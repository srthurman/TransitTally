(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
/*!
 * jQuery JavaScript Library v2.1.4
 * http://jquery.com/
 *
 * Includes Sizzle.js
 * http://sizzlejs.com/
 *
 * Copyright 2005, 2014 jQuery Foundation, Inc. and other contributors
 * Released under the MIT license
 * http://jquery.org/license
 *
 * Date: 2015-04-28T16:01Z
 */

(function( global, factory ) {

	if ( typeof module === "object" && typeof module.exports === "object" ) {
		// For CommonJS and CommonJS-like environments where a proper `window`
		// is present, execute the factory and get jQuery.
		// For environments that do not have a `window` with a `document`
		// (such as Node.js), expose a factory as module.exports.
		// This accentuates the need for the creation of a real `window`.
		// e.g. var jQuery = require("jquery")(window);
		// See ticket #14549 for more info.
		module.exports = global.document ?
			factory( global, true ) :
			function( w ) {
				if ( !w.document ) {
					throw new Error( "jQuery requires a window with a document" );
				}
				return factory( w );
			};
	} else {
		factory( global );
	}

// Pass this if window is not defined yet
}(typeof window !== "undefined" ? window : this, function( window, noGlobal ) {

// Support: Firefox 18+
// Can't be in strict mode, several libs including ASP.NET trace
// the stack via arguments.caller.callee and Firefox dies if
// you try to trace through "use strict" call chains. (#13335)
//

var arr = [];

var slice = arr.slice;

var concat = arr.concat;

var push = arr.push;

var indexOf = arr.indexOf;

var class2type = {};

var toString = class2type.toString;

var hasOwn = class2type.hasOwnProperty;

var support = {};



var
	// Use the correct document accordingly with window argument (sandbox)
	document = window.document,

	version = "2.1.4",

	// Define a local copy of jQuery
	jQuery = function( selector, context ) {
		// The jQuery object is actually just the init constructor 'enhanced'
		// Need init if jQuery is called (just allow error to be thrown if not included)
		return new jQuery.fn.init( selector, context );
	},

	// Support: Android<4.1
	// Make sure we trim BOM and NBSP
	rtrim = /^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,

	// Matches dashed string for camelizing
	rmsPrefix = /^-ms-/,
	rdashAlpha = /-([\da-z])/gi,

	// Used by jQuery.camelCase as callback to replace()
	fcamelCase = function( all, letter ) {
		return letter.toUpperCase();
	};

jQuery.fn = jQuery.prototype = {
	// The current version of jQuery being used
	jquery: version,

	constructor: jQuery,

	// Start with an empty selector
	selector: "",

	// The default length of a jQuery object is 0
	length: 0,

	toArray: function() {
		return slice.call( this );
	},

	// Get the Nth element in the matched element set OR
	// Get the whole matched element set as a clean array
	get: function( num ) {
		return num != null ?

			// Return just the one element from the set
			( num < 0 ? this[ num + this.length ] : this[ num ] ) :

			// Return all the elements in a clean array
			slice.call( this );
	},

	// Take an array of elements and push it onto the stack
	// (returning the new matched element set)
	pushStack: function( elems ) {

		// Build a new jQuery matched element set
		var ret = jQuery.merge( this.constructor(), elems );

		// Add the old object onto the stack (as a reference)
		ret.prevObject = this;
		ret.context = this.context;

		// Return the newly-formed element set
		return ret;
	},

	// Execute a callback for every element in the matched set.
	// (You can seed the arguments with an array of args, but this is
	// only used internally.)
	each: function( callback, args ) {
		return jQuery.each( this, callback, args );
	},

	map: function( callback ) {
		return this.pushStack( jQuery.map(this, function( elem, i ) {
			return callback.call( elem, i, elem );
		}));
	},

	slice: function() {
		return this.pushStack( slice.apply( this, arguments ) );
	},

	first: function() {
		return this.eq( 0 );
	},

	last: function() {
		return this.eq( -1 );
	},

	eq: function( i ) {
		var len = this.length,
			j = +i + ( i < 0 ? len : 0 );
		return this.pushStack( j >= 0 && j < len ? [ this[j] ] : [] );
	},

	end: function() {
		return this.prevObject || this.constructor(null);
	},

	// For internal use only.
	// Behaves like an Array's method, not like a jQuery method.
	push: push,
	sort: arr.sort,
	splice: arr.splice
};

jQuery.extend = jQuery.fn.extend = function() {
	var options, name, src, copy, copyIsArray, clone,
		target = arguments[0] || {},
		i = 1,
		length = arguments.length,
		deep = false;

	// Handle a deep copy situation
	if ( typeof target === "boolean" ) {
		deep = target;

		// Skip the boolean and the target
		target = arguments[ i ] || {};
		i++;
	}

	// Handle case when target is a string or something (possible in deep copy)
	if ( typeof target !== "object" && !jQuery.isFunction(target) ) {
		target = {};
	}

	// Extend jQuery itself if only one argument is passed
	if ( i === length ) {
		target = this;
		i--;
	}

	for ( ; i < length; i++ ) {
		// Only deal with non-null/undefined values
		if ( (options = arguments[ i ]) != null ) {
			// Extend the base object
			for ( name in options ) {
				src = target[ name ];
				copy = options[ name ];

				// Prevent never-ending loop
				if ( target === copy ) {
					continue;
				}

				// Recurse if we're merging plain objects or arrays
				if ( deep && copy && ( jQuery.isPlainObject(copy) || (copyIsArray = jQuery.isArray(copy)) ) ) {
					if ( copyIsArray ) {
						copyIsArray = false;
						clone = src && jQuery.isArray(src) ? src : [];

					} else {
						clone = src && jQuery.isPlainObject(src) ? src : {};
					}

					// Never move original objects, clone them
					target[ name ] = jQuery.extend( deep, clone, copy );

				// Don't bring in undefined values
				} else if ( copy !== undefined ) {
					target[ name ] = copy;
				}
			}
		}
	}

	// Return the modified object
	return target;
};

jQuery.extend({
	// Unique for each copy of jQuery on the page
	expando: "jQuery" + ( version + Math.random() ).replace( /\D/g, "" ),

	// Assume jQuery is ready without the ready module
	isReady: true,

	error: function( msg ) {
		throw new Error( msg );
	},

	noop: function() {},

	isFunction: function( obj ) {
		return jQuery.type(obj) === "function";
	},

	isArray: Array.isArray,

	isWindow: function( obj ) {
		return obj != null && obj === obj.window;
	},

	isNumeric: function( obj ) {
		// parseFloat NaNs numeric-cast false positives (null|true|false|"")
		// ...but misinterprets leading-number strings, particularly hex literals ("0x...")
		// subtraction forces infinities to NaN
		// adding 1 corrects loss of precision from parseFloat (#15100)
		return !jQuery.isArray( obj ) && (obj - parseFloat( obj ) + 1) >= 0;
	},

	isPlainObject: function( obj ) {
		// Not plain objects:
		// - Any object or value whose internal [[Class]] property is not "[object Object]"
		// - DOM nodes
		// - window
		if ( jQuery.type( obj ) !== "object" || obj.nodeType || jQuery.isWindow( obj ) ) {
			return false;
		}

		if ( obj.constructor &&
				!hasOwn.call( obj.constructor.prototype, "isPrototypeOf" ) ) {
			return false;
		}

		// If the function hasn't returned already, we're confident that
		// |obj| is a plain object, created by {} or constructed with new Object
		return true;
	},

	isEmptyObject: function( obj ) {
		var name;
		for ( name in obj ) {
			return false;
		}
		return true;
	},

	type: function( obj ) {
		if ( obj == null ) {
			return obj + "";
		}
		// Support: Android<4.0, iOS<6 (functionish RegExp)
		return typeof obj === "object" || typeof obj === "function" ?
			class2type[ toString.call(obj) ] || "object" :
			typeof obj;
	},

	// Evaluates a script in a global context
	globalEval: function( code ) {
		var script,
			indirect = eval;

		code = jQuery.trim( code );

		if ( code ) {
			// If the code includes a valid, prologue position
			// strict mode pragma, execute code by injecting a
			// script tag into the document.
			if ( code.indexOf("use strict") === 1 ) {
				script = document.createElement("script");
				script.text = code;
				document.head.appendChild( script ).parentNode.removeChild( script );
			} else {
			// Otherwise, avoid the DOM node creation, insertion
			// and removal by using an indirect global eval
				indirect( code );
			}
		}
	},

	// Convert dashed to camelCase; used by the css and data modules
	// Support: IE9-11+
	// Microsoft forgot to hump their vendor prefix (#9572)
	camelCase: function( string ) {
		return string.replace( rmsPrefix, "ms-" ).replace( rdashAlpha, fcamelCase );
	},

	nodeName: function( elem, name ) {
		return elem.nodeName && elem.nodeName.toLowerCase() === name.toLowerCase();
	},

	// args is for internal usage only
	each: function( obj, callback, args ) {
		var value,
			i = 0,
			length = obj.length,
			isArray = isArraylike( obj );

		if ( args ) {
			if ( isArray ) {
				for ( ; i < length; i++ ) {
					value = callback.apply( obj[ i ], args );

					if ( value === false ) {
						break;
					}
				}
			} else {
				for ( i in obj ) {
					value = callback.apply( obj[ i ], args );

					if ( value === false ) {
						break;
					}
				}
			}

		// A special, fast, case for the most common use of each
		} else {
			if ( isArray ) {
				for ( ; i < length; i++ ) {
					value = callback.call( obj[ i ], i, obj[ i ] );

					if ( value === false ) {
						break;
					}
				}
			} else {
				for ( i in obj ) {
					value = callback.call( obj[ i ], i, obj[ i ] );

					if ( value === false ) {
						break;
					}
				}
			}
		}

		return obj;
	},

	// Support: Android<4.1
	trim: function( text ) {
		return text == null ?
			"" :
			( text + "" ).replace( rtrim, "" );
	},

	// results is for internal usage only
	makeArray: function( arr, results ) {
		var ret = results || [];

		if ( arr != null ) {
			if ( isArraylike( Object(arr) ) ) {
				jQuery.merge( ret,
					typeof arr === "string" ?
					[ arr ] : arr
				);
			} else {
				push.call( ret, arr );
			}
		}

		return ret;
	},

	inArray: function( elem, arr, i ) {
		return arr == null ? -1 : indexOf.call( arr, elem, i );
	},

	merge: function( first, second ) {
		var len = +second.length,
			j = 0,
			i = first.length;

		for ( ; j < len; j++ ) {
			first[ i++ ] = second[ j ];
		}

		first.length = i;

		return first;
	},

	grep: function( elems, callback, invert ) {
		var callbackInverse,
			matches = [],
			i = 0,
			length = elems.length,
			callbackExpect = !invert;

		// Go through the array, only saving the items
		// that pass the validator function
		for ( ; i < length; i++ ) {
			callbackInverse = !callback( elems[ i ], i );
			if ( callbackInverse !== callbackExpect ) {
				matches.push( elems[ i ] );
			}
		}

		return matches;
	},

	// arg is for internal usage only
	map: function( elems, callback, arg ) {
		var value,
			i = 0,
			length = elems.length,
			isArray = isArraylike( elems ),
			ret = [];

		// Go through the array, translating each of the items to their new values
		if ( isArray ) {
			for ( ; i < length; i++ ) {
				value = callback( elems[ i ], i, arg );

				if ( value != null ) {
					ret.push( value );
				}
			}

		// Go through every key on the object,
		} else {
			for ( i in elems ) {
				value = callback( elems[ i ], i, arg );

				if ( value != null ) {
					ret.push( value );
				}
			}
		}

		// Flatten any nested arrays
		return concat.apply( [], ret );
	},

	// A global GUID counter for objects
	guid: 1,

	// Bind a function to a context, optionally partially applying any
	// arguments.
	proxy: function( fn, context ) {
		var tmp, args, proxy;

		if ( typeof context === "string" ) {
			tmp = fn[ context ];
			context = fn;
			fn = tmp;
		}

		// Quick check to determine if target is callable, in the spec
		// this throws a TypeError, but we will just return undefined.
		if ( !jQuery.isFunction( fn ) ) {
			return undefined;
		}

		// Simulated bind
		args = slice.call( arguments, 2 );
		proxy = function() {
			return fn.apply( context || this, args.concat( slice.call( arguments ) ) );
		};

		// Set the guid of unique handler to the same of original handler, so it can be removed
		proxy.guid = fn.guid = fn.guid || jQuery.guid++;

		return proxy;
	},

	now: Date.now,

	// jQuery.support is not used in Core but other projects attach their
	// properties to it so it needs to exist.
	support: support
});

// Populate the class2type map
jQuery.each("Boolean Number String Function Array Date RegExp Object Error".split(" "), function(i, name) {
	class2type[ "[object " + name + "]" ] = name.toLowerCase();
});

function isArraylike( obj ) {

	// Support: iOS 8.2 (not reproducible in simulator)
	// `in` check used to prevent JIT error (gh-2145)
	// hasOwn isn't used here due to false negatives
	// regarding Nodelist length in IE
	var length = "length" in obj && obj.length,
		type = jQuery.type( obj );

	if ( type === "function" || jQuery.isWindow( obj ) ) {
		return false;
	}

	if ( obj.nodeType === 1 && length ) {
		return true;
	}

	return type === "array" || length === 0 ||
		typeof length === "number" && length > 0 && ( length - 1 ) in obj;
}
var Sizzle =
/*!
 * Sizzle CSS Selector Engine v2.2.0-pre
 * http://sizzlejs.com/
 *
 * Copyright 2008, 2014 jQuery Foundation, Inc. and other contributors
 * Released under the MIT license
 * http://jquery.org/license
 *
 * Date: 2014-12-16
 */
(function( window ) {

var i,
	support,
	Expr,
	getText,
	isXML,
	tokenize,
	compile,
	select,
	outermostContext,
	sortInput,
	hasDuplicate,

	// Local document vars
	setDocument,
	document,
	docElem,
	documentIsHTML,
	rbuggyQSA,
	rbuggyMatches,
	matches,
	contains,

	// Instance-specific data
	expando = "sizzle" + 1 * new Date(),
	preferredDoc = window.document,
	dirruns = 0,
	done = 0,
	classCache = createCache(),
	tokenCache = createCache(),
	compilerCache = createCache(),
	sortOrder = function( a, b ) {
		if ( a === b ) {
			hasDuplicate = true;
		}
		return 0;
	},

	// General-purpose constants
	MAX_NEGATIVE = 1 << 31,

	// Instance methods
	hasOwn = ({}).hasOwnProperty,
	arr = [],
	pop = arr.pop,
	push_native = arr.push,
	push = arr.push,
	slice = arr.slice,
	// Use a stripped-down indexOf as it's faster than native
	// http://jsperf.com/thor-indexof-vs-for/5
	indexOf = function( list, elem ) {
		var i = 0,
			len = list.length;
		for ( ; i < len; i++ ) {
			if ( list[i] === elem ) {
				return i;
			}
		}
		return -1;
	},

	booleans = "checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",

	// Regular expressions

	// Whitespace characters http://www.w3.org/TR/css3-selectors/#whitespace
	whitespace = "[\\x20\\t\\r\\n\\f]",
	// http://www.w3.org/TR/css3-syntax/#characters
	characterEncoding = "(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",

	// Loosely modeled on CSS identifier characters
	// An unquoted value should be a CSS identifier http://www.w3.org/TR/css3-selectors/#attribute-selectors
	// Proper syntax: http://www.w3.org/TR/CSS21/syndata.html#value-def-identifier
	identifier = characterEncoding.replace( "w", "w#" ),

	// Attribute selectors: http://www.w3.org/TR/selectors/#attribute-selectors
	attributes = "\\[" + whitespace + "*(" + characterEncoding + ")(?:" + whitespace +
		// Operator (capture 2)
		"*([*^$|!~]?=)" + whitespace +
		// "Attribute values must be CSS identifiers [capture 5] or strings [capture 3 or capture 4]"
		"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|(" + identifier + "))|)" + whitespace +
		"*\\]",

	pseudos = ":(" + characterEncoding + ")(?:\\((" +
		// To reduce the number of selectors needing tokenize in the preFilter, prefer arguments:
		// 1. quoted (capture 3; capture 4 or capture 5)
		"('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|" +
		// 2. simple (capture 6)
		"((?:\\\\.|[^\\\\()[\\]]|" + attributes + ")*)|" +
		// 3. anything else (capture 2)
		".*" +
		")\\)|)",

	// Leading and non-escaped trailing whitespace, capturing some non-whitespace characters preceding the latter
	rwhitespace = new RegExp( whitespace + "+", "g" ),
	rtrim = new RegExp( "^" + whitespace + "+|((?:^|[^\\\\])(?:\\\\.)*)" + whitespace + "+$", "g" ),

	rcomma = new RegExp( "^" + whitespace + "*," + whitespace + "*" ),
	rcombinators = new RegExp( "^" + whitespace + "*([>+~]|" + whitespace + ")" + whitespace + "*" ),

	rattributeQuotes = new RegExp( "=" + whitespace + "*([^\\]'\"]*?)" + whitespace + "*\\]", "g" ),

	rpseudo = new RegExp( pseudos ),
	ridentifier = new RegExp( "^" + identifier + "$" ),

	matchExpr = {
		"ID": new RegExp( "^#(" + characterEncoding + ")" ),
		"CLASS": new RegExp( "^\\.(" + characterEncoding + ")" ),
		"TAG": new RegExp( "^(" + characterEncoding.replace( "w", "w*" ) + ")" ),
		"ATTR": new RegExp( "^" + attributes ),
		"PSEUDO": new RegExp( "^" + pseudos ),
		"CHILD": new RegExp( "^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\(" + whitespace +
			"*(even|odd|(([+-]|)(\\d*)n|)" + whitespace + "*(?:([+-]|)" + whitespace +
			"*(\\d+)|))" + whitespace + "*\\)|)", "i" ),
		"bool": new RegExp( "^(?:" + booleans + ")$", "i" ),
		// For use in libraries implementing .is()
		// We use this for POS matching in `select`
		"needsContext": new RegExp( "^" + whitespace + "*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\(" +
			whitespace + "*((?:-\\d)?\\d*)" + whitespace + "*\\)|)(?=[^-]|$)", "i" )
	},

	rinputs = /^(?:input|select|textarea|button)$/i,
	rheader = /^h\d$/i,

	rnative = /^[^{]+\{\s*\[native \w/,

	// Easily-parseable/retrievable ID or TAG or CLASS selectors
	rquickExpr = /^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,

	rsibling = /[+~]/,
	rescape = /'|\\/g,

	// CSS escapes http://www.w3.org/TR/CSS21/syndata.html#escaped-characters
	runescape = new RegExp( "\\\\([\\da-f]{1,6}" + whitespace + "?|(" + whitespace + ")|.)", "ig" ),
	funescape = function( _, escaped, escapedWhitespace ) {
		var high = "0x" + escaped - 0x10000;
		// NaN means non-codepoint
		// Support: Firefox<24
		// Workaround erroneous numeric interpretation of +"0x"
		return high !== high || escapedWhitespace ?
			escaped :
			high < 0 ?
				// BMP codepoint
				String.fromCharCode( high + 0x10000 ) :
				// Supplemental Plane codepoint (surrogate pair)
				String.fromCharCode( high >> 10 | 0xD800, high & 0x3FF | 0xDC00 );
	},

	// Used for iframes
	// See setDocument()
	// Removing the function wrapper causes a "Permission Denied"
	// error in IE
	unloadHandler = function() {
		setDocument();
	};

// Optimize for push.apply( _, NodeList )
try {
	push.apply(
		(arr = slice.call( preferredDoc.childNodes )),
		preferredDoc.childNodes
	);
	// Support: Android<4.0
	// Detect silently failing push.apply
	arr[ preferredDoc.childNodes.length ].nodeType;
} catch ( e ) {
	push = { apply: arr.length ?

		// Leverage slice if possible
		function( target, els ) {
			push_native.apply( target, slice.call(els) );
		} :

		// Support: IE<9
		// Otherwise append directly
		function( target, els ) {
			var j = target.length,
				i = 0;
			// Can't trust NodeList.length
			while ( (target[j++] = els[i++]) ) {}
			target.length = j - 1;
		}
	};
}

function Sizzle( selector, context, results, seed ) {
	var match, elem, m, nodeType,
		// QSA vars
		i, groups, old, nid, newContext, newSelector;

	if ( ( context ? context.ownerDocument || context : preferredDoc ) !== document ) {
		setDocument( context );
	}

	context = context || document;
	results = results || [];
	nodeType = context.nodeType;

	if ( typeof selector !== "string" || !selector ||
		nodeType !== 1 && nodeType !== 9 && nodeType !== 11 ) {

		return results;
	}

	if ( !seed && documentIsHTML ) {

		// Try to shortcut find operations when possible (e.g., not under DocumentFragment)
		if ( nodeType !== 11 && (match = rquickExpr.exec( selector )) ) {
			// Speed-up: Sizzle("#ID")
			if ( (m = match[1]) ) {
				if ( nodeType === 9 ) {
					elem = context.getElementById( m );
					// Check parentNode to catch when Blackberry 4.6 returns
					// nodes that are no longer in the document (jQuery #6963)
					if ( elem && elem.parentNode ) {
						// Handle the case where IE, Opera, and Webkit return items
						// by name instead of ID
						if ( elem.id === m ) {
							results.push( elem );
							return results;
						}
					} else {
						return results;
					}
				} else {
					// Context is not a document
					if ( context.ownerDocument && (elem = context.ownerDocument.getElementById( m )) &&
						contains( context, elem ) && elem.id === m ) {
						results.push( elem );
						return results;
					}
				}

			// Speed-up: Sizzle("TAG")
			} else if ( match[2] ) {
				push.apply( results, context.getElementsByTagName( selector ) );
				return results;

			// Speed-up: Sizzle(".CLASS")
			} else if ( (m = match[3]) && support.getElementsByClassName ) {
				push.apply( results, context.getElementsByClassName( m ) );
				return results;
			}
		}

		// QSA path
		if ( support.qsa && (!rbuggyQSA || !rbuggyQSA.test( selector )) ) {
			nid = old = expando;
			newContext = context;
			newSelector = nodeType !== 1 && selector;

			// qSA works strangely on Element-rooted queries
			// We can work around this by specifying an extra ID on the root
			// and working up from there (Thanks to Andrew Dupont for the technique)
			// IE 8 doesn't work on object elements
			if ( nodeType === 1 && context.nodeName.toLowerCase() !== "object" ) {
				groups = tokenize( selector );

				if ( (old = context.getAttribute("id")) ) {
					nid = old.replace( rescape, "\\$&" );
				} else {
					context.setAttribute( "id", nid );
				}
				nid = "[id='" + nid + "'] ";

				i = groups.length;
				while ( i-- ) {
					groups[i] = nid + toSelector( groups[i] );
				}
				newContext = rsibling.test( selector ) && testContext( context.parentNode ) || context;
				newSelector = groups.join(",");
			}

			if ( newSelector ) {
				try {
					push.apply( results,
						newContext.querySelectorAll( newSelector )
					);
					return results;
				} catch(qsaError) {
				} finally {
					if ( !old ) {
						context.removeAttribute("id");
					}
				}
			}
		}
	}

	// All others
	return select( selector.replace( rtrim, "$1" ), context, results, seed );
}

/**
 * Create key-value caches of limited size
 * @returns {Function(string, Object)} Returns the Object data after storing it on itself with
 *	property name the (space-suffixed) string and (if the cache is larger than Expr.cacheLength)
 *	deleting the oldest entry
 */
function createCache() {
	var keys = [];

	function cache( key, value ) {
		// Use (key + " ") to avoid collision with native prototype properties (see Issue #157)
		if ( keys.push( key + " " ) > Expr.cacheLength ) {
			// Only keep the most recent entries
			delete cache[ keys.shift() ];
		}
		return (cache[ key + " " ] = value);
	}
	return cache;
}

/**
 * Mark a function for special use by Sizzle
 * @param {Function} fn The function to mark
 */
function markFunction( fn ) {
	fn[ expando ] = true;
	return fn;
}

/**
 * Support testing using an element
 * @param {Function} fn Passed the created div and expects a boolean result
 */
function assert( fn ) {
	var div = document.createElement("div");

	try {
		return !!fn( div );
	} catch (e) {
		return false;
	} finally {
		// Remove from its parent by default
		if ( div.parentNode ) {
			div.parentNode.removeChild( div );
		}
		// release memory in IE
		div = null;
	}
}

/**
 * Adds the same handler for all of the specified attrs
 * @param {String} attrs Pipe-separated list of attributes
 * @param {Function} handler The method that will be applied
 */
function addHandle( attrs, handler ) {
	var arr = attrs.split("|"),
		i = attrs.length;

	while ( i-- ) {
		Expr.attrHandle[ arr[i] ] = handler;
	}
}

/**
 * Checks document order of two siblings
 * @param {Element} a
 * @param {Element} b
 * @returns {Number} Returns less than 0 if a precedes b, greater than 0 if a follows b
 */
function siblingCheck( a, b ) {
	var cur = b && a,
		diff = cur && a.nodeType === 1 && b.nodeType === 1 &&
			( ~b.sourceIndex || MAX_NEGATIVE ) -
			( ~a.sourceIndex || MAX_NEGATIVE );

	// Use IE sourceIndex if available on both nodes
	if ( diff ) {
		return diff;
	}

	// Check if b follows a
	if ( cur ) {
		while ( (cur = cur.nextSibling) ) {
			if ( cur === b ) {
				return -1;
			}
		}
	}

	return a ? 1 : -1;
}

/**
 * Returns a function to use in pseudos for input types
 * @param {String} type
 */
function createInputPseudo( type ) {
	return function( elem ) {
		var name = elem.nodeName.toLowerCase();
		return name === "input" && elem.type === type;
	};
}

/**
 * Returns a function to use in pseudos for buttons
 * @param {String} type
 */
function createButtonPseudo( type ) {
	return function( elem ) {
		var name = elem.nodeName.toLowerCase();
		return (name === "input" || name === "button") && elem.type === type;
	};
}

/**
 * Returns a function to use in pseudos for positionals
 * @param {Function} fn
 */
function createPositionalPseudo( fn ) {
	return markFunction(function( argument ) {
		argument = +argument;
		return markFunction(function( seed, matches ) {
			var j,
				matchIndexes = fn( [], seed.length, argument ),
				i = matchIndexes.length;

			// Match elements found at the specified indexes
			while ( i-- ) {
				if ( seed[ (j = matchIndexes[i]) ] ) {
					seed[j] = !(matches[j] = seed[j]);
				}
			}
		});
	});
}

/**
 * Checks a node for validity as a Sizzle context
 * @param {Element|Object=} context
 * @returns {Element|Object|Boolean} The input node if acceptable, otherwise a falsy value
 */
function testContext( context ) {
	return context && typeof context.getElementsByTagName !== "undefined" && context;
}

// Expose support vars for convenience
support = Sizzle.support = {};

/**
 * Detects XML nodes
 * @param {Element|Object} elem An element or a document
 * @returns {Boolean} True iff elem is a non-HTML XML node
 */
isXML = Sizzle.isXML = function( elem ) {
	// documentElement is verified for cases where it doesn't yet exist
	// (such as loading iframes in IE - #4833)
	var documentElement = elem && (elem.ownerDocument || elem).documentElement;
	return documentElement ? documentElement.nodeName !== "HTML" : false;
};

/**
 * Sets document-related variables once based on the current document
 * @param {Element|Object} [doc] An element or document object to use to set the document
 * @returns {Object} Returns the current document
 */
setDocument = Sizzle.setDocument = function( node ) {
	var hasCompare, parent,
		doc = node ? node.ownerDocument || node : preferredDoc;

	// If no document and documentElement is available, return
	if ( doc === document || doc.nodeType !== 9 || !doc.documentElement ) {
		return document;
	}

	// Set our document
	document = doc;
	docElem = doc.documentElement;
	parent = doc.defaultView;

	// Support: IE>8
	// If iframe document is assigned to "document" variable and if iframe has been reloaded,
	// IE will throw "permission denied" error when accessing "document" variable, see jQuery #13936
	// IE6-8 do not support the defaultView property so parent will be undefined
	if ( parent && parent !== parent.top ) {
		// IE11 does not have attachEvent, so all must suffer
		if ( parent.addEventListener ) {
			parent.addEventListener( "unload", unloadHandler, false );
		} else if ( parent.attachEvent ) {
			parent.attachEvent( "onunload", unloadHandler );
		}
	}

	/* Support tests
	---------------------------------------------------------------------- */
	documentIsHTML = !isXML( doc );

	/* Attributes
	---------------------------------------------------------------------- */

	// Support: IE<8
	// Verify that getAttribute really returns attributes and not properties
	// (excepting IE8 booleans)
	support.attributes = assert(function( div ) {
		div.className = "i";
		return !div.getAttribute("className");
	});

	/* getElement(s)By*
	---------------------------------------------------------------------- */

	// Check if getElementsByTagName("*") returns only elements
	support.getElementsByTagName = assert(function( div ) {
		div.appendChild( doc.createComment("") );
		return !div.getElementsByTagName("*").length;
	});

	// Support: IE<9
	support.getElementsByClassName = rnative.test( doc.getElementsByClassName );

	// Support: IE<10
	// Check if getElementById returns elements by name
	// The broken getElementById methods don't pick up programatically-set names,
	// so use a roundabout getElementsByName test
	support.getById = assert(function( div ) {
		docElem.appendChild( div ).id = expando;
		return !doc.getElementsByName || !doc.getElementsByName( expando ).length;
	});

	// ID find and filter
	if ( support.getById ) {
		Expr.find["ID"] = function( id, context ) {
			if ( typeof context.getElementById !== "undefined" && documentIsHTML ) {
				var m = context.getElementById( id );
				// Check parentNode to catch when Blackberry 4.6 returns
				// nodes that are no longer in the document #6963
				return m && m.parentNode ? [ m ] : [];
			}
		};
		Expr.filter["ID"] = function( id ) {
			var attrId = id.replace( runescape, funescape );
			return function( elem ) {
				return elem.getAttribute("id") === attrId;
			};
		};
	} else {
		// Support: IE6/7
		// getElementById is not reliable as a find shortcut
		delete Expr.find["ID"];

		Expr.filter["ID"] =  function( id ) {
			var attrId = id.replace( runescape, funescape );
			return function( elem ) {
				var node = typeof elem.getAttributeNode !== "undefined" && elem.getAttributeNode("id");
				return node && node.value === attrId;
			};
		};
	}

	// Tag
	Expr.find["TAG"] = support.getElementsByTagName ?
		function( tag, context ) {
			if ( typeof context.getElementsByTagName !== "undefined" ) {
				return context.getElementsByTagName( tag );

			// DocumentFragment nodes don't have gEBTN
			} else if ( support.qsa ) {
				return context.querySelectorAll( tag );
			}
		} :

		function( tag, context ) {
			var elem,
				tmp = [],
				i = 0,
				// By happy coincidence, a (broken) gEBTN appears on DocumentFragment nodes too
				results = context.getElementsByTagName( tag );

			// Filter out possible comments
			if ( tag === "*" ) {
				while ( (elem = results[i++]) ) {
					if ( elem.nodeType === 1 ) {
						tmp.push( elem );
					}
				}

				return tmp;
			}
			return results;
		};

	// Class
	Expr.find["CLASS"] = support.getElementsByClassName && function( className, context ) {
		if ( documentIsHTML ) {
			return context.getElementsByClassName( className );
		}
	};

	/* QSA/matchesSelector
	---------------------------------------------------------------------- */

	// QSA and matchesSelector support

	// matchesSelector(:active) reports false when true (IE9/Opera 11.5)
	rbuggyMatches = [];

	// qSa(:focus) reports false when true (Chrome 21)
	// We allow this because of a bug in IE8/9 that throws an error
	// whenever `document.activeElement` is accessed on an iframe
	// So, we allow :focus to pass through QSA all the time to avoid the IE error
	// See http://bugs.jquery.com/ticket/13378
	rbuggyQSA = [];

	if ( (support.qsa = rnative.test( doc.querySelectorAll )) ) {
		// Build QSA regex
		// Regex strategy adopted from Diego Perini
		assert(function( div ) {
			// Select is set to empty string on purpose
			// This is to test IE's treatment of not explicitly
			// setting a boolean content attribute,
			// since its presence should be enough
			// http://bugs.jquery.com/ticket/12359
			docElem.appendChild( div ).innerHTML = "<a id='" + expando + "'></a>" +
				"<select id='" + expando + "-\f]' msallowcapture=''>" +
				"<option selected=''></option></select>";

			// Support: IE8, Opera 11-12.16
			// Nothing should be selected when empty strings follow ^= or $= or *=
			// The test attribute must be unknown in Opera but "safe" for WinRT
			// http://msdn.microsoft.com/en-us/library/ie/hh465388.aspx#attribute_section
			if ( div.querySelectorAll("[msallowcapture^='']").length ) {
				rbuggyQSA.push( "[*^$]=" + whitespace + "*(?:''|\"\")" );
			}

			// Support: IE8
			// Boolean attributes and "value" are not treated correctly
			if ( !div.querySelectorAll("[selected]").length ) {
				rbuggyQSA.push( "\\[" + whitespace + "*(?:value|" + booleans + ")" );
			}

			// Support: Chrome<29, Android<4.2+, Safari<7.0+, iOS<7.0+, PhantomJS<1.9.7+
			if ( !div.querySelectorAll( "[id~=" + expando + "-]" ).length ) {
				rbuggyQSA.push("~=");
			}

			// Webkit/Opera - :checked should return selected option elements
			// http://www.w3.org/TR/2011/REC-css3-selectors-20110929/#checked
			// IE8 throws error here and will not see later tests
			if ( !div.querySelectorAll(":checked").length ) {
				rbuggyQSA.push(":checked");
			}

			// Support: Safari 8+, iOS 8+
			// https://bugs.webkit.org/show_bug.cgi?id=136851
			// In-page `selector#id sibing-combinator selector` fails
			if ( !div.querySelectorAll( "a#" + expando + "+*" ).length ) {
				rbuggyQSA.push(".#.+[+~]");
			}
		});

		assert(function( div ) {
			// Support: Windows 8 Native Apps
			// The type and name attributes are restricted during .innerHTML assignment
			var input = doc.createElement("input");
			input.setAttribute( "type", "hidden" );
			div.appendChild( input ).setAttribute( "name", "D" );

			// Support: IE8
			// Enforce case-sensitivity of name attribute
			if ( div.querySelectorAll("[name=d]").length ) {
				rbuggyQSA.push( "name" + whitespace + "*[*^$|!~]?=" );
			}

			// FF 3.5 - :enabled/:disabled and hidden elements (hidden elements are still enabled)
			// IE8 throws error here and will not see later tests
			if ( !div.querySelectorAll(":enabled").length ) {
				rbuggyQSA.push( ":enabled", ":disabled" );
			}

			// Opera 10-11 does not throw on post-comma invalid pseudos
			div.querySelectorAll("*,:x");
			rbuggyQSA.push(",.*:");
		});
	}

	if ( (support.matchesSelector = rnative.test( (matches = docElem.matches ||
		docElem.webkitMatchesSelector ||
		docElem.mozMatchesSelector ||
		docElem.oMatchesSelector ||
		docElem.msMatchesSelector) )) ) {

		assert(function( div ) {
			// Check to see if it's possible to do matchesSelector
			// on a disconnected node (IE 9)
			support.disconnectedMatch = matches.call( div, "div" );

			// This should fail with an exception
			// Gecko does not error, returns false instead
			matches.call( div, "[s!='']:x" );
			rbuggyMatches.push( "!=", pseudos );
		});
	}

	rbuggyQSA = rbuggyQSA.length && new RegExp( rbuggyQSA.join("|") );
	rbuggyMatches = rbuggyMatches.length && new RegExp( rbuggyMatches.join("|") );

	/* Contains
	---------------------------------------------------------------------- */
	hasCompare = rnative.test( docElem.compareDocumentPosition );

	// Element contains another
	// Purposefully does not implement inclusive descendent
	// As in, an element does not contain itself
	contains = hasCompare || rnative.test( docElem.contains ) ?
		function( a, b ) {
			var adown = a.nodeType === 9 ? a.documentElement : a,
				bup = b && b.parentNode;
			return a === bup || !!( bup && bup.nodeType === 1 && (
				adown.contains ?
					adown.contains( bup ) :
					a.compareDocumentPosition && a.compareDocumentPosition( bup ) & 16
			));
		} :
		function( a, b ) {
			if ( b ) {
				while ( (b = b.parentNode) ) {
					if ( b === a ) {
						return true;
					}
				}
			}
			return false;
		};

	/* Sorting
	---------------------------------------------------------------------- */

	// Document order sorting
	sortOrder = hasCompare ?
	function( a, b ) {

		// Flag for duplicate removal
		if ( a === b ) {
			hasDuplicate = true;
			return 0;
		}

		// Sort on method existence if only one input has compareDocumentPosition
		var compare = !a.compareDocumentPosition - !b.compareDocumentPosition;
		if ( compare ) {
			return compare;
		}

		// Calculate position if both inputs belong to the same document
		compare = ( a.ownerDocument || a ) === ( b.ownerDocument || b ) ?
			a.compareDocumentPosition( b ) :

			// Otherwise we know they are disconnected
			1;

		// Disconnected nodes
		if ( compare & 1 ||
			(!support.sortDetached && b.compareDocumentPosition( a ) === compare) ) {

			// Choose the first element that is related to our preferred document
			if ( a === doc || a.ownerDocument === preferredDoc && contains(preferredDoc, a) ) {
				return -1;
			}
			if ( b === doc || b.ownerDocument === preferredDoc && contains(preferredDoc, b) ) {
				return 1;
			}

			// Maintain original order
			return sortInput ?
				( indexOf( sortInput, a ) - indexOf( sortInput, b ) ) :
				0;
		}

		return compare & 4 ? -1 : 1;
	} :
	function( a, b ) {
		// Exit early if the nodes are identical
		if ( a === b ) {
			hasDuplicate = true;
			return 0;
		}

		var cur,
			i = 0,
			aup = a.parentNode,
			bup = b.parentNode,
			ap = [ a ],
			bp = [ b ];

		// Parentless nodes are either documents or disconnected
		if ( !aup || !bup ) {
			return a === doc ? -1 :
				b === doc ? 1 :
				aup ? -1 :
				bup ? 1 :
				sortInput ?
				( indexOf( sortInput, a ) - indexOf( sortInput, b ) ) :
				0;

		// If the nodes are siblings, we can do a quick check
		} else if ( aup === bup ) {
			return siblingCheck( a, b );
		}

		// Otherwise we need full lists of their ancestors for comparison
		cur = a;
		while ( (cur = cur.parentNode) ) {
			ap.unshift( cur );
		}
		cur = b;
		while ( (cur = cur.parentNode) ) {
			bp.unshift( cur );
		}

		// Walk down the tree looking for a discrepancy
		while ( ap[i] === bp[i] ) {
			i++;
		}

		return i ?
			// Do a sibling check if the nodes have a common ancestor
			siblingCheck( ap[i], bp[i] ) :

			// Otherwise nodes in our document sort first
			ap[i] === preferredDoc ? -1 :
			bp[i] === preferredDoc ? 1 :
			0;
	};

	return doc;
};

Sizzle.matches = function( expr, elements ) {
	return Sizzle( expr, null, null, elements );
};

Sizzle.matchesSelector = function( elem, expr ) {
	// Set document vars if needed
	if ( ( elem.ownerDocument || elem ) !== document ) {
		setDocument( elem );
	}

	// Make sure that attribute selectors are quoted
	expr = expr.replace( rattributeQuotes, "='$1']" );

	if ( support.matchesSelector && documentIsHTML &&
		( !rbuggyMatches || !rbuggyMatches.test( expr ) ) &&
		( !rbuggyQSA     || !rbuggyQSA.test( expr ) ) ) {

		try {
			var ret = matches.call( elem, expr );

			// IE 9's matchesSelector returns false on disconnected nodes
			if ( ret || support.disconnectedMatch ||
					// As well, disconnected nodes are said to be in a document
					// fragment in IE 9
					elem.document && elem.document.nodeType !== 11 ) {
				return ret;
			}
		} catch (e) {}
	}

	return Sizzle( expr, document, null, [ elem ] ).length > 0;
};

Sizzle.contains = function( context, elem ) {
	// Set document vars if needed
	if ( ( context.ownerDocument || context ) !== document ) {
		setDocument( context );
	}
	return contains( context, elem );
};

Sizzle.attr = function( elem, name ) {
	// Set document vars if needed
	if ( ( elem.ownerDocument || elem ) !== document ) {
		setDocument( elem );
	}

	var fn = Expr.attrHandle[ name.toLowerCase() ],
		// Don't get fooled by Object.prototype properties (jQuery #13807)
		val = fn && hasOwn.call( Expr.attrHandle, name.toLowerCase() ) ?
			fn( elem, name, !documentIsHTML ) :
			undefined;

	return val !== undefined ?
		val :
		support.attributes || !documentIsHTML ?
			elem.getAttribute( name ) :
			(val = elem.getAttributeNode(name)) && val.specified ?
				val.value :
				null;
};

Sizzle.error = function( msg ) {
	throw new Error( "Syntax error, unrecognized expression: " + msg );
};

/**
 * Document sorting and removing duplicates
 * @param {ArrayLike} results
 */
Sizzle.uniqueSort = function( results ) {
	var elem,
		duplicates = [],
		j = 0,
		i = 0;

	// Unless we *know* we can detect duplicates, assume their presence
	hasDuplicate = !support.detectDuplicates;
	sortInput = !support.sortStable && results.slice( 0 );
	results.sort( sortOrder );

	if ( hasDuplicate ) {
		while ( (elem = results[i++]) ) {
			if ( elem === results[ i ] ) {
				j = duplicates.push( i );
			}
		}
		while ( j-- ) {
			results.splice( duplicates[ j ], 1 );
		}
	}

	// Clear input after sorting to release objects
	// See https://github.com/jquery/sizzle/pull/225
	sortInput = null;

	return results;
};

/**
 * Utility function for retrieving the text value of an array of DOM nodes
 * @param {Array|Element} elem
 */
getText = Sizzle.getText = function( elem ) {
	var node,
		ret = "",
		i = 0,
		nodeType = elem.nodeType;

	if ( !nodeType ) {
		// If no nodeType, this is expected to be an array
		while ( (node = elem[i++]) ) {
			// Do not traverse comment nodes
			ret += getText( node );
		}
	} else if ( nodeType === 1 || nodeType === 9 || nodeType === 11 ) {
		// Use textContent for elements
		// innerText usage removed for consistency of new lines (jQuery #11153)
		if ( typeof elem.textContent === "string" ) {
			return elem.textContent;
		} else {
			// Traverse its children
			for ( elem = elem.firstChild; elem; elem = elem.nextSibling ) {
				ret += getText( elem );
			}
		}
	} else if ( nodeType === 3 || nodeType === 4 ) {
		return elem.nodeValue;
	}
	// Do not include comment or processing instruction nodes

	return ret;
};

Expr = Sizzle.selectors = {

	// Can be adjusted by the user
	cacheLength: 50,

	createPseudo: markFunction,

	match: matchExpr,

	attrHandle: {},

	find: {},

	relative: {
		">": { dir: "parentNode", first: true },
		" ": { dir: "parentNode" },
		"+": { dir: "previousSibling", first: true },
		"~": { dir: "previousSibling" }
	},

	preFilter: {
		"ATTR": function( match ) {
			match[1] = match[1].replace( runescape, funescape );

			// Move the given value to match[3] whether quoted or unquoted
			match[3] = ( match[3] || match[4] || match[5] || "" ).replace( runescape, funescape );

			if ( match[2] === "~=" ) {
				match[3] = " " + match[3] + " ";
			}

			return match.slice( 0, 4 );
		},

		"CHILD": function( match ) {
			/* matches from matchExpr["CHILD"]
				1 type (only|nth|...)
				2 what (child|of-type)
				3 argument (even|odd|\d*|\d*n([+-]\d+)?|...)
				4 xn-component of xn+y argument ([+-]?\d*n|)
				5 sign of xn-component
				6 x of xn-component
				7 sign of y-component
				8 y of y-component
			*/
			match[1] = match[1].toLowerCase();

			if ( match[1].slice( 0, 3 ) === "nth" ) {
				// nth-* requires argument
				if ( !match[3] ) {
					Sizzle.error( match[0] );
				}

				// numeric x and y parameters for Expr.filter.CHILD
				// remember that false/true cast respectively to 0/1
				match[4] = +( match[4] ? match[5] + (match[6] || 1) : 2 * ( match[3] === "even" || match[3] === "odd" ) );
				match[5] = +( ( match[7] + match[8] ) || match[3] === "odd" );

			// other types prohibit arguments
			} else if ( match[3] ) {
				Sizzle.error( match[0] );
			}

			return match;
		},

		"PSEUDO": function( match ) {
			var excess,
				unquoted = !match[6] && match[2];

			if ( matchExpr["CHILD"].test( match[0] ) ) {
				return null;
			}

			// Accept quoted arguments as-is
			if ( match[3] ) {
				match[2] = match[4] || match[5] || "";

			// Strip excess characters from unquoted arguments
			} else if ( unquoted && rpseudo.test( unquoted ) &&
				// Get excess from tokenize (recursively)
				(excess = tokenize( unquoted, true )) &&
				// advance to the next closing parenthesis
				(excess = unquoted.indexOf( ")", unquoted.length - excess ) - unquoted.length) ) {

				// excess is a negative index
				match[0] = match[0].slice( 0, excess );
				match[2] = unquoted.slice( 0, excess );
			}

			// Return only captures needed by the pseudo filter method (type and argument)
			return match.slice( 0, 3 );
		}
	},

	filter: {

		"TAG": function( nodeNameSelector ) {
			var nodeName = nodeNameSelector.replace( runescape, funescape ).toLowerCase();
			return nodeNameSelector === "*" ?
				function() { return true; } :
				function( elem ) {
					return elem.nodeName && elem.nodeName.toLowerCase() === nodeName;
				};
		},

		"CLASS": function( className ) {
			var pattern = classCache[ className + " " ];

			return pattern ||
				(pattern = new RegExp( "(^|" + whitespace + ")" + className + "(" + whitespace + "|$)" )) &&
				classCache( className, function( elem ) {
					return pattern.test( typeof elem.className === "string" && elem.className || typeof elem.getAttribute !== "undefined" && elem.getAttribute("class") || "" );
				});
		},

		"ATTR": function( name, operator, check ) {
			return function( elem ) {
				var result = Sizzle.attr( elem, name );

				if ( result == null ) {
					return operator === "!=";
				}
				if ( !operator ) {
					return true;
				}

				result += "";

				return operator === "=" ? result === check :
					operator === "!=" ? result !== check :
					operator === "^=" ? check && result.indexOf( check ) === 0 :
					operator === "*=" ? check && result.indexOf( check ) > -1 :
					operator === "$=" ? check && result.slice( -check.length ) === check :
					operator === "~=" ? ( " " + result.replace( rwhitespace, " " ) + " " ).indexOf( check ) > -1 :
					operator === "|=" ? result === check || result.slice( 0, check.length + 1 ) === check + "-" :
					false;
			};
		},

		"CHILD": function( type, what, argument, first, last ) {
			var simple = type.slice( 0, 3 ) !== "nth",
				forward = type.slice( -4 ) !== "last",
				ofType = what === "of-type";

			return first === 1 && last === 0 ?

				// Shortcut for :nth-*(n)
				function( elem ) {
					return !!elem.parentNode;
				} :

				function( elem, context, xml ) {
					var cache, outerCache, node, diff, nodeIndex, start,
						dir = simple !== forward ? "nextSibling" : "previousSibling",
						parent = elem.parentNode,
						name = ofType && elem.nodeName.toLowerCase(),
						useCache = !xml && !ofType;

					if ( parent ) {

						// :(first|last|only)-(child|of-type)
						if ( simple ) {
							while ( dir ) {
								node = elem;
								while ( (node = node[ dir ]) ) {
									if ( ofType ? node.nodeName.toLowerCase() === name : node.nodeType === 1 ) {
										return false;
									}
								}
								// Reverse direction for :only-* (if we haven't yet done so)
								start = dir = type === "only" && !start && "nextSibling";
							}
							return true;
						}

						start = [ forward ? parent.firstChild : parent.lastChild ];

						// non-xml :nth-child(...) stores cache data on `parent`
						if ( forward && useCache ) {
							// Seek `elem` from a previously-cached index
							outerCache = parent[ expando ] || (parent[ expando ] = {});
							cache = outerCache[ type ] || [];
							nodeIndex = cache[0] === dirruns && cache[1];
							diff = cache[0] === dirruns && cache[2];
							node = nodeIndex && parent.childNodes[ nodeIndex ];

							while ( (node = ++nodeIndex && node && node[ dir ] ||

								// Fallback to seeking `elem` from the start
								(diff = nodeIndex = 0) || start.pop()) ) {

								// When found, cache indexes on `parent` and break
								if ( node.nodeType === 1 && ++diff && node === elem ) {
									outerCache[ type ] = [ dirruns, nodeIndex, diff ];
									break;
								}
							}

						// Use previously-cached element index if available
						} else if ( useCache && (cache = (elem[ expando ] || (elem[ expando ] = {}))[ type ]) && cache[0] === dirruns ) {
							diff = cache[1];

						// xml :nth-child(...) or :nth-last-child(...) or :nth(-last)?-of-type(...)
						} else {
							// Use the same loop as above to seek `elem` from the start
							while ( (node = ++nodeIndex && node && node[ dir ] ||
								(diff = nodeIndex = 0) || start.pop()) ) {

								if ( ( ofType ? node.nodeName.toLowerCase() === name : node.nodeType === 1 ) && ++diff ) {
									// Cache the index of each encountered element
									if ( useCache ) {
										(node[ expando ] || (node[ expando ] = {}))[ type ] = [ dirruns, diff ];
									}

									if ( node === elem ) {
										break;
									}
								}
							}
						}

						// Incorporate the offset, then check against cycle size
						diff -= last;
						return diff === first || ( diff % first === 0 && diff / first >= 0 );
					}
				};
		},

		"PSEUDO": function( pseudo, argument ) {
			// pseudo-class names are case-insensitive
			// http://www.w3.org/TR/selectors/#pseudo-classes
			// Prioritize by case sensitivity in case custom pseudos are added with uppercase letters
			// Remember that setFilters inherits from pseudos
			var args,
				fn = Expr.pseudos[ pseudo ] || Expr.setFilters[ pseudo.toLowerCase() ] ||
					Sizzle.error( "unsupported pseudo: " + pseudo );

			// The user may use createPseudo to indicate that
			// arguments are needed to create the filter function
			// just as Sizzle does
			if ( fn[ expando ] ) {
				return fn( argument );
			}

			// But maintain support for old signatures
			if ( fn.length > 1 ) {
				args = [ pseudo, pseudo, "", argument ];
				return Expr.setFilters.hasOwnProperty( pseudo.toLowerCase() ) ?
					markFunction(function( seed, matches ) {
						var idx,
							matched = fn( seed, argument ),
							i = matched.length;
						while ( i-- ) {
							idx = indexOf( seed, matched[i] );
							seed[ idx ] = !( matches[ idx ] = matched[i] );
						}
					}) :
					function( elem ) {
						return fn( elem, 0, args );
					};
			}

			return fn;
		}
	},

	pseudos: {
		// Potentially complex pseudos
		"not": markFunction(function( selector ) {
			// Trim the selector passed to compile
			// to avoid treating leading and trailing
			// spaces as combinators
			var input = [],
				results = [],
				matcher = compile( selector.replace( rtrim, "$1" ) );

			return matcher[ expando ] ?
				markFunction(function( seed, matches, context, xml ) {
					var elem,
						unmatched = matcher( seed, null, xml, [] ),
						i = seed.length;

					// Match elements unmatched by `matcher`
					while ( i-- ) {
						if ( (elem = unmatched[i]) ) {
							seed[i] = !(matches[i] = elem);
						}
					}
				}) :
				function( elem, context, xml ) {
					input[0] = elem;
					matcher( input, null, xml, results );
					// Don't keep the element (issue #299)
					input[0] = null;
					return !results.pop();
				};
		}),

		"has": markFunction(function( selector ) {
			return function( elem ) {
				return Sizzle( selector, elem ).length > 0;
			};
		}),

		"contains": markFunction(function( text ) {
			text = text.replace( runescape, funescape );
			return function( elem ) {
				return ( elem.textContent || elem.innerText || getText( elem ) ).indexOf( text ) > -1;
			};
		}),

		// "Whether an element is represented by a :lang() selector
		// is based solely on the element's language value
		// being equal to the identifier C,
		// or beginning with the identifier C immediately followed by "-".
		// The matching of C against the element's language value is performed case-insensitively.
		// The identifier C does not have to be a valid language name."
		// http://www.w3.org/TR/selectors/#lang-pseudo
		"lang": markFunction( function( lang ) {
			// lang value must be a valid identifier
			if ( !ridentifier.test(lang || "") ) {
				Sizzle.error( "unsupported lang: " + lang );
			}
			lang = lang.replace( runescape, funescape ).toLowerCase();
			return function( elem ) {
				var elemLang;
				do {
					if ( (elemLang = documentIsHTML ?
						elem.lang :
						elem.getAttribute("xml:lang") || elem.getAttribute("lang")) ) {

						elemLang = elemLang.toLowerCase();
						return elemLang === lang || elemLang.indexOf( lang + "-" ) === 0;
					}
				} while ( (elem = elem.parentNode) && elem.nodeType === 1 );
				return false;
			};
		}),

		// Miscellaneous
		"target": function( elem ) {
			var hash = window.location && window.location.hash;
			return hash && hash.slice( 1 ) === elem.id;
		},

		"root": function( elem ) {
			return elem === docElem;
		},

		"focus": function( elem ) {
			return elem === document.activeElement && (!document.hasFocus || document.hasFocus()) && !!(elem.type || elem.href || ~elem.tabIndex);
		},

		// Boolean properties
		"enabled": function( elem ) {
			return elem.disabled === false;
		},

		"disabled": function( elem ) {
			return elem.disabled === true;
		},

		"checked": function( elem ) {
			// In CSS3, :checked should return both checked and selected elements
			// http://www.w3.org/TR/2011/REC-css3-selectors-20110929/#checked
			var nodeName = elem.nodeName.toLowerCase();
			return (nodeName === "input" && !!elem.checked) || (nodeName === "option" && !!elem.selected);
		},

		"selected": function( elem ) {
			// Accessing this property makes selected-by-default
			// options in Safari work properly
			if ( elem.parentNode ) {
				elem.parentNode.selectedIndex;
			}

			return elem.selected === true;
		},

		// Contents
		"empty": function( elem ) {
			// http://www.w3.org/TR/selectors/#empty-pseudo
			// :empty is negated by element (1) or content nodes (text: 3; cdata: 4; entity ref: 5),
			//   but not by others (comment: 8; processing instruction: 7; etc.)
			// nodeType < 6 works because attributes (2) do not appear as children
			for ( elem = elem.firstChild; elem; elem = elem.nextSibling ) {
				if ( elem.nodeType < 6 ) {
					return false;
				}
			}
			return true;
		},

		"parent": function( elem ) {
			return !Expr.pseudos["empty"]( elem );
		},

		// Element/input types
		"header": function( elem ) {
			return rheader.test( elem.nodeName );
		},

		"input": function( elem ) {
			return rinputs.test( elem.nodeName );
		},

		"button": function( elem ) {
			var name = elem.nodeName.toLowerCase();
			return name === "input" && elem.type === "button" || name === "button";
		},

		"text": function( elem ) {
			var attr;
			return elem.nodeName.toLowerCase() === "input" &&
				elem.type === "text" &&

				// Support: IE<8
				// New HTML5 attribute values (e.g., "search") appear with elem.type === "text"
				( (attr = elem.getAttribute("type")) == null || attr.toLowerCase() === "text" );
		},

		// Position-in-collection
		"first": createPositionalPseudo(function() {
			return [ 0 ];
		}),

		"last": createPositionalPseudo(function( matchIndexes, length ) {
			return [ length - 1 ];
		}),

		"eq": createPositionalPseudo(function( matchIndexes, length, argument ) {
			return [ argument < 0 ? argument + length : argument ];
		}),

		"even": createPositionalPseudo(function( matchIndexes, length ) {
			var i = 0;
			for ( ; i < length; i += 2 ) {
				matchIndexes.push( i );
			}
			return matchIndexes;
		}),

		"odd": createPositionalPseudo(function( matchIndexes, length ) {
			var i = 1;
			for ( ; i < length; i += 2 ) {
				matchIndexes.push( i );
			}
			return matchIndexes;
		}),

		"lt": createPositionalPseudo(function( matchIndexes, length, argument ) {
			var i = argument < 0 ? argument + length : argument;
			for ( ; --i >= 0; ) {
				matchIndexes.push( i );
			}
			return matchIndexes;
		}),

		"gt": createPositionalPseudo(function( matchIndexes, length, argument ) {
			var i = argument < 0 ? argument + length : argument;
			for ( ; ++i < length; ) {
				matchIndexes.push( i );
			}
			return matchIndexes;
		})
	}
};

Expr.pseudos["nth"] = Expr.pseudos["eq"];

// Add button/input type pseudos
for ( i in { radio: true, checkbox: true, file: true, password: true, image: true } ) {
	Expr.pseudos[ i ] = createInputPseudo( i );
}
for ( i in { submit: true, reset: true } ) {
	Expr.pseudos[ i ] = createButtonPseudo( i );
}

// Easy API for creating new setFilters
function setFilters() {}
setFilters.prototype = Expr.filters = Expr.pseudos;
Expr.setFilters = new setFilters();

tokenize = Sizzle.tokenize = function( selector, parseOnly ) {
	var matched, match, tokens, type,
		soFar, groups, preFilters,
		cached = tokenCache[ selector + " " ];

	if ( cached ) {
		return parseOnly ? 0 : cached.slice( 0 );
	}

	soFar = selector;
	groups = [];
	preFilters = Expr.preFilter;

	while ( soFar ) {

		// Comma and first run
		if ( !matched || (match = rcomma.exec( soFar )) ) {
			if ( match ) {
				// Don't consume trailing commas as valid
				soFar = soFar.slice( match[0].length ) || soFar;
			}
			groups.push( (tokens = []) );
		}

		matched = false;

		// Combinators
		if ( (match = rcombinators.exec( soFar )) ) {
			matched = match.shift();
			tokens.push({
				value: matched,
				// Cast descendant combinators to space
				type: match[0].replace( rtrim, " " )
			});
			soFar = soFar.slice( matched.length );
		}

		// Filters
		for ( type in Expr.filter ) {
			if ( (match = matchExpr[ type ].exec( soFar )) && (!preFilters[ type ] ||
				(match = preFilters[ type ]( match ))) ) {
				matched = match.shift();
				tokens.push({
					value: matched,
					type: type,
					matches: match
				});
				soFar = soFar.slice( matched.length );
			}
		}

		if ( !matched ) {
			break;
		}
	}

	// Return the length of the invalid excess
	// if we're just parsing
	// Otherwise, throw an error or return tokens
	return parseOnly ?
		soFar.length :
		soFar ?
			Sizzle.error( selector ) :
			// Cache the tokens
			tokenCache( selector, groups ).slice( 0 );
};

function toSelector( tokens ) {
	var i = 0,
		len = tokens.length,
		selector = "";
	for ( ; i < len; i++ ) {
		selector += tokens[i].value;
	}
	return selector;
}

function addCombinator( matcher, combinator, base ) {
	var dir = combinator.dir,
		checkNonElements = base && dir === "parentNode",
		doneName = done++;

	return combinator.first ?
		// Check against closest ancestor/preceding element
		function( elem, context, xml ) {
			while ( (elem = elem[ dir ]) ) {
				if ( elem.nodeType === 1 || checkNonElements ) {
					return matcher( elem, context, xml );
				}
			}
		} :

		// Check against all ancestor/preceding elements
		function( elem, context, xml ) {
			var oldCache, outerCache,
				newCache = [ dirruns, doneName ];

			// We can't set arbitrary data on XML nodes, so they don't benefit from dir caching
			if ( xml ) {
				while ( (elem = elem[ dir ]) ) {
					if ( elem.nodeType === 1 || checkNonElements ) {
						if ( matcher( elem, context, xml ) ) {
							return true;
						}
					}
				}
			} else {
				while ( (elem = elem[ dir ]) ) {
					if ( elem.nodeType === 1 || checkNonElements ) {
						outerCache = elem[ expando ] || (elem[ expando ] = {});
						if ( (oldCache = outerCache[ dir ]) &&
							oldCache[ 0 ] === dirruns && oldCache[ 1 ] === doneName ) {

							// Assign to newCache so results back-propagate to previous elements
							return (newCache[ 2 ] = oldCache[ 2 ]);
						} else {
							// Reuse newcache so results back-propagate to previous elements
							outerCache[ dir ] = newCache;

							// A match means we're done; a fail means we have to keep checking
							if ( (newCache[ 2 ] = matcher( elem, context, xml )) ) {
								return true;
							}
						}
					}
				}
			}
		};
}

function elementMatcher( matchers ) {
	return matchers.length > 1 ?
		function( elem, context, xml ) {
			var i = matchers.length;
			while ( i-- ) {
				if ( !matchers[i]( elem, context, xml ) ) {
					return false;
				}
			}
			return true;
		} :
		matchers[0];
}

function multipleContexts( selector, contexts, results ) {
	var i = 0,
		len = contexts.length;
	for ( ; i < len; i++ ) {
		Sizzle( selector, contexts[i], results );
	}
	return results;
}

function condense( unmatched, map, filter, context, xml ) {
	var elem,
		newUnmatched = [],
		i = 0,
		len = unmatched.length,
		mapped = map != null;

	for ( ; i < len; i++ ) {
		if ( (elem = unmatched[i]) ) {
			if ( !filter || filter( elem, context, xml ) ) {
				newUnmatched.push( elem );
				if ( mapped ) {
					map.push( i );
				}
			}
		}
	}

	return newUnmatched;
}

function setMatcher( preFilter, selector, matcher, postFilter, postFinder, postSelector ) {
	if ( postFilter && !postFilter[ expando ] ) {
		postFilter = setMatcher( postFilter );
	}
	if ( postFinder && !postFinder[ expando ] ) {
		postFinder = setMatcher( postFinder, postSelector );
	}
	return markFunction(function( seed, results, context, xml ) {
		var temp, i, elem,
			preMap = [],
			postMap = [],
			preexisting = results.length,

			// Get initial elements from seed or context
			elems = seed || multipleContexts( selector || "*", context.nodeType ? [ context ] : context, [] ),

			// Prefilter to get matcher input, preserving a map for seed-results synchronization
			matcherIn = preFilter && ( seed || !selector ) ?
				condense( elems, preMap, preFilter, context, xml ) :
				elems,

			matcherOut = matcher ?
				// If we have a postFinder, or filtered seed, or non-seed postFilter or preexisting results,
				postFinder || ( seed ? preFilter : preexisting || postFilter ) ?

					// ...intermediate processing is necessary
					[] :

					// ...otherwise use results directly
					results :
				matcherIn;

		// Find primary matches
		if ( matcher ) {
			matcher( matcherIn, matcherOut, context, xml );
		}

		// Apply postFilter
		if ( postFilter ) {
			temp = condense( matcherOut, postMap );
			postFilter( temp, [], context, xml );

			// Un-match failing elements by moving them back to matcherIn
			i = temp.length;
			while ( i-- ) {
				if ( (elem = temp[i]) ) {
					matcherOut[ postMap[i] ] = !(matcherIn[ postMap[i] ] = elem);
				}
			}
		}

		if ( seed ) {
			if ( postFinder || preFilter ) {
				if ( postFinder ) {
					// Get the final matcherOut by condensing this intermediate into postFinder contexts
					temp = [];
					i = matcherOut.length;
					while ( i-- ) {
						if ( (elem = matcherOut[i]) ) {
							// Restore matcherIn since elem is not yet a final match
							temp.push( (matcherIn[i] = elem) );
						}
					}
					postFinder( null, (matcherOut = []), temp, xml );
				}

				// Move matched elements from seed to results to keep them synchronized
				i = matcherOut.length;
				while ( i-- ) {
					if ( (elem = matcherOut[i]) &&
						(temp = postFinder ? indexOf( seed, elem ) : preMap[i]) > -1 ) {

						seed[temp] = !(results[temp] = elem);
					}
				}
			}

		// Add elements to results, through postFinder if defined
		} else {
			matcherOut = condense(
				matcherOut === results ?
					matcherOut.splice( preexisting, matcherOut.length ) :
					matcherOut
			);
			if ( postFinder ) {
				postFinder( null, results, matcherOut, xml );
			} else {
				push.apply( results, matcherOut );
			}
		}
	});
}

function matcherFromTokens( tokens ) {
	var checkContext, matcher, j,
		len = tokens.length,
		leadingRelative = Expr.relative[ tokens[0].type ],
		implicitRelative = leadingRelative || Expr.relative[" "],
		i = leadingRelative ? 1 : 0,

		// The foundational matcher ensures that elements are reachable from top-level context(s)
		matchContext = addCombinator( function( elem ) {
			return elem === checkContext;
		}, implicitRelative, true ),
		matchAnyContext = addCombinator( function( elem ) {
			return indexOf( checkContext, elem ) > -1;
		}, implicitRelative, true ),
		matchers = [ function( elem, context, xml ) {
			var ret = ( !leadingRelative && ( xml || context !== outermostContext ) ) || (
				(checkContext = context).nodeType ?
					matchContext( elem, context, xml ) :
					matchAnyContext( elem, context, xml ) );
			// Avoid hanging onto element (issue #299)
			checkContext = null;
			return ret;
		} ];

	for ( ; i < len; i++ ) {
		if ( (matcher = Expr.relative[ tokens[i].type ]) ) {
			matchers = [ addCombinator(elementMatcher( matchers ), matcher) ];
		} else {
			matcher = Expr.filter[ tokens[i].type ].apply( null, tokens[i].matches );

			// Return special upon seeing a positional matcher
			if ( matcher[ expando ] ) {
				// Find the next relative operator (if any) for proper handling
				j = ++i;
				for ( ; j < len; j++ ) {
					if ( Expr.relative[ tokens[j].type ] ) {
						break;
					}
				}
				return setMatcher(
					i > 1 && elementMatcher( matchers ),
					i > 1 && toSelector(
						// If the preceding token was a descendant combinator, insert an implicit any-element `*`
						tokens.slice( 0, i - 1 ).concat({ value: tokens[ i - 2 ].type === " " ? "*" : "" })
					).replace( rtrim, "$1" ),
					matcher,
					i < j && matcherFromTokens( tokens.slice( i, j ) ),
					j < len && matcherFromTokens( (tokens = tokens.slice( j )) ),
					j < len && toSelector( tokens )
				);
			}
			matchers.push( matcher );
		}
	}

	return elementMatcher( matchers );
}

function matcherFromGroupMatchers( elementMatchers, setMatchers ) {
	var bySet = setMatchers.length > 0,
		byElement = elementMatchers.length > 0,
		superMatcher = function( seed, context, xml, results, outermost ) {
			var elem, j, matcher,
				matchedCount = 0,
				i = "0",
				unmatched = seed && [],
				setMatched = [],
				contextBackup = outermostContext,
				// We must always have either seed elements or outermost context
				elems = seed || byElement && Expr.find["TAG"]( "*", outermost ),
				// Use integer dirruns iff this is the outermost matcher
				dirrunsUnique = (dirruns += contextBackup == null ? 1 : Math.random() || 0.1),
				len = elems.length;

			if ( outermost ) {
				outermostContext = context !== document && context;
			}

			// Add elements passing elementMatchers directly to results
			// Keep `i` a string if there are no elements so `matchedCount` will be "00" below
			// Support: IE<9, Safari
			// Tolerate NodeList properties (IE: "length"; Safari: <number>) matching elements by id
			for ( ; i !== len && (elem = elems[i]) != null; i++ ) {
				if ( byElement && elem ) {
					j = 0;
					while ( (matcher = elementMatchers[j++]) ) {
						if ( matcher( elem, context, xml ) ) {
							results.push( elem );
							break;
						}
					}
					if ( outermost ) {
						dirruns = dirrunsUnique;
					}
				}

				// Track unmatched elements for set filters
				if ( bySet ) {
					// They will have gone through all possible matchers
					if ( (elem = !matcher && elem) ) {
						matchedCount--;
					}

					// Lengthen the array for every element, matched or not
					if ( seed ) {
						unmatched.push( elem );
					}
				}
			}

			// Apply set filters to unmatched elements
			matchedCount += i;
			if ( bySet && i !== matchedCount ) {
				j = 0;
				while ( (matcher = setMatchers[j++]) ) {
					matcher( unmatched, setMatched, context, xml );
				}

				if ( seed ) {
					// Reintegrate element matches to eliminate the need for sorting
					if ( matchedCount > 0 ) {
						while ( i-- ) {
							if ( !(unmatched[i] || setMatched[i]) ) {
								setMatched[i] = pop.call( results );
							}
						}
					}

					// Discard index placeholder values to get only actual matches
					setMatched = condense( setMatched );
				}

				// Add matches to results
				push.apply( results, setMatched );

				// Seedless set matches succeeding multiple successful matchers stipulate sorting
				if ( outermost && !seed && setMatched.length > 0 &&
					( matchedCount + setMatchers.length ) > 1 ) {

					Sizzle.uniqueSort( results );
				}
			}

			// Override manipulation of globals by nested matchers
			if ( outermost ) {
				dirruns = dirrunsUnique;
				outermostContext = contextBackup;
			}

			return unmatched;
		};

	return bySet ?
		markFunction( superMatcher ) :
		superMatcher;
}

compile = Sizzle.compile = function( selector, match /* Internal Use Only */ ) {
	var i,
		setMatchers = [],
		elementMatchers = [],
		cached = compilerCache[ selector + " " ];

	if ( !cached ) {
		// Generate a function of recursive functions that can be used to check each element
		if ( !match ) {
			match = tokenize( selector );
		}
		i = match.length;
		while ( i-- ) {
			cached = matcherFromTokens( match[i] );
			if ( cached[ expando ] ) {
				setMatchers.push( cached );
			} else {
				elementMatchers.push( cached );
			}
		}

		// Cache the compiled function
		cached = compilerCache( selector, matcherFromGroupMatchers( elementMatchers, setMatchers ) );

		// Save selector and tokenization
		cached.selector = selector;
	}
	return cached;
};

/**
 * A low-level selection function that works with Sizzle's compiled
 *  selector functions
 * @param {String|Function} selector A selector or a pre-compiled
 *  selector function built with Sizzle.compile
 * @param {Element} context
 * @param {Array} [results]
 * @param {Array} [seed] A set of elements to match against
 */
select = Sizzle.select = function( selector, context, results, seed ) {
	var i, tokens, token, type, find,
		compiled = typeof selector === "function" && selector,
		match = !seed && tokenize( (selector = compiled.selector || selector) );

	results = results || [];

	// Try to minimize operations if there is no seed and only one group
	if ( match.length === 1 ) {

		// Take a shortcut and set the context if the root selector is an ID
		tokens = match[0] = match[0].slice( 0 );
		if ( tokens.length > 2 && (token = tokens[0]).type === "ID" &&
				support.getById && context.nodeType === 9 && documentIsHTML &&
				Expr.relative[ tokens[1].type ] ) {

			context = ( Expr.find["ID"]( token.matches[0].replace(runescape, funescape), context ) || [] )[0];
			if ( !context ) {
				return results;

			// Precompiled matchers will still verify ancestry, so step up a level
			} else if ( compiled ) {
				context = context.parentNode;
			}

			selector = selector.slice( tokens.shift().value.length );
		}

		// Fetch a seed set for right-to-left matching
		i = matchExpr["needsContext"].test( selector ) ? 0 : tokens.length;
		while ( i-- ) {
			token = tokens[i];

			// Abort if we hit a combinator
			if ( Expr.relative[ (type = token.type) ] ) {
				break;
			}
			if ( (find = Expr.find[ type ]) ) {
				// Search, expanding context for leading sibling combinators
				if ( (seed = find(
					token.matches[0].replace( runescape, funescape ),
					rsibling.test( tokens[0].type ) && testContext( context.parentNode ) || context
				)) ) {

					// If seed is empty or no tokens remain, we can return early
					tokens.splice( i, 1 );
					selector = seed.length && toSelector( tokens );
					if ( !selector ) {
						push.apply( results, seed );
						return results;
					}

					break;
				}
			}
		}
	}

	// Compile and execute a filtering function if one is not provided
	// Provide `match` to avoid retokenization if we modified the selector above
	( compiled || compile( selector, match ) )(
		seed,
		context,
		!documentIsHTML,
		results,
		rsibling.test( selector ) && testContext( context.parentNode ) || context
	);
	return results;
};

// One-time assignments

// Sort stability
support.sortStable = expando.split("").sort( sortOrder ).join("") === expando;

// Support: Chrome 14-35+
// Always assume duplicates if they aren't passed to the comparison function
support.detectDuplicates = !!hasDuplicate;

// Initialize against the default document
setDocument();

// Support: Webkit<537.32 - Safari 6.0.3/Chrome 25 (fixed in Chrome 27)
// Detached nodes confoundingly follow *each other*
support.sortDetached = assert(function( div1 ) {
	// Should return 1, but returns 4 (following)
	return div1.compareDocumentPosition( document.createElement("div") ) & 1;
});

// Support: IE<8
// Prevent attribute/property "interpolation"
// http://msdn.microsoft.com/en-us/library/ms536429%28VS.85%29.aspx
if ( !assert(function( div ) {
	div.innerHTML = "<a href='#'></a>";
	return div.firstChild.getAttribute("href") === "#" ;
}) ) {
	addHandle( "type|href|height|width", function( elem, name, isXML ) {
		if ( !isXML ) {
			return elem.getAttribute( name, name.toLowerCase() === "type" ? 1 : 2 );
		}
	});
}

// Support: IE<9
// Use defaultValue in place of getAttribute("value")
if ( !support.attributes || !assert(function( div ) {
	div.innerHTML = "<input/>";
	div.firstChild.setAttribute( "value", "" );
	return div.firstChild.getAttribute( "value" ) === "";
}) ) {
	addHandle( "value", function( elem, name, isXML ) {
		if ( !isXML && elem.nodeName.toLowerCase() === "input" ) {
			return elem.defaultValue;
		}
	});
}

// Support: IE<9
// Use getAttributeNode to fetch booleans when getAttribute lies
if ( !assert(function( div ) {
	return div.getAttribute("disabled") == null;
}) ) {
	addHandle( booleans, function( elem, name, isXML ) {
		var val;
		if ( !isXML ) {
			return elem[ name ] === true ? name.toLowerCase() :
					(val = elem.getAttributeNode( name )) && val.specified ?
					val.value :
				null;
		}
	});
}

return Sizzle;

})( window );



jQuery.find = Sizzle;
jQuery.expr = Sizzle.selectors;
jQuery.expr[":"] = jQuery.expr.pseudos;
jQuery.unique = Sizzle.uniqueSort;
jQuery.text = Sizzle.getText;
jQuery.isXMLDoc = Sizzle.isXML;
jQuery.contains = Sizzle.contains;



var rneedsContext = jQuery.expr.match.needsContext;

var rsingleTag = (/^<(\w+)\s*\/?>(?:<\/\1>|)$/);



var risSimple = /^.[^:#\[\.,]*$/;

// Implement the identical functionality for filter and not
function winnow( elements, qualifier, not ) {
	if ( jQuery.isFunction( qualifier ) ) {
		return jQuery.grep( elements, function( elem, i ) {
			/* jshint -W018 */
			return !!qualifier.call( elem, i, elem ) !== not;
		});

	}

	if ( qualifier.nodeType ) {
		return jQuery.grep( elements, function( elem ) {
			return ( elem === qualifier ) !== not;
		});

	}

	if ( typeof qualifier === "string" ) {
		if ( risSimple.test( qualifier ) ) {
			return jQuery.filter( qualifier, elements, not );
		}

		qualifier = jQuery.filter( qualifier, elements );
	}

	return jQuery.grep( elements, function( elem ) {
		return ( indexOf.call( qualifier, elem ) >= 0 ) !== not;
	});
}

jQuery.filter = function( expr, elems, not ) {
	var elem = elems[ 0 ];

	if ( not ) {
		expr = ":not(" + expr + ")";
	}

	return elems.length === 1 && elem.nodeType === 1 ?
		jQuery.find.matchesSelector( elem, expr ) ? [ elem ] : [] :
		jQuery.find.matches( expr, jQuery.grep( elems, function( elem ) {
			return elem.nodeType === 1;
		}));
};

jQuery.fn.extend({
	find: function( selector ) {
		var i,
			len = this.length,
			ret = [],
			self = this;

		if ( typeof selector !== "string" ) {
			return this.pushStack( jQuery( selector ).filter(function() {
				for ( i = 0; i < len; i++ ) {
					if ( jQuery.contains( self[ i ], this ) ) {
						return true;
					}
				}
			}) );
		}

		for ( i = 0; i < len; i++ ) {
			jQuery.find( selector, self[ i ], ret );
		}

		// Needed because $( selector, context ) becomes $( context ).find( selector )
		ret = this.pushStack( len > 1 ? jQuery.unique( ret ) : ret );
		ret.selector = this.selector ? this.selector + " " + selector : selector;
		return ret;
	},
	filter: function( selector ) {
		return this.pushStack( winnow(this, selector || [], false) );
	},
	not: function( selector ) {
		return this.pushStack( winnow(this, selector || [], true) );
	},
	is: function( selector ) {
		return !!winnow(
			this,

			// If this is a positional/relative selector, check membership in the returned set
			// so $("p:first").is("p:last") won't return true for a doc with two "p".
			typeof selector === "string" && rneedsContext.test( selector ) ?
				jQuery( selector ) :
				selector || [],
			false
		).length;
	}
});


// Initialize a jQuery object


// A central reference to the root jQuery(document)
var rootjQuery,

	// A simple way to check for HTML strings
	// Prioritize #id over <tag> to avoid XSS via location.hash (#9521)
	// Strict HTML recognition (#11290: must start with <)
	rquickExpr = /^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/,

	init = jQuery.fn.init = function( selector, context ) {
		var match, elem;

		// HANDLE: $(""), $(null), $(undefined), $(false)
		if ( !selector ) {
			return this;
		}

		// Handle HTML strings
		if ( typeof selector === "string" ) {
			if ( selector[0] === "<" && selector[ selector.length - 1 ] === ">" && selector.length >= 3 ) {
				// Assume that strings that start and end with <> are HTML and skip the regex check
				match = [ null, selector, null ];

			} else {
				match = rquickExpr.exec( selector );
			}

			// Match html or make sure no context is specified for #id
			if ( match && (match[1] || !context) ) {

				// HANDLE: $(html) -> $(array)
				if ( match[1] ) {
					context = context instanceof jQuery ? context[0] : context;

					// Option to run scripts is true for back-compat
					// Intentionally let the error be thrown if parseHTML is not present
					jQuery.merge( this, jQuery.parseHTML(
						match[1],
						context && context.nodeType ? context.ownerDocument || context : document,
						true
					) );

					// HANDLE: $(html, props)
					if ( rsingleTag.test( match[1] ) && jQuery.isPlainObject( context ) ) {
						for ( match in context ) {
							// Properties of context are called as methods if possible
							if ( jQuery.isFunction( this[ match ] ) ) {
								this[ match ]( context[ match ] );

							// ...and otherwise set as attributes
							} else {
								this.attr( match, context[ match ] );
							}
						}
					}

					return this;

				// HANDLE: $(#id)
				} else {
					elem = document.getElementById( match[2] );

					// Support: Blackberry 4.6
					// gEBID returns nodes no longer in the document (#6963)
					if ( elem && elem.parentNode ) {
						// Inject the element directly into the jQuery object
						this.length = 1;
						this[0] = elem;
					}

					this.context = document;
					this.selector = selector;
					return this;
				}

			// HANDLE: $(expr, $(...))
			} else if ( !context || context.jquery ) {
				return ( context || rootjQuery ).find( selector );

			// HANDLE: $(expr, context)
			// (which is just equivalent to: $(context).find(expr)
			} else {
				return this.constructor( context ).find( selector );
			}

		// HANDLE: $(DOMElement)
		} else if ( selector.nodeType ) {
			this.context = this[0] = selector;
			this.length = 1;
			return this;

		// HANDLE: $(function)
		// Shortcut for document ready
		} else if ( jQuery.isFunction( selector ) ) {
			return typeof rootjQuery.ready !== "undefined" ?
				rootjQuery.ready( selector ) :
				// Execute immediately if ready is not present
				selector( jQuery );
		}

		if ( selector.selector !== undefined ) {
			this.selector = selector.selector;
			this.context = selector.context;
		}

		return jQuery.makeArray( selector, this );
	};

// Give the init function the jQuery prototype for later instantiation
init.prototype = jQuery.fn;

// Initialize central reference
rootjQuery = jQuery( document );


var rparentsprev = /^(?:parents|prev(?:Until|All))/,
	// Methods guaranteed to produce a unique set when starting from a unique set
	guaranteedUnique = {
		children: true,
		contents: true,
		next: true,
		prev: true
	};

jQuery.extend({
	dir: function( elem, dir, until ) {
		var matched = [],
			truncate = until !== undefined;

		while ( (elem = elem[ dir ]) && elem.nodeType !== 9 ) {
			if ( elem.nodeType === 1 ) {
				if ( truncate && jQuery( elem ).is( until ) ) {
					break;
				}
				matched.push( elem );
			}
		}
		return matched;
	},

	sibling: function( n, elem ) {
		var matched = [];

		for ( ; n; n = n.nextSibling ) {
			if ( n.nodeType === 1 && n !== elem ) {
				matched.push( n );
			}
		}

		return matched;
	}
});

jQuery.fn.extend({
	has: function( target ) {
		var targets = jQuery( target, this ),
			l = targets.length;

		return this.filter(function() {
			var i = 0;
			for ( ; i < l; i++ ) {
				if ( jQuery.contains( this, targets[i] ) ) {
					return true;
				}
			}
		});
	},

	closest: function( selectors, context ) {
		var cur,
			i = 0,
			l = this.length,
			matched = [],
			pos = rneedsContext.test( selectors ) || typeof selectors !== "string" ?
				jQuery( selectors, context || this.context ) :
				0;

		for ( ; i < l; i++ ) {
			for ( cur = this[i]; cur && cur !== context; cur = cur.parentNode ) {
				// Always skip document fragments
				if ( cur.nodeType < 11 && (pos ?
					pos.index(cur) > -1 :

					// Don't pass non-elements to Sizzle
					cur.nodeType === 1 &&
						jQuery.find.matchesSelector(cur, selectors)) ) {

					matched.push( cur );
					break;
				}
			}
		}

		return this.pushStack( matched.length > 1 ? jQuery.unique( matched ) : matched );
	},

	// Determine the position of an element within the set
	index: function( elem ) {

		// No argument, return index in parent
		if ( !elem ) {
			return ( this[ 0 ] && this[ 0 ].parentNode ) ? this.first().prevAll().length : -1;
		}

		// Index in selector
		if ( typeof elem === "string" ) {
			return indexOf.call( jQuery( elem ), this[ 0 ] );
		}

		// Locate the position of the desired element
		return indexOf.call( this,

			// If it receives a jQuery object, the first element is used
			elem.jquery ? elem[ 0 ] : elem
		);
	},

	add: function( selector, context ) {
		return this.pushStack(
			jQuery.unique(
				jQuery.merge( this.get(), jQuery( selector, context ) )
			)
		);
	},

	addBack: function( selector ) {
		return this.add( selector == null ?
			this.prevObject : this.prevObject.filter(selector)
		);
	}
});

function sibling( cur, dir ) {
	while ( (cur = cur[dir]) && cur.nodeType !== 1 ) {}
	return cur;
}

jQuery.each({
	parent: function( elem ) {
		var parent = elem.parentNode;
		return parent && parent.nodeType !== 11 ? parent : null;
	},
	parents: function( elem ) {
		return jQuery.dir( elem, "parentNode" );
	},
	parentsUntil: function( elem, i, until ) {
		return jQuery.dir( elem, "parentNode", until );
	},
	next: function( elem ) {
		return sibling( elem, "nextSibling" );
	},
	prev: function( elem ) {
		return sibling( elem, "previousSibling" );
	},
	nextAll: function( elem ) {
		return jQuery.dir( elem, "nextSibling" );
	},
	prevAll: function( elem ) {
		return jQuery.dir( elem, "previousSibling" );
	},
	nextUntil: function( elem, i, until ) {
		return jQuery.dir( elem, "nextSibling", until );
	},
	prevUntil: function( elem, i, until ) {
		return jQuery.dir( elem, "previousSibling", until );
	},
	siblings: function( elem ) {
		return jQuery.sibling( ( elem.parentNode || {} ).firstChild, elem );
	},
	children: function( elem ) {
		return jQuery.sibling( elem.firstChild );
	},
	contents: function( elem ) {
		return elem.contentDocument || jQuery.merge( [], elem.childNodes );
	}
}, function( name, fn ) {
	jQuery.fn[ name ] = function( until, selector ) {
		var matched = jQuery.map( this, fn, until );

		if ( name.slice( -5 ) !== "Until" ) {
			selector = until;
		}

		if ( selector && typeof selector === "string" ) {
			matched = jQuery.filter( selector, matched );
		}

		if ( this.length > 1 ) {
			// Remove duplicates
			if ( !guaranteedUnique[ name ] ) {
				jQuery.unique( matched );
			}

			// Reverse order for parents* and prev-derivatives
			if ( rparentsprev.test( name ) ) {
				matched.reverse();
			}
		}

		return this.pushStack( matched );
	};
});
var rnotwhite = (/\S+/g);



// String to Object options format cache
var optionsCache = {};

// Convert String-formatted options into Object-formatted ones and store in cache
function createOptions( options ) {
	var object = optionsCache[ options ] = {};
	jQuery.each( options.match( rnotwhite ) || [], function( _, flag ) {
		object[ flag ] = true;
	});
	return object;
}

/*
 * Create a callback list using the following parameters:
 *
 *	options: an optional list of space-separated options that will change how
 *			the callback list behaves or a more traditional option object
 *
 * By default a callback list will act like an event callback list and can be
 * "fired" multiple times.
 *
 * Possible options:
 *
 *	once:			will ensure the callback list can only be fired once (like a Deferred)
 *
 *	memory:			will keep track of previous values and will call any callback added
 *					after the list has been fired right away with the latest "memorized"
 *					values (like a Deferred)
 *
 *	unique:			will ensure a callback can only be added once (no duplicate in the list)
 *
 *	stopOnFalse:	interrupt callings when a callback returns false
 *
 */
jQuery.Callbacks = function( options ) {

	// Convert options from String-formatted to Object-formatted if needed
	// (we check in cache first)
	options = typeof options === "string" ?
		( optionsCache[ options ] || createOptions( options ) ) :
		jQuery.extend( {}, options );

	var // Last fire value (for non-forgettable lists)
		memory,
		// Flag to know if list was already fired
		fired,
		// Flag to know if list is currently firing
		firing,
		// First callback to fire (used internally by add and fireWith)
		firingStart,
		// End of the loop when firing
		firingLength,
		// Index of currently firing callback (modified by remove if needed)
		firingIndex,
		// Actual callback list
		list = [],
		// Stack of fire calls for repeatable lists
		stack = !options.once && [],
		// Fire callbacks
		fire = function( data ) {
			memory = options.memory && data;
			fired = true;
			firingIndex = firingStart || 0;
			firingStart = 0;
			firingLength = list.length;
			firing = true;
			for ( ; list && firingIndex < firingLength; firingIndex++ ) {
				if ( list[ firingIndex ].apply( data[ 0 ], data[ 1 ] ) === false && options.stopOnFalse ) {
					memory = false; // To prevent further calls using add
					break;
				}
			}
			firing = false;
			if ( list ) {
				if ( stack ) {
					if ( stack.length ) {
						fire( stack.shift() );
					}
				} else if ( memory ) {
					list = [];
				} else {
					self.disable();
				}
			}
		},
		// Actual Callbacks object
		self = {
			// Add a callback or a collection of callbacks to the list
			add: function() {
				if ( list ) {
					// First, we save the current length
					var start = list.length;
					(function add( args ) {
						jQuery.each( args, function( _, arg ) {
							var type = jQuery.type( arg );
							if ( type === "function" ) {
								if ( !options.unique || !self.has( arg ) ) {
									list.push( arg );
								}
							} else if ( arg && arg.length && type !== "string" ) {
								// Inspect recursively
								add( arg );
							}
						});
					})( arguments );
					// Do we need to add the callbacks to the
					// current firing batch?
					if ( firing ) {
						firingLength = list.length;
					// With memory, if we're not firing then
					// we should call right away
					} else if ( memory ) {
						firingStart = start;
						fire( memory );
					}
				}
				return this;
			},
			// Remove a callback from the list
			remove: function() {
				if ( list ) {
					jQuery.each( arguments, function( _, arg ) {
						var index;
						while ( ( index = jQuery.inArray( arg, list, index ) ) > -1 ) {
							list.splice( index, 1 );
							// Handle firing indexes
							if ( firing ) {
								if ( index <= firingLength ) {
									firingLength--;
								}
								if ( index <= firingIndex ) {
									firingIndex--;
								}
							}
						}
					});
				}
				return this;
			},
			// Check if a given callback is in the list.
			// If no argument is given, return whether or not list has callbacks attached.
			has: function( fn ) {
				return fn ? jQuery.inArray( fn, list ) > -1 : !!( list && list.length );
			},
			// Remove all callbacks from the list
			empty: function() {
				list = [];
				firingLength = 0;
				return this;
			},
			// Have the list do nothing anymore
			disable: function() {
				list = stack = memory = undefined;
				return this;
			},
			// Is it disabled?
			disabled: function() {
				return !list;
			},
			// Lock the list in its current state
			lock: function() {
				stack = undefined;
				if ( !memory ) {
					self.disable();
				}
				return this;
			},
			// Is it locked?
			locked: function() {
				return !stack;
			},
			// Call all callbacks with the given context and arguments
			fireWith: function( context, args ) {
				if ( list && ( !fired || stack ) ) {
					args = args || [];
					args = [ context, args.slice ? args.slice() : args ];
					if ( firing ) {
						stack.push( args );
					} else {
						fire( args );
					}
				}
				return this;
			},
			// Call all the callbacks with the given arguments
			fire: function() {
				self.fireWith( this, arguments );
				return this;
			},
			// To know if the callbacks have already been called at least once
			fired: function() {
				return !!fired;
			}
		};

	return self;
};


jQuery.extend({

	Deferred: function( func ) {
		var tuples = [
				// action, add listener, listener list, final state
				[ "resolve", "done", jQuery.Callbacks("once memory"), "resolved" ],
				[ "reject", "fail", jQuery.Callbacks("once memory"), "rejected" ],
				[ "notify", "progress", jQuery.Callbacks("memory") ]
			],
			state = "pending",
			promise = {
				state: function() {
					return state;
				},
				always: function() {
					deferred.done( arguments ).fail( arguments );
					return this;
				},
				then: function( /* fnDone, fnFail, fnProgress */ ) {
					var fns = arguments;
					return jQuery.Deferred(function( newDefer ) {
						jQuery.each( tuples, function( i, tuple ) {
							var fn = jQuery.isFunction( fns[ i ] ) && fns[ i ];
							// deferred[ done | fail | progress ] for forwarding actions to newDefer
							deferred[ tuple[1] ](function() {
								var returned = fn && fn.apply( this, arguments );
								if ( returned && jQuery.isFunction( returned.promise ) ) {
									returned.promise()
										.done( newDefer.resolve )
										.fail( newDefer.reject )
										.progress( newDefer.notify );
								} else {
									newDefer[ tuple[ 0 ] + "With" ]( this === promise ? newDefer.promise() : this, fn ? [ returned ] : arguments );
								}
							});
						});
						fns = null;
					}).promise();
				},
				// Get a promise for this deferred
				// If obj is provided, the promise aspect is added to the object
				promise: function( obj ) {
					return obj != null ? jQuery.extend( obj, promise ) : promise;
				}
			},
			deferred = {};

		// Keep pipe for back-compat
		promise.pipe = promise.then;

		// Add list-specific methods
		jQuery.each( tuples, function( i, tuple ) {
			var list = tuple[ 2 ],
				stateString = tuple[ 3 ];

			// promise[ done | fail | progress ] = list.add
			promise[ tuple[1] ] = list.add;

			// Handle state
			if ( stateString ) {
				list.add(function() {
					// state = [ resolved | rejected ]
					state = stateString;

				// [ reject_list | resolve_list ].disable; progress_list.lock
				}, tuples[ i ^ 1 ][ 2 ].disable, tuples[ 2 ][ 2 ].lock );
			}

			// deferred[ resolve | reject | notify ]
			deferred[ tuple[0] ] = function() {
				deferred[ tuple[0] + "With" ]( this === deferred ? promise : this, arguments );
				return this;
			};
			deferred[ tuple[0] + "With" ] = list.fireWith;
		});

		// Make the deferred a promise
		promise.promise( deferred );

		// Call given func if any
		if ( func ) {
			func.call( deferred, deferred );
		}

		// All done!
		return deferred;
	},

	// Deferred helper
	when: function( subordinate /* , ..., subordinateN */ ) {
		var i = 0,
			resolveValues = slice.call( arguments ),
			length = resolveValues.length,

			// the count of uncompleted subordinates
			remaining = length !== 1 || ( subordinate && jQuery.isFunction( subordinate.promise ) ) ? length : 0,

			// the master Deferred. If resolveValues consist of only a single Deferred, just use that.
			deferred = remaining === 1 ? subordinate : jQuery.Deferred(),

			// Update function for both resolve and progress values
			updateFunc = function( i, contexts, values ) {
				return function( value ) {
					contexts[ i ] = this;
					values[ i ] = arguments.length > 1 ? slice.call( arguments ) : value;
					if ( values === progressValues ) {
						deferred.notifyWith( contexts, values );
					} else if ( !( --remaining ) ) {
						deferred.resolveWith( contexts, values );
					}
				};
			},

			progressValues, progressContexts, resolveContexts;

		// Add listeners to Deferred subordinates; treat others as resolved
		if ( length > 1 ) {
			progressValues = new Array( length );
			progressContexts = new Array( length );
			resolveContexts = new Array( length );
			for ( ; i < length; i++ ) {
				if ( resolveValues[ i ] && jQuery.isFunction( resolveValues[ i ].promise ) ) {
					resolveValues[ i ].promise()
						.done( updateFunc( i, resolveContexts, resolveValues ) )
						.fail( deferred.reject )
						.progress( updateFunc( i, progressContexts, progressValues ) );
				} else {
					--remaining;
				}
			}
		}

		// If we're not waiting on anything, resolve the master
		if ( !remaining ) {
			deferred.resolveWith( resolveContexts, resolveValues );
		}

		return deferred.promise();
	}
});


// The deferred used on DOM ready
var readyList;

jQuery.fn.ready = function( fn ) {
	// Add the callback
	jQuery.ready.promise().done( fn );

	return this;
};

jQuery.extend({
	// Is the DOM ready to be used? Set to true once it occurs.
	isReady: false,

	// A counter to track how many items to wait for before
	// the ready event fires. See #6781
	readyWait: 1,

	// Hold (or release) the ready event
	holdReady: function( hold ) {
		if ( hold ) {
			jQuery.readyWait++;
		} else {
			jQuery.ready( true );
		}
	},

	// Handle when the DOM is ready
	ready: function( wait ) {

		// Abort if there are pending holds or we're already ready
		if ( wait === true ? --jQuery.readyWait : jQuery.isReady ) {
			return;
		}

		// Remember that the DOM is ready
		jQuery.isReady = true;

		// If a normal DOM Ready event fired, decrement, and wait if need be
		if ( wait !== true && --jQuery.readyWait > 0 ) {
			return;
		}

		// If there are functions bound, to execute
		readyList.resolveWith( document, [ jQuery ] );

		// Trigger any bound ready events
		if ( jQuery.fn.triggerHandler ) {
			jQuery( document ).triggerHandler( "ready" );
			jQuery( document ).off( "ready" );
		}
	}
});

/**
 * The ready event handler and self cleanup method
 */
function completed() {
	document.removeEventListener( "DOMContentLoaded", completed, false );
	window.removeEventListener( "load", completed, false );
	jQuery.ready();
}

jQuery.ready.promise = function( obj ) {
	if ( !readyList ) {

		readyList = jQuery.Deferred();

		// Catch cases where $(document).ready() is called after the browser event has already occurred.
		// We once tried to use readyState "interactive" here, but it caused issues like the one
		// discovered by ChrisS here: http://bugs.jquery.com/ticket/12282#comment:15
		if ( document.readyState === "complete" ) {
			// Handle it asynchronously to allow scripts the opportunity to delay ready
			setTimeout( jQuery.ready );

		} else {

			// Use the handy event callback
			document.addEventListener( "DOMContentLoaded", completed, false );

			// A fallback to window.onload, that will always work
			window.addEventListener( "load", completed, false );
		}
	}
	return readyList.promise( obj );
};

// Kick off the DOM ready check even if the user does not
jQuery.ready.promise();




// Multifunctional method to get and set values of a collection
// The value/s can optionally be executed if it's a function
var access = jQuery.access = function( elems, fn, key, value, chainable, emptyGet, raw ) {
	var i = 0,
		len = elems.length,
		bulk = key == null;

	// Sets many values
	if ( jQuery.type( key ) === "object" ) {
		chainable = true;
		for ( i in key ) {
			jQuery.access( elems, fn, i, key[i], true, emptyGet, raw );
		}

	// Sets one value
	} else if ( value !== undefined ) {
		chainable = true;

		if ( !jQuery.isFunction( value ) ) {
			raw = true;
		}

		if ( bulk ) {
			// Bulk operations run against the entire set
			if ( raw ) {
				fn.call( elems, value );
				fn = null;

			// ...except when executing function values
			} else {
				bulk = fn;
				fn = function( elem, key, value ) {
					return bulk.call( jQuery( elem ), value );
				};
			}
		}

		if ( fn ) {
			for ( ; i < len; i++ ) {
				fn( elems[i], key, raw ? value : value.call( elems[i], i, fn( elems[i], key ) ) );
			}
		}
	}

	return chainable ?
		elems :

		// Gets
		bulk ?
			fn.call( elems ) :
			len ? fn( elems[0], key ) : emptyGet;
};


/**
 * Determines whether an object can have data
 */
jQuery.acceptData = function( owner ) {
	// Accepts only:
	//  - Node
	//    - Node.ELEMENT_NODE
	//    - Node.DOCUMENT_NODE
	//  - Object
	//    - Any
	/* jshint -W018 */
	return owner.nodeType === 1 || owner.nodeType === 9 || !( +owner.nodeType );
};


function Data() {
	// Support: Android<4,
	// Old WebKit does not have Object.preventExtensions/freeze method,
	// return new empty object instead with no [[set]] accessor
	Object.defineProperty( this.cache = {}, 0, {
		get: function() {
			return {};
		}
	});

	this.expando = jQuery.expando + Data.uid++;
}

Data.uid = 1;
Data.accepts = jQuery.acceptData;

Data.prototype = {
	key: function( owner ) {
		// We can accept data for non-element nodes in modern browsers,
		// but we should not, see #8335.
		// Always return the key for a frozen object.
		if ( !Data.accepts( owner ) ) {
			return 0;
		}

		var descriptor = {},
			// Check if the owner object already has a cache key
			unlock = owner[ this.expando ];

		// If not, create one
		if ( !unlock ) {
			unlock = Data.uid++;

			// Secure it in a non-enumerable, non-writable property
			try {
				descriptor[ this.expando ] = { value: unlock };
				Object.defineProperties( owner, descriptor );

			// Support: Android<4
			// Fallback to a less secure definition
			} catch ( e ) {
				descriptor[ this.expando ] = unlock;
				jQuery.extend( owner, descriptor );
			}
		}

		// Ensure the cache object
		if ( !this.cache[ unlock ] ) {
			this.cache[ unlock ] = {};
		}

		return unlock;
	},
	set: function( owner, data, value ) {
		var prop,
			// There may be an unlock assigned to this node,
			// if there is no entry for this "owner", create one inline
			// and set the unlock as though an owner entry had always existed
			unlock = this.key( owner ),
			cache = this.cache[ unlock ];

		// Handle: [ owner, key, value ] args
		if ( typeof data === "string" ) {
			cache[ data ] = value;

		// Handle: [ owner, { properties } ] args
		} else {
			// Fresh assignments by object are shallow copied
			if ( jQuery.isEmptyObject( cache ) ) {
				jQuery.extend( this.cache[ unlock ], data );
			// Otherwise, copy the properties one-by-one to the cache object
			} else {
				for ( prop in data ) {
					cache[ prop ] = data[ prop ];
				}
			}
		}
		return cache;
	},
	get: function( owner, key ) {
		// Either a valid cache is found, or will be created.
		// New caches will be created and the unlock returned,
		// allowing direct access to the newly created
		// empty data object. A valid owner object must be provided.
		var cache = this.cache[ this.key( owner ) ];

		return key === undefined ?
			cache : cache[ key ];
	},
	access: function( owner, key, value ) {
		var stored;
		// In cases where either:
		//
		//   1. No key was specified
		//   2. A string key was specified, but no value provided
		//
		// Take the "read" path and allow the get method to determine
		// which value to return, respectively either:
		//
		//   1. The entire cache object
		//   2. The data stored at the key
		//
		if ( key === undefined ||
				((key && typeof key === "string") && value === undefined) ) {

			stored = this.get( owner, key );

			return stored !== undefined ?
				stored : this.get( owner, jQuery.camelCase(key) );
		}

		// [*]When the key is not a string, or both a key and value
		// are specified, set or extend (existing objects) with either:
		//
		//   1. An object of properties
		//   2. A key and value
		//
		this.set( owner, key, value );

		// Since the "set" path can have two possible entry points
		// return the expected data based on which path was taken[*]
		return value !== undefined ? value : key;
	},
	remove: function( owner, key ) {
		var i, name, camel,
			unlock = this.key( owner ),
			cache = this.cache[ unlock ];

		if ( key === undefined ) {
			this.cache[ unlock ] = {};

		} else {
			// Support array or space separated string of keys
			if ( jQuery.isArray( key ) ) {
				// If "name" is an array of keys...
				// When data is initially created, via ("key", "val") signature,
				// keys will be converted to camelCase.
				// Since there is no way to tell _how_ a key was added, remove
				// both plain key and camelCase key. #12786
				// This will only penalize the array argument path.
				name = key.concat( key.map( jQuery.camelCase ) );
			} else {
				camel = jQuery.camelCase( key );
				// Try the string as a key before any manipulation
				if ( key in cache ) {
					name = [ key, camel ];
				} else {
					// If a key with the spaces exists, use it.
					// Otherwise, create an array by matching non-whitespace
					name = camel;
					name = name in cache ?
						[ name ] : ( name.match( rnotwhite ) || [] );
				}
			}

			i = name.length;
			while ( i-- ) {
				delete cache[ name[ i ] ];
			}
		}
	},
	hasData: function( owner ) {
		return !jQuery.isEmptyObject(
			this.cache[ owner[ this.expando ] ] || {}
		);
	},
	discard: function( owner ) {
		if ( owner[ this.expando ] ) {
			delete this.cache[ owner[ this.expando ] ];
		}
	}
};
var data_priv = new Data();

var data_user = new Data();



//	Implementation Summary
//
//	1. Enforce API surface and semantic compatibility with 1.9.x branch
//	2. Improve the module's maintainability by reducing the storage
//		paths to a single mechanism.
//	3. Use the same single mechanism to support "private" and "user" data.
//	4. _Never_ expose "private" data to user code (TODO: Drop _data, _removeData)
//	5. Avoid exposing implementation details on user objects (eg. expando properties)
//	6. Provide a clear path for implementation upgrade to WeakMap in 2014

var rbrace = /^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,
	rmultiDash = /([A-Z])/g;

function dataAttr( elem, key, data ) {
	var name;

	// If nothing was found internally, try to fetch any
	// data from the HTML5 data-* attribute
	if ( data === undefined && elem.nodeType === 1 ) {
		name = "data-" + key.replace( rmultiDash, "-$1" ).toLowerCase();
		data = elem.getAttribute( name );

		if ( typeof data === "string" ) {
			try {
				data = data === "true" ? true :
					data === "false" ? false :
					data === "null" ? null :
					// Only convert to a number if it doesn't change the string
					+data + "" === data ? +data :
					rbrace.test( data ) ? jQuery.parseJSON( data ) :
					data;
			} catch( e ) {}

			// Make sure we set the data so it isn't changed later
			data_user.set( elem, key, data );
		} else {
			data = undefined;
		}
	}
	return data;
}

jQuery.extend({
	hasData: function( elem ) {
		return data_user.hasData( elem ) || data_priv.hasData( elem );
	},

	data: function( elem, name, data ) {
		return data_user.access( elem, name, data );
	},

	removeData: function( elem, name ) {
		data_user.remove( elem, name );
	},

	// TODO: Now that all calls to _data and _removeData have been replaced
	// with direct calls to data_priv methods, these can be deprecated.
	_data: function( elem, name, data ) {
		return data_priv.access( elem, name, data );
	},

	_removeData: function( elem, name ) {
		data_priv.remove( elem, name );
	}
});

jQuery.fn.extend({
	data: function( key, value ) {
		var i, name, data,
			elem = this[ 0 ],
			attrs = elem && elem.attributes;

		// Gets all values
		if ( key === undefined ) {
			if ( this.length ) {
				data = data_user.get( elem );

				if ( elem.nodeType === 1 && !data_priv.get( elem, "hasDataAttrs" ) ) {
					i = attrs.length;
					while ( i-- ) {

						// Support: IE11+
						// The attrs elements can be null (#14894)
						if ( attrs[ i ] ) {
							name = attrs[ i ].name;
							if ( name.indexOf( "data-" ) === 0 ) {
								name = jQuery.camelCase( name.slice(5) );
								dataAttr( elem, name, data[ name ] );
							}
						}
					}
					data_priv.set( elem, "hasDataAttrs", true );
				}
			}

			return data;
		}

		// Sets multiple values
		if ( typeof key === "object" ) {
			return this.each(function() {
				data_user.set( this, key );
			});
		}

		return access( this, function( value ) {
			var data,
				camelKey = jQuery.camelCase( key );

			// The calling jQuery object (element matches) is not empty
			// (and therefore has an element appears at this[ 0 ]) and the
			// `value` parameter was not undefined. An empty jQuery object
			// will result in `undefined` for elem = this[ 0 ] which will
			// throw an exception if an attempt to read a data cache is made.
			if ( elem && value === undefined ) {
				// Attempt to get data from the cache
				// with the key as-is
				data = data_user.get( elem, key );
				if ( data !== undefined ) {
					return data;
				}

				// Attempt to get data from the cache
				// with the key camelized
				data = data_user.get( elem, camelKey );
				if ( data !== undefined ) {
					return data;
				}

				// Attempt to "discover" the data in
				// HTML5 custom data-* attrs
				data = dataAttr( elem, camelKey, undefined );
				if ( data !== undefined ) {
					return data;
				}

				// We tried really hard, but the data doesn't exist.
				return;
			}

			// Set the data...
			this.each(function() {
				// First, attempt to store a copy or reference of any
				// data that might've been store with a camelCased key.
				var data = data_user.get( this, camelKey );

				// For HTML5 data-* attribute interop, we have to
				// store property names with dashes in a camelCase form.
				// This might not apply to all properties...*
				data_user.set( this, camelKey, value );

				// *... In the case of properties that might _actually_
				// have dashes, we need to also store a copy of that
				// unchanged property.
				if ( key.indexOf("-") !== -1 && data !== undefined ) {
					data_user.set( this, key, value );
				}
			});
		}, null, value, arguments.length > 1, null, true );
	},

	removeData: function( key ) {
		return this.each(function() {
			data_user.remove( this, key );
		});
	}
});


jQuery.extend({
	queue: function( elem, type, data ) {
		var queue;

		if ( elem ) {
			type = ( type || "fx" ) + "queue";
			queue = data_priv.get( elem, type );

			// Speed up dequeue by getting out quickly if this is just a lookup
			if ( data ) {
				if ( !queue || jQuery.isArray( data ) ) {
					queue = data_priv.access( elem, type, jQuery.makeArray(data) );
				} else {
					queue.push( data );
				}
			}
			return queue || [];
		}
	},

	dequeue: function( elem, type ) {
		type = type || "fx";

		var queue = jQuery.queue( elem, type ),
			startLength = queue.length,
			fn = queue.shift(),
			hooks = jQuery._queueHooks( elem, type ),
			next = function() {
				jQuery.dequeue( elem, type );
			};

		// If the fx queue is dequeued, always remove the progress sentinel
		if ( fn === "inprogress" ) {
			fn = queue.shift();
			startLength--;
		}

		if ( fn ) {

			// Add a progress sentinel to prevent the fx queue from being
			// automatically dequeued
			if ( type === "fx" ) {
				queue.unshift( "inprogress" );
			}

			// Clear up the last queue stop function
			delete hooks.stop;
			fn.call( elem, next, hooks );
		}

		if ( !startLength && hooks ) {
			hooks.empty.fire();
		}
	},

	// Not public - generate a queueHooks object, or return the current one
	_queueHooks: function( elem, type ) {
		var key = type + "queueHooks";
		return data_priv.get( elem, key ) || data_priv.access( elem, key, {
			empty: jQuery.Callbacks("once memory").add(function() {
				data_priv.remove( elem, [ type + "queue", key ] );
			})
		});
	}
});

jQuery.fn.extend({
	queue: function( type, data ) {
		var setter = 2;

		if ( typeof type !== "string" ) {
			data = type;
			type = "fx";
			setter--;
		}

		if ( arguments.length < setter ) {
			return jQuery.queue( this[0], type );
		}

		return data === undefined ?
			this :
			this.each(function() {
				var queue = jQuery.queue( this, type, data );

				// Ensure a hooks for this queue
				jQuery._queueHooks( this, type );

				if ( type === "fx" && queue[0] !== "inprogress" ) {
					jQuery.dequeue( this, type );
				}
			});
	},
	dequeue: function( type ) {
		return this.each(function() {
			jQuery.dequeue( this, type );
		});
	},
	clearQueue: function( type ) {
		return this.queue( type || "fx", [] );
	},
	// Get a promise resolved when queues of a certain type
	// are emptied (fx is the type by default)
	promise: function( type, obj ) {
		var tmp,
			count = 1,
			defer = jQuery.Deferred(),
			elements = this,
			i = this.length,
			resolve = function() {
				if ( !( --count ) ) {
					defer.resolveWith( elements, [ elements ] );
				}
			};

		if ( typeof type !== "string" ) {
			obj = type;
			type = undefined;
		}
		type = type || "fx";

		while ( i-- ) {
			tmp = data_priv.get( elements[ i ], type + "queueHooks" );
			if ( tmp && tmp.empty ) {
				count++;
				tmp.empty.add( resolve );
			}
		}
		resolve();
		return defer.promise( obj );
	}
});
var pnum = (/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/).source;

var cssExpand = [ "Top", "Right", "Bottom", "Left" ];

var isHidden = function( elem, el ) {
		// isHidden might be called from jQuery#filter function;
		// in that case, element will be second argument
		elem = el || elem;
		return jQuery.css( elem, "display" ) === "none" || !jQuery.contains( elem.ownerDocument, elem );
	};

var rcheckableType = (/^(?:checkbox|radio)$/i);



(function() {
	var fragment = document.createDocumentFragment(),
		div = fragment.appendChild( document.createElement( "div" ) ),
		input = document.createElement( "input" );

	// Support: Safari<=5.1
	// Check state lost if the name is set (#11217)
	// Support: Windows Web Apps (WWA)
	// `name` and `type` must use .setAttribute for WWA (#14901)
	input.setAttribute( "type", "radio" );
	input.setAttribute( "checked", "checked" );
	input.setAttribute( "name", "t" );

	div.appendChild( input );

	// Support: Safari<=5.1, Android<4.2
	// Older WebKit doesn't clone checked state correctly in fragments
	support.checkClone = div.cloneNode( true ).cloneNode( true ).lastChild.checked;

	// Support: IE<=11+
	// Make sure textarea (and checkbox) defaultValue is properly cloned
	div.innerHTML = "<textarea>x</textarea>";
	support.noCloneChecked = !!div.cloneNode( true ).lastChild.defaultValue;
})();
var strundefined = typeof undefined;



support.focusinBubbles = "onfocusin" in window;


var
	rkeyEvent = /^key/,
	rmouseEvent = /^(?:mouse|pointer|contextmenu)|click/,
	rfocusMorph = /^(?:focusinfocus|focusoutblur)$/,
	rtypenamespace = /^([^.]*)(?:\.(.+)|)$/;

function returnTrue() {
	return true;
}

function returnFalse() {
	return false;
}

function safeActiveElement() {
	try {
		return document.activeElement;
	} catch ( err ) { }
}

/*
 * Helper functions for managing events -- not part of the public interface.
 * Props to Dean Edwards' addEvent library for many of the ideas.
 */
jQuery.event = {

	global: {},

	add: function( elem, types, handler, data, selector ) {

		var handleObjIn, eventHandle, tmp,
			events, t, handleObj,
			special, handlers, type, namespaces, origType,
			elemData = data_priv.get( elem );

		// Don't attach events to noData or text/comment nodes (but allow plain objects)
		if ( !elemData ) {
			return;
		}

		// Caller can pass in an object of custom data in lieu of the handler
		if ( handler.handler ) {
			handleObjIn = handler;
			handler = handleObjIn.handler;
			selector = handleObjIn.selector;
		}

		// Make sure that the handler has a unique ID, used to find/remove it later
		if ( !handler.guid ) {
			handler.guid = jQuery.guid++;
		}

		// Init the element's event structure and main handler, if this is the first
		if ( !(events = elemData.events) ) {
			events = elemData.events = {};
		}
		if ( !(eventHandle = elemData.handle) ) {
			eventHandle = elemData.handle = function( e ) {
				// Discard the second event of a jQuery.event.trigger() and
				// when an event is called after a page has unloaded
				return typeof jQuery !== strundefined && jQuery.event.triggered !== e.type ?
					jQuery.event.dispatch.apply( elem, arguments ) : undefined;
			};
		}

		// Handle multiple events separated by a space
		types = ( types || "" ).match( rnotwhite ) || [ "" ];
		t = types.length;
		while ( t-- ) {
			tmp = rtypenamespace.exec( types[t] ) || [];
			type = origType = tmp[1];
			namespaces = ( tmp[2] || "" ).split( "." ).sort();

			// There *must* be a type, no attaching namespace-only handlers
			if ( !type ) {
				continue;
			}

			// If event changes its type, use the special event handlers for the changed type
			special = jQuery.event.special[ type ] || {};

			// If selector defined, determine special event api type, otherwise given type
			type = ( selector ? special.delegateType : special.bindType ) || type;

			// Update special based on newly reset type
			special = jQuery.event.special[ type ] || {};

			// handleObj is passed to all event handlers
			handleObj = jQuery.extend({
				type: type,
				origType: origType,
				data: data,
				handler: handler,
				guid: handler.guid,
				selector: selector,
				needsContext: selector && jQuery.expr.match.needsContext.test( selector ),
				namespace: namespaces.join(".")
			}, handleObjIn );

			// Init the event handler queue if we're the first
			if ( !(handlers = events[ type ]) ) {
				handlers = events[ type ] = [];
				handlers.delegateCount = 0;

				// Only use addEventListener if the special events handler returns false
				if ( !special.setup || special.setup.call( elem, data, namespaces, eventHandle ) === false ) {
					if ( elem.addEventListener ) {
						elem.addEventListener( type, eventHandle, false );
					}
				}
			}

			if ( special.add ) {
				special.add.call( elem, handleObj );

				if ( !handleObj.handler.guid ) {
					handleObj.handler.guid = handler.guid;
				}
			}

			// Add to the element's handler list, delegates in front
			if ( selector ) {
				handlers.splice( handlers.delegateCount++, 0, handleObj );
			} else {
				handlers.push( handleObj );
			}

			// Keep track of which events have ever been used, for event optimization
			jQuery.event.global[ type ] = true;
		}

	},

	// Detach an event or set of events from an element
	remove: function( elem, types, handler, selector, mappedTypes ) {

		var j, origCount, tmp,
			events, t, handleObj,
			special, handlers, type, namespaces, origType,
			elemData = data_priv.hasData( elem ) && data_priv.get( elem );

		if ( !elemData || !(events = elemData.events) ) {
			return;
		}

		// Once for each type.namespace in types; type may be omitted
		types = ( types || "" ).match( rnotwhite ) || [ "" ];
		t = types.length;
		while ( t-- ) {
			tmp = rtypenamespace.exec( types[t] ) || [];
			type = origType = tmp[1];
			namespaces = ( tmp[2] || "" ).split( "." ).sort();

			// Unbind all events (on this namespace, if provided) for the element
			if ( !type ) {
				for ( type in events ) {
					jQuery.event.remove( elem, type + types[ t ], handler, selector, true );
				}
				continue;
			}

			special = jQuery.event.special[ type ] || {};
			type = ( selector ? special.delegateType : special.bindType ) || type;
			handlers = events[ type ] || [];
			tmp = tmp[2] && new RegExp( "(^|\\.)" + namespaces.join("\\.(?:.*\\.|)") + "(\\.|$)" );

			// Remove matching events
			origCount = j = handlers.length;
			while ( j-- ) {
				handleObj = handlers[ j ];

				if ( ( mappedTypes || origType === handleObj.origType ) &&
					( !handler || handler.guid === handleObj.guid ) &&
					( !tmp || tmp.test( handleObj.namespace ) ) &&
					( !selector || selector === handleObj.selector || selector === "**" && handleObj.selector ) ) {
					handlers.splice( j, 1 );

					if ( handleObj.selector ) {
						handlers.delegateCount--;
					}
					if ( special.remove ) {
						special.remove.call( elem, handleObj );
					}
				}
			}

			// Remove generic event handler if we removed something and no more handlers exist
			// (avoids potential for endless recursion during removal of special event handlers)
			if ( origCount && !handlers.length ) {
				if ( !special.teardown || special.teardown.call( elem, namespaces, elemData.handle ) === false ) {
					jQuery.removeEvent( elem, type, elemData.handle );
				}

				delete events[ type ];
			}
		}

		// Remove the expando if it's no longer used
		if ( jQuery.isEmptyObject( events ) ) {
			delete elemData.handle;
			data_priv.remove( elem, "events" );
		}
	},

	trigger: function( event, data, elem, onlyHandlers ) {

		var i, cur, tmp, bubbleType, ontype, handle, special,
			eventPath = [ elem || document ],
			type = hasOwn.call( event, "type" ) ? event.type : event,
			namespaces = hasOwn.call( event, "namespace" ) ? event.namespace.split(".") : [];

		cur = tmp = elem = elem || document;

		// Don't do events on text and comment nodes
		if ( elem.nodeType === 3 || elem.nodeType === 8 ) {
			return;
		}

		// focus/blur morphs to focusin/out; ensure we're not firing them right now
		if ( rfocusMorph.test( type + jQuery.event.triggered ) ) {
			return;
		}

		if ( type.indexOf(".") >= 0 ) {
			// Namespaced trigger; create a regexp to match event type in handle()
			namespaces = type.split(".");
			type = namespaces.shift();
			namespaces.sort();
		}
		ontype = type.indexOf(":") < 0 && "on" + type;

		// Caller can pass in a jQuery.Event object, Object, or just an event type string
		event = event[ jQuery.expando ] ?
			event :
			new jQuery.Event( type, typeof event === "object" && event );

		// Trigger bitmask: & 1 for native handlers; & 2 for jQuery (always true)
		event.isTrigger = onlyHandlers ? 2 : 3;
		event.namespace = namespaces.join(".");
		event.namespace_re = event.namespace ?
			new RegExp( "(^|\\.)" + namespaces.join("\\.(?:.*\\.|)") + "(\\.|$)" ) :
			null;

		// Clean up the event in case it is being reused
		event.result = undefined;
		if ( !event.target ) {
			event.target = elem;
		}

		// Clone any incoming data and prepend the event, creating the handler arg list
		data = data == null ?
			[ event ] :
			jQuery.makeArray( data, [ event ] );

		// Allow special events to draw outside the lines
		special = jQuery.event.special[ type ] || {};
		if ( !onlyHandlers && special.trigger && special.trigger.apply( elem, data ) === false ) {
			return;
		}

		// Determine event propagation path in advance, per W3C events spec (#9951)
		// Bubble up to document, then to window; watch for a global ownerDocument var (#9724)
		if ( !onlyHandlers && !special.noBubble && !jQuery.isWindow( elem ) ) {

			bubbleType = special.delegateType || type;
			if ( !rfocusMorph.test( bubbleType + type ) ) {
				cur = cur.parentNode;
			}
			for ( ; cur; cur = cur.parentNode ) {
				eventPath.push( cur );
				tmp = cur;
			}

			// Only add window if we got to document (e.g., not plain obj or detached DOM)
			if ( tmp === (elem.ownerDocument || document) ) {
				eventPath.push( tmp.defaultView || tmp.parentWindow || window );
			}
		}

		// Fire handlers on the event path
		i = 0;
		while ( (cur = eventPath[i++]) && !event.isPropagationStopped() ) {

			event.type = i > 1 ?
				bubbleType :
				special.bindType || type;

			// jQuery handler
			handle = ( data_priv.get( cur, "events" ) || {} )[ event.type ] && data_priv.get( cur, "handle" );
			if ( handle ) {
				handle.apply( cur, data );
			}

			// Native handler
			handle = ontype && cur[ ontype ];
			if ( handle && handle.apply && jQuery.acceptData( cur ) ) {
				event.result = handle.apply( cur, data );
				if ( event.result === false ) {
					event.preventDefault();
				}
			}
		}
		event.type = type;

		// If nobody prevented the default action, do it now
		if ( !onlyHandlers && !event.isDefaultPrevented() ) {

			if ( (!special._default || special._default.apply( eventPath.pop(), data ) === false) &&
				jQuery.acceptData( elem ) ) {

				// Call a native DOM method on the target with the same name name as the event.
				// Don't do default actions on window, that's where global variables be (#6170)
				if ( ontype && jQuery.isFunction( elem[ type ] ) && !jQuery.isWindow( elem ) ) {

					// Don't re-trigger an onFOO event when we call its FOO() method
					tmp = elem[ ontype ];

					if ( tmp ) {
						elem[ ontype ] = null;
					}

					// Prevent re-triggering of the same event, since we already bubbled it above
					jQuery.event.triggered = type;
					elem[ type ]();
					jQuery.event.triggered = undefined;

					if ( tmp ) {
						elem[ ontype ] = tmp;
					}
				}
			}
		}

		return event.result;
	},

	dispatch: function( event ) {

		// Make a writable jQuery.Event from the native event object
		event = jQuery.event.fix( event );

		var i, j, ret, matched, handleObj,
			handlerQueue = [],
			args = slice.call( arguments ),
			handlers = ( data_priv.get( this, "events" ) || {} )[ event.type ] || [],
			special = jQuery.event.special[ event.type ] || {};

		// Use the fix-ed jQuery.Event rather than the (read-only) native event
		args[0] = event;
		event.delegateTarget = this;

		// Call the preDispatch hook for the mapped type, and let it bail if desired
		if ( special.preDispatch && special.preDispatch.call( this, event ) === false ) {
			return;
		}

		// Determine handlers
		handlerQueue = jQuery.event.handlers.call( this, event, handlers );

		// Run delegates first; they may want to stop propagation beneath us
		i = 0;
		while ( (matched = handlerQueue[ i++ ]) && !event.isPropagationStopped() ) {
			event.currentTarget = matched.elem;

			j = 0;
			while ( (handleObj = matched.handlers[ j++ ]) && !event.isImmediatePropagationStopped() ) {

				// Triggered event must either 1) have no namespace, or 2) have namespace(s)
				// a subset or equal to those in the bound event (both can have no namespace).
				if ( !event.namespace_re || event.namespace_re.test( handleObj.namespace ) ) {

					event.handleObj = handleObj;
					event.data = handleObj.data;

					ret = ( (jQuery.event.special[ handleObj.origType ] || {}).handle || handleObj.handler )
							.apply( matched.elem, args );

					if ( ret !== undefined ) {
						if ( (event.result = ret) === false ) {
							event.preventDefault();
							event.stopPropagation();
						}
					}
				}
			}
		}

		// Call the postDispatch hook for the mapped type
		if ( special.postDispatch ) {
			special.postDispatch.call( this, event );
		}

		return event.result;
	},

	handlers: function( event, handlers ) {
		var i, matches, sel, handleObj,
			handlerQueue = [],
			delegateCount = handlers.delegateCount,
			cur = event.target;

		// Find delegate handlers
		// Black-hole SVG <use> instance trees (#13180)
		// Avoid non-left-click bubbling in Firefox (#3861)
		if ( delegateCount && cur.nodeType && (!event.button || event.type !== "click") ) {

			for ( ; cur !== this; cur = cur.parentNode || this ) {

				// Don't process clicks on disabled elements (#6911, #8165, #11382, #11764)
				if ( cur.disabled !== true || event.type !== "click" ) {
					matches = [];
					for ( i = 0; i < delegateCount; i++ ) {
						handleObj = handlers[ i ];

						// Don't conflict with Object.prototype properties (#13203)
						sel = handleObj.selector + " ";

						if ( matches[ sel ] === undefined ) {
							matches[ sel ] = handleObj.needsContext ?
								jQuery( sel, this ).index( cur ) >= 0 :
								jQuery.find( sel, this, null, [ cur ] ).length;
						}
						if ( matches[ sel ] ) {
							matches.push( handleObj );
						}
					}
					if ( matches.length ) {
						handlerQueue.push({ elem: cur, handlers: matches });
					}
				}
			}
		}

		// Add the remaining (directly-bound) handlers
		if ( delegateCount < handlers.length ) {
			handlerQueue.push({ elem: this, handlers: handlers.slice( delegateCount ) });
		}

		return handlerQueue;
	},

	// Includes some event props shared by KeyEvent and MouseEvent
	props: "altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),

	fixHooks: {},

	keyHooks: {
		props: "char charCode key keyCode".split(" "),
		filter: function( event, original ) {

			// Add which for key events
			if ( event.which == null ) {
				event.which = original.charCode != null ? original.charCode : original.keyCode;
			}

			return event;
		}
	},

	mouseHooks: {
		props: "button buttons clientX clientY offsetX offsetY pageX pageY screenX screenY toElement".split(" "),
		filter: function( event, original ) {
			var eventDoc, doc, body,
				button = original.button;

			// Calculate pageX/Y if missing and clientX/Y available
			if ( event.pageX == null && original.clientX != null ) {
				eventDoc = event.target.ownerDocument || document;
				doc = eventDoc.documentElement;
				body = eventDoc.body;

				event.pageX = original.clientX + ( doc && doc.scrollLeft || body && body.scrollLeft || 0 ) - ( doc && doc.clientLeft || body && body.clientLeft || 0 );
				event.pageY = original.clientY + ( doc && doc.scrollTop  || body && body.scrollTop  || 0 ) - ( doc && doc.clientTop  || body && body.clientTop  || 0 );
			}

			// Add which for click: 1 === left; 2 === middle; 3 === right
			// Note: button is not normalized, so don't use it
			if ( !event.which && button !== undefined ) {
				event.which = ( button & 1 ? 1 : ( button & 2 ? 3 : ( button & 4 ? 2 : 0 ) ) );
			}

			return event;
		}
	},

	fix: function( event ) {
		if ( event[ jQuery.expando ] ) {
			return event;
		}

		// Create a writable copy of the event object and normalize some properties
		var i, prop, copy,
			type = event.type,
			originalEvent = event,
			fixHook = this.fixHooks[ type ];

		if ( !fixHook ) {
			this.fixHooks[ type ] = fixHook =
				rmouseEvent.test( type ) ? this.mouseHooks :
				rkeyEvent.test( type ) ? this.keyHooks :
				{};
		}
		copy = fixHook.props ? this.props.concat( fixHook.props ) : this.props;

		event = new jQuery.Event( originalEvent );

		i = copy.length;
		while ( i-- ) {
			prop = copy[ i ];
			event[ prop ] = originalEvent[ prop ];
		}

		// Support: Cordova 2.5 (WebKit) (#13255)
		// All events should have a target; Cordova deviceready doesn't
		if ( !event.target ) {
			event.target = document;
		}

		// Support: Safari 6.0+, Chrome<28
		// Target should not be a text node (#504, #13143)
		if ( event.target.nodeType === 3 ) {
			event.target = event.target.parentNode;
		}

		return fixHook.filter ? fixHook.filter( event, originalEvent ) : event;
	},

	special: {
		load: {
			// Prevent triggered image.load events from bubbling to window.load
			noBubble: true
		},
		focus: {
			// Fire native event if possible so blur/focus sequence is correct
			trigger: function() {
				if ( this !== safeActiveElement() && this.focus ) {
					this.focus();
					return false;
				}
			},
			delegateType: "focusin"
		},
		blur: {
			trigger: function() {
				if ( this === safeActiveElement() && this.blur ) {
					this.blur();
					return false;
				}
			},
			delegateType: "focusout"
		},
		click: {
			// For checkbox, fire native event so checked state will be right
			trigger: function() {
				if ( this.type === "checkbox" && this.click && jQuery.nodeName( this, "input" ) ) {
					this.click();
					return false;
				}
			},

			// For cross-browser consistency, don't fire native .click() on links
			_default: function( event ) {
				return jQuery.nodeName( event.target, "a" );
			}
		},

		beforeunload: {
			postDispatch: function( event ) {

				// Support: Firefox 20+
				// Firefox doesn't alert if the returnValue field is not set.
				if ( event.result !== undefined && event.originalEvent ) {
					event.originalEvent.returnValue = event.result;
				}
			}
		}
	},

	simulate: function( type, elem, event, bubble ) {
		// Piggyback on a donor event to simulate a different one.
		// Fake originalEvent to avoid donor's stopPropagation, but if the
		// simulated event prevents default then we do the same on the donor.
		var e = jQuery.extend(
			new jQuery.Event(),
			event,
			{
				type: type,
				isSimulated: true,
				originalEvent: {}
			}
		);
		if ( bubble ) {
			jQuery.event.trigger( e, null, elem );
		} else {
			jQuery.event.dispatch.call( elem, e );
		}
		if ( e.isDefaultPrevented() ) {
			event.preventDefault();
		}
	}
};

jQuery.removeEvent = function( elem, type, handle ) {
	if ( elem.removeEventListener ) {
		elem.removeEventListener( type, handle, false );
	}
};

jQuery.Event = function( src, props ) {
	// Allow instantiation without the 'new' keyword
	if ( !(this instanceof jQuery.Event) ) {
		return new jQuery.Event( src, props );
	}

	// Event object
	if ( src && src.type ) {
		this.originalEvent = src;
		this.type = src.type;

		// Events bubbling up the document may have been marked as prevented
		// by a handler lower down the tree; reflect the correct value.
		this.isDefaultPrevented = src.defaultPrevented ||
				src.defaultPrevented === undefined &&
				// Support: Android<4.0
				src.returnValue === false ?
			returnTrue :
			returnFalse;

	// Event type
	} else {
		this.type = src;
	}

	// Put explicitly provided properties onto the event object
	if ( props ) {
		jQuery.extend( this, props );
	}

	// Create a timestamp if incoming event doesn't have one
	this.timeStamp = src && src.timeStamp || jQuery.now();

	// Mark it as fixed
	this[ jQuery.expando ] = true;
};

// jQuery.Event is based on DOM3 Events as specified by the ECMAScript Language Binding
// http://www.w3.org/TR/2003/WD-DOM-Level-3-Events-20030331/ecma-script-binding.html
jQuery.Event.prototype = {
	isDefaultPrevented: returnFalse,
	isPropagationStopped: returnFalse,
	isImmediatePropagationStopped: returnFalse,

	preventDefault: function() {
		var e = this.originalEvent;

		this.isDefaultPrevented = returnTrue;

		if ( e && e.preventDefault ) {
			e.preventDefault();
		}
	},
	stopPropagation: function() {
		var e = this.originalEvent;

		this.isPropagationStopped = returnTrue;

		if ( e && e.stopPropagation ) {
			e.stopPropagation();
		}
	},
	stopImmediatePropagation: function() {
		var e = this.originalEvent;

		this.isImmediatePropagationStopped = returnTrue;

		if ( e && e.stopImmediatePropagation ) {
			e.stopImmediatePropagation();
		}

		this.stopPropagation();
	}
};

// Create mouseenter/leave events using mouseover/out and event-time checks
// Support: Chrome 15+
jQuery.each({
	mouseenter: "mouseover",
	mouseleave: "mouseout",
	pointerenter: "pointerover",
	pointerleave: "pointerout"
}, function( orig, fix ) {
	jQuery.event.special[ orig ] = {
		delegateType: fix,
		bindType: fix,

		handle: function( event ) {
			var ret,
				target = this,
				related = event.relatedTarget,
				handleObj = event.handleObj;

			// For mousenter/leave call the handler if related is outside the target.
			// NB: No relatedTarget if the mouse left/entered the browser window
			if ( !related || (related !== target && !jQuery.contains( target, related )) ) {
				event.type = handleObj.origType;
				ret = handleObj.handler.apply( this, arguments );
				event.type = fix;
			}
			return ret;
		}
	};
});

// Support: Firefox, Chrome, Safari
// Create "bubbling" focus and blur events
if ( !support.focusinBubbles ) {
	jQuery.each({ focus: "focusin", blur: "focusout" }, function( orig, fix ) {

		// Attach a single capturing handler on the document while someone wants focusin/focusout
		var handler = function( event ) {
				jQuery.event.simulate( fix, event.target, jQuery.event.fix( event ), true );
			};

		jQuery.event.special[ fix ] = {
			setup: function() {
				var doc = this.ownerDocument || this,
					attaches = data_priv.access( doc, fix );

				if ( !attaches ) {
					doc.addEventListener( orig, handler, true );
				}
				data_priv.access( doc, fix, ( attaches || 0 ) + 1 );
			},
			teardown: function() {
				var doc = this.ownerDocument || this,
					attaches = data_priv.access( doc, fix ) - 1;

				if ( !attaches ) {
					doc.removeEventListener( orig, handler, true );
					data_priv.remove( doc, fix );

				} else {
					data_priv.access( doc, fix, attaches );
				}
			}
		};
	});
}

jQuery.fn.extend({

	on: function( types, selector, data, fn, /*INTERNAL*/ one ) {
		var origFn, type;

		// Types can be a map of types/handlers
		if ( typeof types === "object" ) {
			// ( types-Object, selector, data )
			if ( typeof selector !== "string" ) {
				// ( types-Object, data )
				data = data || selector;
				selector = undefined;
			}
			for ( type in types ) {
				this.on( type, selector, data, types[ type ], one );
			}
			return this;
		}

		if ( data == null && fn == null ) {
			// ( types, fn )
			fn = selector;
			data = selector = undefined;
		} else if ( fn == null ) {
			if ( typeof selector === "string" ) {
				// ( types, selector, fn )
				fn = data;
				data = undefined;
			} else {
				// ( types, data, fn )
				fn = data;
				data = selector;
				selector = undefined;
			}
		}
		if ( fn === false ) {
			fn = returnFalse;
		} else if ( !fn ) {
			return this;
		}

		if ( one === 1 ) {
			origFn = fn;
			fn = function( event ) {
				// Can use an empty set, since event contains the info
				jQuery().off( event );
				return origFn.apply( this, arguments );
			};
			// Use same guid so caller can remove using origFn
			fn.guid = origFn.guid || ( origFn.guid = jQuery.guid++ );
		}
		return this.each( function() {
			jQuery.event.add( this, types, fn, data, selector );
		});
	},
	one: function( types, selector, data, fn ) {
		return this.on( types, selector, data, fn, 1 );
	},
	off: function( types, selector, fn ) {
		var handleObj, type;
		if ( types && types.preventDefault && types.handleObj ) {
			// ( event )  dispatched jQuery.Event
			handleObj = types.handleObj;
			jQuery( types.delegateTarget ).off(
				handleObj.namespace ? handleObj.origType + "." + handleObj.namespace : handleObj.origType,
				handleObj.selector,
				handleObj.handler
			);
			return this;
		}
		if ( typeof types === "object" ) {
			// ( types-object [, selector] )
			for ( type in types ) {
				this.off( type, selector, types[ type ] );
			}
			return this;
		}
		if ( selector === false || typeof selector === "function" ) {
			// ( types [, fn] )
			fn = selector;
			selector = undefined;
		}
		if ( fn === false ) {
			fn = returnFalse;
		}
		return this.each(function() {
			jQuery.event.remove( this, types, fn, selector );
		});
	},

	trigger: function( type, data ) {
		return this.each(function() {
			jQuery.event.trigger( type, data, this );
		});
	},
	triggerHandler: function( type, data ) {
		var elem = this[0];
		if ( elem ) {
			return jQuery.event.trigger( type, data, elem, true );
		}
	}
});


var
	rxhtmlTag = /<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,
	rtagName = /<([\w:]+)/,
	rhtml = /<|&#?\w+;/,
	rnoInnerhtml = /<(?:script|style|link)/i,
	// checked="checked" or checked
	rchecked = /checked\s*(?:[^=]|=\s*.checked.)/i,
	rscriptType = /^$|\/(?:java|ecma)script/i,
	rscriptTypeMasked = /^true\/(.*)/,
	rcleanScript = /^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,

	// We have to close these tags to support XHTML (#13200)
	wrapMap = {

		// Support: IE9
		option: [ 1, "<select multiple='multiple'>", "</select>" ],

		thead: [ 1, "<table>", "</table>" ],
		col: [ 2, "<table><colgroup>", "</colgroup></table>" ],
		tr: [ 2, "<table><tbody>", "</tbody></table>" ],
		td: [ 3, "<table><tbody><tr>", "</tr></tbody></table>" ],

		_default: [ 0, "", "" ]
	};

// Support: IE9
wrapMap.optgroup = wrapMap.option;

wrapMap.tbody = wrapMap.tfoot = wrapMap.colgroup = wrapMap.caption = wrapMap.thead;
wrapMap.th = wrapMap.td;

// Support: 1.x compatibility
// Manipulating tables requires a tbody
function manipulationTarget( elem, content ) {
	return jQuery.nodeName( elem, "table" ) &&
		jQuery.nodeName( content.nodeType !== 11 ? content : content.firstChild, "tr" ) ?

		elem.getElementsByTagName("tbody")[0] ||
			elem.appendChild( elem.ownerDocument.createElement("tbody") ) :
		elem;
}

// Replace/restore the type attribute of script elements for safe DOM manipulation
function disableScript( elem ) {
	elem.type = (elem.getAttribute("type") !== null) + "/" + elem.type;
	return elem;
}
function restoreScript( elem ) {
	var match = rscriptTypeMasked.exec( elem.type );

	if ( match ) {
		elem.type = match[ 1 ];
	} else {
		elem.removeAttribute("type");
	}

	return elem;
}

// Mark scripts as having already been evaluated
function setGlobalEval( elems, refElements ) {
	var i = 0,
		l = elems.length;

	for ( ; i < l; i++ ) {
		data_priv.set(
			elems[ i ], "globalEval", !refElements || data_priv.get( refElements[ i ], "globalEval" )
		);
	}
}

function cloneCopyEvent( src, dest ) {
	var i, l, type, pdataOld, pdataCur, udataOld, udataCur, events;

	if ( dest.nodeType !== 1 ) {
		return;
	}

	// 1. Copy private data: events, handlers, etc.
	if ( data_priv.hasData( src ) ) {
		pdataOld = data_priv.access( src );
		pdataCur = data_priv.set( dest, pdataOld );
		events = pdataOld.events;

		if ( events ) {
			delete pdataCur.handle;
			pdataCur.events = {};

			for ( type in events ) {
				for ( i = 0, l = events[ type ].length; i < l; i++ ) {
					jQuery.event.add( dest, type, events[ type ][ i ] );
				}
			}
		}
	}

	// 2. Copy user data
	if ( data_user.hasData( src ) ) {
		udataOld = data_user.access( src );
		udataCur = jQuery.extend( {}, udataOld );

		data_user.set( dest, udataCur );
	}
}

function getAll( context, tag ) {
	var ret = context.getElementsByTagName ? context.getElementsByTagName( tag || "*" ) :
			context.querySelectorAll ? context.querySelectorAll( tag || "*" ) :
			[];

	return tag === undefined || tag && jQuery.nodeName( context, tag ) ?
		jQuery.merge( [ context ], ret ) :
		ret;
}

// Fix IE bugs, see support tests
function fixInput( src, dest ) {
	var nodeName = dest.nodeName.toLowerCase();

	// Fails to persist the checked state of a cloned checkbox or radio button.
	if ( nodeName === "input" && rcheckableType.test( src.type ) ) {
		dest.checked = src.checked;

	// Fails to return the selected option to the default selected state when cloning options
	} else if ( nodeName === "input" || nodeName === "textarea" ) {
		dest.defaultValue = src.defaultValue;
	}
}

jQuery.extend({
	clone: function( elem, dataAndEvents, deepDataAndEvents ) {
		var i, l, srcElements, destElements,
			clone = elem.cloneNode( true ),
			inPage = jQuery.contains( elem.ownerDocument, elem );

		// Fix IE cloning issues
		if ( !support.noCloneChecked && ( elem.nodeType === 1 || elem.nodeType === 11 ) &&
				!jQuery.isXMLDoc( elem ) ) {

			// We eschew Sizzle here for performance reasons: http://jsperf.com/getall-vs-sizzle/2
			destElements = getAll( clone );
			srcElements = getAll( elem );

			for ( i = 0, l = srcElements.length; i < l; i++ ) {
				fixInput( srcElements[ i ], destElements[ i ] );
			}
		}

		// Copy the events from the original to the clone
		if ( dataAndEvents ) {
			if ( deepDataAndEvents ) {
				srcElements = srcElements || getAll( elem );
				destElements = destElements || getAll( clone );

				for ( i = 0, l = srcElements.length; i < l; i++ ) {
					cloneCopyEvent( srcElements[ i ], destElements[ i ] );
				}
			} else {
				cloneCopyEvent( elem, clone );
			}
		}

		// Preserve script evaluation history
		destElements = getAll( clone, "script" );
		if ( destElements.length > 0 ) {
			setGlobalEval( destElements, !inPage && getAll( elem, "script" ) );
		}

		// Return the cloned set
		return clone;
	},

	buildFragment: function( elems, context, scripts, selection ) {
		var elem, tmp, tag, wrap, contains, j,
			fragment = context.createDocumentFragment(),
			nodes = [],
			i = 0,
			l = elems.length;

		for ( ; i < l; i++ ) {
			elem = elems[ i ];

			if ( elem || elem === 0 ) {

				// Add nodes directly
				if ( jQuery.type( elem ) === "object" ) {
					// Support: QtWebKit, PhantomJS
					// push.apply(_, arraylike) throws on ancient WebKit
					jQuery.merge( nodes, elem.nodeType ? [ elem ] : elem );

				// Convert non-html into a text node
				} else if ( !rhtml.test( elem ) ) {
					nodes.push( context.createTextNode( elem ) );

				// Convert html into DOM nodes
				} else {
					tmp = tmp || fragment.appendChild( context.createElement("div") );

					// Deserialize a standard representation
					tag = ( rtagName.exec( elem ) || [ "", "" ] )[ 1 ].toLowerCase();
					wrap = wrapMap[ tag ] || wrapMap._default;
					tmp.innerHTML = wrap[ 1 ] + elem.replace( rxhtmlTag, "<$1></$2>" ) + wrap[ 2 ];

					// Descend through wrappers to the right content
					j = wrap[ 0 ];
					while ( j-- ) {
						tmp = tmp.lastChild;
					}

					// Support: QtWebKit, PhantomJS
					// push.apply(_, arraylike) throws on ancient WebKit
					jQuery.merge( nodes, tmp.childNodes );

					// Remember the top-level container
					tmp = fragment.firstChild;

					// Ensure the created nodes are orphaned (#12392)
					tmp.textContent = "";
				}
			}
		}

		// Remove wrapper from fragment
		fragment.textContent = "";

		i = 0;
		while ( (elem = nodes[ i++ ]) ) {

			// #4087 - If origin and destination elements are the same, and this is
			// that element, do not do anything
			if ( selection && jQuery.inArray( elem, selection ) !== -1 ) {
				continue;
			}

			contains = jQuery.contains( elem.ownerDocument, elem );

			// Append to fragment
			tmp = getAll( fragment.appendChild( elem ), "script" );

			// Preserve script evaluation history
			if ( contains ) {
				setGlobalEval( tmp );
			}

			// Capture executables
			if ( scripts ) {
				j = 0;
				while ( (elem = tmp[ j++ ]) ) {
					if ( rscriptType.test( elem.type || "" ) ) {
						scripts.push( elem );
					}
				}
			}
		}

		return fragment;
	},

	cleanData: function( elems ) {
		var data, elem, type, key,
			special = jQuery.event.special,
			i = 0;

		for ( ; (elem = elems[ i ]) !== undefined; i++ ) {
			if ( jQuery.acceptData( elem ) ) {
				key = elem[ data_priv.expando ];

				if ( key && (data = data_priv.cache[ key ]) ) {
					if ( data.events ) {
						for ( type in data.events ) {
							if ( special[ type ] ) {
								jQuery.event.remove( elem, type );

							// This is a shortcut to avoid jQuery.event.remove's overhead
							} else {
								jQuery.removeEvent( elem, type, data.handle );
							}
						}
					}
					if ( data_priv.cache[ key ] ) {
						// Discard any remaining `private` data
						delete data_priv.cache[ key ];
					}
				}
			}
			// Discard any remaining `user` data
			delete data_user.cache[ elem[ data_user.expando ] ];
		}
	}
});

jQuery.fn.extend({
	text: function( value ) {
		return access( this, function( value ) {
			return value === undefined ?
				jQuery.text( this ) :
				this.empty().each(function() {
					if ( this.nodeType === 1 || this.nodeType === 11 || this.nodeType === 9 ) {
						this.textContent = value;
					}
				});
		}, null, value, arguments.length );
	},

	append: function() {
		return this.domManip( arguments, function( elem ) {
			if ( this.nodeType === 1 || this.nodeType === 11 || this.nodeType === 9 ) {
				var target = manipulationTarget( this, elem );
				target.appendChild( elem );
			}
		});
	},

	prepend: function() {
		return this.domManip( arguments, function( elem ) {
			if ( this.nodeType === 1 || this.nodeType === 11 || this.nodeType === 9 ) {
				var target = manipulationTarget( this, elem );
				target.insertBefore( elem, target.firstChild );
			}
		});
	},

	before: function() {
		return this.domManip( arguments, function( elem ) {
			if ( this.parentNode ) {
				this.parentNode.insertBefore( elem, this );
			}
		});
	},

	after: function() {
		return this.domManip( arguments, function( elem ) {
			if ( this.parentNode ) {
				this.parentNode.insertBefore( elem, this.nextSibling );
			}
		});
	},

	remove: function( selector, keepData /* Internal Use Only */ ) {
		var elem,
			elems = selector ? jQuery.filter( selector, this ) : this,
			i = 0;

		for ( ; (elem = elems[i]) != null; i++ ) {
			if ( !keepData && elem.nodeType === 1 ) {
				jQuery.cleanData( getAll( elem ) );
			}

			if ( elem.parentNode ) {
				if ( keepData && jQuery.contains( elem.ownerDocument, elem ) ) {
					setGlobalEval( getAll( elem, "script" ) );
				}
				elem.parentNode.removeChild( elem );
			}
		}

		return this;
	},

	empty: function() {
		var elem,
			i = 0;

		for ( ; (elem = this[i]) != null; i++ ) {
			if ( elem.nodeType === 1 ) {

				// Prevent memory leaks
				jQuery.cleanData( getAll( elem, false ) );

				// Remove any remaining nodes
				elem.textContent = "";
			}
		}

		return this;
	},

	clone: function( dataAndEvents, deepDataAndEvents ) {
		dataAndEvents = dataAndEvents == null ? false : dataAndEvents;
		deepDataAndEvents = deepDataAndEvents == null ? dataAndEvents : deepDataAndEvents;

		return this.map(function() {
			return jQuery.clone( this, dataAndEvents, deepDataAndEvents );
		});
	},

	html: function( value ) {
		return access( this, function( value ) {
			var elem = this[ 0 ] || {},
				i = 0,
				l = this.length;

			if ( value === undefined && elem.nodeType === 1 ) {
				return elem.innerHTML;
			}

			// See if we can take a shortcut and just use innerHTML
			if ( typeof value === "string" && !rnoInnerhtml.test( value ) &&
				!wrapMap[ ( rtagName.exec( value ) || [ "", "" ] )[ 1 ].toLowerCase() ] ) {

				value = value.replace( rxhtmlTag, "<$1></$2>" );

				try {
					for ( ; i < l; i++ ) {
						elem = this[ i ] || {};

						// Remove element nodes and prevent memory leaks
						if ( elem.nodeType === 1 ) {
							jQuery.cleanData( getAll( elem, false ) );
							elem.innerHTML = value;
						}
					}

					elem = 0;

				// If using innerHTML throws an exception, use the fallback method
				} catch( e ) {}
			}

			if ( elem ) {
				this.empty().append( value );
			}
		}, null, value, arguments.length );
	},

	replaceWith: function() {
		var arg = arguments[ 0 ];

		// Make the changes, replacing each context element with the new content
		this.domManip( arguments, function( elem ) {
			arg = this.parentNode;

			jQuery.cleanData( getAll( this ) );

			if ( arg ) {
				arg.replaceChild( elem, this );
			}
		});

		// Force removal if there was no new content (e.g., from empty arguments)
		return arg && (arg.length || arg.nodeType) ? this : this.remove();
	},

	detach: function( selector ) {
		return this.remove( selector, true );
	},

	domManip: function( args, callback ) {

		// Flatten any nested arrays
		args = concat.apply( [], args );

		var fragment, first, scripts, hasScripts, node, doc,
			i = 0,
			l = this.length,
			set = this,
			iNoClone = l - 1,
			value = args[ 0 ],
			isFunction = jQuery.isFunction( value );

		// We can't cloneNode fragments that contain checked, in WebKit
		if ( isFunction ||
				( l > 1 && typeof value === "string" &&
					!support.checkClone && rchecked.test( value ) ) ) {
			return this.each(function( index ) {
				var self = set.eq( index );
				if ( isFunction ) {
					args[ 0 ] = value.call( this, index, self.html() );
				}
				self.domManip( args, callback );
			});
		}

		if ( l ) {
			fragment = jQuery.buildFragment( args, this[ 0 ].ownerDocument, false, this );
			first = fragment.firstChild;

			if ( fragment.childNodes.length === 1 ) {
				fragment = first;
			}

			if ( first ) {
				scripts = jQuery.map( getAll( fragment, "script" ), disableScript );
				hasScripts = scripts.length;

				// Use the original fragment for the last item instead of the first because it can end up
				// being emptied incorrectly in certain situations (#8070).
				for ( ; i < l; i++ ) {
					node = fragment;

					if ( i !== iNoClone ) {
						node = jQuery.clone( node, true, true );

						// Keep references to cloned scripts for later restoration
						if ( hasScripts ) {
							// Support: QtWebKit
							// jQuery.merge because push.apply(_, arraylike) throws
							jQuery.merge( scripts, getAll( node, "script" ) );
						}
					}

					callback.call( this[ i ], node, i );
				}

				if ( hasScripts ) {
					doc = scripts[ scripts.length - 1 ].ownerDocument;

					// Reenable scripts
					jQuery.map( scripts, restoreScript );

					// Evaluate executable scripts on first document insertion
					for ( i = 0; i < hasScripts; i++ ) {
						node = scripts[ i ];
						if ( rscriptType.test( node.type || "" ) &&
							!data_priv.access( node, "globalEval" ) && jQuery.contains( doc, node ) ) {

							if ( node.src ) {
								// Optional AJAX dependency, but won't run scripts if not present
								if ( jQuery._evalUrl ) {
									jQuery._evalUrl( node.src );
								}
							} else {
								jQuery.globalEval( node.textContent.replace( rcleanScript, "" ) );
							}
						}
					}
				}
			}
		}

		return this;
	}
});

jQuery.each({
	appendTo: "append",
	prependTo: "prepend",
	insertBefore: "before",
	insertAfter: "after",
	replaceAll: "replaceWith"
}, function( name, original ) {
	jQuery.fn[ name ] = function( selector ) {
		var elems,
			ret = [],
			insert = jQuery( selector ),
			last = insert.length - 1,
			i = 0;

		for ( ; i <= last; i++ ) {
			elems = i === last ? this : this.clone( true );
			jQuery( insert[ i ] )[ original ]( elems );

			// Support: QtWebKit
			// .get() because push.apply(_, arraylike) throws
			push.apply( ret, elems.get() );
		}

		return this.pushStack( ret );
	};
});


var iframe,
	elemdisplay = {};

/**
 * Retrieve the actual display of a element
 * @param {String} name nodeName of the element
 * @param {Object} doc Document object
 */
// Called only from within defaultDisplay
function actualDisplay( name, doc ) {
	var style,
		elem = jQuery( doc.createElement( name ) ).appendTo( doc.body ),

		// getDefaultComputedStyle might be reliably used only on attached element
		display = window.getDefaultComputedStyle && ( style = window.getDefaultComputedStyle( elem[ 0 ] ) ) ?

			// Use of this method is a temporary fix (more like optimization) until something better comes along,
			// since it was removed from specification and supported only in FF
			style.display : jQuery.css( elem[ 0 ], "display" );

	// We don't have any data stored on the element,
	// so use "detach" method as fast way to get rid of the element
	elem.detach();

	return display;
}

/**
 * Try to determine the default display value of an element
 * @param {String} nodeName
 */
function defaultDisplay( nodeName ) {
	var doc = document,
		display = elemdisplay[ nodeName ];

	if ( !display ) {
		display = actualDisplay( nodeName, doc );

		// If the simple way fails, read from inside an iframe
		if ( display === "none" || !display ) {

			// Use the already-created iframe if possible
			iframe = (iframe || jQuery( "<iframe frameborder='0' width='0' height='0'/>" )).appendTo( doc.documentElement );

			// Always write a new HTML skeleton so Webkit and Firefox don't choke on reuse
			doc = iframe[ 0 ].contentDocument;

			// Support: IE
			doc.write();
			doc.close();

			display = actualDisplay( nodeName, doc );
			iframe.detach();
		}

		// Store the correct default display
		elemdisplay[ nodeName ] = display;
	}

	return display;
}
var rmargin = (/^margin/);

var rnumnonpx = new RegExp( "^(" + pnum + ")(?!px)[a-z%]+$", "i" );

var getStyles = function( elem ) {
		// Support: IE<=11+, Firefox<=30+ (#15098, #14150)
		// IE throws on elements created in popups
		// FF meanwhile throws on frame elements through "defaultView.getComputedStyle"
		if ( elem.ownerDocument.defaultView.opener ) {
			return elem.ownerDocument.defaultView.getComputedStyle( elem, null );
		}

		return window.getComputedStyle( elem, null );
	};



function curCSS( elem, name, computed ) {
	var width, minWidth, maxWidth, ret,
		style = elem.style;

	computed = computed || getStyles( elem );

	// Support: IE9
	// getPropertyValue is only needed for .css('filter') (#12537)
	if ( computed ) {
		ret = computed.getPropertyValue( name ) || computed[ name ];
	}

	if ( computed ) {

		if ( ret === "" && !jQuery.contains( elem.ownerDocument, elem ) ) {
			ret = jQuery.style( elem, name );
		}

		// Support: iOS < 6
		// A tribute to the "awesome hack by Dean Edwards"
		// iOS < 6 (at least) returns percentage for a larger set of values, but width seems to be reliably pixels
		// this is against the CSSOM draft spec: http://dev.w3.org/csswg/cssom/#resolved-values
		if ( rnumnonpx.test( ret ) && rmargin.test( name ) ) {

			// Remember the original values
			width = style.width;
			minWidth = style.minWidth;
			maxWidth = style.maxWidth;

			// Put in the new values to get a computed value out
			style.minWidth = style.maxWidth = style.width = ret;
			ret = computed.width;

			// Revert the changed values
			style.width = width;
			style.minWidth = minWidth;
			style.maxWidth = maxWidth;
		}
	}

	return ret !== undefined ?
		// Support: IE
		// IE returns zIndex value as an integer.
		ret + "" :
		ret;
}


function addGetHookIf( conditionFn, hookFn ) {
	// Define the hook, we'll check on the first run if it's really needed.
	return {
		get: function() {
			if ( conditionFn() ) {
				// Hook not needed (or it's not possible to use it due
				// to missing dependency), remove it.
				delete this.get;
				return;
			}

			// Hook needed; redefine it so that the support test is not executed again.
			return (this.get = hookFn).apply( this, arguments );
		}
	};
}


(function() {
	var pixelPositionVal, boxSizingReliableVal,
		docElem = document.documentElement,
		container = document.createElement( "div" ),
		div = document.createElement( "div" );

	if ( !div.style ) {
		return;
	}

	// Support: IE9-11+
	// Style of cloned element affects source element cloned (#8908)
	div.style.backgroundClip = "content-box";
	div.cloneNode( true ).style.backgroundClip = "";
	support.clearCloneStyle = div.style.backgroundClip === "content-box";

	container.style.cssText = "border:0;width:0;height:0;top:0;left:-9999px;margin-top:1px;" +
		"position:absolute";
	container.appendChild( div );

	// Executing both pixelPosition & boxSizingReliable tests require only one layout
	// so they're executed at the same time to save the second computation.
	function computePixelPositionAndBoxSizingReliable() {
		div.style.cssText =
			// Support: Firefox<29, Android 2.3
			// Vendor-prefix box-sizing
			"-webkit-box-sizing:border-box;-moz-box-sizing:border-box;" +
			"box-sizing:border-box;display:block;margin-top:1%;top:1%;" +
			"border:1px;padding:1px;width:4px;position:absolute";
		div.innerHTML = "";
		docElem.appendChild( container );

		var divStyle = window.getComputedStyle( div, null );
		pixelPositionVal = divStyle.top !== "1%";
		boxSizingReliableVal = divStyle.width === "4px";

		docElem.removeChild( container );
	}

	// Support: node.js jsdom
	// Don't assume that getComputedStyle is a property of the global object
	if ( window.getComputedStyle ) {
		jQuery.extend( support, {
			pixelPosition: function() {

				// This test is executed only once but we still do memoizing
				// since we can use the boxSizingReliable pre-computing.
				// No need to check if the test was already performed, though.
				computePixelPositionAndBoxSizingReliable();
				return pixelPositionVal;
			},
			boxSizingReliable: function() {
				if ( boxSizingReliableVal == null ) {
					computePixelPositionAndBoxSizingReliable();
				}
				return boxSizingReliableVal;
			},
			reliableMarginRight: function() {

				// Support: Android 2.3
				// Check if div with explicit width and no margin-right incorrectly
				// gets computed margin-right based on width of container. (#3333)
				// WebKit Bug 13343 - getComputedStyle returns wrong value for margin-right
				// This support function is only executed once so no memoizing is needed.
				var ret,
					marginDiv = div.appendChild( document.createElement( "div" ) );

				// Reset CSS: box-sizing; display; margin; border; padding
				marginDiv.style.cssText = div.style.cssText =
					// Support: Firefox<29, Android 2.3
					// Vendor-prefix box-sizing
					"-webkit-box-sizing:content-box;-moz-box-sizing:content-box;" +
					"box-sizing:content-box;display:block;margin:0;border:0;padding:0";
				marginDiv.style.marginRight = marginDiv.style.width = "0";
				div.style.width = "1px";
				docElem.appendChild( container );

				ret = !parseFloat( window.getComputedStyle( marginDiv, null ).marginRight );

				docElem.removeChild( container );
				div.removeChild( marginDiv );

				return ret;
			}
		});
	}
})();


// A method for quickly swapping in/out CSS properties to get correct calculations.
jQuery.swap = function( elem, options, callback, args ) {
	var ret, name,
		old = {};

	// Remember the old values, and insert the new ones
	for ( name in options ) {
		old[ name ] = elem.style[ name ];
		elem.style[ name ] = options[ name ];
	}

	ret = callback.apply( elem, args || [] );

	// Revert the old values
	for ( name in options ) {
		elem.style[ name ] = old[ name ];
	}

	return ret;
};


var
	// Swappable if display is none or starts with table except "table", "table-cell", or "table-caption"
	// See here for display values: https://developer.mozilla.org/en-US/docs/CSS/display
	rdisplayswap = /^(none|table(?!-c[ea]).+)/,
	rnumsplit = new RegExp( "^(" + pnum + ")(.*)$", "i" ),
	rrelNum = new RegExp( "^([+-])=(" + pnum + ")", "i" ),

	cssShow = { position: "absolute", visibility: "hidden", display: "block" },
	cssNormalTransform = {
		letterSpacing: "0",
		fontWeight: "400"
	},

	cssPrefixes = [ "Webkit", "O", "Moz", "ms" ];

// Return a css property mapped to a potentially vendor prefixed property
function vendorPropName( style, name ) {

	// Shortcut for names that are not vendor prefixed
	if ( name in style ) {
		return name;
	}

	// Check for vendor prefixed names
	var capName = name[0].toUpperCase() + name.slice(1),
		origName = name,
		i = cssPrefixes.length;

	while ( i-- ) {
		name = cssPrefixes[ i ] + capName;
		if ( name in style ) {
			return name;
		}
	}

	return origName;
}

function setPositiveNumber( elem, value, subtract ) {
	var matches = rnumsplit.exec( value );
	return matches ?
		// Guard against undefined "subtract", e.g., when used as in cssHooks
		Math.max( 0, matches[ 1 ] - ( subtract || 0 ) ) + ( matches[ 2 ] || "px" ) :
		value;
}

function augmentWidthOrHeight( elem, name, extra, isBorderBox, styles ) {
	var i = extra === ( isBorderBox ? "border" : "content" ) ?
		// If we already have the right measurement, avoid augmentation
		4 :
		// Otherwise initialize for horizontal or vertical properties
		name === "width" ? 1 : 0,

		val = 0;

	for ( ; i < 4; i += 2 ) {
		// Both box models exclude margin, so add it if we want it
		if ( extra === "margin" ) {
			val += jQuery.css( elem, extra + cssExpand[ i ], true, styles );
		}

		if ( isBorderBox ) {
			// border-box includes padding, so remove it if we want content
			if ( extra === "content" ) {
				val -= jQuery.css( elem, "padding" + cssExpand[ i ], true, styles );
			}

			// At this point, extra isn't border nor margin, so remove border
			if ( extra !== "margin" ) {
				val -= jQuery.css( elem, "border" + cssExpand[ i ] + "Width", true, styles );
			}
		} else {
			// At this point, extra isn't content, so add padding
			val += jQuery.css( elem, "padding" + cssExpand[ i ], true, styles );

			// At this point, extra isn't content nor padding, so add border
			if ( extra !== "padding" ) {
				val += jQuery.css( elem, "border" + cssExpand[ i ] + "Width", true, styles );
			}
		}
	}

	return val;
}

function getWidthOrHeight( elem, name, extra ) {

	// Start with offset property, which is equivalent to the border-box value
	var valueIsBorderBox = true,
		val = name === "width" ? elem.offsetWidth : elem.offsetHeight,
		styles = getStyles( elem ),
		isBorderBox = jQuery.css( elem, "boxSizing", false, styles ) === "border-box";

	// Some non-html elements return undefined for offsetWidth, so check for null/undefined
	// svg - https://bugzilla.mozilla.org/show_bug.cgi?id=649285
	// MathML - https://bugzilla.mozilla.org/show_bug.cgi?id=491668
	if ( val <= 0 || val == null ) {
		// Fall back to computed then uncomputed css if necessary
		val = curCSS( elem, name, styles );
		if ( val < 0 || val == null ) {
			val = elem.style[ name ];
		}

		// Computed unit is not pixels. Stop here and return.
		if ( rnumnonpx.test(val) ) {
			return val;
		}

		// Check for style in case a browser which returns unreliable values
		// for getComputedStyle silently falls back to the reliable elem.style
		valueIsBorderBox = isBorderBox &&
			( support.boxSizingReliable() || val === elem.style[ name ] );

		// Normalize "", auto, and prepare for extra
		val = parseFloat( val ) || 0;
	}

	// Use the active box-sizing model to add/subtract irrelevant styles
	return ( val +
		augmentWidthOrHeight(
			elem,
			name,
			extra || ( isBorderBox ? "border" : "content" ),
			valueIsBorderBox,
			styles
		)
	) + "px";
}

function showHide( elements, show ) {
	var display, elem, hidden,
		values = [],
		index = 0,
		length = elements.length;

	for ( ; index < length; index++ ) {
		elem = elements[ index ];
		if ( !elem.style ) {
			continue;
		}

		values[ index ] = data_priv.get( elem, "olddisplay" );
		display = elem.style.display;
		if ( show ) {
			// Reset the inline display of this element to learn if it is
			// being hidden by cascaded rules or not
			if ( !values[ index ] && display === "none" ) {
				elem.style.display = "";
			}

			// Set elements which have been overridden with display: none
			// in a stylesheet to whatever the default browser style is
			// for such an element
			if ( elem.style.display === "" && isHidden( elem ) ) {
				values[ index ] = data_priv.access( elem, "olddisplay", defaultDisplay(elem.nodeName) );
			}
		} else {
			hidden = isHidden( elem );

			if ( display !== "none" || !hidden ) {
				data_priv.set( elem, "olddisplay", hidden ? display : jQuery.css( elem, "display" ) );
			}
		}
	}

	// Set the display of most of the elements in a second loop
	// to avoid the constant reflow
	for ( index = 0; index < length; index++ ) {
		elem = elements[ index ];
		if ( !elem.style ) {
			continue;
		}
		if ( !show || elem.style.display === "none" || elem.style.display === "" ) {
			elem.style.display = show ? values[ index ] || "" : "none";
		}
	}

	return elements;
}

jQuery.extend({

	// Add in style property hooks for overriding the default
	// behavior of getting and setting a style property
	cssHooks: {
		opacity: {
			get: function( elem, computed ) {
				if ( computed ) {

					// We should always get a number back from opacity
					var ret = curCSS( elem, "opacity" );
					return ret === "" ? "1" : ret;
				}
			}
		}
	},

	// Don't automatically add "px" to these possibly-unitless properties
	cssNumber: {
		"columnCount": true,
		"fillOpacity": true,
		"flexGrow": true,
		"flexShrink": true,
		"fontWeight": true,
		"lineHeight": true,
		"opacity": true,
		"order": true,
		"orphans": true,
		"widows": true,
		"zIndex": true,
		"zoom": true
	},

	// Add in properties whose names you wish to fix before
	// setting or getting the value
	cssProps: {
		"float": "cssFloat"
	},

	// Get and set the style property on a DOM Node
	style: function( elem, name, value, extra ) {

		// Don't set styles on text and comment nodes
		if ( !elem || elem.nodeType === 3 || elem.nodeType === 8 || !elem.style ) {
			return;
		}

		// Make sure that we're working with the right name
		var ret, type, hooks,
			origName = jQuery.camelCase( name ),
			style = elem.style;

		name = jQuery.cssProps[ origName ] || ( jQuery.cssProps[ origName ] = vendorPropName( style, origName ) );

		// Gets hook for the prefixed version, then unprefixed version
		hooks = jQuery.cssHooks[ name ] || jQuery.cssHooks[ origName ];

		// Check if we're setting a value
		if ( value !== undefined ) {
			type = typeof value;

			// Convert "+=" or "-=" to relative numbers (#7345)
			if ( type === "string" && (ret = rrelNum.exec( value )) ) {
				value = ( ret[1] + 1 ) * ret[2] + parseFloat( jQuery.css( elem, name ) );
				// Fixes bug #9237
				type = "number";
			}

			// Make sure that null and NaN values aren't set (#7116)
			if ( value == null || value !== value ) {
				return;
			}

			// If a number, add 'px' to the (except for certain CSS properties)
			if ( type === "number" && !jQuery.cssNumber[ origName ] ) {
				value += "px";
			}

			// Support: IE9-11+
			// background-* props affect original clone's values
			if ( !support.clearCloneStyle && value === "" && name.indexOf( "background" ) === 0 ) {
				style[ name ] = "inherit";
			}

			// If a hook was provided, use that value, otherwise just set the specified value
			if ( !hooks || !("set" in hooks) || (value = hooks.set( elem, value, extra )) !== undefined ) {
				style[ name ] = value;
			}

		} else {
			// If a hook was provided get the non-computed value from there
			if ( hooks && "get" in hooks && (ret = hooks.get( elem, false, extra )) !== undefined ) {
				return ret;
			}

			// Otherwise just get the value from the style object
			return style[ name ];
		}
	},

	css: function( elem, name, extra, styles ) {
		var val, num, hooks,
			origName = jQuery.camelCase( name );

		// Make sure that we're working with the right name
		name = jQuery.cssProps[ origName ] || ( jQuery.cssProps[ origName ] = vendorPropName( elem.style, origName ) );

		// Try prefixed name followed by the unprefixed name
		hooks = jQuery.cssHooks[ name ] || jQuery.cssHooks[ origName ];

		// If a hook was provided get the computed value from there
		if ( hooks && "get" in hooks ) {
			val = hooks.get( elem, true, extra );
		}

		// Otherwise, if a way to get the computed value exists, use that
		if ( val === undefined ) {
			val = curCSS( elem, name, styles );
		}

		// Convert "normal" to computed value
		if ( val === "normal" && name in cssNormalTransform ) {
			val = cssNormalTransform[ name ];
		}

		// Make numeric if forced or a qualifier was provided and val looks numeric
		if ( extra === "" || extra ) {
			num = parseFloat( val );
			return extra === true || jQuery.isNumeric( num ) ? num || 0 : val;
		}
		return val;
	}
});

jQuery.each([ "height", "width" ], function( i, name ) {
	jQuery.cssHooks[ name ] = {
		get: function( elem, computed, extra ) {
			if ( computed ) {

				// Certain elements can have dimension info if we invisibly show them
				// but it must have a current display style that would benefit
				return rdisplayswap.test( jQuery.css( elem, "display" ) ) && elem.offsetWidth === 0 ?
					jQuery.swap( elem, cssShow, function() {
						return getWidthOrHeight( elem, name, extra );
					}) :
					getWidthOrHeight( elem, name, extra );
			}
		},

		set: function( elem, value, extra ) {
			var styles = extra && getStyles( elem );
			return setPositiveNumber( elem, value, extra ?
				augmentWidthOrHeight(
					elem,
					name,
					extra,
					jQuery.css( elem, "boxSizing", false, styles ) === "border-box",
					styles
				) : 0
			);
		}
	};
});

// Support: Android 2.3
jQuery.cssHooks.marginRight = addGetHookIf( support.reliableMarginRight,
	function( elem, computed ) {
		if ( computed ) {
			return jQuery.swap( elem, { "display": "inline-block" },
				curCSS, [ elem, "marginRight" ] );
		}
	}
);

// These hooks are used by animate to expand properties
jQuery.each({
	margin: "",
	padding: "",
	border: "Width"
}, function( prefix, suffix ) {
	jQuery.cssHooks[ prefix + suffix ] = {
		expand: function( value ) {
			var i = 0,
				expanded = {},

				// Assumes a single number if not a string
				parts = typeof value === "string" ? value.split(" ") : [ value ];

			for ( ; i < 4; i++ ) {
				expanded[ prefix + cssExpand[ i ] + suffix ] =
					parts[ i ] || parts[ i - 2 ] || parts[ 0 ];
			}

			return expanded;
		}
	};

	if ( !rmargin.test( prefix ) ) {
		jQuery.cssHooks[ prefix + suffix ].set = setPositiveNumber;
	}
});

jQuery.fn.extend({
	css: function( name, value ) {
		return access( this, function( elem, name, value ) {
			var styles, len,
				map = {},
				i = 0;

			if ( jQuery.isArray( name ) ) {
				styles = getStyles( elem );
				len = name.length;

				for ( ; i < len; i++ ) {
					map[ name[ i ] ] = jQuery.css( elem, name[ i ], false, styles );
				}

				return map;
			}

			return value !== undefined ?
				jQuery.style( elem, name, value ) :
				jQuery.css( elem, name );
		}, name, value, arguments.length > 1 );
	},
	show: function() {
		return showHide( this, true );
	},
	hide: function() {
		return showHide( this );
	},
	toggle: function( state ) {
		if ( typeof state === "boolean" ) {
			return state ? this.show() : this.hide();
		}

		return this.each(function() {
			if ( isHidden( this ) ) {
				jQuery( this ).show();
			} else {
				jQuery( this ).hide();
			}
		});
	}
});


function Tween( elem, options, prop, end, easing ) {
	return new Tween.prototype.init( elem, options, prop, end, easing );
}
jQuery.Tween = Tween;

Tween.prototype = {
	constructor: Tween,
	init: function( elem, options, prop, end, easing, unit ) {
		this.elem = elem;
		this.prop = prop;
		this.easing = easing || "swing";
		this.options = options;
		this.start = this.now = this.cur();
		this.end = end;
		this.unit = unit || ( jQuery.cssNumber[ prop ] ? "" : "px" );
	},
	cur: function() {
		var hooks = Tween.propHooks[ this.prop ];

		return hooks && hooks.get ?
			hooks.get( this ) :
			Tween.propHooks._default.get( this );
	},
	run: function( percent ) {
		var eased,
			hooks = Tween.propHooks[ this.prop ];

		if ( this.options.duration ) {
			this.pos = eased = jQuery.easing[ this.easing ](
				percent, this.options.duration * percent, 0, 1, this.options.duration
			);
		} else {
			this.pos = eased = percent;
		}
		this.now = ( this.end - this.start ) * eased + this.start;

		if ( this.options.step ) {
			this.options.step.call( this.elem, this.now, this );
		}

		if ( hooks && hooks.set ) {
			hooks.set( this );
		} else {
			Tween.propHooks._default.set( this );
		}
		return this;
	}
};

Tween.prototype.init.prototype = Tween.prototype;

Tween.propHooks = {
	_default: {
		get: function( tween ) {
			var result;

			if ( tween.elem[ tween.prop ] != null &&
				(!tween.elem.style || tween.elem.style[ tween.prop ] == null) ) {
				return tween.elem[ tween.prop ];
			}

			// Passing an empty string as a 3rd parameter to .css will automatically
			// attempt a parseFloat and fallback to a string if the parse fails.
			// Simple values such as "10px" are parsed to Float;
			// complex values such as "rotate(1rad)" are returned as-is.
			result = jQuery.css( tween.elem, tween.prop, "" );
			// Empty strings, null, undefined and "auto" are converted to 0.
			return !result || result === "auto" ? 0 : result;
		},
		set: function( tween ) {
			// Use step hook for back compat.
			// Use cssHook if its there.
			// Use .style if available and use plain properties where available.
			if ( jQuery.fx.step[ tween.prop ] ) {
				jQuery.fx.step[ tween.prop ]( tween );
			} else if ( tween.elem.style && ( tween.elem.style[ jQuery.cssProps[ tween.prop ] ] != null || jQuery.cssHooks[ tween.prop ] ) ) {
				jQuery.style( tween.elem, tween.prop, tween.now + tween.unit );
			} else {
				tween.elem[ tween.prop ] = tween.now;
			}
		}
	}
};

// Support: IE9
// Panic based approach to setting things on disconnected nodes
Tween.propHooks.scrollTop = Tween.propHooks.scrollLeft = {
	set: function( tween ) {
		if ( tween.elem.nodeType && tween.elem.parentNode ) {
			tween.elem[ tween.prop ] = tween.now;
		}
	}
};

jQuery.easing = {
	linear: function( p ) {
		return p;
	},
	swing: function( p ) {
		return 0.5 - Math.cos( p * Math.PI ) / 2;
	}
};

jQuery.fx = Tween.prototype.init;

// Back Compat <1.8 extension point
jQuery.fx.step = {};




var
	fxNow, timerId,
	rfxtypes = /^(?:toggle|show|hide)$/,
	rfxnum = new RegExp( "^(?:([+-])=|)(" + pnum + ")([a-z%]*)$", "i" ),
	rrun = /queueHooks$/,
	animationPrefilters = [ defaultPrefilter ],
	tweeners = {
		"*": [ function( prop, value ) {
			var tween = this.createTween( prop, value ),
				target = tween.cur(),
				parts = rfxnum.exec( value ),
				unit = parts && parts[ 3 ] || ( jQuery.cssNumber[ prop ] ? "" : "px" ),

				// Starting value computation is required for potential unit mismatches
				start = ( jQuery.cssNumber[ prop ] || unit !== "px" && +target ) &&
					rfxnum.exec( jQuery.css( tween.elem, prop ) ),
				scale = 1,
				maxIterations = 20;

			if ( start && start[ 3 ] !== unit ) {
				// Trust units reported by jQuery.css
				unit = unit || start[ 3 ];

				// Make sure we update the tween properties later on
				parts = parts || [];

				// Iteratively approximate from a nonzero starting point
				start = +target || 1;

				do {
					// If previous iteration zeroed out, double until we get *something*.
					// Use string for doubling so we don't accidentally see scale as unchanged below
					scale = scale || ".5";

					// Adjust and apply
					start = start / scale;
					jQuery.style( tween.elem, prop, start + unit );

				// Update scale, tolerating zero or NaN from tween.cur(),
				// break the loop if scale is unchanged or perfect, or if we've just had enough
				} while ( scale !== (scale = tween.cur() / target) && scale !== 1 && --maxIterations );
			}

			// Update tween properties
			if ( parts ) {
				start = tween.start = +start || +target || 0;
				tween.unit = unit;
				// If a +=/-= token was provided, we're doing a relative animation
				tween.end = parts[ 1 ] ?
					start + ( parts[ 1 ] + 1 ) * parts[ 2 ] :
					+parts[ 2 ];
			}

			return tween;
		} ]
	};

// Animations created synchronously will run synchronously
function createFxNow() {
	setTimeout(function() {
		fxNow = undefined;
	});
	return ( fxNow = jQuery.now() );
}

// Generate parameters to create a standard animation
function genFx( type, includeWidth ) {
	var which,
		i = 0,
		attrs = { height: type };

	// If we include width, step value is 1 to do all cssExpand values,
	// otherwise step value is 2 to skip over Left and Right
	includeWidth = includeWidth ? 1 : 0;
	for ( ; i < 4 ; i += 2 - includeWidth ) {
		which = cssExpand[ i ];
		attrs[ "margin" + which ] = attrs[ "padding" + which ] = type;
	}

	if ( includeWidth ) {
		attrs.opacity = attrs.width = type;
	}

	return attrs;
}

function createTween( value, prop, animation ) {
	var tween,
		collection = ( tweeners[ prop ] || [] ).concat( tweeners[ "*" ] ),
		index = 0,
		length = collection.length;
	for ( ; index < length; index++ ) {
		if ( (tween = collection[ index ].call( animation, prop, value )) ) {

			// We're done with this property
			return tween;
		}
	}
}

function defaultPrefilter( elem, props, opts ) {
	/* jshint validthis: true */
	var prop, value, toggle, tween, hooks, oldfire, display, checkDisplay,
		anim = this,
		orig = {},
		style = elem.style,
		hidden = elem.nodeType && isHidden( elem ),
		dataShow = data_priv.get( elem, "fxshow" );

	// Handle queue: false promises
	if ( !opts.queue ) {
		hooks = jQuery._queueHooks( elem, "fx" );
		if ( hooks.unqueued == null ) {
			hooks.unqueued = 0;
			oldfire = hooks.empty.fire;
			hooks.empty.fire = function() {
				if ( !hooks.unqueued ) {
					oldfire();
				}
			};
		}
		hooks.unqueued++;

		anim.always(function() {
			// Ensure the complete handler is called before this completes
			anim.always(function() {
				hooks.unqueued--;
				if ( !jQuery.queue( elem, "fx" ).length ) {
					hooks.empty.fire();
				}
			});
		});
	}

	// Height/width overflow pass
	if ( elem.nodeType === 1 && ( "height" in props || "width" in props ) ) {
		// Make sure that nothing sneaks out
		// Record all 3 overflow attributes because IE9-10 do not
		// change the overflow attribute when overflowX and
		// overflowY are set to the same value
		opts.overflow = [ style.overflow, style.overflowX, style.overflowY ];

		// Set display property to inline-block for height/width
		// animations on inline elements that are having width/height animated
		display = jQuery.css( elem, "display" );

		// Test default display if display is currently "none"
		checkDisplay = display === "none" ?
			data_priv.get( elem, "olddisplay" ) || defaultDisplay( elem.nodeName ) : display;

		if ( checkDisplay === "inline" && jQuery.css( elem, "float" ) === "none" ) {
			style.display = "inline-block";
		}
	}

	if ( opts.overflow ) {
		style.overflow = "hidden";
		anim.always(function() {
			style.overflow = opts.overflow[ 0 ];
			style.overflowX = opts.overflow[ 1 ];
			style.overflowY = opts.overflow[ 2 ];
		});
	}

	// show/hide pass
	for ( prop in props ) {
		value = props[ prop ];
		if ( rfxtypes.exec( value ) ) {
			delete props[ prop ];
			toggle = toggle || value === "toggle";
			if ( value === ( hidden ? "hide" : "show" ) ) {

				// If there is dataShow left over from a stopped hide or show and we are going to proceed with show, we should pretend to be hidden
				if ( value === "show" && dataShow && dataShow[ prop ] !== undefined ) {
					hidden = true;
				} else {
					continue;
				}
			}
			orig[ prop ] = dataShow && dataShow[ prop ] || jQuery.style( elem, prop );

		// Any non-fx value stops us from restoring the original display value
		} else {
			display = undefined;
		}
	}

	if ( !jQuery.isEmptyObject( orig ) ) {
		if ( dataShow ) {
			if ( "hidden" in dataShow ) {
				hidden = dataShow.hidden;
			}
		} else {
			dataShow = data_priv.access( elem, "fxshow", {} );
		}

		// Store state if its toggle - enables .stop().toggle() to "reverse"
		if ( toggle ) {
			dataShow.hidden = !hidden;
		}
		if ( hidden ) {
			jQuery( elem ).show();
		} else {
			anim.done(function() {
				jQuery( elem ).hide();
			});
		}
		anim.done(function() {
			var prop;

			data_priv.remove( elem, "fxshow" );
			for ( prop in orig ) {
				jQuery.style( elem, prop, orig[ prop ] );
			}
		});
		for ( prop in orig ) {
			tween = createTween( hidden ? dataShow[ prop ] : 0, prop, anim );

			if ( !( prop in dataShow ) ) {
				dataShow[ prop ] = tween.start;
				if ( hidden ) {
					tween.end = tween.start;
					tween.start = prop === "width" || prop === "height" ? 1 : 0;
				}
			}
		}

	// If this is a noop like .hide().hide(), restore an overwritten display value
	} else if ( (display === "none" ? defaultDisplay( elem.nodeName ) : display) === "inline" ) {
		style.display = display;
	}
}

function propFilter( props, specialEasing ) {
	var index, name, easing, value, hooks;

	// camelCase, specialEasing and expand cssHook pass
	for ( index in props ) {
		name = jQuery.camelCase( index );
		easing = specialEasing[ name ];
		value = props[ index ];
		if ( jQuery.isArray( value ) ) {
			easing = value[ 1 ];
			value = props[ index ] = value[ 0 ];
		}

		if ( index !== name ) {
			props[ name ] = value;
			delete props[ index ];
		}

		hooks = jQuery.cssHooks[ name ];
		if ( hooks && "expand" in hooks ) {
			value = hooks.expand( value );
			delete props[ name ];

			// Not quite $.extend, this won't overwrite existing keys.
			// Reusing 'index' because we have the correct "name"
			for ( index in value ) {
				if ( !( index in props ) ) {
					props[ index ] = value[ index ];
					specialEasing[ index ] = easing;
				}
			}
		} else {
			specialEasing[ name ] = easing;
		}
	}
}

function Animation( elem, properties, options ) {
	var result,
		stopped,
		index = 0,
		length = animationPrefilters.length,
		deferred = jQuery.Deferred().always( function() {
			// Don't match elem in the :animated selector
			delete tick.elem;
		}),
		tick = function() {
			if ( stopped ) {
				return false;
			}
			var currentTime = fxNow || createFxNow(),
				remaining = Math.max( 0, animation.startTime + animation.duration - currentTime ),
				// Support: Android 2.3
				// Archaic crash bug won't allow us to use `1 - ( 0.5 || 0 )` (#12497)
				temp = remaining / animation.duration || 0,
				percent = 1 - temp,
				index = 0,
				length = animation.tweens.length;

			for ( ; index < length ; index++ ) {
				animation.tweens[ index ].run( percent );
			}

			deferred.notifyWith( elem, [ animation, percent, remaining ]);

			if ( percent < 1 && length ) {
				return remaining;
			} else {
				deferred.resolveWith( elem, [ animation ] );
				return false;
			}
		},
		animation = deferred.promise({
			elem: elem,
			props: jQuery.extend( {}, properties ),
			opts: jQuery.extend( true, { specialEasing: {} }, options ),
			originalProperties: properties,
			originalOptions: options,
			startTime: fxNow || createFxNow(),
			duration: options.duration,
			tweens: [],
			createTween: function( prop, end ) {
				var tween = jQuery.Tween( elem, animation.opts, prop, end,
						animation.opts.specialEasing[ prop ] || animation.opts.easing );
				animation.tweens.push( tween );
				return tween;
			},
			stop: function( gotoEnd ) {
				var index = 0,
					// If we are going to the end, we want to run all the tweens
					// otherwise we skip this part
					length = gotoEnd ? animation.tweens.length : 0;
				if ( stopped ) {
					return this;
				}
				stopped = true;
				for ( ; index < length ; index++ ) {
					animation.tweens[ index ].run( 1 );
				}

				// Resolve when we played the last frame; otherwise, reject
				if ( gotoEnd ) {
					deferred.resolveWith( elem, [ animation, gotoEnd ] );
				} else {
					deferred.rejectWith( elem, [ animation, gotoEnd ] );
				}
				return this;
			}
		}),
		props = animation.props;

	propFilter( props, animation.opts.specialEasing );

	for ( ; index < length ; index++ ) {
		result = animationPrefilters[ index ].call( animation, elem, props, animation.opts );
		if ( result ) {
			return result;
		}
	}

	jQuery.map( props, createTween, animation );

	if ( jQuery.isFunction( animation.opts.start ) ) {
		animation.opts.start.call( elem, animation );
	}

	jQuery.fx.timer(
		jQuery.extend( tick, {
			elem: elem,
			anim: animation,
			queue: animation.opts.queue
		})
	);

	// attach callbacks from options
	return animation.progress( animation.opts.progress )
		.done( animation.opts.done, animation.opts.complete )
		.fail( animation.opts.fail )
		.always( animation.opts.always );
}

jQuery.Animation = jQuery.extend( Animation, {

	tweener: function( props, callback ) {
		if ( jQuery.isFunction( props ) ) {
			callback = props;
			props = [ "*" ];
		} else {
			props = props.split(" ");
		}

		var prop,
			index = 0,
			length = props.length;

		for ( ; index < length ; index++ ) {
			prop = props[ index ];
			tweeners[ prop ] = tweeners[ prop ] || [];
			tweeners[ prop ].unshift( callback );
		}
	},

	prefilter: function( callback, prepend ) {
		if ( prepend ) {
			animationPrefilters.unshift( callback );
		} else {
			animationPrefilters.push( callback );
		}
	}
});

jQuery.speed = function( speed, easing, fn ) {
	var opt = speed && typeof speed === "object" ? jQuery.extend( {}, speed ) : {
		complete: fn || !fn && easing ||
			jQuery.isFunction( speed ) && speed,
		duration: speed,
		easing: fn && easing || easing && !jQuery.isFunction( easing ) && easing
	};

	opt.duration = jQuery.fx.off ? 0 : typeof opt.duration === "number" ? opt.duration :
		opt.duration in jQuery.fx.speeds ? jQuery.fx.speeds[ opt.duration ] : jQuery.fx.speeds._default;

	// Normalize opt.queue - true/undefined/null -> "fx"
	if ( opt.queue == null || opt.queue === true ) {
		opt.queue = "fx";
	}

	// Queueing
	opt.old = opt.complete;

	opt.complete = function() {
		if ( jQuery.isFunction( opt.old ) ) {
			opt.old.call( this );
		}

		if ( opt.queue ) {
			jQuery.dequeue( this, opt.queue );
		}
	};

	return opt;
};

jQuery.fn.extend({
	fadeTo: function( speed, to, easing, callback ) {

		// Show any hidden elements after setting opacity to 0
		return this.filter( isHidden ).css( "opacity", 0 ).show()

			// Animate to the value specified
			.end().animate({ opacity: to }, speed, easing, callback );
	},
	animate: function( prop, speed, easing, callback ) {
		var empty = jQuery.isEmptyObject( prop ),
			optall = jQuery.speed( speed, easing, callback ),
			doAnimation = function() {
				// Operate on a copy of prop so per-property easing won't be lost
				var anim = Animation( this, jQuery.extend( {}, prop ), optall );

				// Empty animations, or finishing resolves immediately
				if ( empty || data_priv.get( this, "finish" ) ) {
					anim.stop( true );
				}
			};
			doAnimation.finish = doAnimation;

		return empty || optall.queue === false ?
			this.each( doAnimation ) :
			this.queue( optall.queue, doAnimation );
	},
	stop: function( type, clearQueue, gotoEnd ) {
		var stopQueue = function( hooks ) {
			var stop = hooks.stop;
			delete hooks.stop;
			stop( gotoEnd );
		};

		if ( typeof type !== "string" ) {
			gotoEnd = clearQueue;
			clearQueue = type;
			type = undefined;
		}
		if ( clearQueue && type !== false ) {
			this.queue( type || "fx", [] );
		}

		return this.each(function() {
			var dequeue = true,
				index = type != null && type + "queueHooks",
				timers = jQuery.timers,
				data = data_priv.get( this );

			if ( index ) {
				if ( data[ index ] && data[ index ].stop ) {
					stopQueue( data[ index ] );
				}
			} else {
				for ( index in data ) {
					if ( data[ index ] && data[ index ].stop && rrun.test( index ) ) {
						stopQueue( data[ index ] );
					}
				}
			}

			for ( index = timers.length; index--; ) {
				if ( timers[ index ].elem === this && (type == null || timers[ index ].queue === type) ) {
					timers[ index ].anim.stop( gotoEnd );
					dequeue = false;
					timers.splice( index, 1 );
				}
			}

			// Start the next in the queue if the last step wasn't forced.
			// Timers currently will call their complete callbacks, which
			// will dequeue but only if they were gotoEnd.
			if ( dequeue || !gotoEnd ) {
				jQuery.dequeue( this, type );
			}
		});
	},
	finish: function( type ) {
		if ( type !== false ) {
			type = type || "fx";
		}
		return this.each(function() {
			var index,
				data = data_priv.get( this ),
				queue = data[ type + "queue" ],
				hooks = data[ type + "queueHooks" ],
				timers = jQuery.timers,
				length = queue ? queue.length : 0;

			// Enable finishing flag on private data
			data.finish = true;

			// Empty the queue first
			jQuery.queue( this, type, [] );

			if ( hooks && hooks.stop ) {
				hooks.stop.call( this, true );
			}

			// Look for any active animations, and finish them
			for ( index = timers.length; index--; ) {
				if ( timers[ index ].elem === this && timers[ index ].queue === type ) {
					timers[ index ].anim.stop( true );
					timers.splice( index, 1 );
				}
			}

			// Look for any animations in the old queue and finish them
			for ( index = 0; index < length; index++ ) {
				if ( queue[ index ] && queue[ index ].finish ) {
					queue[ index ].finish.call( this );
				}
			}

			// Turn off finishing flag
			delete data.finish;
		});
	}
});

jQuery.each([ "toggle", "show", "hide" ], function( i, name ) {
	var cssFn = jQuery.fn[ name ];
	jQuery.fn[ name ] = function( speed, easing, callback ) {
		return speed == null || typeof speed === "boolean" ?
			cssFn.apply( this, arguments ) :
			this.animate( genFx( name, true ), speed, easing, callback );
	};
});

// Generate shortcuts for custom animations
jQuery.each({
	slideDown: genFx("show"),
	slideUp: genFx("hide"),
	slideToggle: genFx("toggle"),
	fadeIn: { opacity: "show" },
	fadeOut: { opacity: "hide" },
	fadeToggle: { opacity: "toggle" }
}, function( name, props ) {
	jQuery.fn[ name ] = function( speed, easing, callback ) {
		return this.animate( props, speed, easing, callback );
	};
});

jQuery.timers = [];
jQuery.fx.tick = function() {
	var timer,
		i = 0,
		timers = jQuery.timers;

	fxNow = jQuery.now();

	for ( ; i < timers.length; i++ ) {
		timer = timers[ i ];
		// Checks the timer has not already been removed
		if ( !timer() && timers[ i ] === timer ) {
			timers.splice( i--, 1 );
		}
	}

	if ( !timers.length ) {
		jQuery.fx.stop();
	}
	fxNow = undefined;
};

jQuery.fx.timer = function( timer ) {
	jQuery.timers.push( timer );
	if ( timer() ) {
		jQuery.fx.start();
	} else {
		jQuery.timers.pop();
	}
};

jQuery.fx.interval = 13;

jQuery.fx.start = function() {
	if ( !timerId ) {
		timerId = setInterval( jQuery.fx.tick, jQuery.fx.interval );
	}
};

jQuery.fx.stop = function() {
	clearInterval( timerId );
	timerId = null;
};

jQuery.fx.speeds = {
	slow: 600,
	fast: 200,
	// Default speed
	_default: 400
};


// Based off of the plugin by Clint Helfers, with permission.
// http://blindsignals.com/index.php/2009/07/jquery-delay/
jQuery.fn.delay = function( time, type ) {
	time = jQuery.fx ? jQuery.fx.speeds[ time ] || time : time;
	type = type || "fx";

	return this.queue( type, function( next, hooks ) {
		var timeout = setTimeout( next, time );
		hooks.stop = function() {
			clearTimeout( timeout );
		};
	});
};


(function() {
	var input = document.createElement( "input" ),
		select = document.createElement( "select" ),
		opt = select.appendChild( document.createElement( "option" ) );

	input.type = "checkbox";

	// Support: iOS<=5.1, Android<=4.2+
	// Default value for a checkbox should be "on"
	support.checkOn = input.value !== "";

	// Support: IE<=11+
	// Must access selectedIndex to make default options select
	support.optSelected = opt.selected;

	// Support: Android<=2.3
	// Options inside disabled selects are incorrectly marked as disabled
	select.disabled = true;
	support.optDisabled = !opt.disabled;

	// Support: IE<=11+
	// An input loses its value after becoming a radio
	input = document.createElement( "input" );
	input.value = "t";
	input.type = "radio";
	support.radioValue = input.value === "t";
})();


var nodeHook, boolHook,
	attrHandle = jQuery.expr.attrHandle;

jQuery.fn.extend({
	attr: function( name, value ) {
		return access( this, jQuery.attr, name, value, arguments.length > 1 );
	},

	removeAttr: function( name ) {
		return this.each(function() {
			jQuery.removeAttr( this, name );
		});
	}
});

jQuery.extend({
	attr: function( elem, name, value ) {
		var hooks, ret,
			nType = elem.nodeType;

		// don't get/set attributes on text, comment and attribute nodes
		if ( !elem || nType === 3 || nType === 8 || nType === 2 ) {
			return;
		}

		// Fallback to prop when attributes are not supported
		if ( typeof elem.getAttribute === strundefined ) {
			return jQuery.prop( elem, name, value );
		}

		// All attributes are lowercase
		// Grab necessary hook if one is defined
		if ( nType !== 1 || !jQuery.isXMLDoc( elem ) ) {
			name = name.toLowerCase();
			hooks = jQuery.attrHooks[ name ] ||
				( jQuery.expr.match.bool.test( name ) ? boolHook : nodeHook );
		}

		if ( value !== undefined ) {

			if ( value === null ) {
				jQuery.removeAttr( elem, name );

			} else if ( hooks && "set" in hooks && (ret = hooks.set( elem, value, name )) !== undefined ) {
				return ret;

			} else {
				elem.setAttribute( name, value + "" );
				return value;
			}

		} else if ( hooks && "get" in hooks && (ret = hooks.get( elem, name )) !== null ) {
			return ret;

		} else {
			ret = jQuery.find.attr( elem, name );

			// Non-existent attributes return null, we normalize to undefined
			return ret == null ?
				undefined :
				ret;
		}
	},

	removeAttr: function( elem, value ) {
		var name, propName,
			i = 0,
			attrNames = value && value.match( rnotwhite );

		if ( attrNames && elem.nodeType === 1 ) {
			while ( (name = attrNames[i++]) ) {
				propName = jQuery.propFix[ name ] || name;

				// Boolean attributes get special treatment (#10870)
				if ( jQuery.expr.match.bool.test( name ) ) {
					// Set corresponding property to false
					elem[ propName ] = false;
				}

				elem.removeAttribute( name );
			}
		}
	},

	attrHooks: {
		type: {
			set: function( elem, value ) {
				if ( !support.radioValue && value === "radio" &&
					jQuery.nodeName( elem, "input" ) ) {
					var val = elem.value;
					elem.setAttribute( "type", value );
					if ( val ) {
						elem.value = val;
					}
					return value;
				}
			}
		}
	}
});

// Hooks for boolean attributes
boolHook = {
	set: function( elem, value, name ) {
		if ( value === false ) {
			// Remove boolean attributes when set to false
			jQuery.removeAttr( elem, name );
		} else {
			elem.setAttribute( name, name );
		}
		return name;
	}
};
jQuery.each( jQuery.expr.match.bool.source.match( /\w+/g ), function( i, name ) {
	var getter = attrHandle[ name ] || jQuery.find.attr;

	attrHandle[ name ] = function( elem, name, isXML ) {
		var ret, handle;
		if ( !isXML ) {
			// Avoid an infinite loop by temporarily removing this function from the getter
			handle = attrHandle[ name ];
			attrHandle[ name ] = ret;
			ret = getter( elem, name, isXML ) != null ?
				name.toLowerCase() :
				null;
			attrHandle[ name ] = handle;
		}
		return ret;
	};
});




var rfocusable = /^(?:input|select|textarea|button)$/i;

jQuery.fn.extend({
	prop: function( name, value ) {
		return access( this, jQuery.prop, name, value, arguments.length > 1 );
	},

	removeProp: function( name ) {
		return this.each(function() {
			delete this[ jQuery.propFix[ name ] || name ];
		});
	}
});

jQuery.extend({
	propFix: {
		"for": "htmlFor",
		"class": "className"
	},

	prop: function( elem, name, value ) {
		var ret, hooks, notxml,
			nType = elem.nodeType;

		// Don't get/set properties on text, comment and attribute nodes
		if ( !elem || nType === 3 || nType === 8 || nType === 2 ) {
			return;
		}

		notxml = nType !== 1 || !jQuery.isXMLDoc( elem );

		if ( notxml ) {
			// Fix name and attach hooks
			name = jQuery.propFix[ name ] || name;
			hooks = jQuery.propHooks[ name ];
		}

		if ( value !== undefined ) {
			return hooks && "set" in hooks && (ret = hooks.set( elem, value, name )) !== undefined ?
				ret :
				( elem[ name ] = value );

		} else {
			return hooks && "get" in hooks && (ret = hooks.get( elem, name )) !== null ?
				ret :
				elem[ name ];
		}
	},

	propHooks: {
		tabIndex: {
			get: function( elem ) {
				return elem.hasAttribute( "tabindex" ) || rfocusable.test( elem.nodeName ) || elem.href ?
					elem.tabIndex :
					-1;
			}
		}
	}
});

if ( !support.optSelected ) {
	jQuery.propHooks.selected = {
		get: function( elem ) {
			var parent = elem.parentNode;
			if ( parent && parent.parentNode ) {
				parent.parentNode.selectedIndex;
			}
			return null;
		}
	};
}

jQuery.each([
	"tabIndex",
	"readOnly",
	"maxLength",
	"cellSpacing",
	"cellPadding",
	"rowSpan",
	"colSpan",
	"useMap",
	"frameBorder",
	"contentEditable"
], function() {
	jQuery.propFix[ this.toLowerCase() ] = this;
});




var rclass = /[\t\r\n\f]/g;

jQuery.fn.extend({
	addClass: function( value ) {
		var classes, elem, cur, clazz, j, finalValue,
			proceed = typeof value === "string" && value,
			i = 0,
			len = this.length;

		if ( jQuery.isFunction( value ) ) {
			return this.each(function( j ) {
				jQuery( this ).addClass( value.call( this, j, this.className ) );
			});
		}

		if ( proceed ) {
			// The disjunction here is for better compressibility (see removeClass)
			classes = ( value || "" ).match( rnotwhite ) || [];

			for ( ; i < len; i++ ) {
				elem = this[ i ];
				cur = elem.nodeType === 1 && ( elem.className ?
					( " " + elem.className + " " ).replace( rclass, " " ) :
					" "
				);

				if ( cur ) {
					j = 0;
					while ( (clazz = classes[j++]) ) {
						if ( cur.indexOf( " " + clazz + " " ) < 0 ) {
							cur += clazz + " ";
						}
					}

					// only assign if different to avoid unneeded rendering.
					finalValue = jQuery.trim( cur );
					if ( elem.className !== finalValue ) {
						elem.className = finalValue;
					}
				}
			}
		}

		return this;
	},

	removeClass: function( value ) {
		var classes, elem, cur, clazz, j, finalValue,
			proceed = arguments.length === 0 || typeof value === "string" && value,
			i = 0,
			len = this.length;

		if ( jQuery.isFunction( value ) ) {
			return this.each(function( j ) {
				jQuery( this ).removeClass( value.call( this, j, this.className ) );
			});
		}
		if ( proceed ) {
			classes = ( value || "" ).match( rnotwhite ) || [];

			for ( ; i < len; i++ ) {
				elem = this[ i ];
				// This expression is here for better compressibility (see addClass)
				cur = elem.nodeType === 1 && ( elem.className ?
					( " " + elem.className + " " ).replace( rclass, " " ) :
					""
				);

				if ( cur ) {
					j = 0;
					while ( (clazz = classes[j++]) ) {
						// Remove *all* instances
						while ( cur.indexOf( " " + clazz + " " ) >= 0 ) {
							cur = cur.replace( " " + clazz + " ", " " );
						}
					}

					// Only assign if different to avoid unneeded rendering.
					finalValue = value ? jQuery.trim( cur ) : "";
					if ( elem.className !== finalValue ) {
						elem.className = finalValue;
					}
				}
			}
		}

		return this;
	},

	toggleClass: function( value, stateVal ) {
		var type = typeof value;

		if ( typeof stateVal === "boolean" && type === "string" ) {
			return stateVal ? this.addClass( value ) : this.removeClass( value );
		}

		if ( jQuery.isFunction( value ) ) {
			return this.each(function( i ) {
				jQuery( this ).toggleClass( value.call(this, i, this.className, stateVal), stateVal );
			});
		}

		return this.each(function() {
			if ( type === "string" ) {
				// Toggle individual class names
				var className,
					i = 0,
					self = jQuery( this ),
					classNames = value.match( rnotwhite ) || [];

				while ( (className = classNames[ i++ ]) ) {
					// Check each className given, space separated list
					if ( self.hasClass( className ) ) {
						self.removeClass( className );
					} else {
						self.addClass( className );
					}
				}

			// Toggle whole class name
			} else if ( type === strundefined || type === "boolean" ) {
				if ( this.className ) {
					// store className if set
					data_priv.set( this, "__className__", this.className );
				}

				// If the element has a class name or if we're passed `false`,
				// then remove the whole classname (if there was one, the above saved it).
				// Otherwise bring back whatever was previously saved (if anything),
				// falling back to the empty string if nothing was stored.
				this.className = this.className || value === false ? "" : data_priv.get( this, "__className__" ) || "";
			}
		});
	},

	hasClass: function( selector ) {
		var className = " " + selector + " ",
			i = 0,
			l = this.length;
		for ( ; i < l; i++ ) {
			if ( this[i].nodeType === 1 && (" " + this[i].className + " ").replace(rclass, " ").indexOf( className ) >= 0 ) {
				return true;
			}
		}

		return false;
	}
});




var rreturn = /\r/g;

jQuery.fn.extend({
	val: function( value ) {
		var hooks, ret, isFunction,
			elem = this[0];

		if ( !arguments.length ) {
			if ( elem ) {
				hooks = jQuery.valHooks[ elem.type ] || jQuery.valHooks[ elem.nodeName.toLowerCase() ];

				if ( hooks && "get" in hooks && (ret = hooks.get( elem, "value" )) !== undefined ) {
					return ret;
				}

				ret = elem.value;

				return typeof ret === "string" ?
					// Handle most common string cases
					ret.replace(rreturn, "") :
					// Handle cases where value is null/undef or number
					ret == null ? "" : ret;
			}

			return;
		}

		isFunction = jQuery.isFunction( value );

		return this.each(function( i ) {
			var val;

			if ( this.nodeType !== 1 ) {
				return;
			}

			if ( isFunction ) {
				val = value.call( this, i, jQuery( this ).val() );
			} else {
				val = value;
			}

			// Treat null/undefined as ""; convert numbers to string
			if ( val == null ) {
				val = "";

			} else if ( typeof val === "number" ) {
				val += "";

			} else if ( jQuery.isArray( val ) ) {
				val = jQuery.map( val, function( value ) {
					return value == null ? "" : value + "";
				});
			}

			hooks = jQuery.valHooks[ this.type ] || jQuery.valHooks[ this.nodeName.toLowerCase() ];

			// If set returns undefined, fall back to normal setting
			if ( !hooks || !("set" in hooks) || hooks.set( this, val, "value" ) === undefined ) {
				this.value = val;
			}
		});
	}
});

jQuery.extend({
	valHooks: {
		option: {
			get: function( elem ) {
				var val = jQuery.find.attr( elem, "value" );
				return val != null ?
					val :
					// Support: IE10-11+
					// option.text throws exceptions (#14686, #14858)
					jQuery.trim( jQuery.text( elem ) );
			}
		},
		select: {
			get: function( elem ) {
				var value, option,
					options = elem.options,
					index = elem.selectedIndex,
					one = elem.type === "select-one" || index < 0,
					values = one ? null : [],
					max = one ? index + 1 : options.length,
					i = index < 0 ?
						max :
						one ? index : 0;

				// Loop through all the selected options
				for ( ; i < max; i++ ) {
					option = options[ i ];

					// IE6-9 doesn't update selected after form reset (#2551)
					if ( ( option.selected || i === index ) &&
							// Don't return options that are disabled or in a disabled optgroup
							( support.optDisabled ? !option.disabled : option.getAttribute( "disabled" ) === null ) &&
							( !option.parentNode.disabled || !jQuery.nodeName( option.parentNode, "optgroup" ) ) ) {

						// Get the specific value for the option
						value = jQuery( option ).val();

						// We don't need an array for one selects
						if ( one ) {
							return value;
						}

						// Multi-Selects return an array
						values.push( value );
					}
				}

				return values;
			},

			set: function( elem, value ) {
				var optionSet, option,
					options = elem.options,
					values = jQuery.makeArray( value ),
					i = options.length;

				while ( i-- ) {
					option = options[ i ];
					if ( (option.selected = jQuery.inArray( option.value, values ) >= 0) ) {
						optionSet = true;
					}
				}

				// Force browsers to behave consistently when non-matching value is set
				if ( !optionSet ) {
					elem.selectedIndex = -1;
				}
				return values;
			}
		}
	}
});

// Radios and checkboxes getter/setter
jQuery.each([ "radio", "checkbox" ], function() {
	jQuery.valHooks[ this ] = {
		set: function( elem, value ) {
			if ( jQuery.isArray( value ) ) {
				return ( elem.checked = jQuery.inArray( jQuery(elem).val(), value ) >= 0 );
			}
		}
	};
	if ( !support.checkOn ) {
		jQuery.valHooks[ this ].get = function( elem ) {
			return elem.getAttribute("value") === null ? "on" : elem.value;
		};
	}
});




// Return jQuery for attributes-only inclusion


jQuery.each( ("blur focus focusin focusout load resize scroll unload click dblclick " +
	"mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave " +
	"change select submit keydown keypress keyup error contextmenu").split(" "), function( i, name ) {

	// Handle event binding
	jQuery.fn[ name ] = function( data, fn ) {
		return arguments.length > 0 ?
			this.on( name, null, data, fn ) :
			this.trigger( name );
	};
});

jQuery.fn.extend({
	hover: function( fnOver, fnOut ) {
		return this.mouseenter( fnOver ).mouseleave( fnOut || fnOver );
	},

	bind: function( types, data, fn ) {
		return this.on( types, null, data, fn );
	},
	unbind: function( types, fn ) {
		return this.off( types, null, fn );
	},

	delegate: function( selector, types, data, fn ) {
		return this.on( types, selector, data, fn );
	},
	undelegate: function( selector, types, fn ) {
		// ( namespace ) or ( selector, types [, fn] )
		return arguments.length === 1 ? this.off( selector, "**" ) : this.off( types, selector || "**", fn );
	}
});


var nonce = jQuery.now();

var rquery = (/\?/);



// Support: Android 2.3
// Workaround failure to string-cast null input
jQuery.parseJSON = function( data ) {
	return JSON.parse( data + "" );
};


// Cross-browser xml parsing
jQuery.parseXML = function( data ) {
	var xml, tmp;
	if ( !data || typeof data !== "string" ) {
		return null;
	}

	// Support: IE9
	try {
		tmp = new DOMParser();
		xml = tmp.parseFromString( data, "text/xml" );
	} catch ( e ) {
		xml = undefined;
	}

	if ( !xml || xml.getElementsByTagName( "parsererror" ).length ) {
		jQuery.error( "Invalid XML: " + data );
	}
	return xml;
};


var
	rhash = /#.*$/,
	rts = /([?&])_=[^&]*/,
	rheaders = /^(.*?):[ \t]*([^\r\n]*)$/mg,
	// #7653, #8125, #8152: local protocol detection
	rlocalProtocol = /^(?:about|app|app-storage|.+-extension|file|res|widget):$/,
	rnoContent = /^(?:GET|HEAD)$/,
	rprotocol = /^\/\//,
	rurl = /^([\w.+-]+:)(?:\/\/(?:[^\/?#]*@|)([^\/?#:]*)(?::(\d+)|)|)/,

	/* Prefilters
	 * 1) They are useful to introduce custom dataTypes (see ajax/jsonp.js for an example)
	 * 2) These are called:
	 *    - BEFORE asking for a transport
	 *    - AFTER param serialization (s.data is a string if s.processData is true)
	 * 3) key is the dataType
	 * 4) the catchall symbol "*" can be used
	 * 5) execution will start with transport dataType and THEN continue down to "*" if needed
	 */
	prefilters = {},

	/* Transports bindings
	 * 1) key is the dataType
	 * 2) the catchall symbol "*" can be used
	 * 3) selection will start with transport dataType and THEN go to "*" if needed
	 */
	transports = {},

	// Avoid comment-prolog char sequence (#10098); must appease lint and evade compression
	allTypes = "*/".concat( "*" ),

	// Document location
	ajaxLocation = window.location.href,

	// Segment location into parts
	ajaxLocParts = rurl.exec( ajaxLocation.toLowerCase() ) || [];

// Base "constructor" for jQuery.ajaxPrefilter and jQuery.ajaxTransport
function addToPrefiltersOrTransports( structure ) {

	// dataTypeExpression is optional and defaults to "*"
	return function( dataTypeExpression, func ) {

		if ( typeof dataTypeExpression !== "string" ) {
			func = dataTypeExpression;
			dataTypeExpression = "*";
		}

		var dataType,
			i = 0,
			dataTypes = dataTypeExpression.toLowerCase().match( rnotwhite ) || [];

		if ( jQuery.isFunction( func ) ) {
			// For each dataType in the dataTypeExpression
			while ( (dataType = dataTypes[i++]) ) {
				// Prepend if requested
				if ( dataType[0] === "+" ) {
					dataType = dataType.slice( 1 ) || "*";
					(structure[ dataType ] = structure[ dataType ] || []).unshift( func );

				// Otherwise append
				} else {
					(structure[ dataType ] = structure[ dataType ] || []).push( func );
				}
			}
		}
	};
}

// Base inspection function for prefilters and transports
function inspectPrefiltersOrTransports( structure, options, originalOptions, jqXHR ) {

	var inspected = {},
		seekingTransport = ( structure === transports );

	function inspect( dataType ) {
		var selected;
		inspected[ dataType ] = true;
		jQuery.each( structure[ dataType ] || [], function( _, prefilterOrFactory ) {
			var dataTypeOrTransport = prefilterOrFactory( options, originalOptions, jqXHR );
			if ( typeof dataTypeOrTransport === "string" && !seekingTransport && !inspected[ dataTypeOrTransport ] ) {
				options.dataTypes.unshift( dataTypeOrTransport );
				inspect( dataTypeOrTransport );
				return false;
			} else if ( seekingTransport ) {
				return !( selected = dataTypeOrTransport );
			}
		});
		return selected;
	}

	return inspect( options.dataTypes[ 0 ] ) || !inspected[ "*" ] && inspect( "*" );
}

// A special extend for ajax options
// that takes "flat" options (not to be deep extended)
// Fixes #9887
function ajaxExtend( target, src ) {
	var key, deep,
		flatOptions = jQuery.ajaxSettings.flatOptions || {};

	for ( key in src ) {
		if ( src[ key ] !== undefined ) {
			( flatOptions[ key ] ? target : ( deep || (deep = {}) ) )[ key ] = src[ key ];
		}
	}
	if ( deep ) {
		jQuery.extend( true, target, deep );
	}

	return target;
}

/* Handles responses to an ajax request:
 * - finds the right dataType (mediates between content-type and expected dataType)
 * - returns the corresponding response
 */
function ajaxHandleResponses( s, jqXHR, responses ) {

	var ct, type, finalDataType, firstDataType,
		contents = s.contents,
		dataTypes = s.dataTypes;

	// Remove auto dataType and get content-type in the process
	while ( dataTypes[ 0 ] === "*" ) {
		dataTypes.shift();
		if ( ct === undefined ) {
			ct = s.mimeType || jqXHR.getResponseHeader("Content-Type");
		}
	}

	// Check if we're dealing with a known content-type
	if ( ct ) {
		for ( type in contents ) {
			if ( contents[ type ] && contents[ type ].test( ct ) ) {
				dataTypes.unshift( type );
				break;
			}
		}
	}

	// Check to see if we have a response for the expected dataType
	if ( dataTypes[ 0 ] in responses ) {
		finalDataType = dataTypes[ 0 ];
	} else {
		// Try convertible dataTypes
		for ( type in responses ) {
			if ( !dataTypes[ 0 ] || s.converters[ type + " " + dataTypes[0] ] ) {
				finalDataType = type;
				break;
			}
			if ( !firstDataType ) {
				firstDataType = type;
			}
		}
		// Or just use first one
		finalDataType = finalDataType || firstDataType;
	}

	// If we found a dataType
	// We add the dataType to the list if needed
	// and return the corresponding response
	if ( finalDataType ) {
		if ( finalDataType !== dataTypes[ 0 ] ) {
			dataTypes.unshift( finalDataType );
		}
		return responses[ finalDataType ];
	}
}

/* Chain conversions given the request and the original response
 * Also sets the responseXXX fields on the jqXHR instance
 */
function ajaxConvert( s, response, jqXHR, isSuccess ) {
	var conv2, current, conv, tmp, prev,
		converters = {},
		// Work with a copy of dataTypes in case we need to modify it for conversion
		dataTypes = s.dataTypes.slice();

	// Create converters map with lowercased keys
	if ( dataTypes[ 1 ] ) {
		for ( conv in s.converters ) {
			converters[ conv.toLowerCase() ] = s.converters[ conv ];
		}
	}

	current = dataTypes.shift();

	// Convert to each sequential dataType
	while ( current ) {

		if ( s.responseFields[ current ] ) {
			jqXHR[ s.responseFields[ current ] ] = response;
		}

		// Apply the dataFilter if provided
		if ( !prev && isSuccess && s.dataFilter ) {
			response = s.dataFilter( response, s.dataType );
		}

		prev = current;
		current = dataTypes.shift();

		if ( current ) {

		// There's only work to do if current dataType is non-auto
			if ( current === "*" ) {

				current = prev;

			// Convert response if prev dataType is non-auto and differs from current
			} else if ( prev !== "*" && prev !== current ) {

				// Seek a direct converter
				conv = converters[ prev + " " + current ] || converters[ "* " + current ];

				// If none found, seek a pair
				if ( !conv ) {
					for ( conv2 in converters ) {

						// If conv2 outputs current
						tmp = conv2.split( " " );
						if ( tmp[ 1 ] === current ) {

							// If prev can be converted to accepted input
							conv = converters[ prev + " " + tmp[ 0 ] ] ||
								converters[ "* " + tmp[ 0 ] ];
							if ( conv ) {
								// Condense equivalence converters
								if ( conv === true ) {
									conv = converters[ conv2 ];

								// Otherwise, insert the intermediate dataType
								} else if ( converters[ conv2 ] !== true ) {
									current = tmp[ 0 ];
									dataTypes.unshift( tmp[ 1 ] );
								}
								break;
							}
						}
					}
				}

				// Apply converter (if not an equivalence)
				if ( conv !== true ) {

					// Unless errors are allowed to bubble, catch and return them
					if ( conv && s[ "throws" ] ) {
						response = conv( response );
					} else {
						try {
							response = conv( response );
						} catch ( e ) {
							return { state: "parsererror", error: conv ? e : "No conversion from " + prev + " to " + current };
						}
					}
				}
			}
		}
	}

	return { state: "success", data: response };
}

jQuery.extend({

	// Counter for holding the number of active queries
	active: 0,

	// Last-Modified header cache for next request
	lastModified: {},
	etag: {},

	ajaxSettings: {
		url: ajaxLocation,
		type: "GET",
		isLocal: rlocalProtocol.test( ajaxLocParts[ 1 ] ),
		global: true,
		processData: true,
		async: true,
		contentType: "application/x-www-form-urlencoded; charset=UTF-8",
		/*
		timeout: 0,
		data: null,
		dataType: null,
		username: null,
		password: null,
		cache: null,
		throws: false,
		traditional: false,
		headers: {},
		*/

		accepts: {
			"*": allTypes,
			text: "text/plain",
			html: "text/html",
			xml: "application/xml, text/xml",
			json: "application/json, text/javascript"
		},

		contents: {
			xml: /xml/,
			html: /html/,
			json: /json/
		},

		responseFields: {
			xml: "responseXML",
			text: "responseText",
			json: "responseJSON"
		},

		// Data converters
		// Keys separate source (or catchall "*") and destination types with a single space
		converters: {

			// Convert anything to text
			"* text": String,

			// Text to html (true = no transformation)
			"text html": true,

			// Evaluate text as a json expression
			"text json": jQuery.parseJSON,

			// Parse text as xml
			"text xml": jQuery.parseXML
		},

		// For options that shouldn't be deep extended:
		// you can add your own custom options here if
		// and when you create one that shouldn't be
		// deep extended (see ajaxExtend)
		flatOptions: {
			url: true,
			context: true
		}
	},

	// Creates a full fledged settings object into target
	// with both ajaxSettings and settings fields.
	// If target is omitted, writes into ajaxSettings.
	ajaxSetup: function( target, settings ) {
		return settings ?

			// Building a settings object
			ajaxExtend( ajaxExtend( target, jQuery.ajaxSettings ), settings ) :

			// Extending ajaxSettings
			ajaxExtend( jQuery.ajaxSettings, target );
	},

	ajaxPrefilter: addToPrefiltersOrTransports( prefilters ),
	ajaxTransport: addToPrefiltersOrTransports( transports ),

	// Main method
	ajax: function( url, options ) {

		// If url is an object, simulate pre-1.5 signature
		if ( typeof url === "object" ) {
			options = url;
			url = undefined;
		}

		// Force options to be an object
		options = options || {};

		var transport,
			// URL without anti-cache param
			cacheURL,
			// Response headers
			responseHeadersString,
			responseHeaders,
			// timeout handle
			timeoutTimer,
			// Cross-domain detection vars
			parts,
			// To know if global events are to be dispatched
			fireGlobals,
			// Loop variable
			i,
			// Create the final options object
			s = jQuery.ajaxSetup( {}, options ),
			// Callbacks context
			callbackContext = s.context || s,
			// Context for global events is callbackContext if it is a DOM node or jQuery collection
			globalEventContext = s.context && ( callbackContext.nodeType || callbackContext.jquery ) ?
				jQuery( callbackContext ) :
				jQuery.event,
			// Deferreds
			deferred = jQuery.Deferred(),
			completeDeferred = jQuery.Callbacks("once memory"),
			// Status-dependent callbacks
			statusCode = s.statusCode || {},
			// Headers (they are sent all at once)
			requestHeaders = {},
			requestHeadersNames = {},
			// The jqXHR state
			state = 0,
			// Default abort message
			strAbort = "canceled",
			// Fake xhr
			jqXHR = {
				readyState: 0,

				// Builds headers hashtable if needed
				getResponseHeader: function( key ) {
					var match;
					if ( state === 2 ) {
						if ( !responseHeaders ) {
							responseHeaders = {};
							while ( (match = rheaders.exec( responseHeadersString )) ) {
								responseHeaders[ match[1].toLowerCase() ] = match[ 2 ];
							}
						}
						match = responseHeaders[ key.toLowerCase() ];
					}
					return match == null ? null : match;
				},

				// Raw string
				getAllResponseHeaders: function() {
					return state === 2 ? responseHeadersString : null;
				},

				// Caches the header
				setRequestHeader: function( name, value ) {
					var lname = name.toLowerCase();
					if ( !state ) {
						name = requestHeadersNames[ lname ] = requestHeadersNames[ lname ] || name;
						requestHeaders[ name ] = value;
					}
					return this;
				},

				// Overrides response content-type header
				overrideMimeType: function( type ) {
					if ( !state ) {
						s.mimeType = type;
					}
					return this;
				},

				// Status-dependent callbacks
				statusCode: function( map ) {
					var code;
					if ( map ) {
						if ( state < 2 ) {
							for ( code in map ) {
								// Lazy-add the new callback in a way that preserves old ones
								statusCode[ code ] = [ statusCode[ code ], map[ code ] ];
							}
						} else {
							// Execute the appropriate callbacks
							jqXHR.always( map[ jqXHR.status ] );
						}
					}
					return this;
				},

				// Cancel the request
				abort: function( statusText ) {
					var finalText = statusText || strAbort;
					if ( transport ) {
						transport.abort( finalText );
					}
					done( 0, finalText );
					return this;
				}
			};

		// Attach deferreds
		deferred.promise( jqXHR ).complete = completeDeferred.add;
		jqXHR.success = jqXHR.done;
		jqXHR.error = jqXHR.fail;

		// Remove hash character (#7531: and string promotion)
		// Add protocol if not provided (prefilters might expect it)
		// Handle falsy url in the settings object (#10093: consistency with old signature)
		// We also use the url parameter if available
		s.url = ( ( url || s.url || ajaxLocation ) + "" ).replace( rhash, "" )
			.replace( rprotocol, ajaxLocParts[ 1 ] + "//" );

		// Alias method option to type as per ticket #12004
		s.type = options.method || options.type || s.method || s.type;

		// Extract dataTypes list
		s.dataTypes = jQuery.trim( s.dataType || "*" ).toLowerCase().match( rnotwhite ) || [ "" ];

		// A cross-domain request is in order when we have a protocol:host:port mismatch
		if ( s.crossDomain == null ) {
			parts = rurl.exec( s.url.toLowerCase() );
			s.crossDomain = !!( parts &&
				( parts[ 1 ] !== ajaxLocParts[ 1 ] || parts[ 2 ] !== ajaxLocParts[ 2 ] ||
					( parts[ 3 ] || ( parts[ 1 ] === "http:" ? "80" : "443" ) ) !==
						( ajaxLocParts[ 3 ] || ( ajaxLocParts[ 1 ] === "http:" ? "80" : "443" ) ) )
			);
		}

		// Convert data if not already a string
		if ( s.data && s.processData && typeof s.data !== "string" ) {
			s.data = jQuery.param( s.data, s.traditional );
		}

		// Apply prefilters
		inspectPrefiltersOrTransports( prefilters, s, options, jqXHR );

		// If request was aborted inside a prefilter, stop there
		if ( state === 2 ) {
			return jqXHR;
		}

		// We can fire global events as of now if asked to
		// Don't fire events if jQuery.event is undefined in an AMD-usage scenario (#15118)
		fireGlobals = jQuery.event && s.global;

		// Watch for a new set of requests
		if ( fireGlobals && jQuery.active++ === 0 ) {
			jQuery.event.trigger("ajaxStart");
		}

		// Uppercase the type
		s.type = s.type.toUpperCase();

		// Determine if request has content
		s.hasContent = !rnoContent.test( s.type );

		// Save the URL in case we're toying with the If-Modified-Since
		// and/or If-None-Match header later on
		cacheURL = s.url;

		// More options handling for requests with no content
		if ( !s.hasContent ) {

			// If data is available, append data to url
			if ( s.data ) {
				cacheURL = ( s.url += ( rquery.test( cacheURL ) ? "&" : "?" ) + s.data );
				// #9682: remove data so that it's not used in an eventual retry
				delete s.data;
			}

			// Add anti-cache in url if needed
			if ( s.cache === false ) {
				s.url = rts.test( cacheURL ) ?

					// If there is already a '_' parameter, set its value
					cacheURL.replace( rts, "$1_=" + nonce++ ) :

					// Otherwise add one to the end
					cacheURL + ( rquery.test( cacheURL ) ? "&" : "?" ) + "_=" + nonce++;
			}
		}

		// Set the If-Modified-Since and/or If-None-Match header, if in ifModified mode.
		if ( s.ifModified ) {
			if ( jQuery.lastModified[ cacheURL ] ) {
				jqXHR.setRequestHeader( "If-Modified-Since", jQuery.lastModified[ cacheURL ] );
			}
			if ( jQuery.etag[ cacheURL ] ) {
				jqXHR.setRequestHeader( "If-None-Match", jQuery.etag[ cacheURL ] );
			}
		}

		// Set the correct header, if data is being sent
		if ( s.data && s.hasContent && s.contentType !== false || options.contentType ) {
			jqXHR.setRequestHeader( "Content-Type", s.contentType );
		}

		// Set the Accepts header for the server, depending on the dataType
		jqXHR.setRequestHeader(
			"Accept",
			s.dataTypes[ 0 ] && s.accepts[ s.dataTypes[0] ] ?
				s.accepts[ s.dataTypes[0] ] + ( s.dataTypes[ 0 ] !== "*" ? ", " + allTypes + "; q=0.01" : "" ) :
				s.accepts[ "*" ]
		);

		// Check for headers option
		for ( i in s.headers ) {
			jqXHR.setRequestHeader( i, s.headers[ i ] );
		}

		// Allow custom headers/mimetypes and early abort
		if ( s.beforeSend && ( s.beforeSend.call( callbackContext, jqXHR, s ) === false || state === 2 ) ) {
			// Abort if not done already and return
			return jqXHR.abort();
		}

		// Aborting is no longer a cancellation
		strAbort = "abort";

		// Install callbacks on deferreds
		for ( i in { success: 1, error: 1, complete: 1 } ) {
			jqXHR[ i ]( s[ i ] );
		}

		// Get transport
		transport = inspectPrefiltersOrTransports( transports, s, options, jqXHR );

		// If no transport, we auto-abort
		if ( !transport ) {
			done( -1, "No Transport" );
		} else {
			jqXHR.readyState = 1;

			// Send global event
			if ( fireGlobals ) {
				globalEventContext.trigger( "ajaxSend", [ jqXHR, s ] );
			}
			// Timeout
			if ( s.async && s.timeout > 0 ) {
				timeoutTimer = setTimeout(function() {
					jqXHR.abort("timeout");
				}, s.timeout );
			}

			try {
				state = 1;
				transport.send( requestHeaders, done );
			} catch ( e ) {
				// Propagate exception as error if not done
				if ( state < 2 ) {
					done( -1, e );
				// Simply rethrow otherwise
				} else {
					throw e;
				}
			}
		}

		// Callback for when everything is done
		function done( status, nativeStatusText, responses, headers ) {
			var isSuccess, success, error, response, modified,
				statusText = nativeStatusText;

			// Called once
			if ( state === 2 ) {
				return;
			}

			// State is "done" now
			state = 2;

			// Clear timeout if it exists
			if ( timeoutTimer ) {
				clearTimeout( timeoutTimer );
			}

			// Dereference transport for early garbage collection
			// (no matter how long the jqXHR object will be used)
			transport = undefined;

			// Cache response headers
			responseHeadersString = headers || "";

			// Set readyState
			jqXHR.readyState = status > 0 ? 4 : 0;

			// Determine if successful
			isSuccess = status >= 200 && status < 300 || status === 304;

			// Get response data
			if ( responses ) {
				response = ajaxHandleResponses( s, jqXHR, responses );
			}

			// Convert no matter what (that way responseXXX fields are always set)
			response = ajaxConvert( s, response, jqXHR, isSuccess );

			// If successful, handle type chaining
			if ( isSuccess ) {

				// Set the If-Modified-Since and/or If-None-Match header, if in ifModified mode.
				if ( s.ifModified ) {
					modified = jqXHR.getResponseHeader("Last-Modified");
					if ( modified ) {
						jQuery.lastModified[ cacheURL ] = modified;
					}
					modified = jqXHR.getResponseHeader("etag");
					if ( modified ) {
						jQuery.etag[ cacheURL ] = modified;
					}
				}

				// if no content
				if ( status === 204 || s.type === "HEAD" ) {
					statusText = "nocontent";

				// if not modified
				} else if ( status === 304 ) {
					statusText = "notmodified";

				// If we have data, let's convert it
				} else {
					statusText = response.state;
					success = response.data;
					error = response.error;
					isSuccess = !error;
				}
			} else {
				// Extract error from statusText and normalize for non-aborts
				error = statusText;
				if ( status || !statusText ) {
					statusText = "error";
					if ( status < 0 ) {
						status = 0;
					}
				}
			}

			// Set data for the fake xhr object
			jqXHR.status = status;
			jqXHR.statusText = ( nativeStatusText || statusText ) + "";

			// Success/Error
			if ( isSuccess ) {
				deferred.resolveWith( callbackContext, [ success, statusText, jqXHR ] );
			} else {
				deferred.rejectWith( callbackContext, [ jqXHR, statusText, error ] );
			}

			// Status-dependent callbacks
			jqXHR.statusCode( statusCode );
			statusCode = undefined;

			if ( fireGlobals ) {
				globalEventContext.trigger( isSuccess ? "ajaxSuccess" : "ajaxError",
					[ jqXHR, s, isSuccess ? success : error ] );
			}

			// Complete
			completeDeferred.fireWith( callbackContext, [ jqXHR, statusText ] );

			if ( fireGlobals ) {
				globalEventContext.trigger( "ajaxComplete", [ jqXHR, s ] );
				// Handle the global AJAX counter
				if ( !( --jQuery.active ) ) {
					jQuery.event.trigger("ajaxStop");
				}
			}
		}

		return jqXHR;
	},

	getJSON: function( url, data, callback ) {
		return jQuery.get( url, data, callback, "json" );
	},

	getScript: function( url, callback ) {
		return jQuery.get( url, undefined, callback, "script" );
	}
});

jQuery.each( [ "get", "post" ], function( i, method ) {
	jQuery[ method ] = function( url, data, callback, type ) {
		// Shift arguments if data argument was omitted
		if ( jQuery.isFunction( data ) ) {
			type = type || callback;
			callback = data;
			data = undefined;
		}

		return jQuery.ajax({
			url: url,
			type: method,
			dataType: type,
			data: data,
			success: callback
		});
	};
});


jQuery._evalUrl = function( url ) {
	return jQuery.ajax({
		url: url,
		type: "GET",
		dataType: "script",
		async: false,
		global: false,
		"throws": true
	});
};


jQuery.fn.extend({
	wrapAll: function( html ) {
		var wrap;

		if ( jQuery.isFunction( html ) ) {
			return this.each(function( i ) {
				jQuery( this ).wrapAll( html.call(this, i) );
			});
		}

		if ( this[ 0 ] ) {

			// The elements to wrap the target around
			wrap = jQuery( html, this[ 0 ].ownerDocument ).eq( 0 ).clone( true );

			if ( this[ 0 ].parentNode ) {
				wrap.insertBefore( this[ 0 ] );
			}

			wrap.map(function() {
				var elem = this;

				while ( elem.firstElementChild ) {
					elem = elem.firstElementChild;
				}

				return elem;
			}).append( this );
		}

		return this;
	},

	wrapInner: function( html ) {
		if ( jQuery.isFunction( html ) ) {
			return this.each(function( i ) {
				jQuery( this ).wrapInner( html.call(this, i) );
			});
		}

		return this.each(function() {
			var self = jQuery( this ),
				contents = self.contents();

			if ( contents.length ) {
				contents.wrapAll( html );

			} else {
				self.append( html );
			}
		});
	},

	wrap: function( html ) {
		var isFunction = jQuery.isFunction( html );

		return this.each(function( i ) {
			jQuery( this ).wrapAll( isFunction ? html.call(this, i) : html );
		});
	},

	unwrap: function() {
		return this.parent().each(function() {
			if ( !jQuery.nodeName( this, "body" ) ) {
				jQuery( this ).replaceWith( this.childNodes );
			}
		}).end();
	}
});


jQuery.expr.filters.hidden = function( elem ) {
	// Support: Opera <= 12.12
	// Opera reports offsetWidths and offsetHeights less than zero on some elements
	return elem.offsetWidth <= 0 && elem.offsetHeight <= 0;
};
jQuery.expr.filters.visible = function( elem ) {
	return !jQuery.expr.filters.hidden( elem );
};




var r20 = /%20/g,
	rbracket = /\[\]$/,
	rCRLF = /\r?\n/g,
	rsubmitterTypes = /^(?:submit|button|image|reset|file)$/i,
	rsubmittable = /^(?:input|select|textarea|keygen)/i;

function buildParams( prefix, obj, traditional, add ) {
	var name;

	if ( jQuery.isArray( obj ) ) {
		// Serialize array item.
		jQuery.each( obj, function( i, v ) {
			if ( traditional || rbracket.test( prefix ) ) {
				// Treat each array item as a scalar.
				add( prefix, v );

			} else {
				// Item is non-scalar (array or object), encode its numeric index.
				buildParams( prefix + "[" + ( typeof v === "object" ? i : "" ) + "]", v, traditional, add );
			}
		});

	} else if ( !traditional && jQuery.type( obj ) === "object" ) {
		// Serialize object item.
		for ( name in obj ) {
			buildParams( prefix + "[" + name + "]", obj[ name ], traditional, add );
		}

	} else {
		// Serialize scalar item.
		add( prefix, obj );
	}
}

// Serialize an array of form elements or a set of
// key/values into a query string
jQuery.param = function( a, traditional ) {
	var prefix,
		s = [],
		add = function( key, value ) {
			// If value is a function, invoke it and return its value
			value = jQuery.isFunction( value ) ? value() : ( value == null ? "" : value );
			s[ s.length ] = encodeURIComponent( key ) + "=" + encodeURIComponent( value );
		};

	// Set traditional to true for jQuery <= 1.3.2 behavior.
	if ( traditional === undefined ) {
		traditional = jQuery.ajaxSettings && jQuery.ajaxSettings.traditional;
	}

	// If an array was passed in, assume that it is an array of form elements.
	if ( jQuery.isArray( a ) || ( a.jquery && !jQuery.isPlainObject( a ) ) ) {
		// Serialize the form elements
		jQuery.each( a, function() {
			add( this.name, this.value );
		});

	} else {
		// If traditional, encode the "old" way (the way 1.3.2 or older
		// did it), otherwise encode params recursively.
		for ( prefix in a ) {
			buildParams( prefix, a[ prefix ], traditional, add );
		}
	}

	// Return the resulting serialization
	return s.join( "&" ).replace( r20, "+" );
};

jQuery.fn.extend({
	serialize: function() {
		return jQuery.param( this.serializeArray() );
	},
	serializeArray: function() {
		return this.map(function() {
			// Can add propHook for "elements" to filter or add form elements
			var elements = jQuery.prop( this, "elements" );
			return elements ? jQuery.makeArray( elements ) : this;
		})
		.filter(function() {
			var type = this.type;

			// Use .is( ":disabled" ) so that fieldset[disabled] works
			return this.name && !jQuery( this ).is( ":disabled" ) &&
				rsubmittable.test( this.nodeName ) && !rsubmitterTypes.test( type ) &&
				( this.checked || !rcheckableType.test( type ) );
		})
		.map(function( i, elem ) {
			var val = jQuery( this ).val();

			return val == null ?
				null :
				jQuery.isArray( val ) ?
					jQuery.map( val, function( val ) {
						return { name: elem.name, value: val.replace( rCRLF, "\r\n" ) };
					}) :
					{ name: elem.name, value: val.replace( rCRLF, "\r\n" ) };
		}).get();
	}
});


jQuery.ajaxSettings.xhr = function() {
	try {
		return new XMLHttpRequest();
	} catch( e ) {}
};

var xhrId = 0,
	xhrCallbacks = {},
	xhrSuccessStatus = {
		// file protocol always yields status code 0, assume 200
		0: 200,
		// Support: IE9
		// #1450: sometimes IE returns 1223 when it should be 204
		1223: 204
	},
	xhrSupported = jQuery.ajaxSettings.xhr();

// Support: IE9
// Open requests must be manually aborted on unload (#5280)
// See https://support.microsoft.com/kb/2856746 for more info
if ( window.attachEvent ) {
	window.attachEvent( "onunload", function() {
		for ( var key in xhrCallbacks ) {
			xhrCallbacks[ key ]();
		}
	});
}

support.cors = !!xhrSupported && ( "withCredentials" in xhrSupported );
support.ajax = xhrSupported = !!xhrSupported;

jQuery.ajaxTransport(function( options ) {
	var callback;

	// Cross domain only allowed if supported through XMLHttpRequest
	if ( support.cors || xhrSupported && !options.crossDomain ) {
		return {
			send: function( headers, complete ) {
				var i,
					xhr = options.xhr(),
					id = ++xhrId;

				xhr.open( options.type, options.url, options.async, options.username, options.password );

				// Apply custom fields if provided
				if ( options.xhrFields ) {
					for ( i in options.xhrFields ) {
						xhr[ i ] = options.xhrFields[ i ];
					}
				}

				// Override mime type if needed
				if ( options.mimeType && xhr.overrideMimeType ) {
					xhr.overrideMimeType( options.mimeType );
				}

				// X-Requested-With header
				// For cross-domain requests, seeing as conditions for a preflight are
				// akin to a jigsaw puzzle, we simply never set it to be sure.
				// (it can always be set on a per-request basis or even using ajaxSetup)
				// For same-domain requests, won't change header if already provided.
				if ( !options.crossDomain && !headers["X-Requested-With"] ) {
					headers["X-Requested-With"] = "XMLHttpRequest";
				}

				// Set headers
				for ( i in headers ) {
					xhr.setRequestHeader( i, headers[ i ] );
				}

				// Callback
				callback = function( type ) {
					return function() {
						if ( callback ) {
							delete xhrCallbacks[ id ];
							callback = xhr.onload = xhr.onerror = null;

							if ( type === "abort" ) {
								xhr.abort();
							} else if ( type === "error" ) {
								complete(
									// file: protocol always yields status 0; see #8605, #14207
									xhr.status,
									xhr.statusText
								);
							} else {
								complete(
									xhrSuccessStatus[ xhr.status ] || xhr.status,
									xhr.statusText,
									// Support: IE9
									// Accessing binary-data responseText throws an exception
									// (#11426)
									typeof xhr.responseText === "string" ? {
										text: xhr.responseText
									} : undefined,
									xhr.getAllResponseHeaders()
								);
							}
						}
					};
				};

				// Listen to events
				xhr.onload = callback();
				xhr.onerror = callback("error");

				// Create the abort callback
				callback = xhrCallbacks[ id ] = callback("abort");

				try {
					// Do send the request (this may raise an exception)
					xhr.send( options.hasContent && options.data || null );
				} catch ( e ) {
					// #14683: Only rethrow if this hasn't been notified as an error yet
					if ( callback ) {
						throw e;
					}
				}
			},

			abort: function() {
				if ( callback ) {
					callback();
				}
			}
		};
	}
});




// Install script dataType
jQuery.ajaxSetup({
	accepts: {
		script: "text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"
	},
	contents: {
		script: /(?:java|ecma)script/
	},
	converters: {
		"text script": function( text ) {
			jQuery.globalEval( text );
			return text;
		}
	}
});

// Handle cache's special case and crossDomain
jQuery.ajaxPrefilter( "script", function( s ) {
	if ( s.cache === undefined ) {
		s.cache = false;
	}
	if ( s.crossDomain ) {
		s.type = "GET";
	}
});

// Bind script tag hack transport
jQuery.ajaxTransport( "script", function( s ) {
	// This transport only deals with cross domain requests
	if ( s.crossDomain ) {
		var script, callback;
		return {
			send: function( _, complete ) {
				script = jQuery("<script>").prop({
					async: true,
					charset: s.scriptCharset,
					src: s.url
				}).on(
					"load error",
					callback = function( evt ) {
						script.remove();
						callback = null;
						if ( evt ) {
							complete( evt.type === "error" ? 404 : 200, evt.type );
						}
					}
				);
				document.head.appendChild( script[ 0 ] );
			},
			abort: function() {
				if ( callback ) {
					callback();
				}
			}
		};
	}
});




var oldCallbacks = [],
	rjsonp = /(=)\?(?=&|$)|\?\?/;

// Default jsonp settings
jQuery.ajaxSetup({
	jsonp: "callback",
	jsonpCallback: function() {
		var callback = oldCallbacks.pop() || ( jQuery.expando + "_" + ( nonce++ ) );
		this[ callback ] = true;
		return callback;
	}
});

// Detect, normalize options and install callbacks for jsonp requests
jQuery.ajaxPrefilter( "json jsonp", function( s, originalSettings, jqXHR ) {

	var callbackName, overwritten, responseContainer,
		jsonProp = s.jsonp !== false && ( rjsonp.test( s.url ) ?
			"url" :
			typeof s.data === "string" && !( s.contentType || "" ).indexOf("application/x-www-form-urlencoded") && rjsonp.test( s.data ) && "data"
		);

	// Handle iff the expected data type is "jsonp" or we have a parameter to set
	if ( jsonProp || s.dataTypes[ 0 ] === "jsonp" ) {

		// Get callback name, remembering preexisting value associated with it
		callbackName = s.jsonpCallback = jQuery.isFunction( s.jsonpCallback ) ?
			s.jsonpCallback() :
			s.jsonpCallback;

		// Insert callback into url or form data
		if ( jsonProp ) {
			s[ jsonProp ] = s[ jsonProp ].replace( rjsonp, "$1" + callbackName );
		} else if ( s.jsonp !== false ) {
			s.url += ( rquery.test( s.url ) ? "&" : "?" ) + s.jsonp + "=" + callbackName;
		}

		// Use data converter to retrieve json after script execution
		s.converters["script json"] = function() {
			if ( !responseContainer ) {
				jQuery.error( callbackName + " was not called" );
			}
			return responseContainer[ 0 ];
		};

		// force json dataType
		s.dataTypes[ 0 ] = "json";

		// Install callback
		overwritten = window[ callbackName ];
		window[ callbackName ] = function() {
			responseContainer = arguments;
		};

		// Clean-up function (fires after converters)
		jqXHR.always(function() {
			// Restore preexisting value
			window[ callbackName ] = overwritten;

			// Save back as free
			if ( s[ callbackName ] ) {
				// make sure that re-using the options doesn't screw things around
				s.jsonpCallback = originalSettings.jsonpCallback;

				// save the callback name for future use
				oldCallbacks.push( callbackName );
			}

			// Call if it was a function and we have a response
			if ( responseContainer && jQuery.isFunction( overwritten ) ) {
				overwritten( responseContainer[ 0 ] );
			}

			responseContainer = overwritten = undefined;
		});

		// Delegate to script
		return "script";
	}
});




// data: string of html
// context (optional): If specified, the fragment will be created in this context, defaults to document
// keepScripts (optional): If true, will include scripts passed in the html string
jQuery.parseHTML = function( data, context, keepScripts ) {
	if ( !data || typeof data !== "string" ) {
		return null;
	}
	if ( typeof context === "boolean" ) {
		keepScripts = context;
		context = false;
	}
	context = context || document;

	var parsed = rsingleTag.exec( data ),
		scripts = !keepScripts && [];

	// Single tag
	if ( parsed ) {
		return [ context.createElement( parsed[1] ) ];
	}

	parsed = jQuery.buildFragment( [ data ], context, scripts );

	if ( scripts && scripts.length ) {
		jQuery( scripts ).remove();
	}

	return jQuery.merge( [], parsed.childNodes );
};


// Keep a copy of the old load method
var _load = jQuery.fn.load;

/**
 * Load a url into a page
 */
jQuery.fn.load = function( url, params, callback ) {
	if ( typeof url !== "string" && _load ) {
		return _load.apply( this, arguments );
	}

	var selector, type, response,
		self = this,
		off = url.indexOf(" ");

	if ( off >= 0 ) {
		selector = jQuery.trim( url.slice( off ) );
		url = url.slice( 0, off );
	}

	// If it's a function
	if ( jQuery.isFunction( params ) ) {

		// We assume that it's the callback
		callback = params;
		params = undefined;

	// Otherwise, build a param string
	} else if ( params && typeof params === "object" ) {
		type = "POST";
	}

	// If we have elements to modify, make the request
	if ( self.length > 0 ) {
		jQuery.ajax({
			url: url,

			// if "type" variable is undefined, then "GET" method will be used
			type: type,
			dataType: "html",
			data: params
		}).done(function( responseText ) {

			// Save response for use in complete callback
			response = arguments;

			self.html( selector ?

				// If a selector was specified, locate the right elements in a dummy div
				// Exclude scripts to avoid IE 'Permission Denied' errors
				jQuery("<div>").append( jQuery.parseHTML( responseText ) ).find( selector ) :

				// Otherwise use the full result
				responseText );

		}).complete( callback && function( jqXHR, status ) {
			self.each( callback, response || [ jqXHR.responseText, status, jqXHR ] );
		});
	}

	return this;
};




// Attach a bunch of functions for handling common AJAX events
jQuery.each( [ "ajaxStart", "ajaxStop", "ajaxComplete", "ajaxError", "ajaxSuccess", "ajaxSend" ], function( i, type ) {
	jQuery.fn[ type ] = function( fn ) {
		return this.on( type, fn );
	};
});




jQuery.expr.filters.animated = function( elem ) {
	return jQuery.grep(jQuery.timers, function( fn ) {
		return elem === fn.elem;
	}).length;
};




var docElem = window.document.documentElement;

/**
 * Gets a window from an element
 */
function getWindow( elem ) {
	return jQuery.isWindow( elem ) ? elem : elem.nodeType === 9 && elem.defaultView;
}

jQuery.offset = {
	setOffset: function( elem, options, i ) {
		var curPosition, curLeft, curCSSTop, curTop, curOffset, curCSSLeft, calculatePosition,
			position = jQuery.css( elem, "position" ),
			curElem = jQuery( elem ),
			props = {};

		// Set position first, in-case top/left are set even on static elem
		if ( position === "static" ) {
			elem.style.position = "relative";
		}

		curOffset = curElem.offset();
		curCSSTop = jQuery.css( elem, "top" );
		curCSSLeft = jQuery.css( elem, "left" );
		calculatePosition = ( position === "absolute" || position === "fixed" ) &&
			( curCSSTop + curCSSLeft ).indexOf("auto") > -1;

		// Need to be able to calculate position if either
		// top or left is auto and position is either absolute or fixed
		if ( calculatePosition ) {
			curPosition = curElem.position();
			curTop = curPosition.top;
			curLeft = curPosition.left;

		} else {
			curTop = parseFloat( curCSSTop ) || 0;
			curLeft = parseFloat( curCSSLeft ) || 0;
		}

		if ( jQuery.isFunction( options ) ) {
			options = options.call( elem, i, curOffset );
		}

		if ( options.top != null ) {
			props.top = ( options.top - curOffset.top ) + curTop;
		}
		if ( options.left != null ) {
			props.left = ( options.left - curOffset.left ) + curLeft;
		}

		if ( "using" in options ) {
			options.using.call( elem, props );

		} else {
			curElem.css( props );
		}
	}
};

jQuery.fn.extend({
	offset: function( options ) {
		if ( arguments.length ) {
			return options === undefined ?
				this :
				this.each(function( i ) {
					jQuery.offset.setOffset( this, options, i );
				});
		}

		var docElem, win,
			elem = this[ 0 ],
			box = { top: 0, left: 0 },
			doc = elem && elem.ownerDocument;

		if ( !doc ) {
			return;
		}

		docElem = doc.documentElement;

		// Make sure it's not a disconnected DOM node
		if ( !jQuery.contains( docElem, elem ) ) {
			return box;
		}

		// Support: BlackBerry 5, iOS 3 (original iPhone)
		// If we don't have gBCR, just use 0,0 rather than error
		if ( typeof elem.getBoundingClientRect !== strundefined ) {
			box = elem.getBoundingClientRect();
		}
		win = getWindow( doc );
		return {
			top: box.top + win.pageYOffset - docElem.clientTop,
			left: box.left + win.pageXOffset - docElem.clientLeft
		};
	},

	position: function() {
		if ( !this[ 0 ] ) {
			return;
		}

		var offsetParent, offset,
			elem = this[ 0 ],
			parentOffset = { top: 0, left: 0 };

		// Fixed elements are offset from window (parentOffset = {top:0, left: 0}, because it is its only offset parent
		if ( jQuery.css( elem, "position" ) === "fixed" ) {
			// Assume getBoundingClientRect is there when computed position is fixed
			offset = elem.getBoundingClientRect();

		} else {
			// Get *real* offsetParent
			offsetParent = this.offsetParent();

			// Get correct offsets
			offset = this.offset();
			if ( !jQuery.nodeName( offsetParent[ 0 ], "html" ) ) {
				parentOffset = offsetParent.offset();
			}

			// Add offsetParent borders
			parentOffset.top += jQuery.css( offsetParent[ 0 ], "borderTopWidth", true );
			parentOffset.left += jQuery.css( offsetParent[ 0 ], "borderLeftWidth", true );
		}

		// Subtract parent offsets and element margins
		return {
			top: offset.top - parentOffset.top - jQuery.css( elem, "marginTop", true ),
			left: offset.left - parentOffset.left - jQuery.css( elem, "marginLeft", true )
		};
	},

	offsetParent: function() {
		return this.map(function() {
			var offsetParent = this.offsetParent || docElem;

			while ( offsetParent && ( !jQuery.nodeName( offsetParent, "html" ) && jQuery.css( offsetParent, "position" ) === "static" ) ) {
				offsetParent = offsetParent.offsetParent;
			}

			return offsetParent || docElem;
		});
	}
});

// Create scrollLeft and scrollTop methods
jQuery.each( { scrollLeft: "pageXOffset", scrollTop: "pageYOffset" }, function( method, prop ) {
	var top = "pageYOffset" === prop;

	jQuery.fn[ method ] = function( val ) {
		return access( this, function( elem, method, val ) {
			var win = getWindow( elem );

			if ( val === undefined ) {
				return win ? win[ prop ] : elem[ method ];
			}

			if ( win ) {
				win.scrollTo(
					!top ? val : window.pageXOffset,
					top ? val : window.pageYOffset
				);

			} else {
				elem[ method ] = val;
			}
		}, method, val, arguments.length, null );
	};
});

// Support: Safari<7+, Chrome<37+
// Add the top/left cssHooks using jQuery.fn.position
// Webkit bug: https://bugs.webkit.org/show_bug.cgi?id=29084
// Blink bug: https://code.google.com/p/chromium/issues/detail?id=229280
// getComputedStyle returns percent when specified for top/left/bottom/right;
// rather than make the css module depend on the offset module, just check for it here
jQuery.each( [ "top", "left" ], function( i, prop ) {
	jQuery.cssHooks[ prop ] = addGetHookIf( support.pixelPosition,
		function( elem, computed ) {
			if ( computed ) {
				computed = curCSS( elem, prop );
				// If curCSS returns percentage, fallback to offset
				return rnumnonpx.test( computed ) ?
					jQuery( elem ).position()[ prop ] + "px" :
					computed;
			}
		}
	);
});


// Create innerHeight, innerWidth, height, width, outerHeight and outerWidth methods
jQuery.each( { Height: "height", Width: "width" }, function( name, type ) {
	jQuery.each( { padding: "inner" + name, content: type, "": "outer" + name }, function( defaultExtra, funcName ) {
		// Margin is only for outerHeight, outerWidth
		jQuery.fn[ funcName ] = function( margin, value ) {
			var chainable = arguments.length && ( defaultExtra || typeof margin !== "boolean" ),
				extra = defaultExtra || ( margin === true || value === true ? "margin" : "border" );

			return access( this, function( elem, type, value ) {
				var doc;

				if ( jQuery.isWindow( elem ) ) {
					// As of 5/8/2012 this will yield incorrect results for Mobile Safari, but there
					// isn't a whole lot we can do. See pull request at this URL for discussion:
					// https://github.com/jquery/jquery/pull/764
					return elem.document.documentElement[ "client" + name ];
				}

				// Get document width or height
				if ( elem.nodeType === 9 ) {
					doc = elem.documentElement;

					// Either scroll[Width/Height] or offset[Width/Height] or client[Width/Height],
					// whichever is greatest
					return Math.max(
						elem.body[ "scroll" + name ], doc[ "scroll" + name ],
						elem.body[ "offset" + name ], doc[ "offset" + name ],
						doc[ "client" + name ]
					);
				}

				return value === undefined ?
					// Get width or height on the element, requesting but not forcing parseFloat
					jQuery.css( elem, type, extra ) :

					// Set width or height on the element
					jQuery.style( elem, type, value, extra );
			}, type, chainable ? margin : undefined, chainable, null );
		};
	});
});


// The number of elements contained in the matched element set
jQuery.fn.size = function() {
	return this.length;
};

jQuery.fn.andSelf = jQuery.fn.addBack;




// Register as a named AMD module, since jQuery can be concatenated with other
// files that may use define, but not via a proper concatenation script that
// understands anonymous AMD modules. A named AMD is safest and most robust
// way to register. Lowercase jquery is used because AMD module names are
// derived from file names, and jQuery is normally delivered in a lowercase
// file name. Do this after creating the global so that if an AMD module wants
// to call noConflict to hide this version of jQuery, it will work.

// Note that for maximum portability, libraries that are not jQuery should
// declare themselves as anonymous modules, and avoid setting a global if an
// AMD loader is present. jQuery is a special case. For more information, see
// https://github.com/jrburke/requirejs/wiki/Updating-existing-libraries#wiki-anon

if ( typeof define === "function" && define.amd ) {
	define( "jquery", [], function() {
		return jQuery;
	});
}




var
	// Map over jQuery in case of overwrite
	_jQuery = window.jQuery,

	// Map over the $ in case of overwrite
	_$ = window.$;

jQuery.noConflict = function( deep ) {
	if ( window.$ === jQuery ) {
		window.$ = _$;
	}

	if ( deep && window.jQuery === jQuery ) {
		window.jQuery = _jQuery;
	}

	return jQuery;
};

// Expose jQuery and $ identifiers, even in AMD
// (#7102#comment:10, https://github.com/jquery/jquery/pull/557)
// and CommonJS for browser emulators (#13566)
if ( typeof noGlobal === strundefined ) {
	window.jQuery = window.$ = jQuery;
}




return jQuery;

}));

},{}],2:[function(require,module,exports){
// http://stackoverflow.com/questions/839899/how-do-i-calculate-a-point-on-a-circles-circumference
// radians = degrees * (pi/180)
// https://github.com/bjornharrtell/jsts/blob/master/examples/buffer.html

var featurecollection = require('turf-featurecollection');
var jsts = require('jsts');
var normalize = require('geojson-normalize');

/**
* Calculates a buffer for input features for a given radius. Units supported are miles, kilometers, and degrees.
*
* @module turf/buffer
* @category transformation
* @param {(Feature|FeatureCollection)} feature input to be buffered
* @param {Number} distance distance to draw the buffer
* @param {String} unit 'miles', 'feet', 'kilometers', 'meters', or 'degrees'
* @return {FeatureCollection<Polygon>|FeatureCollection<MultiPolygon>|Polygon|MultiPolygon} buffered features
*
* @example
* var pt = {
*   "type": "Feature",
*   "properties": {},
*   "geometry": {
*     "type": "Point",
*     "coordinates": [-90.548630, 14.616599]
*   }
* };
* var unit = 'miles';
*
* var buffered = turf.buffer(pt, 500, unit);
* var result = turf.featurecollection([buffered, pt]);
*
* //=result
*/

module.exports = function(feature, radius, units) {

  switch (units) {
    case 'miles':
      radius = radius / 69.047;
    break;
    case 'feet':
      radius = radius / 364568.0;
    break;
    case 'kilometers':
      radius = radius / 111.12;
    break;
    case 'meters':
      radius = radius / 111120.0;
    break;
    case 'degrees':
    break;
  }

  var fc = normalize(feature);
  var buffered = normalize(featurecollection(fc.features.map(function(f) {
    return bufferOp(f, radius);
  })));

  if(buffered.features.length > 1) return buffered;
  else if(buffered.features.length === 1) return buffered.features[0];
};

var bufferOp = function(feature, radius) {
  var reader = new jsts.io.GeoJSONReader();
  var geom = reader.read(JSON.stringify(feature.geometry));
  var buffered = geom.buffer(radius);
  var parser = new jsts.io.GeoJSONParser();
  buffered = parser.write(buffered);

  return {
    type: 'Feature',
    geometry: buffered,
    properties: {}
  };
};

},{"geojson-normalize":3,"jsts":4,"turf-featurecollection":8}],3:[function(require,module,exports){
module.exports = normalize;

var types = {
    Point: 'geometry',
    MultiPoint: 'geometry',
    LineString: 'geometry',
    MultiLineString: 'geometry',
    Polygon: 'geometry',
    MultiPolygon: 'geometry',
    GeometryCollection: 'geometry',
    Feature: 'feature',
    FeatureCollection: 'featurecollection'
};

/**
 * Normalize a GeoJSON feature into a FeatureCollection.
 *
 * @param {object} gj geojson data
 * @returns {object} normalized geojson data
 */
function normalize(gj) {
    if (!gj || !gj.type) return null;
    var type = types[gj.type];
    if (!type) return null;

    if (type === 'geometry') {
        return {
            type: 'FeatureCollection',
            features: [{
                type: 'Feature',
                properties: {},
                geometry: gj
            }]
        };
    } else if (type === 'feature') {
        return {
            type: 'FeatureCollection',
            features: [gj]
        };
    } else if (type === 'featurecollection') {
        return gj;
    }
}

},{}],4:[function(require,module,exports){
require('javascript.util');
var jsts = require('./lib/jsts');
module.exports = jsts

},{"./lib/jsts":5,"javascript.util":7}],5:[function(require,module,exports){
/* The JSTS Topology Suite is a collection of JavaScript classes that
implement the fundamental operations required to validate a given
geo-spatial data set to a known topological specification.

Copyright (C) 2011 The Authors

This library is free software; you can redistribute it and/or
modify it under the terms of the GNU Lesser General Public
License as published by the Free Software Foundation; either
version 2.1 of the License, or (at your option) any later version.

This library is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
Lesser General Public License for more details.

You should have received a copy of the GNU Lesser General Public
License along with this library; if not, write to the Free Software
Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA */
jsts={version:'0.15.0',algorithm:{distance:{},locate:{}},error:{},geom:{util:{}},geomgraph:{index:{}},index:{bintree:{},chain:{},kdtree:{},quadtree:{},strtree:{}},io:{},noding:{snapround:{}},operation:{buffer:{},distance:{},overlay:{snap:{}},polygonize:{},predicate:{},relate:{},union:{},valid:{}},planargraph:{},simplify:{},triangulate:{quadedge:{}},util:{}};if(typeof String.prototype.trim!=='function'){String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,'');};}
jsts.abstractFunc=function(){throw new jsts.error.AbstractMethodInvocationError();};jsts.error={};jsts.error.IllegalArgumentError=function(message){this.name='IllegalArgumentError';this.message=message;};jsts.error.IllegalArgumentError.prototype=new Error();jsts.error.TopologyError=function(message,pt){this.name='TopologyError';this.message=pt?message+' [ '+pt+' ]':message;};jsts.error.TopologyError.prototype=new Error();jsts.error.AbstractMethodInvocationError=function(){this.name='AbstractMethodInvocationError';this.message='Abstract method called, should be implemented in subclass.';};jsts.error.AbstractMethodInvocationError.prototype=new Error();jsts.error.NotImplementedError=function(){this.name='NotImplementedError';this.message='This method has not yet been implemented.';};jsts.error.NotImplementedError.prototype=new Error();jsts.error.NotRepresentableError=function(message){this.name='NotRepresentableError';this.message=message;};jsts.error.NotRepresentableError.prototype=new Error();jsts.error.LocateFailureError=function(message){this.name='LocateFailureError';this.message=message;};jsts.error.LocateFailureError.prototype=new Error();if(typeof module!=="undefined")module.exports=jsts;jsts.geom.GeometryFilter=function(){};jsts.geom.GeometryFilter.prototype.filter=function(geom){throw new jsts.error.AbstractMethodInvocationError();};jsts.geom.util.PolygonExtracter=function(comps){this.comps=comps;};jsts.geom.util.PolygonExtracter.prototype=new jsts.geom.GeometryFilter();jsts.geom.util.PolygonExtracter.prototype.comps=null;jsts.geom.util.PolygonExtracter.getPolygons=function(geom,list){if(list===undefined){list=[];}
if(geom instanceof jsts.geom.Polygon){list.push(geom);}else if(geom instanceof jsts.geom.GeometryCollection){geom.apply(new jsts.geom.util.PolygonExtracter(list));}
return list;};jsts.geom.util.PolygonExtracter.prototype.filter=function(geom){if(geom instanceof jsts.geom.Polygon)
this.comps.push(geom);};jsts.io.WKTParser=function(geometryFactory){this.geometryFactory=geometryFactory||new jsts.geom.GeometryFactory();this.regExes={'typeStr':/^\s*(\w+)\s*\(\s*(.*)\s*\)\s*$/,'emptyTypeStr':/^\s*(\w+)\s*EMPTY\s*$/,'spaces':/\s+/,'parenComma':/\)\s*,\s*\(/,'doubleParenComma':/\)\s*\)\s*,\s*\(\s*\(/,'trimParens':/^\s*\(?(.*?)\)?\s*$/};};jsts.io.WKTParser.prototype.read=function(wkt){var geometry,type,str;wkt=wkt.replace(/[\n\r]/g,' ');var matches=this.regExes.typeStr.exec(wkt);if(wkt.search('EMPTY')!==-1){matches=this.regExes.emptyTypeStr.exec(wkt);matches[2]=undefined;}
if(matches){type=matches[1].toLowerCase();str=matches[2];if(this.parse[type]){geometry=this.parse[type].apply(this,[str]);}}
if(geometry===undefined)
throw new Error('Could not parse WKT '+wkt);return geometry;};jsts.io.WKTParser.prototype.write=function(geometry){return this.extractGeometry(geometry);};jsts.io.WKTParser.prototype.extractGeometry=function(geometry){var type=geometry.CLASS_NAME.split('.')[2].toLowerCase();if(!this.extract[type]){return null;}
var wktType=type.toUpperCase();var data;if(geometry.isEmpty()){data=wktType+' EMPTY';}else{data=wktType+'('+this.extract[type].apply(this,[geometry])+')';}
return data;};jsts.io.WKTParser.prototype.extract={'coordinate':function(coordinate){return coordinate.x+' '+coordinate.y;},'point':function(point){return point.coordinate.x+' '+point.coordinate.y;},'multipoint':function(multipoint){var array=[];for(var i=0,len=multipoint.geometries.length;i<len;++i){array.push('('+
this.extract.point.apply(this,[multipoint.geometries[i]])+')');}
return array.join(',');},'linestring':function(linestring){var array=[];for(var i=0,len=linestring.points.length;i<len;++i){array.push(this.extract.coordinate.apply(this,[linestring.points[i]]));}
return array.join(',');},'multilinestring':function(multilinestring){var array=[];for(var i=0,len=multilinestring.geometries.length;i<len;++i){array.push('('+
this.extract.linestring.apply(this,[multilinestring.geometries[i]])+')');}
return array.join(',');},'polygon':function(polygon){var array=[];array.push('('+this.extract.linestring.apply(this,[polygon.shell])+')');for(var i=0,len=polygon.holes.length;i<len;++i){array.push('('+this.extract.linestring.apply(this,[polygon.holes[i]])+')');}
return array.join(',');},'multipolygon':function(multipolygon){var array=[];for(var i=0,len=multipolygon.geometries.length;i<len;++i){array.push('('+this.extract.polygon.apply(this,[multipolygon.geometries[i]])+')');}
return array.join(',');},'geometrycollection':function(collection){var array=[];for(var i=0,len=collection.geometries.length;i<len;++i){array.push(this.extractGeometry.apply(this,[collection.geometries[i]]));}
return array.join(',');}};jsts.io.WKTParser.prototype.parse={'point':function(str){if(str===undefined){return this.geometryFactory.createPoint(null);}
var coords=str.trim().split(this.regExes.spaces);return this.geometryFactory.createPoint(new jsts.geom.Coordinate(coords[0],coords[1]));},'multipoint':function(str){if(str===undefined){return this.geometryFactory.createMultiPoint(null);}
var point;var points=str.trim().split(',');var components=[];for(var i=0,len=points.length;i<len;++i){point=points[i].replace(this.regExes.trimParens,'$1');components.push(this.parse.point.apply(this,[point]));}
return this.geometryFactory.createMultiPoint(components);},'linestring':function(str){if(str===undefined){return this.geometryFactory.createLineString(null);}
var points=str.trim().split(',');var components=[];var coords;for(var i=0,len=points.length;i<len;++i){coords=points[i].trim().split(this.regExes.spaces);components.push(new jsts.geom.Coordinate(coords[0],coords[1]));}
return this.geometryFactory.createLineString(components);},'linearring':function(str){if(str===undefined){return this.geometryFactory.createLinearRing(null);}
var points=str.trim().split(',');var components=[];var coords;for(var i=0,len=points.length;i<len;++i){coords=points[i].trim().split(this.regExes.spaces);components.push(new jsts.geom.Coordinate(coords[0],coords[1]));}
return this.geometryFactory.createLinearRing(components);},'multilinestring':function(str){if(str===undefined){return this.geometryFactory.createMultiLineString(null);}
var line;var lines=str.trim().split(this.regExes.parenComma);var components=[];for(var i=0,len=lines.length;i<len;++i){line=lines[i].replace(this.regExes.trimParens,'$1');components.push(this.parse.linestring.apply(this,[line]));}
return this.geometryFactory.createMultiLineString(components);},'polygon':function(str){if(str===undefined){return this.geometryFactory.createPolygon(null);}
var ring,linestring,linearring;var rings=str.trim().split(this.regExes.parenComma);var shell;var holes=[];for(var i=0,len=rings.length;i<len;++i){ring=rings[i].replace(this.regExes.trimParens,'$1');linestring=this.parse.linestring.apply(this,[ring]);linearring=this.geometryFactory.createLinearRing(linestring.points);if(i===0){shell=linearring;}else{holes.push(linearring);}}
return this.geometryFactory.createPolygon(shell,holes);},'multipolygon':function(str){if(str===undefined){return this.geometryFactory.createMultiPolygon(null);}
var polygon;var polygons=str.trim().split(this.regExes.doubleParenComma);var components=[];for(var i=0,len=polygons.length;i<len;++i){polygon=polygons[i].replace(this.regExes.trimParens,'$1');components.push(this.parse.polygon.apply(this,[polygon]));}
return this.geometryFactory.createMultiPolygon(components);},'geometrycollection':function(str){if(str===undefined){return this.geometryFactory.createGeometryCollection(null);}
str=str.replace(/,\s*([A-Za-z])/g,'|$1');var wktArray=str.trim().split('|');var components=[];for(var i=0,len=wktArray.length;i<len;++i){components.push(jsts.io.WKTParser.prototype.read.apply(this,[wktArray[i]]));}
return this.geometryFactory.createGeometryCollection(components);}};jsts.index.ItemVisitor=function(){};jsts.index.ItemVisitor.prototype.visitItem=function(){throw new jsts.error.AbstractMethodInvocationError();};jsts.algorithm.CGAlgorithms=function(){};jsts.algorithm.CGAlgorithms.CLOCKWISE=-1;jsts.algorithm.CGAlgorithms.RIGHT=jsts.algorithm.CGAlgorithms.CLOCKWISE;jsts.algorithm.CGAlgorithms.COUNTERCLOCKWISE=1;jsts.algorithm.CGAlgorithms.LEFT=jsts.algorithm.CGAlgorithms.COUNTERCLOCKWISE;jsts.algorithm.CGAlgorithms.COLLINEAR=0;jsts.algorithm.CGAlgorithms.STRAIGHT=jsts.algorithm.CGAlgorithms.COLLINEAR;jsts.algorithm.CGAlgorithms.orientationIndex=function(p1,p2,q){var dx1,dy1,dx2,dy2;dx1=p2.x-p1.x;dy1=p2.y-p1.y;dx2=q.x-p2.x;dy2=q.y-p2.y;return jsts.algorithm.RobustDeterminant.signOfDet2x2(dx1,dy1,dx2,dy2);};jsts.algorithm.CGAlgorithms.isPointInRing=function(p,ring){return jsts.algorithm.CGAlgorithms.locatePointInRing(p,ring)!==jsts.geom.Location.EXTERIOR;};jsts.algorithm.CGAlgorithms.locatePointInRing=function(p,ring){return jsts.algorithm.RayCrossingCounter.locatePointInRing(p,ring);};jsts.algorithm.CGAlgorithms.isOnLine=function(p,pt){var lineIntersector,i,il,p0,p1;lineIntersector=new jsts.algorithm.RobustLineIntersector();for(i=1,il=pt.length;i<il;i++){p0=pt[i-1];p1=pt[i];lineIntersector.computeIntersection(p,p0,p1);if(lineIntersector.hasIntersection()){return true;}}
return false;};jsts.algorithm.CGAlgorithms.isCCW=function(ring){var nPts,hiPt,hiIndex,p,iPrev,iNext,prev,next,i,disc,isCCW;nPts=ring.length-1;if(nPts<3){throw new jsts.IllegalArgumentError('Ring has fewer than 3 points, so orientation cannot be determined');}
hiPt=ring[0];hiIndex=0;i=1;for(i;i<=nPts;i++){p=ring[i];if(p.y>hiPt.y){hiPt=p;hiIndex=i;}}
iPrev=hiIndex;do{iPrev=iPrev-1;if(iPrev<0){iPrev=nPts;}}while(ring[iPrev].equals2D(hiPt)&&iPrev!==hiIndex);iNext=hiIndex;do{iNext=(iNext+1)%nPts;}while(ring[iNext].equals2D(hiPt)&&iNext!==hiIndex);prev=ring[iPrev];next=ring[iNext];if(prev.equals2D(hiPt)||next.equals2D(hiPt)||prev.equals2D(next)){return false;}
disc=jsts.algorithm.CGAlgorithms.computeOrientation(prev,hiPt,next);isCCW=false;if(disc===0){isCCW=(prev.x>next.x);}else{isCCW=(disc>0);}
return isCCW;};jsts.algorithm.CGAlgorithms.computeOrientation=function(p1,p2,q){return jsts.algorithm.CGAlgorithms.orientationIndex(p1,p2,q);};jsts.algorithm.CGAlgorithms.distancePointLine=function(p,A,B){if(!(A instanceof jsts.geom.Coordinate)){jsts.algorithm.CGAlgorithms.distancePointLine2.apply(this,arguments);}
if(A.x===B.x&&A.y===B.y){return p.distance(A);}
var r,s;r=((p.x-A.x)*(B.x-A.x)+(p.y-A.y)*(B.y-A.y))/((B.x-A.x)*(B.x-A.x)+(B.y-A.y)*(B.y-A.y));if(r<=0.0){return p.distance(A);}
if(r>=1.0){return p.distance(B);}
s=((A.y-p.y)*(B.x-A.x)-(A.x-p.x)*(B.y-A.y))/((B.x-A.x)*(B.x-A.x)+(B.y-A.y)*(B.y-A.y));return Math.abs(s)*Math.sqrt(((B.x-A.x)*(B.x-A.x)+(B.y-A.y)*(B.y-A.y)));};jsts.algorithm.CGAlgorithms.distancePointLinePerpendicular=function(p,A,B){var s=((A.y-p.y)*(B.x-A.x)-(A.x-p.x)*(B.y-A.y))/((B.x-A.x)*(B.x-A.x)+(B.y-A.y)*(B.y-A.y));return Math.abs(s)*Math.sqrt(((B.x-A.x)*(B.x-A.x)+(B.y-A.y)*(B.y-A.y)));};jsts.algorithm.CGAlgorithms.distancePointLine2=function(p,line){var minDistance,i,il,dist;if(line.length===0){throw new jsts.error.IllegalArgumentError('Line array must contain at least one vertex');}
minDistance=p.distance(line[0]);for(i=0,il=line.length-1;i<il;i++){dist=jsts.algorithm.CGAlgorithms.distancePointLine(p,line[i],line[i+1]);if(dist<minDistance){minDistance=dist;}}
return minDistance;};jsts.algorithm.CGAlgorithms.distanceLineLine=function(A,B,C,D){if(A.equals(B)){return jsts.algorithm.CGAlgorithms.distancePointLine(A,C,D);}
if(C.equals(D)){return jsts.algorithm.CGAlgorithms.distancePointLine(D,A,B);}
var r_top,r_bot,s_top,s_bot,s,r;r_top=(A.y-C.y)*(D.x-C.x)-(A.x-C.x)*(D.y-C.y);r_bot=(B.x-A.x)*(D.y-C.y)-(B.y-A.y)*(D.x-C.x);s_top=(A.y-C.y)*(B.x-A.x)-(A.x-C.x)*(B.y-A.y);s_bot=(B.x-A.x)*(D.y-C.y)-(B.y-A.y)*(D.x-C.x);if((r_bot===0)||(s_bot===0)){return Math.min(jsts.algorithm.CGAlgorithms.distancePointLine(A,C,D),Math.min(jsts.algorithm.CGAlgorithms.distancePointLine(B,C,D),Math.min(jsts.algorithm.CGAlgorithms.distancePointLine(C,A,B),jsts.algorithm.CGAlgorithms.distancePointLine(D,A,B))));}
s=s_top/s_bot;r=r_top/r_bot;if((r<0)||(r>1)||(s<0)||(s>1)){return Math.min(jsts.algorithm.CGAlgorithms.distancePointLine(A,C,D),Math.min(jsts.algorithm.CGAlgorithms.distancePointLine(B,C,D),Math.min(jsts.algorithm.CGAlgorithms.distancePointLine(C,A,B),jsts.algorithm.CGAlgorithms.distancePointLine(D,A,B))));}
return 0.0;};jsts.algorithm.CGAlgorithms.signedArea=function(ring){if(ring.length<3){return 0.0;}
var sum,i,il,bx,by,cx,cy;sum=0.0;for(i=0,il=ring.length-1;i<il;i++){bx=ring[i].x;by=ring[i].y;cx=ring[i+1].x;cy=ring[i+1].y;sum+=(bx+cx)*(cy-by);}
return-sum/2.0;};jsts.algorithm.CGAlgorithms.signedArea=function(ring){var n,sum,p,bx,by,i,cx,cy;n=ring.length;if(n<3){return 0.0;}
sum=0.0;p=ring[0];bx=p.x;by=p.y;for(i=1;i<n;i++){p=ring[i];cx=p.x;cy=p.y;sum+=(bx+cx)*(cy-by);bx=cx;by=cy;}
return-sum/2.0;};jsts.algorithm.CGAlgorithms.computeLength=function(pts){var n=pts.length,len,x0,y0,x1,y1,dx,dy,p,i,il;if(n<=1){return 0.0;}
len=0.0;p=pts[0];x0=p.x;y0=p.y;i=1,il=n;for(i;i<n;i++){p=pts[i];x1=p.x;y1=p.y;dx=x1-x0;dy=y1-y0;len+=Math.sqrt(dx*dx+dy*dy);x0=x1;y0=y1;}
return len;};jsts.algorithm.CGAlgorithms.length=function(){};jsts.algorithm.Angle=function(){};jsts.algorithm.Angle.PI_TIMES_2=2.0*Math.PI;jsts.algorithm.Angle.PI_OVER_2=Math.PI/2.0;jsts.algorithm.Angle.PI_OVER_4=Math.PI/4.0;jsts.algorithm.Angle.COUNTERCLOCKWISE=jsts.algorithm.CGAlgorithms.COUNTERCLOCKWISE;jsts.algorithm.Angle.CLOCKWISE=jsts.algorithm.CGAlgorithms.CLOCKWISE;jsts.algorithm.Angle.NONE=jsts.algorithm.CGAlgorithms.COLLINEAR;jsts.algorithm.Angle.toDegrees=function(radians){return(radians*180)/Math.PI;};jsts.algorithm.Angle.toRadians=function(angleDegrees){return(angleDegrees*Math.PI)/180.0;};jsts.algorithm.Angle.angle=function(){if(arguments.length===1){return jsts.algorithm.Angle.angleFromOrigo(arguments[0]);}else{return jsts.algorithm.Angle.angleBetweenCoords(arguments[0],arguments[1]);}};jsts.algorithm.Angle.angleBetweenCoords=function(p0,p1){var dx,dy;dx=p1.x-p0.x;dy=p1.y-p0.y;return Math.atan2(dy,dx);};jsts.algorithm.Angle.angleFromOrigo=function(p){return Math.atan2(p.y,p.x);};jsts.algorithm.Angle.isAcute=function(p0,p1,p2){var dx0,dy0,dx1,dy1,dotprod;dx0=p0.x-p1.x;dy0=p0.y-p1.y;dx1=p2.x-p1.x;dy1=p2.y-p1.y;dotprod=dx0*dx1+dy0*dy1;return dotprod>0;};jsts.algorithm.Angle.isObtuse=function(p0,p1,p2){var dx0,dy0,dx1,dy1,dotprod;dx0=p0.x-p1.x;dy0=p0.y-p1.y;dx1=p2.x-p1.x;dy1=p2.y-p1.y;dotprod=dx0*dx1+dy0*dy1;return dotprod<0;};jsts.algorithm.Angle.angleBetween=function(tip1,tail,tip2){var a1,a2;a1=jsts.algorithm.Angle.angle(tail,tip1);a2=jsts.algorithm.Angle.angle(tail,tip2);return jsts.algorithm.Angle.diff(a1,a2);};jsts.algorithm.Angle.angleBetweenOriented=function(tip1,tail,tip2){var a1,a2,angDel;a1=jsts.algorithm.Angle.angle(tail,tip1);a2=jsts.algorithm.Angle.angle(tail,tip2);angDel=a2-a1;if(angDel<=-Math.PI){return angDel+jsts.algorithm.Angle.PI_TIMES_2;}
if(angDel>Math.PI){return angDel-jsts.algorithm.Angle.PI_TIMES_2;}
return angDel;};jsts.algorithm.Angle.interiorAngle=function(p0,p1,p2){var anglePrev,angleNext;anglePrev=jsts.algorithm.Angle.angle(p1,p0);angleNext=jsts.algorithm.Angle.angle(p1,p2);return Math.abs(angleNext-anglePrev);};jsts.algorithm.Angle.getTurn=function(ang1,ang2){var crossproduct=Math.sin(ang2-ang1);if(crossproduct>0){return jsts.algorithm.Angle.COUNTERCLOCKWISE;}
if(crossproduct<0){return jsts.algorithm.Angle.CLOCKWISE;}
return jsts.algorithm.Angle.NONE;};jsts.algorithm.Angle.normalize=function(angle){while(angle>Math.PI){angle-=jsts.algorithm.Angle.PI_TIMES_2;}
while(angle<=-Math.PI){angle+=jsts.algorithm.Angle.PI_TIMES_2;}
return angle;};jsts.algorithm.Angle.normalizePositive=function(angle){if(angle<0.0){while(angle<0.0){angle+=jsts.algorithm.Angle.PI_TIMES_2;}
if(angle>=jsts.algorithm.Angle.PI_TIMES_2){angle=0.0;}}
else{while(angle>=jsts.algorithm.Angle.PI_TIMES_2){angle-=jsts.algorithm.Angle.PI_TIMES_2;}
if(angle<0.0){angle=0.0;}}
return angle;};jsts.algorithm.Angle.diff=function(ang1,ang2){var delAngle;if(ang1<ang2){delAngle=ang2-ang1;}else{delAngle=ang1-ang2;}
if(delAngle>Math.PI){delAngle=(2*Math.PI)-delAngle;}
return delAngle;};jsts.geom.GeometryComponentFilter=function(){};jsts.geom.GeometryComponentFilter.prototype.filter=function(geom){throw new jsts.error.AbstractMethodInvocationError();};jsts.geom.util.LinearComponentExtracter=function(lines,isForcedToLineString){this.lines=lines;this.isForcedToLineString=isForcedToLineString;};jsts.geom.util.LinearComponentExtracter.prototype=new jsts.geom.GeometryComponentFilter();jsts.geom.util.LinearComponentExtracter.prototype.lines=null;jsts.geom.util.LinearComponentExtracter.prototype.isForcedToLineString=false;jsts.geom.util.LinearComponentExtracter.getLines=function(geoms,lines){if(arguments.length==1){return jsts.geom.util.LinearComponentExtracter.getLines5.apply(this,arguments);}
else if(arguments.length==2&&typeof lines==='boolean'){return jsts.geom.util.LinearComponentExtracter.getLines6.apply(this,arguments);}
else if(arguments.length==2&&geoms instanceof jsts.geom.Geometry){return jsts.geom.util.LinearComponentExtracter.getLines3.apply(this,arguments);}
else if(arguments.length==3&&geoms instanceof jsts.geom.Geometry){return jsts.geom.util.LinearComponentExtracter.getLines4.apply(this,arguments);}
else if(arguments.length==3){return jsts.geom.util.LinearComponentExtracter.getLines2.apply(this,arguments);}
for(var i=0;i<geoms.length;i++){var g=geoms[i];jsts.geom.util.LinearComponentExtracter.getLines3(g,lines);}
return lines;};jsts.geom.util.LinearComponentExtracter.getLines2=function(geoms,lines,forceToLineString){for(var i=0;i<geoms.length;i++){var g=geoms[i];jsts.geom.util.LinearComponentExtracter.getLines4(g,lines,forceToLineString);}
return lines;};jsts.geom.util.LinearComponentExtracter.getLines3=function(geom,lines){if(geom instanceof LineString){lines.add(geom);}else{geom.apply(new jsts.geom.util.LinearComponentExtracter(lines));}
return lines;};jsts.geom.util.LinearComponentExtracter.getLines4=function(geom,lines,forceToLineString){geom.apply(new jsts.geom.util.LinearComponentExtracter(lines,forceToLineString));return lines;};jsts.geom.util.LinearComponentExtracter.getLines5=function(geom){return jsts.geom.util.LinearComponentExtracter.getLines6(geom,false);};jsts.geom.util.LinearComponentExtracter.getLines6=function(geom,forceToLineString){var lines=[];geom.apply(new jsts.geom.util.LinearComponentExtracter(lines,forceToLineString));return lines;};jsts.geom.util.LinearComponentExtracter.prototype.setForceToLineString=function(isForcedToLineString){this.isForcedToLineString=isForcedToLineString;};jsts.geom.util.LinearComponentExtracter.prototype.filter=function(geom){if(this.isForcedToLineString&&geom instanceof jsts.geom.LinearRing){var line=geom.getFactory().createLineString(geom.getCoordinateSequence());this.lines.push(line);return;}
if(geom instanceof jsts.geom.LineString||geom instanceof jsts.geom.LinearRing)
this.lines.push(geom);};jsts.geom.Location=function(){};jsts.geom.Location.INTERIOR=0;jsts.geom.Location.BOUNDARY=1;jsts.geom.Location.EXTERIOR=2;jsts.geom.Location.NONE=-1;jsts.geom.Location.toLocationSymbol=function(locationValue){switch(locationValue){case jsts.geom.Location.EXTERIOR:return'e';case jsts.geom.Location.BOUNDARY:return'b';case jsts.geom.Location.INTERIOR:return'i';case jsts.geom.Location.NONE:return'-';}
throw new jsts.IllegalArgumentError('Unknown location value: '+
locationValue);};(function(){jsts.io.GeoJSONReader=function(geometryFactory){this.geometryFactory=geometryFactory||new jsts.geom.GeometryFactory();this.precisionModel=this.geometryFactory.getPrecisionModel();this.parser=new jsts.io.GeoJSONParser(this.geometryFactory);};jsts.io.GeoJSONReader.prototype.read=function(geoJson){var geometry=this.parser.read(geoJson);if(this.precisionModel.getType()===jsts.geom.PrecisionModel.FIXED){this.reducePrecision(geometry);}
return geometry;};jsts.io.GeoJSONReader.prototype.reducePrecision=function(geometry){var i,len;if(geometry.coordinate){this.precisionModel.makePrecise(geometry.coordinate);}else if(geometry.points){for(i=0,len=geometry.points.length;i<len;i++){this.precisionModel.makePrecise(geometry.points[i]);}}else if(geometry.geometries){for(i=0,len=geometry.geometries.length;i<len;i++){this.reducePrecision(geometry.geometries[i]);}}};})();jsts.geom.Geometry=function(factory){this.factory=factory;};jsts.geom.Geometry.prototype.envelope=null;jsts.geom.Geometry.prototype.factory=null;jsts.geom.Geometry.prototype.getGeometryType=function(){return'Geometry';};jsts.geom.Geometry.hasNonEmptyElements=function(geometries){var i;for(i=0;i<geometries.length;i++){if(!geometries[i].isEmpty()){return true;}}
return false;};jsts.geom.Geometry.hasNullElements=function(array){var i;for(i=0;i<array.length;i++){if(array[i]===null){return true;}}
return false;};jsts.geom.Geometry.prototype.getFactory=function(){if(this.factory===null||this.factory===undefined){this.factory=new jsts.geom.GeometryFactory();}
return this.factory;};jsts.geom.Geometry.prototype.getNumGeometries=function(){return 1;};jsts.geom.Geometry.prototype.getGeometryN=function(n){return this;};jsts.geom.Geometry.prototype.getPrecisionModel=function(){return this.getFactory().getPrecisionModel();};jsts.geom.Geometry.prototype.getCoordinate=function(){throw new jsts.error.AbstractMethodInvocationError();};jsts.geom.Geometry.prototype.getCoordinates=function(){throw new jsts.error.AbstractMethodInvocationError();};jsts.geom.Geometry.prototype.getNumPoints=function(){throw new jsts.error.AbstractMethodInvocationError();};jsts.geom.Geometry.prototype.isSimple=function(){this.checkNotGeometryCollection(this);var op=new jsts.operation.IsSimpleOp(this);return op.isSimple();};jsts.geom.Geometry.prototype.isValid=function(){var isValidOp=new jsts.operation.valid.IsValidOp(this);return isValidOp.isValid();};jsts.geom.Geometry.prototype.isEmpty=function(){throw new jsts.error.AbstractMethodInvocationError();};jsts.geom.Geometry.prototype.distance=function(g){return jsts.operation.distance.DistanceOp.distance(this,g);};jsts.geom.Geometry.prototype.isWithinDistance=function(geom,distance){var envDist=this.getEnvelopeInternal().distance(geom.getEnvelopeInternal());if(envDist>distance){return false;}
return DistanceOp.isWithinDistance(this,geom,distance);};jsts.geom.Geometry.prototype.isRectangle=function(){return false;};jsts.geom.Geometry.prototype.getArea=function(){return 0.0;};jsts.geom.Geometry.prototype.getLength=function(){return 0.0;};jsts.geom.Geometry.prototype.getCentroid=function(){if(this.isEmpty()){return null;}
var cent;var centPt=null;var dim=this.getDimension();if(dim===0){cent=new jsts.algorithm.CentroidPoint();cent.add(this);centPt=cent.getCentroid();}else if(dim===1){cent=new jsts.algorithm.CentroidLine();cent.add(this);centPt=cent.getCentroid();}else{cent=new jsts.algorithm.CentroidArea();cent.add(this);centPt=cent.getCentroid();}
return this.createPointFromInternalCoord(centPt,this);};jsts.geom.Geometry.prototype.getInteriorPoint=function(){var intPt;var interiorPt=null;var dim=this.getDimension();if(dim===0){intPt=new jsts.algorithm.InteriorPointPoint(this);interiorPt=intPt.getInteriorPoint();}else if(dim===1){intPt=new jsts.algorithm.InteriorPointLine(this);interiorPt=intPt.getInteriorPoint();}else{intPt=new jsts.algorithm.InteriorPointArea(this);interiorPt=intPt.getInteriorPoint();}
return this.createPointFromInternalCoord(interiorPt,this);};jsts.geom.Geometry.prototype.getDimension=function(){throw new jsts.error.AbstractMethodInvocationError();};jsts.geom.Geometry.prototype.getBoundary=function(){throw new jsts.error.AbstractMethodInvocationError();};jsts.geom.Geometry.prototype.getBoundaryDimension=function(){throw new jsts.error.AbstractMethodInvocationError();};jsts.geom.Geometry.prototype.getEnvelope=function(){return this.getFactory().toGeometry(this.getEnvelopeInternal());};jsts.geom.Geometry.prototype.getEnvelopeInternal=function(){if(this.envelope===null){this.envelope=this.computeEnvelopeInternal();}
return this.envelope;};jsts.geom.Geometry.prototype.disjoint=function(g){return!this.intersects(g);};jsts.geom.Geometry.prototype.touches=function(g){if(!this.getEnvelopeInternal().intersects(g.getEnvelopeInternal())){return false;}
return this.relate(g).isTouches(this.getDimension(),g.getDimension());};jsts.geom.Geometry.prototype.intersects=function(g){if(!this.getEnvelopeInternal().intersects(g.getEnvelopeInternal())){return false;}
if(this.isRectangle()){return jsts.operation.predicate.RectangleIntersects.intersects(this,g);}
if(g.isRectangle()){return jsts.operation.predicate.RectangleIntersects.intersects(g,this);}
return this.relate(g).isIntersects();};jsts.geom.Geometry.prototype.crosses=function(g){if(!this.getEnvelopeInternal().intersects(g.getEnvelopeInternal())){return false;}
return this.relate(g).isCrosses(this.getDimension(),g.getDimension());};jsts.geom.Geometry.prototype.within=function(g){return g.contains(this);};jsts.geom.Geometry.prototype.contains=function(g){if(!this.getEnvelopeInternal().contains(g.getEnvelopeInternal())){return false;}
if(this.isRectangle()){return jsts.operation.predicate.RectangleContains.contains(this,g);}
return this.relate(g).isContains();};jsts.geom.Geometry.prototype.overlaps=function(g){if(!this.getEnvelopeInternal().intersects(g.getEnvelopeInternal())){return false;}
return this.relate(g).isOverlaps(this.getDimension(),g.getDimension());};jsts.geom.Geometry.prototype.covers=function(g){if(!this.getEnvelopeInternal().covers(g.getEnvelopeInternal())){return false;}
if(this.isRectangle()){return true;}
return this.relate(g).isCovers();};jsts.geom.Geometry.prototype.coveredBy=function(g){return g.covers(this);};jsts.geom.Geometry.prototype.relate=function(g,intersectionPattern){if(arguments.length===1){return this.relate2.apply(this,arguments);}
return this.relate2(g).matches(intersectionPattern);};jsts.geom.Geometry.prototype.relate2=function(g){this.checkNotGeometryCollection(this);this.checkNotGeometryCollection(g);return jsts.operation.relate.RelateOp.relate(this,g);};jsts.geom.Geometry.prototype.equalsTopo=function(g){if(!this.getEnvelopeInternal().equals(g.getEnvelopeInternal())){return false;}
return this.relate(g).isEquals(this.getDimension(),g.getDimension());};jsts.geom.Geometry.prototype.equals=function(o){if(o instanceof jsts.geom.Geometry||o instanceof jsts.geom.LinearRing||o instanceof jsts.geom.Polygon||o instanceof jsts.geom.GeometryCollection||o instanceof jsts.geom.MultiPoint||o instanceof jsts.geom.MultiLineString||o instanceof jsts.geom.MultiPolygon){return this.equalsExact(o);}
return false;};jsts.geom.Geometry.prototype.buffer=function(distance,quadrantSegments,endCapStyle){var params=new jsts.operation.buffer.BufferParameters(quadrantSegments,endCapStyle)
return jsts.operation.buffer.BufferOp.bufferOp2(this,distance,params);};jsts.geom.Geometry.prototype.convexHull=function(){return new jsts.algorithm.ConvexHull(this).getConvexHull();};jsts.geom.Geometry.prototype.intersection=function(other){if(this.isEmpty()){return this.getFactory().createGeometryCollection(null);}
if(other.isEmpty()){return this.getFactory().createGeometryCollection(null);}
if(this.isGeometryCollection(this)){var g2=other;}
this.checkNotGeometryCollection(this);this.checkNotGeometryCollection(other);return jsts.operation.overlay.snap.SnapIfNeededOverlayOp.overlayOp(this,other,jsts.operation.overlay.OverlayOp.INTERSECTION);};jsts.geom.Geometry.prototype.union=function(other){if(arguments.length===0){return jsts.operation.union.UnaryUnionOp.union(this);}
if(this.isEmpty()){return other.clone();}
if(other.isEmpty()){return this.clone();}
this.checkNotGeometryCollection(this);this.checkNotGeometryCollection(other);return jsts.operation.overlay.snap.SnapIfNeededOverlayOp.overlayOp(this,other,jsts.operation.overlay.OverlayOp.UNION);};jsts.geom.Geometry.prototype.difference=function(other){if(this.isEmpty()){return this.getFactory().createGeometryCollection(null);}
if(other.isEmpty()){return this.clone();}
this.checkNotGeometryCollection(this);this.checkNotGeometryCollection(other);return jsts.operation.overlay.snap.SnapIfNeededOverlayOp.overlayOp(this,other,jsts.operation.overlay.OverlayOp.DIFFERENCE);};jsts.geom.Geometry.prototype.symDifference=function(other){if(this.isEmpty()){return other.clone();}
if(other.isEmpty()){return this.clone();}
this.checkNotGeometryCollection(this);this.checkNotGeometryCollection(other);return jsts.operation.overlay.snap.SnapIfNeededOverlayOp.overlayOp(this,other,jsts.operation.overlay.OverlayOp.SYMDIFFERENCE);};jsts.geom.Geometry.prototype.equalsExact=function(other,tolerance){throw new jsts.error.AbstractMethodInvocationError();};jsts.geom.Geometry.prototype.equalsNorm=function(g){if(g===null||g===undefined)
return false;return this.norm().equalsExact(g.norm());};jsts.geom.Geometry.prototype.apply=function(filter){throw new jsts.error.AbstractMethodInvocationError();};jsts.geom.Geometry.prototype.clone=function(){throw new jsts.error.AbstractMethodInvocationError();};jsts.geom.Geometry.prototype.normalize=function(){throw new jsts.error.AbstractMethodInvocationError();};jsts.geom.Geometry.prototype.norm=function(){var copy=this.clone();copy.normalize();return copy;};jsts.geom.Geometry.prototype.compareTo=function(o){var other=o;if(this.getClassSortIndex()!==other.getClassSortIndex()){return this.getClassSortIndex()-other.getClassSortIndex();}
if(this.isEmpty()&&other.isEmpty()){return 0;}
if(this.isEmpty()){return-1;}
if(other.isEmpty()){return 1;}
return this.compareToSameClass(o);};jsts.geom.Geometry.prototype.isEquivalentClass=function(other){if(this instanceof jsts.geom.Point&&other instanceof jsts.geom.Point){return true;}else if(this instanceof jsts.geom.LineString&&(other instanceof jsts.geom.LineString|other instanceof jsts.geom.LinearRing)){return true;}else if(this instanceof jsts.geom.LinearRing&&(other instanceof jsts.geom.LineString|other instanceof jsts.geom.LinearRing)){return true;}else if(this instanceof jsts.geom.Polygon&&(other instanceof jsts.geom.Polygon)){return true;}else if(this instanceof jsts.geom.MultiPoint&&(other instanceof jsts.geom.MultiPoint)){return true;}else if(this instanceof jsts.geom.MultiLineString&&(other instanceof jsts.geom.MultiLineString)){return true;}else if(this instanceof jsts.geom.MultiPolygon&&(other instanceof jsts.geom.MultiPolygon)){return true;}else if(this instanceof jsts.geom.GeometryCollection&&(other instanceof jsts.geom.GeometryCollection)){return true;}
return false;};jsts.geom.Geometry.prototype.checkNotGeometryCollection=function(g){if(g.isGeometryCollectionBase()){throw new jsts.error.IllegalArgumentError('This method does not support GeometryCollection');}};jsts.geom.Geometry.prototype.isGeometryCollection=function(){return(this instanceof jsts.geom.GeometryCollection);};jsts.geom.Geometry.prototype.isGeometryCollectionBase=function(){return(this.CLASS_NAME==='jsts.geom.GeometryCollection');};jsts.geom.Geometry.prototype.computeEnvelopeInternal=function(){throw new jsts.error.AbstractMethodInvocationError();};jsts.geom.Geometry.prototype.compareToSameClass=function(o){throw new jsts.error.AbstractMethodInvocationError();};jsts.geom.Geometry.prototype.compare=function(a,b){var i=a.iterator();var j=b.iterator();while(i.hasNext()&&j.hasNext()){var aElement=i.next();var bElement=j.next();var comparison=aElement.compareTo(bElement);if(comparison!==0){return comparison;}}
if(i.hasNext()){return 1;}
if(j.hasNext()){return-1;}
return 0;};jsts.geom.Geometry.prototype.equal=function(a,b,tolerance){if(tolerance===undefined||tolerance===null||tolerance===0){return a.equals(b);}
return a.distance(b)<=tolerance;};jsts.geom.Geometry.prototype.getClassSortIndex=function(){var sortedClasses=[jsts.geom.Point,jsts.geom.MultiPoint,jsts.geom.LineString,jsts.geom.LinearRing,jsts.geom.MultiLineString,jsts.geom.Polygon,jsts.geom.MultiPolygon,jsts.geom.GeometryCollection];for(var i=0;i<sortedClasses.length;i++){if(this instanceof sortedClasses[i])
return i;}
jsts.util.Assert.shouldNeverReachHere('Class not supported: '+this);return-1;};jsts.geom.Geometry.prototype.toString=function(){return new jsts.io.WKTWriter().write(this);};jsts.geom.Geometry.prototype.createPointFromInternalCoord=function(coord,exemplar){exemplar.getPrecisionModel().makePrecise(coord);return exemplar.getFactory().createPoint(coord);};(function(){jsts.geom.Coordinate=function(x,y){if(typeof x==='number'){this.x=x;this.y=y;}else if(x instanceof jsts.geom.Coordinate){this.x=parseFloat(x.x);this.y=parseFloat(x.y);}else if(x===undefined||x===null){this.x=0;this.y=0;}else if(typeof x==='string'){this.x=parseFloat(x);this.y=parseFloat(y);}};jsts.geom.Coordinate.prototype.setCoordinate=function(other){this.x=other.x;this.y=other.y;};jsts.geom.Coordinate.prototype.clone=function(){return new jsts.geom.Coordinate(this.x,this.y);};jsts.geom.Coordinate.prototype.distance=function(p){var dx=this.x-p.x;var dy=this.y-p.y;return Math.sqrt(dx*dx+dy*dy);};jsts.geom.Coordinate.prototype.equals2D=function(other){if(this.x!==other.x){return false;}
if(this.y!==other.y){return false;}
return true;};jsts.geom.Coordinate.prototype.equals=function(other){if(!other instanceof jsts.geom.Coordinate||other===undefined){return false;}
return this.equals2D(other);};jsts.geom.Coordinate.prototype.compareTo=function(other){if(this.x<other.x){return-1;}
if(this.x>other.x){return 1;}
if(this.y<other.y){return-1;}
if(this.y>other.y){return 1;}
return 0;};jsts.geom.Coordinate.prototype.toString=function(){return'('+this.x+', '+this.y+')';};})();jsts.geom.Envelope=function(){jsts.geom.Envelope.prototype.init.apply(this,arguments);};jsts.geom.Envelope.prototype.minx=null;jsts.geom.Envelope.prototype.maxx=null;jsts.geom.Envelope.prototype.miny=null;jsts.geom.Envelope.prototype.maxy=null;jsts.geom.Envelope.prototype.init=function(){if(typeof arguments[0]==='number'&&arguments.length===4){this.initFromValues(arguments[0],arguments[1],arguments[2],arguments[3]);}else if(arguments[0]instanceof jsts.geom.Coordinate&&arguments.length===1){this.initFromCoordinate(arguments[0]);}else if(arguments[0]instanceof jsts.geom.Coordinate&&arguments.length===2){this.initFromCoordinates(arguments[0],arguments[1]);}else if(arguments[0]instanceof jsts.geom.Envelope&&arguments.length===1){this.initFromEnvelope(arguments[0]);}else{this.setToNull();}};jsts.geom.Envelope.prototype.initFromValues=function(x1,x2,y1,y2){if(x1<x2){this.minx=x1;this.maxx=x2;}else{this.minx=x2;this.maxx=x1;}
if(y1<y2){this.miny=y1;this.maxy=y2;}else{this.miny=y2;this.maxy=y1;}};jsts.geom.Envelope.prototype.initFromCoordinates=function(p1,p2){this.initFromValues(p1.x,p2.x,p1.y,p2.y);};jsts.geom.Envelope.prototype.initFromCoordinate=function(p){this.initFromValues(p.x,p.x,p.y,p.y);};jsts.geom.Envelope.prototype.initFromEnvelope=function(env){this.minx=env.minx;this.maxx=env.maxx;this.miny=env.miny;this.maxy=env.maxy;};jsts.geom.Envelope.prototype.setToNull=function(){this.minx=0;this.maxx=-1;this.miny=0;this.maxy=-1;};jsts.geom.Envelope.prototype.isNull=function(){return this.maxx<this.minx;};jsts.geom.Envelope.prototype.getHeight=function(){if(this.isNull()){return 0;}
return this.maxy-this.miny;};jsts.geom.Envelope.prototype.getWidth=function(){if(this.isNull()){return 0;}
return this.maxx-this.minx;};jsts.geom.Envelope.prototype.getMinX=function(){return this.minx;};jsts.geom.Envelope.prototype.getMaxX=function(){return this.maxx;};jsts.geom.Envelope.prototype.getMinY=function(){return this.miny;};jsts.geom.Envelope.prototype.getMaxY=function(){return this.maxy;};jsts.geom.Envelope.prototype.getArea=function(){return this.getWidth()*this.getHeight();};jsts.geom.Envelope.prototype.expandToInclude=function(){if(arguments[0]instanceof jsts.geom.Coordinate){this.expandToIncludeCoordinate(arguments[0]);}else if(arguments[0]instanceof jsts.geom.Envelope){this.expandToIncludeEnvelope(arguments[0]);}else{this.expandToIncludeValues(arguments[0],arguments[1]);}};jsts.geom.Envelope.prototype.expandToIncludeCoordinate=function(p){this.expandToIncludeValues(p.x,p.y);};jsts.geom.Envelope.prototype.expandToIncludeValues=function(x,y){if(this.isNull()){this.minx=x;this.maxx=x;this.miny=y;this.maxy=y;}else{if(x<this.minx){this.minx=x;}
if(x>this.maxx){this.maxx=x;}
if(y<this.miny){this.miny=y;}
if(y>this.maxy){this.maxy=y;}}};jsts.geom.Envelope.prototype.expandToIncludeEnvelope=function(other){if(other.isNull()){return;}
if(this.isNull()){this.minx=other.getMinX();this.maxx=other.getMaxX();this.miny=other.getMinY();this.maxy=other.getMaxY();}else{if(other.minx<this.minx){this.minx=other.minx;}
if(other.maxx>this.maxx){this.maxx=other.maxx;}
if(other.miny<this.miny){this.miny=other.miny;}
if(other.maxy>this.maxy){this.maxy=other.maxy;}}};jsts.geom.Envelope.prototype.expandBy=function(){if(arguments.length===1){this.expandByDistance(arguments[0]);}else{this.expandByDistances(arguments[0],arguments[1]);}};jsts.geom.Envelope.prototype.expandByDistance=function(distance){this.expandByDistances(distance,distance);};jsts.geom.Envelope.prototype.expandByDistances=function(deltaX,deltaY){if(this.isNull()){return;}
this.minx-=deltaX;this.maxx+=deltaX;this.miny-=deltaY;this.maxy+=deltaY;if(this.minx>this.maxx||this.miny>this.maxy){this.setToNull();}};jsts.geom.Envelope.prototype.translate=function(transX,transY){if(this.isNull()){return;}
this.init(this.minx+transX,this.maxx+transX,this.miny+transY,this.maxy+transY);};jsts.geom.Envelope.prototype.centre=function(){if(this.isNull()){return null;}
return new jsts.geom.Coordinate((this.minx+this.maxx)/2.0,(this.miny+this.maxy)/2.0);};jsts.geom.Envelope.prototype.intersection=function(env){if(this.isNull()||env.isNull()||!this.intersects(env)){return new jsts.geom.Envelope();}
var intMinX=this.minx>env.minx?this.minx:env.minx;var intMinY=this.miny>env.miny?this.miny:env.miny;var intMaxX=this.maxx<env.maxx?this.maxx:env.maxx;var intMaxY=this.maxy<env.maxy?this.maxy:env.maxy;return new jsts.geom.Envelope(intMinX,intMaxX,intMinY,intMaxY);};jsts.geom.Envelope.prototype.intersects=function(){if(arguments[0]instanceof jsts.geom.Envelope){return this.intersectsEnvelope(arguments[0]);}else if(arguments[0]instanceof jsts.geom.Coordinate){return this.intersectsCoordinate(arguments[0]);}else{return this.intersectsValues(arguments[0],arguments[1]);}};jsts.geom.Envelope.prototype.intersectsEnvelope=function(other){if(this.isNull()||other.isNull()){return false;}
var result=!(other.minx>this.maxx||other.maxx<this.minx||other.miny>this.maxy||other.maxy<this.miny);return result;};jsts.geom.Envelope.prototype.intersectsCoordinate=function(p){return this.intersectsValues(p.x,p.y);};jsts.geom.Envelope.prototype.intersectsValues=function(x,y){if(this.isNull()){return false;}
return!(x>this.maxx||x<this.minx||y>this.maxy||y<this.miny);};jsts.geom.Envelope.prototype.contains=function(){if(arguments[0]instanceof jsts.geom.Envelope){return this.containsEnvelope(arguments[0]);}else if(arguments[0]instanceof jsts.geom.Coordinate){return this.containsCoordinate(arguments[0]);}else{return this.containsValues(arguments[0],arguments[1]);}};jsts.geom.Envelope.prototype.containsEnvelope=function(other){return this.coversEnvelope(other);};jsts.geom.Envelope.prototype.containsCoordinate=function(p){return this.coversCoordinate(p);};jsts.geom.Envelope.prototype.containsValues=function(x,y){return this.coversValues(x,y);};jsts.geom.Envelope.prototype.covers=function(){if(arguments[0]instanceof jsts.geom.Envelope){return this.coversEnvelope(arguments[0]);}else if(arguments[0]instanceof jsts.geom.Coordinate){return this.coversCoordinate(arguments[0]);}else{return this.coversValues(arguments[0],arguments[1]);}};jsts.geom.Envelope.prototype.coversValues=function(x,y){if(this.isNull()){return false;}
return x>=this.minx&&x<=this.maxx&&y>=this.miny&&y<=this.maxy;};jsts.geom.Envelope.prototype.coversCoordinate=function(p){return this.coversValues(p.x,p.y);};jsts.geom.Envelope.prototype.coversEnvelope=function(other){if(this.isNull()||other.isNull()){return false;}
return other.minx>=this.minx&&other.maxx<=this.maxx&&other.miny>=this.miny&&other.maxy<=this.maxy;};jsts.geom.Envelope.prototype.distance=function(env){if(this.intersects(env)){return 0;}
var dx=0.0;if(this.maxx<env.minx){dx=env.minx-this.maxx;}
if(this.minx>env.maxx){dx=this.minx-env.maxx;}
var dy=0.0;if(this.maxy<env.miny){dy=env.miny-this.maxy;}
if(this.miny>env.maxy){dy=this.miny-env.maxy;}
if(dx===0.0){return dy;}
if(dy===0.0){return dx;}
return Math.sqrt(dx*dx+dy*dy);};jsts.geom.Envelope.prototype.equals=function(other){if(this.isNull()){return other.isNull();}
return this.maxx===other.maxx&&this.maxy===other.maxy&&this.minx===other.minx&&this.miny===other.miny;};jsts.geom.Envelope.prototype.toString=function(){return'Env['+this.minx+' : '+this.maxx+', '+this.miny+' : '+
this.maxy+']';};jsts.geom.Envelope.intersects=function(p1,p2,q){if(arguments.length===4){return jsts.geom.Envelope.intersectsEnvelope(arguments[0],arguments[1],arguments[2],arguments[3]);}
var xc1=p1.x<p2.x?p1.x:p2.x;var xc2=p1.x>p2.x?p1.x:p2.x;var yc1=p1.y<p2.y?p1.y:p2.y;var yc2=p1.y>p2.y?p1.y:p2.y;if(((q.x>=xc1)&&(q.x<=xc2))&&((q.y>=yc1)&&(q.y<=yc2))){return true;}
return false;};jsts.geom.Envelope.intersectsEnvelope=function(p1,p2,q1,q2){var minq=Math.min(q1.x,q2.x);var maxq=Math.max(q1.x,q2.x);var minp=Math.min(p1.x,p2.x);var maxp=Math.max(p1.x,p2.x);if(minp>maxq){return false;}
if(maxp<minq){return false;}
minq=Math.min(q1.y,q2.y);maxq=Math.max(q1.y,q2.y);minp=Math.min(p1.y,p2.y);maxp=Math.max(p1.y,p2.y);if(minp>maxq){return false;}
if(maxp<minq){return false;}
return true;};jsts.geom.Envelope.prototype.clone=function(){return new jsts.geom.Envelope(this.minx,this.maxx,this.miny,this.maxy);};jsts.geom.util.GeometryCombiner=function(geoms){this.geomFactory=jsts.geom.util.GeometryCombiner.extractFactory(geoms);this.inputGeoms=geoms;};jsts.geom.util.GeometryCombiner.combine=function(geoms){if(arguments.length>1)return this.combine2.apply(this,arguments);var combiner=new jsts.geom.util.GeometryCombiner(geoms);return combiner.combine();};jsts.geom.util.GeometryCombiner.combine2=function(){var arrayList=new javascript.util.ArrayList();Array.prototype.slice.call(arguments).forEach(function(a){arrayList.add(a);});var combiner=new jsts.geom.util.GeometryCombiner(arrayList);return combiner.combine();};jsts.geom.util.GeometryCombiner.prototype.geomFactory=null;jsts.geom.util.GeometryCombiner.prototype.skipEmpty=false;jsts.geom.util.GeometryCombiner.prototype.inputGeoms;jsts.geom.util.GeometryCombiner.extractFactory=function(geoms){if(geoms.isEmpty())return null;return geoms.iterator().next().getFactory();};jsts.geom.util.GeometryCombiner.prototype.combine=function(){var elems=new javascript.util.ArrayList(),i;for(i=this.inputGeoms.iterator();i.hasNext();){var g=i.next();this.extractElements(g,elems);}
if(elems.size()===0){if(this.geomFactory!==null){return this.geomFactory.createGeometryCollection(null);}
return null;}
return this.geomFactory.buildGeometry(elems);};jsts.geom.util.GeometryCombiner.prototype.extractElements=function(geom,elems){if(geom===null){return;}
for(var i=0;i<geom.getNumGeometries();i++){var elemGeom=geom.getGeometryN(i);if(this.skipEmpty&&elemGeom.isEmpty()){continue;}
elems.add(elemGeom);}};jsts.geom.PrecisionModel=function(modelType){if(typeof modelType==='number'){this.modelType=jsts.geom.PrecisionModel.FIXED;this.scale=modelType;return;}
this.modelType=modelType||jsts.geom.PrecisionModel.FLOATING;if(this.modelType===jsts.geom.PrecisionModel.FIXED){this.scale=1.0;}};jsts.geom.PrecisionModel.FLOATING='FLOATING';jsts.geom.PrecisionModel.FIXED='FIXED';jsts.geom.PrecisionModel.FLOATING_SINGLE='FLOATING_SINGLE';jsts.geom.PrecisionModel.prototype.scale=null;jsts.geom.PrecisionModel.prototype.modelType=null;jsts.geom.PrecisionModel.prototype.isFloating=function(){return this.modelType===jsts.geom.PrecisionModel.FLOATING||this.modelType===jsts.geom.PrecisionModel.FLOATING_SINLGE;};jsts.geom.PrecisionModel.prototype.getScale=function(){return this.scale;};jsts.geom.PrecisionModel.prototype.getType=function(){return this.modelType;};jsts.geom.PrecisionModel.prototype.equals=function(other){return true;if(!(other instanceof jsts.geom.PrecisionModel)){return false;}
var otherPrecisionModel=other;return this.modelType===otherPrecisionModel.modelType&&this.scale===otherPrecisionModel.scale;};jsts.geom.PrecisionModel.prototype.makePrecise=function(val){if(val instanceof jsts.geom.Coordinate){this.makePrecise2(val);return;}
if(isNaN(val))
return val;if(this.modelType===jsts.geom.PrecisionModel.FIXED){return Math.round(val*this.scale)/this.scale;}
return val;};jsts.geom.PrecisionModel.prototype.makePrecise2=function(coord){if(this.modelType===jsts.geom.PrecisionModel.FLOATING)
return;coord.x=this.makePrecise(coord.x);coord.y=this.makePrecise(coord.y);};jsts.geom.PrecisionModel.prototype.compareTo=function(o){var other=o;return 0;};jsts.geom.CoordinateFilter=function(){};jsts.geom.CoordinateFilter.prototype.filter=function(coord){throw new jsts.error.AbstractMethodInvocationError();};jsts.simplify.DouglasPeuckerLineSimplifier=function(pts){this.pts=pts;this.seg=new jsts.geom.LineSegment();};jsts.simplify.DouglasPeuckerLineSimplifier.prototype.pts=null;jsts.simplify.DouglasPeuckerLineSimplifier.prototype.usePt=null;jsts.simplify.DouglasPeuckerLineSimplifier.prototype.distanceTolerance=null;jsts.simplify.DouglasPeuckerLineSimplifier.simplify=function(pts,distanceTolerance){var simp=new jsts.simplify.DouglasPeuckerLineSimplifier(pts);simp.setDistanceTolerance(distanceTolerance);return simp.simplify();};jsts.simplify.DouglasPeuckerLineSimplifier.prototype.setDistanceTolerance=function(distanceTolerance){this.distanceTolerance=distanceTolerance;};jsts.simplify.DouglasPeuckerLineSimplifier.prototype.simplify=function(){this.usePt=[];for(var i=0;i<this.pts.length;i++){this.usePt[i]=true;}
this.simplifySection(0,this.pts.length-1);var coordList=new jsts.geom.CoordinateList();for(var j=0;j<this.pts.length;j++){if(this.usePt[j]){coordList.add(new jsts.geom.Coordinate(this.pts[j]));}}
return coordList.toCoordinateArray();};jsts.simplify.DouglasPeuckerLineSimplifier.prototype.seg=null;jsts.simplify.DouglasPeuckerLineSimplifier.prototype.simplifySection=function(i,j){if(i+1==j){return;}
this.seg.p0=this.pts[i];this.seg.p1=this.pts[j];var maxDistance=-1.0;var maxIndex=i;for(var k=i+1;k<j;k++){var distance=this.seg.distance(this.pts[k]);if(distance>maxDistance){maxDistance=distance;maxIndex=k;}}
if(maxDistance<=this.distanceTolerance){for(var l=i+1;l<j;l++){this.usePt[l]=false;}}else{this.simplifySection(i,maxIndex);this.simplifySection(maxIndex,j);}};jsts.geomgraph.EdgeIntersection=function(coord,segmentIndex,dist){this.coord=new jsts.geom.Coordinate(coord);this.segmentIndex=segmentIndex;this.dist=dist;};jsts.geomgraph.EdgeIntersection.prototype.coord=null;jsts.geomgraph.EdgeIntersection.prototype.segmentIndex=null;jsts.geomgraph.EdgeIntersection.prototype.dist=null;jsts.geomgraph.EdgeIntersection.prototype.getCoordinate=function(){return this.coord;};jsts.geomgraph.EdgeIntersection.prototype.getSegmentIndex=function(){return this.segmentIndex;};jsts.geomgraph.EdgeIntersection.prototype.getDistance=function(){return this.dist;};jsts.geomgraph.EdgeIntersection.prototype.compareTo=function(other){return this.compare(other.segmentIndex,other.dist);};jsts.geomgraph.EdgeIntersection.prototype.compare=function(segmentIndex,dist){if(this.segmentIndex<segmentIndex)
return-1;if(this.segmentIndex>segmentIndex)
return 1;if(this.dist<dist)
return-1;if(this.dist>dist)
return 1;return 0;};jsts.geomgraph.EdgeIntersection.prototype.isEndPoint=function(maxSegmentIndex){if(this.segmentIndex===0&&this.dist===0.0)
return true;if(this.segmentIndex===maxSegmentIndex)
return true;return false;};jsts.geomgraph.EdgeIntersection.prototype.toString=function(){return''+this.segmentIndex+this.dist;};(function(){var EdgeIntersection=jsts.geomgraph.EdgeIntersection;var TreeMap=javascript.util.TreeMap;jsts.geomgraph.EdgeIntersectionList=function(edge){this.nodeMap=new TreeMap();this.edge=edge;};jsts.geomgraph.EdgeIntersectionList.prototype.nodeMap=null;jsts.geomgraph.EdgeIntersectionList.prototype.edge=null;jsts.geomgraph.EdgeIntersectionList.prototype.isIntersection=function(pt){for(var it=this.iterator();it.hasNext();){var ei=it.next();if(ei.coord.equals(pt)){return true;}}
return false;};jsts.geomgraph.EdgeIntersectionList.prototype.add=function(intPt,segmentIndex,dist){var eiNew=new EdgeIntersection(intPt,segmentIndex,dist);var ei=this.nodeMap.get(eiNew);if(ei!==null){return ei;}
this.nodeMap.put(eiNew,eiNew);return eiNew;};jsts.geomgraph.EdgeIntersectionList.prototype.iterator=function(){return this.nodeMap.values().iterator();};jsts.geomgraph.EdgeIntersectionList.prototype.addEndpoints=function(){var maxSegIndex=this.edge.pts.length-1;this.add(this.edge.pts[0],0,0.0);this.add(this.edge.pts[maxSegIndex],maxSegIndex,0.0);};jsts.geomgraph.EdgeIntersectionList.prototype.addSplitEdges=function(edgeList)
{this.addEndpoints();var it=this.iterator();var eiPrev=it.next();while(it.hasNext()){var ei=it.next();var newEdge=this.createSplitEdge(eiPrev,ei);edgeList.add(newEdge);eiPrev=ei;}};jsts.geomgraph.EdgeIntersectionList.prototype.createSplitEdge=function(ei0,ei1){var npts=ei1.segmentIndex-ei0.segmentIndex+2;var lastSegStartPt=this.edge.pts[ei1.segmentIndex];var useIntPt1=ei1.dist>0.0||!ei1.coord.equals2D(lastSegStartPt);if(!useIntPt1){npts--;}
var pts=[];var ipt=0;pts[ipt++]=new jsts.geom.Coordinate(ei0.coord);for(var i=ei0.segmentIndex+1;i<=ei1.segmentIndex;i++){pts[ipt++]=this.edge.pts[i];}
if(useIntPt1)pts[ipt]=ei1.coord;return new jsts.geomgraph.Edge(pts,new jsts.geomgraph.Label(this.edge.label));};})();(function(){var AssertionFailedException=function(message){this.message=message;};AssertionFailedException.prototype=new Error();AssertionFailedException.prototype.name='AssertionFailedException';jsts.util.AssertionFailedException=AssertionFailedException;})();(function(){var AssertionFailedException=jsts.util.AssertionFailedException;jsts.util.Assert=function(){};jsts.util.Assert.isTrue=function(assertion,message){if(!assertion){if(message===null){throw new AssertionFailedException();}else{throw new AssertionFailedException(message);}}};jsts.util.Assert.equals=function(expectedValue,actualValue,message){if(!actualValue.equals(expectedValue)){throw new AssertionFailedException('Expected '+expectedValue+' but encountered '+actualValue+
(message!=null?': '+message:''));}};jsts.util.Assert.shouldNeverReachHere=function(message){throw new AssertionFailedException('Should never reach here'+
(message!=null?': '+message:''));};})();(function(){var Location=jsts.geom.Location;var Assert=jsts.util.Assert;var ArrayList=javascript.util.ArrayList;jsts.operation.relate.RelateComputer=function(arg){this.li=new jsts.algorithm.RobustLineIntersector();this.ptLocator=new jsts.algorithm.PointLocator();this.nodes=new jsts.geomgraph.NodeMap(new jsts.operation.relate.RelateNodeFactory());this.isolatedEdges=new ArrayList();this.arg=arg;};jsts.operation.relate.RelateComputer.prototype.li=null;jsts.operation.relate.RelateComputer.prototype.ptLocator=null;jsts.operation.relate.RelateComputer.prototype.arg=null;jsts.operation.relate.RelateComputer.prototype.nodes=null;jsts.operation.relate.RelateComputer.prototype.im=null;jsts.operation.relate.RelateComputer.prototype.isolatedEdges=null;jsts.operation.relate.RelateComputer.prototype.invalidPoint=null;jsts.operation.relate.RelateComputer.prototype.computeIM=function(){var im=new jsts.geom.IntersectionMatrix();im.set(Location.EXTERIOR,Location.EXTERIOR,2);if(!this.arg[0].getGeometry().getEnvelopeInternal().intersects(this.arg[1].getGeometry().getEnvelopeInternal())){this.computeDisjointIM(im);return im;}
this.arg[0].computeSelfNodes(this.li,false);this.arg[1].computeSelfNodes(this.li,false);var intersector=this.arg[0].computeEdgeIntersections(this.arg[1],this.li,false);this.computeIntersectionNodes(0);this.computeIntersectionNodes(1);this.copyNodesAndLabels(0);this.copyNodesAndLabels(1);this.labelIsolatedNodes();this.computeProperIntersectionIM(intersector,im);var eeBuilder=new jsts.operation.relate.EdgeEndBuilder();var ee0=eeBuilder.computeEdgeEnds(this.arg[0].getEdgeIterator());this.insertEdgeEnds(ee0);var ee1=eeBuilder.computeEdgeEnds(this.arg[1].getEdgeIterator());this.insertEdgeEnds(ee1);this.labelNodeEdges();this.labelIsolatedEdges(0,1);this.labelIsolatedEdges(1,0);this.updateIM(im);return im;};jsts.operation.relate.RelateComputer.prototype.insertEdgeEnds=function(ee){for(var i=ee.iterator();i.hasNext();){var e=i.next();this.nodes.add(e);}};jsts.operation.relate.RelateComputer.prototype.computeProperIntersectionIM=function(intersector,im){var dimA=this.arg[0].getGeometry().getDimension();var dimB=this.arg[1].getGeometry().getDimension();var hasProper=intersector.hasProperIntersection();var hasProperInterior=intersector.hasProperInteriorIntersection();if(dimA===2&&dimB===2){if(hasProper)
im.setAtLeast('212101212');}
else if(dimA===2&&dimB===1){if(hasProper)
im.setAtLeast('FFF0FFFF2');if(hasProperInterior)
im.setAtLeast('1FFFFF1FF');}else if(dimA===1&&dimB===2){if(hasProper)
im.setAtLeast('F0FFFFFF2');if(hasProperInterior)
im.setAtLeast('1F1FFFFFF');}
else if(dimA===1&&dimB===1){if(hasProperInterior)
im.setAtLeast('0FFFFFFFF');}};jsts.operation.relate.RelateComputer.prototype.copyNodesAndLabels=function(argIndex){for(var i=this.arg[argIndex].getNodeIterator();i.hasNext();){var graphNode=i.next();var newNode=this.nodes.addNode(graphNode.getCoordinate());newNode.setLabel(argIndex,graphNode.getLabel().getLocation(argIndex));}};jsts.operation.relate.RelateComputer.prototype.computeIntersectionNodes=function(argIndex){for(var i=this.arg[argIndex].getEdgeIterator();i.hasNext();){var e=i.next();var eLoc=e.getLabel().getLocation(argIndex);for(var eiIt=e.getEdgeIntersectionList().iterator();eiIt.hasNext();){var ei=eiIt.next();var n=this.nodes.addNode(ei.coord);if(eLoc===Location.BOUNDARY)
n.setLabelBoundary(argIndex);else{if(n.getLabel().isNull(argIndex))
n.setLabel(argIndex,Location.INTERIOR);}}}};jsts.operation.relate.RelateComputer.prototype.labelIntersectionNodes=function(argIndex){for(var i=this.arg[argIndex].getEdgeIterator();i.hasNext();){var e=i.next();var eLoc=e.getLabel().getLocation(argIndex);for(var eiIt=e.getEdgeIntersectionList().iterator();eiIt.hasNext();){var ei=eiIt.next();var n=this.nodes.find(ei.coord);if(n.getLabel().isNull(argIndex)){if(eLoc===Location.BOUNDARY)
n.setLabelBoundary(argIndex);else
n.setLabel(argIndex,Location.INTERIOR);}}}};jsts.operation.relate.RelateComputer.prototype.computeDisjointIM=function(im){var ga=this.arg[0].getGeometry();if(!ga.isEmpty()){im.set(Location.INTERIOR,Location.EXTERIOR,ga.getDimension());im.set(Location.BOUNDARY,Location.EXTERIOR,ga.getBoundaryDimension());}
var gb=this.arg[1].getGeometry();if(!gb.isEmpty()){im.set(Location.EXTERIOR,Location.INTERIOR,gb.getDimension());im.set(Location.EXTERIOR,Location.BOUNDARY,gb.getBoundaryDimension());}};jsts.operation.relate.RelateComputer.prototype.labelNodeEdges=function(){for(var ni=this.nodes.iterator();ni.hasNext();){var node=ni.next();node.getEdges().computeLabelling(this.arg);}};jsts.operation.relate.RelateComputer.prototype.updateIM=function(im){for(var ei=this.isolatedEdges.iterator();ei.hasNext();){var e=ei.next();e.updateIM(im);}
for(var ni=this.nodes.iterator();ni.hasNext();){var node=ni.next();node.updateIM(im);node.updateIMFromEdges(im);}};jsts.operation.relate.RelateComputer.prototype.labelIsolatedEdges=function(thisIndex,targetIndex){for(var ei=this.arg[thisIndex].getEdgeIterator();ei.hasNext();){var e=ei.next();if(e.isIsolated()){this.labelIsolatedEdge(e,targetIndex,this.arg[targetIndex].getGeometry());this.isolatedEdges.add(e);}}};jsts.operation.relate.RelateComputer.prototype.labelIsolatedEdge=function(e,targetIndex,target){if(target.getDimension()>0){var loc=this.ptLocator.locate(e.getCoordinate(),target);e.getLabel().setAllLocations(targetIndex,loc);}else{e.getLabel().setAllLocations(targetIndex,Location.EXTERIOR);}};jsts.operation.relate.RelateComputer.prototype.labelIsolatedNodes=function(){for(var ni=this.nodes.iterator();ni.hasNext();){var n=ni.next();var label=n.getLabel();Assert.isTrue(label.getGeometryCount()>0,'node with empty label found');if(n.isIsolated()){if(label.isNull(0))
this.labelIsolatedNode(n,0);else
this.labelIsolatedNode(n,1);}}};jsts.operation.relate.RelateComputer.prototype.labelIsolatedNode=function(n,targetIndex){var loc=this.ptLocator.locate(n.getCoordinate(),this.arg[targetIndex].getGeometry());n.getLabel().setAllLocations(targetIndex,loc);};})();(function(){var Assert=jsts.util.Assert;jsts.geomgraph.GraphComponent=function(label){this.label=label;};jsts.geomgraph.GraphComponent.prototype.label=null;jsts.geomgraph.GraphComponent.prototype._isInResult=false;jsts.geomgraph.GraphComponent.prototype._isCovered=false;jsts.geomgraph.GraphComponent.prototype._isCoveredSet=false;jsts.geomgraph.GraphComponent.prototype._isVisited=false;jsts.geomgraph.GraphComponent.prototype.getLabel=function(){return this.label;};jsts.geomgraph.GraphComponent.prototype.setLabel=function(label){if(arguments.length===2){this.setLabel2.apply(this,arguments);return;}
this.label=label;};jsts.geomgraph.GraphComponent.prototype.setInResult=function(isInResult){this._isInResult=isInResult;};jsts.geomgraph.GraphComponent.prototype.isInResult=function(){return this._isInResult;};jsts.geomgraph.GraphComponent.prototype.setCovered=function(isCovered){this._isCovered=isCovered;this._isCoveredSet=true;};jsts.geomgraph.GraphComponent.prototype.isCovered=function(){return this._isCovered;};jsts.geomgraph.GraphComponent.prototype.isCoveredSet=function(){return this._isCoveredSet;};jsts.geomgraph.GraphComponent.prototype.isVisited=function(){return this._isVisited;};jsts.geomgraph.GraphComponent.prototype.setVisited=function(isVisited){this._isVisited=isVisited;};jsts.geomgraph.GraphComponent.prototype.getCoordinate=function(){throw new jsts.error.AbstractMethodInvocationError();};jsts.geomgraph.GraphComponent.prototype.computeIM=function(im){throw new jsts.error.AbstractMethodInvocationError();};jsts.geomgraph.GraphComponent.prototype.isIsolated=function(){throw new jsts.error.AbstractMethodInvocationError();};jsts.geomgraph.GraphComponent.prototype.updateIM=function(im){Assert.isTrue(this.label.getGeometryCount()>=2,'found partial label');this.computeIM(im);};})();jsts.geomgraph.Node=function(coord,edges){this.coord=coord;this.edges=edges;this.label=new jsts.geomgraph.Label(0,jsts.geom.Location.NONE);};jsts.geomgraph.Node.prototype=new jsts.geomgraph.GraphComponent();jsts.geomgraph.Node.prototype.coord=null;jsts.geomgraph.Node.prototype.edges=null;jsts.geomgraph.Node.prototype.isIsolated=function(){return(this.label.getGeometryCount()==1);};jsts.geomgraph.Node.prototype.setLabel2=function(argIndex,onLocation){if(this.label===null){this.label=new jsts.geomgraph.Label(argIndex,onLocation);}else
this.label.setLocation(argIndex,onLocation);};jsts.geomgraph.Node.prototype.setLabelBoundary=function(argIndex){var loc=jsts.geom.Location.NONE;if(this.label!==null)
loc=this.label.getLocation(argIndex);var newLoc;switch(loc){case jsts.geom.Location.BOUNDARY:newLoc=jsts.geom.Location.INTERIOR;break;case jsts.geom.Location.INTERIOR:newLoc=jsts.geom.Location.BOUNDARY;break;default:newLoc=jsts.geom.Location.BOUNDARY;break;}
this.label.setLocation(argIndex,newLoc);};jsts.geomgraph.Node.prototype.add=function(e){this.edges.insert(e);e.setNode(this);};jsts.geomgraph.Node.prototype.getCoordinate=function(){return this.coord;};jsts.geomgraph.Node.prototype.getEdges=function(){return this.edges;};jsts.geomgraph.Node.prototype.isIncidentEdgeInResult=function(){for(var it=this.getEdges().getEdges().iterator();it.hasNext();){var de=it.next();if(de.getEdge().isInResult())
return true;}
return false;};jsts.geom.Point=function(coordinate,factory){this.factory=factory;if(coordinate===undefined)
return;this.coordinate=coordinate;};jsts.geom.Point.prototype=new jsts.geom.Geometry();jsts.geom.Point.constructor=jsts.geom.Point;jsts.geom.Point.CLASS_NAME='jsts.geom.Point';jsts.geom.Point.prototype.coordinate=null;jsts.geom.Point.prototype.getX=function(){return this.coordinate.x;};jsts.geom.Point.prototype.getY=function(){return this.coordinate.y;};jsts.geom.Point.prototype.getCoordinate=function(){return this.coordinate;};jsts.geom.Point.prototype.getCoordinates=function(){return this.isEmpty()?[]:[this.coordinate];};jsts.geom.Point.prototype.getCoordinateSequence=function(){return this.isEmpty()?[]:[this.coordinate];};jsts.geom.Point.prototype.isEmpty=function(){return this.coordinate===null;};jsts.geom.Point.prototype.equalsExact=function(other,tolerance){if(!this.isEquivalentClass(other)){return false;}
if(this.isEmpty()&&other.isEmpty()){return true;}
return this.equal(other.getCoordinate(),this.getCoordinate(),tolerance);};jsts.geom.Point.prototype.getNumPoints=function(){return this.isEmpty()?0:1;};jsts.geom.Point.prototype.isSimple=function(){return true;};jsts.geom.Point.prototype.getBoundary=function(){return new jsts.geom.GeometryCollection(null);};jsts.geom.Point.prototype.computeEnvelopeInternal=function(){if(this.isEmpty()){return new jsts.geom.Envelope();}
return new jsts.geom.Envelope(this.coordinate);};jsts.geom.Point.prototype.apply=function(filter){if(filter instanceof jsts.geom.GeometryFilter||filter instanceof jsts.geom.GeometryComponentFilter){filter.filter(this);}else if(filter instanceof jsts.geom.CoordinateFilter){if(this.isEmpty()){return;}
filter.filter(this.getCoordinate());}};jsts.geom.Point.prototype.clone=function(){return new jsts.geom.Point(this.coordinate.clone(),this.factory);};jsts.geom.Point.prototype.getDimension=function(){return 0;};jsts.geom.Point.prototype.getBoundaryDimension=function(){return jsts.geom.Dimension.FALSE;};jsts.geom.Point.prototype.reverse=function(){return this.clone();};jsts.geom.Point.prototype.isValid=function(){if(!jsts.operation.valid.IsValidOp.isValid(this.getCoordinate())){return false;}
return true;};jsts.geom.Point.prototype.normalize=function(){};jsts.geom.Point.prototype.compareToSameClass=function(other){var point=other;return this.getCoordinate().compareTo(point.getCoordinate());};jsts.geom.Point.prototype.getGeometryType=function(){return'Point';};jsts.geom.Point.prototype.hashCode=function(){return'Point_'+this.coordinate.hashCode();};jsts.geom.Point.prototype.CLASS_NAME='jsts.geom.Point';jsts.geom.Dimension=function(){};jsts.geom.Dimension.P=0;jsts.geom.Dimension.L=1;jsts.geom.Dimension.A=2;jsts.geom.Dimension.FALSE=-1;jsts.geom.Dimension.TRUE=-2;jsts.geom.Dimension.DONTCARE=-3;jsts.geom.Dimension.toDimensionSymbol=function(dimensionValue){switch(dimensionValue){case jsts.geom.Dimension.FALSE:return'F';case jsts.geom.Dimension.TRUE:return'T';case jsts.geom.Dimension.DONTCARE:return'*';case jsts.geom.Dimension.P:return'0';case jsts.geom.Dimension.L:return'1';case jsts.geom.Dimension.A:return'2';}
throw new jsts.IllegalArgumentError('Unknown dimension value: '+
dimensionValue);};jsts.geom.Dimension.toDimensionValue=function(dimensionSymbol){switch(dimensionSymbol.toUpperCase()){case'F':return jsts.geom.Dimension.FALSE;case'T':return jsts.geom.Dimension.TRUE;case'*':return jsts.geom.Dimension.DONTCARE;case'0':return jsts.geom.Dimension.P;case'1':return jsts.geom.Dimension.L;case'2':return jsts.geom.Dimension.A;}
throw new jsts.error.IllegalArgumentError('Unknown dimension symbol: '+
dimensionSymbol);};(function(){var Dimension=jsts.geom.Dimension;jsts.geom.LineString=function(points,factory){this.factory=factory;this.points=points||[];};jsts.geom.LineString.prototype=new jsts.geom.Geometry();jsts.geom.LineString.constructor=jsts.geom.LineString;jsts.geom.LineString.prototype.points=null;jsts.geom.LineString.prototype.getCoordinates=function(){return this.points;};jsts.geom.LineString.prototype.getCoordinateSequence=function(){return this.points;};jsts.geom.LineString.prototype.getCoordinateN=function(n){return this.points[n];};jsts.geom.LineString.prototype.getCoordinate=function(){if(this.isEmpty()){return null;}
return this.getCoordinateN(0);};jsts.geom.LineString.prototype.getDimension=function(){return 1;};jsts.geom.LineString.prototype.getBoundaryDimension=function(){if(this.isClosed()){return Dimension.FALSE;}
return 0;};jsts.geom.LineString.prototype.isEmpty=function(){return this.points.length===0;};jsts.geom.LineString.prototype.getNumPoints=function(){return this.points.length;};jsts.geom.LineString.prototype.getPointN=function(n){return this.getFactory().createPoint(this.points[n]);};jsts.geom.LineString.prototype.getStartPoint=function(){if(this.isEmpty()){return null;}
return this.getPointN(0);};jsts.geom.LineString.prototype.getEndPoint=function(){if(this.isEmpty()){return null;}
return this.getPointN(this.getNumPoints()-1);};jsts.geom.LineString.prototype.isClosed=function(){if(this.isEmpty()){return false;}
return this.getCoordinateN(0).equals2D(this.getCoordinateN(this.points.length-1));};jsts.geom.LineString.prototype.isRing=function(){return this.isClosed()&&this.isSimple();};jsts.geom.LineString.prototype.getGeometryType=function(){return'LineString';};jsts.geom.LineString.prototype.getLength=function(){return jsts.algorithm.CGAlgorithms.computeLength(this.points);};jsts.geom.LineString.prototype.getBoundary=function(){return(new jsts.operation.BoundaryOp(this)).getBoundary();};jsts.geom.LineString.prototype.computeEnvelopeInternal=function(){if(this.isEmpty()){return new jsts.geom.Envelope();}
var env=new jsts.geom.Envelope();this.points.forEach(function(component){env.expandToInclude(component);});return env;};jsts.geom.LineString.prototype.equalsExact=function(other,tolerance){if(!this.isEquivalentClass(other)){return false;}
if(this.points.length!==other.points.length){return false;}
if(this.isEmpty()&&other.isEmpty()){return true;}
return this.points.reduce(function(equal,point,i){return equal&&jsts.geom.Geometry.prototype.equal(point,other.points[i],tolerance);});};jsts.geom.LineString.prototype.isEquivalentClass=function(other){return other instanceof jsts.geom.LineString;};jsts.geom.LineString.prototype.compareToSameClass=function(o){var line=o;var i=0,il=this.points.length;var j=0,jl=line.points.length;while(i<il&&j<jl){var comparison=this.points[i].compareTo(line.points[j]);if(comparison!==0){return comparison;}
i++;j++;}
if(i<il){return 1;}
if(j<jl){return-1;}
return 0;};jsts.geom.LineString.prototype.apply=function(filter){if(filter instanceof jsts.geom.GeometryFilter||filter instanceof jsts.geom.GeometryComponentFilter){filter.filter(this);}else if(filter instanceof jsts.geom.CoordinateFilter){for(var i=0,len=this.points.length;i<len;i++){filter.filter(this.points[i]);}}else if(filter instanceof jsts.geom.CoordinateSequenceFilter){this.apply2.apply(this,arguments);}};jsts.geom.LineString.prototype.apply2=function(filter){if(this.points.length===0)
return;for(var i=0;i<this.points.length;i++){filter.filter(this.points,i);if(filter.isDone())
break;}
if(filter.isGeometryChanged()){}};jsts.geom.LineString.prototype.clone=function(){var points=[];for(var i=0,len=this.points.length;i<len;i++){points.push(this.points[i].clone());}
return this.factory.createLineString(points);};jsts.geom.LineString.prototype.normalize=function(){var i,il,j,ci,cj,len;len=this.points.length;il=parseInt(len/2);for(i=0;i<il;i++){j=len-1-i;ci=this.points[i];cj=this.points[j];if(!ci.equals(cj)){if(ci.compareTo(cj)>0){this.points.reverse();}
return;}}};jsts.geom.LineString.prototype.CLASS_NAME='jsts.geom.LineString';})();(function(){jsts.geom.Polygon=function(shell,holes,factory){this.shell=shell||factory.createLinearRing(null);this.holes=holes||[];this.factory=factory;};jsts.geom.Polygon.prototype=new jsts.geom.Geometry();jsts.geom.Polygon.constructor=jsts.geom.Polygon;jsts.geom.Polygon.prototype.getCoordinate=function(){return this.shell.getCoordinate();};jsts.geom.Polygon.prototype.getCoordinates=function(){if(this.isEmpty()){return[];}
var coordinates=[];var k=-1;var shellCoordinates=this.shell.getCoordinates();for(var x=0;x<shellCoordinates.length;x++){k++;coordinates[k]=shellCoordinates[x];}
for(var i=0;i<this.holes.length;i++){var childCoordinates=this.holes[i].getCoordinates();for(var j=0;j<childCoordinates.length;j++){k++;coordinates[k]=childCoordinates[j];}}
return coordinates;};jsts.geom.Polygon.prototype.getNumPoints=function(){var numPoints=this.shell.getNumPoints();for(var i=0;i<this.holes.length;i++){numPoints+=this.holes[i].getNumPoints();}
return numPoints;};jsts.geom.Polygon.prototype.isEmpty=function(){return this.shell.isEmpty();};jsts.geom.Polygon.prototype.isRectangle=function(){if(this.getNumInteriorRing()!=0)return false;if(this.shell==null)return false;if(this.shell.getNumPoints()!=5)return false;var seq=this.shell.getCoordinateSequence();var env=this.getEnvelopeInternal();for(var i=0;i<5;i++){var x=seq[i].x;if(!(x==env.getMinX()||x==env.getMaxX()))return false;var y=seq[i].y;if(!(y==env.getMinY()||y==env.getMaxY()))return false;}
var prevX=seq[0].x;var prevY=seq[0].y;for(var i=1;i<=4;i++){var x=seq[i].x;var y=seq[i].y;var xChanged=x!=prevX;var yChanged=y!=prevY;if(xChanged==yChanged)
return false;prevX=x;prevY=y;}
return true;};jsts.geom.Polygon.prototype.getExteriorRing=function(){return this.shell;};jsts.geom.Polygon.prototype.getInteriorRingN=function(n){return this.holes[n];};jsts.geom.Polygon.prototype.getNumInteriorRing=function(){return this.holes.length;};jsts.geom.Polygon.prototype.getArea=function(){var area=0.0;area+=Math.abs(jsts.algorithm.CGAlgorithms.signedArea(this.shell.getCoordinateSequence()));for(var i=0;i<this.holes.length;i++){area-=Math.abs(jsts.algorithm.CGAlgorithms.signedArea(this.holes[i].getCoordinateSequence()));}
return area;};jsts.geom.Polygon.prototype.getLength=function(){var len=0.0;len+=this.shell.getLength();for(var i=0;i<this.holes.length;i++){len+=this.holes[i].getLength();}
return len;};jsts.geom.Polygon.prototype.getBoundary=function(){if(this.isEmpty()){return this.getFactory().createMultiLineString(null);}
var rings=[];rings[0]=this.shell.clone();for(var i=0,len=this.holes.length;i<len;i++){rings[i+1]=this.holes[i].clone();}
if(rings.length<=1)
return rings[0];return this.getFactory().createMultiLineString(rings);};jsts.geom.Polygon.prototype.computeEnvelopeInternal=function(){return this.shell.getEnvelopeInternal();};jsts.geom.Polygon.prototype.getDimension=function(){return 2;};jsts.geom.Polygon.prototype.getBoundaryDimension=function(){return 1;};jsts.geom.Polygon.prototype.equalsExact=function(other,tolerance){if(!this.isEquivalentClass(other)){return false;}
if(this.isEmpty()&&other.isEmpty()){return true;}
if(this.isEmpty()!==other.isEmpty()){return false;}
if(!this.shell.equalsExact(other.shell,tolerance)){return false;}
if(this.holes.length!==other.holes.length){return false;}
if(this.holes.length!==other.holes.length){return false;}
for(var i=0;i<this.holes.length;i++){if(!(this.holes[i]).equalsExact(other.holes[i],tolerance)){return false;}}
return true;};jsts.geom.Polygon.prototype.compareToSameClass=function(o){return this.shell.compareToSameClass(o.shell);};jsts.geom.Polygon.prototype.apply=function(filter){if(filter instanceof jsts.geom.GeometryComponentFilter){filter.filter(this);this.shell.apply(filter);for(var i=0,len=this.holes.length;i<len;i++){this.holes[i].apply(filter);}}else if(filter instanceof jsts.geom.GeometryFilter){filter.filter(this);}else if(filter instanceof jsts.geom.CoordinateFilter){this.shell.apply(filter);for(var i=0,len=this.holes.length;i<len;i++){this.holes[i].apply(filter);}}else if(filter instanceof jsts.geom.CoordinateSequenceFilter){this.apply2.apply(this,arguments);}};jsts.geom.Polygon.prototype.apply2=function(filter){this.shell.apply(filter);if(!filter.isDone()){for(var i=0;i<this.holes.length;i++){this.holes[i].apply(filter);if(filter.isDone())
break;}}
if(filter.isGeometryChanged()){}};jsts.geom.Polygon.prototype.clone=function(){var holes=[];for(var i=0,len=this.holes.length;i<len;i++){holes.push(this.holes[i].clone());}
return this.factory.createPolygon(this.shell.clone(),holes);};jsts.geom.Polygon.prototype.normalize=function(){this.normalize2(this.shell,true);for(var i=0,len=this.holes.length;i<len;i++){this.normalize2(this.holes[i],false);}
this.holes.sort();};jsts.geom.Polygon.prototype.normalize2=function(ring,clockwise){if(ring.isEmpty()){return;}
var uniqueCoordinates=ring.points.slice(0,ring.points.length-1);var minCoordinate=jsts.geom.CoordinateArrays.minCoordinate(ring.points);jsts.geom.CoordinateArrays.scroll(uniqueCoordinates,minCoordinate);ring.points=uniqueCoordinates.concat();ring.points[uniqueCoordinates.length]=uniqueCoordinates[0];if(jsts.algorithm.CGAlgorithms.isCCW(ring.points)===clockwise){ring.points.reverse();}};jsts.geom.Polygon.prototype.getGeometryType=function(){return'Polygon';};jsts.geom.Polygon.prototype.CLASS_NAME='jsts.geom.Polygon';})();(function(){var Geometry=jsts.geom.Geometry;var TreeSet=javascript.util.TreeSet;var Arrays=javascript.util.Arrays;jsts.geom.GeometryCollection=function(geometries,factory){this.geometries=geometries||[];this.factory=factory;};jsts.geom.GeometryCollection.prototype=new Geometry();jsts.geom.GeometryCollection.constructor=jsts.geom.GeometryCollection;jsts.geom.GeometryCollection.prototype.isEmpty=function(){for(var i=0,len=this.geometries.length;i<len;i++){var geometry=this.getGeometryN(i);if(!geometry.isEmpty()){return false;}}
return true;};jsts.geom.GeometryCollection.prototype.getArea=function(){var area=0.0;for(var i=0,len=this.geometries.length;i<len;i++){area+=this.getGeometryN(i).getArea();}
return area;};jsts.geom.GeometryCollection.prototype.getLength=function(){var length=0.0;for(var i=0,len=this.geometries.length;i<len;i++){length+=this.getGeometryN(i).getLength();}
return length;};jsts.geom.GeometryCollection.prototype.getCoordinate=function(){if(this.isEmpty())
return null;return this.getGeometryN(0).getCoordinate();};jsts.geom.GeometryCollection.prototype.getCoordinates=function(){var coordinates=[];var k=-1;for(var i=0,len=this.geometries.length;i<len;i++){var geometry=this.getGeometryN(i);var childCoordinates=geometry.getCoordinates();for(var j=0;j<childCoordinates.length;j++){k++;coordinates[k]=childCoordinates[j];}}
return coordinates;};jsts.geom.GeometryCollection.prototype.getNumGeometries=function(){return this.geometries.length;};jsts.geom.GeometryCollection.prototype.getGeometryN=function(n){var geometry=this.geometries[n];if(geometry instanceof jsts.geom.Coordinate){geometry=new jsts.geom.Point(geometry);}
return geometry;};jsts.geom.GeometryCollection.prototype.getNumPoints=function(n){var numPoints=0;for(var i=0;i<this.geometries.length;i++){numPoints+=this.geometries[i].getNumPoints();}
return numPoints;}
jsts.geom.GeometryCollection.prototype.equalsExact=function(other,tolerance){if(!this.isEquivalentClass(other)){return false;}
if(this.geometries.length!==other.geometries.length){return false;}
for(var i=0,len=this.geometries.length;i<len;i++){var geometry=this.getGeometryN(i);if(!geometry.equalsExact(other.getGeometryN(i),tolerance)){return false;}}
return true;};jsts.geom.GeometryCollection.prototype.clone=function(){var geometries=[];for(var i=0,len=this.geometries.length;i<len;i++){geometries.push(this.geometries[i].clone());}
return this.factory.createGeometryCollection(geometries);};jsts.geom.GeometryCollection.prototype.normalize=function(){for(var i=0,len=this.geometries.length;i<len;i++){this.getGeometryN(i).normalize();}
this.geometries.sort();};jsts.geom.GeometryCollection.prototype.compareToSameClass=function(o){var theseElements=new TreeSet(Arrays.asList(this.geometries));var otherElements=new TreeSet(Arrays.asList(o.geometries));return this.compare(theseElements,otherElements);};jsts.geom.GeometryCollection.prototype.apply=function(filter){if(filter instanceof jsts.geom.GeometryFilter||filter instanceof jsts.geom.GeometryComponentFilter){filter.filter(this);for(var i=0,len=this.geometries.length;i<len;i++){this.getGeometryN(i).apply(filter);}}else if(filter instanceof jsts.geom.CoordinateFilter){for(var i=0,len=this.geometries.length;i<len;i++){this.getGeometryN(i).apply(filter);}}else if(filter instanceof jsts.geom.CoordinateSequenceFilter){this.apply2.apply(this,arguments);}};jsts.geom.GeometryCollection.prototype.apply2=function(filter){if(this.geometries.length==0)
return;for(var i=0;i<this.geometries.length;i++){this.geometries[i].apply(filter);if(filter.isDone()){break;}}
if(filter.isGeometryChanged()){}};jsts.geom.GeometryCollection.prototype.getDimension=function(){var dimension=jsts.geom.Dimension.FALSE;for(var i=0,len=this.geometries.length;i<len;i++){var geometry=this.getGeometryN(i);dimension=Math.max(dimension,geometry.getDimension());}
return dimension;};jsts.geom.GeometryCollection.prototype.computeEnvelopeInternal=function(){var envelope=new jsts.geom.Envelope();for(var i=0,len=this.geometries.length;i<len;i++){var geometry=this.getGeometryN(i);envelope.expandToInclude(geometry.getEnvelopeInternal());}
return envelope;};jsts.geom.GeometryCollection.prototype.CLASS_NAME='jsts.geom.GeometryCollection';})();jsts.algorithm.Centroid=function(geometry){this.areaBasePt=null;this.triangleCent3=new jsts.geom.Coordinate();this.areasum2=0;this.cg3=new jsts.geom.Coordinate();this.lineCentSum=new jsts.geom.Coordinate();this.totalLength=0;this.ptCount=0;this.ptCentSum=new jsts.geom.Coordinate();this.add(geometry);};jsts.algorithm.Centroid.getCentroid=function(geometry){var cent=new jsts.algorithm.Centroid(geometry);return cent.getCentroid();};jsts.algorithm.Centroid.centroid3=function(p1,p2,p3,c){c.x=p1.x+p2.x+p3.x;c.y=p1.y+p2.y+p3.y;};jsts.algorithm.Centroid.area2=function(p1,p2,p3){return(p2.x-p1.x)*(p3.y-p1.y)-(p3.x-p1.x)*(p2.y-p1.y);};jsts.algorithm.Centroid.prototype.add=function(geom){if(geom.isEmpty()){return;}
if(geom instanceof jsts.geom.Point){this.addPoint(geom.getCoordinate());}else if(geom instanceof jsts.geom.LineString){this.addLineSegments(geom.getCoordinates());}else if(geom instanceof jsts.geom.Polygon){this.addPolygon(geom);}else if(geom instanceof jsts.geom.GeometryCollection){for(var i=0;i<geom.getNumGeometries();i++){this.add(geom.getGeometryN(i));}}};jsts.algorithm.Centroid.prototype.getCentroid=function(){var cent=new jsts.geom.Coordinate();if(Math.abs(this.areasum2)>0){cent.x=this.cg3.x/3/this.areasum2;cent.y=this.cg3.y/3/this.areasum2;}else if(this.totalLength>0){cent.x=this.lineCentSum.x/this.totalLength;cent.y=this.lineCentSum.y/this.totalLength;}else if(this.ptCount>0){cent.x=this.ptCentSum.x/this.ptCount;cent.y=this.ptCentSum.y/this.ptCount;}else{return null;}
return cent;};jsts.algorithm.Centroid.prototype.setBasePoint=function(basePt){if(this.areaBasePt===null){this.areaBasePt=basePt;}};jsts.algorithm.Centroid.prototype.addPolygon=function(poly){this.addShell(poly.getExteriorRing().getCoordinates());for(var i=0;i<poly.getNumInteriorRing();i++){this.addHole(poly.getInteriorRingN(i).getCoordinates());}};jsts.algorithm.Centroid.prototype.addShell=function(pts){if(pts.length>0){this.setBasePoint(pts[0]);}
var isPositiveArea=!jsts.algorithm.CGAlgorithms.isCCW(pts);for(var i=0;i<pts.length-1;i++){this.addTriangle(this.areaBasePt,pts[i],pts[i+1],isPositiveArea);}
this.addLineSegments(pts);};jsts.algorithm.Centroid.prototype.addHole=function(pts){var isPositiveArea=jsts.algorithm.CGAlgorithms.isCCW(pts);for(var i=0;i<pts.length-1;i++){this.addTriangle(this.areaBasePt,pts[i],pts[i+1],isPositiveArea);}
this.addLineSegments(pts);};jsts.algorithm.Centroid.prototype.addTriangle=function(p0,p1,p2,isPositiveArea){var sign=(isPositiveArea)?1:-1;jsts.algorithm.Centroid.centroid3(p0,p1,p2,this.triangleCent3);var area2=jsts.algorithm.Centroid.area2(p0,p1,p2);this.cg3.x+=sign*area2*this.triangleCent3.x;this.cg3.y+=sign*area2*this.triangleCent3.y;this.areasum2+=sign*area2;};jsts.algorithm.Centroid.prototype.addLineSegments=function(pts){var lineLen=0;for(var i=0;i<pts.length-1;i++){var segmentLen=pts[i].distance(pts[i+1]);if(segmentLen===0){continue;}
lineLen+=segmentLen;var midx=(pts[i].x+pts[i+1].x)/2;this.lineCentSum.x+=segmentLen*midx;var midy=(pts[i].y+pts[i+1].y)/2;this.lineCentSum.y+=segmentLen*midy;}
this.totalLength+=lineLen;if(lineLen===0&&pts.length>0){this.addPoint(pts[0]);}};jsts.algorithm.Centroid.prototype.addPoint=function(pt){this.ptCount+=1;this.ptCentSum.x+=pt.x;this.ptCentSum.y+=pt.y;};(function(){var EdgeRing=function(factory){this.deList=new javascript.util.ArrayList();this.factory=factory;};EdgeRing.findEdgeRingContaining=function(testEr,shellList){var testRing=testEr.getRing();var testEnv=testRing.getEnvelopeInternal();var testPt=testRing.getCoordinateN(0);var minShell=null;var minEnv=null;for(var it=shellList.iterator();it.hasNext();){var tryShell=it.next();var tryRing=tryShell.getRing();var tryEnv=tryRing.getEnvelopeInternal();if(minShell!=null)
minEnv=minShell.getRing().getEnvelopeInternal();var isContained=false;if(tryEnv.equals(testEnv))
continue;testPt=jsts.geom.CoordinateArrays.ptNotInList(testRing.getCoordinates(),tryRing.getCoordinates());if(tryEnv.contains(testEnv)&&jsts.algorithm.CGAlgorithms.isPointInRing(testPt,tryRing.getCoordinates()))
isContained=true;if(isContained){if(minShell==null||minEnv.contains(tryEnv)){minShell=tryShell;}}}
return minShell;};EdgeRing.ptNotInList=function(testPts,pts){for(var i=0;i<testPts.length;i++){var testPt=testPts[i];if(!isInList(testPt,pts))
return testPt;}
return null;};EdgeRing.isInList=function(pt,pts){for(var i=0;i<pts.length;i++){if(pt.equals(pts[i]))
return true;}
return false;}
EdgeRing.prototype.factory=null;EdgeRing.prototype.deList=null;EdgeRing.prototype.ring=null;EdgeRing.prototype.ringPts=null;EdgeRing.prototype.holes=null;EdgeRing.prototype.add=function(de){this.deList.add(de);};EdgeRing.prototype.isHole=function(){var ring=this.getRing();return jsts.algorithm.CGAlgorithms.isCCW(ring.getCoordinates());};EdgeRing.prototype.addHole=function(hole){if(this.holes==null)
this.holes=new javascript.util.ArrayList();this.holes.add(hole);};EdgeRing.prototype.getPolygon=function(){var holeLR=null;if(this.holes!=null){holeLR=[];for(var i=0;i<this.holes.size();i++){holeLR[i]=this.holes.get(i);}}
var poly=this.factory.createPolygon(this.ring,holeLR);return poly;};EdgeRing.prototype.isValid=function(){this.getCoordinates();if(this.ringPts.length<=3)
return false;this.getRing();return this.ring.isValid();};EdgeRing.prototype.getCoordinates=function(){if(this.ringPts==null){var coordList=new jsts.geom.CoordinateList();for(var i=this.deList.iterator();i.hasNext();){var de=i.next();var edge=de.getEdge();EdgeRing.addEdge(edge.getLine().getCoordinates(),de.getEdgeDirection(),coordList);}
this.ringPts=coordList.toCoordinateArray();}
return this.ringPts;};EdgeRing.prototype.getLineString=function(){this.getCoordinates();return this.factory.createLineString(this.ringPts);};EdgeRing.prototype.getRing=function(){if(this.ring!=null)
return this.ring;this.getCoordinates();if(this.ringPts.length<3)
console.log(this.ringPts);try{this.ring=this.factory.createLinearRing(this.ringPts);}catch(ex){console.log(this.ringPts);}
return this.ring;};EdgeRing.addEdge=function(coords,isForward,coordList){if(isForward){for(var i=0;i<coords.length;i++){coordList.add(coords[i],false);}}else{for(var i=coords.length-1;i>=0;i--){coordList.add(coords[i],false);}}};jsts.operation.polygonize.EdgeRing=EdgeRing;})();(function(){var GraphComponent=function(){};GraphComponent.setVisited=function(i,visited){while(i.hasNext()){var comp=i.next();comp.setVisited(visited);}};GraphComponent.setMarked=function(i,marked){while(i.hasNext()){var comp=i.next();comp.setMarked(marked);}};GraphComponent.getComponentWithVisitedState=function(i,visitedState){while(i.hasNext()){var comp=i.next();if(comp.isVisited()==visitedState)
return comp;}
return null;};GraphComponent.prototype._isMarked=false;GraphComponent.prototype._isVisited=false;GraphComponent.prototype.data;GraphComponent.prototype.isVisited=function(){return this._isVisited;};GraphComponent.prototype.setVisited=function(isVisited){this._isVisited=isVisited;};GraphComponent.prototype.isMarked=function(){return this._isMarked;};GraphComponent.prototype.setMarked=function(isMarked){this._isMarked=isMarked;};GraphComponent.prototype.setContext=function(data){this.data=data;};GraphComponent.prototype.getContext=function(){return data;};GraphComponent.prototype.setData=function(data){this.data=data;};GraphComponent.prototype.getData=function(){return data;};GraphComponent.prototype.isRemoved=function(){throw new jsts.error.AbstractMethodInvocationError();};jsts.planargraph.GraphComponent=GraphComponent;})();(function(){var GraphComponent=jsts.planargraph.GraphComponent;var Edge=function(de0,de1){if(de0===undefined){return;}
this.setDirectedEdges(de0,de1);};Edge.prototype=new GraphComponent();Edge.prototype.dirEdge=null;Edge.prototype.setDirectedEdges=function(de0,de1){this.dirEdge=[de0,de1];de0.setEdge(this);de1.setEdge(this);de0.setSym(de1);de1.setSym(de0);de0.getFromNode().addOutEdge(de0);de1.getFromNode().addOutEdge(de1);};Edge.prototype.getDirEdge=function(i){if(i instanceof jsts.planargraph.Node){this.getDirEdge2(i);}
return this.dirEdge[i];};Edge.prototype.getDirEdge2=function(fromNode){if(this.dirEdge[0].getFromNode()==fromNode)
return this.dirEdge[0];if(this.dirEdge[1].getFromNode()==fromNode)
return this.dirEdge[1];return null;};Edge.prototype.getOppositeNode=function(node){if(this.dirEdge[0].getFromNode()==node)
return this.dirEdge[0].getToNode();if(this.dirEdge[1].getFromNode()==node)
return this.dirEdge[1].getToNode();return null;};Edge.prototype.remove=function(){this.dirEdge=null;};Edge.prototype.isRemoved=function(){return dirEdge==null;};jsts.planargraph.Edge=Edge;})();jsts.operation.polygonize.PolygonizeEdge=function(line){this.line=line;};jsts.operation.polygonize.PolygonizeEdge.prototype=new jsts.planargraph.Edge();jsts.operation.polygonize.PolygonizeEdge.prototype.line=null;jsts.operation.polygonize.PolygonizeEdge.prototype.getLine=function(){return this.line;};(function(){var ArrayList=javascript.util.ArrayList;var GraphComponent=jsts.planargraph.GraphComponent;var DirectedEdge=function(from,to,directionPt,edgeDirection){if(from===undefined){return;}
this.from=from;this.to=to;this.edgeDirection=edgeDirection;this.p0=from.getCoordinate();this.p1=directionPt;var dx=this.p1.x-this.p0.x;var dy=this.p1.y-this.p0.y;this.quadrant=jsts.geomgraph.Quadrant.quadrant(dx,dy);this.angle=Math.atan2(dy,dx);};DirectedEdge.prototype=new GraphComponent();DirectedEdge.toEdges=function(dirEdges){var edges=new ArrayList();for(var i=dirEdges.iterator();i.hasNext();){edges.add((i.next()).parentEdge);}
return edges;};DirectedEdge.prototype.parentEdge=null;DirectedEdge.prototype.from=null;DirectedEdge.prototype.to=null;DirectedEdge.prototype.p0=null;DirectedEdge.prototype.p1=null;DirectedEdge.prototype.sym=null;DirectedEdge.prototype.edgeDirection=null;DirectedEdge.prototype.quadrant=null;DirectedEdge.prototype.angle=null;DirectedEdge.prototype.getEdge=function(){return this.parentEdge;};DirectedEdge.prototype.setEdge=function(parentEdge){this.parentEdge=parentEdge;};DirectedEdge.prototype.getQuadrant=function(){return this.quadrant;};DirectedEdge.prototype.getDirectionPt=function(){return this.p1;};DirectedEdge.prototype.getEdgeDirection=function(){return this.edgeDirection;};DirectedEdge.prototype.getFromNode=function(){return this.from;};DirectedEdge.prototype.getToNode=function(){return this.to;};DirectedEdge.prototype.getCoordinate=function(){return this.from.getCoordinate();};DirectedEdge.prototype.getAngle=function(){return this.angle;};DirectedEdge.prototype.getSym=function(){return this.sym;};DirectedEdge.prototype.setSym=function(sym){this.sym=sym;};DirectedEdge.prototype.remove=function(){this.sym=null;this.parentEdge=null;};DirectedEdge.prototype.isRemoved=function(){return this.parentEdge==null;};DirectedEdge.prototype.compareTo=function(obj){var de=obj;return this.compareDirection(de);};DirectedEdge.prototype.compareDirection=function(e){if(this.quadrant>e.quadrant)
return 1;if(this.quadrant<e.quadrant)
return-1;return jsts.algorithm.CGAlgorithms.computeOrientation(e.p0,e.p1,this.p1);};jsts.planargraph.DirectedEdge=DirectedEdge;})();(function(){var DirectedEdge=jsts.planargraph.DirectedEdge;var PolygonizeDirectedEdge=function(from,to,directionPt,edgeDirection){DirectedEdge.apply(this,arguments);};PolygonizeDirectedEdge.prototype=new DirectedEdge();PolygonizeDirectedEdge.prototype.edgeRing=null;PolygonizeDirectedEdge.prototype.next=null;PolygonizeDirectedEdge.prototype.label=-1;PolygonizeDirectedEdge.prototype.getLabel=function(){return this.label;};PolygonizeDirectedEdge.prototype.setLabel=function(label){this.label=label;};PolygonizeDirectedEdge.prototype.getNext=function(){return this.next;};PolygonizeDirectedEdge.prototype.setNext=function(next){this.next=next;};PolygonizeDirectedEdge.prototype.isInRing=function(){return this.edgeRing!=null;};PolygonizeDirectedEdge.prototype.setRing=function(edgeRing){this.edgeRing=edgeRing;};jsts.operation.polygonize.PolygonizeDirectedEdge=PolygonizeDirectedEdge;})();(function(){var ArrayList=javascript.util.ArrayList;var DirectedEdgeStar=function(){this.outEdges=new ArrayList();};DirectedEdgeStar.prototype.outEdges=null;DirectedEdgeStar.prototype.sorted=false;DirectedEdgeStar.prototype.add=function(de){this.outEdges.add(de);this.sorted=false;};DirectedEdgeStar.prototype.remove=function(de){this.outEdges.remove(de);};DirectedEdgeStar.prototype.iterator=function(){this.sortEdges();return this.outEdges.iterator();};DirectedEdgeStar.prototype.getDegree=function(){return this.outEdges.size();};DirectedEdgeStar.prototype.getCoordinate=function(){var it=iterator();if(!it.hasNext())
return null;var e=it.next();return e.getCoordinate();};DirectedEdgeStar.prototype.getEdges=function(){this.sortEdges();return this.outEdges;};DirectedEdgeStar.prototype.sortEdges=function(){if(!this.sorted){var array=this.outEdges.toArray();array.sort(function(a,b){return a.compareTo(b);});this.outEdges=javascript.util.Arrays.asList(array);this.sorted=true;}};DirectedEdgeStar.prototype.getIndex=function(edge){if(edge instanceof jsts.planargraph.DirectedEdge){return this.getIndex2(edge);}else if(typeof(edge)==='number'){return this.getIndex3(edge);}
this.sortEdges();for(var i=0;i<this.outEdges.size();i++){var de=this.outEdges.get(i);if(de.getEdge()==edge)
return i;}
return-1;};DirectedEdgeStar.prototype.getIndex2=function(dirEdge){this.sortEdges();for(var i=0;i<this.outEdges.size();i++){var de=this.outEdges.get(i);if(de==dirEdge)
return i;}
return-1;};DirectedEdgeStar.prototype.getIndex3=function(i){var modi=toInt(i%this.outEdges.size());if(modi<0)
modi+=this.outEdges.size();return modi;};DirectedEdgeStar.prototype.getNextEdge=function(dirEdge){var i=this.getIndex(dirEdge);return this.outEdges.get(getIndex(i+1));};DirectedEdgeStar.prototype.getNextCWEdge=function(dirEdge){var i=this.getIndex(dirEdge);return this.outEdges.get(getIndex(i-1));};jsts.planargraph.DirectedEdgeStar=DirectedEdgeStar;})();(function(){var GraphComponent=jsts.planargraph.GraphComponent;var DirectedEdgeStar=jsts.planargraph.DirectedEdgeStar;var Node=function(pt,deStar){this.pt=pt;this.deStar=deStar||new DirectedEdgeStar();};Node.prototype=new GraphComponent();Node.getEdgesBetween=function(node0,node1){var edges0=DirectedEdge.toEdges(node0.getOutEdges().getEdges());var commonEdges=new javascript.util.HashSet(edges0);var edges1=DirectedEdge.toEdges(node1.getOutEdges().getEdges());commonEdges.retainAll(edges1);return commonEdges;};Node.prototype.pt=null;Node.prototype.deStar=null;Node.prototype.getCoordinate=function(){return this.pt;};Node.prototype.addOutEdge=function(de){this.deStar.add(de);};Node.prototype.getOutEdges=function(){return this.deStar;};Node.prototype.getDegree=function(){return this.deStar.getDegree();};Node.prototype.getIndex=function(edge){return this.deStar.getIndex(edge);};Node.prototype.remove=function(de){if(de===undefined){return this.remove2();}
this.deStar.remove(de);};Node.prototype.remove2=function(){this.pt=null;};Node.prototype.isRemoved=function(){return this.pt==null;};jsts.planargraph.Node=Node;})();(function(){var NodeMap=function(){this.nodeMap=new javascript.util.TreeMap();};NodeMap.prototype.nodeMap=null;NodeMap.prototype.add=function(n){this.nodeMap.put(n.getCoordinate(),n);return n;};NodeMap.prototype.remove=function(pt){return this.nodeMap.remove(pt);};NodeMap.prototype.find=function(coord){return this.nodeMap.get(coord);};NodeMap.prototype.iterator=function(){return this.nodeMap.values().iterator();};NodeMap.prototype.values=function(){return this.nodeMap.values();};jsts.planargraph.NodeMap=NodeMap;})();(function(){var ArrayList=javascript.util.ArrayList;var PlanarGraph=function(){this.edges=new javascript.util.HashSet();this.dirEdges=new javascript.util.HashSet();this.nodeMap=new jsts.planargraph.NodeMap();};PlanarGraph.prototype.edges=null;PlanarGraph.prototype.dirEdges=null;PlanarGraph.prototype.nodeMap=null;PlanarGraph.prototype.findNode=function(pt){return this.nodeMap.find(pt);};PlanarGraph.prototype.add=function(node){if(node instanceof jsts.planargraph.Edge){return this.add2(node);}else if(node instanceof jsts.planargraph.DirectedEdge){return this.add3(node);}
this.nodeMap.add(node);};PlanarGraph.prototype.add2=function(edge){this.edges.add(edge);this.add(edge.getDirEdge(0));this.add(edge.getDirEdge(1));};PlanarGraph.prototype.add3=function(dirEdge){this.dirEdges.add(dirEdge);};PlanarGraph.prototype.nodeIterator=function(){return this.nodeMap.iterator();};PlanarGraph.prototype.contains=function(e){if(e instanceof jsts.planargraph.DirectedEdge){return this.contains2(e);}
return this.edges.contains(e);};PlanarGraph.prototype.contains2=function(de){return this.dirEdges.contains(de);};PlanarGraph.prototype.getNodes=function(){return this.nodeMap.values();};PlanarGraph.prototype.dirEdgeIterator=function(){return this.dirEdges.iterator();};PlanarGraph.prototype.edgeIterator=function(){return this.edges.iterator();};PlanarGraph.prototype.getEdges=function(){return this.edges;};PlanarGraph.prototype.remove=function(edge){if(edge instanceof jsts.planargraph.DirectedEdge){return this.remove2(edge);}
this.remove(edge.getDirEdge(0));this.remove(edge.getDirEdge(1));this.edges.remove(edge);this.edge.remove();};PlanarGraph.prototype.remove2=function(de){if(de instanceof jsts.planargraph.Node){return this.remove3(de);}
var sym=de.getSym();if(sym!=null)
sym.setSym(null);de.getFromNode().remove(de);de.remove();this.dirEdges.remove(de);};PlanarGraph.prototype.remove3=function(node){var outEdges=node.getOutEdges().getEdges();for(var i=outEdges.iterator();i.hasNext();){var de=i.next();var sym=de.getSym();if(sym!=null)
this.remove(sym);this.dirEdges.remove(de);var edge=de.getEdge();if(edge!=null){this.edges.remove(edge);}}
this.nodeMap.remove(node.getCoordinate());node.remove();};PlanarGraph.prototype.findNodesOfDegree=function(degree){var nodesFound=new ArrayList();for(var i=this.nodeIterator();i.hasNext();){var node=i.next();if(node.getDegree()==degree)
nodesFound.add(node);}
return nodesFound;};jsts.planargraph.PlanarGraph=PlanarGraph;})();(function(){var ArrayList=javascript.util.ArrayList;var Stack=javascript.util.Stack;var HashSet=javascript.util.HashSet;var Assert=jsts.util.Assert;var EdgeRing=jsts.operation.polygonize.EdgeRing;var PolygonizeEdge=jsts.operation.polygonize.PolygonizeEdge;var PolygonizeDirectedEdge=jsts.operation.polygonize.PolygonizeDirectedEdge;var PlanarGraph=jsts.planargraph.PlanarGraph;var Node=jsts.planargraph.Node;var PolygonizeGraph=function(factory){PlanarGraph.apply(this);this.factory=factory;};PolygonizeGraph.prototype=new PlanarGraph();PolygonizeGraph.getDegreeNonDeleted=function(node){var edges=node.getOutEdges().getEdges();var degree=0;for(var i=edges.iterator();i.hasNext();){var de=i.next();if(!de.isMarked())
degree++;}
return degree;};PolygonizeGraph.getDegree=function(node,label){var edges=node.getOutEdges().getEdges();var degree=0;for(var i=edges.iterator();i.hasNext();){var de=i.next();if(de.getLabel()==label)
degree++;}
return degree;};PolygonizeGraph.deleteAllEdges=function(node){var edges=node.getOutEdges().getEdges();for(var i=edges.iterator();i.hasNext();){var de=i.next();de.setMarked(true);var sym=de.getSym();if(sym!=null)
sym.setMarked(true);}};PolygonizeGraph.prototype.factory=null;PolygonizeGraph.prototype.addEdge=function(line){if(line.isEmpty()){return;}
var linePts=jsts.geom.CoordinateArrays.removeRepeatedPoints(line.getCoordinates());if(linePts.length<2){return;}
var startPt=linePts[0];var endPt=linePts[linePts.length-1];var nStart=this.getNode(startPt);var nEnd=this.getNode(endPt);var de0=new PolygonizeDirectedEdge(nStart,nEnd,linePts[1],true);var de1=new PolygonizeDirectedEdge(nEnd,nStart,linePts[linePts.length-2],false);var edge=new PolygonizeEdge(line);edge.setDirectedEdges(de0,de1);this.add(edge);};PolygonizeGraph.prototype.getNode=function(pt){var node=this.findNode(pt);if(node==null){node=new Node(pt);this.add(node);}
return node;};PolygonizeGraph.prototype.computeNextCWEdges=function(){for(var iNode=this.nodeIterator();iNode.hasNext();){var node=iNode.next();PolygonizeGraph.computeNextCWEdges(node);}};PolygonizeGraph.prototype.convertMaximalToMinimalEdgeRings=function(ringEdges){for(var i=ringEdges.iterator();i.hasNext();){var de=i.next();var label=de.getLabel();var intNodes=PolygonizeGraph.findIntersectionNodes(de,label);if(intNodes==null)
continue;for(var iNode=intNodes.iterator();iNode.hasNext();){var node=iNode.next();PolygonizeGraph.computeNextCCWEdges(node,label);}}};PolygonizeGraph.findIntersectionNodes=function(startDE,label){var de=startDE;var intNodes=null;do{var node=de.getFromNode();if(PolygonizeGraph.getDegree(node,label)>1){if(intNodes==null)
intNodes=new ArrayList();intNodes.add(node);}
de=de.getNext();Assert.isTrue(de!=null,'found null DE in ring');Assert.isTrue(de==startDE||!de.isInRing(),'found DE already in ring');}while(de!=startDE);return intNodes;};PolygonizeGraph.prototype.getEdgeRings=function(){this.computeNextCWEdges();PolygonizeGraph.label(this.dirEdges,-1);var maximalRings=PolygonizeGraph.findLabeledEdgeRings(this.dirEdges);this.convertMaximalToMinimalEdgeRings(maximalRings);var edgeRingList=new ArrayList();for(var i=this.dirEdges.iterator();i.hasNext();){var de=i.next();if(de.isMarked())
continue;if(de.isInRing())
continue;var er=this.findEdgeRing(de);edgeRingList.add(er);}
return edgeRingList;};PolygonizeGraph.findLabeledEdgeRings=function(dirEdges){var edgeRingStarts=new ArrayList();var currLabel=1;for(var i=dirEdges.iterator();i.hasNext();){var de=i.next();if(de.isMarked())
continue;if(de.getLabel()>=0)
continue;edgeRingStarts.add(de);var edges=PolygonizeGraph.findDirEdgesInRing(de);PolygonizeGraph.label(edges,currLabel);currLabel++;}
return edgeRingStarts;};PolygonizeGraph.prototype.deleteCutEdges=function(){this.computeNextCWEdges();PolygonizeGraph.findLabeledEdgeRings(this.dirEdges);var cutLines=new ArrayList();for(var i=this.dirEdges.iterator();i.hasNext();){var de=i.next();if(de.isMarked())
continue;var sym=de.getSym();if(de.getLabel()==sym.getLabel()){de.setMarked(true);sym.setMarked(true);var e=de.getEdge();cutLines.add(e.getLine());}}
return cutLines;};PolygonizeGraph.label=function(dirEdges,label){for(var i=dirEdges.iterator();i.hasNext();){var de=i.next();de.setLabel(label);}};PolygonizeGraph.computeNextCWEdges=function(node){var deStar=node.getOutEdges();var startDE=null;var prevDE=null;for(var i=deStar.getEdges().iterator();i.hasNext();){var outDE=i.next();if(outDE.isMarked())
continue;if(startDE==null)
startDE=outDE;if(prevDE!=null){var sym=prevDE.getSym();sym.setNext(outDE);}
prevDE=outDE;}
if(prevDE!=null){var sym=prevDE.getSym();sym.setNext(startDE);}};PolygonizeGraph.computeNextCCWEdges=function(node,label){var deStar=node.getOutEdges();var firstOutDE=null;var prevInDE=null;var edges=deStar.getEdges();for(var i=edges.size()-1;i>=0;i--){var de=edges.get(i);var sym=de.getSym();var outDE=null;if(de.getLabel()==label)
outDE=de;var inDE=null;if(sym.getLabel()==label)
inDE=sym;if(outDE==null&&inDE==null)
continue;if(inDE!=null){prevInDE=inDE;}
if(outDE!=null){if(prevInDE!=null){prevInDE.setNext(outDE);prevInDE=null;}
if(firstOutDE==null)
firstOutDE=outDE;}}
if(prevInDE!=null){Assert.isTrue(firstOutDE!=null);prevInDE.setNext(firstOutDE);}};PolygonizeGraph.findDirEdgesInRing=function(startDE){var de=startDE;var edges=new ArrayList();do{edges.add(de);de=de.getNext();Assert.isTrue(de!=null,'found null DE in ring');Assert.isTrue(de==startDE||!de.isInRing(),'found DE already in ring');}while(de!=startDE);return edges;};PolygonizeGraph.prototype.findEdgeRing=function(startDE){var de=startDE;var er=new EdgeRing(this.factory);do{er.add(de);de.setRing(er);de=de.getNext();Assert.isTrue(de!=null,'found null DE in ring');Assert.isTrue(de==startDE||!de.isInRing(),'found DE already in ring');}while(de!=startDE);return er;};PolygonizeGraph.prototype.deleteDangles=function(){var nodesToRemove=this.findNodesOfDegree(1);var dangleLines=new HashSet();var nodeStack=new Stack();for(var i=nodesToRemove.iterator();i.hasNext();){nodeStack.push(i.next());}
while(!nodeStack.isEmpty()){var node=nodeStack.pop();PolygonizeGraph.deleteAllEdges(node);var nodeOutEdges=node.getOutEdges().getEdges();for(var i=nodeOutEdges.iterator();i.hasNext();){var de=i.next();de.setMarked(true);var sym=de.getSym();if(sym!=null)
sym.setMarked(true);var e=de.getEdge();dangleLines.add(e.getLine());var toNode=de.getToNode();if(PolygonizeGraph.getDegreeNonDeleted(toNode)==1)
nodeStack.push(toNode);}}
return dangleLines;};PolygonizeGraph.prototype.computeDepthParity=function(){while(true){var de=null;if(de==null)
return;this.computeDepthParity(de);}};PolygonizeGraph.prototype.computeDepthParity=function(de){};jsts.operation.polygonize.PolygonizeGraph=PolygonizeGraph;})();jsts.index.strtree.Interval=function(){var other;if(arguments.length===1){other=arguments[0];return jsts.index.strtree.Interval(other.min,other.max);}else if(arguments.length===2){jsts.util.Assert.isTrue(this.min<=this.max);this.min=arguments[0];this.max=arguments[1];}};jsts.index.strtree.Interval.prototype.min=null;jsts.index.strtree.Interval.prototype.max=null;jsts.index.strtree.Interval.prototype.getCentre=function(){return(this.min+this.max)/2;};jsts.index.strtree.Interval.prototype.expandToInclude=function(other){this.max=Math.max(this.max,other.max);this.min=Math.min(this.min,other.min);return this;};jsts.index.strtree.Interval.prototype.intersects=function(other){return!(other.min>this.max||other.max<this.min);};jsts.index.strtree.Interval.prototype.equals=function(o){if(!(o instanceof jsts.index.strtree.Interval)){return false;}
other=o;return this.min===other.min&&this.max===other.max;};jsts.geom.GeometryFactory=function(precisionModel){this.precisionModel=precisionModel||new jsts.geom.PrecisionModel();};jsts.geom.GeometryFactory.prototype.precisionModel=null;jsts.geom.GeometryFactory.prototype.getPrecisionModel=function(){return this.precisionModel;};jsts.geom.GeometryFactory.prototype.createPoint=function(coordinate){var point=new jsts.geom.Point(coordinate,this);return point;};jsts.geom.GeometryFactory.prototype.createLineString=function(coordinates){var lineString=new jsts.geom.LineString(coordinates,this);return lineString;};jsts.geom.GeometryFactory.prototype.createLinearRing=function(coordinates){var linearRing=new jsts.geom.LinearRing(coordinates,this);return linearRing;};jsts.geom.GeometryFactory.prototype.createPolygon=function(shell,holes){var polygon=new jsts.geom.Polygon(shell,holes,this);return polygon;};jsts.geom.GeometryFactory.prototype.createMultiPoint=function(points){if(points&&points[0]instanceof jsts.geom.Coordinate){var converted=[];var i;for(i=0;i<points.length;i++){converted.push(this.createPoint(points[i]));}
points=converted;}
return new jsts.geom.MultiPoint(points,this);};jsts.geom.GeometryFactory.prototype.createMultiLineString=function(lineStrings){return new jsts.geom.MultiLineString(lineStrings,this);};jsts.geom.GeometryFactory.prototype.createMultiPolygon=function(polygons){return new jsts.geom.MultiPolygon(polygons,this);};jsts.geom.GeometryFactory.prototype.buildGeometry=function(geomList){var geomClass=null;var isHeterogeneous=false;var hasGeometryCollection=false;for(var i=geomList.iterator();i.hasNext();){var geom=i.next();var partClass=geom.CLASS_NAME;if(geomClass===null){geomClass=partClass;}
if(!(partClass===geomClass)){isHeterogeneous=true;}
if(geom.isGeometryCollectionBase())
hasGeometryCollection=true;}
if(geomClass===null){return this.createGeometryCollection(null);}
if(isHeterogeneous||hasGeometryCollection){return this.createGeometryCollection(geomList.toArray());}
var geom0=geomList.get(0);var isCollection=geomList.size()>1;if(isCollection){if(geom0 instanceof jsts.geom.Polygon){return this.createMultiPolygon(geomList.toArray());}else if(geom0 instanceof jsts.geom.LineString){return this.createMultiLineString(geomList.toArray());}else if(geom0 instanceof jsts.geom.Point){return this.createMultiPoint(geomList.toArray());}
jsts.util.Assert.shouldNeverReachHere('Unhandled class: '+geom0);}
return geom0;};jsts.geom.GeometryFactory.prototype.createGeometryCollection=function(geometries){return new jsts.geom.GeometryCollection(geometries,this);};jsts.geom.GeometryFactory.prototype.toGeometry=function(envelope){if(envelope.isNull()){return this.createPoint(null);}
if(envelope.getMinX()===envelope.getMaxX()&&envelope.getMinY()===envelope.getMaxY()){return this.createPoint(new jsts.geom.Coordinate(envelope.getMinX(),envelope.getMinY()));}
if(envelope.getMinX()===envelope.getMaxX()||envelope.getMinY()===envelope.getMaxY()){return this.createLineString([new jsts.geom.Coordinate(envelope.getMinX(),envelope.getMinY()),new jsts.geom.Coordinate(envelope.getMaxX(),envelope.getMaxY())]);}
return this.createPolygon(this.createLinearRing([new jsts.geom.Coordinate(envelope.getMinX(),envelope.getMinY()),new jsts.geom.Coordinate(envelope.getMinX(),envelope.getMaxY()),new jsts.geom.Coordinate(envelope.getMaxX(),envelope.getMaxY()),new jsts.geom.Coordinate(envelope.getMaxX(),envelope.getMinY()),new jsts.geom.Coordinate(envelope.getMinX(),envelope.getMinY())]),null);};jsts.geomgraph.NodeFactory=function(){};jsts.geomgraph.NodeFactory.prototype.createNode=function(coord){return new jsts.geomgraph.Node(coord,null);};(function(){jsts.geomgraph.Position=function(){};jsts.geomgraph.Position.ON=0;jsts.geomgraph.Position.LEFT=1;jsts.geomgraph.Position.RIGHT=2;jsts.geomgraph.Position.opposite=function(position){if(position===jsts.geomgraph.Position.LEFT){return jsts.geomgraph.Position.RIGHT;}
if(position===jsts.geomgraph.Position.RIGHT){return jsts.geomgraph.Position.LEFT;}
return position;};})();jsts.geomgraph.TopologyLocation=function(){this.location=[];if(arguments.length===3){var on=arguments[0];var left=arguments[1];var right=arguments[2];this.init(3);this.location[jsts.geomgraph.Position.ON]=on;this.location[jsts.geomgraph.Position.LEFT]=left;this.location[jsts.geomgraph.Position.RIGHT]=right;}else if(arguments[0]instanceof jsts.geomgraph.TopologyLocation){var gl=arguments[0];this.init(gl.location.length);if(gl!=null){for(var i=0;i<this.location.length;i++){this.location[i]=gl.location[i];}}}else if(typeof arguments[0]==='number'){var on=arguments[0];this.init(1);this.location[jsts.geomgraph.Position.ON]=on;}else if(arguments[0]instanceof Array){var location=arguments[0];this.init(location.length);}};jsts.geomgraph.TopologyLocation.prototype.location=null;jsts.geomgraph.TopologyLocation.prototype.init=function(size){this.location[size-1]=null;this.setAllLocations(jsts.geom.Location.NONE);};jsts.geomgraph.TopologyLocation.prototype.get=function(posIndex){if(posIndex<this.location.length)
return this.location[posIndex];return jsts.geom.Location.NONE;};jsts.geomgraph.TopologyLocation.prototype.isNull=function(){for(var i=0;i<this.location.length;i++){if(this.location[i]!==jsts.geom.Location.NONE)
return false;}
return true;};jsts.geomgraph.TopologyLocation.prototype.isAnyNull=function(){for(var i=0;i<this.location.length;i++){if(this.location[i]===jsts.geom.Location.NONE)
return true;}
return false;};jsts.geomgraph.TopologyLocation.prototype.isEqualOnSide=function(le,locIndex){return this.location[locIndex]==le.location[locIndex];};jsts.geomgraph.TopologyLocation.prototype.isArea=function(){return this.location.length>1;};jsts.geomgraph.TopologyLocation.prototype.isLine=function(){return this.location.length===1;};jsts.geomgraph.TopologyLocation.prototype.flip=function(){if(this.location.length<=1)
return;var temp=this.location[jsts.geomgraph.Position.LEFT];this.location[jsts.geomgraph.Position.LEFT]=this.location[jsts.geomgraph.Position.RIGHT];this.location[jsts.geomgraph.Position.RIGHT]=temp;};jsts.geomgraph.TopologyLocation.prototype.setAllLocations=function(locValue){for(var i=0;i<this.location.length;i++){this.location[i]=locValue;}};jsts.geomgraph.TopologyLocation.prototype.setAllLocationsIfNull=function(locValue){for(var i=0;i<this.location.length;i++){if(this.location[i]===jsts.geom.Location.NONE)
this.location[i]=locValue;}};jsts.geomgraph.TopologyLocation.prototype.setLocation=function(locIndex,locValue){if(locValue!==undefined){this.location[locIndex]=locValue;}else{this.setLocation(jsts.geomgraph.Position.ON,locIndex);}};jsts.geomgraph.TopologyLocation.prototype.getLocations=function(){return location;};jsts.geomgraph.TopologyLocation.prototype.setLocations=function(on,left,right){this.location[jsts.geomgraph.Position.ON]=on;this.location[jsts.geomgraph.Position.LEFT]=left;this.location[jsts.geomgraph.Position.RIGHT]=right;};jsts.geomgraph.TopologyLocation.prototype.allPositionsEqual=function(loc){for(var i=0;i<this.location.length;i++){if(this.location[i]!==loc)
return false;}
return true;};jsts.geomgraph.TopologyLocation.prototype.merge=function(gl){if(gl.location.length>this.location.length){var newLoc=[];newLoc[jsts.geomgraph.Position.ON]=this.location[jsts.geomgraph.Position.ON];newLoc[jsts.geomgraph.Position.LEFT]=jsts.geom.Location.NONE;newLoc[jsts.geomgraph.Position.RIGHT]=jsts.geom.Location.NONE;this.location=newLoc;}
for(var i=0;i<this.location.length;i++){if(this.location[i]===jsts.geom.Location.NONE&&i<gl.location.length)
this.location[i]=gl.location[i];}};jsts.geomgraph.Label=function(){this.elt=[];var geomIndex,onLoc,leftLoc,lbl,rightLoc;if(arguments.length===4){geomIndex=arguments[0];onLoc=arguments[1];leftLoc=arguments[2];rightLoc=arguments[3];this.elt[0]=new jsts.geomgraph.TopologyLocation(jsts.geom.Location.NONE,jsts.geom.Location.NONE,jsts.geom.Location.NONE);this.elt[1]=new jsts.geomgraph.TopologyLocation(jsts.geom.Location.NONE,jsts.geom.Location.NONE,jsts.geom.Location.NONE);this.elt[geomIndex].setLocations(onLoc,leftLoc,rightLoc);}else if(arguments.length===3){onLoc=arguments[0];leftLoc=arguments[1];rightLoc=arguments[2];this.elt[0]=new jsts.geomgraph.TopologyLocation(onLoc,leftLoc,rightLoc);this.elt[1]=new jsts.geomgraph.TopologyLocation(onLoc,leftLoc,rightLoc);}else if(arguments.length===2){geomIndex=arguments[0];onLoc=arguments[1];this.elt[0]=new jsts.geomgraph.TopologyLocation(jsts.geom.Location.NONE);this.elt[1]=new jsts.geomgraph.TopologyLocation(jsts.geom.Location.NONE);this.elt[geomIndex].setLocation(onLoc);}else if(arguments[0]instanceof jsts.geomgraph.Label){lbl=arguments[0];this.elt[0]=new jsts.geomgraph.TopologyLocation(lbl.elt[0]);this.elt[1]=new jsts.geomgraph.TopologyLocation(lbl.elt[1]);}else if(typeof arguments[0]==='number'){onLoc=arguments[0];this.elt[0]=new jsts.geomgraph.TopologyLocation(onLoc);this.elt[1]=new jsts.geomgraph.TopologyLocation(onLoc);}};jsts.geomgraph.Label.toLineLabel=function(label){var i,lineLabel=new jsts.geomgraph.Label(jsts.geom.Location.NONE);for(i=0;i<2;i++){lineLabel.setLocation(i,label.getLocation(i));}
return lineLabel;};jsts.geomgraph.Label.prototype.elt=null;jsts.geomgraph.Label.prototype.flip=function(){this.elt[0].flip();this.elt[1].flip();};jsts.geomgraph.Label.prototype.getLocation=function(geomIndex,posIndex){if(arguments.length==1){return this.getLocation2.apply(this,arguments);}
return this.elt[geomIndex].get(posIndex);};jsts.geomgraph.Label.prototype.getLocation2=function(geomIndex){return this.elt[geomIndex].get(jsts.geomgraph.Position.ON);};jsts.geomgraph.Label.prototype.setLocation=function(geomIndex,posIndex,location){if(arguments.length==2){this.setLocation2.apply(this,arguments);return;}
this.elt[geomIndex].setLocation(posIndex,location);};jsts.geomgraph.Label.prototype.setLocation2=function(geomIndex,location){this.elt[geomIndex].setLocation(jsts.geomgraph.Position.ON,location);};jsts.geomgraph.Label.prototype.setAllLocations=function(geomIndex,location){this.elt[geomIndex].setAllLocations(location);};jsts.geomgraph.Label.prototype.setAllLocationsIfNull=function(geomIndex,location){if(arguments.length==1){this.setAllLocationsIfNull2.apply(this,arguments);return;}
this.elt[geomIndex].setAllLocationsIfNull(location);};jsts.geomgraph.Label.prototype.setAllLocationsIfNull2=function(location){this.setAllLocationsIfNull(0,location);this.setAllLocationsIfNull(1,location);};jsts.geomgraph.Label.prototype.merge=function(lbl){var i;for(i=0;i<2;i++){if(this.elt[i]===null&&lbl.elt[i]!==null){this.elt[i]=new jsts.geomgraph.TopologyLocation(lbl.elt[i]);}else{this.elt[i].merge(lbl.elt[i]);}}};jsts.geomgraph.Label.prototype.getGeometryCount=function(){var count=0;if(!this.elt[0].isNull()){count++;}
if(!this.elt[1].isNull()){count++;}
return count;};jsts.geomgraph.Label.prototype.isNull=function(geomIndex){return this.elt[geomIndex].isNull();};jsts.geomgraph.Label.prototype.isAnyNull=function(geomIndex){return this.elt[geomIndex].isAnyNull();};jsts.geomgraph.Label.prototype.isArea=function(){if(arguments.length==1){return this.isArea2(arguments[0]);}
return this.elt[0].isArea()||this.elt[1].isArea();};jsts.geomgraph.Label.prototype.isArea2=function(geomIndex){return this.elt[geomIndex].isArea();};jsts.geomgraph.Label.prototype.isLine=function(geomIndex){return this.elt[geomIndex].isLine();};jsts.geomgraph.Label.prototype.isEqualOnSide=function(lbl,side){return this.elt[0].isEqualOnSide(lbl.elt[0],side)&&this.elt[1].isEqualOnSide(lbl.elt[1],side);};jsts.geomgraph.Label.prototype.allPositionsEqual=function(geomIndex,loc){return this.elt[geomIndex].allPositionsEqual(loc);};jsts.geomgraph.Label.prototype.toLine=function(geomIndex){if(this.elt[geomIndex].isArea()){this.elt[geomIndex]=new jsts.geomgraph.TopologyLocation(this.elt[geomIndex].location[0]);}};jsts.geomgraph.EdgeRing=function(start,geometryFactory){this.edges=[];this.pts=[];this.holes=[];this.label=new jsts.geomgraph.Label(jsts.geom.Location.NONE);this.geometryFactory=geometryFactory;if(start){this.computePoints(start);this.computeRing();}};jsts.geomgraph.EdgeRing.prototype.startDe=null;jsts.geomgraph.EdgeRing.prototype.maxNodeDegree=-1;jsts.geomgraph.EdgeRing.prototype.edges=null;jsts.geomgraph.EdgeRing.prototype.pts=null;jsts.geomgraph.EdgeRing.prototype.label=null;jsts.geomgraph.EdgeRing.prototype.ring=null;jsts.geomgraph.EdgeRing.prototype._isHole=null;jsts.geomgraph.EdgeRing.prototype.shell=null;jsts.geomgraph.EdgeRing.prototype.holes=null;jsts.geomgraph.EdgeRing.prototype.geometryFactory=null;jsts.geomgraph.EdgeRing.prototype.isIsolated=function(){return(this.label.getGeometryCount()==1);};jsts.geomgraph.EdgeRing.prototype.isHole=function(){return this._isHole;};jsts.geomgraph.EdgeRing.prototype.getCoordinate=function(i){return this.pts[i];};jsts.geomgraph.EdgeRing.prototype.getLinearRing=function(){return this.ring;};jsts.geomgraph.EdgeRing.prototype.getLabel=function(){return this.label;};jsts.geomgraph.EdgeRing.prototype.isShell=function(){return this.shell===null;};jsts.geomgraph.EdgeRing.prototype.getShell=function(){return this.shell;};jsts.geomgraph.EdgeRing.prototype.setShell=function(shell){this.shell=shell;if(shell!==null)
shell.addHole(this);};jsts.geomgraph.EdgeRing.prototype.addHole=function(ring){this.holes.push(ring);};jsts.geomgraph.EdgeRing.prototype.toPolygon=function(geometryFactory){var holeLR=[];for(var i=0;i<this.holes.length;i++){holeLR[i]=this.holes[i].getLinearRing();}
var poly=this.geometryFactory.createPolygon(this.getLinearRing(),holeLR);return poly;};jsts.geomgraph.EdgeRing.prototype.computeRing=function(){if(this.ring!==null)
return;var coord=[];for(var i=0;i<this.pts.length;i++){coord[i]=this.pts[i];}
this.ring=this.geometryFactory.createLinearRing(coord);this._isHole=jsts.algorithm.CGAlgorithms.isCCW(this.ring.getCoordinates());};jsts.geomgraph.EdgeRing.prototype.getNext=function(de){throw new jsts.error.AbstractInvocationError();};jsts.geomgraph.EdgeRing.prototype.setEdgeRing=function(de,er){throw new jsts.error.AbstractInvocationError();};jsts.geomgraph.EdgeRing.prototype.getEdges=function(){return this.edges;};jsts.geomgraph.EdgeRing.prototype.computePoints=function(start){this.startDe=start;var de=start;var isFirstEdge=true;do{if(de===null)
throw new jsts.error.TopologyError('Found null DirectedEdge');if(de.getEdgeRing()===this)
throw new jsts.error.TopologyError('Directed Edge visited twice during ring-building at '+
de.getCoordinate());this.edges.push(de);var label=de.getLabel();jsts.util.Assert.isTrue(label.isArea());this.mergeLabel(label);this.addPoints(de.getEdge(),de.isForward(),isFirstEdge);isFirstEdge=false;this.setEdgeRing(de,this);de=this.getNext(de);}while(de!==this.startDe);};jsts.geomgraph.EdgeRing.prototype.getMaxNodeDegree=function(){if(this.maxNodeDegree<0)
this.computeMaxNodeDegree();return this.maxNodeDegree;};jsts.geomgraph.EdgeRing.prototype.computeMaxNodeDegree=function(){this.maxNodeDegree=0;var de=this.startDe;do{var node=de.getNode();var degree=node.getEdges().getOutgoingDegree(this);if(degree>this.maxNodeDegree)
this.maxNodeDegree=degree;de=this.getNext(de);}while(de!==this.startDe);this.maxNodeDegree*=2;};jsts.geomgraph.EdgeRing.prototype.setInResult=function(){var de=this.startDe;do{de.getEdge().setInResult(true);de=de.getNext();}while(de!=this.startDe);};jsts.geomgraph.EdgeRing.prototype.mergeLabel=function(deLabel){this.mergeLabel2(deLabel,0);this.mergeLabel2(deLabel,1);};jsts.geomgraph.EdgeRing.prototype.mergeLabel2=function(deLabel,geomIndex){var loc=deLabel.getLocation(geomIndex,jsts.geomgraph.Position.RIGHT);if(loc==jsts.geom.Location.NONE)
return;if(this.label.getLocation(geomIndex)===jsts.geom.Location.NONE){this.label.setLocation(geomIndex,loc);return;}};jsts.geomgraph.EdgeRing.prototype.addPoints=function(edge,isForward,isFirstEdge){var edgePts=edge.getCoordinates();if(isForward){var startIndex=1;if(isFirstEdge)
startIndex=0;for(var i=startIndex;i<edgePts.length;i++){this.pts.push(edgePts[i]);}}else{var startIndex=edgePts.length-2;if(isFirstEdge)
startIndex=edgePts.length-1;for(var i=startIndex;i>=0;i--){this.pts.push(edgePts[i]);}}};jsts.geomgraph.EdgeRing.prototype.containsPoint=function(p){var shell=this.getLinearRing();var env=shell.getEnvelopeInternal();if(!env.contains(p))
return false;if(!jsts.algorithm.CGAlgorithms.isPointInRing(p,shell.getCoordinates()))
return false;for(var i=0;i<this.holes.length;i++){var hole=this.holes[i];if(hole.containsPoint(p))
return false;}
return true;};(function(){jsts.geom.LinearRing=function(points,factory){jsts.geom.LineString.apply(this,arguments);};jsts.geom.LinearRing.prototype=new jsts.geom.LineString();jsts.geom.LinearRing.constructor=jsts.geom.LinearRing;jsts.geom.LinearRing.prototype.getBoundaryDimension=function(){return jsts.geom.Dimension.FALSE;};jsts.geom.LinearRing.prototype.isSimple=function(){return true;};jsts.geom.LinearRing.prototype.getGeometryType=function(){return'LinearRing';};jsts.geom.LinearRing.MINIMUM_VALID_SIZE=4;jsts.geom.LinearRing.prototype.CLASS_NAME='jsts.geom.LinearRing';})();jsts.index.strtree.Boundable=function(){};jsts.index.strtree.Boundable.prototype.getBounds=function(){throw new jsts.error.AbstractMethodInvocationError();};jsts.index.strtree.AbstractNode=function(level){this.level=level;this.childBoundables=[];};jsts.index.strtree.AbstractNode.prototype=new jsts.index.strtree.Boundable();jsts.index.strtree.AbstractNode.constructor=jsts.index.strtree.AbstractNode;jsts.index.strtree.AbstractNode.prototype.childBoundables=null;jsts.index.strtree.AbstractNode.prototype.bounds=null;jsts.index.strtree.AbstractNode.prototype.level=null;jsts.index.strtree.AbstractNode.prototype.getChildBoundables=function(){return this.childBoundables;};jsts.index.strtree.AbstractNode.prototype.computeBounds=function(){throw new jsts.error.AbstractMethodInvocationError();};jsts.index.strtree.AbstractNode.prototype.getBounds=function(){if(this.bounds===null){this.bounds=this.computeBounds();}
return this.bounds;};jsts.index.strtree.AbstractNode.prototype.getLevel=function(){return this.level;};jsts.index.strtree.AbstractNode.prototype.addChildBoundable=function(childBoundable){this.childBoundables.push(childBoundable);};(function(){jsts.noding.Noder=function(){};jsts.noding.Noder.prototype.computeNodes=jsts.abstractFunc;jsts.noding.Noder.prototype.getNodedSubstrings=jsts.abstractFunc;})();(function(){var Noder=jsts.noding.Noder;jsts.noding.SinglePassNoder=function(){};jsts.noding.SinglePassNoder.prototype=new Noder();jsts.noding.SinglePassNoder.constructor=jsts.noding.SinglePassNoder;jsts.noding.SinglePassNoder.prototype.segInt=null;jsts.noding.SinglePassNoder.prototype.setSegmentIntersector=function(segInt){this.segInt=segInt;};})();jsts.index.SpatialIndex=function(){};jsts.index.SpatialIndex.prototype.insert=function(itemEnv,item){throw new jsts.error.AbstractMethodInvocationError();};jsts.index.SpatialIndex.prototype.query=function(searchEnv,visitor){throw new jsts.error.AbstractMethodInvocationError();};jsts.index.SpatialIndex.prototype.remove=function(itemEnv,item){throw new jsts.error.AbstractMethodInvocationError();};jsts.index.strtree.AbstractSTRtree=function(nodeCapacity){if(nodeCapacity===undefined)
return;this.itemBoundables=[];jsts.util.Assert.isTrue(nodeCapacity>1,'Node capacity must be greater than 1');this.nodeCapacity=nodeCapacity;};jsts.index.strtree.AbstractSTRtree.IntersectsOp=function(){};jsts.index.strtree.AbstractSTRtree.IntersectsOp.prototype.intersects=function(aBounds,bBounds){throw new jsts.error.AbstractMethodInvocationError();};jsts.index.strtree.AbstractSTRtree.prototype.root=null;jsts.index.strtree.AbstractSTRtree.prototype.built=false;jsts.index.strtree.AbstractSTRtree.prototype.itemBoundables=null;jsts.index.strtree.AbstractSTRtree.prototype.nodeCapacity=null;jsts.index.strtree.AbstractSTRtree.prototype.build=function(){jsts.util.Assert.isTrue(!this.built);this.root=this.itemBoundables.length===0?this.createNode(0):this.createHigherLevels(this.itemBoundables,-1);this.built=true;};jsts.index.strtree.AbstractSTRtree.prototype.createNode=function(level){throw new jsts.error.AbstractMethodInvocationError();};jsts.index.strtree.AbstractSTRtree.prototype.createParentBoundables=function(childBoundables,newLevel){jsts.util.Assert.isTrue(!(childBoundables.length===0));var parentBoundables=[];parentBoundables.push(this.createNode(newLevel));var sortedChildBoundables=[];for(var i=0;i<childBoundables.length;i++){sortedChildBoundables.push(childBoundables[i]);}
sortedChildBoundables.sort(this.getComparator());for(var i=0;i<sortedChildBoundables.length;i++){var childBoundable=sortedChildBoundables[i];if(this.lastNode(parentBoundables).getChildBoundables().length===this.getNodeCapacity()){parentBoundables.push(this.createNode(newLevel));}
this.lastNode(parentBoundables).addChildBoundable(childBoundable);}
return parentBoundables;};jsts.index.strtree.AbstractSTRtree.prototype.lastNode=function(nodes){return nodes[nodes.length-1];};jsts.index.strtree.AbstractSTRtree.prototype.compareDoubles=function(a,b){return a>b?1:a<b?-1:0;};jsts.index.strtree.AbstractSTRtree.prototype.createHigherLevels=function(boundablesOfALevel,level){jsts.util.Assert.isTrue(!(boundablesOfALevel.length===0));var parentBoundables=this.createParentBoundables(boundablesOfALevel,level+1);if(parentBoundables.length===1){return parentBoundables[0];}
return this.createHigherLevels(parentBoundables,level+1);};jsts.index.strtree.AbstractSTRtree.prototype.getRoot=function(){if(!this.built)
this.build();return this.root;};jsts.index.strtree.AbstractSTRtree.prototype.getNodeCapacity=function(){return this.nodeCapacity;};jsts.index.strtree.AbstractSTRtree.prototype.size=function(){if(arguments.length===1){return this.size2(arguments[0]);}
if(!this.built){this.build();}
if(this.itemBoundables.length===0){return 0;}
return this.size2(root);};jsts.index.strtree.AbstractSTRtree.prototype.size2=function(node){var size=0;var childBoundables=node.getChildBoundables();for(var i=0;i<childBoundables.length;i++){var childBoundable=childBoundables[i];if(childBoundable instanceof jsts.index.strtree.AbstractNode){size+=this.size(childBoundable);}else if(childBoundable instanceof jsts.index.strtree.ItemBoundable){size+=1;}}
return size;};jsts.index.strtree.AbstractSTRtree.prototype.depth=function(){if(arguments.length===1){return this.depth2(arguments[0]);}
if(!this.built){this.build();}
if(this.itemBoundables.length===0){return 0;}
return this.depth2(root);};jsts.index.strtree.AbstractSTRtree.prototype.depth2=function(){var maxChildDepth=0;var childBoundables=node.getChildBoundables();for(var i=0;i<childBoundables.length;i++){var childBoundable=childBoundables[i];if(childBoundable instanceof jsts.index.strtree.AbstractNode){var childDepth=this.depth(childBoundable);if(childDepth>maxChildDepth)
maxChildDepth=childDepth;}}
return maxChildDepth+1;};jsts.index.strtree.AbstractSTRtree.prototype.insert=function(bounds,item){jsts.util.Assert.isTrue(!this.built,'Cannot insert items into an STR packed R-tree after it has been built.');this.itemBoundables.push(new jsts.index.strtree.ItemBoundable(bounds,item));};jsts.index.strtree.AbstractSTRtree.prototype.query=function(searchBounds){if(arguments.length>1){this.query2.apply(this,arguments);}
if(!this.built){this.build();}
var matches=[];if(this.itemBoundables.length===0){jsts.util.Assert.isTrue(this.root.getBounds()===null);return matches;}
if(this.getIntersectsOp().intersects(this.root.getBounds(),searchBounds)){this.query3(searchBounds,this.root,matches);}
return matches;};jsts.index.strtree.AbstractSTRtree.prototype.query2=function(searchBounds,visitor){if(arguments.length>2){this.query3.apply(this,arguments);}
if(!this.built){this.build();}
if(this.itemBoundables.length===0){jsts.util.Assert.isTrue(this.root.getBounds()===null);}
if(this.getIntersectsOp().intersects(this.root.getBounds(),searchBounds)){this.query4(searchBounds,this.root,visitor);}};jsts.index.strtree.AbstractSTRtree.prototype.query3=function(searchBounds,node,matches){if(!(arguments[2]instanceof Array)){this.query4.apply(this,arguments);}
var childBoundables=node.getChildBoundables();for(var i=0;i<childBoundables.length;i++){var childBoundable=childBoundables[i];if(!this.getIntersectsOp().intersects(childBoundable.getBounds(),searchBounds)){continue;}
if(childBoundable instanceof jsts.index.strtree.AbstractNode){this.query3(searchBounds,childBoundable,matches);}else if(childBoundable instanceof jsts.index.strtree.ItemBoundable){matches.push(childBoundable.getItem());}else{jsts.util.Assert.shouldNeverReachHere();}}};jsts.index.strtree.AbstractSTRtree.prototype.query4=function(searchBounds,node,visitor){var childBoundables=node.getChildBoundables();for(var i=0;i<childBoundables.length;i++){var childBoundable=childBoundables[i];if(!this.getIntersectsOp().intersects(childBoundable.getBounds(),searchBounds)){continue;}
if(childBoundable instanceof jsts.index.strtree.AbstractNode){this.query4(searchBounds,childBoundable,visitor);}else if(childBoundable instanceof jsts.index.strtree.ItemBoundable){visitor.visitItem(childBoundable.getItem());}else{jsts.util.Assert.shouldNeverReachHere();}}};jsts.index.strtree.AbstractSTRtree.prototype.getIntersectsOp=function(){throw new jsts.error.AbstractMethodInvocationError();};jsts.index.strtree.AbstractSTRtree.prototype.itemsTree=function(){if(arguments.length===1){return this.itemsTree2.apply(this,arguments);}
if(!this.built){this.build();}
var valuesTree=this.itemsTree2(this.root);if(valuesTree===null)
return[];return valuesTree;};jsts.index.strtree.AbstractSTRtree.prototype.itemsTree2=function(node){var valuesTreeForNode=[];var childBoundables=node.getChildBoundables();for(var i=0;i<childBoundables.length;i++){var childBoundable=childBoundables[i];if(childBoundable instanceof jsts.index.strtree.AbstractNode){var valuesTreeForChild=this.itemsTree(childBoundable);if(valuesTreeForChild!=null)
valuesTreeForNode.push(valuesTreeForChild);}else if(childBoundable instanceof jsts.index.strtree.ItemBoundable){valuesTreeForNode.push(childBoundable.getItem());}else{jsts.util.Assert.shouldNeverReachHere();}}
if(valuesTreeForNode.length<=0)
return null;return valuesTreeForNode;};jsts.index.strtree.AbstractSTRtree.prototype.remove=function(searchBounds,item){if(!this.built){this.build();}
if(this.itemBoundables.length===0){jsts.util.Assert.isTrue(this.root.getBounds()==null);}
if(this.getIntersectsOp().intersects(this.root.getBounds(),searchBounds)){return this.remove2(searchBounds,this.root,item);}
return false;};jsts.index.strtree.AbstractSTRtree.prototype.remove2=function(searchBounds,node,item){var found=this.removeItem(node,item);if(found)
return true;var childToPrune=null;var childBoundables=node.getChildBoundables();for(var i=0;i<childBoundables.length;i++){var childBoundable=childBoundables[i];if(!this.getIntersectsOp().intersects(childBoundable.getBounds(),searchBounds)){continue;}
if(childBoundable instanceof jsts.index.strtree.AbstractNode){found=this.remove(searchBounds,childBoundable,item);if(found){childToPrune=childBoundable;break;}}}
if(childToPrune!=null){if(childToPrune.getChildBoundables().length===0){childBoundables.splice(childBoundables.indexOf(childToPrune),1);}}
return found;};jsts.index.strtree.AbstractSTRtree.prototype.removeItem=function(node,item){var childToRemove=null;var childBoundables=node.getChildBoundables();for(var i=0;i<childBoundables.length;i++){var childBoundable=childBoundables[i];if(childBoundable instanceof jsts.index.strtree.ItemBoundable){if(childBoundable.getItem()===item)
childToRemove=childBoundable;}}
if(childToRemove!==null){childBoundables.splice(childBoundables.indexOf(childToRemove),1);return true;}
return false;};jsts.index.strtree.AbstractSTRtree.prototype.boundablesAtLevel=function(level){if(arguments.length>1){this.boundablesAtLevel2.apply(this,arguments);return;}
var boundables=[];this.boundablesAtLevel2(level,this.root,boundables);return boundables;};jsts.index.strtree.AbstractSTRtree.prototype.boundablesAtLevel2=function(level,top,boundables){jsts.util.Assert.isTrue(level>-2);if(top.getLevel()===level){boundables.add(top);return;}
var childBoundables=node.getChildBoundables();for(var i=0;i<childBoundables.length;i++){var boundable=childBoundables[i];if(boundable instanceof jsts.index.strtree.AbstractNode){this.boundablesAtLevel(level,boundable,boundables);}else{jsts.util.Assert.isTrue(boundable instanceof jsts.index.strtree.ItemBoundable);if(level===-1){boundables.add(boundable);}}}
return;};jsts.index.strtree.AbstractSTRtree.prototype.getComparator=function(){throw new jsts.error.AbstractMethodInvocationError();};jsts.index.strtree.STRtree=function(nodeCapacity){nodeCapacity=nodeCapacity||jsts.index.strtree.STRtree.DEFAULT_NODE_CAPACITY;jsts.index.strtree.AbstractSTRtree.call(this,nodeCapacity);};jsts.index.strtree.STRtree.prototype=new jsts.index.strtree.AbstractSTRtree();jsts.index.strtree.STRtree.constructor=jsts.index.strtree.STRtree;jsts.index.strtree.STRtree.prototype.xComparator=function(o1,o2){return jsts.index.strtree.AbstractSTRtree.prototype.compareDoubles(jsts.index.strtree.STRtree.prototype.centreX(o1.getBounds()),jsts.index.strtree.STRtree.prototype.centreX(o2.getBounds()));};jsts.index.strtree.STRtree.prototype.yComparator=function(o1,o2){return jsts.index.strtree.AbstractSTRtree.prototype.compareDoubles(jsts.index.strtree.STRtree.prototype.centreY(o1.getBounds()),jsts.index.strtree.STRtree.prototype.centreY(o2.getBounds()));};jsts.index.strtree.STRtree.prototype.centreX=function(e){return jsts.index.strtree.STRtree.prototype.avg(e.getMinX(),e.getMaxX());};jsts.index.strtree.STRtree.prototype.centreY=function(e){return jsts.index.strtree.STRtree.prototype.avg(e.getMinY(),e.getMaxY());};jsts.index.strtree.STRtree.prototype.avg=function(a,b){return(a+b)/2.0;};jsts.index.strtree.STRtree.prototype.intersectsOp={intersects:function(aBounds,bBounds){return aBounds.intersects(bBounds);}};jsts.index.strtree.STRtree.prototype.createParentBoundables=function(childBoundables,newLevel){jsts.util.Assert.isTrue(!(childBoundables.length===0));var minLeafCount=Math.ceil(childBoundables.length/this.getNodeCapacity());var sortedChildBoundables=[];for(var i=0;i<childBoundables.length;i++){sortedChildBoundables.push(childBoundables[i]);}
sortedChildBoundables.sort(this.xComparator);var verticalSlices=this.verticalSlices(sortedChildBoundables,Math.ceil(Math.sqrt(minLeafCount)));return this.createParentBoundablesFromVerticalSlices(verticalSlices,newLevel);};jsts.index.strtree.STRtree.prototype.createParentBoundablesFromVerticalSlices=function(verticalSlices,newLevel){jsts.util.Assert.isTrue(verticalSlices.length>0);var parentBoundables=[];for(var i=0;i<verticalSlices.length;i++){parentBoundables=parentBoundables.concat(this.createParentBoundablesFromVerticalSlice(verticalSlices[i],newLevel));}
return parentBoundables;};jsts.index.strtree.STRtree.prototype.createParentBoundablesFromVerticalSlice=function(childBoundables,newLevel){return jsts.index.strtree.AbstractSTRtree.prototype.createParentBoundables.call(this,childBoundables,newLevel);};jsts.index.strtree.STRtree.prototype.verticalSlices=function(childBoundables,sliceCount){var sliceCapacity=Math.ceil(childBoundables.length/sliceCount);var slices=[];var i=0,boundablesAddedToSlice,childBoundable;for(var j=0;j<sliceCount;j++){slices[j]=[];boundablesAddedToSlice=0;while(i<childBoundables.length&&boundablesAddedToSlice<sliceCapacity){childBoundable=childBoundables[i++];slices[j].push(childBoundable);boundablesAddedToSlice++;}}
return slices;};jsts.index.strtree.STRtree.DEFAULT_NODE_CAPACITY=10;jsts.index.strtree.STRtree.prototype.createNode=function(level){var abstractNode=new jsts.index.strtree.AbstractNode(level);abstractNode.computeBounds=function(){var bounds=null;var childBoundables=this.getChildBoundables();for(var i=0;i<childBoundables.length;i++){var childBoundable=childBoundables[i];if(bounds===null){bounds=new jsts.geom.Envelope(childBoundable.getBounds());}else{bounds.expandToInclude(childBoundable.getBounds());}}
return bounds;};return abstractNode;};jsts.index.strtree.STRtree.prototype.getIntersectsOp=function(){return this.intersectsOp;};jsts.index.strtree.STRtree.prototype.insert=function(itemEnv,item){if(itemEnv.isNull()){return;}
jsts.index.strtree.AbstractSTRtree.prototype.insert.call(this,itemEnv,item);};jsts.index.strtree.STRtree.prototype.query=function(searchEnv,visitor){return jsts.index.strtree.AbstractSTRtree.prototype.query.apply(this,arguments);};jsts.index.strtree.STRtree.prototype.remove=function(itemEnv,item){return jsts.index.strtree.AbstractSTRtree.prototype.remove.call(this,itemEnv,item);};jsts.index.strtree.STRtree.prototype.size=function(){return jsts.index.strtree.AbstractSTRtree.prototype.size.call(this);};jsts.index.strtree.STRtree.prototype.depth=function(){return jsts.index.strtree.AbstractSTRtree.prototype.depth.call(this);};jsts.index.strtree.STRtree.prototype.getComparator=function(){return this.yComparator;};jsts.index.strtree.STRtree.prototype.nearestNeighbour=function(itemDist){var bp=new jsts.index.strtree.BoundablePair(this.getRoot(),this.getRoot(),itemDist);return this.nearestNeighbour4(bp);};jsts.index.strtree.STRtree.prototype.nearestNeighbour2=function(env,item,itemDist){var bnd=new jsts.index.strtree.ItemBoundable(env,item);var bp=new jsts.index.strtree.BoundablePair(this.getRoot(),bnd,itemDist);return this.nearestNeighbour4(bp)[0];};jsts.index.strtree.STRtree.prototype.nearestNeighbour3=function(tree,itemDist){var bp=new jsts.index.strtree.BoundablePair(this.getRoot(),tree.getRoot(),itemDist);return this.nearestNeighbour4(bp);};jsts.index.strtree.STRtree.prototype.nearestNeighbour4=function(initBndPair){return this.nearestNeighbour5(initBndPair,Double.POSITIVE_INFINITY);};jsts.index.strtree.STRtree.prototype.nearestNeighbour5=function(initBndPair,maxDistance){var distanceLowerBound=maxDistance;var minPair=null;var priQ=[];priQ.push(initBndPair);while(!priQ.isEmpty()&&distanceLowerBound>0.0){var bndPair=priQ.pop();var currentDistance=bndPair.getDistance();if(currentDistance>=distanceLowerBound)
break;if(bndPair.isLeaves()){distanceLowerBound=currentDistance;minPair=bndPair;}else{bndPair.expandToQueue(priQ,distanceLowerBound);}}
return[minPair.getBoundable(0).getItem(),minPair.getBoundable(1).getItem()];};jsts.noding.SegmentString=function(){};jsts.noding.SegmentString.prototype.getData=jsts.abstractFunc;jsts.noding.SegmentString.prototype.setData=jsts.abstractFunc;jsts.noding.SegmentString.prototype.size=jsts.abstractFunc;jsts.noding.SegmentString.prototype.getCoordinate=jsts.abstractFunc;jsts.noding.SegmentString.prototype.getCoordinates=jsts.abstractFunc;jsts.noding.SegmentString.prototype.isClosed=jsts.abstractFunc;jsts.noding.NodableSegmentString=function(){};jsts.noding.NodableSegmentString.prototype=new jsts.noding.SegmentString();jsts.noding.NodableSegmentString.prototype.addIntersection=jsts.abstractFunc;jsts.noding.NodedSegmentString=function(pts,data){this.nodeList=new jsts.noding.SegmentNodeList(this);this.pts=pts;this.data=data;};jsts.noding.NodedSegmentString.prototype=new jsts.noding.NodableSegmentString();jsts.noding.NodedSegmentString.constructor=jsts.noding.NodedSegmentString;jsts.noding.NodedSegmentString.getNodedSubstrings=function(segStrings){if(arguments.length===2){jsts.noding.NodedSegmentString.getNodedSubstrings2.apply(this,arguments);return;}
var resultEdgelist=new javascript.util.ArrayList();jsts.noding.NodedSegmentString.getNodedSubstrings2(segStrings,resultEdgelist);return resultEdgelist;};jsts.noding.NodedSegmentString.getNodedSubstrings2=function(segStrings,resultEdgelist){for(var i=segStrings.iterator();i.hasNext();){var ss=i.next();ss.getNodeList().addSplitEdges(resultEdgelist);}};jsts.noding.NodedSegmentString.prototype.nodeList=null;jsts.noding.NodedSegmentString.prototype.pts=null;jsts.noding.NodedSegmentString.prototype.data=null;jsts.noding.NodedSegmentString.prototype.getData=function(){return this.data;};jsts.noding.NodedSegmentString.prototype.setData=function(data){this.data=data;};jsts.noding.NodedSegmentString.prototype.getNodeList=function(){return this.nodeList;};jsts.noding.NodedSegmentString.prototype.size=function(){return this.pts.length;};jsts.noding.NodedSegmentString.prototype.getCoordinate=function(i){return this.pts[i];};jsts.noding.NodedSegmentString.prototype.getCoordinates=function(){return this.pts;};jsts.noding.NodedSegmentString.prototype.isClosed=function(){return this.pts[0].equals(this.pts[this.pts.length-1]);};jsts.noding.NodedSegmentString.prototype.getSegmentOctant=function(index){if(index===this.pts.length-1)
return-1;return this.safeOctant(this.getCoordinate(index),this.getCoordinate(index+1));};jsts.noding.NodedSegmentString.prototype.safeOctant=function(p0,p1){if(p0.equals2D(p1))
return 0;return jsts.noding.Octant.octant(p0,p1);};jsts.noding.NodedSegmentString.prototype.addIntersections=function(li,segmentIndex,geomIndex){for(var i=0;i<li.getIntersectionNum();i++){this.addIntersection(li,segmentIndex,geomIndex,i);}};jsts.noding.NodedSegmentString.prototype.addIntersection=function(li,segmentIndex,geomIndex,intIndex){if(li instanceof jsts.geom.Coordinate){this.addIntersection2.apply(this,arguments);return;}
var intPt=new jsts.geom.Coordinate(li.getIntersection(intIndex));this.addIntersection2(intPt,segmentIndex);};jsts.noding.NodedSegmentString.prototype.addIntersection2=function(intPt,segmentIndex){this.addIntersectionNode(intPt,segmentIndex);};jsts.noding.NodedSegmentString.prototype.addIntersectionNode=function(intPt,segmentIndex){var normalizedSegmentIndex=segmentIndex;var nextSegIndex=normalizedSegmentIndex+1;if(nextSegIndex<this.pts.length){var nextPt=this.pts[nextSegIndex];if(intPt.equals2D(nextPt)){normalizedSegmentIndex=nextSegIndex;}}
var ei=this.nodeList.add(intPt,normalizedSegmentIndex);return ei;};jsts.noding.NodedSegmentString.prototype.toString=function(){var geometryFactory=new jsts.geom.GeometryFactory();return new jsts.io.WKTWriter().write(geometryFactory.createLineString(this.pts));};jsts.index.chain.MonotoneChainBuilder=function(){};jsts.index.chain.MonotoneChainBuilder.toIntArray=function(list){var array=[];for(var i=0;i<list.length;i++){array[i]=list[i];}
return array;};jsts.index.chain.MonotoneChainBuilder.getChains=function(pts){if(arguments.length===2){return jsts.index.chain.MonotoneChainBuilder.getChains2.apply(this,arguments);}
return jsts.index.chain.MonotoneChainBuilder.getChains2(pts,null);};jsts.index.chain.MonotoneChainBuilder.getChains2=function(pts,context){var mcList=[];var startIndex=jsts.index.chain.MonotoneChainBuilder.getChainStartIndices(pts);for(var i=0;i<startIndex.length-1;i++){var mc=new jsts.index.chain.MonotoneChain(pts,startIndex[i],startIndex[i+1],context);mcList.push(mc);}
return mcList;};jsts.index.chain.MonotoneChainBuilder.getChainStartIndices=function(pts){var start=0;var startIndexList=[];startIndexList.push(start);do{var last=jsts.index.chain.MonotoneChainBuilder.findChainEnd(pts,start);startIndexList.push(last);start=last;}while(start<pts.length-1);var startIndex=jsts.index.chain.MonotoneChainBuilder.toIntArray(startIndexList);return startIndex;};jsts.index.chain.MonotoneChainBuilder.findChainEnd=function(pts,start){var safeStart=start;while(safeStart<pts.length-1&&pts[safeStart].equals2D(pts[safeStart+1])){safeStart++;}
if(safeStart>=pts.length-1){return pts.length-1;}
var chainQuad=jsts.geomgraph.Quadrant.quadrant(pts[safeStart],pts[safeStart+1]);var last=start+1;while(last<pts.length){if(!pts[last-1].equals2D(pts[last])){var quad=jsts.geomgraph.Quadrant.quadrant(pts[last-1],pts[last]);if(quad!==chainQuad)
break;}
last++;}
return last-1;};jsts.algorithm.LineIntersector=function(){this.inputLines=[[],[]];this.intPt=[null,null];this.pa=this.intPt[0];this.pb=this.intPt[1];this.result=jsts.algorithm.LineIntersector.NO_INTERSECTION;};jsts.algorithm.LineIntersector.NO_INTERSECTION=0;jsts.algorithm.LineIntersector.POINT_INTERSECTION=1;jsts.algorithm.LineIntersector.COLLINEAR_INTERSECTION=2;jsts.algorithm.LineIntersector.prototype.setPrecisionModel=function(precisionModel){this.precisionModel=precisionModel;};jsts.algorithm.LineIntersector.prototype.getEndpoint=function(segmentIndex,ptIndex){return this.inputLines[segmentIndex][ptIndex];};jsts.algorithm.LineIntersector.computeEdgeDistance=function(p,p0,p1){var dx=Math.abs(p1.x-p0.x);var dy=Math.abs(p1.y-p0.y);var dist=-1.0;if(p.equals(p0)){dist=0.0;}else if(p.equals(p1)){if(dx>dy){dist=dx;}else{dist=dy;}}else{var pdx=Math.abs(p.x-p0.x);var pdy=Math.abs(p.y-p0.y);if(dx>dy){dist=pdx;}else{dist=pdy;}
if(dist===0.0&&!p.equals(p0)){dist=Math.max(pdx,pdy);}}
if(dist===0.0&&!p.equals(p0)){throw new jsts.error.IllegalArgumentError('Bad distance calculation');}
return dist;};jsts.algorithm.LineIntersector.nonRobustComputeEdgeDistance=function(p,p1,p2){var dx=p.x-p1.x;var dy=p.y-p1.y;var dist=Math.sqrt(dx*dx+dy*dy);if(!(dist===0.0&&!p.equals(p1))){throw new jsts.error.IllegalArgumentError('Invalid distance calculation');}
return dist;};jsts.algorithm.LineIntersector.prototype.result=null;jsts.algorithm.LineIntersector.prototype.inputLines=null;jsts.algorithm.LineIntersector.prototype.intPt=null;jsts.algorithm.LineIntersector.prototype.intLineIndex=null;jsts.algorithm.LineIntersector.prototype._isProper=null;jsts.algorithm.LineIntersector.prototype.pa=null;jsts.algorithm.LineIntersector.prototype.pb=null;jsts.algorithm.LineIntersector.prototype.precisionModel=null;jsts.algorithm.LineIntersector.prototype.computeIntersection=function(p,p1,p2){throw new jsts.error.AbstractMethodInvocationError();};jsts.algorithm.LineIntersector.prototype.isCollinear=function(){return this.result===jsts.algorithm.LineIntersector.COLLINEAR_INTERSECTION;};jsts.algorithm.LineIntersector.prototype.computeIntersection=function(p1,p2,p3,p4){this.inputLines[0][0]=p1;this.inputLines[0][1]=p2;this.inputLines[1][0]=p3;this.inputLines[1][1]=p4;this.result=this.computeIntersect(p1,p2,p3,p4);};jsts.algorithm.LineIntersector.prototype.computeIntersect=function(p1,p2,q1,q2){throw new jsts.error.AbstractMethodInvocationError();};jsts.algorithm.LineIntersector.prototype.isEndPoint=function(){return this.hasIntersection()&&!this._isProper;};jsts.algorithm.LineIntersector.prototype.hasIntersection=function(){return this.result!==jsts.algorithm.LineIntersector.NO_INTERSECTION;};jsts.algorithm.LineIntersector.prototype.getIntersectionNum=function(){return this.result;};jsts.algorithm.LineIntersector.prototype.getIntersection=function(intIndex){return this.intPt[intIndex];};jsts.algorithm.LineIntersector.prototype.computeIntLineIndex=function(){if(this.intLineIndex===null){this.intLineIndex=[[],[]];this.computeIntLineIndex(0);this.computeIntLineIndex(1);}};jsts.algorithm.LineIntersector.prototype.isIntersection=function(pt){var i;for(i=0;i<this.result;i++){if(this.intPt[i].equals2D(pt)){return true;}}
return false;};jsts.algorithm.LineIntersector.prototype.isInteriorIntersection=function(){if(arguments.length===1){return this.isInteriorIntersection2.apply(this,arguments);}
if(this.isInteriorIntersection(0)){return true;}
if(this.isInteriorIntersection(1)){return true;}
return false;};jsts.algorithm.LineIntersector.prototype.isInteriorIntersection2=function(inputLineIndex){var i;for(i=0;i<this.result;i++){if(!(this.intPt[i].equals2D(this.inputLines[inputLineIndex][0])||this.intPt[i].equals2D(this.inputLines[inputLineIndex][1]))){return true;}}
return false;};jsts.algorithm.LineIntersector.prototype.isProper=function(){return this.hasIntersection()&&this._isProper;};jsts.algorithm.LineIntersector.prototype.getIntersectionAlongSegment=function(segmentIndex,intIndex){this.computeIntLineIndex();return this.intPt[intLineIndex[segmentIndex][intIndex]];};jsts.algorithm.LineIntersector.prototype.getIndexAlongSegment=function(segmentIndex,intIndex){this.computeIntLineIndex();return this.intLineIndex[segmentIndex][intIndex];};jsts.algorithm.LineIntersector.prototype.computeIntLineIndex=function(segmentIndex){var dist0=this.getEdgeDistance(segmentIndex,0);var dist1=this.getEdgeDistance(segmentIndex,1);if(dist0>dist1){this.intLineIndex[segmentIndex][0]=0;this.intLineIndex[segmentIndex][1]=1;}else{this.intLineIndex[segmentIndex][0]=1;this.intLineIndex[segmentIndex][1]=0;}};jsts.algorithm.LineIntersector.prototype.getEdgeDistance=function(segmentIndex,intIndex){var dist=jsts.algorithm.LineIntersector.computeEdgeDistance(this.intPt[intIndex],this.inputLines[segmentIndex][0],this.inputLines[segmentIndex][1]);return dist;};jsts.algorithm.RobustLineIntersector=function(){jsts.algorithm.RobustLineIntersector.prototype.constructor.call(this);};jsts.algorithm.RobustLineIntersector.prototype=new jsts.algorithm.LineIntersector();jsts.algorithm.RobustLineIntersector.prototype.computeIntersection=function(p,p1,p2){if(arguments.length===4){jsts.algorithm.LineIntersector.prototype.computeIntersection.apply(this,arguments);return;}
this._isProper=false;if(jsts.geom.Envelope.intersects(p1,p2,p)){if((jsts.algorithm.CGAlgorithms.orientationIndex(p1,p2,p)===0)&&(jsts.algorithm.CGAlgorithms.orientationIndex(p2,p1,p)===0)){this._isProper=true;if(p.equals(p1)||p.equals(p2)){this._isProper=false;}
this.result=jsts.algorithm.LineIntersector.POINT_INTERSECTION;return;}}
this.result=jsts.algorithm.LineIntersector.NO_INTERSECTION;};jsts.algorithm.RobustLineIntersector.prototype.computeIntersect=function(p1,p2,q1,q2){this._isProper=false;if(!jsts.geom.Envelope.intersects(p1,p2,q1,q2)){return jsts.algorithm.LineIntersector.NO_INTERSECTION;}
var Pq1=jsts.algorithm.CGAlgorithms.orientationIndex(p1,p2,q1);var Pq2=jsts.algorithm.CGAlgorithms.orientationIndex(p1,p2,q2);if((Pq1>0&&Pq2>0)||(Pq1<0&&Pq2<0)){return jsts.algorithm.LineIntersector.NO_INTERSECTION;}
var Qp1=jsts.algorithm.CGAlgorithms.orientationIndex(q1,q2,p1);var Qp2=jsts.algorithm.CGAlgorithms.orientationIndex(q1,q2,p2);if((Qp1>0&&Qp2>0)||(Qp1<0&&Qp2<0)){return jsts.algorithm.LineIntersector.NO_INTERSECTION;}
var collinear=Pq1===0&&Pq2===0&&Qp1===0&&Qp2===0;if(collinear){return this.computeCollinearIntersection(p1,p2,q1,q2);}
if(Pq1===0||Pq2===0||Qp1===0||Qp2===0){this._isProper=false;if(p1.equals2D(q1)||p1.equals2D(q2)){this.intPt[0]=p1;}else if(p2.equals2D(q1)||p2.equals2D(q2)){this.intPt[0]=p2;}
else if(Pq1===0){this.intPt[0]=new jsts.geom.Coordinate(q1);}else if(Pq2===0){this.intPt[0]=new jsts.geom.Coordinate(q2);}else if(Qp1===0){this.intPt[0]=new jsts.geom.Coordinate(p1);}else if(Qp2===0){this.intPt[0]=new jsts.geom.Coordinate(p2);}}else{this._isProper=true;this.intPt[0]=this.intersection(p1,p2,q1,q2);}
return jsts.algorithm.LineIntersector.POINT_INTERSECTION;};jsts.algorithm.RobustLineIntersector.prototype.computeCollinearIntersection=function(p1,p2,q1,q2){var p1q1p2=jsts.geom.Envelope.intersects(p1,p2,q1);var p1q2p2=jsts.geom.Envelope.intersects(p1,p2,q2);var q1p1q2=jsts.geom.Envelope.intersects(q1,q2,p1);var q1p2q2=jsts.geom.Envelope.intersects(q1,q2,p2);if(p1q1p2&&p1q2p2){this.intPt[0]=q1;this.intPt[1]=q2;return jsts.algorithm.LineIntersector.COLLINEAR_INTERSECTION;}
if(q1p1q2&&q1p2q2){this.intPt[0]=p1;this.intPt[1]=p2;return jsts.algorithm.LineIntersector.COLLINEAR_INTERSECTION;}
if(p1q1p2&&q1p1q2){this.intPt[0]=q1;this.intPt[1]=p1;return q1.equals(p1)&&!p1q2p2&&!q1p2q2?jsts.algorithm.LineIntersector.POINT_INTERSECTION:jsts.algorithm.LineIntersector.COLLINEAR_INTERSECTION;}
if(p1q1p2&&q1p2q2){this.intPt[0]=q1;this.intPt[1]=p2;return q1.equals(p2)&&!p1q2p2&&!q1p1q2?jsts.algorithm.LineIntersector.POINT_INTERSECTION:jsts.algorithm.LineIntersector.COLLINEAR_INTERSECTION;}
if(p1q2p2&&q1p1q2){this.intPt[0]=q2;this.intPt[1]=p1;return q2.equals(p1)&&!p1q1p2&&!q1p2q2?jsts.algorithm.LineIntersector.POINT_INTERSECTION:jsts.algorithm.LineIntersector.COLLINEAR_INTERSECTION;}
if(p1q2p2&&q1p2q2){this.intPt[0]=q2;this.intPt[1]=p2;return q2.equals(p2)&&!p1q1p2&&!q1p1q2?jsts.algorithm.LineIntersector.POINT_INTERSECTION:jsts.algorithm.LineIntersector.COLLINEAR_INTERSECTION;}
return jsts.algorithm.LineIntersector.NO_INTERSECTION;};jsts.algorithm.RobustLineIntersector.prototype.intersection=function(p1,p2,q1,q2){var intPt=this.intersectionWithNormalization(p1,p2,q1,q2);if(!this.isInSegmentEnvelopes(intPt)){intPt=jsts.algorithm.CentralEndpointIntersector.getIntersection(p1,p2,q1,q2);}
if(this.precisionModel!==null){this.precisionModel.makePrecise(intPt);}
return intPt;};jsts.algorithm.RobustLineIntersector.prototype.intersectionWithNormalization=function(p1,p2,q1,q2){var n1=new jsts.geom.Coordinate(p1);var n2=new jsts.geom.Coordinate(p2);var n3=new jsts.geom.Coordinate(q1);var n4=new jsts.geom.Coordinate(q2);var normPt=new jsts.geom.Coordinate();this.normalizeToEnvCentre(n1,n2,n3,n4,normPt);var intPt=this.safeHCoordinateIntersection(n1,n2,n3,n4);intPt.x+=normPt.x;intPt.y+=normPt.y;return intPt;};jsts.algorithm.RobustLineIntersector.prototype.safeHCoordinateIntersection=function(p1,p2,q1,q2){var intPt=null;try{intPt=jsts.algorithm.HCoordinate.intersection(p1,p2,q1,q2);}catch(e){if(e instanceof jsts.error.NotRepresentableError){intPt=jsts.algorithm.CentralEndpointIntersector.getIntersection(p1,p2,q1,q2);}else{throw e;}}
return intPt;};jsts.algorithm.RobustLineIntersector.prototype.normalizeToMinimum=function(n1,n2,n3,n4,normPt){normPt.x=this.smallestInAbsValue(n1.x,n2.x,n3.x,n4.x);normPt.y=this.smallestInAbsValue(n1.y,n2.y,n3.y,n4.y);n1.x-=normPt.x;n1.y-=normPt.y;n2.x-=normPt.x;n2.y-=normPt.y;n3.x-=normPt.x;n3.y-=normPt.y;n4.x-=normPt.x;n4.y-=normPt.y;};jsts.algorithm.RobustLineIntersector.prototype.normalizeToEnvCentre=function(n00,n01,n10,n11,normPt){var minX0=n00.x<n01.x?n00.x:n01.x;var minY0=n00.y<n01.y?n00.y:n01.y;var maxX0=n00.x>n01.x?n00.x:n01.x;var maxY0=n00.y>n01.y?n00.y:n01.y;var minX1=n10.x<n11.x?n10.x:n11.x;var minY1=n10.y<n11.y?n10.y:n11.y;var maxX1=n10.x>n11.x?n10.x:n11.x;var maxY1=n10.y>n11.y?n10.y:n11.y;var intMinX=minX0>minX1?minX0:minX1;var intMaxX=maxX0<maxX1?maxX0:maxX1;var intMinY=minY0>minY1?minY0:minY1;var intMaxY=maxY0<maxY1?maxY0:maxY1;var intMidX=(intMinX+intMaxX)/2.0;var intMidY=(intMinY+intMaxY)/2.0;normPt.x=intMidX;normPt.y=intMidY;n00.x-=normPt.x;n00.y-=normPt.y;n01.x-=normPt.x;n01.y-=normPt.y;n10.x-=normPt.x;n10.y-=normPt.y;n11.x-=normPt.x;n11.y-=normPt.y;};jsts.algorithm.RobustLineIntersector.prototype.smallestInAbsValue=function(x1,x2,x3,x4){var x=x1;var xabs=Math.abs(x);if(Math.abs(x2)<xabs){x=x2;xabs=Math.abs(x2);}
if(Math.abs(x3)<xabs){x=x3;xabs=Math.abs(x3);}
if(Math.abs(x4)<xabs){x=x4;}
return x;};jsts.algorithm.RobustLineIntersector.prototype.isInSegmentEnvelopes=function(intPt){var env0=new jsts.geom.Envelope(this.inputLines[0][0],this.inputLines[0][1]);var env1=new jsts.geom.Envelope(this.inputLines[1][0],this.inputLines[1][1]);return env0.contains(intPt)&&env1.contains(intPt);};jsts.algorithm.HCoordinate=function(){this.x=0.0;this.y=0.0;this.w=1.0;if(arguments.length===1){this.initFrom1Coordinate(arguments[0]);}else if(arguments.length===2&&arguments[0]instanceof jsts.geom.Coordinate){this.initFrom2Coordinates(arguments[0],arguments[1]);}else if(arguments.length===2&&arguments[0]instanceof jsts.algorithm.HCoordinate){this.initFrom2HCoordinates(arguments[0],arguments[1]);}else if(arguments.length===2){this.initFromXY(arguments[0],arguments[1]);}else if(arguments.length===3){this.initFromXYW(arguments[0],arguments[1],arguments[2]);}else if(arguments.length===4){this.initFromXYW(arguments[0],arguments[1],arguments[2],arguments[3]);}};jsts.algorithm.HCoordinate.intersection=function(p1,p2,q1,q2){var px,py,pw,qx,qy,qw,x,y,w,xInt,yInt;px=p1.y-p2.y;py=p2.x-p1.x;pw=p1.x*p2.y-p2.x*p1.y;qx=q1.y-q2.y;qy=q2.x-q1.x;qw=q1.x*q2.y-q2.x*q1.y;x=py*qw-qy*pw;y=qx*pw-px*qw;w=px*qy-qx*py;xInt=x/w;yInt=y/w;if(!isFinite(xInt)||!isFinite(yInt)){throw new jsts.error.NotRepresentableError();}
return new jsts.geom.Coordinate(xInt,yInt);};jsts.algorithm.HCoordinate.prototype.initFrom1Coordinate=function(p){this.x=p.x;this.y=p.y;this.w=1.0;};jsts.algorithm.HCoordinate.prototype.initFrom2Coordinates=function(p1,p2){this.x=p1.y-p2.y;this.y=p2.x-p1.x;this.w=p1.x*p2.y-p2.x*p1.y;};jsts.algorithm.HCoordinate.prototype.initFrom2HCoordinates=function(p1,p2){this.x=p1.y*p2.w-p2.y*p1.w;this.y=p2.x*p1.w-p1.x*p2.w;this.w=p1.x*p2.y-p2.x*p1.y;};jsts.algorithm.HCoordinate.prototype.initFromXYW=function(x,y,w){this.x=x;this.y=y;this.w=w;};jsts.algorithm.HCoordinate.prototype.initFromXY=function(x,y){this.x=x;this.y=y;this.w=1.0;};jsts.algorithm.HCoordinate.prototype.initFrom4Coordinates=function(p1,p2,q1,q2){var px,py,pw,qx,qy,qw;px=p1.y-p2.y;py=p2.x-p1.x;pw=p1.x*p2.y-p2.x*p1.y;qx=q1.y-q2.y;qy=q2.x-q1.x;qw=q1.x*q2.y-q2.x*q1.y;this.x=py*qw-qy*pw;this.y=qx*pw-px*qw;this.w=px*qy-qx*py;};jsts.algorithm.HCoordinate.prototype.getX=function(){var a=this.x/this.w;if(!isFinite(a)){throw new jsts.error.NotRepresentableError();}
return a;};jsts.algorithm.HCoordinate.prototype.getY=function(){var a=this.y/this.w;if(!isFinite(a)){throw new jsts.error.NotRepresentableError();}
return a;};jsts.algorithm.HCoordinate.prototype.getCoordinate=function(){var p=new jsts.geom.Coordinate();p.x=this.getX();p.y=this.getY();return p;};jsts.geom.LineSegment=function(){if(arguments.length===0){this.p0=new jsts.geom.Coordinate();this.p1=new jsts.geom.Coordinate();}else if(arguments.length===1){this.p0=arguments[0].p0;this.p1=arguments[0].p1;}else if(arguments.length===2){this.p0=arguments[0];this.p1=arguments[1];}else if(arguments.length===4){this.p0=new jsts.geom.Coordinate(arguments[0],arguments[1]);this.p1=new jsts.geom.Coordinate(arguments[2],arguments[3]);}};jsts.geom.LineSegment.prototype.p0=null;jsts.geom.LineSegment.prototype.p1=null;jsts.geom.LineSegment.midPoint=function(p0,p1){return new jsts.geom.Coordinate((p0.x+p1.x)/2,(p0.y+p1.y)/2);};jsts.geom.LineSegment.prototype.getCoordinate=function(i){if(i===0)return this.p0;return this.p1;};jsts.geom.LineSegment.prototype.getLength=function(){return this.p0.distance(this.p1);};jsts.geom.LineSegment.prototype.isHorizontal=function(){return this.p0.y===this.p1.y;};jsts.geom.LineSegment.prototype.isVertical=function(){return this.p0.x===this.p1.x;};jsts.geom.LineSegment.prototype.orientationIndex=function(arg){if(arg instanceof jsts.geom.LineSegment){return this.orientationIndex1(arg);}else if(arg instanceof jsts.geom.Coordinate){return this.orientationIndex2(arg);}};jsts.geom.LineSegment.prototype.orientationIndex1=function(seg){var orient0=jsts.algorithm.CGAlgorithms.orientationIndex(this.p0,this.p1,seg.p0);var orient1=jsts.algorithm.CGAlgorithms.orientationIndex(this.p0,this.p1,seg.p1);if(orient0>=0&&orient1>=0){return Math.max(orient0,orient1);}
if(orient0<=0&&orient1<=0){return Math.max(orient0,orient1);}
return 0;};jsts.geom.LineSegment.prototype.orientationIndex2=function(p){return jsts.algorithm.CGAlgorithms.orientationIndex(this.p0,this.p1,p);};jsts.geom.LineSegment.prototype.reverse=function(){var temp=this.p0;this.p0=this.p1;this.p1=temp;};jsts.geom.LineSegment.prototype.normalize=function(){if(this.p1.compareTo(this.p0)<0)this.reverse();};jsts.geom.LineSegment.prototype.angle=function(){return Math.atan2(this.p1.y-this.p0.y,this.p1.x-this.p0.x);};jsts.geom.LineSegment.prototype.midPoint=function(){return jsts.geom.LineSegment.midPoint(this.p0,this.p1);};jsts.geom.LineSegment.prototype.distance=function(arg){if(arg instanceof jsts.geom.LineSegment){return this.distance1(arg);}else if(arg instanceof jsts.geom.Coordinate){return this.distance2(arg);}};jsts.geom.LineSegment.prototype.distance1=function(ls){return jsts.algorithm.CGAlgorithms.distanceLineLine(this.p0,this.p1,ls.p0,ls.p1);};jsts.geom.LineSegment.prototype.distance2=function(p){return jsts.algorithm.CGAlgorithms.distancePointLine(p,this.p0,this.p1);};jsts.geom.LineSegment.prototype.pointAlong=function(segmentLengthFraction){var coord=new jsts.geom.Coordinate();coord.x=this.p0.x+segmentLengthFraction*(this.p1.x-this.p0.x);coord.y=this.p0.y+segmentLengthFraction*(this.p1.y-this.p0.y);return coord;};jsts.geom.LineSegment.prototype.pointAlongOffset=function(segmentLengthFraction,offsetDistance){var segx=this.p0.x+segmentLengthFraction*(this.p1.x-this.p0.x);var segy=this.p0.y+segmentLengthFraction*(this.p1.y-this.p0.y);var dx=this.p1.x-this.p0.x;var dy=this.p1.y-this.p0.y;var len=Math.sqrt(dx*dx+dy*dy);var ux=0;var uy=0;if(offsetDistance!==0){if(len<=0){throw"Cannot compute offset from zero-length line segment";}
ux=offsetDistance*dx/len;uy=offsetDistance*dy/len;}
var offsetx=segx-uy;var offsety=segy+ux;var coord=new jsts.geom.Coordinate(offsetx,offsety);return coord;};jsts.geom.LineSegment.prototype.projectionFactor=function(p){if(p.equals(this.p0))
return 0.0;if(p.equals(this.p1))
return 1.0;var dx=this.p1.x-this.p0.x;var dy=this.p1.y-this.p0.y;var len2=dx*dx+dy*dy;var r=((p.x-this.p0.x)*dx+(p.y-this.p0.y)*dy)/len2;return r;};jsts.geom.LineSegment.prototype.segmentFraction=function(inputPt){var segFrac=this.projectionFactor(inputPt);if(segFrac<0){segFrac=0;}else if(segFrac>1||isNaN(segFrac)){segFrac=1;}
return segFrac;};jsts.geom.LineSegment.prototype.project=function(arg){if(arg instanceof jsts.geom.Coordinate){return this.project1(arg);}else if(arg instanceof jsts.geom.LineSegment){return this.project2(arg);}};jsts.geom.LineSegment.prototype.project1=function(p){if(p.equals(this.p0)||p.equals(this.p1)){return new jsts.geom.Coordinate(p);}
var r=this.projectionFactor(p);var coord=new jsts.geom.Coordinate();coord.x=this.p0.x+r*(this.p1.x-this.p0.x);coord.y=this.p0.y+r*(this.p1.y-this.p0.y);return coord;};jsts.geom.LineSegment.prototype.project2=function(seg){var pf0=this.projectionFactor(seg.p0);var pf1=this.projectionFactor(seg.p1);if(pf0>=1&&pf1>=1)return null;if(pf0<=0&&pf1<=0)return null;var newp0=this.project(seg.p0);if(pf0<0)newp0=p0;if(pf0>1)newp0=p1;var newp1=this.project(seg.p1);if(pf1<0.0)newp1=p0;if(pf1>1.0)newp1=p1;return new jsts.geom.LineSegment(newp0,newp1);};jsts.geom.LineSegment.prototype.closestPoint=function(p){var factor=this.projectionFactor(p);if(factor>0&&factor<1){return this.project(p);}
var dist0=this.p0.distance(p);var dist1=this.p1.distance(p);if(dist0<dist1)
return this.p0;return this.p1;};jsts.geom.LineSegment.prototype.closestPoints=function(line){var intPt=this.intersection(line);if(intPt!==null){return[intPt,intPt];}
var closestPt=[];var minDistance=Number.MAX_VALUE;var dist;var close00=this.closestPoint(line.p0);minDistance=close00.distance(line.p0);closestPt[0]=close00;closestPt[1]=line.p0;var close01=this.closestPoint(line.p1);dist=close01.distance(line.p1);if(dist<minDistance){minDistance=dist;closestPt[0]=close01;closestPt[1]=line.p1;}
var close10=line.closestPoint(this.p0);dist=close10.distance(this.p0);if(dist<minDistance){minDistance=dist;closestPt[0]=this.p0;closestPt[1]=close10;}
var close11=line.closestPoint(this.p1);dist=close11.distance(this.p1);if(dist<minDistance){minDistance=dist;closestPt[0]=this.p1;closestPt[1]=close11;}
return closestPt;};jsts.geom.LineSegment.prototype.intersection=function(line){var li=new jsts.algorithm.RobustLineIntersector();li.computeIntersection(this.p0,this.p1,line.p0,line.p1);if(li.hasIntersection())
return li.getIntersection(0);return null;};jsts.geom.LineSegment.prototype.setCoordinates=function(ls){if(ls instanceof jsts.geom.Coordinate){this.setCoordinates2.apply(this,arguments);return;}
this.setCoordinates2(ls.p0,ls.p1);};jsts.geom.LineSegment.prototype.setCoordinates2=function(p0,p1){this.p0.x=p0.x;this.p0.y=p0.y;this.p1.x=p1.x;this.p1.y=p1.y;};jsts.geom.LineSegment.prototype.distancePerpendicular=function(p){return jsts.algorithm.CGAlgorithms.distancePointLinePerpendicular(p,this.p0,this.p1);};jsts.geom.LineSegment.prototype.lineIntersection=function(line){try{var intPt=jsts.algorithm.HCoordinate.intersection(this.p0,this.p1,line.p0,line.p1);return intPt;}catch(ex){}
return null;};jsts.geom.LineSegment.prototype.toGeometry=function(geomFactory){return geomFactory.createLineString([this.p0,this.p1]);};jsts.geom.LineSegment.prototype.equals=function(o){if(!(o instanceof jsts.geom.LineSegment)){return false;}
return this.p0.equals(o.p0)&&this.p1.equals(o.p1);};jsts.geom.LineSegment.prototype.compareTo=function(o){var comp0=this.p0.compareTo(o.p0);if(comp0!==0)return comp0;return this.p1.compareTo(o.p1);};jsts.geom.LineSegment.prototype.equalsTopo=function(other){return this.p0.equals(other.p0)&&this.p1.equals(other.p1)||this.p0.equals(other.p1)&&this.p1.equals(other.p0);};jsts.geom.LineSegment.prototype.toString=function(){return"LINESTRING("+
this.p0.x+" "+this.p0.y
+", "+
this.p1.x+" "+this.p1.y+")";};jsts.index.chain.MonotoneChainOverlapAction=function(){this.tempEnv1=new jsts.geom.Envelope();this.tempEnv2=new jsts.geom.Envelope();this.overlapSeg1=new jsts.geom.LineSegment();this.overlapSeg2=new jsts.geom.LineSegment();};jsts.index.chain.MonotoneChainOverlapAction.prototype.tempEnv1=null;jsts.index.chain.MonotoneChainOverlapAction.prototype.tempEnv2=null;jsts.index.chain.MonotoneChainOverlapAction.prototype.overlapSeg1=null;jsts.index.chain.MonotoneChainOverlapAction.prototype.overlapSeg2=null;jsts.index.chain.MonotoneChainOverlapAction.prototype.overlap=function(mc1,start1,mc2,start2){this.mc1.getLineSegment(start1,this.overlapSeg1);this.mc2.getLineSegment(start2,this.overlapSeg2);this.overlap2(this.overlapSeg1,this.overlapSeg2);};jsts.index.chain.MonotoneChainOverlapAction.prototype.overlap2=function(seg1,seg2){};(function(){var MonotoneChainOverlapAction=jsts.index.chain.MonotoneChainOverlapAction;var SinglePassNoder=jsts.noding.SinglePassNoder;var STRtree=jsts.index.strtree.STRtree;var NodedSegmentString=jsts.noding.NodedSegmentString;var MonotoneChainBuilder=jsts.index.chain.MonotoneChainBuilder;var SegmentOverlapAction=function(si){this.si=si;};SegmentOverlapAction.prototype=new MonotoneChainOverlapAction();SegmentOverlapAction.constructor=SegmentOverlapAction;SegmentOverlapAction.prototype.si=null;SegmentOverlapAction.prototype.overlap=function(mc1,start1,mc2,start2){var ss1=mc1.getContext();var ss2=mc2.getContext();this.si.processIntersections(ss1,start1,ss2,start2);};jsts.noding.MCIndexNoder=function(){this.monoChains=[];this.index=new STRtree();};jsts.noding.MCIndexNoder.prototype=new SinglePassNoder();jsts.noding.MCIndexNoder.constructor=jsts.noding.MCIndexNoder;jsts.noding.MCIndexNoder.prototype.monoChains=null;jsts.noding.MCIndexNoder.prototype.index=null;jsts.noding.MCIndexNoder.prototype.idCounter=0;jsts.noding.MCIndexNoder.prototype.nodedSegStrings=null;jsts.noding.MCIndexNoder.prototype.nOverlaps=0;jsts.noding.MCIndexNoder.prototype.getMonotoneChains=function(){return this.monoChains;};jsts.noding.MCIndexNoder.prototype.getIndex=function(){return this.index;};jsts.noding.MCIndexNoder.prototype.getNodedSubstrings=function(){return NodedSegmentString.getNodedSubstrings(this.nodedSegStrings);};jsts.noding.MCIndexNoder.prototype.computeNodes=function(inputSegStrings){this.nodedSegStrings=inputSegStrings;for(var i=inputSegStrings.iterator();i.hasNext();){this.add(i.next());}
this.intersectChains();};jsts.noding.MCIndexNoder.prototype.intersectChains=function(){var overlapAction=new SegmentOverlapAction(this.segInt);for(var i=0;i<this.monoChains.length;i++){var queryChain=this.monoChains[i];var overlapChains=this.index.query(queryChain.getEnvelope());for(var j=0;j<overlapChains.length;j++){var testChain=overlapChains[j];if(testChain.getId()>queryChain.getId()){queryChain.computeOverlaps(testChain,overlapAction);this.nOverlaps++;}
if(this.segInt.isDone())
return;}}};jsts.noding.MCIndexNoder.prototype.add=function(segStr){var segChains=MonotoneChainBuilder.getChains(segStr.getCoordinates(),segStr);for(var i=0;i<segChains.length;i++){var mc=segChains[i];mc.setId(this.idCounter++);this.index.insert(mc.getEnvelope(),mc);this.monoChains.push(mc);}};})();jsts.simplify.LineSegmentIndex=function(){this.index=new jsts.index.quadtree.Quadtree();};jsts.simplify.LineSegmentIndex.prototype.index=null;jsts.simplify.LineSegmentIndex.prototype.add=function(line){if(line instanceof jsts.geom.LineSegment){this.add2(line);return;}
var segs=line.getSegments();for(var i=0;i<segs.length;i++){var seg=segs[i];this.add2(seg);}};jsts.simplify.LineSegmentIndex.prototype.add2=function(seg){this.index.insert(new jsts.geom.Envelope(seg.p0,seg.p1),seg);};jsts.simplify.LineSegmentIndex.prototype.remove=function(seg){this.index.remove(new jsts.geom.Envelope(seg.p0,seg.p1),seg);};jsts.simplify.LineSegmentIndex.prototype.query=function(querySeg){var env=new jsts.geom.Envelope(querySeg.p0,querySeg.p1);var visitor=new jsts.simplify.LineSegmentIndex.LineSegmentVisitor(querySeg);this.index.query(env,visitor);var itemsFound=visitor.getItems();return itemsFound;};jsts.simplify.LineSegmentIndex.LineSegmentVisitor=function(querySeg){this.items=[];this.querySeg=querySeg;};jsts.simplify.LineSegmentIndex.LineSegmentVisitor.prototype=new jsts.index.ItemVisitor();jsts.simplify.LineSegmentIndex.LineSegmentVisitor.prototype.querySeg=null;jsts.simplify.LineSegmentIndex.LineSegmentVisitor.prototype.items=null;jsts.simplify.LineSegmentIndex.LineSegmentVisitor.prototype.visitItem=function(item){var seg=item;if(jsts.geom.Envelope.intersects(seg.p0,seg.p1,this.querySeg.p0,this.querySeg.p1))
this.items.push(item);};jsts.simplify.LineSegmentIndex.LineSegmentVisitor.prototype.getItems=function(){return this.items;};jsts.geomgraph.EdgeEndStar=function(){this.edgeMap=new javascript.util.TreeMap();this.edgeList=null;this.ptInAreaLocation=[jsts.geom.Location.NONE,jsts.geom.Location.NONE];};jsts.geomgraph.EdgeEndStar.prototype.edgeMap=null;jsts.geomgraph.EdgeEndStar.prototype.edgeList=null;jsts.geomgraph.EdgeEndStar.prototype.ptInAreaLocation=null;jsts.geomgraph.EdgeEndStar.prototype.insert=function(e){throw new jsts.error.AbstractMethodInvocationError();};jsts.geomgraph.EdgeEndStar.prototype.insertEdgeEnd=function(e,obj){this.edgeMap.put(e,obj);this.edgeList=null;};jsts.geomgraph.EdgeEndStar.prototype.getCoordinate=function(){var it=this.iterator();if(!it.hasNext())
return null;var e=it.next();return e.getCoordinate();};jsts.geomgraph.EdgeEndStar.prototype.getDegree=function(){return this.edgeMap.size();};jsts.geomgraph.EdgeEndStar.prototype.iterator=function(){return this.getEdges().iterator();};jsts.geomgraph.EdgeEndStar.prototype.getEdges=function(){if(this.edgeList===null){this.edgeList=new javascript.util.ArrayList(this.edgeMap.values());}
return this.edgeList;};jsts.geomgraph.EdgeEndStar.prototype.getNextCW=function(ee){this.getEdges();var i=this.edgeList.indexOf(ee);var iNextCW=i-1;if(i===0)
iNextCW=this.edgeList.length-1;return this.edgeList[iNextCW];};jsts.geomgraph.EdgeEndStar.prototype.computeLabelling=function(geomGraph){this.computeEdgeEndLabels(geomGraph[0].getBoundaryNodeRule());this.propagateSideLabels(0);this.propagateSideLabels(1);var hasDimensionalCollapseEdge=[false,false];for(var it=this.iterator();it.hasNext();){var e=it.next();var label=e.getLabel();for(var geomi=0;geomi<2;geomi++){if(label.isLine(geomi)&&label.getLocation(geomi)===jsts.geom.Location.BOUNDARY)
hasDimensionalCollapseEdge[geomi]=true;}}
for(var it=this.iterator();it.hasNext();){var e=it.next();var label=e.getLabel();for(var geomi=0;geomi<2;geomi++){if(label.isAnyNull(geomi)){var loc=jsts.geom.Location.NONE;if(hasDimensionalCollapseEdge[geomi]){loc=jsts.geom.Location.EXTERIOR;}else{var p=e.getCoordinate();loc=this.getLocation(geomi,p,geomGraph);}
label.setAllLocationsIfNull(geomi,loc);}}}};jsts.geomgraph.EdgeEndStar.prototype.computeEdgeEndLabels=function(boundaryNodeRule){for(var it=this.iterator();it.hasNext();){var ee=it.next();ee.computeLabel(boundaryNodeRule);}};jsts.geomgraph.EdgeEndStar.prototype.getLocation=function(geomIndex,p,geom){if(this.ptInAreaLocation[geomIndex]===jsts.geom.Location.NONE){this.ptInAreaLocation[geomIndex]=jsts.algorithm.locate.SimplePointInAreaLocator.locate(p,geom[geomIndex].getGeometry());}
return this.ptInAreaLocation[geomIndex];};jsts.geomgraph.EdgeEndStar.prototype.isAreaLabelsConsistent=function(geomGraph){this.computeEdgeEndLabels(geomGraph.getBoundaryNodeRule());return this.checkAreaLabelsConsistent(0);};jsts.geomgraph.EdgeEndStar.prototype.checkAreaLabelsConsistent=function(geomIndex){var edges=this.getEdges();if(edges.size()<=0)
return true;var lastEdgeIndex=edges.size()-1;var startLabel=edges.get(lastEdgeIndex).getLabel();var startLoc=startLabel.getLocation(geomIndex,jsts.geomgraph.Position.LEFT);jsts.util.Assert.isTrue(startLoc!=jsts.geom.Location.NONE,'Found unlabelled area edge');var currLoc=startLoc;for(var it=this.iterator();it.hasNext();){var e=it.next();var label=e.getLabel();jsts.util.Assert.isTrue(label.isArea(geomIndex),'Found non-area edge');var leftLoc=label.getLocation(geomIndex,jsts.geomgraph.Position.LEFT);var rightLoc=label.getLocation(geomIndex,jsts.geomgraph.Position.RIGHT);if(leftLoc===rightLoc){return false;}
if(rightLoc!==currLoc){return false;}
currLoc=leftLoc;}
return true;};jsts.geomgraph.EdgeEndStar.prototype.propagateSideLabels=function(geomIndex){var startLoc=jsts.geom.Location.NONE;for(var it=this.iterator();it.hasNext();){var e=it.next();var label=e.getLabel();if(label.isArea(geomIndex)&&label.getLocation(geomIndex,jsts.geomgraph.Position.LEFT)!==jsts.geom.Location.NONE)
startLoc=label.getLocation(geomIndex,jsts.geomgraph.Position.LEFT);}
if(startLoc===jsts.geom.Location.NONE)
return;var currLoc=startLoc;for(var it=this.iterator();it.hasNext();){var e=it.next();var label=e.getLabel();if(label.getLocation(geomIndex,jsts.geomgraph.Position.ON)===jsts.geom.Location.NONE)
label.setLocation(geomIndex,jsts.geomgraph.Position.ON,currLoc);if(label.isArea(geomIndex)){var leftLoc=label.getLocation(geomIndex,jsts.geomgraph.Position.LEFT);var rightLoc=label.getLocation(geomIndex,jsts.geomgraph.Position.RIGHT);if(rightLoc!==jsts.geom.Location.NONE){if(rightLoc!==currLoc)
throw new jsts.error.TopologyError('side location conflict',e.getCoordinate());if(leftLoc===jsts.geom.Location.NONE){jsts.util.Assert.shouldNeverReachHere('found single null side (at '+
e.getCoordinate()+')');}
currLoc=leftLoc;}else{jsts.util.Assert.isTrue(label.getLocation(geomIndex,jsts.geomgraph.Position.LEFT)===jsts.geom.Location.NONE,'found single null side');label.setLocation(geomIndex,jsts.geomgraph.Position.RIGHT,currLoc);label.setLocation(geomIndex,jsts.geomgraph.Position.LEFT,currLoc);}}}};jsts.geomgraph.EdgeEndStar.prototype.findIndex=function(eSearch){this.iterator();for(var i=0;i<this.edgeList.size();i++){var e=this.edgeList.get(i);if(e===eSearch)
return i;}
return-1;};jsts.operation.relate.EdgeEndBundleStar=function(){jsts.geomgraph.EdgeEndStar.apply(this,arguments);};jsts.operation.relate.EdgeEndBundleStar.prototype=new jsts.geomgraph.EdgeEndStar();jsts.operation.relate.EdgeEndBundleStar.prototype.insert=function(e){var eb=this.edgeMap.get(e);if(eb===null){eb=new jsts.operation.relate.EdgeEndBundle(e);this.insertEdgeEnd(e,eb);}
else{eb.insert(e);}};jsts.operation.relate.EdgeEndBundleStar.prototype.updateIM=function(im){for(var it=this.iterator();it.hasNext();){var esb=it.next();esb.updateIM(im);}};jsts.index.ArrayListVisitor=function(){this.items=[];};jsts.index.ArrayListVisitor.prototype.visitItem=function(item){this.items.push(item);};jsts.index.ArrayListVisitor.prototype.getItems=function(){return this.items;};jsts.algorithm.distance.DistanceToPoint=function(){};jsts.algorithm.distance.DistanceToPoint.computeDistance=function(geom,pt,ptDist){if(geom instanceof jsts.geom.LineString){jsts.algorithm.distance.DistanceToPoint.computeDistance2(geom,pt,ptDist);}else if(geom instanceof jsts.geom.Polygon){jsts.algorithm.distance.DistanceToPoint.computeDistance4(geom,pt,ptDist);}else if(geom instanceof jsts.geom.GeometryCollection){var gc=geom;for(var i=0;i<gc.getNumGeometries();i++){var g=gc.getGeometryN(i);jsts.algorithm.distance.DistanceToPoint.computeDistance(g,pt,ptDist);}}else{ptDist.setMinimum(geom.getCoordinate(),pt);}};jsts.algorithm.distance.DistanceToPoint.computeDistance2=function(line,pt,ptDist){var tempSegment=new jsts.geom.LineSegment();var coords=line.getCoordinates();for(var i=0;i<coords.length-1;i++){tempSegment.setCoordinates(coords[i],coords[i+1]);var closestPt=tempSegment.closestPoint(pt);ptDist.setMinimum(closestPt,pt);}};jsts.algorithm.distance.DistanceToPoint.computeDistance3=function(segment,pt,ptDist){var closestPt=segment.closestPoint(pt);ptDist.setMinimum(closestPt,pt);};jsts.algorithm.distance.DistanceToPoint.computeDistance4=function(poly,pt,ptDist){jsts.algorithm.distance.DistanceToPoint.computeDistance2(poly.getExteriorRing(),pt,ptDist);for(var i=0;i<poly.getNumInteriorRing();i++){jsts.algorithm.distance.DistanceToPoint.computeDistance2(poly.getInteriorRingN(i),pt,ptDist);}};jsts.index.strtree.ItemBoundable=function(bounds,item){this.bounds=bounds;this.item=item;};jsts.index.strtree.ItemBoundable.prototype=new jsts.index.strtree.Boundable();jsts.index.strtree.ItemBoundable.constructor=jsts.index.strtree.ItemBoundable;jsts.index.strtree.ItemBoundable.prototype.bounds=null;jsts.index.strtree.ItemBoundable.prototype.item=null;jsts.index.strtree.ItemBoundable.prototype.getBounds=function(){return this.bounds;};jsts.index.strtree.ItemBoundable.prototype.getItem=function(){return this.item;};(function(){var ArrayList=javascript.util.ArrayList;var TreeMap=javascript.util.TreeMap;jsts.geomgraph.EdgeList=function(){this.edges=new ArrayList();this.ocaMap=new TreeMap();};jsts.geomgraph.EdgeList.prototype.edges=null;jsts.geomgraph.EdgeList.prototype.ocaMap=null;jsts.geomgraph.EdgeList.prototype.add=function(e){this.edges.add(e);var oca=new jsts.noding.OrientedCoordinateArray(e.getCoordinates());this.ocaMap.put(oca,e);};jsts.geomgraph.EdgeList.prototype.addAll=function(edgeColl){for(var i=edgeColl.iterator();i.hasNext();){this.add(i.next());}};jsts.geomgraph.EdgeList.prototype.getEdges=function(){return this.edges;};jsts.geomgraph.EdgeList.prototype.findEqualEdge=function(e){var oca=new jsts.noding.OrientedCoordinateArray(e.getCoordinates());var matchEdge=this.ocaMap.get(oca);return matchEdge;};jsts.geomgraph.EdgeList.prototype.getEdges=function(){return this.edges;};jsts.geomgraph.EdgeList.prototype.iterator=function(){return this.edges.iterator();};jsts.geomgraph.EdgeList.prototype.get=function(i){return this.edges.get(i);};jsts.geomgraph.EdgeList.prototype.findEdgeIndex=function(e){for(var i=0;i<this.edges.size();i++){if(this.edges.get(i).equals(e))
return i;}
return-1;};})();jsts.operation.IsSimpleOp=function(geom){this.geom=geom;};jsts.operation.IsSimpleOp.prototype.geom=null;jsts.operation.IsSimpleOp.prototype.isClosedEndpointsInInterior=true;jsts.operation.IsSimpleOp.prototype.nonSimpleLocation=null;jsts.operation.IsSimpleOp.prototype.IsSimpleOp=function(geom){this.geom=geom;};jsts.operation.IsSimpleOp.prototype.isSimple=function(){this.nonSimpleLocation=null;if(this.geom instanceof jsts.geom.LineString){return this.isSimpleLinearGeometry(this.geom);}
if(this.geom instanceof jsts.geom.MultiLineString){return this.isSimpleLinearGeometry(this.geom);}
if(this.geom instanceof jsts.geom.MultiPoint){return this.isSimpleMultiPoint(this.geom);}
return true;};jsts.operation.IsSimpleOp.prototype.isSimpleMultiPoint=function(mp){if(mp.isEmpty())
return true;var points=[];for(var i=0;i<mp.getNumGeometries();i++){var pt=mp.getGeometryN(i);var p=pt.getCoordinate();for(var j=0;j<points.length;j++){var point=points[j];if(p.equals2D(point)){this.nonSimpleLocation=p;return false;}}
points.push(p);}
return true;};jsts.operation.IsSimpleOp.prototype.isSimpleLinearGeometry=function(geom){if(geom.isEmpty())
return true;var graph=new jsts.geomgraph.GeometryGraph(0,geom);var li=new jsts.algorithm.RobustLineIntersector();var si=graph.computeSelfNodes(li,true);if(!si.hasIntersection())
return true;if(si.hasProperIntersection()){this.nonSimpleLocation=si.getProperIntersectionPoint();return false;}
if(this.hasNonEndpointIntersection(graph))
return false;if(this.isClosedEndpointsInInterior){if(this.hasClosedEndpointIntersection(graph))
return false;}
return true;};jsts.operation.IsSimpleOp.prototype.hasNonEndpointIntersection=function(graph){for(var i=graph.getEdgeIterator();i.hasNext();){var e=i.next();var maxSegmentIndex=e.getMaximumSegmentIndex();for(var eiIt=e.getEdgeIntersectionList().iterator();eiIt.hasNext();){var ei=eiIt.next();if(!ei.isEndPoint(maxSegmentIndex)){this.nonSimpleLocation=ei.getCoordinate();return true;}}}
return false;};jsts.operation.IsSimpleOp.prototype.hasClosedEndpointIntersection=function(graph){var endPoints=new javascript.util.TreeMap();for(var i=graph.getEdgeIterator();i.hasNext();){var e=i.next();var maxSegmentIndex=e.getMaximumSegmentIndex();var isClosed=e.isClosed();var p0=e.getCoordinate(0);this.addEndpoint(endPoints,p0,isClosed);var p1=e.getCoordinate(e.getNumPoints()-1);this.addEndpoint(endPoints,p1,isClosed);}
for(var i=endPoints.values().iterator();i.hasNext();){var eiInfo=i.next();if(eiInfo.isClosed&&eiInfo.degree!=2){this.nonSimpleLocation=eiInfo.getCoordinate();return true;}}
return false;};jsts.operation.IsSimpleOp.EndpointInfo=function(pt){this.pt=pt;this.isClosed=false;this.degree=0;};jsts.operation.IsSimpleOp.EndpointInfo.prototype.pt=null;jsts.operation.IsSimpleOp.EndpointInfo.prototype.isClosed=null;jsts.operation.IsSimpleOp.EndpointInfo.prototype.degree=null;jsts.operation.IsSimpleOp.EndpointInfo.prototype.getCoordinate=function(){return this.pt;};jsts.operation.IsSimpleOp.EndpointInfo.prototype.addEndpoint=function(isClosed){this.degree++;this.isClosed=this.isClosed||isClosed;};jsts.operation.IsSimpleOp.prototype.addEndpoint=function(endPoints,p,isClosed){var eiInfo=endPoints.get(p);if(eiInfo===null){eiInfo=new jsts.operation.IsSimpleOp.EndpointInfo(p);endPoints.put(p,eiInfo);}
eiInfo.addEndpoint(isClosed);};(function(){var LineStringSnapper=function(){this.snapTolerance=0.0;this.seg=new jsts.geom.LineSegment();this.allowSnappingToSourceVertices=false;this.isClosed=false;this.srcPts=[];if(arguments[0]instanceof jsts.geom.LineString){this.initFromLine.apply(this,arguments);}else{this.initFromPoints.apply(this,arguments);}};LineStringSnapper.prototype.initFromLine=function(srcLine,snapTolerance){this.initFromPoints(srcLine.getCoordinates(),snapTolerance);};LineStringSnapper.prototype.initFromPoints=function(srcPts,snapTolerance){this.srcPts=srcPts;this.isClosed=this.calcIsClosed(srcPts);this.snapTolerance=snapTolerance;};LineStringSnapper.prototype.setAllowSnappingToSourceVertices=function(allowSnappingToSourceVertices){this.allowSnappingToSourceVertices=allowSnappingToSourceVertices;};LineStringSnapper.prototype.calcIsClosed=function(pts){if(pts.length<=1){return false;}
return pts[0].equals(pts[pts.length-1]);};LineStringSnapper.prototype.snapTo=function(snapPts){var coordList=new jsts.geom.CoordinateList(this.srcPts);this.snapVertices(coordList,snapPts);this.snapSegments(coordList,snapPts);return coordList.toCoordinateArray();};LineStringSnapper.prototype.snapVertices=function(srcCoords,snapPts){var end=this.isClosed?srcCoords.size()-1:srcCoords.size(),i=0,srcPt,snapVert;for(i;i<end;i++){srcPt=srcCoords.get(i);snapVert=this.findSnapForVertex(srcPt,snapPts);if(snapVert!==null){srcCoords.set(i,new jsts.geom.Coordinate(snapVert));if(i===0&&this.isClosed)
srcCoords.set(srcCoords.size()-1,new jsts.geom.Coordinate(snapVert));}}};LineStringSnapper.prototype.findSnapForVertex=function(pt,snapPts){var i=0,il=snapPts.length;for(i=0;i<il;i++){if(pt.equals(snapPts[i])){return null;}
if(pt.distance(snapPts[i])<this.snapTolerance){return snapPts[i];}}
return null;};LineStringSnapper.prototype.snapSegments=function(srcCoords,snapPts){if(snapPts.length===0){return;}
var distinctPtCount=snapPts.length,i,snapPt,index;if(snapPts.length>1&&snapPts[0].equals2D(snapPts[snapPts.length-1])){distinctPtCount=snapPts.length-1;}
i=0;for(i;i<distinctPtCount;i++){snapPt=snapPts[i];index=this.findSegmentIndexToSnap(snapPt,srcCoords);if(index>=0){srcCoords.add(index+1,new jsts.geom.Coordinate(snapPt),false);}}};LineStringSnapper.prototype.findSegmentIndexToSnap=function(snapPt,srcCoords){var minDist=Number.MAX_VALUE,snapIndex=-1,i=0,dist;for(i;i<srcCoords.size()-1;i++){this.seg.p0=srcCoords.get(i);this.seg.p1=srcCoords.get(i+1);if(this.seg.p0.equals(snapPt)||this.seg.p1.equals(snapPt)){if(this.allowSnappingToSourceVertices){continue;}else{return-1;}}
dist=this.seg.distance(snapPt);if(dist<this.snapTolerance&&dist<minDist){minDist=dist;snapIndex=i;}}
return snapIndex;};jsts.operation.overlay.snap.LineStringSnapper=LineStringSnapper;})();(function(){var ArrayList=javascript.util.ArrayList;var GeometryComponentFilter=jsts.geom.GeometryComponentFilter;var LineString=jsts.geom.LineString;var EdgeRing=jsts.operation.polygonize.EdgeRing;var PolygonizeGraph=jsts.operation.polygonize.PolygonizeGraph;var Polygonizer=function(){var that=this;var LineStringAdder=function(){};LineStringAdder.prototype=new GeometryComponentFilter();LineStringAdder.prototype.filter=function(g){if(g instanceof LineString)
that.add(g);};this.lineStringAdder=new LineStringAdder();this.dangles=new ArrayList();this.cutEdges=new ArrayList();this.invalidRingLines=new ArrayList();};Polygonizer.prototype.lineStringAdder=null;Polygonizer.prototype.graph=null;Polygonizer.prototype.dangles=null;Polygonizer.prototype.cutEdges=null;Polygonizer.prototype.invalidRingLines=null;Polygonizer.prototype.holeList=null;Polygonizer.prototype.shellList=null;Polygonizer.prototype.polyList=null;Polygonizer.prototype.add=function(geomList){if(geomList instanceof jsts.geom.LineString){return this.add3(geomList);}else if(geomList instanceof jsts.geom.Geometry){return this.add2(geomList);}
for(var i=geomList.iterator();i.hasNext();){var geometry=i.next();this.add2(geometry);}};Polygonizer.prototype.add2=function(g){g.apply(this.lineStringAdder);};Polygonizer.prototype.add3=function(line){if(this.graph==null)
this.graph=new PolygonizeGraph(line.getFactory());this.graph.addEdge(line);};Polygonizer.prototype.getPolygons=function(){this.polygonize();return this.polyList;};Polygonizer.prototype.getDangles=function(){this.polygonize();return this.dangles;};Polygonizer.prototype.getCutEdges=function(){this.polygonize();return this.cutEdges;};Polygonizer.prototype.getInvalidRingLines=function(){this.polygonize();return this.invalidRingLines;};Polygonizer.prototype.polygonize=function(){if(this.polyList!=null)
return;this.polyList=new ArrayList();if(this.graph==null)
return;this.dangles=this.graph.deleteDangles();this.cutEdges=this.graph.deleteCutEdges();var edgeRingList=this.graph.getEdgeRings();var validEdgeRingList=new ArrayList();this.invalidRingLines=new ArrayList();this.findValidRings(edgeRingList,validEdgeRingList,this.invalidRingLines);this.findShellsAndHoles(validEdgeRingList);Polygonizer.assignHolesToShells(this.holeList,this.shellList);this.polyList=new ArrayList();for(var i=this.shellList.iterator();i.hasNext();){var er=i.next();this.polyList.add(er.getPolygon());}};Polygonizer.prototype.findValidRings=function(edgeRingList,validEdgeRingList,invalidRingList){for(var i=edgeRingList.iterator();i.hasNext();){var er=i.next();if(er.isValid())
validEdgeRingList.add(er);else
invalidRingList.add(er.getLineString());}};Polygonizer.prototype.findShellsAndHoles=function(edgeRingList){this.holeList=new ArrayList();this.shellList=new ArrayList();for(var i=edgeRingList.iterator();i.hasNext();){var er=i.next();if(er.isHole())
this.holeList.add(er);else
this.shellList.add(er);}};Polygonizer.assignHolesToShells=function(holeList,shellList){for(var i=holeList.iterator();i.hasNext();){var holeER=i.next();Polygonizer.assignHoleToShell(holeER,shellList);}};Polygonizer.assignHoleToShell=function(holeER,shellList){var shell=EdgeRing.findEdgeRingContaining(holeER,shellList);if(shell!=null)
shell.addHole(holeER.getRing());};jsts.operation.polygonize.Polygonizer=Polygonizer;})();(function(){var ArrayList=javascript.util.ArrayList;var GeometryTransformer=function(){};GeometryTransformer.prototype.inputGeom=null;GeometryTransformer.prototype.factory=null;GeometryTransformer.prototype.pruneEmptyGeometry=true;GeometryTransformer.prototype.preserveGeometryCollectionType=true;GeometryTransformer.prototype.preserveCollections=false;GeometryTransformer.prototype.reserveType=false;GeometryTransformer.prototype.getInputGeometry=function(){return this.inputGeom;};GeometryTransformer.prototype.transform=function(inputGeom){this.inputGeom=inputGeom;this.factory=inputGeom.getFactory();if(inputGeom instanceof jsts.geom.Point)
return this.transformPoint(inputGeom,null);if(inputGeom instanceof jsts.geom.MultiPoint)
return this.transformMultiPoint(inputGeom,null);if(inputGeom instanceof jsts.geom.LinearRing)
return this.transformLinearRing(inputGeom,null);if(inputGeom instanceof jsts.geom.LineString)
return this.transformLineString(inputGeom,null);if(inputGeom instanceof jsts.geom.MultiLineString)
return this.transformMultiLineString(inputGeom,null);if(inputGeom instanceof jsts.geom.Polygon)
return this.transformPolygon(inputGeom,null);if(inputGeom instanceof jsts.geom.MultiPolygon)
return this.transformMultiPolygon(inputGeom,null);if(inputGeom instanceof jsts.geom.GeometryCollection)
return this.transformGeometryCollection(inputGeom,null);throw new jsts.error.IllegalArgumentException('Unknown Geometry subtype: '+
inputGeom.getClass().getName());};GeometryTransformer.prototype.createCoordinateSequence=function(coords){return this.factory.getCoordinateSequenceFactory().create(coords);};GeometryTransformer.prototype.copy=function(seq){return seq.clone();};GeometryTransformer.prototype.transformCoordinates=function(coords,parent){return this.copy(coords);};GeometryTransformer.prototype.transformPoint=function(geom,parent){return this.factory.createPoint(this.transformCoordinates(geom.getCoordinateSequence(),geom));};GeometryTransformer.prototype.transformMultiPoint=function(geom,parent){var transGeomList=new ArrayList();for(var i=0;i<geom.getNumGeometries();i++){var transformGeom=this.transformPoint(geom.getGeometryN(i),geom);if(transformGeom==null)
continue;if(transformGeom.isEmpty())
continue;transGeomList.add(transformGeom);}
return this.factory.buildGeometry(transGeomList);};GeometryTransformer.prototype.transformLinearRing=function(geom,parent){var seq=this.transformCoordinates(geom.getCoordinateSequence(),geom);var seqSize=seq.length;if(seqSize>0&&seqSize<4&&!this.preserveType)
return this.factory.createLineString(seq);return this.factory.createLinearRing(seq);};GeometryTransformer.prototype.transformLineString=function(geom,parent){return this.factory.createLineString(this.transformCoordinates(geom.getCoordinateSequence(),geom));};GeometryTransformer.prototype.transformMultiLineString=function(geom,parent){var transGeomList=new ArrayList();for(var i=0;i<geom.getNumGeometries();i++){var transformGeom=this.transformLineString(geom.getGeometryN(i),geom);if(transformGeom==null)
continue;if(transformGeom.isEmpty())
continue;transGeomList.add(transformGeom);}
return this.factory.buildGeometry(transGeomList);};GeometryTransformer.prototype.transformPolygon=function(geom,parent){var isAllValidLinearRings=true;var shell=this.transformLinearRing(geom.getExteriorRing(),geom);if(shell==null||!(shell instanceof jsts.geom.LinearRing)||shell.isEmpty())
isAllValidLinearRings=false;var holes=new ArrayList();for(var i=0;i<geom.getNumInteriorRing();i++){var hole=this.transformLinearRing(geom.getInteriorRingN(i),geom);if(hole==null||hole.isEmpty()){continue;}
if(!(hole instanceof jsts.geom.LinearRing))
isAllValidLinearRings=false;holes.add(hole);}
if(isAllValidLinearRings)
return this.factory.createPolygon(shell,holes.toArray());else{var components=new ArrayList();if(shell!=null)
components.add(shell);components.addAll(holes);return this.factory.buildGeometry(components);}};GeometryTransformer.prototype.transformMultiPolygon=function(geom,parent){var transGeomList=new ArrayList();for(var i=0;i<geom.getNumGeometries();i++){var transformGeom=this.transformPolygon(geom.getGeometryN(i),geom);if(transformGeom==null)
continue;if(transformGeom.isEmpty())
continue;transGeomList.add(transformGeom);}
return this.factory.buildGeometry(transGeomList);};GeometryTransformer.prototype.transformGeometryCollection=function(geom,parent){var transGeomList=new ArrayList();for(var i=0;i<geom.getNumGeometries();i++){var transformGeom=this.transform(geom.getGeometryN(i));if(transformGeom==null)
continue;if(this.pruneEmptyGeometry&&transformGeom.isEmpty())
continue;transGeomList.add(transformGeom);}
if(this.preserveGeometryCollectionType)
return this.factory.createGeometryCollection(GeometryFactory.toGeometryArray(transGeomList));return this.factory.buildGeometry(transGeomList);};jsts.geom.util.GeometryTransformer=GeometryTransformer;})();(function(){var LineStringSnapper=jsts.operation.overlay.snap.LineStringSnapper;var PrecisionModel=jsts.geom.PrecisionModel;var TreeSet=javascript.util.TreeSet;var SnapTransformer=function(snapTolerance,snapPts,isSelfSnap){this.snapTolerance=snapTolerance;this.snapPts=snapPts;this.isSelfSnap=isSelfSnap||false;};SnapTransformer.prototype=new jsts.geom.util.GeometryTransformer();SnapTransformer.prototype.snapTolerance=null;SnapTransformer.prototype.snapPts=null;SnapTransformer.prototype.isSelfSnap=false;SnapTransformer.prototype.transformCoordinates=function(coords,parent){var srcPts=coords;var newPts=this.snapLine(srcPts,this.snapPts);return newPts;};SnapTransformer.prototype.snapLine=function(srcPts,snapPts){var snapper=new LineStringSnapper(srcPts,this.snapTolerance);snapper.setAllowSnappingToSourceVertices(this.isSelfSnap);return snapper.snapTo(snapPts);};var GeometrySnapper=function(srcGeom){this.srcGeom=srcGeom;};GeometrySnapper.SNAP_PRECISION_FACTOR=1e-9;GeometrySnapper.computeOverlaySnapTolerance=function(g){if(arguments.length===2){return GeometrySnapper.computeOverlaySnapTolerance2.apply(this,arguments);}
var snapTolerance=this.computeSizeBasedSnapTolerance(g);var pm=g.getPrecisionModel();if(pm.getType()==PrecisionModel.FIXED){var fixedSnapTol=(1/pm.getScale())*2/1.415;if(fixedSnapTol>snapTolerance)
snapTolerance=fixedSnapTol;}
return snapTolerance;};GeometrySnapper.computeSizeBasedSnapTolerance=function(g){var env=g.getEnvelopeInternal();var minDimension=Math.min(env.getHeight(),env.getWidth());var snapTol=minDimension*GeometrySnapper.SNAP_PRECISION_FACTOR;return snapTol;};GeometrySnapper.computeOverlaySnapTolerance2=function(g0,g1){return Math.min(this.computeOverlaySnapTolerance(g0),this.computeOverlaySnapTolerance(g1));};GeometrySnapper.snap=function(g0,g1,snapTolerance){var snapGeom=[];var snapper0=new GeometrySnapper(g0);snapGeom[0]=snapper0.snapTo(g1,snapTolerance);var snapper1=new GeometrySnapper(g1);snapGeom[1]=snapper1.snapTo(snapGeom[0],snapTolerance);return snapGeom;};GeometrySnapper.snapToSelf=function(g0,snapTolerance,cleanResult){var snapper0=new GeometrySnapper(g0);return snapper0.snapToSelf(snapTolerance,cleanResult);};GeometrySnapper.prototype.srcGeom=null;GeometrySnapper.prototype.snapTo=function(snapGeom,snapTolerance){var snapPts=this.extractTargetCoordinates(snapGeom);var snapTrans=new SnapTransformer(snapTolerance,snapPts);return snapTrans.transform(this.srcGeom);};GeometrySnapper.prototype.snapToSelf=function(snapTolerance,cleanResult){var snapPts=this.extractTargetCoordinates(srcGeom);var snapTrans=new SnapTransformer(snapTolerance,snapPts,true);var snappedGeom=snapTrans.transform(srcGeom);var result=snappedGeom;if(cleanResult&&result instanceof Polygonal){result=snappedGeom.buffer(0);}
return result;};GeometrySnapper.prototype.extractTargetCoordinates=function(g){var ptSet=new TreeSet();var pts=g.getCoordinates();for(var i=0;i<pts.length;i++){ptSet.add(pts[i]);}
return ptSet.toArray();};GeometrySnapper.prototype.computeSnapTolerance=function(ringPts){var minSegLen=this.computeMinimumSegmentLength(ringPts);var snapTol=minSegLen/10;return snapTol;};GeometrySnapper.prototype.computeMinimumSegmentLength=function(pts){var minSegLen=Number.MAX_VALUE;for(var i=0;i<pts.length-1;i++){var segLen=pts[i].distance(pts[i+1]);if(segLen<minSegLen)
minSegLen=segLen;}
return minSegLen;};jsts.operation.overlay.snap.GeometrySnapper=GeometrySnapper;})();jsts.algorithm.PointLocator=function(boundaryRule){this.boundaryRule=boundaryRule?boundaryRule:jsts.algorithm.BoundaryNodeRule.OGC_SFS_BOUNDARY_RULE;};jsts.algorithm.PointLocator.prototype.boundaryRule=null;jsts.algorithm.PointLocator.prototype.isIn=null;jsts.algorithm.PointLocator.prototype.numBoundaries=null;jsts.algorithm.PointLocator.prototype.intersects=function(p,geom){return this.locate(p,geom)!==jsts.geom.Location.EXTERIOR;};jsts.algorithm.PointLocator.prototype.locate=function(p,geom){if(geom.isEmpty())
return jsts.geom.Location.EXTERIOR;if(geom instanceof jsts.geom.Point){return this.locate2(p,geom);}else if(geom instanceof jsts.geom.LineString){return this.locate3(p,geom);}else if(geom instanceof jsts.geom.Polygon){return this.locate4(p,geom);}
this.isIn=false;this.numBoundaries=0;this.computeLocation(p,geom);if(this.boundaryRule.isInBoundary(this.numBoundaries))
return jsts.geom.Location.BOUNDARY;if(this.numBoundaries>0||this.isIn)
return jsts.geom.Location.INTERIOR;return jsts.geom.Location.EXTERIOR;};jsts.algorithm.PointLocator.prototype.computeLocation=function(p,geom){if(geom instanceof jsts.geom.Point||geom instanceof jsts.geom.LineString||geom instanceof jsts.geom.Polygon){this.updateLocationInfo(this.locate(p,geom));}else if(geom instanceof jsts.geom.MultiLineString){var ml=geom;for(var i=0;i<ml.getNumGeometries();i++){var l=ml.getGeometryN(i);this.updateLocationInfo(this.locate(p,l));}}else if(geom instanceof jsts.geom.MultiPolygon){var mpoly=geom;for(var i=0;i<mpoly.getNumGeometries();i++){var poly=mpoly.getGeometryN(i);this.updateLocationInfo(this.locate(p,poly));}}else if(geom instanceof jsts.geom.MultiPoint||geom instanceof jsts.geom.GeometryCollection){for(var i=0;i<geom.getNumGeometries();i++){var part=geom.getGeometryN(i);if(part!==geom){this.computeLocation(p,part);}}}};jsts.algorithm.PointLocator.prototype.updateLocationInfo=function(loc){if(loc===jsts.geom.Location.INTERIOR)
this.isIn=true;if(loc===jsts.geom.Location.BOUNDARY)
this.numBoundaries++;};jsts.algorithm.PointLocator.prototype.locate2=function(p,pt){var ptCoord=pt.getCoordinate();if(ptCoord.equals2D(p))
return jsts.geom.Location.INTERIOR;return jsts.geom.Location.EXTERIOR;};jsts.algorithm.PointLocator.prototype.locate3=function(p,l){if(!l.getEnvelopeInternal().intersects(p))
return jsts.geom.Location.EXTERIOR;var pt=l.getCoordinates();if(!l.isClosed()){if(p.equals(pt[0])||p.equals(pt[pt.length-1])){return jsts.geom.Location.BOUNDARY;}}
if(jsts.algorithm.CGAlgorithms.isOnLine(p,pt))
return jsts.geom.Location.INTERIOR;return jsts.geom.Location.EXTERIOR;};jsts.algorithm.PointLocator.prototype.locateInPolygonRing=function(p,ring){if(!ring.getEnvelopeInternal().intersects(p))
return jsts.geom.Location.EXTERIOR;return jsts.algorithm.CGAlgorithms.locatePointInRing(p,ring.getCoordinates());};jsts.algorithm.PointLocator.prototype.locate4=function(p,poly){if(poly.isEmpty())
return jsts.geom.Location.EXTERIOR;var shell=poly.getExteriorRing();var shellLoc=this.locateInPolygonRing(p,shell);if(shellLoc===jsts.geom.Location.EXTERIOR)
return jsts.geom.Location.EXTERIOR;if(shellLoc===jsts.geom.Location.BOUNDARY)
return jsts.geom.Location.BOUNDARY;for(var i=0;i<poly.getNumInteriorRing();i++){var hole=poly.getInteriorRingN(i);var holeLoc=this.locateInPolygonRing(p,hole);if(holeLoc===jsts.geom.Location.INTERIOR)
return jsts.geom.Location.EXTERIOR;if(holeLoc===jsts.geom.Location.BOUNDARY)
return jsts.geom.Location.BOUNDARY;}
return jsts.geom.Location.INTERIOR;};(function(){var Location=jsts.geom.Location;var ArrayList=javascript.util.ArrayList;var TreeMap=javascript.util.TreeMap;jsts.geomgraph.NodeMap=function(nodeFactory){this.nodeMap=new TreeMap();this.nodeFact=nodeFactory;};jsts.geomgraph.NodeMap.prototype.nodeMap=null;jsts.geomgraph.NodeMap.prototype.nodeFact=null;jsts.geomgraph.NodeMap.prototype.addNode=function(arg){var node,coord;if(arg instanceof jsts.geom.Coordinate){coord=arg;node=this.nodeMap.get(coord);if(node===null){node=this.nodeFact.createNode(coord);this.nodeMap.put(coord,node);}
return node;}else if(arg instanceof jsts.geomgraph.Node){var n=arg;coord=n.getCoordinate();node=this.nodeMap.get(coord);if(node===null){this.nodeMap.put(coord,n);return n;}
node.mergeLabel(n);return node;}};jsts.geomgraph.NodeMap.prototype.add=function(e){var p=e.getCoordinate();var n=this.addNode(p);n.add(e);};jsts.geomgraph.NodeMap.prototype.find=function(coord){return this.nodeMap.get(coord);};jsts.geomgraph.NodeMap.prototype.values=function(){return this.nodeMap.values();};jsts.geomgraph.NodeMap.prototype.iterator=function(){return this.values().iterator();};jsts.geomgraph.NodeMap.prototype.getBoundaryNodes=function(geomIndex){var bdyNodes=new ArrayList();for(var i=this.iterator();i.hasNext();){var node=i.next();if(node.getLabel().getLocation(geomIndex)===Location.BOUNDARY){bdyNodes.add(node);}}
return bdyNodes;};})();(function(){var ArrayList=javascript.util.ArrayList;jsts.geomgraph.PlanarGraph=function(nodeFactory){this.edges=new ArrayList();this.edgeEndList=new ArrayList();this.nodes=new jsts.geomgraph.NodeMap(nodeFactory||new jsts.geomgraph.NodeFactory());};jsts.geomgraph.PlanarGraph.prototype.edges=null;jsts.geomgraph.PlanarGraph.prototype.nodes=null;jsts.geomgraph.PlanarGraph.prototype.edgeEndList=null;jsts.geomgraph.PlanarGraph.linkResultDirectedEdges=function(nodes){for(var nodeit=nodes.iterator();nodeit.hasNext();){var node=nodeit.next();node.getEdges().linkResultDirectedEdges();}};jsts.geomgraph.PlanarGraph.prototype.getEdgeIterator=function(){return this.edges.iterator();};jsts.geomgraph.PlanarGraph.prototype.getEdgeEnds=function(){return this.edgeEndList;};jsts.geomgraph.PlanarGraph.prototype.isBoundaryNode=function(geomIndex,coord){var node=this.nodes.find(coord);if(node===null)
return false;var label=node.getLabel();if(label!==null&&label.getLocation(geomIndex)===jsts.geom.Location.BOUNDARY)
return true;return false;};jsts.geomgraph.PlanarGraph.prototype.insertEdge=function(e){this.edges.add(e);};jsts.geomgraph.PlanarGraph.prototype.add=function(e){this.nodes.add(e);this.edgeEndList.add(e);};jsts.geomgraph.PlanarGraph.prototype.getNodeIterator=function(){return this.nodes.iterator();};jsts.geomgraph.PlanarGraph.prototype.getNodes=function(){return this.nodes.values();};jsts.geomgraph.PlanarGraph.prototype.addNode=function(node){return this.nodes.addNode(node);};jsts.geomgraph.PlanarGraph.prototype.addEdges=function(edgesToAdd){for(var it=edgesToAdd.iterator();it.hasNext();){var e=it.next();this.edges.add(e);var de1=new jsts.geomgraph.DirectedEdge(e,true);var de2=new jsts.geomgraph.DirectedEdge(e,false);de1.setSym(de2);de2.setSym(de1);this.add(de1);this.add(de2);}};jsts.geomgraph.PlanarGraph.prototype.linkResultDirectedEdges=function(){for(var nodeit=this.nodes.iterator();nodeit.hasNext();){var node=nodeit.next();node.getEdges().linkResultDirectedEdges();}};jsts.geomgraph.PlanarGraph.prototype.findEdgeInSameDirection=function(p0,p1){var i=0,il=this.edges.size(),e,eCoord;for(i;i<il;i++){e=this.edges.get(i);eCoord=e.getCoordinates();if(this.matchInSameDirection(p0,p1,eCoord[0],eCoord[1])){return e;}
if(this.matchInSameDirection(p0,p1,eCoord[eCoord.length-1],eCoord[eCoord.length-2])){return e;}}
return null;};jsts.geomgraph.PlanarGraph.prototype.matchInSameDirection=function(p0,p1,ep0,ep1){if(!p0.equals(ep0)){return false;}
if(jsts.algorithm.CGAlgorithms.computeOrientation(p0,p1,ep1)===jsts.algorithm.CGAlgorithms.COLLINEAR&&jsts.geomgraph.Quadrant.quadrant(p0,p1)===jsts.geomgraph.Quadrant.quadrant(ep0,ep1)){return true;}
return false;};jsts.geomgraph.PlanarGraph.prototype.findEdgeEnd=function(e){for(var i=this.getEdgeEnds().iterator();i.hasNext();){var ee=i.next();if(ee.getEdge()===e){return ee;}}
return null;};})();jsts.noding.SegmentIntersector=function(){};jsts.noding.SegmentIntersector.prototype.processIntersections=jsts.abstractFunc;jsts.noding.SegmentIntersector.prototype.isDone=jsts.abstractFunc;(function(){var SegmentIntersector=jsts.noding.SegmentIntersector;var ArrayList=javascript.util.ArrayList;jsts.noding.InteriorIntersectionFinder=function(li){this.li=li;this.intersections=new ArrayList();this.interiorIntersection=null;};jsts.noding.InteriorIntersectionFinder.prototype=new SegmentIntersector();jsts.noding.InteriorIntersectionFinder.constructor=jsts.noding.InteriorIntersectionFinder;jsts.noding.InteriorIntersectionFinder.prototype.findAllIntersections=false;jsts.noding.InteriorIntersectionFinder.prototype.isCheckEndSegmentsOnly=false;jsts.noding.InteriorIntersectionFinder.prototype.li=null;jsts.noding.InteriorIntersectionFinder.prototype.interiorIntersection=null;jsts.noding.InteriorIntersectionFinder.prototype.intSegments=null;jsts.noding.InteriorIntersectionFinder.prototype.intersections=null;jsts.noding.InteriorIntersectionFinder.prototype.setFindAllIntersections=function(findAllIntersections){this.findAllIntersections=findAllIntersections;};jsts.noding.InteriorIntersectionFinder.prototype.getIntersections=function(){return intersections;};jsts.noding.InteriorIntersectionFinder.prototype.setCheckEndSegmentsOnly=function(isCheckEndSegmentsOnly){this.isCheckEndSegmentsOnly=isCheckEndSegmentsOnly;}
jsts.noding.InteriorIntersectionFinder.prototype.hasIntersection=function(){return this.interiorIntersection!=null;};jsts.noding.InteriorIntersectionFinder.prototype.getInteriorIntersection=function(){return this.interiorIntersection;};jsts.noding.InteriorIntersectionFinder.prototype.getIntersectionSegments=function(){return this.intSegments;};jsts.noding.InteriorIntersectionFinder.prototype.processIntersections=function(e0,segIndex0,e1,segIndex1){if(this.hasIntersection())
return;if(e0==e1&&segIndex0==segIndex1)
return;if(this.isCheckEndSegmentsOnly){var isEndSegPresent=this.isEndSegment(e0,segIndex0)||isEndSegment(e1,segIndex1);if(!isEndSegPresent)
return;}
var p00=e0.getCoordinates()[segIndex0];var p01=e0.getCoordinates()[segIndex0+1];var p10=e1.getCoordinates()[segIndex1];var p11=e1.getCoordinates()[segIndex1+1];this.li.computeIntersection(p00,p01,p10,p11);if(this.li.hasIntersection()){if(this.li.isInteriorIntersection()){this.intSegments=[];this.intSegments[0]=p00;this.intSegments[1]=p01;this.intSegments[2]=p10;this.intSegments[3]=p11;this.interiorIntersection=this.li.getIntersection(0);this.intersections.add(this.interiorIntersection);}}};jsts.noding.InteriorIntersectionFinder.prototype.isEndSegment=function(segStr,index){if(index==0)
return true;if(index>=segStr.size()-2)
return true;return false;};jsts.noding.InteriorIntersectionFinder.prototype.isDone=function(){if(this.findAllIntersections)
return false;return this.interiorIntersection!=null;};})();(function(){var RobustLineIntersector=jsts.algorithm.RobustLineIntersector;var InteriorIntersectionFinder=jsts.noding.InteriorIntersectionFinder;var MCIndexNoder=jsts.noding.MCIndexNoder;jsts.noding.FastNodingValidator=function(segStrings){this.li=new RobustLineIntersector();this.segStrings=segStrings;};jsts.noding.FastNodingValidator.prototype.li=null;jsts.noding.FastNodingValidator.prototype.segStrings=null;jsts.noding.FastNodingValidator.prototype.findAllIntersections=false;jsts.noding.FastNodingValidator.prototype.segInt=null;jsts.noding.FastNodingValidator.prototype._isValid=true;jsts.noding.FastNodingValidator.prototype.setFindAllIntersections=function(findAllIntersections){this.findAllIntersections=findAllIntersections;};jsts.noding.FastNodingValidator.prototype.getIntersections=function(){return segInt.getIntersections();};jsts.noding.FastNodingValidator.prototype.isValid=function(){this.execute();return this._isValid;};jsts.noding.FastNodingValidator.prototype.getErrorMessage=function(){if(this._isValid)
return'no intersections found';var intSegs=this.segInt.getIntersectionSegments();return'found non-noded intersection between '+
jsts.io.WKTWriter.toLineString(intSegs[0],intSegs[1])+' and '+
jsts.io.WKTWriter.toLineString(intSegs[2],intSegs[3]);};jsts.noding.FastNodingValidator.prototype.checkValid=function(){this.execute();if(!this._isValid)
throw new jsts.error.TopologyError(this.getErrorMessage(),this.segInt.getInteriorIntersection());};jsts.noding.FastNodingValidator.prototype.execute=function(){if(this.segInt!=null)
return;this.checkInteriorIntersections();};jsts.noding.FastNodingValidator.prototype.checkInteriorIntersections=function(){this._isValid=true;this.segInt=new InteriorIntersectionFinder(this.li);this.segInt.setFindAllIntersections(this.findAllIntersections);var noder=new MCIndexNoder();noder.setSegmentIntersector(this.segInt);noder.computeNodes(this.segStrings);if(this.segInt.hasIntersection()){this._isValid=false;return;}};})();(function(){jsts.noding.BasicSegmentString=function(pts,data){this.pts=pts;this.data=data;};jsts.noding.BasicSegmentString.prototype=new jsts.noding.SegmentString();jsts.noding.BasicSegmentString.prototype.pts=null;jsts.noding.BasicSegmentString.prototype.data=null;jsts.noding.BasicSegmentString.prototype.getData=function(){return this.data;}
jsts.noding.BasicSegmentString.prototype.setData=function(data){this.data=data;};jsts.noding.BasicSegmentString.prototype.size=function(){return this.pts.length;};jsts.noding.BasicSegmentString.prototype.getCoordinate=function(i){return this.pts[i];};jsts.noding.BasicSegmentString.prototype.getCoordinates=function(){return this.pts;};jsts.noding.BasicSegmentString.prototype.isClosed=function(){return this.pts[0].equals(this.pts[this.pts.length-1]);};jsts.noding.BasicSegmentString.prototype.getSegmentOctant=function(index){if(index==this.pts.length-1)
return-1;return jsts.noding.Octant.octant(this.getCoordinate(index),this.getCoordinate(index+1));};})();(function(){var FastNodingValidator=jsts.noding.FastNodingValidator;var BasicSegmentString=jsts.noding.BasicSegmentString;var ArrayList=javascript.util.ArrayList;jsts.geomgraph.EdgeNodingValidator=function(edges){this.nv=new FastNodingValidator(jsts.geomgraph.EdgeNodingValidator.toSegmentStrings(edges));};jsts.geomgraph.EdgeNodingValidator.checkValid=function(edges){var validator=new jsts.geomgraph.EdgeNodingValidator(edges);validator.checkValid();};jsts.geomgraph.EdgeNodingValidator.toSegmentStrings=function(edges){var segStrings=new ArrayList();for(var i=edges.iterator();i.hasNext();){var e=i.next();segStrings.add(new BasicSegmentString(e.getCoordinates(),e));}
return segStrings;};jsts.geomgraph.EdgeNodingValidator.prototype.nv=null;jsts.geomgraph.EdgeNodingValidator.prototype.checkValid=function(){this.nv.checkValid();};})();jsts.operation.GeometryGraphOperation=function(g0,g1,boundaryNodeRule){this.li=new jsts.algorithm.RobustLineIntersector();this.arg=[];if(g0===undefined){return;}
if(g1===undefined){this.setComputationPrecision(g0.getPrecisionModel());this.arg[0]=new jsts.geomgraph.GeometryGraph(0,g0);return;}
boundaryNodeRule=boundaryNodeRule||jsts.algorithm.BoundaryNodeRule.OGC_SFS_BOUNDARY_RULE;if(g0.getPrecisionModel().compareTo(g1.getPrecisionModel())>=0)
this.setComputationPrecision(g0.getPrecisionModel());else
this.setComputationPrecision(g1.getPrecisionModel());this.arg[0]=new jsts.geomgraph.GeometryGraph(0,g0,boundaryNodeRule);this.arg[1]=new jsts.geomgraph.GeometryGraph(1,g1,boundaryNodeRule);};jsts.operation.GeometryGraphOperation.prototype.li=null;jsts.operation.GeometryGraphOperation.prototype.resultPrecisionModel=null;jsts.operation.GeometryGraphOperation.prototype.arg=null;jsts.operation.GeometryGraphOperation.prototype.getArgGeometry=function(i){return arg[i].getGeometry();};jsts.operation.GeometryGraphOperation.prototype.setComputationPrecision=function(pm){this.resultPrecisionModel=pm;this.li.setPrecisionModel(this.resultPrecisionModel);};jsts.operation.overlay.OverlayNodeFactory=function(){};jsts.operation.overlay.OverlayNodeFactory.prototype=new jsts.geomgraph.NodeFactory();jsts.operation.overlay.OverlayNodeFactory.constructor=jsts.operation.overlay.OverlayNodeFactory;jsts.operation.overlay.OverlayNodeFactory.prototype.createNode=function(coord){return new jsts.geomgraph.Node(coord,new jsts.geomgraph.DirectedEdgeStar());};jsts.operation.overlay.PolygonBuilder=function(geometryFactory){this.shellList=[];this.geometryFactory=geometryFactory;};jsts.operation.overlay.PolygonBuilder.prototype.geometryFactory=null;jsts.operation.overlay.PolygonBuilder.prototype.shellList=null;jsts.operation.overlay.PolygonBuilder.prototype.add=function(graph){if(arguments.length===2){this.add2.apply(this,arguments);return;}
this.add2(graph.getEdgeEnds(),graph.getNodes());};jsts.operation.overlay.PolygonBuilder.prototype.add2=function(dirEdges,nodes){jsts.geomgraph.PlanarGraph.linkResultDirectedEdges(nodes);var maxEdgeRings=this.buildMaximalEdgeRings(dirEdges);var freeHoleList=[];var edgeRings=this.buildMinimalEdgeRings(maxEdgeRings,this.shellList,freeHoleList);this.sortShellsAndHoles(edgeRings,this.shellList,freeHoleList);this.placeFreeHoles(this.shellList,freeHoleList);};jsts.operation.overlay.PolygonBuilder.prototype.getPolygons=function(){var resultPolyList=this.computePolygons(this.shellList);return resultPolyList;};jsts.operation.overlay.PolygonBuilder.prototype.buildMaximalEdgeRings=function(dirEdges){var maxEdgeRings=[];for(var it=dirEdges.iterator();it.hasNext();){var de=it.next();if(de.isInResult()&&de.getLabel().isArea()){if(de.getEdgeRing()==null){var er=new jsts.operation.overlay.MaximalEdgeRing(de,this.geometryFactory);maxEdgeRings.push(er);er.setInResult();}}}
return maxEdgeRings;};jsts.operation.overlay.PolygonBuilder.prototype.buildMinimalEdgeRings=function(maxEdgeRings,shellList,freeHoleList){var edgeRings=[];for(var i=0;i<maxEdgeRings.length;i++){var er=maxEdgeRings[i];if(er.getMaxNodeDegree()>2){er.linkDirectedEdgesForMinimalEdgeRings();var minEdgeRings=er.buildMinimalRings();var shell=this.findShell(minEdgeRings);if(shell!==null){this.placePolygonHoles(shell,minEdgeRings);shellList.push(shell);}else{freeHoleList=freeHoleList.concat(minEdgeRings);}}else{edgeRings.push(er);}}
return edgeRings;};jsts.operation.overlay.PolygonBuilder.prototype.findShell=function(minEdgeRings){var shellCount=0;var shell=null;for(var i=0;i<minEdgeRings.length;i++){var er=minEdgeRings[i];if(!er.isHole()){shell=er;shellCount++;}}
jsts.util.Assert.isTrue(shellCount<=1,'found two shells in MinimalEdgeRing list');return shell;};jsts.operation.overlay.PolygonBuilder.prototype.placePolygonHoles=function(shell,minEdgeRings){for(var i=0;i<minEdgeRings.length;i++){var er=minEdgeRings[i];if(er.isHole()){er.setShell(shell);}}};jsts.operation.overlay.PolygonBuilder.prototype.sortShellsAndHoles=function(edgeRings,shellList,freeHoleList){for(var i=0;i<edgeRings.length;i++){var er=edgeRings[i];if(er.isHole()){freeHoleList.push(er);}else{shellList.push(er);}}};jsts.operation.overlay.PolygonBuilder.prototype.placeFreeHoles=function(shellList,freeHoleList){for(var i=0;i<freeHoleList.length;i++){var hole=freeHoleList[i];if(hole.getShell()==null){var shell=this.findEdgeRingContaining(hole,shellList);if(shell===null)
throw new jsts.error.TopologyError('unable to assign hole to a shell',hole.getCoordinate(0));hole.setShell(shell);}}};jsts.operation.overlay.PolygonBuilder.prototype.findEdgeRingContaining=function(testEr,shellList){var testRing=testEr.getLinearRing();var testEnv=testRing.getEnvelopeInternal();var testPt=testRing.getCoordinateN(0);var minShell=null;var minEnv=null;for(var i=0;i<shellList.length;i++){var tryShell=shellList[i];var tryRing=tryShell.getLinearRing();var tryEnv=tryRing.getEnvelopeInternal();if(minShell!==null)
minEnv=minShell.getLinearRing().getEnvelopeInternal();var isContained=false;if(tryEnv.contains(testEnv)&&jsts.algorithm.CGAlgorithms.isPointInRing(testPt,tryRing.getCoordinates()))
isContained=true;if(isContained){if(minShell==null||minEnv.contains(tryEnv)){minShell=tryShell;}}}
return minShell;};jsts.operation.overlay.PolygonBuilder.prototype.computePolygons=function(shellList){var resultPolyList=new javascript.util.ArrayList();for(var i=0;i<shellList.length;i++){var er=shellList[i];var poly=er.toPolygon(this.geometryFactory);resultPolyList.add(poly);}
return resultPolyList;};jsts.operation.overlay.PolygonBuilder.prototype.containsPoint=function(p){for(var i=0;i<this.shellList.length;i++){var er=this.shellList[i];if(er.containsPoint(p))
return true;}
return false;};(function(){var Assert=jsts.util.Assert;var ArrayList=javascript.util.ArrayList;var LineBuilder=function(op,geometryFactory,ptLocator){this.lineEdgesList=new ArrayList();this.resultLineList=new ArrayList();this.op=op;this.geometryFactory=geometryFactory;this.ptLocator=ptLocator;};LineBuilder.prototype.op=null;LineBuilder.prototype.geometryFactory=null;LineBuilder.prototype.ptLocator=null;LineBuilder.prototype.lineEdgesList=null;LineBuilder.prototype.resultLineList=null;LineBuilder.prototype.build=function(opCode){this.findCoveredLineEdges();this.collectLines(opCode);this.buildLines(opCode);return this.resultLineList;};LineBuilder.prototype.findCoveredLineEdges=function(){for(var nodeit=this.op.getGraph().getNodes().iterator();nodeit.hasNext();){var node=nodeit.next();node.getEdges().findCoveredLineEdges();}
for(var it=this.op.getGraph().getEdgeEnds().iterator();it.hasNext();){var de=it.next();var e=de.getEdge();if(de.isLineEdge()&&!e.isCoveredSet()){var isCovered=this.op.isCoveredByA(de.getCoordinate());e.setCovered(isCovered);}}};LineBuilder.prototype.collectLines=function(opCode){for(var it=this.op.getGraph().getEdgeEnds().iterator();it.hasNext();){var de=it.next();this.collectLineEdge(de,opCode,this.lineEdgesList);this.collectBoundaryTouchEdge(de,opCode,this.lineEdgesList);}};LineBuilder.prototype.collectLineEdge=function(de,opCode,edges){var label=de.getLabel();var e=de.getEdge();if(de.isLineEdge()){if(!de.isVisited()&&jsts.operation.overlay.OverlayOp.isResultOfOp(label,opCode)&&!e.isCovered()){edges.add(e);de.setVisitedEdge(true);}}};LineBuilder.prototype.collectBoundaryTouchEdge=function(de,opCode,edges){var label=de.getLabel();if(de.isLineEdge())
return;if(de.isVisited())
return;if(de.isInteriorAreaEdge())
return;if(de.getEdge().isInResult())
return;Assert.isTrue(!(de.isInResult()||de.getSym().isInResult())||!de.getEdge().isInResult());if(jsts.operation.overlay.OverlayOp.isResultOfOp(label,opCode)&&opCode===jsts.operation.overlay.OverlayOp.INTERSECTION){edges.add(de.getEdge());de.setVisitedEdge(true);}};LineBuilder.prototype.buildLines=function(opCode){for(var it=this.lineEdgesList.iterator();it.hasNext();){var e=it.next();var label=e.getLabel();var line=this.geometryFactory.createLineString(e.getCoordinates());this.resultLineList.add(line);e.setInResult(true);}};LineBuilder.prototype.labelIsolatedLines=function(edgesList){for(var it=edgesList.iterator();it.hasNext();){var e=it.next();var label=e.getLabel();if(e.isIsolated()){if(label.isNull(0))
this.labelIsolatedLine(e,0);else
this.labelIsolatedLine(e,1);}}};LineBuilder.prototype.labelIsolatedLine=function(e,targetIndex){var loc=ptLocator.locate(e.getCoordinate(),op.getArgGeometry(targetIndex));e.getLabel().setLocation(targetIndex,loc);};jsts.operation.overlay.LineBuilder=LineBuilder;})();(function(){var ArrayList=javascript.util.ArrayList;var PointBuilder=function(op,geometryFactory,ptLocator){this.resultPointList=new ArrayList();this.op=op;this.geometryFactory=geometryFactory;};PointBuilder.prototype.op=null;PointBuilder.prototype.geometryFactory=null;PointBuilder.prototype.resultPointList=null;PointBuilder.prototype.build=function(opCode){this.extractNonCoveredResultNodes(opCode);return this.resultPointList;};PointBuilder.prototype.extractNonCoveredResultNodes=function(opCode){for(var nodeit=this.op.getGraph().getNodes().iterator();nodeit.hasNext();){var n=nodeit.next();if(n.isInResult())
continue;if(n.isIncidentEdgeInResult())
continue;if(n.getEdges().getDegree()===0||opCode===jsts.operation.overlay.OverlayOp.INTERSECTION){var label=n.getLabel();if(jsts.operation.overlay.OverlayOp.isResultOfOp(label,opCode)){this.filterCoveredNodeToPoint(n);}}}};PointBuilder.prototype.filterCoveredNodeToPoint=function(n){var coord=n.getCoordinate();if(!this.op.isCoveredByLA(coord)){var pt=this.geometryFactory.createPoint(coord);this.resultPointList.add(pt);}};jsts.operation.overlay.PointBuilder=PointBuilder;})();(function(){var PointLocator=jsts.algorithm.PointLocator;var Location=jsts.geom.Location;var EdgeList=jsts.geomgraph.EdgeList;var Label=jsts.geomgraph.Label;var PlanarGraph=jsts.geomgraph.PlanarGraph;var Position=jsts.geomgraph.Position;var EdgeNodingValidator=jsts.geomgraph.EdgeNodingValidator;var GeometryGraphOperation=jsts.operation.GeometryGraphOperation;var OverlayNodeFactory=jsts.operation.overlay.OverlayNodeFactory;var PolygonBuilder=jsts.operation.overlay.PolygonBuilder;var LineBuilder=jsts.operation.overlay.LineBuilder;var PointBuilder=jsts.operation.overlay.PointBuilder;var Assert=jsts.util.Assert;var ArrayList=javascript.util.ArrayList;jsts.operation.overlay.OverlayOp=function(g0,g1){this.ptLocator=new PointLocator();this.edgeList=new EdgeList();this.resultPolyList=new ArrayList();this.resultLineList=new ArrayList();this.resultPointList=new ArrayList();GeometryGraphOperation.call(this,g0,g1);this.graph=new PlanarGraph(new OverlayNodeFactory());this.geomFact=g0.getFactory();};jsts.operation.overlay.OverlayOp.prototype=new GeometryGraphOperation();jsts.operation.overlay.OverlayOp.constructor=jsts.operation.overlay.OverlayOp;jsts.operation.overlay.OverlayOp.INTERSECTION=1;jsts.operation.overlay.OverlayOp.UNION=2;jsts.operation.overlay.OverlayOp.DIFFERENCE=3;jsts.operation.overlay.OverlayOp.SYMDIFFERENCE=4;jsts.operation.overlay.OverlayOp.overlayOp=function(geom0,geom1,opCode){var gov=new jsts.operation.overlay.OverlayOp(geom0,geom1);var geomOv=gov.getResultGeometry(opCode);return geomOv;}
jsts.operation.overlay.OverlayOp.isResultOfOp=function(label,opCode){if(arguments.length===3){return jsts.operation.overlay.OverlayOp.isResultOfOp2.apply(this,arguments);}
var loc0=label.getLocation(0);var loc1=label.getLocation(1);return jsts.operation.overlay.OverlayOp.isResultOfOp2(loc0,loc1,opCode);}
jsts.operation.overlay.OverlayOp.isResultOfOp2=function(loc0,loc1,opCode){if(loc0==Location.BOUNDARY)
loc0=Location.INTERIOR;if(loc1==Location.BOUNDARY)
loc1=Location.INTERIOR;switch(opCode){case jsts.operation.overlay.OverlayOp.INTERSECTION:return loc0==Location.INTERIOR&&loc1==Location.INTERIOR;case jsts.operation.overlay.OverlayOp.UNION:return loc0==Location.INTERIOR||loc1==Location.INTERIOR;case jsts.operation.overlay.OverlayOp.DIFFERENCE:return loc0==Location.INTERIOR&&loc1!=Location.INTERIOR;case jsts.operation.overlay.OverlayOp.SYMDIFFERENCE:return(loc0==Location.INTERIOR&&loc1!=Location.INTERIOR)||(loc0!=Location.INTERIOR&&loc1==Location.INTERIOR);}
return false;}
jsts.operation.overlay.OverlayOp.prototype.ptLocator=null;jsts.operation.overlay.OverlayOp.prototype.geomFact=null;jsts.operation.overlay.OverlayOp.prototype.resultGeom=null;jsts.operation.overlay.OverlayOp.prototype.graph=null;jsts.operation.overlay.OverlayOp.prototype.edgeList=null;jsts.operation.overlay.OverlayOp.prototype.resultPolyList=null;jsts.operation.overlay.OverlayOp.prototype.resultLineList=null;jsts.operation.overlay.OverlayOp.prototype.resultPointList=null;jsts.operation.overlay.OverlayOp.prototype.getResultGeometry=function(funcCode){this.computeOverlay(funcCode);return this.resultGeom;}
jsts.operation.overlay.OverlayOp.prototype.getGraph=function(){return this.graph;}
jsts.operation.overlay.OverlayOp.prototype.computeOverlay=function(opCode){this.copyPoints(0);this.copyPoints(1);this.arg[0].computeSelfNodes(this.li,false);this.arg[1].computeSelfNodes(this.li,false);this.arg[0].computeEdgeIntersections(this.arg[1],this.li,true);var baseSplitEdges=new ArrayList();this.arg[0].computeSplitEdges(baseSplitEdges);this.arg[1].computeSplitEdges(baseSplitEdges);var splitEdges=baseSplitEdges;this.insertUniqueEdges(baseSplitEdges);this.computeLabelsFromDepths();this.replaceCollapsedEdges();EdgeNodingValidator.checkValid(this.edgeList.getEdges());this.graph.addEdges(this.edgeList.getEdges());this.computeLabelling();this.labelIncompleteNodes();this.findResultAreaEdges(opCode);this.cancelDuplicateResultEdges();var polyBuilder=new PolygonBuilder(this.geomFact);polyBuilder.add(this.graph);this.resultPolyList=polyBuilder.getPolygons();var lineBuilder=new LineBuilder(this,this.geomFact,this.ptLocator);this.resultLineList=lineBuilder.build(opCode);var pointBuilder=new PointBuilder(this,this.geomFact,this.ptLocator);this.resultPointList=pointBuilder.build(opCode);this.resultGeom=this.computeGeometry(this.resultPointList,this.resultLineList,this.resultPolyList,opCode);}
jsts.operation.overlay.OverlayOp.prototype.insertUniqueEdges=function(edges){for(var i=edges.iterator();i.hasNext();){var e=i.next();this.insertUniqueEdge(e);}}
jsts.operation.overlay.OverlayOp.prototype.insertUniqueEdge=function(e){var existingEdge=this.edgeList.findEqualEdge(e);if(existingEdge!==null){var existingLabel=existingEdge.getLabel();var labelToMerge=e.getLabel();if(!existingEdge.isPointwiseEqual(e)){labelToMerge=new Label(e.getLabel());labelToMerge.flip();}
var depth=existingEdge.getDepth();if(depth.isNull()){depth.add(existingLabel);}
depth.add(labelToMerge);existingLabel.merge(labelToMerge);}else{this.edgeList.add(e);}};jsts.operation.overlay.OverlayOp.prototype.computeLabelsFromDepths=function(){for(var it=this.edgeList.iterator();it.hasNext();){var e=it.next();var lbl=e.getLabel();var depth=e.getDepth();if(!depth.isNull()){depth.normalize();for(var i=0;i<2;i++){if(!lbl.isNull(i)&&lbl.isArea()&&!depth.isNull(i)){if(depth.getDelta(i)==0){lbl.toLine(i);}else{Assert.isTrue(!depth.isNull(i,Position.LEFT),'depth of LEFT side has not been initialized');lbl.setLocation(i,Position.LEFT,depth.getLocation(i,Position.LEFT));Assert.isTrue(!depth.isNull(i,Position.RIGHT),'depth of RIGHT side has not been initialized');lbl.setLocation(i,Position.RIGHT,depth.getLocation(i,Position.RIGHT));}}}}}}
jsts.operation.overlay.OverlayOp.prototype.replaceCollapsedEdges=function(){var newEdges=new ArrayList();for(var it=this.edgeList.iterator();it.hasNext();){var e=it.next();if(e.isCollapsed()){it.remove();newEdges.add(e.getCollapsedEdge());}}
this.edgeList.addAll(newEdges);}
jsts.operation.overlay.OverlayOp.prototype.copyPoints=function(argIndex){for(var i=this.arg[argIndex].getNodeIterator();i.hasNext();){var graphNode=i.next();var newNode=this.graph.addNode(graphNode.getCoordinate());newNode.setLabel(argIndex,graphNode.getLabel().getLocation(argIndex));}}
jsts.operation.overlay.OverlayOp.prototype.computeLabelling=function(){for(var nodeit=this.graph.getNodes().iterator();nodeit.hasNext();){var node=nodeit.next();node.getEdges().computeLabelling(this.arg);}
this.mergeSymLabels();this.updateNodeLabelling();}
jsts.operation.overlay.OverlayOp.prototype.mergeSymLabels=function(){for(var nodeit=this.graph.getNodes().iterator();nodeit.hasNext();){var node=nodeit.next();node.getEdges().mergeSymLabels();}}
jsts.operation.overlay.OverlayOp.prototype.updateNodeLabelling=function(){for(var nodeit=this.graph.getNodes().iterator();nodeit.hasNext();){var node=nodeit.next();var lbl=node.getEdges().getLabel();node.getLabel().merge(lbl);}}
jsts.operation.overlay.OverlayOp.prototype.labelIncompleteNodes=function(){var nodeCount=0;for(var ni=this.graph.getNodes().iterator();ni.hasNext();){var n=ni.next();var label=n.getLabel();if(n.isIsolated()){nodeCount++;if(label.isNull(0))
this.labelIncompleteNode(n,0);else
this.labelIncompleteNode(n,1);}
n.getEdges().updateLabelling(label);}};jsts.operation.overlay.OverlayOp.prototype.labelIncompleteNode=function(n,targetIndex){var loc=this.ptLocator.locate(n.getCoordinate(),this.arg[targetIndex].getGeometry());n.getLabel().setLocation(targetIndex,loc);};jsts.operation.overlay.OverlayOp.prototype.findResultAreaEdges=function(opCode){for(var it=this.graph.getEdgeEnds().iterator();it.hasNext();){var de=it.next();var label=de.getLabel();if(label.isArea()&&!de.isInteriorAreaEdge()&&jsts.operation.overlay.OverlayOp.isResultOfOp(label.getLocation(0,Position.RIGHT),label.getLocation(1,Position.RIGHT),opCode)){de.setInResult(true);}}};jsts.operation.overlay.OverlayOp.prototype.cancelDuplicateResultEdges=function(){for(var it=this.graph.getEdgeEnds().iterator();it.hasNext();){var de=it.next();var sym=de.getSym();if(de.isInResult()&&sym.isInResult()){de.setInResult(false);sym.setInResult(false);}}};jsts.operation.overlay.OverlayOp.prototype.isCoveredByLA=function(coord){if(this.isCovered(coord,this.resultLineList))
return true;if(this.isCovered(coord,this.resultPolyList))
return true;return false;};jsts.operation.overlay.OverlayOp.prototype.isCoveredByA=function(coord){if(this.isCovered(coord,this.resultPolyList))
return true;return false;};jsts.operation.overlay.OverlayOp.prototype.isCovered=function(coord,geomList){for(var it=geomList.iterator();it.hasNext();){var geom=it.next();var loc=this.ptLocator.locate(coord,geom);if(loc!=Location.EXTERIOR)
return true;}
return false;};jsts.operation.overlay.OverlayOp.prototype.computeGeometry=function(resultPointList,resultLineList,resultPolyList,opcode){var geomList=new ArrayList();geomList.addAll(resultPointList);geomList.addAll(resultLineList);geomList.addAll(resultPolyList);return this.geomFact.buildGeometry(geomList);};jsts.operation.overlay.OverlayOp.prototype.createEmptyResult=function(opCode){var result=null;switch(resultDimension(opCode,this.arg[0].getGeometry(),this.arg[1].getGeometry())){case-1:result=geomFact.createGeometryCollection();break;case 0:result=geomFact.createPoint(null);break;case 1:result=geomFact.createLineString(null);break;case 2:result=geomFact.createPolygon(null,null);break;}
return result;};jsts.operation.overlay.OverlayOp.prototype.resultDimension=function(opCode,g0,g1){var dim0=g0.getDimension();var dim1=g1.getDimension();var resultDimension=-1;switch(opCode){case jsts.operation.overlay.OverlayOp.INTERSECTION:resultDimension=Math.min(dim0,dim1);break;case jsts.operation.overlay.OverlayOp.UNION:resultDimension=Math.max(dim0,dim1);break;case jsts.operation.overlay.OverlayOp.DIFFERENCE:resultDimension=dim0;break;case jsts.operation.overlay.OverlayOp.SYMDIFFERENCE:resultDimension=Math.max(dim0,dim1);break;}
return resultDimension;};})();(function(){var OverlayOp=jsts.operation.overlay.OverlayOp;var GeometrySnapper=jsts.operation.overlay.snap.GeometrySnapper;var SnapOverlayOp=function(g1,g2){this.geom=[];this.geom[0]=g1;this.geom[1]=g2;this.computeSnapTolerance();};SnapOverlayOp.overlayOp=function(g0,g1,opCode){var op=new SnapOverlayOp(g0,g1);return op.getResultGeometry(opCode);};SnapOverlayOp.intersection=function(g0,g1){return this.overlayOp(g0,g1,OverlayOp.INTERSECTION);};SnapOverlayOp.union=function(g0,g1){return this.overlayOp(g0,g1,OverlayOp.UNION);};SnapOverlayOp.difference=function(g0,g1){return overlayOp(g0,g1,OverlayOp.DIFFERENCE);};SnapOverlayOp.symDifference=function(g0,g1){return overlayOp(g0,g1,OverlayOp.SYMDIFFERENCE);};SnapOverlayOp.prototype.geom=null;SnapOverlayOp.prototype.snapTolerance=null;SnapOverlayOp.prototype.computeSnapTolerance=function(){this.snapTolerance=GeometrySnapper.computeOverlaySnapTolerance(this.geom[0],this.geom[1]);};SnapOverlayOp.prototype.getResultGeometry=function(opCode){var prepGeom=this.snap(this.geom);var result=OverlayOp.overlayOp(prepGeom[0],prepGeom[1],opCode);return this.prepareResult(result);};SnapOverlayOp.prototype.selfSnap=function(geom){var snapper0=new GeometrySnapper(geom);var snapGeom=snapper0.snapTo(geom,this.snapTolerance);return snapGeom;};SnapOverlayOp.prototype.snap=function(geom){var remGeom=geom;var snapGeom=GeometrySnapper.snap(remGeom[0],remGeom[1],this.snapTolerance);return snapGeom;};SnapOverlayOp.prototype.prepareResult=function(geom){return geom;};SnapOverlayOp.prototype.cbr=null;SnapOverlayOp.prototype.removeCommonBits=function(geom){this.cbr=new jsts.precision.CommonBitsRemover();this.cbr.add(this.geom[0]);this.cbr.add(this.geom[1]);var remGeom=[];remGeom[0]=cbr.removeCommonBits(this.geom[0].clone());remGeom[1]=cbr.removeCommonBits(this.geom[1].clone());return remGeom;};jsts.operation.overlay.snap.SnapOverlayOp=SnapOverlayOp;})();jsts.geomgraph.index.EdgeSetIntersector=function(){};jsts.geomgraph.index.EdgeSetIntersector.prototype.computeIntersections=function(edges,si,testAllSegments){throw new jsts.error.AbstractMethodInvocationError();};jsts.geomgraph.index.EdgeSetIntersector.prototype.computeIntersections2=function(edges0,edges1,si){throw new jsts.error.AbstractMethodInvocationError();};jsts.geomgraph.index.SimpleMCSweepLineIntersector=function(){this.events=[];};jsts.geomgraph.index.SimpleMCSweepLineIntersector.prototype=new jsts.geomgraph.index.EdgeSetIntersector();jsts.geomgraph.index.SimpleMCSweepLineIntersector.prototype.events=null;jsts.geomgraph.index.SimpleMCSweepLineIntersector.prototype.nOverlaps=0;jsts.geomgraph.index.SimpleMCSweepLineIntersector.prototype.computeIntersections=function(edges,si,testAllSegments){if(si instanceof javascript.util.List){this.computeIntersections2.apply(this,arguments);return;}
if(testAllSegments){this.addList2(edges,null);}else{this.addList(edges);}
this.computeIntersections3(si);};jsts.geomgraph.index.SimpleMCSweepLineIntersector.prototype.computeIntersections2=function(edges0,edges1,si){this.addList2(edges0,edges0);this.addList2(edges1,edges1);this.computeIntersections3(si);};jsts.geomgraph.index.SimpleMCSweepLineIntersector.prototype.add=function(edge,edgeSet){if(edge instanceof javascript.util.List){this.addList.apply(this,arguments);return;}
var mce=edge.getMonotoneChainEdge();var startIndex=mce.getStartIndexes();for(var i=0;i<startIndex.length-1;i++){var mc=new jsts.geomgraph.index.MonotoneChain(mce,i);var insertEvent=new jsts.geomgraph.index.SweepLineEvent(mce.getMinX(i),mc,edgeSet);this.events.push(insertEvent);this.events.push(new jsts.geomgraph.index.SweepLineEvent(mce.getMaxX(i),insertEvent));}};jsts.geomgraph.index.SimpleMCSweepLineIntersector.prototype.addList=function(edges){for(var i=edges.iterator();i.hasNext();){var edge=i.next();this.add(edge,edge);}};jsts.geomgraph.index.SimpleMCSweepLineIntersector.prototype.addList2=function(edges,edgeSet){for(var i=edges.iterator();i.hasNext();){var edge=i.next();this.add(edge,edgeSet);}};jsts.geomgraph.index.SimpleMCSweepLineIntersector.prototype.prepareEvents=function(){this.events.sort(function(a,b){return a.compareTo(b);});for(var i=0;i<this.events.length;i++){var ev=this.events[i];if(ev.isDelete()){ev.getInsertEvent().setDeleteEventIndex(i);}}};jsts.geomgraph.index.SimpleMCSweepLineIntersector.prototype.computeIntersections3=function(si){this.nOverlaps=0;this.prepareEvents();for(var i=0;i<this.events.length;i++){var ev=this.events[i];if(ev.isInsert()){this.processOverlaps(i,ev.getDeleteEventIndex(),ev,si);}}};jsts.geomgraph.index.SimpleMCSweepLineIntersector.prototype.processOverlaps=function(start,end,ev0,si){var mc0=ev0.getObject();for(var i=start;i<end;i++){var ev1=this.events[i];if(ev1.isInsert()){var mc1=ev1.getObject();if(!ev0.isSameLabel(ev1)){mc0.computeIntersections(mc1,si);this.nOverlaps++;}}}};jsts.algorithm.locate.SimplePointInAreaLocator=function(geom){this.geom=geom;};jsts.algorithm.locate.SimplePointInAreaLocator.locate=function(p,geom){if(geom.isEmpty())
return jsts.geom.Location.EXTERIOR;if(jsts.algorithm.locate.SimplePointInAreaLocator.containsPoint(p,geom))
return jsts.geom.Location.INTERIOR;return jsts.geom.Location.EXTERIOR;};jsts.algorithm.locate.SimplePointInAreaLocator.containsPoint=function(p,geom){if(geom instanceof jsts.geom.Polygon){return jsts.algorithm.locate.SimplePointInAreaLocator.containsPointInPolygon(p,geom);}else if(geom instanceof jsts.geom.GeometryCollection||geom instanceof jsts.geom.MultiPoint||geom instanceof jsts.geom.MultiLineString||geom instanceof jsts.geom.MultiPolygon){for(var i=0;i<geom.geometries.length;i++){var g2=geom.geometries[i];if(g2!==geom)
if(jsts.algorithm.locate.SimplePointInAreaLocator.containsPoint(p,g2))
return true;}}
return false;};jsts.algorithm.locate.SimplePointInAreaLocator.containsPointInPolygon=function(p,poly){if(poly.isEmpty())
return false;var shell=poly.getExteriorRing();if(!jsts.algorithm.locate.SimplePointInAreaLocator.isPointInRing(p,shell))
return false;for(var i=0;i<poly.getNumInteriorRing();i++){var hole=poly.getInteriorRingN(i);if(jsts.algorithm.locate.SimplePointInAreaLocator.isPointInRing(p,hole))
return false;}
return true;};jsts.algorithm.locate.SimplePointInAreaLocator.isPointInRing=function(p,ring){if(!ring.getEnvelopeInternal().intersects(p))
return false;return jsts.algorithm.CGAlgorithms.isPointInRing(p,ring.getCoordinates());};jsts.algorithm.locate.SimplePointInAreaLocator.prototype.geom=null;jsts.algorithm.locate.SimplePointInAreaLocator.prototype.locate=function(p){return jsts.algorithm.locate.SimplePointInAreaLocator.locate(p,geom);};(function(){var Location=jsts.geom.Location;var Position=jsts.geomgraph.Position;var EdgeEndStar=jsts.geomgraph.EdgeEndStar;var Assert=jsts.util.Assert;jsts.geomgraph.DirectedEdgeStar=function(){jsts.geomgraph.EdgeEndStar.call(this);};jsts.geomgraph.DirectedEdgeStar.prototype=new EdgeEndStar();jsts.geomgraph.DirectedEdgeStar.constructor=jsts.geomgraph.DirectedEdgeStar;jsts.geomgraph.DirectedEdgeStar.prototype.resultAreaEdgeList=null;jsts.geomgraph.DirectedEdgeStar.prototype.label=null;jsts.geomgraph.DirectedEdgeStar.prototype.insert=function(ee){var de=ee;this.insertEdgeEnd(de,de);};jsts.geomgraph.DirectedEdgeStar.prototype.getLabel=function(){return this.label;};jsts.geomgraph.DirectedEdgeStar.prototype.getOutgoingDegree=function(){var degree=0;for(var it=this.iterator();it.hasNext();){var de=it.next();if(de.isInResult())
degree++;}
return degree;};jsts.geomgraph.DirectedEdgeStar.prototype.getOutgoingDegree=function(er){var degree=0;for(var it=this.iterator();it.hasNext();){var de=it.next();if(de.getEdgeRing()===er)
degree++;}
return degree;};jsts.geomgraph.DirectedEdgeStar.prototype.getRightmostEdge=function(){var edges=this.getEdges();var size=edges.size();if(size<1)
return null;var de0=edges.get(0);if(size==1)
return de0;var deLast=edges.get(size-1);var quad0=de0.getQuadrant();var quad1=deLast.getQuadrant();if(jsts.geomgraph.Quadrant.isNorthern(quad0)&&jsts.geomgraph.Quadrant.isNorthern(quad1))
return de0;else if(!jsts.geomgraph.Quadrant.isNorthern(quad0)&&!jsts.geomgraph.Quadrant.isNorthern(quad1))
return deLast;else{var nonHorizontalEdge=null;if(de0.getDy()!=0)
return de0;else if(deLast.getDy()!=0)
return deLast;}
Assert.shouldNeverReachHere('found two horizontal edges incident on node');return null;};jsts.geomgraph.DirectedEdgeStar.prototype.computeLabelling=function(geom){EdgeEndStar.prototype.computeLabelling.call(this,geom);this.label=new jsts.geomgraph.Label(Location.NONE);for(var it=this.iterator();it.hasNext();){var ee=it.next();var e=ee.getEdge();var eLabel=e.getLabel();for(var i=0;i<2;i++){var eLoc=eLabel.getLocation(i);if(eLoc===Location.INTERIOR||eLoc===Location.BOUNDARY)
this.label.setLocation(i,Location.INTERIOR);}}};jsts.geomgraph.DirectedEdgeStar.prototype.mergeSymLabels=function(){for(var it=this.iterator();it.hasNext();){var de=it.next();var label=de.getLabel();label.merge(de.getSym().getLabel());}};jsts.geomgraph.DirectedEdgeStar.prototype.updateLabelling=function(nodeLabel){for(var it=this.iterator();it.hasNext();){var de=it.next();var label=de.getLabel();label.setAllLocationsIfNull(0,nodeLabel.getLocation(0));label.setAllLocationsIfNull(1,nodeLabel.getLocation(1));}};jsts.geomgraph.DirectedEdgeStar.prototype.getResultAreaEdges=function(){if(this.resultAreaEdgeList!==null)
return this.resultAreaEdgeList;this.resultAreaEdgeList=new javascript.util.ArrayList();for(var it=this.iterator();it.hasNext();){var de=it.next();if(de.isInResult()||de.getSym().isInResult())
this.resultAreaEdgeList.add(de);}
return this.resultAreaEdgeList;};jsts.geomgraph.DirectedEdgeStar.prototype.SCANNING_FOR_INCOMING=1;jsts.geomgraph.DirectedEdgeStar.prototype.LINKING_TO_OUTGOING=2;jsts.geomgraph.DirectedEdgeStar.prototype.linkResultDirectedEdges=function(){this.getResultAreaEdges();var firstOut=null;var incoming=null;var state=this.SCANNING_FOR_INCOMING;for(var i=0;i<this.resultAreaEdgeList.size();i++){var nextOut=this.resultAreaEdgeList.get(i);var nextIn=nextOut.getSym();if(!nextOut.getLabel().isArea())
continue;if(firstOut===null&&nextOut.isInResult())
firstOut=nextOut;switch(state){case this.SCANNING_FOR_INCOMING:if(!nextIn.isInResult())
continue;incoming=nextIn;state=this.LINKING_TO_OUTGOING;break;case this.LINKING_TO_OUTGOING:if(!nextOut.isInResult())
continue;incoming.setNext(nextOut);state=this.SCANNING_FOR_INCOMING;break;}}
if(state===this.LINKING_TO_OUTGOING){if(firstOut===null)
throw new jsts.error.TopologyError('no outgoing dirEdge found',this.getCoordinate());Assert.isTrue(firstOut.isInResult(),'unable to link last incoming dirEdge');incoming.setNext(firstOut);}};jsts.geomgraph.DirectedEdgeStar.prototype.linkMinimalDirectedEdges=function(er){var firstOut=null;var incoming=null;var state=this.SCANNING_FOR_INCOMING;for(var i=this.resultAreaEdgeList.size()-1;i>=0;i--){var nextOut=this.resultAreaEdgeList.get(i);var nextIn=nextOut.getSym();if(firstOut===null&&nextOut.getEdgeRing()===er)
firstOut=nextOut;switch(state){case this.SCANNING_FOR_INCOMING:if(nextIn.getEdgeRing()!=er)
continue;incoming=nextIn;state=this.LINKING_TO_OUTGOING;break;case this.LINKING_TO_OUTGOING:if(nextOut.getEdgeRing()!==er)
continue;incoming.setNextMin(nextOut);state=this.SCANNING_FOR_INCOMING;break;}}
if(state===this.LINKING_TO_OUTGOING){Assert.isTrue(firstOut!==null,'found null for first outgoing dirEdge');Assert.isTrue(firstOut.getEdgeRing()===er,'unable to link last incoming dirEdge');incoming.setNextMin(firstOut);}};jsts.geomgraph.DirectedEdgeStar.prototype.linkAllDirectedEdges=function(){this.getEdges();var prevOut=null;var firstIn=null;for(var i=this.edgeList.size()-1;i>=0;i--){var nextOut=this.edgeList.get(i);var nextIn=nextOut.getSym();if(firstIn===null)
firstIn=nextIn;if(prevOut!==null)
nextIn.setNext(prevOut);prevOut=nextOut;}
firstIn.setNext(prevOut);};jsts.geomgraph.DirectedEdgeStar.prototype.findCoveredLineEdges=function(){var startLoc=Location.NONE;for(var it=this.iterator();it.hasNext();){var nextOut=it.next();var nextIn=nextOut.getSym();if(!nextOut.isLineEdge()){if(nextOut.isInResult()){startLoc=Location.INTERIOR;break;}
if(nextIn.isInResult()){startLoc=Location.EXTERIOR;break;}}}
if(startLoc===Location.NONE)
return;var currLoc=startLoc;for(var it=this.iterator();it.hasNext();){var nextOut=it.next();var nextIn=nextOut.getSym();if(nextOut.isLineEdge()){nextOut.getEdge().setCovered(currLoc===Location.INTERIOR);}else{if(nextOut.isInResult())
currLoc=Location.EXTERIOR;if(nextIn.isInResult())
currLoc=Location.INTERIOR;}}};jsts.geomgraph.DirectedEdgeStar.prototype.computeDepths=function(de){if(arguments.length===2){this.computeDepths2.apply(this,arguments);return;}
var edgeIndex=this.findIndex(de);var label=de.getLabel();var startDepth=de.getDepth(Position.LEFT);var targetLastDepth=de.getDepth(Position.RIGHT);var nextDepth=this.computeDepths2(edgeIndex+1,this.edgeList.size(),startDepth);var lastDepth=this.computeDepths2(0,edgeIndex,nextDepth);if(lastDepth!=targetLastDepth)
throw new jsts.error.TopologyError('depth mismatch at '+
de.getCoordinate());};jsts.geomgraph.DirectedEdgeStar.prototype.computeDepths2=function(startIndex,endIndex,startDepth){var currDepth=startDepth;for(var i=startIndex;i<endIndex;i++){var nextDe=this.edgeList.get(i);var label=nextDe.getLabel();nextDe.setEdgeDepths(Position.RIGHT,currDepth);currDepth=nextDe.getDepth(Position.LEFT);}
return currDepth;};})();jsts.algorithm.CentroidLine=function(){this.centSum=new jsts.geom.Coordinate();};jsts.algorithm.CentroidLine.prototype.centSum=null;jsts.algorithm.CentroidLine.prototype.totalLength=0.0;jsts.algorithm.CentroidLine.prototype.add=function(geom){if(geom instanceof Array){this.add2.apply(this,arguments);return;}
if(geom instanceof jsts.geom.LineString){this.add(geom.getCoordinates());}else if(geom instanceof jsts.geom.Polygon){var poly=geom;this.add(poly.getExteriorRing().getCoordinates());for(var i=0;i<poly.getNumInteriorRing();i++){this.add(poly.getInteriorRingN(i).getCoordinates());}}else if(geom instanceof jsts.geom.GeometryCollection||geom instanceof jsts.geom.MultiPoint||geom instanceof jsts.geom.MultiLineString||geom instanceof jsts.geom.MultiPolygon){var gc=geom;for(var i=0;i<gc.getNumGeometries();i++){this.add(gc.getGeometryN(i));}}};jsts.algorithm.CentroidLine.prototype.getCentroid=function(){var cent=new jsts.geom.Coordinate();cent.x=this.centSum.x/this.totalLength;cent.y=this.centSum.y/this.totalLength;return cent;};jsts.algorithm.CentroidLine.prototype.add2=function(pts){for(var i=0;i<pts.length-1;i++){var segmentLen=pts[i].distance(pts[i+1]);this.totalLength+=segmentLen;var midx=(pts[i].x+pts[i+1].x)/2;this.centSum.x+=segmentLen*midx;var midy=(pts[i].y+pts[i+1].y)/2;this.centSum.y+=segmentLen*midy;}};jsts.index.IntervalSize=function(){};jsts.index.IntervalSize.MIN_BINARY_EXPONENT=-50;jsts.index.IntervalSize.isZeroWidth=function(min,max){var width=max-min;if(width===0.0){return true;}
var maxAbs,scaledInterval,level;maxAbs=Math.max(Math.abs(min),Math.abs(max));scaledInterval=width/maxAbs;level=jsts.index.DoubleBits.exponent(scaledInterval);return level<=jsts.index.IntervalSize.MIN_BINARY_EXPONENT;};jsts.geomgraph.index.SimpleEdgeSetIntersector=function(){};jsts.geomgraph.index.SimpleEdgeSetIntersector.prototype=new jsts.geomgraph.index.EdgeSetIntersector();jsts.geomgraph.index.SimpleEdgeSetIntersector.prototype.nOverlaps=0;jsts.geomgraph.index.SimpleEdgeSetIntersector.prototype.computeIntersections=function(edges,si,testAllSegments){if(si instanceof javascript.util.List){this.computeIntersections2.apply(this,arguments);return;}
this.nOverlaps=0;for(var i0=edges.iterator();i0.hasNext();){var edge0=i0.next();for(var i1=edges.iterator();i1.hasNext();){var edge1=i1.next();if(testAllSegments||edge0!=edge1)
this.computeIntersects(edge0,edge1,si);}}};jsts.geomgraph.index.SimpleEdgeSetIntersector.prototype.computeIntersections2=function(edges0,edges1,si){this.nOverlaps=0;for(var i0=edges0.iterator();i0.hasNext();){var edge0=i0.next();for(var i1=edges1.iterator();i1.hasNext();){var edge1=i1.next();this.computeIntersects(edge0,edge1,si);}}};jsts.geomgraph.index.SimpleEdgeSetIntersector.prototype.computeIntersects=function(e0,e1,si){var pts0=e0.getCoordinates();var pts1=e1.getCoordinates();var i0,i1;for(i0=0;i0<pts0.length-1;i0++){for(i1=0;i1<pts1.length-1;i1++){si.addIntersections(e0,i0,e1,i1);}}};jsts.geomgraph.Edge=function(pts,label){this.pts=pts;this.label=label;this.eiList=new jsts.geomgraph.EdgeIntersectionList(this);this.depth=new jsts.geomgraph.Depth();};jsts.geomgraph.Edge.prototype=new jsts.geomgraph.GraphComponent();jsts.geomgraph.Edge.constructor=jsts.geomgraph.Edge;jsts.geomgraph.Edge.updateIM=function(label,im){im.setAtLeastIfValid(label.getLocation(0,jsts.geomgraph.Position.ON),label.getLocation(1,jsts.geomgraph.Position.ON),1);if(label.isArea()){im.setAtLeastIfValid(label.getLocation(0,jsts.geomgraph.Position.LEFT),label.getLocation(1,jsts.geomgraph.Position.LEFT),2);im.setAtLeastIfValid(label.getLocation(0,jsts.geomgraph.Position.RIGHT),label.getLocation(1,jsts.geomgraph.Position.RIGHT),2);}};jsts.geomgraph.Edge.prototype.pts=null;jsts.geomgraph.Edge.prototype.env=null;jsts.geomgraph.Edge.prototype.name=null;jsts.geomgraph.Edge.prototype.mce=null;jsts.geomgraph.Edge.prototype._isIsolated=true;jsts.geomgraph.Edge.prototype.depth=null;jsts.geomgraph.Edge.prototype.depthDelta=0;jsts.geomgraph.Edge.prototype.eiList=null;jsts.geomgraph.Edge.prototype.getNumPoints=function(){return this.pts.length;};jsts.geomgraph.Edge.prototype.getEnvelope=function(){if(this.env===null){this.env=new jsts.geom.Envelope();for(var i=0;i<this.pts.length;i++){this.env.expandToInclude(pts[i]);}}
return env;};jsts.geomgraph.Edge.prototype.getDepth=function(){return this.depth;};jsts.geomgraph.Edge.prototype.getDepthDelta=function(){return this.depthDelta;};jsts.geomgraph.Edge.prototype.setDepthDelta=function(depthDelta){this.depthDelta=depthDelta;};jsts.geomgraph.Edge.prototype.getCoordinates=function(){return this.pts;};jsts.geomgraph.Edge.prototype.getCoordinate=function(i){if(i===undefined){if(this.pts.length>0){return this.pts[0];}else{return null;}}
return this.pts[i];};jsts.geomgraph.Edge.prototype.isClosed=function(){return this.pts[0].equals(this.pts[this.pts.length-1]);};jsts.geomgraph.Edge.prototype.setIsolated=function(isIsolated){this._isIsolated=isIsolated;};jsts.geomgraph.Edge.prototype.isIsolated=function(){return this._isIsolated;};jsts.geomgraph.Edge.prototype.addIntersections=function(li,segmentIndex,geomIndex){for(var i=0;i<li.getIntersectionNum();i++){this.addIntersection(li,segmentIndex,geomIndex,i);}};jsts.geomgraph.Edge.prototype.addIntersection=function(li,segmentIndex,geomIndex,intIndex){var intPt=new jsts.geom.Coordinate(li.getIntersection(intIndex));var normalizedSegmentIndex=segmentIndex;var dist=li.getEdgeDistance(geomIndex,intIndex);var nextSegIndex=normalizedSegmentIndex+1;if(nextSegIndex<this.pts.length){var nextPt=this.pts[nextSegIndex];if(intPt.equals2D(nextPt)){normalizedSegmentIndex=nextSegIndex;dist=0.0;}}
var ei=this.eiList.add(intPt,normalizedSegmentIndex,dist);};jsts.geomgraph.Edge.prototype.getMaximumSegmentIndex=function(){return this.pts.length-1;};jsts.geomgraph.Edge.prototype.getEdgeIntersectionList=function(){return this.eiList;};jsts.geomgraph.Edge.prototype.getMonotoneChainEdge=function(){if(this.mce==null){this.mce=new jsts.geomgraph.index.MonotoneChainEdge(this);}
return this.mce;};jsts.geomgraph.Edge.prototype.isClosed=function()
{return this.pts[0].equals(this.pts[this.pts.length-1]);};jsts.geomgraph.Edge.prototype.isCollapsed=function()
{if(!this.label.isArea())return false;if(this.pts.length!=3)return false;if(this.pts[0].equals(this.pts[2]))return true;return false;};jsts.geomgraph.Edge.prototype.getCollapsedEdge=function()
{var newPts=[];newPts[0]=this.pts[0];newPts[1]=this.pts[1];var newe=new jsts.geomgraph.Edge(newPts,jsts.geomgraph.Label.toLineLabel(this.label));return newe;};jsts.geomgraph.Edge.prototype.computeIM=function(im){jsts.geomgraph.Edge.updateIM(this.label,im);};jsts.geomgraph.Edge.prototype.isPointwiseEqual=function(e)
{if(this.pts.length!=e.pts.length)return false;for(var i=0;i<this.pts.length;i++){if(!this.pts[i].equals2D(e.pts[i])){return false;}}
return true;};jsts.noding.Octant=function(){throw jsts.error.AbstractMethodInvocationError();};jsts.noding.Octant.octant=function(dx,dy){if(dx instanceof jsts.geom.Coordinate){return jsts.noding.Octant.octant2.apply(this,arguments);}
if(dx===0.0&&dy===0.0)
throw new jsts.error.IllegalArgumentError('Cannot compute the octant for point ( '+dx+', '+dy+' )');var adx=Math.abs(dx);var ady=Math.abs(dy);if(dx>=0){if(dy>=0){if(adx>=ady)
return 0;else
return 1;}
else{if(adx>=ady)
return 7;else
return 6;}}
else{if(dy>=0){if(adx>=ady)
return 3;else
return 2;}
else{if(adx>=ady)
return 4;else
return 5;}}};jsts.noding.Octant.octant2=function(p0,p1){var dx=p1.x-p0.x;var dy=p1.y-p0.y;if(dx===0.0&&dy===0.0)
throw new jsts.error.IllegalArgumentError('Cannot compute the octant for two identical points '+p0);return jsts.noding.Octant.octant(dx,dy);};jsts.operation.union.UnionInteracting=function(g0,g1){this.g0=g0;this.g1=g1;this.geomFactory=g0.getFactory();this.interacts0=[];this.interacts1=[];};jsts.operation.union.UnionInteracting.union=function(g0,g1){var uue=new jsts.operation.union.UnionInteracting(g0,g1);return uue.union();};jsts.operation.union.UnionInteracting.prototype.geomFactory=null;jsts.operation.union.UnionInteracting.prototype.g0=null;jsts.operation.union.UnionInteracting.prototype.g1=null;jsts.operation.union.UnionInteracting.prototype.interacts0=null;jsts.operation.union.UnionInteracting.prototype.interacts1=null;jsts.operation.union.UnionInteracting.prototype.union=function(){this.computeInteracting();var int0=this.extractElements(this.g0,this.interacts0,true);var int1=this.extractElements(this.g1,this.interacts1,true);if(int0.isEmpty()||int1.isEmpty()){}
var union=in0.union(int1);var disjoint0=this.extractElements(this.g0,this.interacts0,false);var disjoint1=this.extractElements(this.g1,this.interacts1,false);var overallUnion=jsts.geom.util.GeometryCombiner.combine(union,disjoint0,disjoint1);return overallUnion;};jsts.operation.union.UnionInteracting.prototype.bufferUnion=function(g0,g1){var factory=g0.getFactory();var gColl=factory.createGeometryCollection([g0,g1]);var unionAll=gColl.buffer(0.0);return unionAll;};jsts.operation.union.UnionInteracting.prototype.computeInteracting=function(elem0){if(!elem0){for(var i=0,l=this.g0.getNumGeometries();i<l;i++){var elem=this.g0.getGeometryN(i);this.interacts0[i]=this.computeInteracting(elem);}}
else{var interactsWithAny=false;for(var i=0,l=g1.getNumGeometries();i<l;i++){var elem1=this.g1.getGeometryN(i);var interacts=elem1.getEnvelopeInternal().intersects(elem0.getEnvelopeInternal());if(interacts){this.interacts1[i]=true;interactsWithAny=true;}}
return interactsWithAny;}};jsts.operation.union.UnionInteracting.prototype.extractElements=function(geom,interacts,isInteracting){var extractedGeoms=[];for(var i=0,l=geom.getNumGeometries();i<l;i++){var elem=geom.getGeometryN(i);if(interacts[i]===isInteracting){extractedGeoms.push(elem);}}
return this.geomFactory.buildGeometry(extractedGeoms);};jsts.triangulate.quadedge.TrianglePredicate=function(){};jsts.triangulate.quadedge.TrianglePredicate.isInCircleNonRobust=function(a,b,c,p){var isInCircle=(a.x*a.x+a.y*a.y)*jsts.triangulate.quadedge.TrianglePredicate.triArea(b,c,p)-
(b.x*b.x+b.y*b.y)*jsts.triangulate.quadedge.TrianglePredicate.triArea(a,c,p)+
(c.x*c.x+c.y*c.y)*jsts.triangulate.quadedge.TrianglePredicate.triArea(a,b,p)-
(p.x*p.x+p.y*p.y)*jsts.triangulate.quadedge.TrianglePredicate.triArea(a,b,c)>0;return isInCircle;};jsts.triangulate.quadedge.TrianglePredicate.isInCircleNormalized=function(a,b,c,p){var adx,ady,bdx,bdy,cdx,cdy,abdet,bcdet,cadet,alift,blift,clift,disc;adx=a.x-p.x;ady=a.y-p.y;bdx=b.x-p.x;bdy=b.y-p.y;cdx=c.x-p.x;cdy=c.y-p.y;abdet=adx*bdy-bdx*ady;bcdet=bdx*cdy-cdx*bdy;cadet=cdx*ady-adx*cdy;alift=adx*adx+ady*ady;blift=bdx*bdx+bdy*bdy;clift=cdx*cdx+cdy*cdy;disc=alift*bcdet+blift*cadet+clift*abdet;return disc>0;};jsts.triangulate.quadedge.TrianglePredicate.triArea=function(a,b,c){return(b.x-a.x)*(c.y-a.y)-(b.y-a.y)*(c.x-a.x);};jsts.triangulate.quadedge.TrianglePredicate.isInCircleRobust=function(a,b,c,p){return jsts.triangulate.quadedge.TrianglePredicate.isInCircleNormalized(a,b,c,p);};jsts.triangulate.quadedge.TrianglePredicate.isInCircleDDSlow=function(a,b,c,p){var px,py,ax,ay,bx,by,cx,cy,aTerm,bTerm,cTerm,pTerm,sum,isInCircle;px=jsts.math.DD.valueOf(p.x);py=jsts.math.DD.valueOf(p.y);ax=jsts.math.DD.valueOf(a.x);ay=jsts.math.DD.valueOf(a.y);bx=jsts.math.DD.valueOf(b.x);by=jsts.math.DD.valueOf(b.y);cx=jsts.math.DD.valueOf(c.x);cy=jsts.math.DD.valueOf(c.y);aTerm=(ax.multiply(ax).add(ay.multiply(ay))).multiply(jsts.triangulate.quadedge.TrianglePredicate.triAreaDDSlow(bx,by,cx,cy,px,py));bTerm=(bx.multiply(bx).add(by.multiply(by))).multiply(jsts.triangulate.quadedge.TrianglePredicate.triAreaDDSlow(ax,ay,cx,cy,px,py));cTerm=(cx.multiply(cx).add(cy.multiply(cy))).multiply(jsts.triangulate.quadedge.TrianglePredicate.triAreaDDSlow(ax,ay,bx,by,px,py));pTerm=(px.multiply(px).add(py.multiply(py))).multiply(jsts.triangulate.quadedge.TrianglePredicate.triAreaDDSlow(ax,ay,bx,by,cx,cy));sum=aTerm.subtract(bTerm).add(cTerm).subtract(pTerm);isInCircle=sum.doubleValue()>0;return isInCircle;};jsts.triangulate.quadedge.TrianglePredicate.triAreaDDSlow=function(ax,ay,bx,by,cx,cy){return(bx.subtract(ax).multiply(cy.subtract(ay)).subtract(by.subtract(ay).multiply(cx.subtract(ax))));};jsts.triangulate.quadedge.TrianglePredicate.isInCircleDDFast=function(a,b,c,p){var aTerm,bTerm,cTerm,pTerm,sum,isInCircle;aTerm=(jsts.math.DD.sqr(a.x).selfAdd(jsts.math.DD.sqr(a.y))).selfMultiply(jsts.triangulate.quadedge.TrianglePredicate.triAreaDDFast(b,c,p));bTerm=(jsts.math.DD.sqr(b.x).selfAdd(jsts.math.DD.sqr(b.y))).selfMultiply(jsts.triangulate.quadedge.TrianglePredicate.triAreaDDFast(a,c,p));cTerm=(jsts.math.DD.sqr(c.x).selfAdd(jsts.math.DD.sqr(c.y))).selfMultiply(jsts.triangulate.quadedge.TrianglePredicate.triAreaDDFast(a,b,p));pTerm=(jsts.math.DD.sqr(p.x).selfAdd(jsts.math.DD.sqr(p.y))).selfMultiply(jsts.triangulate.quadedge.TrianglePredicate.triAreaDDFast(a,b,c));sum=aTerm.selfSubtract(bTerm).selfAdd(cTerm).selfSubtract(pTerm);isInCircle=sum.doubleValue()>0;return isInCircle;};jsts.triangulate.quadedge.TrianglePredicate.triAreaDDFast=function(a,b,c){var t1,t2;t1=jsts.math.DD.valueOf(b.x).selfSubtract(a.x).selfMultiply(jsts.math.DD.valueOf(c.y).selfSubtract(a.y));t2=jsts.math.DD.valueOf(b.y).selSubtract(a.y).selfMultiply(jsts.math.DD.valueOf(c.x).selfSubtract(a.x));return t1.selfSubtract(t2);};jsts.triangulate.quadedge.TrianglePredicate.isInCircleDDNormalized=function(a,b,c,p){var adx,ady,bdx,bdy,cdx,cdy,abdet,bcdet,cadet,alift,blift,clift,sum,isInCircle;adx=jsts.math.DD.valueOf(a.x).selfSubtract(p.x);ady=jsts.math.DD.valueOf(a.y).selfSubtract(p.y);bdx=jsts.math.DD.valueOf(b.x).selfSubtract(p.x);bdx=jsts.math.DD.valueOf(b.y).selfSubtract(p.y);cdx=jsts.math.DD.valueOf(c.x).selfSubtract(p.x);cdx=jsts.math.DD.valueOf(c.y).selfSubtract(p.y);abdet=adx.multiply(bdy).selfSubtract(bdx.multiply(ady));bcdet=bdx.multiply(cdy).selfSubtract(cdx.multiply(bdy));cadet=cdx.multiply(ady).selfSubtract(adx.multiply(cdy));alift=adx.multiply(adx).selfAdd(ady.multiply(ady));blift=bdx.multiply(bdx).selfAdd(bdy.multiply(bdy));clift=cdx.multiply(cdx).selfAdd(cdy.multiply(cdy));sum=alift.selfMultiply(bcdet).selfAdd(blift.selfMultiply(cadet)).selfAdd(clift.selfMultiply(abdet));isInCircle=sum.doubleValue()>0;return isInCircle;};jsts.triangulate.quadedge.TrianglePredicate.isInCircleCC=function(a,b,c,p){var cc,ccRadius,pRadiusDiff;cc=jsts.geom.Triangle.circumcentre(a,b,c);ccRadius=a.distance(cc);pRadiusDiff=p.distance(cc)-ccRadius;return pRadiusDiff<=0;};jsts.operation.union.PointGeometryUnion=function(pointGeom,otherGeom){this.pointGeom=pointGeom;this.otherGeom=otherGeom;this.geomFact=otherGeom.getFactory();};jsts.operation.union.PointGeometryUnion.union=function(pointGeom,otherGeom){var unioner=new jsts.operation.union.PointGeometryUnion(pointGeom,otherGeom);return unioner.union();};jsts.operation.union.PointGeometryUnion.prototype.pointGeom=null;jsts.operation.union.PointGeometryUnion.prototype.otherGeom=null;jsts.operation.union.PointGeometryUnion.prototype.geomFact=null;jsts.operation.union.PointGeometryUnion.prototype.union=function(){var locator=new jsts.algorithm.PointLocator();var exteriorCoords=[];for(var i=0,l=this.pointGeom.getNumGeometries();i<l;i++){var point=this.pointGeom.getGeometryN(i);var coord=point.getCoordinate();var loc=locator.locate(coord,this.otherGeom);if(loc===jsts.geom.Location.EXTERIOR){var include=true;for(var j=exteriorCoords.length;i--;){if(exteriorCoords[j].equals(coord)){include=false;break;}}
if(include){exteriorCoords.push(coord);}}}
exteriorCoords.sort(function(x,y){return x.compareTo(y);});if(exteriorCoords.length===0){return this.otherGeom;}
var ptComp=null;var coords=jsts.geom.CoordinateArrays.toCoordinateArray(exteriorCoords);if(coords.length===1){ptComp=this.geomFact.createPoint(coords[0]);}
else{ptComp=this.geomFact.createMultiPoint(coords);}
return jsts.geom.util.GeometryCombiner.combine(ptComp,this.otherGeom);};jsts.noding.IntersectionFinderAdder=function(li){this.li=li;this.interiorIntersections=new javascript.util.ArrayList();};jsts.noding.IntersectionFinderAdder.prototype=new jsts.noding.SegmentIntersector();jsts.noding.IntersectionFinderAdder.constructor=jsts.noding.IntersectionFinderAdder;jsts.noding.IntersectionFinderAdder.prototype.li=null;jsts.noding.IntersectionFinderAdder.prototype.interiorIntersections=null;jsts.noding.IntersectionFinderAdder.prototype.getInteriorIntersections=function(){return this.interiorIntersections;};jsts.noding.IntersectionFinderAdder.prototype.processIntersections=function(e0,segIndex0,e1,segIndex1){if(e0===e1&&segIndex0===segIndex1)
return;var p00=e0.getCoordinates()[segIndex0];var p01=e0.getCoordinates()[segIndex0+1];var p10=e1.getCoordinates()[segIndex1];var p11=e1.getCoordinates()[segIndex1+1];this.li.computeIntersection(p00,p01,p10,p11);if(this.li.hasIntersection()){if(this.li.isInteriorIntersection()){for(var intIndex=0;intIndex<this.li.getIntersectionNum();intIndex++){this.interiorIntersections.add(this.li.getIntersection(intIndex));}
e0.addIntersections(this.li,segIndex0,0);e1.addIntersections(this.li,segIndex1,1);}}};jsts.noding.IntersectionFinderAdder.prototype.isDone=function(){return false;};jsts.noding.snapround.MCIndexSnapRounder=function(pm){this.pm=pm;this.li=new jsts.algorithm.RobustLineIntersector();this.li.setPrecisionModel(pm);this.scaleFactor=pm.getScale();};jsts.noding.snapround.MCIndexSnapRounder.prototype=new jsts.noding.Noder();jsts.noding.snapround.MCIndexSnapRounder.constructor=jsts.noding.snapround.MCIndexSnapRounder;jsts.noding.snapround.MCIndexSnapRounder.prototype.pm=null;jsts.noding.snapround.MCIndexSnapRounder.prototype.li=null;jsts.noding.snapround.MCIndexSnapRounder.prototype.scaleFactor=null;jsts.noding.snapround.MCIndexSnapRounder.prototype.noder=null;jsts.noding.snapround.MCIndexSnapRounder.prototype.pointSnapper=null;jsts.noding.snapround.MCIndexSnapRounder.prototype.nodedSegStrings=null;jsts.noding.snapround.MCIndexSnapRounder.prototype.getNodedSubstrings=function(){return jsts.noding.NodedSegmentString.getNodedSubstrings(this.nodedSegStrings);};jsts.noding.snapround.MCIndexSnapRounder.prototype.computeNodes=function(inputSegmentStrings){this.nodedSegStrings=inputSegmentStrings;this.noder=new jsts.noding.MCIndexNoder();this.pointSnapper=new jsts.noding.snapround.MCIndexPointSnapper(this.noder.getIndex());this.snapRound(inputSegmentStrings,this.li);};jsts.noding.snapround.MCIndexSnapRounder.prototype.snapRound=function(segStrings,li){var intersections=this.findInteriorIntersections(segStrings,li);this.computeIntersectionSnaps(intersections);this.computeVertexSnaps(segStrings);};jsts.noding.snapround.MCIndexSnapRounder.prototype.findInteriorIntersections=function(segStrings,li){var intFinderAdder=new jsts.noding.IntersectionFinderAdder(li);this.noder.setSegmentIntersector(intFinderAdder);this.noder.computeNodes(segStrings);return intFinderAdder.getInteriorIntersections();};jsts.noding.snapround.MCIndexSnapRounder.prototype.computeIntersectionSnaps=function(snapPts){for(var it=snapPts.iterator();it.hasNext();){var snapPt=it.next();var hotPixel=new jsts.noding.snapround.HotPixel(snapPt,this.scaleFactor,this.li);this.pointSnapper.snap(hotPixel);}};jsts.noding.snapround.MCIndexSnapRounder.prototype.computeVertexSnaps=function(edges){if(edges instanceof jsts.noding.NodedSegmentString){this.computeVertexSnaps2.apply(this,arguments);return;}
for(var i0=edges.iterator();i0.hasNext();){var edge0=i0.next();this.computeVertexSnaps(edge0);}};jsts.noding.snapround.MCIndexSnapRounder.prototype.computeVertexSnaps2=function(e){var pts0=e.getCoordinates();for(var i=0;i<pts0.length-1;i++){var hotPixel=new jsts.noding.snapround.HotPixel(pts0[i],this.scaleFactor,this.li);var isNodeAdded=this.pointSnapper.snap(hotPixel,e,i);if(isNodeAdded){e.addIntersection(pts0[i],i);}}};jsts.operation.valid.ConnectedInteriorTester=function(geomGraph){this.geomGraph=geomGraph;this.geometryFactory=new jsts.geom.GeometryFactory();this.disconnectedRingcoord=null;};jsts.operation.valid.ConnectedInteriorTester.findDifferentPoint=function(coord,pt){var i=0,il=coord.length;for(i;i<il;i++){if(!coord[i].equals(pt))
return coord[i];}
return null;};jsts.operation.valid.ConnectedInteriorTester.prototype.getCoordinate=function(){return this.disconnectedRingcoord;};jsts.operation.valid.ConnectedInteriorTester.prototype.isInteriorsConnected=function(){var splitEdges=new javascript.util.ArrayList();this.geomGraph.computeSplitEdges(splitEdges);var graph=new jsts.geomgraph.PlanarGraph(new jsts.operation.overlay.OverlayNodeFactory());graph.addEdges(splitEdges);this.setInteriorEdgesInResult(graph);graph.linkResultDirectedEdges();var edgeRings=this.buildEdgeRings(graph.getEdgeEnds());this.visitShellInteriors(this.geomGraph.getGeometry(),graph);return!this.hasUnvisitedShellEdge(edgeRings);};jsts.operation.valid.ConnectedInteriorTester.prototype.setInteriorEdgesInResult=function(graph){var it=graph.getEdgeEnds().iterator(),de;while(it.hasNext()){de=it.next();if(de.getLabel().getLocation(0,jsts.geomgraph.Position.RIGHT)==jsts.geom.Location.INTERIOR){de.setInResult(true);}}};jsts.operation.valid.ConnectedInteriorTester.prototype.buildEdgeRings=function(dirEdges){var edgeRings=new javascript.util.ArrayList();for(var it=dirEdges.iterator();it.hasNext();){var de=it.next();if(de.isInResult()&&de.getEdgeRing()==null){var er=new jsts.operation.overlay.MaximalEdgeRing(de,this.geometryFactory);er.linkDirectedEdgesForMinimalEdgeRings();var minEdgeRings=er.buildMinimalRings();var i=0,il=minEdgeRings.length;for(i;i<il;i++){edgeRings.add(minEdgeRings[i]);}}}
return edgeRings;};jsts.operation.valid.ConnectedInteriorTester.prototype.visitShellInteriors=function(g,graph){if(g instanceof jsts.geom.Polygon){var p=g;this.visitInteriorRing(p.getExteriorRing(),graph);}
if(g instanceof jsts.geom.MultiPolygon){var mp=g;for(var i=0;i<mp.getNumGeometries();i++){var p=mp.getGeometryN(i);this.visitInteriorRing(p.getExteriorRing(),graph);}}};jsts.operation.valid.ConnectedInteriorTester.prototype.visitInteriorRing=function(ring,graph){var pts=ring.getCoordinates();var pt0=pts[0];var pt1=jsts.operation.valid.ConnectedInteriorTester.findDifferentPoint(pts,pt0);var e=graph.findEdgeInSameDirection(pt0,pt1);var de=graph.findEdgeEnd(e);var intDe=null;if(de.getLabel().getLocation(0,jsts.geomgraph.Position.RIGHT)==jsts.geom.Location.INTERIOR){intDe=de;}else if(de.getSym().getLabel().getLocation(0,jsts.geomgraph.Position.RIGHT)==jsts.geom.Location.INTERIOR){intDe=de.getSym();}
this.visitLinkedDirectedEdges(intDe);};jsts.operation.valid.ConnectedInteriorTester.prototype.visitLinkedDirectedEdges=function(start){var startDe=start;var de=start;do{de.setVisited(true);de=de.getNext();}while(de!=startDe);};jsts.operation.valid.ConnectedInteriorTester.prototype.hasUnvisitedShellEdge=function(edgeRings){for(var i=0;i<edgeRings.size();i++){var er=edgeRings.get(i);if(er.isHole()){continue;}
var edges=er.getEdges();var de=edges[0];if(de.getLabel().getLocation(0,jsts.geomgraph.Position.RIGHT)!=jsts.geom.Location.INTERIOR){continue;}
for(var j=0;j<edges.length;j++){de=edges[j];if(!de.isVisited()){disconnectedRingcoord=de.getCoordinate();return true;}}}
return false;};jsts.algorithm.InteriorPointLine=function(geometry){this.centroid;this.minDistance=Number.MAX_VALUE;this.interiorPoint=null;this.centroid=geometry.getCentroid().getCoordinate();this.addInterior(geometry);if(this.interiorPoint==null){this.addEndpoints(geometry);}};jsts.algorithm.InteriorPointLine.prototype.getInteriorPoint=function(){return this.interiorPoint;};jsts.algorithm.InteriorPointLine.prototype.addInterior=function(geometry){if(geometry instanceof jsts.geom.LineString){this.addInteriorCoord(geometry.getCoordinates());}else if(geometry instanceof jsts.geom.GeometryCollection){for(var i=0;i<geometry.getNumGeometries();i++){this.addInterior(geometry.getGeometryN(i));}}};jsts.algorithm.InteriorPointLine.prototype.addInteriorCoord=function(pts){for(var i=1;i<pts.length-1;i++){this.add(pts[i]);}};jsts.algorithm.InteriorPointLine.prototype.addEndpoints=function(geometry){if(geometry instanceof jsts.geom.LineString){this.addEndpointsCoord(geometry.getCoordinates());}else if(geometry instanceof jsts.geom.GeometryCollection){for(var i=0;i<geometry.getNumGeometries();i++){this.addEndpoints(geometry.getGeometryN(i));}}};jsts.algorithm.InteriorPointLine.prototype.addEndpointsCoord=function(pts){this.add(pts[0]);this.add(pts[pts.length-1]);};jsts.algorithm.InteriorPointLine.prototype.add=function(point){var dist=point.distance(this.centroid);if(dist<this.minDistance){this.interiorPoint=new jsts.geom.Coordinate(point);this.minDistance=dist;}};jsts.index.chain.MonotoneChainSelectAction=function(){this.tempEnv1=new jsts.geom.Envelope();this.selectedSegment=new jsts.geom.LineSegment();};jsts.index.chain.MonotoneChainSelectAction.prototype.tempEnv1=null;jsts.index.chain.MonotoneChainSelectAction.prototype.selectedSegment=null;jsts.index.chain.MonotoneChainSelectAction.prototype.select=function(mc,start){mc.getLineSegment(start,this.selectedSegment);this.select2(this.selectedSegment);};jsts.index.chain.MonotoneChainSelectAction.prototype.select2=function(seg){};jsts.algorithm.MCPointInRing=function(ring){this.ring=ring;this.tree=null;this.crossings=0;this.interval=new jsts.index.bintree.Interval();this.buildIndex();};jsts.algorithm.MCPointInRing.MCSelecter=function(p,parent){this.parent=parent;this.p=p;};jsts.algorithm.MCPointInRing.MCSelecter.prototype=new jsts.index.chain.MonotoneChainSelectAction;jsts.algorithm.MCPointInRing.MCSelecter.prototype.constructor=jsts.algorithm.MCPointInRing.MCSelecter;jsts.algorithm.MCPointInRing.MCSelecter.prototype.select2=function(ls){this.parent.testLineSegment.apply(this.parent,[this.p,ls]);};jsts.algorithm.MCPointInRing.prototype.buildIndex=function(){this.tree=new jsts.index.bintree.Bintree();var pts=jsts.geom.CoordinateArrays.removeRepeatedPoints(this.ring.getCoordinates());var mcList=jsts.index.chain.MonotoneChainBuilder.getChains(pts);for(var i=0;i<mcList.length;i++){var mc=mcList[i];var mcEnv=mc.getEnvelope();this.interval.min=mcEnv.getMinY();this.interval.max=mcEnv.getMaxY();this.tree.insert(this.interval,mc);}};jsts.algorithm.MCPointInRing.prototype.isInside=function(pt){this.crossings=0;var rayEnv=new jsts.geom.Envelope(-Number.MAX_VALUE,Number.MAX_VALUE,pt.y,pt.y);this.interval.min=pt.y;this.interval.max=pt.y;var segs=this.tree.query(this.interval);var mcSelecter=new jsts.algorithm.MCPointInRing.MCSelecter(pt,this);for(var i=segs.iterator();i.hasNext();){var mc=i.next();this.testMonotoneChain(rayEnv,mcSelecter,mc);}
if((this.crossings%2)==1){return true;}
return false;};jsts.algorithm.MCPointInRing.prototype.testMonotoneChain=function(rayEnv,mcSelecter,mc){mc.select(rayEnv,mcSelecter);};jsts.algorithm.MCPointInRing.prototype.testLineSegment=function(p,seg){var xInt,x1,y1,x2,y2,p1,p2;p1=seg.p0;p2=seg.p1;x1=p1.x-p.x;y1=p1.y-p.y;x2=p2.x-p.x;y2=p2.y-p.y;if(((y1>0)&&(y2<=0))||((y2>0)&&(y1<=0))){xInt=jsts.algorithm.RobustDeterminant.signOfDet2x2(x1,y1,x2,y2)/(y2-y1);if(0.0<xInt){this.crossings++;}}};jsts.operation.valid.TopologyValidationError=function(errorType,pt){this.errorType=errorType;this.pt=null;if(pt!=null){this.pt=pt.clone();}};jsts.operation.valid.TopologyValidationError.HOLE_OUTSIDE_SHELL=2;jsts.operation.valid.TopologyValidationError.NESTED_HOLES=3;jsts.operation.valid.TopologyValidationError.DISCONNECTED_INTERIOR=4;jsts.operation.valid.TopologyValidationError.SELF_INTERSECTION=5;jsts.operation.valid.TopologyValidationError.RING_SELF_INTERSECTION=6;jsts.operation.valid.TopologyValidationError.NESTED_SHELLS=7;jsts.operation.valid.TopologyValidationError.DUPLICATE_RINGS=8;jsts.operation.valid.TopologyValidationError.TOO_FEW_POINTS=9;jsts.operation.valid.TopologyValidationError.INVALID_COORDINATE=10;jsts.operation.valid.TopologyValidationError.RING_NOT_CLOSED=11;jsts.operation.valid.TopologyValidationError.prototype.errMsg=['Topology Validation Error','Repeated Point','Hole lies outside shell','Holes are nested','Interior is disconnected','Self-intersection','Ring Self-intersection','Nested shells','Duplicate Rings','Too few distinct points in geometry component','Invalid Coordinate','Ring is not closed'];jsts.operation.valid.TopologyValidationError.prototype.getCoordinate=function(){return this.pt;};jsts.operation.valid.TopologyValidationError.prototype.getErrorType=function(){return this.errorType;};jsts.operation.valid.TopologyValidationError.prototype.getMessage=function(){return this.errMsg[this.errorType];};jsts.operation.valid.TopologyValidationError.prototype.toString=function(){var locStr='';if(this.pt!=null){locStr=' at or near point '+this.pt;return this.getMessage()+locStr;}
return locStr;};(function(){jsts.geom.MultiPolygon=function(geometries,factory){this.geometries=geometries||[];this.factory=factory;};jsts.geom.MultiPolygon.prototype=new jsts.geom.GeometryCollection();jsts.geom.MultiPolygon.constructor=jsts.geom.MultiPolygon;jsts.geom.MultiPolygon.prototype.getBoundary=function(){if(this.isEmpty()){return this.getFactory().createMultiLineString(null);}
var allRings=[];for(var i=0;i<this.geometries.length;i++){var polygon=this.geometries[i];var rings=polygon.getBoundary();for(var j=0;j<rings.getNumGeometries();j++){allRings.push(rings.getGeometryN(j));}}
return this.getFactory().createMultiLineString(allRings);};jsts.geom.MultiPolygon.prototype.equalsExact=function(other,tolerance){if(!this.isEquivalentClass(other)){return false;}
return jsts.geom.GeometryCollection.prototype.equalsExact.call(this,other,tolerance);};jsts.geom.MultiPolygon.prototype.CLASS_NAME='jsts.geom.MultiPolygon';})();jsts.geom.CoordinateSequenceFilter=function(){};jsts.geom.CoordinateSequenceFilter.prototype.filter=jsts.abstractFunc;jsts.geom.CoordinateSequenceFilter.prototype.isDone=jsts.abstractFunc;jsts.geom.CoordinateSequenceFilter.prototype.isGeometryChanged=jsts.abstractFunc;(function(){var Interval=function(){this.min=0.0;this.max=0.0;if(arguments.length===1){var interval=arguments[0];this.init(interval.min,interval.max);}else if(arguments.length===2){this.init(arguments[0],arguments[1]);}};Interval.prototype.init=function(min,max){this.min=min;this.max=max;if(min>max){this.min=max;this.max=min;}};Interval.prototype.getMin=function(){return this.min;};Interval.prototype.getMax=function(){return this.max;};Interval.prototype.getWidth=function(){return(this.max-this.min);};Interval.prototype.expandToInclude=function(interval){if(interval.max>this.max){this.max=interval.max;}
if(interval.min<this.min){this.min=interval.min;}};Interval.prototype.overlaps=function(){if(arguments.length===1){return this.overlapsInterval.apply(this,arguments);}else{return this.overlapsMinMax.apply(this,arguments);}};Interval.prototype.overlapsInterval=function(interval){return this.overlaps(interval.min,interval.max);};Interval.prototype.overlapsMinMax=function(min,max){if(this.min>max||this.max<min){return false;}
return true;};Interval.prototype.contains=function(){var interval;if(arguments[0]instanceof jsts.index.bintree.Interval){interval=arguments[0];return this.containsMinMax(interval.min,interval.max);}else if(arguments.length===1){return this.containsPoint(arguments[0]);}else{return this.containsMinMax(arguments[0],arguments[1]);}};Interval.prototype.containsMinMax=function(min,max){return(min>=this.min&&max<=this.max);};Interval.prototype.containsPoint=function(p){return(p>=this.min&&p<=this.max);};jsts.index.bintree.Interval=Interval;})();jsts.index.DoubleBits=function(){};jsts.index.DoubleBits.powerOf2=function(exp){return Math.pow(2,exp);};jsts.index.DoubleBits.exponent=function(d){return jsts.index.DoubleBits.CVTFWD(64,d)-1023;};jsts.index.DoubleBits.CVTFWD=function(NumW,Qty){var Sign,Expo,Mant,Bin,nb01='';var Inf={32:{d:0x7F,c:0x80,b:0,a:0},64:{d:0x7FF0,c:0,b:0,a:0}};var ExW={32:8,64:11}[NumW],MtW=NumW-ExW-1;if(!Bin){Sign=Qty<0||1/Qty<0;if(!isFinite(Qty)){Bin=Inf[NumW];if(Sign){Bin.d+=1<<(NumW/4-1);}
Expo=Math.pow(2,ExW)-1;Mant=0;}}
if(!Bin){Expo={32:127,64:1023}[NumW];Mant=Math.abs(Qty);while(Mant>=2){Expo++;Mant/=2;}
while(Mant<1&&Expo>0){Expo--;Mant*=2;}
if(Expo<=0){Mant/=2;nb01='Zero or Denormal';}
if(NumW===32&&Expo>254){nb01='Too big for Single';Bin={d:Sign?0xFF:0x7F,c:0x80,b:0,a:0};Expo=Math.pow(2,ExW)-1;Mant=0;}}
return Expo;};(function(){var DoubleBits=jsts.index.DoubleBits;var Interval=jsts.index.bintree.Interval;var Key=function(interval){this.pt=0.0;this.level=0;this.computeKey(interval);};Key.computeLevel=function(interval){var dx=interval.getWidth(),level;level=DoubleBits.exponent(dx)+1;return level;};Key.prototype.getPoint=function(){return this.pt;};Key.prototype.getLevel=function(){return this.level;};Key.prototype.getInterval=function(){return this.interval;};Key.prototype.computeKey=function(itemInterval){this.level=Key.computeLevel(itemInterval);this.interval=new Interval();this.computeInterval(this.level,itemInterval);while(!this.interval.contains(itemInterval)){this.level+=1;this.computeInterval(this.level,itemInterval);}};Key.prototype.computeInterval=function(level,itemInterval){var size=DoubleBits.powerOf2(level);this.pt=Math.floor(itemInterval.getMin()/size)*size;this.interval.init(this.pt,this.pt+size);};jsts.index.bintree.Key=Key;})();jsts.operation.buffer.SubgraphDepthLocater=function(subgraphs){this.subgraphs=[];this.seg=new jsts.geom.LineSegment();this.subgraphs=subgraphs;};jsts.operation.buffer.SubgraphDepthLocater.prototype.subgraphs=null;jsts.operation.buffer.SubgraphDepthLocater.prototype.seg=null;jsts.operation.buffer.SubgraphDepthLocater.prototype.getDepth=function(p){var stabbedSegments=this.findStabbedSegments(p);if(stabbedSegments.length===0)
return 0;stabbedSegments.sort();var ds=stabbedSegments[0];return ds.leftDepth;};jsts.operation.buffer.SubgraphDepthLocater.prototype.findStabbedSegments=function(stabbingRayLeftPt){if(arguments.length===3){this.findStabbedSegments2.apply(this,arguments);return;}
var stabbedSegments=[];for(var i=0;i<this.subgraphs.length;i++){var bsg=this.subgraphs[i];var env=bsg.getEnvelope();if(stabbingRayLeftPt.y<env.getMinY()||stabbingRayLeftPt.y>env.getMaxY())
continue;this.findStabbedSegments2(stabbingRayLeftPt,bsg.getDirectedEdges(),stabbedSegments);}
return stabbedSegments;};jsts.operation.buffer.SubgraphDepthLocater.prototype.findStabbedSegments2=function(stabbingRayLeftPt,dirEdges,stabbedSegments){if(arguments[1]instanceof jsts.geomgraph.DirectedEdge){this.findStabbedSegments3(stabbingRayLeftPt,dirEdges,stabbedSegments);return;}
for(var i=dirEdges.iterator();i.hasNext();){var de=i.next();if(!de.isForward())
continue;this.findStabbedSegments3(stabbingRayLeftPt,de,stabbedSegments);}};jsts.operation.buffer.SubgraphDepthLocater.prototype.findStabbedSegments3=function(stabbingRayLeftPt,dirEdge,stabbedSegments){var pts=dirEdge.getEdge().getCoordinates();for(var i=0;i<pts.length-1;i++){this.seg.p0=pts[i];this.seg.p1=pts[i+1];if(this.seg.p0.y>this.seg.p1.y)
this.seg.reverse();var maxx=Math.max(this.seg.p0.x,this.seg.p1.x);if(maxx<stabbingRayLeftPt.x)
continue;if(this.seg.isHorizontal())
continue;if(stabbingRayLeftPt.y<this.seg.p0.y||stabbingRayLeftPt.y>this.seg.p1.y)
continue;if(jsts.algorithm.CGAlgorithms.computeOrientation(this.seg.p0,this.seg.p1,stabbingRayLeftPt)===jsts.algorithm.CGAlgorithms.RIGHT)
continue;var depth=dirEdge.getDepth(jsts.geomgraph.Position.LEFT);if(!this.seg.p0.equals(pts[i]))
depth=dirEdge.getDepth(jsts.geomgraph.Position.RIGHT);var ds=new jsts.operation.buffer.SubgraphDepthLocater.DepthSegment(this.seg,depth);stabbedSegments.push(ds);}};jsts.operation.buffer.SubgraphDepthLocater.DepthSegment=function(seg,depth){this.upwardSeg=new jsts.geom.LineSegment(seg);this.leftDepth=depth;};jsts.operation.buffer.SubgraphDepthLocater.DepthSegment.prototype.upwardSeg=null;jsts.operation.buffer.SubgraphDepthLocater.DepthSegment.prototype.leftDepth=null;jsts.operation.buffer.SubgraphDepthLocater.DepthSegment.prototype.compareTo=function(obj){var other=obj;var orientIndex=this.upwardSeg.orientationIndex(other.upwardSeg);if(orientIndex===0)
orientIndex=-1*other.upwardSeg.orientationIndex(upwardSeg);if(orientIndex!==0)
return orientIndex;return this.compareX(this.upwardSeg,other.upwardSeg);};jsts.operation.buffer.SubgraphDepthLocater.DepthSegment.prototype.compareX=function(seg0,seg1){var compare0=seg0.p0.compareTo(seg1.p0);if(compare0!==0)
return compare0;return seg0.p1.compareTo(seg1.p1);};jsts.noding.snapround.HotPixel=function(pt,scaleFactor,li){this.corner=[];this.originalPt=pt;this.pt=pt;this.scaleFactor=scaleFactor;this.li=li;if(this.scaleFactor!==1.0){this.pt=new jsts.geom.Coordinate(this.scale(pt.x),this.scale(pt.y));this.p0Scaled=new jsts.geom.Coordinate();this.p1Scaled=new jsts.geom.Coordinate();}
this.initCorners(this.pt);};jsts.noding.snapround.HotPixel.prototype.li=null;jsts.noding.snapround.HotPixel.prototype.pt=null;jsts.noding.snapround.HotPixel.prototype.originalPt=null;jsts.noding.snapround.HotPixel.prototype.ptScaled=null;jsts.noding.snapround.HotPixel.prototype.p0Scaled=null;jsts.noding.snapround.HotPixel.prototype.p1Scaled=null;jsts.noding.snapround.HotPixel.prototype.scaleFactor=undefined;jsts.noding.snapround.HotPixel.prototype.minx=undefined;jsts.noding.snapround.HotPixel.prototype.maxx=undefined;jsts.noding.snapround.HotPixel.prototype.miny=undefined;jsts.noding.snapround.HotPixel.prototype.maxy=undefined;jsts.noding.snapround.HotPixel.prototype.corner=null;jsts.noding.snapround.HotPixel.prototype.safeEnv=null;jsts.noding.snapround.HotPixel.prototype.getCoordinate=function(){return this.originalPt;};jsts.noding.snapround.HotPixel.SAFE_ENV_EXPANSION_FACTOR=0.75;jsts.noding.snapround.HotPixel.prototype.getSafeEnvelope=function(){if(this.safeEnv===null){var safeTolerance=jsts.noding.snapround.HotPixel.SAFE_ENV_EXPANSION_FACTOR/this.scaleFactor;this.safeEnv=new jsts.geom.Envelope(this.originalPt.x-safeTolerance,this.originalPt.x+safeTolerance,this.originalPt.y-safeTolerance,this.originalPt.y+safeTolerance);}
return this.safeEnv;};jsts.noding.snapround.HotPixel.prototype.initCorners=function(pt){var tolerance=0.5;this.minx=pt.x-tolerance;this.maxx=pt.x+tolerance;this.miny=pt.y-tolerance;this.maxy=pt.y+tolerance;this.corner[0]=new jsts.geom.Coordinate(this.maxx,this.maxy);this.corner[1]=new jsts.geom.Coordinate(this.minx,this.maxy);this.corner[2]=new jsts.geom.Coordinate(this.minx,this.miny);this.corner[3]=new jsts.geom.Coordinate(this.maxx,this.miny);};jsts.noding.snapround.HotPixel.prototype.scale=function(val){return Math.round(val*this.scaleFactor);};jsts.noding.snapround.HotPixel.prototype.intersects=function(p0,p1){if(this.scaleFactor===1.0)
return this.intersectsScaled(p0,p1);this.copyScaled(p0,this.p0Scaled);this.copyScaled(p1,this.p1Scaled);return this.intersectsScaled(this.p0Scaled,this.p1Scaled);};jsts.noding.snapround.HotPixel.prototype.copyScaled=function(p,pScaled){pScaled.x=this.scale(p.x);pScaled.y=this.scale(p.y);};jsts.noding.snapround.HotPixel.prototype.intersectsScaled=function(p0,p1){var segMinx=Math.min(p0.x,p1.x);var segMaxx=Math.max(p0.x,p1.x);var segMiny=Math.min(p0.y,p1.y);var segMaxy=Math.max(p0.y,p1.y);var isOutsidePixelEnv=this.maxx<segMinx||this.minx>segMaxx||this.maxy<segMiny||this.miny>segMaxy;if(isOutsidePixelEnv)
return false;var intersects=this.intersectsToleranceSquare(p0,p1);jsts.util.Assert.isTrue(!(isOutsidePixelEnv&&intersects),'Found bad envelope test');return intersects;};jsts.noding.snapround.HotPixel.prototype.intersectsToleranceSquare=function(p0,p1){var intersectsLeft=false;var intersectsBottom=false;this.li.computeIntersection(p0,p1,this.corner[0],this.corner[1]);if(this.li.isProper())
return true;this.li.computeIntersection(p0,p1,this.corner[1],this.corner[2]);if(this.li.isProper())
return true;if(this.li.hasIntersection())
intersectsLeft=true;this.li.computeIntersection(p0,p1,this.corner[2],this.corner[3]);if(this.li.isProper())
return true;if(this.li.hasIntersection())
intersectsBottom=true;this.li.computeIntersection(p0,p1,this.corner[3],this.corner[0]);if(this.li.isProper())
return true;if(intersectsLeft&&intersectsBottom)
return true;if(p0.equals(this.pt))
return true;if(p1.equals(this.pt))
return true;return false;};jsts.noding.snapround.HotPixel.prototype.intersectsPixelClosure=function(p0,p1){this.li.computeIntersection(p0,p1,this.corner[0],this.corner[1]);if(this.li.hasIntersection())
return true;this.li.computeIntersection(p0,p1,this.corner[1],this.corner[2]);if(this.li.hasIntersection())
return true;this.li.computeIntersection(p0,p1,this.corner[2],this.corner[3]);if(this.li.hasIntersection())
return true;this.li.computeIntersection(p0,p1,this.corner[3],this.corner[0]);if(this.li.hasIntersection())
return true;return false;};jsts.noding.snapround.HotPixel.prototype.addSnappedNode=function(segStr,segIndex){var p0=segStr.getCoordinate(segIndex);var p1=segStr.getCoordinate(segIndex+1);if(this.intersects(p0,p1)){segStr.addIntersection(this.getCoordinate(),segIndex);return true;}
return false;};jsts.operation.buffer.BufferInputLineSimplifier=function(inputLine){this.inputLine=inputLine;};jsts.operation.buffer.BufferInputLineSimplifier.simplify=function(inputLine,distanceTol){var simp=new jsts.operation.buffer.BufferInputLineSimplifier(inputLine);return simp.simplify(distanceTol);};jsts.operation.buffer.BufferInputLineSimplifier.INIT=0;jsts.operation.buffer.BufferInputLineSimplifier.DELETE=1;jsts.operation.buffer.BufferInputLineSimplifier.KEEP=1;jsts.operation.buffer.BufferInputLineSimplifier.prototype.inputLine=null;jsts.operation.buffer.BufferInputLineSimplifier.prototype.distanceTol=null;jsts.operation.buffer.BufferInputLineSimplifier.prototype.isDeleted=null;jsts.operation.buffer.BufferInputLineSimplifier.prototype.angleOrientation=jsts.algorithm.CGAlgorithms.COUNTERCLOCKWISE;jsts.operation.buffer.BufferInputLineSimplifier.prototype.simplify=function(distanceTol){this.distanceTol=Math.abs(distanceTol);if(distanceTol<0)
this.angleOrientation=jsts.algorithm.CGAlgorithms.CLOCKWISE;this.isDeleted=[];this.isDeleted.length=this.inputLine.length;var isChanged=false;do{isChanged=this.deleteShallowConcavities();}while(isChanged);return this.collapseLine();};jsts.operation.buffer.BufferInputLineSimplifier.prototype.deleteShallowConcavities=function(){var index=1;var maxIndex=this.inputLine.length-1;var midIndex=this.findNextNonDeletedIndex(index);var lastIndex=this.findNextNonDeletedIndex(midIndex);var isChanged=false;while(lastIndex<this.inputLine.length){var isMiddleVertexDeleted=false;if(this.isDeletable(index,midIndex,lastIndex,this.distanceTol)){this.isDeleted[midIndex]=jsts.operation.buffer.BufferInputLineSimplifier.DELETE;isMiddleVertexDeleted=true;isChanged=true;}
if(isMiddleVertexDeleted)
index=lastIndex;else
index=midIndex;midIndex=this.findNextNonDeletedIndex(index);lastIndex=this.findNextNonDeletedIndex(midIndex);}
return isChanged;};jsts.operation.buffer.BufferInputLineSimplifier.prototype.findNextNonDeletedIndex=function(index){var next=index+1;while(next<this.inputLine.length&&this.isDeleted[next]===jsts.operation.buffer.BufferInputLineSimplifier.DELETE)
next++;return next;};jsts.operation.buffer.BufferInputLineSimplifier.prototype.collapseLine=function(){var coordList=[];for(var i=0;i<this.inputLine.length;i++){if(this.isDeleted[i]!==jsts.operation.buffer.BufferInputLineSimplifier.DELETE)
coordList.push(this.inputLine[i]);}
return coordList;};jsts.operation.buffer.BufferInputLineSimplifier.prototype.isDeletable=function(i0,i1,i2,distanceTol){var p0=this.inputLine[i0];var p1=this.inputLine[i1];var p2=this.inputLine[i2];if(!this.isConcave(p0,p1,p2))
return false;if(!this.isShallow(p0,p1,p2,distanceTol))
return false;return this.isShallowSampled(p0,p1,i0,i2,distanceTol);};jsts.operation.buffer.BufferInputLineSimplifier.prototype.isShallowConcavity=function(p0,p1,p2,distanceTol){var orientation=jsts.algorithm.CGAlgorithms.computeOrientation(p0,p1,p2);var isAngleToSimplify=(orientation===this.angleOrientation);if(!isAngleToSimplify)
return false;var dist=jsts.algorithm.CGAlgorithms.distancePointLine(p1,p0,p2);return dist<distanceTol;};jsts.operation.buffer.BufferInputLineSimplifier.NUM_PTS_TO_CHECK=10;jsts.operation.buffer.BufferInputLineSimplifier.prototype.isShallowSampled=function(p0,p2,i0,i2,distanceTol){var inc=parseInt((i2-i0)/jsts.operation.buffer.BufferInputLineSimplifier.NUM_PTS_TO_CHECK);if(inc<=0)
inc=1;for(var i=i0;i<i2;i+=inc){if(!this.isShallow(p0,p2,this.inputLine[i],distanceTol))
return false;}
return true;};jsts.operation.buffer.BufferInputLineSimplifier.prototype.isShallow=function(p0,p1,p2,distanceTol){var dist=jsts.algorithm.CGAlgorithms.distancePointLine(p1,p0,p2);return dist<distanceTol;};jsts.operation.buffer.BufferInputLineSimplifier.prototype.isConcave=function(p0,p1,p2){var orientation=jsts.algorithm.CGAlgorithms.computeOrientation(p0,p1,p2);var isConcave=(orientation===this.angleOrientation);return isConcave;};jsts.geomgraph.index.SweepLineEvent=function(x,obj,label){if(!(obj instanceof jsts.geomgraph.index.SweepLineEvent)){this.eventType=jsts.geomgraph.index.SweepLineEvent.INSERT;this.label=label;this.xValue=x;this.obj=obj;return;}
this.eventType=jsts.geomgraph.index.SweepLineEvent.DELETE;this.xValue=x;this.insertEvent=obj;};jsts.geomgraph.index.SweepLineEvent.INSERT=1;jsts.geomgraph.index.SweepLineEvent.DELETE=2;jsts.geomgraph.index.SweepLineEvent.prototype.label=null;jsts.geomgraph.index.SweepLineEvent.prototype.xValue=null;jsts.geomgraph.index.SweepLineEvent.prototype.eventType=null;jsts.geomgraph.index.SweepLineEvent.prototype.insertEvent=null;jsts.geomgraph.index.SweepLineEvent.prototype.deleteEventIndex=null;jsts.geomgraph.index.SweepLineEvent.prototype.obj=null;jsts.geomgraph.index.SweepLineEvent.prototype.isInsert=function(){return this.eventType==jsts.geomgraph.index.SweepLineEvent.INSERT;};jsts.geomgraph.index.SweepLineEvent.prototype.isDelete=function(){return this.eventType==jsts.geomgraph.index.SweepLineEvent.DELETE;};jsts.geomgraph.index.SweepLineEvent.prototype.getInsertEvent=function(){return this.insertEvent;};jsts.geomgraph.index.SweepLineEvent.prototype.getDeleteEventIndex=function(){return this.deleteEventIndex;};jsts.geomgraph.index.SweepLineEvent.prototype.setDeleteEventIndex=function(deleteEventIndex){this.deleteEventIndex=deleteEventIndex;};jsts.geomgraph.index.SweepLineEvent.prototype.getObject=function(){return this.obj;};jsts.geomgraph.index.SweepLineEvent.prototype.isSameLabel=function(ev){if(this.label==null){return false;}
return this.label==ev.label;};jsts.geomgraph.index.SweepLineEvent.prototype.compareTo=function(pe){if(this.xValue<pe.xValue){return-1;}
if(this.xValue>pe.xValue){return 1;}
if(this.eventType<pe.eventType){return-1;}
if(this.eventType>pe.eventType){return 1;}
return 0;};jsts.geom.CoordinateList=function(coord,allowRepeated){this.array=[];allowRepeated=(allowRepeated===undefined)?true:allowRepeated;if(coord!==undefined){this.add(coord,allowRepeated);}};jsts.geom.CoordinateList.prototype=new javascript.util.ArrayList();jsts.geom.CoordinateList.prototype.iterator=null;jsts.geom.CoordinateList.prototype.remove=null;jsts.geom.CoordinateList.prototype.get=function(i){return this.array[i];};jsts.geom.CoordinateList.prototype.set=function(i,e){var o=this.array[i];this.array[i]=e;return o;};jsts.geom.CoordinateList.prototype.size=function(){return this.array.length;};jsts.geom.CoordinateList.prototype.add=function(){if(arguments.length>1){return this.addCoordinates.apply(this,arguments);}else{return this.array.push(arguments[0]);}};jsts.geom.CoordinateList.prototype.addCoordinates=function(coord,allowRepeated,direction){if(coord instanceof jsts.geom.Coordinate){return this.addCoordinate.apply(this,arguments);}else if(typeof coord==='number'){return this.insertCoordinate.apply(this,arguments);}
direction=direction||true;if(direction){for(var i=0;i<coord.length;i++){this.addCoordinate(coord[i],allowRepeated);}}else{for(var i=coord.length-1;i>=0;i--){this.addCoordinate(coord[i],allowRepeated);}}
return true;};jsts.geom.CoordinateList.prototype.addCoordinate=function(coord,allowRepeated){if(!allowRepeated){if(this.size()>=1){var last=this.get(this.size()-1);if(last.equals2D(coord))return;}}
this.add(coord);};jsts.geom.CoordinateList.prototype.insertCoordinate=function(index,coord,allowRepeated){if(!allowRepeated){var before=index>0?index-1:-1;if(before!==-1&&this.get(before).equals2D(coord)){return;}
var after=index<this.size()-1?index+1:-1;if(after!==-1&&this.get(after).equals2D(coord)){return;}}
this.array.splice(index,0,coord);};jsts.geom.CoordinateList.prototype.closeRing=function(){if(this.size()>0){this.addCoordinate(new jsts.geom.Coordinate(this.get(0)),false);}};jsts.geom.CoordinateList.prototype.toArray=function(){return this.array;};jsts.geom.CoordinateList.prototype.toCoordinateArray=function(){return this.array;};jsts.operation.buffer.OffsetSegmentGenerator=function(precisionModel,bufParams,distance){this.seg0=new jsts.geom.LineSegment();this.seg1=new jsts.geom.LineSegment();this.offset0=new jsts.geom.LineSegment();this.offset1=new jsts.geom.LineSegment();this.precisionModel=precisionModel;this.bufParams=bufParams;this.li=new jsts.algorithm.RobustLineIntersector();this.filletAngleQuantum=Math.PI/2.0/bufParams.getQuadrantSegments();if(this.bufParams.getQuadrantSegments()>=8&&this.bufParams.getJoinStyle()===jsts.operation.buffer.BufferParameters.JOIN_ROUND){this.closingSegLengthFactor=jsts.operation.buffer.OffsetSegmentGenerator.MAX_CLOSING_SEG_LEN_FACTOR;}
this.init(distance);};jsts.operation.buffer.OffsetSegmentGenerator.OFFSET_SEGMENT_SEPARATION_FACTOR=1.0E-3;jsts.operation.buffer.OffsetSegmentGenerator.INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR=1.0E-3;jsts.operation.buffer.OffsetSegmentGenerator.CURVE_VERTEX_SNAP_DISTANCE_FACTOR=1.0E-6;jsts.operation.buffer.OffsetSegmentGenerator.MAX_CLOSING_SEG_LEN_FACTOR=80;jsts.operation.buffer.OffsetSegmentGenerator.prototype.maxCurveSegmentError=0.0;jsts.operation.buffer.OffsetSegmentGenerator.prototype.filletAngleQuantum=null;jsts.operation.buffer.OffsetSegmentGenerator.prototype.closingSegLengthFactor=1;jsts.operation.buffer.OffsetSegmentGenerator.prototype.segList=null;jsts.operation.buffer.OffsetSegmentGenerator.prototype.distance=0.0;jsts.operation.buffer.OffsetSegmentGenerator.prototype.precisionModel=null;jsts.operation.buffer.OffsetSegmentGenerator.prototype.bufParams=null;jsts.operation.buffer.OffsetSegmentGenerator.prototype.li=null;jsts.operation.buffer.OffsetSegmentGenerator.prototype.s0=null;jsts.operation.buffer.OffsetSegmentGenerator.prototype.s1=null;jsts.operation.buffer.OffsetSegmentGenerator.prototype.s2=null;jsts.operation.buffer.OffsetSegmentGenerator.prototype.seg0=null;jsts.operation.buffer.OffsetSegmentGenerator.prototype.seg1=null;jsts.operation.buffer.OffsetSegmentGenerator.prototype.offset0=null;jsts.operation.buffer.OffsetSegmentGenerator.prototype.offset1=null;jsts.operation.buffer.OffsetSegmentGenerator.prototype.side=0;jsts.operation.buffer.OffsetSegmentGenerator.prototype.hasNarrowConcaveAngle=false;jsts.operation.buffer.OffsetSegmentGenerator.prototype.hasNarrowConcaveAngle=function(){return this.hasNarrowConcaveAngle;};jsts.operation.buffer.OffsetSegmentGenerator.prototype.init=function(distance){this.distance=distance;this.maxCurveSegmentError=this.distance*(1-Math.cos(this.filletAngleQuantum/2.0));this.segList=new jsts.operation.buffer.OffsetSegmentString();this.segList.setPrecisionModel(this.precisionModel);this.segList.setMinimumVertexDistance(this.distance*jsts.operation.buffer.OffsetSegmentGenerator.CURVE_VERTEX_SNAP_DISTANCE_FACTOR);};jsts.operation.buffer.OffsetSegmentGenerator.prototype.initSideSegments=function(s1,s2,side){this.s1=s1;this.s2=s2;this.side=side;this.seg1.setCoordinates(this.s1,this.s2);this.computeOffsetSegment(this.seg1,this.side,this.distance,this.offset1);};jsts.operation.buffer.OffsetSegmentGenerator.prototype.getCoordinates=function(){return this.segList.getCoordinates();};jsts.operation.buffer.OffsetSegmentGenerator.prototype.closeRing=function(){this.segList.closeRing();};jsts.operation.buffer.OffsetSegmentGenerator.prototype.addSegments=function(pt,isForward){this.segList.addPts(pt,isForward);};jsts.operation.buffer.OffsetSegmentGenerator.prototype.addFirstSegment=function(){this.segList.addPt(this.offset1.p0);};jsts.operation.buffer.OffsetSegmentGenerator.prototype.addLastSegment=function(){this.segList.addPt(this.offset1.p1);};jsts.operation.buffer.OffsetSegmentGenerator.prototype.addNextSegment=function(p,addStartPoint){this.s0=this.s1;this.s1=this.s2;this.s2=p;this.seg0.setCoordinates(this.s0,this.s1);this.computeOffsetSegment(this.seg0,this.side,this.distance,this.offset0);this.seg1.setCoordinates(this.s1,this.s2);this.computeOffsetSegment(this.seg1,this.side,this.distance,this.offset1);if(this.s1.equals(this.s2))
return;var orientation=jsts.algorithm.CGAlgorithms.computeOrientation(this.s0,this.s1,this.s2);var outsideTurn=(orientation===jsts.algorithm.CGAlgorithms.CLOCKWISE&&this.side===jsts.geomgraph.Position.LEFT)||(orientation===jsts.algorithm.CGAlgorithms.COUNTERCLOCKWISE&&this.side===jsts.geomgraph.Position.RIGHT);if(orientation==0){this.addCollinear(addStartPoint);}else if(outsideTurn){this.addOutsideTurn(orientation,addStartPoint);}else{this.addInsideTurn(orientation,addStartPoint);}};jsts.operation.buffer.OffsetSegmentGenerator.prototype.addCollinear=function(addStartPoint){this.li.computeIntersection(this.s0,this.s1,this.s1,this.s2);var numInt=this.li.getIntersectionNum();if(numInt>=2){if(this.bufParams.getJoinStyle()===jsts.operation.buffer.BufferParameters.JOIN_BEVEL||this.bufParams.getJoinStyle()===jsts.operation.buffer.BufferParameters.JOIN_MITRE){if(addStartPoint)
this.segList.addPt(this.offset0.p1);this.segList.addPt(this.offset1.p0);}else{this.addFillet(this.s1,this.offset0.p1,this.offset1.p0,jsts.algorithm.CGAlgorithms.CLOCKWISE,this.distance);}}};jsts.operation.buffer.OffsetSegmentGenerator.prototype.addOutsideTurn=function(orientation,addStartPoint){if(this.offset0.p1.distance(this.offset1.p0)<this.distance*jsts.operation.buffer.OffsetSegmentGenerator.OFFSET_SEGMENT_SEPARATION_FACTOR){this.segList.addPt(this.offset0.p1);return;}
if(this.bufParams.getJoinStyle()===jsts.operation.buffer.BufferParameters.JOIN_MITRE){this.addMitreJoin(this.s1,this.offset0,this.offset1,this.distance);}else if(this.bufParams.getJoinStyle()===jsts.operation.buffer.BufferParameters.JOIN_BEVEL){this.addBevelJoin(this.offset0,this.offset1);}else{if(addStartPoint)
this.segList.addPt(this.offset0.p1);this.addFillet(this.s1,this.offset0.p1,this.offset1.p0,orientation,this.distance);this.segList.addPt(this.offset1.p0);}};jsts.operation.buffer.OffsetSegmentGenerator.prototype.addInsideTurn=function(orientation,addStartPoint){this.li.computeIntersection(this.offset0.p0,this.offset0.p1,this.offset1.p0,this.offset1.p1);if(this.li.hasIntersection()){this.segList.addPt(this.li.getIntersection(0));}else{this.hasNarrowConcaveAngle=true;if(this.offset0.p1.distance(this.offset1.p0)<this.distance*jsts.operation.buffer.OffsetSegmentGenerator.INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR){this.segList.addPt(this.offset0.p1);}else{this.segList.addPt(this.offset0.p1);if(this.closingSegLengthFactor>0){var mid0=new jsts.geom.Coordinate((this.closingSegLengthFactor*this.offset0.p1.x+this.s1.x)/(this.closingSegLengthFactor+1),(this.closingSegLengthFactor*this.offset0.p1.y+this.s1.y)/(this.closingSegLengthFactor+1));this.segList.addPt(mid0);var mid1=new jsts.geom.Coordinate((this.closingSegLengthFactor*this.offset1.p0.x+this.s1.x)/(this.closingSegLengthFactor+1),(this.closingSegLengthFactor*this.offset1.p0.y+this.s1.y)/(this.closingSegLengthFactor+1));this.segList.addPt(mid1);}else{this.segList.addPt(this.s1);}
this.segList.addPt(this.offset1.p0);}}};jsts.operation.buffer.OffsetSegmentGenerator.prototype.computeOffsetSegment=function(seg,side,distance,offset){var sideSign=side===jsts.geomgraph.Position.LEFT?1:-1;var dx=seg.p1.x-seg.p0.x;var dy=seg.p1.y-seg.p0.y;var len=Math.sqrt(dx*dx+dy*dy);var ux=sideSign*distance*dx/len;var uy=sideSign*distance*dy/len;offset.p0.x=seg.p0.x-uy;offset.p0.y=seg.p0.y+ux;offset.p1.x=seg.p1.x-uy;offset.p1.y=seg.p1.y+ux;};jsts.operation.buffer.OffsetSegmentGenerator.prototype.addLineEndCap=function(p0,p1){var seg=new jsts.geom.LineSegment(p0,p1);var offsetL=new jsts.geom.LineSegment();this.computeOffsetSegment(seg,jsts.geomgraph.Position.LEFT,this.distance,offsetL);var offsetR=new jsts.geom.LineSegment();this.computeOffsetSegment(seg,jsts.geomgraph.Position.RIGHT,this.distance,offsetR);var dx=p1.x-p0.x;var dy=p1.y-p0.y;var angle=Math.atan2(dy,dx);switch(this.bufParams.getEndCapStyle()){case jsts.operation.buffer.BufferParameters.CAP_ROUND:this.segList.addPt(offsetL.p1);this.addFillet(p1,angle+Math.PI/2,angle-Math.PI/2,jsts.algorithm.CGAlgorithms.CLOCKWISE,this.distance);this.segList.addPt(offsetR.p1);break;case jsts.operation.buffer.BufferParameters.CAP_FLAT:this.segList.addPt(offsetL.p1);this.segList.addPt(offsetR.p1);break;case jsts.operation.buffer.BufferParameters.CAP_SQUARE:var squareCapSideOffset=new jsts.geom.Coordinate();squareCapSideOffset.x=Math.abs(this.distance)*Math.cos(angle);squareCapSideOffset.y=Math.abs(this.distance)*Math.sin(angle);var squareCapLOffset=new jsts.geom.Coordinate(offsetL.p1.x+
squareCapSideOffset.x,offsetL.p1.y+squareCapSideOffset.y);var squareCapROffset=new jsts.geom.Coordinate(offsetR.p1.x+
squareCapSideOffset.x,offsetR.p1.y+squareCapSideOffset.y);this.segList.addPt(squareCapLOffset);this.segList.addPt(squareCapROffset);break;}};jsts.operation.buffer.OffsetSegmentGenerator.prototype.addMitreJoin=function(p,offset0,offset1,distance){var isMitreWithinLimit=true;var intPt=null;try{intPt=jsts.algorithm.HCoordinate.intersection(offset0.p0,offset0.p1,offset1.p0,offset1.p1);var mitreRatio=distance<=0.0?1.0:intPt.distance(p)/Math.abs(distance);if(mitreRatio>this.bufParams.getMitreLimit())
this.isMitreWithinLimit=false;}catch(e){if(e instanceof jsts.error.NotRepresentableError){intPt=new jsts.geom.Coordinate(0,0);this.isMitreWithinLimit=false;}}
if(isMitreWithinLimit){this.segList.addPt(intPt);}else{this.addLimitedMitreJoin(offset0,offset1,distance,bufParams.getMitreLimit());}};jsts.operation.buffer.OffsetSegmentGenerator.prototype.addLimitedMitreJoin=function(offset0,offset1,distance,mitreLimit){var basePt=this.seg0.p1;var ang0=jsts.algorithm.Angle.angle(basePt,this.seg0.p0);var ang1=jsts.algorithm.Angle.angle(basePt,this.seg1.p1);var angDiff=jsts.algorithm.Angle.angleBetweenOriented(this.seg0.p0,basePt,this.seg1.p1);var angDiffHalf=angDiff/2;var midAng=jsts.algorithm.Angle.normalize(ang0+angDiffHalf);var mitreMidAng=jsts.algorithm.Angle.normalize(midAng+Math.PI);var mitreDist=mitreLimit*distance;var bevelDelta=mitreDist*Math.abs(Math.sin(angDiffHalf));var bevelHalfLen=distance-bevelDelta;var bevelMidX=basePt.x+mitreDist*Math.cos(mitreMidAng);var bevelMidY=basePt.y+mitreDist*Math.sin(mitreMidAng);var bevelMidPt=new jsts.geom.Coordinate(bevelMidX,bevelMidY);var mitreMidLine=new jsts.geom.LineSegment(basePt,bevelMidPt);var bevelEndLeft=mitreMidLine.pointAlongOffset(1.0,bevelHalfLen);var bevelEndRight=mitreMidLine.pointAlongOffset(1.0,-bevelHalfLen);if(this.side==jsts.geomgraph.Position.LEFT){this.segList.addPt(bevelEndLeft);this.segList.addPt(bevelEndRight);}else{this.segList.addPt(bevelEndRight);this.segList.addPt(bevelEndLeft);}};jsts.operation.buffer.OffsetSegmentGenerator.prototype.addBevelJoin=function(offset0,offset1){this.segList.addPt(offset0.p1);this.segList.addPt(offset1.p0);};jsts.operation.buffer.OffsetSegmentGenerator.prototype.addFillet=function(p,p0,p1,direction,radius){if(!(p1 instanceof jsts.geom.Coordinate)){this.addFillet2.apply(this,arguments);return;}
var dx0=p0.x-p.x;var dy0=p0.y-p.y;var startAngle=Math.atan2(dy0,dx0);var dx1=p1.x-p.x;var dy1=p1.y-p.y;var endAngle=Math.atan2(dy1,dx1);if(direction===jsts.algorithm.CGAlgorithms.CLOCKWISE){if(startAngle<=endAngle)
startAngle+=2.0*Math.PI;}else{if(startAngle>=endAngle)
startAngle-=2.0*Math.PI;}
this.segList.addPt(p0);this.addFillet(p,startAngle,endAngle,direction,radius);this.segList.addPt(p1);};jsts.operation.buffer.OffsetSegmentGenerator.prototype.addFillet2=function(p,startAngle,endAngle,direction,radius){var directionFactor=direction===jsts.algorithm.CGAlgorithms.CLOCKWISE?-1:1;var totalAngle=Math.abs(startAngle-endAngle);var nSegs=parseInt((totalAngle/this.filletAngleQuantum+0.5));if(nSegs<1)
return;var initAngle,currAngleInc;initAngle=0.0;currAngleInc=totalAngle/nSegs;var currAngle=initAngle;var pt=new jsts.geom.Coordinate();while(currAngle<totalAngle){var angle=startAngle+directionFactor*currAngle;pt.x=p.x+radius*Math.cos(angle);pt.y=p.y+radius*Math.sin(angle);this.segList.addPt(pt);currAngle+=currAngleInc;}};jsts.operation.buffer.OffsetSegmentGenerator.prototype.createCircle=function(p){var pt=new jsts.geom.Coordinate(p.x+this.distance,p.y);this.segList.addPt(pt);this.addFillet(p,0.0,2.0*Math.PI,-1,this.distance);this.segList.closeRing();};jsts.operation.buffer.OffsetSegmentGenerator.prototype.createSquare=function(p){this.segList.addPt(new jsts.geom.Coordinate(p.x+distance,p.y+distance));this.segList.addPt(new jsts.geom.Coordinate(p.x+distance,p.y-distance));this.segList.addPt(new jsts.geom.Coordinate(p.x-distance,p.y-distance));this.segList.addPt(new jsts.geom.Coordinate(p.x-distance,p.y+distance));this.segList.closeRing();};jsts.operation.overlay.MaximalEdgeRing=function(start,geometryFactory){jsts.geomgraph.EdgeRing.call(this,start,geometryFactory);};jsts.operation.overlay.MaximalEdgeRing.prototype=new jsts.geomgraph.EdgeRing();jsts.operation.overlay.MaximalEdgeRing.constructor=jsts.operation.overlay.MaximalEdgeRing;jsts.operation.overlay.MaximalEdgeRing.prototype.getNext=function(de)
{return de.getNext();};jsts.operation.overlay.MaximalEdgeRing.prototype.setEdgeRing=function(de,er)
{de.setEdgeRing(er);};jsts.operation.overlay.MaximalEdgeRing.prototype.linkDirectedEdgesForMinimalEdgeRings=function()
{var de=this.startDe;do{var node=de.getNode();node.getEdges().linkMinimalDirectedEdges(this);de=de.getNext();}while(de!=this.startDe);};jsts.operation.overlay.MaximalEdgeRing.prototype.buildMinimalRings=function()
{var minEdgeRings=[];var de=this.startDe;do{if(de.getMinEdgeRing()===null){var minEr=new jsts.operation.overlay.MinimalEdgeRing(de,this.geometryFactory);minEdgeRings.push(minEr);}
de=de.getNext();}while(de!=this.startDe);return minEdgeRings;};jsts.algorithm.CentroidPoint=function(){this.centSum=new jsts.geom.Coordinate();};jsts.algorithm.CentroidPoint.prototype.ptCount=0;jsts.algorithm.CentroidPoint.prototype.centSum=null;jsts.algorithm.CentroidPoint.prototype.add=function(geom){if(geom instanceof jsts.geom.Point){this.add2(geom.getCoordinate());}else if(geom instanceof jsts.geom.GeometryCollection||geom instanceof jsts.geom.MultiPoint||geom instanceof jsts.geom.MultiLineString||geom instanceof jsts.geom.MultiPolygon){var gc=geom;for(var i=0;i<gc.getNumGeometries();i++){this.add(gc.getGeometryN(i));}}};jsts.algorithm.CentroidPoint.prototype.add2=function(pt){this.ptCount+=1;this.centSum.x+=pt.x;this.centSum.y+=pt.y;};jsts.algorithm.CentroidPoint.prototype.getCentroid=function(){var cent=new jsts.geom.Coordinate();cent.x=this.centSum.x/this.ptCount;cent.y=this.centSum.y/this.ptCount;return cent;};jsts.operation.distance.ConnectedElementLocationFilter=function(locations){this.locations=locations;};jsts.operation.distance.ConnectedElementLocationFilter.prototype=new jsts.geom.GeometryFilter();jsts.operation.distance.ConnectedElementLocationFilter.prototype.locations=null;jsts.operation.distance.ConnectedElementLocationFilter.getLocations=function(geom){var locations=[];geom.apply(new jsts.operation.distance.ConnectedElementLocationFilter(locations));return locations;};jsts.operation.distance.ConnectedElementLocationFilter.prototype.filter=function(geom){if(geom instanceof jsts.geom.Point||geom instanceof jsts.geom.LineString||geom instanceof jsts.geom.Polygon)
this.locations.push(new jsts.operation.distance.GeometryLocation(geom,0,geom.getCoordinate()));};jsts.geomgraph.index.MonotoneChainEdge=function(e){this.e=e;this.pts=e.getCoordinates();var mcb=new jsts.geomgraph.index.MonotoneChainIndexer();this.startIndex=mcb.getChainStartIndices(this.pts);};jsts.geomgraph.index.MonotoneChainEdge.prototype.e=null;jsts.geomgraph.index.MonotoneChainEdge.prototype.pts=null;jsts.geomgraph.index.MonotoneChainEdge.prototype.startIndex=null;jsts.geomgraph.index.MonotoneChainEdge.prototype.env1=new jsts.geom.Envelope();jsts.geomgraph.index.MonotoneChainEdge.prototype.env2=new jsts.geom.Envelope();jsts.geomgraph.index.MonotoneChainEdge.prototype.getCoordinates=function(){return this.pts;};jsts.geomgraph.index.MonotoneChainEdge.prototype.getStartIndexes=function(){return this.startIndex;};jsts.geomgraph.index.MonotoneChainEdge.prototype.getMinX=function(chainIndex){var x1=this.pts[this.startIndex[chainIndex]].x;var x2=this.pts[this.startIndex[chainIndex+1]].x;if(x1<x2){return x1;}
return x2;};jsts.geomgraph.index.MonotoneChainEdge.prototype.getMaxX=function(chainIndex){var x1=this.pts[this.startIndex[chainIndex]].x;var x2=this.pts[this.startIndex[chainIndex+1]].x;if(x1>x2){return x1;}
return x2;};jsts.geomgraph.index.MonotoneChainEdge.prototype.computeIntersects=function(mce,si){for(var i=0;i<this.startIndex.length-1;i++){for(var j=0;j<mce.startIndex.length-1;j++){this.computeIntersectsForChain(i,mce,j,si);}}};jsts.geomgraph.index.MonotoneChainEdge.prototype.computeIntersectsForChain=function(chainIndex0,mce,chainIndex1,si){this.computeIntersectsForChain2(this.startIndex[chainIndex0],this.startIndex[chainIndex0+1],mce,mce.startIndex[chainIndex1],mce.startIndex[chainIndex1+1],si);};jsts.geomgraph.index.MonotoneChainEdge.prototype.computeIntersectsForChain2=function(start0,end0,mce,start1,end1,ei){var p00=this.pts[start0];var p01=this.pts[end0];var p10=mce.pts[start1];var p11=mce.pts[end1];if(end0-start0==1&&end1-start1==1){ei.addIntersections(this.e,start0,mce.e,start1);return;}
this.env1.init(p00,p01);this.env2.init(p10,p11);if(!this.env1.intersects(this.env2)){return;}
var mid0=Math.floor((start0+end0)/2);var mid1=Math.floor((start1+end1)/2);if(start0<mid0){if(start1<mid1){this.computeIntersectsForChain2(start0,mid0,mce,start1,mid1,ei);}
if(mid1<end1){this.computeIntersectsForChain2(start0,mid0,mce,mid1,end1,ei);}}
if(mid0<end0){if(start1<mid1){this.computeIntersectsForChain2(mid0,end0,mce,start1,mid1,ei);}
if(mid1<end1){this.computeIntersectsForChain2(mid0,end0,mce,mid1,end1,ei);}}};(function(){var ArrayList=javascript.util.ArrayList;jsts.operation.relate.EdgeEndBuilder=function(){};jsts.operation.relate.EdgeEndBuilder.prototype.computeEdgeEnds=function(edges){if(arguments.length==2){this.computeEdgeEnds2.apply(this,arguments);return;}
var l=new ArrayList();for(var i=edges;i.hasNext();){var e=i.next();this.computeEdgeEnds2(e,l);}
return l;};jsts.operation.relate.EdgeEndBuilder.prototype.computeEdgeEnds2=function(edge,l){var eiList=edge.getEdgeIntersectionList();eiList.addEndpoints();var it=eiList.iterator();var eiPrev=null;var eiCurr=null;if(!it.hasNext())
return;var eiNext=it.next();do{eiPrev=eiCurr;eiCurr=eiNext;eiNext=null;if(it.hasNext())
eiNext=it.next();if(eiCurr!==null){this.createEdgeEndForPrev(edge,l,eiCurr,eiPrev);this.createEdgeEndForNext(edge,l,eiCurr,eiNext);}}while(eiCurr!==null);};jsts.operation.relate.EdgeEndBuilder.prototype.createEdgeEndForPrev=function(edge,l,eiCurr,eiPrev){var iPrev=eiCurr.segmentIndex;if(eiCurr.dist===0.0){if(iPrev===0)
return;iPrev--;}
var pPrev=edge.getCoordinate(iPrev);if(eiPrev!==null&&eiPrev.segmentIndex>=iPrev)
pPrev=eiPrev.coord;var label=new jsts.geomgraph.Label(edge.getLabel());label.flip();var e=new jsts.geomgraph.EdgeEnd(edge,eiCurr.coord,pPrev,label);l.add(e);};jsts.operation.relate.EdgeEndBuilder.prototype.createEdgeEndForNext=function(edge,l,eiCurr,eiNext){var iNext=eiCurr.segmentIndex+1;if(iNext>=edge.getNumPoints()&&eiNext===null)
return;var pNext=edge.getCoordinate(iNext);if(eiNext!==null&&eiNext.segmentIndex===eiCurr.segmentIndex)
pNext=eiNext.coord;var e=new jsts.geomgraph.EdgeEnd(edge,eiCurr.coord,pNext,new jsts.geomgraph.Label(edge.getLabel()));l.add(e);};})();(function(){var ArrayList=javascript.util.ArrayList;var TreeSet=javascript.util.TreeSet;var CoordinateFilter=jsts.geom.CoordinateFilter;jsts.util.UniqueCoordinateArrayFilter=function(){this.treeSet=new TreeSet();this.list=new ArrayList();};jsts.util.UniqueCoordinateArrayFilter.prototype=new CoordinateFilter();jsts.util.UniqueCoordinateArrayFilter.prototype.treeSet=null;jsts.util.UniqueCoordinateArrayFilter.prototype.list=null;jsts.util.UniqueCoordinateArrayFilter.prototype.getCoordinates=function(){return this.list.toArray();};jsts.util.UniqueCoordinateArrayFilter.prototype.filter=function(coord){if(!this.treeSet.contains(coord)){this.list.add(coord);this.treeSet.add(coord);}};})();(function(){var CGAlgorithms=jsts.algorithm.CGAlgorithms;var UniqueCoordinateArrayFilter=jsts.util.UniqueCoordinateArrayFilter;var Assert=jsts.util.Assert;var Stack=javascript.util.Stack;var ArrayList=javascript.util.ArrayList;var Arrays=javascript.util.Arrays;var RadialComparator=function(origin){this.origin=origin;};RadialComparator.prototype.origin=null;RadialComparator.prototype.compare=function(o1,o2){var p1=o1;var p2=o2;return RadialComparator.polarCompare(this.origin,p1,p2);};RadialComparator.polarCompare=function(o,p,q){var dxp=p.x-o.x;var dyp=p.y-o.y;var dxq=q.x-o.x;var dyq=q.y-o.y;var orient=CGAlgorithms.computeOrientation(o,p,q);if(orient==CGAlgorithms.COUNTERCLOCKWISE)
return 1;if(orient==CGAlgorithms.CLOCKWISE)
return-1;var op=dxp*dxp+dyp*dyp;var oq=dxq*dxq+dyq*dyq;if(op<oq){return-1;}
if(op>oq){return 1;}
return 0;};jsts.algorithm.ConvexHull=function(){if(arguments.length===1){var geometry=arguments[0];this.inputPts=jsts.algorithm.ConvexHull.extractCoordinates(geometry);this.geomFactory=geometry.getFactory();}else{this.pts=arguments[0];this.geomFactory=arguments[1];}};jsts.algorithm.ConvexHull.prototype.geomFactory=null;jsts.algorithm.ConvexHull.prototype.inputPts=null;jsts.algorithm.ConvexHull.extractCoordinates=function(geom){var filter=new UniqueCoordinateArrayFilter();geom.apply(filter);return filter.getCoordinates();};jsts.algorithm.ConvexHull.prototype.getConvexHull=function(){if(this.inputPts.length==0){return this.geomFactory.createGeometryCollection(null);}
if(this.inputPts.length==1){return this.geomFactory.createPoint(this.inputPts[0]);}
if(this.inputPts.length==2){return this.geomFactory.createLineString(this.inputPts);}
var reducedPts=this.inputPts;if(this.inputPts.length>50){reducedPts=this.reduce(this.inputPts);}
var sortedPts=this.preSort(reducedPts);var cHS=this.grahamScan(sortedPts);var cH=cHS.toArray();return this.lineOrPolygon(cH);};jsts.algorithm.ConvexHull.prototype.reduce=function(inputPts){var polyPts=this.computeOctRing(inputPts);if(polyPts==null)
return this.inputPts;var reducedSet=new javascript.util.TreeSet();for(var i=0;i<polyPts.length;i++){reducedSet.add(polyPts[i]);}
for(var i=0;i<inputPts.length;i++){if(!CGAlgorithms.isPointInRing(inputPts[i],polyPts)){reducedSet.add(inputPts[i]);}}
var reducedPts=reducedSet.toArray();if(reducedPts.length<3)
return this.padArray3(reducedPts);return reducedPts;};jsts.algorithm.ConvexHull.prototype.padArray3=function(pts){var pad=[];for(var i=0;i<pad.length;i++){if(i<pts.length){pad[i]=pts[i];}else
pad[i]=pts[0];}
return pad;};jsts.algorithm.ConvexHull.prototype.preSort=function(pts){var t;for(var i=1;i<pts.length;i++){if((pts[i].y<pts[0].y)||((pts[i].y==pts[0].y)&&(pts[i].x<pts[0].x))){t=pts[0];pts[0]=pts[i];pts[i]=t;}}
Arrays.sort(pts,1,pts.length,new RadialComparator(pts[0]));return pts;};jsts.algorithm.ConvexHull.prototype.grahamScan=function(c){var p;var ps=new Stack();p=ps.push(c[0]);p=ps.push(c[1]);p=ps.push(c[2]);for(var i=3;i<c.length;i++){p=ps.pop();while(!ps.empty()&&CGAlgorithms.computeOrientation(ps.peek(),p,c[i])>0){p=ps.pop();}
p=ps.push(p);p=ps.push(c[i]);}
p=ps.push(c[0]);return ps;};jsts.algorithm.ConvexHull.prototype.isBetween=function(c1,c2,c3){if(CGAlgorithms.computeOrientation(c1,c2,c3)!==0){return false;}
if(c1.x!=c3.x){if(c1.x<=c2.x&&c2.x<=c3.x){return true;}
if(c3.x<=c2.x&&c2.x<=c1.x){return true;}}
if(c1.y!=c3.y){if(c1.y<=c2.y&&c2.y<=c3.y){return true;}
if(c3.y<=c2.y&&c2.y<=c1.y){return true;}}
return false;};jsts.algorithm.ConvexHull.prototype.computeOctRing=function(inputPts){var octPts=this.computeOctPts(inputPts);var coordList=new jsts.geom.CoordinateList();coordList.add(octPts,false);if(coordList.size()<3){return null;}
coordList.closeRing();return coordList.toCoordinateArray();};jsts.algorithm.ConvexHull.prototype.computeOctPts=function(inputPts){var pts=[];for(var j=0;j<8;j++){pts[j]=inputPts[0];}
for(var i=1;i<inputPts.length;i++){if(inputPts[i].x<pts[0].x){pts[0]=inputPts[i];}
if(inputPts[i].x-inputPts[i].y<pts[1].x-pts[1].y){pts[1]=inputPts[i];}
if(inputPts[i].y>pts[2].y){pts[2]=inputPts[i];}
if(inputPts[i].x+inputPts[i].y>pts[3].x+pts[3].y){pts[3]=inputPts[i];}
if(inputPts[i].x>pts[4].x){pts[4]=inputPts[i];}
if(inputPts[i].x-inputPts[i].y>pts[5].x-pts[5].y){pts[5]=inputPts[i];}
if(inputPts[i].y<pts[6].y){pts[6]=inputPts[i];}
if(inputPts[i].x+inputPts[i].y<pts[7].x+pts[7].y){pts[7]=inputPts[i];}}
return pts;};jsts.algorithm.ConvexHull.prototype.lineOrPolygon=function(coordinates){coordinates=this.cleanRing(coordinates);if(coordinates.length==3){return this.geomFactory.createLineString([coordinates[0],coordinates[1]]);}
var linearRing=this.geomFactory.createLinearRing(coordinates);return this.geomFactory.createPolygon(linearRing,null);};jsts.algorithm.ConvexHull.prototype.cleanRing=function(original){Assert.equals(original[0],original[original.length-1]);var cleanedRing=new ArrayList();var previousDistinctCoordinate=null;for(var i=0;i<=original.length-2;i++){var currentCoordinate=original[i];var nextCoordinate=original[i+1];if(currentCoordinate.equals(nextCoordinate)){continue;}
if(previousDistinctCoordinate!=null&&this.isBetween(previousDistinctCoordinate,currentCoordinate,nextCoordinate)){continue;}
cleanedRing.add(currentCoordinate);previousDistinctCoordinate=currentCoordinate;}
cleanedRing.add(original[original.length-1]);var cleanedRingCoordinates=[];return cleanedRing.toArray(cleanedRingCoordinates);};})();jsts.algorithm.MinimumDiameter=function(inputGeom,isConvex){this.convexHullPts=null;this.minBaseSeg=new jsts.geom.LineSegment();this.minWidthPt=null;this.minPtIndex=0;this.minWidth=0;jsts.algorithm.MinimumDiameter.inputGeom=inputGeom;jsts.algorithm.MinimumDiameter.isConvex=isConvex||false;};jsts.algorithm.MinimumDiameter.inputGeom=null;jsts.algorithm.MinimumDiameter.isConvex=false;jsts.algorithm.MinimumDiameter.nextIndex=function(pts,index){index++;if(index>=pts.length){index=0;}
return index;};jsts.algorithm.MinimumDiameter.computeC=function(a,b,p){return a*p.y-b*p.x;};jsts.algorithm.MinimumDiameter.computeSegmentForLine=function(a,b,c){var p0;var p1;if(Math.abs(b)>Math.abs(a)){p0=new jsts.geom.Coordinate(0,c/b);p1=new jsts.geom.Coordinate(1,c/b-a/b);}
else{p0=new jsts.geom.Coordinate(c/a,0);p1=new jsts.geom.Coordinate(c/a-b/a,1);}
return new jsts.geom.LineSegment(p0,p1);};jsts.algorithm.MinimumDiameter.prototype.getLength=function(){this.computeMinimumDiameter();return this.minWidth;};jsts.algorithm.MinimumDiameter.prototype.getWidthCoordinate=function(){this.computeMinimumDiameter();return this.minWidthPt;};jsts.algorithm.MinimumDiameter.prototype.getSupportingSegment=function(){this.computeMinimumDiameter();var coord=[this.minBaseSeg.p0,this.minBaseSeg.p1];return jsts.algorithm.MinimumDiameter.inputGeom.getFactory().createLineString(coord);};jsts.algorithm.MinimumDiameter.prototype.getDiameter=function(){this.computeMinimumDiameter();if(this.minWidthPt===null){return jsts.algorithm.MinimumDiameter.inputGeom.getFactory().createLineString(null);}
var basePt=this.minBaseSeg.project(this.minWidthPt);return jsts.algorithm.MinimumDiameter.inputGeom.getFactory().createLineString([basePt,this.minWidthPt]);};jsts.algorithm.MinimumDiameter.prototype.computeMinimumDiameter=function(){if(this.minWidthPt!==null){return;}
if(jsts.algorithm.MinimumDiameter.isConvex)
this.computeWidthConvex(jsts.algorithm.MinimumDiameter.inputGeom);else{var convexGeom=new jsts.algorithm.ConvexHull(jsts.algorithm.MinimumDiameter.inputGeom).getConvexHull();this.computeWidthConvex(convexGeom);}};jsts.algorithm.MinimumDiameter.prototype.computeWidthConvex=function(convexGeom){if(convexGeom instanceof jsts.geom.Polygon){this.convexHullPts=convexGeom.getExteriorRing().getCoordinates();}else{this.convexHullPts=convexGeom.getCoordinates();}
if(this.convexHullPts.length===0){this.minWidth=0;this.minWidthPt=null;this.minBaseSeg=null;}else if(this.convexHullPts.length===1){this.minWidth=0;this.minWidthPt=this.convexHullPts[0];this.minBaseSeg.p0=this.convexHullPts[0];this.minBaseSeg.p1=this.convexHullPts[0];}else if(this.convexHullPts.length===2||this.convexHullPts.length===3){this.minWidth=0;this.minWidthPt=this.convexHullPts[0];this.minBaseSeg.p0=this.convexHullPts[0];this.minBaseSeg.p1=this.convexHullPts[1];}else{this.computeConvexRingMinDiameter(this.convexHullPts);}};jsts.algorithm.MinimumDiameter.prototype.computeConvexRingMinDiameter=function(pts){this.minWidth=Number.MAX_VALUE;var currMaxIndex=1;var seg=new jsts.geom.LineSegment();for(var i=0;i<pts.length-1;i++){seg.p0=pts[i];seg.p1=pts[i+1];currMaxIndex=this.findMaxPerpDistance(pts,seg,currMaxIndex);}};jsts.algorithm.MinimumDiameter.prototype.findMaxPerpDistance=function(pts,seg,startIndex){var maxPerpDistance=seg.distancePerpendicular(pts[startIndex]);var nextPerpDistance=maxPerpDistance;var maxIndex=startIndex;var nextIndex=maxIndex;while(nextPerpDistance>=maxPerpDistance){maxPerpDistance=nextPerpDistance;maxIndex=nextIndex;nextIndex=jsts.algorithm.MinimumDiameter.nextIndex(pts,maxIndex);nextPerpDistance=seg.distancePerpendicular(pts[nextIndex]);}
if(maxPerpDistance<this.minWidth){this.minPtIndex=maxIndex;this.minWidth=maxPerpDistance;this.minWidthPt=pts[this.minPtIndex];this.minBaseSeg=new jsts.geom.LineSegment(seg);}
return maxIndex;};jsts.algorithm.MinimumDiameter.prototype.getMinimumRectangle=function(){this.computeMinimumDiameter();if(this.minWidth===0){if(this.minBaseSeg.p0.equals2D(this.minBaseSeg.p1)){return jsts.algorithm.MinimumDiameter.inputGeom.getFactory().createPoint(this.minBaseSeg.p0);}
return this.minBaseSeg.toGeometry(jsts.algorithm.MinimumDiameter.inputGeom.getFactory());}
var dx=this.minBaseSeg.p1.x-this.minBaseSeg.p0.x;var dy=this.minBaseSeg.p1.y-this.minBaseSeg.p0.y;var minPara=Number.MAX_VALUE;var maxPara=-Number.MAX_VALUE;var minPerp=Number.MAX_VALUE;var maxPerp=-Number.MAX_VALUE;for(var i=0;i<this.convexHullPts.length;i++){var paraC=jsts.algorithm.MinimumDiameter.computeC(dx,dy,this.convexHullPts[i]);if(paraC>maxPara)maxPara=paraC;if(paraC<minPara)minPara=paraC;var perpC=jsts.algorithm.MinimumDiameter.computeC(-dy,dx,this.convexHullPts[i]);if(perpC>maxPerp)maxPerp=perpC;if(perpC<minPerp)minPerp=perpC;}
var maxPerpLine=jsts.algorithm.MinimumDiameter.computeSegmentForLine(-dx,-dy,maxPerp);var minPerpLine=jsts.algorithm.MinimumDiameter.computeSegmentForLine(-dx,-dy,minPerp);var maxParaLine=jsts.algorithm.MinimumDiameter.computeSegmentForLine(-dy,dx,maxPara);var minParaLine=jsts.algorithm.MinimumDiameter.computeSegmentForLine(-dy,dx,minPara);var p0=maxParaLine.lineIntersection(maxPerpLine);var p1=minParaLine.lineIntersection(maxPerpLine);var p2=minParaLine.lineIntersection(minPerpLine);var p3=maxParaLine.lineIntersection(minPerpLine);var shell=jsts.algorithm.MinimumDiameter.inputGeom.getFactory().createLinearRing([p0,p1,p2,p3,p0]);return jsts.algorithm.MinimumDiameter.inputGeom.getFactory().createPolygon(shell,null);};(function(){jsts.io.GeoJSONParser=function(geometryFactory){this.geometryFactory=geometryFactory||new jsts.geom.GeometryFactory();this.geometryTypes=['Point','MultiPoint','LineString','MultiLineString','Polygon','MultiPolygon'];};jsts.io.GeoJSONParser.prototype.read=function(json){var obj;if(typeof json==='string'){obj=JSON.parse(json);}else{obj=json;}
var type=obj.type;if(!this.parse[type]){throw new Error('Unknown GeoJSON type: '+obj.type);}
if(this.geometryTypes.indexOf(type)!=-1){return this.parse[type].apply(this,[obj.coordinates]);}else if(type==='GeometryCollection'){return this.parse[type].apply(this,[obj.geometries]);}
return this.parse[type].apply(this,[obj]);};jsts.io.GeoJSONParser.prototype.parse={'Feature':function(obj){var feature={};for(var key in obj){feature[key]=obj[key];}
if(obj.geometry){var type=obj.geometry.type;if(!this.parse[type]){throw new Error('Unknown GeoJSON type: '+obj.type);}
feature.geometry=this.read(obj.geometry);}
if(obj.bbox){feature.bbox=this.parse.bbox.apply(this,[obj.bbox]);}
return feature;},'FeatureCollection':function(obj){var featureCollection={};if(obj.features){featureCollection.features=[];for(var i=0;i<obj.features.length;++i){featureCollection.features.push(this.read(obj.features[i]));}}
if(obj.bbox){featureCollection.bbox=this.parse.bbox.apply(this,[obj.bbox]);}
return featureCollection;},'coordinates':function(array){var coordinates=[];for(var i=0;i<array.length;++i){var sub=array[i];coordinates.push(new jsts.geom.Coordinate(sub[0],sub[1]));}
return coordinates;},'bbox':function(array){return this.geometryFactory.createLinearRing([new jsts.geom.Coordinate(array[0],array[1]),new jsts.geom.Coordinate(array[2],array[1]),new jsts.geom.Coordinate(array[2],array[3]),new jsts.geom.Coordinate(array[0],array[3]),new jsts.geom.Coordinate(array[0],array[1])]);},'Point':function(array){var coordinate=new jsts.geom.Coordinate(array[0],array[1]);return this.geometryFactory.createPoint(coordinate);},'MultiPoint':function(array){var points=[];for(var i=0;i<array.length;++i){points.push(this.parse.Point.apply(this,[array[i]]));}
return this.geometryFactory.createMultiPoint(points);},'LineString':function(array){var coordinates=this.parse.coordinates.apply(this,[array]);return this.geometryFactory.createLineString(coordinates);},'MultiLineString':function(array){var lineStrings=[];for(var i=0;i<array.length;++i){lineStrings.push(this.parse.LineString.apply(this,[array[i]]));}
return this.geometryFactory.createMultiLineString(lineStrings);},'Polygon':function(array){var shellCoordinates=this.parse.coordinates.apply(this,[array[0]]);var shell=this.geometryFactory.createLinearRing(shellCoordinates);var holes=[];for(var i=1;i<array.length;++i){var hole=array[i];var coordinates=this.parse.coordinates.apply(this,[hole]);var linearRing=this.geometryFactory.createLinearRing(coordinates);holes.push(linearRing);}
return this.geometryFactory.createPolygon(shell,holes);},'MultiPolygon':function(array){var polygons=[];for(var i=0;i<array.length;++i){var polygon=array[i];polygons.push(this.parse.Polygon.apply(this,[polygon]));}
return this.geometryFactory.createMultiPolygon(polygons);},'GeometryCollection':function(array){var geometries=[];for(var i=0;i<array.length;++i){var geometry=array[i];geometries.push(this.read(geometry));}
return this.geometryFactory.createGeometryCollection(geometries);}};jsts.io.GeoJSONParser.prototype.write=function(geometry){var type=geometry.CLASS_NAME.slice(10);if(!this.extract[type]){throw new Error('Geometry is not supported');}
return this.extract[type].apply(this,[geometry]);};jsts.io.GeoJSONParser.prototype.extract={'coordinate':function(coordinate){return[coordinate.x,coordinate.y];},'Point':function(point){var array=this.extract.coordinate.apply(this,[point.coordinate]);return{type:'Point',coordinates:array};},'MultiPoint':function(multipoint){var array=[];for(var i=0;i<multipoint.geometries.length;++i){var point=multipoint.geometries[i];var geoJson=this.extract.Point.apply(this,[point]);array.push(geoJson.coordinates);}
return{type:'MultiPoint',coordinates:array};},'LineString':function(linestring){var array=[];for(var i=0;i<linestring.points.length;++i){var coordinate=linestring.points[i];array.push(this.extract.coordinate.apply(this,[coordinate]));}
return{type:'LineString',coordinates:array};},'MultiLineString':function(multilinestring){var array=[];for(var i=0;i<multilinestring.geometries.length;++i){var linestring=multilinestring.geometries[i];var geoJson=this.extract.LineString.apply(this,[linestring]);array.push(geoJson.coordinates);}
return{type:'MultiLineString',coordinates:array};},'Polygon':function(polygon){var array=[];var shellGeoJson=this.extract.LineString.apply(this,[polygon.shell]);array.push(shellGeoJson.coordinates);for(var i=0;i<polygon.holes.length;++i){var hole=polygon.holes[i];var holeGeoJson=this.extract.LineString.apply(this,[hole]);array.push(holeGeoJson.coordinates);}
return{type:'Polygon',coordinates:array};},'MultiPolygon':function(multipolygon){var array=[];for(var i=0;i<multipolygon.geometries.length;++i){var polygon=multipolygon.geometries[i];var geoJson=this.extract.Polygon.apply(this,[polygon]);array.push(geoJson.coordinates);}
return{type:'MultiPolygon',coordinates:array};},'GeometryCollection':function(collection){var array=[];for(var i=0;i<collection.geometries.length;++i){var geometry=collection.geometries[i];var type=geometry.CLASS_NAME.slice(10);array.push(this.extract[type].apply(this,[geometry]));}
return{type:'GeometryCollection',geometries:array};}};})();jsts.triangulate.quadedge.Vertex=function(){if(arguments.length===1){this.initFromCoordinate(arguments[0]);}else{this.initFromXY(arguments[0],arguments[1]);}};jsts.triangulate.quadedge.Vertex.LEFT=0;jsts.triangulate.quadedge.Vertex.RIGHT=1;jsts.triangulate.quadedge.Vertex.BEYOND=2;jsts.triangulate.quadedge.Vertex.BEHIND=3;jsts.triangulate.quadedge.Vertex.BETWEEN=4;jsts.triangulate.quadedge.Vertex.ORIGIN=5;jsts.triangulate.quadedge.Vertex.DESTINATION=6;jsts.triangulate.quadedge.Vertex.prototype.initFromXY=function(x,y){this.p=new jsts.geom.Coordinate(x,y);};jsts.triangulate.quadedge.Vertex.prototype.initFromCoordinate=function(_p){this.p=new jsts.geom.Coordinate(_p);};jsts.triangulate.quadedge.Vertex.prototype.getX=function(){return this.p.x;};jsts.triangulate.quadedge.Vertex.prototype.getY=function(){return this.p.y;};jsts.triangulate.quadedge.Vertex.prototype.getZ=function(){return this.p.z;};jsts.triangulate.quadedge.Vertex.prototype.setZ=function(z){this.p.z=z;};jsts.triangulate.quadedge.Vertex.prototype.getCoordinate=function(){return this.p;};jsts.triangulate.quadedge.Vertex.prototype.toString=function(){return'POINT ('+this.p.x+' '+this.p.y+')';};jsts.triangulate.quadedge.Vertex.prototype.equals=function(){if(arguments.length===1){return this.equalsExact(arguments[0]);}else{return this.equalsWithTolerance(arguments[0],arguments[1]);}};jsts.triangulate.quadedge.Vertex.prototype.equalsExact=function(other){return(this.p.x===other.getX()&&this.p.y===other.getY());};jsts.triangulate.quadedge.Vertex.prototype.equalsWithTolerance=function(other,tolerance){return(this.p.distance(other.getCoordinate())<tolerance);};jsts.triangulate.quadedge.Vertex.prototype.classify=function(p0,p1){var p2,a,b,sa;p2=this;a=p1.sub(p0);b=p2.sub(p0);sa=a.crossProduct(b);if(sa>0.0){return jsts.triangulate.quadedge.Vertex.LEFT;}
if(sa<0.0){return jsts.triangulate.quadedge.Vertex.RIGHT;}
if((a.getX()*b.getX()<0.0)||(a.getY()*b.getY()<0.0)){return jsts.triangulate.quadedge.Vertex.BEHIND;}
if(a.magn()<b.magn()){return jsts.triangulate.quadedge.Vertex.BEYOND;}
if(p0.equals(p2)){return jsts.triangulate.quadedge.Vertex.ORIGIN;}
if(p1.equals(p2)){return jsts.triangulate.quadedge.Vertex.DESTINATION;}
return jsts.triangulate.quadedge.Vertex.BETWEEN;};jsts.triangulate.quadedge.Vertex.prototype.crossProduct=function(v){return((this.p.x*v.getY())-(this.p.y*v.getX()));};jsts.triangulate.quadedge.Vertex.prototype.dot=function(v){return((this.p.x*v.getX())+(this.p.y*v.getY()));};jsts.triangulate.quadedge.Vertex.prototype.times=function(c){return new jsts.triangulate.quadedge.Vertex(c*this.p.x,c*this.p.y);};jsts.triangulate.quadedge.Vertex.prototype.sum=function(v){return new jsts.triangulate.quadedge.Vertex(this.p.x+v.getX(),this.p.y+
v.getY());};jsts.triangulate.quadedge.Vertex.prototype.sub=function(v){return new jsts.triangulate.quadedge.Vertex(this.p.x-v.getX(),this.p.y-
v.getY());};jsts.triangulate.quadedge.Vertex.prototype.magn=function(){return(Math.sqrt((this.p.x*this.p.x)+(this.p.y*this.p.y)));};jsts.triangulate.quadedge.Vertex.prototype.cross=function(){return new Vertex(this.p.y,-this.p.x);};jsts.triangulate.quadedge.Vertex.prototype.isInCircle=function(a,b,c){return jsts.triangulate.quadedge.TrianglePredicate.isInCircleRobust(a.p,b.p,c.p,this.p);};jsts.triangulate.quadedge.Vertex.prototype.isCCW=function(b,c){return((b.p.x-this.p.x)*(c.p.y-this.p.y)-(b.p.y-this.p.y)*(c.p.x-this.p.x)>0);};jsts.triangulate.quadedge.Vertex.prototype.rightOf=function(e){return this.isCCW(e.dest(),e.orig());};jsts.triangulate.quadedge.Vertex.prototype.leftOf=function(e){return this.isCCW(e.orig(),e.dest());};jsts.triangulate.quadedge.Vertex.prototype.bisector=function(a,b){var dx,dy,l1,l2;dx=b.getX()-a.getX();dy=b.getY()-a.getY();l1=new jsts.algorithm.HCoordinate(a.getX()+(dx/2.0),a.getY()+
(dy/2.0),1.0);l2=new jsts.algorithm.HCoordinate(a.getX()-dy+(dx/2.0),a.getY()+
dx+(dy/2.0),1.0);return new jsts.algorithm.HCoordinate(l1,l2);};jsts.triangulate.quadedge.Vertex.prototype.distance=function(v1,v2){return v1.p.distance(v2.p);};jsts.triangulate.quadedge.Vertex.prototype.circumRadiusRatio=function(b,c){var x,radius,edgeLength,el;x=this.circleCenter(b,c);radius=this.distance(x,b);edgeLength=this.distance(this,b);el=this.distance(b,c);if(el<edgeLength){edgeLength=el;}
el=this.distance(c,this);if(el<edgeLength){edgeLength=el;}
return radius/edgeLength;};jsts.triangulate.quadedge.Vertex.prototype.midPoint=function(a){var xm,ym;xm=(this.p.x+a.getX())/2.0;ym=(this.p.y+a.getY())/2.0;return new jsts.triangulate.quadedge.Vertex(xm,ym);};jsts.triangulate.quadedge.Vertex.prototype.circleCenter=function(b,c){var a,cab,cbc,hcc,cc;a=new jsts.triangulate.quadedge.Vertex(this.getX(),this.getY());cab=this.bisector(a,b);cbc=this.bisector(b,c);hcc=new jsts.algorithm.HCoordinate(cab,cbc);cc=null;try{cc=new jsts.triangulate.quadedge.Vertex(hcc.getX(),hcc.getY());}catch(err){}
return cc;};jsts.operation.valid.IsValidOp=function(parentGeometry){this.parentGeometry=parentGeometry;this.isSelfTouchingRingFormingHoleValid=false;this.validErr=null;};jsts.operation.valid.IsValidOp.isValid=function(arg){if(arguments[0]instanceof jsts.geom.Coordinate){if(isNaN(arg.x)){return false;}
if(!isFinite(arg.x)&&!isNaN(arg.x)){return false;}
if(isNaN(arg.y)){return false;}
if(!isFinite(arg.y)&&!isNaN(arg.y)){return false;}
return true;}else{var isValidOp=new jsts.operation.valid.IsValidOp(arg);return isValidOp.isValid();}};jsts.operation.valid.IsValidOp.findPtNotNode=function(testCoords,searchRing,graph){var searchEdge=graph.findEdge(searchRing);var eiList=searchEdge.getEdgeIntersectionList();for(var i=0;i<testCoords.length;i++){var pt=testCoords[i];if(!eiList.isIntersection(pt)){return pt;}}
return null;};jsts.operation.valid.IsValidOp.prototype.setSelfTouchingRingFormingHoleValid=function(isValid){this.isSelfTouchingRingFormingHoleValid=isValid;};jsts.operation.valid.IsValidOp.prototype.isValid=function(){this.checkValid(this.parentGeometry);return this.validErr==null;};jsts.operation.valid.IsValidOp.prototype.getValidationError=function(){this.checkValid(this.parentGeometry);return this.validErr;};jsts.operation.valid.IsValidOp.prototype.checkValid=function(g){this.validErr=null;if(g.isEmpty()){return;}
if(g instanceof jsts.geom.Point){this.checkValidPoint(g);}else if(g instanceof jsts.geom.MultiPoint){this.checkValidMultiPoint(g);}else if(g instanceof jsts.geom.LinearRing){this.checkValidLinearRing(g);}else if(g instanceof jsts.geom.LineString){this.checkValidLineString(g);}else if(g instanceof jsts.geom.Polygon){this.checkValidPolygon(g);}else if(g instanceof jsts.geom.MultiPolygon){this.checkValidMultiPolygon(g);}else if(g instanceof jsts.geom.GeometryCollection){this.checkValidGeometryCollection(g);}else{throw g.constructor;}};jsts.operation.valid.IsValidOp.prototype.checkValidPoint=function(g){this.checkInvalidCoordinates(g.getCoordinates());};jsts.operation.valid.IsValidOp.prototype.checkValidMultiPoint=function(g){this.checkInvalidCoordinates(g.getCoordinates());};jsts.operation.valid.IsValidOp.prototype.checkValidLineString=function(g){this.checkInvalidCoordinates(g.getCoordinates());if(this.validErr!=null){return;}
var graph=new jsts.geomgraph.GeometryGraph(0,g);this.checkTooFewPoints(graph);};jsts.operation.valid.IsValidOp.prototype.checkValidLinearRing=function(g){this.checkInvalidCoordinates(g.getCoordinates());if(this.validErr!=null){return;}
this.checkClosedRing(g);if(this.validErr!=null){return;}
var graph=new jsts.geomgraph.GeometryGraph(0,g);this.checkTooFewPoints(graph);if(this.validErr!=null){return;}
var li=new jsts.algorithm.RobustLineIntersector();graph.computeSelfNodes(li,true);this.checkNoSelfIntersectingRings(graph);};jsts.operation.valid.IsValidOp.prototype.checkValidPolygon=function(g){this.checkInvalidCoordinates(g);if(this.validErr!=null){return;}
this.checkClosedRings(g);if(this.validErr!=null){return;}
var graph=new jsts.geomgraph.GeometryGraph(0,g);this.checkTooFewPoints(graph);if(this.validErr!=null){return;}
this.checkConsistentArea(graph);if(this.validErr!=null){return;}
if(!this.isSelfTouchingRingFormingHoleValid){this.checkNoSelfIntersectingRings(graph);if(this.validErr!=null){return;}}
this.checkHolesInShell(g,graph);if(this.validErr!=null){return;}
this.checkHolesNotNested(g,graph);if(this.validErr!=null){return;}
this.checkConnectedInteriors(graph);};jsts.operation.valid.IsValidOp.prototype.checkValidMultiPolygon=function(g){var il=g.getNumGeometries();for(var i=0;i<il;i++){var p=g.getGeometryN(i);this.checkInvalidCoordinates(p);if(this.validErr!=null){return;}
this.checkClosedRings(p);if(this.validErr!=null){return;}}
var graph=new jsts.geomgraph.GeometryGraph(0,g);this.checkTooFewPoints(graph);if(this.validErr!=null){return;}
this.checkConsistentArea(graph);if(this.validErr!=null){return;}
if(!this.isSelfTouchingRingFormingHoleValid){this.checkNoSelfIntersectingRings(graph);if(this.validErr!=null){return;}}
for(var i=0;i<g.getNumGeometries();i++){var p=g.getGeometryN(i);this.checkHolesInShell(p,graph);if(this.validErr!=null){return;}}
for(var i=0;i<g.getNumGeometries();i++){var p=g.getGeometryN(i);this.checkHolesNotNested(p,graph);if(this.validErr!=null){return;}}
this.checkShellsNotNested(g,graph);if(this.validErr!=null){return;}
this.checkConnectedInteriors(graph);};jsts.operation.valid.IsValidOp.prototype.checkValidGeometryCollection=function(gc){for(var i=0;i<gc.getNumGeometries();i++){var g=gc.getGeometryN(i);this.checkValid(g);if(this.validErr!=null){return;}}};jsts.operation.valid.IsValidOp.prototype.checkInvalidCoordinates=function(arg){if(arg instanceof jsts.geom.Polygon){var poly=arg;this.checkInvalidCoordinates(poly.getExteriorRing().getCoordinates());if(this.validErr!=null){return;}
for(var i=0;i<poly.getNumInteriorRing();i++){this.checkInvalidCoordinates(poly.getInteriorRingN(i).getCoordinates());if(this.validErr!=null){return;}}}else{var coords=arg;for(var i=0;i<coords.length;i++){if(!jsts.operation.valid.IsValidOp.isValid(coords[i])){this.validErr=new jsts.operation.valid.TopologyValidationError(jsts.operation.valid.TopologyValidationError.INVALID_COORDINATE,coords[i]);return;}}}};jsts.operation.valid.IsValidOp.prototype.checkClosedRings=function(poly){this.checkClosedRing(poly.getExteriorRing());if(this.validErr!=null){return;}
for(var i=0;i<poly.getNumInteriorRing();i++){this.checkClosedRing(poly.getInteriorRingN(i));if(this.validErr!=null){return;}}};jsts.operation.valid.IsValidOp.prototype.checkClosedRing=function(ring){if(!ring.isClosed()){var pt=null;if(ring.getNumPoints()>=1){pt=ring.getCoordinateN(0);}
this.validErr=new jsts.operation.valid.TopologyValidationError(jsts.operation.valid.TopologyValidationError.RING_NOT_CLOSED,pt);}};jsts.operation.valid.IsValidOp.prototype.checkTooFewPoints=function(graph){if(graph.hasTooFewPoints){this.validErr=new jsts.operation.valid.TopologyValidationError(jsts.operation.valid.TopologyValidationError.TOO_FEW_POINTS,graph.getInvalidPoint());return;}};jsts.operation.valid.IsValidOp.prototype.checkConsistentArea=function(graph){var cat=new jsts.operation.valid.ConsistentAreaTester(graph);var isValidArea=cat.isNodeConsistentArea();if(!isValidArea){this.validErr=new jsts.operation.valid.TopologyValidationError(jsts.operation.valid.TopologyValidationError.SELF_INTERSECTION,cat.getInvalidPoint());return;}
if(cat.hasDuplicateRings()){this.validErr=new jsts.operation.valid.TopologyValidationError(jsts.operation.valid.TopologyValidationError.DUPLICATE_RINGS,cat.getInvalidPoint());}};jsts.operation.valid.IsValidOp.prototype.checkNoSelfIntersectingRings=function(graph){for(var i=graph.getEdgeIterator();i.hasNext();){var e=i.next();this.checkNoSelfIntersectingRing(e.getEdgeIntersectionList());if(this.validErr!=null){return;}}};jsts.operation.valid.IsValidOp.prototype.checkNoSelfIntersectingRing=function(eiList){var nodeSet=[];var isFirst=true;for(var i=eiList.iterator();i.hasNext();){var ei=i.next();if(isFirst){isFirst=false;continue;}
if(nodeSet.indexOf(ei.coord)>=0){this.validErr=new jsts.operation.valid.TopologyValidationError(jsts.operation.valid.TopologyValidationError.RING_SELF_INTERSECTION,ei.coord);return;}else{nodeSet.push(ei.coord);}}};jsts.operation.valid.IsValidOp.prototype.checkHolesInShell=function(p,graph){var shell=p.getExteriorRing();var pir=new jsts.algorithm.MCPointInRing(shell);for(var i=0;i<p.getNumInteriorRing();i++){var hole=p.getInteriorRingN(i);var holePt=jsts.operation.valid.IsValidOp.findPtNotNode(hole.getCoordinates(),shell,graph);if(holePt==null){return;}
var outside=!pir.isInside(holePt);if(outside){this.validErr=new jsts.operation.valid.TopologyValidationError(jsts.operation.valid.TopologyValidationError.HOLE_OUTSIDE_SHELL,holePt);return;}}};jsts.operation.valid.IsValidOp.prototype.checkHolesNotNested=function(p,graph){var nestedTester=new jsts.operation.valid.IndexedNestedRingTester(graph);for(var i=0;i<p.getNumInteriorRing();i++){var innerHole=p.getInteriorRingN(i);nestedTester.add(innerHole);}
var isNonNested=nestedTester.isNonNested();if(!isNonNested){this.validErr=new jsts.operation.valid.TopologyValidationError(jsts.operation.valid.TopologyValidationError.NESTED_HOLES,nestedTester.getNestedPoint());}};jsts.operation.valid.IsValidOp.prototype.checkShellsNotNested=function(mp,graph){for(var i=0;i<mp.getNumGeometries();i++){var p=mp.getGeometryN(i);var shell=p.getExteriorRing();for(var j=0;j<mp.getNumGeometries();j++){if(i==j){continue;}
var p2=mp.getGeometryN(j);this.checkShellNotNested(shell,p2,graph);if(this.validErr!=null){return;}}}};jsts.operation.valid.IsValidOp.prototype.checkShellNotNested=function(shell,p,graph){var shellPts=shell.getCoordinates();var polyShell=p.getExteriorRing();var polyPts=polyShell.getCoordinates();var shellPt=jsts.operation.valid.IsValidOp.findPtNotNode(shellPts,polyShell,graph);if(shellPt==null){return;}
var insidePolyShell=jsts.algorithm.CGAlgorithms.isPointInRing(shellPt,polyPts);if(!insidePolyShell){return;}
if(p.getNumInteriorRing()<=0){this.validErr=new jsts.operation.valid.TopologyValidationError(jsts.operation.valid.TopologyValidationError.NESTED_SHELLS,shellPt);return;}
var badNestedPt=null;for(var i=0;i<p.getNumInteriorRing();i++){var hole=p.getInteriorRingN(i);badNestedPt=this.checkShellInsideHole(shell,hole,graph);if(badNestedPt==null){return;}}
this.validErr=new jsts.operation.valid.TopologyValidationError(jsts.operation.valid.TopologyValidationError.NESTED_SHELLS,badNestedPt);};jsts.operation.valid.IsValidOp.prototype.checkShellInsideHole=function(shell,hole,graph){var shellPts=shell.getCoordinates();var holePts=hole.getCoordinates();var shellPt=jsts.operation.valid.IsValidOp.findPtNotNode(shellPts,hole,graph);if(shellPt!=null){var insideHole=jsts.algorithm.CGAlgorithms.isPointInRing(shellPt,holePts);if(!insideHole){return shellPt;}}
var holePt=jsts.operation.valid.IsValidOp.findPtNotNode(holePts,shell,graph);if(holePt!=null){var insideShell=jsts.algorithm.CGAlgorithms.isPointInRing(holePt,shellPts);if(insideShell){return holePt;}
return null;}
jsts.util.Assert.shouldNeverReachHere('points in shell and hole appear to be equal');return null;};jsts.operation.valid.IsValidOp.prototype.checkConnectedInteriors=function(graph){var cit=new jsts.operation.valid.ConnectedInteriorTester(graph);if(!cit.isInteriorsConnected()){this.validErr=new jsts.operation.valid.TopologyValidationError(jsts.operation.valid.TopologyValidationError.DISCONNECTED_INTERIOR,cit.getCoordinate());}};jsts.algorithm.RobustDeterminant=function(){};jsts.algorithm.RobustDeterminant.signOfDet2x2=function(x1,y1,x2,y2){var sign,swap,k,count;count=0;sign=1;if((x1===0.0)||(y2===0.0)){if((y1===0.0)||(x2===0.0)){return 0;}
else if(y1>0){if(x2>0){return-sign;}
else{return sign;}}
else{if(x2>0){return sign;}
else{return-sign;}}}
if((y1===0.0)||(x2===0.0)){if(y2>0){if(x1>0){return sign;}
else{return-sign;}}
else{if(x1>0){return-sign;}
else{return sign;}}}
if(0.0<y1){if(0.0<y2){if(y1>y2){sign=-sign;swap=x1;x1=x2;x2=swap;swap=y1;y1=y2;y2=swap;}}
else{if(y1<=-y2){sign=-sign;x2=-x2;y2=-y2;}
else{swap=x1;x1=-x2;x2=swap;swap=y1;y1=-y2;y2=swap;}}}
else{if(0.0<y2){if(-y1<=y2){sign=-sign;x1=-x1;y1=-y1;}
else{swap=-x1;x1=x2;x2=swap;swap=-y1;y1=y2;y2=swap;}}
else{if(y1>=y2){x1=-x1;y1=-y1;x2=-x2;y2=-y2;}
else{sign=-sign;swap=-x1;x1=-x2;x2=swap;swap=-y1;y1=-y2;y2=swap;}}}
if(0.0<x1){if(0.0<x2){if(x1>x2){return sign;}}
else{return sign;}}
else{if(0.0<x2){return-sign;}
else{if(x1>=x2){sign=-sign;x1=-x1;x2=-x2;}
else{return-sign;}}}
while(true){count=count+1;k=Math.floor(x2/x1);x2=x2-k*x1;y2=y2-k*y1;if(y2<0.0){return-sign;}
if(y2>y1){return sign;}
if(x1>x2+x2){if(y1<y2+y2){return sign;}}
else{if(y1>y2+y2){return-sign;}
else{x2=x1-x2;y2=y1-y2;sign=-sign;}}
if(y2===0.0){if(x2===0.0){return 0;}
else{return-sign;}}
if(x2===0.0){return sign;}
k=Math.floor(x1/x2);x1=x1-k*x2;y1=y1-k*y2;if(y1<0.0){return sign;}
if(y1>y2){return-sign;}
if(x2>x1+x1){if(y2<y1+y1){return-sign;}}
else{if(y2>y1+y1){return sign;}
else{x1=x2-x1;y1=y2-y1;sign=-sign;}}
if(y1===0.0){if(x1===0.0){return 0;}
else{return sign;}}
if(x1===0.0){return-sign;}}};jsts.algorithm.RobustDeterminant.orientationIndex=function(p1,p2,q){var dx1=p2.x-p1.x;var dy1=p2.y-p1.y;var dx2=q.x-p2.x;var dy2=q.y-p2.y;return jsts.algorithm.RobustDeterminant.signOfDet2x2(dx1,dy1,dx2,dy2);};jsts.index.quadtree.NodeBase=function(){this.subnode=new Array(4);this.subnode[0]=null;this.subnode[1]=null;this.subnode[2]=null;this.subnode[3]=null;this.items=[];};jsts.index.quadtree.NodeBase.prototype.getSubnodeIndex=function(env,centre){var subnodeIndex=-1;if(env.getMinX()>=centre.x){if(env.getMinY()>=centre.y){subnodeIndex=3;}
if(env.getMaxY()<=centre.y){subnodeIndex=1;}}
if(env.getMaxX()<=centre.x){if(env.getMinY()>=centre.y){subnodeIndex=2;}
if(env.getMaxY()<=centre.y){subnodeIndex=0;}}
return subnodeIndex;};jsts.index.quadtree.NodeBase.prototype.getItems=function(){return this.items;};jsts.index.quadtree.NodeBase.prototype.hasItems=function(){return(this.items.length>0);};jsts.index.quadtree.NodeBase.prototype.add=function(item){this.items.push(item);};jsts.index.quadtree.NodeBase.prototype.remove=function(itemEnv,item){if(!this.isSearchMatch(itemEnv)){return false;}
var found=false,i=0;for(i;i<4;i++){if(this.subnode[i]!==null){found=this.subnode[i].remove(itemEnv,item);if(found){if(this.subnode[i].isPrunable()){this.subnode[i]=null;}
break;}}}
if(found){return found;}
if(this.items.indexOf(item)!==-1){for(var i=this.items.length-1;i>=0;i--){if(this.items[i]===item){this.items.splice(i,1);}}
found=true;}
return found;};jsts.index.quadtree.NodeBase.prototype.isPrunable=function(){return!(this.hasChildren()||this.hasItems());};jsts.index.quadtree.NodeBase.prototype.hasChildren=function(){var i=0;for(i;i<4;i++){if(this.subnode[i]!==null){return true;}}
return false;};jsts.index.quadtree.NodeBase.prototype.isEmpty=function(){var isEmpty=true;if(this.items.length>0){isEmpty=false;}
var i=0;for(i;i<4;i++){if(this.subnode[i]!==null){if(!this.subnode[i].isEmpty()){isEmpty=false;}}}
return isEmpty;};jsts.index.quadtree.NodeBase.prototype.addAllItems=function(resultItems){resultItems=resultItems.concat(this.items);var i=0;for(i;i<4;i++){if(this.subnode[i]!==null){resultItems=this.subnode[i].addAllItems(resultItems);}}
return resultItems;};jsts.index.quadtree.NodeBase.prototype.addAllItemsFromOverlapping=function(searchEnv,resultItems){if(!this.isSearchMatch(searchEnv)){return;}
resultItems=resultItems.concat(this.items);var i=0;for(i;i<4;i++){if(this.subnode[i]!==null){resultItems=this.subnode[i].addAllItemsFromOverlapping(searchEnv,resultItems);}}};jsts.index.quadtree.NodeBase.prototype.visit=function(searchEnv,visitor){if(!this.isSearchMatch(searchEnv)){return;}
this.visitItems(searchEnv,visitor);var i=0;for(i;i<4;i++){if(this.subnode[i]!==null){this.subnode[i].visit(searchEnv,visitor);}}};jsts.index.quadtree.NodeBase.prototype.visitItems=function(env,visitor){var i=0,il=this.items.length;for(i;i<il;i++){visitor.visitItem(this.items[i]);}};jsts.index.quadtree.NodeBase.prototype.depth=function(){var maxSubDepth=0,i=0,sqd;for(i;i<4;i++){if(this.subnode[i]!==null){sqd=this.subnode[i].depth();if(sqd>maxSubDepth){maxSubDepth=sqd;}}}
return maxSubDepth+1;};jsts.index.quadtree.NodeBase.prototype.size=function(){var subSize=0,i=0;for(i;i<4;i++){if(this.subnode[i]!==null){subSize+=this.subnode[i].size();}}
return subSize+this.items.length;};jsts.index.quadtree.NodeBase.prototype.getNodeCount=function(){var subSize=0,i=0;for(i;i<4;i++){if(this.subnode[i]!==null){subSize+=this.subnode[i].size();}}
return subSize+1;};jsts.index.quadtree.Node=function(env,level){jsts.index.quadtree.NodeBase.prototype.constructor.apply(this,arguments);this.env=env;this.level=level;this.centre=new jsts.geom.Coordinate();this.centre.x=(env.getMinX()+env.getMaxX())/2;this.centre.y=(env.getMinY()+env.getMaxY())/2;};jsts.index.quadtree.Node.prototype=new jsts.index.quadtree.NodeBase();jsts.index.quadtree.Node.createNode=function(env){var key,node;key=new jsts.index.quadtree.Key(env);node=new jsts.index.quadtree.Node(key.getEnvelope(),key.getLevel());return node;};jsts.index.quadtree.Node.createExpanded=function(node,addEnv){var expandEnv=new jsts.geom.Envelope(addEnv),largerNode;if(node!==null){expandEnv.expandToInclude(node.env);}
largerNode=jsts.index.quadtree.Node.createNode(expandEnv);if(node!==null){largerNode.insertNode(node);}
return largerNode;};jsts.index.quadtree.Node.prototype.getEnvelope=function(){return this.env;};jsts.index.quadtree.Node.prototype.isSearchMatch=function(searchEnv){return this.env.intersects(searchEnv);};jsts.index.quadtree.Node.prototype.getNode=function(searchEnv){var subnodeIndex=this.getSubnodeIndex(searchEnv,this.centre),node;if(subnodeIndex!==-1){node=this.getSubnode(subnodeIndex);return node.getNode(searchEnv);}else{return this;}};jsts.index.quadtree.Node.prototype.find=function(searchEnv){var subnodeIndex=this.getSubnodeIndex(searchEnv,this.centre),node;if(subnodeIndex===-1){return this;}
if(this.subnode[subnodeIndex]!==null){node=this.subnode[subnodeIndex];return node.find(searchEnv);}
return this;};jsts.index.quadtree.Node.prototype.insertNode=function(node){var index=this.getSubnodeIndex(node.env,this.centre),childNode;if(node.level===this.level-1){this.subnode[index]=node;}else{childNode=this.createSubnode(index);childNode.insertNode(node);this.subnode[index]=childNode;}};jsts.index.quadtree.Node.prototype.getSubnode=function(index){if(this.subnode[index]===null){this.subnode[index]=this.createSubnode(index);}
return this.subnode[index];};jsts.index.quadtree.Node.prototype.createSubnode=function(index){var minx=0.0,maxx=0.0,miny=0.0,maxy=0.0,sqEnv,node;switch(index){case 0:minx=this.env.getMinX();maxx=this.centre.x;miny=this.env.getMinY();maxy=this.centre.y;break;case 1:minx=this.centre.x;maxx=this.env.getMaxX();miny=this.env.getMinY();maxy=this.centre.y;break;case 2:minx=this.env.getMinX();maxx=this.centre.x;miny=this.centre.y;maxy=this.env.getMaxY();break;case 3:minx=this.centre.x;maxx=this.env.getMaxX();miny=this.centre.y;maxy=this.env.getMaxY();break;}
sqEnv=new jsts.geom.Envelope(minx,maxx,miny,maxy);node=new jsts.index.quadtree.Node(sqEnv,this.level-1);return node;};(function(){jsts.triangulate.quadedge.QuadEdge=function(){this.rot=null;this.vertex=null;this.next=null;this.data=null;};var QuadEdge=jsts.triangulate.quadedge.QuadEdge;jsts.triangulate.quadedge.QuadEdge.makeEdge=function(o,d){var q0,q1,q2,q3,base;q0=new QuadEdge();q1=new QuadEdge();q2=new QuadEdge();q3=new QuadEdge();q0.rot=q1;q1.rot=q2;q2.rot=q3;q3.rot=q0;q0.setNext(q0);q1.setNext(q3);q2.setNext(q2);q3.setNext(q1);base=q0;base.setOrig(o);base.setDest(d);return base;};jsts.triangulate.quadedge.QuadEdge.connect=function(a,b){var e=QuadEdge.makeEdge(a.dest(),b.orig());QuadEdge.splice(e,a.lNext());QuadEdge.splice(e.sym(),b);return e;};jsts.triangulate.quadedge.QuadEdge.splice=function(a,b){var alpha,beta,t1,t2,t3,t4;alpha=a.oNext().rot;beta=b.oNext().rot;t1=b.oNext();t2=a.oNext();t3=beta.oNext();t4=alpha.oNext();a.setNext(t1);b.setNext(t2);alpha.setNext(t3);beta.setNext(t4);};jsts.triangulate.quadedge.QuadEdge.swap=function(e){var a,b;a=e.oPrev();b=e.sym().oPrev();QuadEdge.splice(e,a);QuadEdge.splice(e.sym(),b);QuadEdge.splice(e,a.lNext());QuadEdge.splice(e.sym(),b.lNext());e.setOrig(a.dest());e.setDest(b.dest());};jsts.triangulate.quadedge.QuadEdge.prototype.getPrimary=function(){if(this.orig().getCoordinate().compareTo(this.dest().getCoordinate())<=0){return this;}
else{return this.sym();}};jsts.triangulate.quadedge.QuadEdge.prototype.setData=function(data){this.data=data;};jsts.triangulate.quadedge.QuadEdge.prototype.getData=function(){return this.data;};jsts.triangulate.quadedge.QuadEdge.prototype.delete_jsts=function(){this.rot=null;};jsts.triangulate.quadedge.QuadEdge.prototype.isLive=function(){return this.rot!==null;};jsts.triangulate.quadedge.QuadEdge.prototype.setNext=function(next){this.next=next;};jsts.triangulate.quadedge.QuadEdge.prototype.invRot=function(){return this.rot.sym();};jsts.triangulate.quadedge.QuadEdge.prototype.sym=function(){return this.rot.rot;};jsts.triangulate.quadedge.QuadEdge.prototype.oNext=function(){return this.next;};jsts.triangulate.quadedge.QuadEdge.prototype.oPrev=function(){return this.rot.next.rot;};jsts.triangulate.quadedge.QuadEdge.prototype.dNext=function(){return this.sym().oNext().sym();};jsts.triangulate.quadedge.QuadEdge.prototype.dPrev=function(){return this.invRot().oNext().invRot();};jsts.triangulate.quadedge.QuadEdge.prototype.lNext=function(){return this.invRot().oNext().rot;};jsts.triangulate.quadedge.QuadEdge.prototype.lPrev=function(){return this.next.sym();};jsts.triangulate.quadedge.QuadEdge.prototype.rNext=function(){return this.rot.next.invRot();};jsts.triangulate.quadedge.QuadEdge.prototype.rPrev=function(){return this.sym().oNext();};jsts.triangulate.quadedge.QuadEdge.prototype.setOrig=function(o){this.vertex=o;};jsts.triangulate.quadedge.QuadEdge.prototype.setDest=function(d){this.sym().setOrig(d);};jsts.triangulate.quadedge.QuadEdge.prototype.orig=function(){return this.vertex;};jsts.triangulate.quadedge.QuadEdge.prototype.dest=function(){return this.sym().orig();};jsts.triangulate.quadedge.QuadEdge.prototype.getLength=function(){return this.orig().getCoordinate().distance(dest().getCoordinate());};jsts.triangulate.quadedge.QuadEdge.prototype.equalsNonOriented=function(qe){if(this.equalsOriented(qe)){return true;}
if(this.equalsOriented(qe.sym())){return true;}
return false;};jsts.triangulate.quadedge.QuadEdge.prototype.equalsOriented=function(qe){if(this.orig().getCoordinate().equals2D(qe.orig().getCoordinate())&&this.dest().getCoordinate().equals2D(qe.dest().getCoordinate())){return true;}
return false;};jsts.triangulate.quadedge.QuadEdge.prototype.toLineSegment=function()
{return new jsts.geom.LineSegment(this.vertex.getCoordinate(),this.dest().getCoordinate());};jsts.triangulate.quadedge.QuadEdge.prototype.toString=function(){var p0,p1;p0=this.vertex.getCoordinate();p1=this.dest().getCoordinate();return jsts.io.WKTWriter.toLineString(p0,p1);};})();(function(){var Assert=jsts.util.Assert;jsts.geomgraph.EdgeEnd=function(edge,p0,p1,label){this.edge=edge;if(p0&&p1){this.init(p0,p1);}
if(label){this.label=label||null;}};jsts.geomgraph.EdgeEnd.prototype.edge=null;jsts.geomgraph.EdgeEnd.prototype.label=null;jsts.geomgraph.EdgeEnd.prototype.node=null;jsts.geomgraph.EdgeEnd.prototype.p0=null;jsts.geomgraph.EdgeEnd.prototype.p1=null;jsts.geomgraph.EdgeEnd.prototype.dx=null;jsts.geomgraph.EdgeEnd.prototype.dy=null;jsts.geomgraph.EdgeEnd.prototype.quadrant=null;jsts.geomgraph.EdgeEnd.prototype.init=function(p0,p1){this.p0=p0;this.p1=p1;this.dx=p1.x-p0.x;this.dy=p1.y-p0.y;this.quadrant=jsts.geomgraph.Quadrant.quadrant(this.dx,this.dy);Assert.isTrue(!(this.dx===0&&this.dy===0),'EdgeEnd with identical endpoints found');};jsts.geomgraph.EdgeEnd.prototype.getEdge=function(){return this.edge;};jsts.geomgraph.EdgeEnd.prototype.getLabel=function(){return this.label;};jsts.geomgraph.EdgeEnd.prototype.getCoordinate=function(){return this.p0;};jsts.geomgraph.EdgeEnd.prototype.getDirectedCoordinate=function(){return this.p1;};jsts.geomgraph.EdgeEnd.prototype.getQuadrant=function(){return this.quadrant;};jsts.geomgraph.EdgeEnd.prototype.getDx=function(){return this.dx;};jsts.geomgraph.EdgeEnd.prototype.getDy=function(){return this.dy;};jsts.geomgraph.EdgeEnd.prototype.setNode=function(node){this.node=node;};jsts.geomgraph.EdgeEnd.prototype.getNode=function(){return this.node;};jsts.geomgraph.EdgeEnd.prototype.compareTo=function(e){return this.compareDirection(e);};jsts.geomgraph.EdgeEnd.prototype.compareDirection=function(e){if(this.dx===e.dx&&this.dy===e.dy)
return 0;if(this.quadrant>e.quadrant)
return 1;if(this.quadrant<e.quadrant)
return-1;return jsts.algorithm.CGAlgorithms.computeOrientation(e.p0,e.p1,this.p1);};jsts.geomgraph.EdgeEnd.prototype.computeLabel=function(boundaryNodeRule){};})();jsts.operation.buffer.RightmostEdgeFinder=function(){};jsts.operation.buffer.RightmostEdgeFinder.prototype.minIndex=-1;jsts.operation.buffer.RightmostEdgeFinder.prototype.minCoord=null;jsts.operation.buffer.RightmostEdgeFinder.prototype.minDe=null;jsts.operation.buffer.RightmostEdgeFinder.prototype.orientedDe=null;jsts.operation.buffer.RightmostEdgeFinder.prototype.getEdge=function(){return this.orientedDe;};jsts.operation.buffer.RightmostEdgeFinder.prototype.getCoordinate=function(){return this.minCoord;};jsts.operation.buffer.RightmostEdgeFinder.prototype.findEdge=function(dirEdgeList){for(var i=dirEdgeList.iterator();i.hasNext();){var de=i.next();if(!de.isForward())
continue;this.checkForRightmostCoordinate(de);}
jsts.util.Assert.isTrue(this.minIndex!==0||this.minCoord.equals(this.minDe.getCoordinate()),'inconsistency in rightmost processing');if(this.minIndex===0){this.findRightmostEdgeAtNode();}else{this.findRightmostEdgeAtVertex();}
this.orientedDe=this.minDe;var rightmostSide=this.getRightmostSide(this.minDe,this.minIndex);if(rightmostSide==jsts.geomgraph.Position.LEFT){this.orientedDe=this.minDe.getSym();}};jsts.operation.buffer.RightmostEdgeFinder.prototype.findRightmostEdgeAtNode=function(){var node=this.minDe.getNode();var star=node.getEdges();this.minDe=star.getRightmostEdge();if(!this.minDe.isForward()){this.minDe=this.minDe.getSym();this.minIndex=this.minDe.getEdge().getCoordinates().length-1;}};jsts.operation.buffer.RightmostEdgeFinder.prototype.findRightmostEdgeAtVertex=function(){var pts=this.minDe.getEdge().getCoordinates();jsts.util.Assert.isTrue(this.minIndex>0&&this.minIndex<pts.length,'rightmost point expected to be interior vertex of edge');var pPrev=pts[this.minIndex-1];var pNext=pts[this.minIndex+1];var orientation=jsts.algorithm.CGAlgorithms.computeOrientation(this.minCoord,pNext,pPrev);var usePrev=false;if(pPrev.y<this.minCoord.y&&pNext.y<this.minCoord.y&&orientation===jsts.algorithm.CGAlgorithms.COUNTERCLOCKWISE){usePrev=true;}else if(pPrev.y>this.minCoord.y&&pNext.y>this.minCoord.y&&orientation===jsts.algorithm.CGAlgorithms.CLOCKWISE){usePrev=true;}
if(usePrev){this.minIndex=this.minIndex-1;}};jsts.operation.buffer.RightmostEdgeFinder.prototype.checkForRightmostCoordinate=function(de){var coord=de.getEdge().getCoordinates();for(var i=0;i<coord.length-1;i++){if(this.minCoord===null||coord[i].x>this.minCoord.x){this.minDe=de;this.minIndex=i;this.minCoord=coord[i];}}};jsts.operation.buffer.RightmostEdgeFinder.prototype.getRightmostSide=function(de,index){var side=this.getRightmostSideOfSegment(de,index);if(side<0)
side=this.getRightmostSideOfSegment(de,index-1);if(side<0){this.minCoord=null;this.checkForRightmostCoordinate(de);}
return side;};jsts.operation.buffer.RightmostEdgeFinder.prototype.getRightmostSideOfSegment=function(de,i){var e=de.getEdge();var coord=e.getCoordinates();if(i<0||i+1>=coord.length)
return-1;if(coord[i].y==coord[i+1].y)
return-1;var pos=jsts.geomgraph.Position.LEFT;if(coord[i].y<coord[i+1].y)
pos=jsts.geomgraph.Position.RIGHT;return pos;};(function(){jsts.triangulate.IncrementalDelaunayTriangulator=function(subdiv){this.subdiv=subdiv;this.isUsingTolerance=subdiv.getTolerance()>0.0;};jsts.triangulate.IncrementalDelaunayTriangulator.prototype.insertSites=function(vertices){var i=0,il=vertices.length,v;for(i;i<il;i++){v=vertices[i];this.insertSite(v);}};jsts.triangulate.IncrementalDelaunayTriangulator.prototype.insertSite=function(v){var e,base,startEdge,t;e=this.subdiv.locate(v);if(this.subdiv.isVertexOfEdge(e,v)){return e;}
else if(this.subdiv.isOnEdge(e,v.getCoordinate())){e=e.oPrev();this.subdiv.delete_jsts(e.oNext());}
base=this.subdiv.makeEdge(e.orig(),v);jsts.triangulate.quadedge.QuadEdge.splice(base,e);startEdge=base;do{base=this.subdiv.connect(e,base.sym());e=base.oPrev();}while(e.lNext()!=startEdge);do{t=e.oPrev();if(t.dest().rightOf(e)&&v.isInCircle(e.orig(),t.dest(),e.dest())){jsts.triangulate.quadedge.QuadEdge.swap(e);e=e.oPrev();}else if(e.oNext()==startEdge){return base;}else{e=e.oNext().lPrev();}}while(true);};}());jsts.algorithm.CentroidArea=function(){this.basePt=null;this.triangleCent3=new jsts.geom.Coordinate();this.centSum=new jsts.geom.Coordinate();this.cg3=new jsts.geom.Coordinate();};jsts.algorithm.CentroidArea.prototype.basePt=null;jsts.algorithm.CentroidArea.prototype.triangleCent3=null;jsts.algorithm.CentroidArea.prototype.areasum2=0;jsts.algorithm.CentroidArea.prototype.cg3=null;jsts.algorithm.CentroidArea.prototype.centSum=null;jsts.algorithm.CentroidArea.prototype.totalLength=0.0;jsts.algorithm.CentroidArea.prototype.add=function(geom){if(geom instanceof jsts.geom.Polygon){var poly=geom;this.setBasePoint(poly.getExteriorRing().getCoordinateN(0));this.add3(poly);}else if(geom instanceof jsts.geom.GeometryCollection||geom instanceof jsts.geom.MultiPolygon){var gc=geom;for(var i=0;i<gc.getNumGeometries();i++){this.add(gc.getGeometryN(i));}}else if(geom instanceof Array){this.add2(geom);}};jsts.algorithm.CentroidArea.prototype.add2=function(ring){this.setBasePoint(ring[0]);this.addShell(ring);};jsts.algorithm.CentroidArea.prototype.getCentroid=function(){var cent=new jsts.geom.Coordinate();if(Math.abs(this.areasum2)>0.0){cent.x=this.cg3.x/3/this.areasum2;cent.y=this.cg3.y/3/this.areasum2;}else{cent.x=this.centSum.x/this.totalLength;cent.y=this.centSum.y/this.totalLength;}
return cent;};jsts.algorithm.CentroidArea.prototype.setBasePoint=function(basePt){if(this.basePt==null)
this.basePt=basePt;};jsts.algorithm.CentroidArea.prototype.add3=function(poly){this.addShell(poly.getExteriorRing().getCoordinates());for(var i=0;i<poly.getNumInteriorRing();i++){this.addHole(poly.getInteriorRingN(i).getCoordinates());}};jsts.algorithm.CentroidArea.prototype.addShell=function(pts){var isPositiveArea=!jsts.algorithm.CGAlgorithms.isCCW(pts);for(var i=0;i<pts.length-1;i++){this.addTriangle(this.basePt,pts[i],pts[i+1],isPositiveArea);}
this.addLinearSegments(pts);};jsts.algorithm.CentroidArea.prototype.addHole=function(pts){var isPositiveArea=jsts.algorithm.CGAlgorithms.isCCW(pts);for(var i=0;i<pts.length-1;i++){this.addTriangle(this.basePt,pts[i],pts[i+1],isPositiveArea);}
this.addLinearSegments(pts);};jsts.algorithm.CentroidArea.prototype.addTriangle=function(p0,p1,p2,isPositiveArea){var sign=(isPositiveArea)?1.0:-1.0;jsts.algorithm.CentroidArea.centroid3(p0,p1,p2,this.triangleCent3);var area2=jsts.algorithm.CentroidArea.area2(p0,p1,p2);this.cg3.x+=sign*area2*this.triangleCent3.x;this.cg3.y+=sign*area2*this.triangleCent3.y;this.areasum2+=sign*area2;};jsts.algorithm.CentroidArea.centroid3=function(p1,p2,p3,c){c.x=p1.x+p2.x+p3.x;c.y=p1.y+p2.y+p3.y;return;};jsts.algorithm.CentroidArea.area2=function(p1,p2,p3){return(p2.x-p1.x)*(p3.y-p1.y)-(p3.x-p1.x)*(p2.y-p1.y);};jsts.algorithm.CentroidArea.prototype.addLinearSegments=function(pts){for(var i=0;i<pts.length-1;i++){var segmentLen=pts[i].distance(pts[i+1]);this.totalLength+=segmentLen;var midx=(pts[i].x+pts[i+1].x)/2;this.centSum.x+=segmentLen*midx;var midy=(pts[i].y+pts[i+1].y)/2;this.centSum.y+=segmentLen*midy;}};jsts.geomgraph.index.SweepLineSegment=function(edge,ptIndex){this.edge=edge;this.ptIndex=ptIndex;this.pts=edge.getCoordinates();};jsts.geomgraph.index.SweepLineSegment.prototype.edge=null;jsts.geomgraph.index.SweepLineSegment.prototype.pts=null;jsts.geomgraph.index.SweepLineSegment.prototype.ptIndex=null;jsts.geomgraph.index.SweepLineSegment.prototype.getMinX=function(){var x1=this.pts[this.ptIndex].x;var x2=this.pts[this.ptIndex+1].x;if(x1<x2){return x1;}
return x2;};jsts.geomgraph.index.SweepLineSegment.prototype.getMaxX=function(){var x1=this.pts[this.ptIndex].x;var x2=this.pts[this.ptIndex+1].x;if(x1>x2){return x1;}
return x2;};jsts.geomgraph.index.SweepLineSegment.prototype.computeIntersections=function(ss,si){si.addIntersections(this.edge,this.ptIndex,ss.edge,ss.ptIndex);};jsts.index.quadtree.Root=function(){jsts.index.quadtree.NodeBase.prototype.constructor.apply(this,arguments);this.origin=new jsts.geom.Coordinate(0.0,0.0);};jsts.index.quadtree.Root.prototype=new jsts.index.quadtree.NodeBase();jsts.index.quadtree.Root.prototype.insert=function(itemEnv,item){var index=this.getSubnodeIndex(itemEnv,this.origin);if(index===-1){this.add(item);return;}
var node=this.subnode[index];if(node===null||!node.getEnvelope().contains(itemEnv)){var largerNode=jsts.index.quadtree.Node.createExpanded(node,itemEnv);this.subnode[index]=largerNode;}
this.insertContained(this.subnode[index],itemEnv,item);};jsts.index.quadtree.Root.prototype.insertContained=function(tree,itemEnv,item){var isZeroX,isZeroY,node;isZeroX=jsts.index.IntervalSize.isZeroWidth(itemEnv.getMinX(),itemEnv.getMaxX());isZeroY=jsts.index.IntervalSize.isZeroWidth(itemEnv.getMinY(),itemEnv.getMaxY());if(isZeroX||isZeroY){node=tree.find(itemEnv);}else{node=tree.getNode(itemEnv);}
node.add(item);};jsts.index.quadtree.Root.prototype.isSearchMatch=function(searchEnv){return true;};jsts.geomgraph.index.MonotoneChainIndexer=function(){};jsts.geomgraph.index.MonotoneChainIndexer.toIntArray=function(list){var array=[];for(var i=list.iterator();i.hasNext();){var element=i.next();array.push(element);}
return array;};jsts.geomgraph.index.MonotoneChainIndexer.prototype.getChainStartIndices=function(pts){var start=0;var startIndexList=new javascript.util.ArrayList();startIndexList.add(start);do{var last=this.findChainEnd(pts,start);startIndexList.add(last);start=last;}while(start<pts.length-1);var startIndex=jsts.geomgraph.index.MonotoneChainIndexer.toIntArray(startIndexList);return startIndex;};jsts.geomgraph.index.MonotoneChainIndexer.prototype.findChainEnd=function(pts,start){var chainQuad=jsts.geomgraph.Quadrant.quadrant(pts[start],pts[start+1]);var last=start+1;while(last<pts.length){var quad=jsts.geomgraph.Quadrant.quadrant(pts[last-1],pts[last]);if(quad!=chainQuad){break;}
last++;}
return last-1;};jsts.noding.IntersectionAdder=function(li){this.li=li;};jsts.noding.IntersectionAdder.prototype=new jsts.noding.SegmentIntersector();jsts.noding.IntersectionAdder.constructor=jsts.noding.IntersectionAdder;jsts.noding.IntersectionAdder.isAdjacentSegments=function(i1,i2){return Math.abs(i1-i2)===1;};jsts.noding.IntersectionAdder.prototype._hasIntersection=false;jsts.noding.IntersectionAdder.prototype.hasProper=false;jsts.noding.IntersectionAdder.prototype.hasProperInterior=false;jsts.noding.IntersectionAdder.prototype.hasInterior=false;jsts.noding.IntersectionAdder.prototype.properIntersectionPoint=null;jsts.noding.IntersectionAdder.prototype.li=null;jsts.noding.IntersectionAdder.prototype.isSelfIntersection=null;jsts.noding.IntersectionAdder.prototype.numIntersections=0;jsts.noding.IntersectionAdder.prototype.numInteriorIntersections=0;jsts.noding.IntersectionAdder.prototype.numProperIntersections=0;jsts.noding.IntersectionAdder.prototype.numTests=0;jsts.noding.IntersectionAdder.prototype.getLineIntersector=function(){return this.li;};jsts.noding.IntersectionAdder.prototype.getProperIntersectionPoint=function(){return this.properIntersectionPoint;};jsts.noding.IntersectionAdder.prototype.hasIntersection=function(){return this._hasIntersection;};jsts.noding.IntersectionAdder.prototype.hasProperIntersection=function(){return this.hasProper;};jsts.noding.IntersectionAdder.prototype.hasProperInteriorIntersection=function(){return this.hasProperInterior;};jsts.noding.IntersectionAdder.prototype.hasInteriorIntersection=function(){return this.hasInterior;};jsts.noding.IntersectionAdder.prototype.isTrivialIntersection=function(e0,segIndex0,e1,segIndex1){if(e0==e1){if(this.li.getIntersectionNum()==1){if(jsts.noding.IntersectionAdder.isAdjacentSegments(segIndex0,segIndex1))
return true;if(e0.isClosed()){var maxSegIndex=e0.size()-1;if((segIndex0===0&&segIndex1===maxSegIndex)||(segIndex1===0&&segIndex0===maxSegIndex)){return true;}}}}
return false;};jsts.noding.IntersectionAdder.prototype.processIntersections=function(e0,segIndex0,e1,segIndex1){if(e0===e1&&segIndex0===segIndex1)
return;this.numTests++;var p00=e0.getCoordinates()[segIndex0];var p01=e0.getCoordinates()[segIndex0+1];var p10=e1.getCoordinates()[segIndex1];var p11=e1.getCoordinates()[segIndex1+1];this.li.computeIntersection(p00,p01,p10,p11);if(this.li.hasIntersection()){this.numIntersections++;if(this.li.isInteriorIntersection()){this.numInteriorIntersections++;this.hasInterior=true;}
if(!this.isTrivialIntersection(e0,segIndex0,e1,segIndex1)){this._hasIntersection=true;e0.addIntersections(this.li,segIndex0,0);e1.addIntersections(this.li,segIndex1,1);if(this.li.isProper()){this.numProperIntersections++;this.hasProper=true;this.hasProperInterior=true;}}}};jsts.noding.IntersectionAdder.prototype.isDone=function(){return false;};jsts.operation.union.CascadedPolygonUnion=function(polys){this.inputPolys=polys;};jsts.operation.union.CascadedPolygonUnion.union=function(polys){var op=new jsts.operation.union.CascadedPolygonUnion(polys);return op.union();};jsts.operation.union.CascadedPolygonUnion.prototype.inputPolys;jsts.operation.union.CascadedPolygonUnion.prototype.geomFactory=null;jsts.operation.union.CascadedPolygonUnion.prototype.STRTREE_NODE_CAPACITY=4;jsts.operation.union.CascadedPolygonUnion.prototype.union=function(){if(this.inputPolys.length===0){return null;}
this.geomFactory=this.inputPolys[0].getFactory();var index=new jsts.index.strtree.STRtree(this.STRTREE_NODE_CAPACITY);for(var i=0,l=this.inputPolys.length;i<l;i++){var item=this.inputPolys[i];index.insert(item.getEnvelopeInternal(),item);}
var itemTree=index.itemsTree();var unionAll=this.unionTree(itemTree);return unionAll;};jsts.operation.union.CascadedPolygonUnion.prototype.unionTree=function(geomTree){var geoms=this.reduceToGeometries(geomTree);var union=this.binaryUnion(geoms);return union;};jsts.operation.union.CascadedPolygonUnion.prototype.binaryUnion=function(geoms,start,end){start=start||0;end=end||geoms.length;if(end-start<=1){var g0=this.getGeometry(geoms,start);return this.unionSafe(g0,null);}
else if(end-start===2){return this.unionSafe(this.getGeometry(geoms,start),this.getGeometry(geoms,start+1));}
else{var mid=parseInt((end+start)/2);var g0=this.binaryUnion(geoms,start,mid);var g1=this.binaryUnion(geoms,mid,end);return this.unionSafe(g0,g1);}};jsts.operation.union.CascadedPolygonUnion.prototype.getGeometry=function(list,index){if(index>=list.length){return null;}
return list[index];};jsts.operation.union.CascadedPolygonUnion.prototype.reduceToGeometries=function(geomTree){var geoms=[];for(var i=0,l=geomTree.length;i<l;i++){var o=geomTree[i],geom=null;if(o instanceof Array){geom=this.unionTree(o);}
else if(o instanceof jsts.geom.Geometry){geom=o;}
geoms.push(geom);}
return geoms;};jsts.operation.union.CascadedPolygonUnion.prototype.unionSafe=function(g0,g1){if(g0===null&&g1===null){return null;}
if(g0===null){return g1.clone();}
if(g1===null){return g0.clone();}
return this.unionOptimized(g0,g1);};jsts.operation.union.CascadedPolygonUnion.prototype.unionOptimized=function(g0,g1){var g0Env=g0.getEnvelopeInternal(),g1Env=g1.getEnvelopeInternal();if(!g0Env.intersects(g1Env)){var combo=jsts.geom.util.GeometryCombiner.combine(g0,g1);return combo;}
if(g0.getNumGeometries<=1&&g1.getNumGeometries<=1){return this.unionActual(g0,g1);}
var commonEnv=g0Env.intersection(g1Env);return this.unionUsingEnvelopeIntersection(g0,g1,commonEnv);};jsts.operation.union.CascadedPolygonUnion.prototype.unionUsingEnvelopeIntersection=function(g0,g1,common){var disjointPolys=new javascript.util.ArrayList();var g0Int=this.extractByEnvelope(common,g0,disjointPolys);var g1Int=this.extractByEnvelope(common,g1,disjointPolys);var union=this.unionActual(g0Int,g1Int);disjointPolys.add(union);var overallUnion=jsts.geom.util.GeometryCombiner.combine(disjointPolys);return overallUnion;};jsts.operation.union.CascadedPolygonUnion.prototype.extractByEnvelope=function(env,geom,disjointGeoms){var intersectingGeoms=new javascript.util.ArrayList();for(var i=0;i<geom.getNumGeometries();i++){var elem=geom.getGeometryN(i);if(elem.getEnvelopeInternal().intersects(env)){intersectingGeoms.add(elem);}
else{disjointGeoms.add(elem);}}
return this.geomFactory.buildGeometry(intersectingGeoms);};jsts.operation.union.CascadedPolygonUnion.prototype.unionActual=function(g0,g1){return g0.union(g1);};(function(){jsts.geom.MultiPoint=function(points,factory){this.geometries=points||[];this.factory=factory;};jsts.geom.MultiPoint.prototype=new jsts.geom.GeometryCollection();jsts.geom.MultiPoint.constructor=jsts.geom.MultiPoint;jsts.geom.MultiPoint.prototype.getBoundary=function(){return this.getFactory().createGeometryCollection(null);};jsts.geom.MultiPoint.prototype.getGeometryN=function(n){return this.geometries[n];};jsts.geom.MultiPoint.prototype.equalsExact=function(other,tolerance){if(!this.isEquivalentClass(other)){return false;}
return jsts.geom.GeometryCollection.prototype.equalsExact.call(this,other,tolerance);};jsts.geom.MultiPoint.prototype.CLASS_NAME='jsts.geom.MultiPoint';})();jsts.operation.buffer.OffsetCurveBuilder=function(precisionModel,bufParams){this.precisionModel=precisionModel;this.bufParams=bufParams;};jsts.operation.buffer.OffsetCurveBuilder.prototype.distance=0.0;jsts.operation.buffer.OffsetCurveBuilder.prototype.precisionModel=null;jsts.operation.buffer.OffsetCurveBuilder.prototype.bufParams=null;jsts.operation.buffer.OffsetCurveBuilder.prototype.getBufferParameters=function(){return this.bufParams;};jsts.operation.buffer.OffsetCurveBuilder.prototype.getLineCurve=function(inputPts,distance){this.distance=distance;if(this.distance<0.0&&!this.bufParams.isSingleSided())
return null;if(this.distance==0.0)
return null;var posDistance=Math.abs(this.distance);var segGen=this.getSegGen(posDistance);if(inputPts.length<=1){this.computePointCurve(inputPts[0],segGen);}else{if(this.bufParams.isSingleSided()){var isRightSide=distance<0.0;this.computeSingleSidedBufferCurve(inputPts,isRightSide,segGen);}else
this.computeLineBufferCurve(inputPts,segGen);}
var lineCoord=segGen.getCoordinates();return lineCoord;};jsts.operation.buffer.OffsetCurveBuilder.prototype.getRingCurve=function(inputPts,side,distance){this.distance=distance;if(inputPts.length<=2)
return this.getLineCurve(inputPts,distance);if(this.distance==0.0){return jsts.operation.buffer.OffsetCurveBuilder.copyCoordinates(inputPts);}
var segGen=this.getSegGen(this.distance);this.computeRingBufferCurve(inputPts,side,segGen);return segGen.getCoordinates();};jsts.operation.buffer.OffsetCurveBuilder.prototype.getOffsetCurve=function(inputPts,distance){this.distance=distance;if(this.distance===0.0)
return null;var isRightSide=this.distance<0.0;var posDistance=Math.abs(this.distance);var segGen=this.getSegGen(posDistance);if(inputPts.length<=1){this.computePointCurve(inputPts[0],segGen);}else{this.computeOffsetCurve(inputPts,isRightSide,segGen);}
var curvePts=segGen.getCoordinates();if(isRightSide)
curvePts.reverse();return curvePts;};jsts.operation.buffer.OffsetCurveBuilder.copyCoordinates=function(pts){var copy=[];for(var i=0;i<pts.length;i++){copy.push(pts[i].clone());}
return copy;};jsts.operation.buffer.OffsetCurveBuilder.prototype.getSegGen=function(distance){return new jsts.operation.buffer.OffsetSegmentGenerator(this.precisionModel,this.bufParams,distance);};jsts.operation.buffer.OffsetCurveBuilder.SIMPLIFY_FACTOR=100.0;jsts.operation.buffer.OffsetCurveBuilder.simplifyTolerance=function(bufDistance){return bufDistance/jsts.operation.buffer.OffsetCurveBuilder.SIMPLIFY_FACTOR;};jsts.operation.buffer.OffsetCurveBuilder.prototype.computePointCurve=function(pt,segGen){switch(this.bufParams.getEndCapStyle()){case jsts.operation.buffer.BufferParameters.CAP_ROUND:segGen.createCircle(pt);break;case jsts.operation.buffer.BufferParameters.CAP_SQUARE:segGen.createSquare(pt);break;}};jsts.operation.buffer.OffsetCurveBuilder.prototype.computeLineBufferCurve=function(inputPts,segGen){var distTol=jsts.operation.buffer.OffsetCurveBuilder.simplifyTolerance(this.distance);var simp1=jsts.operation.buffer.BufferInputLineSimplifier.simplify(inputPts,distTol);var n1=simp1.length-1;segGen.initSideSegments(simp1[0],simp1[1],jsts.geomgraph.Position.LEFT);for(var i=2;i<=n1;i++){segGen.addNextSegment(simp1[i],true);}
segGen.addLastSegment();segGen.addLineEndCap(simp1[n1-1],simp1[n1]);var simp2=jsts.operation.buffer.BufferInputLineSimplifier.simplify(inputPts,-distTol);var n2=simp2.length-1;segGen.initSideSegments(simp2[n2],simp2[n2-1],jsts.geomgraph.Position.LEFT);for(var i=n2-2;i>=0;i--){segGen.addNextSegment(simp2[i],true);}
segGen.addLastSegment();segGen.addLineEndCap(simp2[1],simp2[0]);segGen.closeRing();};jsts.operation.buffer.OffsetCurveBuilder.prototype.computeSingleSidedBufferCurve=function(inputPts,isRightSide,segGen){var distTol=jsts.operation.buffer.OffsetCurveBuilder.simplifyTolerance(this.distance);if(isRightSide){segGen.addSegments(inputPts,true);var simp2=jsts.operation.buffer.BufferInputLineSimplifier.simplify(inputPts,-distTol);var n2=simp2.length-1;segGen.initSideSegments(simp2[n2],simp2[n2-1],jsts.geomgraph.Position.LEFT);segGen.addFirstSegment();for(var i=n2-2;i>=0;i--){segGen.addNextSegment(simp2[i],true);}}else{segGen.addSegments(inputPts,false);var simp1=jsts.operation.buffer.BufferInputLineSimplifier.simplify(inputPts,distTol);var n1=simp1.length-1;segGen.initSideSegments(simp1[0],simp1[1],jsts.geomgraph.Position.LEFT);segGen.addFirstSegment();for(var i=2;i<=n1;i++){segGen.addNextSegment(simp1[i],true);}}
segGen.addLastSegment();segGen.closeRing();};jsts.operation.buffer.OffsetCurveBuilder.prototype.computeOffsetCurve=function(inputPts,isRightSide,segGen){var distTol=jsts.operation.buffer.OffsetCurveBuilder.simplifyTolerance(this.distance);if(isRightSide){var simp2=jsts.operation.buffer.BufferInputLineSimplifier.simplify(inputPts,-distTol);var n2=simp2.length-1;segGen.initSideSegments(simp2[n2],simp2[n2-1],jsts.geomgraph.Position.LEFT);segGen.addFirstSegment();for(var i=n2-2;i>=0;i--){segGen.addNextSegment(simp2[i],true);}}else{var simp1=jsts.operation.buffer.BufferInputLineSimplifier.simplify(inputPts,distTol);var n1=simp1.length-1;segGen.initSideSegments(simp1[0],simp1[1],jsts.geomgraph.Position.LEFT);segGen.addFirstSegment();for(var i=2;i<=n1;i++){segGen.addNextSegment(simp1[i],true);}}
segGen.addLastSegment();};jsts.operation.buffer.OffsetCurveBuilder.prototype.computeRingBufferCurve=function(inputPts,side,segGen){var distTol=jsts.operation.buffer.OffsetCurveBuilder.simplifyTolerance(this.distance);if(side===jsts.geomgraph.Position.RIGHT)
distTol=-distTol;var simp=jsts.operation.buffer.BufferInputLineSimplifier.simplify(inputPts,distTol);var n=simp.length-1;segGen.initSideSegments(simp[n-1],simp[0],side);for(var i=1;i<=n;i++){var addStartPoint=i!==1;segGen.addNextSegment(simp[i],addStartPoint);}
segGen.closeRing();};(function(){var HotPixelSnapAction=function(hotPixel,parentEdge,vertexIndex){this.hotPixel=hotPixel;this.parentEdge=parentEdge;this.vertexIndex=vertexIndex;};HotPixelSnapAction.prototype=new jsts.index.chain.MonotoneChainSelectAction();HotPixelSnapAction.constructor=HotPixelSnapAction;HotPixelSnapAction.prototype.hotPixel=null;HotPixelSnapAction.prototype.parentEdge=null;HotPixelSnapAction.prototype.vertexIndex=null;HotPixelSnapAction.prototype._isNodeAdded=false;HotPixelSnapAction.prototype.isNodeAdded=function(){return this._isNodeAdded;};HotPixelSnapAction.prototype.select=function(mc,startIndex){var ss=mc.getContext();if(this.parentEdge!==null){if(ss===this.parentEdge&&startIndex===this.vertexIndex)
return;}
this._isNodeAdded=this.hotPixel.addSnappedNode(ss,startIndex);};jsts.noding.snapround.MCIndexPointSnapper=function(index){this.index=index;};jsts.noding.snapround.MCIndexPointSnapper.prototype.index=null;jsts.noding.snapround.MCIndexPointSnapper.prototype.snap=function(hotPixel,parentEdge,vertexIndex){if(arguments.length===1){this.snap2.apply(this,arguments);return;}
var pixelEnv=hotPixel.getSafeEnvelope();var hotPixelSnapAction=new HotPixelSnapAction(hotPixel,parentEdge,vertexIndex);this.index.query(pixelEnv,{visitItem:function(testChain){testChain.select(pixelEnv,hotPixelSnapAction);}});return hotPixelSnapAction.isNodeAdded();};jsts.noding.snapround.MCIndexPointSnapper.prototype.snap2=function(hotPixel){return this.snap(hotPixel,null,-1);};})();(function(){var NodeBase=function(){this.items=new javascript.util.ArrayList();this.subnode=[null,null];};NodeBase.getSubnodeIndex=function(interval,centre){var subnodeIndex=-1;if(interval.min>=centre){subnodeIndex=1;}
if(interval.max<=centre){subnodeIndex=0;}
return subnodeIndex;};NodeBase.prototype.getItems=function(){return this.items;};NodeBase.prototype.add=function(item){this.items.add(item);};NodeBase.prototype.addAllItems=function(items){items.addAll(this.items);var i=0,il=2;for(i;i<il;i++){if(this.subnode[i]!==null){this.subnode[i].addAllItems(items);}}
return items;};NodeBase.prototype.addAllItemsFromOverlapping=function(interval,resultItems){if(interval!==null&&!this.isSearchMatch(interval)){return;}
resultItems.addAll(this.items);if(this.subnode[0]!==null){this.subnode[0].addAllItemsFromOverlapping(interval,resultItems);}
if(this.subnode[1]!==null){this.subnode[1].addAllItemsFromOverlapping(interval,resultItems);}};NodeBase.prototype.remove=function(itemInterval,item){if(!this.isSearchMatch(itemInterval)){return false;}
var found=false,i=0,il=2;for(i;i<il;i++){if(this.subnode[i]!==null){found=this.subnode[i].remove(itemInterval,item);if(found){if(this.subnode[i].isPrunable()){this.subnode[i]=null;}
break;}}}
if(found){return found;}
found=this.items.remove(item);return found;};NodeBase.prototype.isPrunable=function(){return!(this.hasChildren()||this.hasItems());};NodeBase.prototype.hasChildren=function(){var i=0,il=2;for(i;i<il;i++){if(this.subnode[i]!==null){return true;}}
return false;};NodeBase.prototype.hasItems=function(){return!this.items.isEmpty();};NodeBase.prototype.depth=function(){var maxSubDepth=0,i=0,il=2,sqd;for(i;i<il;i++){if(this.subnode[i]!==null){sqd=this.subnode[i].depth();if(sqd>maxSubDepth){maxSubDepth=sqd;}}}
return maxSubDepth+1;};NodeBase.prototype.size=function(){var subSize=0,i=0,il=2;for(i;i<il;i++){if(this.subnode[i]!==null){subSize+=this.subnode[i].size();}}
return subSize+this.items.size();};NodeBase.prototype.nodeSize=function(){var subSize=0,i=0,il=2;for(i;i<il;i++){if(this.subnode[i]!==null){subSize+=this.subnode[i].nodeSize();}}
return subSize+1;};jsts.index.bintree.NodeBase=NodeBase;})();(function(){var NodeBase=jsts.index.bintree.NodeBase;var Key=jsts.index.bintree.Key;var Interval=jsts.index.bintree.Interval;var Node=function(interval,level){this.items=new javascript.util.ArrayList();this.subnode=[null,null];this.interval=interval;this.level=level;this.centre=(interval.getMin()+interval.getMax())/2;};Node.prototype=new NodeBase();Node.constructor=Node;Node.createNode=function(itemInterval){var key,node;key=new Key(itemInterval);node=new Node(key.getInterval(),key.getLevel());return node;};Node.createExpanded=function(node,addInterval){var expandInt,largerNode;expandInt=new Interval(addInterval);if(node!==null){expandInt.expandToInclude(node.interval);}
largerNode=Node.createNode(expandInt);if(node!==null){largerNode.insert(node);}
return largerNode;};Node.prototype.getInterval=function(){return this.interval;};Node.prototype.isSearchMatch=function(itemInterval){return itemInterval.overlaps(this.interval);};Node.prototype.getNode=function(searchInterval){var subnodeIndex=NodeBase.getSubnodeIndex(searchInterval,this.centre),node;if(subnodeIndex!=-1){node=this.getSubnode(subnodeIndex);return node.getNode(searchInterval);}else{return this;}};Node.prototype.find=function(searchInterval){var subnodeIndex=NodeBase.getSubnodeIndex(searchInterval,this.centre),node;if(subnodeIndex===-1){return this;}
if(this.subnode[subnodeIndex]!==null){node=this.subnode[subnodeIndex];return node.find(searchInterval);}
return this;};Node.prototype.insert=function(node){var index=NodeBase.getSubnodeIndex(node.interval,this.centre),childNode;if(node.level===this.level-1){this.subnode[index]=node;}else{childNode=this.createSubnode(index);childNode.insert(node);this.subnode[index]=childNode;}};Node.prototype.getSubnode=function(index){if(this.subnode[index]===null){this.subnode[index]=this.createSubnode(index);}
return this.subnode[index];};Node.prototype.createSubnode=function(index){var min,max,subInt,node;min=0.0;max=0.0;switch(index){case 0:min=this.interval.getMin();max=this.centre;break;case 1:min=this.centre;max=this.interval.getMax();break;}
subInt=new Interval(min,max);node=new Node(subInt,this.level-1);return node;};jsts.index.bintree.Node=Node;})();(function(){var Node=jsts.index.bintree.Node;var NodeBase=jsts.index.bintree.NodeBase;var Root=function(){this.subnode=[null,null];this.items=new javascript.util.ArrayList();};Root.prototype=new jsts.index.bintree.NodeBase();Root.constructor=Root;Root.origin=0.0;Root.prototype.insert=function(itemInterval,item){var index=NodeBase.getSubnodeIndex(itemInterval,Root.origin),node,largerNode;if(index===-1){this.add(item);return;}
node=this.subnode[index];if(node===null||!node.getInterval().contains(itemInterval)){largerNode=Node.createExpanded(node,itemInterval);this.subnode[index]=largerNode;}
this.insertContained(this.subnode[index],itemInterval,item);};Root.prototype.insertContained=function(tree,itemInterval,item){var isZeroArea,node;isZeroArea=jsts.index.IntervalSize.isZeroWidth(itemInterval.getMin(),itemInterval.getMax());node=isZeroArea?tree.find(itemInterval):tree.getNode(itemInterval);node.add(item);};Root.prototype.isSearchMatch=function(interval){return true;};jsts.index.bintree.Root=Root;})();jsts.geomgraph.Quadrant=function(){};jsts.geomgraph.Quadrant.NE=0;jsts.geomgraph.Quadrant.NW=1;jsts.geomgraph.Quadrant.SW=2;jsts.geomgraph.Quadrant.SE=3;jsts.geomgraph.Quadrant.quadrant=function(dx,dy){if(dx instanceof jsts.geom.Coordinate){return jsts.geomgraph.Quadrant.quadrant2.apply(this,arguments);}
if(dx===0.0&&dy===0.0)
throw new jsts.error.IllegalArgumentError('Cannot compute the quadrant for point ( '+dx+', '+dy+' )');if(dx>=0.0){if(dy>=0.0)
return jsts.geomgraph.Quadrant.NE;else
return jsts.geomgraph.Quadrant.SE;}else{if(dy>=0.0)
return jsts.geomgraph.Quadrant.NW;else
return jsts.geomgraph.Quadrant.SW;}};jsts.geomgraph.Quadrant.quadrant2=function(p0,p1){if(p1.x===p0.x&&p1.y===p0.y)
throw new jsts.error.IllegalArgumentError('Cannot compute the quadrant for two identical points '+p0);if(p1.x>=p0.x){if(p1.y>=p0.y)
return jsts.geomgraph.Quadrant.NE;else
return jsts.geomgraph.Quadrant.SE;}else{if(p1.y>=p0.y)
return jsts.geomgraph.Quadrant.NW;else
return jsts.geomgraph.Quadrant.SW;}};jsts.geomgraph.Quadrant.isOpposite=function(quad1,quad2){if(quad1===quad2)
return false;var diff=(quad1-quad2+4)%4;if(diff===2)
return true;return false;};jsts.geomgraph.Quadrant.commonHalfPlane=function(quad1,quad2){if(quad1===quad2)
return quad1;var diff=(quad1-quad2+4)%4;if(diff===2)
return-1;var min=(quad1<quad2)?quad1:quad2;var max=(quad1>quad2)?quad1:quad2;if(min===0&&max===3)
return 3;return min;};jsts.geomgraph.Quadrant.isInHalfPlane=function(quad,halfPlane){if(halfPlane===jsts.geomgraph.Quadrant.SE){return quad===jsts.geomgraph.Quadrant.SE||quad===jsts.geomgraph.Quadrant.SW;}
return quad===halfPlane||quad===halfPlane+1;};jsts.geomgraph.Quadrant.isNorthern=function(quad){return quad===jsts.geomgraph.Quadrant.NE||quad===jsts.geomgraph.Quadrant.NW;};jsts.operation.valid.ConsistentAreaTester=function(geomGraph){this.geomGraph=geomGraph;this.li=new jsts.algorithm.RobustLineIntersector();this.nodeGraph=new jsts.operation.relate.RelateNodeGraph();this.invalidPoint=null;};jsts.operation.valid.ConsistentAreaTester.prototype.getInvalidPoint=function(){return this.invalidPoint;};jsts.operation.valid.ConsistentAreaTester.prototype.isNodeConsistentArea=function(){var intersector=this.geomGraph.computeSelfNodes(this.li,true);if(intersector.hasProperIntersection()){this.invalidPoint=intersector.getProperIntersectionPoint();return false;}
this.nodeGraph.build(this.geomGraph);return this.isNodeEdgeAreaLabelsConsistent();};jsts.operation.valid.ConsistentAreaTester.prototype.isNodeEdgeAreaLabelsConsistent=function(){for(var nodeIt=this.nodeGraph.getNodeIterator();nodeIt.hasNext();){var node=nodeIt.next();if(!node.getEdges().isAreaLabelsConsistent(this.geomGraph)){this.invalidPoint=node.getCoordinate().clone();return false;}}
return true;};jsts.operation.valid.ConsistentAreaTester.prototype.hasDuplicateRings=function(){for(var nodeIt=this.nodeGraph.getNodeIterator();nodeIt.hasNext();){var node=nodeIt.next();for(var i=node.getEdges().iterator();i.hasNext();){var eeb=i.next();if(eeb.getEdgeEnds().length>1){invalidPoint=eeb.getEdge().getCoordinate(0);return true;}}}
return false;};jsts.operation.relate.RelateNode=function(coord,edges){jsts.geomgraph.Node.apply(this,arguments);};jsts.operation.relate.RelateNode.prototype=new jsts.geomgraph.Node();jsts.operation.relate.RelateNode.prototype.computeIM=function(im){im.setAtLeastIfValid(this.label.getLocation(0),this.label.getLocation(1),0);};jsts.operation.relate.RelateNode.prototype.updateIMFromEdges=function(im){this.edges.updateIM(im);};(function(){var Location=jsts.geom.Location;var Position=jsts.geomgraph.Position;var EdgeEnd=jsts.geomgraph.EdgeEnd;jsts.geomgraph.DirectedEdge=function(edge,isForward){EdgeEnd.call(this,edge);this.depth=[0,-999,-999];this._isForward=isForward;if(isForward){this.init(edge.getCoordinate(0),edge.getCoordinate(1));}else{var n=edge.getNumPoints()-1;this.init(edge.getCoordinate(n),edge.getCoordinate(n-1));}
this.computeDirectedLabel();};jsts.geomgraph.DirectedEdge.prototype=new EdgeEnd();jsts.geomgraph.DirectedEdge.constructor=jsts.geomgraph.DirectedEdge;jsts.geomgraph.DirectedEdge.depthFactor=function(currLocation,nextLocation){if(currLocation===Location.EXTERIOR&&nextLocation===Location.INTERIOR)
return 1;else if(currLocation===Location.INTERIOR&&nextLocation===Location.EXTERIOR)
return-1;return 0;};jsts.geomgraph.DirectedEdge.prototype._isForward=null;jsts.geomgraph.DirectedEdge.prototype._isInResult=false;jsts.geomgraph.DirectedEdge.prototype._isVisited=false;jsts.geomgraph.DirectedEdge.prototype.sym=null;jsts.geomgraph.DirectedEdge.prototype.next=null;jsts.geomgraph.DirectedEdge.prototype.nextMin=null;jsts.geomgraph.DirectedEdge.prototype.edgeRing=null;jsts.geomgraph.DirectedEdge.prototype.minEdgeRing=null;jsts.geomgraph.DirectedEdge.prototype.depth=null;jsts.geomgraph.DirectedEdge.prototype.getEdge=function(){return this.edge;};jsts.geomgraph.DirectedEdge.prototype.setInResult=function(isInResult){this._isInResult=isInResult;};jsts.geomgraph.DirectedEdge.prototype.isInResult=function(){return this._isInResult;};jsts.geomgraph.DirectedEdge.prototype.isVisited=function(){return this._isVisited;};jsts.geomgraph.DirectedEdge.prototype.setVisited=function(isVisited){this._isVisited=isVisited;};jsts.geomgraph.DirectedEdge.prototype.setEdgeRing=function(edgeRing){this.edgeRing=edgeRing;};jsts.geomgraph.DirectedEdge.prototype.getEdgeRing=function(){return this.edgeRing;};jsts.geomgraph.DirectedEdge.prototype.setMinEdgeRing=function(minEdgeRing){this.minEdgeRing=minEdgeRing;};jsts.geomgraph.DirectedEdge.prototype.getMinEdgeRing=function(){return this.minEdgeRing;};jsts.geomgraph.DirectedEdge.prototype.getDepth=function(position){return this.depth[position];};jsts.geomgraph.DirectedEdge.prototype.setDepth=function(position,depthVal){if(this.depth[position]!==-999){if(this.depth[position]!==depthVal)
throw new jsts.error.TopologyError('assigned depths do not match',this.getCoordinate());}
this.depth[position]=depthVal;};jsts.geomgraph.DirectedEdge.prototype.getDepthDelta=function(){var depthDelta=this.edge.getDepthDelta();if(!this._isForward)
depthDelta=-depthDelta;return depthDelta;};jsts.geomgraph.DirectedEdge.prototype.setVisitedEdge=function(isVisited){this.setVisited(isVisited);this.sym.setVisited(isVisited);};jsts.geomgraph.DirectedEdge.prototype.getSym=function(){return this.sym;};jsts.geomgraph.DirectedEdge.prototype.isForward=function(){return this._isForward;};jsts.geomgraph.DirectedEdge.prototype.setSym=function(de){this.sym=de;};jsts.geomgraph.DirectedEdge.prototype.getNext=function(){return this.next;};jsts.geomgraph.DirectedEdge.prototype.setNext=function(next){this.next=next;};jsts.geomgraph.DirectedEdge.prototype.getNextMin=function(){return this.nextMin;};jsts.geomgraph.DirectedEdge.prototype.setNextMin=function(nextMin){this.nextMin=nextMin;};jsts.geomgraph.DirectedEdge.prototype.isLineEdge=function(){var isLine=this.label.isLine(0)||this.label.isLine(1);var isExteriorIfArea0=!this.label.isArea(0)||this.label.allPositionsEqual(0,Location.EXTERIOR);var isExteriorIfArea1=!this.label.isArea(1)||this.label.allPositionsEqual(1,Location.EXTERIOR);return isLine&&isExteriorIfArea0&&isExteriorIfArea1;};jsts.geomgraph.DirectedEdge.prototype.isInteriorAreaEdge=function(){var isInteriorAreaEdge=true;for(var i=0;i<2;i++){if(!(this.label.isArea(i)&&this.label.getLocation(i,Position.LEFT)===Location.INTERIOR&&this.label.getLocation(i,Position.RIGHT)===Location.INTERIOR)){isInteriorAreaEdge=false;}}
return isInteriorAreaEdge;};jsts.geomgraph.DirectedEdge.prototype.computeDirectedLabel=function(){this.label=new jsts.geomgraph.Label(this.edge.getLabel());if(!this._isForward)
this.label.flip();};jsts.geomgraph.DirectedEdge.prototype.setEdgeDepths=function(position,depth){var depthDelta=this.getEdge().getDepthDelta();if(!this._isForward)
depthDelta=-depthDelta;var directionFactor=1;if(position===Position.LEFT)
directionFactor=-1;var oppositePos=Position.opposite(position);var delta=depthDelta*directionFactor;var oppositeDepth=depth+delta;this.setDepth(position,depth);this.setDepth(oppositePos,oppositeDepth);};})();jsts.operation.distance.DistanceOp=function(g0,g1,terminateDistance){this.ptLocator=new jsts.algorithm.PointLocator();this.geom=[];this.geom[0]=g0;this.geom[1]=g1;this.terminateDistance=terminateDistance;};jsts.operation.distance.DistanceOp.prototype.geom=null;jsts.operation.distance.DistanceOp.prototype.terminateDistance=0.0;jsts.operation.distance.DistanceOp.prototype.ptLocator=null;jsts.operation.distance.DistanceOp.prototype.minDistanceLocation=null;jsts.operation.distance.DistanceOp.prototype.minDistance=Number.MAX_VALUE;jsts.operation.distance.DistanceOp.distance=function(g0,g1){var distOp=new jsts.operation.distance.DistanceOp(g0,g1,0.0);return distOp.distance();};jsts.operation.distance.DistanceOp.isWithinDistance=function(g0,g1,distance){var distOp=new jsts.operation.distance.DistanceOp(g0,g1,distance);return distOp.distance()<=distance;};jsts.operation.distance.DistanceOp.nearestPoints=function(g0,g1){var distOp=new jsts.operation.distance.DistanceOp(g0,g1,0.0);return distOp.nearestPoints();};jsts.operation.distance.DistanceOp.prototype.distance=function(){if(this.geom[0]===null||this.geom[1]===null)
throw new jsts.error.IllegalArgumentError('null geometries are not supported');if(this.geom[0].isEmpty()||this.geom[1].isEmpty())
return 0.0;this.computeMinDistance();return this.minDistance;};jsts.operation.distance.DistanceOp.prototype.nearestPoints=function(){this.computeMinDistance();var nearestPts=[this.minDistanceLocation[0].getCoordinate(),this.minDistanceLocation[1].getCoordinate()];return nearestPts;};jsts.operation.distance.DistanceOp.prototype.nearestLocations=function(){this.computeMinDistance();return this.minDistanceLocation;};jsts.operation.distance.DistanceOp.prototype.updateMinDistance=function(locGeom,flip){if(locGeom[0]===null)
return;if(flip){this.minDistanceLocation[0]=locGeom[1];this.minDistanceLocation[1]=locGeom[0];}else{this.minDistanceLocation[0]=locGeom[0];this.minDistanceLocation[1]=locGeom[1];}};jsts.operation.distance.DistanceOp.prototype.computeMinDistance=function(){if(arguments.length>0){this.computeMinDistance2.apply(this,arguments);return;}
if(this.minDistanceLocation!==null)
return;this.minDistanceLocation=[];this.computeContainmentDistance();if(this.minDistance<=this.terminateDistance)
return;this.computeFacetDistance();};jsts.operation.distance.DistanceOp.prototype.computeContainmentDistance=function(){if(arguments.length===2){this.computeContainmentDistance2.apply(this,arguments);return;}else if(arguments.length===3&&(!arguments[0]instanceof jsts.operation.distance.GeometryLocation)){this.computeContainmentDistance3.apply(this,arguments);return;}else if(arguments.length===3){this.computeContainmentDistance4.apply(this,arguments);return;}
var locPtPoly=[];this.computeContainmentDistance2(0,locPtPoly);if(this.minDistance<=this.terminateDistance)
return;this.computeContainmentDistance2(1,locPtPoly);};jsts.operation.distance.DistanceOp.prototype.computeContainmentDistance2=function(polyGeomIndex,locPtPoly){var locationsIndex=1-polyGeomIndex;var polys=jsts.geom.util.PolygonExtracter.getPolygons(this.geom[polyGeomIndex]);if(polys.length>0){var insideLocs=jsts.operation.distance.ConnectedElementLocationFilter.getLocations(this.geom[locationsIndex]);this.computeContainmentDistance3(insideLocs,polys,locPtPoly);if(this.minDistance<=this.terminateDistance){this.minDistanceLocation[locationsIndex]=locPtPoly[0];this.minDistanceLocation[polyGeomIndex]=locPtPoly[1];return;}}};jsts.operation.distance.DistanceOp.prototype.computeContainmentDistance3=function(locs,polys,locPtPoly){for(var i=0;i<locs.length;i++){var loc=locs[i];for(var j=0;j<polys.length;j++){this.computeContainmentDistance4(loc,polys[j],locPtPoly);if(this.minDistance<=this.terminateDistance)
return;}}};jsts.operation.distance.DistanceOp.prototype.computeContainmentDistance4=function(ptLoc,poly,locPtPoly){var pt=ptLoc.getCoordinate();if(jsts.geom.Location.EXTERIOR!==this.ptLocator.locate(pt,poly)){this.minDistance=0.0;locPtPoly[0]=ptLoc;locPtPoly[1]=new jsts.operation.distance.GeometryLocation(poly,pt);return;}};jsts.operation.distance.DistanceOp.prototype.computeFacetDistance=function(){var locGeom=[];var lines0=jsts.geom.util.LinearComponentExtracter.getLines(this.geom[0]);var lines1=jsts.geom.util.LinearComponentExtracter.getLines(this.geom[1]);var pts0=jsts.geom.util.PointExtracter.getPoints(this.geom[0]);var pts1=jsts.geom.util.PointExtracter.getPoints(this.geom[1]);this.computeMinDistanceLines(lines0,lines1,locGeom);this.updateMinDistance(locGeom,false);if(this.minDistance<=this.terminateDistance)
return;locGeom[0]=null;locGeom[1]=null;this.computeMinDistanceLinesPoints(lines0,pts1,locGeom);this.updateMinDistance(locGeom,false);if(this.minDistance<=this.terminateDistance)
return;locGeom[0]=null;locGeom[1]=null;this.computeMinDistanceLinesPoints(lines1,pts0,locGeom);this.updateMinDistance(locGeom,true);if(this.minDistance<=this.terminateDistance)
return;locGeom[0]=null;locGeom[1]=null;this.computeMinDistancePoints(pts0,pts1,locGeom);this.updateMinDistance(locGeom,false);};jsts.operation.distance.DistanceOp.prototype.computeMinDistanceLines=function(lines0,lines1,locGeom){for(var i=0;i<lines0.length;i++){var line0=lines0[i];for(var j=0;j<lines1.length;j++){var line1=lines1[j];this.computeMinDistance(line0,line1,locGeom);if(this.minDistance<=this.terminateDistance)
return;}}};jsts.operation.distance.DistanceOp.prototype.computeMinDistancePoints=function(points0,points1,locGeom){for(var i=0;i<points0.length;i++){var pt0=points0[i];for(var j=0;j<points1.length;j++){var pt1=points1[j];var dist=pt0.getCoordinate().distance(pt1.getCoordinate());if(dist<this.minDistance){this.minDistance=dist;locGeom[0]=new jsts.operation.distance.GeometryLocation(pt0,0,pt0.getCoordinate());locGeom[1]=new jsts.operation.distance.GeometryLocation(pt1,0,pt1.getCoordinate());}
if(this.minDistance<=this.terminateDistance)
return;}}};jsts.operation.distance.DistanceOp.prototype.computeMinDistanceLinesPoints=function(lines,points,locGeom){for(var i=0;i<lines.length;i++){var line=lines[i];for(var j=0;j<points.length;j++){var pt=points[j];this.computeMinDistance(line,pt,locGeom);if(this.minDistance<=this.terminateDistance)
return;}}};jsts.operation.distance.DistanceOp.prototype.computeMinDistance2=function(line0,line1,locGeom){if(line1 instanceof jsts.geom.Point){this.computeMinDistance3(line0,line1,locGeom);return;}
if(line0.getEnvelopeInternal().distance(line1.getEnvelopeInternal())>this.minDistance){return;}
var coord0=line0.getCoordinates();var coord1=line1.getCoordinates();for(var i=0;i<coord0.length-1;i++){for(var j=0;j<coord1.length-1;j++){var dist=jsts.algorithm.CGAlgorithms.distanceLineLine(coord0[i],coord0[i+1],coord1[j],coord1[j+1]);if(dist<this.minDistance){this.minDistance=dist;var seg0=new jsts.geom.LineSegment(coord0[i],coord0[i+1]);var seg1=new jsts.geom.LineSegment(coord1[j],coord1[j+1]);var closestPt=seg0.closestPoints(seg1);locGeom[0]=new jsts.operation.distance.GeometryLocation(line0,i,closestPt[0]);locGeom[1]=new jsts.operation.distance.GeometryLocation(line1,j,closestPt[1]);}
if(this.minDistance<=this.terminateDistance){return;}}}};jsts.operation.distance.DistanceOp.prototype.computeMinDistance3=function(line,pt,locGeom){if(line.getEnvelopeInternal().distance(pt.getEnvelopeInternal())>this.minDistance){return;}
var coord0=line.getCoordinates();var coord=pt.getCoordinate();for(var i=0;i<coord0.length-1;i++){var dist=jsts.algorithm.CGAlgorithms.distancePointLine(coord,coord0[i],coord0[i+1]);if(dist<this.minDistance){this.minDistance=dist;var seg=new jsts.geom.LineSegment(coord0[i],coord0[i+1]);var segClosestPoint=seg.closestPoint(coord);locGeom[0]=new jsts.operation.distance.GeometryLocation(line,i,segClosestPoint);locGeom[1]=new jsts.operation.distance.GeometryLocation(pt,0,coord);}
if(this.minDistance<=this.terminateDistance){return;}}};jsts.index.strtree.SIRtree=function(nodeCapacity){nodeCapacity=nodeCapacity||10;jsts.index.strtree.AbstractSTRtree.call(this,nodeCapacity);};jsts.index.strtree.SIRtree.prototype=new jsts.index.strtree.AbstractSTRtree();jsts.index.strtree.SIRtree.constructor=jsts.index.strtree.SIRtree;jsts.index.strtree.SIRtree.prototype.comperator={compare:function(o1,o2){return o1.getBounds().getCentre()-o2.getBounds().getCentre();}};jsts.index.strtree.SIRtree.prototype.intersectionOp={intersects:function(aBounds,bBounds){return aBounds.intersects(bBounds);}};jsts.index.strtree.SIRtree.prototype.createNode=function(level){var AbstractNode=function(level){jsts.index.strtree.AbstractNode.apply(this,arguments);};AbstractNode.prototype=new jsts.index.strtree.AbstractNode();AbstractNode.constructor=AbstractNode;AbstractNode.prototype.computeBounds=function(){var bounds=null,childBoundables=this.getChildBoundables(),childBoundable;for(var i=0,l=childBoundables.length;i<l;i++){childBoundable=childBoundables[i];if(bounds===null){bounds=new jsts.index.strtree.Interval(childBoundable.getBounds());}
else{bounds.expandToInclude(childBoundable.getBounds());}}
return bounds;};return AbstractNode;};jsts.index.strtree.SIRtree.prototype.insert=function(x1,x2,item){jsts.index.strtree.AbstractSTRtree.prototype.insert(new jsts.index.strtree.Interval(Math.min(x1,x2),Math.max(x1,x2)),item);};jsts.index.strtree.SIRtree.prototype.query=function(x1,x2){x2=x2||x1;jsts.index.strtree.AbstractSTRtree.prototype.query(new jsts.index.strtree.Interval(Math.min(x1,x2),Math.max(x1,x2)));};jsts.index.strtree.SIRtree.prototype.getIntersectsOp=function(){return this.intersectionOp;};jsts.index.strtree.SIRtree.prototype.getComparator=function(){return this.comperator;};jsts.simplify.DouglasPeuckerSimplifier=function(inputGeom){this.inputGeom=inputGeom;this.isEnsureValidTopology=true;};jsts.simplify.DouglasPeuckerSimplifier.prototype.inputGeom=null;jsts.simplify.DouglasPeuckerSimplifier.prototype.distanceTolerance=null;jsts.simplify.DouglasPeuckerSimplifier.prototype.isEnsureValidTopology=null;jsts.simplify.DouglasPeuckerSimplifier.simplify=function(geom,distanceTolerance){var tss=new jsts.simplify.DouglasPeuckerSimplifier(geom);tss.setDistanceTolerance(distanceTolerance);return tss.getResultGeometry();};jsts.simplify.DouglasPeuckerSimplifier.prototype.setDistanceTolerance=function(distanceTolerance){if(distanceTolerance<0.0){throw"Tolerance must be non-negative";}
this.distanceTolerance=distanceTolerance;};jsts.simplify.DouglasPeuckerSimplifier.prototype.setEnsureValid=function(isEnsureValidTopology){this.isEnsureValidTopology=isEnsureValidTopology;};jsts.simplify.DouglasPeuckerSimplifier.prototype.getResultGeometry=function(){if(this.inputGeom.isEmpty()){return this.inputGeom.clone();}
return(new jsts.simplify.DPTransformer(this.distanceTolerance,this.isEnsureValidTopology)).transform(this.inputGeom);};(function(){jsts.operation.predicate.RectangleContains=function(rectangle){this.rectEnv=rectangle.getEnvelopeInternal();}
jsts.operation.predicate.RectangleContains.contains=function(rectangle,b){var rc=new jsts.operation.predicate.RectangleContains(rectangle);return rc.contains(b);}
jsts.operation.predicate.RectangleContains.prototype.rectEnv=null;jsts.operation.predicate.RectangleContains.prototype.contains=function(geom){if(!this.rectEnv.contains(geom.getEnvelopeInternal()))
return false;if(this.isContainedInBoundary(geom))
return false;return true;}
jsts.operation.predicate.RectangleContains.prototype.isContainedInBoundary=function(geom){if(geom instanceof jsts.geom.Polygon)return false;if(geom instanceof jsts.geom.Point)return this.isPointContainedInBoundary(geom.getCoordinate());if(geom instanceof jsts.geom.LineString)return this.isLineStringContainedInBoundary(geom);for(var i=0;i<geom.getNumGeometries();i++){var comp=geom.getGeometryN(i);if(!this.isContainedInBoundary(comp))
return false;}
return true;}
jsts.operation.predicate.RectangleContains.prototype.isPointContainedInBoundary=function(pt){return pt.x==this.rectEnv.getMinX()||pt.x==this.rectEnv.getMaxX()||pt.y==this.rectEnv.getMinY()||pt.y==this.rectEnv.getMaxY();}
jsts.operation.predicate.RectangleContains.prototype.isLineStringContainedInBoundary=function(line){var seq=line.getCoordinateSequence();for(var i=0;i<seq.length-1;i++){var p0=seq[i];var p1=seq[i+1];if(!this.isLineSegmentContainedInBoundary(p0,p1))
return false;}
return true;}
jsts.operation.predicate.RectangleContains.prototype.isLineSegmentContainedInBoundary=function(p0,p1){if(p0.equals(p1))
return this.isPointContainedInBoundary(p0);if(p0.x==p1.x){if(p0.x==this.rectEnv.getMinX()||p0.x==this.rectEnv.getMaxX())
return true;}
else if(p0.y==p1.y){if(p0.y==this.rectEnv.getMinY()||p0.y==this.rectEnv.getMaxY())
return true;}
return false;}})();(function(){var Location=jsts.geom.Location;var Position=jsts.geomgraph.Position;jsts.geomgraph.Depth=function(){this.depth=[[],[]];for(var i=0;i<2;i++){for(var j=0;j<3;j++){this.depth[i][j]=jsts.geomgraph.Depth.NULL_VALUE;}}};jsts.geomgraph.Depth.NULL_VALUE=-1;jsts.geomgraph.Depth.depthAtLocation=function(location){if(location===Location.EXTERIOR)
return 0;if(location===Location.INTERIOR)
return 1;return jsts.geomgraph.Depth.NULL_VALUE;};jsts.geomgraph.Depth.prototype.depth=null;jsts.geomgraph.Depth.prototype.getDepth=function(geomIndex,posIndex){return this.depth[geomIndex][posIndex];};jsts.geomgraph.Depth.prototype.setDepth=function(geomIndex,posIndex,depthValue){this.depth[geomIndex][posIndex]=depthValue;};jsts.geomgraph.Depth.prototype.getLocation=function(geomIndex,posIndex){if(this.depth[geomIndex][posIndex]<=0)
return Location.EXTERIOR;return Location.INTERIOR;};jsts.geomgraph.Depth.prototype.add=function(geomIndex,posIndex,location){if(location===Location.INTERIOR)
this.depth[geomIndex][posIndex]++;};jsts.geomgraph.Depth.prototype.isNull=function(){if(arguments.length>0){return this.isNull2.apply(this,arguments);}
for(var i=0;i<2;i++){for(var j=0;j<3;j++){if(this.depth[i][j]!==jsts.geomgraph.Depth.NULL_VALUE)
return false;}}
return true;};jsts.geomgraph.Depth.prototype.isNull2=function(geomIndex){if(arguments.length>1){return this.isNull3.apply(this,arguments);}
return this.depth[geomIndex][1]==jsts.geomgraph.Depth.NULL_VALUE;};jsts.geomgraph.Depth.prototype.isNull3=function(geomIndex,posIndex){return this.depth[geomIndex][posIndex]==jsts.geomgraph.Depth.NULL_VALUE;};jsts.geomgraph.Depth.prototype.add=function(lbl){for(var i=0;i<2;i++){for(var j=1;j<3;j++){var loc=lbl.getLocation(i,j);if(loc===Location.EXTERIOR||loc===Location.INTERIOR){if(this.isNull(i,j)){this.depth[i][j]=jsts.geomgraph.Depth.depthAtLocation(loc);}else
this.depth[i][j]+=jsts.geomgraph.Depth.depthAtLocation(loc);}}}};jsts.geomgraph.Depth.prototype.getDelta=function(geomIndex){return this.depth[geomIndex][Position.RIGHT]-
this.depth[geomIndex][Position.LEFT];};jsts.geomgraph.Depth.prototype.normalize=function(){for(var i=0;i<2;i++){if(!this.isNull(i)){var minDepth=this.depth[i][1];if(this.depth[i][2]<minDepth)
minDepth=this.depth[i][2];if(minDepth<0)
minDepth=0;for(var j=1;j<3;j++){var newValue=0;if(this.depth[i][j]>minDepth)
newValue=1;this.depth[i][j]=newValue;}}}};jsts.geomgraph.Depth.prototype.toString=function(){return'A: '+this.depth[0][1]+','+this.depth[0][2]+' B: '+
this.depth[1][1]+','+this.depth[1][2];};})();jsts.algorithm.BoundaryNodeRule=function(){};jsts.algorithm.BoundaryNodeRule.prototype.isInBoundary=function(boundaryCount){throw new jsts.error.AbstractMethodInvocationError();};jsts.algorithm.Mod2BoundaryNodeRule=function(){};jsts.algorithm.Mod2BoundaryNodeRule.prototype=new jsts.algorithm.BoundaryNodeRule();jsts.algorithm.Mod2BoundaryNodeRule.prototype.isInBoundary=function(boundaryCount){return boundaryCount%2===1;};jsts.algorithm.BoundaryNodeRule.MOD2_BOUNDARY_RULE=new jsts.algorithm.Mod2BoundaryNodeRule();jsts.algorithm.BoundaryNodeRule.OGC_SFS_BOUNDARY_RULE=jsts.algorithm.BoundaryNodeRule.MOD2_BOUNDARY_RULE;jsts.operation.distance.GeometryLocation=function(component,segIndex,pt){this.component=component;this.segIndex=segIndex;this.pt=pt;};jsts.operation.distance.GeometryLocation.INSIDE_AREA=-1;jsts.operation.distance.GeometryLocation.prototype.component=null;jsts.operation.distance.GeometryLocation.prototype.segIndex=null;jsts.operation.distance.GeometryLocation.prototype.pt=null;jsts.operation.distance.GeometryLocation.prototype.getGeometryComponent=function(){return this.component;};jsts.operation.distance.GeometryLocation.prototype.getSegmentIndex=function(){return this.segIndex;};jsts.operation.distance.GeometryLocation.prototype.getCoordinate=function(){return this.pt;};jsts.operation.distance.GeometryLocation.prototype.isInsideArea=function(){return this.segIndex===jsts.operation.distance.GeometryLocation.INSIDE_AREA;};jsts.geom.util.PointExtracter=function(pts){this.pts=pts;};jsts.geom.util.PointExtracter.prototype=new jsts.geom.GeometryFilter();jsts.geom.util.PointExtracter.prototype.pts=null;jsts.geom.util.PointExtracter.getPoints=function(geom,list){if(list===undefined){list=[];}
if(geom instanceof jsts.geom.Point){list.push(geom);}else if(geom instanceof jsts.geom.GeometryCollection||geom instanceof jsts.geom.MultiPoint||geom instanceof jsts.geom.MultiLineString||geom instanceof jsts.geom.MultiPolygon){geom.apply(new jsts.geom.util.PointExtracter(list));}
return list;};jsts.geom.util.PointExtracter.prototype.filter=function(geom){if(geom instanceof jsts.geom.Point)
this.pts.push(geom);};(function(){var Location=jsts.geom.Location;jsts.operation.relate.RelateNodeGraph=function(){this.nodes=new jsts.geomgraph.NodeMap(new jsts.operation.relate.RelateNodeFactory());};jsts.operation.relate.RelateNodeGraph.prototype.nodes=null;jsts.operation.relate.RelateNodeGraph.prototype.build=function(geomGraph){this.computeIntersectionNodes(geomGraph,0);this.copyNodesAndLabels(geomGraph,0);var eeBuilder=new jsts.operation.relate.EdgeEndBuilder();var eeList=eeBuilder.computeEdgeEnds(geomGraph.getEdgeIterator());this.insertEdgeEnds(eeList);};jsts.operation.relate.RelateNodeGraph.prototype.computeIntersectionNodes=function(geomGraph,argIndex){for(var edgeIt=geomGraph.getEdgeIterator();edgeIt.hasNext();){var e=edgeIt.next();var eLoc=e.getLabel().getLocation(argIndex);for(var eiIt=e.getEdgeIntersectionList().iterator();eiIt.hasNext();){var ei=eiIt.next();var n=this.nodes.addNode(ei.coord);if(eLoc===Location.BOUNDARY)
n.setLabelBoundary(argIndex);else{if(n.getLabel().isNull(argIndex))
n.setLabel(argIndex,Location.INTERIOR);}}}};jsts.operation.relate.RelateNodeGraph.prototype.copyNodesAndLabels=function(geomGraph,argIndex){for(var nodeIt=geomGraph.getNodeIterator();nodeIt.hasNext();){var graphNode=nodeIt.next();var newNode=this.nodes.addNode(graphNode.getCoordinate());newNode.setLabel(argIndex,graphNode.getLabel().getLocation(argIndex));}};jsts.operation.relate.RelateNodeGraph.prototype.insertEdgeEnds=function(ee){for(var i=ee.iterator();i.hasNext();){var e=i.next();this.nodes.add(e);}};jsts.operation.relate.RelateNodeGraph.prototype.getNodeIterator=function(){return this.nodes.iterator();};})();jsts.geomgraph.index.SimpleSweepLineIntersector=function(){};jsts.geomgraph.index.SimpleSweepLineIntersector.prototype=new jsts.geomgraph.index.EdgeSetIntersector();jsts.geomgraph.index.SimpleSweepLineIntersector.prototype.events=[];jsts.geomgraph.index.SimpleSweepLineIntersector.prototype.nOverlaps=null;jsts.geomgraph.index.SimpleSweepLineIntersector.prototype.computeIntersections=function(edges,si,testAllSegments){if(si instanceof javascript.util.List){this.computeIntersections2.apply(this,arguments);return;}
if(testAllSegments){this.add(edges,null);}else{this.add(edges);}
this.computeIntersections3(si);};jsts.geomgraph.index.SimpleSweepLineIntersector.prototype.computeIntersections2=function(edges0,edges1,si){this.add(edges0,edges0);this.add(edges1,edges1);this.computeIntersections3(si);};jsts.geomgraph.index.SimpleSweepLineIntersector.prototype.add=function(edge,edgeSet){if(edge instanceof javascript.util.List){this.add2.apply(this,arguments);return;}
var pts=edge.getCoordinates();for(var i=0;i<pts.length-1;i++){var ss=new jsts.geomgraph.index.SweepLineSegment(edge,i);var insertEvent=new jsts.geomgraph.index.SweepLineEvent(ss.getMinX(),ss,edgeSet);this.events.push(insertEvent);this.events.push(new jsts.geomgraph.index.SweepLineEvent(ss.getMaxX(),insertEvent));}};jsts.geomgraph.index.SimpleSweepLineIntersector.prototype.add2=function(edges,edgeSet){for(var i=edges.iterator();i.hasNext();){var edge=i.next();if(edgeSet){this.add(edge,edgeSet);}else{this.add(edge,edge);}}};jsts.geomgraph.index.SimpleSweepLineIntersector.prototype.prepareEvents=function(){this.events.sort(function(a,b){return a.compareTo(b);});for(var i=0;i<this.events.length;i++){var ev=this.events[i];if(ev.isDelete()){ev.getInsertEvent().setDeleteEventIndex(i);}}};jsts.geomgraph.index.SimpleSweepLineIntersector.prototype.computeIntersections3=function(si){this.nOverlaps=0;this.prepareEvents();for(var i=0;i<this.events.length;i++){var ev=this.events[i];if(ev.isInsert()){this.processOverlaps(i,ev.getDeleteEventIndex(),ev,si);}}};jsts.geomgraph.index.SimpleSweepLineIntersector.prototype.processOverlaps=function(start,end,ev0,si){var ss0=ev0.getObject();for(var i=start;i<end;i++){var ev1=this.events[i];if(ev1.isInsert()){var ss1=ev1.getObject();if(!ev0.isSameLabel(ev1)){ss0.computeIntersections(ss1,si);this.nOverlaps++;}}}}
jsts.triangulate.VoronoiDiagramBuilder=function(){this.siteCoords=null;this.tolerance=0.0;this.subdiv=null;this.clipEnv=null;this.diagramEnv=null;};jsts.triangulate.VoronoiDiagramBuilder.prototype.setSites=function(){var arg=arguments[0];if(arg instanceof jsts.geom.Geometry||arg instanceof jsts.geom.Coordinate||arg instanceof jsts.geom.Point||arg instanceof jsts.geom.MultiPoint||arg instanceof jsts.geom.LineString||arg instanceof jsts.geom.MultiLineString||arg instanceof jsts.geom.LinearRing||arg instanceof jsts.geom.Polygon||arg instanceof jsts.geom.MultiPolygon){this.setSitesByGeometry(arg);}else{this.setSitesByArray(arg);}};jsts.triangulate.VoronoiDiagramBuilder.prototype.setSitesByGeometry=function(geom){this.siteCoords=jsts.triangulate.DelaunayTriangulationBuilder.extractUniqueCoordinates(geom);};jsts.triangulate.VoronoiDiagramBuilder.prototype.setSitesByArray=function(coords){this.siteCoords=jsts.triangulate.DelaunayTriangulationBuilder.unique(coords);};jsts.triangulate.VoronoiDiagramBuilder.prototype.setClipEnvelope=function(clipEnv){this.clipEnv=clipEnv;};jsts.triangulate.VoronoiDiagramBuilder.prototype.setTolerance=function(tolerance)
{this.tolerance=tolerance;};jsts.triangulate.VoronoiDiagramBuilder.prototype.create=function(){if(this.subdiv!==null){return;}
var siteEnv,expandBy,vertices,triangulator;siteEnv=jsts.triangulate.DelaunayTriangulationBuilder.envelope(this.siteCoords);this.diagramEnv=siteEnv;expandBy=Math.max(this.diagramEnv.getWidth(),this.diagramEnv.getHeight());this.diagramEnv.expandBy(expandBy);if(this.clipEnv!==null){this.diagramEnv.expandToInclude(this.clipEnv);}
vertices=jsts.triangulate.DelaunayTriangulationBuilder.toVertices(this.siteCoords);this.subdiv=new jsts.triangulate.quadedge.QuadEdgeSubdivision(siteEnv,this.tolerance);triangulator=new jsts.triangulate.IncrementalDelaunayTriangulator(this.subdiv);triangulator.insertSites(vertices);};jsts.triangulate.VoronoiDiagramBuilder.prototype.getSubdivision=function(){this.create();return this.subdiv;};jsts.triangulate.VoronoiDiagramBuilder.prototype.getDiagram=function(geomFact){this.create();var polys=this.subdiv.getVoronoiDiagram(geomFact);return this.clipGeometryCollection(polys,this.diagramEnv);};jsts.triangulate.VoronoiDiagramBuilder.prototype.clipGeometryCollection=function(geom,clipEnv){var clipPoly,clipped,i,il,g,result;clipPoly=geom.getFactory().toGeometry(clipEnv);clipped=[];i=0,il=geom.getNumGeometries();for(i;i<il;i++){g=geom.getGeometryN(i);result=null;if(clipEnv.contains(g.getEnvelopeInternal())){result=g;}
else if(clipEnv.intersects(g.getEnvelopeInternal())){result=clipPoly.intersection(g);}
if(result!==null&&!result.isEmpty()){clipped.push(result);}}
return geom.getFactory().createGeometryCollection(clipped);};jsts.operation.valid.IndexedNestedRingTester=function(graph){this.graph=graph;this.rings=new javascript.util.ArrayList();this.totalEnv=new jsts.geom.Envelope();this.index=null;this.nestedPt=null;};jsts.operation.valid.IndexedNestedRingTester.prototype.getNestedPoint=function(){return this.nestedPt;};jsts.operation.valid.IndexedNestedRingTester.prototype.add=function(ring){this.rings.add(ring);this.totalEnv.expandToInclude(ring.getEnvelopeInternal());};jsts.operation.valid.IndexedNestedRingTester.prototype.isNonNested=function(){this.buildIndex();for(var i=0;i<this.rings.size();i++){var innerRing=this.rings.get(i);var innerRingPts=innerRing.getCoordinates();var results=this.index.query(innerRing.getEnvelopeInternal());for(var j=0;j<results.length;j++){var searchRing=results[j];var searchRingPts=searchRing.getCoordinates();if(innerRing==searchRing){continue;}
if(!innerRing.getEnvelopeInternal().intersects(searchRing.getEnvelopeInternal())){continue;}
var innerRingPt=jsts.operation.valid.IsValidOp.findPtNotNode(innerRingPts,searchRing,this.graph);if(innerRingPt==null){continue;}
var isInside=jsts.algorithm.CGAlgorithms.isPointInRing(innerRingPt,searchRingPts);if(isInside){this.nestedPt=innerRingPt;return false;}}}
return true;};jsts.operation.valid.IndexedNestedRingTester.prototype.buildIndex=function(){this.index=new jsts.index.strtree.STRtree();for(var i=0;i<this.rings.size();i++){var ring=this.rings.get(i);var env=ring.getEnvelopeInternal();this.index.insert(env,ring);}};jsts.geomgraph.index.MonotoneChain=function(mce,chainIndex){this.mce=mce;this.chainIndex=chainIndex;};jsts.geomgraph.index.MonotoneChain.prototype.mce=null;jsts.geomgraph.index.MonotoneChain.prototype.chainIndex=null;jsts.geomgraph.index.MonotoneChain.prototype.computeIntersections=function(mc,si){this.mce.computeIntersectsForChain(this.chainIndex,mc.mce,mc.chainIndex,si);};jsts.noding.SegmentNode=function(segString,coord,segmentIndex,segmentOctant){this.segString=segString;this.coord=new jsts.geom.Coordinate(coord);this.segmentIndex=segmentIndex;this.segmentOctant=segmentOctant;this._isInterior=!coord.equals2D(segString.getCoordinate(segmentIndex));};jsts.noding.SegmentNode.prototype.segString=null;jsts.noding.SegmentNode.prototype.coord=null;jsts.noding.SegmentNode.prototype.segmentIndex=null;jsts.noding.SegmentNode.prototype.segmentOctant=null;jsts.noding.SegmentNode.prototype._isInterior=null;jsts.noding.SegmentNode.prototype.getCoordinate=function(){return this.coord;};jsts.noding.SegmentNode.prototype.isInterior=function(){return this._isInterior;};jsts.noding.SegmentNode.prototype.isEndPoint=function(maxSegmentIndex){if(this.segmentIndex===0&&!this._isInterior)return true;if(this.segmentIndex===this.maxSegmentIndex)return true;return false;};jsts.noding.SegmentNode.prototype.compareTo=function(obj){var other=obj;if(this.segmentIndex<other.segmentIndex)return-1;if(this.segmentIndex>other.segmentIndex)return 1;if(this.coord.equals2D(other.coord))return 0;return jsts.noding.SegmentPointComparator.compare(this.segmentOctant,this.coord,other.coord);};(function(){jsts.io.GeoJSONWriter=function(){this.parser=new jsts.io.GeoJSONParser(this.geometryFactory);};jsts.io.GeoJSONWriter.prototype.write=function(geometry){var geoJson=this.parser.write(geometry);return geoJson;};})();jsts.io.OpenLayersParser=function(geometryFactory){this.geometryFactory=geometryFactory||new jsts.geom.GeometryFactory();};jsts.io.OpenLayersParser.prototype.read=function(geometry){if(geometry.CLASS_NAME==='OpenLayers.Geometry.Point'){return this.convertFromPoint(geometry);}else if(geometry.CLASS_NAME==='OpenLayers.Geometry.LineString'){return this.convertFromLineString(geometry);}else if(geometry.CLASS_NAME==='OpenLayers.Geometry.LinearRing'){return this.convertFromLinearRing(geometry);}else if(geometry.CLASS_NAME==='OpenLayers.Geometry.Polygon'){return this.convertFromPolygon(geometry);}else if(geometry.CLASS_NAME==='OpenLayers.Geometry.MultiPoint'){return this.convertFromMultiPoint(geometry);}else if(geometry.CLASS_NAME==='OpenLayers.Geometry.MultiLineString'){return this.convertFromMultiLineString(geometry);}else if(geometry.CLASS_NAME==='OpenLayers.Geometry.MultiPolygon'){return this.convertFromMultiPolygon(geometry);}else if(geometry.CLASS_NAME==='OpenLayers.Geometry.Collection'){return this.convertFromCollection(geometry);}};jsts.io.OpenLayersParser.prototype.convertFromPoint=function(point){return this.geometryFactory.createPoint(new jsts.geom.Coordinate(point.x,point.y));};jsts.io.OpenLayersParser.prototype.convertFromLineString=function(lineString){var i;var coordinates=[];for(i=0;i<lineString.components.length;i++){coordinates.push(new jsts.geom.Coordinate(lineString.components[i].x,lineString.components[i].y));}
return this.geometryFactory.createLineString(coordinates);};jsts.io.OpenLayersParser.prototype.convertFromLinearRing=function(linearRing){var i;var coordinates=[];for(i=0;i<linearRing.components.length;i++){coordinates.push(new jsts.geom.Coordinate(linearRing.components[i].x,linearRing.components[i].y));}
return this.geometryFactory.createLinearRing(coordinates);};jsts.io.OpenLayersParser.prototype.convertFromPolygon=function(polygon){var i;var shell=null;var holes=[];for(i=0;i<polygon.components.length;i++){var linearRing=this.convertFromLinearRing(polygon.components[i]);if(i===0){shell=linearRing;}else{holes.push(linearRing);}}
return this.geometryFactory.createPolygon(shell,holes);};jsts.io.OpenLayersParser.prototype.convertFromMultiPoint=function(multiPoint){var i;var points=[];for(i=0;i<multiPoint.components.length;i++){points.push(this.convertFromPoint(multiPoint.components[i]));}
return this.geometryFactory.createMultiPoint(points);};jsts.io.OpenLayersParser.prototype.convertFromMultiLineString=function(multiLineString){var i;var lineStrings=[];for(i=0;i<multiLineString.components.length;i++){lineStrings.push(this.convertFromLineString(multiLineString.components[i]));}
return this.geometryFactory.createMultiLineString(lineStrings);};jsts.io.OpenLayersParser.prototype.convertFromMultiPolygon=function(multiPolygon){var i;var polygons=[];for(i=0;i<multiPolygon.components.length;i++){polygons.push(this.convertFromPolygon(multiPolygon.components[i]));}
return this.geometryFactory.createMultiPolygon(polygons);};jsts.io.OpenLayersParser.prototype.convertFromCollection=function(collection){var i;var geometries=[];for(i=0;i<collection.components.length;i++){geometries.push(this.read(collection.components[i]));}
return this.geometryFactory.createGeometryCollection(geometries);};jsts.io.OpenLayersParser.prototype.write=function(geometry){if(geometry.CLASS_NAME==='jsts.geom.Point'){return this.convertToPoint(geometry.coordinate);}else if(geometry.CLASS_NAME==='jsts.geom.LineString'){return this.convertToLineString(geometry);}else if(geometry.CLASS_NAME==='jsts.geom.LinearRing'){return this.convertToLinearRing(geometry);}else if(geometry.CLASS_NAME==='jsts.geom.Polygon'){return this.convertToPolygon(geometry);}else if(geometry.CLASS_NAME==='jsts.geom.MultiPoint'){return this.convertToMultiPoint(geometry);}else if(geometry.CLASS_NAME==='jsts.geom.MultiLineString'){return this.convertToMultiLineString(geometry);}else if(geometry.CLASS_NAME==='jsts.geom.MultiPolygon'){return this.convertToMultiPolygon(geometry);}else if(geometry.CLASS_NAME==='jsts.geom.GeometryCollection'){return this.convertToCollection(geometry);}};jsts.io.OpenLayersParser.prototype.convertToPoint=function(coordinate){return new OpenLayers.Geometry.Point(coordinate.x,coordinate.y);};jsts.io.OpenLayersParser.prototype.convertToLineString=function(lineString){var i;var points=[];for(i=0;i<lineString.points.length;i++){var coordinate=lineString.points[i];points.push(this.convertToPoint(coordinate));}
return new OpenLayers.Geometry.LineString(points);};jsts.io.OpenLayersParser.prototype.convertToLinearRing=function(linearRing){var i;var points=[];for(i=0;i<linearRing.points.length;i++){var coordinate=linearRing.points[i];points.push(this.convertToPoint(coordinate));}
return new OpenLayers.Geometry.LinearRing(points);};jsts.io.OpenLayersParser.prototype.convertToPolygon=function(polygon){var i;var rings=[];rings.push(this.convertToLinearRing(polygon.shell));for(i=0;i<polygon.holes.length;i++){var ring=polygon.holes[i];rings.push(this.convertToLinearRing(ring));}
return new OpenLayers.Geometry.Polygon(rings);};jsts.io.OpenLayersParser.prototype.convertToMultiPoint=function(multiPoint){var i;var points=[];for(i=0;i<multiPoint.geometries.length;i++){var coordinate=multiPoint.geometries[i].coordinate;points.push(new OpenLayers.Geometry.Point(coordinate.x,coordinate.y));}
return new OpenLayers.Geometry.MultiPoint(points);};jsts.io.OpenLayersParser.prototype.convertToMultiLineString=function(multiLineString){var i;var lineStrings=[];for(i=0;i<multiLineString.geometries.length;i++){lineStrings.push(this.convertToLineString(multiLineString.geometries[i]));}
return new OpenLayers.Geometry.MultiLineString(lineStrings);};jsts.io.OpenLayersParser.prototype.convertToMultiPolygon=function(multiPolygon){var i;var polygons=[];for(i=0;i<multiPolygon.geometries.length;i++){polygons.push(this.convertToPolygon(multiPolygon.geometries[i]));}
return new OpenLayers.Geometry.MultiPolygon(polygons);};jsts.io.OpenLayersParser.prototype.convertToCollection=function(geometryCollection){var i;var geometries=[];for(i=0;i<geometryCollection.geometries.length;i++){var geometry=geometryCollection.geometries[i];var geometryOpenLayers=this.write(geometry);geometries.push(geometryOpenLayers);}
return new OpenLayers.Geometry.Collection(geometries);};jsts.index.quadtree.Quadtree=function(){this.root=new jsts.index.quadtree.Root();this.minExtent=1.0;};jsts.index.quadtree.Quadtree.ensureExtent=function(itemEnv,minExtent){var minx,maxx,miny,maxy;minx=itemEnv.getMinX();maxx=itemEnv.getMaxX();miny=itemEnv.getMinY();maxy=itemEnv.getMaxY();if(minx!==maxx&&miny!==maxy){return itemEnv;}
if(minx===maxx){minx=minx-(minExtent/2.0);maxx=minx+(minExtent/2.0);}
if(miny===maxy){miny=miny-(minExtent/2.0);maxy=miny+(minExtent/2.0);}
return new jsts.geom.Envelope(minx,maxx,miny,maxy);};jsts.index.quadtree.Quadtree.prototype.depth=function(){return this.root.depth();};jsts.index.quadtree.Quadtree.prototype.size=function(){return this.root.size();};jsts.index.quadtree.Quadtree.prototype.insert=function(itemEnv,item){this.collectStats(itemEnv);var insertEnv=jsts.index.quadtree.Quadtree.ensureExtent(itemEnv,this.minExtent);this.root.insert(insertEnv,item);};jsts.index.quadtree.Quadtree.prototype.remove=function(itemEnv,item){var posEnv=jsts.index.quadtree.Quadtree.ensureExtent(itemEnv,this.minExtent);return this.root.remove(posEnv,item);};jsts.index.quadtree.Quadtree.prototype.query=function(){if(arguments.length===1){return jsts.index.quadtree.Quadtree.prototype.queryByEnvelope.apply(this,arguments);}else{jsts.index.quadtree.Quadtree.prototype.queryWithVisitor.apply(this,arguments);}};jsts.index.quadtree.Quadtree.prototype.queryByEnvelope=function(searchEnv){var visitor=new jsts.index.ArrayListVisitor();this.query(searchEnv,visitor);return visitor.getItems();};jsts.index.quadtree.Quadtree.prototype.queryWithVisitor=function(searchEnv,visitor){this.root.visit(searchEnv,visitor);};jsts.index.quadtree.Quadtree.prototype.queryAll=function(){var foundItems=[];foundItems=this.root.addAllItems(foundItems);return foundItems;};jsts.index.quadtree.Quadtree.prototype.collectStats=function(itemEnv){var delX=itemEnv.getWidth();if(delX<this.minExtent&&delX>0.0){this.minExtent=delX;}
var delY=itemEnv.getHeight();if(delY<this.minExtent&&delY>0.0){this.minExtent=delY;}};jsts.operation.relate.RelateNodeFactory=function(){};jsts.operation.relate.RelateNodeFactory.prototype=new jsts.geomgraph.NodeFactory();jsts.operation.relate.RelateNodeFactory.prototype.createNode=function(coord){return new jsts.operation.relate.RelateNode(coord,new jsts.operation.relate.EdgeEndBundleStar());};jsts.index.quadtree.Key=function(itemEnv){this.pt=new jsts.geom.Coordinate();this.level=0;this.env=null;this.computeKey(itemEnv);};jsts.index.quadtree.Key.computeQuadLevel=function(env){var dx,dy,dMax,level;dx=env.getWidth();dy=env.getHeight();dMax=dx>dy?dx:dy;level=jsts.index.DoubleBits.exponent(dMax)+1;return level;};jsts.index.quadtree.Key.prototype.getPoint=function(){return this.pt;};jsts.index.quadtree.Key.prototype.getLevel=function(){return this.level;};jsts.index.quadtree.Key.prototype.getEnvelope=function(){return this.env;};jsts.index.quadtree.Key.prototype.getCentre=function(){var x,y;x=(this.env.getMinX()+this.env.getMaxX())/2;y=(this.env.getMinY()+this.env.getMaxY())/2;return new jsts.geom.Coordinate(x,y);};jsts.index.quadtree.Key.prototype.computeKey=function(){if(arguments[0]instanceof jsts.geom.Envelope){this.computeKeyFromEnvelope(arguments[0]);}else{this.computeKeyFromLevel(arguments[0],arguments[1]);}};jsts.index.quadtree.Key.prototype.computeKeyFromEnvelope=function(env){this.level=jsts.index.quadtree.Key.computeQuadLevel(env);this.env=new jsts.geom.Envelope();this.computeKey(this.level,env);while(!this.env.contains(env)){this.level+=1;this.computeKey(this.level,env);}};jsts.index.quadtree.Key.prototype.computeKeyFromLevel=function(level,env){var quadSize=jsts.index.DoubleBits.powerOf2(level);this.pt.x=Math.floor(env.getMinX()/quadSize)*quadSize;this.pt.y=Math.floor(env.getMinY()/quadSize)*quadSize;this.env.init(this.pt.x,this.pt.x+quadSize,this.pt.y,this.pt.y+
quadSize);};jsts.geom.CoordinateArrays=function(){throw new jsts.error.AbstractMethodInvocationError();};jsts.geom.CoordinateArrays.copyDeep=function(){if(arguments.length===1){return jsts.geom.CoordinateArrays.copyDeep1(arguments[0]);}else if(arguments.length===5){jsts.geom.CoordinateArrays.copyDeep2(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4]);}};jsts.geom.CoordinateArrays.copyDeep1=function(coordinates){var copy=[];for(var i=0;i<coordinates.length;i++){copy[i]=new jsts.geom.Coordinate(coordinates[i]);}
return copy;};jsts.geom.CoordinateArrays.copyDeep2=function(src,srcStart,dest,destStart,length){for(var i=0;i<length;i++){dest[destStart+i]=new jsts.geom.Coordinate(src[srcStart+i]);}};jsts.geom.CoordinateArrays.removeRepeatedPoints=function(coord){var coordList;if(!this.hasRepeatedPoints(coord)){return coord;}
coordList=new jsts.geom.CoordinateList(coord,false);return coordList.toCoordinateArray();};jsts.geom.CoordinateArrays.hasRepeatedPoints=function(coord){var i;for(i=1;i<coord.length;i++){if(coord[i-1].equals(coord[i])){return true;}}
return false;};jsts.geom.CoordinateArrays.ptNotInList=function(testPts,pts){for(var i=0;i<testPts.length;i++){var testPt=testPts[i];if(jsts.geom.CoordinateArrays.indexOf(testPt,pts)<0)
return testPt;}
return null;};jsts.geom.CoordinateArrays.increasingDirection=function(pts){for(var i=0;i<parseInt(pts.length/2);i++){var j=pts.length-1-i;var comp=pts[i].compareTo(pts[j]);if(comp!=0)
return comp;}
return 1;};jsts.geom.CoordinateArrays.minCoordinate=function(coordinates){var minCoord=null;for(var i=0;i<coordinates.length;i++){if(minCoord===null||minCoord.compareTo(coordinates[i])>0){minCoord=coordinates[i];}}
return minCoord;};jsts.geom.CoordinateArrays.scroll=function(coordinates,firstCoordinate){var i=jsts.geom.CoordinateArrays.indexOf(firstCoordinate,coordinates);if(i<0)
return;var newCoordinates=coordinates.slice(i).concat(coordinates.slice(0,i));for(i=0;i<newCoordinates.length;i++){coordinates[i]=newCoordinates[i];}};jsts.geom.CoordinateArrays.indexOf=function(coordinate,coordinates){for(var i=0;i<coordinates.length;i++){if(coordinate.equals(coordinates[i])){return i;}}
return-1;};jsts.operation.overlay.MinimalEdgeRing=function(start,geometryFactory){jsts.geomgraph.EdgeRing.call(this,start,geometryFactory);};jsts.operation.overlay.MinimalEdgeRing.prototype=new jsts.geomgraph.EdgeRing();jsts.operation.overlay.MinimalEdgeRing.constructor=jsts.operation.overlay.MinimalEdgeRing;jsts.operation.overlay.MinimalEdgeRing.prototype.getNext=function(de){return de.getNextMin();};jsts.operation.overlay.MinimalEdgeRing.prototype.setEdgeRing=function(de,er){de.setMinEdgeRing(er);};jsts.triangulate.DelaunayTriangulationBuilder=function(){this.siteCoords=null;this.tolerance=0.0;this.subdiv=null;};jsts.triangulate.DelaunayTriangulationBuilder.extractUniqueCoordinates=function(geom){if(geom===undefined||geom===null){return new jsts.geom.CoordinateList([],false).toArray();}
var coords=geom.getCoordinates();return jsts.triangulate.DelaunayTriangulationBuilder.unique(coords);};jsts.triangulate.DelaunayTriangulationBuilder.unique=function(coords){coords.sort(function(a,b){return a.compareTo(b);});var coordList=new jsts.geom.CoordinateList(coords,false);return coordList.toArray();};jsts.triangulate.DelaunayTriangulationBuilder.toVertices=function(coords){var verts=new Array(coords.length),i=0,il=coords.length,coord;for(i;i<il;i++){coord=coords[i];verts[i]=new jsts.triangulate.quadedge.Vertex(coord);}
return verts;};jsts.triangulate.DelaunayTriangulationBuilder.envelope=function(coords){var env=new jsts.geom.Envelope(),i=0,il=coords.length;for(i;i<il;i++){env.expandToInclude(coords[i]);}
return env;};jsts.triangulate.DelaunayTriangulationBuilder.prototype.setSites=function(){var arg=arguments[0];if(arg instanceof jsts.geom.Geometry||arg instanceof jsts.geom.Coordinate||arg instanceof jsts.geom.Point||arg instanceof jsts.geom.MultiPoint||arg instanceof jsts.geom.LineString||arg instanceof jsts.geom.MultiLineString||arg instanceof jsts.geom.LinearRing||arg instanceof jsts.geom.Polygon||arg instanceof jsts.geom.MultiPolygon){this.setSitesFromGeometry(arg);}else{this.setSitesFromCollection(arg);}};jsts.triangulate.DelaunayTriangulationBuilder.prototype.setSitesFromGeometry=function(geom){this.siteCoords=jsts.triangulate.DelaunayTriangulationBuilder.extractUniqueCoordinates(geom);};jsts.triangulate.DelaunayTriangulationBuilder.prototype.setSitesFromCollection=function(coords){this.siteCoords=jsts.triangulate.DelaunayTriangulationBuilder.unique(coords);};jsts.triangulate.DelaunayTriangulationBuilder.prototype.setTolerance=function(tolerance){this.tolerance=tolerance;};jsts.triangulate.DelaunayTriangulationBuilder.prototype.create=function(){if(this.subdiv===null){var siteEnv,vertices,triangulator;siteEnv=jsts.triangulate.DelaunayTriangulationBuilder.envelope(this.siteCoords);vertices=jsts.triangulate.DelaunayTriangulationBuilder.toVertices(this.siteCoords);this.subdiv=new jsts.triangulate.quadedge.QuadEdgeSubdivision(siteEnv,this.tolerance);triangulator=new jsts.triangulate.IncrementalDelaunayTriangulator(this.subdiv);triangulator.insertSites(vertices);}};jsts.triangulate.DelaunayTriangulationBuilder.prototype.getSubdivision=function(){this.create();return this.subdiv;};jsts.triangulate.DelaunayTriangulationBuilder.prototype.getEdges=function(geomFact){this.create();return this.subdiv.getEdges(geomFact);};jsts.triangulate.DelaunayTriangulationBuilder.prototype.getTriangles=function(geomFact){this.create();return this.subdiv.getTriangles(geomFact);};jsts.algorithm.RayCrossingCounter=function(p){this.p=p;};jsts.algorithm.RayCrossingCounter.locatePointInRing=function(p,ring){var counter=new jsts.algorithm.RayCrossingCounter(p);for(var i=1;i<ring.length;i++){var p1=ring[i];var p2=ring[i-1];counter.countSegment(p1,p2);if(counter.isOnSegment())
return counter.getLocation();}
return counter.getLocation();};jsts.algorithm.RayCrossingCounter.prototype.p=null;jsts.algorithm.RayCrossingCounter.prototype.crossingCount=0;jsts.algorithm.RayCrossingCounter.prototype.isPointOnSegment=false;jsts.algorithm.RayCrossingCounter.prototype.countSegment=function(p1,p2){if(p1.x<this.p.x&&p2.x<this.p.x)
return;if(this.p.x==p2.x&&this.p.y===p2.y){this.isPointOnSegment=true;return;}
if(p1.y===this.p.y&&p2.y===this.p.y){var minx=p1.x;var maxx=p2.x;if(minx>maxx){minx=p2.x;maxx=p1.x;}
if(this.p.x>=minx&&this.p.x<=maxx){this.isPointOnSegment=true;}
return;}
if(((p1.y>this.p.y)&&(p2.y<=this.p.y))||((p2.y>this.p.y)&&(p1.y<=this.p.y))){var x1=p1.x-this.p.x;var y1=p1.y-this.p.y;var x2=p2.x-this.p.x;var y2=p2.y-this.p.y;var xIntSign=jsts.algorithm.RobustDeterminant.signOfDet2x2(x1,y1,x2,y2);if(xIntSign===0.0){this.isPointOnSegment=true;return;}
if(y2<y1)
xIntSign=-xIntSign;if(xIntSign>0.0){this.crossingCount++;}}};jsts.algorithm.RayCrossingCounter.prototype.isOnSegment=function(){return jsts.geom.isPointOnSegment;};jsts.algorithm.RayCrossingCounter.prototype.getLocation=function(){if(this.isPointOnSegment)
return jsts.geom.Location.BOUNDARY;if((this.crossingCount%2)===1){return jsts.geom.Location.INTERIOR;}
return jsts.geom.Location.EXTERIOR;};jsts.algorithm.RayCrossingCounter.prototype.isPointInPolygon=function(){return this.getLocation()!==jsts.geom.Location.EXTERIOR;};jsts.operation.BoundaryOp=function(geom,bnRule){this.geom=geom;this.geomFact=geom.getFactory();this.bnRule=bnRule||jsts.algorithm.BoundaryNodeRule.MOD2_BOUNDARY_RULE;};jsts.operation.BoundaryOp.prototype.geom=null;jsts.operation.BoundaryOp.prototype.geomFact=null;jsts.operation.BoundaryOp.prototype.bnRule=null;jsts.operation.BoundaryOp.prototype.getBoundary=function(){if(this.geom instanceof jsts.geom.LineString)return this.boundaryLineString(this.geom);if(this.geom instanceof jsts.geom.MultiLineString)return this.boundaryMultiLineString(this.geom);return this.geom.getBoundary();};jsts.operation.BoundaryOp.prototype.getEmptyMultiPoint=function(){return this.geomFact.createMultiPoint(null);};jsts.operation.BoundaryOp.prototype.boundaryMultiLineString=function(mLine){if(this.geom.isEmpty()){return this.getEmptyMultiPoint();}
var bdyPts=this.computeBoundaryCoordinates(mLine);if(bdyPts.length==1){return this.geomFact.createPoint(bdyPts[0]);}
return this.geomFact.createMultiPoint(bdyPts);};jsts.operation.BoundaryOp.prototype.endpoints=null;jsts.operation.BoundaryOp.prototype.computeBoundaryCoordinates=function(mLine){var i,line,endpoint,bdyPts=[];this.endpoints=[];for(i=0;i<mLine.getNumGeometries();i++){line=mLine.getGeometryN(i);if(line.getNumPoints()==0)
continue;this.addEndpoint(line.getCoordinateN(0));this.addEndpoint(line.getCoordinateN(line.getNumPoints()-1));}
for(i=0;i<this.endpoints.length;i++){endpoint=this.endpoints[i];if(this.bnRule.isInBoundary(endpoint.count)){bdyPts.push(endpoint.coordinate);}}
return bdyPts;};jsts.operation.BoundaryOp.prototype.addEndpoint=function(pt){var i,endpoint,found=false;for(i=0;i<this.endpoints.length;i++){endpoint=this.endpoints[i];if(endpoint.coordinate.equals(pt)){found=true;break;}}
if(!found){endpoint={};endpoint.coordinate=pt;endpoint.count=0;this.endpoints.push(endpoint);}
endpoint.count++;};jsts.operation.BoundaryOp.prototype.boundaryLineString=function(line){if(this.geom.isEmpty()){return this.getEmptyMultiPoint();}
if(line.isClosed()){var closedEndpointOnBoundary=this.bnRule.isInBoundary(2);if(closedEndpointOnBoundary){return line.getStartPoint();}
else{return this.geomFact.createMultiPoint(null);}}
return this.geomFact.createMultiPoint([line.getStartPoint(),line.getEndPoint()]);};jsts.operation.buffer.OffsetCurveSetBuilder=function(inputGeom,distance,curveBuilder){this.inputGeom=inputGeom;this.distance=distance;this.curveBuilder=curveBuilder;this.curveList=new javascript.util.ArrayList();};jsts.operation.buffer.OffsetCurveSetBuilder.prototype.inputGeom=null;jsts.operation.buffer.OffsetCurveSetBuilder.prototype.distance=null;jsts.operation.buffer.OffsetCurveSetBuilder.prototype.curveBuilder=null;jsts.operation.buffer.OffsetCurveSetBuilder.prototype.curveList=null;jsts.operation.buffer.OffsetCurveSetBuilder.prototype.getCurves=function(){this.add(this.inputGeom);return this.curveList;};jsts.operation.buffer.OffsetCurveSetBuilder.prototype.addCurve=function(coord,leftLoc,rightLoc){if(coord==null||coord.length<2)
return;var e=new jsts.noding.NodedSegmentString(coord,new jsts.geomgraph.Label(0,jsts.geom.Location.BOUNDARY,leftLoc,rightLoc));this.curveList.add(e);};jsts.operation.buffer.OffsetCurveSetBuilder.prototype.add=function(g){if(g.isEmpty())
return;if(g instanceof jsts.geom.Polygon)
this.addPolygon(g);else if(g instanceof jsts.geom.LineString)
this.addLineString(g);else if(g instanceof jsts.geom.Point)
this.addPoint(g);else if(g instanceof jsts.geom.MultiPoint)
this.addCollection(g);else if(g instanceof jsts.geom.MultiLineString)
this.addCollection(g);else if(g instanceof jsts.geom.MultiPolygon)
this.addCollection(g);else if(g instanceof jsts.geom.GeometryCollection)
this.addCollection(g);else
throw new jsts.error.IllegalArgumentError();};jsts.operation.buffer.OffsetCurveSetBuilder.prototype.addCollection=function(gc){for(var i=0;i<gc.getNumGeometries();i++){var g=gc.getGeometryN(i);this.add(g);}};jsts.operation.buffer.OffsetCurveSetBuilder.prototype.addPoint=function(p){if(this.distance<=0.0)
return;var coord=p.getCoordinates();var curve=this.curveBuilder.getLineCurve(coord,this.distance);this.addCurve(curve,jsts.geom.Location.EXTERIOR,jsts.geom.Location.INTERIOR);};jsts.operation.buffer.OffsetCurveSetBuilder.prototype.addLineString=function(line){if(this.distance<=0.0&&!this.curveBuilder.getBufferParameters().isSingleSided())
return;var coord=jsts.geom.CoordinateArrays.removeRepeatedPoints(line.getCoordinates());var curve=this.curveBuilder.getLineCurve(coord,this.distance);this.addCurve(curve,jsts.geom.Location.EXTERIOR,jsts.geom.Location.INTERIOR);};jsts.operation.buffer.OffsetCurveSetBuilder.prototype.addPolygon=function(p){var offsetDistance=this.distance;var offsetSide=jsts.geomgraph.Position.LEFT;if(this.distance<0.0){offsetDistance=-this.distance;offsetSide=jsts.geomgraph.Position.RIGHT;}
var shell=p.getExteriorRing();var shellCoord=jsts.geom.CoordinateArrays.removeRepeatedPoints(shell.getCoordinates());if(this.distance<0.0&&this.isErodedCompletely(shell,this.distance))
return;if(this.distance<=0.0&&shellCoord.length<3)
return;this.addPolygonRing(shellCoord,offsetDistance,offsetSide,jsts.geom.Location.EXTERIOR,jsts.geom.Location.INTERIOR);for(var i=0;i<p.getNumInteriorRing();i++){var hole=p.getInteriorRingN(i);var holeCoord=jsts.geom.CoordinateArrays.removeRepeatedPoints(hole.getCoordinates());if(this.distance>0.0&&this.isErodedCompletely(hole,-this.distance))
continue;this.addPolygonRing(holeCoord,offsetDistance,jsts.geomgraph.Position.opposite(offsetSide),jsts.geom.Location.INTERIOR,jsts.geom.Location.EXTERIOR);}};jsts.operation.buffer.OffsetCurveSetBuilder.prototype.addPolygonRing=function(coord,offsetDistance,side,cwLeftLoc,cwRightLoc){if(offsetDistance==0.0&&coord.length<jsts.geom.LinearRing.MINIMUM_VALID_SIZE)
return;var leftLoc=cwLeftLoc;var rightLoc=cwRightLoc;if(coord.length>=jsts.geom.LinearRing.MINIMUM_VALID_SIZE&&jsts.algorithm.CGAlgorithms.isCCW(coord)){leftLoc=cwRightLoc;rightLoc=cwLeftLoc;side=jsts.geomgraph.Position.opposite(side);}
var curve=this.curveBuilder.getRingCurve(coord,side,offsetDistance);this.addCurve(curve,leftLoc,rightLoc);};jsts.operation.buffer.OffsetCurveSetBuilder.prototype.isErodedCompletely=function(ring,bufferDistance){var ringCoord=ring.getCoordinates();var minDiam=0.0;if(ringCoord.length<4)
return bufferDistance<0;if(ringCoord.length==4)
return this.isTriangleErodedCompletely(ringCoord,bufferDistance);var env=ring.getEnvelopeInternal();var envMinDimension=Math.min(env.getHeight(),env.getWidth());if(bufferDistance<0.0&&2*Math.abs(bufferDistance)>envMinDimension)
return true;return false;};jsts.operation.buffer.OffsetCurveSetBuilder.prototype.isTriangleErodedCompletely=function(triangleCoord,bufferDistance){var tri=new jsts.geom.Triangle(triangleCoord[0],triangleCoord[1],triangleCoord[2]);var inCentre=tri.inCentre();var distToCentre=jsts.algorithm.CGAlgorithms.distancePointLine(inCentre,tri.p0,tri.p1);return distToCentre<Math.abs(bufferDistance);};jsts.operation.buffer.BufferSubgraph=function(){this.dirEdgeList=new javascript.util.ArrayList();this.nodes=new javascript.util.ArrayList();this.finder=new jsts.operation.buffer.RightmostEdgeFinder();};jsts.operation.buffer.BufferSubgraph.prototype.finder=null;jsts.operation.buffer.BufferSubgraph.prototype.dirEdgeList=null;jsts.operation.buffer.BufferSubgraph.prototype.nodes=null;jsts.operation.buffer.BufferSubgraph.prototype.rightMostCoord=null;jsts.operation.buffer.BufferSubgraph.prototype.env=null;jsts.operation.buffer.BufferSubgraph.prototype.getDirectedEdges=function(){return this.dirEdgeList;};jsts.operation.buffer.BufferSubgraph.prototype.getNodes=function(){return this.nodes;};jsts.operation.buffer.BufferSubgraph.prototype.getEnvelope=function(){if(this.env===null){var edgeEnv=new jsts.geom.Envelope();for(var it=this.dirEdgeList.iterator();it.hasNext();){var dirEdge=it.next();var pts=dirEdge.getEdge().getCoordinates();for(var j=0;j<pts.length-1;j++){edgeEnv.expandToInclude(pts[j]);}}
this.env=edgeEnv;}
return this.env;};jsts.operation.buffer.BufferSubgraph.prototype.getRightmostCoordinate=function(){return this.rightMostCoord;};jsts.operation.buffer.BufferSubgraph.prototype.create=function(node){this.addReachable(node);this.finder.findEdge(this.dirEdgeList);this.rightMostCoord=this.finder.getCoordinate();};jsts.operation.buffer.BufferSubgraph.prototype.addReachable=function(startNode){var nodeStack=[];nodeStack.push(startNode);while(nodeStack.length!==0){var node=nodeStack.pop();this.add(node,nodeStack);}};jsts.operation.buffer.BufferSubgraph.prototype.add=function(node,nodeStack){node.setVisited(true);this.nodes.add(node);for(var i=node.getEdges().iterator();i.hasNext();){var de=i.next();this.dirEdgeList.add(de);var sym=de.getSym();var symNode=sym.getNode();if(!symNode.isVisited())
nodeStack.push(symNode);}};jsts.operation.buffer.BufferSubgraph.prototype.clearVisitedEdges=function(){for(var it=this.dirEdgeList.iterator();it.hasNext();){var de=it.next();de.setVisited(false);}};jsts.operation.buffer.BufferSubgraph.prototype.computeDepth=function(outsideDepth){this.clearVisitedEdges();var de=this.finder.getEdge();var n=de.getNode();var label=de.getLabel();de.setEdgeDepths(jsts.geomgraph.Position.RIGHT,outsideDepth);this.copySymDepths(de);this.computeDepths(de);};jsts.operation.buffer.BufferSubgraph.prototype.computeDepths=function(startEdge){var nodesVisited=[];var nodeQueue=[];var startNode=startEdge.getNode();nodeQueue.push(startNode);nodesVisited.push(startNode);startEdge.setVisited(true);while(nodeQueue.length!==0){var n=nodeQueue.shift();nodesVisited.push(n);this.computeNodeDepth(n);for(var i=n.getEdges().iterator();i.hasNext();){var de=i.next();var sym=de.getSym();if(sym.isVisited())
continue;var adjNode=sym.getNode();if(nodesVisited.indexOf(adjNode)===-1){nodeQueue.push(adjNode);nodesVisited.push(adjNode);}}}};jsts.operation.buffer.BufferSubgraph.prototype.computeNodeDepth=function(n){var startEdge=null;for(var i=n.getEdges().iterator();i.hasNext();){var de=i.next();if(de.isVisited()||de.getSym().isVisited()){startEdge=de;break;}}
if(startEdge==null)
throw new jsts.error.TopologyError('unable to find edge to compute depths at '+n.getCoordinate());n.getEdges().computeDepths(startEdge);for(var i=n.getEdges().iterator();i.hasNext();){var de=i.next();de.setVisited(true);this.copySymDepths(de);}};jsts.operation.buffer.BufferSubgraph.prototype.copySymDepths=function(de){var sym=de.getSym();sym.setDepth(jsts.geomgraph.Position.LEFT,de.getDepth(jsts.geomgraph.Position.RIGHT));sym.setDepth(jsts.geomgraph.Position.RIGHT,de.getDepth(jsts.geomgraph.Position.LEFT));};jsts.operation.buffer.BufferSubgraph.prototype.findResultEdges=function(){for(var it=this.dirEdgeList.iterator();it.hasNext();){var de=it.next();if(de.getDepth(jsts.geomgraph.Position.RIGHT)>=1&&de.getDepth(jsts.geomgraph.Position.LEFT)<=0&&!de.isInteriorAreaEdge()){de.setInResult(true);}}};jsts.operation.buffer.BufferSubgraph.prototype.compareTo=function(o){var graph=o;if(this.rightMostCoord.x<graph.rightMostCoord.x){return-1;}
if(this.rightMostCoord.x>graph.rightMostCoord.x){return 1;}
return 0;};jsts.simplify.DPTransformer=function(distanceTolerance,isEnsureValidTopology){this.distanceTolerance=distanceTolerance;this.isEnsureValidTopology=isEnsureValidTopology;};jsts.simplify.DPTransformer.prototype=new jsts.geom.util.GeometryTransformer();jsts.simplify.DPTransformer.prototype.distanceTolerance=null;jsts.simplify.DPTransformer.prototype.isEnsureValidTopology=null;jsts.simplify.DPTransformer.prototype.transformCoordinates=function(coords,parent){var inputPts=coords;var newPts=null;if(inputPts.length==0){newPts=[];}else{newPts=jsts.simplify.DouglasPeuckerLineSimplifier.simplify(inputPts,this.distanceTolerance);}
return newPts;};jsts.simplify.DPTransformer.prototype.transformPolygon=function(geom,parent){if(geom.isEmpty()){return null;}
var rawGeom=jsts.geom.util.GeometryTransformer.prototype.transformPolygon.apply(this,arguments);if(parent instanceof jsts.geom.MultiPolygon){return rawGeom;}
return this.createValidArea(rawGeom);};jsts.simplify.DPTransformer.prototype.transformLinearRing=function(geom,parent){var removeDegenerateRings=parent instanceof jsts.geom.Polygon;var simpResult=jsts.geom.util.GeometryTransformer.prototype.transformLinearRing.apply(this,arguments);if(removeDegenerateRings&&!(simpResult instanceof jsts.geom.LinearRing)){return null;}
return simpResult;};jsts.simplify.DPTransformer.prototype.transformMultiPolygon=function(geom,parent){var rawGeom=jsts.geom.util.GeometryTransformer.prototype.transformMultiPolygon.apply(this,arguments);return this.createValidArea(rawGeom);};jsts.simplify.DPTransformer.prototype.createValidArea=function(rawAreaGeom){if(this.isEnsureValidTopology){return rawAreaGeom.buffer(0.0);}
return rawAreaGeom;};jsts.geom.util.GeometryExtracter=function(clz,comps){this.clz=clz;this.comps=comps;};jsts.geom.util.GeometryExtracter.prototype=new jsts.geom.GeometryFilter();jsts.geom.util.GeometryExtracter.prototype.clz=null;jsts.geom.util.GeometryExtracter.prototype.comps=null;jsts.geom.util.GeometryExtracter.extract=function(geom,clz,list){list=list||new javascript.util.ArrayList();if(geom instanceof clz){list.add(geom);}
else if(geom instanceof jsts.geom.GeometryCollection||geom instanceof jsts.geom.MultiPoint||geom instanceof jsts.geom.MultiLineString||geom instanceof jsts.geom.MultiPolygon){geom.apply(new jsts.geom.util.GeometryExtracter(clz,list));}
return list;};jsts.geom.util.GeometryExtracter.prototype.filter=function(geom){if(this.clz===null||geom instanceof this.clz){this.comps.add(geom);}};(function(){var OverlayOp=jsts.operation.overlay.OverlayOp;var SnapOverlayOp=jsts.operation.overlay.snap.SnapOverlayOp;var SnapIfNeededOverlayOp=function(g1,g2){this.geom=[];this.geom[0]=g1;this.geom[1]=g2;};SnapIfNeededOverlayOp.overlayOp=function(g0,g1,opCode){var op=new SnapIfNeededOverlayOp(g0,g1);return op.getResultGeometry(opCode);};SnapIfNeededOverlayOp.intersection=function(g0,g1){return overlayOp(g0,g1,OverlayOp.INTERSECTION);};SnapIfNeededOverlayOp.union=function(g0,g1){return overlayOp(g0,g1,OverlayOp.UNION);};SnapIfNeededOverlayOp.difference=function(g0,g1){return overlayOp(g0,g1,OverlayOp.DIFFERENCE);};SnapIfNeededOverlayOp.symDifference=function(g0,g1){return overlayOp(g0,g1,OverlayOp.SYMDIFFERENCE);};SnapIfNeededOverlayOp.prototype.geom=null;SnapIfNeededOverlayOp.prototype.getResultGeometry=function(opCode){var result=null;var isSuccess=false;var savedException=null;try{result=OverlayOp.overlayOp(this.geom[0],this.geom[1],opCode);var isValid=true;if(isValid)
isSuccess=true;}catch(ex){savedException=ex;}
if(!isSuccess){try{result=SnapOverlayOp.overlayOp(this.geom[0],this.geom[1],opCode);}catch(ex){throw savedException;}}
return result;};jsts.operation.overlay.snap.SnapIfNeededOverlayOp=SnapIfNeededOverlayOp;})();(function(){var GeometryExtracter=jsts.geom.util.GeometryExtracter;var CascadedPolygonUnion=jsts.operation.union.CascadedPolygonUnion;var PointGeometryUnion=jsts.operation.union.PointGeometryUnion;var OverlayOp=jsts.operation.overlay.OverlayOp;var SnapIfNeededOverlayOp=jsts.operation.overlay.snap.SnapIfNeededOverlayOp;var ArrayList=javascript.util.ArrayList;jsts.operation.union.UnaryUnionOp=function(geoms,geomFact){this.polygons=new ArrayList();this.lines=new ArrayList();this.points=new ArrayList();if(geomFact){this.geomFact=geomFact;}
this.extract(geoms);};jsts.operation.union.UnaryUnionOp.union=function(geoms,geomFact){var op=new jsts.operation.union.UnaryUnionOp(geoms,geomFact);return op.union();};jsts.operation.union.UnaryUnionOp.prototype.polygons=null;jsts.operation.union.UnaryUnionOp.prototype.lines=null;jsts.operation.union.UnaryUnionOp.prototype.points=null;jsts.operation.union.UnaryUnionOp.prototype.geomFact=null;jsts.operation.union.UnaryUnionOp.prototype.extract=function(geoms){if(geoms instanceof ArrayList){for(var i=geoms.iterator();i.hasNext();){var geom=i.next();this.extract(geom);}}else{if(this.geomFact===null){this.geomFact=geoms.getFactory();}
GeometryExtracter.extract(geoms,jsts.geom.Polygon,this.polygons);GeometryExtracter.extract(geoms,jsts.geom.LineString,this.lines);GeometryExtracter.extract(geoms,jsts.geom.Point,this.points);}};jsts.operation.union.UnaryUnionOp.prototype.union=function(){if(this.geomFact===null){return null;}
var unionPoints=null;if(this.points.size()>0){var ptGeom=this.geomFact.buildGeometry(this.points);unionPoints=this.unionNoOpt(ptGeom);}
var unionLines=null;if(this.lines.size()>0){var lineGeom=this.geomFact.buildGeometry(this.lines);unionLines=this.unionNoOpt(lineGeom);}
var unionPolygons=null;if(this.polygons.size()>0){unionPolygons=CascadedPolygonUnion.union(this.polygons);}
var unionLA=this.unionWithNull(unionLines,unionPolygons);var union=null;if(unionPoints===null){union=unionLA;}else if(unionLA===null){union=unionPoints;}else{union=PointGeometryUnion(unionPoints,unionLA);}
if(union===null){return this.geomFact.createGeometryCollection(null);}
return union;};jsts.operation.union.UnaryUnionOp.prototype.unionWithNull=function(g0,g1){if(g0===null&&g1===null){return null;}
if(g1===null){return g0;}
if(g0===null){return g1;}
return g0.union(g1);};jsts.operation.union.UnaryUnionOp.prototype.unionNoOpt=function(g0){var empty=this.geomFact.createPoint(null);return SnapIfNeededOverlayOp.overlayOp(g0,empty,OverlayOp.UNION);};}());jsts.index.kdtree.KdNode=function(){this.left=null;this.right=null;this.count=1;if(arguments.length===2){this.initializeFromCoordinate.apply(this,arguments[0],arguments[1]);}else if(arguments.length===3){this.initializeFromXY.apply(this,arguments[0],arguments[1],arguments[2]);}};jsts.index.kdtree.KdNode.prototype.initializeFromXY=function(x,y,data){this.p=new jsts.geom.Coordinate(x,y);this.data=data;};jsts.index.kdtree.KdNode.prototype.initializeFromCoordinate=function(p,data){this.p=p;this.data=data;};jsts.index.kdtree.KdNode.prototype.getX=function(){return this.p.x;};jsts.index.kdtree.KdNode.prototype.getY=function(){return this.p.y;};jsts.index.kdtree.KdNode.prototype.getCoordinate=function(){return this.p;};jsts.index.kdtree.KdNode.prototype.getData=function(){return this.data;};jsts.index.kdtree.KdNode.prototype.getLeft=function(){return this.left;};jsts.index.kdtree.KdNode.prototype.getRight=function(){return this.right;};jsts.index.kdtree.KdNode.prototype.increment=function(){this.count+=1;};jsts.index.kdtree.KdNode.prototype.getCount=function(){return this.count;};jsts.index.kdtree.KdNode.prototype.isRepeated=function(){return count>1;};jsts.index.kdtree.KdNode.prototype.setLeft=function(left){this.left=left;};jsts.index.kdtree.KdNode.prototype.setRight=function(right){this.right=right;};jsts.algorithm.InteriorPointPoint=function(geometry){this.minDistance=Number.MAX_VALUE;this.interiorPoint=null;this.centroid=geometry.getCentroid().getCoordinate();this.add(geometry);};jsts.algorithm.InteriorPointPoint.prototype.add=function(geometry){if(geometry instanceof jsts.geom.Point){this.addPoint(geometry.getCoordinate());}else if(geometry instanceof jsts.geom.GeometryCollection){for(var i=0;i<geometry.getNumGeometries();i++){this.add(geometry.getGeometryN(i));}}};jsts.algorithm.InteriorPointPoint.prototype.addPoint=function(point){var dist=point.distance(this.centroid);if(dist<this.minDistance){this.interiorPoint=new jsts.geom.Coordinate(point);this.minDistance=dist;}};jsts.algorithm.InteriorPointPoint.prototype.getInteriorPoint=function(){return this.interiorPoint;};(function(){jsts.geom.MultiLineString=function(geometries,factory){this.geometries=geometries||[];this.factory=factory;};jsts.geom.MultiLineString.prototype=new jsts.geom.GeometryCollection();jsts.geom.MultiLineString.constructor=jsts.geom.MultiLineString;jsts.geom.MultiLineString.prototype.getBoundary=function(){return(new jsts.operation.BoundaryOp(this)).getBoundary();};jsts.geom.MultiLineString.prototype.equalsExact=function(other,tolerance){if(!this.isEquivalentClass(other)){return false;}
return jsts.geom.GeometryCollection.prototype.equalsExact.call(this,other,tolerance);};jsts.geom.MultiLineString.prototype.CLASS_NAME='jsts.geom.MultiLineString';})();(function(){var Interval=jsts.index.bintree.Interval;var Root=jsts.index.bintree.Root;var Bintree=function(){this.root=new Root();this.minExtent=1.0;};Bintree.ensureExtent=function(itemInterval,minExtent){var min,max;min=itemInterval.getMin();max=itemInterval.getMax();if(min!==max){return itemInterval;}
if(min===max){min=min-(minExtent/2.0);max=min+(minExtent/2.0);}
return new Interval(min,max);};Bintree.prototype.depth=function(){if(this.root!==null){return this.root.depth();}
return 0;};Bintree.prototype.size=function(){if(this.root!==null){return this.root.size();}
return 0;};Bintree.prototype.nodeSize=function(){if(this.root!==null){return this.root.nodeSize();}
return 0;};Bintree.prototype.insert=function(itemInterval,item){this.collectStats(itemInterval);var insertInterval=Bintree.ensureExtent(itemInterval,this.minExtent);this.root.insert(insertInterval,item);};Bintree.prototype.remove=function(itemInterval,item){var insertInterval=Bintree.ensureExtent(itemInterval,this.minExtent);return this.root.remove(insertInterval,item);};Bintree.prototype.iterator=function(){var foundItems=new javascript.util.ArrayList();this.root.addAllItems(foundItems);return foundItems.iterator();};Bintree.prototype.query=function(){if(arguments.length===2){this.queryAndAdd(arguments[0],arguments[1]);}else{var x=arguments[0];if(!x instanceof Interval){x=new Interval(x,x);}
return this.queryInterval(x);}};Bintree.prototype.queryInterval=function(interval){var foundItems=new javascript.util.ArrayList();this.query(interval,foundItems);return foundItems;};Bintree.prototype.queryAndAdd=function(interval,foundItems){this.root.addAllItemsFromOverlapping(interval,foundItems);};Bintree.prototype.collectStats=function(interval){var del=interval.getWidth();if(del<this.minExtent&&del>0.0){this.minExtent=del;}};jsts.index.bintree.Bintree=Bintree;})();jsts.algorithm.InteriorPointArea=function(geometry){this.factory;this.interiorPoint=null;this.maxWidth=0;this.factory=geometry.getFactory();this.add(geometry);};jsts.algorithm.InteriorPointArea.avg=function(a,b){return(a+b)/2;};jsts.algorithm.InteriorPointArea.prototype.getInteriorPoint=function(){return this.interiorPoint;};jsts.algorithm.InteriorPointArea.prototype.add=function(geometry){if(geometry instanceof jsts.geom.Polygon){this.addPolygon(geometry);}else if(geometry instanceof jsts.geom.GeometryCollection){for(var i=0;i<geometry.getNumGeometries();i++){this.add(geometry.getGeometryN(i));}}};jsts.algorithm.InteriorPointArea.prototype.addPolygon=function(geometry){if(geometry.isEmpty()){return;}
var intPt;var width=0;var bisector=this.horizontalBisector(geometry);if(bisector.getLength()==0.0){width=0;intPt=bisector.getCoordinate();}else{var intersections=bisector.intersection(geometry);var widestIntersection=this.widestGeometry(intersections);width=widestIntersection.getEnvelopeInternal().getWidth();intPt=this.centre(widestIntersection.getEnvelopeInternal());}
if(this.interiorPoint==null||width>this.maxWidth){this.interiorPoint=intPt;this.maxWidth=width;}};jsts.algorithm.InteriorPointArea.prototype.widestGeometry=function(obj){if(obj instanceof jsts.geom.GeometryCollection){var gc=obj;if(gc.isEmpty()){return gc;}
var widestGeometry=gc.getGeometryN(0);for(var i=1;i<gc.getNumGeometries();i++){if(gc.getGeometryN(i).getEnvelopeInternal().getWidth()>widestGeometry.getEnvelopeInternal().getWidth()){widestGeometry=gc.getGeometryN(i);}}
return widestGeometry;}else if(obj instanceof jsts.geom.Geometry){return obj;}};jsts.algorithm.InteriorPointArea.prototype.horizontalBisector=function(geometry){var envelope=geometry.getEnvelopeInternal();var bisectY=jsts.algorithm.SafeBisectorFinder.getBisectorY(geometry);return this.factory.createLineString([new jsts.geom.Coordinate(envelope.getMinX(),bisectY),new jsts.geom.Coordinate(envelope.getMaxX(),bisectY)]);};jsts.algorithm.InteriorPointArea.prototype.centre=function(envelope){return new jsts.geom.Coordinate(jsts.algorithm.InteriorPointArea.avg(envelope.getMinX(),envelope.getMaxX()),jsts.algorithm.InteriorPointArea.avg(envelope.getMinY(),envelope.getMaxY()));};jsts.algorithm.SafeBisectorFinder=function(poly){this.poly;this.centreY;this.hiY=Number.MAX_VALUE;this.loY=-Number.MAX_VALUE;this.poly=poly;this.hiY=poly.getEnvelopeInternal().getMaxY();this.loY=poly.getEnvelopeInternal().getMinY();this.centreY=jsts.algorithm.InteriorPointArea.avg(this.loY,this.hiY);};jsts.algorithm.SafeBisectorFinder.getBisectorY=function(poly){var finder=new jsts.algorithm.SafeBisectorFinder(poly);return finder.getBisectorY();};jsts.algorithm.SafeBisectorFinder.prototype.getBisectorY=function(){this.process(this.poly.getExteriorRing());for(var i=0;i<this.poly.getNumInteriorRing();i++){this.process(this.poly.getInteriorRingN(i));}
var bisectY=jsts.algorithm.InteriorPointArea.avg(this.hiY,this.loY);return bisectY;};jsts.algorithm.SafeBisectorFinder.prototype.process=function(line){var seq=line.getCoordinateSequence();for(var i=0;i<seq.length;i++){var y=seq[i].y;this.updateInterval(y);}};jsts.algorithm.SafeBisectorFinder.prototype.updateInterval=function(y){if(y<=this.centreY){if(y>this.loY){this.loY=y;}}else if(y>this.centreY){if(y<this.hiY){this.hiY=y;}}};jsts.operation.buffer.BufferParameters=function(quadrantSegments,endCapStyle,joinStyle,mitreLimit){if(quadrantSegments)
this.setQuadrantSegments(quadrantSegments);if(endCapStyle)
this.setEndCapStyle(endCapStyle);if(joinStyle)
this.setJoinStyle(joinStyle);if(mitreLimit)
this.setMitreLimit(mitreLimit);};jsts.operation.buffer.BufferParameters.CAP_ROUND=1;jsts.operation.buffer.BufferParameters.CAP_FLAT=2;jsts.operation.buffer.BufferParameters.CAP_SQUARE=3;jsts.operation.buffer.BufferParameters.JOIN_ROUND=1;jsts.operation.buffer.BufferParameters.JOIN_MITRE=2;jsts.operation.buffer.BufferParameters.JOIN_BEVEL=3;jsts.operation.buffer.BufferParameters.DEFAULT_QUADRANT_SEGMENTS=8;jsts.operation.buffer.BufferParameters.DEFAULT_MITRE_LIMIT=5.0;jsts.operation.buffer.BufferParameters.prototype.quadrantSegments=jsts.operation.buffer.BufferParameters.DEFAULT_QUADRANT_SEGMENTS;jsts.operation.buffer.BufferParameters.prototype.endCapStyle=jsts.operation.buffer.BufferParameters.CAP_ROUND;jsts.operation.buffer.BufferParameters.prototype.joinStyle=jsts.operation.buffer.BufferParameters.JOIN_ROUND;jsts.operation.buffer.BufferParameters.prototype.mitreLimit=jsts.operation.buffer.BufferParameters.DEFAULT_MITRE_LIMIT;jsts.operation.buffer.BufferParameters.prototype._isSingleSided=false;jsts.operation.buffer.BufferParameters.prototype.getQuadrantSegments=function(){return this.quadrantSegments;};jsts.operation.buffer.BufferParameters.prototype.setQuadrantSegments=function(quadrantSegments){this.quadrantSegments=quadrantSegments;};jsts.operation.buffer.BufferParameters.prototype.setQuadrantSegments=function(quadSegs){this.quadrantSegments=quadSegs;if(this.quadrantSegments===0)
this.joinStyle=jsts.operation.buffer.BufferParameters.JOIN_BEVEL;if(this.quadrantSegments<0){this.joinStyle=jsts.operation.buffer.BufferParameters.JOIN_MITRE;this.mitreLimit=Math.abs(this.quadrantSegments);}
if(quadSegs<=0){this.quadrantSegments=1;}
if(this.joinStyle!==jsts.operation.buffer.BufferParameters.JOIN_ROUND){this.quadrantSegments=jsts.operation.buffer.BufferParameters.DEFAULT_QUADRANT_SEGMENTS;}};jsts.operation.buffer.BufferParameters.bufferDistanceError=function(quadSegs){var alpha=Math.PI/2.0/quadSegs;return 1-Math.cos(alpha/2.0);};jsts.operation.buffer.BufferParameters.prototype.getEndCapStyle=function(){return this.endCapStyle;};jsts.operation.buffer.BufferParameters.prototype.setEndCapStyle=function(endCapStyle){this.endCapStyle=endCapStyle;};jsts.operation.buffer.BufferParameters.prototype.getJoinStyle=function(){return this.joinStyle;};jsts.operation.buffer.BufferParameters.prototype.setJoinStyle=function(joinStyle){this.joinStyle=joinStyle;};jsts.operation.buffer.BufferParameters.prototype.getMitreLimit=function(){return this.mitreLimit;};jsts.operation.buffer.BufferParameters.prototype.setMitreLimit=function(mitreLimit){this.mitreLimit=mitreLimit;};jsts.operation.buffer.BufferParameters.prototype.setSingleSided=function(isSingleSided){this._isSingleSided=isSingleSided;};jsts.operation.buffer.BufferParameters.prototype.isSingleSided=function(){return this._isSingleSided;};(function(){jsts.geom.util.ShortCircuitedGeometryVisitor=function(){};jsts.geom.util.ShortCircuitedGeometryVisitor.prototype.isDone=false;jsts.geom.util.ShortCircuitedGeometryVisitor.prototype.applyTo=function(geom){for(var i=0;i<geom.getNumGeometries()&&!this.isDone;i++){var element=geom.getGeometryN(i);if(!(element instanceof jsts.geom.GeometryCollection)){this.visit(element);if(this.isDone()){this.isDone=true;return;}}
else
this.applyTo(element);}}
jsts.geom.util.ShortCircuitedGeometryVisitor.prototype.visit=function(element){};jsts.geom.util.ShortCircuitedGeometryVisitor.prototype.isDone=function(){};})();(function(){var EnvelopeIntersectsVisitor=function(rectEnv){this.rectEnv=rectEnv;};EnvelopeIntersectsVisitor.prototype=new jsts.geom.util.ShortCircuitedGeometryVisitor();EnvelopeIntersectsVisitor.constructor=EnvelopeIntersectsVisitor;EnvelopeIntersectsVisitor.prototype.rectEnv=null;EnvelopeIntersectsVisitor.prototype.intersects=false;EnvelopeIntersectsVisitor.prototype.intersects=function(){return this.intersects;}
EnvelopeIntersectsVisitor.prototype.visit=function(element){var elementEnv=element.getEnvelopeInternal();if(!this.rectEnv.intersects(elementEnv)){return;}
if(this.rectEnv.contains(elementEnv)){this.intersects=true;return;}
if(elementEnv.getMinX()>=rectEnv.getMinX()&&elementEnv.getMaxX()<=rectEnv.getMaxX()){this.intersects=true;return;}
if(elementEnv.getMinY()>=rectEnv.getMinY()&&elementEnv.getMaxY()<=rectEnv.getMaxY()){this.intersects=true;return;}}
EnvelopeIntersectsVisitor.prototype.isDone=function(){return this.intersects==true;}
var GeometryContainsPointVisitor=function(rectangle){this.rectSeq=rectangle.getExteriorRing().getCoordinateSequence();this.rectEnv=rectangle.getEnvelopeInternal();};GeometryContainsPointVisitor.prototype=new jsts.geom.util.ShortCircuitedGeometryVisitor();GeometryContainsPointVisitor.constructor=GeometryContainsPointVisitor;GeometryContainsPointVisitor.prototype.rectSeq=null;GeometryContainsPointVisitor.prototype.rectEnv=null;GeometryContainsPointVisitor.prototype.containsPoint=false;GeometryContainsPointVisitor.prototype.containsPoint=function(){return this.containsPoint;}
GeometryContainsPointVisitor.prototype.visit=function(geom){if(!(geom instanceof jsts.geom.Polygon))
return;var elementEnv=geom.getEnvelopeInternal();if(!this.rectEnv.intersects(elementEnv))
return;var rectPt=new jsts.geom.Coordinate();for(var i=0;i<4;i++){this.rectSeq.getCoordinate(i,rectPt);if(!elementEnv.contains(rectPt))
continue;if(SimplePointInAreaLocator.containsPointInPolygon(rectPt,geom)){this.containsPoint=true;return;}}}
GeometryContainsPointVisitor.prototype.isDone=function(){return this.containsPoint==true;}
var RectangleIntersectsSegmentVisitor=function(rectangle){this.rectEnv=rectangle.getEnvelopeInternal();this.rectIntersector=new RectangleLineIntersector(rectEnv);};RectangleIntersectsSegmentVisitor.prototype=new jsts.geom.util.ShortCircuitedGeometryVisitor();RectangleIntersectsSegmentVisitor.constructor=RectangleIntersectsSegmentVisitor;RectangleIntersectsSegmentVisitor.prototype.rectEnv=null;RectangleIntersectsSegmentVisitor.prototype.rectIntersector=null;RectangleIntersectsSegmentVisitor.prototype.hasIntersection=false;RectangleIntersectsSegmentVisitor.prototype.p0=null;RectangleIntersectsSegmentVisitor.prototype.p1=null;RectangleIntersectsSegmentVisitor.prototype.intersects=function(){return this.hasIntersection;}
RectangleIntersectsSegmentVisitor.prototype.visit=function(geom){var elementEnv=geom.getEnvelopeInternal();if(!this.rectEnv.intersects(elementEnv))
return;var lines=LinearComponentExtracter.getLines(geom);this.checkIntersectionWithLineStrings(lines);}
RectangleIntersectsSegmentVisitor.prototype.checkIntersectionWithLineStrings=function(lines){for(var i=lines.iterator();i.hasNext();){var testLine=i.next();this.checkIntersectionWithSegments(testLine);if(this.hasIntersection)
return;}}
RectangleIntersectsSegmentVisitor.prototype.checkIntersectionWithSegments=function(testLine){var seq1=testLine.getCoordinateSequence();for(var j=1;j<seq1.length;j++){this.p0=seq1[j-1];this.p1=seq1[j];if(rectIntersector.intersects(p0,p1)){this.hasIntersection=true;return;}}}
RectangleIntersectsSegmentVisitor.prototype.isDone=function(){return this.hasIntersection==true;}
jsts.operation.predicate.RectangleIntersects=function(rectangle){this.rectangle=rectangle;this.rectEnv=rectangle.getEnvelopeInternal();}
jsts.operation.predicate.RectangleIntersects.intersects=function(rectangle,b){var rp=new jsts.operation.predicate.RectangleIntersects(rectangle);return rp.intersects(b);}
jsts.operation.predicate.RectangleIntersects.prototype.rectangle=null;jsts.operation.predicate.RectangleIntersects.prototype.rectEnv=null;jsts.operation.predicate.RectangleIntersects.prototype.intersects=function(geom){if(!this.rectEnv.intersects(geom.getEnvelopeInternal()))
return false;var visitor=new EnvelopeIntersectsVisitor(this.rectEnv);visitor.applyTo(geom);if(visitor.intersects())
return true;var ecpVisitor=new GeometryContainsPointVisitor(rectangle);ecpVisitor.applyTo(geom);if(ecpVisitor.containsPoint())
return true;var riVisitor=new RectangleIntersectsSegmentVisitor(rectangle);riVisitor.applyTo(geom);if(riVisitor.intersects())
return true;return false;}})();jsts.operation.buffer.BufferBuilder=function(bufParams){this.bufParams=bufParams;this.edgeList=new jsts.geomgraph.EdgeList();};jsts.operation.buffer.BufferBuilder.depthDelta=function(label){var lLoc=label.getLocation(0,jsts.geomgraph.Position.LEFT);var rLoc=label.getLocation(0,jsts.geomgraph.Position.RIGHT);if(lLoc===jsts.geom.Location.INTERIOR&&rLoc===jsts.geom.Location.EXTERIOR)
return 1;else if(lLoc===jsts.geom.Location.EXTERIOR&&rLoc===jsts.geom.Location.INTERIOR)
return-1;return 0;};jsts.operation.buffer.BufferBuilder.prototype.bufParams=null;jsts.operation.buffer.BufferBuilder.prototype.workingPrecisionModel=null;jsts.operation.buffer.BufferBuilder.prototype.workingNoder=null;jsts.operation.buffer.BufferBuilder.prototype.geomFact=null;jsts.operation.buffer.BufferBuilder.prototype.graph=null;jsts.operation.buffer.BufferBuilder.prototype.edgeList=null;jsts.operation.buffer.BufferBuilder.prototype.setWorkingPrecisionModel=function(pm){this.workingPrecisionModel=pm;};jsts.operation.buffer.BufferBuilder.prototype.setNoder=function(noder){this.workingNoder=noder;};jsts.operation.buffer.BufferBuilder.prototype.buffer=function(g,distance){var precisionModel=this.workingPrecisionModel;if(precisionModel===null)
precisionModel=g.getPrecisionModel();this.geomFact=g.getFactory();var curveBuilder=new jsts.operation.buffer.OffsetCurveBuilder(precisionModel,this.bufParams);var curveSetBuilder=new jsts.operation.buffer.OffsetCurveSetBuilder(g,distance,curveBuilder);var bufferSegStrList=curveSetBuilder.getCurves();if(bufferSegStrList.size()<=0){return this.createEmptyResultGeometry();}
this.computeNodedEdges(bufferSegStrList,precisionModel);this.graph=new jsts.geomgraph.PlanarGraph(new jsts.operation.overlay.OverlayNodeFactory());this.graph.addEdges(this.edgeList.getEdges());var subgraphList=this.createSubgraphs(this.graph);var polyBuilder=new jsts.operation.overlay.PolygonBuilder(this.geomFact);this.buildSubgraphs(subgraphList,polyBuilder);var resultPolyList=polyBuilder.getPolygons();if(resultPolyList.size()<=0){return this.createEmptyResultGeometry();}
var resultGeom=this.geomFact.buildGeometry(resultPolyList);return resultGeom;};jsts.operation.buffer.BufferBuilder.prototype.getNoder=function(precisionModel){if(this.workingNoder!==null)
return this.workingNoder;var noder=new jsts.noding.MCIndexNoder();var li=new jsts.algorithm.RobustLineIntersector();li.setPrecisionModel(precisionModel);noder.setSegmentIntersector(new jsts.noding.IntersectionAdder(li));return noder;};jsts.operation.buffer.BufferBuilder.prototype.computeNodedEdges=function(bufferSegStrList,precisionModel){var noder=this.getNoder(precisionModel);noder.computeNodes(bufferSegStrList);var nodedSegStrings=noder.getNodedSubstrings();for(var i=nodedSegStrings.iterator();i.hasNext();){var segStr=i.next();var oldLabel=segStr.getData();var edge=new jsts.geomgraph.Edge(segStr.getCoordinates(),new jsts.geomgraph.Label(oldLabel));this.insertUniqueEdge(edge);}};jsts.operation.buffer.BufferBuilder.prototype.insertUniqueEdge=function(e){var existingEdge=this.edgeList.findEqualEdge(e);if(existingEdge!=null){var existingLabel=existingEdge.getLabel();var labelToMerge=e.getLabel();if(!existingEdge.isPointwiseEqual(e)){labelToMerge=new jsts.geomgraph.Label(e.getLabel());labelToMerge.flip();}
existingLabel.merge(labelToMerge);var mergeDelta=jsts.operation.buffer.BufferBuilder.depthDelta(labelToMerge);var existingDelta=existingEdge.getDepthDelta();var newDelta=existingDelta+mergeDelta;existingEdge.setDepthDelta(newDelta);}else{this.edgeList.add(e);e.setDepthDelta(jsts.operation.buffer.BufferBuilder.depthDelta(e.getLabel()));}};jsts.operation.buffer.BufferBuilder.prototype.createSubgraphs=function(graph){var subgraphList=[];for(var i=graph.getNodes().iterator();i.hasNext();){var node=i.next();if(!node.isVisited()){var subgraph=new jsts.operation.buffer.BufferSubgraph();subgraph.create(node);subgraphList.push(subgraph);}}
var compare=function(a,b){return a.compareTo(b);};subgraphList.sort(compare);subgraphList.reverse();return subgraphList;};jsts.operation.buffer.BufferBuilder.prototype.buildSubgraphs=function(subgraphList,polyBuilder){var processedGraphs=[];for(var i=0;i<subgraphList.length;i++){var subgraph=subgraphList[i];var p=subgraph.getRightmostCoordinate();var locater=new jsts.operation.buffer.SubgraphDepthLocater(processedGraphs);var outsideDepth=locater.getDepth(p);subgraph.computeDepth(outsideDepth);subgraph.findResultEdges();processedGraphs.push(subgraph);polyBuilder.add(subgraph.getDirectedEdges(),subgraph.getNodes());}};jsts.operation.buffer.BufferBuilder.convertSegStrings=function(it){var fact=new jsts.geom.GeometryFactory();var lines=new javascript.util.ArrayList();while(it.hasNext()){var ss=it.next();var line=fact.createLineString(ss.getCoordinates());lines.add(line);}
return fact.buildGeometry(lines);};jsts.operation.buffer.BufferBuilder.prototype.createEmptyResultGeometry=function(){var emptyGeom=this.geomFact.createPolygon(null,null);return emptyGeom;};jsts.noding.SegmentPointComparator=function(){};jsts.noding.SegmentPointComparator.compare=function(octant,p0,p1){if(p0.equals2D(p1))
return 0;var xSign=jsts.noding.SegmentPointComparator.relativeSign(p0.x,p1.x);var ySign=jsts.noding.SegmentPointComparator.relativeSign(p0.y,p1.y);switch(octant){case 0:return jsts.noding.SegmentPointComparator.compareValue(xSign,ySign);case 1:return jsts.noding.SegmentPointComparator.compareValue(ySign,xSign);case 2:return jsts.noding.SegmentPointComparator.compareValue(ySign,-xSign);case 3:return jsts.noding.SegmentPointComparator.compareValue(-xSign,ySign);case 4:return jsts.noding.SegmentPointComparator.compareValue(-xSign,-ySign);case 5:return jsts.noding.SegmentPointComparator.compareValue(-ySign,-xSign);case 6:return jsts.noding.SegmentPointComparator.compareValue(-ySign,xSign);case 7:return jsts.noding.SegmentPointComparator.compareValue(xSign,-ySign);}
return 0;};jsts.noding.SegmentPointComparator.relativeSign=function(x0,x1){if(x0<x1)
return-1;if(x0>x1)
return 1;return 0;};jsts.noding.SegmentPointComparator.compareValue=function(compareSign0,compareSign1){if(compareSign0<0)
return-1;if(compareSign0>0)
return 1;if(compareSign1<0)
return-1;if(compareSign1>0)
return 1;return 0;};jsts.operation.relate.RelateOp=function(){jsts.operation.GeometryGraphOperation.apply(this,arguments);this._relate=new jsts.operation.relate.RelateComputer(this.arg);};jsts.operation.relate.RelateOp.prototype=new jsts.operation.GeometryGraphOperation();jsts.operation.relate.RelateOp.relate=function(a,b,boundaryNodeRule){var relOp=new jsts.operation.relate.RelateOp(a,b,boundaryNodeRule);var im=relOp.getIntersectionMatrix();return im;};jsts.operation.relate.RelateOp.prototype._relate=null;jsts.operation.relate.RelateOp.prototype.getIntersectionMatrix=function(){return this._relate.computeIM();};jsts.index.chain.MonotoneChain=function(pts,start,end,context){this.pts=pts;this.start=start;this.end=end;this.context=context;};jsts.index.chain.MonotoneChain.prototype.pts=null;jsts.index.chain.MonotoneChain.prototype.start=null;jsts.index.chain.MonotoneChain.prototype.end=null;jsts.index.chain.MonotoneChain.prototype.env=null;jsts.index.chain.MonotoneChain.prototype.context=null;jsts.index.chain.MonotoneChain.prototype.id=null;jsts.index.chain.MonotoneChain.prototype.setId=function(id){this.id=id;};jsts.index.chain.MonotoneChain.prototype.getId=function(){return this.id;};jsts.index.chain.MonotoneChain.prototype.getContext=function(){return this.context;};jsts.index.chain.MonotoneChain.prototype.getEnvelope=function(){if(this.env==null){var p0=this.pts[this.start];var p1=this.pts[this.end];this.env=new jsts.geom.Envelope(p0,p1);}
return this.env;};jsts.index.chain.MonotoneChain.prototype.getStartIndex=function(){return this.start;};jsts.index.chain.MonotoneChain.prototype.getEndIndex=function(){return this.end;};jsts.index.chain.MonotoneChain.prototype.getLineSegment=function(index,ls){ls.p0=this.pts[index];ls.p1=this.pts[index+1];};jsts.index.chain.MonotoneChain.prototype.getCoordinates=function(){var coord=[];var index=0;for(var i=this.start;i<=this.end;i++){coord[index++]=this.pts[i];}
return coord;};jsts.index.chain.MonotoneChain.prototype.select=function(searchEnv,mcs){this.computeSelect2(searchEnv,this.start,this.end,mcs);};jsts.index.chain.MonotoneChain.prototype.computeSelect2=function(searchEnv,start0,end0,mcs){var p0=this.pts[start0];var p1=this.pts[end0];mcs.tempEnv1.init(p0,p1);if(end0-start0===1){mcs.select(this,start0);return;}
if(!searchEnv.intersects(mcs.tempEnv1))
return;var mid=parseInt((start0+end0)/2);if(start0<mid){this.computeSelect2(searchEnv,start0,mid,mcs);}
if(mid<end0){this.computeSelect2(searchEnv,mid,end0,mcs);}};jsts.index.chain.MonotoneChain.prototype.computeOverlaps=function(mc,mco){if(arguments.length===6){return this.computeOverlaps2.apply(this,arguments);}
this.computeOverlaps2(this.start,this.end,mc,mc.start,mc.end,mco);};jsts.index.chain.MonotoneChain.prototype.computeOverlaps2=function(start0,end0,mc,start1,end1,mco){var p00=this.pts[start0];var p01=this.pts[end0];var p10=mc.pts[start1];var p11=mc.pts[end1];if(end0-start0===1&&end1-start1===1){mco.overlap(this,start0,mc,start1);return;}
mco.tempEnv1.init(p00,p01);mco.tempEnv2.init(p10,p11);if(!mco.tempEnv1.intersects(mco.tempEnv2))
return;var mid0=parseInt((start0+end0)/2);var mid1=parseInt((start1+end1)/2);if(start0<mid0){if(start1<mid1)
this.computeOverlaps2(start0,mid0,mc,start1,mid1,mco);if(mid1<end1)
this.computeOverlaps2(start0,mid0,mc,mid1,end1,mco);}
if(mid0<end0){if(start1<mid1)
this.computeOverlaps2(mid0,end0,mc,start1,mid1,mco);if(mid1<end1)
this.computeOverlaps2(mid0,end0,mc,mid1,end1,mco);}};(function(){var Location=jsts.geom.Location;var Dimension=jsts.geom.Dimension;jsts.geom.IntersectionMatrix=function(elements){var other=elements;if(elements===undefined||elements===null){this.matrix=[[],[],[]];this.setAll(Dimension.FALSE);}else if(typeof elements==='string'){this.set(elements);}else if(other instanceof jsts.geom.IntersectionMatrix){this.matrix[Location.INTERIOR][Location.INTERIOR]=other.matrix[Location.INTERIOR][Location.INTERIOR];this.matrix[Location.INTERIOR][Location.BOUNDARY]=other.matrix[Location.INTERIOR][Location.BOUNDARY];this.matrix[Location.INTERIOR][Location.EXTERIOR]=other.matrix[Location.INTERIOR][Location.EXTERIOR];this.matrix[Location.BOUNDARY][Location.INTERIOR]=other.matrix[Location.BOUNDARY][Location.INTERIOR];this.matrix[Location.BOUNDARY][Location.BOUNDARY]=other.matrix[Location.BOUNDARY][Location.BOUNDARY];this.matrix[Location.BOUNDARY][Location.EXTERIOR]=other.matrix[Location.BOUNDARY][Location.EXTERIOR];this.matrix[Location.EXTERIOR][Location.INTERIOR]=other.matrix[Location.EXTERIOR][Location.INTERIOR];this.matrix[Location.EXTERIOR][Location.BOUNDARY]=other.matrix[Location.EXTERIOR][Location.BOUNDARY];this.matrix[Location.EXTERIOR][Location.EXTERIOR]=other.matrix[Location.EXTERIOR][Location.EXTERIOR];}};jsts.geom.IntersectionMatrix.prototype.matrix=null;jsts.geom.IntersectionMatrix.prototype.add=function(im){var i,j;for(i=0;i<3;i++){for(j=0;j<3;j++){this.setAtLeast(i,j,im.get(i,j));}}};jsts.geom.IntersectionMatrix.matches=function(actualDimensionValue,requiredDimensionSymbol){if(typeof actualDimensionValue==='string'){return jsts.geom.IntersectionMatrix.matches2.call(this,arguments);}
if(requiredDimensionSymbol==='*'){return true;}
if(requiredDimensionSymbol==='T'&&(actualDimensionValue>=0||actualDimensionValue===Dimension.TRUE)){return true;}
if(requiredDimensionSymbol==='F'&&actualDimensionValue===Dimension.FALSE){return true;}
if(requiredDimensionSymbol==='0'&&actualDimensionValue===Dimension.P){return true;}
if(requiredDimensionSymbol==='1'&&actualDimensionValue===Dimension.L){return true;}
if(requiredDimensionSymbol==='2'&&actualDimensionValue===Dimension.A){return true;}
return false;};jsts.geom.IntersectionMatrix.matches2=function(actualDimensionSymbols,requiredDimensionSymbols){var m=new jsts.geom.IntersectionMatrix(actualDimensionSymbols);return m.matches(requiredDimensionSymbols);};jsts.geom.IntersectionMatrix.prototype.set=function(row,column,dimensionValue){if(typeof row==='string'){this.set2(row);return;}
this.matrix[row][column]=dimensionValue;};jsts.geom.IntersectionMatrix.prototype.set2=function(dimensionSymbols){for(var i=0;i<dimensionSymbols.length();i++){var row=i/3;var col=i%3;this.matrix[row][col]=Dimension.toDimensionValue(dimensionSymbols.charAt(i));}};jsts.geom.IntersectionMatrix.prototype.setAtLeast=function(row,column,minimumDimensionValue){if(arguments.length===1){this.setAtLeast2(arguments[0]);return;}
if(this.matrix[row][column]<minimumDimensionValue){this.matrix[row][column]=minimumDimensionValue;}};jsts.geom.IntersectionMatrix.prototype.setAtLeastIfValid=function(row,column,minimumDimensionValue){if(row>=0&&column>=0){this.setAtLeast(row,column,minimumDimensionValue);}};jsts.geom.IntersectionMatrix.prototype.setAtLeast2=function(minimumDimensionSymbols){var i;for(i=0;i<minimumDimensionSymbols.length;i++){var row=parseInt(i/3);var col=parseInt(i%3);this.setAtLeast(row,col,jsts.geom.Dimension.toDimensionValue(minimumDimensionSymbols.charAt(i)));}};jsts.geom.IntersectionMatrix.prototype.setAll=function(dimensionValue){var ai,bi;for(ai=0;ai<3;ai++){for(bi=0;bi<3;bi++){this.matrix[ai][bi]=dimensionValue;}}};jsts.geom.IntersectionMatrix.prototype.get=function(row,column){return this.matrix[row][column];};jsts.geom.IntersectionMatrix.prototype.isDisjoint=function(){return this.matrix[Location.INTERIOR][Location.INTERIOR]===Dimension.FALSE&&this.matrix[Location.INTERIOR][Location.BOUNDARY]===Dimension.FALSE&&this.matrix[Location.BOUNDARY][Location.INTERIOR]===Dimension.FALSE&&this.matrix[Location.BOUNDARY][Location.BOUNDARY]===Dimension.FALSE;};jsts.geom.IntersectionMatrix.prototype.isIntersects=function(){return!this.isDisjoint();};jsts.geom.IntersectionMatrix.prototype.isTouches=function(dimensionOfGeometryA,dimensionOfGeometryB){if(dimensionOfGeometryA>dimensionOfGeometryB){return this.isTouches(dimensionOfGeometryB,dimensionOfGeometryA);}
if((dimensionOfGeometryA==Dimension.A&&dimensionOfGeometryB==Dimension.A)||(dimensionOfGeometryA==Dimension.L&&dimensionOfGeometryB==Dimension.L)||(dimensionOfGeometryA==Dimension.L&&dimensionOfGeometryB==Dimension.A)||(dimensionOfGeometryA==Dimension.P&&dimensionOfGeometryB==Dimension.A)||(dimensionOfGeometryA==Dimension.P&&dimensionOfGeometryB==Dimension.L)){return this.matrix[Location.INTERIOR][Location.INTERIOR]===Dimension.FALSE&&(jsts.geom.IntersectionMatrix.matches(this.matrix[Location.INTERIOR][Location.BOUNDARY],'T')||jsts.geom.IntersectionMatrix.matches(this.matrix[Location.BOUNDARY][Location.INTERIOR],'T')||jsts.geom.IntersectionMatrix.matches(this.matrix[Location.BOUNDARY][Location.BOUNDARY],'T'));}
return false;};jsts.geom.IntersectionMatrix.prototype.isCrosses=function(dimensionOfGeometryA,dimensionOfGeometryB){if((dimensionOfGeometryA==Dimension.P&&dimensionOfGeometryB==Dimension.L)||(dimensionOfGeometryA==Dimension.P&&dimensionOfGeometryB==Dimension.A)||(dimensionOfGeometryA==Dimension.L&&dimensionOfGeometryB==Dimension.A)){return jsts.geom.IntersectionMatrix.matches(this.matrix[Location.INTERIOR][Location.INTERIOR],'T')&&jsts.geom.IntersectionMatrix.matches(this.matrix[Location.INTERIOR][Location.EXTERIOR],'T');}
if((dimensionOfGeometryA==Dimension.L&&dimensionOfGeometryB==Dimension.P)||(dimensionOfGeometryA==Dimension.A&&dimensionOfGeometryB==Dimension.P)||(dimensionOfGeometryA==Dimension.A&&dimensionOfGeometryB==Dimension.L)){return jsts.geom.IntersectionMatrix.matches(matrix[Location.INTERIOR][Location.INTERIOR],'T')&&jsts.geom.IntersectionMatrix.matches(this.matrix[Location.EXTERIOR][Location.INTERIOR],'T');}
if(dimensionOfGeometryA===Dimension.L&&dimensionOfGeometryB===Dimension.L){return this.matrix[Location.INTERIOR][Location.INTERIOR]===0;}
return false;};jsts.geom.IntersectionMatrix.prototype.isWithin=function(){return jsts.geom.IntersectionMatrix.matches(this.matrix[Location.INTERIOR][Location.INTERIOR],'T')&&this.matrix[Location.INTERIOR][Location.EXTERIOR]==Dimension.FALSE&&this.matrix[Location.BOUNDARY][Location.EXTERIOR]==Dimension.FALSE;};jsts.geom.IntersectionMatrix.prototype.isContains=function(){return jsts.geom.IntersectionMatrix.matches(this.matrix[Location.INTERIOR][Location.INTERIOR],'T')&&this.matrix[Location.EXTERIOR][Location.INTERIOR]==Dimension.FALSE&&this.matrix[Location.EXTERIOR][Location.BOUNDARY]==Dimension.FALSE;};jsts.geom.IntersectionMatrix.prototype.isCovers=function(){var hasPointInCommon=jsts.geom.IntersectionMatrix.matches(this.matrix[Location.INTERIOR][Location.INTERIOR],'T')||jsts.geom.IntersectionMatrix.matches(this.matrix[Location.INTERIOR][Location.BOUNDARY],'T')||jsts.geom.IntersectionMatrix.matches(this.matrix[Location.BOUNDARY][Location.INTERIOR],'T')||jsts.geom.IntersectionMatrix.matches(this.matrix[Location.BOUNDARY][Location.BOUNDARY],'T');return hasPointInCommon&&this.matrix[Location.EXTERIOR][Location.INTERIOR]==Dimension.FALSE&&this.matrix[Location.EXTERIOR][Location.BOUNDARY]==Dimension.FALSE;};jsts.geom.IntersectionMatrix.prototype.isCoveredBy=function(){var hasPointInCommon=jsts.geom.IntersectionMatrix.matches(this.matrix[Location.INTERIOR][Location.INTERIOR],'T')||jsts.geom.IntersectionMatrix.matches(this.matrix[Location.INTERIOR][Location.BOUNDARY],'T')||jsts.geom.IntersectionMatrix.matches(this.matrix[Location.BOUNDARY][Location.INTERIOR],'T')||jsts.geom.IntersectionMatrix.matches(this.matrix[Location.BOUNDARY][Location.BOUNDARY],'T');return hasPointInCommon&&this.matrix[Location.INTERIOR][Location.EXTERIOR]===Dimension.FALSE&&this.matrix[Location.BOUNDARY][Location.EXTERIOR]===Dimension.FALSE;};jsts.geom.IntersectionMatrix.prototype.isEquals=function(dimensionOfGeometryA,dimensionOfGeometryB){if(dimensionOfGeometryA!==dimensionOfGeometryB){return false;}
return jsts.geom.IntersectionMatrix.matches(this.matrix[Location.INTERIOR][Location.INTERIOR],'T')&&this.matrix[Location.EXTERIOR][Location.INTERIOR]===Dimension.FALSE&&this.matrix[Location.INTERIOR][Location.EXTERIOR]===Dimension.FALSE&&this.matrix[Location.EXTERIOR][Location.BOUNDARY]===Dimension.FALSE&&this.matrix[Location.BOUNDARY][Location.EXTERIOR]===Dimension.FALSE;};jsts.geom.IntersectionMatrix.prototype.isOverlaps=function(dimensionOfGeometryA,dimensionOfGeometryB){if((dimensionOfGeometryA==Dimension.P&&dimensionOfGeometryB===Dimension.P)||(dimensionOfGeometryA==Dimension.A&&dimensionOfGeometryB===Dimension.A)){return jsts.geom.IntersectionMatrix.matches(this.matrix[Location.INTERIOR][Location.INTERIOR],'T')&&jsts.geom.IntersectionMatrix.matches(this.matrix[Location.INTERIOR][Location.EXTERIOR],'T')&&jsts.geom.IntersectionMatrix.matches(this.matrix[Location.EXTERIOR][Location.INTERIOR],'T');}
if(dimensionOfGeometryA===Dimension.L&&dimensionOfGeometryB===Dimension.L){return this.matrix[Location.INTERIOR][Location.INTERIOR]==1&&jsts.geom.IntersectionMatrix.matches(this.matrix[Location.INTERIOR][Location.EXTERIOR],'T')&&jsts.geom.IntersectionMatrix.matches(this.matrix[Location.EXTERIOR][Location.INTERIOR],'T');}
return false;};jsts.geom.IntersectionMatrix.prototype.matches=function(requiredDimensionSymbols){if(requiredDimensionSymbols.length!=9){throw new jsts.error.IllegalArgumentException('Should be length 9: '+
requiredDimensionSymbols);}
for(var ai=0;ai<3;ai++){for(var bi=0;bi<3;bi++){if(!jsts.geom.IntersectionMatrix.matches(this.matrix[ai][bi],requiredDimensionSymbols.charAt(3*ai+bi))){return false;}}}
return true;};jsts.geom.IntersectionMatrix.prototype.transpose=function(){var temp=matrix[1][0];this.matrix[1][0]=this.matrix[0][1];this.matrix[0][1]=temp;temp=this.matrix[2][0];this.matrix[2][0]=this.matrix[0][2];this.matrix[0][2]=temp;temp=this.matrix[2][1];this.matrix[2][1]=this.matrix[1][2];this.matrix[1][2]=temp;return this;};jsts.geom.IntersectionMatrix.prototype.toString=function(){var ai,bi,buf='';for(ai=0;ai<3;ai++){for(bi=0;bi<3;bi++){buf+=Dimension.toDimensionSymbol(this.matrix[ai][bi]);}}
return buf;};})();jsts.triangulate.quadedge.LastFoundQuadEdgeLocator=function(subdiv){this.subdiv=subdiv;this.lastEdge=null;this.init();};jsts.triangulate.quadedge.LastFoundQuadEdgeLocator.prototype.init=function(){this.lastEdge=this.findEdge();};jsts.triangulate.quadedge.LastFoundQuadEdgeLocator.prototype.findEdge=function(){var edges=this.subdiv.getEdges();return edges[0];};jsts.triangulate.quadedge.LastFoundQuadEdgeLocator.prototype.locate=function(v){if(!this.lastEdge.isLive()){this.init();}
var e=this.subdiv.locateFromEdge(v,this.lastEdge);this.lastEdge=e;return e;};jsts.noding.SegmentNodeList=function(edge){this.nodeMap=new javascript.util.TreeMap();this.edge=edge;};jsts.noding.SegmentNodeList.prototype.nodeMap=null;jsts.noding.SegmentNodeList.prototype.iterator=function(){return this.nodeMap.values().iterator();};jsts.noding.SegmentNodeList.prototype.edge=null;jsts.noding.SegmentNodeList.prototype.getEdge=function(){return this.edge;};jsts.noding.SegmentNodeList.prototype.add=function(intPt,segmentIndex){var eiNew=new jsts.noding.SegmentNode(this.edge,intPt,segmentIndex,this.edge.getSegmentOctant(segmentIndex));var ei=this.nodeMap.get(eiNew);if(ei!==null){jsts.util.Assert.isTrue(ei.coord.equals2D(intPt),'Found equal nodes with different coordinates');return ei;}
this.nodeMap.put(eiNew,eiNew);return eiNew;};jsts.noding.SegmentNodeList.prototype.addEndpoints=function(){var maxSegIndex=this.edge.size()-1;this.add(this.edge.getCoordinate(0),0);this.add(this.edge.getCoordinate(maxSegIndex),maxSegIndex);};jsts.noding.SegmentNodeList.prototype.addCollapsedNodes=function(){var collapsedVertexIndexes=[];this.findCollapsesFromInsertedNodes(collapsedVertexIndexes);this.findCollapsesFromExistingVertices(collapsedVertexIndexes);for(var i=0;i<collapsedVertexIndexes.length;i++){var vertexIndex=collapsedVertexIndexes[i];this.add(this.edge.getCoordinate(vertexIndex),vertexIndex);}};jsts.noding.SegmentNodeList.prototype.findCollapsesFromExistingVertices=function(collapsedVertexIndexes){for(var i=0;i<this.edge.size()-2;i++){var p0=this.edge.getCoordinate(i);var p1=this.edge.getCoordinate(i+1);var p2=this.edge.getCoordinate(i+2);if(p0.equals2D(p2)){collapsedVertexIndexes.push(i+1);}}};jsts.noding.SegmentNodeList.prototype.findCollapsesFromInsertedNodes=function(collapsedVertexIndexes){var collapsedVertexIndex=[null];var it=this.iterator();var eiPrev=it.next();while(it.hasNext()){var ei=it.next();var isCollapsed=this.findCollapseIndex(eiPrev,ei,collapsedVertexIndex);if(isCollapsed)
collapsedVertexIndexes.push(collapsedVertexIndex[0]);eiPrev=ei;}};jsts.noding.SegmentNodeList.prototype.findCollapseIndex=function(ei0,ei1,collapsedVertexIndex){if(!ei0.coord.equals2D(ei1.coord))
return false;var numVerticesBetween=ei1.segmentIndex-ei0.segmentIndex;if(!ei1.isInterior()){numVerticesBetween--;}
if(numVerticesBetween===1){collapsedVertexIndex[0]=ei0.segmentIndex+1;return true;}
return false;};jsts.noding.SegmentNodeList.prototype.addSplitEdges=function(edgeList){this.addEndpoints();this.addCollapsedNodes();var it=this.iterator();var eiPrev=it.next();while(it.hasNext()){var ei=it.next();var newEdge=this.createSplitEdge(eiPrev,ei);edgeList.add(newEdge);eiPrev=ei;}};jsts.noding.SegmentNodeList.prototype.checkSplitEdgesCorrectness=function(splitEdges){var edgePts=edge.getCoordinates();var split0=splitEdges[0];var pt0=split0.getCoordinate(0);if(!pt0.equals2D(edgePts[0]))
throw new Error('bad split edge start point at '+pt0);var splitn=splitEdges[splitEdges.length-1];var splitnPts=splitn.getCoordinates();var ptn=splitnPts[splitnPts.length-1];if(!ptn.equals2D(edgePts[edgePts.length-1]))
throw new Error('bad split edge end point at '+ptn);};jsts.noding.SegmentNodeList.prototype.createSplitEdge=function(ei0,ei1){var npts=ei1.segmentIndex-ei0.segmentIndex+2;var lastSegStartPt=this.edge.getCoordinate(ei1.segmentIndex);var useIntPt1=ei1.isInterior()||!ei1.coord.equals2D(lastSegStartPt);if(!useIntPt1){npts--;}
var pts=[];var ipt=0;pts[ipt++]=new jsts.geom.Coordinate(ei0.coord);for(var i=ei0.segmentIndex+1;i<=ei1.segmentIndex;i++){pts[ipt++]=this.edge.getCoordinate(i);}
if(useIntPt1)
pts[ipt]=ei1.coord;return new jsts.noding.NodedSegmentString(pts,this.edge.getData());};jsts.io.WKTWriter=function(){this.parser=new jsts.io.WKTParser(this.geometryFactory);};jsts.io.WKTWriter.prototype.write=function(geometry){var wkt=this.parser.write(geometry);return wkt;};jsts.io.WKTWriter.toLineString=function(p0,p1){if(arguments.length!==2){throw new jsts.error.NotImplementedError();}
return'LINESTRING ( '+p0.x+' '+p0.y+', '+p1.x+' '+p1.y+' )';};jsts.io.WKTReader=function(geometryFactory){this.geometryFactory=geometryFactory||new jsts.geom.GeometryFactory();this.precisionModel=this.geometryFactory.getPrecisionModel();this.parser=new jsts.io.WKTParser(this.geometryFactory);};jsts.io.WKTReader.prototype.read=function(wkt){var geometry=this.parser.read(wkt);if(this.precisionModel.getType()===jsts.geom.PrecisionModel.FIXED){this.reducePrecision(geometry);}
return geometry;};jsts.io.WKTReader.prototype.reducePrecision=function(geometry){var i,len;if(geometry.coordinate){this.precisionModel.makePrecise(geometry.coordinate);}else if(geometry.points){for(i=0,len=geometry.points.length;i<len;i++){this.precisionModel.makePrecise(geometry.points[i]);}}else if(geometry.geometries){for(i=0,len=geometry.geometries.length;i<len;i++){this.reducePrecision(geometry.geometries[i]);}}};jsts.triangulate.quadedge.QuadEdgeSubdivision=function(env,tolerance){this.tolerance=tolerance;this.edgeCoincidenceTolerance=tolerance/jsts.triangulate.quadedge.QuadEdgeSubdivision.EDGE_COINCIDENCE_TOL_FACTOR;this.visitedKey=0;this.quadEdges=[];this.startingEdge;this.tolerance;this.edgeCoincidenceTolerance;this.frameEnv;this.locator=null;this.seg=new jsts.geom.LineSegment();this.triEdges=new Array(3);this.frameVertex=new Array(3);this.createFrame(env);this.startingEdge=this.initSubdiv();this.locator=new jsts.triangulate.quadedge.LastFoundQuadEdgeLocator(this);};jsts.triangulate.quadedge.QuadEdgeSubdivision.EDGE_COINCIDENCE_TOL_FACTOR=1000;jsts.triangulate.quadedge.QuadEdgeSubdivision.getTriangleEdges=function(startQE,triEdge){triEdge[0]=startQE;triEdge[1]=triEdge[0].lNext();triEdge[2]=triEdge[1].lNext();if(triEdge[2].lNext()!=triEdge[0]){throw new jsts.IllegalArgumentError('Edges do not form a triangle');}};jsts.triangulate.quadedge.QuadEdgeSubdivision.prototype.createFrame=function(env){var deltaX,deltaY,offset;deltaX=env.getWidth();deltaY=env.getHeight();offset=0.0;if(deltaX>deltaY){offset=deltaX*10.0;}else{offset=deltaY*10.0;}
this.frameVertex[0]=new jsts.triangulate.quadedge.Vertex((env.getMaxX()+env.getMinX())/2.0,env.getMaxY()
+offset);this.frameVertex[1]=new jsts.triangulate.quadedge.Vertex(env.getMinX()-offset,env.getMinY()-offset);this.frameVertex[2]=new jsts.triangulate.quadedge.Vertex(env.getMaxX()+offset,env.getMinY()-offset);this.frameEnv=new jsts.geom.Envelope(this.frameVertex[0].getCoordinate(),this.frameVertex[1].getCoordinate());this.frameEnv.expandToInclude(this.frameVertex[2].getCoordinate());};jsts.triangulate.quadedge.QuadEdgeSubdivision.prototype.initSubdiv=function(){var ea,eb,ec;ea=this.makeEdge(this.frameVertex[0],this.frameVertex[1]);eb=this.makeEdge(this.frameVertex[1],this.frameVertex[2]);jsts.triangulate.quadedge.QuadEdge.splice(ea.sym(),eb);ec=this.makeEdge(this.frameVertex[2],this.frameVertex[0]);jsts.triangulate.quadedge.QuadEdge.splice(eb.sym(),ec);jsts.triangulate.quadedge.QuadEdge.splice(ec.sym(),ea);return ea;};jsts.triangulate.quadedge.QuadEdgeSubdivision.prototype.getTolerance=function(){return this.tolerance;};jsts.triangulate.quadedge.QuadEdgeSubdivision.prototype.getEnvelope=function(){return new jsts.geom.Envelope(this.frameEnv);};jsts.triangulate.quadedge.QuadEdgeSubdivision.prototype.getEdges=function(){if(arguments.length>0){return this.getEdgesByFactory(arguments[0]);}else{return this.quadEdges;}};jsts.triangulate.quadedge.QuadEdgeSubdivision.prototype.setLocator=function(locator){this.locator=locator;};jsts.triangulate.quadedge.QuadEdgeSubdivision.prototype.makeEdge=function(o,d){var q=jsts.triangulate.quadedge.QuadEdge.makeEdge(o,d);this.quadEdges.push(q);return q;};jsts.triangulate.quadedge.QuadEdgeSubdivision.prototype.connect=function(a,b){var q=jsts.triangulate.quadedge.QuadEdge.connect(a,b);this.quadEdges.push(q);return q;};jsts.triangulate.quadedge.QuadEdgeSubdivision.prototype.delete_jsts=function(e){jsts.triangulate.quadedge.QuadEdge.splice(e,e.oPrev());jsts.triangulate.quadedge.QuadEdge.splice(e.sym(),e.sym().oPrev());var eSym,eRot,eRotSym;e.eSym=e.sym();eRot=e.rot;eRotSym=e.rot.sym();var idx=this.quadEdges.indexOf(e);if(idx!==-1){this.quadEdges.splice(idx,1);}
idx=this.quadEdges.indexOf(eSym);if(idx!==-1){this.quadEdges.splice(idx,1);}
idx=this.quadEdges.indexOf(eRot);if(idx!==-1){this.quadEdges.splice(idx,1);}
idx=this.quadEdges.indexOf(eRotSym);if(idx!==-1){this.quadEdges.splice(idx,1);}
e.delete_jsts();eSym.delete_jsts();eRot.delete_jsts();eRotSym.delete_jsts();};jsts.triangulate.quadedge.QuadEdgeSubdivision.prototype.locateFromEdge=function(v,startEdge){var iter=0,maxIter=this.quadEdges.length,e;e=startEdge;while(true){iter++;if(iter>maxIter){throw new jsts.error.LocateFailureError(e.toLineSegment());}
if((v.equals(e.orig()))||(v.equals(e.dest()))){break;}else if(v.rightOf(e)){e=e.sym();}else if(!v.rightOf(e.oNext())){e=e.oNext();}else if(!v.rightOf(e.dPrev())){e=e.dPrev();}else{break;}}
return e;};jsts.triangulate.quadedge.QuadEdgeSubdivision.prototype.locate=function(){if(arguments.length===1){if(arguments[0]instanceof jsts.triangulate.quadedge.Vertex){return this.locateByVertex(arguments[0]);}else{return this.locateByCoordinate(arguments[0]);}}else{return this.locateByCoordinates(arguments[0],arguments[1]);}};jsts.triangulate.quadedge.QuadEdgeSubdivision.prototype.locateByVertex=function(v){return this.locator.locate(v);};jsts.triangulate.quadedge.QuadEdgeSubdivision.prototype.locateByCoordinate=function(p){return this.locator.locate(new jsts.triangulate.quadedge.Vertex(p));};jsts.triangulate.quadedge.QuadEdgeSubdivision.prototype.locateByCoordinates=function(p0,p1){var e,base,locEdge;var e=this.locator.locate(new jsts.triangulate.quadedge.Vertex(p0));if(e===null){return null;}
base=e;if(e.dest().getCoordinate().equals2D(p0)){base=e.sym();}
locEdge=base;do{if(locEdge.dest().getCoordinate().equals2D(p1)){return locEdge;}
locEdge=locEdge.oNext();}while(locEdge!=base);return null;};jsts.triangulate.quadedge.QuadEdgeSubdivision.prototype.insertSite=function(v){var e,base,startEdge;e=this.locate(v);if((v.equals(e.orig(),this.tolerance))||(v.equals(e.dest(),this.tolerance))){return e;}
base=this.makeEdge(e.orig(),v);jsts.triangulate.quadedge.QuadEdge.splice(base,e);startEdge=base;do{base=this.connect(e,base.sym());e=base.oPrev();}while(e.lNext()!=startEdge);return startEdge;};jsts.triangulate.quadedge.QuadEdgeSubdivision.prototype.isFrameEdge=function(e){if(this.isFrameVertex(e.orig())||this.isFrameVertex(e.dest())){return true;}
return false;};jsts.triangulate.quadedge.QuadEdgeSubdivision.prototype.isFrameBorderEdge=function(e){var leftTri,rightTri,vLeftTriOther,vRightTriOther;leftTri=new Array(3);this.getTriangleEdges(e,leftTri);rightTri=new Array(3);this.getTriangleEdges(e.sym(),rightTri);vLeftTriOther=e.lNext().dest();if(this.isFrameVertex(vLeftTriOther)){return true;}
vRightTriOther=e.sym().lNext().dest();if(this.isFrameVertex(vRightTriOther)){return true;}
return false;};jsts.triangulate.quadedge.QuadEdgeSubdivision.prototype.isFrameVertex=function(v){if(v.equals(this.frameVertex[0])){return true;}
if(v.equals(this.frameVertex[1])){return true;}
if(v.equals(this.frameVertex[2])){return true;}
return false;};jsts.triangulate.quadedge.QuadEdgeSubdivision.prototype.isOnEdge=function(e,p){this.seg.setCoordinates(e.orig().getCoordinate(),e.dest().getCoordinate());var dist=this.seg.distance(p);return dist<this.edgeCoincidenceTolerance;};jsts.triangulate.quadedge.QuadEdgeSubdivision.prototype.isVertexOfEdge=function(e,v){if((v.equals(e.orig(),this.tolerance))||(v.equals(e.dest(),this.tolerance))){return true;}
return false;};jsts.triangulate.quadedge.QuadEdgeSubdivision.prototype.getVertices=function(includeFrame)
{var vertices=[],i,il,qe,v,vd;i=0,il=this.quadEdges.length;for(i;i<il;i++){qe=this.quadEdges[i];v=qe.orig();if(includeFrame||!this.isFrameVertex(v)){vertices.push(v);}
vd=qe.dest();if(includeFrame||!this.isFrameVertex(vd)){vertices.push(vd);}}
return vertices;};jsts.triangulate.quadedge.QuadEdgeSubdivision.prototype.getVertexUniqueEdges=function(includeFrame)
{var edges,visitedVertices,i,il,qe,v,qd,vd;edges=[];visitedVertices=[];i=0,il=this.quadEdges.length;for(i;i<il;i++){qe=this.quadEdges[i];v=qe.orig();if(visitedVertices.indexOf(v)===-1){visitedVertices.push(v);if(includeFrame||!this.isFrameVertex(v)){edges.push(qe);}}
qd=qe.sym();vd=qd.orig();if(visitedVertices.indexOf(vd)===-1){visitedVertices.push(vd);if(includeFrame||!this.isFrameVertex(vd)){edges.push(qd);}}}
return edges;};jsts.triangulate.quadedge.QuadEdgeSubdivision.prototype.getPrimaryEdges=function(includeFrame){this.visitedKey++;var edges,edgeStack,visitedEdges,edge,priQE;edges=[];edgeStack=[];edgeStack.push(this.startingEdge);visitedEdges=[];while(edgeStack.length>0){edge=edgeStack.pop();if(visitedEdges.indexOf(edge)===-1){priQE=edge.getPrimary();if(includeFrame||!this.isFrameEdge(priQE)){edges.push(priQE);}
edgeStack.push(edge.oNext());edgeStack.push(edge.sym().oNext());visitedEdges.push(edge);visitedEdges.push(edge.sym());}}
return edges;};jsts.triangulate.quadedge.QuadEdgeSubdivision.prototype.visitTriangles=function(triVisitor,includeFrame){this.visitedKey++;var edgeStack,visitedEdges,edge,triEdges;edgeStack=[];edgeStack.push(this.startingEdge);visitedEdges=[];while(edgeStack.length>0){edge=edgeStack.pop();if(visitedEdges.indexOf(edge)===-1){triEdges=this.fetchTriangleToVisit(edge,edgeStack,includeFrame,visitedEdges);if(triEdges!==null)
triVisitor.visit(triEdges);}}};jsts.triangulate.quadedge.QuadEdgeSubdivision.prototype.fetchTriangleToVisit=function(edge,edgeStack,includeFrame,visitedEdges){var curr,edgeCount,isFrame,sym;curr=edge;edgeCount=0;isFrame=false;do{this.triEdges[edgeCount]=curr;if(this.isFrameEdge(curr)){isFrame=true;}
sym=curr.sym();if(visitedEdges.indexOf(sym)===-1){edgeStack.push(sym);}
visitedEdges.push(curr);edgeCount++;curr=curr.lNext();}while(curr!==edge);if(isFrame&&!includeFrame){return null;}
return this.triEdges;};jsts.triangulate.quadedge.QuadEdgeSubdivision.prototype.getTriangleEdges=function(includeFrame){var visitor=new jsts.triangulate.quadedge.TriangleEdgesListVisitor();this.visitTriangles(visitor,includeFrame);return visitor.getTriangleEdges();};jsts.triangulate.quadedge.QuadEdgeSubdivision.prototype.getTriangleVertices=function(includeFrame){var visitor=new TriangleVertexListVisitor();this.visitTriangles(visitor,includeFrame);return visitor.getTriangleVertices();};jsts.triangulate.quadedge.QuadEdgeSubdivision.prototype.getTriangleCoordinates=function(includeFrame){var visitor=new jsts.triangulate.quadedge.TriangleCoordinatesVisitor();this.visitTriangles(visitor,includeFrame);return visitor.getTriangles();};jsts.triangulate.quadedge.QuadEdgeSubdivision.prototype.getEdgesByFactory=function(geomFact){var quadEdges,edges,i,il,qe,coords;quadEdges=this.getPrimaryEdges(false);edges=[];i=0;il=quadEdges.length;for(i;i<il;i++){qe=quadEdges[i];coords=[];coords[0]=(qe.orig().getCoordinate());coords[1]=(qe.dest().getCoordinate());edges[i]=geomFact.createLineString(coords);}
return geomFact.createMultiLineString(edges);};jsts.triangulate.quadedge.QuadEdgeSubdivision.prototype.getTriangles=function(geomFact){var triPtsList,tris,triPt,i,il;triPtsList=this.getTriangleCoordinates(false);tris=new Array(triPtsList.length);i=0,il=triPtsList.length;for(i;i<il;i++){triPt=triPtsList[i];tris[i]=geomFact.createPolygon(geomFact.createLinearRing(triPt,null));}
return geomFact.createGeometryCollection(tris);};jsts.triangulate.quadedge.QuadEdgeSubdivision.prototype.getVoronoiDiagram=function(geomFact)
{var vorCells=this.getVoronoiCellPolygons(geomFact);return geomFact.createGeometryCollection(vorCells);};jsts.triangulate.quadedge.QuadEdgeSubdivision.prototype.getVoronoiCellPolygons=function(geomFact)
{this.visitTriangles(new jsts.triangulate.quadedge.TriangleCircumcentreVisitor(),true);var cells,edges,i,il,qe;cells=[];edges=this.getVertexUniqueEdges(false);i=0,il=edges.length;for(i;i<il;i++){qe=edges[i];cells.push(this.getVoronoiCellPolygon(qe,geomFact));}
return cells;};jsts.triangulate.quadedge.QuadEdgeSubdivision.prototype.getVoronoiCellPolygon=function(qe,geomFact)
{var cellPts,startQe,cc,coordList,cellPoly,v;cellPts=[];startQE=qe;do{cc=qe.rot.orig().getCoordinate();cellPts.push(cc);qe=qe.oPrev();}while(qe!==startQE);coordList=new jsts.geom.CoordinateList([],false);coordList.add(cellPts,false);coordList.closeRing();if(coordList.size()<4){coordList.add(coordList.get(coordList.size()-1),true);}
cellPoly=geomFact.createPolygon(geomFact.createLinearRing(coordList.toArray()),null);v=startQE.orig();return cellPoly;};jsts.triangulate.quadedge.TriangleCircumcentreVisitor=function(){};jsts.triangulate.quadedge.TriangleCircumcentreVisitor.prototype.visit=function(triEdges){var a,b,c,cc,ccVertex,i;a=triEdges[0].orig().getCoordinate();b=triEdges[1].orig().getCoordinate();c=triEdges[2].orig().getCoordinate();cc=jsts.geom.Triangle.circumcentre(a,b,c);ccVertex=new jsts.triangulate.quadedge.Vertex(cc);i=0;for(i;i<3;i++){triEdges[i].rot.setOrig(ccVertex);}};jsts.triangulate.quadedge.TriangleEdgesListVisitor=function(){this.triList=[];};jsts.triangulate.quadedge.TriangleEdgesListVisitor.prototype.visit=function(triEdges){var clone=triEdges.concat();this.triList.push(clone);};jsts.triangulate.quadedge.TriangleEdgesListVisitor.prototype.getTriangleEdges=function(){return this.triList;};jsts.triangulate.quadedge.TriangleVertexListVisitor=function(){this.triList=[];};jsts.triangulate.quadedge.TriangleVertexListVisitor.prototype.visit=function(triEdges){var vertices=[];vertices.push(trieEdges[0].orig());vertices.push(trieEdges[1].orig());vertices.push(trieEdges[2].orig());this.triList.push(vertices);};jsts.triangulate.quadedge.TriangleVertexListVisitor.prototype.getTriangleVertices=function(){return this.triList;};jsts.triangulate.quadedge.TriangleCoordinatesVisitor=function(){this.coordList=new jsts.geom.CoordinateList([],false);this.triCoords=[];};jsts.triangulate.quadedge.TriangleCoordinatesVisitor.prototype.visit=function(triEdges){this.coordList=new jsts.geom.CoordinateList([],false);var i=0,v,pts;for(i;i<3;i++){v=triEdges[i].orig();this.coordList.add(v.getCoordinate());}
if(this.coordList.size()>0){this.coordList.closeRing();pts=this.coordList.toArray();if(pts.length!==4){return;}
this.triCoords.push(pts);}};jsts.triangulate.quadedge.TriangleCoordinatesVisitor.prototype.getTriangles=function(){return this.triCoords;};jsts.operation.relate.EdgeEndBundle=function(){this.edgeEnds=[];var e=arguments[0]instanceof jsts.geomgraph.EdgeEnd?arguments[0]:arguments[1];var edge=e.getEdge();var coord=e.getCoordinate();var dirCoord=e.getDirectedCoordinate();var label=new jsts.geomgraph.Label(e.getLabel());jsts.geomgraph.EdgeEnd.call(this,edge,coord,dirCoord,label);this.insert(e);};jsts.operation.relate.EdgeEndBundle.prototype=new jsts.geomgraph.EdgeEnd();jsts.operation.relate.EdgeEndBundle.prototype.edgeEnds=null;jsts.operation.relate.EdgeEndBundle.prototype.getLabel=function(){return this.label;};jsts.operation.relate.EdgeEndBundle.prototype.getEdgeEnds=function(){return this.edgeEnds;};jsts.operation.relate.EdgeEndBundle.prototype.insert=function(e){this.edgeEnds.push(e);};jsts.operation.relate.EdgeEndBundle.prototype.computeLabel=function(boundaryNodeRule){var isArea=false;for(var i=0;i<this.edgeEnds.length;i++){var e=this.edgeEnds[i];if(e.getLabel().isArea())
isArea=true;}
if(isArea)
this.label=new jsts.geomgraph.Label(jsts.geom.Location.NONE,jsts.geom.Location.NONE,jsts.geom.Location.NONE);else
this.label=new jsts.geomgraph.Label(jsts.geom.Location.NONE);for(var i=0;i<2;i++){this.computeLabelOn(i,boundaryNodeRule);if(isArea)
this.computeLabelSides(i);}};jsts.operation.relate.EdgeEndBundle.prototype.computeLabelOn=function(geomIndex,boundaryNodeRule){var boundaryCount=0;var foundInterior=false;for(var i=0;i<this.edgeEnds.length;i++){var e=this.edgeEnds[i];var loc=e.getLabel().getLocation(geomIndex);if(loc==jsts.geom.Location.BOUNDARY)
boundaryCount++;if(loc==jsts.geom.Location.INTERIOR)
foundInterior=true;}
var loc=jsts.geom.Location.NONE;if(foundInterior)
loc=jsts.geom.Location.INTERIOR;if(boundaryCount>0){loc=jsts.geomgraph.GeometryGraph.determineBoundary(boundaryNodeRule,boundaryCount);}
this.label.setLocation(geomIndex,loc);};jsts.operation.relate.EdgeEndBundle.prototype.computeLabelSides=function(geomIndex){this.computeLabelSide(geomIndex,jsts.geomgraph.Position.LEFT);this.computeLabelSide(geomIndex,jsts.geomgraph.Position.RIGHT);};jsts.operation.relate.EdgeEndBundle.prototype.computeLabelSide=function(geomIndex,side){for(var i=0;i<this.edgeEnds.length;i++){var e=this.edgeEnds[i];if(e.getLabel().isArea()){var loc=e.getLabel().getLocation(geomIndex,side);if(loc===jsts.geom.Location.INTERIOR){this.label.setLocation(geomIndex,side,jsts.geom.Location.INTERIOR);return;}else if(loc===jsts.geom.Location.EXTERIOR)
this.label.setLocation(geomIndex,side,jsts.geom.Location.EXTERIOR);}}};jsts.operation.relate.EdgeEndBundle.prototype.updateIM=function(im){jsts.geomgraph.Edge.updateIM(this.label,im);};jsts.index.kdtree.KdTree=function(tolerance){var tol=0.0;if(tolerance!==undefined){tol=tolerance;}
this.root=null;this.last=null;this.numberOfNodes=0;this.tolerance=tol;};jsts.index.kdtree.KdTree.prototype.insert=function(){if(arguments.length===1){return this.insertCoordinate.apply(this,arguments[0]);}else{return this.insertWithData.apply(this,arguments[0],arguments[1]);}};jsts.index.kdtree.KdTree.prototype.insertCoordinate=function(p){return this.insertWithData(p,null);};jsts.index.kdtree.KdTree.prototype.insertWithData=function(p,data){if(this.root===null){this.root=new jsts.index.kdtree.KdNode(p,data);return this.root;}
var currentNode=this.root,leafNode=this.root,isOddLevel=true,isLessThan=true;while(currentNode!==last){if(isOddLevel){isLessThan=p.x<currentNode.getX();}else{isLessThan=p.y<currentNode.getY();}
leafNode=currentNode;if(isLessThan){currentNode=currentNode.getLeft();}else{currentNode=currentNode.getRight();}
if(currentNode!==null){var isInTolerance=p.distance(currentNode.getCoordinate())<=this.tolerance;if(isInTolerance){currentNode.increment();return currentNode;}}
isOddLevel=!isOddLevel;}
this.numberOfNodes=numberOfNodes+1;var node=new jsts.index.kdtree.KdNode(p,data);node.setLeft(this.last);node.setRight(this.last);if(isLessThan){leafNode.setLeft(node);}else{leafNode.setRight(node);}
return node;};jsts.index.kdtree.KdTree.prototype.queryNode=function(currentNode,bottomNode,queryEnv,odd,result){if(currentNode===bottomNode){return;}
var min,max,discriminant;if(odd){min=queryEnv.getMinX();max=queryEnv.getMaxX();discriminant=currentNode.getX();}else{min=queryEnv.getMinY();max=queryEnv.getMaxY();discriminant=currentNode.getY();}
var searchLeft=min<discriminant;var searchRight=discriminant<=max;if(searchLeft){this.queryNode(currentNode.getLeft(),bottomNode,queryEnv,!odd,result);}
if(queryEnv.contains(currentNode.getCoordinate())){result.add(currentNode);}
if(searchRight){this.queryNode(currentNode.getRight(),bottomNode,queryEnv,!odd,result);}};jsts.index.kdtree.KdTree.prototype.query=function(){if(arguments.length===1){return this.queryByEnvelope.apply(this,arguments[0]);}else{return this.queryWithArray.apply(this,arguments[0],arguments[1]);}};jsts.index.kdtree.KdTree.prototype.queryByEnvelope=function(queryEnv){var result=[];this.queryNode(this.root,this.last,queryEnv,true,result);return result;};jsts.index.kdtree.KdTree.prototype.queryWithArray=function(queryEnv,result){this.queryNode(this.root,this.last,queryEnv,true,result);};jsts.geom.Triangle=function(p0,p1,p2){this.p0=p0;this.p1=p1;this.p2=p2;};jsts.geom.Triangle.isAcute=function(a,b,c){if(!jsts.algorithm.Angle.isAcute(a,b,c)){return false;}
if(!jsts.algorithm.Angle.isAcute(b,c,a)){return false;}
if(!jsts.algorithm.Angle.isAcute(c,a,b)){return false;}
return true;};jsts.geom.Triangle.perpendicularBisector=function(a,b){var dx,dy,l1,l2;dx=b.x-a.x;dy=b.y-a.y;l1=new jsts.algorithm.HCoordinate(a.x+dx/2.0,a.y+dy/2.0,1.0);l2=new jsts.algorithm.HCoordinate(a.x-dy+dx/2.0,a.y+dx+dy/2.0,1.0);return new jsts.algorithm.HCoordinate(l1,l2);};jsts.geom.Triangle.circumcentre=function(a,b,c){var cx,cy,ax,ay,bx,by,denom,numx,numy,ccx,ccy;cx=c.x;cy=c.y;ax=a.x-cx;ay=a.y-cy;bx=b.x-cx;by=b.y-cy;denom=2*jsts.geom.Triangle.det(ax,ay,bx,by);numx=jsts.geom.Triangle.det(ay,ax*ax+ay*ay,by,bx*bx+by*by);numy=jsts.geom.Triangle.det(ax,ax*ax+ay*ay,bx,bx*bx+by*by);ccx=cx-numx/denom;ccy=cy+numy/denom;return new jsts.geom.Coordinate(ccx,ccy);};jsts.geom.Triangle.det=function(m00,m01,m10,m11){return m00*m11-m01*m10;};jsts.geom.Triangle.inCentre=function(a,b,c){var len0,len1,len2,circum,inCentreX,inCentreY;len0=b.distance(c);len1=a.distance(c);len2=a.distance(b);circum=len0+len1+len2;inCentreX=(len0*a.x+len1*b.x+len2*c.x)/circum;inCentreY=(len0*a.y+len1*b.y+len2*c.y)/circum;return new jsts.geom.Coordinate(inCentreX,inCentreY);};jsts.geom.Triangle.centroid=function(a,b,c){var x,y;x=(a.x+b.x+c.x)/3;y=(a.y+b.y+c.y)/3;return new jsts.geom.Coordinate(x,y);};jsts.geom.Triangle.longestSideLength=function(a,b,c){var lenAB,lenBC,lenCA,maxLen;lenAB=a.distance(b);lenBC=b.distance(c);lenCA=c.distance(a);maxLen=lenAB;if(lenBC>maxLen){maxLen=lenBC;}
if(lenCA>maxLen){maxLen=lenCA;}
return maxLen;};jsts.geom.Triangle.angleBisector=function(a,b,c){var len0,len2,frac,dx,dy,splitPt;len0=b.distance(a);len2=b.distance(c);frac=len0/(len0+len2);dx=c.x-a.x;dy=c.y-a.y;splitPt=new jsts.geom.Coordinate(a.x+frac*dx,a.y+frac*dy);return splitPt;};jsts.geom.Triangle.area=function(a,b,c){return Math.abs(((c.x-a.x)*(b.y-a.y)-(b.x-a.x)*(c.y-a.y))/2.0);};jsts.geom.Triangle.signedArea=function(a,b,c){return((c.x-a.x)*(b.y-a.y)-(b.x-a.x)*(c.y-a.y))/2.0;};jsts.geom.Triangle.prototype.inCentre=function(){return jsts.geom.Triangle.inCentre(this.p0,this.p1,this.p2);};jsts.noding.OrientedCoordinateArray=function(pts){this.pts=pts;this._orientation=jsts.noding.OrientedCoordinateArray.orientation(pts);};jsts.noding.OrientedCoordinateArray.prototype.pts=null;jsts.noding.OrientedCoordinateArray.prototype._orientation=undefined;jsts.noding.OrientedCoordinateArray.orientation=function(pts){return jsts.geom.CoordinateArrays.increasingDirection(pts)===1;};jsts.noding.OrientedCoordinateArray.prototype.compareTo=function(o1){var oca=o1;var comp=jsts.noding.OrientedCoordinateArray.compareOriented(this.pts,this._orientation,oca.pts,oca._orientation);return comp;};jsts.noding.OrientedCoordinateArray.compareOriented=function(pts1,orientation1,pts2,orientation2){var dir1=orientation1?1:-1;var dir2=orientation2?1:-1;var limit1=orientation1?pts1.length:-1;var limit2=orientation2?pts2.length:-1;var i1=orientation1?0:pts1.length-1;var i2=orientation2?0:pts2.length-1;var comp=0;while(true){var compPt=pts1[i1].compareTo(pts2[i2]);if(compPt!==0)
return compPt;i1+=dir1;i2+=dir2;var done1=i1===limit1;var done2=i2===limit2;if(done1&&!done2)
return-1;if(!done1&&done2)
return 1;if(done1&&done2)
return 0;}};jsts.algorithm.CentralEndpointIntersector=function(p00,p01,p10,p11){this.pts=[p00,p01,p10,p11];this.compute();};jsts.algorithm.CentralEndpointIntersector.getIntersection=function(p00,p01,p10,p11){var intor=new jsts.algorithm.CentralEndpointIntersector(p00,p01,p10,p11);return intor.getIntersection();};jsts.algorithm.CentralEndpointIntersector.prototype.pts=null;jsts.algorithm.CentralEndpointIntersector.prototype.intPt=null;jsts.algorithm.CentralEndpointIntersector.prototype.compute=function(){var centroid=jsts.algorithm.CentralEndpointIntersector.average(this.pts);this.intPt=this.findNearestPoint(centroid,this.pts);};jsts.algorithm.CentralEndpointIntersector.prototype.getIntersection=function(){return this.intPt;};jsts.algorithm.CentralEndpointIntersector.average=function(pts){var avg=new jsts.geom.Coordinate();var i,n=pts.length;for(i=0;i<n;i++){avg.x+=pts[i].x;avg.y+=pts[i].y;}
if(n>0){avg.x/=n;avg.y/=n;}
return avg;};jsts.algorithm.CentralEndpointIntersector.prototype.findNearestPoint=function(p,pts){var minDist=Number.MAX_VALUE;var i,result=null,dist;for(i=0;i<pts.length;i++){dist=p.distance(pts[i]);if(dist<minDist){minDist=dist;result=pts[i];}}
return result;};jsts.operation.buffer.BufferOp=function(g,bufParams){this.argGeom=g;this.bufParams=bufParams?bufParams:new jsts.operation.buffer.BufferParameters();};jsts.operation.buffer.BufferOp.MAX_PRECISION_DIGITS=12;jsts.operation.buffer.BufferOp.precisionScaleFactor=function(g,distance,maxPrecisionDigits){var env=g.getEnvelopeInternal();var envSize=Math.max(env.getHeight(),env.getWidth());var expandByDistance=distance>0.0?distance:0.0;var bufEnvSize=envSize+2*expandByDistance;var bufEnvLog10=(Math.log(bufEnvSize)/Math.log(10)+1.0);var minUnitLog10=bufEnvLog10-maxPrecisionDigits;var scaleFactor=Math.pow(10.0,-minUnitLog10);return scaleFactor;};jsts.operation.buffer.BufferOp.bufferOp=function(g,distance){if(arguments.length>2){return jsts.operation.buffer.BufferOp.bufferOp2.apply(this,arguments);}
var gBuf=new jsts.operation.buffer.BufferOp(g);var geomBuf=gBuf.getResultGeometry(distance);return geomBuf;};jsts.operation.buffer.BufferOp.bufferOp2=function(g,distance,params){if(arguments.length>3){return jsts.operation.buffer.BufferOp.bufferOp3.apply(this,arguments);}
var bufOp=new jsts.operation.buffer.BufferOp(g,params);var geomBuf=bufOp.getResultGeometry(distance);return geomBuf;};jsts.operation.buffer.BufferOp.bufferOp3=function(g,distance,quadrantSegments){if(arguments.length>4){return jsts.operation.buffer.BufferOp.bufferOp4.apply(this,arguments);}
var bufOp=new jsts.operation.buffer.BufferOp(g);bufOp.setQuadrantSegments(quadrantSegments);var geomBuf=bufOp.getResultGeometry(distance);return geomBuf;};jsts.operation.buffer.BufferOp.bufferOp4=function(g,distance,quadrantSegments,endCapStyle){var bufOp=new jsts.operation.buffer.BufferOp(g);bufOp.setQuadrantSegments(quadrantSegments);bufOp.setEndCapStyle(endCapStyle);var geomBuf=bufOp.getResultGeometry(distance);return geomBuf;};jsts.operation.buffer.BufferOp.prototype.argGeom=null;jsts.operation.buffer.BufferOp.prototype.distance=null;jsts.operation.buffer.BufferOp.prototype.bufParams=null;jsts.operation.buffer.BufferOp.prototype.resultGeometry=null;jsts.operation.buffer.BufferOp.prototype.setEndCapStyle=function(endCapStyle){this.bufParams.setEndCapStyle(endCapStyle);};jsts.operation.buffer.BufferOp.prototype.setQuadrantSegments=function(quadrantSegments){this.bufParams.setQuadrantSegments(quadrantSegments);};jsts.operation.buffer.BufferOp.prototype.getResultGeometry=function(dist){this.distance=dist;this.computeGeometry();return this.resultGeometry;};jsts.operation.buffer.BufferOp.prototype.computeGeometry=function(){this.bufferOriginalPrecision();if(this.resultGeometry!==null){return;}
var argPM=this.argGeom.getPrecisionModel();if(argPM.getType()===jsts.geom.PrecisionModel.FIXED){this.bufferFixedPrecision(argPM);}else{this.bufferReducedPrecision();}};jsts.operation.buffer.BufferOp.prototype.bufferReducedPrecision=function(){var precDigits;var saveException=null;for(precDigits=jsts.operation.buffer.BufferOp.MAX_PRECISION_DIGITS;precDigits>=0;precDigits--){try{this.bufferReducedPrecision2(precDigits);}catch(ex){saveException=ex;}
if(this.resultGeometry!==null){return;}}
throw saveException;};jsts.operation.buffer.BufferOp.prototype.bufferOriginalPrecision=function(){try{var bufBuilder=new jsts.operation.buffer.BufferBuilder(this.bufParams);this.resultGeometry=bufBuilder.buffer(this.argGeom,this.distance);}catch(e){}};jsts.operation.buffer.BufferOp.prototype.bufferReducedPrecision2=function(precisionDigits){var sizeBasedScaleFactor=jsts.operation.buffer.BufferOp.precisionScaleFactor(this.argGeom,this.distance,precisionDigits);var fixedPM=new jsts.geom.PrecisionModel(sizeBasedScaleFactor);this.bufferFixedPrecision(fixedPM);};jsts.operation.buffer.BufferOp.prototype.bufferFixedPrecision=function(fixedPM){var noder=new jsts.noding.ScaledNoder(new jsts.noding.snapround.MCIndexSnapRounder(new jsts.geom.PrecisionModel(1.0)),fixedPM.getScale());var bufBuilder=new jsts.operation.buffer.BufferBuilder(this.bufParams);bufBuilder.setWorkingPrecisionModel(fixedPM);bufBuilder.setNoder(noder);this.resultGeometry=bufBuilder.buffer(this.argGeom,this.distance);};(function(){var Location=jsts.geom.Location;var Position=jsts.geomgraph.Position;var Assert=jsts.util.Assert;jsts.geomgraph.GeometryGraph=function(argIndex,parentGeom,boundaryNodeRule){jsts.geomgraph.PlanarGraph.call(this);this.lineEdgeMap=new javascript.util.HashMap();this.ptLocator=new jsts.algorithm.PointLocator();this.argIndex=argIndex;this.parentGeom=parentGeom;this.boundaryNodeRule=boundaryNodeRule||jsts.algorithm.BoundaryNodeRule.OGC_SFS_BOUNDARY_RULE;if(parentGeom!==null){this.add(parentGeom);}};jsts.geomgraph.GeometryGraph.prototype=new jsts.geomgraph.PlanarGraph();jsts.geomgraph.GeometryGraph.constructor=jsts.geomgraph.GeometryGraph;jsts.geomgraph.GeometryGraph.prototype.createEdgeSetIntersector=function(){return new jsts.geomgraph.index.SimpleMCSweepLineIntersector();};jsts.geomgraph.GeometryGraph.determineBoundary=function(boundaryNodeRule,boundaryCount){return boundaryNodeRule.isInBoundary(boundaryCount)?Location.BOUNDARY:Location.INTERIOR;};jsts.geomgraph.GeometryGraph.prototype.parentGeom=null;jsts.geomgraph.GeometryGraph.prototype.lineEdgeMap=null;jsts.geomgraph.GeometryGraph.prototype.boundaryNodeRule=null;jsts.geomgraph.GeometryGraph.prototype.useBoundaryDeterminationRule=true;jsts.geomgraph.GeometryGraph.prototype.argIndex=null;jsts.geomgraph.GeometryGraph.prototype.boundaryNodes=null;jsts.geomgraph.GeometryGraph.prototype.hasTooFewPoints=false;jsts.geomgraph.GeometryGraph.prototype.invalidPoint=null;jsts.geomgraph.GeometryGraph.prototype.areaPtLocator=null;jsts.geomgraph.GeometryGraph.prototype.ptLocator=null;jsts.geomgraph.GeometryGraph.prototype.getGeometry=function(){return this.parentGeom;};jsts.geomgraph.GeometryGraph.prototype.getBoundaryNodes=function(){if(this.boundaryNodes===null)
this.boundaryNodes=this.nodes.getBoundaryNodes(this.argIndex);return this.boundaryNodes;};jsts.geomgraph.GeometryGraph.prototype.getBoundaryNodeRule=function(){return this.boundaryNodeRule;};jsts.geomgraph.GeometryGraph.prototype.findEdge=function(line){return this.lineEdgeMap.get(line);};jsts.geomgraph.GeometryGraph.prototype.computeSplitEdges=function(edgelist){for(var i=this.edges.iterator();i.hasNext();){var e=i.next();e.eiList.addSplitEdges(edgelist);}}
jsts.geomgraph.GeometryGraph.prototype.add=function(g){if(g.isEmpty()){return;}
if(g instanceof jsts.geom.MultiPolygon)
this.useBoundaryDeterminationRule=false;if(g instanceof jsts.geom.Polygon)
this.addPolygon(g);else if(g instanceof jsts.geom.LineString)
this.addLineString(g);else if(g instanceof jsts.geom.Point)
this.addPoint(g);else if(g instanceof jsts.geom.MultiPoint)
this.addCollection(g);else if(g instanceof jsts.geom.MultiLineString)
this.addCollection(g);else if(g instanceof jsts.geom.MultiPolygon)
this.addCollection(g);else if(g instanceof jsts.geom.GeometryCollection)
this.addCollection(g);else
throw new jsts.error.IllegalArgumentError('Geometry type not supported.');};jsts.geomgraph.GeometryGraph.prototype.addCollection=function(gc){for(var i=0;i<gc.getNumGeometries();i++){var g=gc.getGeometryN(i);this.add(g);}};jsts.geomgraph.GeometryGraph.prototype.addEdge=function(e){this.insertEdge(e);var coord=e.getCoordinates();this.insertPoint(this.argIndex,coord[0],Location.BOUNDARY);this.insertPoint(this.argIndex,coord[coord.length-1],Location.BOUNDARY);};jsts.geomgraph.GeometryGraph.prototype.addPoint=function(p){var coord=p.getCoordinate();this.insertPoint(this.argIndex,coord,Location.INTERIOR);};jsts.geomgraph.GeometryGraph.prototype.addLineString=function(line){var coord=jsts.geom.CoordinateArrays.removeRepeatedPoints(line.getCoordinates());if(coord.length<2){this.hasTooFewPoints=true;this.invalidPoint=coords[0];return;}
var e=new jsts.geomgraph.Edge(coord,new jsts.geomgraph.Label(this.argIndex,Location.INTERIOR));this.lineEdgeMap.put(line,e);this.insertEdge(e);Assert.isTrue(coord.length>=2,'found LineString with single point');this.insertBoundaryPoint(this.argIndex,coord[0]);this.insertBoundaryPoint(this.argIndex,coord[coord.length-1]);};jsts.geomgraph.GeometryGraph.prototype.addPolygonRing=function(lr,cwLeft,cwRight){if(lr.isEmpty())
return;var coord=jsts.geom.CoordinateArrays.removeRepeatedPoints(lr.getCoordinates());if(coord.length<4){this.hasTooFewPoints=true;this.invalidPoint=coord[0];return;}
var left=cwLeft;var right=cwRight;if(jsts.algorithm.CGAlgorithms.isCCW(coord)){left=cwRight;right=cwLeft;}
var e=new jsts.geomgraph.Edge(coord,new jsts.geomgraph.Label(this.argIndex,Location.BOUNDARY,left,right));this.lineEdgeMap.put(lr,e);this.insertEdge(e);this.insertPoint(this.argIndex,coord[0],Location.BOUNDARY);};jsts.geomgraph.GeometryGraph.prototype.addPolygon=function(p){this.addPolygonRing(p.getExteriorRing(),Location.EXTERIOR,Location.INTERIOR);for(var i=0;i<p.getNumInteriorRing();i++){var hole=p.getInteriorRingN(i);this.addPolygonRing(hole,Location.INTERIOR,Location.EXTERIOR);}};jsts.geomgraph.GeometryGraph.prototype.computeEdgeIntersections=function(g,li,includeProper){var si=new jsts.geomgraph.index.SegmentIntersector(li,includeProper,true);si.setBoundaryNodes(this.getBoundaryNodes(),g.getBoundaryNodes());var esi=this.createEdgeSetIntersector();esi.computeIntersections(this.edges,g.edges,si);return si;};jsts.geomgraph.GeometryGraph.prototype.computeSelfNodes=function(li,computeRingSelfNodes){var si=new jsts.geomgraph.index.SegmentIntersector(li,true,false);var esi=this.createEdgeSetIntersector();if(!computeRingSelfNodes&&(this.parentGeom instanceof jsts.geom.LinearRing||this.parentGeom instanceof jsts.geom.Polygon||this.parentGeom instanceof jsts.geom.MultiPolygon)){esi.computeIntersections(this.edges,si,false);}else{esi.computeIntersections(this.edges,si,true);}
this.addSelfIntersectionNodes(this.argIndex);return si;};jsts.geomgraph.GeometryGraph.prototype.insertPoint=function(argIndex,coord,onLocation){var n=this.nodes.addNode(coord);var lbl=n.getLabel();if(lbl==null){n.label=new jsts.geomgraph.Label(argIndex,onLocation);}else
lbl.setLocation(argIndex,onLocation);};jsts.geomgraph.GeometryGraph.prototype.insertBoundaryPoint=function(argIndex,coord){var n=this.nodes.addNode(coord);var lbl=n.getLabel();var boundaryCount=1;var loc=Location.NONE;if(lbl!==null)
loc=lbl.getLocation(argIndex,Position.ON);if(loc===Location.BOUNDARY)
boundaryCount++;var newLoc=jsts.geomgraph.GeometryGraph.determineBoundary(this.boundaryNodeRule,boundaryCount);lbl.setLocation(argIndex,newLoc);};jsts.geomgraph.GeometryGraph.prototype.addSelfIntersectionNodes=function(argIndex){for(var i=this.edges.iterator();i.hasNext();){var e=i.next();var eLoc=e.getLabel().getLocation(argIndex);for(var eiIt=e.eiList.iterator();eiIt.hasNext();){var ei=eiIt.next();this.addSelfIntersectionNode(argIndex,ei.coord,eLoc);}}};jsts.geomgraph.GeometryGraph.prototype.addSelfIntersectionNode=function(argIndex,coord,loc){if(this.isBoundaryNode(argIndex,coord))
return;if(loc===Location.BOUNDARY&&this.useBoundaryDeterminationRule)
this.insertBoundaryPoint(argIndex,coord);else
this.insertPoint(argIndex,coord,loc);};jsts.geomgraph.GeometryGraph.prototype.getInvalidPoint=function(){return this.invalidPoint;};})();jsts.operation.buffer.OffsetSegmentString=function(){this.ptList=[];};jsts.operation.buffer.OffsetSegmentString.prototype.ptList=null;jsts.operation.buffer.OffsetSegmentString.prototype.precisionModel=null;jsts.operation.buffer.OffsetSegmentString.prototype.minimimVertexDistance=0.0;jsts.operation.buffer.OffsetSegmentString.prototype.setPrecisionModel=function(precisionModel){this.precisionModel=precisionModel;};jsts.operation.buffer.OffsetSegmentString.prototype.setMinimumVertexDistance=function(minimimVertexDistance){this.minimimVertexDistance=minimimVertexDistance;};jsts.operation.buffer.OffsetSegmentString.prototype.addPt=function(pt){var bufPt=new jsts.geom.Coordinate(pt);this.precisionModel.makePrecise(bufPt);if(this.isRedundant(bufPt))
return;this.ptList.push(bufPt);};jsts.operation.buffer.OffsetSegmentString.prototype.addPts=function(pt,isForward){if(isForward){for(var i=0;i<pt.length;i++){this.addPt(pt[i]);}}else{for(var i=pt.length-1;i>=0;i--){this.addPt(pt[i]);}}};jsts.operation.buffer.OffsetSegmentString.prototype.isRedundant=function(pt){if(this.ptList.length<1)
return false;var lastPt=this.ptList[this.ptList.length-1];var ptDist=pt.distance(lastPt);if(ptDist<this.minimimVertexDistance)
return true;return false;};jsts.operation.buffer.OffsetSegmentString.prototype.closeRing=function(){if(this.ptList.length<1)
return;var startPt=new jsts.geom.Coordinate(this.ptList[0]);var lastPt=this.ptList[this.ptList.length-1];var last2Pt=null;if(this.ptList.length>=2)
last2Pt=this.ptList[this.ptList.length-2];if(startPt.equals(lastPt))
return;this.ptList.push(startPt);};jsts.operation.buffer.OffsetSegmentString.prototype.reverse=function(){};jsts.operation.buffer.OffsetSegmentString.prototype.getCoordinates=function(){return this.ptList;};jsts.algorithm.distance.PointPairDistance=function(){this.pt=[new jsts.geom.Coordinate(),new jsts.geom.Coordinate()];};jsts.algorithm.distance.PointPairDistance.prototype.pt=null;jsts.algorithm.distance.PointPairDistance.prototype.distance=NaN;jsts.algorithm.distance.PointPairDistance.prototype.isNull=true;jsts.algorithm.distance.PointPairDistance.prototype.initialize=function(p0,p1,distance){if(p0===undefined){this.isNull=true;return;}
this.pt[0].setCoordinate(p0);this.pt[1].setCoordinate(p1);this.distance=distance!==undefined?distance:p0.distance(p1);this.isNull=false;};jsts.algorithm.distance.PointPairDistance.prototype.getDistance=function(){return this.distance;};jsts.algorithm.distance.PointPairDistance.prototype.getCoordinates=function(){return this.pt;};jsts.algorithm.distance.PointPairDistance.prototype.getCoordinate=function(i){return this.pt[i];};jsts.algorithm.distance.PointPairDistance.prototype.setMaximum=function(ptDist){if(arguments.length===2){this.setMaximum2.apply(this,arguments);return;}
this.setMaximum(ptDist.pt[0],ptDist.pt[1]);};jsts.algorithm.distance.PointPairDistance.prototype.setMaximum2=function(p0,p1){if(this.isNull){this.initialize(p0,p1);return;}
var dist=p0.distance(p1);if(dist>this.distance)
this.initialize(p0,p1,dist);};jsts.algorithm.distance.PointPairDistance.prototype.setMinimum=function(ptDist){if(arguments.length===2){this.setMinimum2.apply(this,arguments);return;}
this.setMinimum(ptDist.pt[0],ptDist.pt[1]);};jsts.algorithm.distance.PointPairDistance.prototype.setMinimum2=function(p0,p1){if(this.isNull){this.initialize(p0,p1);return;}
var dist=p0.distance(p1);if(dist<this.distance)
this.initialize(p0,p1,dist);};(function(){var PointPairDistance=jsts.algorithm.distance.PointPairDistance;var DistanceToPoint=jsts.algorithm.distance.DistanceToPoint;var MaxPointDistanceFilter=function(geom){this.maxPtDist=new PointPairDistance();this.minPtDist=new PointPairDistance();this.euclideanDist=new DistanceToPoint();this.geom=geom;};MaxPointDistanceFilter.prototype=new jsts.geom.CoordinateFilter();MaxPointDistanceFilter.prototype.maxPtDist=new PointPairDistance();MaxPointDistanceFilter.prototype.minPtDist=new PointPairDistance();MaxPointDistanceFilter.prototype.euclideanDist=new DistanceToPoint();MaxPointDistanceFilter.prototype.geom;MaxPointDistanceFilter.prototype.filter=function(pt){this.minPtDist.initialize();DistanceToPoint.computeDistance(this.geom,pt,this.minPtDist);this.maxPtDist.setMaximum(this.minPtDist);};MaxPointDistanceFilter.prototype.getMaxPointDistance=function(){return this.maxPtDist;};var MaxDensifiedByFractionDistanceFilter=function(geom,fraction){this.maxPtDist=new PointPairDistance();this.minPtDist=new PointPairDistance();this.geom=geom;this.numSubSegs=Math.round(1.0/fraction);};MaxDensifiedByFractionDistanceFilter.prototype=new jsts.geom.CoordinateSequenceFilter();MaxDensifiedByFractionDistanceFilter.prototype.maxPtDist=new PointPairDistance();MaxDensifiedByFractionDistanceFilter.prototype.minPtDist=new PointPairDistance();MaxDensifiedByFractionDistanceFilter.prototype.geom;MaxDensifiedByFractionDistanceFilter.prototype.numSubSegs=0;MaxDensifiedByFractionDistanceFilter.prototype.filter=function(seq,index){if(index==0)
return;var p0=seq[index-1];var p1=seq[index];var delx=(p1.x-p0.x)/this.numSubSegs;var dely=(p1.y-p0.y)/this.numSubSegs;for(var i=0;i<this.numSubSegs;i++){var x=p0.x+i*delx;var y=p0.y+i*dely;var pt=new jsts.geom.Coordinate(x,y);this.minPtDist.initialize();DistanceToPoint.computeDistance(this.geom,pt,this.minPtDist);this.maxPtDist.setMaximum(this.minPtDist);}};MaxDensifiedByFractionDistanceFilter.prototype.isGeometryChanged=function(){return false;};MaxDensifiedByFractionDistanceFilter.prototype.isDone=function(){return false;};MaxDensifiedByFractionDistanceFilter.prototype.getMaxPointDistance=function(){return this.maxPtDist;};jsts.algorithm.distance.DiscreteHausdorffDistance=function(g0,g1){this.g0=g0;this.g1=g1;this.ptDist=new jsts.algorithm.distance.PointPairDistance();};jsts.algorithm.distance.DiscreteHausdorffDistance.prototype.g0=null;jsts.algorithm.distance.DiscreteHausdorffDistance.prototype.g1=null;jsts.algorithm.distance.DiscreteHausdorffDistance.prototype.ptDist=null;jsts.algorithm.distance.DiscreteHausdorffDistance.prototype.densifyFrac=0.0;jsts.algorithm.distance.DiscreteHausdorffDistance.distance=function(g0,g1,densifyFrac){var dist=new jsts.algorithm.distance.DiscreteHausdorffDistance(g0,g1);if(densifyFrac!==undefined)
dist.setDensifyFraction(densifyFrac);return dist.distance();};jsts.algorithm.distance.DiscreteHausdorffDistance.prototype.setDensifyFraction=function(densifyFrac){if(densifyFrac>1.0||densifyFrac<=0.0)
throw new jsts.error.IllegalArgumentError('Fraction is not in range (0.0 - 1.0]');this.densifyFrac=densifyFrac;};jsts.algorithm.distance.DiscreteHausdorffDistance.prototype.distance=function(){this.compute(this.g0,this.g1);return ptDist.getDistance();};jsts.algorithm.distance.DiscreteHausdorffDistance.prototype.orientedDistance=function(){this.computeOrientedDistance(this.g0,this.g1,this.ptDist);return this.ptDist.getDistance();};jsts.algorithm.distance.DiscreteHausdorffDistance.prototype.getCoordinates=function(){return ptDist.getCoordinates();};jsts.algorithm.distance.DiscreteHausdorffDistance.prototype.compute=function(g0,g1){this.computeOrientedDistance(g0,g1,this.ptDist);this.computeOrientedDistance(g1,g0,this.ptDist);};jsts.algorithm.distance.DiscreteHausdorffDistance.prototype.computeOrientedDistance=function(discreteGeom,geom,ptDist){var distFilter=new MaxPointDistanceFilter(geom);discreteGeom.apply(distFilter);ptDist.setMaximum(distFilter.getMaxPointDistance());if(this.densifyFrac>0){var fracFilter=new MaxDensifiedByFractionDistanceFilter(geom,this.densifyFrac);discreteGeom.apply(fracFilter);ptDist.setMaximum(fracFilter.getMaxPointDistance());}};})();jsts.algorithm.MinimumBoundingCircle=function(geom){this.input=null;this.extremalPts=null;this.centre=null;this.radius=0;this.input=geom;};jsts.algorithm.MinimumBoundingCircle.prototype.getCircle=function(){this.compute();if(this.centre===null){return this.input.getFactory().createPolygon(null,null);}
var centrePoint=this.input.getFactory().createPoint(this.centre);if(this.radius===0){return centrePoint;}
return centrePoint.buffer(this.radius);};jsts.algorithm.MinimumBoundingCircle.prototype.getExtremalPoints=function(){this.compute();return this.extremalPts;};jsts.algorithm.MinimumBoundingCircle.prototype.getCentre=function(){this.compute();return this.centre;};jsts.algorithm.MinimumBoundingCircle.prototype.getRadius=function(){this.compute();return this.radius;};jsts.algorithm.MinimumBoundingCircle.prototype.computeCentre=function(){switch(this.extremalPts.length){case 0:this.centre=null;break;case 1:this.centre=this.extremalPts[0];break;case 2:this.centre=new jsts.geom.Coordinate((this.extremalPts[0].x+this.extremalPts[1].x)/2,(this.extremalPts[0].y+this.extremalPts[1].y)/2);break;case 3:this.centre=jsts.geom.Triangle.circumcentre(this.extremalPts[0],this.extremalPts[1],this.extremalPts[2]);break;}};jsts.algorithm.MinimumBoundingCircle.prototype.compute=function(){if(this.extremalPts!==null){return;}
this.computeCirclePoints();this.computeCentre();if(this.centre!==null){this.radius=this.centre.distance(this.extremalPts[0]);}};jsts.algorithm.MinimumBoundingCircle.prototype.computeCirclePoints=function(){if(this.input.isEmpty()){this.extremalPts=[];return;}
var pts;if(this.input.getNumPoints()===1){pts=this.input.getCoordinates();this.extremalPts=[new jsts.geom.Coordinate(pts[0])];return;}
var convexHull=this.input.convexHull();var hullPts=convexHull.getCoordinates();pts=hullPts;if(hullPts[0].equals2D(hullPts[hullPts.length-1])){pts=[];jsts.geom.CoordinateArrays.copyDeep(hullPts,0,pts,0,hullPts.length-1);}
if(pts.length<=2){this.extremalPts=jsts.geom.CoordinateArrays.copyDeep(pts);return;}
var P=jsts.algorithm.MinimumBoundingCircle.lowestPoint(pts);var Q=jsts.algorithm.MinimumBoundingCircle.pointWitMinAngleWithX(pts,P);for(var i=0;i<pts.length;i++){var R=jsts.algorithm.MinimumBoundingCircle.pointWithMinAngleWithSegment(pts,P,Q);if(jsts.algorithm.Angle.isObtuse(P,R,Q)){this.extremalPts=[new jsts.geom.Coordinate(P),new jsts.geom.Coordinate(Q)];return;}
if(jsts.algorithm.Angle.isObtuse(R,P,Q)){P=R;continue;}
if(jsts.algorithm.Angle.isObtuse(R,Q,P)){Q=R;continue;}
this.extremalPts=[new jsts.geom.Coordinate(P),new jsts.geom.Coordinate(Q),new jsts.geom.Coordinate(R)];return;}
throw new Error("Logic failure in Minimum Bounding Circle algorithm!");};jsts.algorithm.MinimumBoundingCircle.lowestPoint=function(pts){var min=pts[0];for(var i=1;i<pts.length;i++){if(pts[i].y<min.y){min=pts[i];}}
return min;};jsts.algorithm.MinimumBoundingCircle.pointWitMinAngleWithX=function(pts,P){var minSin=Number.MAX_VALUE;var minAngPt=null;for(var i=0;i<pts.length;i++){var p=pts[i];if(p===P)continue;var dx=p.x-P.x;var dy=p.y-P.y;if(dy<0)dy=-dy;var len=Math.sqrt(dx*dx+dy*dy);var sin=dy/len;if(sin<minSin){minSin=sin;minAngPt=p;}}
return minAngPt;};jsts.algorithm.MinimumBoundingCircle.pointWithMinAngleWithSegment=function(pts,P,Q){var minAng=Number.MAX_VALUE;var minAngPt=null;for(var i=0;i<pts.length;i++){var p=pts[i];if(p===P)continue;if(p===Q)continue;var ang=jsts.algorithm.Angle.angleBetween(P,p,Q);if(ang<minAng){minAng=ang;minAngPt=p;}}
return minAngPt;};jsts.noding.ScaledNoder=function(noder,scaleFactor,offsetX,offsetY){this.offsetX=offsetX?offsetX:0;this.offsetY=offsetY?offsetY:0;this.noder=noder;this.scaleFactor=scaleFactor;this.isScaled=!this.isIntegerPrecision();};jsts.noding.ScaledNoder.prototype=new jsts.noding.Noder();jsts.noding.ScaledNoder.constructor=jsts.noding.ScaledNoder;jsts.noding.ScaledNoder.prototype.noder=null;jsts.noding.ScaledNoder.prototype.scaleFactor=undefined;jsts.noding.ScaledNoder.prototype.offsetX=undefined;jsts.noding.ScaledNoder.prototype.offsetY=undefined;jsts.noding.ScaledNoder.prototype.isScaled=false;jsts.noding.ScaledNoder.prototype.isIntegerPrecision=function(){return this.scaleFactor===1.0;};jsts.noding.ScaledNoder.prototype.getNodedSubstrings=function(){var splitSS=this.noder.getNodedSubstrings();if(this.isScaled)
this.rescale(splitSS);return splitSS;};jsts.noding.ScaledNoder.prototype.computeNodes=function(inputSegStrings){var intSegStrings=inputSegStrings;if(this.isScaled)
intSegStrings=this.scale(inputSegStrings);this.noder.computeNodes(intSegStrings);};jsts.noding.ScaledNoder.prototype.scale=function(segStrings){if(segStrings instanceof Array){return this.scale2(segStrings);}
var transformed=new javascript.util.ArrayList();for(var i=segStrings.iterator();i.hasNext();){var ss=i.next();transformed.add(new jsts.noding.NodedSegmentString(this.scale(ss.getCoordinates()),ss.getData()));}
return transformed;};jsts.noding.ScaledNoder.prototype.scale2=function(pts){var roundPts=[];for(var i=0;i<pts.length;i++){roundPts[i]=new jsts.geom.Coordinate(Math.round((pts[i].x-this.offsetX)*this.scaleFactor),Math.round((pts[i].y-this.offsetY)*this.scaleFactor));}
var roundPtsNoDup=jsts.geom.CoordinateArrays.removeRepeatedPoints(roundPts);return roundPtsNoDup;};jsts.noding.ScaledNoder.prototype.rescale=function(segStrings){if(segStrings instanceof Array){this.rescale2(segStrings);return;}
for(var i=segStrings.iterator();i.hasNext();){var ss=i.next();this.rescale(ss.getCoordinates());}};jsts.noding.ScaledNoder.prototype.rescale2=function(pts){for(var i=0;i<pts.length;i++){pts[i].x=pts[i].x/this.scaleFactor+this.offsetX;pts[i].y=pts[i].y/this.scaleFactor+this.offsetY;}};(function(){var ArrayList=javascript.util.ArrayList;jsts.geomgraph.index.SegmentIntersector=function(li,includeProper,recordIsolated){this.li=li;this.includeProper=includeProper;this.recordIsolated=recordIsolated;};jsts.geomgraph.index.SegmentIntersector.isAdjacentSegments=function(i1,i2){return Math.abs(i1-i2)===1;};jsts.geomgraph.index.SegmentIntersector.prototype._hasIntersection=false;jsts.geomgraph.index.SegmentIntersector.prototype.hasProper=false;jsts.geomgraph.index.SegmentIntersector.prototype.hasProperInterior=false;jsts.geomgraph.index.SegmentIntersector.prototype.properIntersectionPoint=null;jsts.geomgraph.index.SegmentIntersector.prototype.li=null;jsts.geomgraph.index.SegmentIntersector.prototype.includeProper=null;jsts.geomgraph.index.SegmentIntersector.prototype.recordIsolated=null;jsts.geomgraph.index.SegmentIntersector.prototype.isSelfIntersection=null;jsts.geomgraph.index.SegmentIntersector.prototype.numIntersections=0;jsts.geomgraph.index.SegmentIntersector.prototype.numTests=0;jsts.geomgraph.index.SegmentIntersector.prototype.bdyNodes=null;jsts.geomgraph.index.SegmentIntersector.prototype.setBoundaryNodes=function(bdyNodes0,bdyNodes1){this.bdyNodes=[];this.bdyNodes[0]=bdyNodes0;this.bdyNodes[1]=bdyNodes1;};jsts.geomgraph.index.SegmentIntersector.prototype.getProperIntersectionPoint=function(){return this.properIntersectionPoint;};jsts.geomgraph.index.SegmentIntersector.prototype.hasIntersection=function(){return this._hasIntersection;};jsts.geomgraph.index.SegmentIntersector.prototype.hasProperIntersection=function(){return this.hasProper;};jsts.geomgraph.index.SegmentIntersector.prototype.hasProperInteriorIntersection=function(){return this.hasProperInterior;};jsts.geomgraph.index.SegmentIntersector.prototype.isTrivialIntersection=function(e0,segIndex0,e1,segIndex1){if(e0===e1){if(this.li.getIntersectionNum()===1){if(jsts.geomgraph.index.SegmentIntersector.isAdjacentSegments(segIndex0,segIndex1))
return true;if(e0.isClosed()){var maxSegIndex=e0.getNumPoints()-1;if((segIndex0===0&&segIndex1===maxSegIndex)||(segIndex1===0&&segIndex0===maxSegIndex)){return true;}}}}
return false;};jsts.geomgraph.index.SegmentIntersector.prototype.addIntersections=function(e0,segIndex0,e1,segIndex1){if(e0===e1&&segIndex0===segIndex1)
return;this.numTests++;var p00=e0.getCoordinates()[segIndex0];var p01=e0.getCoordinates()[segIndex0+1];var p10=e1.getCoordinates()[segIndex1];var p11=e1.getCoordinates()[segIndex1+1];this.li.computeIntersection(p00,p01,p10,p11);if(this.li.hasIntersection()){if(this.recordIsolated){e0.setIsolated(false);e1.setIsolated(false);}
this.numIntersections++;if(!this.isTrivialIntersection(e0,segIndex0,e1,segIndex1)){this._hasIntersection=true;if(this.includeProper||!this.li.isProper()){e0.addIntersections(this.li,segIndex0,0);e1.addIntersections(this.li,segIndex1,1);}
if(this.li.isProper()){this.properIntersectionPoint=this.li.getIntersection(0).clone();this.hasProper=true;if(!this.isBoundaryPoint(this.li,this.bdyNodes))
this.hasProperInterior=true;}}}};jsts.geomgraph.index.SegmentIntersector.prototype.isBoundaryPoint=function(li,bdyNodes){if(bdyNodes===null)
return false;if(bdyNodes instanceof Array){if(this.isBoundaryPoint(li,bdyNodes[0]))
return true;if(this.isBoundaryPoint(li,bdyNodes[1]))
return true;return false;}else{for(var i=bdyNodes.iterator();i.hasNext();){var node=i.next();var pt=node.getCoordinate();if(li.isIntersection(pt))
return true;}
return false;}};})();
},{}],6:[function(require,module,exports){
(function (global){
/*
  javascript.util is a port of selected parts of java.util to JavaScript which
  main purpose is to ease porting Java code to JavaScript.
  
  The MIT License (MIT)

  Copyright (C) 2011-2014 by The Authors

  Permission is hereby granted, free of charge, to any person obtaining a copy
  of this software and associated documentation files (the "Software"), to deal
  in the Software without restriction, including without limitation the rights
  to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
  copies of the Software, and to permit persons to whom the Software is
  furnished to do so, subject to the following conditions:

  The above copyright notice and this permission notice shall be included in
  all copies or substantial portions of the Software.

  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
  FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
  OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
  THE SOFTWARE.
*/
;(function(){var e=this;function f(a,b){var c=a.split("."),d=e;c[0]in d||!d.execScript||d.execScript("var "+c[0]);for(var t;c.length&&(t=c.shift());)c.length||void 0===b?d=d[t]?d[t]:d[t]={}:d[t]=b}function g(a,b){function c(){}c.prototype=b.prototype;a.q=b.prototype;a.prototype=new c;a.prototype.constructor=a;a.p=function(a,c,O){var M=Array.prototype.slice.call(arguments,2);return b.prototype[c].apply(a,M)}};function h(a){this.message=a||""}g(h,Error);f("javascript.util.EmptyStackException",h);h.prototype.name="EmptyStackException";function k(a){this.message=a||""}g(k,Error);f("javascript.util.IndexOutOfBoundsException",k);k.prototype.name="IndexOutOfBoundsException";function l(){}f("javascript.util.Iterator",l);l.prototype.hasNext=l.prototype.c;l.prototype.next=l.prototype.next;l.prototype.remove=l.prototype.remove;function m(){}f("javascript.util.Collection",m);function n(){}g(n,m);f("javascript.util.List",n);function p(){}f("javascript.util.Map",p);function q(a){this.message=a||""}g(q,Error);f("javascript.util.NoSuchElementException",q);q.prototype.name="NoSuchElementException";function r(a){this.message=a||""}g(r,Error);r.prototype.name="OperationNotSupported";function s(a){this.a=[];a instanceof m&&this.e(a)}g(s,n);f("javascript.util.ArrayList",s);s.prototype.a=null;s.prototype.add=function(a){this.a.push(a);return!0};s.prototype.add=s.prototype.add;s.prototype.e=function(a){for(a=a.f();a.c();)this.add(a.next());return!0};s.prototype.addAll=s.prototype.e;s.prototype.set=function(a,b){var c=this.a[a];this.a[a]=b;return c};s.prototype.set=s.prototype.set;s.prototype.f=function(){return new u(this)};s.prototype.iterator=s.prototype.f;
s.prototype.get=function(a){if(0>a||a>=this.size())throw new k;return this.a[a]};s.prototype.get=s.prototype.get;s.prototype.g=function(){return 0===this.a.length};s.prototype.isEmpty=s.prototype.g;s.prototype.size=function(){return this.a.length};s.prototype.size=s.prototype.size;s.prototype.h=function(){for(var a=[],b=0,c=this.a.length;b<c;b++)a.push(this.a[b]);return a};s.prototype.toArray=s.prototype.h;
s.prototype.remove=function(a){for(var b=!1,c=0,d=this.a.length;c<d;c++)if(this.a[c]===a){this.a.splice(c,1);b=!0;break}return b};s.prototype.remove=s.prototype.remove;function u(a){this.j=a}f("$jscomp.scope.Iterator_",u);u.prototype.j=null;u.prototype.b=0;u.prototype.next=function(){if(this.b===this.j.size())throw new q;return this.j.get(this.b++)};u.prototype.next=u.prototype.next;u.prototype.c=function(){return this.b<this.j.size()?!0:!1};u.prototype.hasNext=u.prototype.c;
u.prototype.remove=function(){throw new r;};u.prototype.remove=u.prototype.remove;function v(){}f("javascript.util.Arrays",v);
v.sort=function(){var a=arguments[0],b,c,d;if(1===arguments.length)a.sort();else if(2===arguments.length)c=arguments[1],d=function(a,b){return c.compare(a,b)},a.sort(d);else if(3===arguments.length)for(b=a.slice(arguments[1],arguments[2]),b.sort(),d=a.slice(0,arguments[1]).concat(b,a.slice(arguments[2],a.length)),a.splice(0,a.length),b=0;b<d.length;b++)a.push(d[b]);else if(4===arguments.length)for(b=a.slice(arguments[1],arguments[2]),c=arguments[3],d=function(a,b){return c.compare(a,b)},b.sort(d),
d=a.slice(0,arguments[1]).concat(b,a.slice(arguments[2],a.length)),a.splice(0,a.length),b=0;b<d.length;b++)a.push(d[b])};v.asList=function(a){for(var b=new s,c=0,d=a.length;c<d;c++)b.add(a[c]);return b};function w(){this.i={}}g(w,p);f("javascript.util.HashMap",w);w.prototype.i=null;w.prototype.get=function(a){return this.i[a]||null};w.prototype.get=w.prototype.get;w.prototype.put=function(a,b){return this.i[a]=b};w.prototype.put=w.prototype.put;w.prototype.m=function(){var a=new s,b;for(b in this.i)this.i.hasOwnProperty(b)&&a.add(this.i[b]);return a};w.prototype.values=w.prototype.m;w.prototype.size=function(){return this.m().size()};w.prototype.size=w.prototype.size;function x(){}g(x,m);f("javascript.util.Set",x);function y(a){this.a=[];a instanceof m&&this.e(a)}g(y,x);f("javascript.util.HashSet",y);y.prototype.a=null;y.prototype.contains=function(a){for(var b=0,c=this.a.length;b<c;b++)if(this.a[b]===a)return!0;return!1};y.prototype.contains=y.prototype.contains;y.prototype.add=function(a){if(this.contains(a))return!1;this.a.push(a);return!0};y.prototype.add=y.prototype.add;y.prototype.e=function(a){for(a=a.f();a.c();)this.add(a.next());return!0};y.prototype.addAll=y.prototype.e;
y.prototype.remove=function(){throw new r;};y.prototype.remove=y.prototype.remove;y.prototype.size=function(){return this.a.length};y.prototype.g=function(){return 0===this.a.length};y.prototype.isEmpty=y.prototype.g;y.prototype.h=function(){for(var a=[],b=0,c=this.a.length;b<c;b++)a.push(this.a[b]);return a};y.prototype.toArray=y.prototype.h;y.prototype.f=function(){return new z(this)};y.prototype.iterator=y.prototype.f;function z(a){this.k=a}f("$jscomp.scope.Iterator_$1",z);z.prototype.k=null;
z.prototype.b=0;z.prototype.next=function(){if(this.b===this.k.size())throw new q;return this.k.a[this.b++]};z.prototype.next=z.prototype.next;z.prototype.c=function(){return this.b<this.k.size()?!0:!1};z.prototype.hasNext=z.prototype.c;z.prototype.remove=function(){throw new r;};z.prototype.remove=z.prototype.remove;function A(){}g(A,p);f("javascript.util.SortedMap",A);function B(){}g(B,x);f("javascript.util.SortedSet",B);function C(){this.a=[]}g(C,n);f("javascript.util.Stack",C);C.prototype.a=null;C.prototype.push=function(a){this.a.push(a);return a};C.prototype.push=C.prototype.push;C.prototype.pop=function(){if(0===this.a.length)throw new h;return this.a.pop()};C.prototype.pop=C.prototype.pop;C.prototype.o=function(){if(0===this.a.length)throw new h;return this.a[this.a.length-1]};C.prototype.peek=C.prototype.o;C.prototype.empty=function(){return 0===this.a.length?!0:!1};C.prototype.empty=C.prototype.empty;
C.prototype.g=function(){return this.empty()};C.prototype.isEmpty=C.prototype.g;C.prototype.search=function(a){return this.a.indexOf(a)};C.prototype.search=C.prototype.search;C.prototype.size=function(){return this.a.length};C.prototype.size=C.prototype.size;C.prototype.h=function(){for(var a=[],b=0,c=this.a.length;b<c;b++)a.push(this.a[b]);return a};C.prototype.toArray=C.prototype.h;function D(a){return null==a?null:a.parent}function E(a,b){null!==a&&(a.color=b)}function F(a){return null==a?null:a.left}function G(a){return null==a?null:a.right}function H(){this.d=null;this.n=0}g(H,A);f("javascript.util.TreeMap",H);H.prototype.get=function(a){for(var b=this.d;null!==b;){var c=a.compareTo(b.key);if(0>c)b=b.left;else if(0<c)b=b.right;else return b.value}return null};H.prototype.get=H.prototype.get;
H.prototype.put=function(a,b){if(null===this.d)return this.d={key:a,value:b,left:null,right:null,parent:null,color:0},this.n=1,null;var c=this.d,d,t;do if(d=c,t=a.compareTo(c.key),0>t)c=c.left;else if(0<t)c=c.right;else return d=c.value,c.value=b,d;while(null!==c);c={key:a,left:null,right:null,value:b,parent:d,color:0};0>t?d.left=c:d.right=c;for(c.color=1;null!=c&&c!=this.d&&1==c.parent.color;)D(c)==F(D(D(c)))?(d=G(D(D(c))),1==(null==d?0:d.color)?(E(D(c),0),E(d,0),E(D(D(c)),1),c=D(D(c))):(c==G(D(c))&&
(c=D(c),I(this,c)),E(D(c),0),E(D(D(c)),1),J(this,D(D(c))))):(d=F(D(D(c))),1==(null==d?0:d.color)?(E(D(c),0),E(d,0),E(D(D(c)),1),c=D(D(c))):(c==F(D(c))&&(c=D(c),J(this,c)),E(D(c),0),E(D(D(c)),1),I(this,D(D(c)))));this.d.color=0;this.n++;return null};H.prototype.put=H.prototype.put;H.prototype.m=function(){var a=new s,b;b=this.d;if(null!=b)for(;null!=b.left;)b=b.left;if(null!==b)for(a.add(b.value);null!==(b=K(b));)a.add(b.value);return a};H.prototype.values=H.prototype.m;
function I(a,b){if(null!=b){var c=b.right;b.right=c.left;null!=c.left&&(c.left.parent=b);c.parent=b.parent;null==b.parent?a.d=c:b.parent.left==b?b.parent.left=c:b.parent.right=c;c.left=b;b.parent=c}}function J(a,b){if(null!=b){var c=b.left;b.left=c.right;null!=c.right&&(c.right.parent=b);c.parent=b.parent;null==b.parent?a.d=c:b.parent.right==b?b.parent.right=c:b.parent.left=c;c.right=b;b.parent=c}}
function K(a){if(null===a)return null;if(null!==a.right)for(var b=a.right;null!==b.left;)b=b.left;else for(b=a.parent;null!==b&&a===b.right;)a=b,b=b.parent;return b}H.prototype.size=function(){return this.n};H.prototype.size=H.prototype.size;function L(a){this.a=[];a instanceof m&&this.e(a)}g(L,B);f("javascript.util.TreeSet",L);L.prototype.a=null;L.prototype.contains=function(a){for(var b=0,c=this.a.length;b<c;b++)if(0===this.a[b].compareTo(a))return!0;return!1};L.prototype.contains=L.prototype.contains;L.prototype.add=function(a){if(this.contains(a))return!1;for(var b=0,c=this.a.length;b<c;b++)if(1===this.a[b].compareTo(a))return this.a.splice(b,0,a),!0;this.a.push(a);return!0};L.prototype.add=L.prototype.add;
L.prototype.e=function(a){for(a=a.f();a.c();)this.add(a.next());return!0};L.prototype.addAll=L.prototype.e;L.prototype.remove=function(){throw new r;};L.prototype.remove=L.prototype.remove;L.prototype.size=function(){return this.a.length};L.prototype.size=L.prototype.size;L.prototype.g=function(){return 0===this.a.length};L.prototype.isEmpty=L.prototype.g;L.prototype.h=function(){for(var a=[],b=0,c=this.a.length;b<c;b++)a.push(this.a[b]);return a};L.prototype.toArray=L.prototype.h;L.prototype.f=function(){return new N(this)};
L.prototype.iterator=L.prototype.f;function N(a){this.l=a}f("$jscomp.scope.Iterator_$2",N);N.prototype.l=null;N.prototype.b=0;N.prototype.next=function(){if(this.b===this.l.size())throw new q;return this.l.a[this.b++]};N.prototype.next=N.prototype.next;N.prototype.c=function(){return this.b<this.l.size()?!0:!1};N.prototype.hasNext=N.prototype.c;N.prototype.remove=function(){throw new r;};N.prototype.remove=N.prototype.remove;"undefined"!==typeof global&&(global.javascript={},global.javascript.util={},global.javascript.util.ArrayList=s,global.javascript.util.Arrays=v,global.javascript.util.Collection=m,global.javascript.util.EmptyStackException=h,global.javascript.util.HashMap=w,global.javascript.util.HashSet=y,global.javascript.util.IndexOutOfBoundsException=k,global.javascript.util.Iterator=l,global.javascript.util.List=n,global.javascript.util.Map=p,global.javascript.util.NoSuchElementException=q,global.javascript.util.OperationNotSupported=
r,global.javascript.util.Set=x,global.javascript.util.SortedMap=A,global.javascript.util.SortedSet=B,global.javascript.util.Stack=C,global.javascript.util.TreeMap=H,global.javascript.util.TreeSet=L);}).call(this);

}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})

},{}],7:[function(require,module,exports){
require('./dist/javascript.util-node.min.js');

},{"./dist/javascript.util-node.min.js":6}],8:[function(require,module,exports){
/**
 * Takes one or more {@link Feature|Features} and creates a {@link FeatureCollection}
 *
 * @module turf/featurecollection
 * @category helper
 * @param {Feature} features input Features
 * @returns {FeatureCollection} a FeatureCollection of input features
 * @example
 * var features = [
 *  turf.point([-75.343, 39.984], {name: 'Location A'}),
 *  turf.point([-75.833, 39.284], {name: 'Location B'}),
 *  turf.point([-75.534, 39.123], {name: 'Location C'})
 * ];
 *
 * var fc = turf.featurecollection(features);
 *
 * //=fc
 */
module.exports = function(features){
  return {
    type: "FeatureCollection",
    features: features
  };
};

},{}],9:[function(require,module,exports){
arguments[4][8][0].apply(exports,arguments)
},{"dup":8}],10:[function(require,module,exports){
var inside = require('turf-inside');
var featureCollection = require('turf-featurecollection');

/**
 * Takes a {@link FeatureCollection} of {@link Point} features and a FeatureCollection of {@link Polygon} features and returns a FeatureCollection of Point features representing all points that fall within a collection of polygons.
 *
 * @module turf/within
 * @category joins
 * @param {FeatureCollection} points a FeatureCollection of {@link Point} features
 * @param {FeatureCollection} polygons a FeatureCollection of {@link Polygon} features
 * @return {FeatureCollection} a collection of all points that land
 * within at least one polygon
 * @example
 * var searchWithin = {
 *   "type": "FeatureCollection",
 *   "features": [
 *     {
 *       "type": "Feature",
 *       "properties": {},
 *       "geometry": {
 *         "type": "Polygon",
 *         "coordinates": [[
 *           [-46.653,-23.543],
 *           [-46.634,-23.5346],
 *           [-46.613,-23.543],
 *           [-46.614,-23.559],
 *           [-46.631,-23.567],
 *           [-46.653,-23.560],
 *           [-46.653,-23.543]
 *         ]]
 *       }
 *     }
 *   ]
 * };
 * var points = {
 *   "type": "FeatureCollection",
 *   "features": [
 *     {
 *       "type": "Feature",
 *       "properties": {},
 *       "geometry": {
 *         "type": "Point",
 *         "coordinates": [-46.6318, -23.5523]
 *       }
 *     }, {
 *       "type": "Feature",
 *       "properties": {},
 *       "geometry": {
 *         "type": "Point",
 *         "coordinates": [-46.6246, -23.5325]
 *       }
 *     }, {
 *       "type": "Feature",
 *       "properties": {},
 *       "geometry": {
 *         "type": "Point",
 *         "coordinates": [-46.6062, -23.5513]
 *       }
 *     }, {
 *       "type": "Feature",
 *       "properties": {},
 *       "geometry": {
 *         "type": "Point",
 *         "coordinates": [-46.663, -23.554]
 *       }
 *     }, {
 *       "type": "Feature",
 *       "properties": {},
 *       "geometry": {
 *         "type": "Point",
 *         "coordinates": [-46.643, -23.557]
 *       }
 *     }
 *   ]
 * };
 *
 * var ptsWithin = turf.within(points, searchWithin);
 *
 * //=points
 *
 * //=searchWithin
 *
 * //=ptsWithin
 */
module.exports = function(ptFC, polyFC){
  var pointsWithin = featureCollection([]);
  for (var i = 0; i < polyFC.features.length; i++) {
    for (var j = 0; j < ptFC.features.length; j++) {
      var isInside = inside(ptFC.features[j], polyFC.features[i]);
      if(isInside){
        pointsWithin.features.push(ptFC.features[j]);
      }
    }
  }
  return pointsWithin;
};

},{"turf-featurecollection":11,"turf-inside":12}],11:[function(require,module,exports){
arguments[4][8][0].apply(exports,arguments)
},{"dup":8}],12:[function(require,module,exports){
// http://en.wikipedia.org/wiki/Even%E2%80%93odd_rule
// modified from: https://github.com/substack/point-in-polygon/blob/master/index.js
// which was modified from http://www.ecse.rpi.edu/Homepages/wrf/Research/Short_Notes/pnpoly.html

/**
 * Takes a {@link Point} feature and a {@link Polygon} feature and determines if the Point resides inside the Polygon. The Polygon can
 * be convex or concave. The function accepts any valid Polygon or {@link MultiPolygon}
 * and accounts for holes.
 *
 * @module turf/inside
 * @category joins
 * @param {Point} point a Point feature
 * @param {Polygon} polygon a Polygon feature
 * @return {Boolean} `true` if the Point is inside the Polygon; `false` if the Point is not inside the Polygon
 * @example
 * var pt1 = {
 *   "type": "Feature",
 *   "properties": {
 *     "marker-color": "#f00"
 *   },
 *   "geometry": {
 *     "type": "Point",
 *     "coordinates": [-111.467285, 40.75766]
 *   }
 * };
 * var pt2 = {
 *   "type": "Feature",
 *   "properties": {
 *     "marker-color": "#0f0"
 *   },
 *   "geometry": {
 *     "type": "Point",
 *     "coordinates": [-111.873779, 40.647303]
 *   }
 * };
 * var poly = {
 *   "type": "Feature",
 *   "properties": {},
 *   "geometry": {
 *     "type": "Polygon",
 *     "coordinates": [[
 *       [-112.074279, 40.52215],
 *       [-112.074279, 40.853293],
 *       [-111.610107, 40.853293],
 *       [-111.610107, 40.52215],
 *       [-112.074279, 40.52215]
 *     ]]
 *   }
 * };
 *
 * var features = {
 *   "type": "FeatureCollection",
 *   "features": [pt1, pt2, poly]
 * };
 *
 * //=features
 *
 * var isInside1 = turf.inside(pt1, poly);
 * //=isInside1
 *
 * var isInside2 = turf.inside(pt2, poly);
 * //=isInside2
 */
module.exports = function(point, polygon) {
  var polys = polygon.geometry.coordinates;
  var pt = [point.geometry.coordinates[0], point.geometry.coordinates[1]];
  // normalize to multipolygon
  if(polygon.geometry.type === 'Polygon') polys = [polys];

  var insidePoly = false;
  var i = 0;
  while (i < polys.length && !insidePoly) {
    // check if it is in the outer ring first
    if(inRing(pt, polys[i][0])) {
      var inHole = false;
      var k = 1;
      // check for the point in any of the holes
      while(k < polys[i].length && !inHole) {
        if(inRing(pt, polys[i][k])) {
          inHole = true;
        }
        k++;
      }
      if(!inHole) insidePoly = true;
    }
    i++;
  }
  return insidePoly;
}

// pt is [x,y] and ring is [[x,y], [x,y],..]
function inRing (pt, ring) {
  var isInside = false;
  for (var i = 0, j = ring.length - 1; i < ring.length; j = i++) {
    var xi = ring[i][0], yi = ring[i][1];
    var xj = ring[j][0], yj = ring[j][1];
    
    var intersect = ((yi > pt[1]) != (yj > pt[1]))
        && (pt[0] < (xj - xi) * (pt[1] - yi) / (yj - yi) + xi);
    if (intersect) isInside = !isInside;
  }
  return isInside;
}


},{}],13:[function(require,module,exports){
var buffer = require('turf-buffer');
var within = require('turf-within');
var fc = require('turf-featurecollection');

var $ = require('jquery');
//var turf = require('turf');

var baseURI = window.location.href;

L.mapbox.accessToken = 'pk.eyJ1Ijoic3J0aHVybWFuIiwiYSI6IkVGXy1NMHcifQ.EouINDEZGzjGs0x0VMhHxg';

var map = L.mapbox.map('map','srthurman.n9l71i86')
    .setView([38.901078, -77.024361], 14);
    
var wmataRoutes = L.mapbox.featureLayer()
    .loadURL('https://transitnearme-srthurman.c9.io/wmataRoutes')
    .addTo(map);
    
var marker = L.marker(new L.LatLng(38.901078, -77.024361), {
    icon: L.mapbox.marker.icon({
        "marker-color": "#FF00FF",
        "title": "You need coffee",
        "marker-symbol": "pitch",
        "marker-size": "large"
    }),
    draggable: true,
    zIndexOffset:999
}).addTo(map);

var bufferLayer = L.mapbox.featureLayer().addTo(map);

var bufferCntr = marker.getLatLng();
var pt = {
  "type": "Feature",
  "properties": {},
  "geometry": {
    "type": "Point",
    "coordinates": [bufferCntr.lng, bufferCntr.lat]
  }
};

var transitBuffer = buffer(pt, 0.5, 'miles');

transitBuffer.properties = {
                "fill": "#00704A",
                "fill-opacity":0.05,
                "stroke": "#00704A",
                "stroke-width": 2,
                "stroke-opacity": 0.5
            };

bufferLayer.setGeoJSON(transitBuffer);

//load stops and filter based on buffer
var filteredStops = L.mapbox.featureLayer().addTo(map);

$.get('https://transitnearme-srthurman.c9.io/wmataStops', function(data) {
    var stops = within(data, fc([transitBuffer]));
    filteredStops.setGeoJSON(stops);
});
},{"jquery":1,"turf-buffer":2,"turf-featurecollection":9,"turf-within":10}]},{},[13])
//# sourceMappingURL=data:application/json;charset:utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy5udm0vdjAuMTAuMzUvbGliL25vZGVfbW9kdWxlcy93YXRjaGlmeS9ub2RlX21vZHVsZXMvYnJvd3NlcmlmeS9ub2RlX21vZHVsZXMvYnJvd3Nlci1wYWNrL19wcmVsdWRlLmpzIiwiLi4vbm9kZV9tb2R1bGVzL2pxdWVyeS9kaXN0L2pxdWVyeS5qcyIsIi4uL25vZGVfbW9kdWxlcy90dXJmLWJ1ZmZlci9pbmRleC5qcyIsIi4uL25vZGVfbW9kdWxlcy90dXJmLWJ1ZmZlci9ub2RlX21vZHVsZXMvZ2VvanNvbi1ub3JtYWxpemUvaW5kZXguanMiLCIuLi9ub2RlX21vZHVsZXMvdHVyZi1idWZmZXIvbm9kZV9tb2R1bGVzL2pzdHMvaW5kZXguanMiLCIuLi9ub2RlX21vZHVsZXMvdHVyZi1idWZmZXIvbm9kZV9tb2R1bGVzL2pzdHMvbGliL2pzdHMuanMiLCIuLi9ub2RlX21vZHVsZXMvdHVyZi1idWZmZXIvbm9kZV9tb2R1bGVzL2pzdHMvbm9kZV9tb2R1bGVzL2phdmFzY3JpcHQudXRpbC9kaXN0L2phdmFzY3JpcHQudXRpbC1ub2RlLm1pbi5qcyIsIi4uL25vZGVfbW9kdWxlcy90dXJmLWJ1ZmZlci9ub2RlX21vZHVsZXMvanN0cy9ub2RlX21vZHVsZXMvamF2YXNjcmlwdC51dGlsL2luZGV4LmpzIiwiLi4vbm9kZV9tb2R1bGVzL3R1cmYtYnVmZmVyL25vZGVfbW9kdWxlcy90dXJmLWZlYXR1cmVjb2xsZWN0aW9uL2luZGV4LmpzIiwiLi4vbm9kZV9tb2R1bGVzL3R1cmYtd2l0aGluL2luZGV4LmpzIiwiLi4vbm9kZV9tb2R1bGVzL3R1cmYtd2l0aGluL25vZGVfbW9kdWxlcy90dXJmLWluc2lkZS9pbmRleC5qcyIsIm1hcC5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtBQ0FBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzEvUkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM1RUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMzQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDSEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FDNXFEQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7OztBQzFDQTtBQUNBOztBQ0RBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7O0FDeEJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7O0FDaEdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN4R0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwiZmlsZSI6ImdlbmVyYXRlZC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24gZSh0LG4scil7ZnVuY3Rpb24gcyhvLHUpe2lmKCFuW29dKXtpZighdFtvXSl7dmFyIGE9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtpZighdSYmYSlyZXR1cm4gYShvLCEwKTtpZihpKXJldHVybiBpKG8sITApO3ZhciBmPW5ldyBFcnJvcihcIkNhbm5vdCBmaW5kIG1vZHVsZSAnXCIrbytcIidcIik7dGhyb3cgZi5jb2RlPVwiTU9EVUxFX05PVF9GT1VORFwiLGZ9dmFyIGw9bltvXT17ZXhwb3J0czp7fX07dFtvXVswXS5jYWxsKGwuZXhwb3J0cyxmdW5jdGlvbihlKXt2YXIgbj10W29dWzFdW2VdO3JldHVybiBzKG4/bjplKX0sbCxsLmV4cG9ydHMsZSx0LG4scil9cmV0dXJuIG5bb10uZXhwb3J0c312YXIgaT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2Zvcih2YXIgbz0wO288ci5sZW5ndGg7bysrKXMocltvXSk7cmV0dXJuIHN9KSIsIi8qIVxuICogalF1ZXJ5IEphdmFTY3JpcHQgTGlicmFyeSB2Mi4xLjRcbiAqIGh0dHA6Ly9qcXVlcnkuY29tL1xuICpcbiAqIEluY2x1ZGVzIFNpenpsZS5qc1xuICogaHR0cDovL3NpenpsZWpzLmNvbS9cbiAqXG4gKiBDb3B5cmlnaHQgMjAwNSwgMjAxNCBqUXVlcnkgRm91bmRhdGlvbiwgSW5jLiBhbmQgb3RoZXIgY29udHJpYnV0b3JzXG4gKiBSZWxlYXNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2VcbiAqIGh0dHA6Ly9qcXVlcnkub3JnL2xpY2Vuc2VcbiAqXG4gKiBEYXRlOiAyMDE1LTA0LTI4VDE2OjAxWlxuICovXG5cbihmdW5jdGlvbiggZ2xvYmFsLCBmYWN0b3J5ICkge1xuXG5cdGlmICggdHlwZW9mIG1vZHVsZSA9PT0gXCJvYmplY3RcIiAmJiB0eXBlb2YgbW9kdWxlLmV4cG9ydHMgPT09IFwib2JqZWN0XCIgKSB7XG5cdFx0Ly8gRm9yIENvbW1vbkpTIGFuZCBDb21tb25KUy1saWtlIGVudmlyb25tZW50cyB3aGVyZSBhIHByb3BlciBgd2luZG93YFxuXHRcdC8vIGlzIHByZXNlbnQsIGV4ZWN1dGUgdGhlIGZhY3RvcnkgYW5kIGdldCBqUXVlcnkuXG5cdFx0Ly8gRm9yIGVudmlyb25tZW50cyB0aGF0IGRvIG5vdCBoYXZlIGEgYHdpbmRvd2Agd2l0aCBhIGBkb2N1bWVudGBcblx0XHQvLyAoc3VjaCBhcyBOb2RlLmpzKSwgZXhwb3NlIGEgZmFjdG9yeSBhcyBtb2R1bGUuZXhwb3J0cy5cblx0XHQvLyBUaGlzIGFjY2VudHVhdGVzIHRoZSBuZWVkIGZvciB0aGUgY3JlYXRpb24gb2YgYSByZWFsIGB3aW5kb3dgLlxuXHRcdC8vIGUuZy4gdmFyIGpRdWVyeSA9IHJlcXVpcmUoXCJqcXVlcnlcIikod2luZG93KTtcblx0XHQvLyBTZWUgdGlja2V0ICMxNDU0OSBmb3IgbW9yZSBpbmZvLlxuXHRcdG1vZHVsZS5leHBvcnRzID0gZ2xvYmFsLmRvY3VtZW50ID9cblx0XHRcdGZhY3RvcnkoIGdsb2JhbCwgdHJ1ZSApIDpcblx0XHRcdGZ1bmN0aW9uKCB3ICkge1xuXHRcdFx0XHRpZiAoICF3LmRvY3VtZW50ICkge1xuXHRcdFx0XHRcdHRocm93IG5ldyBFcnJvciggXCJqUXVlcnkgcmVxdWlyZXMgYSB3aW5kb3cgd2l0aCBhIGRvY3VtZW50XCIgKTtcblx0XHRcdFx0fVxuXHRcdFx0XHRyZXR1cm4gZmFjdG9yeSggdyApO1xuXHRcdFx0fTtcblx0fSBlbHNlIHtcblx0XHRmYWN0b3J5KCBnbG9iYWwgKTtcblx0fVxuXG4vLyBQYXNzIHRoaXMgaWYgd2luZG93IGlzIG5vdCBkZWZpbmVkIHlldFxufSh0eXBlb2Ygd2luZG93ICE9PSBcInVuZGVmaW5lZFwiID8gd2luZG93IDogdGhpcywgZnVuY3Rpb24oIHdpbmRvdywgbm9HbG9iYWwgKSB7XG5cbi8vIFN1cHBvcnQ6IEZpcmVmb3ggMTgrXG4vLyBDYW4ndCBiZSBpbiBzdHJpY3QgbW9kZSwgc2V2ZXJhbCBsaWJzIGluY2x1ZGluZyBBU1AuTkVUIHRyYWNlXG4vLyB0aGUgc3RhY2sgdmlhIGFyZ3VtZW50cy5jYWxsZXIuY2FsbGVlIGFuZCBGaXJlZm94IGRpZXMgaWZcbi8vIHlvdSB0cnkgdG8gdHJhY2UgdGhyb3VnaCBcInVzZSBzdHJpY3RcIiBjYWxsIGNoYWlucy4gKCMxMzMzNSlcbi8vXG5cbnZhciBhcnIgPSBbXTtcblxudmFyIHNsaWNlID0gYXJyLnNsaWNlO1xuXG52YXIgY29uY2F0ID0gYXJyLmNvbmNhdDtcblxudmFyIHB1c2ggPSBhcnIucHVzaDtcblxudmFyIGluZGV4T2YgPSBhcnIuaW5kZXhPZjtcblxudmFyIGNsYXNzMnR5cGUgPSB7fTtcblxudmFyIHRvU3RyaW5nID0gY2xhc3MydHlwZS50b1N0cmluZztcblxudmFyIGhhc093biA9IGNsYXNzMnR5cGUuaGFzT3duUHJvcGVydHk7XG5cbnZhciBzdXBwb3J0ID0ge307XG5cblxuXG52YXJcblx0Ly8gVXNlIHRoZSBjb3JyZWN0IGRvY3VtZW50IGFjY29yZGluZ2x5IHdpdGggd2luZG93IGFyZ3VtZW50IChzYW5kYm94KVxuXHRkb2N1bWVudCA9IHdpbmRvdy5kb2N1bWVudCxcblxuXHR2ZXJzaW9uID0gXCIyLjEuNFwiLFxuXG5cdC8vIERlZmluZSBhIGxvY2FsIGNvcHkgb2YgalF1ZXJ5XG5cdGpRdWVyeSA9IGZ1bmN0aW9uKCBzZWxlY3RvciwgY29udGV4dCApIHtcblx0XHQvLyBUaGUgalF1ZXJ5IG9iamVjdCBpcyBhY3R1YWxseSBqdXN0IHRoZSBpbml0IGNvbnN0cnVjdG9yICdlbmhhbmNlZCdcblx0XHQvLyBOZWVkIGluaXQgaWYgalF1ZXJ5IGlzIGNhbGxlZCAoanVzdCBhbGxvdyBlcnJvciB0byBiZSB0aHJvd24gaWYgbm90IGluY2x1ZGVkKVxuXHRcdHJldHVybiBuZXcgalF1ZXJ5LmZuLmluaXQoIHNlbGVjdG9yLCBjb250ZXh0ICk7XG5cdH0sXG5cblx0Ly8gU3VwcG9ydDogQW5kcm9pZDw0LjFcblx0Ly8gTWFrZSBzdXJlIHdlIHRyaW0gQk9NIGFuZCBOQlNQXG5cdHJ0cmltID0gL15bXFxzXFx1RkVGRlxceEEwXSt8W1xcc1xcdUZFRkZcXHhBMF0rJC9nLFxuXG5cdC8vIE1hdGNoZXMgZGFzaGVkIHN0cmluZyBmb3IgY2FtZWxpemluZ1xuXHRybXNQcmVmaXggPSAvXi1tcy0vLFxuXHRyZGFzaEFscGhhID0gLy0oW1xcZGEtel0pL2dpLFxuXG5cdC8vIFVzZWQgYnkgalF1ZXJ5LmNhbWVsQ2FzZSBhcyBjYWxsYmFjayB0byByZXBsYWNlKClcblx0ZmNhbWVsQ2FzZSA9IGZ1bmN0aW9uKCBhbGwsIGxldHRlciApIHtcblx0XHRyZXR1cm4gbGV0dGVyLnRvVXBwZXJDYXNlKCk7XG5cdH07XG5cbmpRdWVyeS5mbiA9IGpRdWVyeS5wcm90b3R5cGUgPSB7XG5cdC8vIFRoZSBjdXJyZW50IHZlcnNpb24gb2YgalF1ZXJ5IGJlaW5nIHVzZWRcblx0anF1ZXJ5OiB2ZXJzaW9uLFxuXG5cdGNvbnN0cnVjdG9yOiBqUXVlcnksXG5cblx0Ly8gU3RhcnQgd2l0aCBhbiBlbXB0eSBzZWxlY3RvclxuXHRzZWxlY3RvcjogXCJcIixcblxuXHQvLyBUaGUgZGVmYXVsdCBsZW5ndGggb2YgYSBqUXVlcnkgb2JqZWN0IGlzIDBcblx0bGVuZ3RoOiAwLFxuXG5cdHRvQXJyYXk6IGZ1bmN0aW9uKCkge1xuXHRcdHJldHVybiBzbGljZS5jYWxsKCB0aGlzICk7XG5cdH0sXG5cblx0Ly8gR2V0IHRoZSBOdGggZWxlbWVudCBpbiB0aGUgbWF0Y2hlZCBlbGVtZW50IHNldCBPUlxuXHQvLyBHZXQgdGhlIHdob2xlIG1hdGNoZWQgZWxlbWVudCBzZXQgYXMgYSBjbGVhbiBhcnJheVxuXHRnZXQ6IGZ1bmN0aW9uKCBudW0gKSB7XG5cdFx0cmV0dXJuIG51bSAhPSBudWxsID9cblxuXHRcdFx0Ly8gUmV0dXJuIGp1c3QgdGhlIG9uZSBlbGVtZW50IGZyb20gdGhlIHNldFxuXHRcdFx0KCBudW0gPCAwID8gdGhpc1sgbnVtICsgdGhpcy5sZW5ndGggXSA6IHRoaXNbIG51bSBdICkgOlxuXG5cdFx0XHQvLyBSZXR1cm4gYWxsIHRoZSBlbGVtZW50cyBpbiBhIGNsZWFuIGFycmF5XG5cdFx0XHRzbGljZS5jYWxsKCB0aGlzICk7XG5cdH0sXG5cblx0Ly8gVGFrZSBhbiBhcnJheSBvZiBlbGVtZW50cyBhbmQgcHVzaCBpdCBvbnRvIHRoZSBzdGFja1xuXHQvLyAocmV0dXJuaW5nIHRoZSBuZXcgbWF0Y2hlZCBlbGVtZW50IHNldClcblx0cHVzaFN0YWNrOiBmdW5jdGlvbiggZWxlbXMgKSB7XG5cblx0XHQvLyBCdWlsZCBhIG5ldyBqUXVlcnkgbWF0Y2hlZCBlbGVtZW50IHNldFxuXHRcdHZhciByZXQgPSBqUXVlcnkubWVyZ2UoIHRoaXMuY29uc3RydWN0b3IoKSwgZWxlbXMgKTtcblxuXHRcdC8vIEFkZCB0aGUgb2xkIG9iamVjdCBvbnRvIHRoZSBzdGFjayAoYXMgYSByZWZlcmVuY2UpXG5cdFx0cmV0LnByZXZPYmplY3QgPSB0aGlzO1xuXHRcdHJldC5jb250ZXh0ID0gdGhpcy5jb250ZXh0O1xuXG5cdFx0Ly8gUmV0dXJuIHRoZSBuZXdseS1mb3JtZWQgZWxlbWVudCBzZXRcblx0XHRyZXR1cm4gcmV0O1xuXHR9LFxuXG5cdC8vIEV4ZWN1dGUgYSBjYWxsYmFjayBmb3IgZXZlcnkgZWxlbWVudCBpbiB0aGUgbWF0Y2hlZCBzZXQuXG5cdC8vIChZb3UgY2FuIHNlZWQgdGhlIGFyZ3VtZW50cyB3aXRoIGFuIGFycmF5IG9mIGFyZ3MsIGJ1dCB0aGlzIGlzXG5cdC8vIG9ubHkgdXNlZCBpbnRlcm5hbGx5Lilcblx0ZWFjaDogZnVuY3Rpb24oIGNhbGxiYWNrLCBhcmdzICkge1xuXHRcdHJldHVybiBqUXVlcnkuZWFjaCggdGhpcywgY2FsbGJhY2ssIGFyZ3MgKTtcblx0fSxcblxuXHRtYXA6IGZ1bmN0aW9uKCBjYWxsYmFjayApIHtcblx0XHRyZXR1cm4gdGhpcy5wdXNoU3RhY2soIGpRdWVyeS5tYXAodGhpcywgZnVuY3Rpb24oIGVsZW0sIGkgKSB7XG5cdFx0XHRyZXR1cm4gY2FsbGJhY2suY2FsbCggZWxlbSwgaSwgZWxlbSApO1xuXHRcdH0pKTtcblx0fSxcblxuXHRzbGljZTogZnVuY3Rpb24oKSB7XG5cdFx0cmV0dXJuIHRoaXMucHVzaFN0YWNrKCBzbGljZS5hcHBseSggdGhpcywgYXJndW1lbnRzICkgKTtcblx0fSxcblxuXHRmaXJzdDogZnVuY3Rpb24oKSB7XG5cdFx0cmV0dXJuIHRoaXMuZXEoIDAgKTtcblx0fSxcblxuXHRsYXN0OiBmdW5jdGlvbigpIHtcblx0XHRyZXR1cm4gdGhpcy5lcSggLTEgKTtcblx0fSxcblxuXHRlcTogZnVuY3Rpb24oIGkgKSB7XG5cdFx0dmFyIGxlbiA9IHRoaXMubGVuZ3RoLFxuXHRcdFx0aiA9ICtpICsgKCBpIDwgMCA/IGxlbiA6IDAgKTtcblx0XHRyZXR1cm4gdGhpcy5wdXNoU3RhY2soIGogPj0gMCAmJiBqIDwgbGVuID8gWyB0aGlzW2pdIF0gOiBbXSApO1xuXHR9LFxuXG5cdGVuZDogZnVuY3Rpb24oKSB7XG5cdFx0cmV0dXJuIHRoaXMucHJldk9iamVjdCB8fCB0aGlzLmNvbnN0cnVjdG9yKG51bGwpO1xuXHR9LFxuXG5cdC8vIEZvciBpbnRlcm5hbCB1c2Ugb25seS5cblx0Ly8gQmVoYXZlcyBsaWtlIGFuIEFycmF5J3MgbWV0aG9kLCBub3QgbGlrZSBhIGpRdWVyeSBtZXRob2QuXG5cdHB1c2g6IHB1c2gsXG5cdHNvcnQ6IGFyci5zb3J0LFxuXHRzcGxpY2U6IGFyci5zcGxpY2Vcbn07XG5cbmpRdWVyeS5leHRlbmQgPSBqUXVlcnkuZm4uZXh0ZW5kID0gZnVuY3Rpb24oKSB7XG5cdHZhciBvcHRpb25zLCBuYW1lLCBzcmMsIGNvcHksIGNvcHlJc0FycmF5LCBjbG9uZSxcblx0XHR0YXJnZXQgPSBhcmd1bWVudHNbMF0gfHwge30sXG5cdFx0aSA9IDEsXG5cdFx0bGVuZ3RoID0gYXJndW1lbnRzLmxlbmd0aCxcblx0XHRkZWVwID0gZmFsc2U7XG5cblx0Ly8gSGFuZGxlIGEgZGVlcCBjb3B5IHNpdHVhdGlvblxuXHRpZiAoIHR5cGVvZiB0YXJnZXQgPT09IFwiYm9vbGVhblwiICkge1xuXHRcdGRlZXAgPSB0YXJnZXQ7XG5cblx0XHQvLyBTa2lwIHRoZSBib29sZWFuIGFuZCB0aGUgdGFyZ2V0XG5cdFx0dGFyZ2V0ID0gYXJndW1lbnRzWyBpIF0gfHwge307XG5cdFx0aSsrO1xuXHR9XG5cblx0Ly8gSGFuZGxlIGNhc2Ugd2hlbiB0YXJnZXQgaXMgYSBzdHJpbmcgb3Igc29tZXRoaW5nIChwb3NzaWJsZSBpbiBkZWVwIGNvcHkpXG5cdGlmICggdHlwZW9mIHRhcmdldCAhPT0gXCJvYmplY3RcIiAmJiAhalF1ZXJ5LmlzRnVuY3Rpb24odGFyZ2V0KSApIHtcblx0XHR0YXJnZXQgPSB7fTtcblx0fVxuXG5cdC8vIEV4dGVuZCBqUXVlcnkgaXRzZWxmIGlmIG9ubHkgb25lIGFyZ3VtZW50IGlzIHBhc3NlZFxuXHRpZiAoIGkgPT09IGxlbmd0aCApIHtcblx0XHR0YXJnZXQgPSB0aGlzO1xuXHRcdGktLTtcblx0fVxuXG5cdGZvciAoIDsgaSA8IGxlbmd0aDsgaSsrICkge1xuXHRcdC8vIE9ubHkgZGVhbCB3aXRoIG5vbi1udWxsL3VuZGVmaW5lZCB2YWx1ZXNcblx0XHRpZiAoIChvcHRpb25zID0gYXJndW1lbnRzWyBpIF0pICE9IG51bGwgKSB7XG5cdFx0XHQvLyBFeHRlbmQgdGhlIGJhc2Ugb2JqZWN0XG5cdFx0XHRmb3IgKCBuYW1lIGluIG9wdGlvbnMgKSB7XG5cdFx0XHRcdHNyYyA9IHRhcmdldFsgbmFtZSBdO1xuXHRcdFx0XHRjb3B5ID0gb3B0aW9uc1sgbmFtZSBdO1xuXG5cdFx0XHRcdC8vIFByZXZlbnQgbmV2ZXItZW5kaW5nIGxvb3Bcblx0XHRcdFx0aWYgKCB0YXJnZXQgPT09IGNvcHkgKSB7XG5cdFx0XHRcdFx0Y29udGludWU7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHQvLyBSZWN1cnNlIGlmIHdlJ3JlIG1lcmdpbmcgcGxhaW4gb2JqZWN0cyBvciBhcnJheXNcblx0XHRcdFx0aWYgKCBkZWVwICYmIGNvcHkgJiYgKCBqUXVlcnkuaXNQbGFpbk9iamVjdChjb3B5KSB8fCAoY29weUlzQXJyYXkgPSBqUXVlcnkuaXNBcnJheShjb3B5KSkgKSApIHtcblx0XHRcdFx0XHRpZiAoIGNvcHlJc0FycmF5ICkge1xuXHRcdFx0XHRcdFx0Y29weUlzQXJyYXkgPSBmYWxzZTtcblx0XHRcdFx0XHRcdGNsb25lID0gc3JjICYmIGpRdWVyeS5pc0FycmF5KHNyYykgPyBzcmMgOiBbXTtcblxuXHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHRjbG9uZSA9IHNyYyAmJiBqUXVlcnkuaXNQbGFpbk9iamVjdChzcmMpID8gc3JjIDoge307XG5cdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0Ly8gTmV2ZXIgbW92ZSBvcmlnaW5hbCBvYmplY3RzLCBjbG9uZSB0aGVtXG5cdFx0XHRcdFx0dGFyZ2V0WyBuYW1lIF0gPSBqUXVlcnkuZXh0ZW5kKCBkZWVwLCBjbG9uZSwgY29weSApO1xuXG5cdFx0XHRcdC8vIERvbid0IGJyaW5nIGluIHVuZGVmaW5lZCB2YWx1ZXNcblx0XHRcdFx0fSBlbHNlIGlmICggY29weSAhPT0gdW5kZWZpbmVkICkge1xuXHRcdFx0XHRcdHRhcmdldFsgbmFtZSBdID0gY29weTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH1cblx0fVxuXG5cdC8vIFJldHVybiB0aGUgbW9kaWZpZWQgb2JqZWN0XG5cdHJldHVybiB0YXJnZXQ7XG59O1xuXG5qUXVlcnkuZXh0ZW5kKHtcblx0Ly8gVW5pcXVlIGZvciBlYWNoIGNvcHkgb2YgalF1ZXJ5IG9uIHRoZSBwYWdlXG5cdGV4cGFuZG86IFwialF1ZXJ5XCIgKyAoIHZlcnNpb24gKyBNYXRoLnJhbmRvbSgpICkucmVwbGFjZSggL1xcRC9nLCBcIlwiICksXG5cblx0Ly8gQXNzdW1lIGpRdWVyeSBpcyByZWFkeSB3aXRob3V0IHRoZSByZWFkeSBtb2R1bGVcblx0aXNSZWFkeTogdHJ1ZSxcblxuXHRlcnJvcjogZnVuY3Rpb24oIG1zZyApIHtcblx0XHR0aHJvdyBuZXcgRXJyb3IoIG1zZyApO1xuXHR9LFxuXG5cdG5vb3A6IGZ1bmN0aW9uKCkge30sXG5cblx0aXNGdW5jdGlvbjogZnVuY3Rpb24oIG9iaiApIHtcblx0XHRyZXR1cm4galF1ZXJ5LnR5cGUob2JqKSA9PT0gXCJmdW5jdGlvblwiO1xuXHR9LFxuXG5cdGlzQXJyYXk6IEFycmF5LmlzQXJyYXksXG5cblx0aXNXaW5kb3c6IGZ1bmN0aW9uKCBvYmogKSB7XG5cdFx0cmV0dXJuIG9iaiAhPSBudWxsICYmIG9iaiA9PT0gb2JqLndpbmRvdztcblx0fSxcblxuXHRpc051bWVyaWM6IGZ1bmN0aW9uKCBvYmogKSB7XG5cdFx0Ly8gcGFyc2VGbG9hdCBOYU5zIG51bWVyaWMtY2FzdCBmYWxzZSBwb3NpdGl2ZXMgKG51bGx8dHJ1ZXxmYWxzZXxcIlwiKVxuXHRcdC8vIC4uLmJ1dCBtaXNpbnRlcnByZXRzIGxlYWRpbmctbnVtYmVyIHN0cmluZ3MsIHBhcnRpY3VsYXJseSBoZXggbGl0ZXJhbHMgKFwiMHguLi5cIilcblx0XHQvLyBzdWJ0cmFjdGlvbiBmb3JjZXMgaW5maW5pdGllcyB0byBOYU5cblx0XHQvLyBhZGRpbmcgMSBjb3JyZWN0cyBsb3NzIG9mIHByZWNpc2lvbiBmcm9tIHBhcnNlRmxvYXQgKCMxNTEwMClcblx0XHRyZXR1cm4gIWpRdWVyeS5pc0FycmF5KCBvYmogKSAmJiAob2JqIC0gcGFyc2VGbG9hdCggb2JqICkgKyAxKSA+PSAwO1xuXHR9LFxuXG5cdGlzUGxhaW5PYmplY3Q6IGZ1bmN0aW9uKCBvYmogKSB7XG5cdFx0Ly8gTm90IHBsYWluIG9iamVjdHM6XG5cdFx0Ly8gLSBBbnkgb2JqZWN0IG9yIHZhbHVlIHdob3NlIGludGVybmFsIFtbQ2xhc3NdXSBwcm9wZXJ0eSBpcyBub3QgXCJbb2JqZWN0IE9iamVjdF1cIlxuXHRcdC8vIC0gRE9NIG5vZGVzXG5cdFx0Ly8gLSB3aW5kb3dcblx0XHRpZiAoIGpRdWVyeS50eXBlKCBvYmogKSAhPT0gXCJvYmplY3RcIiB8fCBvYmoubm9kZVR5cGUgfHwgalF1ZXJ5LmlzV2luZG93KCBvYmogKSApIHtcblx0XHRcdHJldHVybiBmYWxzZTtcblx0XHR9XG5cblx0XHRpZiAoIG9iai5jb25zdHJ1Y3RvciAmJlxuXHRcdFx0XHQhaGFzT3duLmNhbGwoIG9iai5jb25zdHJ1Y3Rvci5wcm90b3R5cGUsIFwiaXNQcm90b3R5cGVPZlwiICkgKSB7XG5cdFx0XHRyZXR1cm4gZmFsc2U7XG5cdFx0fVxuXG5cdFx0Ly8gSWYgdGhlIGZ1bmN0aW9uIGhhc24ndCByZXR1cm5lZCBhbHJlYWR5LCB3ZSdyZSBjb25maWRlbnQgdGhhdFxuXHRcdC8vIHxvYmp8IGlzIGEgcGxhaW4gb2JqZWN0LCBjcmVhdGVkIGJ5IHt9IG9yIGNvbnN0cnVjdGVkIHdpdGggbmV3IE9iamVjdFxuXHRcdHJldHVybiB0cnVlO1xuXHR9LFxuXG5cdGlzRW1wdHlPYmplY3Q6IGZ1bmN0aW9uKCBvYmogKSB7XG5cdFx0dmFyIG5hbWU7XG5cdFx0Zm9yICggbmFtZSBpbiBvYmogKSB7XG5cdFx0XHRyZXR1cm4gZmFsc2U7XG5cdFx0fVxuXHRcdHJldHVybiB0cnVlO1xuXHR9LFxuXG5cdHR5cGU6IGZ1bmN0aW9uKCBvYmogKSB7XG5cdFx0aWYgKCBvYmogPT0gbnVsbCApIHtcblx0XHRcdHJldHVybiBvYmogKyBcIlwiO1xuXHRcdH1cblx0XHQvLyBTdXBwb3J0OiBBbmRyb2lkPDQuMCwgaU9TPDYgKGZ1bmN0aW9uaXNoIFJlZ0V4cClcblx0XHRyZXR1cm4gdHlwZW9mIG9iaiA9PT0gXCJvYmplY3RcIiB8fCB0eXBlb2Ygb2JqID09PSBcImZ1bmN0aW9uXCIgP1xuXHRcdFx0Y2xhc3MydHlwZVsgdG9TdHJpbmcuY2FsbChvYmopIF0gfHwgXCJvYmplY3RcIiA6XG5cdFx0XHR0eXBlb2Ygb2JqO1xuXHR9LFxuXG5cdC8vIEV2YWx1YXRlcyBhIHNjcmlwdCBpbiBhIGdsb2JhbCBjb250ZXh0XG5cdGdsb2JhbEV2YWw6IGZ1bmN0aW9uKCBjb2RlICkge1xuXHRcdHZhciBzY3JpcHQsXG5cdFx0XHRpbmRpcmVjdCA9IGV2YWw7XG5cblx0XHRjb2RlID0galF1ZXJ5LnRyaW0oIGNvZGUgKTtcblxuXHRcdGlmICggY29kZSApIHtcblx0XHRcdC8vIElmIHRoZSBjb2RlIGluY2x1ZGVzIGEgdmFsaWQsIHByb2xvZ3VlIHBvc2l0aW9uXG5cdFx0XHQvLyBzdHJpY3QgbW9kZSBwcmFnbWEsIGV4ZWN1dGUgY29kZSBieSBpbmplY3RpbmcgYVxuXHRcdFx0Ly8gc2NyaXB0IHRhZyBpbnRvIHRoZSBkb2N1bWVudC5cblx0XHRcdGlmICggY29kZS5pbmRleE9mKFwidXNlIHN0cmljdFwiKSA9PT0gMSApIHtcblx0XHRcdFx0c2NyaXB0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInNjcmlwdFwiKTtcblx0XHRcdFx0c2NyaXB0LnRleHQgPSBjb2RlO1xuXHRcdFx0XHRkb2N1bWVudC5oZWFkLmFwcGVuZENoaWxkKCBzY3JpcHQgKS5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKCBzY3JpcHQgKTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHQvLyBPdGhlcndpc2UsIGF2b2lkIHRoZSBET00gbm9kZSBjcmVhdGlvbiwgaW5zZXJ0aW9uXG5cdFx0XHQvLyBhbmQgcmVtb3ZhbCBieSB1c2luZyBhbiBpbmRpcmVjdCBnbG9iYWwgZXZhbFxuXHRcdFx0XHRpbmRpcmVjdCggY29kZSApO1xuXHRcdFx0fVxuXHRcdH1cblx0fSxcblxuXHQvLyBDb252ZXJ0IGRhc2hlZCB0byBjYW1lbENhc2U7IHVzZWQgYnkgdGhlIGNzcyBhbmQgZGF0YSBtb2R1bGVzXG5cdC8vIFN1cHBvcnQ6IElFOS0xMStcblx0Ly8gTWljcm9zb2Z0IGZvcmdvdCB0byBodW1wIHRoZWlyIHZlbmRvciBwcmVmaXggKCM5NTcyKVxuXHRjYW1lbENhc2U6IGZ1bmN0aW9uKCBzdHJpbmcgKSB7XG5cdFx0cmV0dXJuIHN0cmluZy5yZXBsYWNlKCBybXNQcmVmaXgsIFwibXMtXCIgKS5yZXBsYWNlKCByZGFzaEFscGhhLCBmY2FtZWxDYXNlICk7XG5cdH0sXG5cblx0bm9kZU5hbWU6IGZ1bmN0aW9uKCBlbGVtLCBuYW1lICkge1xuXHRcdHJldHVybiBlbGVtLm5vZGVOYW1lICYmIGVsZW0ubm9kZU5hbWUudG9Mb3dlckNhc2UoKSA9PT0gbmFtZS50b0xvd2VyQ2FzZSgpO1xuXHR9LFxuXG5cdC8vIGFyZ3MgaXMgZm9yIGludGVybmFsIHVzYWdlIG9ubHlcblx0ZWFjaDogZnVuY3Rpb24oIG9iaiwgY2FsbGJhY2ssIGFyZ3MgKSB7XG5cdFx0dmFyIHZhbHVlLFxuXHRcdFx0aSA9IDAsXG5cdFx0XHRsZW5ndGggPSBvYmoubGVuZ3RoLFxuXHRcdFx0aXNBcnJheSA9IGlzQXJyYXlsaWtlKCBvYmogKTtcblxuXHRcdGlmICggYXJncyApIHtcblx0XHRcdGlmICggaXNBcnJheSApIHtcblx0XHRcdFx0Zm9yICggOyBpIDwgbGVuZ3RoOyBpKysgKSB7XG5cdFx0XHRcdFx0dmFsdWUgPSBjYWxsYmFjay5hcHBseSggb2JqWyBpIF0sIGFyZ3MgKTtcblxuXHRcdFx0XHRcdGlmICggdmFsdWUgPT09IGZhbHNlICkge1xuXHRcdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRmb3IgKCBpIGluIG9iaiApIHtcblx0XHRcdFx0XHR2YWx1ZSA9IGNhbGxiYWNrLmFwcGx5KCBvYmpbIGkgXSwgYXJncyApO1xuXG5cdFx0XHRcdFx0aWYgKCB2YWx1ZSA9PT0gZmFsc2UgKSB7XG5cdFx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdH1cblxuXHRcdC8vIEEgc3BlY2lhbCwgZmFzdCwgY2FzZSBmb3IgdGhlIG1vc3QgY29tbW9uIHVzZSBvZiBlYWNoXG5cdFx0fSBlbHNlIHtcblx0XHRcdGlmICggaXNBcnJheSApIHtcblx0XHRcdFx0Zm9yICggOyBpIDwgbGVuZ3RoOyBpKysgKSB7XG5cdFx0XHRcdFx0dmFsdWUgPSBjYWxsYmFjay5jYWxsKCBvYmpbIGkgXSwgaSwgb2JqWyBpIF0gKTtcblxuXHRcdFx0XHRcdGlmICggdmFsdWUgPT09IGZhbHNlICkge1xuXHRcdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRmb3IgKCBpIGluIG9iaiApIHtcblx0XHRcdFx0XHR2YWx1ZSA9IGNhbGxiYWNrLmNhbGwoIG9ialsgaSBdLCBpLCBvYmpbIGkgXSApO1xuXG5cdFx0XHRcdFx0aWYgKCB2YWx1ZSA9PT0gZmFsc2UgKSB7XG5cdFx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9XG5cblx0XHRyZXR1cm4gb2JqO1xuXHR9LFxuXG5cdC8vIFN1cHBvcnQ6IEFuZHJvaWQ8NC4xXG5cdHRyaW06IGZ1bmN0aW9uKCB0ZXh0ICkge1xuXHRcdHJldHVybiB0ZXh0ID09IG51bGwgP1xuXHRcdFx0XCJcIiA6XG5cdFx0XHQoIHRleHQgKyBcIlwiICkucmVwbGFjZSggcnRyaW0sIFwiXCIgKTtcblx0fSxcblxuXHQvLyByZXN1bHRzIGlzIGZvciBpbnRlcm5hbCB1c2FnZSBvbmx5XG5cdG1ha2VBcnJheTogZnVuY3Rpb24oIGFyciwgcmVzdWx0cyApIHtcblx0XHR2YXIgcmV0ID0gcmVzdWx0cyB8fCBbXTtcblxuXHRcdGlmICggYXJyICE9IG51bGwgKSB7XG5cdFx0XHRpZiAoIGlzQXJyYXlsaWtlKCBPYmplY3QoYXJyKSApICkge1xuXHRcdFx0XHRqUXVlcnkubWVyZ2UoIHJldCxcblx0XHRcdFx0XHR0eXBlb2YgYXJyID09PSBcInN0cmluZ1wiID9cblx0XHRcdFx0XHRbIGFyciBdIDogYXJyXG5cdFx0XHRcdCk7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRwdXNoLmNhbGwoIHJldCwgYXJyICk7XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0cmV0dXJuIHJldDtcblx0fSxcblxuXHRpbkFycmF5OiBmdW5jdGlvbiggZWxlbSwgYXJyLCBpICkge1xuXHRcdHJldHVybiBhcnIgPT0gbnVsbCA/IC0xIDogaW5kZXhPZi5jYWxsKCBhcnIsIGVsZW0sIGkgKTtcblx0fSxcblxuXHRtZXJnZTogZnVuY3Rpb24oIGZpcnN0LCBzZWNvbmQgKSB7XG5cdFx0dmFyIGxlbiA9ICtzZWNvbmQubGVuZ3RoLFxuXHRcdFx0aiA9IDAsXG5cdFx0XHRpID0gZmlyc3QubGVuZ3RoO1xuXG5cdFx0Zm9yICggOyBqIDwgbGVuOyBqKysgKSB7XG5cdFx0XHRmaXJzdFsgaSsrIF0gPSBzZWNvbmRbIGogXTtcblx0XHR9XG5cblx0XHRmaXJzdC5sZW5ndGggPSBpO1xuXG5cdFx0cmV0dXJuIGZpcnN0O1xuXHR9LFxuXG5cdGdyZXA6IGZ1bmN0aW9uKCBlbGVtcywgY2FsbGJhY2ssIGludmVydCApIHtcblx0XHR2YXIgY2FsbGJhY2tJbnZlcnNlLFxuXHRcdFx0bWF0Y2hlcyA9IFtdLFxuXHRcdFx0aSA9IDAsXG5cdFx0XHRsZW5ndGggPSBlbGVtcy5sZW5ndGgsXG5cdFx0XHRjYWxsYmFja0V4cGVjdCA9ICFpbnZlcnQ7XG5cblx0XHQvLyBHbyB0aHJvdWdoIHRoZSBhcnJheSwgb25seSBzYXZpbmcgdGhlIGl0ZW1zXG5cdFx0Ly8gdGhhdCBwYXNzIHRoZSB2YWxpZGF0b3IgZnVuY3Rpb25cblx0XHRmb3IgKCA7IGkgPCBsZW5ndGg7IGkrKyApIHtcblx0XHRcdGNhbGxiYWNrSW52ZXJzZSA9ICFjYWxsYmFjayggZWxlbXNbIGkgXSwgaSApO1xuXHRcdFx0aWYgKCBjYWxsYmFja0ludmVyc2UgIT09IGNhbGxiYWNrRXhwZWN0ICkge1xuXHRcdFx0XHRtYXRjaGVzLnB1c2goIGVsZW1zWyBpIF0gKTtcblx0XHRcdH1cblx0XHR9XG5cblx0XHRyZXR1cm4gbWF0Y2hlcztcblx0fSxcblxuXHQvLyBhcmcgaXMgZm9yIGludGVybmFsIHVzYWdlIG9ubHlcblx0bWFwOiBmdW5jdGlvbiggZWxlbXMsIGNhbGxiYWNrLCBhcmcgKSB7XG5cdFx0dmFyIHZhbHVlLFxuXHRcdFx0aSA9IDAsXG5cdFx0XHRsZW5ndGggPSBlbGVtcy5sZW5ndGgsXG5cdFx0XHRpc0FycmF5ID0gaXNBcnJheWxpa2UoIGVsZW1zICksXG5cdFx0XHRyZXQgPSBbXTtcblxuXHRcdC8vIEdvIHRocm91Z2ggdGhlIGFycmF5LCB0cmFuc2xhdGluZyBlYWNoIG9mIHRoZSBpdGVtcyB0byB0aGVpciBuZXcgdmFsdWVzXG5cdFx0aWYgKCBpc0FycmF5ICkge1xuXHRcdFx0Zm9yICggOyBpIDwgbGVuZ3RoOyBpKysgKSB7XG5cdFx0XHRcdHZhbHVlID0gY2FsbGJhY2soIGVsZW1zWyBpIF0sIGksIGFyZyApO1xuXG5cdFx0XHRcdGlmICggdmFsdWUgIT0gbnVsbCApIHtcblx0XHRcdFx0XHRyZXQucHVzaCggdmFsdWUgKTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXG5cdFx0Ly8gR28gdGhyb3VnaCBldmVyeSBrZXkgb24gdGhlIG9iamVjdCxcblx0XHR9IGVsc2Uge1xuXHRcdFx0Zm9yICggaSBpbiBlbGVtcyApIHtcblx0XHRcdFx0dmFsdWUgPSBjYWxsYmFjayggZWxlbXNbIGkgXSwgaSwgYXJnICk7XG5cblx0XHRcdFx0aWYgKCB2YWx1ZSAhPSBudWxsICkge1xuXHRcdFx0XHRcdHJldC5wdXNoKCB2YWx1ZSApO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0Ly8gRmxhdHRlbiBhbnkgbmVzdGVkIGFycmF5c1xuXHRcdHJldHVybiBjb25jYXQuYXBwbHkoIFtdLCByZXQgKTtcblx0fSxcblxuXHQvLyBBIGdsb2JhbCBHVUlEIGNvdW50ZXIgZm9yIG9iamVjdHNcblx0Z3VpZDogMSxcblxuXHQvLyBCaW5kIGEgZnVuY3Rpb24gdG8gYSBjb250ZXh0LCBvcHRpb25hbGx5IHBhcnRpYWxseSBhcHBseWluZyBhbnlcblx0Ly8gYXJndW1lbnRzLlxuXHRwcm94eTogZnVuY3Rpb24oIGZuLCBjb250ZXh0ICkge1xuXHRcdHZhciB0bXAsIGFyZ3MsIHByb3h5O1xuXG5cdFx0aWYgKCB0eXBlb2YgY29udGV4dCA9PT0gXCJzdHJpbmdcIiApIHtcblx0XHRcdHRtcCA9IGZuWyBjb250ZXh0IF07XG5cdFx0XHRjb250ZXh0ID0gZm47XG5cdFx0XHRmbiA9IHRtcDtcblx0XHR9XG5cblx0XHQvLyBRdWljayBjaGVjayB0byBkZXRlcm1pbmUgaWYgdGFyZ2V0IGlzIGNhbGxhYmxlLCBpbiB0aGUgc3BlY1xuXHRcdC8vIHRoaXMgdGhyb3dzIGEgVHlwZUVycm9yLCBidXQgd2Ugd2lsbCBqdXN0IHJldHVybiB1bmRlZmluZWQuXG5cdFx0aWYgKCAhalF1ZXJ5LmlzRnVuY3Rpb24oIGZuICkgKSB7XG5cdFx0XHRyZXR1cm4gdW5kZWZpbmVkO1xuXHRcdH1cblxuXHRcdC8vIFNpbXVsYXRlZCBiaW5kXG5cdFx0YXJncyA9IHNsaWNlLmNhbGwoIGFyZ3VtZW50cywgMiApO1xuXHRcdHByb3h5ID0gZnVuY3Rpb24oKSB7XG5cdFx0XHRyZXR1cm4gZm4uYXBwbHkoIGNvbnRleHQgfHwgdGhpcywgYXJncy5jb25jYXQoIHNsaWNlLmNhbGwoIGFyZ3VtZW50cyApICkgKTtcblx0XHR9O1xuXG5cdFx0Ly8gU2V0IHRoZSBndWlkIG9mIHVuaXF1ZSBoYW5kbGVyIHRvIHRoZSBzYW1lIG9mIG9yaWdpbmFsIGhhbmRsZXIsIHNvIGl0IGNhbiBiZSByZW1vdmVkXG5cdFx0cHJveHkuZ3VpZCA9IGZuLmd1aWQgPSBmbi5ndWlkIHx8IGpRdWVyeS5ndWlkKys7XG5cblx0XHRyZXR1cm4gcHJveHk7XG5cdH0sXG5cblx0bm93OiBEYXRlLm5vdyxcblxuXHQvLyBqUXVlcnkuc3VwcG9ydCBpcyBub3QgdXNlZCBpbiBDb3JlIGJ1dCBvdGhlciBwcm9qZWN0cyBhdHRhY2ggdGhlaXJcblx0Ly8gcHJvcGVydGllcyB0byBpdCBzbyBpdCBuZWVkcyB0byBleGlzdC5cblx0c3VwcG9ydDogc3VwcG9ydFxufSk7XG5cbi8vIFBvcHVsYXRlIHRoZSBjbGFzczJ0eXBlIG1hcFxualF1ZXJ5LmVhY2goXCJCb29sZWFuIE51bWJlciBTdHJpbmcgRnVuY3Rpb24gQXJyYXkgRGF0ZSBSZWdFeHAgT2JqZWN0IEVycm9yXCIuc3BsaXQoXCIgXCIpLCBmdW5jdGlvbihpLCBuYW1lKSB7XG5cdGNsYXNzMnR5cGVbIFwiW29iamVjdCBcIiArIG5hbWUgKyBcIl1cIiBdID0gbmFtZS50b0xvd2VyQ2FzZSgpO1xufSk7XG5cbmZ1bmN0aW9uIGlzQXJyYXlsaWtlKCBvYmogKSB7XG5cblx0Ly8gU3VwcG9ydDogaU9TIDguMiAobm90IHJlcHJvZHVjaWJsZSBpbiBzaW11bGF0b3IpXG5cdC8vIGBpbmAgY2hlY2sgdXNlZCB0byBwcmV2ZW50IEpJVCBlcnJvciAoZ2gtMjE0NSlcblx0Ly8gaGFzT3duIGlzbid0IHVzZWQgaGVyZSBkdWUgdG8gZmFsc2UgbmVnYXRpdmVzXG5cdC8vIHJlZ2FyZGluZyBOb2RlbGlzdCBsZW5ndGggaW4gSUVcblx0dmFyIGxlbmd0aCA9IFwibGVuZ3RoXCIgaW4gb2JqICYmIG9iai5sZW5ndGgsXG5cdFx0dHlwZSA9IGpRdWVyeS50eXBlKCBvYmogKTtcblxuXHRpZiAoIHR5cGUgPT09IFwiZnVuY3Rpb25cIiB8fCBqUXVlcnkuaXNXaW5kb3coIG9iaiApICkge1xuXHRcdHJldHVybiBmYWxzZTtcblx0fVxuXG5cdGlmICggb2JqLm5vZGVUeXBlID09PSAxICYmIGxlbmd0aCApIHtcblx0XHRyZXR1cm4gdHJ1ZTtcblx0fVxuXG5cdHJldHVybiB0eXBlID09PSBcImFycmF5XCIgfHwgbGVuZ3RoID09PSAwIHx8XG5cdFx0dHlwZW9mIGxlbmd0aCA9PT0gXCJudW1iZXJcIiAmJiBsZW5ndGggPiAwICYmICggbGVuZ3RoIC0gMSApIGluIG9iajtcbn1cbnZhciBTaXp6bGUgPVxuLyohXG4gKiBTaXp6bGUgQ1NTIFNlbGVjdG9yIEVuZ2luZSB2Mi4yLjAtcHJlXG4gKiBodHRwOi8vc2l6emxlanMuY29tL1xuICpcbiAqIENvcHlyaWdodCAyMDA4LCAyMDE0IGpRdWVyeSBGb3VuZGF0aW9uLCBJbmMuIGFuZCBvdGhlciBjb250cmlidXRvcnNcbiAqIFJlbGVhc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZVxuICogaHR0cDovL2pxdWVyeS5vcmcvbGljZW5zZVxuICpcbiAqIERhdGU6IDIwMTQtMTItMTZcbiAqL1xuKGZ1bmN0aW9uKCB3aW5kb3cgKSB7XG5cbnZhciBpLFxuXHRzdXBwb3J0LFxuXHRFeHByLFxuXHRnZXRUZXh0LFxuXHRpc1hNTCxcblx0dG9rZW5pemUsXG5cdGNvbXBpbGUsXG5cdHNlbGVjdCxcblx0b3V0ZXJtb3N0Q29udGV4dCxcblx0c29ydElucHV0LFxuXHRoYXNEdXBsaWNhdGUsXG5cblx0Ly8gTG9jYWwgZG9jdW1lbnQgdmFyc1xuXHRzZXREb2N1bWVudCxcblx0ZG9jdW1lbnQsXG5cdGRvY0VsZW0sXG5cdGRvY3VtZW50SXNIVE1MLFxuXHRyYnVnZ3lRU0EsXG5cdHJidWdneU1hdGNoZXMsXG5cdG1hdGNoZXMsXG5cdGNvbnRhaW5zLFxuXG5cdC8vIEluc3RhbmNlLXNwZWNpZmljIGRhdGFcblx0ZXhwYW5kbyA9IFwic2l6emxlXCIgKyAxICogbmV3IERhdGUoKSxcblx0cHJlZmVycmVkRG9jID0gd2luZG93LmRvY3VtZW50LFxuXHRkaXJydW5zID0gMCxcblx0ZG9uZSA9IDAsXG5cdGNsYXNzQ2FjaGUgPSBjcmVhdGVDYWNoZSgpLFxuXHR0b2tlbkNhY2hlID0gY3JlYXRlQ2FjaGUoKSxcblx0Y29tcGlsZXJDYWNoZSA9IGNyZWF0ZUNhY2hlKCksXG5cdHNvcnRPcmRlciA9IGZ1bmN0aW9uKCBhLCBiICkge1xuXHRcdGlmICggYSA9PT0gYiApIHtcblx0XHRcdGhhc0R1cGxpY2F0ZSA9IHRydWU7XG5cdFx0fVxuXHRcdHJldHVybiAwO1xuXHR9LFxuXG5cdC8vIEdlbmVyYWwtcHVycG9zZSBjb25zdGFudHNcblx0TUFYX05FR0FUSVZFID0gMSA8PCAzMSxcblxuXHQvLyBJbnN0YW5jZSBtZXRob2RzXG5cdGhhc093biA9ICh7fSkuaGFzT3duUHJvcGVydHksXG5cdGFyciA9IFtdLFxuXHRwb3AgPSBhcnIucG9wLFxuXHRwdXNoX25hdGl2ZSA9IGFyci5wdXNoLFxuXHRwdXNoID0gYXJyLnB1c2gsXG5cdHNsaWNlID0gYXJyLnNsaWNlLFxuXHQvLyBVc2UgYSBzdHJpcHBlZC1kb3duIGluZGV4T2YgYXMgaXQncyBmYXN0ZXIgdGhhbiBuYXRpdmVcblx0Ly8gaHR0cDovL2pzcGVyZi5jb20vdGhvci1pbmRleG9mLXZzLWZvci81XG5cdGluZGV4T2YgPSBmdW5jdGlvbiggbGlzdCwgZWxlbSApIHtcblx0XHR2YXIgaSA9IDAsXG5cdFx0XHRsZW4gPSBsaXN0Lmxlbmd0aDtcblx0XHRmb3IgKCA7IGkgPCBsZW47IGkrKyApIHtcblx0XHRcdGlmICggbGlzdFtpXSA9PT0gZWxlbSApIHtcblx0XHRcdFx0cmV0dXJuIGk7XG5cdFx0XHR9XG5cdFx0fVxuXHRcdHJldHVybiAtMTtcblx0fSxcblxuXHRib29sZWFucyA9IFwiY2hlY2tlZHxzZWxlY3RlZHxhc3luY3xhdXRvZm9jdXN8YXV0b3BsYXl8Y29udHJvbHN8ZGVmZXJ8ZGlzYWJsZWR8aGlkZGVufGlzbWFwfGxvb3B8bXVsdGlwbGV8b3BlbnxyZWFkb25seXxyZXF1aXJlZHxzY29wZWRcIixcblxuXHQvLyBSZWd1bGFyIGV4cHJlc3Npb25zXG5cblx0Ly8gV2hpdGVzcGFjZSBjaGFyYWN0ZXJzIGh0dHA6Ly93d3cudzMub3JnL1RSL2NzczMtc2VsZWN0b3JzLyN3aGl0ZXNwYWNlXG5cdHdoaXRlc3BhY2UgPSBcIltcXFxceDIwXFxcXHRcXFxcclxcXFxuXFxcXGZdXCIsXG5cdC8vIGh0dHA6Ly93d3cudzMub3JnL1RSL2NzczMtc3ludGF4LyNjaGFyYWN0ZXJzXG5cdGNoYXJhY3RlckVuY29kaW5nID0gXCIoPzpcXFxcXFxcXC58W1xcXFx3LV18W15cXFxceDAwLVxcXFx4YTBdKStcIixcblxuXHQvLyBMb29zZWx5IG1vZGVsZWQgb24gQ1NTIGlkZW50aWZpZXIgY2hhcmFjdGVyc1xuXHQvLyBBbiB1bnF1b3RlZCB2YWx1ZSBzaG91bGQgYmUgYSBDU1MgaWRlbnRpZmllciBodHRwOi8vd3d3LnczLm9yZy9UUi9jc3MzLXNlbGVjdG9ycy8jYXR0cmlidXRlLXNlbGVjdG9yc1xuXHQvLyBQcm9wZXIgc3ludGF4OiBodHRwOi8vd3d3LnczLm9yZy9UUi9DU1MyMS9zeW5kYXRhLmh0bWwjdmFsdWUtZGVmLWlkZW50aWZpZXJcblx0aWRlbnRpZmllciA9IGNoYXJhY3RlckVuY29kaW5nLnJlcGxhY2UoIFwid1wiLCBcIncjXCIgKSxcblxuXHQvLyBBdHRyaWJ1dGUgc2VsZWN0b3JzOiBodHRwOi8vd3d3LnczLm9yZy9UUi9zZWxlY3RvcnMvI2F0dHJpYnV0ZS1zZWxlY3RvcnNcblx0YXR0cmlidXRlcyA9IFwiXFxcXFtcIiArIHdoaXRlc3BhY2UgKyBcIiooXCIgKyBjaGFyYWN0ZXJFbmNvZGluZyArIFwiKSg/OlwiICsgd2hpdGVzcGFjZSArXG5cdFx0Ly8gT3BlcmF0b3IgKGNhcHR1cmUgMilcblx0XHRcIiooWypeJHwhfl0/PSlcIiArIHdoaXRlc3BhY2UgK1xuXHRcdC8vIFwiQXR0cmlidXRlIHZhbHVlcyBtdXN0IGJlIENTUyBpZGVudGlmaWVycyBbY2FwdHVyZSA1XSBvciBzdHJpbmdzIFtjYXB0dXJlIDMgb3IgY2FwdHVyZSA0XVwiXG5cdFx0XCIqKD86JygoPzpcXFxcXFxcXC58W15cXFxcXFxcXCddKSopJ3xcXFwiKCg/OlxcXFxcXFxcLnxbXlxcXFxcXFxcXFxcIl0pKilcXFwifChcIiArIGlkZW50aWZpZXIgKyBcIikpfClcIiArIHdoaXRlc3BhY2UgK1xuXHRcdFwiKlxcXFxdXCIsXG5cblx0cHNldWRvcyA9IFwiOihcIiArIGNoYXJhY3RlckVuY29kaW5nICsgXCIpKD86XFxcXCgoXCIgK1xuXHRcdC8vIFRvIHJlZHVjZSB0aGUgbnVtYmVyIG9mIHNlbGVjdG9ycyBuZWVkaW5nIHRva2VuaXplIGluIHRoZSBwcmVGaWx0ZXIsIHByZWZlciBhcmd1bWVudHM6XG5cdFx0Ly8gMS4gcXVvdGVkIChjYXB0dXJlIDM7IGNhcHR1cmUgNCBvciBjYXB0dXJlIDUpXG5cdFx0XCIoJygoPzpcXFxcXFxcXC58W15cXFxcXFxcXCddKSopJ3xcXFwiKCg/OlxcXFxcXFxcLnxbXlxcXFxcXFxcXFxcIl0pKilcXFwiKXxcIiArXG5cdFx0Ly8gMi4gc2ltcGxlIChjYXB0dXJlIDYpXG5cdFx0XCIoKD86XFxcXFxcXFwufFteXFxcXFxcXFwoKVtcXFxcXV18XCIgKyBhdHRyaWJ1dGVzICsgXCIpKil8XCIgK1xuXHRcdC8vIDMuIGFueXRoaW5nIGVsc2UgKGNhcHR1cmUgMilcblx0XHRcIi4qXCIgK1xuXHRcdFwiKVxcXFwpfClcIixcblxuXHQvLyBMZWFkaW5nIGFuZCBub24tZXNjYXBlZCB0cmFpbGluZyB3aGl0ZXNwYWNlLCBjYXB0dXJpbmcgc29tZSBub24td2hpdGVzcGFjZSBjaGFyYWN0ZXJzIHByZWNlZGluZyB0aGUgbGF0dGVyXG5cdHJ3aGl0ZXNwYWNlID0gbmV3IFJlZ0V4cCggd2hpdGVzcGFjZSArIFwiK1wiLCBcImdcIiApLFxuXHRydHJpbSA9IG5ldyBSZWdFeHAoIFwiXlwiICsgd2hpdGVzcGFjZSArIFwiK3woKD86XnxbXlxcXFxcXFxcXSkoPzpcXFxcXFxcXC4pKilcIiArIHdoaXRlc3BhY2UgKyBcIiskXCIsIFwiZ1wiICksXG5cblx0cmNvbW1hID0gbmV3IFJlZ0V4cCggXCJeXCIgKyB3aGl0ZXNwYWNlICsgXCIqLFwiICsgd2hpdGVzcGFjZSArIFwiKlwiICksXG5cdHJjb21iaW5hdG9ycyA9IG5ldyBSZWdFeHAoIFwiXlwiICsgd2hpdGVzcGFjZSArIFwiKihbPit+XXxcIiArIHdoaXRlc3BhY2UgKyBcIilcIiArIHdoaXRlc3BhY2UgKyBcIipcIiApLFxuXG5cdHJhdHRyaWJ1dGVRdW90ZXMgPSBuZXcgUmVnRXhwKCBcIj1cIiArIHdoaXRlc3BhY2UgKyBcIiooW15cXFxcXSdcXFwiXSo/KVwiICsgd2hpdGVzcGFjZSArIFwiKlxcXFxdXCIsIFwiZ1wiICksXG5cblx0cnBzZXVkbyA9IG5ldyBSZWdFeHAoIHBzZXVkb3MgKSxcblx0cmlkZW50aWZpZXIgPSBuZXcgUmVnRXhwKCBcIl5cIiArIGlkZW50aWZpZXIgKyBcIiRcIiApLFxuXG5cdG1hdGNoRXhwciA9IHtcblx0XHRcIklEXCI6IG5ldyBSZWdFeHAoIFwiXiMoXCIgKyBjaGFyYWN0ZXJFbmNvZGluZyArIFwiKVwiICksXG5cdFx0XCJDTEFTU1wiOiBuZXcgUmVnRXhwKCBcIl5cXFxcLihcIiArIGNoYXJhY3RlckVuY29kaW5nICsgXCIpXCIgKSxcblx0XHRcIlRBR1wiOiBuZXcgUmVnRXhwKCBcIl4oXCIgKyBjaGFyYWN0ZXJFbmNvZGluZy5yZXBsYWNlKCBcIndcIiwgXCJ3KlwiICkgKyBcIilcIiApLFxuXHRcdFwiQVRUUlwiOiBuZXcgUmVnRXhwKCBcIl5cIiArIGF0dHJpYnV0ZXMgKSxcblx0XHRcIlBTRVVET1wiOiBuZXcgUmVnRXhwKCBcIl5cIiArIHBzZXVkb3MgKSxcblx0XHRcIkNISUxEXCI6IG5ldyBSZWdFeHAoIFwiXjoob25seXxmaXJzdHxsYXN0fG50aHxudGgtbGFzdCktKGNoaWxkfG9mLXR5cGUpKD86XFxcXChcIiArIHdoaXRlc3BhY2UgK1xuXHRcdFx0XCIqKGV2ZW58b2RkfCgoWystXXwpKFxcXFxkKilufClcIiArIHdoaXRlc3BhY2UgKyBcIiooPzooWystXXwpXCIgKyB3aGl0ZXNwYWNlICtcblx0XHRcdFwiKihcXFxcZCspfCkpXCIgKyB3aGl0ZXNwYWNlICsgXCIqXFxcXCl8KVwiLCBcImlcIiApLFxuXHRcdFwiYm9vbFwiOiBuZXcgUmVnRXhwKCBcIl4oPzpcIiArIGJvb2xlYW5zICsgXCIpJFwiLCBcImlcIiApLFxuXHRcdC8vIEZvciB1c2UgaW4gbGlicmFyaWVzIGltcGxlbWVudGluZyAuaXMoKVxuXHRcdC8vIFdlIHVzZSB0aGlzIGZvciBQT1MgbWF0Y2hpbmcgaW4gYHNlbGVjdGBcblx0XHRcIm5lZWRzQ29udGV4dFwiOiBuZXcgUmVnRXhwKCBcIl5cIiArIHdoaXRlc3BhY2UgKyBcIipbPit+XXw6KGV2ZW58b2RkfGVxfGd0fGx0fG50aHxmaXJzdHxsYXN0KSg/OlxcXFwoXCIgK1xuXHRcdFx0d2hpdGVzcGFjZSArIFwiKigoPzotXFxcXGQpP1xcXFxkKilcIiArIHdoaXRlc3BhY2UgKyBcIipcXFxcKXwpKD89W14tXXwkKVwiLCBcImlcIiApXG5cdH0sXG5cblx0cmlucHV0cyA9IC9eKD86aW5wdXR8c2VsZWN0fHRleHRhcmVhfGJ1dHRvbikkL2ksXG5cdHJoZWFkZXIgPSAvXmhcXGQkL2ksXG5cblx0cm5hdGl2ZSA9IC9eW157XStcXHtcXHMqXFxbbmF0aXZlIFxcdy8sXG5cblx0Ly8gRWFzaWx5LXBhcnNlYWJsZS9yZXRyaWV2YWJsZSBJRCBvciBUQUcgb3IgQ0xBU1Mgc2VsZWN0b3JzXG5cdHJxdWlja0V4cHIgPSAvXig/OiMoW1xcdy1dKyl8KFxcdyspfFxcLihbXFx3LV0rKSkkLyxcblxuXHRyc2libGluZyA9IC9bK35dLyxcblx0cmVzY2FwZSA9IC8nfFxcXFwvZyxcblxuXHQvLyBDU1MgZXNjYXBlcyBodHRwOi8vd3d3LnczLm9yZy9UUi9DU1MyMS9zeW5kYXRhLmh0bWwjZXNjYXBlZC1jaGFyYWN0ZXJzXG5cdHJ1bmVzY2FwZSA9IG5ldyBSZWdFeHAoIFwiXFxcXFxcXFwoW1xcXFxkYS1mXXsxLDZ9XCIgKyB3aGl0ZXNwYWNlICsgXCI/fChcIiArIHdoaXRlc3BhY2UgKyBcIil8LilcIiwgXCJpZ1wiICksXG5cdGZ1bmVzY2FwZSA9IGZ1bmN0aW9uKCBfLCBlc2NhcGVkLCBlc2NhcGVkV2hpdGVzcGFjZSApIHtcblx0XHR2YXIgaGlnaCA9IFwiMHhcIiArIGVzY2FwZWQgLSAweDEwMDAwO1xuXHRcdC8vIE5hTiBtZWFucyBub24tY29kZXBvaW50XG5cdFx0Ly8gU3VwcG9ydDogRmlyZWZveDwyNFxuXHRcdC8vIFdvcmthcm91bmQgZXJyb25lb3VzIG51bWVyaWMgaW50ZXJwcmV0YXRpb24gb2YgK1wiMHhcIlxuXHRcdHJldHVybiBoaWdoICE9PSBoaWdoIHx8IGVzY2FwZWRXaGl0ZXNwYWNlID9cblx0XHRcdGVzY2FwZWQgOlxuXHRcdFx0aGlnaCA8IDAgP1xuXHRcdFx0XHQvLyBCTVAgY29kZXBvaW50XG5cdFx0XHRcdFN0cmluZy5mcm9tQ2hhckNvZGUoIGhpZ2ggKyAweDEwMDAwICkgOlxuXHRcdFx0XHQvLyBTdXBwbGVtZW50YWwgUGxhbmUgY29kZXBvaW50IChzdXJyb2dhdGUgcGFpcilcblx0XHRcdFx0U3RyaW5nLmZyb21DaGFyQ29kZSggaGlnaCA+PiAxMCB8IDB4RDgwMCwgaGlnaCAmIDB4M0ZGIHwgMHhEQzAwICk7XG5cdH0sXG5cblx0Ly8gVXNlZCBmb3IgaWZyYW1lc1xuXHQvLyBTZWUgc2V0RG9jdW1lbnQoKVxuXHQvLyBSZW1vdmluZyB0aGUgZnVuY3Rpb24gd3JhcHBlciBjYXVzZXMgYSBcIlBlcm1pc3Npb24gRGVuaWVkXCJcblx0Ly8gZXJyb3IgaW4gSUVcblx0dW5sb2FkSGFuZGxlciA9IGZ1bmN0aW9uKCkge1xuXHRcdHNldERvY3VtZW50KCk7XG5cdH07XG5cbi8vIE9wdGltaXplIGZvciBwdXNoLmFwcGx5KCBfLCBOb2RlTGlzdCApXG50cnkge1xuXHRwdXNoLmFwcGx5KFxuXHRcdChhcnIgPSBzbGljZS5jYWxsKCBwcmVmZXJyZWREb2MuY2hpbGROb2RlcyApKSxcblx0XHRwcmVmZXJyZWREb2MuY2hpbGROb2Rlc1xuXHQpO1xuXHQvLyBTdXBwb3J0OiBBbmRyb2lkPDQuMFxuXHQvLyBEZXRlY3Qgc2lsZW50bHkgZmFpbGluZyBwdXNoLmFwcGx5XG5cdGFyclsgcHJlZmVycmVkRG9jLmNoaWxkTm9kZXMubGVuZ3RoIF0ubm9kZVR5cGU7XG59IGNhdGNoICggZSApIHtcblx0cHVzaCA9IHsgYXBwbHk6IGFyci5sZW5ndGggP1xuXG5cdFx0Ly8gTGV2ZXJhZ2Ugc2xpY2UgaWYgcG9zc2libGVcblx0XHRmdW5jdGlvbiggdGFyZ2V0LCBlbHMgKSB7XG5cdFx0XHRwdXNoX25hdGl2ZS5hcHBseSggdGFyZ2V0LCBzbGljZS5jYWxsKGVscykgKTtcblx0XHR9IDpcblxuXHRcdC8vIFN1cHBvcnQ6IElFPDlcblx0XHQvLyBPdGhlcndpc2UgYXBwZW5kIGRpcmVjdGx5XG5cdFx0ZnVuY3Rpb24oIHRhcmdldCwgZWxzICkge1xuXHRcdFx0dmFyIGogPSB0YXJnZXQubGVuZ3RoLFxuXHRcdFx0XHRpID0gMDtcblx0XHRcdC8vIENhbid0IHRydXN0IE5vZGVMaXN0Lmxlbmd0aFxuXHRcdFx0d2hpbGUgKCAodGFyZ2V0W2orK10gPSBlbHNbaSsrXSkgKSB7fVxuXHRcdFx0dGFyZ2V0Lmxlbmd0aCA9IGogLSAxO1xuXHRcdH1cblx0fTtcbn1cblxuZnVuY3Rpb24gU2l6emxlKCBzZWxlY3RvciwgY29udGV4dCwgcmVzdWx0cywgc2VlZCApIHtcblx0dmFyIG1hdGNoLCBlbGVtLCBtLCBub2RlVHlwZSxcblx0XHQvLyBRU0EgdmFyc1xuXHRcdGksIGdyb3Vwcywgb2xkLCBuaWQsIG5ld0NvbnRleHQsIG5ld1NlbGVjdG9yO1xuXG5cdGlmICggKCBjb250ZXh0ID8gY29udGV4dC5vd25lckRvY3VtZW50IHx8IGNvbnRleHQgOiBwcmVmZXJyZWREb2MgKSAhPT0gZG9jdW1lbnQgKSB7XG5cdFx0c2V0RG9jdW1lbnQoIGNvbnRleHQgKTtcblx0fVxuXG5cdGNvbnRleHQgPSBjb250ZXh0IHx8IGRvY3VtZW50O1xuXHRyZXN1bHRzID0gcmVzdWx0cyB8fCBbXTtcblx0bm9kZVR5cGUgPSBjb250ZXh0Lm5vZGVUeXBlO1xuXG5cdGlmICggdHlwZW9mIHNlbGVjdG9yICE9PSBcInN0cmluZ1wiIHx8ICFzZWxlY3RvciB8fFxuXHRcdG5vZGVUeXBlICE9PSAxICYmIG5vZGVUeXBlICE9PSA5ICYmIG5vZGVUeXBlICE9PSAxMSApIHtcblxuXHRcdHJldHVybiByZXN1bHRzO1xuXHR9XG5cblx0aWYgKCAhc2VlZCAmJiBkb2N1bWVudElzSFRNTCApIHtcblxuXHRcdC8vIFRyeSB0byBzaG9ydGN1dCBmaW5kIG9wZXJhdGlvbnMgd2hlbiBwb3NzaWJsZSAoZS5nLiwgbm90IHVuZGVyIERvY3VtZW50RnJhZ21lbnQpXG5cdFx0aWYgKCBub2RlVHlwZSAhPT0gMTEgJiYgKG1hdGNoID0gcnF1aWNrRXhwci5leGVjKCBzZWxlY3RvciApKSApIHtcblx0XHRcdC8vIFNwZWVkLXVwOiBTaXp6bGUoXCIjSURcIilcblx0XHRcdGlmICggKG0gPSBtYXRjaFsxXSkgKSB7XG5cdFx0XHRcdGlmICggbm9kZVR5cGUgPT09IDkgKSB7XG5cdFx0XHRcdFx0ZWxlbSA9IGNvbnRleHQuZ2V0RWxlbWVudEJ5SWQoIG0gKTtcblx0XHRcdFx0XHQvLyBDaGVjayBwYXJlbnROb2RlIHRvIGNhdGNoIHdoZW4gQmxhY2tiZXJyeSA0LjYgcmV0dXJuc1xuXHRcdFx0XHRcdC8vIG5vZGVzIHRoYXQgYXJlIG5vIGxvbmdlciBpbiB0aGUgZG9jdW1lbnQgKGpRdWVyeSAjNjk2Mylcblx0XHRcdFx0XHRpZiAoIGVsZW0gJiYgZWxlbS5wYXJlbnROb2RlICkge1xuXHRcdFx0XHRcdFx0Ly8gSGFuZGxlIHRoZSBjYXNlIHdoZXJlIElFLCBPcGVyYSwgYW5kIFdlYmtpdCByZXR1cm4gaXRlbXNcblx0XHRcdFx0XHRcdC8vIGJ5IG5hbWUgaW5zdGVhZCBvZiBJRFxuXHRcdFx0XHRcdFx0aWYgKCBlbGVtLmlkID09PSBtICkge1xuXHRcdFx0XHRcdFx0XHRyZXN1bHRzLnB1c2goIGVsZW0gKTtcblx0XHRcdFx0XHRcdFx0cmV0dXJuIHJlc3VsdHM7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdHJldHVybiByZXN1bHRzO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHQvLyBDb250ZXh0IGlzIG5vdCBhIGRvY3VtZW50XG5cdFx0XHRcdFx0aWYgKCBjb250ZXh0Lm93bmVyRG9jdW1lbnQgJiYgKGVsZW0gPSBjb250ZXh0Lm93bmVyRG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoIG0gKSkgJiZcblx0XHRcdFx0XHRcdGNvbnRhaW5zKCBjb250ZXh0LCBlbGVtICkgJiYgZWxlbS5pZCA9PT0gbSApIHtcblx0XHRcdFx0XHRcdHJlc3VsdHMucHVzaCggZWxlbSApO1xuXHRcdFx0XHRcdFx0cmV0dXJuIHJlc3VsdHM7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cblx0XHRcdC8vIFNwZWVkLXVwOiBTaXp6bGUoXCJUQUdcIilcblx0XHRcdH0gZWxzZSBpZiAoIG1hdGNoWzJdICkge1xuXHRcdFx0XHRwdXNoLmFwcGx5KCByZXN1bHRzLCBjb250ZXh0LmdldEVsZW1lbnRzQnlUYWdOYW1lKCBzZWxlY3RvciApICk7XG5cdFx0XHRcdHJldHVybiByZXN1bHRzO1xuXG5cdFx0XHQvLyBTcGVlZC11cDogU2l6emxlKFwiLkNMQVNTXCIpXG5cdFx0XHR9IGVsc2UgaWYgKCAobSA9IG1hdGNoWzNdKSAmJiBzdXBwb3J0LmdldEVsZW1lbnRzQnlDbGFzc05hbWUgKSB7XG5cdFx0XHRcdHB1c2guYXBwbHkoIHJlc3VsdHMsIGNvbnRleHQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSggbSApICk7XG5cdFx0XHRcdHJldHVybiByZXN1bHRzO1xuXHRcdFx0fVxuXHRcdH1cblxuXHRcdC8vIFFTQSBwYXRoXG5cdFx0aWYgKCBzdXBwb3J0LnFzYSAmJiAoIXJidWdneVFTQSB8fCAhcmJ1Z2d5UVNBLnRlc3QoIHNlbGVjdG9yICkpICkge1xuXHRcdFx0bmlkID0gb2xkID0gZXhwYW5kbztcblx0XHRcdG5ld0NvbnRleHQgPSBjb250ZXh0O1xuXHRcdFx0bmV3U2VsZWN0b3IgPSBub2RlVHlwZSAhPT0gMSAmJiBzZWxlY3RvcjtcblxuXHRcdFx0Ly8gcVNBIHdvcmtzIHN0cmFuZ2VseSBvbiBFbGVtZW50LXJvb3RlZCBxdWVyaWVzXG5cdFx0XHQvLyBXZSBjYW4gd29yayBhcm91bmQgdGhpcyBieSBzcGVjaWZ5aW5nIGFuIGV4dHJhIElEIG9uIHRoZSByb290XG5cdFx0XHQvLyBhbmQgd29ya2luZyB1cCBmcm9tIHRoZXJlIChUaGFua3MgdG8gQW5kcmV3IER1cG9udCBmb3IgdGhlIHRlY2huaXF1ZSlcblx0XHRcdC8vIElFIDggZG9lc24ndCB3b3JrIG9uIG9iamVjdCBlbGVtZW50c1xuXHRcdFx0aWYgKCBub2RlVHlwZSA9PT0gMSAmJiBjb250ZXh0Lm5vZGVOYW1lLnRvTG93ZXJDYXNlKCkgIT09IFwib2JqZWN0XCIgKSB7XG5cdFx0XHRcdGdyb3VwcyA9IHRva2VuaXplKCBzZWxlY3RvciApO1xuXG5cdFx0XHRcdGlmICggKG9sZCA9IGNvbnRleHQuZ2V0QXR0cmlidXRlKFwiaWRcIikpICkge1xuXHRcdFx0XHRcdG5pZCA9IG9sZC5yZXBsYWNlKCByZXNjYXBlLCBcIlxcXFwkJlwiICk7XG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0Y29udGV4dC5zZXRBdHRyaWJ1dGUoIFwiaWRcIiwgbmlkICk7XG5cdFx0XHRcdH1cblx0XHRcdFx0bmlkID0gXCJbaWQ9J1wiICsgbmlkICsgXCInXSBcIjtcblxuXHRcdFx0XHRpID0gZ3JvdXBzLmxlbmd0aDtcblx0XHRcdFx0d2hpbGUgKCBpLS0gKSB7XG5cdFx0XHRcdFx0Z3JvdXBzW2ldID0gbmlkICsgdG9TZWxlY3RvciggZ3JvdXBzW2ldICk7XG5cdFx0XHRcdH1cblx0XHRcdFx0bmV3Q29udGV4dCA9IHJzaWJsaW5nLnRlc3QoIHNlbGVjdG9yICkgJiYgdGVzdENvbnRleHQoIGNvbnRleHQucGFyZW50Tm9kZSApIHx8IGNvbnRleHQ7XG5cdFx0XHRcdG5ld1NlbGVjdG9yID0gZ3JvdXBzLmpvaW4oXCIsXCIpO1xuXHRcdFx0fVxuXG5cdFx0XHRpZiAoIG5ld1NlbGVjdG9yICkge1xuXHRcdFx0XHR0cnkge1xuXHRcdFx0XHRcdHB1c2guYXBwbHkoIHJlc3VsdHMsXG5cdFx0XHRcdFx0XHRuZXdDb250ZXh0LnF1ZXJ5U2VsZWN0b3JBbGwoIG5ld1NlbGVjdG9yIClcblx0XHRcdFx0XHQpO1xuXHRcdFx0XHRcdHJldHVybiByZXN1bHRzO1xuXHRcdFx0XHR9IGNhdGNoKHFzYUVycm9yKSB7XG5cdFx0XHRcdH0gZmluYWxseSB7XG5cdFx0XHRcdFx0aWYgKCAhb2xkICkge1xuXHRcdFx0XHRcdFx0Y29udGV4dC5yZW1vdmVBdHRyaWJ1dGUoXCJpZFwiKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9XG5cdH1cblxuXHQvLyBBbGwgb3RoZXJzXG5cdHJldHVybiBzZWxlY3QoIHNlbGVjdG9yLnJlcGxhY2UoIHJ0cmltLCBcIiQxXCIgKSwgY29udGV4dCwgcmVzdWx0cywgc2VlZCApO1xufVxuXG4vKipcbiAqIENyZWF0ZSBrZXktdmFsdWUgY2FjaGVzIG9mIGxpbWl0ZWQgc2l6ZVxuICogQHJldHVybnMge0Z1bmN0aW9uKHN0cmluZywgT2JqZWN0KX0gUmV0dXJucyB0aGUgT2JqZWN0IGRhdGEgYWZ0ZXIgc3RvcmluZyBpdCBvbiBpdHNlbGYgd2l0aFxuICpcdHByb3BlcnR5IG5hbWUgdGhlIChzcGFjZS1zdWZmaXhlZCkgc3RyaW5nIGFuZCAoaWYgdGhlIGNhY2hlIGlzIGxhcmdlciB0aGFuIEV4cHIuY2FjaGVMZW5ndGgpXG4gKlx0ZGVsZXRpbmcgdGhlIG9sZGVzdCBlbnRyeVxuICovXG5mdW5jdGlvbiBjcmVhdGVDYWNoZSgpIHtcblx0dmFyIGtleXMgPSBbXTtcblxuXHRmdW5jdGlvbiBjYWNoZSgga2V5LCB2YWx1ZSApIHtcblx0XHQvLyBVc2UgKGtleSArIFwiIFwiKSB0byBhdm9pZCBjb2xsaXNpb24gd2l0aCBuYXRpdmUgcHJvdG90eXBlIHByb3BlcnRpZXMgKHNlZSBJc3N1ZSAjMTU3KVxuXHRcdGlmICgga2V5cy5wdXNoKCBrZXkgKyBcIiBcIiApID4gRXhwci5jYWNoZUxlbmd0aCApIHtcblx0XHRcdC8vIE9ubHkga2VlcCB0aGUgbW9zdCByZWNlbnQgZW50cmllc1xuXHRcdFx0ZGVsZXRlIGNhY2hlWyBrZXlzLnNoaWZ0KCkgXTtcblx0XHR9XG5cdFx0cmV0dXJuIChjYWNoZVsga2V5ICsgXCIgXCIgXSA9IHZhbHVlKTtcblx0fVxuXHRyZXR1cm4gY2FjaGU7XG59XG5cbi8qKlxuICogTWFyayBhIGZ1bmN0aW9uIGZvciBzcGVjaWFsIHVzZSBieSBTaXp6bGVcbiAqIEBwYXJhbSB7RnVuY3Rpb259IGZuIFRoZSBmdW5jdGlvbiB0byBtYXJrXG4gKi9cbmZ1bmN0aW9uIG1hcmtGdW5jdGlvbiggZm4gKSB7XG5cdGZuWyBleHBhbmRvIF0gPSB0cnVlO1xuXHRyZXR1cm4gZm47XG59XG5cbi8qKlxuICogU3VwcG9ydCB0ZXN0aW5nIHVzaW5nIGFuIGVsZW1lbnRcbiAqIEBwYXJhbSB7RnVuY3Rpb259IGZuIFBhc3NlZCB0aGUgY3JlYXRlZCBkaXYgYW5kIGV4cGVjdHMgYSBib29sZWFuIHJlc3VsdFxuICovXG5mdW5jdGlvbiBhc3NlcnQoIGZuICkge1xuXHR2YXIgZGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcblxuXHR0cnkge1xuXHRcdHJldHVybiAhIWZuKCBkaXYgKTtcblx0fSBjYXRjaCAoZSkge1xuXHRcdHJldHVybiBmYWxzZTtcblx0fSBmaW5hbGx5IHtcblx0XHQvLyBSZW1vdmUgZnJvbSBpdHMgcGFyZW50IGJ5IGRlZmF1bHRcblx0XHRpZiAoIGRpdi5wYXJlbnROb2RlICkge1xuXHRcdFx0ZGl2LnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQoIGRpdiApO1xuXHRcdH1cblx0XHQvLyByZWxlYXNlIG1lbW9yeSBpbiBJRVxuXHRcdGRpdiA9IG51bGw7XG5cdH1cbn1cblxuLyoqXG4gKiBBZGRzIHRoZSBzYW1lIGhhbmRsZXIgZm9yIGFsbCBvZiB0aGUgc3BlY2lmaWVkIGF0dHJzXG4gKiBAcGFyYW0ge1N0cmluZ30gYXR0cnMgUGlwZS1zZXBhcmF0ZWQgbGlzdCBvZiBhdHRyaWJ1dGVzXG4gKiBAcGFyYW0ge0Z1bmN0aW9ufSBoYW5kbGVyIFRoZSBtZXRob2QgdGhhdCB3aWxsIGJlIGFwcGxpZWRcbiAqL1xuZnVuY3Rpb24gYWRkSGFuZGxlKCBhdHRycywgaGFuZGxlciApIHtcblx0dmFyIGFyciA9IGF0dHJzLnNwbGl0KFwifFwiKSxcblx0XHRpID0gYXR0cnMubGVuZ3RoO1xuXG5cdHdoaWxlICggaS0tICkge1xuXHRcdEV4cHIuYXR0ckhhbmRsZVsgYXJyW2ldIF0gPSBoYW5kbGVyO1xuXHR9XG59XG5cbi8qKlxuICogQ2hlY2tzIGRvY3VtZW50IG9yZGVyIG9mIHR3byBzaWJsaW5nc1xuICogQHBhcmFtIHtFbGVtZW50fSBhXG4gKiBAcGFyYW0ge0VsZW1lbnR9IGJcbiAqIEByZXR1cm5zIHtOdW1iZXJ9IFJldHVybnMgbGVzcyB0aGFuIDAgaWYgYSBwcmVjZWRlcyBiLCBncmVhdGVyIHRoYW4gMCBpZiBhIGZvbGxvd3MgYlxuICovXG5mdW5jdGlvbiBzaWJsaW5nQ2hlY2soIGEsIGIgKSB7XG5cdHZhciBjdXIgPSBiICYmIGEsXG5cdFx0ZGlmZiA9IGN1ciAmJiBhLm5vZGVUeXBlID09PSAxICYmIGIubm9kZVR5cGUgPT09IDEgJiZcblx0XHRcdCggfmIuc291cmNlSW5kZXggfHwgTUFYX05FR0FUSVZFICkgLVxuXHRcdFx0KCB+YS5zb3VyY2VJbmRleCB8fCBNQVhfTkVHQVRJVkUgKTtcblxuXHQvLyBVc2UgSUUgc291cmNlSW5kZXggaWYgYXZhaWxhYmxlIG9uIGJvdGggbm9kZXNcblx0aWYgKCBkaWZmICkge1xuXHRcdHJldHVybiBkaWZmO1xuXHR9XG5cblx0Ly8gQ2hlY2sgaWYgYiBmb2xsb3dzIGFcblx0aWYgKCBjdXIgKSB7XG5cdFx0d2hpbGUgKCAoY3VyID0gY3VyLm5leHRTaWJsaW5nKSApIHtcblx0XHRcdGlmICggY3VyID09PSBiICkge1xuXHRcdFx0XHRyZXR1cm4gLTE7XG5cdFx0XHR9XG5cdFx0fVxuXHR9XG5cblx0cmV0dXJuIGEgPyAxIDogLTE7XG59XG5cbi8qKlxuICogUmV0dXJucyBhIGZ1bmN0aW9uIHRvIHVzZSBpbiBwc2V1ZG9zIGZvciBpbnB1dCB0eXBlc1xuICogQHBhcmFtIHtTdHJpbmd9IHR5cGVcbiAqL1xuZnVuY3Rpb24gY3JlYXRlSW5wdXRQc2V1ZG8oIHR5cGUgKSB7XG5cdHJldHVybiBmdW5jdGlvbiggZWxlbSApIHtcblx0XHR2YXIgbmFtZSA9IGVsZW0ubm9kZU5hbWUudG9Mb3dlckNhc2UoKTtcblx0XHRyZXR1cm4gbmFtZSA9PT0gXCJpbnB1dFwiICYmIGVsZW0udHlwZSA9PT0gdHlwZTtcblx0fTtcbn1cblxuLyoqXG4gKiBSZXR1cm5zIGEgZnVuY3Rpb24gdG8gdXNlIGluIHBzZXVkb3MgZm9yIGJ1dHRvbnNcbiAqIEBwYXJhbSB7U3RyaW5nfSB0eXBlXG4gKi9cbmZ1bmN0aW9uIGNyZWF0ZUJ1dHRvblBzZXVkbyggdHlwZSApIHtcblx0cmV0dXJuIGZ1bmN0aW9uKCBlbGVtICkge1xuXHRcdHZhciBuYW1lID0gZWxlbS5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpO1xuXHRcdHJldHVybiAobmFtZSA9PT0gXCJpbnB1dFwiIHx8IG5hbWUgPT09IFwiYnV0dG9uXCIpICYmIGVsZW0udHlwZSA9PT0gdHlwZTtcblx0fTtcbn1cblxuLyoqXG4gKiBSZXR1cm5zIGEgZnVuY3Rpb24gdG8gdXNlIGluIHBzZXVkb3MgZm9yIHBvc2l0aW9uYWxzXG4gKiBAcGFyYW0ge0Z1bmN0aW9ufSBmblxuICovXG5mdW5jdGlvbiBjcmVhdGVQb3NpdGlvbmFsUHNldWRvKCBmbiApIHtcblx0cmV0dXJuIG1hcmtGdW5jdGlvbihmdW5jdGlvbiggYXJndW1lbnQgKSB7XG5cdFx0YXJndW1lbnQgPSArYXJndW1lbnQ7XG5cdFx0cmV0dXJuIG1hcmtGdW5jdGlvbihmdW5jdGlvbiggc2VlZCwgbWF0Y2hlcyApIHtcblx0XHRcdHZhciBqLFxuXHRcdFx0XHRtYXRjaEluZGV4ZXMgPSBmbiggW10sIHNlZWQubGVuZ3RoLCBhcmd1bWVudCApLFxuXHRcdFx0XHRpID0gbWF0Y2hJbmRleGVzLmxlbmd0aDtcblxuXHRcdFx0Ly8gTWF0Y2ggZWxlbWVudHMgZm91bmQgYXQgdGhlIHNwZWNpZmllZCBpbmRleGVzXG5cdFx0XHR3aGlsZSAoIGktLSApIHtcblx0XHRcdFx0aWYgKCBzZWVkWyAoaiA9IG1hdGNoSW5kZXhlc1tpXSkgXSApIHtcblx0XHRcdFx0XHRzZWVkW2pdID0gIShtYXRjaGVzW2pdID0gc2VlZFtqXSk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9KTtcblx0fSk7XG59XG5cbi8qKlxuICogQ2hlY2tzIGEgbm9kZSBmb3IgdmFsaWRpdHkgYXMgYSBTaXp6bGUgY29udGV4dFxuICogQHBhcmFtIHtFbGVtZW50fE9iamVjdD19IGNvbnRleHRcbiAqIEByZXR1cm5zIHtFbGVtZW50fE9iamVjdHxCb29sZWFufSBUaGUgaW5wdXQgbm9kZSBpZiBhY2NlcHRhYmxlLCBvdGhlcndpc2UgYSBmYWxzeSB2YWx1ZVxuICovXG5mdW5jdGlvbiB0ZXN0Q29udGV4dCggY29udGV4dCApIHtcblx0cmV0dXJuIGNvbnRleHQgJiYgdHlwZW9mIGNvbnRleHQuZ2V0RWxlbWVudHNCeVRhZ05hbWUgIT09IFwidW5kZWZpbmVkXCIgJiYgY29udGV4dDtcbn1cblxuLy8gRXhwb3NlIHN1cHBvcnQgdmFycyBmb3IgY29udmVuaWVuY2VcbnN1cHBvcnQgPSBTaXp6bGUuc3VwcG9ydCA9IHt9O1xuXG4vKipcbiAqIERldGVjdHMgWE1MIG5vZGVzXG4gKiBAcGFyYW0ge0VsZW1lbnR8T2JqZWN0fSBlbGVtIEFuIGVsZW1lbnQgb3IgYSBkb2N1bWVudFxuICogQHJldHVybnMge0Jvb2xlYW59IFRydWUgaWZmIGVsZW0gaXMgYSBub24tSFRNTCBYTUwgbm9kZVxuICovXG5pc1hNTCA9IFNpenpsZS5pc1hNTCA9IGZ1bmN0aW9uKCBlbGVtICkge1xuXHQvLyBkb2N1bWVudEVsZW1lbnQgaXMgdmVyaWZpZWQgZm9yIGNhc2VzIHdoZXJlIGl0IGRvZXNuJ3QgeWV0IGV4aXN0XG5cdC8vIChzdWNoIGFzIGxvYWRpbmcgaWZyYW1lcyBpbiBJRSAtICM0ODMzKVxuXHR2YXIgZG9jdW1lbnRFbGVtZW50ID0gZWxlbSAmJiAoZWxlbS5vd25lckRvY3VtZW50IHx8IGVsZW0pLmRvY3VtZW50RWxlbWVudDtcblx0cmV0dXJuIGRvY3VtZW50RWxlbWVudCA/IGRvY3VtZW50RWxlbWVudC5ub2RlTmFtZSAhPT0gXCJIVE1MXCIgOiBmYWxzZTtcbn07XG5cbi8qKlxuICogU2V0cyBkb2N1bWVudC1yZWxhdGVkIHZhcmlhYmxlcyBvbmNlIGJhc2VkIG9uIHRoZSBjdXJyZW50IGRvY3VtZW50XG4gKiBAcGFyYW0ge0VsZW1lbnR8T2JqZWN0fSBbZG9jXSBBbiBlbGVtZW50IG9yIGRvY3VtZW50IG9iamVjdCB0byB1c2UgdG8gc2V0IHRoZSBkb2N1bWVudFxuICogQHJldHVybnMge09iamVjdH0gUmV0dXJucyB0aGUgY3VycmVudCBkb2N1bWVudFxuICovXG5zZXREb2N1bWVudCA9IFNpenpsZS5zZXREb2N1bWVudCA9IGZ1bmN0aW9uKCBub2RlICkge1xuXHR2YXIgaGFzQ29tcGFyZSwgcGFyZW50LFxuXHRcdGRvYyA9IG5vZGUgPyBub2RlLm93bmVyRG9jdW1lbnQgfHwgbm9kZSA6IHByZWZlcnJlZERvYztcblxuXHQvLyBJZiBubyBkb2N1bWVudCBhbmQgZG9jdW1lbnRFbGVtZW50IGlzIGF2YWlsYWJsZSwgcmV0dXJuXG5cdGlmICggZG9jID09PSBkb2N1bWVudCB8fCBkb2Mubm9kZVR5cGUgIT09IDkgfHwgIWRvYy5kb2N1bWVudEVsZW1lbnQgKSB7XG5cdFx0cmV0dXJuIGRvY3VtZW50O1xuXHR9XG5cblx0Ly8gU2V0IG91ciBkb2N1bWVudFxuXHRkb2N1bWVudCA9IGRvYztcblx0ZG9jRWxlbSA9IGRvYy5kb2N1bWVudEVsZW1lbnQ7XG5cdHBhcmVudCA9IGRvYy5kZWZhdWx0VmlldztcblxuXHQvLyBTdXBwb3J0OiBJRT44XG5cdC8vIElmIGlmcmFtZSBkb2N1bWVudCBpcyBhc3NpZ25lZCB0byBcImRvY3VtZW50XCIgdmFyaWFibGUgYW5kIGlmIGlmcmFtZSBoYXMgYmVlbiByZWxvYWRlZCxcblx0Ly8gSUUgd2lsbCB0aHJvdyBcInBlcm1pc3Npb24gZGVuaWVkXCIgZXJyb3Igd2hlbiBhY2Nlc3NpbmcgXCJkb2N1bWVudFwiIHZhcmlhYmxlLCBzZWUgalF1ZXJ5ICMxMzkzNlxuXHQvLyBJRTYtOCBkbyBub3Qgc3VwcG9ydCB0aGUgZGVmYXVsdFZpZXcgcHJvcGVydHkgc28gcGFyZW50IHdpbGwgYmUgdW5kZWZpbmVkXG5cdGlmICggcGFyZW50ICYmIHBhcmVudCAhPT0gcGFyZW50LnRvcCApIHtcblx0XHQvLyBJRTExIGRvZXMgbm90IGhhdmUgYXR0YWNoRXZlbnQsIHNvIGFsbCBtdXN0IHN1ZmZlclxuXHRcdGlmICggcGFyZW50LmFkZEV2ZW50TGlzdGVuZXIgKSB7XG5cdFx0XHRwYXJlbnQuYWRkRXZlbnRMaXN0ZW5lciggXCJ1bmxvYWRcIiwgdW5sb2FkSGFuZGxlciwgZmFsc2UgKTtcblx0XHR9IGVsc2UgaWYgKCBwYXJlbnQuYXR0YWNoRXZlbnQgKSB7XG5cdFx0XHRwYXJlbnQuYXR0YWNoRXZlbnQoIFwib251bmxvYWRcIiwgdW5sb2FkSGFuZGxlciApO1xuXHRcdH1cblx0fVxuXG5cdC8qIFN1cHBvcnQgdGVzdHNcblx0LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuXHRkb2N1bWVudElzSFRNTCA9ICFpc1hNTCggZG9jICk7XG5cblx0LyogQXR0cmlidXRlc1xuXHQtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG5cblx0Ly8gU3VwcG9ydDogSUU8OFxuXHQvLyBWZXJpZnkgdGhhdCBnZXRBdHRyaWJ1dGUgcmVhbGx5IHJldHVybnMgYXR0cmlidXRlcyBhbmQgbm90IHByb3BlcnRpZXNcblx0Ly8gKGV4Y2VwdGluZyBJRTggYm9vbGVhbnMpXG5cdHN1cHBvcnQuYXR0cmlidXRlcyA9IGFzc2VydChmdW5jdGlvbiggZGl2ICkge1xuXHRcdGRpdi5jbGFzc05hbWUgPSBcImlcIjtcblx0XHRyZXR1cm4gIWRpdi5nZXRBdHRyaWJ1dGUoXCJjbGFzc05hbWVcIik7XG5cdH0pO1xuXG5cdC8qIGdldEVsZW1lbnQocylCeSpcblx0LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuXG5cdC8vIENoZWNrIGlmIGdldEVsZW1lbnRzQnlUYWdOYW1lKFwiKlwiKSByZXR1cm5zIG9ubHkgZWxlbWVudHNcblx0c3VwcG9ydC5nZXRFbGVtZW50c0J5VGFnTmFtZSA9IGFzc2VydChmdW5jdGlvbiggZGl2ICkge1xuXHRcdGRpdi5hcHBlbmRDaGlsZCggZG9jLmNyZWF0ZUNvbW1lbnQoXCJcIikgKTtcblx0XHRyZXR1cm4gIWRpdi5nZXRFbGVtZW50c0J5VGFnTmFtZShcIipcIikubGVuZ3RoO1xuXHR9KTtcblxuXHQvLyBTdXBwb3J0OiBJRTw5XG5cdHN1cHBvcnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSA9IHJuYXRpdmUudGVzdCggZG9jLmdldEVsZW1lbnRzQnlDbGFzc05hbWUgKTtcblxuXHQvLyBTdXBwb3J0OiBJRTwxMFxuXHQvLyBDaGVjayBpZiBnZXRFbGVtZW50QnlJZCByZXR1cm5zIGVsZW1lbnRzIGJ5IG5hbWVcblx0Ly8gVGhlIGJyb2tlbiBnZXRFbGVtZW50QnlJZCBtZXRob2RzIGRvbid0IHBpY2sgdXAgcHJvZ3JhbWF0aWNhbGx5LXNldCBuYW1lcyxcblx0Ly8gc28gdXNlIGEgcm91bmRhYm91dCBnZXRFbGVtZW50c0J5TmFtZSB0ZXN0XG5cdHN1cHBvcnQuZ2V0QnlJZCA9IGFzc2VydChmdW5jdGlvbiggZGl2ICkge1xuXHRcdGRvY0VsZW0uYXBwZW5kQ2hpbGQoIGRpdiApLmlkID0gZXhwYW5kbztcblx0XHRyZXR1cm4gIWRvYy5nZXRFbGVtZW50c0J5TmFtZSB8fCAhZG9jLmdldEVsZW1lbnRzQnlOYW1lKCBleHBhbmRvICkubGVuZ3RoO1xuXHR9KTtcblxuXHQvLyBJRCBmaW5kIGFuZCBmaWx0ZXJcblx0aWYgKCBzdXBwb3J0LmdldEJ5SWQgKSB7XG5cdFx0RXhwci5maW5kW1wiSURcIl0gPSBmdW5jdGlvbiggaWQsIGNvbnRleHQgKSB7XG5cdFx0XHRpZiAoIHR5cGVvZiBjb250ZXh0LmdldEVsZW1lbnRCeUlkICE9PSBcInVuZGVmaW5lZFwiICYmIGRvY3VtZW50SXNIVE1MICkge1xuXHRcdFx0XHR2YXIgbSA9IGNvbnRleHQuZ2V0RWxlbWVudEJ5SWQoIGlkICk7XG5cdFx0XHRcdC8vIENoZWNrIHBhcmVudE5vZGUgdG8gY2F0Y2ggd2hlbiBCbGFja2JlcnJ5IDQuNiByZXR1cm5zXG5cdFx0XHRcdC8vIG5vZGVzIHRoYXQgYXJlIG5vIGxvbmdlciBpbiB0aGUgZG9jdW1lbnQgIzY5NjNcblx0XHRcdFx0cmV0dXJuIG0gJiYgbS5wYXJlbnROb2RlID8gWyBtIF0gOiBbXTtcblx0XHRcdH1cblx0XHR9O1xuXHRcdEV4cHIuZmlsdGVyW1wiSURcIl0gPSBmdW5jdGlvbiggaWQgKSB7XG5cdFx0XHR2YXIgYXR0cklkID0gaWQucmVwbGFjZSggcnVuZXNjYXBlLCBmdW5lc2NhcGUgKTtcblx0XHRcdHJldHVybiBmdW5jdGlvbiggZWxlbSApIHtcblx0XHRcdFx0cmV0dXJuIGVsZW0uZ2V0QXR0cmlidXRlKFwiaWRcIikgPT09IGF0dHJJZDtcblx0XHRcdH07XG5cdFx0fTtcblx0fSBlbHNlIHtcblx0XHQvLyBTdXBwb3J0OiBJRTYvN1xuXHRcdC8vIGdldEVsZW1lbnRCeUlkIGlzIG5vdCByZWxpYWJsZSBhcyBhIGZpbmQgc2hvcnRjdXRcblx0XHRkZWxldGUgRXhwci5maW5kW1wiSURcIl07XG5cblx0XHRFeHByLmZpbHRlcltcIklEXCJdID0gIGZ1bmN0aW9uKCBpZCApIHtcblx0XHRcdHZhciBhdHRySWQgPSBpZC5yZXBsYWNlKCBydW5lc2NhcGUsIGZ1bmVzY2FwZSApO1xuXHRcdFx0cmV0dXJuIGZ1bmN0aW9uKCBlbGVtICkge1xuXHRcdFx0XHR2YXIgbm9kZSA9IHR5cGVvZiBlbGVtLmdldEF0dHJpYnV0ZU5vZGUgIT09IFwidW5kZWZpbmVkXCIgJiYgZWxlbS5nZXRBdHRyaWJ1dGVOb2RlKFwiaWRcIik7XG5cdFx0XHRcdHJldHVybiBub2RlICYmIG5vZGUudmFsdWUgPT09IGF0dHJJZDtcblx0XHRcdH07XG5cdFx0fTtcblx0fVxuXG5cdC8vIFRhZ1xuXHRFeHByLmZpbmRbXCJUQUdcIl0gPSBzdXBwb3J0LmdldEVsZW1lbnRzQnlUYWdOYW1lID9cblx0XHRmdW5jdGlvbiggdGFnLCBjb250ZXh0ICkge1xuXHRcdFx0aWYgKCB0eXBlb2YgY29udGV4dC5nZXRFbGVtZW50c0J5VGFnTmFtZSAhPT0gXCJ1bmRlZmluZWRcIiApIHtcblx0XHRcdFx0cmV0dXJuIGNvbnRleHQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoIHRhZyApO1xuXG5cdFx0XHQvLyBEb2N1bWVudEZyYWdtZW50IG5vZGVzIGRvbid0IGhhdmUgZ0VCVE5cblx0XHRcdH0gZWxzZSBpZiAoIHN1cHBvcnQucXNhICkge1xuXHRcdFx0XHRyZXR1cm4gY29udGV4dC5xdWVyeVNlbGVjdG9yQWxsKCB0YWcgKTtcblx0XHRcdH1cblx0XHR9IDpcblxuXHRcdGZ1bmN0aW9uKCB0YWcsIGNvbnRleHQgKSB7XG5cdFx0XHR2YXIgZWxlbSxcblx0XHRcdFx0dG1wID0gW10sXG5cdFx0XHRcdGkgPSAwLFxuXHRcdFx0XHQvLyBCeSBoYXBweSBjb2luY2lkZW5jZSwgYSAoYnJva2VuKSBnRUJUTiBhcHBlYXJzIG9uIERvY3VtZW50RnJhZ21lbnQgbm9kZXMgdG9vXG5cdFx0XHRcdHJlc3VsdHMgPSBjb250ZXh0LmdldEVsZW1lbnRzQnlUYWdOYW1lKCB0YWcgKTtcblxuXHRcdFx0Ly8gRmlsdGVyIG91dCBwb3NzaWJsZSBjb21tZW50c1xuXHRcdFx0aWYgKCB0YWcgPT09IFwiKlwiICkge1xuXHRcdFx0XHR3aGlsZSAoIChlbGVtID0gcmVzdWx0c1tpKytdKSApIHtcblx0XHRcdFx0XHRpZiAoIGVsZW0ubm9kZVR5cGUgPT09IDEgKSB7XG5cdFx0XHRcdFx0XHR0bXAucHVzaCggZWxlbSApO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXG5cdFx0XHRcdHJldHVybiB0bXA7XG5cdFx0XHR9XG5cdFx0XHRyZXR1cm4gcmVzdWx0cztcblx0XHR9O1xuXG5cdC8vIENsYXNzXG5cdEV4cHIuZmluZFtcIkNMQVNTXCJdID0gc3VwcG9ydC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lICYmIGZ1bmN0aW9uKCBjbGFzc05hbWUsIGNvbnRleHQgKSB7XG5cdFx0aWYgKCBkb2N1bWVudElzSFRNTCApIHtcblx0XHRcdHJldHVybiBjb250ZXh0LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoIGNsYXNzTmFtZSApO1xuXHRcdH1cblx0fTtcblxuXHQvKiBRU0EvbWF0Y2hlc1NlbGVjdG9yXG5cdC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cblxuXHQvLyBRU0EgYW5kIG1hdGNoZXNTZWxlY3RvciBzdXBwb3J0XG5cblx0Ly8gbWF0Y2hlc1NlbGVjdG9yKDphY3RpdmUpIHJlcG9ydHMgZmFsc2Ugd2hlbiB0cnVlIChJRTkvT3BlcmEgMTEuNSlcblx0cmJ1Z2d5TWF0Y2hlcyA9IFtdO1xuXG5cdC8vIHFTYSg6Zm9jdXMpIHJlcG9ydHMgZmFsc2Ugd2hlbiB0cnVlIChDaHJvbWUgMjEpXG5cdC8vIFdlIGFsbG93IHRoaXMgYmVjYXVzZSBvZiBhIGJ1ZyBpbiBJRTgvOSB0aGF0IHRocm93cyBhbiBlcnJvclxuXHQvLyB3aGVuZXZlciBgZG9jdW1lbnQuYWN0aXZlRWxlbWVudGAgaXMgYWNjZXNzZWQgb24gYW4gaWZyYW1lXG5cdC8vIFNvLCB3ZSBhbGxvdyA6Zm9jdXMgdG8gcGFzcyB0aHJvdWdoIFFTQSBhbGwgdGhlIHRpbWUgdG8gYXZvaWQgdGhlIElFIGVycm9yXG5cdC8vIFNlZSBodHRwOi8vYnVncy5qcXVlcnkuY29tL3RpY2tldC8xMzM3OFxuXHRyYnVnZ3lRU0EgPSBbXTtcblxuXHRpZiAoIChzdXBwb3J0LnFzYSA9IHJuYXRpdmUudGVzdCggZG9jLnF1ZXJ5U2VsZWN0b3JBbGwgKSkgKSB7XG5cdFx0Ly8gQnVpbGQgUVNBIHJlZ2V4XG5cdFx0Ly8gUmVnZXggc3RyYXRlZ3kgYWRvcHRlZCBmcm9tIERpZWdvIFBlcmluaVxuXHRcdGFzc2VydChmdW5jdGlvbiggZGl2ICkge1xuXHRcdFx0Ly8gU2VsZWN0IGlzIHNldCB0byBlbXB0eSBzdHJpbmcgb24gcHVycG9zZVxuXHRcdFx0Ly8gVGhpcyBpcyB0byB0ZXN0IElFJ3MgdHJlYXRtZW50IG9mIG5vdCBleHBsaWNpdGx5XG5cdFx0XHQvLyBzZXR0aW5nIGEgYm9vbGVhbiBjb250ZW50IGF0dHJpYnV0ZSxcblx0XHRcdC8vIHNpbmNlIGl0cyBwcmVzZW5jZSBzaG91bGQgYmUgZW5vdWdoXG5cdFx0XHQvLyBodHRwOi8vYnVncy5qcXVlcnkuY29tL3RpY2tldC8xMjM1OVxuXHRcdFx0ZG9jRWxlbS5hcHBlbmRDaGlsZCggZGl2ICkuaW5uZXJIVE1MID0gXCI8YSBpZD0nXCIgKyBleHBhbmRvICsgXCInPjwvYT5cIiArXG5cdFx0XHRcdFwiPHNlbGVjdCBpZD0nXCIgKyBleHBhbmRvICsgXCItXFxmXScgbXNhbGxvd2NhcHR1cmU9Jyc+XCIgK1xuXHRcdFx0XHRcIjxvcHRpb24gc2VsZWN0ZWQ9Jyc+PC9vcHRpb24+PC9zZWxlY3Q+XCI7XG5cblx0XHRcdC8vIFN1cHBvcnQ6IElFOCwgT3BlcmEgMTEtMTIuMTZcblx0XHRcdC8vIE5vdGhpbmcgc2hvdWxkIGJlIHNlbGVjdGVkIHdoZW4gZW1wdHkgc3RyaW5ncyBmb2xsb3cgXj0gb3IgJD0gb3IgKj1cblx0XHRcdC8vIFRoZSB0ZXN0IGF0dHJpYnV0ZSBtdXN0IGJlIHVua25vd24gaW4gT3BlcmEgYnV0IFwic2FmZVwiIGZvciBXaW5SVFxuXHRcdFx0Ly8gaHR0cDovL21zZG4ubWljcm9zb2Z0LmNvbS9lbi11cy9saWJyYXJ5L2llL2hoNDY1Mzg4LmFzcHgjYXR0cmlidXRlX3NlY3Rpb25cblx0XHRcdGlmICggZGl2LnF1ZXJ5U2VsZWN0b3JBbGwoXCJbbXNhbGxvd2NhcHR1cmVePScnXVwiKS5sZW5ndGggKSB7XG5cdFx0XHRcdHJidWdneVFTQS5wdXNoKCBcIlsqXiRdPVwiICsgd2hpdGVzcGFjZSArIFwiKig/OicnfFxcXCJcXFwiKVwiICk7XG5cdFx0XHR9XG5cblx0XHRcdC8vIFN1cHBvcnQ6IElFOFxuXHRcdFx0Ly8gQm9vbGVhbiBhdHRyaWJ1dGVzIGFuZCBcInZhbHVlXCIgYXJlIG5vdCB0cmVhdGVkIGNvcnJlY3RseVxuXHRcdFx0aWYgKCAhZGl2LnF1ZXJ5U2VsZWN0b3JBbGwoXCJbc2VsZWN0ZWRdXCIpLmxlbmd0aCApIHtcblx0XHRcdFx0cmJ1Z2d5UVNBLnB1c2goIFwiXFxcXFtcIiArIHdoaXRlc3BhY2UgKyBcIiooPzp2YWx1ZXxcIiArIGJvb2xlYW5zICsgXCIpXCIgKTtcblx0XHRcdH1cblxuXHRcdFx0Ly8gU3VwcG9ydDogQ2hyb21lPDI5LCBBbmRyb2lkPDQuMissIFNhZmFyaTw3LjArLCBpT1M8Ny4wKywgUGhhbnRvbUpTPDEuOS43K1xuXHRcdFx0aWYgKCAhZGl2LnF1ZXJ5U2VsZWN0b3JBbGwoIFwiW2lkfj1cIiArIGV4cGFuZG8gKyBcIi1dXCIgKS5sZW5ndGggKSB7XG5cdFx0XHRcdHJidWdneVFTQS5wdXNoKFwifj1cIik7XG5cdFx0XHR9XG5cblx0XHRcdC8vIFdlYmtpdC9PcGVyYSAtIDpjaGVja2VkIHNob3VsZCByZXR1cm4gc2VsZWN0ZWQgb3B0aW9uIGVsZW1lbnRzXG5cdFx0XHQvLyBodHRwOi8vd3d3LnczLm9yZy9UUi8yMDExL1JFQy1jc3MzLXNlbGVjdG9ycy0yMDExMDkyOS8jY2hlY2tlZFxuXHRcdFx0Ly8gSUU4IHRocm93cyBlcnJvciBoZXJlIGFuZCB3aWxsIG5vdCBzZWUgbGF0ZXIgdGVzdHNcblx0XHRcdGlmICggIWRpdi5xdWVyeVNlbGVjdG9yQWxsKFwiOmNoZWNrZWRcIikubGVuZ3RoICkge1xuXHRcdFx0XHRyYnVnZ3lRU0EucHVzaChcIjpjaGVja2VkXCIpO1xuXHRcdFx0fVxuXG5cdFx0XHQvLyBTdXBwb3J0OiBTYWZhcmkgOCssIGlPUyA4K1xuXHRcdFx0Ly8gaHR0cHM6Ly9idWdzLndlYmtpdC5vcmcvc2hvd19idWcuY2dpP2lkPTEzNjg1MVxuXHRcdFx0Ly8gSW4tcGFnZSBgc2VsZWN0b3IjaWQgc2liaW5nLWNvbWJpbmF0b3Igc2VsZWN0b3JgIGZhaWxzXG5cdFx0XHRpZiAoICFkaXYucXVlcnlTZWxlY3RvckFsbCggXCJhI1wiICsgZXhwYW5kbyArIFwiKypcIiApLmxlbmd0aCApIHtcblx0XHRcdFx0cmJ1Z2d5UVNBLnB1c2goXCIuIy4rWyt+XVwiKTtcblx0XHRcdH1cblx0XHR9KTtcblxuXHRcdGFzc2VydChmdW5jdGlvbiggZGl2ICkge1xuXHRcdFx0Ly8gU3VwcG9ydDogV2luZG93cyA4IE5hdGl2ZSBBcHBzXG5cdFx0XHQvLyBUaGUgdHlwZSBhbmQgbmFtZSBhdHRyaWJ1dGVzIGFyZSByZXN0cmljdGVkIGR1cmluZyAuaW5uZXJIVE1MIGFzc2lnbm1lbnRcblx0XHRcdHZhciBpbnB1dCA9IGRvYy5jcmVhdGVFbGVtZW50KFwiaW5wdXRcIik7XG5cdFx0XHRpbnB1dC5zZXRBdHRyaWJ1dGUoIFwidHlwZVwiLCBcImhpZGRlblwiICk7XG5cdFx0XHRkaXYuYXBwZW5kQ2hpbGQoIGlucHV0ICkuc2V0QXR0cmlidXRlKCBcIm5hbWVcIiwgXCJEXCIgKTtcblxuXHRcdFx0Ly8gU3VwcG9ydDogSUU4XG5cdFx0XHQvLyBFbmZvcmNlIGNhc2Utc2Vuc2l0aXZpdHkgb2YgbmFtZSBhdHRyaWJ1dGVcblx0XHRcdGlmICggZGl2LnF1ZXJ5U2VsZWN0b3JBbGwoXCJbbmFtZT1kXVwiKS5sZW5ndGggKSB7XG5cdFx0XHRcdHJidWdneVFTQS5wdXNoKCBcIm5hbWVcIiArIHdoaXRlc3BhY2UgKyBcIipbKl4kfCF+XT89XCIgKTtcblx0XHRcdH1cblxuXHRcdFx0Ly8gRkYgMy41IC0gOmVuYWJsZWQvOmRpc2FibGVkIGFuZCBoaWRkZW4gZWxlbWVudHMgKGhpZGRlbiBlbGVtZW50cyBhcmUgc3RpbGwgZW5hYmxlZClcblx0XHRcdC8vIElFOCB0aHJvd3MgZXJyb3IgaGVyZSBhbmQgd2lsbCBub3Qgc2VlIGxhdGVyIHRlc3RzXG5cdFx0XHRpZiAoICFkaXYucXVlcnlTZWxlY3RvckFsbChcIjplbmFibGVkXCIpLmxlbmd0aCApIHtcblx0XHRcdFx0cmJ1Z2d5UVNBLnB1c2goIFwiOmVuYWJsZWRcIiwgXCI6ZGlzYWJsZWRcIiApO1xuXHRcdFx0fVxuXG5cdFx0XHQvLyBPcGVyYSAxMC0xMSBkb2VzIG5vdCB0aHJvdyBvbiBwb3N0LWNvbW1hIGludmFsaWQgcHNldWRvc1xuXHRcdFx0ZGl2LnF1ZXJ5U2VsZWN0b3JBbGwoXCIqLDp4XCIpO1xuXHRcdFx0cmJ1Z2d5UVNBLnB1c2goXCIsLio6XCIpO1xuXHRcdH0pO1xuXHR9XG5cblx0aWYgKCAoc3VwcG9ydC5tYXRjaGVzU2VsZWN0b3IgPSBybmF0aXZlLnRlc3QoIChtYXRjaGVzID0gZG9jRWxlbS5tYXRjaGVzIHx8XG5cdFx0ZG9jRWxlbS53ZWJraXRNYXRjaGVzU2VsZWN0b3IgfHxcblx0XHRkb2NFbGVtLm1vek1hdGNoZXNTZWxlY3RvciB8fFxuXHRcdGRvY0VsZW0ub01hdGNoZXNTZWxlY3RvciB8fFxuXHRcdGRvY0VsZW0ubXNNYXRjaGVzU2VsZWN0b3IpICkpICkge1xuXG5cdFx0YXNzZXJ0KGZ1bmN0aW9uKCBkaXYgKSB7XG5cdFx0XHQvLyBDaGVjayB0byBzZWUgaWYgaXQncyBwb3NzaWJsZSB0byBkbyBtYXRjaGVzU2VsZWN0b3Jcblx0XHRcdC8vIG9uIGEgZGlzY29ubmVjdGVkIG5vZGUgKElFIDkpXG5cdFx0XHRzdXBwb3J0LmRpc2Nvbm5lY3RlZE1hdGNoID0gbWF0Y2hlcy5jYWxsKCBkaXYsIFwiZGl2XCIgKTtcblxuXHRcdFx0Ly8gVGhpcyBzaG91bGQgZmFpbCB3aXRoIGFuIGV4Y2VwdGlvblxuXHRcdFx0Ly8gR2Vja28gZG9lcyBub3QgZXJyb3IsIHJldHVybnMgZmFsc2UgaW5zdGVhZFxuXHRcdFx0bWF0Y2hlcy5jYWxsKCBkaXYsIFwiW3MhPScnXTp4XCIgKTtcblx0XHRcdHJidWdneU1hdGNoZXMucHVzaCggXCIhPVwiLCBwc2V1ZG9zICk7XG5cdFx0fSk7XG5cdH1cblxuXHRyYnVnZ3lRU0EgPSByYnVnZ3lRU0EubGVuZ3RoICYmIG5ldyBSZWdFeHAoIHJidWdneVFTQS5qb2luKFwifFwiKSApO1xuXHRyYnVnZ3lNYXRjaGVzID0gcmJ1Z2d5TWF0Y2hlcy5sZW5ndGggJiYgbmV3IFJlZ0V4cCggcmJ1Z2d5TWF0Y2hlcy5qb2luKFwifFwiKSApO1xuXG5cdC8qIENvbnRhaW5zXG5cdC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cblx0aGFzQ29tcGFyZSA9IHJuYXRpdmUudGVzdCggZG9jRWxlbS5jb21wYXJlRG9jdW1lbnRQb3NpdGlvbiApO1xuXG5cdC8vIEVsZW1lbnQgY29udGFpbnMgYW5vdGhlclxuXHQvLyBQdXJwb3NlZnVsbHkgZG9lcyBub3QgaW1wbGVtZW50IGluY2x1c2l2ZSBkZXNjZW5kZW50XG5cdC8vIEFzIGluLCBhbiBlbGVtZW50IGRvZXMgbm90IGNvbnRhaW4gaXRzZWxmXG5cdGNvbnRhaW5zID0gaGFzQ29tcGFyZSB8fCBybmF0aXZlLnRlc3QoIGRvY0VsZW0uY29udGFpbnMgKSA/XG5cdFx0ZnVuY3Rpb24oIGEsIGIgKSB7XG5cdFx0XHR2YXIgYWRvd24gPSBhLm5vZGVUeXBlID09PSA5ID8gYS5kb2N1bWVudEVsZW1lbnQgOiBhLFxuXHRcdFx0XHRidXAgPSBiICYmIGIucGFyZW50Tm9kZTtcblx0XHRcdHJldHVybiBhID09PSBidXAgfHwgISEoIGJ1cCAmJiBidXAubm9kZVR5cGUgPT09IDEgJiYgKFxuXHRcdFx0XHRhZG93bi5jb250YWlucyA/XG5cdFx0XHRcdFx0YWRvd24uY29udGFpbnMoIGJ1cCApIDpcblx0XHRcdFx0XHRhLmNvbXBhcmVEb2N1bWVudFBvc2l0aW9uICYmIGEuY29tcGFyZURvY3VtZW50UG9zaXRpb24oIGJ1cCApICYgMTZcblx0XHRcdCkpO1xuXHRcdH0gOlxuXHRcdGZ1bmN0aW9uKCBhLCBiICkge1xuXHRcdFx0aWYgKCBiICkge1xuXHRcdFx0XHR3aGlsZSAoIChiID0gYi5wYXJlbnROb2RlKSApIHtcblx0XHRcdFx0XHRpZiAoIGIgPT09IGEgKSB7XG5cdFx0XHRcdFx0XHRyZXR1cm4gdHJ1ZTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHRcdHJldHVybiBmYWxzZTtcblx0XHR9O1xuXG5cdC8qIFNvcnRpbmdcblx0LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuXG5cdC8vIERvY3VtZW50IG9yZGVyIHNvcnRpbmdcblx0c29ydE9yZGVyID0gaGFzQ29tcGFyZSA/XG5cdGZ1bmN0aW9uKCBhLCBiICkge1xuXG5cdFx0Ly8gRmxhZyBmb3IgZHVwbGljYXRlIHJlbW92YWxcblx0XHRpZiAoIGEgPT09IGIgKSB7XG5cdFx0XHRoYXNEdXBsaWNhdGUgPSB0cnVlO1xuXHRcdFx0cmV0dXJuIDA7XG5cdFx0fVxuXG5cdFx0Ly8gU29ydCBvbiBtZXRob2QgZXhpc3RlbmNlIGlmIG9ubHkgb25lIGlucHV0IGhhcyBjb21wYXJlRG9jdW1lbnRQb3NpdGlvblxuXHRcdHZhciBjb21wYXJlID0gIWEuY29tcGFyZURvY3VtZW50UG9zaXRpb24gLSAhYi5jb21wYXJlRG9jdW1lbnRQb3NpdGlvbjtcblx0XHRpZiAoIGNvbXBhcmUgKSB7XG5cdFx0XHRyZXR1cm4gY29tcGFyZTtcblx0XHR9XG5cblx0XHQvLyBDYWxjdWxhdGUgcG9zaXRpb24gaWYgYm90aCBpbnB1dHMgYmVsb25nIHRvIHRoZSBzYW1lIGRvY3VtZW50XG5cdFx0Y29tcGFyZSA9ICggYS5vd25lckRvY3VtZW50IHx8IGEgKSA9PT0gKCBiLm93bmVyRG9jdW1lbnQgfHwgYiApID9cblx0XHRcdGEuY29tcGFyZURvY3VtZW50UG9zaXRpb24oIGIgKSA6XG5cblx0XHRcdC8vIE90aGVyd2lzZSB3ZSBrbm93IHRoZXkgYXJlIGRpc2Nvbm5lY3RlZFxuXHRcdFx0MTtcblxuXHRcdC8vIERpc2Nvbm5lY3RlZCBub2Rlc1xuXHRcdGlmICggY29tcGFyZSAmIDEgfHxcblx0XHRcdCghc3VwcG9ydC5zb3J0RGV0YWNoZWQgJiYgYi5jb21wYXJlRG9jdW1lbnRQb3NpdGlvbiggYSApID09PSBjb21wYXJlKSApIHtcblxuXHRcdFx0Ly8gQ2hvb3NlIHRoZSBmaXJzdCBlbGVtZW50IHRoYXQgaXMgcmVsYXRlZCB0byBvdXIgcHJlZmVycmVkIGRvY3VtZW50XG5cdFx0XHRpZiAoIGEgPT09IGRvYyB8fCBhLm93bmVyRG9jdW1lbnQgPT09IHByZWZlcnJlZERvYyAmJiBjb250YWlucyhwcmVmZXJyZWREb2MsIGEpICkge1xuXHRcdFx0XHRyZXR1cm4gLTE7XG5cdFx0XHR9XG5cdFx0XHRpZiAoIGIgPT09IGRvYyB8fCBiLm93bmVyRG9jdW1lbnQgPT09IHByZWZlcnJlZERvYyAmJiBjb250YWlucyhwcmVmZXJyZWREb2MsIGIpICkge1xuXHRcdFx0XHRyZXR1cm4gMTtcblx0XHRcdH1cblxuXHRcdFx0Ly8gTWFpbnRhaW4gb3JpZ2luYWwgb3JkZXJcblx0XHRcdHJldHVybiBzb3J0SW5wdXQgP1xuXHRcdFx0XHQoIGluZGV4T2YoIHNvcnRJbnB1dCwgYSApIC0gaW5kZXhPZiggc29ydElucHV0LCBiICkgKSA6XG5cdFx0XHRcdDA7XG5cdFx0fVxuXG5cdFx0cmV0dXJuIGNvbXBhcmUgJiA0ID8gLTEgOiAxO1xuXHR9IDpcblx0ZnVuY3Rpb24oIGEsIGIgKSB7XG5cdFx0Ly8gRXhpdCBlYXJseSBpZiB0aGUgbm9kZXMgYXJlIGlkZW50aWNhbFxuXHRcdGlmICggYSA9PT0gYiApIHtcblx0XHRcdGhhc0R1cGxpY2F0ZSA9IHRydWU7XG5cdFx0XHRyZXR1cm4gMDtcblx0XHR9XG5cblx0XHR2YXIgY3VyLFxuXHRcdFx0aSA9IDAsXG5cdFx0XHRhdXAgPSBhLnBhcmVudE5vZGUsXG5cdFx0XHRidXAgPSBiLnBhcmVudE5vZGUsXG5cdFx0XHRhcCA9IFsgYSBdLFxuXHRcdFx0YnAgPSBbIGIgXTtcblxuXHRcdC8vIFBhcmVudGxlc3Mgbm9kZXMgYXJlIGVpdGhlciBkb2N1bWVudHMgb3IgZGlzY29ubmVjdGVkXG5cdFx0aWYgKCAhYXVwIHx8ICFidXAgKSB7XG5cdFx0XHRyZXR1cm4gYSA9PT0gZG9jID8gLTEgOlxuXHRcdFx0XHRiID09PSBkb2MgPyAxIDpcblx0XHRcdFx0YXVwID8gLTEgOlxuXHRcdFx0XHRidXAgPyAxIDpcblx0XHRcdFx0c29ydElucHV0ID9cblx0XHRcdFx0KCBpbmRleE9mKCBzb3J0SW5wdXQsIGEgKSAtIGluZGV4T2YoIHNvcnRJbnB1dCwgYiApICkgOlxuXHRcdFx0XHQwO1xuXG5cdFx0Ly8gSWYgdGhlIG5vZGVzIGFyZSBzaWJsaW5ncywgd2UgY2FuIGRvIGEgcXVpY2sgY2hlY2tcblx0XHR9IGVsc2UgaWYgKCBhdXAgPT09IGJ1cCApIHtcblx0XHRcdHJldHVybiBzaWJsaW5nQ2hlY2soIGEsIGIgKTtcblx0XHR9XG5cblx0XHQvLyBPdGhlcndpc2Ugd2UgbmVlZCBmdWxsIGxpc3RzIG9mIHRoZWlyIGFuY2VzdG9ycyBmb3IgY29tcGFyaXNvblxuXHRcdGN1ciA9IGE7XG5cdFx0d2hpbGUgKCAoY3VyID0gY3VyLnBhcmVudE5vZGUpICkge1xuXHRcdFx0YXAudW5zaGlmdCggY3VyICk7XG5cdFx0fVxuXHRcdGN1ciA9IGI7XG5cdFx0d2hpbGUgKCAoY3VyID0gY3VyLnBhcmVudE5vZGUpICkge1xuXHRcdFx0YnAudW5zaGlmdCggY3VyICk7XG5cdFx0fVxuXG5cdFx0Ly8gV2FsayBkb3duIHRoZSB0cmVlIGxvb2tpbmcgZm9yIGEgZGlzY3JlcGFuY3lcblx0XHR3aGlsZSAoIGFwW2ldID09PSBicFtpXSApIHtcblx0XHRcdGkrKztcblx0XHR9XG5cblx0XHRyZXR1cm4gaSA/XG5cdFx0XHQvLyBEbyBhIHNpYmxpbmcgY2hlY2sgaWYgdGhlIG5vZGVzIGhhdmUgYSBjb21tb24gYW5jZXN0b3Jcblx0XHRcdHNpYmxpbmdDaGVjayggYXBbaV0sIGJwW2ldICkgOlxuXG5cdFx0XHQvLyBPdGhlcndpc2Ugbm9kZXMgaW4gb3VyIGRvY3VtZW50IHNvcnQgZmlyc3Rcblx0XHRcdGFwW2ldID09PSBwcmVmZXJyZWREb2MgPyAtMSA6XG5cdFx0XHRicFtpXSA9PT0gcHJlZmVycmVkRG9jID8gMSA6XG5cdFx0XHQwO1xuXHR9O1xuXG5cdHJldHVybiBkb2M7XG59O1xuXG5TaXp6bGUubWF0Y2hlcyA9IGZ1bmN0aW9uKCBleHByLCBlbGVtZW50cyApIHtcblx0cmV0dXJuIFNpenpsZSggZXhwciwgbnVsbCwgbnVsbCwgZWxlbWVudHMgKTtcbn07XG5cblNpenpsZS5tYXRjaGVzU2VsZWN0b3IgPSBmdW5jdGlvbiggZWxlbSwgZXhwciApIHtcblx0Ly8gU2V0IGRvY3VtZW50IHZhcnMgaWYgbmVlZGVkXG5cdGlmICggKCBlbGVtLm93bmVyRG9jdW1lbnQgfHwgZWxlbSApICE9PSBkb2N1bWVudCApIHtcblx0XHRzZXREb2N1bWVudCggZWxlbSApO1xuXHR9XG5cblx0Ly8gTWFrZSBzdXJlIHRoYXQgYXR0cmlidXRlIHNlbGVjdG9ycyBhcmUgcXVvdGVkXG5cdGV4cHIgPSBleHByLnJlcGxhY2UoIHJhdHRyaWJ1dGVRdW90ZXMsIFwiPSckMSddXCIgKTtcblxuXHRpZiAoIHN1cHBvcnQubWF0Y2hlc1NlbGVjdG9yICYmIGRvY3VtZW50SXNIVE1MICYmXG5cdFx0KCAhcmJ1Z2d5TWF0Y2hlcyB8fCAhcmJ1Z2d5TWF0Y2hlcy50ZXN0KCBleHByICkgKSAmJlxuXHRcdCggIXJidWdneVFTQSAgICAgfHwgIXJidWdneVFTQS50ZXN0KCBleHByICkgKSApIHtcblxuXHRcdHRyeSB7XG5cdFx0XHR2YXIgcmV0ID0gbWF0Y2hlcy5jYWxsKCBlbGVtLCBleHByICk7XG5cblx0XHRcdC8vIElFIDkncyBtYXRjaGVzU2VsZWN0b3IgcmV0dXJucyBmYWxzZSBvbiBkaXNjb25uZWN0ZWQgbm9kZXNcblx0XHRcdGlmICggcmV0IHx8IHN1cHBvcnQuZGlzY29ubmVjdGVkTWF0Y2ggfHxcblx0XHRcdFx0XHQvLyBBcyB3ZWxsLCBkaXNjb25uZWN0ZWQgbm9kZXMgYXJlIHNhaWQgdG8gYmUgaW4gYSBkb2N1bWVudFxuXHRcdFx0XHRcdC8vIGZyYWdtZW50IGluIElFIDlcblx0XHRcdFx0XHRlbGVtLmRvY3VtZW50ICYmIGVsZW0uZG9jdW1lbnQubm9kZVR5cGUgIT09IDExICkge1xuXHRcdFx0XHRyZXR1cm4gcmV0O1xuXHRcdFx0fVxuXHRcdH0gY2F0Y2ggKGUpIHt9XG5cdH1cblxuXHRyZXR1cm4gU2l6emxlKCBleHByLCBkb2N1bWVudCwgbnVsbCwgWyBlbGVtIF0gKS5sZW5ndGggPiAwO1xufTtcblxuU2l6emxlLmNvbnRhaW5zID0gZnVuY3Rpb24oIGNvbnRleHQsIGVsZW0gKSB7XG5cdC8vIFNldCBkb2N1bWVudCB2YXJzIGlmIG5lZWRlZFxuXHRpZiAoICggY29udGV4dC5vd25lckRvY3VtZW50IHx8IGNvbnRleHQgKSAhPT0gZG9jdW1lbnQgKSB7XG5cdFx0c2V0RG9jdW1lbnQoIGNvbnRleHQgKTtcblx0fVxuXHRyZXR1cm4gY29udGFpbnMoIGNvbnRleHQsIGVsZW0gKTtcbn07XG5cblNpenpsZS5hdHRyID0gZnVuY3Rpb24oIGVsZW0sIG5hbWUgKSB7XG5cdC8vIFNldCBkb2N1bWVudCB2YXJzIGlmIG5lZWRlZFxuXHRpZiAoICggZWxlbS5vd25lckRvY3VtZW50IHx8IGVsZW0gKSAhPT0gZG9jdW1lbnQgKSB7XG5cdFx0c2V0RG9jdW1lbnQoIGVsZW0gKTtcblx0fVxuXG5cdHZhciBmbiA9IEV4cHIuYXR0ckhhbmRsZVsgbmFtZS50b0xvd2VyQ2FzZSgpIF0sXG5cdFx0Ly8gRG9uJ3QgZ2V0IGZvb2xlZCBieSBPYmplY3QucHJvdG90eXBlIHByb3BlcnRpZXMgKGpRdWVyeSAjMTM4MDcpXG5cdFx0dmFsID0gZm4gJiYgaGFzT3duLmNhbGwoIEV4cHIuYXR0ckhhbmRsZSwgbmFtZS50b0xvd2VyQ2FzZSgpICkgP1xuXHRcdFx0Zm4oIGVsZW0sIG5hbWUsICFkb2N1bWVudElzSFRNTCApIDpcblx0XHRcdHVuZGVmaW5lZDtcblxuXHRyZXR1cm4gdmFsICE9PSB1bmRlZmluZWQgP1xuXHRcdHZhbCA6XG5cdFx0c3VwcG9ydC5hdHRyaWJ1dGVzIHx8ICFkb2N1bWVudElzSFRNTCA/XG5cdFx0XHRlbGVtLmdldEF0dHJpYnV0ZSggbmFtZSApIDpcblx0XHRcdCh2YWwgPSBlbGVtLmdldEF0dHJpYnV0ZU5vZGUobmFtZSkpICYmIHZhbC5zcGVjaWZpZWQgP1xuXHRcdFx0XHR2YWwudmFsdWUgOlxuXHRcdFx0XHRudWxsO1xufTtcblxuU2l6emxlLmVycm9yID0gZnVuY3Rpb24oIG1zZyApIHtcblx0dGhyb3cgbmV3IEVycm9yKCBcIlN5bnRheCBlcnJvciwgdW5yZWNvZ25pemVkIGV4cHJlc3Npb246IFwiICsgbXNnICk7XG59O1xuXG4vKipcbiAqIERvY3VtZW50IHNvcnRpbmcgYW5kIHJlbW92aW5nIGR1cGxpY2F0ZXNcbiAqIEBwYXJhbSB7QXJyYXlMaWtlfSByZXN1bHRzXG4gKi9cblNpenpsZS51bmlxdWVTb3J0ID0gZnVuY3Rpb24oIHJlc3VsdHMgKSB7XG5cdHZhciBlbGVtLFxuXHRcdGR1cGxpY2F0ZXMgPSBbXSxcblx0XHRqID0gMCxcblx0XHRpID0gMDtcblxuXHQvLyBVbmxlc3Mgd2UgKmtub3cqIHdlIGNhbiBkZXRlY3QgZHVwbGljYXRlcywgYXNzdW1lIHRoZWlyIHByZXNlbmNlXG5cdGhhc0R1cGxpY2F0ZSA9ICFzdXBwb3J0LmRldGVjdER1cGxpY2F0ZXM7XG5cdHNvcnRJbnB1dCA9ICFzdXBwb3J0LnNvcnRTdGFibGUgJiYgcmVzdWx0cy5zbGljZSggMCApO1xuXHRyZXN1bHRzLnNvcnQoIHNvcnRPcmRlciApO1xuXG5cdGlmICggaGFzRHVwbGljYXRlICkge1xuXHRcdHdoaWxlICggKGVsZW0gPSByZXN1bHRzW2krK10pICkge1xuXHRcdFx0aWYgKCBlbGVtID09PSByZXN1bHRzWyBpIF0gKSB7XG5cdFx0XHRcdGogPSBkdXBsaWNhdGVzLnB1c2goIGkgKTtcblx0XHRcdH1cblx0XHR9XG5cdFx0d2hpbGUgKCBqLS0gKSB7XG5cdFx0XHRyZXN1bHRzLnNwbGljZSggZHVwbGljYXRlc1sgaiBdLCAxICk7XG5cdFx0fVxuXHR9XG5cblx0Ly8gQ2xlYXIgaW5wdXQgYWZ0ZXIgc29ydGluZyB0byByZWxlYXNlIG9iamVjdHNcblx0Ly8gU2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9qcXVlcnkvc2l6emxlL3B1bGwvMjI1XG5cdHNvcnRJbnB1dCA9IG51bGw7XG5cblx0cmV0dXJuIHJlc3VsdHM7XG59O1xuXG4vKipcbiAqIFV0aWxpdHkgZnVuY3Rpb24gZm9yIHJldHJpZXZpbmcgdGhlIHRleHQgdmFsdWUgb2YgYW4gYXJyYXkgb2YgRE9NIG5vZGVzXG4gKiBAcGFyYW0ge0FycmF5fEVsZW1lbnR9IGVsZW1cbiAqL1xuZ2V0VGV4dCA9IFNpenpsZS5nZXRUZXh0ID0gZnVuY3Rpb24oIGVsZW0gKSB7XG5cdHZhciBub2RlLFxuXHRcdHJldCA9IFwiXCIsXG5cdFx0aSA9IDAsXG5cdFx0bm9kZVR5cGUgPSBlbGVtLm5vZGVUeXBlO1xuXG5cdGlmICggIW5vZGVUeXBlICkge1xuXHRcdC8vIElmIG5vIG5vZGVUeXBlLCB0aGlzIGlzIGV4cGVjdGVkIHRvIGJlIGFuIGFycmF5XG5cdFx0d2hpbGUgKCAobm9kZSA9IGVsZW1baSsrXSkgKSB7XG5cdFx0XHQvLyBEbyBub3QgdHJhdmVyc2UgY29tbWVudCBub2Rlc1xuXHRcdFx0cmV0ICs9IGdldFRleHQoIG5vZGUgKTtcblx0XHR9XG5cdH0gZWxzZSBpZiAoIG5vZGVUeXBlID09PSAxIHx8IG5vZGVUeXBlID09PSA5IHx8IG5vZGVUeXBlID09PSAxMSApIHtcblx0XHQvLyBVc2UgdGV4dENvbnRlbnQgZm9yIGVsZW1lbnRzXG5cdFx0Ly8gaW5uZXJUZXh0IHVzYWdlIHJlbW92ZWQgZm9yIGNvbnNpc3RlbmN5IG9mIG5ldyBsaW5lcyAoalF1ZXJ5ICMxMTE1Mylcblx0XHRpZiAoIHR5cGVvZiBlbGVtLnRleHRDb250ZW50ID09PSBcInN0cmluZ1wiICkge1xuXHRcdFx0cmV0dXJuIGVsZW0udGV4dENvbnRlbnQ7XG5cdFx0fSBlbHNlIHtcblx0XHRcdC8vIFRyYXZlcnNlIGl0cyBjaGlsZHJlblxuXHRcdFx0Zm9yICggZWxlbSA9IGVsZW0uZmlyc3RDaGlsZDsgZWxlbTsgZWxlbSA9IGVsZW0ubmV4dFNpYmxpbmcgKSB7XG5cdFx0XHRcdHJldCArPSBnZXRUZXh0KCBlbGVtICk7XG5cdFx0XHR9XG5cdFx0fVxuXHR9IGVsc2UgaWYgKCBub2RlVHlwZSA9PT0gMyB8fCBub2RlVHlwZSA9PT0gNCApIHtcblx0XHRyZXR1cm4gZWxlbS5ub2RlVmFsdWU7XG5cdH1cblx0Ly8gRG8gbm90IGluY2x1ZGUgY29tbWVudCBvciBwcm9jZXNzaW5nIGluc3RydWN0aW9uIG5vZGVzXG5cblx0cmV0dXJuIHJldDtcbn07XG5cbkV4cHIgPSBTaXp6bGUuc2VsZWN0b3JzID0ge1xuXG5cdC8vIENhbiBiZSBhZGp1c3RlZCBieSB0aGUgdXNlclxuXHRjYWNoZUxlbmd0aDogNTAsXG5cblx0Y3JlYXRlUHNldWRvOiBtYXJrRnVuY3Rpb24sXG5cblx0bWF0Y2g6IG1hdGNoRXhwcixcblxuXHRhdHRySGFuZGxlOiB7fSxcblxuXHRmaW5kOiB7fSxcblxuXHRyZWxhdGl2ZToge1xuXHRcdFwiPlwiOiB7IGRpcjogXCJwYXJlbnROb2RlXCIsIGZpcnN0OiB0cnVlIH0sXG5cdFx0XCIgXCI6IHsgZGlyOiBcInBhcmVudE5vZGVcIiB9LFxuXHRcdFwiK1wiOiB7IGRpcjogXCJwcmV2aW91c1NpYmxpbmdcIiwgZmlyc3Q6IHRydWUgfSxcblx0XHRcIn5cIjogeyBkaXI6IFwicHJldmlvdXNTaWJsaW5nXCIgfVxuXHR9LFxuXG5cdHByZUZpbHRlcjoge1xuXHRcdFwiQVRUUlwiOiBmdW5jdGlvbiggbWF0Y2ggKSB7XG5cdFx0XHRtYXRjaFsxXSA9IG1hdGNoWzFdLnJlcGxhY2UoIHJ1bmVzY2FwZSwgZnVuZXNjYXBlICk7XG5cblx0XHRcdC8vIE1vdmUgdGhlIGdpdmVuIHZhbHVlIHRvIG1hdGNoWzNdIHdoZXRoZXIgcXVvdGVkIG9yIHVucXVvdGVkXG5cdFx0XHRtYXRjaFszXSA9ICggbWF0Y2hbM10gfHwgbWF0Y2hbNF0gfHwgbWF0Y2hbNV0gfHwgXCJcIiApLnJlcGxhY2UoIHJ1bmVzY2FwZSwgZnVuZXNjYXBlICk7XG5cblx0XHRcdGlmICggbWF0Y2hbMl0gPT09IFwifj1cIiApIHtcblx0XHRcdFx0bWF0Y2hbM10gPSBcIiBcIiArIG1hdGNoWzNdICsgXCIgXCI7XG5cdFx0XHR9XG5cblx0XHRcdHJldHVybiBtYXRjaC5zbGljZSggMCwgNCApO1xuXHRcdH0sXG5cblx0XHRcIkNISUxEXCI6IGZ1bmN0aW9uKCBtYXRjaCApIHtcblx0XHRcdC8qIG1hdGNoZXMgZnJvbSBtYXRjaEV4cHJbXCJDSElMRFwiXVxuXHRcdFx0XHQxIHR5cGUgKG9ubHl8bnRofC4uLilcblx0XHRcdFx0MiB3aGF0IChjaGlsZHxvZi10eXBlKVxuXHRcdFx0XHQzIGFyZ3VtZW50IChldmVufG9kZHxcXGQqfFxcZCpuKFsrLV1cXGQrKT98Li4uKVxuXHRcdFx0XHQ0IHhuLWNvbXBvbmVudCBvZiB4bit5IGFyZ3VtZW50IChbKy1dP1xcZCpufClcblx0XHRcdFx0NSBzaWduIG9mIHhuLWNvbXBvbmVudFxuXHRcdFx0XHQ2IHggb2YgeG4tY29tcG9uZW50XG5cdFx0XHRcdDcgc2lnbiBvZiB5LWNvbXBvbmVudFxuXHRcdFx0XHQ4IHkgb2YgeS1jb21wb25lbnRcblx0XHRcdCovXG5cdFx0XHRtYXRjaFsxXSA9IG1hdGNoWzFdLnRvTG93ZXJDYXNlKCk7XG5cblx0XHRcdGlmICggbWF0Y2hbMV0uc2xpY2UoIDAsIDMgKSA9PT0gXCJudGhcIiApIHtcblx0XHRcdFx0Ly8gbnRoLSogcmVxdWlyZXMgYXJndW1lbnRcblx0XHRcdFx0aWYgKCAhbWF0Y2hbM10gKSB7XG5cdFx0XHRcdFx0U2l6emxlLmVycm9yKCBtYXRjaFswXSApO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0Ly8gbnVtZXJpYyB4IGFuZCB5IHBhcmFtZXRlcnMgZm9yIEV4cHIuZmlsdGVyLkNISUxEXG5cdFx0XHRcdC8vIHJlbWVtYmVyIHRoYXQgZmFsc2UvdHJ1ZSBjYXN0IHJlc3BlY3RpdmVseSB0byAwLzFcblx0XHRcdFx0bWF0Y2hbNF0gPSArKCBtYXRjaFs0XSA/IG1hdGNoWzVdICsgKG1hdGNoWzZdIHx8IDEpIDogMiAqICggbWF0Y2hbM10gPT09IFwiZXZlblwiIHx8IG1hdGNoWzNdID09PSBcIm9kZFwiICkgKTtcblx0XHRcdFx0bWF0Y2hbNV0gPSArKCAoIG1hdGNoWzddICsgbWF0Y2hbOF0gKSB8fCBtYXRjaFszXSA9PT0gXCJvZGRcIiApO1xuXG5cdFx0XHQvLyBvdGhlciB0eXBlcyBwcm9oaWJpdCBhcmd1bWVudHNcblx0XHRcdH0gZWxzZSBpZiAoIG1hdGNoWzNdICkge1xuXHRcdFx0XHRTaXp6bGUuZXJyb3IoIG1hdGNoWzBdICk7XG5cdFx0XHR9XG5cblx0XHRcdHJldHVybiBtYXRjaDtcblx0XHR9LFxuXG5cdFx0XCJQU0VVRE9cIjogZnVuY3Rpb24oIG1hdGNoICkge1xuXHRcdFx0dmFyIGV4Y2Vzcyxcblx0XHRcdFx0dW5xdW90ZWQgPSAhbWF0Y2hbNl0gJiYgbWF0Y2hbMl07XG5cblx0XHRcdGlmICggbWF0Y2hFeHByW1wiQ0hJTERcIl0udGVzdCggbWF0Y2hbMF0gKSApIHtcblx0XHRcdFx0cmV0dXJuIG51bGw7XG5cdFx0XHR9XG5cblx0XHRcdC8vIEFjY2VwdCBxdW90ZWQgYXJndW1lbnRzIGFzLWlzXG5cdFx0XHRpZiAoIG1hdGNoWzNdICkge1xuXHRcdFx0XHRtYXRjaFsyXSA9IG1hdGNoWzRdIHx8IG1hdGNoWzVdIHx8IFwiXCI7XG5cblx0XHRcdC8vIFN0cmlwIGV4Y2VzcyBjaGFyYWN0ZXJzIGZyb20gdW5xdW90ZWQgYXJndW1lbnRzXG5cdFx0XHR9IGVsc2UgaWYgKCB1bnF1b3RlZCAmJiBycHNldWRvLnRlc3QoIHVucXVvdGVkICkgJiZcblx0XHRcdFx0Ly8gR2V0IGV4Y2VzcyBmcm9tIHRva2VuaXplIChyZWN1cnNpdmVseSlcblx0XHRcdFx0KGV4Y2VzcyA9IHRva2VuaXplKCB1bnF1b3RlZCwgdHJ1ZSApKSAmJlxuXHRcdFx0XHQvLyBhZHZhbmNlIHRvIHRoZSBuZXh0IGNsb3NpbmcgcGFyZW50aGVzaXNcblx0XHRcdFx0KGV4Y2VzcyA9IHVucXVvdGVkLmluZGV4T2YoIFwiKVwiLCB1bnF1b3RlZC5sZW5ndGggLSBleGNlc3MgKSAtIHVucXVvdGVkLmxlbmd0aCkgKSB7XG5cblx0XHRcdFx0Ly8gZXhjZXNzIGlzIGEgbmVnYXRpdmUgaW5kZXhcblx0XHRcdFx0bWF0Y2hbMF0gPSBtYXRjaFswXS5zbGljZSggMCwgZXhjZXNzICk7XG5cdFx0XHRcdG1hdGNoWzJdID0gdW5xdW90ZWQuc2xpY2UoIDAsIGV4Y2VzcyApO1xuXHRcdFx0fVxuXG5cdFx0XHQvLyBSZXR1cm4gb25seSBjYXB0dXJlcyBuZWVkZWQgYnkgdGhlIHBzZXVkbyBmaWx0ZXIgbWV0aG9kICh0eXBlIGFuZCBhcmd1bWVudClcblx0XHRcdHJldHVybiBtYXRjaC5zbGljZSggMCwgMyApO1xuXHRcdH1cblx0fSxcblxuXHRmaWx0ZXI6IHtcblxuXHRcdFwiVEFHXCI6IGZ1bmN0aW9uKCBub2RlTmFtZVNlbGVjdG9yICkge1xuXHRcdFx0dmFyIG5vZGVOYW1lID0gbm9kZU5hbWVTZWxlY3Rvci5yZXBsYWNlKCBydW5lc2NhcGUsIGZ1bmVzY2FwZSApLnRvTG93ZXJDYXNlKCk7XG5cdFx0XHRyZXR1cm4gbm9kZU5hbWVTZWxlY3RvciA9PT0gXCIqXCIgP1xuXHRcdFx0XHRmdW5jdGlvbigpIHsgcmV0dXJuIHRydWU7IH0gOlxuXHRcdFx0XHRmdW5jdGlvbiggZWxlbSApIHtcblx0XHRcdFx0XHRyZXR1cm4gZWxlbS5ub2RlTmFtZSAmJiBlbGVtLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCkgPT09IG5vZGVOYW1lO1xuXHRcdFx0XHR9O1xuXHRcdH0sXG5cblx0XHRcIkNMQVNTXCI6IGZ1bmN0aW9uKCBjbGFzc05hbWUgKSB7XG5cdFx0XHR2YXIgcGF0dGVybiA9IGNsYXNzQ2FjaGVbIGNsYXNzTmFtZSArIFwiIFwiIF07XG5cblx0XHRcdHJldHVybiBwYXR0ZXJuIHx8XG5cdFx0XHRcdChwYXR0ZXJuID0gbmV3IFJlZ0V4cCggXCIoXnxcIiArIHdoaXRlc3BhY2UgKyBcIilcIiArIGNsYXNzTmFtZSArIFwiKFwiICsgd2hpdGVzcGFjZSArIFwifCQpXCIgKSkgJiZcblx0XHRcdFx0Y2xhc3NDYWNoZSggY2xhc3NOYW1lLCBmdW5jdGlvbiggZWxlbSApIHtcblx0XHRcdFx0XHRyZXR1cm4gcGF0dGVybi50ZXN0KCB0eXBlb2YgZWxlbS5jbGFzc05hbWUgPT09IFwic3RyaW5nXCIgJiYgZWxlbS5jbGFzc05hbWUgfHwgdHlwZW9mIGVsZW0uZ2V0QXR0cmlidXRlICE9PSBcInVuZGVmaW5lZFwiICYmIGVsZW0uZ2V0QXR0cmlidXRlKFwiY2xhc3NcIikgfHwgXCJcIiApO1xuXHRcdFx0XHR9KTtcblx0XHR9LFxuXG5cdFx0XCJBVFRSXCI6IGZ1bmN0aW9uKCBuYW1lLCBvcGVyYXRvciwgY2hlY2sgKSB7XG5cdFx0XHRyZXR1cm4gZnVuY3Rpb24oIGVsZW0gKSB7XG5cdFx0XHRcdHZhciByZXN1bHQgPSBTaXp6bGUuYXR0ciggZWxlbSwgbmFtZSApO1xuXG5cdFx0XHRcdGlmICggcmVzdWx0ID09IG51bGwgKSB7XG5cdFx0XHRcdFx0cmV0dXJuIG9wZXJhdG9yID09PSBcIiE9XCI7XG5cdFx0XHRcdH1cblx0XHRcdFx0aWYgKCAhb3BlcmF0b3IgKSB7XG5cdFx0XHRcdFx0cmV0dXJuIHRydWU7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHRyZXN1bHQgKz0gXCJcIjtcblxuXHRcdFx0XHRyZXR1cm4gb3BlcmF0b3IgPT09IFwiPVwiID8gcmVzdWx0ID09PSBjaGVjayA6XG5cdFx0XHRcdFx0b3BlcmF0b3IgPT09IFwiIT1cIiA/IHJlc3VsdCAhPT0gY2hlY2sgOlxuXHRcdFx0XHRcdG9wZXJhdG9yID09PSBcIl49XCIgPyBjaGVjayAmJiByZXN1bHQuaW5kZXhPZiggY2hlY2sgKSA9PT0gMCA6XG5cdFx0XHRcdFx0b3BlcmF0b3IgPT09IFwiKj1cIiA/IGNoZWNrICYmIHJlc3VsdC5pbmRleE9mKCBjaGVjayApID4gLTEgOlxuXHRcdFx0XHRcdG9wZXJhdG9yID09PSBcIiQ9XCIgPyBjaGVjayAmJiByZXN1bHQuc2xpY2UoIC1jaGVjay5sZW5ndGggKSA9PT0gY2hlY2sgOlxuXHRcdFx0XHRcdG9wZXJhdG9yID09PSBcIn49XCIgPyAoIFwiIFwiICsgcmVzdWx0LnJlcGxhY2UoIHJ3aGl0ZXNwYWNlLCBcIiBcIiApICsgXCIgXCIgKS5pbmRleE9mKCBjaGVjayApID4gLTEgOlxuXHRcdFx0XHRcdG9wZXJhdG9yID09PSBcInw9XCIgPyByZXN1bHQgPT09IGNoZWNrIHx8IHJlc3VsdC5zbGljZSggMCwgY2hlY2subGVuZ3RoICsgMSApID09PSBjaGVjayArIFwiLVwiIDpcblx0XHRcdFx0XHRmYWxzZTtcblx0XHRcdH07XG5cdFx0fSxcblxuXHRcdFwiQ0hJTERcIjogZnVuY3Rpb24oIHR5cGUsIHdoYXQsIGFyZ3VtZW50LCBmaXJzdCwgbGFzdCApIHtcblx0XHRcdHZhciBzaW1wbGUgPSB0eXBlLnNsaWNlKCAwLCAzICkgIT09IFwibnRoXCIsXG5cdFx0XHRcdGZvcndhcmQgPSB0eXBlLnNsaWNlKCAtNCApICE9PSBcImxhc3RcIixcblx0XHRcdFx0b2ZUeXBlID0gd2hhdCA9PT0gXCJvZi10eXBlXCI7XG5cblx0XHRcdHJldHVybiBmaXJzdCA9PT0gMSAmJiBsYXN0ID09PSAwID9cblxuXHRcdFx0XHQvLyBTaG9ydGN1dCBmb3IgOm50aC0qKG4pXG5cdFx0XHRcdGZ1bmN0aW9uKCBlbGVtICkge1xuXHRcdFx0XHRcdHJldHVybiAhIWVsZW0ucGFyZW50Tm9kZTtcblx0XHRcdFx0fSA6XG5cblx0XHRcdFx0ZnVuY3Rpb24oIGVsZW0sIGNvbnRleHQsIHhtbCApIHtcblx0XHRcdFx0XHR2YXIgY2FjaGUsIG91dGVyQ2FjaGUsIG5vZGUsIGRpZmYsIG5vZGVJbmRleCwgc3RhcnQsXG5cdFx0XHRcdFx0XHRkaXIgPSBzaW1wbGUgIT09IGZvcndhcmQgPyBcIm5leHRTaWJsaW5nXCIgOiBcInByZXZpb3VzU2libGluZ1wiLFxuXHRcdFx0XHRcdFx0cGFyZW50ID0gZWxlbS5wYXJlbnROb2RlLFxuXHRcdFx0XHRcdFx0bmFtZSA9IG9mVHlwZSAmJiBlbGVtLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCksXG5cdFx0XHRcdFx0XHR1c2VDYWNoZSA9ICF4bWwgJiYgIW9mVHlwZTtcblxuXHRcdFx0XHRcdGlmICggcGFyZW50ICkge1xuXG5cdFx0XHRcdFx0XHQvLyA6KGZpcnN0fGxhc3R8b25seSktKGNoaWxkfG9mLXR5cGUpXG5cdFx0XHRcdFx0XHRpZiAoIHNpbXBsZSApIHtcblx0XHRcdFx0XHRcdFx0d2hpbGUgKCBkaXIgKSB7XG5cdFx0XHRcdFx0XHRcdFx0bm9kZSA9IGVsZW07XG5cdFx0XHRcdFx0XHRcdFx0d2hpbGUgKCAobm9kZSA9IG5vZGVbIGRpciBdKSApIHtcblx0XHRcdFx0XHRcdFx0XHRcdGlmICggb2ZUeXBlID8gbm9kZS5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpID09PSBuYW1lIDogbm9kZS5ub2RlVHlwZSA9PT0gMSApIHtcblx0XHRcdFx0XHRcdFx0XHRcdFx0cmV0dXJuIGZhbHNlO1xuXHRcdFx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0XHQvLyBSZXZlcnNlIGRpcmVjdGlvbiBmb3IgOm9ubHktKiAoaWYgd2UgaGF2ZW4ndCB5ZXQgZG9uZSBzbylcblx0XHRcdFx0XHRcdFx0XHRzdGFydCA9IGRpciA9IHR5cGUgPT09IFwib25seVwiICYmICFzdGFydCAmJiBcIm5leHRTaWJsaW5nXCI7XG5cdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0cmV0dXJuIHRydWU7XG5cdFx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRcdHN0YXJ0ID0gWyBmb3J3YXJkID8gcGFyZW50LmZpcnN0Q2hpbGQgOiBwYXJlbnQubGFzdENoaWxkIF07XG5cblx0XHRcdFx0XHRcdC8vIG5vbi14bWwgOm50aC1jaGlsZCguLi4pIHN0b3JlcyBjYWNoZSBkYXRhIG9uIGBwYXJlbnRgXG5cdFx0XHRcdFx0XHRpZiAoIGZvcndhcmQgJiYgdXNlQ2FjaGUgKSB7XG5cdFx0XHRcdFx0XHRcdC8vIFNlZWsgYGVsZW1gIGZyb20gYSBwcmV2aW91c2x5LWNhY2hlZCBpbmRleFxuXHRcdFx0XHRcdFx0XHRvdXRlckNhY2hlID0gcGFyZW50WyBleHBhbmRvIF0gfHwgKHBhcmVudFsgZXhwYW5kbyBdID0ge30pO1xuXHRcdFx0XHRcdFx0XHRjYWNoZSA9IG91dGVyQ2FjaGVbIHR5cGUgXSB8fCBbXTtcblx0XHRcdFx0XHRcdFx0bm9kZUluZGV4ID0gY2FjaGVbMF0gPT09IGRpcnJ1bnMgJiYgY2FjaGVbMV07XG5cdFx0XHRcdFx0XHRcdGRpZmYgPSBjYWNoZVswXSA9PT0gZGlycnVucyAmJiBjYWNoZVsyXTtcblx0XHRcdFx0XHRcdFx0bm9kZSA9IG5vZGVJbmRleCAmJiBwYXJlbnQuY2hpbGROb2Rlc1sgbm9kZUluZGV4IF07XG5cblx0XHRcdFx0XHRcdFx0d2hpbGUgKCAobm9kZSA9ICsrbm9kZUluZGV4ICYmIG5vZGUgJiYgbm9kZVsgZGlyIF0gfHxcblxuXHRcdFx0XHRcdFx0XHRcdC8vIEZhbGxiYWNrIHRvIHNlZWtpbmcgYGVsZW1gIGZyb20gdGhlIHN0YXJ0XG5cdFx0XHRcdFx0XHRcdFx0KGRpZmYgPSBub2RlSW5kZXggPSAwKSB8fCBzdGFydC5wb3AoKSkgKSB7XG5cblx0XHRcdFx0XHRcdFx0XHQvLyBXaGVuIGZvdW5kLCBjYWNoZSBpbmRleGVzIG9uIGBwYXJlbnRgIGFuZCBicmVha1xuXHRcdFx0XHRcdFx0XHRcdGlmICggbm9kZS5ub2RlVHlwZSA9PT0gMSAmJiArK2RpZmYgJiYgbm9kZSA9PT0gZWxlbSApIHtcblx0XHRcdFx0XHRcdFx0XHRcdG91dGVyQ2FjaGVbIHR5cGUgXSA9IFsgZGlycnVucywgbm9kZUluZGV4LCBkaWZmIF07XG5cdFx0XHRcdFx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdFx0Ly8gVXNlIHByZXZpb3VzbHktY2FjaGVkIGVsZW1lbnQgaW5kZXggaWYgYXZhaWxhYmxlXG5cdFx0XHRcdFx0XHR9IGVsc2UgaWYgKCB1c2VDYWNoZSAmJiAoY2FjaGUgPSAoZWxlbVsgZXhwYW5kbyBdIHx8IChlbGVtWyBleHBhbmRvIF0gPSB7fSkpWyB0eXBlIF0pICYmIGNhY2hlWzBdID09PSBkaXJydW5zICkge1xuXHRcdFx0XHRcdFx0XHRkaWZmID0gY2FjaGVbMV07XG5cblx0XHRcdFx0XHRcdC8vIHhtbCA6bnRoLWNoaWxkKC4uLikgb3IgOm50aC1sYXN0LWNoaWxkKC4uLikgb3IgOm50aCgtbGFzdCk/LW9mLXR5cGUoLi4uKVxuXHRcdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdFx0Ly8gVXNlIHRoZSBzYW1lIGxvb3AgYXMgYWJvdmUgdG8gc2VlayBgZWxlbWAgZnJvbSB0aGUgc3RhcnRcblx0XHRcdFx0XHRcdFx0d2hpbGUgKCAobm9kZSA9ICsrbm9kZUluZGV4ICYmIG5vZGUgJiYgbm9kZVsgZGlyIF0gfHxcblx0XHRcdFx0XHRcdFx0XHQoZGlmZiA9IG5vZGVJbmRleCA9IDApIHx8IHN0YXJ0LnBvcCgpKSApIHtcblxuXHRcdFx0XHRcdFx0XHRcdGlmICggKCBvZlR5cGUgPyBub2RlLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCkgPT09IG5hbWUgOiBub2RlLm5vZGVUeXBlID09PSAxICkgJiYgKytkaWZmICkge1xuXHRcdFx0XHRcdFx0XHRcdFx0Ly8gQ2FjaGUgdGhlIGluZGV4IG9mIGVhY2ggZW5jb3VudGVyZWQgZWxlbWVudFxuXHRcdFx0XHRcdFx0XHRcdFx0aWYgKCB1c2VDYWNoZSApIHtcblx0XHRcdFx0XHRcdFx0XHRcdFx0KG5vZGVbIGV4cGFuZG8gXSB8fCAobm9kZVsgZXhwYW5kbyBdID0ge30pKVsgdHlwZSBdID0gWyBkaXJydW5zLCBkaWZmIF07XG5cdFx0XHRcdFx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRcdFx0XHRcdGlmICggbm9kZSA9PT0gZWxlbSApIHtcblx0XHRcdFx0XHRcdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRcdC8vIEluY29ycG9yYXRlIHRoZSBvZmZzZXQsIHRoZW4gY2hlY2sgYWdhaW5zdCBjeWNsZSBzaXplXG5cdFx0XHRcdFx0XHRkaWZmIC09IGxhc3Q7XG5cdFx0XHRcdFx0XHRyZXR1cm4gZGlmZiA9PT0gZmlyc3QgfHwgKCBkaWZmICUgZmlyc3QgPT09IDAgJiYgZGlmZiAvIGZpcnN0ID49IDAgKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH07XG5cdFx0fSxcblxuXHRcdFwiUFNFVURPXCI6IGZ1bmN0aW9uKCBwc2V1ZG8sIGFyZ3VtZW50ICkge1xuXHRcdFx0Ly8gcHNldWRvLWNsYXNzIG5hbWVzIGFyZSBjYXNlLWluc2Vuc2l0aXZlXG5cdFx0XHQvLyBodHRwOi8vd3d3LnczLm9yZy9UUi9zZWxlY3RvcnMvI3BzZXVkby1jbGFzc2VzXG5cdFx0XHQvLyBQcmlvcml0aXplIGJ5IGNhc2Ugc2Vuc2l0aXZpdHkgaW4gY2FzZSBjdXN0b20gcHNldWRvcyBhcmUgYWRkZWQgd2l0aCB1cHBlcmNhc2UgbGV0dGVyc1xuXHRcdFx0Ly8gUmVtZW1iZXIgdGhhdCBzZXRGaWx0ZXJzIGluaGVyaXRzIGZyb20gcHNldWRvc1xuXHRcdFx0dmFyIGFyZ3MsXG5cdFx0XHRcdGZuID0gRXhwci5wc2V1ZG9zWyBwc2V1ZG8gXSB8fCBFeHByLnNldEZpbHRlcnNbIHBzZXVkby50b0xvd2VyQ2FzZSgpIF0gfHxcblx0XHRcdFx0XHRTaXp6bGUuZXJyb3IoIFwidW5zdXBwb3J0ZWQgcHNldWRvOiBcIiArIHBzZXVkbyApO1xuXG5cdFx0XHQvLyBUaGUgdXNlciBtYXkgdXNlIGNyZWF0ZVBzZXVkbyB0byBpbmRpY2F0ZSB0aGF0XG5cdFx0XHQvLyBhcmd1bWVudHMgYXJlIG5lZWRlZCB0byBjcmVhdGUgdGhlIGZpbHRlciBmdW5jdGlvblxuXHRcdFx0Ly8ganVzdCBhcyBTaXp6bGUgZG9lc1xuXHRcdFx0aWYgKCBmblsgZXhwYW5kbyBdICkge1xuXHRcdFx0XHRyZXR1cm4gZm4oIGFyZ3VtZW50ICk7XG5cdFx0XHR9XG5cblx0XHRcdC8vIEJ1dCBtYWludGFpbiBzdXBwb3J0IGZvciBvbGQgc2lnbmF0dXJlc1xuXHRcdFx0aWYgKCBmbi5sZW5ndGggPiAxICkge1xuXHRcdFx0XHRhcmdzID0gWyBwc2V1ZG8sIHBzZXVkbywgXCJcIiwgYXJndW1lbnQgXTtcblx0XHRcdFx0cmV0dXJuIEV4cHIuc2V0RmlsdGVycy5oYXNPd25Qcm9wZXJ0eSggcHNldWRvLnRvTG93ZXJDYXNlKCkgKSA/XG5cdFx0XHRcdFx0bWFya0Z1bmN0aW9uKGZ1bmN0aW9uKCBzZWVkLCBtYXRjaGVzICkge1xuXHRcdFx0XHRcdFx0dmFyIGlkeCxcblx0XHRcdFx0XHRcdFx0bWF0Y2hlZCA9IGZuKCBzZWVkLCBhcmd1bWVudCApLFxuXHRcdFx0XHRcdFx0XHRpID0gbWF0Y2hlZC5sZW5ndGg7XG5cdFx0XHRcdFx0XHR3aGlsZSAoIGktLSApIHtcblx0XHRcdFx0XHRcdFx0aWR4ID0gaW5kZXhPZiggc2VlZCwgbWF0Y2hlZFtpXSApO1xuXHRcdFx0XHRcdFx0XHRzZWVkWyBpZHggXSA9ICEoIG1hdGNoZXNbIGlkeCBdID0gbWF0Y2hlZFtpXSApO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH0pIDpcblx0XHRcdFx0XHRmdW5jdGlvbiggZWxlbSApIHtcblx0XHRcdFx0XHRcdHJldHVybiBmbiggZWxlbSwgMCwgYXJncyApO1xuXHRcdFx0XHRcdH07XG5cdFx0XHR9XG5cblx0XHRcdHJldHVybiBmbjtcblx0XHR9XG5cdH0sXG5cblx0cHNldWRvczoge1xuXHRcdC8vIFBvdGVudGlhbGx5IGNvbXBsZXggcHNldWRvc1xuXHRcdFwibm90XCI6IG1hcmtGdW5jdGlvbihmdW5jdGlvbiggc2VsZWN0b3IgKSB7XG5cdFx0XHQvLyBUcmltIHRoZSBzZWxlY3RvciBwYXNzZWQgdG8gY29tcGlsZVxuXHRcdFx0Ly8gdG8gYXZvaWQgdHJlYXRpbmcgbGVhZGluZyBhbmQgdHJhaWxpbmdcblx0XHRcdC8vIHNwYWNlcyBhcyBjb21iaW5hdG9yc1xuXHRcdFx0dmFyIGlucHV0ID0gW10sXG5cdFx0XHRcdHJlc3VsdHMgPSBbXSxcblx0XHRcdFx0bWF0Y2hlciA9IGNvbXBpbGUoIHNlbGVjdG9yLnJlcGxhY2UoIHJ0cmltLCBcIiQxXCIgKSApO1xuXG5cdFx0XHRyZXR1cm4gbWF0Y2hlclsgZXhwYW5kbyBdID9cblx0XHRcdFx0bWFya0Z1bmN0aW9uKGZ1bmN0aW9uKCBzZWVkLCBtYXRjaGVzLCBjb250ZXh0LCB4bWwgKSB7XG5cdFx0XHRcdFx0dmFyIGVsZW0sXG5cdFx0XHRcdFx0XHR1bm1hdGNoZWQgPSBtYXRjaGVyKCBzZWVkLCBudWxsLCB4bWwsIFtdICksXG5cdFx0XHRcdFx0XHRpID0gc2VlZC5sZW5ndGg7XG5cblx0XHRcdFx0XHQvLyBNYXRjaCBlbGVtZW50cyB1bm1hdGNoZWQgYnkgYG1hdGNoZXJgXG5cdFx0XHRcdFx0d2hpbGUgKCBpLS0gKSB7XG5cdFx0XHRcdFx0XHRpZiAoIChlbGVtID0gdW5tYXRjaGVkW2ldKSApIHtcblx0XHRcdFx0XHRcdFx0c2VlZFtpXSA9ICEobWF0Y2hlc1tpXSA9IGVsZW0pO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH1cblx0XHRcdFx0fSkgOlxuXHRcdFx0XHRmdW5jdGlvbiggZWxlbSwgY29udGV4dCwgeG1sICkge1xuXHRcdFx0XHRcdGlucHV0WzBdID0gZWxlbTtcblx0XHRcdFx0XHRtYXRjaGVyKCBpbnB1dCwgbnVsbCwgeG1sLCByZXN1bHRzICk7XG5cdFx0XHRcdFx0Ly8gRG9uJ3Qga2VlcCB0aGUgZWxlbWVudCAoaXNzdWUgIzI5OSlcblx0XHRcdFx0XHRpbnB1dFswXSA9IG51bGw7XG5cdFx0XHRcdFx0cmV0dXJuICFyZXN1bHRzLnBvcCgpO1xuXHRcdFx0XHR9O1xuXHRcdH0pLFxuXG5cdFx0XCJoYXNcIjogbWFya0Z1bmN0aW9uKGZ1bmN0aW9uKCBzZWxlY3RvciApIHtcblx0XHRcdHJldHVybiBmdW5jdGlvbiggZWxlbSApIHtcblx0XHRcdFx0cmV0dXJuIFNpenpsZSggc2VsZWN0b3IsIGVsZW0gKS5sZW5ndGggPiAwO1xuXHRcdFx0fTtcblx0XHR9KSxcblxuXHRcdFwiY29udGFpbnNcIjogbWFya0Z1bmN0aW9uKGZ1bmN0aW9uKCB0ZXh0ICkge1xuXHRcdFx0dGV4dCA9IHRleHQucmVwbGFjZSggcnVuZXNjYXBlLCBmdW5lc2NhcGUgKTtcblx0XHRcdHJldHVybiBmdW5jdGlvbiggZWxlbSApIHtcblx0XHRcdFx0cmV0dXJuICggZWxlbS50ZXh0Q29udGVudCB8fCBlbGVtLmlubmVyVGV4dCB8fCBnZXRUZXh0KCBlbGVtICkgKS5pbmRleE9mKCB0ZXh0ICkgPiAtMTtcblx0XHRcdH07XG5cdFx0fSksXG5cblx0XHQvLyBcIldoZXRoZXIgYW4gZWxlbWVudCBpcyByZXByZXNlbnRlZCBieSBhIDpsYW5nKCkgc2VsZWN0b3Jcblx0XHQvLyBpcyBiYXNlZCBzb2xlbHkgb24gdGhlIGVsZW1lbnQncyBsYW5ndWFnZSB2YWx1ZVxuXHRcdC8vIGJlaW5nIGVxdWFsIHRvIHRoZSBpZGVudGlmaWVyIEMsXG5cdFx0Ly8gb3IgYmVnaW5uaW5nIHdpdGggdGhlIGlkZW50aWZpZXIgQyBpbW1lZGlhdGVseSBmb2xsb3dlZCBieSBcIi1cIi5cblx0XHQvLyBUaGUgbWF0Y2hpbmcgb2YgQyBhZ2FpbnN0IHRoZSBlbGVtZW50J3MgbGFuZ3VhZ2UgdmFsdWUgaXMgcGVyZm9ybWVkIGNhc2UtaW5zZW5zaXRpdmVseS5cblx0XHQvLyBUaGUgaWRlbnRpZmllciBDIGRvZXMgbm90IGhhdmUgdG8gYmUgYSB2YWxpZCBsYW5ndWFnZSBuYW1lLlwiXG5cdFx0Ly8gaHR0cDovL3d3dy53My5vcmcvVFIvc2VsZWN0b3JzLyNsYW5nLXBzZXVkb1xuXHRcdFwibGFuZ1wiOiBtYXJrRnVuY3Rpb24oIGZ1bmN0aW9uKCBsYW5nICkge1xuXHRcdFx0Ly8gbGFuZyB2YWx1ZSBtdXN0IGJlIGEgdmFsaWQgaWRlbnRpZmllclxuXHRcdFx0aWYgKCAhcmlkZW50aWZpZXIudGVzdChsYW5nIHx8IFwiXCIpICkge1xuXHRcdFx0XHRTaXp6bGUuZXJyb3IoIFwidW5zdXBwb3J0ZWQgbGFuZzogXCIgKyBsYW5nICk7XG5cdFx0XHR9XG5cdFx0XHRsYW5nID0gbGFuZy5yZXBsYWNlKCBydW5lc2NhcGUsIGZ1bmVzY2FwZSApLnRvTG93ZXJDYXNlKCk7XG5cdFx0XHRyZXR1cm4gZnVuY3Rpb24oIGVsZW0gKSB7XG5cdFx0XHRcdHZhciBlbGVtTGFuZztcblx0XHRcdFx0ZG8ge1xuXHRcdFx0XHRcdGlmICggKGVsZW1MYW5nID0gZG9jdW1lbnRJc0hUTUwgP1xuXHRcdFx0XHRcdFx0ZWxlbS5sYW5nIDpcblx0XHRcdFx0XHRcdGVsZW0uZ2V0QXR0cmlidXRlKFwieG1sOmxhbmdcIikgfHwgZWxlbS5nZXRBdHRyaWJ1dGUoXCJsYW5nXCIpKSApIHtcblxuXHRcdFx0XHRcdFx0ZWxlbUxhbmcgPSBlbGVtTGFuZy50b0xvd2VyQ2FzZSgpO1xuXHRcdFx0XHRcdFx0cmV0dXJuIGVsZW1MYW5nID09PSBsYW5nIHx8IGVsZW1MYW5nLmluZGV4T2YoIGxhbmcgKyBcIi1cIiApID09PSAwO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fSB3aGlsZSAoIChlbGVtID0gZWxlbS5wYXJlbnROb2RlKSAmJiBlbGVtLm5vZGVUeXBlID09PSAxICk7XG5cdFx0XHRcdHJldHVybiBmYWxzZTtcblx0XHRcdH07XG5cdFx0fSksXG5cblx0XHQvLyBNaXNjZWxsYW5lb3VzXG5cdFx0XCJ0YXJnZXRcIjogZnVuY3Rpb24oIGVsZW0gKSB7XG5cdFx0XHR2YXIgaGFzaCA9IHdpbmRvdy5sb2NhdGlvbiAmJiB3aW5kb3cubG9jYXRpb24uaGFzaDtcblx0XHRcdHJldHVybiBoYXNoICYmIGhhc2guc2xpY2UoIDEgKSA9PT0gZWxlbS5pZDtcblx0XHR9LFxuXG5cdFx0XCJyb290XCI6IGZ1bmN0aW9uKCBlbGVtICkge1xuXHRcdFx0cmV0dXJuIGVsZW0gPT09IGRvY0VsZW07XG5cdFx0fSxcblxuXHRcdFwiZm9jdXNcIjogZnVuY3Rpb24oIGVsZW0gKSB7XG5cdFx0XHRyZXR1cm4gZWxlbSA9PT0gZG9jdW1lbnQuYWN0aXZlRWxlbWVudCAmJiAoIWRvY3VtZW50Lmhhc0ZvY3VzIHx8IGRvY3VtZW50Lmhhc0ZvY3VzKCkpICYmICEhKGVsZW0udHlwZSB8fCBlbGVtLmhyZWYgfHwgfmVsZW0udGFiSW5kZXgpO1xuXHRcdH0sXG5cblx0XHQvLyBCb29sZWFuIHByb3BlcnRpZXNcblx0XHRcImVuYWJsZWRcIjogZnVuY3Rpb24oIGVsZW0gKSB7XG5cdFx0XHRyZXR1cm4gZWxlbS5kaXNhYmxlZCA9PT0gZmFsc2U7XG5cdFx0fSxcblxuXHRcdFwiZGlzYWJsZWRcIjogZnVuY3Rpb24oIGVsZW0gKSB7XG5cdFx0XHRyZXR1cm4gZWxlbS5kaXNhYmxlZCA9PT0gdHJ1ZTtcblx0XHR9LFxuXG5cdFx0XCJjaGVja2VkXCI6IGZ1bmN0aW9uKCBlbGVtICkge1xuXHRcdFx0Ly8gSW4gQ1NTMywgOmNoZWNrZWQgc2hvdWxkIHJldHVybiBib3RoIGNoZWNrZWQgYW5kIHNlbGVjdGVkIGVsZW1lbnRzXG5cdFx0XHQvLyBodHRwOi8vd3d3LnczLm9yZy9UUi8yMDExL1JFQy1jc3MzLXNlbGVjdG9ycy0yMDExMDkyOS8jY2hlY2tlZFxuXHRcdFx0dmFyIG5vZGVOYW1lID0gZWxlbS5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpO1xuXHRcdFx0cmV0dXJuIChub2RlTmFtZSA9PT0gXCJpbnB1dFwiICYmICEhZWxlbS5jaGVja2VkKSB8fCAobm9kZU5hbWUgPT09IFwib3B0aW9uXCIgJiYgISFlbGVtLnNlbGVjdGVkKTtcblx0XHR9LFxuXG5cdFx0XCJzZWxlY3RlZFwiOiBmdW5jdGlvbiggZWxlbSApIHtcblx0XHRcdC8vIEFjY2Vzc2luZyB0aGlzIHByb3BlcnR5IG1ha2VzIHNlbGVjdGVkLWJ5LWRlZmF1bHRcblx0XHRcdC8vIG9wdGlvbnMgaW4gU2FmYXJpIHdvcmsgcHJvcGVybHlcblx0XHRcdGlmICggZWxlbS5wYXJlbnROb2RlICkge1xuXHRcdFx0XHRlbGVtLnBhcmVudE5vZGUuc2VsZWN0ZWRJbmRleDtcblx0XHRcdH1cblxuXHRcdFx0cmV0dXJuIGVsZW0uc2VsZWN0ZWQgPT09IHRydWU7XG5cdFx0fSxcblxuXHRcdC8vIENvbnRlbnRzXG5cdFx0XCJlbXB0eVwiOiBmdW5jdGlvbiggZWxlbSApIHtcblx0XHRcdC8vIGh0dHA6Ly93d3cudzMub3JnL1RSL3NlbGVjdG9ycy8jZW1wdHktcHNldWRvXG5cdFx0XHQvLyA6ZW1wdHkgaXMgbmVnYXRlZCBieSBlbGVtZW50ICgxKSBvciBjb250ZW50IG5vZGVzICh0ZXh0OiAzOyBjZGF0YTogNDsgZW50aXR5IHJlZjogNSksXG5cdFx0XHQvLyAgIGJ1dCBub3QgYnkgb3RoZXJzIChjb21tZW50OiA4OyBwcm9jZXNzaW5nIGluc3RydWN0aW9uOiA3OyBldGMuKVxuXHRcdFx0Ly8gbm9kZVR5cGUgPCA2IHdvcmtzIGJlY2F1c2UgYXR0cmlidXRlcyAoMikgZG8gbm90IGFwcGVhciBhcyBjaGlsZHJlblxuXHRcdFx0Zm9yICggZWxlbSA9IGVsZW0uZmlyc3RDaGlsZDsgZWxlbTsgZWxlbSA9IGVsZW0ubmV4dFNpYmxpbmcgKSB7XG5cdFx0XHRcdGlmICggZWxlbS5ub2RlVHlwZSA8IDYgKSB7XG5cdFx0XHRcdFx0cmV0dXJuIGZhbHNlO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0XHRyZXR1cm4gdHJ1ZTtcblx0XHR9LFxuXG5cdFx0XCJwYXJlbnRcIjogZnVuY3Rpb24oIGVsZW0gKSB7XG5cdFx0XHRyZXR1cm4gIUV4cHIucHNldWRvc1tcImVtcHR5XCJdKCBlbGVtICk7XG5cdFx0fSxcblxuXHRcdC8vIEVsZW1lbnQvaW5wdXQgdHlwZXNcblx0XHRcImhlYWRlclwiOiBmdW5jdGlvbiggZWxlbSApIHtcblx0XHRcdHJldHVybiByaGVhZGVyLnRlc3QoIGVsZW0ubm9kZU5hbWUgKTtcblx0XHR9LFxuXG5cdFx0XCJpbnB1dFwiOiBmdW5jdGlvbiggZWxlbSApIHtcblx0XHRcdHJldHVybiByaW5wdXRzLnRlc3QoIGVsZW0ubm9kZU5hbWUgKTtcblx0XHR9LFxuXG5cdFx0XCJidXR0b25cIjogZnVuY3Rpb24oIGVsZW0gKSB7XG5cdFx0XHR2YXIgbmFtZSA9IGVsZW0ubm9kZU5hbWUudG9Mb3dlckNhc2UoKTtcblx0XHRcdHJldHVybiBuYW1lID09PSBcImlucHV0XCIgJiYgZWxlbS50eXBlID09PSBcImJ1dHRvblwiIHx8IG5hbWUgPT09IFwiYnV0dG9uXCI7XG5cdFx0fSxcblxuXHRcdFwidGV4dFwiOiBmdW5jdGlvbiggZWxlbSApIHtcblx0XHRcdHZhciBhdHRyO1xuXHRcdFx0cmV0dXJuIGVsZW0ubm9kZU5hbWUudG9Mb3dlckNhc2UoKSA9PT0gXCJpbnB1dFwiICYmXG5cdFx0XHRcdGVsZW0udHlwZSA9PT0gXCJ0ZXh0XCIgJiZcblxuXHRcdFx0XHQvLyBTdXBwb3J0OiBJRTw4XG5cdFx0XHRcdC8vIE5ldyBIVE1MNSBhdHRyaWJ1dGUgdmFsdWVzIChlLmcuLCBcInNlYXJjaFwiKSBhcHBlYXIgd2l0aCBlbGVtLnR5cGUgPT09IFwidGV4dFwiXG5cdFx0XHRcdCggKGF0dHIgPSBlbGVtLmdldEF0dHJpYnV0ZShcInR5cGVcIikpID09IG51bGwgfHwgYXR0ci50b0xvd2VyQ2FzZSgpID09PSBcInRleHRcIiApO1xuXHRcdH0sXG5cblx0XHQvLyBQb3NpdGlvbi1pbi1jb2xsZWN0aW9uXG5cdFx0XCJmaXJzdFwiOiBjcmVhdGVQb3NpdGlvbmFsUHNldWRvKGZ1bmN0aW9uKCkge1xuXHRcdFx0cmV0dXJuIFsgMCBdO1xuXHRcdH0pLFxuXG5cdFx0XCJsYXN0XCI6IGNyZWF0ZVBvc2l0aW9uYWxQc2V1ZG8oZnVuY3Rpb24oIG1hdGNoSW5kZXhlcywgbGVuZ3RoICkge1xuXHRcdFx0cmV0dXJuIFsgbGVuZ3RoIC0gMSBdO1xuXHRcdH0pLFxuXG5cdFx0XCJlcVwiOiBjcmVhdGVQb3NpdGlvbmFsUHNldWRvKGZ1bmN0aW9uKCBtYXRjaEluZGV4ZXMsIGxlbmd0aCwgYXJndW1lbnQgKSB7XG5cdFx0XHRyZXR1cm4gWyBhcmd1bWVudCA8IDAgPyBhcmd1bWVudCArIGxlbmd0aCA6IGFyZ3VtZW50IF07XG5cdFx0fSksXG5cblx0XHRcImV2ZW5cIjogY3JlYXRlUG9zaXRpb25hbFBzZXVkbyhmdW5jdGlvbiggbWF0Y2hJbmRleGVzLCBsZW5ndGggKSB7XG5cdFx0XHR2YXIgaSA9IDA7XG5cdFx0XHRmb3IgKCA7IGkgPCBsZW5ndGg7IGkgKz0gMiApIHtcblx0XHRcdFx0bWF0Y2hJbmRleGVzLnB1c2goIGkgKTtcblx0XHRcdH1cblx0XHRcdHJldHVybiBtYXRjaEluZGV4ZXM7XG5cdFx0fSksXG5cblx0XHRcIm9kZFwiOiBjcmVhdGVQb3NpdGlvbmFsUHNldWRvKGZ1bmN0aW9uKCBtYXRjaEluZGV4ZXMsIGxlbmd0aCApIHtcblx0XHRcdHZhciBpID0gMTtcblx0XHRcdGZvciAoIDsgaSA8IGxlbmd0aDsgaSArPSAyICkge1xuXHRcdFx0XHRtYXRjaEluZGV4ZXMucHVzaCggaSApO1xuXHRcdFx0fVxuXHRcdFx0cmV0dXJuIG1hdGNoSW5kZXhlcztcblx0XHR9KSxcblxuXHRcdFwibHRcIjogY3JlYXRlUG9zaXRpb25hbFBzZXVkbyhmdW5jdGlvbiggbWF0Y2hJbmRleGVzLCBsZW5ndGgsIGFyZ3VtZW50ICkge1xuXHRcdFx0dmFyIGkgPSBhcmd1bWVudCA8IDAgPyBhcmd1bWVudCArIGxlbmd0aCA6IGFyZ3VtZW50O1xuXHRcdFx0Zm9yICggOyAtLWkgPj0gMDsgKSB7XG5cdFx0XHRcdG1hdGNoSW5kZXhlcy5wdXNoKCBpICk7XG5cdFx0XHR9XG5cdFx0XHRyZXR1cm4gbWF0Y2hJbmRleGVzO1xuXHRcdH0pLFxuXG5cdFx0XCJndFwiOiBjcmVhdGVQb3NpdGlvbmFsUHNldWRvKGZ1bmN0aW9uKCBtYXRjaEluZGV4ZXMsIGxlbmd0aCwgYXJndW1lbnQgKSB7XG5cdFx0XHR2YXIgaSA9IGFyZ3VtZW50IDwgMCA/IGFyZ3VtZW50ICsgbGVuZ3RoIDogYXJndW1lbnQ7XG5cdFx0XHRmb3IgKCA7ICsraSA8IGxlbmd0aDsgKSB7XG5cdFx0XHRcdG1hdGNoSW5kZXhlcy5wdXNoKCBpICk7XG5cdFx0XHR9XG5cdFx0XHRyZXR1cm4gbWF0Y2hJbmRleGVzO1xuXHRcdH0pXG5cdH1cbn07XG5cbkV4cHIucHNldWRvc1tcIm50aFwiXSA9IEV4cHIucHNldWRvc1tcImVxXCJdO1xuXG4vLyBBZGQgYnV0dG9uL2lucHV0IHR5cGUgcHNldWRvc1xuZm9yICggaSBpbiB7IHJhZGlvOiB0cnVlLCBjaGVja2JveDogdHJ1ZSwgZmlsZTogdHJ1ZSwgcGFzc3dvcmQ6IHRydWUsIGltYWdlOiB0cnVlIH0gKSB7XG5cdEV4cHIucHNldWRvc1sgaSBdID0gY3JlYXRlSW5wdXRQc2V1ZG8oIGkgKTtcbn1cbmZvciAoIGkgaW4geyBzdWJtaXQ6IHRydWUsIHJlc2V0OiB0cnVlIH0gKSB7XG5cdEV4cHIucHNldWRvc1sgaSBdID0gY3JlYXRlQnV0dG9uUHNldWRvKCBpICk7XG59XG5cbi8vIEVhc3kgQVBJIGZvciBjcmVhdGluZyBuZXcgc2V0RmlsdGVyc1xuZnVuY3Rpb24gc2V0RmlsdGVycygpIHt9XG5zZXRGaWx0ZXJzLnByb3RvdHlwZSA9IEV4cHIuZmlsdGVycyA9IEV4cHIucHNldWRvcztcbkV4cHIuc2V0RmlsdGVycyA9IG5ldyBzZXRGaWx0ZXJzKCk7XG5cbnRva2VuaXplID0gU2l6emxlLnRva2VuaXplID0gZnVuY3Rpb24oIHNlbGVjdG9yLCBwYXJzZU9ubHkgKSB7XG5cdHZhciBtYXRjaGVkLCBtYXRjaCwgdG9rZW5zLCB0eXBlLFxuXHRcdHNvRmFyLCBncm91cHMsIHByZUZpbHRlcnMsXG5cdFx0Y2FjaGVkID0gdG9rZW5DYWNoZVsgc2VsZWN0b3IgKyBcIiBcIiBdO1xuXG5cdGlmICggY2FjaGVkICkge1xuXHRcdHJldHVybiBwYXJzZU9ubHkgPyAwIDogY2FjaGVkLnNsaWNlKCAwICk7XG5cdH1cblxuXHRzb0ZhciA9IHNlbGVjdG9yO1xuXHRncm91cHMgPSBbXTtcblx0cHJlRmlsdGVycyA9IEV4cHIucHJlRmlsdGVyO1xuXG5cdHdoaWxlICggc29GYXIgKSB7XG5cblx0XHQvLyBDb21tYSBhbmQgZmlyc3QgcnVuXG5cdFx0aWYgKCAhbWF0Y2hlZCB8fCAobWF0Y2ggPSByY29tbWEuZXhlYyggc29GYXIgKSkgKSB7XG5cdFx0XHRpZiAoIG1hdGNoICkge1xuXHRcdFx0XHQvLyBEb24ndCBjb25zdW1lIHRyYWlsaW5nIGNvbW1hcyBhcyB2YWxpZFxuXHRcdFx0XHRzb0ZhciA9IHNvRmFyLnNsaWNlKCBtYXRjaFswXS5sZW5ndGggKSB8fCBzb0Zhcjtcblx0XHRcdH1cblx0XHRcdGdyb3Vwcy5wdXNoKCAodG9rZW5zID0gW10pICk7XG5cdFx0fVxuXG5cdFx0bWF0Y2hlZCA9IGZhbHNlO1xuXG5cdFx0Ly8gQ29tYmluYXRvcnNcblx0XHRpZiAoIChtYXRjaCA9IHJjb21iaW5hdG9ycy5leGVjKCBzb0ZhciApKSApIHtcblx0XHRcdG1hdGNoZWQgPSBtYXRjaC5zaGlmdCgpO1xuXHRcdFx0dG9rZW5zLnB1c2goe1xuXHRcdFx0XHR2YWx1ZTogbWF0Y2hlZCxcblx0XHRcdFx0Ly8gQ2FzdCBkZXNjZW5kYW50IGNvbWJpbmF0b3JzIHRvIHNwYWNlXG5cdFx0XHRcdHR5cGU6IG1hdGNoWzBdLnJlcGxhY2UoIHJ0cmltLCBcIiBcIiApXG5cdFx0XHR9KTtcblx0XHRcdHNvRmFyID0gc29GYXIuc2xpY2UoIG1hdGNoZWQubGVuZ3RoICk7XG5cdFx0fVxuXG5cdFx0Ly8gRmlsdGVyc1xuXHRcdGZvciAoIHR5cGUgaW4gRXhwci5maWx0ZXIgKSB7XG5cdFx0XHRpZiAoIChtYXRjaCA9IG1hdGNoRXhwclsgdHlwZSBdLmV4ZWMoIHNvRmFyICkpICYmICghcHJlRmlsdGVyc1sgdHlwZSBdIHx8XG5cdFx0XHRcdChtYXRjaCA9IHByZUZpbHRlcnNbIHR5cGUgXSggbWF0Y2ggKSkpICkge1xuXHRcdFx0XHRtYXRjaGVkID0gbWF0Y2guc2hpZnQoKTtcblx0XHRcdFx0dG9rZW5zLnB1c2goe1xuXHRcdFx0XHRcdHZhbHVlOiBtYXRjaGVkLFxuXHRcdFx0XHRcdHR5cGU6IHR5cGUsXG5cdFx0XHRcdFx0bWF0Y2hlczogbWF0Y2hcblx0XHRcdFx0fSk7XG5cdFx0XHRcdHNvRmFyID0gc29GYXIuc2xpY2UoIG1hdGNoZWQubGVuZ3RoICk7XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0aWYgKCAhbWF0Y2hlZCApIHtcblx0XHRcdGJyZWFrO1xuXHRcdH1cblx0fVxuXG5cdC8vIFJldHVybiB0aGUgbGVuZ3RoIG9mIHRoZSBpbnZhbGlkIGV4Y2Vzc1xuXHQvLyBpZiB3ZSdyZSBqdXN0IHBhcnNpbmdcblx0Ly8gT3RoZXJ3aXNlLCB0aHJvdyBhbiBlcnJvciBvciByZXR1cm4gdG9rZW5zXG5cdHJldHVybiBwYXJzZU9ubHkgP1xuXHRcdHNvRmFyLmxlbmd0aCA6XG5cdFx0c29GYXIgP1xuXHRcdFx0U2l6emxlLmVycm9yKCBzZWxlY3RvciApIDpcblx0XHRcdC8vIENhY2hlIHRoZSB0b2tlbnNcblx0XHRcdHRva2VuQ2FjaGUoIHNlbGVjdG9yLCBncm91cHMgKS5zbGljZSggMCApO1xufTtcblxuZnVuY3Rpb24gdG9TZWxlY3RvciggdG9rZW5zICkge1xuXHR2YXIgaSA9IDAsXG5cdFx0bGVuID0gdG9rZW5zLmxlbmd0aCxcblx0XHRzZWxlY3RvciA9IFwiXCI7XG5cdGZvciAoIDsgaSA8IGxlbjsgaSsrICkge1xuXHRcdHNlbGVjdG9yICs9IHRva2Vuc1tpXS52YWx1ZTtcblx0fVxuXHRyZXR1cm4gc2VsZWN0b3I7XG59XG5cbmZ1bmN0aW9uIGFkZENvbWJpbmF0b3IoIG1hdGNoZXIsIGNvbWJpbmF0b3IsIGJhc2UgKSB7XG5cdHZhciBkaXIgPSBjb21iaW5hdG9yLmRpcixcblx0XHRjaGVja05vbkVsZW1lbnRzID0gYmFzZSAmJiBkaXIgPT09IFwicGFyZW50Tm9kZVwiLFxuXHRcdGRvbmVOYW1lID0gZG9uZSsrO1xuXG5cdHJldHVybiBjb21iaW5hdG9yLmZpcnN0ID9cblx0XHQvLyBDaGVjayBhZ2FpbnN0IGNsb3Nlc3QgYW5jZXN0b3IvcHJlY2VkaW5nIGVsZW1lbnRcblx0XHRmdW5jdGlvbiggZWxlbSwgY29udGV4dCwgeG1sICkge1xuXHRcdFx0d2hpbGUgKCAoZWxlbSA9IGVsZW1bIGRpciBdKSApIHtcblx0XHRcdFx0aWYgKCBlbGVtLm5vZGVUeXBlID09PSAxIHx8IGNoZWNrTm9uRWxlbWVudHMgKSB7XG5cdFx0XHRcdFx0cmV0dXJuIG1hdGNoZXIoIGVsZW0sIGNvbnRleHQsIHhtbCApO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fSA6XG5cblx0XHQvLyBDaGVjayBhZ2FpbnN0IGFsbCBhbmNlc3Rvci9wcmVjZWRpbmcgZWxlbWVudHNcblx0XHRmdW5jdGlvbiggZWxlbSwgY29udGV4dCwgeG1sICkge1xuXHRcdFx0dmFyIG9sZENhY2hlLCBvdXRlckNhY2hlLFxuXHRcdFx0XHRuZXdDYWNoZSA9IFsgZGlycnVucywgZG9uZU5hbWUgXTtcblxuXHRcdFx0Ly8gV2UgY2FuJ3Qgc2V0IGFyYml0cmFyeSBkYXRhIG9uIFhNTCBub2Rlcywgc28gdGhleSBkb24ndCBiZW5lZml0IGZyb20gZGlyIGNhY2hpbmdcblx0XHRcdGlmICggeG1sICkge1xuXHRcdFx0XHR3aGlsZSAoIChlbGVtID0gZWxlbVsgZGlyIF0pICkge1xuXHRcdFx0XHRcdGlmICggZWxlbS5ub2RlVHlwZSA9PT0gMSB8fCBjaGVja05vbkVsZW1lbnRzICkge1xuXHRcdFx0XHRcdFx0aWYgKCBtYXRjaGVyKCBlbGVtLCBjb250ZXh0LCB4bWwgKSApIHtcblx0XHRcdFx0XHRcdFx0cmV0dXJuIHRydWU7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHR3aGlsZSAoIChlbGVtID0gZWxlbVsgZGlyIF0pICkge1xuXHRcdFx0XHRcdGlmICggZWxlbS5ub2RlVHlwZSA9PT0gMSB8fCBjaGVja05vbkVsZW1lbnRzICkge1xuXHRcdFx0XHRcdFx0b3V0ZXJDYWNoZSA9IGVsZW1bIGV4cGFuZG8gXSB8fCAoZWxlbVsgZXhwYW5kbyBdID0ge30pO1xuXHRcdFx0XHRcdFx0aWYgKCAob2xkQ2FjaGUgPSBvdXRlckNhY2hlWyBkaXIgXSkgJiZcblx0XHRcdFx0XHRcdFx0b2xkQ2FjaGVbIDAgXSA9PT0gZGlycnVucyAmJiBvbGRDYWNoZVsgMSBdID09PSBkb25lTmFtZSApIHtcblxuXHRcdFx0XHRcdFx0XHQvLyBBc3NpZ24gdG8gbmV3Q2FjaGUgc28gcmVzdWx0cyBiYWNrLXByb3BhZ2F0ZSB0byBwcmV2aW91cyBlbGVtZW50c1xuXHRcdFx0XHRcdFx0XHRyZXR1cm4gKG5ld0NhY2hlWyAyIF0gPSBvbGRDYWNoZVsgMiBdKTtcblx0XHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHRcdC8vIFJldXNlIG5ld2NhY2hlIHNvIHJlc3VsdHMgYmFjay1wcm9wYWdhdGUgdG8gcHJldmlvdXMgZWxlbWVudHNcblx0XHRcdFx0XHRcdFx0b3V0ZXJDYWNoZVsgZGlyIF0gPSBuZXdDYWNoZTtcblxuXHRcdFx0XHRcdFx0XHQvLyBBIG1hdGNoIG1lYW5zIHdlJ3JlIGRvbmU7IGEgZmFpbCBtZWFucyB3ZSBoYXZlIHRvIGtlZXAgY2hlY2tpbmdcblx0XHRcdFx0XHRcdFx0aWYgKCAobmV3Q2FjaGVbIDIgXSA9IG1hdGNoZXIoIGVsZW0sIGNvbnRleHQsIHhtbCApKSApIHtcblx0XHRcdFx0XHRcdFx0XHRyZXR1cm4gdHJ1ZTtcblx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH07XG59XG5cbmZ1bmN0aW9uIGVsZW1lbnRNYXRjaGVyKCBtYXRjaGVycyApIHtcblx0cmV0dXJuIG1hdGNoZXJzLmxlbmd0aCA+IDEgP1xuXHRcdGZ1bmN0aW9uKCBlbGVtLCBjb250ZXh0LCB4bWwgKSB7XG5cdFx0XHR2YXIgaSA9IG1hdGNoZXJzLmxlbmd0aDtcblx0XHRcdHdoaWxlICggaS0tICkge1xuXHRcdFx0XHRpZiAoICFtYXRjaGVyc1tpXSggZWxlbSwgY29udGV4dCwgeG1sICkgKSB7XG5cdFx0XHRcdFx0cmV0dXJuIGZhbHNlO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0XHRyZXR1cm4gdHJ1ZTtcblx0XHR9IDpcblx0XHRtYXRjaGVyc1swXTtcbn1cblxuZnVuY3Rpb24gbXVsdGlwbGVDb250ZXh0cyggc2VsZWN0b3IsIGNvbnRleHRzLCByZXN1bHRzICkge1xuXHR2YXIgaSA9IDAsXG5cdFx0bGVuID0gY29udGV4dHMubGVuZ3RoO1xuXHRmb3IgKCA7IGkgPCBsZW47IGkrKyApIHtcblx0XHRTaXp6bGUoIHNlbGVjdG9yLCBjb250ZXh0c1tpXSwgcmVzdWx0cyApO1xuXHR9XG5cdHJldHVybiByZXN1bHRzO1xufVxuXG5mdW5jdGlvbiBjb25kZW5zZSggdW5tYXRjaGVkLCBtYXAsIGZpbHRlciwgY29udGV4dCwgeG1sICkge1xuXHR2YXIgZWxlbSxcblx0XHRuZXdVbm1hdGNoZWQgPSBbXSxcblx0XHRpID0gMCxcblx0XHRsZW4gPSB1bm1hdGNoZWQubGVuZ3RoLFxuXHRcdG1hcHBlZCA9IG1hcCAhPSBudWxsO1xuXG5cdGZvciAoIDsgaSA8IGxlbjsgaSsrICkge1xuXHRcdGlmICggKGVsZW0gPSB1bm1hdGNoZWRbaV0pICkge1xuXHRcdFx0aWYgKCAhZmlsdGVyIHx8IGZpbHRlciggZWxlbSwgY29udGV4dCwgeG1sICkgKSB7XG5cdFx0XHRcdG5ld1VubWF0Y2hlZC5wdXNoKCBlbGVtICk7XG5cdFx0XHRcdGlmICggbWFwcGVkICkge1xuXHRcdFx0XHRcdG1hcC5wdXNoKCBpICk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9XG5cdH1cblxuXHRyZXR1cm4gbmV3VW5tYXRjaGVkO1xufVxuXG5mdW5jdGlvbiBzZXRNYXRjaGVyKCBwcmVGaWx0ZXIsIHNlbGVjdG9yLCBtYXRjaGVyLCBwb3N0RmlsdGVyLCBwb3N0RmluZGVyLCBwb3N0U2VsZWN0b3IgKSB7XG5cdGlmICggcG9zdEZpbHRlciAmJiAhcG9zdEZpbHRlclsgZXhwYW5kbyBdICkge1xuXHRcdHBvc3RGaWx0ZXIgPSBzZXRNYXRjaGVyKCBwb3N0RmlsdGVyICk7XG5cdH1cblx0aWYgKCBwb3N0RmluZGVyICYmICFwb3N0RmluZGVyWyBleHBhbmRvIF0gKSB7XG5cdFx0cG9zdEZpbmRlciA9IHNldE1hdGNoZXIoIHBvc3RGaW5kZXIsIHBvc3RTZWxlY3RvciApO1xuXHR9XG5cdHJldHVybiBtYXJrRnVuY3Rpb24oZnVuY3Rpb24oIHNlZWQsIHJlc3VsdHMsIGNvbnRleHQsIHhtbCApIHtcblx0XHR2YXIgdGVtcCwgaSwgZWxlbSxcblx0XHRcdHByZU1hcCA9IFtdLFxuXHRcdFx0cG9zdE1hcCA9IFtdLFxuXHRcdFx0cHJlZXhpc3RpbmcgPSByZXN1bHRzLmxlbmd0aCxcblxuXHRcdFx0Ly8gR2V0IGluaXRpYWwgZWxlbWVudHMgZnJvbSBzZWVkIG9yIGNvbnRleHRcblx0XHRcdGVsZW1zID0gc2VlZCB8fCBtdWx0aXBsZUNvbnRleHRzKCBzZWxlY3RvciB8fCBcIipcIiwgY29udGV4dC5ub2RlVHlwZSA/IFsgY29udGV4dCBdIDogY29udGV4dCwgW10gKSxcblxuXHRcdFx0Ly8gUHJlZmlsdGVyIHRvIGdldCBtYXRjaGVyIGlucHV0LCBwcmVzZXJ2aW5nIGEgbWFwIGZvciBzZWVkLXJlc3VsdHMgc3luY2hyb25pemF0aW9uXG5cdFx0XHRtYXRjaGVySW4gPSBwcmVGaWx0ZXIgJiYgKCBzZWVkIHx8ICFzZWxlY3RvciApID9cblx0XHRcdFx0Y29uZGVuc2UoIGVsZW1zLCBwcmVNYXAsIHByZUZpbHRlciwgY29udGV4dCwgeG1sICkgOlxuXHRcdFx0XHRlbGVtcyxcblxuXHRcdFx0bWF0Y2hlck91dCA9IG1hdGNoZXIgP1xuXHRcdFx0XHQvLyBJZiB3ZSBoYXZlIGEgcG9zdEZpbmRlciwgb3IgZmlsdGVyZWQgc2VlZCwgb3Igbm9uLXNlZWQgcG9zdEZpbHRlciBvciBwcmVleGlzdGluZyByZXN1bHRzLFxuXHRcdFx0XHRwb3N0RmluZGVyIHx8ICggc2VlZCA/IHByZUZpbHRlciA6IHByZWV4aXN0aW5nIHx8IHBvc3RGaWx0ZXIgKSA/XG5cblx0XHRcdFx0XHQvLyAuLi5pbnRlcm1lZGlhdGUgcHJvY2Vzc2luZyBpcyBuZWNlc3Nhcnlcblx0XHRcdFx0XHRbXSA6XG5cblx0XHRcdFx0XHQvLyAuLi5vdGhlcndpc2UgdXNlIHJlc3VsdHMgZGlyZWN0bHlcblx0XHRcdFx0XHRyZXN1bHRzIDpcblx0XHRcdFx0bWF0Y2hlckluO1xuXG5cdFx0Ly8gRmluZCBwcmltYXJ5IG1hdGNoZXNcblx0XHRpZiAoIG1hdGNoZXIgKSB7XG5cdFx0XHRtYXRjaGVyKCBtYXRjaGVySW4sIG1hdGNoZXJPdXQsIGNvbnRleHQsIHhtbCApO1xuXHRcdH1cblxuXHRcdC8vIEFwcGx5IHBvc3RGaWx0ZXJcblx0XHRpZiAoIHBvc3RGaWx0ZXIgKSB7XG5cdFx0XHR0ZW1wID0gY29uZGVuc2UoIG1hdGNoZXJPdXQsIHBvc3RNYXAgKTtcblx0XHRcdHBvc3RGaWx0ZXIoIHRlbXAsIFtdLCBjb250ZXh0LCB4bWwgKTtcblxuXHRcdFx0Ly8gVW4tbWF0Y2ggZmFpbGluZyBlbGVtZW50cyBieSBtb3ZpbmcgdGhlbSBiYWNrIHRvIG1hdGNoZXJJblxuXHRcdFx0aSA9IHRlbXAubGVuZ3RoO1xuXHRcdFx0d2hpbGUgKCBpLS0gKSB7XG5cdFx0XHRcdGlmICggKGVsZW0gPSB0ZW1wW2ldKSApIHtcblx0XHRcdFx0XHRtYXRjaGVyT3V0WyBwb3N0TWFwW2ldIF0gPSAhKG1hdGNoZXJJblsgcG9zdE1hcFtpXSBdID0gZWxlbSk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9XG5cblx0XHRpZiAoIHNlZWQgKSB7XG5cdFx0XHRpZiAoIHBvc3RGaW5kZXIgfHwgcHJlRmlsdGVyICkge1xuXHRcdFx0XHRpZiAoIHBvc3RGaW5kZXIgKSB7XG5cdFx0XHRcdFx0Ly8gR2V0IHRoZSBmaW5hbCBtYXRjaGVyT3V0IGJ5IGNvbmRlbnNpbmcgdGhpcyBpbnRlcm1lZGlhdGUgaW50byBwb3N0RmluZGVyIGNvbnRleHRzXG5cdFx0XHRcdFx0dGVtcCA9IFtdO1xuXHRcdFx0XHRcdGkgPSBtYXRjaGVyT3V0Lmxlbmd0aDtcblx0XHRcdFx0XHR3aGlsZSAoIGktLSApIHtcblx0XHRcdFx0XHRcdGlmICggKGVsZW0gPSBtYXRjaGVyT3V0W2ldKSApIHtcblx0XHRcdFx0XHRcdFx0Ly8gUmVzdG9yZSBtYXRjaGVySW4gc2luY2UgZWxlbSBpcyBub3QgeWV0IGEgZmluYWwgbWF0Y2hcblx0XHRcdFx0XHRcdFx0dGVtcC5wdXNoKCAobWF0Y2hlckluW2ldID0gZWxlbSkgKTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0cG9zdEZpbmRlciggbnVsbCwgKG1hdGNoZXJPdXQgPSBbXSksIHRlbXAsIHhtbCApO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0Ly8gTW92ZSBtYXRjaGVkIGVsZW1lbnRzIGZyb20gc2VlZCB0byByZXN1bHRzIHRvIGtlZXAgdGhlbSBzeW5jaHJvbml6ZWRcblx0XHRcdFx0aSA9IG1hdGNoZXJPdXQubGVuZ3RoO1xuXHRcdFx0XHR3aGlsZSAoIGktLSApIHtcblx0XHRcdFx0XHRpZiAoIChlbGVtID0gbWF0Y2hlck91dFtpXSkgJiZcblx0XHRcdFx0XHRcdCh0ZW1wID0gcG9zdEZpbmRlciA/IGluZGV4T2YoIHNlZWQsIGVsZW0gKSA6IHByZU1hcFtpXSkgPiAtMSApIHtcblxuXHRcdFx0XHRcdFx0c2VlZFt0ZW1wXSA9ICEocmVzdWx0c1t0ZW1wXSA9IGVsZW0pO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0fVxuXG5cdFx0Ly8gQWRkIGVsZW1lbnRzIHRvIHJlc3VsdHMsIHRocm91Z2ggcG9zdEZpbmRlciBpZiBkZWZpbmVkXG5cdFx0fSBlbHNlIHtcblx0XHRcdG1hdGNoZXJPdXQgPSBjb25kZW5zZShcblx0XHRcdFx0bWF0Y2hlck91dCA9PT0gcmVzdWx0cyA/XG5cdFx0XHRcdFx0bWF0Y2hlck91dC5zcGxpY2UoIHByZWV4aXN0aW5nLCBtYXRjaGVyT3V0Lmxlbmd0aCApIDpcblx0XHRcdFx0XHRtYXRjaGVyT3V0XG5cdFx0XHQpO1xuXHRcdFx0aWYgKCBwb3N0RmluZGVyICkge1xuXHRcdFx0XHRwb3N0RmluZGVyKCBudWxsLCByZXN1bHRzLCBtYXRjaGVyT3V0LCB4bWwgKTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdHB1c2guYXBwbHkoIHJlc3VsdHMsIG1hdGNoZXJPdXQgKTtcblx0XHRcdH1cblx0XHR9XG5cdH0pO1xufVxuXG5mdW5jdGlvbiBtYXRjaGVyRnJvbVRva2VucyggdG9rZW5zICkge1xuXHR2YXIgY2hlY2tDb250ZXh0LCBtYXRjaGVyLCBqLFxuXHRcdGxlbiA9IHRva2Vucy5sZW5ndGgsXG5cdFx0bGVhZGluZ1JlbGF0aXZlID0gRXhwci5yZWxhdGl2ZVsgdG9rZW5zWzBdLnR5cGUgXSxcblx0XHRpbXBsaWNpdFJlbGF0aXZlID0gbGVhZGluZ1JlbGF0aXZlIHx8IEV4cHIucmVsYXRpdmVbXCIgXCJdLFxuXHRcdGkgPSBsZWFkaW5nUmVsYXRpdmUgPyAxIDogMCxcblxuXHRcdC8vIFRoZSBmb3VuZGF0aW9uYWwgbWF0Y2hlciBlbnN1cmVzIHRoYXQgZWxlbWVudHMgYXJlIHJlYWNoYWJsZSBmcm9tIHRvcC1sZXZlbCBjb250ZXh0KHMpXG5cdFx0bWF0Y2hDb250ZXh0ID0gYWRkQ29tYmluYXRvciggZnVuY3Rpb24oIGVsZW0gKSB7XG5cdFx0XHRyZXR1cm4gZWxlbSA9PT0gY2hlY2tDb250ZXh0O1xuXHRcdH0sIGltcGxpY2l0UmVsYXRpdmUsIHRydWUgKSxcblx0XHRtYXRjaEFueUNvbnRleHQgPSBhZGRDb21iaW5hdG9yKCBmdW5jdGlvbiggZWxlbSApIHtcblx0XHRcdHJldHVybiBpbmRleE9mKCBjaGVja0NvbnRleHQsIGVsZW0gKSA+IC0xO1xuXHRcdH0sIGltcGxpY2l0UmVsYXRpdmUsIHRydWUgKSxcblx0XHRtYXRjaGVycyA9IFsgZnVuY3Rpb24oIGVsZW0sIGNvbnRleHQsIHhtbCApIHtcblx0XHRcdHZhciByZXQgPSAoICFsZWFkaW5nUmVsYXRpdmUgJiYgKCB4bWwgfHwgY29udGV4dCAhPT0gb3V0ZXJtb3N0Q29udGV4dCApICkgfHwgKFxuXHRcdFx0XHQoY2hlY2tDb250ZXh0ID0gY29udGV4dCkubm9kZVR5cGUgP1xuXHRcdFx0XHRcdG1hdGNoQ29udGV4dCggZWxlbSwgY29udGV4dCwgeG1sICkgOlxuXHRcdFx0XHRcdG1hdGNoQW55Q29udGV4dCggZWxlbSwgY29udGV4dCwgeG1sICkgKTtcblx0XHRcdC8vIEF2b2lkIGhhbmdpbmcgb250byBlbGVtZW50IChpc3N1ZSAjMjk5KVxuXHRcdFx0Y2hlY2tDb250ZXh0ID0gbnVsbDtcblx0XHRcdHJldHVybiByZXQ7XG5cdFx0fSBdO1xuXG5cdGZvciAoIDsgaSA8IGxlbjsgaSsrICkge1xuXHRcdGlmICggKG1hdGNoZXIgPSBFeHByLnJlbGF0aXZlWyB0b2tlbnNbaV0udHlwZSBdKSApIHtcblx0XHRcdG1hdGNoZXJzID0gWyBhZGRDb21iaW5hdG9yKGVsZW1lbnRNYXRjaGVyKCBtYXRjaGVycyApLCBtYXRjaGVyKSBdO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRtYXRjaGVyID0gRXhwci5maWx0ZXJbIHRva2Vuc1tpXS50eXBlIF0uYXBwbHkoIG51bGwsIHRva2Vuc1tpXS5tYXRjaGVzICk7XG5cblx0XHRcdC8vIFJldHVybiBzcGVjaWFsIHVwb24gc2VlaW5nIGEgcG9zaXRpb25hbCBtYXRjaGVyXG5cdFx0XHRpZiAoIG1hdGNoZXJbIGV4cGFuZG8gXSApIHtcblx0XHRcdFx0Ly8gRmluZCB0aGUgbmV4dCByZWxhdGl2ZSBvcGVyYXRvciAoaWYgYW55KSBmb3IgcHJvcGVyIGhhbmRsaW5nXG5cdFx0XHRcdGogPSArK2k7XG5cdFx0XHRcdGZvciAoIDsgaiA8IGxlbjsgaisrICkge1xuXHRcdFx0XHRcdGlmICggRXhwci5yZWxhdGl2ZVsgdG9rZW5zW2pdLnR5cGUgXSApIHtcblx0XHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0XHRyZXR1cm4gc2V0TWF0Y2hlcihcblx0XHRcdFx0XHRpID4gMSAmJiBlbGVtZW50TWF0Y2hlciggbWF0Y2hlcnMgKSxcblx0XHRcdFx0XHRpID4gMSAmJiB0b1NlbGVjdG9yKFxuXHRcdFx0XHRcdFx0Ly8gSWYgdGhlIHByZWNlZGluZyB0b2tlbiB3YXMgYSBkZXNjZW5kYW50IGNvbWJpbmF0b3IsIGluc2VydCBhbiBpbXBsaWNpdCBhbnktZWxlbWVudCBgKmBcblx0XHRcdFx0XHRcdHRva2Vucy5zbGljZSggMCwgaSAtIDEgKS5jb25jYXQoeyB2YWx1ZTogdG9rZW5zWyBpIC0gMiBdLnR5cGUgPT09IFwiIFwiID8gXCIqXCIgOiBcIlwiIH0pXG5cdFx0XHRcdFx0KS5yZXBsYWNlKCBydHJpbSwgXCIkMVwiICksXG5cdFx0XHRcdFx0bWF0Y2hlcixcblx0XHRcdFx0XHRpIDwgaiAmJiBtYXRjaGVyRnJvbVRva2VucyggdG9rZW5zLnNsaWNlKCBpLCBqICkgKSxcblx0XHRcdFx0XHRqIDwgbGVuICYmIG1hdGNoZXJGcm9tVG9rZW5zKCAodG9rZW5zID0gdG9rZW5zLnNsaWNlKCBqICkpICksXG5cdFx0XHRcdFx0aiA8IGxlbiAmJiB0b1NlbGVjdG9yKCB0b2tlbnMgKVxuXHRcdFx0XHQpO1xuXHRcdFx0fVxuXHRcdFx0bWF0Y2hlcnMucHVzaCggbWF0Y2hlciApO1xuXHRcdH1cblx0fVxuXG5cdHJldHVybiBlbGVtZW50TWF0Y2hlciggbWF0Y2hlcnMgKTtcbn1cblxuZnVuY3Rpb24gbWF0Y2hlckZyb21Hcm91cE1hdGNoZXJzKCBlbGVtZW50TWF0Y2hlcnMsIHNldE1hdGNoZXJzICkge1xuXHR2YXIgYnlTZXQgPSBzZXRNYXRjaGVycy5sZW5ndGggPiAwLFxuXHRcdGJ5RWxlbWVudCA9IGVsZW1lbnRNYXRjaGVycy5sZW5ndGggPiAwLFxuXHRcdHN1cGVyTWF0Y2hlciA9IGZ1bmN0aW9uKCBzZWVkLCBjb250ZXh0LCB4bWwsIHJlc3VsdHMsIG91dGVybW9zdCApIHtcblx0XHRcdHZhciBlbGVtLCBqLCBtYXRjaGVyLFxuXHRcdFx0XHRtYXRjaGVkQ291bnQgPSAwLFxuXHRcdFx0XHRpID0gXCIwXCIsXG5cdFx0XHRcdHVubWF0Y2hlZCA9IHNlZWQgJiYgW10sXG5cdFx0XHRcdHNldE1hdGNoZWQgPSBbXSxcblx0XHRcdFx0Y29udGV4dEJhY2t1cCA9IG91dGVybW9zdENvbnRleHQsXG5cdFx0XHRcdC8vIFdlIG11c3QgYWx3YXlzIGhhdmUgZWl0aGVyIHNlZWQgZWxlbWVudHMgb3Igb3V0ZXJtb3N0IGNvbnRleHRcblx0XHRcdFx0ZWxlbXMgPSBzZWVkIHx8IGJ5RWxlbWVudCAmJiBFeHByLmZpbmRbXCJUQUdcIl0oIFwiKlwiLCBvdXRlcm1vc3QgKSxcblx0XHRcdFx0Ly8gVXNlIGludGVnZXIgZGlycnVucyBpZmYgdGhpcyBpcyB0aGUgb3V0ZXJtb3N0IG1hdGNoZXJcblx0XHRcdFx0ZGlycnVuc1VuaXF1ZSA9IChkaXJydW5zICs9IGNvbnRleHRCYWNrdXAgPT0gbnVsbCA/IDEgOiBNYXRoLnJhbmRvbSgpIHx8IDAuMSksXG5cdFx0XHRcdGxlbiA9IGVsZW1zLmxlbmd0aDtcblxuXHRcdFx0aWYgKCBvdXRlcm1vc3QgKSB7XG5cdFx0XHRcdG91dGVybW9zdENvbnRleHQgPSBjb250ZXh0ICE9PSBkb2N1bWVudCAmJiBjb250ZXh0O1xuXHRcdFx0fVxuXG5cdFx0XHQvLyBBZGQgZWxlbWVudHMgcGFzc2luZyBlbGVtZW50TWF0Y2hlcnMgZGlyZWN0bHkgdG8gcmVzdWx0c1xuXHRcdFx0Ly8gS2VlcCBgaWAgYSBzdHJpbmcgaWYgdGhlcmUgYXJlIG5vIGVsZW1lbnRzIHNvIGBtYXRjaGVkQ291bnRgIHdpbGwgYmUgXCIwMFwiIGJlbG93XG5cdFx0XHQvLyBTdXBwb3J0OiBJRTw5LCBTYWZhcmlcblx0XHRcdC8vIFRvbGVyYXRlIE5vZGVMaXN0IHByb3BlcnRpZXMgKElFOiBcImxlbmd0aFwiOyBTYWZhcmk6IDxudW1iZXI+KSBtYXRjaGluZyBlbGVtZW50cyBieSBpZFxuXHRcdFx0Zm9yICggOyBpICE9PSBsZW4gJiYgKGVsZW0gPSBlbGVtc1tpXSkgIT0gbnVsbDsgaSsrICkge1xuXHRcdFx0XHRpZiAoIGJ5RWxlbWVudCAmJiBlbGVtICkge1xuXHRcdFx0XHRcdGogPSAwO1xuXHRcdFx0XHRcdHdoaWxlICggKG1hdGNoZXIgPSBlbGVtZW50TWF0Y2hlcnNbaisrXSkgKSB7XG5cdFx0XHRcdFx0XHRpZiAoIG1hdGNoZXIoIGVsZW0sIGNvbnRleHQsIHhtbCApICkge1xuXHRcdFx0XHRcdFx0XHRyZXN1bHRzLnB1c2goIGVsZW0gKTtcblx0XHRcdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdGlmICggb3V0ZXJtb3N0ICkge1xuXHRcdFx0XHRcdFx0ZGlycnVucyA9IGRpcnJ1bnNVbmlxdWU7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cblx0XHRcdFx0Ly8gVHJhY2sgdW5tYXRjaGVkIGVsZW1lbnRzIGZvciBzZXQgZmlsdGVyc1xuXHRcdFx0XHRpZiAoIGJ5U2V0ICkge1xuXHRcdFx0XHRcdC8vIFRoZXkgd2lsbCBoYXZlIGdvbmUgdGhyb3VnaCBhbGwgcG9zc2libGUgbWF0Y2hlcnNcblx0XHRcdFx0XHRpZiAoIChlbGVtID0gIW1hdGNoZXIgJiYgZWxlbSkgKSB7XG5cdFx0XHRcdFx0XHRtYXRjaGVkQ291bnQtLTtcblx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHQvLyBMZW5ndGhlbiB0aGUgYXJyYXkgZm9yIGV2ZXJ5IGVsZW1lbnQsIG1hdGNoZWQgb3Igbm90XG5cdFx0XHRcdFx0aWYgKCBzZWVkICkge1xuXHRcdFx0XHRcdFx0dW5tYXRjaGVkLnB1c2goIGVsZW0gKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdH1cblxuXHRcdFx0Ly8gQXBwbHkgc2V0IGZpbHRlcnMgdG8gdW5tYXRjaGVkIGVsZW1lbnRzXG5cdFx0XHRtYXRjaGVkQ291bnQgKz0gaTtcblx0XHRcdGlmICggYnlTZXQgJiYgaSAhPT0gbWF0Y2hlZENvdW50ICkge1xuXHRcdFx0XHRqID0gMDtcblx0XHRcdFx0d2hpbGUgKCAobWF0Y2hlciA9IHNldE1hdGNoZXJzW2orK10pICkge1xuXHRcdFx0XHRcdG1hdGNoZXIoIHVubWF0Y2hlZCwgc2V0TWF0Y2hlZCwgY29udGV4dCwgeG1sICk7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHRpZiAoIHNlZWQgKSB7XG5cdFx0XHRcdFx0Ly8gUmVpbnRlZ3JhdGUgZWxlbWVudCBtYXRjaGVzIHRvIGVsaW1pbmF0ZSB0aGUgbmVlZCBmb3Igc29ydGluZ1xuXHRcdFx0XHRcdGlmICggbWF0Y2hlZENvdW50ID4gMCApIHtcblx0XHRcdFx0XHRcdHdoaWxlICggaS0tICkge1xuXHRcdFx0XHRcdFx0XHRpZiAoICEodW5tYXRjaGVkW2ldIHx8IHNldE1hdGNoZWRbaV0pICkge1xuXHRcdFx0XHRcdFx0XHRcdHNldE1hdGNoZWRbaV0gPSBwb3AuY2FsbCggcmVzdWx0cyApO1xuXHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0Ly8gRGlzY2FyZCBpbmRleCBwbGFjZWhvbGRlciB2YWx1ZXMgdG8gZ2V0IG9ubHkgYWN0dWFsIG1hdGNoZXNcblx0XHRcdFx0XHRzZXRNYXRjaGVkID0gY29uZGVuc2UoIHNldE1hdGNoZWQgKTtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdC8vIEFkZCBtYXRjaGVzIHRvIHJlc3VsdHNcblx0XHRcdFx0cHVzaC5hcHBseSggcmVzdWx0cywgc2V0TWF0Y2hlZCApO1xuXG5cdFx0XHRcdC8vIFNlZWRsZXNzIHNldCBtYXRjaGVzIHN1Y2NlZWRpbmcgbXVsdGlwbGUgc3VjY2Vzc2Z1bCBtYXRjaGVycyBzdGlwdWxhdGUgc29ydGluZ1xuXHRcdFx0XHRpZiAoIG91dGVybW9zdCAmJiAhc2VlZCAmJiBzZXRNYXRjaGVkLmxlbmd0aCA+IDAgJiZcblx0XHRcdFx0XHQoIG1hdGNoZWRDb3VudCArIHNldE1hdGNoZXJzLmxlbmd0aCApID4gMSApIHtcblxuXHRcdFx0XHRcdFNpenpsZS51bmlxdWVTb3J0KCByZXN1bHRzICk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblxuXHRcdFx0Ly8gT3ZlcnJpZGUgbWFuaXB1bGF0aW9uIG9mIGdsb2JhbHMgYnkgbmVzdGVkIG1hdGNoZXJzXG5cdFx0XHRpZiAoIG91dGVybW9zdCApIHtcblx0XHRcdFx0ZGlycnVucyA9IGRpcnJ1bnNVbmlxdWU7XG5cdFx0XHRcdG91dGVybW9zdENvbnRleHQgPSBjb250ZXh0QmFja3VwO1xuXHRcdFx0fVxuXG5cdFx0XHRyZXR1cm4gdW5tYXRjaGVkO1xuXHRcdH07XG5cblx0cmV0dXJuIGJ5U2V0ID9cblx0XHRtYXJrRnVuY3Rpb24oIHN1cGVyTWF0Y2hlciApIDpcblx0XHRzdXBlck1hdGNoZXI7XG59XG5cbmNvbXBpbGUgPSBTaXp6bGUuY29tcGlsZSA9IGZ1bmN0aW9uKCBzZWxlY3RvciwgbWF0Y2ggLyogSW50ZXJuYWwgVXNlIE9ubHkgKi8gKSB7XG5cdHZhciBpLFxuXHRcdHNldE1hdGNoZXJzID0gW10sXG5cdFx0ZWxlbWVudE1hdGNoZXJzID0gW10sXG5cdFx0Y2FjaGVkID0gY29tcGlsZXJDYWNoZVsgc2VsZWN0b3IgKyBcIiBcIiBdO1xuXG5cdGlmICggIWNhY2hlZCApIHtcblx0XHQvLyBHZW5lcmF0ZSBhIGZ1bmN0aW9uIG9mIHJlY3Vyc2l2ZSBmdW5jdGlvbnMgdGhhdCBjYW4gYmUgdXNlZCB0byBjaGVjayBlYWNoIGVsZW1lbnRcblx0XHRpZiAoICFtYXRjaCApIHtcblx0XHRcdG1hdGNoID0gdG9rZW5pemUoIHNlbGVjdG9yICk7XG5cdFx0fVxuXHRcdGkgPSBtYXRjaC5sZW5ndGg7XG5cdFx0d2hpbGUgKCBpLS0gKSB7XG5cdFx0XHRjYWNoZWQgPSBtYXRjaGVyRnJvbVRva2VucyggbWF0Y2hbaV0gKTtcblx0XHRcdGlmICggY2FjaGVkWyBleHBhbmRvIF0gKSB7XG5cdFx0XHRcdHNldE1hdGNoZXJzLnB1c2goIGNhY2hlZCApO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0ZWxlbWVudE1hdGNoZXJzLnB1c2goIGNhY2hlZCApO1xuXHRcdFx0fVxuXHRcdH1cblxuXHRcdC8vIENhY2hlIHRoZSBjb21waWxlZCBmdW5jdGlvblxuXHRcdGNhY2hlZCA9IGNvbXBpbGVyQ2FjaGUoIHNlbGVjdG9yLCBtYXRjaGVyRnJvbUdyb3VwTWF0Y2hlcnMoIGVsZW1lbnRNYXRjaGVycywgc2V0TWF0Y2hlcnMgKSApO1xuXG5cdFx0Ly8gU2F2ZSBzZWxlY3RvciBhbmQgdG9rZW5pemF0aW9uXG5cdFx0Y2FjaGVkLnNlbGVjdG9yID0gc2VsZWN0b3I7XG5cdH1cblx0cmV0dXJuIGNhY2hlZDtcbn07XG5cbi8qKlxuICogQSBsb3ctbGV2ZWwgc2VsZWN0aW9uIGZ1bmN0aW9uIHRoYXQgd29ya3Mgd2l0aCBTaXp6bGUncyBjb21waWxlZFxuICogIHNlbGVjdG9yIGZ1bmN0aW9uc1xuICogQHBhcmFtIHtTdHJpbmd8RnVuY3Rpb259IHNlbGVjdG9yIEEgc2VsZWN0b3Igb3IgYSBwcmUtY29tcGlsZWRcbiAqICBzZWxlY3RvciBmdW5jdGlvbiBidWlsdCB3aXRoIFNpenpsZS5jb21waWxlXG4gKiBAcGFyYW0ge0VsZW1lbnR9IGNvbnRleHRcbiAqIEBwYXJhbSB7QXJyYXl9IFtyZXN1bHRzXVxuICogQHBhcmFtIHtBcnJheX0gW3NlZWRdIEEgc2V0IG9mIGVsZW1lbnRzIHRvIG1hdGNoIGFnYWluc3RcbiAqL1xuc2VsZWN0ID0gU2l6emxlLnNlbGVjdCA9IGZ1bmN0aW9uKCBzZWxlY3RvciwgY29udGV4dCwgcmVzdWx0cywgc2VlZCApIHtcblx0dmFyIGksIHRva2VucywgdG9rZW4sIHR5cGUsIGZpbmQsXG5cdFx0Y29tcGlsZWQgPSB0eXBlb2Ygc2VsZWN0b3IgPT09IFwiZnVuY3Rpb25cIiAmJiBzZWxlY3Rvcixcblx0XHRtYXRjaCA9ICFzZWVkICYmIHRva2VuaXplKCAoc2VsZWN0b3IgPSBjb21waWxlZC5zZWxlY3RvciB8fCBzZWxlY3RvcikgKTtcblxuXHRyZXN1bHRzID0gcmVzdWx0cyB8fCBbXTtcblxuXHQvLyBUcnkgdG8gbWluaW1pemUgb3BlcmF0aW9ucyBpZiB0aGVyZSBpcyBubyBzZWVkIGFuZCBvbmx5IG9uZSBncm91cFxuXHRpZiAoIG1hdGNoLmxlbmd0aCA9PT0gMSApIHtcblxuXHRcdC8vIFRha2UgYSBzaG9ydGN1dCBhbmQgc2V0IHRoZSBjb250ZXh0IGlmIHRoZSByb290IHNlbGVjdG9yIGlzIGFuIElEXG5cdFx0dG9rZW5zID0gbWF0Y2hbMF0gPSBtYXRjaFswXS5zbGljZSggMCApO1xuXHRcdGlmICggdG9rZW5zLmxlbmd0aCA+IDIgJiYgKHRva2VuID0gdG9rZW5zWzBdKS50eXBlID09PSBcIklEXCIgJiZcblx0XHRcdFx0c3VwcG9ydC5nZXRCeUlkICYmIGNvbnRleHQubm9kZVR5cGUgPT09IDkgJiYgZG9jdW1lbnRJc0hUTUwgJiZcblx0XHRcdFx0RXhwci5yZWxhdGl2ZVsgdG9rZW5zWzFdLnR5cGUgXSApIHtcblxuXHRcdFx0Y29udGV4dCA9ICggRXhwci5maW5kW1wiSURcIl0oIHRva2VuLm1hdGNoZXNbMF0ucmVwbGFjZShydW5lc2NhcGUsIGZ1bmVzY2FwZSksIGNvbnRleHQgKSB8fCBbXSApWzBdO1xuXHRcdFx0aWYgKCAhY29udGV4dCApIHtcblx0XHRcdFx0cmV0dXJuIHJlc3VsdHM7XG5cblx0XHRcdC8vIFByZWNvbXBpbGVkIG1hdGNoZXJzIHdpbGwgc3RpbGwgdmVyaWZ5IGFuY2VzdHJ5LCBzbyBzdGVwIHVwIGEgbGV2ZWxcblx0XHRcdH0gZWxzZSBpZiAoIGNvbXBpbGVkICkge1xuXHRcdFx0XHRjb250ZXh0ID0gY29udGV4dC5wYXJlbnROb2RlO1xuXHRcdFx0fVxuXG5cdFx0XHRzZWxlY3RvciA9IHNlbGVjdG9yLnNsaWNlKCB0b2tlbnMuc2hpZnQoKS52YWx1ZS5sZW5ndGggKTtcblx0XHR9XG5cblx0XHQvLyBGZXRjaCBhIHNlZWQgc2V0IGZvciByaWdodC10by1sZWZ0IG1hdGNoaW5nXG5cdFx0aSA9IG1hdGNoRXhwcltcIm5lZWRzQ29udGV4dFwiXS50ZXN0KCBzZWxlY3RvciApID8gMCA6IHRva2Vucy5sZW5ndGg7XG5cdFx0d2hpbGUgKCBpLS0gKSB7XG5cdFx0XHR0b2tlbiA9IHRva2Vuc1tpXTtcblxuXHRcdFx0Ly8gQWJvcnQgaWYgd2UgaGl0IGEgY29tYmluYXRvclxuXHRcdFx0aWYgKCBFeHByLnJlbGF0aXZlWyAodHlwZSA9IHRva2VuLnR5cGUpIF0gKSB7XG5cdFx0XHRcdGJyZWFrO1xuXHRcdFx0fVxuXHRcdFx0aWYgKCAoZmluZCA9IEV4cHIuZmluZFsgdHlwZSBdKSApIHtcblx0XHRcdFx0Ly8gU2VhcmNoLCBleHBhbmRpbmcgY29udGV4dCBmb3IgbGVhZGluZyBzaWJsaW5nIGNvbWJpbmF0b3JzXG5cdFx0XHRcdGlmICggKHNlZWQgPSBmaW5kKFxuXHRcdFx0XHRcdHRva2VuLm1hdGNoZXNbMF0ucmVwbGFjZSggcnVuZXNjYXBlLCBmdW5lc2NhcGUgKSxcblx0XHRcdFx0XHRyc2libGluZy50ZXN0KCB0b2tlbnNbMF0udHlwZSApICYmIHRlc3RDb250ZXh0KCBjb250ZXh0LnBhcmVudE5vZGUgKSB8fCBjb250ZXh0XG5cdFx0XHRcdCkpICkge1xuXG5cdFx0XHRcdFx0Ly8gSWYgc2VlZCBpcyBlbXB0eSBvciBubyB0b2tlbnMgcmVtYWluLCB3ZSBjYW4gcmV0dXJuIGVhcmx5XG5cdFx0XHRcdFx0dG9rZW5zLnNwbGljZSggaSwgMSApO1xuXHRcdFx0XHRcdHNlbGVjdG9yID0gc2VlZC5sZW5ndGggJiYgdG9TZWxlY3RvciggdG9rZW5zICk7XG5cdFx0XHRcdFx0aWYgKCAhc2VsZWN0b3IgKSB7XG5cdFx0XHRcdFx0XHRwdXNoLmFwcGx5KCByZXN1bHRzLCBzZWVkICk7XG5cdFx0XHRcdFx0XHRyZXR1cm4gcmVzdWx0cztcblx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH1cblx0fVxuXG5cdC8vIENvbXBpbGUgYW5kIGV4ZWN1dGUgYSBmaWx0ZXJpbmcgZnVuY3Rpb24gaWYgb25lIGlzIG5vdCBwcm92aWRlZFxuXHQvLyBQcm92aWRlIGBtYXRjaGAgdG8gYXZvaWQgcmV0b2tlbml6YXRpb24gaWYgd2UgbW9kaWZpZWQgdGhlIHNlbGVjdG9yIGFib3ZlXG5cdCggY29tcGlsZWQgfHwgY29tcGlsZSggc2VsZWN0b3IsIG1hdGNoICkgKShcblx0XHRzZWVkLFxuXHRcdGNvbnRleHQsXG5cdFx0IWRvY3VtZW50SXNIVE1MLFxuXHRcdHJlc3VsdHMsXG5cdFx0cnNpYmxpbmcudGVzdCggc2VsZWN0b3IgKSAmJiB0ZXN0Q29udGV4dCggY29udGV4dC5wYXJlbnROb2RlICkgfHwgY29udGV4dFxuXHQpO1xuXHRyZXR1cm4gcmVzdWx0cztcbn07XG5cbi8vIE9uZS10aW1lIGFzc2lnbm1lbnRzXG5cbi8vIFNvcnQgc3RhYmlsaXR5XG5zdXBwb3J0LnNvcnRTdGFibGUgPSBleHBhbmRvLnNwbGl0KFwiXCIpLnNvcnQoIHNvcnRPcmRlciApLmpvaW4oXCJcIikgPT09IGV4cGFuZG87XG5cbi8vIFN1cHBvcnQ6IENocm9tZSAxNC0zNStcbi8vIEFsd2F5cyBhc3N1bWUgZHVwbGljYXRlcyBpZiB0aGV5IGFyZW4ndCBwYXNzZWQgdG8gdGhlIGNvbXBhcmlzb24gZnVuY3Rpb25cbnN1cHBvcnQuZGV0ZWN0RHVwbGljYXRlcyA9ICEhaGFzRHVwbGljYXRlO1xuXG4vLyBJbml0aWFsaXplIGFnYWluc3QgdGhlIGRlZmF1bHQgZG9jdW1lbnRcbnNldERvY3VtZW50KCk7XG5cbi8vIFN1cHBvcnQ6IFdlYmtpdDw1MzcuMzIgLSBTYWZhcmkgNi4wLjMvQ2hyb21lIDI1IChmaXhlZCBpbiBDaHJvbWUgMjcpXG4vLyBEZXRhY2hlZCBub2RlcyBjb25mb3VuZGluZ2x5IGZvbGxvdyAqZWFjaCBvdGhlcipcbnN1cHBvcnQuc29ydERldGFjaGVkID0gYXNzZXJ0KGZ1bmN0aW9uKCBkaXYxICkge1xuXHQvLyBTaG91bGQgcmV0dXJuIDEsIGJ1dCByZXR1cm5zIDQgKGZvbGxvd2luZylcblx0cmV0dXJuIGRpdjEuY29tcGFyZURvY3VtZW50UG9zaXRpb24oIGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIikgKSAmIDE7XG59KTtcblxuLy8gU3VwcG9ydDogSUU8OFxuLy8gUHJldmVudCBhdHRyaWJ1dGUvcHJvcGVydHkgXCJpbnRlcnBvbGF0aW9uXCJcbi8vIGh0dHA6Ly9tc2RuLm1pY3Jvc29mdC5jb20vZW4tdXMvbGlicmFyeS9tczUzNjQyOSUyOFZTLjg1JTI5LmFzcHhcbmlmICggIWFzc2VydChmdW5jdGlvbiggZGl2ICkge1xuXHRkaXYuaW5uZXJIVE1MID0gXCI8YSBocmVmPScjJz48L2E+XCI7XG5cdHJldHVybiBkaXYuZmlyc3RDaGlsZC5nZXRBdHRyaWJ1dGUoXCJocmVmXCIpID09PSBcIiNcIiA7XG59KSApIHtcblx0YWRkSGFuZGxlKCBcInR5cGV8aHJlZnxoZWlnaHR8d2lkdGhcIiwgZnVuY3Rpb24oIGVsZW0sIG5hbWUsIGlzWE1MICkge1xuXHRcdGlmICggIWlzWE1MICkge1xuXHRcdFx0cmV0dXJuIGVsZW0uZ2V0QXR0cmlidXRlKCBuYW1lLCBuYW1lLnRvTG93ZXJDYXNlKCkgPT09IFwidHlwZVwiID8gMSA6IDIgKTtcblx0XHR9XG5cdH0pO1xufVxuXG4vLyBTdXBwb3J0OiBJRTw5XG4vLyBVc2UgZGVmYXVsdFZhbHVlIGluIHBsYWNlIG9mIGdldEF0dHJpYnV0ZShcInZhbHVlXCIpXG5pZiAoICFzdXBwb3J0LmF0dHJpYnV0ZXMgfHwgIWFzc2VydChmdW5jdGlvbiggZGl2ICkge1xuXHRkaXYuaW5uZXJIVE1MID0gXCI8aW5wdXQvPlwiO1xuXHRkaXYuZmlyc3RDaGlsZC5zZXRBdHRyaWJ1dGUoIFwidmFsdWVcIiwgXCJcIiApO1xuXHRyZXR1cm4gZGl2LmZpcnN0Q2hpbGQuZ2V0QXR0cmlidXRlKCBcInZhbHVlXCIgKSA9PT0gXCJcIjtcbn0pICkge1xuXHRhZGRIYW5kbGUoIFwidmFsdWVcIiwgZnVuY3Rpb24oIGVsZW0sIG5hbWUsIGlzWE1MICkge1xuXHRcdGlmICggIWlzWE1MICYmIGVsZW0ubm9kZU5hbWUudG9Mb3dlckNhc2UoKSA9PT0gXCJpbnB1dFwiICkge1xuXHRcdFx0cmV0dXJuIGVsZW0uZGVmYXVsdFZhbHVlO1xuXHRcdH1cblx0fSk7XG59XG5cbi8vIFN1cHBvcnQ6IElFPDlcbi8vIFVzZSBnZXRBdHRyaWJ1dGVOb2RlIHRvIGZldGNoIGJvb2xlYW5zIHdoZW4gZ2V0QXR0cmlidXRlIGxpZXNcbmlmICggIWFzc2VydChmdW5jdGlvbiggZGl2ICkge1xuXHRyZXR1cm4gZGl2LmdldEF0dHJpYnV0ZShcImRpc2FibGVkXCIpID09IG51bGw7XG59KSApIHtcblx0YWRkSGFuZGxlKCBib29sZWFucywgZnVuY3Rpb24oIGVsZW0sIG5hbWUsIGlzWE1MICkge1xuXHRcdHZhciB2YWw7XG5cdFx0aWYgKCAhaXNYTUwgKSB7XG5cdFx0XHRyZXR1cm4gZWxlbVsgbmFtZSBdID09PSB0cnVlID8gbmFtZS50b0xvd2VyQ2FzZSgpIDpcblx0XHRcdFx0XHQodmFsID0gZWxlbS5nZXRBdHRyaWJ1dGVOb2RlKCBuYW1lICkpICYmIHZhbC5zcGVjaWZpZWQgP1xuXHRcdFx0XHRcdHZhbC52YWx1ZSA6XG5cdFx0XHRcdG51bGw7XG5cdFx0fVxuXHR9KTtcbn1cblxucmV0dXJuIFNpenpsZTtcblxufSkoIHdpbmRvdyApO1xuXG5cblxualF1ZXJ5LmZpbmQgPSBTaXp6bGU7XG5qUXVlcnkuZXhwciA9IFNpenpsZS5zZWxlY3RvcnM7XG5qUXVlcnkuZXhwcltcIjpcIl0gPSBqUXVlcnkuZXhwci5wc2V1ZG9zO1xualF1ZXJ5LnVuaXF1ZSA9IFNpenpsZS51bmlxdWVTb3J0O1xualF1ZXJ5LnRleHQgPSBTaXp6bGUuZ2V0VGV4dDtcbmpRdWVyeS5pc1hNTERvYyA9IFNpenpsZS5pc1hNTDtcbmpRdWVyeS5jb250YWlucyA9IFNpenpsZS5jb250YWlucztcblxuXG5cbnZhciBybmVlZHNDb250ZXh0ID0galF1ZXJ5LmV4cHIubWF0Y2gubmVlZHNDb250ZXh0O1xuXG52YXIgcnNpbmdsZVRhZyA9ICgvXjwoXFx3KylcXHMqXFwvPz4oPzo8XFwvXFwxPnwpJC8pO1xuXG5cblxudmFyIHJpc1NpbXBsZSA9IC9eLlteOiNcXFtcXC4sXSokLztcblxuLy8gSW1wbGVtZW50IHRoZSBpZGVudGljYWwgZnVuY3Rpb25hbGl0eSBmb3IgZmlsdGVyIGFuZCBub3RcbmZ1bmN0aW9uIHdpbm5vdyggZWxlbWVudHMsIHF1YWxpZmllciwgbm90ICkge1xuXHRpZiAoIGpRdWVyeS5pc0Z1bmN0aW9uKCBxdWFsaWZpZXIgKSApIHtcblx0XHRyZXR1cm4galF1ZXJ5LmdyZXAoIGVsZW1lbnRzLCBmdW5jdGlvbiggZWxlbSwgaSApIHtcblx0XHRcdC8qIGpzaGludCAtVzAxOCAqL1xuXHRcdFx0cmV0dXJuICEhcXVhbGlmaWVyLmNhbGwoIGVsZW0sIGksIGVsZW0gKSAhPT0gbm90O1xuXHRcdH0pO1xuXG5cdH1cblxuXHRpZiAoIHF1YWxpZmllci5ub2RlVHlwZSApIHtcblx0XHRyZXR1cm4galF1ZXJ5LmdyZXAoIGVsZW1lbnRzLCBmdW5jdGlvbiggZWxlbSApIHtcblx0XHRcdHJldHVybiAoIGVsZW0gPT09IHF1YWxpZmllciApICE9PSBub3Q7XG5cdFx0fSk7XG5cblx0fVxuXG5cdGlmICggdHlwZW9mIHF1YWxpZmllciA9PT0gXCJzdHJpbmdcIiApIHtcblx0XHRpZiAoIHJpc1NpbXBsZS50ZXN0KCBxdWFsaWZpZXIgKSApIHtcblx0XHRcdHJldHVybiBqUXVlcnkuZmlsdGVyKCBxdWFsaWZpZXIsIGVsZW1lbnRzLCBub3QgKTtcblx0XHR9XG5cblx0XHRxdWFsaWZpZXIgPSBqUXVlcnkuZmlsdGVyKCBxdWFsaWZpZXIsIGVsZW1lbnRzICk7XG5cdH1cblxuXHRyZXR1cm4galF1ZXJ5LmdyZXAoIGVsZW1lbnRzLCBmdW5jdGlvbiggZWxlbSApIHtcblx0XHRyZXR1cm4gKCBpbmRleE9mLmNhbGwoIHF1YWxpZmllciwgZWxlbSApID49IDAgKSAhPT0gbm90O1xuXHR9KTtcbn1cblxualF1ZXJ5LmZpbHRlciA9IGZ1bmN0aW9uKCBleHByLCBlbGVtcywgbm90ICkge1xuXHR2YXIgZWxlbSA9IGVsZW1zWyAwIF07XG5cblx0aWYgKCBub3QgKSB7XG5cdFx0ZXhwciA9IFwiOm5vdChcIiArIGV4cHIgKyBcIilcIjtcblx0fVxuXG5cdHJldHVybiBlbGVtcy5sZW5ndGggPT09IDEgJiYgZWxlbS5ub2RlVHlwZSA9PT0gMSA/XG5cdFx0alF1ZXJ5LmZpbmQubWF0Y2hlc1NlbGVjdG9yKCBlbGVtLCBleHByICkgPyBbIGVsZW0gXSA6IFtdIDpcblx0XHRqUXVlcnkuZmluZC5tYXRjaGVzKCBleHByLCBqUXVlcnkuZ3JlcCggZWxlbXMsIGZ1bmN0aW9uKCBlbGVtICkge1xuXHRcdFx0cmV0dXJuIGVsZW0ubm9kZVR5cGUgPT09IDE7XG5cdFx0fSkpO1xufTtcblxualF1ZXJ5LmZuLmV4dGVuZCh7XG5cdGZpbmQ6IGZ1bmN0aW9uKCBzZWxlY3RvciApIHtcblx0XHR2YXIgaSxcblx0XHRcdGxlbiA9IHRoaXMubGVuZ3RoLFxuXHRcdFx0cmV0ID0gW10sXG5cdFx0XHRzZWxmID0gdGhpcztcblxuXHRcdGlmICggdHlwZW9mIHNlbGVjdG9yICE9PSBcInN0cmluZ1wiICkge1xuXHRcdFx0cmV0dXJuIHRoaXMucHVzaFN0YWNrKCBqUXVlcnkoIHNlbGVjdG9yICkuZmlsdGVyKGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRmb3IgKCBpID0gMDsgaSA8IGxlbjsgaSsrICkge1xuXHRcdFx0XHRcdGlmICggalF1ZXJ5LmNvbnRhaW5zKCBzZWxmWyBpIF0sIHRoaXMgKSApIHtcblx0XHRcdFx0XHRcdHJldHVybiB0cnVlO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0fSkgKTtcblx0XHR9XG5cblx0XHRmb3IgKCBpID0gMDsgaSA8IGxlbjsgaSsrICkge1xuXHRcdFx0alF1ZXJ5LmZpbmQoIHNlbGVjdG9yLCBzZWxmWyBpIF0sIHJldCApO1xuXHRcdH1cblxuXHRcdC8vIE5lZWRlZCBiZWNhdXNlICQoIHNlbGVjdG9yLCBjb250ZXh0ICkgYmVjb21lcyAkKCBjb250ZXh0ICkuZmluZCggc2VsZWN0b3IgKVxuXHRcdHJldCA9IHRoaXMucHVzaFN0YWNrKCBsZW4gPiAxID8galF1ZXJ5LnVuaXF1ZSggcmV0ICkgOiByZXQgKTtcblx0XHRyZXQuc2VsZWN0b3IgPSB0aGlzLnNlbGVjdG9yID8gdGhpcy5zZWxlY3RvciArIFwiIFwiICsgc2VsZWN0b3IgOiBzZWxlY3Rvcjtcblx0XHRyZXR1cm4gcmV0O1xuXHR9LFxuXHRmaWx0ZXI6IGZ1bmN0aW9uKCBzZWxlY3RvciApIHtcblx0XHRyZXR1cm4gdGhpcy5wdXNoU3RhY2soIHdpbm5vdyh0aGlzLCBzZWxlY3RvciB8fCBbXSwgZmFsc2UpICk7XG5cdH0sXG5cdG5vdDogZnVuY3Rpb24oIHNlbGVjdG9yICkge1xuXHRcdHJldHVybiB0aGlzLnB1c2hTdGFjayggd2lubm93KHRoaXMsIHNlbGVjdG9yIHx8IFtdLCB0cnVlKSApO1xuXHR9LFxuXHRpczogZnVuY3Rpb24oIHNlbGVjdG9yICkge1xuXHRcdHJldHVybiAhIXdpbm5vdyhcblx0XHRcdHRoaXMsXG5cblx0XHRcdC8vIElmIHRoaXMgaXMgYSBwb3NpdGlvbmFsL3JlbGF0aXZlIHNlbGVjdG9yLCBjaGVjayBtZW1iZXJzaGlwIGluIHRoZSByZXR1cm5lZCBzZXRcblx0XHRcdC8vIHNvICQoXCJwOmZpcnN0XCIpLmlzKFwicDpsYXN0XCIpIHdvbid0IHJldHVybiB0cnVlIGZvciBhIGRvYyB3aXRoIHR3byBcInBcIi5cblx0XHRcdHR5cGVvZiBzZWxlY3RvciA9PT0gXCJzdHJpbmdcIiAmJiBybmVlZHNDb250ZXh0LnRlc3QoIHNlbGVjdG9yICkgP1xuXHRcdFx0XHRqUXVlcnkoIHNlbGVjdG9yICkgOlxuXHRcdFx0XHRzZWxlY3RvciB8fCBbXSxcblx0XHRcdGZhbHNlXG5cdFx0KS5sZW5ndGg7XG5cdH1cbn0pO1xuXG5cbi8vIEluaXRpYWxpemUgYSBqUXVlcnkgb2JqZWN0XG5cblxuLy8gQSBjZW50cmFsIHJlZmVyZW5jZSB0byB0aGUgcm9vdCBqUXVlcnkoZG9jdW1lbnQpXG52YXIgcm9vdGpRdWVyeSxcblxuXHQvLyBBIHNpbXBsZSB3YXkgdG8gY2hlY2sgZm9yIEhUTUwgc3RyaW5nc1xuXHQvLyBQcmlvcml0aXplICNpZCBvdmVyIDx0YWc+IHRvIGF2b2lkIFhTUyB2aWEgbG9jYXRpb24uaGFzaCAoIzk1MjEpXG5cdC8vIFN0cmljdCBIVE1MIHJlY29nbml0aW9uICgjMTEyOTA6IG11c3Qgc3RhcnQgd2l0aCA8KVxuXHRycXVpY2tFeHByID0gL14oPzpcXHMqKDxbXFx3XFxXXSs+KVtePl0qfCMoW1xcdy1dKikpJC8sXG5cblx0aW5pdCA9IGpRdWVyeS5mbi5pbml0ID0gZnVuY3Rpb24oIHNlbGVjdG9yLCBjb250ZXh0ICkge1xuXHRcdHZhciBtYXRjaCwgZWxlbTtcblxuXHRcdC8vIEhBTkRMRTogJChcIlwiKSwgJChudWxsKSwgJCh1bmRlZmluZWQpLCAkKGZhbHNlKVxuXHRcdGlmICggIXNlbGVjdG9yICkge1xuXHRcdFx0cmV0dXJuIHRoaXM7XG5cdFx0fVxuXG5cdFx0Ly8gSGFuZGxlIEhUTUwgc3RyaW5nc1xuXHRcdGlmICggdHlwZW9mIHNlbGVjdG9yID09PSBcInN0cmluZ1wiICkge1xuXHRcdFx0aWYgKCBzZWxlY3RvclswXSA9PT0gXCI8XCIgJiYgc2VsZWN0b3JbIHNlbGVjdG9yLmxlbmd0aCAtIDEgXSA9PT0gXCI+XCIgJiYgc2VsZWN0b3IubGVuZ3RoID49IDMgKSB7XG5cdFx0XHRcdC8vIEFzc3VtZSB0aGF0IHN0cmluZ3MgdGhhdCBzdGFydCBhbmQgZW5kIHdpdGggPD4gYXJlIEhUTUwgYW5kIHNraXAgdGhlIHJlZ2V4IGNoZWNrXG5cdFx0XHRcdG1hdGNoID0gWyBudWxsLCBzZWxlY3RvciwgbnVsbCBdO1xuXG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRtYXRjaCA9IHJxdWlja0V4cHIuZXhlYyggc2VsZWN0b3IgKTtcblx0XHRcdH1cblxuXHRcdFx0Ly8gTWF0Y2ggaHRtbCBvciBtYWtlIHN1cmUgbm8gY29udGV4dCBpcyBzcGVjaWZpZWQgZm9yICNpZFxuXHRcdFx0aWYgKCBtYXRjaCAmJiAobWF0Y2hbMV0gfHwgIWNvbnRleHQpICkge1xuXG5cdFx0XHRcdC8vIEhBTkRMRTogJChodG1sKSAtPiAkKGFycmF5KVxuXHRcdFx0XHRpZiAoIG1hdGNoWzFdICkge1xuXHRcdFx0XHRcdGNvbnRleHQgPSBjb250ZXh0IGluc3RhbmNlb2YgalF1ZXJ5ID8gY29udGV4dFswXSA6IGNvbnRleHQ7XG5cblx0XHRcdFx0XHQvLyBPcHRpb24gdG8gcnVuIHNjcmlwdHMgaXMgdHJ1ZSBmb3IgYmFjay1jb21wYXRcblx0XHRcdFx0XHQvLyBJbnRlbnRpb25hbGx5IGxldCB0aGUgZXJyb3IgYmUgdGhyb3duIGlmIHBhcnNlSFRNTCBpcyBub3QgcHJlc2VudFxuXHRcdFx0XHRcdGpRdWVyeS5tZXJnZSggdGhpcywgalF1ZXJ5LnBhcnNlSFRNTChcblx0XHRcdFx0XHRcdG1hdGNoWzFdLFxuXHRcdFx0XHRcdFx0Y29udGV4dCAmJiBjb250ZXh0Lm5vZGVUeXBlID8gY29udGV4dC5vd25lckRvY3VtZW50IHx8IGNvbnRleHQgOiBkb2N1bWVudCxcblx0XHRcdFx0XHRcdHRydWVcblx0XHRcdFx0XHQpICk7XG5cblx0XHRcdFx0XHQvLyBIQU5ETEU6ICQoaHRtbCwgcHJvcHMpXG5cdFx0XHRcdFx0aWYgKCByc2luZ2xlVGFnLnRlc3QoIG1hdGNoWzFdICkgJiYgalF1ZXJ5LmlzUGxhaW5PYmplY3QoIGNvbnRleHQgKSApIHtcblx0XHRcdFx0XHRcdGZvciAoIG1hdGNoIGluIGNvbnRleHQgKSB7XG5cdFx0XHRcdFx0XHRcdC8vIFByb3BlcnRpZXMgb2YgY29udGV4dCBhcmUgY2FsbGVkIGFzIG1ldGhvZHMgaWYgcG9zc2libGVcblx0XHRcdFx0XHRcdFx0aWYgKCBqUXVlcnkuaXNGdW5jdGlvbiggdGhpc1sgbWF0Y2ggXSApICkge1xuXHRcdFx0XHRcdFx0XHRcdHRoaXNbIG1hdGNoIF0oIGNvbnRleHRbIG1hdGNoIF0gKTtcblxuXHRcdFx0XHRcdFx0XHQvLyAuLi5hbmQgb3RoZXJ3aXNlIHNldCBhcyBhdHRyaWJ1dGVzXG5cdFx0XHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHRcdFx0dGhpcy5hdHRyKCBtYXRjaCwgY29udGV4dFsgbWF0Y2ggXSApO1xuXHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0cmV0dXJuIHRoaXM7XG5cblx0XHRcdFx0Ly8gSEFORExFOiAkKCNpZClcblx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRlbGVtID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoIG1hdGNoWzJdICk7XG5cblx0XHRcdFx0XHQvLyBTdXBwb3J0OiBCbGFja2JlcnJ5IDQuNlxuXHRcdFx0XHRcdC8vIGdFQklEIHJldHVybnMgbm9kZXMgbm8gbG9uZ2VyIGluIHRoZSBkb2N1bWVudCAoIzY5NjMpXG5cdFx0XHRcdFx0aWYgKCBlbGVtICYmIGVsZW0ucGFyZW50Tm9kZSApIHtcblx0XHRcdFx0XHRcdC8vIEluamVjdCB0aGUgZWxlbWVudCBkaXJlY3RseSBpbnRvIHRoZSBqUXVlcnkgb2JqZWN0XG5cdFx0XHRcdFx0XHR0aGlzLmxlbmd0aCA9IDE7XG5cdFx0XHRcdFx0XHR0aGlzWzBdID0gZWxlbTtcblx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHR0aGlzLmNvbnRleHQgPSBkb2N1bWVudDtcblx0XHRcdFx0XHR0aGlzLnNlbGVjdG9yID0gc2VsZWN0b3I7XG5cdFx0XHRcdFx0cmV0dXJuIHRoaXM7XG5cdFx0XHRcdH1cblxuXHRcdFx0Ly8gSEFORExFOiAkKGV4cHIsICQoLi4uKSlcblx0XHRcdH0gZWxzZSBpZiAoICFjb250ZXh0IHx8IGNvbnRleHQuanF1ZXJ5ICkge1xuXHRcdFx0XHRyZXR1cm4gKCBjb250ZXh0IHx8IHJvb3RqUXVlcnkgKS5maW5kKCBzZWxlY3RvciApO1xuXG5cdFx0XHQvLyBIQU5ETEU6ICQoZXhwciwgY29udGV4dClcblx0XHRcdC8vICh3aGljaCBpcyBqdXN0IGVxdWl2YWxlbnQgdG86ICQoY29udGV4dCkuZmluZChleHByKVxuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0cmV0dXJuIHRoaXMuY29uc3RydWN0b3IoIGNvbnRleHQgKS5maW5kKCBzZWxlY3RvciApO1xuXHRcdFx0fVxuXG5cdFx0Ly8gSEFORExFOiAkKERPTUVsZW1lbnQpXG5cdFx0fSBlbHNlIGlmICggc2VsZWN0b3Iubm9kZVR5cGUgKSB7XG5cdFx0XHR0aGlzLmNvbnRleHQgPSB0aGlzWzBdID0gc2VsZWN0b3I7XG5cdFx0XHR0aGlzLmxlbmd0aCA9IDE7XG5cdFx0XHRyZXR1cm4gdGhpcztcblxuXHRcdC8vIEhBTkRMRTogJChmdW5jdGlvbilcblx0XHQvLyBTaG9ydGN1dCBmb3IgZG9jdW1lbnQgcmVhZHlcblx0XHR9IGVsc2UgaWYgKCBqUXVlcnkuaXNGdW5jdGlvbiggc2VsZWN0b3IgKSApIHtcblx0XHRcdHJldHVybiB0eXBlb2Ygcm9vdGpRdWVyeS5yZWFkeSAhPT0gXCJ1bmRlZmluZWRcIiA/XG5cdFx0XHRcdHJvb3RqUXVlcnkucmVhZHkoIHNlbGVjdG9yICkgOlxuXHRcdFx0XHQvLyBFeGVjdXRlIGltbWVkaWF0ZWx5IGlmIHJlYWR5IGlzIG5vdCBwcmVzZW50XG5cdFx0XHRcdHNlbGVjdG9yKCBqUXVlcnkgKTtcblx0XHR9XG5cblx0XHRpZiAoIHNlbGVjdG9yLnNlbGVjdG9yICE9PSB1bmRlZmluZWQgKSB7XG5cdFx0XHR0aGlzLnNlbGVjdG9yID0gc2VsZWN0b3Iuc2VsZWN0b3I7XG5cdFx0XHR0aGlzLmNvbnRleHQgPSBzZWxlY3Rvci5jb250ZXh0O1xuXHRcdH1cblxuXHRcdHJldHVybiBqUXVlcnkubWFrZUFycmF5KCBzZWxlY3RvciwgdGhpcyApO1xuXHR9O1xuXG4vLyBHaXZlIHRoZSBpbml0IGZ1bmN0aW9uIHRoZSBqUXVlcnkgcHJvdG90eXBlIGZvciBsYXRlciBpbnN0YW50aWF0aW9uXG5pbml0LnByb3RvdHlwZSA9IGpRdWVyeS5mbjtcblxuLy8gSW5pdGlhbGl6ZSBjZW50cmFsIHJlZmVyZW5jZVxucm9vdGpRdWVyeSA9IGpRdWVyeSggZG9jdW1lbnQgKTtcblxuXG52YXIgcnBhcmVudHNwcmV2ID0gL14oPzpwYXJlbnRzfHByZXYoPzpVbnRpbHxBbGwpKS8sXG5cdC8vIE1ldGhvZHMgZ3VhcmFudGVlZCB0byBwcm9kdWNlIGEgdW5pcXVlIHNldCB3aGVuIHN0YXJ0aW5nIGZyb20gYSB1bmlxdWUgc2V0XG5cdGd1YXJhbnRlZWRVbmlxdWUgPSB7XG5cdFx0Y2hpbGRyZW46IHRydWUsXG5cdFx0Y29udGVudHM6IHRydWUsXG5cdFx0bmV4dDogdHJ1ZSxcblx0XHRwcmV2OiB0cnVlXG5cdH07XG5cbmpRdWVyeS5leHRlbmQoe1xuXHRkaXI6IGZ1bmN0aW9uKCBlbGVtLCBkaXIsIHVudGlsICkge1xuXHRcdHZhciBtYXRjaGVkID0gW10sXG5cdFx0XHR0cnVuY2F0ZSA9IHVudGlsICE9PSB1bmRlZmluZWQ7XG5cblx0XHR3aGlsZSAoIChlbGVtID0gZWxlbVsgZGlyIF0pICYmIGVsZW0ubm9kZVR5cGUgIT09IDkgKSB7XG5cdFx0XHRpZiAoIGVsZW0ubm9kZVR5cGUgPT09IDEgKSB7XG5cdFx0XHRcdGlmICggdHJ1bmNhdGUgJiYgalF1ZXJ5KCBlbGVtICkuaXMoIHVudGlsICkgKSB7XG5cdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdH1cblx0XHRcdFx0bWF0Y2hlZC5wdXNoKCBlbGVtICk7XG5cdFx0XHR9XG5cdFx0fVxuXHRcdHJldHVybiBtYXRjaGVkO1xuXHR9LFxuXG5cdHNpYmxpbmc6IGZ1bmN0aW9uKCBuLCBlbGVtICkge1xuXHRcdHZhciBtYXRjaGVkID0gW107XG5cblx0XHRmb3IgKCA7IG47IG4gPSBuLm5leHRTaWJsaW5nICkge1xuXHRcdFx0aWYgKCBuLm5vZGVUeXBlID09PSAxICYmIG4gIT09IGVsZW0gKSB7XG5cdFx0XHRcdG1hdGNoZWQucHVzaCggbiApO1xuXHRcdFx0fVxuXHRcdH1cblxuXHRcdHJldHVybiBtYXRjaGVkO1xuXHR9XG59KTtcblxualF1ZXJ5LmZuLmV4dGVuZCh7XG5cdGhhczogZnVuY3Rpb24oIHRhcmdldCApIHtcblx0XHR2YXIgdGFyZ2V0cyA9IGpRdWVyeSggdGFyZ2V0LCB0aGlzICksXG5cdFx0XHRsID0gdGFyZ2V0cy5sZW5ndGg7XG5cblx0XHRyZXR1cm4gdGhpcy5maWx0ZXIoZnVuY3Rpb24oKSB7XG5cdFx0XHR2YXIgaSA9IDA7XG5cdFx0XHRmb3IgKCA7IGkgPCBsOyBpKysgKSB7XG5cdFx0XHRcdGlmICggalF1ZXJ5LmNvbnRhaW5zKCB0aGlzLCB0YXJnZXRzW2ldICkgKSB7XG5cdFx0XHRcdFx0cmV0dXJuIHRydWU7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9KTtcblx0fSxcblxuXHRjbG9zZXN0OiBmdW5jdGlvbiggc2VsZWN0b3JzLCBjb250ZXh0ICkge1xuXHRcdHZhciBjdXIsXG5cdFx0XHRpID0gMCxcblx0XHRcdGwgPSB0aGlzLmxlbmd0aCxcblx0XHRcdG1hdGNoZWQgPSBbXSxcblx0XHRcdHBvcyA9IHJuZWVkc0NvbnRleHQudGVzdCggc2VsZWN0b3JzICkgfHwgdHlwZW9mIHNlbGVjdG9ycyAhPT0gXCJzdHJpbmdcIiA/XG5cdFx0XHRcdGpRdWVyeSggc2VsZWN0b3JzLCBjb250ZXh0IHx8IHRoaXMuY29udGV4dCApIDpcblx0XHRcdFx0MDtcblxuXHRcdGZvciAoIDsgaSA8IGw7IGkrKyApIHtcblx0XHRcdGZvciAoIGN1ciA9IHRoaXNbaV07IGN1ciAmJiBjdXIgIT09IGNvbnRleHQ7IGN1ciA9IGN1ci5wYXJlbnROb2RlICkge1xuXHRcdFx0XHQvLyBBbHdheXMgc2tpcCBkb2N1bWVudCBmcmFnbWVudHNcblx0XHRcdFx0aWYgKCBjdXIubm9kZVR5cGUgPCAxMSAmJiAocG9zID9cblx0XHRcdFx0XHRwb3MuaW5kZXgoY3VyKSA+IC0xIDpcblxuXHRcdFx0XHRcdC8vIERvbid0IHBhc3Mgbm9uLWVsZW1lbnRzIHRvIFNpenpsZVxuXHRcdFx0XHRcdGN1ci5ub2RlVHlwZSA9PT0gMSAmJlxuXHRcdFx0XHRcdFx0alF1ZXJ5LmZpbmQubWF0Y2hlc1NlbGVjdG9yKGN1ciwgc2VsZWN0b3JzKSkgKSB7XG5cblx0XHRcdFx0XHRtYXRjaGVkLnB1c2goIGN1ciApO1xuXHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0cmV0dXJuIHRoaXMucHVzaFN0YWNrKCBtYXRjaGVkLmxlbmd0aCA+IDEgPyBqUXVlcnkudW5pcXVlKCBtYXRjaGVkICkgOiBtYXRjaGVkICk7XG5cdH0sXG5cblx0Ly8gRGV0ZXJtaW5lIHRoZSBwb3NpdGlvbiBvZiBhbiBlbGVtZW50IHdpdGhpbiB0aGUgc2V0XG5cdGluZGV4OiBmdW5jdGlvbiggZWxlbSApIHtcblxuXHRcdC8vIE5vIGFyZ3VtZW50LCByZXR1cm4gaW5kZXggaW4gcGFyZW50XG5cdFx0aWYgKCAhZWxlbSApIHtcblx0XHRcdHJldHVybiAoIHRoaXNbIDAgXSAmJiB0aGlzWyAwIF0ucGFyZW50Tm9kZSApID8gdGhpcy5maXJzdCgpLnByZXZBbGwoKS5sZW5ndGggOiAtMTtcblx0XHR9XG5cblx0XHQvLyBJbmRleCBpbiBzZWxlY3RvclxuXHRcdGlmICggdHlwZW9mIGVsZW0gPT09IFwic3RyaW5nXCIgKSB7XG5cdFx0XHRyZXR1cm4gaW5kZXhPZi5jYWxsKCBqUXVlcnkoIGVsZW0gKSwgdGhpc1sgMCBdICk7XG5cdFx0fVxuXG5cdFx0Ly8gTG9jYXRlIHRoZSBwb3NpdGlvbiBvZiB0aGUgZGVzaXJlZCBlbGVtZW50XG5cdFx0cmV0dXJuIGluZGV4T2YuY2FsbCggdGhpcyxcblxuXHRcdFx0Ly8gSWYgaXQgcmVjZWl2ZXMgYSBqUXVlcnkgb2JqZWN0LCB0aGUgZmlyc3QgZWxlbWVudCBpcyB1c2VkXG5cdFx0XHRlbGVtLmpxdWVyeSA/IGVsZW1bIDAgXSA6IGVsZW1cblx0XHQpO1xuXHR9LFxuXG5cdGFkZDogZnVuY3Rpb24oIHNlbGVjdG9yLCBjb250ZXh0ICkge1xuXHRcdHJldHVybiB0aGlzLnB1c2hTdGFjayhcblx0XHRcdGpRdWVyeS51bmlxdWUoXG5cdFx0XHRcdGpRdWVyeS5tZXJnZSggdGhpcy5nZXQoKSwgalF1ZXJ5KCBzZWxlY3RvciwgY29udGV4dCApIClcblx0XHRcdClcblx0XHQpO1xuXHR9LFxuXG5cdGFkZEJhY2s6IGZ1bmN0aW9uKCBzZWxlY3RvciApIHtcblx0XHRyZXR1cm4gdGhpcy5hZGQoIHNlbGVjdG9yID09IG51bGwgP1xuXHRcdFx0dGhpcy5wcmV2T2JqZWN0IDogdGhpcy5wcmV2T2JqZWN0LmZpbHRlcihzZWxlY3Rvcilcblx0XHQpO1xuXHR9XG59KTtcblxuZnVuY3Rpb24gc2libGluZyggY3VyLCBkaXIgKSB7XG5cdHdoaWxlICggKGN1ciA9IGN1cltkaXJdKSAmJiBjdXIubm9kZVR5cGUgIT09IDEgKSB7fVxuXHRyZXR1cm4gY3VyO1xufVxuXG5qUXVlcnkuZWFjaCh7XG5cdHBhcmVudDogZnVuY3Rpb24oIGVsZW0gKSB7XG5cdFx0dmFyIHBhcmVudCA9IGVsZW0ucGFyZW50Tm9kZTtcblx0XHRyZXR1cm4gcGFyZW50ICYmIHBhcmVudC5ub2RlVHlwZSAhPT0gMTEgPyBwYXJlbnQgOiBudWxsO1xuXHR9LFxuXHRwYXJlbnRzOiBmdW5jdGlvbiggZWxlbSApIHtcblx0XHRyZXR1cm4galF1ZXJ5LmRpciggZWxlbSwgXCJwYXJlbnROb2RlXCIgKTtcblx0fSxcblx0cGFyZW50c1VudGlsOiBmdW5jdGlvbiggZWxlbSwgaSwgdW50aWwgKSB7XG5cdFx0cmV0dXJuIGpRdWVyeS5kaXIoIGVsZW0sIFwicGFyZW50Tm9kZVwiLCB1bnRpbCApO1xuXHR9LFxuXHRuZXh0OiBmdW5jdGlvbiggZWxlbSApIHtcblx0XHRyZXR1cm4gc2libGluZyggZWxlbSwgXCJuZXh0U2libGluZ1wiICk7XG5cdH0sXG5cdHByZXY6IGZ1bmN0aW9uKCBlbGVtICkge1xuXHRcdHJldHVybiBzaWJsaW5nKCBlbGVtLCBcInByZXZpb3VzU2libGluZ1wiICk7XG5cdH0sXG5cdG5leHRBbGw6IGZ1bmN0aW9uKCBlbGVtICkge1xuXHRcdHJldHVybiBqUXVlcnkuZGlyKCBlbGVtLCBcIm5leHRTaWJsaW5nXCIgKTtcblx0fSxcblx0cHJldkFsbDogZnVuY3Rpb24oIGVsZW0gKSB7XG5cdFx0cmV0dXJuIGpRdWVyeS5kaXIoIGVsZW0sIFwicHJldmlvdXNTaWJsaW5nXCIgKTtcblx0fSxcblx0bmV4dFVudGlsOiBmdW5jdGlvbiggZWxlbSwgaSwgdW50aWwgKSB7XG5cdFx0cmV0dXJuIGpRdWVyeS5kaXIoIGVsZW0sIFwibmV4dFNpYmxpbmdcIiwgdW50aWwgKTtcblx0fSxcblx0cHJldlVudGlsOiBmdW5jdGlvbiggZWxlbSwgaSwgdW50aWwgKSB7XG5cdFx0cmV0dXJuIGpRdWVyeS5kaXIoIGVsZW0sIFwicHJldmlvdXNTaWJsaW5nXCIsIHVudGlsICk7XG5cdH0sXG5cdHNpYmxpbmdzOiBmdW5jdGlvbiggZWxlbSApIHtcblx0XHRyZXR1cm4galF1ZXJ5LnNpYmxpbmcoICggZWxlbS5wYXJlbnROb2RlIHx8IHt9ICkuZmlyc3RDaGlsZCwgZWxlbSApO1xuXHR9LFxuXHRjaGlsZHJlbjogZnVuY3Rpb24oIGVsZW0gKSB7XG5cdFx0cmV0dXJuIGpRdWVyeS5zaWJsaW5nKCBlbGVtLmZpcnN0Q2hpbGQgKTtcblx0fSxcblx0Y29udGVudHM6IGZ1bmN0aW9uKCBlbGVtICkge1xuXHRcdHJldHVybiBlbGVtLmNvbnRlbnREb2N1bWVudCB8fCBqUXVlcnkubWVyZ2UoIFtdLCBlbGVtLmNoaWxkTm9kZXMgKTtcblx0fVxufSwgZnVuY3Rpb24oIG5hbWUsIGZuICkge1xuXHRqUXVlcnkuZm5bIG5hbWUgXSA9IGZ1bmN0aW9uKCB1bnRpbCwgc2VsZWN0b3IgKSB7XG5cdFx0dmFyIG1hdGNoZWQgPSBqUXVlcnkubWFwKCB0aGlzLCBmbiwgdW50aWwgKTtcblxuXHRcdGlmICggbmFtZS5zbGljZSggLTUgKSAhPT0gXCJVbnRpbFwiICkge1xuXHRcdFx0c2VsZWN0b3IgPSB1bnRpbDtcblx0XHR9XG5cblx0XHRpZiAoIHNlbGVjdG9yICYmIHR5cGVvZiBzZWxlY3RvciA9PT0gXCJzdHJpbmdcIiApIHtcblx0XHRcdG1hdGNoZWQgPSBqUXVlcnkuZmlsdGVyKCBzZWxlY3RvciwgbWF0Y2hlZCApO1xuXHRcdH1cblxuXHRcdGlmICggdGhpcy5sZW5ndGggPiAxICkge1xuXHRcdFx0Ly8gUmVtb3ZlIGR1cGxpY2F0ZXNcblx0XHRcdGlmICggIWd1YXJhbnRlZWRVbmlxdWVbIG5hbWUgXSApIHtcblx0XHRcdFx0alF1ZXJ5LnVuaXF1ZSggbWF0Y2hlZCApO1xuXHRcdFx0fVxuXG5cdFx0XHQvLyBSZXZlcnNlIG9yZGVyIGZvciBwYXJlbnRzKiBhbmQgcHJldi1kZXJpdmF0aXZlc1xuXHRcdFx0aWYgKCBycGFyZW50c3ByZXYudGVzdCggbmFtZSApICkge1xuXHRcdFx0XHRtYXRjaGVkLnJldmVyc2UoKTtcblx0XHRcdH1cblx0XHR9XG5cblx0XHRyZXR1cm4gdGhpcy5wdXNoU3RhY2soIG1hdGNoZWQgKTtcblx0fTtcbn0pO1xudmFyIHJub3R3aGl0ZSA9ICgvXFxTKy9nKTtcblxuXG5cbi8vIFN0cmluZyB0byBPYmplY3Qgb3B0aW9ucyBmb3JtYXQgY2FjaGVcbnZhciBvcHRpb25zQ2FjaGUgPSB7fTtcblxuLy8gQ29udmVydCBTdHJpbmctZm9ybWF0dGVkIG9wdGlvbnMgaW50byBPYmplY3QtZm9ybWF0dGVkIG9uZXMgYW5kIHN0b3JlIGluIGNhY2hlXG5mdW5jdGlvbiBjcmVhdGVPcHRpb25zKCBvcHRpb25zICkge1xuXHR2YXIgb2JqZWN0ID0gb3B0aW9uc0NhY2hlWyBvcHRpb25zIF0gPSB7fTtcblx0alF1ZXJ5LmVhY2goIG9wdGlvbnMubWF0Y2goIHJub3R3aGl0ZSApIHx8IFtdLCBmdW5jdGlvbiggXywgZmxhZyApIHtcblx0XHRvYmplY3RbIGZsYWcgXSA9IHRydWU7XG5cdH0pO1xuXHRyZXR1cm4gb2JqZWN0O1xufVxuXG4vKlxuICogQ3JlYXRlIGEgY2FsbGJhY2sgbGlzdCB1c2luZyB0aGUgZm9sbG93aW5nIHBhcmFtZXRlcnM6XG4gKlxuICpcdG9wdGlvbnM6IGFuIG9wdGlvbmFsIGxpc3Qgb2Ygc3BhY2Utc2VwYXJhdGVkIG9wdGlvbnMgdGhhdCB3aWxsIGNoYW5nZSBob3dcbiAqXHRcdFx0dGhlIGNhbGxiYWNrIGxpc3QgYmVoYXZlcyBvciBhIG1vcmUgdHJhZGl0aW9uYWwgb3B0aW9uIG9iamVjdFxuICpcbiAqIEJ5IGRlZmF1bHQgYSBjYWxsYmFjayBsaXN0IHdpbGwgYWN0IGxpa2UgYW4gZXZlbnQgY2FsbGJhY2sgbGlzdCBhbmQgY2FuIGJlXG4gKiBcImZpcmVkXCIgbXVsdGlwbGUgdGltZXMuXG4gKlxuICogUG9zc2libGUgb3B0aW9uczpcbiAqXG4gKlx0b25jZTpcdFx0XHR3aWxsIGVuc3VyZSB0aGUgY2FsbGJhY2sgbGlzdCBjYW4gb25seSBiZSBmaXJlZCBvbmNlIChsaWtlIGEgRGVmZXJyZWQpXG4gKlxuICpcdG1lbW9yeTpcdFx0XHR3aWxsIGtlZXAgdHJhY2sgb2YgcHJldmlvdXMgdmFsdWVzIGFuZCB3aWxsIGNhbGwgYW55IGNhbGxiYWNrIGFkZGVkXG4gKlx0XHRcdFx0XHRhZnRlciB0aGUgbGlzdCBoYXMgYmVlbiBmaXJlZCByaWdodCBhd2F5IHdpdGggdGhlIGxhdGVzdCBcIm1lbW9yaXplZFwiXG4gKlx0XHRcdFx0XHR2YWx1ZXMgKGxpa2UgYSBEZWZlcnJlZClcbiAqXG4gKlx0dW5pcXVlOlx0XHRcdHdpbGwgZW5zdXJlIGEgY2FsbGJhY2sgY2FuIG9ubHkgYmUgYWRkZWQgb25jZSAobm8gZHVwbGljYXRlIGluIHRoZSBsaXN0KVxuICpcbiAqXHRzdG9wT25GYWxzZTpcdGludGVycnVwdCBjYWxsaW5ncyB3aGVuIGEgY2FsbGJhY2sgcmV0dXJucyBmYWxzZVxuICpcbiAqL1xualF1ZXJ5LkNhbGxiYWNrcyA9IGZ1bmN0aW9uKCBvcHRpb25zICkge1xuXG5cdC8vIENvbnZlcnQgb3B0aW9ucyBmcm9tIFN0cmluZy1mb3JtYXR0ZWQgdG8gT2JqZWN0LWZvcm1hdHRlZCBpZiBuZWVkZWRcblx0Ly8gKHdlIGNoZWNrIGluIGNhY2hlIGZpcnN0KVxuXHRvcHRpb25zID0gdHlwZW9mIG9wdGlvbnMgPT09IFwic3RyaW5nXCIgP1xuXHRcdCggb3B0aW9uc0NhY2hlWyBvcHRpb25zIF0gfHwgY3JlYXRlT3B0aW9ucyggb3B0aW9ucyApICkgOlxuXHRcdGpRdWVyeS5leHRlbmQoIHt9LCBvcHRpb25zICk7XG5cblx0dmFyIC8vIExhc3QgZmlyZSB2YWx1ZSAoZm9yIG5vbi1mb3JnZXR0YWJsZSBsaXN0cylcblx0XHRtZW1vcnksXG5cdFx0Ly8gRmxhZyB0byBrbm93IGlmIGxpc3Qgd2FzIGFscmVhZHkgZmlyZWRcblx0XHRmaXJlZCxcblx0XHQvLyBGbGFnIHRvIGtub3cgaWYgbGlzdCBpcyBjdXJyZW50bHkgZmlyaW5nXG5cdFx0ZmlyaW5nLFxuXHRcdC8vIEZpcnN0IGNhbGxiYWNrIHRvIGZpcmUgKHVzZWQgaW50ZXJuYWxseSBieSBhZGQgYW5kIGZpcmVXaXRoKVxuXHRcdGZpcmluZ1N0YXJ0LFxuXHRcdC8vIEVuZCBvZiB0aGUgbG9vcCB3aGVuIGZpcmluZ1xuXHRcdGZpcmluZ0xlbmd0aCxcblx0XHQvLyBJbmRleCBvZiBjdXJyZW50bHkgZmlyaW5nIGNhbGxiYWNrIChtb2RpZmllZCBieSByZW1vdmUgaWYgbmVlZGVkKVxuXHRcdGZpcmluZ0luZGV4LFxuXHRcdC8vIEFjdHVhbCBjYWxsYmFjayBsaXN0XG5cdFx0bGlzdCA9IFtdLFxuXHRcdC8vIFN0YWNrIG9mIGZpcmUgY2FsbHMgZm9yIHJlcGVhdGFibGUgbGlzdHNcblx0XHRzdGFjayA9ICFvcHRpb25zLm9uY2UgJiYgW10sXG5cdFx0Ly8gRmlyZSBjYWxsYmFja3Ncblx0XHRmaXJlID0gZnVuY3Rpb24oIGRhdGEgKSB7XG5cdFx0XHRtZW1vcnkgPSBvcHRpb25zLm1lbW9yeSAmJiBkYXRhO1xuXHRcdFx0ZmlyZWQgPSB0cnVlO1xuXHRcdFx0ZmlyaW5nSW5kZXggPSBmaXJpbmdTdGFydCB8fCAwO1xuXHRcdFx0ZmlyaW5nU3RhcnQgPSAwO1xuXHRcdFx0ZmlyaW5nTGVuZ3RoID0gbGlzdC5sZW5ndGg7XG5cdFx0XHRmaXJpbmcgPSB0cnVlO1xuXHRcdFx0Zm9yICggOyBsaXN0ICYmIGZpcmluZ0luZGV4IDwgZmlyaW5nTGVuZ3RoOyBmaXJpbmdJbmRleCsrICkge1xuXHRcdFx0XHRpZiAoIGxpc3RbIGZpcmluZ0luZGV4IF0uYXBwbHkoIGRhdGFbIDAgXSwgZGF0YVsgMSBdICkgPT09IGZhbHNlICYmIG9wdGlvbnMuc3RvcE9uRmFsc2UgKSB7XG5cdFx0XHRcdFx0bWVtb3J5ID0gZmFsc2U7IC8vIFRvIHByZXZlbnQgZnVydGhlciBjYWxscyB1c2luZyBhZGRcblx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdFx0ZmlyaW5nID0gZmFsc2U7XG5cdFx0XHRpZiAoIGxpc3QgKSB7XG5cdFx0XHRcdGlmICggc3RhY2sgKSB7XG5cdFx0XHRcdFx0aWYgKCBzdGFjay5sZW5ndGggKSB7XG5cdFx0XHRcdFx0XHRmaXJlKCBzdGFjay5zaGlmdCgpICk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9IGVsc2UgaWYgKCBtZW1vcnkgKSB7XG5cdFx0XHRcdFx0bGlzdCA9IFtdO1xuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdHNlbGYuZGlzYWJsZSgpO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fSxcblx0XHQvLyBBY3R1YWwgQ2FsbGJhY2tzIG9iamVjdFxuXHRcdHNlbGYgPSB7XG5cdFx0XHQvLyBBZGQgYSBjYWxsYmFjayBvciBhIGNvbGxlY3Rpb24gb2YgY2FsbGJhY2tzIHRvIHRoZSBsaXN0XG5cdFx0XHRhZGQ6IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRpZiAoIGxpc3QgKSB7XG5cdFx0XHRcdFx0Ly8gRmlyc3QsIHdlIHNhdmUgdGhlIGN1cnJlbnQgbGVuZ3RoXG5cdFx0XHRcdFx0dmFyIHN0YXJ0ID0gbGlzdC5sZW5ndGg7XG5cdFx0XHRcdFx0KGZ1bmN0aW9uIGFkZCggYXJncyApIHtcblx0XHRcdFx0XHRcdGpRdWVyeS5lYWNoKCBhcmdzLCBmdW5jdGlvbiggXywgYXJnICkge1xuXHRcdFx0XHRcdFx0XHR2YXIgdHlwZSA9IGpRdWVyeS50eXBlKCBhcmcgKTtcblx0XHRcdFx0XHRcdFx0aWYgKCB0eXBlID09PSBcImZ1bmN0aW9uXCIgKSB7XG5cdFx0XHRcdFx0XHRcdFx0aWYgKCAhb3B0aW9ucy51bmlxdWUgfHwgIXNlbGYuaGFzKCBhcmcgKSApIHtcblx0XHRcdFx0XHRcdFx0XHRcdGxpc3QucHVzaCggYXJnICk7XG5cdFx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHR9IGVsc2UgaWYgKCBhcmcgJiYgYXJnLmxlbmd0aCAmJiB0eXBlICE9PSBcInN0cmluZ1wiICkge1xuXHRcdFx0XHRcdFx0XHRcdC8vIEluc3BlY3QgcmVjdXJzaXZlbHlcblx0XHRcdFx0XHRcdFx0XHRhZGQoIGFyZyApO1xuXHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHR9KTtcblx0XHRcdFx0XHR9KSggYXJndW1lbnRzICk7XG5cdFx0XHRcdFx0Ly8gRG8gd2UgbmVlZCB0byBhZGQgdGhlIGNhbGxiYWNrcyB0byB0aGVcblx0XHRcdFx0XHQvLyBjdXJyZW50IGZpcmluZyBiYXRjaD9cblx0XHRcdFx0XHRpZiAoIGZpcmluZyApIHtcblx0XHRcdFx0XHRcdGZpcmluZ0xlbmd0aCA9IGxpc3QubGVuZ3RoO1xuXHRcdFx0XHRcdC8vIFdpdGggbWVtb3J5LCBpZiB3ZSdyZSBub3QgZmlyaW5nIHRoZW5cblx0XHRcdFx0XHQvLyB3ZSBzaG91bGQgY2FsbCByaWdodCBhd2F5XG5cdFx0XHRcdFx0fSBlbHNlIGlmICggbWVtb3J5ICkge1xuXHRcdFx0XHRcdFx0ZmlyaW5nU3RhcnQgPSBzdGFydDtcblx0XHRcdFx0XHRcdGZpcmUoIG1lbW9yeSApO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0XHRyZXR1cm4gdGhpcztcblx0XHRcdH0sXG5cdFx0XHQvLyBSZW1vdmUgYSBjYWxsYmFjayBmcm9tIHRoZSBsaXN0XG5cdFx0XHRyZW1vdmU6IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRpZiAoIGxpc3QgKSB7XG5cdFx0XHRcdFx0alF1ZXJ5LmVhY2goIGFyZ3VtZW50cywgZnVuY3Rpb24oIF8sIGFyZyApIHtcblx0XHRcdFx0XHRcdHZhciBpbmRleDtcblx0XHRcdFx0XHRcdHdoaWxlICggKCBpbmRleCA9IGpRdWVyeS5pbkFycmF5KCBhcmcsIGxpc3QsIGluZGV4ICkgKSA+IC0xICkge1xuXHRcdFx0XHRcdFx0XHRsaXN0LnNwbGljZSggaW5kZXgsIDEgKTtcblx0XHRcdFx0XHRcdFx0Ly8gSGFuZGxlIGZpcmluZyBpbmRleGVzXG5cdFx0XHRcdFx0XHRcdGlmICggZmlyaW5nICkge1xuXHRcdFx0XHRcdFx0XHRcdGlmICggaW5kZXggPD0gZmlyaW5nTGVuZ3RoICkge1xuXHRcdFx0XHRcdFx0XHRcdFx0ZmlyaW5nTGVuZ3RoLS07XG5cdFx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHRcdGlmICggaW5kZXggPD0gZmlyaW5nSW5kZXggKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRmaXJpbmdJbmRleC0tO1xuXHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH0pO1xuXHRcdFx0XHR9XG5cdFx0XHRcdHJldHVybiB0aGlzO1xuXHRcdFx0fSxcblx0XHRcdC8vIENoZWNrIGlmIGEgZ2l2ZW4gY2FsbGJhY2sgaXMgaW4gdGhlIGxpc3QuXG5cdFx0XHQvLyBJZiBubyBhcmd1bWVudCBpcyBnaXZlbiwgcmV0dXJuIHdoZXRoZXIgb3Igbm90IGxpc3QgaGFzIGNhbGxiYWNrcyBhdHRhY2hlZC5cblx0XHRcdGhhczogZnVuY3Rpb24oIGZuICkge1xuXHRcdFx0XHRyZXR1cm4gZm4gPyBqUXVlcnkuaW5BcnJheSggZm4sIGxpc3QgKSA+IC0xIDogISEoIGxpc3QgJiYgbGlzdC5sZW5ndGggKTtcblx0XHRcdH0sXG5cdFx0XHQvLyBSZW1vdmUgYWxsIGNhbGxiYWNrcyBmcm9tIHRoZSBsaXN0XG5cdFx0XHRlbXB0eTogZnVuY3Rpb24oKSB7XG5cdFx0XHRcdGxpc3QgPSBbXTtcblx0XHRcdFx0ZmlyaW5nTGVuZ3RoID0gMDtcblx0XHRcdFx0cmV0dXJuIHRoaXM7XG5cdFx0XHR9LFxuXHRcdFx0Ly8gSGF2ZSB0aGUgbGlzdCBkbyBub3RoaW5nIGFueW1vcmVcblx0XHRcdGRpc2FibGU6IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRsaXN0ID0gc3RhY2sgPSBtZW1vcnkgPSB1bmRlZmluZWQ7XG5cdFx0XHRcdHJldHVybiB0aGlzO1xuXHRcdFx0fSxcblx0XHRcdC8vIElzIGl0IGRpc2FibGVkP1xuXHRcdFx0ZGlzYWJsZWQ6IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRyZXR1cm4gIWxpc3Q7XG5cdFx0XHR9LFxuXHRcdFx0Ly8gTG9jayB0aGUgbGlzdCBpbiBpdHMgY3VycmVudCBzdGF0ZVxuXHRcdFx0bG9jazogZnVuY3Rpb24oKSB7XG5cdFx0XHRcdHN0YWNrID0gdW5kZWZpbmVkO1xuXHRcdFx0XHRpZiAoICFtZW1vcnkgKSB7XG5cdFx0XHRcdFx0c2VsZi5kaXNhYmxlKCk7XG5cdFx0XHRcdH1cblx0XHRcdFx0cmV0dXJuIHRoaXM7XG5cdFx0XHR9LFxuXHRcdFx0Ly8gSXMgaXQgbG9ja2VkP1xuXHRcdFx0bG9ja2VkOiBmdW5jdGlvbigpIHtcblx0XHRcdFx0cmV0dXJuICFzdGFjaztcblx0XHRcdH0sXG5cdFx0XHQvLyBDYWxsIGFsbCBjYWxsYmFja3Mgd2l0aCB0aGUgZ2l2ZW4gY29udGV4dCBhbmQgYXJndW1lbnRzXG5cdFx0XHRmaXJlV2l0aDogZnVuY3Rpb24oIGNvbnRleHQsIGFyZ3MgKSB7XG5cdFx0XHRcdGlmICggbGlzdCAmJiAoICFmaXJlZCB8fCBzdGFjayApICkge1xuXHRcdFx0XHRcdGFyZ3MgPSBhcmdzIHx8IFtdO1xuXHRcdFx0XHRcdGFyZ3MgPSBbIGNvbnRleHQsIGFyZ3Muc2xpY2UgPyBhcmdzLnNsaWNlKCkgOiBhcmdzIF07XG5cdFx0XHRcdFx0aWYgKCBmaXJpbmcgKSB7XG5cdFx0XHRcdFx0XHRzdGFjay5wdXNoKCBhcmdzICk7XG5cdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdGZpcmUoIGFyZ3MgKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdFx0cmV0dXJuIHRoaXM7XG5cdFx0XHR9LFxuXHRcdFx0Ly8gQ2FsbCBhbGwgdGhlIGNhbGxiYWNrcyB3aXRoIHRoZSBnaXZlbiBhcmd1bWVudHNcblx0XHRcdGZpcmU6IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRzZWxmLmZpcmVXaXRoKCB0aGlzLCBhcmd1bWVudHMgKTtcblx0XHRcdFx0cmV0dXJuIHRoaXM7XG5cdFx0XHR9LFxuXHRcdFx0Ly8gVG8ga25vdyBpZiB0aGUgY2FsbGJhY2tzIGhhdmUgYWxyZWFkeSBiZWVuIGNhbGxlZCBhdCBsZWFzdCBvbmNlXG5cdFx0XHRmaXJlZDogZnVuY3Rpb24oKSB7XG5cdFx0XHRcdHJldHVybiAhIWZpcmVkO1xuXHRcdFx0fVxuXHRcdH07XG5cblx0cmV0dXJuIHNlbGY7XG59O1xuXG5cbmpRdWVyeS5leHRlbmQoe1xuXG5cdERlZmVycmVkOiBmdW5jdGlvbiggZnVuYyApIHtcblx0XHR2YXIgdHVwbGVzID0gW1xuXHRcdFx0XHQvLyBhY3Rpb24sIGFkZCBsaXN0ZW5lciwgbGlzdGVuZXIgbGlzdCwgZmluYWwgc3RhdGVcblx0XHRcdFx0WyBcInJlc29sdmVcIiwgXCJkb25lXCIsIGpRdWVyeS5DYWxsYmFja3MoXCJvbmNlIG1lbW9yeVwiKSwgXCJyZXNvbHZlZFwiIF0sXG5cdFx0XHRcdFsgXCJyZWplY3RcIiwgXCJmYWlsXCIsIGpRdWVyeS5DYWxsYmFja3MoXCJvbmNlIG1lbW9yeVwiKSwgXCJyZWplY3RlZFwiIF0sXG5cdFx0XHRcdFsgXCJub3RpZnlcIiwgXCJwcm9ncmVzc1wiLCBqUXVlcnkuQ2FsbGJhY2tzKFwibWVtb3J5XCIpIF1cblx0XHRcdF0sXG5cdFx0XHRzdGF0ZSA9IFwicGVuZGluZ1wiLFxuXHRcdFx0cHJvbWlzZSA9IHtcblx0XHRcdFx0c3RhdGU6IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRcdHJldHVybiBzdGF0ZTtcblx0XHRcdFx0fSxcblx0XHRcdFx0YWx3YXlzOiBmdW5jdGlvbigpIHtcblx0XHRcdFx0XHRkZWZlcnJlZC5kb25lKCBhcmd1bWVudHMgKS5mYWlsKCBhcmd1bWVudHMgKTtcblx0XHRcdFx0XHRyZXR1cm4gdGhpcztcblx0XHRcdFx0fSxcblx0XHRcdFx0dGhlbjogZnVuY3Rpb24oIC8qIGZuRG9uZSwgZm5GYWlsLCBmblByb2dyZXNzICovICkge1xuXHRcdFx0XHRcdHZhciBmbnMgPSBhcmd1bWVudHM7XG5cdFx0XHRcdFx0cmV0dXJuIGpRdWVyeS5EZWZlcnJlZChmdW5jdGlvbiggbmV3RGVmZXIgKSB7XG5cdFx0XHRcdFx0XHRqUXVlcnkuZWFjaCggdHVwbGVzLCBmdW5jdGlvbiggaSwgdHVwbGUgKSB7XG5cdFx0XHRcdFx0XHRcdHZhciBmbiA9IGpRdWVyeS5pc0Z1bmN0aW9uKCBmbnNbIGkgXSApICYmIGZuc1sgaSBdO1xuXHRcdFx0XHRcdFx0XHQvLyBkZWZlcnJlZFsgZG9uZSB8IGZhaWwgfCBwcm9ncmVzcyBdIGZvciBmb3J3YXJkaW5nIGFjdGlvbnMgdG8gbmV3RGVmZXJcblx0XHRcdFx0XHRcdFx0ZGVmZXJyZWRbIHR1cGxlWzFdIF0oZnVuY3Rpb24oKSB7XG5cdFx0XHRcdFx0XHRcdFx0dmFyIHJldHVybmVkID0gZm4gJiYgZm4uYXBwbHkoIHRoaXMsIGFyZ3VtZW50cyApO1xuXHRcdFx0XHRcdFx0XHRcdGlmICggcmV0dXJuZWQgJiYgalF1ZXJ5LmlzRnVuY3Rpb24oIHJldHVybmVkLnByb21pc2UgKSApIHtcblx0XHRcdFx0XHRcdFx0XHRcdHJldHVybmVkLnByb21pc2UoKVxuXHRcdFx0XHRcdFx0XHRcdFx0XHQuZG9uZSggbmV3RGVmZXIucmVzb2x2ZSApXG5cdFx0XHRcdFx0XHRcdFx0XHRcdC5mYWlsKCBuZXdEZWZlci5yZWplY3QgKVxuXHRcdFx0XHRcdFx0XHRcdFx0XHQucHJvZ3Jlc3MoIG5ld0RlZmVyLm5vdGlmeSApO1xuXHRcdFx0XHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRuZXdEZWZlclsgdHVwbGVbIDAgXSArIFwiV2l0aFwiIF0oIHRoaXMgPT09IHByb21pc2UgPyBuZXdEZWZlci5wcm9taXNlKCkgOiB0aGlzLCBmbiA/IFsgcmV0dXJuZWQgXSA6IGFyZ3VtZW50cyApO1xuXHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0fSk7XG5cdFx0XHRcdFx0XHR9KTtcblx0XHRcdFx0XHRcdGZucyA9IG51bGw7XG5cdFx0XHRcdFx0fSkucHJvbWlzZSgpO1xuXHRcdFx0XHR9LFxuXHRcdFx0XHQvLyBHZXQgYSBwcm9taXNlIGZvciB0aGlzIGRlZmVycmVkXG5cdFx0XHRcdC8vIElmIG9iaiBpcyBwcm92aWRlZCwgdGhlIHByb21pc2UgYXNwZWN0IGlzIGFkZGVkIHRvIHRoZSBvYmplY3Rcblx0XHRcdFx0cHJvbWlzZTogZnVuY3Rpb24oIG9iaiApIHtcblx0XHRcdFx0XHRyZXR1cm4gb2JqICE9IG51bGwgPyBqUXVlcnkuZXh0ZW5kKCBvYmosIHByb21pc2UgKSA6IHByb21pc2U7XG5cdFx0XHRcdH1cblx0XHRcdH0sXG5cdFx0XHRkZWZlcnJlZCA9IHt9O1xuXG5cdFx0Ly8gS2VlcCBwaXBlIGZvciBiYWNrLWNvbXBhdFxuXHRcdHByb21pc2UucGlwZSA9IHByb21pc2UudGhlbjtcblxuXHRcdC8vIEFkZCBsaXN0LXNwZWNpZmljIG1ldGhvZHNcblx0XHRqUXVlcnkuZWFjaCggdHVwbGVzLCBmdW5jdGlvbiggaSwgdHVwbGUgKSB7XG5cdFx0XHR2YXIgbGlzdCA9IHR1cGxlWyAyIF0sXG5cdFx0XHRcdHN0YXRlU3RyaW5nID0gdHVwbGVbIDMgXTtcblxuXHRcdFx0Ly8gcHJvbWlzZVsgZG9uZSB8IGZhaWwgfCBwcm9ncmVzcyBdID0gbGlzdC5hZGRcblx0XHRcdHByb21pc2VbIHR1cGxlWzFdIF0gPSBsaXN0LmFkZDtcblxuXHRcdFx0Ly8gSGFuZGxlIHN0YXRlXG5cdFx0XHRpZiAoIHN0YXRlU3RyaW5nICkge1xuXHRcdFx0XHRsaXN0LmFkZChmdW5jdGlvbigpIHtcblx0XHRcdFx0XHQvLyBzdGF0ZSA9IFsgcmVzb2x2ZWQgfCByZWplY3RlZCBdXG5cdFx0XHRcdFx0c3RhdGUgPSBzdGF0ZVN0cmluZztcblxuXHRcdFx0XHQvLyBbIHJlamVjdF9saXN0IHwgcmVzb2x2ZV9saXN0IF0uZGlzYWJsZTsgcHJvZ3Jlc3NfbGlzdC5sb2NrXG5cdFx0XHRcdH0sIHR1cGxlc1sgaSBeIDEgXVsgMiBdLmRpc2FibGUsIHR1cGxlc1sgMiBdWyAyIF0ubG9jayApO1xuXHRcdFx0fVxuXG5cdFx0XHQvLyBkZWZlcnJlZFsgcmVzb2x2ZSB8IHJlamVjdCB8IG5vdGlmeSBdXG5cdFx0XHRkZWZlcnJlZFsgdHVwbGVbMF0gXSA9IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRkZWZlcnJlZFsgdHVwbGVbMF0gKyBcIldpdGhcIiBdKCB0aGlzID09PSBkZWZlcnJlZCA/IHByb21pc2UgOiB0aGlzLCBhcmd1bWVudHMgKTtcblx0XHRcdFx0cmV0dXJuIHRoaXM7XG5cdFx0XHR9O1xuXHRcdFx0ZGVmZXJyZWRbIHR1cGxlWzBdICsgXCJXaXRoXCIgXSA9IGxpc3QuZmlyZVdpdGg7XG5cdFx0fSk7XG5cblx0XHQvLyBNYWtlIHRoZSBkZWZlcnJlZCBhIHByb21pc2Vcblx0XHRwcm9taXNlLnByb21pc2UoIGRlZmVycmVkICk7XG5cblx0XHQvLyBDYWxsIGdpdmVuIGZ1bmMgaWYgYW55XG5cdFx0aWYgKCBmdW5jICkge1xuXHRcdFx0ZnVuYy5jYWxsKCBkZWZlcnJlZCwgZGVmZXJyZWQgKTtcblx0XHR9XG5cblx0XHQvLyBBbGwgZG9uZSFcblx0XHRyZXR1cm4gZGVmZXJyZWQ7XG5cdH0sXG5cblx0Ly8gRGVmZXJyZWQgaGVscGVyXG5cdHdoZW46IGZ1bmN0aW9uKCBzdWJvcmRpbmF0ZSAvKiAsIC4uLiwgc3Vib3JkaW5hdGVOICovICkge1xuXHRcdHZhciBpID0gMCxcblx0XHRcdHJlc29sdmVWYWx1ZXMgPSBzbGljZS5jYWxsKCBhcmd1bWVudHMgKSxcblx0XHRcdGxlbmd0aCA9IHJlc29sdmVWYWx1ZXMubGVuZ3RoLFxuXG5cdFx0XHQvLyB0aGUgY291bnQgb2YgdW5jb21wbGV0ZWQgc3Vib3JkaW5hdGVzXG5cdFx0XHRyZW1haW5pbmcgPSBsZW5ndGggIT09IDEgfHwgKCBzdWJvcmRpbmF0ZSAmJiBqUXVlcnkuaXNGdW5jdGlvbiggc3Vib3JkaW5hdGUucHJvbWlzZSApICkgPyBsZW5ndGggOiAwLFxuXG5cdFx0XHQvLyB0aGUgbWFzdGVyIERlZmVycmVkLiBJZiByZXNvbHZlVmFsdWVzIGNvbnNpc3Qgb2Ygb25seSBhIHNpbmdsZSBEZWZlcnJlZCwganVzdCB1c2UgdGhhdC5cblx0XHRcdGRlZmVycmVkID0gcmVtYWluaW5nID09PSAxID8gc3Vib3JkaW5hdGUgOiBqUXVlcnkuRGVmZXJyZWQoKSxcblxuXHRcdFx0Ly8gVXBkYXRlIGZ1bmN0aW9uIGZvciBib3RoIHJlc29sdmUgYW5kIHByb2dyZXNzIHZhbHVlc1xuXHRcdFx0dXBkYXRlRnVuYyA9IGZ1bmN0aW9uKCBpLCBjb250ZXh0cywgdmFsdWVzICkge1xuXHRcdFx0XHRyZXR1cm4gZnVuY3Rpb24oIHZhbHVlICkge1xuXHRcdFx0XHRcdGNvbnRleHRzWyBpIF0gPSB0aGlzO1xuXHRcdFx0XHRcdHZhbHVlc1sgaSBdID0gYXJndW1lbnRzLmxlbmd0aCA+IDEgPyBzbGljZS5jYWxsKCBhcmd1bWVudHMgKSA6IHZhbHVlO1xuXHRcdFx0XHRcdGlmICggdmFsdWVzID09PSBwcm9ncmVzc1ZhbHVlcyApIHtcblx0XHRcdFx0XHRcdGRlZmVycmVkLm5vdGlmeVdpdGgoIGNvbnRleHRzLCB2YWx1ZXMgKTtcblx0XHRcdFx0XHR9IGVsc2UgaWYgKCAhKCAtLXJlbWFpbmluZyApICkge1xuXHRcdFx0XHRcdFx0ZGVmZXJyZWQucmVzb2x2ZVdpdGgoIGNvbnRleHRzLCB2YWx1ZXMgKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH07XG5cdFx0XHR9LFxuXG5cdFx0XHRwcm9ncmVzc1ZhbHVlcywgcHJvZ3Jlc3NDb250ZXh0cywgcmVzb2x2ZUNvbnRleHRzO1xuXG5cdFx0Ly8gQWRkIGxpc3RlbmVycyB0byBEZWZlcnJlZCBzdWJvcmRpbmF0ZXM7IHRyZWF0IG90aGVycyBhcyByZXNvbHZlZFxuXHRcdGlmICggbGVuZ3RoID4gMSApIHtcblx0XHRcdHByb2dyZXNzVmFsdWVzID0gbmV3IEFycmF5KCBsZW5ndGggKTtcblx0XHRcdHByb2dyZXNzQ29udGV4dHMgPSBuZXcgQXJyYXkoIGxlbmd0aCApO1xuXHRcdFx0cmVzb2x2ZUNvbnRleHRzID0gbmV3IEFycmF5KCBsZW5ndGggKTtcblx0XHRcdGZvciAoIDsgaSA8IGxlbmd0aDsgaSsrICkge1xuXHRcdFx0XHRpZiAoIHJlc29sdmVWYWx1ZXNbIGkgXSAmJiBqUXVlcnkuaXNGdW5jdGlvbiggcmVzb2x2ZVZhbHVlc1sgaSBdLnByb21pc2UgKSApIHtcblx0XHRcdFx0XHRyZXNvbHZlVmFsdWVzWyBpIF0ucHJvbWlzZSgpXG5cdFx0XHRcdFx0XHQuZG9uZSggdXBkYXRlRnVuYyggaSwgcmVzb2x2ZUNvbnRleHRzLCByZXNvbHZlVmFsdWVzICkgKVxuXHRcdFx0XHRcdFx0LmZhaWwoIGRlZmVycmVkLnJlamVjdCApXG5cdFx0XHRcdFx0XHQucHJvZ3Jlc3MoIHVwZGF0ZUZ1bmMoIGksIHByb2dyZXNzQ29udGV4dHMsIHByb2dyZXNzVmFsdWVzICkgKTtcblx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHQtLXJlbWFpbmluZztcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH1cblxuXHRcdC8vIElmIHdlJ3JlIG5vdCB3YWl0aW5nIG9uIGFueXRoaW5nLCByZXNvbHZlIHRoZSBtYXN0ZXJcblx0XHRpZiAoICFyZW1haW5pbmcgKSB7XG5cdFx0XHRkZWZlcnJlZC5yZXNvbHZlV2l0aCggcmVzb2x2ZUNvbnRleHRzLCByZXNvbHZlVmFsdWVzICk7XG5cdFx0fVxuXG5cdFx0cmV0dXJuIGRlZmVycmVkLnByb21pc2UoKTtcblx0fVxufSk7XG5cblxuLy8gVGhlIGRlZmVycmVkIHVzZWQgb24gRE9NIHJlYWR5XG52YXIgcmVhZHlMaXN0O1xuXG5qUXVlcnkuZm4ucmVhZHkgPSBmdW5jdGlvbiggZm4gKSB7XG5cdC8vIEFkZCB0aGUgY2FsbGJhY2tcblx0alF1ZXJ5LnJlYWR5LnByb21pc2UoKS5kb25lKCBmbiApO1xuXG5cdHJldHVybiB0aGlzO1xufTtcblxualF1ZXJ5LmV4dGVuZCh7XG5cdC8vIElzIHRoZSBET00gcmVhZHkgdG8gYmUgdXNlZD8gU2V0IHRvIHRydWUgb25jZSBpdCBvY2N1cnMuXG5cdGlzUmVhZHk6IGZhbHNlLFxuXG5cdC8vIEEgY291bnRlciB0byB0cmFjayBob3cgbWFueSBpdGVtcyB0byB3YWl0IGZvciBiZWZvcmVcblx0Ly8gdGhlIHJlYWR5IGV2ZW50IGZpcmVzLiBTZWUgIzY3ODFcblx0cmVhZHlXYWl0OiAxLFxuXG5cdC8vIEhvbGQgKG9yIHJlbGVhc2UpIHRoZSByZWFkeSBldmVudFxuXHRob2xkUmVhZHk6IGZ1bmN0aW9uKCBob2xkICkge1xuXHRcdGlmICggaG9sZCApIHtcblx0XHRcdGpRdWVyeS5yZWFkeVdhaXQrKztcblx0XHR9IGVsc2Uge1xuXHRcdFx0alF1ZXJ5LnJlYWR5KCB0cnVlICk7XG5cdFx0fVxuXHR9LFxuXG5cdC8vIEhhbmRsZSB3aGVuIHRoZSBET00gaXMgcmVhZHlcblx0cmVhZHk6IGZ1bmN0aW9uKCB3YWl0ICkge1xuXG5cdFx0Ly8gQWJvcnQgaWYgdGhlcmUgYXJlIHBlbmRpbmcgaG9sZHMgb3Igd2UncmUgYWxyZWFkeSByZWFkeVxuXHRcdGlmICggd2FpdCA9PT0gdHJ1ZSA/IC0talF1ZXJ5LnJlYWR5V2FpdCA6IGpRdWVyeS5pc1JlYWR5ICkge1xuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblxuXHRcdC8vIFJlbWVtYmVyIHRoYXQgdGhlIERPTSBpcyByZWFkeVxuXHRcdGpRdWVyeS5pc1JlYWR5ID0gdHJ1ZTtcblxuXHRcdC8vIElmIGEgbm9ybWFsIERPTSBSZWFkeSBldmVudCBmaXJlZCwgZGVjcmVtZW50LCBhbmQgd2FpdCBpZiBuZWVkIGJlXG5cdFx0aWYgKCB3YWl0ICE9PSB0cnVlICYmIC0talF1ZXJ5LnJlYWR5V2FpdCA+IDAgKSB7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXG5cdFx0Ly8gSWYgdGhlcmUgYXJlIGZ1bmN0aW9ucyBib3VuZCwgdG8gZXhlY3V0ZVxuXHRcdHJlYWR5TGlzdC5yZXNvbHZlV2l0aCggZG9jdW1lbnQsIFsgalF1ZXJ5IF0gKTtcblxuXHRcdC8vIFRyaWdnZXIgYW55IGJvdW5kIHJlYWR5IGV2ZW50c1xuXHRcdGlmICggalF1ZXJ5LmZuLnRyaWdnZXJIYW5kbGVyICkge1xuXHRcdFx0alF1ZXJ5KCBkb2N1bWVudCApLnRyaWdnZXJIYW5kbGVyKCBcInJlYWR5XCIgKTtcblx0XHRcdGpRdWVyeSggZG9jdW1lbnQgKS5vZmYoIFwicmVhZHlcIiApO1xuXHRcdH1cblx0fVxufSk7XG5cbi8qKlxuICogVGhlIHJlYWR5IGV2ZW50IGhhbmRsZXIgYW5kIHNlbGYgY2xlYW51cCBtZXRob2RcbiAqL1xuZnVuY3Rpb24gY29tcGxldGVkKCkge1xuXHRkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCBcIkRPTUNvbnRlbnRMb2FkZWRcIiwgY29tcGxldGVkLCBmYWxzZSApO1xuXHR3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lciggXCJsb2FkXCIsIGNvbXBsZXRlZCwgZmFsc2UgKTtcblx0alF1ZXJ5LnJlYWR5KCk7XG59XG5cbmpRdWVyeS5yZWFkeS5wcm9taXNlID0gZnVuY3Rpb24oIG9iaiApIHtcblx0aWYgKCAhcmVhZHlMaXN0ICkge1xuXG5cdFx0cmVhZHlMaXN0ID0galF1ZXJ5LkRlZmVycmVkKCk7XG5cblx0XHQvLyBDYXRjaCBjYXNlcyB3aGVyZSAkKGRvY3VtZW50KS5yZWFkeSgpIGlzIGNhbGxlZCBhZnRlciB0aGUgYnJvd3NlciBldmVudCBoYXMgYWxyZWFkeSBvY2N1cnJlZC5cblx0XHQvLyBXZSBvbmNlIHRyaWVkIHRvIHVzZSByZWFkeVN0YXRlIFwiaW50ZXJhY3RpdmVcIiBoZXJlLCBidXQgaXQgY2F1c2VkIGlzc3VlcyBsaWtlIHRoZSBvbmVcblx0XHQvLyBkaXNjb3ZlcmVkIGJ5IENocmlzUyBoZXJlOiBodHRwOi8vYnVncy5qcXVlcnkuY29tL3RpY2tldC8xMjI4MiNjb21tZW50OjE1XG5cdFx0aWYgKCBkb2N1bWVudC5yZWFkeVN0YXRlID09PSBcImNvbXBsZXRlXCIgKSB7XG5cdFx0XHQvLyBIYW5kbGUgaXQgYXN5bmNocm9ub3VzbHkgdG8gYWxsb3cgc2NyaXB0cyB0aGUgb3Bwb3J0dW5pdHkgdG8gZGVsYXkgcmVhZHlcblx0XHRcdHNldFRpbWVvdXQoIGpRdWVyeS5yZWFkeSApO1xuXG5cdFx0fSBlbHNlIHtcblxuXHRcdFx0Ly8gVXNlIHRoZSBoYW5keSBldmVudCBjYWxsYmFja1xuXHRcdFx0ZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lciggXCJET01Db250ZW50TG9hZGVkXCIsIGNvbXBsZXRlZCwgZmFsc2UgKTtcblxuXHRcdFx0Ly8gQSBmYWxsYmFjayB0byB3aW5kb3cub25sb2FkLCB0aGF0IHdpbGwgYWx3YXlzIHdvcmtcblx0XHRcdHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCBcImxvYWRcIiwgY29tcGxldGVkLCBmYWxzZSApO1xuXHRcdH1cblx0fVxuXHRyZXR1cm4gcmVhZHlMaXN0LnByb21pc2UoIG9iaiApO1xufTtcblxuLy8gS2ljayBvZmYgdGhlIERPTSByZWFkeSBjaGVjayBldmVuIGlmIHRoZSB1c2VyIGRvZXMgbm90XG5qUXVlcnkucmVhZHkucHJvbWlzZSgpO1xuXG5cblxuXG4vLyBNdWx0aWZ1bmN0aW9uYWwgbWV0aG9kIHRvIGdldCBhbmQgc2V0IHZhbHVlcyBvZiBhIGNvbGxlY3Rpb25cbi8vIFRoZSB2YWx1ZS9zIGNhbiBvcHRpb25hbGx5IGJlIGV4ZWN1dGVkIGlmIGl0J3MgYSBmdW5jdGlvblxudmFyIGFjY2VzcyA9IGpRdWVyeS5hY2Nlc3MgPSBmdW5jdGlvbiggZWxlbXMsIGZuLCBrZXksIHZhbHVlLCBjaGFpbmFibGUsIGVtcHR5R2V0LCByYXcgKSB7XG5cdHZhciBpID0gMCxcblx0XHRsZW4gPSBlbGVtcy5sZW5ndGgsXG5cdFx0YnVsayA9IGtleSA9PSBudWxsO1xuXG5cdC8vIFNldHMgbWFueSB2YWx1ZXNcblx0aWYgKCBqUXVlcnkudHlwZSgga2V5ICkgPT09IFwib2JqZWN0XCIgKSB7XG5cdFx0Y2hhaW5hYmxlID0gdHJ1ZTtcblx0XHRmb3IgKCBpIGluIGtleSApIHtcblx0XHRcdGpRdWVyeS5hY2Nlc3MoIGVsZW1zLCBmbiwgaSwga2V5W2ldLCB0cnVlLCBlbXB0eUdldCwgcmF3ICk7XG5cdFx0fVxuXG5cdC8vIFNldHMgb25lIHZhbHVlXG5cdH0gZWxzZSBpZiAoIHZhbHVlICE9PSB1bmRlZmluZWQgKSB7XG5cdFx0Y2hhaW5hYmxlID0gdHJ1ZTtcblxuXHRcdGlmICggIWpRdWVyeS5pc0Z1bmN0aW9uKCB2YWx1ZSApICkge1xuXHRcdFx0cmF3ID0gdHJ1ZTtcblx0XHR9XG5cblx0XHRpZiAoIGJ1bGsgKSB7XG5cdFx0XHQvLyBCdWxrIG9wZXJhdGlvbnMgcnVuIGFnYWluc3QgdGhlIGVudGlyZSBzZXRcblx0XHRcdGlmICggcmF3ICkge1xuXHRcdFx0XHRmbi5jYWxsKCBlbGVtcywgdmFsdWUgKTtcblx0XHRcdFx0Zm4gPSBudWxsO1xuXG5cdFx0XHQvLyAuLi5leGNlcHQgd2hlbiBleGVjdXRpbmcgZnVuY3Rpb24gdmFsdWVzXG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRidWxrID0gZm47XG5cdFx0XHRcdGZuID0gZnVuY3Rpb24oIGVsZW0sIGtleSwgdmFsdWUgKSB7XG5cdFx0XHRcdFx0cmV0dXJuIGJ1bGsuY2FsbCggalF1ZXJ5KCBlbGVtICksIHZhbHVlICk7XG5cdFx0XHRcdH07XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0aWYgKCBmbiApIHtcblx0XHRcdGZvciAoIDsgaSA8IGxlbjsgaSsrICkge1xuXHRcdFx0XHRmbiggZWxlbXNbaV0sIGtleSwgcmF3ID8gdmFsdWUgOiB2YWx1ZS5jYWxsKCBlbGVtc1tpXSwgaSwgZm4oIGVsZW1zW2ldLCBrZXkgKSApICk7XG5cdFx0XHR9XG5cdFx0fVxuXHR9XG5cblx0cmV0dXJuIGNoYWluYWJsZSA/XG5cdFx0ZWxlbXMgOlxuXG5cdFx0Ly8gR2V0c1xuXHRcdGJ1bGsgP1xuXHRcdFx0Zm4uY2FsbCggZWxlbXMgKSA6XG5cdFx0XHRsZW4gPyBmbiggZWxlbXNbMF0sIGtleSApIDogZW1wdHlHZXQ7XG59O1xuXG5cbi8qKlxuICogRGV0ZXJtaW5lcyB3aGV0aGVyIGFuIG9iamVjdCBjYW4gaGF2ZSBkYXRhXG4gKi9cbmpRdWVyeS5hY2NlcHREYXRhID0gZnVuY3Rpb24oIG93bmVyICkge1xuXHQvLyBBY2NlcHRzIG9ubHk6XG5cdC8vICAtIE5vZGVcblx0Ly8gICAgLSBOb2RlLkVMRU1FTlRfTk9ERVxuXHQvLyAgICAtIE5vZGUuRE9DVU1FTlRfTk9ERVxuXHQvLyAgLSBPYmplY3Rcblx0Ly8gICAgLSBBbnlcblx0LyoganNoaW50IC1XMDE4ICovXG5cdHJldHVybiBvd25lci5ub2RlVHlwZSA9PT0gMSB8fCBvd25lci5ub2RlVHlwZSA9PT0gOSB8fCAhKCArb3duZXIubm9kZVR5cGUgKTtcbn07XG5cblxuZnVuY3Rpb24gRGF0YSgpIHtcblx0Ly8gU3VwcG9ydDogQW5kcm9pZDw0LFxuXHQvLyBPbGQgV2ViS2l0IGRvZXMgbm90IGhhdmUgT2JqZWN0LnByZXZlbnRFeHRlbnNpb25zL2ZyZWV6ZSBtZXRob2QsXG5cdC8vIHJldHVybiBuZXcgZW1wdHkgb2JqZWN0IGluc3RlYWQgd2l0aCBubyBbW3NldF1dIGFjY2Vzc29yXG5cdE9iamVjdC5kZWZpbmVQcm9wZXJ0eSggdGhpcy5jYWNoZSA9IHt9LCAwLCB7XG5cdFx0Z2V0OiBmdW5jdGlvbigpIHtcblx0XHRcdHJldHVybiB7fTtcblx0XHR9XG5cdH0pO1xuXG5cdHRoaXMuZXhwYW5kbyA9IGpRdWVyeS5leHBhbmRvICsgRGF0YS51aWQrKztcbn1cblxuRGF0YS51aWQgPSAxO1xuRGF0YS5hY2NlcHRzID0galF1ZXJ5LmFjY2VwdERhdGE7XG5cbkRhdGEucHJvdG90eXBlID0ge1xuXHRrZXk6IGZ1bmN0aW9uKCBvd25lciApIHtcblx0XHQvLyBXZSBjYW4gYWNjZXB0IGRhdGEgZm9yIG5vbi1lbGVtZW50IG5vZGVzIGluIG1vZGVybiBicm93c2Vycyxcblx0XHQvLyBidXQgd2Ugc2hvdWxkIG5vdCwgc2VlICM4MzM1LlxuXHRcdC8vIEFsd2F5cyByZXR1cm4gdGhlIGtleSBmb3IgYSBmcm96ZW4gb2JqZWN0LlxuXHRcdGlmICggIURhdGEuYWNjZXB0cyggb3duZXIgKSApIHtcblx0XHRcdHJldHVybiAwO1xuXHRcdH1cblxuXHRcdHZhciBkZXNjcmlwdG9yID0ge30sXG5cdFx0XHQvLyBDaGVjayBpZiB0aGUgb3duZXIgb2JqZWN0IGFscmVhZHkgaGFzIGEgY2FjaGUga2V5XG5cdFx0XHR1bmxvY2sgPSBvd25lclsgdGhpcy5leHBhbmRvIF07XG5cblx0XHQvLyBJZiBub3QsIGNyZWF0ZSBvbmVcblx0XHRpZiAoICF1bmxvY2sgKSB7XG5cdFx0XHR1bmxvY2sgPSBEYXRhLnVpZCsrO1xuXG5cdFx0XHQvLyBTZWN1cmUgaXQgaW4gYSBub24tZW51bWVyYWJsZSwgbm9uLXdyaXRhYmxlIHByb3BlcnR5XG5cdFx0XHR0cnkge1xuXHRcdFx0XHRkZXNjcmlwdG9yWyB0aGlzLmV4cGFuZG8gXSA9IHsgdmFsdWU6IHVubG9jayB9O1xuXHRcdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydGllcyggb3duZXIsIGRlc2NyaXB0b3IgKTtcblxuXHRcdFx0Ly8gU3VwcG9ydDogQW5kcm9pZDw0XG5cdFx0XHQvLyBGYWxsYmFjayB0byBhIGxlc3Mgc2VjdXJlIGRlZmluaXRpb25cblx0XHRcdH0gY2F0Y2ggKCBlICkge1xuXHRcdFx0XHRkZXNjcmlwdG9yWyB0aGlzLmV4cGFuZG8gXSA9IHVubG9jaztcblx0XHRcdFx0alF1ZXJ5LmV4dGVuZCggb3duZXIsIGRlc2NyaXB0b3IgKTtcblx0XHRcdH1cblx0XHR9XG5cblx0XHQvLyBFbnN1cmUgdGhlIGNhY2hlIG9iamVjdFxuXHRcdGlmICggIXRoaXMuY2FjaGVbIHVubG9jayBdICkge1xuXHRcdFx0dGhpcy5jYWNoZVsgdW5sb2NrIF0gPSB7fTtcblx0XHR9XG5cblx0XHRyZXR1cm4gdW5sb2NrO1xuXHR9LFxuXHRzZXQ6IGZ1bmN0aW9uKCBvd25lciwgZGF0YSwgdmFsdWUgKSB7XG5cdFx0dmFyIHByb3AsXG5cdFx0XHQvLyBUaGVyZSBtYXkgYmUgYW4gdW5sb2NrIGFzc2lnbmVkIHRvIHRoaXMgbm9kZSxcblx0XHRcdC8vIGlmIHRoZXJlIGlzIG5vIGVudHJ5IGZvciB0aGlzIFwib3duZXJcIiwgY3JlYXRlIG9uZSBpbmxpbmVcblx0XHRcdC8vIGFuZCBzZXQgdGhlIHVubG9jayBhcyB0aG91Z2ggYW4gb3duZXIgZW50cnkgaGFkIGFsd2F5cyBleGlzdGVkXG5cdFx0XHR1bmxvY2sgPSB0aGlzLmtleSggb3duZXIgKSxcblx0XHRcdGNhY2hlID0gdGhpcy5jYWNoZVsgdW5sb2NrIF07XG5cblx0XHQvLyBIYW5kbGU6IFsgb3duZXIsIGtleSwgdmFsdWUgXSBhcmdzXG5cdFx0aWYgKCB0eXBlb2YgZGF0YSA9PT0gXCJzdHJpbmdcIiApIHtcblx0XHRcdGNhY2hlWyBkYXRhIF0gPSB2YWx1ZTtcblxuXHRcdC8vIEhhbmRsZTogWyBvd25lciwgeyBwcm9wZXJ0aWVzIH0gXSBhcmdzXG5cdFx0fSBlbHNlIHtcblx0XHRcdC8vIEZyZXNoIGFzc2lnbm1lbnRzIGJ5IG9iamVjdCBhcmUgc2hhbGxvdyBjb3BpZWRcblx0XHRcdGlmICggalF1ZXJ5LmlzRW1wdHlPYmplY3QoIGNhY2hlICkgKSB7XG5cdFx0XHRcdGpRdWVyeS5leHRlbmQoIHRoaXMuY2FjaGVbIHVubG9jayBdLCBkYXRhICk7XG5cdFx0XHQvLyBPdGhlcndpc2UsIGNvcHkgdGhlIHByb3BlcnRpZXMgb25lLWJ5LW9uZSB0byB0aGUgY2FjaGUgb2JqZWN0XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRmb3IgKCBwcm9wIGluIGRhdGEgKSB7XG5cdFx0XHRcdFx0Y2FjaGVbIHByb3AgXSA9IGRhdGFbIHByb3AgXTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH1cblx0XHRyZXR1cm4gY2FjaGU7XG5cdH0sXG5cdGdldDogZnVuY3Rpb24oIG93bmVyLCBrZXkgKSB7XG5cdFx0Ly8gRWl0aGVyIGEgdmFsaWQgY2FjaGUgaXMgZm91bmQsIG9yIHdpbGwgYmUgY3JlYXRlZC5cblx0XHQvLyBOZXcgY2FjaGVzIHdpbGwgYmUgY3JlYXRlZCBhbmQgdGhlIHVubG9jayByZXR1cm5lZCxcblx0XHQvLyBhbGxvd2luZyBkaXJlY3QgYWNjZXNzIHRvIHRoZSBuZXdseSBjcmVhdGVkXG5cdFx0Ly8gZW1wdHkgZGF0YSBvYmplY3QuIEEgdmFsaWQgb3duZXIgb2JqZWN0IG11c3QgYmUgcHJvdmlkZWQuXG5cdFx0dmFyIGNhY2hlID0gdGhpcy5jYWNoZVsgdGhpcy5rZXkoIG93bmVyICkgXTtcblxuXHRcdHJldHVybiBrZXkgPT09IHVuZGVmaW5lZCA/XG5cdFx0XHRjYWNoZSA6IGNhY2hlWyBrZXkgXTtcblx0fSxcblx0YWNjZXNzOiBmdW5jdGlvbiggb3duZXIsIGtleSwgdmFsdWUgKSB7XG5cdFx0dmFyIHN0b3JlZDtcblx0XHQvLyBJbiBjYXNlcyB3aGVyZSBlaXRoZXI6XG5cdFx0Ly9cblx0XHQvLyAgIDEuIE5vIGtleSB3YXMgc3BlY2lmaWVkXG5cdFx0Ly8gICAyLiBBIHN0cmluZyBrZXkgd2FzIHNwZWNpZmllZCwgYnV0IG5vIHZhbHVlIHByb3ZpZGVkXG5cdFx0Ly9cblx0XHQvLyBUYWtlIHRoZSBcInJlYWRcIiBwYXRoIGFuZCBhbGxvdyB0aGUgZ2V0IG1ldGhvZCB0byBkZXRlcm1pbmVcblx0XHQvLyB3aGljaCB2YWx1ZSB0byByZXR1cm4sIHJlc3BlY3RpdmVseSBlaXRoZXI6XG5cdFx0Ly9cblx0XHQvLyAgIDEuIFRoZSBlbnRpcmUgY2FjaGUgb2JqZWN0XG5cdFx0Ly8gICAyLiBUaGUgZGF0YSBzdG9yZWQgYXQgdGhlIGtleVxuXHRcdC8vXG5cdFx0aWYgKCBrZXkgPT09IHVuZGVmaW5lZCB8fFxuXHRcdFx0XHQoKGtleSAmJiB0eXBlb2Yga2V5ID09PSBcInN0cmluZ1wiKSAmJiB2YWx1ZSA9PT0gdW5kZWZpbmVkKSApIHtcblxuXHRcdFx0c3RvcmVkID0gdGhpcy5nZXQoIG93bmVyLCBrZXkgKTtcblxuXHRcdFx0cmV0dXJuIHN0b3JlZCAhPT0gdW5kZWZpbmVkID9cblx0XHRcdFx0c3RvcmVkIDogdGhpcy5nZXQoIG93bmVyLCBqUXVlcnkuY2FtZWxDYXNlKGtleSkgKTtcblx0XHR9XG5cblx0XHQvLyBbKl1XaGVuIHRoZSBrZXkgaXMgbm90IGEgc3RyaW5nLCBvciBib3RoIGEga2V5IGFuZCB2YWx1ZVxuXHRcdC8vIGFyZSBzcGVjaWZpZWQsIHNldCBvciBleHRlbmQgKGV4aXN0aW5nIG9iamVjdHMpIHdpdGggZWl0aGVyOlxuXHRcdC8vXG5cdFx0Ly8gICAxLiBBbiBvYmplY3Qgb2YgcHJvcGVydGllc1xuXHRcdC8vICAgMi4gQSBrZXkgYW5kIHZhbHVlXG5cdFx0Ly9cblx0XHR0aGlzLnNldCggb3duZXIsIGtleSwgdmFsdWUgKTtcblxuXHRcdC8vIFNpbmNlIHRoZSBcInNldFwiIHBhdGggY2FuIGhhdmUgdHdvIHBvc3NpYmxlIGVudHJ5IHBvaW50c1xuXHRcdC8vIHJldHVybiB0aGUgZXhwZWN0ZWQgZGF0YSBiYXNlZCBvbiB3aGljaCBwYXRoIHdhcyB0YWtlblsqXVxuXHRcdHJldHVybiB2YWx1ZSAhPT0gdW5kZWZpbmVkID8gdmFsdWUgOiBrZXk7XG5cdH0sXG5cdHJlbW92ZTogZnVuY3Rpb24oIG93bmVyLCBrZXkgKSB7XG5cdFx0dmFyIGksIG5hbWUsIGNhbWVsLFxuXHRcdFx0dW5sb2NrID0gdGhpcy5rZXkoIG93bmVyICksXG5cdFx0XHRjYWNoZSA9IHRoaXMuY2FjaGVbIHVubG9jayBdO1xuXG5cdFx0aWYgKCBrZXkgPT09IHVuZGVmaW5lZCApIHtcblx0XHRcdHRoaXMuY2FjaGVbIHVubG9jayBdID0ge307XG5cblx0XHR9IGVsc2Uge1xuXHRcdFx0Ly8gU3VwcG9ydCBhcnJheSBvciBzcGFjZSBzZXBhcmF0ZWQgc3RyaW5nIG9mIGtleXNcblx0XHRcdGlmICggalF1ZXJ5LmlzQXJyYXkoIGtleSApICkge1xuXHRcdFx0XHQvLyBJZiBcIm5hbWVcIiBpcyBhbiBhcnJheSBvZiBrZXlzLi4uXG5cdFx0XHRcdC8vIFdoZW4gZGF0YSBpcyBpbml0aWFsbHkgY3JlYXRlZCwgdmlhIChcImtleVwiLCBcInZhbFwiKSBzaWduYXR1cmUsXG5cdFx0XHRcdC8vIGtleXMgd2lsbCBiZSBjb252ZXJ0ZWQgdG8gY2FtZWxDYXNlLlxuXHRcdFx0XHQvLyBTaW5jZSB0aGVyZSBpcyBubyB3YXkgdG8gdGVsbCBfaG93XyBhIGtleSB3YXMgYWRkZWQsIHJlbW92ZVxuXHRcdFx0XHQvLyBib3RoIHBsYWluIGtleSBhbmQgY2FtZWxDYXNlIGtleS4gIzEyNzg2XG5cdFx0XHRcdC8vIFRoaXMgd2lsbCBvbmx5IHBlbmFsaXplIHRoZSBhcnJheSBhcmd1bWVudCBwYXRoLlxuXHRcdFx0XHRuYW1lID0ga2V5LmNvbmNhdCgga2V5Lm1hcCggalF1ZXJ5LmNhbWVsQ2FzZSApICk7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRjYW1lbCA9IGpRdWVyeS5jYW1lbENhc2UoIGtleSApO1xuXHRcdFx0XHQvLyBUcnkgdGhlIHN0cmluZyBhcyBhIGtleSBiZWZvcmUgYW55IG1hbmlwdWxhdGlvblxuXHRcdFx0XHRpZiAoIGtleSBpbiBjYWNoZSApIHtcblx0XHRcdFx0XHRuYW1lID0gWyBrZXksIGNhbWVsIF07XG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0Ly8gSWYgYSBrZXkgd2l0aCB0aGUgc3BhY2VzIGV4aXN0cywgdXNlIGl0LlxuXHRcdFx0XHRcdC8vIE90aGVyd2lzZSwgY3JlYXRlIGFuIGFycmF5IGJ5IG1hdGNoaW5nIG5vbi13aGl0ZXNwYWNlXG5cdFx0XHRcdFx0bmFtZSA9IGNhbWVsO1xuXHRcdFx0XHRcdG5hbWUgPSBuYW1lIGluIGNhY2hlID9cblx0XHRcdFx0XHRcdFsgbmFtZSBdIDogKCBuYW1lLm1hdGNoKCBybm90d2hpdGUgKSB8fCBbXSApO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cblx0XHRcdGkgPSBuYW1lLmxlbmd0aDtcblx0XHRcdHdoaWxlICggaS0tICkge1xuXHRcdFx0XHRkZWxldGUgY2FjaGVbIG5hbWVbIGkgXSBdO1xuXHRcdFx0fVxuXHRcdH1cblx0fSxcblx0aGFzRGF0YTogZnVuY3Rpb24oIG93bmVyICkge1xuXHRcdHJldHVybiAhalF1ZXJ5LmlzRW1wdHlPYmplY3QoXG5cdFx0XHR0aGlzLmNhY2hlWyBvd25lclsgdGhpcy5leHBhbmRvIF0gXSB8fCB7fVxuXHRcdCk7XG5cdH0sXG5cdGRpc2NhcmQ6IGZ1bmN0aW9uKCBvd25lciApIHtcblx0XHRpZiAoIG93bmVyWyB0aGlzLmV4cGFuZG8gXSApIHtcblx0XHRcdGRlbGV0ZSB0aGlzLmNhY2hlWyBvd25lclsgdGhpcy5leHBhbmRvIF0gXTtcblx0XHR9XG5cdH1cbn07XG52YXIgZGF0YV9wcml2ID0gbmV3IERhdGEoKTtcblxudmFyIGRhdGFfdXNlciA9IG5ldyBEYXRhKCk7XG5cblxuXG4vL1x0SW1wbGVtZW50YXRpb24gU3VtbWFyeVxuLy9cbi8vXHQxLiBFbmZvcmNlIEFQSSBzdXJmYWNlIGFuZCBzZW1hbnRpYyBjb21wYXRpYmlsaXR5IHdpdGggMS45LnggYnJhbmNoXG4vL1x0Mi4gSW1wcm92ZSB0aGUgbW9kdWxlJ3MgbWFpbnRhaW5hYmlsaXR5IGJ5IHJlZHVjaW5nIHRoZSBzdG9yYWdlXG4vL1x0XHRwYXRocyB0byBhIHNpbmdsZSBtZWNoYW5pc20uXG4vL1x0My4gVXNlIHRoZSBzYW1lIHNpbmdsZSBtZWNoYW5pc20gdG8gc3VwcG9ydCBcInByaXZhdGVcIiBhbmQgXCJ1c2VyXCIgZGF0YS5cbi8vXHQ0LiBfTmV2ZXJfIGV4cG9zZSBcInByaXZhdGVcIiBkYXRhIHRvIHVzZXIgY29kZSAoVE9ETzogRHJvcCBfZGF0YSwgX3JlbW92ZURhdGEpXG4vL1x0NS4gQXZvaWQgZXhwb3NpbmcgaW1wbGVtZW50YXRpb24gZGV0YWlscyBvbiB1c2VyIG9iamVjdHMgKGVnLiBleHBhbmRvIHByb3BlcnRpZXMpXG4vL1x0Ni4gUHJvdmlkZSBhIGNsZWFyIHBhdGggZm9yIGltcGxlbWVudGF0aW9uIHVwZ3JhZGUgdG8gV2Vha01hcCBpbiAyMDE0XG5cbnZhciByYnJhY2UgPSAvXig/Olxce1tcXHdcXFddKlxcfXxcXFtbXFx3XFxXXSpcXF0pJC8sXG5cdHJtdWx0aURhc2ggPSAvKFtBLVpdKS9nO1xuXG5mdW5jdGlvbiBkYXRhQXR0ciggZWxlbSwga2V5LCBkYXRhICkge1xuXHR2YXIgbmFtZTtcblxuXHQvLyBJZiBub3RoaW5nIHdhcyBmb3VuZCBpbnRlcm5hbGx5LCB0cnkgdG8gZmV0Y2ggYW55XG5cdC8vIGRhdGEgZnJvbSB0aGUgSFRNTDUgZGF0YS0qIGF0dHJpYnV0ZVxuXHRpZiAoIGRhdGEgPT09IHVuZGVmaW5lZCAmJiBlbGVtLm5vZGVUeXBlID09PSAxICkge1xuXHRcdG5hbWUgPSBcImRhdGEtXCIgKyBrZXkucmVwbGFjZSggcm11bHRpRGFzaCwgXCItJDFcIiApLnRvTG93ZXJDYXNlKCk7XG5cdFx0ZGF0YSA9IGVsZW0uZ2V0QXR0cmlidXRlKCBuYW1lICk7XG5cblx0XHRpZiAoIHR5cGVvZiBkYXRhID09PSBcInN0cmluZ1wiICkge1xuXHRcdFx0dHJ5IHtcblx0XHRcdFx0ZGF0YSA9IGRhdGEgPT09IFwidHJ1ZVwiID8gdHJ1ZSA6XG5cdFx0XHRcdFx0ZGF0YSA9PT0gXCJmYWxzZVwiID8gZmFsc2UgOlxuXHRcdFx0XHRcdGRhdGEgPT09IFwibnVsbFwiID8gbnVsbCA6XG5cdFx0XHRcdFx0Ly8gT25seSBjb252ZXJ0IHRvIGEgbnVtYmVyIGlmIGl0IGRvZXNuJ3QgY2hhbmdlIHRoZSBzdHJpbmdcblx0XHRcdFx0XHQrZGF0YSArIFwiXCIgPT09IGRhdGEgPyArZGF0YSA6XG5cdFx0XHRcdFx0cmJyYWNlLnRlc3QoIGRhdGEgKSA/IGpRdWVyeS5wYXJzZUpTT04oIGRhdGEgKSA6XG5cdFx0XHRcdFx0ZGF0YTtcblx0XHRcdH0gY2F0Y2goIGUgKSB7fVxuXG5cdFx0XHQvLyBNYWtlIHN1cmUgd2Ugc2V0IHRoZSBkYXRhIHNvIGl0IGlzbid0IGNoYW5nZWQgbGF0ZXJcblx0XHRcdGRhdGFfdXNlci5zZXQoIGVsZW0sIGtleSwgZGF0YSApO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRkYXRhID0gdW5kZWZpbmVkO1xuXHRcdH1cblx0fVxuXHRyZXR1cm4gZGF0YTtcbn1cblxualF1ZXJ5LmV4dGVuZCh7XG5cdGhhc0RhdGE6IGZ1bmN0aW9uKCBlbGVtICkge1xuXHRcdHJldHVybiBkYXRhX3VzZXIuaGFzRGF0YSggZWxlbSApIHx8IGRhdGFfcHJpdi5oYXNEYXRhKCBlbGVtICk7XG5cdH0sXG5cblx0ZGF0YTogZnVuY3Rpb24oIGVsZW0sIG5hbWUsIGRhdGEgKSB7XG5cdFx0cmV0dXJuIGRhdGFfdXNlci5hY2Nlc3MoIGVsZW0sIG5hbWUsIGRhdGEgKTtcblx0fSxcblxuXHRyZW1vdmVEYXRhOiBmdW5jdGlvbiggZWxlbSwgbmFtZSApIHtcblx0XHRkYXRhX3VzZXIucmVtb3ZlKCBlbGVtLCBuYW1lICk7XG5cdH0sXG5cblx0Ly8gVE9ETzogTm93IHRoYXQgYWxsIGNhbGxzIHRvIF9kYXRhIGFuZCBfcmVtb3ZlRGF0YSBoYXZlIGJlZW4gcmVwbGFjZWRcblx0Ly8gd2l0aCBkaXJlY3QgY2FsbHMgdG8gZGF0YV9wcml2IG1ldGhvZHMsIHRoZXNlIGNhbiBiZSBkZXByZWNhdGVkLlxuXHRfZGF0YTogZnVuY3Rpb24oIGVsZW0sIG5hbWUsIGRhdGEgKSB7XG5cdFx0cmV0dXJuIGRhdGFfcHJpdi5hY2Nlc3MoIGVsZW0sIG5hbWUsIGRhdGEgKTtcblx0fSxcblxuXHRfcmVtb3ZlRGF0YTogZnVuY3Rpb24oIGVsZW0sIG5hbWUgKSB7XG5cdFx0ZGF0YV9wcml2LnJlbW92ZSggZWxlbSwgbmFtZSApO1xuXHR9XG59KTtcblxualF1ZXJ5LmZuLmV4dGVuZCh7XG5cdGRhdGE6IGZ1bmN0aW9uKCBrZXksIHZhbHVlICkge1xuXHRcdHZhciBpLCBuYW1lLCBkYXRhLFxuXHRcdFx0ZWxlbSA9IHRoaXNbIDAgXSxcblx0XHRcdGF0dHJzID0gZWxlbSAmJiBlbGVtLmF0dHJpYnV0ZXM7XG5cblx0XHQvLyBHZXRzIGFsbCB2YWx1ZXNcblx0XHRpZiAoIGtleSA9PT0gdW5kZWZpbmVkICkge1xuXHRcdFx0aWYgKCB0aGlzLmxlbmd0aCApIHtcblx0XHRcdFx0ZGF0YSA9IGRhdGFfdXNlci5nZXQoIGVsZW0gKTtcblxuXHRcdFx0XHRpZiAoIGVsZW0ubm9kZVR5cGUgPT09IDEgJiYgIWRhdGFfcHJpdi5nZXQoIGVsZW0sIFwiaGFzRGF0YUF0dHJzXCIgKSApIHtcblx0XHRcdFx0XHRpID0gYXR0cnMubGVuZ3RoO1xuXHRcdFx0XHRcdHdoaWxlICggaS0tICkge1xuXG5cdFx0XHRcdFx0XHQvLyBTdXBwb3J0OiBJRTExK1xuXHRcdFx0XHRcdFx0Ly8gVGhlIGF0dHJzIGVsZW1lbnRzIGNhbiBiZSBudWxsICgjMTQ4OTQpXG5cdFx0XHRcdFx0XHRpZiAoIGF0dHJzWyBpIF0gKSB7XG5cdFx0XHRcdFx0XHRcdG5hbWUgPSBhdHRyc1sgaSBdLm5hbWU7XG5cdFx0XHRcdFx0XHRcdGlmICggbmFtZS5pbmRleE9mKCBcImRhdGEtXCIgKSA9PT0gMCApIHtcblx0XHRcdFx0XHRcdFx0XHRuYW1lID0galF1ZXJ5LmNhbWVsQ2FzZSggbmFtZS5zbGljZSg1KSApO1xuXHRcdFx0XHRcdFx0XHRcdGRhdGFBdHRyKCBlbGVtLCBuYW1lLCBkYXRhWyBuYW1lIF0gKTtcblx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHRkYXRhX3ByaXYuc2V0KCBlbGVtLCBcImhhc0RhdGFBdHRyc1wiLCB0cnVlICk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblxuXHRcdFx0cmV0dXJuIGRhdGE7XG5cdFx0fVxuXG5cdFx0Ly8gU2V0cyBtdWx0aXBsZSB2YWx1ZXNcblx0XHRpZiAoIHR5cGVvZiBrZXkgPT09IFwib2JqZWN0XCIgKSB7XG5cdFx0XHRyZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRkYXRhX3VzZXIuc2V0KCB0aGlzLCBrZXkgKTtcblx0XHRcdH0pO1xuXHRcdH1cblxuXHRcdHJldHVybiBhY2Nlc3MoIHRoaXMsIGZ1bmN0aW9uKCB2YWx1ZSApIHtcblx0XHRcdHZhciBkYXRhLFxuXHRcdFx0XHRjYW1lbEtleSA9IGpRdWVyeS5jYW1lbENhc2UoIGtleSApO1xuXG5cdFx0XHQvLyBUaGUgY2FsbGluZyBqUXVlcnkgb2JqZWN0IChlbGVtZW50IG1hdGNoZXMpIGlzIG5vdCBlbXB0eVxuXHRcdFx0Ly8gKGFuZCB0aGVyZWZvcmUgaGFzIGFuIGVsZW1lbnQgYXBwZWFycyBhdCB0aGlzWyAwIF0pIGFuZCB0aGVcblx0XHRcdC8vIGB2YWx1ZWAgcGFyYW1ldGVyIHdhcyBub3QgdW5kZWZpbmVkLiBBbiBlbXB0eSBqUXVlcnkgb2JqZWN0XG5cdFx0XHQvLyB3aWxsIHJlc3VsdCBpbiBgdW5kZWZpbmVkYCBmb3IgZWxlbSA9IHRoaXNbIDAgXSB3aGljaCB3aWxsXG5cdFx0XHQvLyB0aHJvdyBhbiBleGNlcHRpb24gaWYgYW4gYXR0ZW1wdCB0byByZWFkIGEgZGF0YSBjYWNoZSBpcyBtYWRlLlxuXHRcdFx0aWYgKCBlbGVtICYmIHZhbHVlID09PSB1bmRlZmluZWQgKSB7XG5cdFx0XHRcdC8vIEF0dGVtcHQgdG8gZ2V0IGRhdGEgZnJvbSB0aGUgY2FjaGVcblx0XHRcdFx0Ly8gd2l0aCB0aGUga2V5IGFzLWlzXG5cdFx0XHRcdGRhdGEgPSBkYXRhX3VzZXIuZ2V0KCBlbGVtLCBrZXkgKTtcblx0XHRcdFx0aWYgKCBkYXRhICE9PSB1bmRlZmluZWQgKSB7XG5cdFx0XHRcdFx0cmV0dXJuIGRhdGE7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHQvLyBBdHRlbXB0IHRvIGdldCBkYXRhIGZyb20gdGhlIGNhY2hlXG5cdFx0XHRcdC8vIHdpdGggdGhlIGtleSBjYW1lbGl6ZWRcblx0XHRcdFx0ZGF0YSA9IGRhdGFfdXNlci5nZXQoIGVsZW0sIGNhbWVsS2V5ICk7XG5cdFx0XHRcdGlmICggZGF0YSAhPT0gdW5kZWZpbmVkICkge1xuXHRcdFx0XHRcdHJldHVybiBkYXRhO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0Ly8gQXR0ZW1wdCB0byBcImRpc2NvdmVyXCIgdGhlIGRhdGEgaW5cblx0XHRcdFx0Ly8gSFRNTDUgY3VzdG9tIGRhdGEtKiBhdHRyc1xuXHRcdFx0XHRkYXRhID0gZGF0YUF0dHIoIGVsZW0sIGNhbWVsS2V5LCB1bmRlZmluZWQgKTtcblx0XHRcdFx0aWYgKCBkYXRhICE9PSB1bmRlZmluZWQgKSB7XG5cdFx0XHRcdFx0cmV0dXJuIGRhdGE7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHQvLyBXZSB0cmllZCByZWFsbHkgaGFyZCwgYnV0IHRoZSBkYXRhIGRvZXNuJ3QgZXhpc3QuXG5cdFx0XHRcdHJldHVybjtcblx0XHRcdH1cblxuXHRcdFx0Ly8gU2V0IHRoZSBkYXRhLi4uXG5cdFx0XHR0aGlzLmVhY2goZnVuY3Rpb24oKSB7XG5cdFx0XHRcdC8vIEZpcnN0LCBhdHRlbXB0IHRvIHN0b3JlIGEgY29weSBvciByZWZlcmVuY2Ugb2YgYW55XG5cdFx0XHRcdC8vIGRhdGEgdGhhdCBtaWdodCd2ZSBiZWVuIHN0b3JlIHdpdGggYSBjYW1lbENhc2VkIGtleS5cblx0XHRcdFx0dmFyIGRhdGEgPSBkYXRhX3VzZXIuZ2V0KCB0aGlzLCBjYW1lbEtleSApO1xuXG5cdFx0XHRcdC8vIEZvciBIVE1MNSBkYXRhLSogYXR0cmlidXRlIGludGVyb3AsIHdlIGhhdmUgdG9cblx0XHRcdFx0Ly8gc3RvcmUgcHJvcGVydHkgbmFtZXMgd2l0aCBkYXNoZXMgaW4gYSBjYW1lbENhc2UgZm9ybS5cblx0XHRcdFx0Ly8gVGhpcyBtaWdodCBub3QgYXBwbHkgdG8gYWxsIHByb3BlcnRpZXMuLi4qXG5cdFx0XHRcdGRhdGFfdXNlci5zZXQoIHRoaXMsIGNhbWVsS2V5LCB2YWx1ZSApO1xuXG5cdFx0XHRcdC8vICouLi4gSW4gdGhlIGNhc2Ugb2YgcHJvcGVydGllcyB0aGF0IG1pZ2h0IF9hY3R1YWxseV9cblx0XHRcdFx0Ly8gaGF2ZSBkYXNoZXMsIHdlIG5lZWQgdG8gYWxzbyBzdG9yZSBhIGNvcHkgb2YgdGhhdFxuXHRcdFx0XHQvLyB1bmNoYW5nZWQgcHJvcGVydHkuXG5cdFx0XHRcdGlmICgga2V5LmluZGV4T2YoXCItXCIpICE9PSAtMSAmJiBkYXRhICE9PSB1bmRlZmluZWQgKSB7XG5cdFx0XHRcdFx0ZGF0YV91c2VyLnNldCggdGhpcywga2V5LCB2YWx1ZSApO1xuXHRcdFx0XHR9XG5cdFx0XHR9KTtcblx0XHR9LCBudWxsLCB2YWx1ZSwgYXJndW1lbnRzLmxlbmd0aCA+IDEsIG51bGwsIHRydWUgKTtcblx0fSxcblxuXHRyZW1vdmVEYXRhOiBmdW5jdGlvbigga2V5ICkge1xuXHRcdHJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oKSB7XG5cdFx0XHRkYXRhX3VzZXIucmVtb3ZlKCB0aGlzLCBrZXkgKTtcblx0XHR9KTtcblx0fVxufSk7XG5cblxualF1ZXJ5LmV4dGVuZCh7XG5cdHF1ZXVlOiBmdW5jdGlvbiggZWxlbSwgdHlwZSwgZGF0YSApIHtcblx0XHR2YXIgcXVldWU7XG5cblx0XHRpZiAoIGVsZW0gKSB7XG5cdFx0XHR0eXBlID0gKCB0eXBlIHx8IFwiZnhcIiApICsgXCJxdWV1ZVwiO1xuXHRcdFx0cXVldWUgPSBkYXRhX3ByaXYuZ2V0KCBlbGVtLCB0eXBlICk7XG5cblx0XHRcdC8vIFNwZWVkIHVwIGRlcXVldWUgYnkgZ2V0dGluZyBvdXQgcXVpY2tseSBpZiB0aGlzIGlzIGp1c3QgYSBsb29rdXBcblx0XHRcdGlmICggZGF0YSApIHtcblx0XHRcdFx0aWYgKCAhcXVldWUgfHwgalF1ZXJ5LmlzQXJyYXkoIGRhdGEgKSApIHtcblx0XHRcdFx0XHRxdWV1ZSA9IGRhdGFfcHJpdi5hY2Nlc3MoIGVsZW0sIHR5cGUsIGpRdWVyeS5tYWtlQXJyYXkoZGF0YSkgKTtcblx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRxdWV1ZS5wdXNoKCBkYXRhICk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHRcdHJldHVybiBxdWV1ZSB8fCBbXTtcblx0XHR9XG5cdH0sXG5cblx0ZGVxdWV1ZTogZnVuY3Rpb24oIGVsZW0sIHR5cGUgKSB7XG5cdFx0dHlwZSA9IHR5cGUgfHwgXCJmeFwiO1xuXG5cdFx0dmFyIHF1ZXVlID0galF1ZXJ5LnF1ZXVlKCBlbGVtLCB0eXBlICksXG5cdFx0XHRzdGFydExlbmd0aCA9IHF1ZXVlLmxlbmd0aCxcblx0XHRcdGZuID0gcXVldWUuc2hpZnQoKSxcblx0XHRcdGhvb2tzID0galF1ZXJ5Ll9xdWV1ZUhvb2tzKCBlbGVtLCB0eXBlICksXG5cdFx0XHRuZXh0ID0gZnVuY3Rpb24oKSB7XG5cdFx0XHRcdGpRdWVyeS5kZXF1ZXVlKCBlbGVtLCB0eXBlICk7XG5cdFx0XHR9O1xuXG5cdFx0Ly8gSWYgdGhlIGZ4IHF1ZXVlIGlzIGRlcXVldWVkLCBhbHdheXMgcmVtb3ZlIHRoZSBwcm9ncmVzcyBzZW50aW5lbFxuXHRcdGlmICggZm4gPT09IFwiaW5wcm9ncmVzc1wiICkge1xuXHRcdFx0Zm4gPSBxdWV1ZS5zaGlmdCgpO1xuXHRcdFx0c3RhcnRMZW5ndGgtLTtcblx0XHR9XG5cblx0XHRpZiAoIGZuICkge1xuXG5cdFx0XHQvLyBBZGQgYSBwcm9ncmVzcyBzZW50aW5lbCB0byBwcmV2ZW50IHRoZSBmeCBxdWV1ZSBmcm9tIGJlaW5nXG5cdFx0XHQvLyBhdXRvbWF0aWNhbGx5IGRlcXVldWVkXG5cdFx0XHRpZiAoIHR5cGUgPT09IFwiZnhcIiApIHtcblx0XHRcdFx0cXVldWUudW5zaGlmdCggXCJpbnByb2dyZXNzXCIgKTtcblx0XHRcdH1cblxuXHRcdFx0Ly8gQ2xlYXIgdXAgdGhlIGxhc3QgcXVldWUgc3RvcCBmdW5jdGlvblxuXHRcdFx0ZGVsZXRlIGhvb2tzLnN0b3A7XG5cdFx0XHRmbi5jYWxsKCBlbGVtLCBuZXh0LCBob29rcyApO1xuXHRcdH1cblxuXHRcdGlmICggIXN0YXJ0TGVuZ3RoICYmIGhvb2tzICkge1xuXHRcdFx0aG9va3MuZW1wdHkuZmlyZSgpO1xuXHRcdH1cblx0fSxcblxuXHQvLyBOb3QgcHVibGljIC0gZ2VuZXJhdGUgYSBxdWV1ZUhvb2tzIG9iamVjdCwgb3IgcmV0dXJuIHRoZSBjdXJyZW50IG9uZVxuXHRfcXVldWVIb29rczogZnVuY3Rpb24oIGVsZW0sIHR5cGUgKSB7XG5cdFx0dmFyIGtleSA9IHR5cGUgKyBcInF1ZXVlSG9va3NcIjtcblx0XHRyZXR1cm4gZGF0YV9wcml2LmdldCggZWxlbSwga2V5ICkgfHwgZGF0YV9wcml2LmFjY2VzcyggZWxlbSwga2V5LCB7XG5cdFx0XHRlbXB0eTogalF1ZXJ5LkNhbGxiYWNrcyhcIm9uY2UgbWVtb3J5XCIpLmFkZChmdW5jdGlvbigpIHtcblx0XHRcdFx0ZGF0YV9wcml2LnJlbW92ZSggZWxlbSwgWyB0eXBlICsgXCJxdWV1ZVwiLCBrZXkgXSApO1xuXHRcdFx0fSlcblx0XHR9KTtcblx0fVxufSk7XG5cbmpRdWVyeS5mbi5leHRlbmQoe1xuXHRxdWV1ZTogZnVuY3Rpb24oIHR5cGUsIGRhdGEgKSB7XG5cdFx0dmFyIHNldHRlciA9IDI7XG5cblx0XHRpZiAoIHR5cGVvZiB0eXBlICE9PSBcInN0cmluZ1wiICkge1xuXHRcdFx0ZGF0YSA9IHR5cGU7XG5cdFx0XHR0eXBlID0gXCJmeFwiO1xuXHRcdFx0c2V0dGVyLS07XG5cdFx0fVxuXG5cdFx0aWYgKCBhcmd1bWVudHMubGVuZ3RoIDwgc2V0dGVyICkge1xuXHRcdFx0cmV0dXJuIGpRdWVyeS5xdWV1ZSggdGhpc1swXSwgdHlwZSApO1xuXHRcdH1cblxuXHRcdHJldHVybiBkYXRhID09PSB1bmRlZmluZWQgP1xuXHRcdFx0dGhpcyA6XG5cdFx0XHR0aGlzLmVhY2goZnVuY3Rpb24oKSB7XG5cdFx0XHRcdHZhciBxdWV1ZSA9IGpRdWVyeS5xdWV1ZSggdGhpcywgdHlwZSwgZGF0YSApO1xuXG5cdFx0XHRcdC8vIEVuc3VyZSBhIGhvb2tzIGZvciB0aGlzIHF1ZXVlXG5cdFx0XHRcdGpRdWVyeS5fcXVldWVIb29rcyggdGhpcywgdHlwZSApO1xuXG5cdFx0XHRcdGlmICggdHlwZSA9PT0gXCJmeFwiICYmIHF1ZXVlWzBdICE9PSBcImlucHJvZ3Jlc3NcIiApIHtcblx0XHRcdFx0XHRqUXVlcnkuZGVxdWV1ZSggdGhpcywgdHlwZSApO1xuXHRcdFx0XHR9XG5cdFx0XHR9KTtcblx0fSxcblx0ZGVxdWV1ZTogZnVuY3Rpb24oIHR5cGUgKSB7XG5cdFx0cmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbigpIHtcblx0XHRcdGpRdWVyeS5kZXF1ZXVlKCB0aGlzLCB0eXBlICk7XG5cdFx0fSk7XG5cdH0sXG5cdGNsZWFyUXVldWU6IGZ1bmN0aW9uKCB0eXBlICkge1xuXHRcdHJldHVybiB0aGlzLnF1ZXVlKCB0eXBlIHx8IFwiZnhcIiwgW10gKTtcblx0fSxcblx0Ly8gR2V0IGEgcHJvbWlzZSByZXNvbHZlZCB3aGVuIHF1ZXVlcyBvZiBhIGNlcnRhaW4gdHlwZVxuXHQvLyBhcmUgZW1wdGllZCAoZnggaXMgdGhlIHR5cGUgYnkgZGVmYXVsdClcblx0cHJvbWlzZTogZnVuY3Rpb24oIHR5cGUsIG9iaiApIHtcblx0XHR2YXIgdG1wLFxuXHRcdFx0Y291bnQgPSAxLFxuXHRcdFx0ZGVmZXIgPSBqUXVlcnkuRGVmZXJyZWQoKSxcblx0XHRcdGVsZW1lbnRzID0gdGhpcyxcblx0XHRcdGkgPSB0aGlzLmxlbmd0aCxcblx0XHRcdHJlc29sdmUgPSBmdW5jdGlvbigpIHtcblx0XHRcdFx0aWYgKCAhKCAtLWNvdW50ICkgKSB7XG5cdFx0XHRcdFx0ZGVmZXIucmVzb2x2ZVdpdGgoIGVsZW1lbnRzLCBbIGVsZW1lbnRzIF0gKTtcblx0XHRcdFx0fVxuXHRcdFx0fTtcblxuXHRcdGlmICggdHlwZW9mIHR5cGUgIT09IFwic3RyaW5nXCIgKSB7XG5cdFx0XHRvYmogPSB0eXBlO1xuXHRcdFx0dHlwZSA9IHVuZGVmaW5lZDtcblx0XHR9XG5cdFx0dHlwZSA9IHR5cGUgfHwgXCJmeFwiO1xuXG5cdFx0d2hpbGUgKCBpLS0gKSB7XG5cdFx0XHR0bXAgPSBkYXRhX3ByaXYuZ2V0KCBlbGVtZW50c1sgaSBdLCB0eXBlICsgXCJxdWV1ZUhvb2tzXCIgKTtcblx0XHRcdGlmICggdG1wICYmIHRtcC5lbXB0eSApIHtcblx0XHRcdFx0Y291bnQrKztcblx0XHRcdFx0dG1wLmVtcHR5LmFkZCggcmVzb2x2ZSApO1xuXHRcdFx0fVxuXHRcdH1cblx0XHRyZXNvbHZlKCk7XG5cdFx0cmV0dXJuIGRlZmVyLnByb21pc2UoIG9iaiApO1xuXHR9XG59KTtcbnZhciBwbnVtID0gKC9bKy1dPyg/OlxcZCpcXC58KVxcZCsoPzpbZUVdWystXT9cXGQrfCkvKS5zb3VyY2U7XG5cbnZhciBjc3NFeHBhbmQgPSBbIFwiVG9wXCIsIFwiUmlnaHRcIiwgXCJCb3R0b21cIiwgXCJMZWZ0XCIgXTtcblxudmFyIGlzSGlkZGVuID0gZnVuY3Rpb24oIGVsZW0sIGVsICkge1xuXHRcdC8vIGlzSGlkZGVuIG1pZ2h0IGJlIGNhbGxlZCBmcm9tIGpRdWVyeSNmaWx0ZXIgZnVuY3Rpb247XG5cdFx0Ly8gaW4gdGhhdCBjYXNlLCBlbGVtZW50IHdpbGwgYmUgc2Vjb25kIGFyZ3VtZW50XG5cdFx0ZWxlbSA9IGVsIHx8IGVsZW07XG5cdFx0cmV0dXJuIGpRdWVyeS5jc3MoIGVsZW0sIFwiZGlzcGxheVwiICkgPT09IFwibm9uZVwiIHx8ICFqUXVlcnkuY29udGFpbnMoIGVsZW0ub3duZXJEb2N1bWVudCwgZWxlbSApO1xuXHR9O1xuXG52YXIgcmNoZWNrYWJsZVR5cGUgPSAoL14oPzpjaGVja2JveHxyYWRpbykkL2kpO1xuXG5cblxuKGZ1bmN0aW9uKCkge1xuXHR2YXIgZnJhZ21lbnQgPSBkb2N1bWVudC5jcmVhdGVEb2N1bWVudEZyYWdtZW50KCksXG5cdFx0ZGl2ID0gZnJhZ21lbnQuYXBwZW5kQ2hpbGQoIGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoIFwiZGl2XCIgKSApLFxuXHRcdGlucHV0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCggXCJpbnB1dFwiICk7XG5cblx0Ly8gU3VwcG9ydDogU2FmYXJpPD01LjFcblx0Ly8gQ2hlY2sgc3RhdGUgbG9zdCBpZiB0aGUgbmFtZSBpcyBzZXQgKCMxMTIxNylcblx0Ly8gU3VwcG9ydDogV2luZG93cyBXZWIgQXBwcyAoV1dBKVxuXHQvLyBgbmFtZWAgYW5kIGB0eXBlYCBtdXN0IHVzZSAuc2V0QXR0cmlidXRlIGZvciBXV0EgKCMxNDkwMSlcblx0aW5wdXQuc2V0QXR0cmlidXRlKCBcInR5cGVcIiwgXCJyYWRpb1wiICk7XG5cdGlucHV0LnNldEF0dHJpYnV0ZSggXCJjaGVja2VkXCIsIFwiY2hlY2tlZFwiICk7XG5cdGlucHV0LnNldEF0dHJpYnV0ZSggXCJuYW1lXCIsIFwidFwiICk7XG5cblx0ZGl2LmFwcGVuZENoaWxkKCBpbnB1dCApO1xuXG5cdC8vIFN1cHBvcnQ6IFNhZmFyaTw9NS4xLCBBbmRyb2lkPDQuMlxuXHQvLyBPbGRlciBXZWJLaXQgZG9lc24ndCBjbG9uZSBjaGVja2VkIHN0YXRlIGNvcnJlY3RseSBpbiBmcmFnbWVudHNcblx0c3VwcG9ydC5jaGVja0Nsb25lID0gZGl2LmNsb25lTm9kZSggdHJ1ZSApLmNsb25lTm9kZSggdHJ1ZSApLmxhc3RDaGlsZC5jaGVja2VkO1xuXG5cdC8vIFN1cHBvcnQ6IElFPD0xMStcblx0Ly8gTWFrZSBzdXJlIHRleHRhcmVhIChhbmQgY2hlY2tib3gpIGRlZmF1bHRWYWx1ZSBpcyBwcm9wZXJseSBjbG9uZWRcblx0ZGl2LmlubmVySFRNTCA9IFwiPHRleHRhcmVhPng8L3RleHRhcmVhPlwiO1xuXHRzdXBwb3J0Lm5vQ2xvbmVDaGVja2VkID0gISFkaXYuY2xvbmVOb2RlKCB0cnVlICkubGFzdENoaWxkLmRlZmF1bHRWYWx1ZTtcbn0pKCk7XG52YXIgc3RydW5kZWZpbmVkID0gdHlwZW9mIHVuZGVmaW5lZDtcblxuXG5cbnN1cHBvcnQuZm9jdXNpbkJ1YmJsZXMgPSBcIm9uZm9jdXNpblwiIGluIHdpbmRvdztcblxuXG52YXJcblx0cmtleUV2ZW50ID0gL15rZXkvLFxuXHRybW91c2VFdmVudCA9IC9eKD86bW91c2V8cG9pbnRlcnxjb250ZXh0bWVudSl8Y2xpY2svLFxuXHRyZm9jdXNNb3JwaCA9IC9eKD86Zm9jdXNpbmZvY3VzfGZvY3Vzb3V0Ymx1cikkLyxcblx0cnR5cGVuYW1lc3BhY2UgPSAvXihbXi5dKikoPzpcXC4oLispfCkkLztcblxuZnVuY3Rpb24gcmV0dXJuVHJ1ZSgpIHtcblx0cmV0dXJuIHRydWU7XG59XG5cbmZ1bmN0aW9uIHJldHVybkZhbHNlKCkge1xuXHRyZXR1cm4gZmFsc2U7XG59XG5cbmZ1bmN0aW9uIHNhZmVBY3RpdmVFbGVtZW50KCkge1xuXHR0cnkge1xuXHRcdHJldHVybiBkb2N1bWVudC5hY3RpdmVFbGVtZW50O1xuXHR9IGNhdGNoICggZXJyICkgeyB9XG59XG5cbi8qXG4gKiBIZWxwZXIgZnVuY3Rpb25zIGZvciBtYW5hZ2luZyBldmVudHMgLS0gbm90IHBhcnQgb2YgdGhlIHB1YmxpYyBpbnRlcmZhY2UuXG4gKiBQcm9wcyB0byBEZWFuIEVkd2FyZHMnIGFkZEV2ZW50IGxpYnJhcnkgZm9yIG1hbnkgb2YgdGhlIGlkZWFzLlxuICovXG5qUXVlcnkuZXZlbnQgPSB7XG5cblx0Z2xvYmFsOiB7fSxcblxuXHRhZGQ6IGZ1bmN0aW9uKCBlbGVtLCB0eXBlcywgaGFuZGxlciwgZGF0YSwgc2VsZWN0b3IgKSB7XG5cblx0XHR2YXIgaGFuZGxlT2JqSW4sIGV2ZW50SGFuZGxlLCB0bXAsXG5cdFx0XHRldmVudHMsIHQsIGhhbmRsZU9iaixcblx0XHRcdHNwZWNpYWwsIGhhbmRsZXJzLCB0eXBlLCBuYW1lc3BhY2VzLCBvcmlnVHlwZSxcblx0XHRcdGVsZW1EYXRhID0gZGF0YV9wcml2LmdldCggZWxlbSApO1xuXG5cdFx0Ly8gRG9uJ3QgYXR0YWNoIGV2ZW50cyB0byBub0RhdGEgb3IgdGV4dC9jb21tZW50IG5vZGVzIChidXQgYWxsb3cgcGxhaW4gb2JqZWN0cylcblx0XHRpZiAoICFlbGVtRGF0YSApIHtcblx0XHRcdHJldHVybjtcblx0XHR9XG5cblx0XHQvLyBDYWxsZXIgY2FuIHBhc3MgaW4gYW4gb2JqZWN0IG9mIGN1c3RvbSBkYXRhIGluIGxpZXUgb2YgdGhlIGhhbmRsZXJcblx0XHRpZiAoIGhhbmRsZXIuaGFuZGxlciApIHtcblx0XHRcdGhhbmRsZU9iakluID0gaGFuZGxlcjtcblx0XHRcdGhhbmRsZXIgPSBoYW5kbGVPYmpJbi5oYW5kbGVyO1xuXHRcdFx0c2VsZWN0b3IgPSBoYW5kbGVPYmpJbi5zZWxlY3Rvcjtcblx0XHR9XG5cblx0XHQvLyBNYWtlIHN1cmUgdGhhdCB0aGUgaGFuZGxlciBoYXMgYSB1bmlxdWUgSUQsIHVzZWQgdG8gZmluZC9yZW1vdmUgaXQgbGF0ZXJcblx0XHRpZiAoICFoYW5kbGVyLmd1aWQgKSB7XG5cdFx0XHRoYW5kbGVyLmd1aWQgPSBqUXVlcnkuZ3VpZCsrO1xuXHRcdH1cblxuXHRcdC8vIEluaXQgdGhlIGVsZW1lbnQncyBldmVudCBzdHJ1Y3R1cmUgYW5kIG1haW4gaGFuZGxlciwgaWYgdGhpcyBpcyB0aGUgZmlyc3Rcblx0XHRpZiAoICEoZXZlbnRzID0gZWxlbURhdGEuZXZlbnRzKSApIHtcblx0XHRcdGV2ZW50cyA9IGVsZW1EYXRhLmV2ZW50cyA9IHt9O1xuXHRcdH1cblx0XHRpZiAoICEoZXZlbnRIYW5kbGUgPSBlbGVtRGF0YS5oYW5kbGUpICkge1xuXHRcdFx0ZXZlbnRIYW5kbGUgPSBlbGVtRGF0YS5oYW5kbGUgPSBmdW5jdGlvbiggZSApIHtcblx0XHRcdFx0Ly8gRGlzY2FyZCB0aGUgc2Vjb25kIGV2ZW50IG9mIGEgalF1ZXJ5LmV2ZW50LnRyaWdnZXIoKSBhbmRcblx0XHRcdFx0Ly8gd2hlbiBhbiBldmVudCBpcyBjYWxsZWQgYWZ0ZXIgYSBwYWdlIGhhcyB1bmxvYWRlZFxuXHRcdFx0XHRyZXR1cm4gdHlwZW9mIGpRdWVyeSAhPT0gc3RydW5kZWZpbmVkICYmIGpRdWVyeS5ldmVudC50cmlnZ2VyZWQgIT09IGUudHlwZSA/XG5cdFx0XHRcdFx0alF1ZXJ5LmV2ZW50LmRpc3BhdGNoLmFwcGx5KCBlbGVtLCBhcmd1bWVudHMgKSA6IHVuZGVmaW5lZDtcblx0XHRcdH07XG5cdFx0fVxuXG5cdFx0Ly8gSGFuZGxlIG11bHRpcGxlIGV2ZW50cyBzZXBhcmF0ZWQgYnkgYSBzcGFjZVxuXHRcdHR5cGVzID0gKCB0eXBlcyB8fCBcIlwiICkubWF0Y2goIHJub3R3aGl0ZSApIHx8IFsgXCJcIiBdO1xuXHRcdHQgPSB0eXBlcy5sZW5ndGg7XG5cdFx0d2hpbGUgKCB0LS0gKSB7XG5cdFx0XHR0bXAgPSBydHlwZW5hbWVzcGFjZS5leGVjKCB0eXBlc1t0XSApIHx8IFtdO1xuXHRcdFx0dHlwZSA9IG9yaWdUeXBlID0gdG1wWzFdO1xuXHRcdFx0bmFtZXNwYWNlcyA9ICggdG1wWzJdIHx8IFwiXCIgKS5zcGxpdCggXCIuXCIgKS5zb3J0KCk7XG5cblx0XHRcdC8vIFRoZXJlICptdXN0KiBiZSBhIHR5cGUsIG5vIGF0dGFjaGluZyBuYW1lc3BhY2Utb25seSBoYW5kbGVyc1xuXHRcdFx0aWYgKCAhdHlwZSApIHtcblx0XHRcdFx0Y29udGludWU7XG5cdFx0XHR9XG5cblx0XHRcdC8vIElmIGV2ZW50IGNoYW5nZXMgaXRzIHR5cGUsIHVzZSB0aGUgc3BlY2lhbCBldmVudCBoYW5kbGVycyBmb3IgdGhlIGNoYW5nZWQgdHlwZVxuXHRcdFx0c3BlY2lhbCA9IGpRdWVyeS5ldmVudC5zcGVjaWFsWyB0eXBlIF0gfHwge307XG5cblx0XHRcdC8vIElmIHNlbGVjdG9yIGRlZmluZWQsIGRldGVybWluZSBzcGVjaWFsIGV2ZW50IGFwaSB0eXBlLCBvdGhlcndpc2UgZ2l2ZW4gdHlwZVxuXHRcdFx0dHlwZSA9ICggc2VsZWN0b3IgPyBzcGVjaWFsLmRlbGVnYXRlVHlwZSA6IHNwZWNpYWwuYmluZFR5cGUgKSB8fCB0eXBlO1xuXG5cdFx0XHQvLyBVcGRhdGUgc3BlY2lhbCBiYXNlZCBvbiBuZXdseSByZXNldCB0eXBlXG5cdFx0XHRzcGVjaWFsID0galF1ZXJ5LmV2ZW50LnNwZWNpYWxbIHR5cGUgXSB8fCB7fTtcblxuXHRcdFx0Ly8gaGFuZGxlT2JqIGlzIHBhc3NlZCB0byBhbGwgZXZlbnQgaGFuZGxlcnNcblx0XHRcdGhhbmRsZU9iaiA9IGpRdWVyeS5leHRlbmQoe1xuXHRcdFx0XHR0eXBlOiB0eXBlLFxuXHRcdFx0XHRvcmlnVHlwZTogb3JpZ1R5cGUsXG5cdFx0XHRcdGRhdGE6IGRhdGEsXG5cdFx0XHRcdGhhbmRsZXI6IGhhbmRsZXIsXG5cdFx0XHRcdGd1aWQ6IGhhbmRsZXIuZ3VpZCxcblx0XHRcdFx0c2VsZWN0b3I6IHNlbGVjdG9yLFxuXHRcdFx0XHRuZWVkc0NvbnRleHQ6IHNlbGVjdG9yICYmIGpRdWVyeS5leHByLm1hdGNoLm5lZWRzQ29udGV4dC50ZXN0KCBzZWxlY3RvciApLFxuXHRcdFx0XHRuYW1lc3BhY2U6IG5hbWVzcGFjZXMuam9pbihcIi5cIilcblx0XHRcdH0sIGhhbmRsZU9iakluICk7XG5cblx0XHRcdC8vIEluaXQgdGhlIGV2ZW50IGhhbmRsZXIgcXVldWUgaWYgd2UncmUgdGhlIGZpcnN0XG5cdFx0XHRpZiAoICEoaGFuZGxlcnMgPSBldmVudHNbIHR5cGUgXSkgKSB7XG5cdFx0XHRcdGhhbmRsZXJzID0gZXZlbnRzWyB0eXBlIF0gPSBbXTtcblx0XHRcdFx0aGFuZGxlcnMuZGVsZWdhdGVDb3VudCA9IDA7XG5cblx0XHRcdFx0Ly8gT25seSB1c2UgYWRkRXZlbnRMaXN0ZW5lciBpZiB0aGUgc3BlY2lhbCBldmVudHMgaGFuZGxlciByZXR1cm5zIGZhbHNlXG5cdFx0XHRcdGlmICggIXNwZWNpYWwuc2V0dXAgfHwgc3BlY2lhbC5zZXR1cC5jYWxsKCBlbGVtLCBkYXRhLCBuYW1lc3BhY2VzLCBldmVudEhhbmRsZSApID09PSBmYWxzZSApIHtcblx0XHRcdFx0XHRpZiAoIGVsZW0uYWRkRXZlbnRMaXN0ZW5lciApIHtcblx0XHRcdFx0XHRcdGVsZW0uYWRkRXZlbnRMaXN0ZW5lciggdHlwZSwgZXZlbnRIYW5kbGUsIGZhbHNlICk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cdFx0XHR9XG5cblx0XHRcdGlmICggc3BlY2lhbC5hZGQgKSB7XG5cdFx0XHRcdHNwZWNpYWwuYWRkLmNhbGwoIGVsZW0sIGhhbmRsZU9iaiApO1xuXG5cdFx0XHRcdGlmICggIWhhbmRsZU9iai5oYW5kbGVyLmd1aWQgKSB7XG5cdFx0XHRcdFx0aGFuZGxlT2JqLmhhbmRsZXIuZ3VpZCA9IGhhbmRsZXIuZ3VpZDtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXG5cdFx0XHQvLyBBZGQgdG8gdGhlIGVsZW1lbnQncyBoYW5kbGVyIGxpc3QsIGRlbGVnYXRlcyBpbiBmcm9udFxuXHRcdFx0aWYgKCBzZWxlY3RvciApIHtcblx0XHRcdFx0aGFuZGxlcnMuc3BsaWNlKCBoYW5kbGVycy5kZWxlZ2F0ZUNvdW50KyssIDAsIGhhbmRsZU9iaiApO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0aGFuZGxlcnMucHVzaCggaGFuZGxlT2JqICk7XG5cdFx0XHR9XG5cblx0XHRcdC8vIEtlZXAgdHJhY2sgb2Ygd2hpY2ggZXZlbnRzIGhhdmUgZXZlciBiZWVuIHVzZWQsIGZvciBldmVudCBvcHRpbWl6YXRpb25cblx0XHRcdGpRdWVyeS5ldmVudC5nbG9iYWxbIHR5cGUgXSA9IHRydWU7XG5cdFx0fVxuXG5cdH0sXG5cblx0Ly8gRGV0YWNoIGFuIGV2ZW50IG9yIHNldCBvZiBldmVudHMgZnJvbSBhbiBlbGVtZW50XG5cdHJlbW92ZTogZnVuY3Rpb24oIGVsZW0sIHR5cGVzLCBoYW5kbGVyLCBzZWxlY3RvciwgbWFwcGVkVHlwZXMgKSB7XG5cblx0XHR2YXIgaiwgb3JpZ0NvdW50LCB0bXAsXG5cdFx0XHRldmVudHMsIHQsIGhhbmRsZU9iaixcblx0XHRcdHNwZWNpYWwsIGhhbmRsZXJzLCB0eXBlLCBuYW1lc3BhY2VzLCBvcmlnVHlwZSxcblx0XHRcdGVsZW1EYXRhID0gZGF0YV9wcml2Lmhhc0RhdGEoIGVsZW0gKSAmJiBkYXRhX3ByaXYuZ2V0KCBlbGVtICk7XG5cblx0XHRpZiAoICFlbGVtRGF0YSB8fCAhKGV2ZW50cyA9IGVsZW1EYXRhLmV2ZW50cykgKSB7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXG5cdFx0Ly8gT25jZSBmb3IgZWFjaCB0eXBlLm5hbWVzcGFjZSBpbiB0eXBlczsgdHlwZSBtYXkgYmUgb21pdHRlZFxuXHRcdHR5cGVzID0gKCB0eXBlcyB8fCBcIlwiICkubWF0Y2goIHJub3R3aGl0ZSApIHx8IFsgXCJcIiBdO1xuXHRcdHQgPSB0eXBlcy5sZW5ndGg7XG5cdFx0d2hpbGUgKCB0LS0gKSB7XG5cdFx0XHR0bXAgPSBydHlwZW5hbWVzcGFjZS5leGVjKCB0eXBlc1t0XSApIHx8IFtdO1xuXHRcdFx0dHlwZSA9IG9yaWdUeXBlID0gdG1wWzFdO1xuXHRcdFx0bmFtZXNwYWNlcyA9ICggdG1wWzJdIHx8IFwiXCIgKS5zcGxpdCggXCIuXCIgKS5zb3J0KCk7XG5cblx0XHRcdC8vIFVuYmluZCBhbGwgZXZlbnRzIChvbiB0aGlzIG5hbWVzcGFjZSwgaWYgcHJvdmlkZWQpIGZvciB0aGUgZWxlbWVudFxuXHRcdFx0aWYgKCAhdHlwZSApIHtcblx0XHRcdFx0Zm9yICggdHlwZSBpbiBldmVudHMgKSB7XG5cdFx0XHRcdFx0alF1ZXJ5LmV2ZW50LnJlbW92ZSggZWxlbSwgdHlwZSArIHR5cGVzWyB0IF0sIGhhbmRsZXIsIHNlbGVjdG9yLCB0cnVlICk7XG5cdFx0XHRcdH1cblx0XHRcdFx0Y29udGludWU7XG5cdFx0XHR9XG5cblx0XHRcdHNwZWNpYWwgPSBqUXVlcnkuZXZlbnQuc3BlY2lhbFsgdHlwZSBdIHx8IHt9O1xuXHRcdFx0dHlwZSA9ICggc2VsZWN0b3IgPyBzcGVjaWFsLmRlbGVnYXRlVHlwZSA6IHNwZWNpYWwuYmluZFR5cGUgKSB8fCB0eXBlO1xuXHRcdFx0aGFuZGxlcnMgPSBldmVudHNbIHR5cGUgXSB8fCBbXTtcblx0XHRcdHRtcCA9IHRtcFsyXSAmJiBuZXcgUmVnRXhwKCBcIihefFxcXFwuKVwiICsgbmFtZXNwYWNlcy5qb2luKFwiXFxcXC4oPzouKlxcXFwufClcIikgKyBcIihcXFxcLnwkKVwiICk7XG5cblx0XHRcdC8vIFJlbW92ZSBtYXRjaGluZyBldmVudHNcblx0XHRcdG9yaWdDb3VudCA9IGogPSBoYW5kbGVycy5sZW5ndGg7XG5cdFx0XHR3aGlsZSAoIGotLSApIHtcblx0XHRcdFx0aGFuZGxlT2JqID0gaGFuZGxlcnNbIGogXTtcblxuXHRcdFx0XHRpZiAoICggbWFwcGVkVHlwZXMgfHwgb3JpZ1R5cGUgPT09IGhhbmRsZU9iai5vcmlnVHlwZSApICYmXG5cdFx0XHRcdFx0KCAhaGFuZGxlciB8fCBoYW5kbGVyLmd1aWQgPT09IGhhbmRsZU9iai5ndWlkICkgJiZcblx0XHRcdFx0XHQoICF0bXAgfHwgdG1wLnRlc3QoIGhhbmRsZU9iai5uYW1lc3BhY2UgKSApICYmXG5cdFx0XHRcdFx0KCAhc2VsZWN0b3IgfHwgc2VsZWN0b3IgPT09IGhhbmRsZU9iai5zZWxlY3RvciB8fCBzZWxlY3RvciA9PT0gXCIqKlwiICYmIGhhbmRsZU9iai5zZWxlY3RvciApICkge1xuXHRcdFx0XHRcdGhhbmRsZXJzLnNwbGljZSggaiwgMSApO1xuXG5cdFx0XHRcdFx0aWYgKCBoYW5kbGVPYmouc2VsZWN0b3IgKSB7XG5cdFx0XHRcdFx0XHRoYW5kbGVycy5kZWxlZ2F0ZUNvdW50LS07XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdGlmICggc3BlY2lhbC5yZW1vdmUgKSB7XG5cdFx0XHRcdFx0XHRzcGVjaWFsLnJlbW92ZS5jYWxsKCBlbGVtLCBoYW5kbGVPYmogKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdH1cblxuXHRcdFx0Ly8gUmVtb3ZlIGdlbmVyaWMgZXZlbnQgaGFuZGxlciBpZiB3ZSByZW1vdmVkIHNvbWV0aGluZyBhbmQgbm8gbW9yZSBoYW5kbGVycyBleGlzdFxuXHRcdFx0Ly8gKGF2b2lkcyBwb3RlbnRpYWwgZm9yIGVuZGxlc3MgcmVjdXJzaW9uIGR1cmluZyByZW1vdmFsIG9mIHNwZWNpYWwgZXZlbnQgaGFuZGxlcnMpXG5cdFx0XHRpZiAoIG9yaWdDb3VudCAmJiAhaGFuZGxlcnMubGVuZ3RoICkge1xuXHRcdFx0XHRpZiAoICFzcGVjaWFsLnRlYXJkb3duIHx8IHNwZWNpYWwudGVhcmRvd24uY2FsbCggZWxlbSwgbmFtZXNwYWNlcywgZWxlbURhdGEuaGFuZGxlICkgPT09IGZhbHNlICkge1xuXHRcdFx0XHRcdGpRdWVyeS5yZW1vdmVFdmVudCggZWxlbSwgdHlwZSwgZWxlbURhdGEuaGFuZGxlICk7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHRkZWxldGUgZXZlbnRzWyB0eXBlIF07XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0Ly8gUmVtb3ZlIHRoZSBleHBhbmRvIGlmIGl0J3Mgbm8gbG9uZ2VyIHVzZWRcblx0XHRpZiAoIGpRdWVyeS5pc0VtcHR5T2JqZWN0KCBldmVudHMgKSApIHtcblx0XHRcdGRlbGV0ZSBlbGVtRGF0YS5oYW5kbGU7XG5cdFx0XHRkYXRhX3ByaXYucmVtb3ZlKCBlbGVtLCBcImV2ZW50c1wiICk7XG5cdFx0fVxuXHR9LFxuXG5cdHRyaWdnZXI6IGZ1bmN0aW9uKCBldmVudCwgZGF0YSwgZWxlbSwgb25seUhhbmRsZXJzICkge1xuXG5cdFx0dmFyIGksIGN1ciwgdG1wLCBidWJibGVUeXBlLCBvbnR5cGUsIGhhbmRsZSwgc3BlY2lhbCxcblx0XHRcdGV2ZW50UGF0aCA9IFsgZWxlbSB8fCBkb2N1bWVudCBdLFxuXHRcdFx0dHlwZSA9IGhhc093bi5jYWxsKCBldmVudCwgXCJ0eXBlXCIgKSA/IGV2ZW50LnR5cGUgOiBldmVudCxcblx0XHRcdG5hbWVzcGFjZXMgPSBoYXNPd24uY2FsbCggZXZlbnQsIFwibmFtZXNwYWNlXCIgKSA/IGV2ZW50Lm5hbWVzcGFjZS5zcGxpdChcIi5cIikgOiBbXTtcblxuXHRcdGN1ciA9IHRtcCA9IGVsZW0gPSBlbGVtIHx8IGRvY3VtZW50O1xuXG5cdFx0Ly8gRG9uJ3QgZG8gZXZlbnRzIG9uIHRleHQgYW5kIGNvbW1lbnQgbm9kZXNcblx0XHRpZiAoIGVsZW0ubm9kZVR5cGUgPT09IDMgfHwgZWxlbS5ub2RlVHlwZSA9PT0gOCApIHtcblx0XHRcdHJldHVybjtcblx0XHR9XG5cblx0XHQvLyBmb2N1cy9ibHVyIG1vcnBocyB0byBmb2N1c2luL291dDsgZW5zdXJlIHdlJ3JlIG5vdCBmaXJpbmcgdGhlbSByaWdodCBub3dcblx0XHRpZiAoIHJmb2N1c01vcnBoLnRlc3QoIHR5cGUgKyBqUXVlcnkuZXZlbnQudHJpZ2dlcmVkICkgKSB7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXG5cdFx0aWYgKCB0eXBlLmluZGV4T2YoXCIuXCIpID49IDAgKSB7XG5cdFx0XHQvLyBOYW1lc3BhY2VkIHRyaWdnZXI7IGNyZWF0ZSBhIHJlZ2V4cCB0byBtYXRjaCBldmVudCB0eXBlIGluIGhhbmRsZSgpXG5cdFx0XHRuYW1lc3BhY2VzID0gdHlwZS5zcGxpdChcIi5cIik7XG5cdFx0XHR0eXBlID0gbmFtZXNwYWNlcy5zaGlmdCgpO1xuXHRcdFx0bmFtZXNwYWNlcy5zb3J0KCk7XG5cdFx0fVxuXHRcdG9udHlwZSA9IHR5cGUuaW5kZXhPZihcIjpcIikgPCAwICYmIFwib25cIiArIHR5cGU7XG5cblx0XHQvLyBDYWxsZXIgY2FuIHBhc3MgaW4gYSBqUXVlcnkuRXZlbnQgb2JqZWN0LCBPYmplY3QsIG9yIGp1c3QgYW4gZXZlbnQgdHlwZSBzdHJpbmdcblx0XHRldmVudCA9IGV2ZW50WyBqUXVlcnkuZXhwYW5kbyBdID9cblx0XHRcdGV2ZW50IDpcblx0XHRcdG5ldyBqUXVlcnkuRXZlbnQoIHR5cGUsIHR5cGVvZiBldmVudCA9PT0gXCJvYmplY3RcIiAmJiBldmVudCApO1xuXG5cdFx0Ly8gVHJpZ2dlciBiaXRtYXNrOiAmIDEgZm9yIG5hdGl2ZSBoYW5kbGVyczsgJiAyIGZvciBqUXVlcnkgKGFsd2F5cyB0cnVlKVxuXHRcdGV2ZW50LmlzVHJpZ2dlciA9IG9ubHlIYW5kbGVycyA/IDIgOiAzO1xuXHRcdGV2ZW50Lm5hbWVzcGFjZSA9IG5hbWVzcGFjZXMuam9pbihcIi5cIik7XG5cdFx0ZXZlbnQubmFtZXNwYWNlX3JlID0gZXZlbnQubmFtZXNwYWNlID9cblx0XHRcdG5ldyBSZWdFeHAoIFwiKF58XFxcXC4pXCIgKyBuYW1lc3BhY2VzLmpvaW4oXCJcXFxcLig/Oi4qXFxcXC58KVwiKSArIFwiKFxcXFwufCQpXCIgKSA6XG5cdFx0XHRudWxsO1xuXG5cdFx0Ly8gQ2xlYW4gdXAgdGhlIGV2ZW50IGluIGNhc2UgaXQgaXMgYmVpbmcgcmV1c2VkXG5cdFx0ZXZlbnQucmVzdWx0ID0gdW5kZWZpbmVkO1xuXHRcdGlmICggIWV2ZW50LnRhcmdldCApIHtcblx0XHRcdGV2ZW50LnRhcmdldCA9IGVsZW07XG5cdFx0fVxuXG5cdFx0Ly8gQ2xvbmUgYW55IGluY29taW5nIGRhdGEgYW5kIHByZXBlbmQgdGhlIGV2ZW50LCBjcmVhdGluZyB0aGUgaGFuZGxlciBhcmcgbGlzdFxuXHRcdGRhdGEgPSBkYXRhID09IG51bGwgP1xuXHRcdFx0WyBldmVudCBdIDpcblx0XHRcdGpRdWVyeS5tYWtlQXJyYXkoIGRhdGEsIFsgZXZlbnQgXSApO1xuXG5cdFx0Ly8gQWxsb3cgc3BlY2lhbCBldmVudHMgdG8gZHJhdyBvdXRzaWRlIHRoZSBsaW5lc1xuXHRcdHNwZWNpYWwgPSBqUXVlcnkuZXZlbnQuc3BlY2lhbFsgdHlwZSBdIHx8IHt9O1xuXHRcdGlmICggIW9ubHlIYW5kbGVycyAmJiBzcGVjaWFsLnRyaWdnZXIgJiYgc3BlY2lhbC50cmlnZ2VyLmFwcGx5KCBlbGVtLCBkYXRhICkgPT09IGZhbHNlICkge1xuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblxuXHRcdC8vIERldGVybWluZSBldmVudCBwcm9wYWdhdGlvbiBwYXRoIGluIGFkdmFuY2UsIHBlciBXM0MgZXZlbnRzIHNwZWMgKCM5OTUxKVxuXHRcdC8vIEJ1YmJsZSB1cCB0byBkb2N1bWVudCwgdGhlbiB0byB3aW5kb3c7IHdhdGNoIGZvciBhIGdsb2JhbCBvd25lckRvY3VtZW50IHZhciAoIzk3MjQpXG5cdFx0aWYgKCAhb25seUhhbmRsZXJzICYmICFzcGVjaWFsLm5vQnViYmxlICYmICFqUXVlcnkuaXNXaW5kb3coIGVsZW0gKSApIHtcblxuXHRcdFx0YnViYmxlVHlwZSA9IHNwZWNpYWwuZGVsZWdhdGVUeXBlIHx8IHR5cGU7XG5cdFx0XHRpZiAoICFyZm9jdXNNb3JwaC50ZXN0KCBidWJibGVUeXBlICsgdHlwZSApICkge1xuXHRcdFx0XHRjdXIgPSBjdXIucGFyZW50Tm9kZTtcblx0XHRcdH1cblx0XHRcdGZvciAoIDsgY3VyOyBjdXIgPSBjdXIucGFyZW50Tm9kZSApIHtcblx0XHRcdFx0ZXZlbnRQYXRoLnB1c2goIGN1ciApO1xuXHRcdFx0XHR0bXAgPSBjdXI7XG5cdFx0XHR9XG5cblx0XHRcdC8vIE9ubHkgYWRkIHdpbmRvdyBpZiB3ZSBnb3QgdG8gZG9jdW1lbnQgKGUuZy4sIG5vdCBwbGFpbiBvYmogb3IgZGV0YWNoZWQgRE9NKVxuXHRcdFx0aWYgKCB0bXAgPT09IChlbGVtLm93bmVyRG9jdW1lbnQgfHwgZG9jdW1lbnQpICkge1xuXHRcdFx0XHRldmVudFBhdGgucHVzaCggdG1wLmRlZmF1bHRWaWV3IHx8IHRtcC5wYXJlbnRXaW5kb3cgfHwgd2luZG93ICk7XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0Ly8gRmlyZSBoYW5kbGVycyBvbiB0aGUgZXZlbnQgcGF0aFxuXHRcdGkgPSAwO1xuXHRcdHdoaWxlICggKGN1ciA9IGV2ZW50UGF0aFtpKytdKSAmJiAhZXZlbnQuaXNQcm9wYWdhdGlvblN0b3BwZWQoKSApIHtcblxuXHRcdFx0ZXZlbnQudHlwZSA9IGkgPiAxID9cblx0XHRcdFx0YnViYmxlVHlwZSA6XG5cdFx0XHRcdHNwZWNpYWwuYmluZFR5cGUgfHwgdHlwZTtcblxuXHRcdFx0Ly8galF1ZXJ5IGhhbmRsZXJcblx0XHRcdGhhbmRsZSA9ICggZGF0YV9wcml2LmdldCggY3VyLCBcImV2ZW50c1wiICkgfHwge30gKVsgZXZlbnQudHlwZSBdICYmIGRhdGFfcHJpdi5nZXQoIGN1ciwgXCJoYW5kbGVcIiApO1xuXHRcdFx0aWYgKCBoYW5kbGUgKSB7XG5cdFx0XHRcdGhhbmRsZS5hcHBseSggY3VyLCBkYXRhICk7XG5cdFx0XHR9XG5cblx0XHRcdC8vIE5hdGl2ZSBoYW5kbGVyXG5cdFx0XHRoYW5kbGUgPSBvbnR5cGUgJiYgY3VyWyBvbnR5cGUgXTtcblx0XHRcdGlmICggaGFuZGxlICYmIGhhbmRsZS5hcHBseSAmJiBqUXVlcnkuYWNjZXB0RGF0YSggY3VyICkgKSB7XG5cdFx0XHRcdGV2ZW50LnJlc3VsdCA9IGhhbmRsZS5hcHBseSggY3VyLCBkYXRhICk7XG5cdFx0XHRcdGlmICggZXZlbnQucmVzdWx0ID09PSBmYWxzZSApIHtcblx0XHRcdFx0XHRldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fVxuXHRcdGV2ZW50LnR5cGUgPSB0eXBlO1xuXG5cdFx0Ly8gSWYgbm9ib2R5IHByZXZlbnRlZCB0aGUgZGVmYXVsdCBhY3Rpb24sIGRvIGl0IG5vd1xuXHRcdGlmICggIW9ubHlIYW5kbGVycyAmJiAhZXZlbnQuaXNEZWZhdWx0UHJldmVudGVkKCkgKSB7XG5cblx0XHRcdGlmICggKCFzcGVjaWFsLl9kZWZhdWx0IHx8IHNwZWNpYWwuX2RlZmF1bHQuYXBwbHkoIGV2ZW50UGF0aC5wb3AoKSwgZGF0YSApID09PSBmYWxzZSkgJiZcblx0XHRcdFx0alF1ZXJ5LmFjY2VwdERhdGEoIGVsZW0gKSApIHtcblxuXHRcdFx0XHQvLyBDYWxsIGEgbmF0aXZlIERPTSBtZXRob2Qgb24gdGhlIHRhcmdldCB3aXRoIHRoZSBzYW1lIG5hbWUgbmFtZSBhcyB0aGUgZXZlbnQuXG5cdFx0XHRcdC8vIERvbid0IGRvIGRlZmF1bHQgYWN0aW9ucyBvbiB3aW5kb3csIHRoYXQncyB3aGVyZSBnbG9iYWwgdmFyaWFibGVzIGJlICgjNjE3MClcblx0XHRcdFx0aWYgKCBvbnR5cGUgJiYgalF1ZXJ5LmlzRnVuY3Rpb24oIGVsZW1bIHR5cGUgXSApICYmICFqUXVlcnkuaXNXaW5kb3coIGVsZW0gKSApIHtcblxuXHRcdFx0XHRcdC8vIERvbid0IHJlLXRyaWdnZXIgYW4gb25GT08gZXZlbnQgd2hlbiB3ZSBjYWxsIGl0cyBGT08oKSBtZXRob2Rcblx0XHRcdFx0XHR0bXAgPSBlbGVtWyBvbnR5cGUgXTtcblxuXHRcdFx0XHRcdGlmICggdG1wICkge1xuXHRcdFx0XHRcdFx0ZWxlbVsgb250eXBlIF0gPSBudWxsO1xuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdC8vIFByZXZlbnQgcmUtdHJpZ2dlcmluZyBvZiB0aGUgc2FtZSBldmVudCwgc2luY2Ugd2UgYWxyZWFkeSBidWJibGVkIGl0IGFib3ZlXG5cdFx0XHRcdFx0alF1ZXJ5LmV2ZW50LnRyaWdnZXJlZCA9IHR5cGU7XG5cdFx0XHRcdFx0ZWxlbVsgdHlwZSBdKCk7XG5cdFx0XHRcdFx0alF1ZXJ5LmV2ZW50LnRyaWdnZXJlZCA9IHVuZGVmaW5lZDtcblxuXHRcdFx0XHRcdGlmICggdG1wICkge1xuXHRcdFx0XHRcdFx0ZWxlbVsgb250eXBlIF0gPSB0bXA7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0cmV0dXJuIGV2ZW50LnJlc3VsdDtcblx0fSxcblxuXHRkaXNwYXRjaDogZnVuY3Rpb24oIGV2ZW50ICkge1xuXG5cdFx0Ly8gTWFrZSBhIHdyaXRhYmxlIGpRdWVyeS5FdmVudCBmcm9tIHRoZSBuYXRpdmUgZXZlbnQgb2JqZWN0XG5cdFx0ZXZlbnQgPSBqUXVlcnkuZXZlbnQuZml4KCBldmVudCApO1xuXG5cdFx0dmFyIGksIGosIHJldCwgbWF0Y2hlZCwgaGFuZGxlT2JqLFxuXHRcdFx0aGFuZGxlclF1ZXVlID0gW10sXG5cdFx0XHRhcmdzID0gc2xpY2UuY2FsbCggYXJndW1lbnRzICksXG5cdFx0XHRoYW5kbGVycyA9ICggZGF0YV9wcml2LmdldCggdGhpcywgXCJldmVudHNcIiApIHx8IHt9IClbIGV2ZW50LnR5cGUgXSB8fCBbXSxcblx0XHRcdHNwZWNpYWwgPSBqUXVlcnkuZXZlbnQuc3BlY2lhbFsgZXZlbnQudHlwZSBdIHx8IHt9O1xuXG5cdFx0Ly8gVXNlIHRoZSBmaXgtZWQgalF1ZXJ5LkV2ZW50IHJhdGhlciB0aGFuIHRoZSAocmVhZC1vbmx5KSBuYXRpdmUgZXZlbnRcblx0XHRhcmdzWzBdID0gZXZlbnQ7XG5cdFx0ZXZlbnQuZGVsZWdhdGVUYXJnZXQgPSB0aGlzO1xuXG5cdFx0Ly8gQ2FsbCB0aGUgcHJlRGlzcGF0Y2ggaG9vayBmb3IgdGhlIG1hcHBlZCB0eXBlLCBhbmQgbGV0IGl0IGJhaWwgaWYgZGVzaXJlZFxuXHRcdGlmICggc3BlY2lhbC5wcmVEaXNwYXRjaCAmJiBzcGVjaWFsLnByZURpc3BhdGNoLmNhbGwoIHRoaXMsIGV2ZW50ICkgPT09IGZhbHNlICkge1xuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblxuXHRcdC8vIERldGVybWluZSBoYW5kbGVyc1xuXHRcdGhhbmRsZXJRdWV1ZSA9IGpRdWVyeS5ldmVudC5oYW5kbGVycy5jYWxsKCB0aGlzLCBldmVudCwgaGFuZGxlcnMgKTtcblxuXHRcdC8vIFJ1biBkZWxlZ2F0ZXMgZmlyc3Q7IHRoZXkgbWF5IHdhbnQgdG8gc3RvcCBwcm9wYWdhdGlvbiBiZW5lYXRoIHVzXG5cdFx0aSA9IDA7XG5cdFx0d2hpbGUgKCAobWF0Y2hlZCA9IGhhbmRsZXJRdWV1ZVsgaSsrIF0pICYmICFldmVudC5pc1Byb3BhZ2F0aW9uU3RvcHBlZCgpICkge1xuXHRcdFx0ZXZlbnQuY3VycmVudFRhcmdldCA9IG1hdGNoZWQuZWxlbTtcblxuXHRcdFx0aiA9IDA7XG5cdFx0XHR3aGlsZSAoIChoYW5kbGVPYmogPSBtYXRjaGVkLmhhbmRsZXJzWyBqKysgXSkgJiYgIWV2ZW50LmlzSW1tZWRpYXRlUHJvcGFnYXRpb25TdG9wcGVkKCkgKSB7XG5cblx0XHRcdFx0Ly8gVHJpZ2dlcmVkIGV2ZW50IG11c3QgZWl0aGVyIDEpIGhhdmUgbm8gbmFtZXNwYWNlLCBvciAyKSBoYXZlIG5hbWVzcGFjZShzKVxuXHRcdFx0XHQvLyBhIHN1YnNldCBvciBlcXVhbCB0byB0aG9zZSBpbiB0aGUgYm91bmQgZXZlbnQgKGJvdGggY2FuIGhhdmUgbm8gbmFtZXNwYWNlKS5cblx0XHRcdFx0aWYgKCAhZXZlbnQubmFtZXNwYWNlX3JlIHx8IGV2ZW50Lm5hbWVzcGFjZV9yZS50ZXN0KCBoYW5kbGVPYmoubmFtZXNwYWNlICkgKSB7XG5cblx0XHRcdFx0XHRldmVudC5oYW5kbGVPYmogPSBoYW5kbGVPYmo7XG5cdFx0XHRcdFx0ZXZlbnQuZGF0YSA9IGhhbmRsZU9iai5kYXRhO1xuXG5cdFx0XHRcdFx0cmV0ID0gKCAoalF1ZXJ5LmV2ZW50LnNwZWNpYWxbIGhhbmRsZU9iai5vcmlnVHlwZSBdIHx8IHt9KS5oYW5kbGUgfHwgaGFuZGxlT2JqLmhhbmRsZXIgKVxuXHRcdFx0XHRcdFx0XHQuYXBwbHkoIG1hdGNoZWQuZWxlbSwgYXJncyApO1xuXG5cdFx0XHRcdFx0aWYgKCByZXQgIT09IHVuZGVmaW5lZCApIHtcblx0XHRcdFx0XHRcdGlmICggKGV2ZW50LnJlc3VsdCA9IHJldCkgPT09IGZhbHNlICkge1xuXHRcdFx0XHRcdFx0XHRldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuXHRcdFx0XHRcdFx0XHRldmVudC5zdG9wUHJvcGFnYXRpb24oKTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9XG5cblx0XHQvLyBDYWxsIHRoZSBwb3N0RGlzcGF0Y2ggaG9vayBmb3IgdGhlIG1hcHBlZCB0eXBlXG5cdFx0aWYgKCBzcGVjaWFsLnBvc3REaXNwYXRjaCApIHtcblx0XHRcdHNwZWNpYWwucG9zdERpc3BhdGNoLmNhbGwoIHRoaXMsIGV2ZW50ICk7XG5cdFx0fVxuXG5cdFx0cmV0dXJuIGV2ZW50LnJlc3VsdDtcblx0fSxcblxuXHRoYW5kbGVyczogZnVuY3Rpb24oIGV2ZW50LCBoYW5kbGVycyApIHtcblx0XHR2YXIgaSwgbWF0Y2hlcywgc2VsLCBoYW5kbGVPYmosXG5cdFx0XHRoYW5kbGVyUXVldWUgPSBbXSxcblx0XHRcdGRlbGVnYXRlQ291bnQgPSBoYW5kbGVycy5kZWxlZ2F0ZUNvdW50LFxuXHRcdFx0Y3VyID0gZXZlbnQudGFyZ2V0O1xuXG5cdFx0Ly8gRmluZCBkZWxlZ2F0ZSBoYW5kbGVyc1xuXHRcdC8vIEJsYWNrLWhvbGUgU1ZHIDx1c2U+IGluc3RhbmNlIHRyZWVzICgjMTMxODApXG5cdFx0Ly8gQXZvaWQgbm9uLWxlZnQtY2xpY2sgYnViYmxpbmcgaW4gRmlyZWZveCAoIzM4NjEpXG5cdFx0aWYgKCBkZWxlZ2F0ZUNvdW50ICYmIGN1ci5ub2RlVHlwZSAmJiAoIWV2ZW50LmJ1dHRvbiB8fCBldmVudC50eXBlICE9PSBcImNsaWNrXCIpICkge1xuXG5cdFx0XHRmb3IgKCA7IGN1ciAhPT0gdGhpczsgY3VyID0gY3VyLnBhcmVudE5vZGUgfHwgdGhpcyApIHtcblxuXHRcdFx0XHQvLyBEb24ndCBwcm9jZXNzIGNsaWNrcyBvbiBkaXNhYmxlZCBlbGVtZW50cyAoIzY5MTEsICM4MTY1LCAjMTEzODIsICMxMTc2NClcblx0XHRcdFx0aWYgKCBjdXIuZGlzYWJsZWQgIT09IHRydWUgfHwgZXZlbnQudHlwZSAhPT0gXCJjbGlja1wiICkge1xuXHRcdFx0XHRcdG1hdGNoZXMgPSBbXTtcblx0XHRcdFx0XHRmb3IgKCBpID0gMDsgaSA8IGRlbGVnYXRlQ291bnQ7IGkrKyApIHtcblx0XHRcdFx0XHRcdGhhbmRsZU9iaiA9IGhhbmRsZXJzWyBpIF07XG5cblx0XHRcdFx0XHRcdC8vIERvbid0IGNvbmZsaWN0IHdpdGggT2JqZWN0LnByb3RvdHlwZSBwcm9wZXJ0aWVzICgjMTMyMDMpXG5cdFx0XHRcdFx0XHRzZWwgPSBoYW5kbGVPYmouc2VsZWN0b3IgKyBcIiBcIjtcblxuXHRcdFx0XHRcdFx0aWYgKCBtYXRjaGVzWyBzZWwgXSA9PT0gdW5kZWZpbmVkICkge1xuXHRcdFx0XHRcdFx0XHRtYXRjaGVzWyBzZWwgXSA9IGhhbmRsZU9iai5uZWVkc0NvbnRleHQgP1xuXHRcdFx0XHRcdFx0XHRcdGpRdWVyeSggc2VsLCB0aGlzICkuaW5kZXgoIGN1ciApID49IDAgOlxuXHRcdFx0XHRcdFx0XHRcdGpRdWVyeS5maW5kKCBzZWwsIHRoaXMsIG51bGwsIFsgY3VyIF0gKS5sZW5ndGg7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRpZiAoIG1hdGNoZXNbIHNlbCBdICkge1xuXHRcdFx0XHRcdFx0XHRtYXRjaGVzLnB1c2goIGhhbmRsZU9iaiApO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHRpZiAoIG1hdGNoZXMubGVuZ3RoICkge1xuXHRcdFx0XHRcdFx0aGFuZGxlclF1ZXVlLnB1c2goeyBlbGVtOiBjdXIsIGhhbmRsZXJzOiBtYXRjaGVzIH0pO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH1cblxuXHRcdC8vIEFkZCB0aGUgcmVtYWluaW5nIChkaXJlY3RseS1ib3VuZCkgaGFuZGxlcnNcblx0XHRpZiAoIGRlbGVnYXRlQ291bnQgPCBoYW5kbGVycy5sZW5ndGggKSB7XG5cdFx0XHRoYW5kbGVyUXVldWUucHVzaCh7IGVsZW06IHRoaXMsIGhhbmRsZXJzOiBoYW5kbGVycy5zbGljZSggZGVsZWdhdGVDb3VudCApIH0pO1xuXHRcdH1cblxuXHRcdHJldHVybiBoYW5kbGVyUXVldWU7XG5cdH0sXG5cblx0Ly8gSW5jbHVkZXMgc29tZSBldmVudCBwcm9wcyBzaGFyZWQgYnkgS2V5RXZlbnQgYW5kIE1vdXNlRXZlbnRcblx0cHJvcHM6IFwiYWx0S2V5IGJ1YmJsZXMgY2FuY2VsYWJsZSBjdHJsS2V5IGN1cnJlbnRUYXJnZXQgZXZlbnRQaGFzZSBtZXRhS2V5IHJlbGF0ZWRUYXJnZXQgc2hpZnRLZXkgdGFyZ2V0IHRpbWVTdGFtcCB2aWV3IHdoaWNoXCIuc3BsaXQoXCIgXCIpLFxuXG5cdGZpeEhvb2tzOiB7fSxcblxuXHRrZXlIb29rczoge1xuXHRcdHByb3BzOiBcImNoYXIgY2hhckNvZGUga2V5IGtleUNvZGVcIi5zcGxpdChcIiBcIiksXG5cdFx0ZmlsdGVyOiBmdW5jdGlvbiggZXZlbnQsIG9yaWdpbmFsICkge1xuXG5cdFx0XHQvLyBBZGQgd2hpY2ggZm9yIGtleSBldmVudHNcblx0XHRcdGlmICggZXZlbnQud2hpY2ggPT0gbnVsbCApIHtcblx0XHRcdFx0ZXZlbnQud2hpY2ggPSBvcmlnaW5hbC5jaGFyQ29kZSAhPSBudWxsID8gb3JpZ2luYWwuY2hhckNvZGUgOiBvcmlnaW5hbC5rZXlDb2RlO1xuXHRcdFx0fVxuXG5cdFx0XHRyZXR1cm4gZXZlbnQ7XG5cdFx0fVxuXHR9LFxuXG5cdG1vdXNlSG9va3M6IHtcblx0XHRwcm9wczogXCJidXR0b24gYnV0dG9ucyBjbGllbnRYIGNsaWVudFkgb2Zmc2V0WCBvZmZzZXRZIHBhZ2VYIHBhZ2VZIHNjcmVlblggc2NyZWVuWSB0b0VsZW1lbnRcIi5zcGxpdChcIiBcIiksXG5cdFx0ZmlsdGVyOiBmdW5jdGlvbiggZXZlbnQsIG9yaWdpbmFsICkge1xuXHRcdFx0dmFyIGV2ZW50RG9jLCBkb2MsIGJvZHksXG5cdFx0XHRcdGJ1dHRvbiA9IG9yaWdpbmFsLmJ1dHRvbjtcblxuXHRcdFx0Ly8gQ2FsY3VsYXRlIHBhZ2VYL1kgaWYgbWlzc2luZyBhbmQgY2xpZW50WC9ZIGF2YWlsYWJsZVxuXHRcdFx0aWYgKCBldmVudC5wYWdlWCA9PSBudWxsICYmIG9yaWdpbmFsLmNsaWVudFggIT0gbnVsbCApIHtcblx0XHRcdFx0ZXZlbnREb2MgPSBldmVudC50YXJnZXQub3duZXJEb2N1bWVudCB8fCBkb2N1bWVudDtcblx0XHRcdFx0ZG9jID0gZXZlbnREb2MuZG9jdW1lbnRFbGVtZW50O1xuXHRcdFx0XHRib2R5ID0gZXZlbnREb2MuYm9keTtcblxuXHRcdFx0XHRldmVudC5wYWdlWCA9IG9yaWdpbmFsLmNsaWVudFggKyAoIGRvYyAmJiBkb2Muc2Nyb2xsTGVmdCB8fCBib2R5ICYmIGJvZHkuc2Nyb2xsTGVmdCB8fCAwICkgLSAoIGRvYyAmJiBkb2MuY2xpZW50TGVmdCB8fCBib2R5ICYmIGJvZHkuY2xpZW50TGVmdCB8fCAwICk7XG5cdFx0XHRcdGV2ZW50LnBhZ2VZID0gb3JpZ2luYWwuY2xpZW50WSArICggZG9jICYmIGRvYy5zY3JvbGxUb3AgIHx8IGJvZHkgJiYgYm9keS5zY3JvbGxUb3AgIHx8IDAgKSAtICggZG9jICYmIGRvYy5jbGllbnRUb3AgIHx8IGJvZHkgJiYgYm9keS5jbGllbnRUb3AgIHx8IDAgKTtcblx0XHRcdH1cblxuXHRcdFx0Ly8gQWRkIHdoaWNoIGZvciBjbGljazogMSA9PT0gbGVmdDsgMiA9PT0gbWlkZGxlOyAzID09PSByaWdodFxuXHRcdFx0Ly8gTm90ZTogYnV0dG9uIGlzIG5vdCBub3JtYWxpemVkLCBzbyBkb24ndCB1c2UgaXRcblx0XHRcdGlmICggIWV2ZW50LndoaWNoICYmIGJ1dHRvbiAhPT0gdW5kZWZpbmVkICkge1xuXHRcdFx0XHRldmVudC53aGljaCA9ICggYnV0dG9uICYgMSA/IDEgOiAoIGJ1dHRvbiAmIDIgPyAzIDogKCBidXR0b24gJiA0ID8gMiA6IDAgKSApICk7XG5cdFx0XHR9XG5cblx0XHRcdHJldHVybiBldmVudDtcblx0XHR9XG5cdH0sXG5cblx0Zml4OiBmdW5jdGlvbiggZXZlbnQgKSB7XG5cdFx0aWYgKCBldmVudFsgalF1ZXJ5LmV4cGFuZG8gXSApIHtcblx0XHRcdHJldHVybiBldmVudDtcblx0XHR9XG5cblx0XHQvLyBDcmVhdGUgYSB3cml0YWJsZSBjb3B5IG9mIHRoZSBldmVudCBvYmplY3QgYW5kIG5vcm1hbGl6ZSBzb21lIHByb3BlcnRpZXNcblx0XHR2YXIgaSwgcHJvcCwgY29weSxcblx0XHRcdHR5cGUgPSBldmVudC50eXBlLFxuXHRcdFx0b3JpZ2luYWxFdmVudCA9IGV2ZW50LFxuXHRcdFx0Zml4SG9vayA9IHRoaXMuZml4SG9va3NbIHR5cGUgXTtcblxuXHRcdGlmICggIWZpeEhvb2sgKSB7XG5cdFx0XHR0aGlzLmZpeEhvb2tzWyB0eXBlIF0gPSBmaXhIb29rID1cblx0XHRcdFx0cm1vdXNlRXZlbnQudGVzdCggdHlwZSApID8gdGhpcy5tb3VzZUhvb2tzIDpcblx0XHRcdFx0cmtleUV2ZW50LnRlc3QoIHR5cGUgKSA/IHRoaXMua2V5SG9va3MgOlxuXHRcdFx0XHR7fTtcblx0XHR9XG5cdFx0Y29weSA9IGZpeEhvb2sucHJvcHMgPyB0aGlzLnByb3BzLmNvbmNhdCggZml4SG9vay5wcm9wcyApIDogdGhpcy5wcm9wcztcblxuXHRcdGV2ZW50ID0gbmV3IGpRdWVyeS5FdmVudCggb3JpZ2luYWxFdmVudCApO1xuXG5cdFx0aSA9IGNvcHkubGVuZ3RoO1xuXHRcdHdoaWxlICggaS0tICkge1xuXHRcdFx0cHJvcCA9IGNvcHlbIGkgXTtcblx0XHRcdGV2ZW50WyBwcm9wIF0gPSBvcmlnaW5hbEV2ZW50WyBwcm9wIF07XG5cdFx0fVxuXG5cdFx0Ly8gU3VwcG9ydDogQ29yZG92YSAyLjUgKFdlYktpdCkgKCMxMzI1NSlcblx0XHQvLyBBbGwgZXZlbnRzIHNob3VsZCBoYXZlIGEgdGFyZ2V0OyBDb3Jkb3ZhIGRldmljZXJlYWR5IGRvZXNuJ3Rcblx0XHRpZiAoICFldmVudC50YXJnZXQgKSB7XG5cdFx0XHRldmVudC50YXJnZXQgPSBkb2N1bWVudDtcblx0XHR9XG5cblx0XHQvLyBTdXBwb3J0OiBTYWZhcmkgNi4wKywgQ2hyb21lPDI4XG5cdFx0Ly8gVGFyZ2V0IHNob3VsZCBub3QgYmUgYSB0ZXh0IG5vZGUgKCM1MDQsICMxMzE0Mylcblx0XHRpZiAoIGV2ZW50LnRhcmdldC5ub2RlVHlwZSA9PT0gMyApIHtcblx0XHRcdGV2ZW50LnRhcmdldCA9IGV2ZW50LnRhcmdldC5wYXJlbnROb2RlO1xuXHRcdH1cblxuXHRcdHJldHVybiBmaXhIb29rLmZpbHRlciA/IGZpeEhvb2suZmlsdGVyKCBldmVudCwgb3JpZ2luYWxFdmVudCApIDogZXZlbnQ7XG5cdH0sXG5cblx0c3BlY2lhbDoge1xuXHRcdGxvYWQ6IHtcblx0XHRcdC8vIFByZXZlbnQgdHJpZ2dlcmVkIGltYWdlLmxvYWQgZXZlbnRzIGZyb20gYnViYmxpbmcgdG8gd2luZG93LmxvYWRcblx0XHRcdG5vQnViYmxlOiB0cnVlXG5cdFx0fSxcblx0XHRmb2N1czoge1xuXHRcdFx0Ly8gRmlyZSBuYXRpdmUgZXZlbnQgaWYgcG9zc2libGUgc28gYmx1ci9mb2N1cyBzZXF1ZW5jZSBpcyBjb3JyZWN0XG5cdFx0XHR0cmlnZ2VyOiBmdW5jdGlvbigpIHtcblx0XHRcdFx0aWYgKCB0aGlzICE9PSBzYWZlQWN0aXZlRWxlbWVudCgpICYmIHRoaXMuZm9jdXMgKSB7XG5cdFx0XHRcdFx0dGhpcy5mb2N1cygpO1xuXHRcdFx0XHRcdHJldHVybiBmYWxzZTtcblx0XHRcdFx0fVxuXHRcdFx0fSxcblx0XHRcdGRlbGVnYXRlVHlwZTogXCJmb2N1c2luXCJcblx0XHR9LFxuXHRcdGJsdXI6IHtcblx0XHRcdHRyaWdnZXI6IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRpZiAoIHRoaXMgPT09IHNhZmVBY3RpdmVFbGVtZW50KCkgJiYgdGhpcy5ibHVyICkge1xuXHRcdFx0XHRcdHRoaXMuYmx1cigpO1xuXHRcdFx0XHRcdHJldHVybiBmYWxzZTtcblx0XHRcdFx0fVxuXHRcdFx0fSxcblx0XHRcdGRlbGVnYXRlVHlwZTogXCJmb2N1c291dFwiXG5cdFx0fSxcblx0XHRjbGljazoge1xuXHRcdFx0Ly8gRm9yIGNoZWNrYm94LCBmaXJlIG5hdGl2ZSBldmVudCBzbyBjaGVja2VkIHN0YXRlIHdpbGwgYmUgcmlnaHRcblx0XHRcdHRyaWdnZXI6IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRpZiAoIHRoaXMudHlwZSA9PT0gXCJjaGVja2JveFwiICYmIHRoaXMuY2xpY2sgJiYgalF1ZXJ5Lm5vZGVOYW1lKCB0aGlzLCBcImlucHV0XCIgKSApIHtcblx0XHRcdFx0XHR0aGlzLmNsaWNrKCk7XG5cdFx0XHRcdFx0cmV0dXJuIGZhbHNlO1xuXHRcdFx0XHR9XG5cdFx0XHR9LFxuXG5cdFx0XHQvLyBGb3IgY3Jvc3MtYnJvd3NlciBjb25zaXN0ZW5jeSwgZG9uJ3QgZmlyZSBuYXRpdmUgLmNsaWNrKCkgb24gbGlua3Ncblx0XHRcdF9kZWZhdWx0OiBmdW5jdGlvbiggZXZlbnQgKSB7XG5cdFx0XHRcdHJldHVybiBqUXVlcnkubm9kZU5hbWUoIGV2ZW50LnRhcmdldCwgXCJhXCIgKTtcblx0XHRcdH1cblx0XHR9LFxuXG5cdFx0YmVmb3JldW5sb2FkOiB7XG5cdFx0XHRwb3N0RGlzcGF0Y2g6IGZ1bmN0aW9uKCBldmVudCApIHtcblxuXHRcdFx0XHQvLyBTdXBwb3J0OiBGaXJlZm94IDIwK1xuXHRcdFx0XHQvLyBGaXJlZm94IGRvZXNuJ3QgYWxlcnQgaWYgdGhlIHJldHVyblZhbHVlIGZpZWxkIGlzIG5vdCBzZXQuXG5cdFx0XHRcdGlmICggZXZlbnQucmVzdWx0ICE9PSB1bmRlZmluZWQgJiYgZXZlbnQub3JpZ2luYWxFdmVudCApIHtcblx0XHRcdFx0XHRldmVudC5vcmlnaW5hbEV2ZW50LnJldHVyblZhbHVlID0gZXZlbnQucmVzdWx0O1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fVxuXHR9LFxuXG5cdHNpbXVsYXRlOiBmdW5jdGlvbiggdHlwZSwgZWxlbSwgZXZlbnQsIGJ1YmJsZSApIHtcblx0XHQvLyBQaWdneWJhY2sgb24gYSBkb25vciBldmVudCB0byBzaW11bGF0ZSBhIGRpZmZlcmVudCBvbmUuXG5cdFx0Ly8gRmFrZSBvcmlnaW5hbEV2ZW50IHRvIGF2b2lkIGRvbm9yJ3Mgc3RvcFByb3BhZ2F0aW9uLCBidXQgaWYgdGhlXG5cdFx0Ly8gc2ltdWxhdGVkIGV2ZW50IHByZXZlbnRzIGRlZmF1bHQgdGhlbiB3ZSBkbyB0aGUgc2FtZSBvbiB0aGUgZG9ub3IuXG5cdFx0dmFyIGUgPSBqUXVlcnkuZXh0ZW5kKFxuXHRcdFx0bmV3IGpRdWVyeS5FdmVudCgpLFxuXHRcdFx0ZXZlbnQsXG5cdFx0XHR7XG5cdFx0XHRcdHR5cGU6IHR5cGUsXG5cdFx0XHRcdGlzU2ltdWxhdGVkOiB0cnVlLFxuXHRcdFx0XHRvcmlnaW5hbEV2ZW50OiB7fVxuXHRcdFx0fVxuXHRcdCk7XG5cdFx0aWYgKCBidWJibGUgKSB7XG5cdFx0XHRqUXVlcnkuZXZlbnQudHJpZ2dlciggZSwgbnVsbCwgZWxlbSApO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRqUXVlcnkuZXZlbnQuZGlzcGF0Y2guY2FsbCggZWxlbSwgZSApO1xuXHRcdH1cblx0XHRpZiAoIGUuaXNEZWZhdWx0UHJldmVudGVkKCkgKSB7XG5cdFx0XHRldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuXHRcdH1cblx0fVxufTtcblxualF1ZXJ5LnJlbW92ZUV2ZW50ID0gZnVuY3Rpb24oIGVsZW0sIHR5cGUsIGhhbmRsZSApIHtcblx0aWYgKCBlbGVtLnJlbW92ZUV2ZW50TGlzdGVuZXIgKSB7XG5cdFx0ZWxlbS5yZW1vdmVFdmVudExpc3RlbmVyKCB0eXBlLCBoYW5kbGUsIGZhbHNlICk7XG5cdH1cbn07XG5cbmpRdWVyeS5FdmVudCA9IGZ1bmN0aW9uKCBzcmMsIHByb3BzICkge1xuXHQvLyBBbGxvdyBpbnN0YW50aWF0aW9uIHdpdGhvdXQgdGhlICduZXcnIGtleXdvcmRcblx0aWYgKCAhKHRoaXMgaW5zdGFuY2VvZiBqUXVlcnkuRXZlbnQpICkge1xuXHRcdHJldHVybiBuZXcgalF1ZXJ5LkV2ZW50KCBzcmMsIHByb3BzICk7XG5cdH1cblxuXHQvLyBFdmVudCBvYmplY3Rcblx0aWYgKCBzcmMgJiYgc3JjLnR5cGUgKSB7XG5cdFx0dGhpcy5vcmlnaW5hbEV2ZW50ID0gc3JjO1xuXHRcdHRoaXMudHlwZSA9IHNyYy50eXBlO1xuXG5cdFx0Ly8gRXZlbnRzIGJ1YmJsaW5nIHVwIHRoZSBkb2N1bWVudCBtYXkgaGF2ZSBiZWVuIG1hcmtlZCBhcyBwcmV2ZW50ZWRcblx0XHQvLyBieSBhIGhhbmRsZXIgbG93ZXIgZG93biB0aGUgdHJlZTsgcmVmbGVjdCB0aGUgY29ycmVjdCB2YWx1ZS5cblx0XHR0aGlzLmlzRGVmYXVsdFByZXZlbnRlZCA9IHNyYy5kZWZhdWx0UHJldmVudGVkIHx8XG5cdFx0XHRcdHNyYy5kZWZhdWx0UHJldmVudGVkID09PSB1bmRlZmluZWQgJiZcblx0XHRcdFx0Ly8gU3VwcG9ydDogQW5kcm9pZDw0LjBcblx0XHRcdFx0c3JjLnJldHVyblZhbHVlID09PSBmYWxzZSA/XG5cdFx0XHRyZXR1cm5UcnVlIDpcblx0XHRcdHJldHVybkZhbHNlO1xuXG5cdC8vIEV2ZW50IHR5cGVcblx0fSBlbHNlIHtcblx0XHR0aGlzLnR5cGUgPSBzcmM7XG5cdH1cblxuXHQvLyBQdXQgZXhwbGljaXRseSBwcm92aWRlZCBwcm9wZXJ0aWVzIG9udG8gdGhlIGV2ZW50IG9iamVjdFxuXHRpZiAoIHByb3BzICkge1xuXHRcdGpRdWVyeS5leHRlbmQoIHRoaXMsIHByb3BzICk7XG5cdH1cblxuXHQvLyBDcmVhdGUgYSB0aW1lc3RhbXAgaWYgaW5jb21pbmcgZXZlbnQgZG9lc24ndCBoYXZlIG9uZVxuXHR0aGlzLnRpbWVTdGFtcCA9IHNyYyAmJiBzcmMudGltZVN0YW1wIHx8IGpRdWVyeS5ub3coKTtcblxuXHQvLyBNYXJrIGl0IGFzIGZpeGVkXG5cdHRoaXNbIGpRdWVyeS5leHBhbmRvIF0gPSB0cnVlO1xufTtcblxuLy8galF1ZXJ5LkV2ZW50IGlzIGJhc2VkIG9uIERPTTMgRXZlbnRzIGFzIHNwZWNpZmllZCBieSB0aGUgRUNNQVNjcmlwdCBMYW5ndWFnZSBCaW5kaW5nXG4vLyBodHRwOi8vd3d3LnczLm9yZy9UUi8yMDAzL1dELURPTS1MZXZlbC0zLUV2ZW50cy0yMDAzMDMzMS9lY21hLXNjcmlwdC1iaW5kaW5nLmh0bWxcbmpRdWVyeS5FdmVudC5wcm90b3R5cGUgPSB7XG5cdGlzRGVmYXVsdFByZXZlbnRlZDogcmV0dXJuRmFsc2UsXG5cdGlzUHJvcGFnYXRpb25TdG9wcGVkOiByZXR1cm5GYWxzZSxcblx0aXNJbW1lZGlhdGVQcm9wYWdhdGlvblN0b3BwZWQ6IHJldHVybkZhbHNlLFxuXG5cdHByZXZlbnREZWZhdWx0OiBmdW5jdGlvbigpIHtcblx0XHR2YXIgZSA9IHRoaXMub3JpZ2luYWxFdmVudDtcblxuXHRcdHRoaXMuaXNEZWZhdWx0UHJldmVudGVkID0gcmV0dXJuVHJ1ZTtcblxuXHRcdGlmICggZSAmJiBlLnByZXZlbnREZWZhdWx0ICkge1xuXHRcdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xuXHRcdH1cblx0fSxcblx0c3RvcFByb3BhZ2F0aW9uOiBmdW5jdGlvbigpIHtcblx0XHR2YXIgZSA9IHRoaXMub3JpZ2luYWxFdmVudDtcblxuXHRcdHRoaXMuaXNQcm9wYWdhdGlvblN0b3BwZWQgPSByZXR1cm5UcnVlO1xuXG5cdFx0aWYgKCBlICYmIGUuc3RvcFByb3BhZ2F0aW9uICkge1xuXHRcdFx0ZS5zdG9wUHJvcGFnYXRpb24oKTtcblx0XHR9XG5cdH0sXG5cdHN0b3BJbW1lZGlhdGVQcm9wYWdhdGlvbjogZnVuY3Rpb24oKSB7XG5cdFx0dmFyIGUgPSB0aGlzLm9yaWdpbmFsRXZlbnQ7XG5cblx0XHR0aGlzLmlzSW1tZWRpYXRlUHJvcGFnYXRpb25TdG9wcGVkID0gcmV0dXJuVHJ1ZTtcblxuXHRcdGlmICggZSAmJiBlLnN0b3BJbW1lZGlhdGVQcm9wYWdhdGlvbiApIHtcblx0XHRcdGUuc3RvcEltbWVkaWF0ZVByb3BhZ2F0aW9uKCk7XG5cdFx0fVxuXG5cdFx0dGhpcy5zdG9wUHJvcGFnYXRpb24oKTtcblx0fVxufTtcblxuLy8gQ3JlYXRlIG1vdXNlZW50ZXIvbGVhdmUgZXZlbnRzIHVzaW5nIG1vdXNlb3Zlci9vdXQgYW5kIGV2ZW50LXRpbWUgY2hlY2tzXG4vLyBTdXBwb3J0OiBDaHJvbWUgMTUrXG5qUXVlcnkuZWFjaCh7XG5cdG1vdXNlZW50ZXI6IFwibW91c2VvdmVyXCIsXG5cdG1vdXNlbGVhdmU6IFwibW91c2VvdXRcIixcblx0cG9pbnRlcmVudGVyOiBcInBvaW50ZXJvdmVyXCIsXG5cdHBvaW50ZXJsZWF2ZTogXCJwb2ludGVyb3V0XCJcbn0sIGZ1bmN0aW9uKCBvcmlnLCBmaXggKSB7XG5cdGpRdWVyeS5ldmVudC5zcGVjaWFsWyBvcmlnIF0gPSB7XG5cdFx0ZGVsZWdhdGVUeXBlOiBmaXgsXG5cdFx0YmluZFR5cGU6IGZpeCxcblxuXHRcdGhhbmRsZTogZnVuY3Rpb24oIGV2ZW50ICkge1xuXHRcdFx0dmFyIHJldCxcblx0XHRcdFx0dGFyZ2V0ID0gdGhpcyxcblx0XHRcdFx0cmVsYXRlZCA9IGV2ZW50LnJlbGF0ZWRUYXJnZXQsXG5cdFx0XHRcdGhhbmRsZU9iaiA9IGV2ZW50LmhhbmRsZU9iajtcblxuXHRcdFx0Ly8gRm9yIG1vdXNlbnRlci9sZWF2ZSBjYWxsIHRoZSBoYW5kbGVyIGlmIHJlbGF0ZWQgaXMgb3V0c2lkZSB0aGUgdGFyZ2V0LlxuXHRcdFx0Ly8gTkI6IE5vIHJlbGF0ZWRUYXJnZXQgaWYgdGhlIG1vdXNlIGxlZnQvZW50ZXJlZCB0aGUgYnJvd3NlciB3aW5kb3dcblx0XHRcdGlmICggIXJlbGF0ZWQgfHwgKHJlbGF0ZWQgIT09IHRhcmdldCAmJiAhalF1ZXJ5LmNvbnRhaW5zKCB0YXJnZXQsIHJlbGF0ZWQgKSkgKSB7XG5cdFx0XHRcdGV2ZW50LnR5cGUgPSBoYW5kbGVPYmoub3JpZ1R5cGU7XG5cdFx0XHRcdHJldCA9IGhhbmRsZU9iai5oYW5kbGVyLmFwcGx5KCB0aGlzLCBhcmd1bWVudHMgKTtcblx0XHRcdFx0ZXZlbnQudHlwZSA9IGZpeDtcblx0XHRcdH1cblx0XHRcdHJldHVybiByZXQ7XG5cdFx0fVxuXHR9O1xufSk7XG5cbi8vIFN1cHBvcnQ6IEZpcmVmb3gsIENocm9tZSwgU2FmYXJpXG4vLyBDcmVhdGUgXCJidWJibGluZ1wiIGZvY3VzIGFuZCBibHVyIGV2ZW50c1xuaWYgKCAhc3VwcG9ydC5mb2N1c2luQnViYmxlcyApIHtcblx0alF1ZXJ5LmVhY2goeyBmb2N1czogXCJmb2N1c2luXCIsIGJsdXI6IFwiZm9jdXNvdXRcIiB9LCBmdW5jdGlvbiggb3JpZywgZml4ICkge1xuXG5cdFx0Ly8gQXR0YWNoIGEgc2luZ2xlIGNhcHR1cmluZyBoYW5kbGVyIG9uIHRoZSBkb2N1bWVudCB3aGlsZSBzb21lb25lIHdhbnRzIGZvY3VzaW4vZm9jdXNvdXRcblx0XHR2YXIgaGFuZGxlciA9IGZ1bmN0aW9uKCBldmVudCApIHtcblx0XHRcdFx0alF1ZXJ5LmV2ZW50LnNpbXVsYXRlKCBmaXgsIGV2ZW50LnRhcmdldCwgalF1ZXJ5LmV2ZW50LmZpeCggZXZlbnQgKSwgdHJ1ZSApO1xuXHRcdFx0fTtcblxuXHRcdGpRdWVyeS5ldmVudC5zcGVjaWFsWyBmaXggXSA9IHtcblx0XHRcdHNldHVwOiBmdW5jdGlvbigpIHtcblx0XHRcdFx0dmFyIGRvYyA9IHRoaXMub3duZXJEb2N1bWVudCB8fCB0aGlzLFxuXHRcdFx0XHRcdGF0dGFjaGVzID0gZGF0YV9wcml2LmFjY2VzcyggZG9jLCBmaXggKTtcblxuXHRcdFx0XHRpZiAoICFhdHRhY2hlcyApIHtcblx0XHRcdFx0XHRkb2MuYWRkRXZlbnRMaXN0ZW5lciggb3JpZywgaGFuZGxlciwgdHJ1ZSApO1xuXHRcdFx0XHR9XG5cdFx0XHRcdGRhdGFfcHJpdi5hY2Nlc3MoIGRvYywgZml4LCAoIGF0dGFjaGVzIHx8IDAgKSArIDEgKTtcblx0XHRcdH0sXG5cdFx0XHR0ZWFyZG93bjogZnVuY3Rpb24oKSB7XG5cdFx0XHRcdHZhciBkb2MgPSB0aGlzLm93bmVyRG9jdW1lbnQgfHwgdGhpcyxcblx0XHRcdFx0XHRhdHRhY2hlcyA9IGRhdGFfcHJpdi5hY2Nlc3MoIGRvYywgZml4ICkgLSAxO1xuXG5cdFx0XHRcdGlmICggIWF0dGFjaGVzICkge1xuXHRcdFx0XHRcdGRvYy5yZW1vdmVFdmVudExpc3RlbmVyKCBvcmlnLCBoYW5kbGVyLCB0cnVlICk7XG5cdFx0XHRcdFx0ZGF0YV9wcml2LnJlbW92ZSggZG9jLCBmaXggKTtcblxuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdGRhdGFfcHJpdi5hY2Nlc3MoIGRvYywgZml4LCBhdHRhY2hlcyApO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fTtcblx0fSk7XG59XG5cbmpRdWVyeS5mbi5leHRlbmQoe1xuXG5cdG9uOiBmdW5jdGlvbiggdHlwZXMsIHNlbGVjdG9yLCBkYXRhLCBmbiwgLypJTlRFUk5BTCovIG9uZSApIHtcblx0XHR2YXIgb3JpZ0ZuLCB0eXBlO1xuXG5cdFx0Ly8gVHlwZXMgY2FuIGJlIGEgbWFwIG9mIHR5cGVzL2hhbmRsZXJzXG5cdFx0aWYgKCB0eXBlb2YgdHlwZXMgPT09IFwib2JqZWN0XCIgKSB7XG5cdFx0XHQvLyAoIHR5cGVzLU9iamVjdCwgc2VsZWN0b3IsIGRhdGEgKVxuXHRcdFx0aWYgKCB0eXBlb2Ygc2VsZWN0b3IgIT09IFwic3RyaW5nXCIgKSB7XG5cdFx0XHRcdC8vICggdHlwZXMtT2JqZWN0LCBkYXRhIClcblx0XHRcdFx0ZGF0YSA9IGRhdGEgfHwgc2VsZWN0b3I7XG5cdFx0XHRcdHNlbGVjdG9yID0gdW5kZWZpbmVkO1xuXHRcdFx0fVxuXHRcdFx0Zm9yICggdHlwZSBpbiB0eXBlcyApIHtcblx0XHRcdFx0dGhpcy5vbiggdHlwZSwgc2VsZWN0b3IsIGRhdGEsIHR5cGVzWyB0eXBlIF0sIG9uZSApO1xuXHRcdFx0fVxuXHRcdFx0cmV0dXJuIHRoaXM7XG5cdFx0fVxuXG5cdFx0aWYgKCBkYXRhID09IG51bGwgJiYgZm4gPT0gbnVsbCApIHtcblx0XHRcdC8vICggdHlwZXMsIGZuIClcblx0XHRcdGZuID0gc2VsZWN0b3I7XG5cdFx0XHRkYXRhID0gc2VsZWN0b3IgPSB1bmRlZmluZWQ7XG5cdFx0fSBlbHNlIGlmICggZm4gPT0gbnVsbCApIHtcblx0XHRcdGlmICggdHlwZW9mIHNlbGVjdG9yID09PSBcInN0cmluZ1wiICkge1xuXHRcdFx0XHQvLyAoIHR5cGVzLCBzZWxlY3RvciwgZm4gKVxuXHRcdFx0XHRmbiA9IGRhdGE7XG5cdFx0XHRcdGRhdGEgPSB1bmRlZmluZWQ7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHQvLyAoIHR5cGVzLCBkYXRhLCBmbiApXG5cdFx0XHRcdGZuID0gZGF0YTtcblx0XHRcdFx0ZGF0YSA9IHNlbGVjdG9yO1xuXHRcdFx0XHRzZWxlY3RvciA9IHVuZGVmaW5lZDtcblx0XHRcdH1cblx0XHR9XG5cdFx0aWYgKCBmbiA9PT0gZmFsc2UgKSB7XG5cdFx0XHRmbiA9IHJldHVybkZhbHNlO1xuXHRcdH0gZWxzZSBpZiAoICFmbiApIHtcblx0XHRcdHJldHVybiB0aGlzO1xuXHRcdH1cblxuXHRcdGlmICggb25lID09PSAxICkge1xuXHRcdFx0b3JpZ0ZuID0gZm47XG5cdFx0XHRmbiA9IGZ1bmN0aW9uKCBldmVudCApIHtcblx0XHRcdFx0Ly8gQ2FuIHVzZSBhbiBlbXB0eSBzZXQsIHNpbmNlIGV2ZW50IGNvbnRhaW5zIHRoZSBpbmZvXG5cdFx0XHRcdGpRdWVyeSgpLm9mZiggZXZlbnQgKTtcblx0XHRcdFx0cmV0dXJuIG9yaWdGbi5hcHBseSggdGhpcywgYXJndW1lbnRzICk7XG5cdFx0XHR9O1xuXHRcdFx0Ly8gVXNlIHNhbWUgZ3VpZCBzbyBjYWxsZXIgY2FuIHJlbW92ZSB1c2luZyBvcmlnRm5cblx0XHRcdGZuLmd1aWQgPSBvcmlnRm4uZ3VpZCB8fCAoIG9yaWdGbi5ndWlkID0galF1ZXJ5Lmd1aWQrKyApO1xuXHRcdH1cblx0XHRyZXR1cm4gdGhpcy5lYWNoKCBmdW5jdGlvbigpIHtcblx0XHRcdGpRdWVyeS5ldmVudC5hZGQoIHRoaXMsIHR5cGVzLCBmbiwgZGF0YSwgc2VsZWN0b3IgKTtcblx0XHR9KTtcblx0fSxcblx0b25lOiBmdW5jdGlvbiggdHlwZXMsIHNlbGVjdG9yLCBkYXRhLCBmbiApIHtcblx0XHRyZXR1cm4gdGhpcy5vbiggdHlwZXMsIHNlbGVjdG9yLCBkYXRhLCBmbiwgMSApO1xuXHR9LFxuXHRvZmY6IGZ1bmN0aW9uKCB0eXBlcywgc2VsZWN0b3IsIGZuICkge1xuXHRcdHZhciBoYW5kbGVPYmosIHR5cGU7XG5cdFx0aWYgKCB0eXBlcyAmJiB0eXBlcy5wcmV2ZW50RGVmYXVsdCAmJiB0eXBlcy5oYW5kbGVPYmogKSB7XG5cdFx0XHQvLyAoIGV2ZW50ICkgIGRpc3BhdGNoZWQgalF1ZXJ5LkV2ZW50XG5cdFx0XHRoYW5kbGVPYmogPSB0eXBlcy5oYW5kbGVPYmo7XG5cdFx0XHRqUXVlcnkoIHR5cGVzLmRlbGVnYXRlVGFyZ2V0ICkub2ZmKFxuXHRcdFx0XHRoYW5kbGVPYmoubmFtZXNwYWNlID8gaGFuZGxlT2JqLm9yaWdUeXBlICsgXCIuXCIgKyBoYW5kbGVPYmoubmFtZXNwYWNlIDogaGFuZGxlT2JqLm9yaWdUeXBlLFxuXHRcdFx0XHRoYW5kbGVPYmouc2VsZWN0b3IsXG5cdFx0XHRcdGhhbmRsZU9iai5oYW5kbGVyXG5cdFx0XHQpO1xuXHRcdFx0cmV0dXJuIHRoaXM7XG5cdFx0fVxuXHRcdGlmICggdHlwZW9mIHR5cGVzID09PSBcIm9iamVjdFwiICkge1xuXHRcdFx0Ly8gKCB0eXBlcy1vYmplY3QgWywgc2VsZWN0b3JdIClcblx0XHRcdGZvciAoIHR5cGUgaW4gdHlwZXMgKSB7XG5cdFx0XHRcdHRoaXMub2ZmKCB0eXBlLCBzZWxlY3RvciwgdHlwZXNbIHR5cGUgXSApO1xuXHRcdFx0fVxuXHRcdFx0cmV0dXJuIHRoaXM7XG5cdFx0fVxuXHRcdGlmICggc2VsZWN0b3IgPT09IGZhbHNlIHx8IHR5cGVvZiBzZWxlY3RvciA9PT0gXCJmdW5jdGlvblwiICkge1xuXHRcdFx0Ly8gKCB0eXBlcyBbLCBmbl0gKVxuXHRcdFx0Zm4gPSBzZWxlY3Rvcjtcblx0XHRcdHNlbGVjdG9yID0gdW5kZWZpbmVkO1xuXHRcdH1cblx0XHRpZiAoIGZuID09PSBmYWxzZSApIHtcblx0XHRcdGZuID0gcmV0dXJuRmFsc2U7XG5cdFx0fVxuXHRcdHJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oKSB7XG5cdFx0XHRqUXVlcnkuZXZlbnQucmVtb3ZlKCB0aGlzLCB0eXBlcywgZm4sIHNlbGVjdG9yICk7XG5cdFx0fSk7XG5cdH0sXG5cblx0dHJpZ2dlcjogZnVuY3Rpb24oIHR5cGUsIGRhdGEgKSB7XG5cdFx0cmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbigpIHtcblx0XHRcdGpRdWVyeS5ldmVudC50cmlnZ2VyKCB0eXBlLCBkYXRhLCB0aGlzICk7XG5cdFx0fSk7XG5cdH0sXG5cdHRyaWdnZXJIYW5kbGVyOiBmdW5jdGlvbiggdHlwZSwgZGF0YSApIHtcblx0XHR2YXIgZWxlbSA9IHRoaXNbMF07XG5cdFx0aWYgKCBlbGVtICkge1xuXHRcdFx0cmV0dXJuIGpRdWVyeS5ldmVudC50cmlnZ2VyKCB0eXBlLCBkYXRhLCBlbGVtLCB0cnVlICk7XG5cdFx0fVxuXHR9XG59KTtcblxuXG52YXJcblx0cnhodG1sVGFnID0gLzwoPyFhcmVhfGJyfGNvbHxlbWJlZHxocnxpbWd8aW5wdXR8bGlua3xtZXRhfHBhcmFtKSgoW1xcdzpdKylbXj5dKilcXC8+L2dpLFxuXHRydGFnTmFtZSA9IC88KFtcXHc6XSspLyxcblx0cmh0bWwgPSAvPHwmIz9cXHcrOy8sXG5cdHJub0lubmVyaHRtbCA9IC88KD86c2NyaXB0fHN0eWxlfGxpbmspL2ksXG5cdC8vIGNoZWNrZWQ9XCJjaGVja2VkXCIgb3IgY2hlY2tlZFxuXHRyY2hlY2tlZCA9IC9jaGVja2VkXFxzKig/OltePV18PVxccyouY2hlY2tlZC4pL2ksXG5cdHJzY3JpcHRUeXBlID0gL14kfFxcLyg/OmphdmF8ZWNtYSlzY3JpcHQvaSxcblx0cnNjcmlwdFR5cGVNYXNrZWQgPSAvXnRydWVcXC8oLiopLyxcblx0cmNsZWFuU2NyaXB0ID0gL15cXHMqPCEoPzpcXFtDREFUQVxcW3wtLSl8KD86XFxdXFxdfC0tKT5cXHMqJC9nLFxuXG5cdC8vIFdlIGhhdmUgdG8gY2xvc2UgdGhlc2UgdGFncyB0byBzdXBwb3J0IFhIVE1MICgjMTMyMDApXG5cdHdyYXBNYXAgPSB7XG5cblx0XHQvLyBTdXBwb3J0OiBJRTlcblx0XHRvcHRpb246IFsgMSwgXCI8c2VsZWN0IG11bHRpcGxlPSdtdWx0aXBsZSc+XCIsIFwiPC9zZWxlY3Q+XCIgXSxcblxuXHRcdHRoZWFkOiBbIDEsIFwiPHRhYmxlPlwiLCBcIjwvdGFibGU+XCIgXSxcblx0XHRjb2w6IFsgMiwgXCI8dGFibGU+PGNvbGdyb3VwPlwiLCBcIjwvY29sZ3JvdXA+PC90YWJsZT5cIiBdLFxuXHRcdHRyOiBbIDIsIFwiPHRhYmxlPjx0Ym9keT5cIiwgXCI8L3Rib2R5PjwvdGFibGU+XCIgXSxcblx0XHR0ZDogWyAzLCBcIjx0YWJsZT48dGJvZHk+PHRyPlwiLCBcIjwvdHI+PC90Ym9keT48L3RhYmxlPlwiIF0sXG5cblx0XHRfZGVmYXVsdDogWyAwLCBcIlwiLCBcIlwiIF1cblx0fTtcblxuLy8gU3VwcG9ydDogSUU5XG53cmFwTWFwLm9wdGdyb3VwID0gd3JhcE1hcC5vcHRpb247XG5cbndyYXBNYXAudGJvZHkgPSB3cmFwTWFwLnRmb290ID0gd3JhcE1hcC5jb2xncm91cCA9IHdyYXBNYXAuY2FwdGlvbiA9IHdyYXBNYXAudGhlYWQ7XG53cmFwTWFwLnRoID0gd3JhcE1hcC50ZDtcblxuLy8gU3VwcG9ydDogMS54IGNvbXBhdGliaWxpdHlcbi8vIE1hbmlwdWxhdGluZyB0YWJsZXMgcmVxdWlyZXMgYSB0Ym9keVxuZnVuY3Rpb24gbWFuaXB1bGF0aW9uVGFyZ2V0KCBlbGVtLCBjb250ZW50ICkge1xuXHRyZXR1cm4galF1ZXJ5Lm5vZGVOYW1lKCBlbGVtLCBcInRhYmxlXCIgKSAmJlxuXHRcdGpRdWVyeS5ub2RlTmFtZSggY29udGVudC5ub2RlVHlwZSAhPT0gMTEgPyBjb250ZW50IDogY29udGVudC5maXJzdENoaWxkLCBcInRyXCIgKSA/XG5cblx0XHRlbGVtLmdldEVsZW1lbnRzQnlUYWdOYW1lKFwidGJvZHlcIilbMF0gfHxcblx0XHRcdGVsZW0uYXBwZW5kQ2hpbGQoIGVsZW0ub3duZXJEb2N1bWVudC5jcmVhdGVFbGVtZW50KFwidGJvZHlcIikgKSA6XG5cdFx0ZWxlbTtcbn1cblxuLy8gUmVwbGFjZS9yZXN0b3JlIHRoZSB0eXBlIGF0dHJpYnV0ZSBvZiBzY3JpcHQgZWxlbWVudHMgZm9yIHNhZmUgRE9NIG1hbmlwdWxhdGlvblxuZnVuY3Rpb24gZGlzYWJsZVNjcmlwdCggZWxlbSApIHtcblx0ZWxlbS50eXBlID0gKGVsZW0uZ2V0QXR0cmlidXRlKFwidHlwZVwiKSAhPT0gbnVsbCkgKyBcIi9cIiArIGVsZW0udHlwZTtcblx0cmV0dXJuIGVsZW07XG59XG5mdW5jdGlvbiByZXN0b3JlU2NyaXB0KCBlbGVtICkge1xuXHR2YXIgbWF0Y2ggPSByc2NyaXB0VHlwZU1hc2tlZC5leGVjKCBlbGVtLnR5cGUgKTtcblxuXHRpZiAoIG1hdGNoICkge1xuXHRcdGVsZW0udHlwZSA9IG1hdGNoWyAxIF07XG5cdH0gZWxzZSB7XG5cdFx0ZWxlbS5yZW1vdmVBdHRyaWJ1dGUoXCJ0eXBlXCIpO1xuXHR9XG5cblx0cmV0dXJuIGVsZW07XG59XG5cbi8vIE1hcmsgc2NyaXB0cyBhcyBoYXZpbmcgYWxyZWFkeSBiZWVuIGV2YWx1YXRlZFxuZnVuY3Rpb24gc2V0R2xvYmFsRXZhbCggZWxlbXMsIHJlZkVsZW1lbnRzICkge1xuXHR2YXIgaSA9IDAsXG5cdFx0bCA9IGVsZW1zLmxlbmd0aDtcblxuXHRmb3IgKCA7IGkgPCBsOyBpKysgKSB7XG5cdFx0ZGF0YV9wcml2LnNldChcblx0XHRcdGVsZW1zWyBpIF0sIFwiZ2xvYmFsRXZhbFwiLCAhcmVmRWxlbWVudHMgfHwgZGF0YV9wcml2LmdldCggcmVmRWxlbWVudHNbIGkgXSwgXCJnbG9iYWxFdmFsXCIgKVxuXHRcdCk7XG5cdH1cbn1cblxuZnVuY3Rpb24gY2xvbmVDb3B5RXZlbnQoIHNyYywgZGVzdCApIHtcblx0dmFyIGksIGwsIHR5cGUsIHBkYXRhT2xkLCBwZGF0YUN1ciwgdWRhdGFPbGQsIHVkYXRhQ3VyLCBldmVudHM7XG5cblx0aWYgKCBkZXN0Lm5vZGVUeXBlICE9PSAxICkge1xuXHRcdHJldHVybjtcblx0fVxuXG5cdC8vIDEuIENvcHkgcHJpdmF0ZSBkYXRhOiBldmVudHMsIGhhbmRsZXJzLCBldGMuXG5cdGlmICggZGF0YV9wcml2Lmhhc0RhdGEoIHNyYyApICkge1xuXHRcdHBkYXRhT2xkID0gZGF0YV9wcml2LmFjY2Vzcyggc3JjICk7XG5cdFx0cGRhdGFDdXIgPSBkYXRhX3ByaXYuc2V0KCBkZXN0LCBwZGF0YU9sZCApO1xuXHRcdGV2ZW50cyA9IHBkYXRhT2xkLmV2ZW50cztcblxuXHRcdGlmICggZXZlbnRzICkge1xuXHRcdFx0ZGVsZXRlIHBkYXRhQ3VyLmhhbmRsZTtcblx0XHRcdHBkYXRhQ3VyLmV2ZW50cyA9IHt9O1xuXG5cdFx0XHRmb3IgKCB0eXBlIGluIGV2ZW50cyApIHtcblx0XHRcdFx0Zm9yICggaSA9IDAsIGwgPSBldmVudHNbIHR5cGUgXS5sZW5ndGg7IGkgPCBsOyBpKysgKSB7XG5cdFx0XHRcdFx0alF1ZXJ5LmV2ZW50LmFkZCggZGVzdCwgdHlwZSwgZXZlbnRzWyB0eXBlIF1bIGkgXSApO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fVxuXHR9XG5cblx0Ly8gMi4gQ29weSB1c2VyIGRhdGFcblx0aWYgKCBkYXRhX3VzZXIuaGFzRGF0YSggc3JjICkgKSB7XG5cdFx0dWRhdGFPbGQgPSBkYXRhX3VzZXIuYWNjZXNzKCBzcmMgKTtcblx0XHR1ZGF0YUN1ciA9IGpRdWVyeS5leHRlbmQoIHt9LCB1ZGF0YU9sZCApO1xuXG5cdFx0ZGF0YV91c2VyLnNldCggZGVzdCwgdWRhdGFDdXIgKTtcblx0fVxufVxuXG5mdW5jdGlvbiBnZXRBbGwoIGNvbnRleHQsIHRhZyApIHtcblx0dmFyIHJldCA9IGNvbnRleHQuZ2V0RWxlbWVudHNCeVRhZ05hbWUgPyBjb250ZXh0LmdldEVsZW1lbnRzQnlUYWdOYW1lKCB0YWcgfHwgXCIqXCIgKSA6XG5cdFx0XHRjb250ZXh0LnF1ZXJ5U2VsZWN0b3JBbGwgPyBjb250ZXh0LnF1ZXJ5U2VsZWN0b3JBbGwoIHRhZyB8fCBcIipcIiApIDpcblx0XHRcdFtdO1xuXG5cdHJldHVybiB0YWcgPT09IHVuZGVmaW5lZCB8fCB0YWcgJiYgalF1ZXJ5Lm5vZGVOYW1lKCBjb250ZXh0LCB0YWcgKSA/XG5cdFx0alF1ZXJ5Lm1lcmdlKCBbIGNvbnRleHQgXSwgcmV0ICkgOlxuXHRcdHJldDtcbn1cblxuLy8gRml4IElFIGJ1Z3MsIHNlZSBzdXBwb3J0IHRlc3RzXG5mdW5jdGlvbiBmaXhJbnB1dCggc3JjLCBkZXN0ICkge1xuXHR2YXIgbm9kZU5hbWUgPSBkZXN0Lm5vZGVOYW1lLnRvTG93ZXJDYXNlKCk7XG5cblx0Ly8gRmFpbHMgdG8gcGVyc2lzdCB0aGUgY2hlY2tlZCBzdGF0ZSBvZiBhIGNsb25lZCBjaGVja2JveCBvciByYWRpbyBidXR0b24uXG5cdGlmICggbm9kZU5hbWUgPT09IFwiaW5wdXRcIiAmJiByY2hlY2thYmxlVHlwZS50ZXN0KCBzcmMudHlwZSApICkge1xuXHRcdGRlc3QuY2hlY2tlZCA9IHNyYy5jaGVja2VkO1xuXG5cdC8vIEZhaWxzIHRvIHJldHVybiB0aGUgc2VsZWN0ZWQgb3B0aW9uIHRvIHRoZSBkZWZhdWx0IHNlbGVjdGVkIHN0YXRlIHdoZW4gY2xvbmluZyBvcHRpb25zXG5cdH0gZWxzZSBpZiAoIG5vZGVOYW1lID09PSBcImlucHV0XCIgfHwgbm9kZU5hbWUgPT09IFwidGV4dGFyZWFcIiApIHtcblx0XHRkZXN0LmRlZmF1bHRWYWx1ZSA9IHNyYy5kZWZhdWx0VmFsdWU7XG5cdH1cbn1cblxualF1ZXJ5LmV4dGVuZCh7XG5cdGNsb25lOiBmdW5jdGlvbiggZWxlbSwgZGF0YUFuZEV2ZW50cywgZGVlcERhdGFBbmRFdmVudHMgKSB7XG5cdFx0dmFyIGksIGwsIHNyY0VsZW1lbnRzLCBkZXN0RWxlbWVudHMsXG5cdFx0XHRjbG9uZSA9IGVsZW0uY2xvbmVOb2RlKCB0cnVlICksXG5cdFx0XHRpblBhZ2UgPSBqUXVlcnkuY29udGFpbnMoIGVsZW0ub3duZXJEb2N1bWVudCwgZWxlbSApO1xuXG5cdFx0Ly8gRml4IElFIGNsb25pbmcgaXNzdWVzXG5cdFx0aWYgKCAhc3VwcG9ydC5ub0Nsb25lQ2hlY2tlZCAmJiAoIGVsZW0ubm9kZVR5cGUgPT09IDEgfHwgZWxlbS5ub2RlVHlwZSA9PT0gMTEgKSAmJlxuXHRcdFx0XHQhalF1ZXJ5LmlzWE1MRG9jKCBlbGVtICkgKSB7XG5cblx0XHRcdC8vIFdlIGVzY2hldyBTaXp6bGUgaGVyZSBmb3IgcGVyZm9ybWFuY2UgcmVhc29uczogaHR0cDovL2pzcGVyZi5jb20vZ2V0YWxsLXZzLXNpenpsZS8yXG5cdFx0XHRkZXN0RWxlbWVudHMgPSBnZXRBbGwoIGNsb25lICk7XG5cdFx0XHRzcmNFbGVtZW50cyA9IGdldEFsbCggZWxlbSApO1xuXG5cdFx0XHRmb3IgKCBpID0gMCwgbCA9IHNyY0VsZW1lbnRzLmxlbmd0aDsgaSA8IGw7IGkrKyApIHtcblx0XHRcdFx0Zml4SW5wdXQoIHNyY0VsZW1lbnRzWyBpIF0sIGRlc3RFbGVtZW50c1sgaSBdICk7XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0Ly8gQ29weSB0aGUgZXZlbnRzIGZyb20gdGhlIG9yaWdpbmFsIHRvIHRoZSBjbG9uZVxuXHRcdGlmICggZGF0YUFuZEV2ZW50cyApIHtcblx0XHRcdGlmICggZGVlcERhdGFBbmRFdmVudHMgKSB7XG5cdFx0XHRcdHNyY0VsZW1lbnRzID0gc3JjRWxlbWVudHMgfHwgZ2V0QWxsKCBlbGVtICk7XG5cdFx0XHRcdGRlc3RFbGVtZW50cyA9IGRlc3RFbGVtZW50cyB8fCBnZXRBbGwoIGNsb25lICk7XG5cblx0XHRcdFx0Zm9yICggaSA9IDAsIGwgPSBzcmNFbGVtZW50cy5sZW5ndGg7IGkgPCBsOyBpKysgKSB7XG5cdFx0XHRcdFx0Y2xvbmVDb3B5RXZlbnQoIHNyY0VsZW1lbnRzWyBpIF0sIGRlc3RFbGVtZW50c1sgaSBdICk7XG5cdFx0XHRcdH1cblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdGNsb25lQ29weUV2ZW50KCBlbGVtLCBjbG9uZSApO1xuXHRcdFx0fVxuXHRcdH1cblxuXHRcdC8vIFByZXNlcnZlIHNjcmlwdCBldmFsdWF0aW9uIGhpc3Rvcnlcblx0XHRkZXN0RWxlbWVudHMgPSBnZXRBbGwoIGNsb25lLCBcInNjcmlwdFwiICk7XG5cdFx0aWYgKCBkZXN0RWxlbWVudHMubGVuZ3RoID4gMCApIHtcblx0XHRcdHNldEdsb2JhbEV2YWwoIGRlc3RFbGVtZW50cywgIWluUGFnZSAmJiBnZXRBbGwoIGVsZW0sIFwic2NyaXB0XCIgKSApO1xuXHRcdH1cblxuXHRcdC8vIFJldHVybiB0aGUgY2xvbmVkIHNldFxuXHRcdHJldHVybiBjbG9uZTtcblx0fSxcblxuXHRidWlsZEZyYWdtZW50OiBmdW5jdGlvbiggZWxlbXMsIGNvbnRleHQsIHNjcmlwdHMsIHNlbGVjdGlvbiApIHtcblx0XHR2YXIgZWxlbSwgdG1wLCB0YWcsIHdyYXAsIGNvbnRhaW5zLCBqLFxuXHRcdFx0ZnJhZ21lbnQgPSBjb250ZXh0LmNyZWF0ZURvY3VtZW50RnJhZ21lbnQoKSxcblx0XHRcdG5vZGVzID0gW10sXG5cdFx0XHRpID0gMCxcblx0XHRcdGwgPSBlbGVtcy5sZW5ndGg7XG5cblx0XHRmb3IgKCA7IGkgPCBsOyBpKysgKSB7XG5cdFx0XHRlbGVtID0gZWxlbXNbIGkgXTtcblxuXHRcdFx0aWYgKCBlbGVtIHx8IGVsZW0gPT09IDAgKSB7XG5cblx0XHRcdFx0Ly8gQWRkIG5vZGVzIGRpcmVjdGx5XG5cdFx0XHRcdGlmICggalF1ZXJ5LnR5cGUoIGVsZW0gKSA9PT0gXCJvYmplY3RcIiApIHtcblx0XHRcdFx0XHQvLyBTdXBwb3J0OiBRdFdlYktpdCwgUGhhbnRvbUpTXG5cdFx0XHRcdFx0Ly8gcHVzaC5hcHBseShfLCBhcnJheWxpa2UpIHRocm93cyBvbiBhbmNpZW50IFdlYktpdFxuXHRcdFx0XHRcdGpRdWVyeS5tZXJnZSggbm9kZXMsIGVsZW0ubm9kZVR5cGUgPyBbIGVsZW0gXSA6IGVsZW0gKTtcblxuXHRcdFx0XHQvLyBDb252ZXJ0IG5vbi1odG1sIGludG8gYSB0ZXh0IG5vZGVcblx0XHRcdFx0fSBlbHNlIGlmICggIXJodG1sLnRlc3QoIGVsZW0gKSApIHtcblx0XHRcdFx0XHRub2Rlcy5wdXNoKCBjb250ZXh0LmNyZWF0ZVRleHROb2RlKCBlbGVtICkgKTtcblxuXHRcdFx0XHQvLyBDb252ZXJ0IGh0bWwgaW50byBET00gbm9kZXNcblx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHR0bXAgPSB0bXAgfHwgZnJhZ21lbnQuYXBwZW5kQ2hpbGQoIGNvbnRleHQuY3JlYXRlRWxlbWVudChcImRpdlwiKSApO1xuXG5cdFx0XHRcdFx0Ly8gRGVzZXJpYWxpemUgYSBzdGFuZGFyZCByZXByZXNlbnRhdGlvblxuXHRcdFx0XHRcdHRhZyA9ICggcnRhZ05hbWUuZXhlYyggZWxlbSApIHx8IFsgXCJcIiwgXCJcIiBdIClbIDEgXS50b0xvd2VyQ2FzZSgpO1xuXHRcdFx0XHRcdHdyYXAgPSB3cmFwTWFwWyB0YWcgXSB8fCB3cmFwTWFwLl9kZWZhdWx0O1xuXHRcdFx0XHRcdHRtcC5pbm5lckhUTUwgPSB3cmFwWyAxIF0gKyBlbGVtLnJlcGxhY2UoIHJ4aHRtbFRhZywgXCI8JDE+PC8kMj5cIiApICsgd3JhcFsgMiBdO1xuXG5cdFx0XHRcdFx0Ly8gRGVzY2VuZCB0aHJvdWdoIHdyYXBwZXJzIHRvIHRoZSByaWdodCBjb250ZW50XG5cdFx0XHRcdFx0aiA9IHdyYXBbIDAgXTtcblx0XHRcdFx0XHR3aGlsZSAoIGotLSApIHtcblx0XHRcdFx0XHRcdHRtcCA9IHRtcC5sYXN0Q2hpbGQ7XG5cdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0Ly8gU3VwcG9ydDogUXRXZWJLaXQsIFBoYW50b21KU1xuXHRcdFx0XHRcdC8vIHB1c2guYXBwbHkoXywgYXJyYXlsaWtlKSB0aHJvd3Mgb24gYW5jaWVudCBXZWJLaXRcblx0XHRcdFx0XHRqUXVlcnkubWVyZ2UoIG5vZGVzLCB0bXAuY2hpbGROb2RlcyApO1xuXG5cdFx0XHRcdFx0Ly8gUmVtZW1iZXIgdGhlIHRvcC1sZXZlbCBjb250YWluZXJcblx0XHRcdFx0XHR0bXAgPSBmcmFnbWVudC5maXJzdENoaWxkO1xuXG5cdFx0XHRcdFx0Ly8gRW5zdXJlIHRoZSBjcmVhdGVkIG5vZGVzIGFyZSBvcnBoYW5lZCAoIzEyMzkyKVxuXHRcdFx0XHRcdHRtcC50ZXh0Q29udGVudCA9IFwiXCI7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9XG5cblx0XHQvLyBSZW1vdmUgd3JhcHBlciBmcm9tIGZyYWdtZW50XG5cdFx0ZnJhZ21lbnQudGV4dENvbnRlbnQgPSBcIlwiO1xuXG5cdFx0aSA9IDA7XG5cdFx0d2hpbGUgKCAoZWxlbSA9IG5vZGVzWyBpKysgXSkgKSB7XG5cblx0XHRcdC8vICM0MDg3IC0gSWYgb3JpZ2luIGFuZCBkZXN0aW5hdGlvbiBlbGVtZW50cyBhcmUgdGhlIHNhbWUsIGFuZCB0aGlzIGlzXG5cdFx0XHQvLyB0aGF0IGVsZW1lbnQsIGRvIG5vdCBkbyBhbnl0aGluZ1xuXHRcdFx0aWYgKCBzZWxlY3Rpb24gJiYgalF1ZXJ5LmluQXJyYXkoIGVsZW0sIHNlbGVjdGlvbiApICE9PSAtMSApIHtcblx0XHRcdFx0Y29udGludWU7XG5cdFx0XHR9XG5cblx0XHRcdGNvbnRhaW5zID0galF1ZXJ5LmNvbnRhaW5zKCBlbGVtLm93bmVyRG9jdW1lbnQsIGVsZW0gKTtcblxuXHRcdFx0Ly8gQXBwZW5kIHRvIGZyYWdtZW50XG5cdFx0XHR0bXAgPSBnZXRBbGwoIGZyYWdtZW50LmFwcGVuZENoaWxkKCBlbGVtICksIFwic2NyaXB0XCIgKTtcblxuXHRcdFx0Ly8gUHJlc2VydmUgc2NyaXB0IGV2YWx1YXRpb24gaGlzdG9yeVxuXHRcdFx0aWYgKCBjb250YWlucyApIHtcblx0XHRcdFx0c2V0R2xvYmFsRXZhbCggdG1wICk7XG5cdFx0XHR9XG5cblx0XHRcdC8vIENhcHR1cmUgZXhlY3V0YWJsZXNcblx0XHRcdGlmICggc2NyaXB0cyApIHtcblx0XHRcdFx0aiA9IDA7XG5cdFx0XHRcdHdoaWxlICggKGVsZW0gPSB0bXBbIGorKyBdKSApIHtcblx0XHRcdFx0XHRpZiAoIHJzY3JpcHRUeXBlLnRlc3QoIGVsZW0udHlwZSB8fCBcIlwiICkgKSB7XG5cdFx0XHRcdFx0XHRzY3JpcHRzLnB1c2goIGVsZW0gKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9XG5cblx0XHRyZXR1cm4gZnJhZ21lbnQ7XG5cdH0sXG5cblx0Y2xlYW5EYXRhOiBmdW5jdGlvbiggZWxlbXMgKSB7XG5cdFx0dmFyIGRhdGEsIGVsZW0sIHR5cGUsIGtleSxcblx0XHRcdHNwZWNpYWwgPSBqUXVlcnkuZXZlbnQuc3BlY2lhbCxcblx0XHRcdGkgPSAwO1xuXG5cdFx0Zm9yICggOyAoZWxlbSA9IGVsZW1zWyBpIF0pICE9PSB1bmRlZmluZWQ7IGkrKyApIHtcblx0XHRcdGlmICggalF1ZXJ5LmFjY2VwdERhdGEoIGVsZW0gKSApIHtcblx0XHRcdFx0a2V5ID0gZWxlbVsgZGF0YV9wcml2LmV4cGFuZG8gXTtcblxuXHRcdFx0XHRpZiAoIGtleSAmJiAoZGF0YSA9IGRhdGFfcHJpdi5jYWNoZVsga2V5IF0pICkge1xuXHRcdFx0XHRcdGlmICggZGF0YS5ldmVudHMgKSB7XG5cdFx0XHRcdFx0XHRmb3IgKCB0eXBlIGluIGRhdGEuZXZlbnRzICkge1xuXHRcdFx0XHRcdFx0XHRpZiAoIHNwZWNpYWxbIHR5cGUgXSApIHtcblx0XHRcdFx0XHRcdFx0XHRqUXVlcnkuZXZlbnQucmVtb3ZlKCBlbGVtLCB0eXBlICk7XG5cblx0XHRcdFx0XHRcdFx0Ly8gVGhpcyBpcyBhIHNob3J0Y3V0IHRvIGF2b2lkIGpRdWVyeS5ldmVudC5yZW1vdmUncyBvdmVyaGVhZFxuXHRcdFx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0XHRcdGpRdWVyeS5yZW1vdmVFdmVudCggZWxlbSwgdHlwZSwgZGF0YS5oYW5kbGUgKTtcblx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHRpZiAoIGRhdGFfcHJpdi5jYWNoZVsga2V5IF0gKSB7XG5cdFx0XHRcdFx0XHQvLyBEaXNjYXJkIGFueSByZW1haW5pbmcgYHByaXZhdGVgIGRhdGFcblx0XHRcdFx0XHRcdGRlbGV0ZSBkYXRhX3ByaXYuY2FjaGVbIGtleSBdO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdFx0Ly8gRGlzY2FyZCBhbnkgcmVtYWluaW5nIGB1c2VyYCBkYXRhXG5cdFx0XHRkZWxldGUgZGF0YV91c2VyLmNhY2hlWyBlbGVtWyBkYXRhX3VzZXIuZXhwYW5kbyBdIF07XG5cdFx0fVxuXHR9XG59KTtcblxualF1ZXJ5LmZuLmV4dGVuZCh7XG5cdHRleHQ6IGZ1bmN0aW9uKCB2YWx1ZSApIHtcblx0XHRyZXR1cm4gYWNjZXNzKCB0aGlzLCBmdW5jdGlvbiggdmFsdWUgKSB7XG5cdFx0XHRyZXR1cm4gdmFsdWUgPT09IHVuZGVmaW5lZCA/XG5cdFx0XHRcdGpRdWVyeS50ZXh0KCB0aGlzICkgOlxuXHRcdFx0XHR0aGlzLmVtcHR5KCkuZWFjaChmdW5jdGlvbigpIHtcblx0XHRcdFx0XHRpZiAoIHRoaXMubm9kZVR5cGUgPT09IDEgfHwgdGhpcy5ub2RlVHlwZSA9PT0gMTEgfHwgdGhpcy5ub2RlVHlwZSA9PT0gOSApIHtcblx0XHRcdFx0XHRcdHRoaXMudGV4dENvbnRlbnQgPSB2YWx1ZTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH0pO1xuXHRcdH0sIG51bGwsIHZhbHVlLCBhcmd1bWVudHMubGVuZ3RoICk7XG5cdH0sXG5cblx0YXBwZW5kOiBmdW5jdGlvbigpIHtcblx0XHRyZXR1cm4gdGhpcy5kb21NYW5pcCggYXJndW1lbnRzLCBmdW5jdGlvbiggZWxlbSApIHtcblx0XHRcdGlmICggdGhpcy5ub2RlVHlwZSA9PT0gMSB8fCB0aGlzLm5vZGVUeXBlID09PSAxMSB8fCB0aGlzLm5vZGVUeXBlID09PSA5ICkge1xuXHRcdFx0XHR2YXIgdGFyZ2V0ID0gbWFuaXB1bGF0aW9uVGFyZ2V0KCB0aGlzLCBlbGVtICk7XG5cdFx0XHRcdHRhcmdldC5hcHBlbmRDaGlsZCggZWxlbSApO1xuXHRcdFx0fVxuXHRcdH0pO1xuXHR9LFxuXG5cdHByZXBlbmQ6IGZ1bmN0aW9uKCkge1xuXHRcdHJldHVybiB0aGlzLmRvbU1hbmlwKCBhcmd1bWVudHMsIGZ1bmN0aW9uKCBlbGVtICkge1xuXHRcdFx0aWYgKCB0aGlzLm5vZGVUeXBlID09PSAxIHx8IHRoaXMubm9kZVR5cGUgPT09IDExIHx8IHRoaXMubm9kZVR5cGUgPT09IDkgKSB7XG5cdFx0XHRcdHZhciB0YXJnZXQgPSBtYW5pcHVsYXRpb25UYXJnZXQoIHRoaXMsIGVsZW0gKTtcblx0XHRcdFx0dGFyZ2V0Lmluc2VydEJlZm9yZSggZWxlbSwgdGFyZ2V0LmZpcnN0Q2hpbGQgKTtcblx0XHRcdH1cblx0XHR9KTtcblx0fSxcblxuXHRiZWZvcmU6IGZ1bmN0aW9uKCkge1xuXHRcdHJldHVybiB0aGlzLmRvbU1hbmlwKCBhcmd1bWVudHMsIGZ1bmN0aW9uKCBlbGVtICkge1xuXHRcdFx0aWYgKCB0aGlzLnBhcmVudE5vZGUgKSB7XG5cdFx0XHRcdHRoaXMucGFyZW50Tm9kZS5pbnNlcnRCZWZvcmUoIGVsZW0sIHRoaXMgKTtcblx0XHRcdH1cblx0XHR9KTtcblx0fSxcblxuXHRhZnRlcjogZnVuY3Rpb24oKSB7XG5cdFx0cmV0dXJuIHRoaXMuZG9tTWFuaXAoIGFyZ3VtZW50cywgZnVuY3Rpb24oIGVsZW0gKSB7XG5cdFx0XHRpZiAoIHRoaXMucGFyZW50Tm9kZSApIHtcblx0XHRcdFx0dGhpcy5wYXJlbnROb2RlLmluc2VydEJlZm9yZSggZWxlbSwgdGhpcy5uZXh0U2libGluZyApO1xuXHRcdFx0fVxuXHRcdH0pO1xuXHR9LFxuXG5cdHJlbW92ZTogZnVuY3Rpb24oIHNlbGVjdG9yLCBrZWVwRGF0YSAvKiBJbnRlcm5hbCBVc2UgT25seSAqLyApIHtcblx0XHR2YXIgZWxlbSxcblx0XHRcdGVsZW1zID0gc2VsZWN0b3IgPyBqUXVlcnkuZmlsdGVyKCBzZWxlY3RvciwgdGhpcyApIDogdGhpcyxcblx0XHRcdGkgPSAwO1xuXG5cdFx0Zm9yICggOyAoZWxlbSA9IGVsZW1zW2ldKSAhPSBudWxsOyBpKysgKSB7XG5cdFx0XHRpZiAoICFrZWVwRGF0YSAmJiBlbGVtLm5vZGVUeXBlID09PSAxICkge1xuXHRcdFx0XHRqUXVlcnkuY2xlYW5EYXRhKCBnZXRBbGwoIGVsZW0gKSApO1xuXHRcdFx0fVxuXG5cdFx0XHRpZiAoIGVsZW0ucGFyZW50Tm9kZSApIHtcblx0XHRcdFx0aWYgKCBrZWVwRGF0YSAmJiBqUXVlcnkuY29udGFpbnMoIGVsZW0ub3duZXJEb2N1bWVudCwgZWxlbSApICkge1xuXHRcdFx0XHRcdHNldEdsb2JhbEV2YWwoIGdldEFsbCggZWxlbSwgXCJzY3JpcHRcIiApICk7XG5cdFx0XHRcdH1cblx0XHRcdFx0ZWxlbS5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKCBlbGVtICk7XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0cmV0dXJuIHRoaXM7XG5cdH0sXG5cblx0ZW1wdHk6IGZ1bmN0aW9uKCkge1xuXHRcdHZhciBlbGVtLFxuXHRcdFx0aSA9IDA7XG5cblx0XHRmb3IgKCA7IChlbGVtID0gdGhpc1tpXSkgIT0gbnVsbDsgaSsrICkge1xuXHRcdFx0aWYgKCBlbGVtLm5vZGVUeXBlID09PSAxICkge1xuXG5cdFx0XHRcdC8vIFByZXZlbnQgbWVtb3J5IGxlYWtzXG5cdFx0XHRcdGpRdWVyeS5jbGVhbkRhdGEoIGdldEFsbCggZWxlbSwgZmFsc2UgKSApO1xuXG5cdFx0XHRcdC8vIFJlbW92ZSBhbnkgcmVtYWluaW5nIG5vZGVzXG5cdFx0XHRcdGVsZW0udGV4dENvbnRlbnQgPSBcIlwiO1xuXHRcdFx0fVxuXHRcdH1cblxuXHRcdHJldHVybiB0aGlzO1xuXHR9LFxuXG5cdGNsb25lOiBmdW5jdGlvbiggZGF0YUFuZEV2ZW50cywgZGVlcERhdGFBbmRFdmVudHMgKSB7XG5cdFx0ZGF0YUFuZEV2ZW50cyA9IGRhdGFBbmRFdmVudHMgPT0gbnVsbCA/IGZhbHNlIDogZGF0YUFuZEV2ZW50cztcblx0XHRkZWVwRGF0YUFuZEV2ZW50cyA9IGRlZXBEYXRhQW5kRXZlbnRzID09IG51bGwgPyBkYXRhQW5kRXZlbnRzIDogZGVlcERhdGFBbmRFdmVudHM7XG5cblx0XHRyZXR1cm4gdGhpcy5tYXAoZnVuY3Rpb24oKSB7XG5cdFx0XHRyZXR1cm4galF1ZXJ5LmNsb25lKCB0aGlzLCBkYXRhQW5kRXZlbnRzLCBkZWVwRGF0YUFuZEV2ZW50cyApO1xuXHRcdH0pO1xuXHR9LFxuXG5cdGh0bWw6IGZ1bmN0aW9uKCB2YWx1ZSApIHtcblx0XHRyZXR1cm4gYWNjZXNzKCB0aGlzLCBmdW5jdGlvbiggdmFsdWUgKSB7XG5cdFx0XHR2YXIgZWxlbSA9IHRoaXNbIDAgXSB8fCB7fSxcblx0XHRcdFx0aSA9IDAsXG5cdFx0XHRcdGwgPSB0aGlzLmxlbmd0aDtcblxuXHRcdFx0aWYgKCB2YWx1ZSA9PT0gdW5kZWZpbmVkICYmIGVsZW0ubm9kZVR5cGUgPT09IDEgKSB7XG5cdFx0XHRcdHJldHVybiBlbGVtLmlubmVySFRNTDtcblx0XHRcdH1cblxuXHRcdFx0Ly8gU2VlIGlmIHdlIGNhbiB0YWtlIGEgc2hvcnRjdXQgYW5kIGp1c3QgdXNlIGlubmVySFRNTFxuXHRcdFx0aWYgKCB0eXBlb2YgdmFsdWUgPT09IFwic3RyaW5nXCIgJiYgIXJub0lubmVyaHRtbC50ZXN0KCB2YWx1ZSApICYmXG5cdFx0XHRcdCF3cmFwTWFwWyAoIHJ0YWdOYW1lLmV4ZWMoIHZhbHVlICkgfHwgWyBcIlwiLCBcIlwiIF0gKVsgMSBdLnRvTG93ZXJDYXNlKCkgXSApIHtcblxuXHRcdFx0XHR2YWx1ZSA9IHZhbHVlLnJlcGxhY2UoIHJ4aHRtbFRhZywgXCI8JDE+PC8kMj5cIiApO1xuXG5cdFx0XHRcdHRyeSB7XG5cdFx0XHRcdFx0Zm9yICggOyBpIDwgbDsgaSsrICkge1xuXHRcdFx0XHRcdFx0ZWxlbSA9IHRoaXNbIGkgXSB8fCB7fTtcblxuXHRcdFx0XHRcdFx0Ly8gUmVtb3ZlIGVsZW1lbnQgbm9kZXMgYW5kIHByZXZlbnQgbWVtb3J5IGxlYWtzXG5cdFx0XHRcdFx0XHRpZiAoIGVsZW0ubm9kZVR5cGUgPT09IDEgKSB7XG5cdFx0XHRcdFx0XHRcdGpRdWVyeS5jbGVhbkRhdGEoIGdldEFsbCggZWxlbSwgZmFsc2UgKSApO1xuXHRcdFx0XHRcdFx0XHRlbGVtLmlubmVySFRNTCA9IHZhbHVlO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdGVsZW0gPSAwO1xuXG5cdFx0XHRcdC8vIElmIHVzaW5nIGlubmVySFRNTCB0aHJvd3MgYW4gZXhjZXB0aW9uLCB1c2UgdGhlIGZhbGxiYWNrIG1ldGhvZFxuXHRcdFx0XHR9IGNhdGNoKCBlICkge31cblx0XHRcdH1cblxuXHRcdFx0aWYgKCBlbGVtICkge1xuXHRcdFx0XHR0aGlzLmVtcHR5KCkuYXBwZW5kKCB2YWx1ZSApO1xuXHRcdFx0fVxuXHRcdH0sIG51bGwsIHZhbHVlLCBhcmd1bWVudHMubGVuZ3RoICk7XG5cdH0sXG5cblx0cmVwbGFjZVdpdGg6IGZ1bmN0aW9uKCkge1xuXHRcdHZhciBhcmcgPSBhcmd1bWVudHNbIDAgXTtcblxuXHRcdC8vIE1ha2UgdGhlIGNoYW5nZXMsIHJlcGxhY2luZyBlYWNoIGNvbnRleHQgZWxlbWVudCB3aXRoIHRoZSBuZXcgY29udGVudFxuXHRcdHRoaXMuZG9tTWFuaXAoIGFyZ3VtZW50cywgZnVuY3Rpb24oIGVsZW0gKSB7XG5cdFx0XHRhcmcgPSB0aGlzLnBhcmVudE5vZGU7XG5cblx0XHRcdGpRdWVyeS5jbGVhbkRhdGEoIGdldEFsbCggdGhpcyApICk7XG5cblx0XHRcdGlmICggYXJnICkge1xuXHRcdFx0XHRhcmcucmVwbGFjZUNoaWxkKCBlbGVtLCB0aGlzICk7XG5cdFx0XHR9XG5cdFx0fSk7XG5cblx0XHQvLyBGb3JjZSByZW1vdmFsIGlmIHRoZXJlIHdhcyBubyBuZXcgY29udGVudCAoZS5nLiwgZnJvbSBlbXB0eSBhcmd1bWVudHMpXG5cdFx0cmV0dXJuIGFyZyAmJiAoYXJnLmxlbmd0aCB8fCBhcmcubm9kZVR5cGUpID8gdGhpcyA6IHRoaXMucmVtb3ZlKCk7XG5cdH0sXG5cblx0ZGV0YWNoOiBmdW5jdGlvbiggc2VsZWN0b3IgKSB7XG5cdFx0cmV0dXJuIHRoaXMucmVtb3ZlKCBzZWxlY3RvciwgdHJ1ZSApO1xuXHR9LFxuXG5cdGRvbU1hbmlwOiBmdW5jdGlvbiggYXJncywgY2FsbGJhY2sgKSB7XG5cblx0XHQvLyBGbGF0dGVuIGFueSBuZXN0ZWQgYXJyYXlzXG5cdFx0YXJncyA9IGNvbmNhdC5hcHBseSggW10sIGFyZ3MgKTtcblxuXHRcdHZhciBmcmFnbWVudCwgZmlyc3QsIHNjcmlwdHMsIGhhc1NjcmlwdHMsIG5vZGUsIGRvYyxcblx0XHRcdGkgPSAwLFxuXHRcdFx0bCA9IHRoaXMubGVuZ3RoLFxuXHRcdFx0c2V0ID0gdGhpcyxcblx0XHRcdGlOb0Nsb25lID0gbCAtIDEsXG5cdFx0XHR2YWx1ZSA9IGFyZ3NbIDAgXSxcblx0XHRcdGlzRnVuY3Rpb24gPSBqUXVlcnkuaXNGdW5jdGlvbiggdmFsdWUgKTtcblxuXHRcdC8vIFdlIGNhbid0IGNsb25lTm9kZSBmcmFnbWVudHMgdGhhdCBjb250YWluIGNoZWNrZWQsIGluIFdlYktpdFxuXHRcdGlmICggaXNGdW5jdGlvbiB8fFxuXHRcdFx0XHQoIGwgPiAxICYmIHR5cGVvZiB2YWx1ZSA9PT0gXCJzdHJpbmdcIiAmJlxuXHRcdFx0XHRcdCFzdXBwb3J0LmNoZWNrQ2xvbmUgJiYgcmNoZWNrZWQudGVzdCggdmFsdWUgKSApICkge1xuXHRcdFx0cmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbiggaW5kZXggKSB7XG5cdFx0XHRcdHZhciBzZWxmID0gc2V0LmVxKCBpbmRleCApO1xuXHRcdFx0XHRpZiAoIGlzRnVuY3Rpb24gKSB7XG5cdFx0XHRcdFx0YXJnc1sgMCBdID0gdmFsdWUuY2FsbCggdGhpcywgaW5kZXgsIHNlbGYuaHRtbCgpICk7XG5cdFx0XHRcdH1cblx0XHRcdFx0c2VsZi5kb21NYW5pcCggYXJncywgY2FsbGJhY2sgKTtcblx0XHRcdH0pO1xuXHRcdH1cblxuXHRcdGlmICggbCApIHtcblx0XHRcdGZyYWdtZW50ID0galF1ZXJ5LmJ1aWxkRnJhZ21lbnQoIGFyZ3MsIHRoaXNbIDAgXS5vd25lckRvY3VtZW50LCBmYWxzZSwgdGhpcyApO1xuXHRcdFx0Zmlyc3QgPSBmcmFnbWVudC5maXJzdENoaWxkO1xuXG5cdFx0XHRpZiAoIGZyYWdtZW50LmNoaWxkTm9kZXMubGVuZ3RoID09PSAxICkge1xuXHRcdFx0XHRmcmFnbWVudCA9IGZpcnN0O1xuXHRcdFx0fVxuXG5cdFx0XHRpZiAoIGZpcnN0ICkge1xuXHRcdFx0XHRzY3JpcHRzID0galF1ZXJ5Lm1hcCggZ2V0QWxsKCBmcmFnbWVudCwgXCJzY3JpcHRcIiApLCBkaXNhYmxlU2NyaXB0ICk7XG5cdFx0XHRcdGhhc1NjcmlwdHMgPSBzY3JpcHRzLmxlbmd0aDtcblxuXHRcdFx0XHQvLyBVc2UgdGhlIG9yaWdpbmFsIGZyYWdtZW50IGZvciB0aGUgbGFzdCBpdGVtIGluc3RlYWQgb2YgdGhlIGZpcnN0IGJlY2F1c2UgaXQgY2FuIGVuZCB1cFxuXHRcdFx0XHQvLyBiZWluZyBlbXB0aWVkIGluY29ycmVjdGx5IGluIGNlcnRhaW4gc2l0dWF0aW9ucyAoIzgwNzApLlxuXHRcdFx0XHRmb3IgKCA7IGkgPCBsOyBpKysgKSB7XG5cdFx0XHRcdFx0bm9kZSA9IGZyYWdtZW50O1xuXG5cdFx0XHRcdFx0aWYgKCBpICE9PSBpTm9DbG9uZSApIHtcblx0XHRcdFx0XHRcdG5vZGUgPSBqUXVlcnkuY2xvbmUoIG5vZGUsIHRydWUsIHRydWUgKTtcblxuXHRcdFx0XHRcdFx0Ly8gS2VlcCByZWZlcmVuY2VzIHRvIGNsb25lZCBzY3JpcHRzIGZvciBsYXRlciByZXN0b3JhdGlvblxuXHRcdFx0XHRcdFx0aWYgKCBoYXNTY3JpcHRzICkge1xuXHRcdFx0XHRcdFx0XHQvLyBTdXBwb3J0OiBRdFdlYktpdFxuXHRcdFx0XHRcdFx0XHQvLyBqUXVlcnkubWVyZ2UgYmVjYXVzZSBwdXNoLmFwcGx5KF8sIGFycmF5bGlrZSkgdGhyb3dzXG5cdFx0XHRcdFx0XHRcdGpRdWVyeS5tZXJnZSggc2NyaXB0cywgZ2V0QWxsKCBub2RlLCBcInNjcmlwdFwiICkgKTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRjYWxsYmFjay5jYWxsKCB0aGlzWyBpIF0sIG5vZGUsIGkgKTtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdGlmICggaGFzU2NyaXB0cyApIHtcblx0XHRcdFx0XHRkb2MgPSBzY3JpcHRzWyBzY3JpcHRzLmxlbmd0aCAtIDEgXS5vd25lckRvY3VtZW50O1xuXG5cdFx0XHRcdFx0Ly8gUmVlbmFibGUgc2NyaXB0c1xuXHRcdFx0XHRcdGpRdWVyeS5tYXAoIHNjcmlwdHMsIHJlc3RvcmVTY3JpcHQgKTtcblxuXHRcdFx0XHRcdC8vIEV2YWx1YXRlIGV4ZWN1dGFibGUgc2NyaXB0cyBvbiBmaXJzdCBkb2N1bWVudCBpbnNlcnRpb25cblx0XHRcdFx0XHRmb3IgKCBpID0gMDsgaSA8IGhhc1NjcmlwdHM7IGkrKyApIHtcblx0XHRcdFx0XHRcdG5vZGUgPSBzY3JpcHRzWyBpIF07XG5cdFx0XHRcdFx0XHRpZiAoIHJzY3JpcHRUeXBlLnRlc3QoIG5vZGUudHlwZSB8fCBcIlwiICkgJiZcblx0XHRcdFx0XHRcdFx0IWRhdGFfcHJpdi5hY2Nlc3MoIG5vZGUsIFwiZ2xvYmFsRXZhbFwiICkgJiYgalF1ZXJ5LmNvbnRhaW5zKCBkb2MsIG5vZGUgKSApIHtcblxuXHRcdFx0XHRcdFx0XHRpZiAoIG5vZGUuc3JjICkge1xuXHRcdFx0XHRcdFx0XHRcdC8vIE9wdGlvbmFsIEFKQVggZGVwZW5kZW5jeSwgYnV0IHdvbid0IHJ1biBzY3JpcHRzIGlmIG5vdCBwcmVzZW50XG5cdFx0XHRcdFx0XHRcdFx0aWYgKCBqUXVlcnkuX2V2YWxVcmwgKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRqUXVlcnkuX2V2YWxVcmwoIG5vZGUuc3JjICk7XG5cdFx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0XHRcdGpRdWVyeS5nbG9iYWxFdmFsKCBub2RlLnRleHRDb250ZW50LnJlcGxhY2UoIHJjbGVhblNjcmlwdCwgXCJcIiApICk7XG5cdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9XG5cblx0XHRyZXR1cm4gdGhpcztcblx0fVxufSk7XG5cbmpRdWVyeS5lYWNoKHtcblx0YXBwZW5kVG86IFwiYXBwZW5kXCIsXG5cdHByZXBlbmRUbzogXCJwcmVwZW5kXCIsXG5cdGluc2VydEJlZm9yZTogXCJiZWZvcmVcIixcblx0aW5zZXJ0QWZ0ZXI6IFwiYWZ0ZXJcIixcblx0cmVwbGFjZUFsbDogXCJyZXBsYWNlV2l0aFwiXG59LCBmdW5jdGlvbiggbmFtZSwgb3JpZ2luYWwgKSB7XG5cdGpRdWVyeS5mblsgbmFtZSBdID0gZnVuY3Rpb24oIHNlbGVjdG9yICkge1xuXHRcdHZhciBlbGVtcyxcblx0XHRcdHJldCA9IFtdLFxuXHRcdFx0aW5zZXJ0ID0galF1ZXJ5KCBzZWxlY3RvciApLFxuXHRcdFx0bGFzdCA9IGluc2VydC5sZW5ndGggLSAxLFxuXHRcdFx0aSA9IDA7XG5cblx0XHRmb3IgKCA7IGkgPD0gbGFzdDsgaSsrICkge1xuXHRcdFx0ZWxlbXMgPSBpID09PSBsYXN0ID8gdGhpcyA6IHRoaXMuY2xvbmUoIHRydWUgKTtcblx0XHRcdGpRdWVyeSggaW5zZXJ0WyBpIF0gKVsgb3JpZ2luYWwgXSggZWxlbXMgKTtcblxuXHRcdFx0Ly8gU3VwcG9ydDogUXRXZWJLaXRcblx0XHRcdC8vIC5nZXQoKSBiZWNhdXNlIHB1c2guYXBwbHkoXywgYXJyYXlsaWtlKSB0aHJvd3Ncblx0XHRcdHB1c2guYXBwbHkoIHJldCwgZWxlbXMuZ2V0KCkgKTtcblx0XHR9XG5cblx0XHRyZXR1cm4gdGhpcy5wdXNoU3RhY2soIHJldCApO1xuXHR9O1xufSk7XG5cblxudmFyIGlmcmFtZSxcblx0ZWxlbWRpc3BsYXkgPSB7fTtcblxuLyoqXG4gKiBSZXRyaWV2ZSB0aGUgYWN0dWFsIGRpc3BsYXkgb2YgYSBlbGVtZW50XG4gKiBAcGFyYW0ge1N0cmluZ30gbmFtZSBub2RlTmFtZSBvZiB0aGUgZWxlbWVudFxuICogQHBhcmFtIHtPYmplY3R9IGRvYyBEb2N1bWVudCBvYmplY3RcbiAqL1xuLy8gQ2FsbGVkIG9ubHkgZnJvbSB3aXRoaW4gZGVmYXVsdERpc3BsYXlcbmZ1bmN0aW9uIGFjdHVhbERpc3BsYXkoIG5hbWUsIGRvYyApIHtcblx0dmFyIHN0eWxlLFxuXHRcdGVsZW0gPSBqUXVlcnkoIGRvYy5jcmVhdGVFbGVtZW50KCBuYW1lICkgKS5hcHBlbmRUbyggZG9jLmJvZHkgKSxcblxuXHRcdC8vIGdldERlZmF1bHRDb21wdXRlZFN0eWxlIG1pZ2h0IGJlIHJlbGlhYmx5IHVzZWQgb25seSBvbiBhdHRhY2hlZCBlbGVtZW50XG5cdFx0ZGlzcGxheSA9IHdpbmRvdy5nZXREZWZhdWx0Q29tcHV0ZWRTdHlsZSAmJiAoIHN0eWxlID0gd2luZG93LmdldERlZmF1bHRDb21wdXRlZFN0eWxlKCBlbGVtWyAwIF0gKSApID9cblxuXHRcdFx0Ly8gVXNlIG9mIHRoaXMgbWV0aG9kIGlzIGEgdGVtcG9yYXJ5IGZpeCAobW9yZSBsaWtlIG9wdGltaXphdGlvbikgdW50aWwgc29tZXRoaW5nIGJldHRlciBjb21lcyBhbG9uZyxcblx0XHRcdC8vIHNpbmNlIGl0IHdhcyByZW1vdmVkIGZyb20gc3BlY2lmaWNhdGlvbiBhbmQgc3VwcG9ydGVkIG9ubHkgaW4gRkZcblx0XHRcdHN0eWxlLmRpc3BsYXkgOiBqUXVlcnkuY3NzKCBlbGVtWyAwIF0sIFwiZGlzcGxheVwiICk7XG5cblx0Ly8gV2UgZG9uJ3QgaGF2ZSBhbnkgZGF0YSBzdG9yZWQgb24gdGhlIGVsZW1lbnQsXG5cdC8vIHNvIHVzZSBcImRldGFjaFwiIG1ldGhvZCBhcyBmYXN0IHdheSB0byBnZXQgcmlkIG9mIHRoZSBlbGVtZW50XG5cdGVsZW0uZGV0YWNoKCk7XG5cblx0cmV0dXJuIGRpc3BsYXk7XG59XG5cbi8qKlxuICogVHJ5IHRvIGRldGVybWluZSB0aGUgZGVmYXVsdCBkaXNwbGF5IHZhbHVlIG9mIGFuIGVsZW1lbnRcbiAqIEBwYXJhbSB7U3RyaW5nfSBub2RlTmFtZVxuICovXG5mdW5jdGlvbiBkZWZhdWx0RGlzcGxheSggbm9kZU5hbWUgKSB7XG5cdHZhciBkb2MgPSBkb2N1bWVudCxcblx0XHRkaXNwbGF5ID0gZWxlbWRpc3BsYXlbIG5vZGVOYW1lIF07XG5cblx0aWYgKCAhZGlzcGxheSApIHtcblx0XHRkaXNwbGF5ID0gYWN0dWFsRGlzcGxheSggbm9kZU5hbWUsIGRvYyApO1xuXG5cdFx0Ly8gSWYgdGhlIHNpbXBsZSB3YXkgZmFpbHMsIHJlYWQgZnJvbSBpbnNpZGUgYW4gaWZyYW1lXG5cdFx0aWYgKCBkaXNwbGF5ID09PSBcIm5vbmVcIiB8fCAhZGlzcGxheSApIHtcblxuXHRcdFx0Ly8gVXNlIHRoZSBhbHJlYWR5LWNyZWF0ZWQgaWZyYW1lIGlmIHBvc3NpYmxlXG5cdFx0XHRpZnJhbWUgPSAoaWZyYW1lIHx8IGpRdWVyeSggXCI8aWZyYW1lIGZyYW1lYm9yZGVyPScwJyB3aWR0aD0nMCcgaGVpZ2h0PScwJy8+XCIgKSkuYXBwZW5kVG8oIGRvYy5kb2N1bWVudEVsZW1lbnQgKTtcblxuXHRcdFx0Ly8gQWx3YXlzIHdyaXRlIGEgbmV3IEhUTUwgc2tlbGV0b24gc28gV2Via2l0IGFuZCBGaXJlZm94IGRvbid0IGNob2tlIG9uIHJldXNlXG5cdFx0XHRkb2MgPSBpZnJhbWVbIDAgXS5jb250ZW50RG9jdW1lbnQ7XG5cblx0XHRcdC8vIFN1cHBvcnQ6IElFXG5cdFx0XHRkb2Mud3JpdGUoKTtcblx0XHRcdGRvYy5jbG9zZSgpO1xuXG5cdFx0XHRkaXNwbGF5ID0gYWN0dWFsRGlzcGxheSggbm9kZU5hbWUsIGRvYyApO1xuXHRcdFx0aWZyYW1lLmRldGFjaCgpO1xuXHRcdH1cblxuXHRcdC8vIFN0b3JlIHRoZSBjb3JyZWN0IGRlZmF1bHQgZGlzcGxheVxuXHRcdGVsZW1kaXNwbGF5WyBub2RlTmFtZSBdID0gZGlzcGxheTtcblx0fVxuXG5cdHJldHVybiBkaXNwbGF5O1xufVxudmFyIHJtYXJnaW4gPSAoL15tYXJnaW4vKTtcblxudmFyIHJudW1ub25weCA9IG5ldyBSZWdFeHAoIFwiXihcIiArIHBudW0gKyBcIikoPyFweClbYS16JV0rJFwiLCBcImlcIiApO1xuXG52YXIgZ2V0U3R5bGVzID0gZnVuY3Rpb24oIGVsZW0gKSB7XG5cdFx0Ly8gU3VwcG9ydDogSUU8PTExKywgRmlyZWZveDw9MzArICgjMTUwOTgsICMxNDE1MClcblx0XHQvLyBJRSB0aHJvd3Mgb24gZWxlbWVudHMgY3JlYXRlZCBpbiBwb3B1cHNcblx0XHQvLyBGRiBtZWFud2hpbGUgdGhyb3dzIG9uIGZyYW1lIGVsZW1lbnRzIHRocm91Z2ggXCJkZWZhdWx0Vmlldy5nZXRDb21wdXRlZFN0eWxlXCJcblx0XHRpZiAoIGVsZW0ub3duZXJEb2N1bWVudC5kZWZhdWx0Vmlldy5vcGVuZXIgKSB7XG5cdFx0XHRyZXR1cm4gZWxlbS5vd25lckRvY3VtZW50LmRlZmF1bHRWaWV3LmdldENvbXB1dGVkU3R5bGUoIGVsZW0sIG51bGwgKTtcblx0XHR9XG5cblx0XHRyZXR1cm4gd2luZG93LmdldENvbXB1dGVkU3R5bGUoIGVsZW0sIG51bGwgKTtcblx0fTtcblxuXG5cbmZ1bmN0aW9uIGN1ckNTUyggZWxlbSwgbmFtZSwgY29tcHV0ZWQgKSB7XG5cdHZhciB3aWR0aCwgbWluV2lkdGgsIG1heFdpZHRoLCByZXQsXG5cdFx0c3R5bGUgPSBlbGVtLnN0eWxlO1xuXG5cdGNvbXB1dGVkID0gY29tcHV0ZWQgfHwgZ2V0U3R5bGVzKCBlbGVtICk7XG5cblx0Ly8gU3VwcG9ydDogSUU5XG5cdC8vIGdldFByb3BlcnR5VmFsdWUgaXMgb25seSBuZWVkZWQgZm9yIC5jc3MoJ2ZpbHRlcicpICgjMTI1MzcpXG5cdGlmICggY29tcHV0ZWQgKSB7XG5cdFx0cmV0ID0gY29tcHV0ZWQuZ2V0UHJvcGVydHlWYWx1ZSggbmFtZSApIHx8IGNvbXB1dGVkWyBuYW1lIF07XG5cdH1cblxuXHRpZiAoIGNvbXB1dGVkICkge1xuXG5cdFx0aWYgKCByZXQgPT09IFwiXCIgJiYgIWpRdWVyeS5jb250YWlucyggZWxlbS5vd25lckRvY3VtZW50LCBlbGVtICkgKSB7XG5cdFx0XHRyZXQgPSBqUXVlcnkuc3R5bGUoIGVsZW0sIG5hbWUgKTtcblx0XHR9XG5cblx0XHQvLyBTdXBwb3J0OiBpT1MgPCA2XG5cdFx0Ly8gQSB0cmlidXRlIHRvIHRoZSBcImF3ZXNvbWUgaGFjayBieSBEZWFuIEVkd2FyZHNcIlxuXHRcdC8vIGlPUyA8IDYgKGF0IGxlYXN0KSByZXR1cm5zIHBlcmNlbnRhZ2UgZm9yIGEgbGFyZ2VyIHNldCBvZiB2YWx1ZXMsIGJ1dCB3aWR0aCBzZWVtcyB0byBiZSByZWxpYWJseSBwaXhlbHNcblx0XHQvLyB0aGlzIGlzIGFnYWluc3QgdGhlIENTU09NIGRyYWZ0IHNwZWM6IGh0dHA6Ly9kZXYudzMub3JnL2Nzc3dnL2Nzc29tLyNyZXNvbHZlZC12YWx1ZXNcblx0XHRpZiAoIHJudW1ub25weC50ZXN0KCByZXQgKSAmJiBybWFyZ2luLnRlc3QoIG5hbWUgKSApIHtcblxuXHRcdFx0Ly8gUmVtZW1iZXIgdGhlIG9yaWdpbmFsIHZhbHVlc1xuXHRcdFx0d2lkdGggPSBzdHlsZS53aWR0aDtcblx0XHRcdG1pbldpZHRoID0gc3R5bGUubWluV2lkdGg7XG5cdFx0XHRtYXhXaWR0aCA9IHN0eWxlLm1heFdpZHRoO1xuXG5cdFx0XHQvLyBQdXQgaW4gdGhlIG5ldyB2YWx1ZXMgdG8gZ2V0IGEgY29tcHV0ZWQgdmFsdWUgb3V0XG5cdFx0XHRzdHlsZS5taW5XaWR0aCA9IHN0eWxlLm1heFdpZHRoID0gc3R5bGUud2lkdGggPSByZXQ7XG5cdFx0XHRyZXQgPSBjb21wdXRlZC53aWR0aDtcblxuXHRcdFx0Ly8gUmV2ZXJ0IHRoZSBjaGFuZ2VkIHZhbHVlc1xuXHRcdFx0c3R5bGUud2lkdGggPSB3aWR0aDtcblx0XHRcdHN0eWxlLm1pbldpZHRoID0gbWluV2lkdGg7XG5cdFx0XHRzdHlsZS5tYXhXaWR0aCA9IG1heFdpZHRoO1xuXHRcdH1cblx0fVxuXG5cdHJldHVybiByZXQgIT09IHVuZGVmaW5lZCA/XG5cdFx0Ly8gU3VwcG9ydDogSUVcblx0XHQvLyBJRSByZXR1cm5zIHpJbmRleCB2YWx1ZSBhcyBhbiBpbnRlZ2VyLlxuXHRcdHJldCArIFwiXCIgOlxuXHRcdHJldDtcbn1cblxuXG5mdW5jdGlvbiBhZGRHZXRIb29rSWYoIGNvbmRpdGlvbkZuLCBob29rRm4gKSB7XG5cdC8vIERlZmluZSB0aGUgaG9vaywgd2UnbGwgY2hlY2sgb24gdGhlIGZpcnN0IHJ1biBpZiBpdCdzIHJlYWxseSBuZWVkZWQuXG5cdHJldHVybiB7XG5cdFx0Z2V0OiBmdW5jdGlvbigpIHtcblx0XHRcdGlmICggY29uZGl0aW9uRm4oKSApIHtcblx0XHRcdFx0Ly8gSG9vayBub3QgbmVlZGVkIChvciBpdCdzIG5vdCBwb3NzaWJsZSB0byB1c2UgaXQgZHVlXG5cdFx0XHRcdC8vIHRvIG1pc3NpbmcgZGVwZW5kZW5jeSksIHJlbW92ZSBpdC5cblx0XHRcdFx0ZGVsZXRlIHRoaXMuZ2V0O1xuXHRcdFx0XHRyZXR1cm47XG5cdFx0XHR9XG5cblx0XHRcdC8vIEhvb2sgbmVlZGVkOyByZWRlZmluZSBpdCBzbyB0aGF0IHRoZSBzdXBwb3J0IHRlc3QgaXMgbm90IGV4ZWN1dGVkIGFnYWluLlxuXHRcdFx0cmV0dXJuICh0aGlzLmdldCA9IGhvb2tGbikuYXBwbHkoIHRoaXMsIGFyZ3VtZW50cyApO1xuXHRcdH1cblx0fTtcbn1cblxuXG4oZnVuY3Rpb24oKSB7XG5cdHZhciBwaXhlbFBvc2l0aW9uVmFsLCBib3hTaXppbmdSZWxpYWJsZVZhbCxcblx0XHRkb2NFbGVtID0gZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LFxuXHRcdGNvbnRhaW5lciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoIFwiZGl2XCIgKSxcblx0XHRkaXYgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCBcImRpdlwiICk7XG5cblx0aWYgKCAhZGl2LnN0eWxlICkge1xuXHRcdHJldHVybjtcblx0fVxuXG5cdC8vIFN1cHBvcnQ6IElFOS0xMStcblx0Ly8gU3R5bGUgb2YgY2xvbmVkIGVsZW1lbnQgYWZmZWN0cyBzb3VyY2UgZWxlbWVudCBjbG9uZWQgKCM4OTA4KVxuXHRkaXYuc3R5bGUuYmFja2dyb3VuZENsaXAgPSBcImNvbnRlbnQtYm94XCI7XG5cdGRpdi5jbG9uZU5vZGUoIHRydWUgKS5zdHlsZS5iYWNrZ3JvdW5kQ2xpcCA9IFwiXCI7XG5cdHN1cHBvcnQuY2xlYXJDbG9uZVN0eWxlID0gZGl2LnN0eWxlLmJhY2tncm91bmRDbGlwID09PSBcImNvbnRlbnQtYm94XCI7XG5cblx0Y29udGFpbmVyLnN0eWxlLmNzc1RleHQgPSBcImJvcmRlcjowO3dpZHRoOjA7aGVpZ2h0OjA7dG9wOjA7bGVmdDotOTk5OXB4O21hcmdpbi10b3A6MXB4O1wiICtcblx0XHRcInBvc2l0aW9uOmFic29sdXRlXCI7XG5cdGNvbnRhaW5lci5hcHBlbmRDaGlsZCggZGl2ICk7XG5cblx0Ly8gRXhlY3V0aW5nIGJvdGggcGl4ZWxQb3NpdGlvbiAmIGJveFNpemluZ1JlbGlhYmxlIHRlc3RzIHJlcXVpcmUgb25seSBvbmUgbGF5b3V0XG5cdC8vIHNvIHRoZXkncmUgZXhlY3V0ZWQgYXQgdGhlIHNhbWUgdGltZSB0byBzYXZlIHRoZSBzZWNvbmQgY29tcHV0YXRpb24uXG5cdGZ1bmN0aW9uIGNvbXB1dGVQaXhlbFBvc2l0aW9uQW5kQm94U2l6aW5nUmVsaWFibGUoKSB7XG5cdFx0ZGl2LnN0eWxlLmNzc1RleHQgPVxuXHRcdFx0Ly8gU3VwcG9ydDogRmlyZWZveDwyOSwgQW5kcm9pZCAyLjNcblx0XHRcdC8vIFZlbmRvci1wcmVmaXggYm94LXNpemluZ1xuXHRcdFx0XCItd2Via2l0LWJveC1zaXppbmc6Ym9yZGVyLWJveDstbW96LWJveC1zaXppbmc6Ym9yZGVyLWJveDtcIiArXG5cdFx0XHRcImJveC1zaXppbmc6Ym9yZGVyLWJveDtkaXNwbGF5OmJsb2NrO21hcmdpbi10b3A6MSU7dG9wOjElO1wiICtcblx0XHRcdFwiYm9yZGVyOjFweDtwYWRkaW5nOjFweDt3aWR0aDo0cHg7cG9zaXRpb246YWJzb2x1dGVcIjtcblx0XHRkaXYuaW5uZXJIVE1MID0gXCJcIjtcblx0XHRkb2NFbGVtLmFwcGVuZENoaWxkKCBjb250YWluZXIgKTtcblxuXHRcdHZhciBkaXZTdHlsZSA9IHdpbmRvdy5nZXRDb21wdXRlZFN0eWxlKCBkaXYsIG51bGwgKTtcblx0XHRwaXhlbFBvc2l0aW9uVmFsID0gZGl2U3R5bGUudG9wICE9PSBcIjElXCI7XG5cdFx0Ym94U2l6aW5nUmVsaWFibGVWYWwgPSBkaXZTdHlsZS53aWR0aCA9PT0gXCI0cHhcIjtcblxuXHRcdGRvY0VsZW0ucmVtb3ZlQ2hpbGQoIGNvbnRhaW5lciApO1xuXHR9XG5cblx0Ly8gU3VwcG9ydDogbm9kZS5qcyBqc2RvbVxuXHQvLyBEb24ndCBhc3N1bWUgdGhhdCBnZXRDb21wdXRlZFN0eWxlIGlzIGEgcHJvcGVydHkgb2YgdGhlIGdsb2JhbCBvYmplY3Rcblx0aWYgKCB3aW5kb3cuZ2V0Q29tcHV0ZWRTdHlsZSApIHtcblx0XHRqUXVlcnkuZXh0ZW5kKCBzdXBwb3J0LCB7XG5cdFx0XHRwaXhlbFBvc2l0aW9uOiBmdW5jdGlvbigpIHtcblxuXHRcdFx0XHQvLyBUaGlzIHRlc3QgaXMgZXhlY3V0ZWQgb25seSBvbmNlIGJ1dCB3ZSBzdGlsbCBkbyBtZW1vaXppbmdcblx0XHRcdFx0Ly8gc2luY2Ugd2UgY2FuIHVzZSB0aGUgYm94U2l6aW5nUmVsaWFibGUgcHJlLWNvbXB1dGluZy5cblx0XHRcdFx0Ly8gTm8gbmVlZCB0byBjaGVjayBpZiB0aGUgdGVzdCB3YXMgYWxyZWFkeSBwZXJmb3JtZWQsIHRob3VnaC5cblx0XHRcdFx0Y29tcHV0ZVBpeGVsUG9zaXRpb25BbmRCb3hTaXppbmdSZWxpYWJsZSgpO1xuXHRcdFx0XHRyZXR1cm4gcGl4ZWxQb3NpdGlvblZhbDtcblx0XHRcdH0sXG5cdFx0XHRib3hTaXppbmdSZWxpYWJsZTogZnVuY3Rpb24oKSB7XG5cdFx0XHRcdGlmICggYm94U2l6aW5nUmVsaWFibGVWYWwgPT0gbnVsbCApIHtcblx0XHRcdFx0XHRjb21wdXRlUGl4ZWxQb3NpdGlvbkFuZEJveFNpemluZ1JlbGlhYmxlKCk7XG5cdFx0XHRcdH1cblx0XHRcdFx0cmV0dXJuIGJveFNpemluZ1JlbGlhYmxlVmFsO1xuXHRcdFx0fSxcblx0XHRcdHJlbGlhYmxlTWFyZ2luUmlnaHQ6IGZ1bmN0aW9uKCkge1xuXG5cdFx0XHRcdC8vIFN1cHBvcnQ6IEFuZHJvaWQgMi4zXG5cdFx0XHRcdC8vIENoZWNrIGlmIGRpdiB3aXRoIGV4cGxpY2l0IHdpZHRoIGFuZCBubyBtYXJnaW4tcmlnaHQgaW5jb3JyZWN0bHlcblx0XHRcdFx0Ly8gZ2V0cyBjb21wdXRlZCBtYXJnaW4tcmlnaHQgYmFzZWQgb24gd2lkdGggb2YgY29udGFpbmVyLiAoIzMzMzMpXG5cdFx0XHRcdC8vIFdlYktpdCBCdWcgMTMzNDMgLSBnZXRDb21wdXRlZFN0eWxlIHJldHVybnMgd3JvbmcgdmFsdWUgZm9yIG1hcmdpbi1yaWdodFxuXHRcdFx0XHQvLyBUaGlzIHN1cHBvcnQgZnVuY3Rpb24gaXMgb25seSBleGVjdXRlZCBvbmNlIHNvIG5vIG1lbW9pemluZyBpcyBuZWVkZWQuXG5cdFx0XHRcdHZhciByZXQsXG5cdFx0XHRcdFx0bWFyZ2luRGl2ID0gZGl2LmFwcGVuZENoaWxkKCBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCBcImRpdlwiICkgKTtcblxuXHRcdFx0XHQvLyBSZXNldCBDU1M6IGJveC1zaXppbmc7IGRpc3BsYXk7IG1hcmdpbjsgYm9yZGVyOyBwYWRkaW5nXG5cdFx0XHRcdG1hcmdpbkRpdi5zdHlsZS5jc3NUZXh0ID0gZGl2LnN0eWxlLmNzc1RleHQgPVxuXHRcdFx0XHRcdC8vIFN1cHBvcnQ6IEZpcmVmb3g8MjksIEFuZHJvaWQgMi4zXG5cdFx0XHRcdFx0Ly8gVmVuZG9yLXByZWZpeCBib3gtc2l6aW5nXG5cdFx0XHRcdFx0XCItd2Via2l0LWJveC1zaXppbmc6Y29udGVudC1ib3g7LW1vei1ib3gtc2l6aW5nOmNvbnRlbnQtYm94O1wiICtcblx0XHRcdFx0XHRcImJveC1zaXppbmc6Y29udGVudC1ib3g7ZGlzcGxheTpibG9jazttYXJnaW46MDtib3JkZXI6MDtwYWRkaW5nOjBcIjtcblx0XHRcdFx0bWFyZ2luRGl2LnN0eWxlLm1hcmdpblJpZ2h0ID0gbWFyZ2luRGl2LnN0eWxlLndpZHRoID0gXCIwXCI7XG5cdFx0XHRcdGRpdi5zdHlsZS53aWR0aCA9IFwiMXB4XCI7XG5cdFx0XHRcdGRvY0VsZW0uYXBwZW5kQ2hpbGQoIGNvbnRhaW5lciApO1xuXG5cdFx0XHRcdHJldCA9ICFwYXJzZUZsb2F0KCB3aW5kb3cuZ2V0Q29tcHV0ZWRTdHlsZSggbWFyZ2luRGl2LCBudWxsICkubWFyZ2luUmlnaHQgKTtcblxuXHRcdFx0XHRkb2NFbGVtLnJlbW92ZUNoaWxkKCBjb250YWluZXIgKTtcblx0XHRcdFx0ZGl2LnJlbW92ZUNoaWxkKCBtYXJnaW5EaXYgKTtcblxuXHRcdFx0XHRyZXR1cm4gcmV0O1xuXHRcdFx0fVxuXHRcdH0pO1xuXHR9XG59KSgpO1xuXG5cbi8vIEEgbWV0aG9kIGZvciBxdWlja2x5IHN3YXBwaW5nIGluL291dCBDU1MgcHJvcGVydGllcyB0byBnZXQgY29ycmVjdCBjYWxjdWxhdGlvbnMuXG5qUXVlcnkuc3dhcCA9IGZ1bmN0aW9uKCBlbGVtLCBvcHRpb25zLCBjYWxsYmFjaywgYXJncyApIHtcblx0dmFyIHJldCwgbmFtZSxcblx0XHRvbGQgPSB7fTtcblxuXHQvLyBSZW1lbWJlciB0aGUgb2xkIHZhbHVlcywgYW5kIGluc2VydCB0aGUgbmV3IG9uZXNcblx0Zm9yICggbmFtZSBpbiBvcHRpb25zICkge1xuXHRcdG9sZFsgbmFtZSBdID0gZWxlbS5zdHlsZVsgbmFtZSBdO1xuXHRcdGVsZW0uc3R5bGVbIG5hbWUgXSA9IG9wdGlvbnNbIG5hbWUgXTtcblx0fVxuXG5cdHJldCA9IGNhbGxiYWNrLmFwcGx5KCBlbGVtLCBhcmdzIHx8IFtdICk7XG5cblx0Ly8gUmV2ZXJ0IHRoZSBvbGQgdmFsdWVzXG5cdGZvciAoIG5hbWUgaW4gb3B0aW9ucyApIHtcblx0XHRlbGVtLnN0eWxlWyBuYW1lIF0gPSBvbGRbIG5hbWUgXTtcblx0fVxuXG5cdHJldHVybiByZXQ7XG59O1xuXG5cbnZhclxuXHQvLyBTd2FwcGFibGUgaWYgZGlzcGxheSBpcyBub25lIG9yIHN0YXJ0cyB3aXRoIHRhYmxlIGV4Y2VwdCBcInRhYmxlXCIsIFwidGFibGUtY2VsbFwiLCBvciBcInRhYmxlLWNhcHRpb25cIlxuXHQvLyBTZWUgaGVyZSBmb3IgZGlzcGxheSB2YWx1ZXM6IGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2VuLVVTL2RvY3MvQ1NTL2Rpc3BsYXlcblx0cmRpc3BsYXlzd2FwID0gL14obm9uZXx0YWJsZSg/IS1jW2VhXSkuKykvLFxuXHRybnVtc3BsaXQgPSBuZXcgUmVnRXhwKCBcIl4oXCIgKyBwbnVtICsgXCIpKC4qKSRcIiwgXCJpXCIgKSxcblx0cnJlbE51bSA9IG5ldyBSZWdFeHAoIFwiXihbKy1dKT0oXCIgKyBwbnVtICsgXCIpXCIsIFwiaVwiICksXG5cblx0Y3NzU2hvdyA9IHsgcG9zaXRpb246IFwiYWJzb2x1dGVcIiwgdmlzaWJpbGl0eTogXCJoaWRkZW5cIiwgZGlzcGxheTogXCJibG9ja1wiIH0sXG5cdGNzc05vcm1hbFRyYW5zZm9ybSA9IHtcblx0XHRsZXR0ZXJTcGFjaW5nOiBcIjBcIixcblx0XHRmb250V2VpZ2h0OiBcIjQwMFwiXG5cdH0sXG5cblx0Y3NzUHJlZml4ZXMgPSBbIFwiV2Via2l0XCIsIFwiT1wiLCBcIk1velwiLCBcIm1zXCIgXTtcblxuLy8gUmV0dXJuIGEgY3NzIHByb3BlcnR5IG1hcHBlZCB0byBhIHBvdGVudGlhbGx5IHZlbmRvciBwcmVmaXhlZCBwcm9wZXJ0eVxuZnVuY3Rpb24gdmVuZG9yUHJvcE5hbWUoIHN0eWxlLCBuYW1lICkge1xuXG5cdC8vIFNob3J0Y3V0IGZvciBuYW1lcyB0aGF0IGFyZSBub3QgdmVuZG9yIHByZWZpeGVkXG5cdGlmICggbmFtZSBpbiBzdHlsZSApIHtcblx0XHRyZXR1cm4gbmFtZTtcblx0fVxuXG5cdC8vIENoZWNrIGZvciB2ZW5kb3IgcHJlZml4ZWQgbmFtZXNcblx0dmFyIGNhcE5hbWUgPSBuYW1lWzBdLnRvVXBwZXJDYXNlKCkgKyBuYW1lLnNsaWNlKDEpLFxuXHRcdG9yaWdOYW1lID0gbmFtZSxcblx0XHRpID0gY3NzUHJlZml4ZXMubGVuZ3RoO1xuXG5cdHdoaWxlICggaS0tICkge1xuXHRcdG5hbWUgPSBjc3NQcmVmaXhlc1sgaSBdICsgY2FwTmFtZTtcblx0XHRpZiAoIG5hbWUgaW4gc3R5bGUgKSB7XG5cdFx0XHRyZXR1cm4gbmFtZTtcblx0XHR9XG5cdH1cblxuXHRyZXR1cm4gb3JpZ05hbWU7XG59XG5cbmZ1bmN0aW9uIHNldFBvc2l0aXZlTnVtYmVyKCBlbGVtLCB2YWx1ZSwgc3VidHJhY3QgKSB7XG5cdHZhciBtYXRjaGVzID0gcm51bXNwbGl0LmV4ZWMoIHZhbHVlICk7XG5cdHJldHVybiBtYXRjaGVzID9cblx0XHQvLyBHdWFyZCBhZ2FpbnN0IHVuZGVmaW5lZCBcInN1YnRyYWN0XCIsIGUuZy4sIHdoZW4gdXNlZCBhcyBpbiBjc3NIb29rc1xuXHRcdE1hdGgubWF4KCAwLCBtYXRjaGVzWyAxIF0gLSAoIHN1YnRyYWN0IHx8IDAgKSApICsgKCBtYXRjaGVzWyAyIF0gfHwgXCJweFwiICkgOlxuXHRcdHZhbHVlO1xufVxuXG5mdW5jdGlvbiBhdWdtZW50V2lkdGhPckhlaWdodCggZWxlbSwgbmFtZSwgZXh0cmEsIGlzQm9yZGVyQm94LCBzdHlsZXMgKSB7XG5cdHZhciBpID0gZXh0cmEgPT09ICggaXNCb3JkZXJCb3ggPyBcImJvcmRlclwiIDogXCJjb250ZW50XCIgKSA/XG5cdFx0Ly8gSWYgd2UgYWxyZWFkeSBoYXZlIHRoZSByaWdodCBtZWFzdXJlbWVudCwgYXZvaWQgYXVnbWVudGF0aW9uXG5cdFx0NCA6XG5cdFx0Ly8gT3RoZXJ3aXNlIGluaXRpYWxpemUgZm9yIGhvcml6b250YWwgb3IgdmVydGljYWwgcHJvcGVydGllc1xuXHRcdG5hbWUgPT09IFwid2lkdGhcIiA/IDEgOiAwLFxuXG5cdFx0dmFsID0gMDtcblxuXHRmb3IgKCA7IGkgPCA0OyBpICs9IDIgKSB7XG5cdFx0Ly8gQm90aCBib3ggbW9kZWxzIGV4Y2x1ZGUgbWFyZ2luLCBzbyBhZGQgaXQgaWYgd2Ugd2FudCBpdFxuXHRcdGlmICggZXh0cmEgPT09IFwibWFyZ2luXCIgKSB7XG5cdFx0XHR2YWwgKz0galF1ZXJ5LmNzcyggZWxlbSwgZXh0cmEgKyBjc3NFeHBhbmRbIGkgXSwgdHJ1ZSwgc3R5bGVzICk7XG5cdFx0fVxuXG5cdFx0aWYgKCBpc0JvcmRlckJveCApIHtcblx0XHRcdC8vIGJvcmRlci1ib3ggaW5jbHVkZXMgcGFkZGluZywgc28gcmVtb3ZlIGl0IGlmIHdlIHdhbnQgY29udGVudFxuXHRcdFx0aWYgKCBleHRyYSA9PT0gXCJjb250ZW50XCIgKSB7XG5cdFx0XHRcdHZhbCAtPSBqUXVlcnkuY3NzKCBlbGVtLCBcInBhZGRpbmdcIiArIGNzc0V4cGFuZFsgaSBdLCB0cnVlLCBzdHlsZXMgKTtcblx0XHRcdH1cblxuXHRcdFx0Ly8gQXQgdGhpcyBwb2ludCwgZXh0cmEgaXNuJ3QgYm9yZGVyIG5vciBtYXJnaW4sIHNvIHJlbW92ZSBib3JkZXJcblx0XHRcdGlmICggZXh0cmEgIT09IFwibWFyZ2luXCIgKSB7XG5cdFx0XHRcdHZhbCAtPSBqUXVlcnkuY3NzKCBlbGVtLCBcImJvcmRlclwiICsgY3NzRXhwYW5kWyBpIF0gKyBcIldpZHRoXCIsIHRydWUsIHN0eWxlcyApO1xuXHRcdFx0fVxuXHRcdH0gZWxzZSB7XG5cdFx0XHQvLyBBdCB0aGlzIHBvaW50LCBleHRyYSBpc24ndCBjb250ZW50LCBzbyBhZGQgcGFkZGluZ1xuXHRcdFx0dmFsICs9IGpRdWVyeS5jc3MoIGVsZW0sIFwicGFkZGluZ1wiICsgY3NzRXhwYW5kWyBpIF0sIHRydWUsIHN0eWxlcyApO1xuXG5cdFx0XHQvLyBBdCB0aGlzIHBvaW50LCBleHRyYSBpc24ndCBjb250ZW50IG5vciBwYWRkaW5nLCBzbyBhZGQgYm9yZGVyXG5cdFx0XHRpZiAoIGV4dHJhICE9PSBcInBhZGRpbmdcIiApIHtcblx0XHRcdFx0dmFsICs9IGpRdWVyeS5jc3MoIGVsZW0sIFwiYm9yZGVyXCIgKyBjc3NFeHBhbmRbIGkgXSArIFwiV2lkdGhcIiwgdHJ1ZSwgc3R5bGVzICk7XG5cdFx0XHR9XG5cdFx0fVxuXHR9XG5cblx0cmV0dXJuIHZhbDtcbn1cblxuZnVuY3Rpb24gZ2V0V2lkdGhPckhlaWdodCggZWxlbSwgbmFtZSwgZXh0cmEgKSB7XG5cblx0Ly8gU3RhcnQgd2l0aCBvZmZzZXQgcHJvcGVydHksIHdoaWNoIGlzIGVxdWl2YWxlbnQgdG8gdGhlIGJvcmRlci1ib3ggdmFsdWVcblx0dmFyIHZhbHVlSXNCb3JkZXJCb3ggPSB0cnVlLFxuXHRcdHZhbCA9IG5hbWUgPT09IFwid2lkdGhcIiA/IGVsZW0ub2Zmc2V0V2lkdGggOiBlbGVtLm9mZnNldEhlaWdodCxcblx0XHRzdHlsZXMgPSBnZXRTdHlsZXMoIGVsZW0gKSxcblx0XHRpc0JvcmRlckJveCA9IGpRdWVyeS5jc3MoIGVsZW0sIFwiYm94U2l6aW5nXCIsIGZhbHNlLCBzdHlsZXMgKSA9PT0gXCJib3JkZXItYm94XCI7XG5cblx0Ly8gU29tZSBub24taHRtbCBlbGVtZW50cyByZXR1cm4gdW5kZWZpbmVkIGZvciBvZmZzZXRXaWR0aCwgc28gY2hlY2sgZm9yIG51bGwvdW5kZWZpbmVkXG5cdC8vIHN2ZyAtIGh0dHBzOi8vYnVnemlsbGEubW96aWxsYS5vcmcvc2hvd19idWcuY2dpP2lkPTY0OTI4NVxuXHQvLyBNYXRoTUwgLSBodHRwczovL2J1Z3ppbGxhLm1vemlsbGEub3JnL3Nob3dfYnVnLmNnaT9pZD00OTE2Njhcblx0aWYgKCB2YWwgPD0gMCB8fCB2YWwgPT0gbnVsbCApIHtcblx0XHQvLyBGYWxsIGJhY2sgdG8gY29tcHV0ZWQgdGhlbiB1bmNvbXB1dGVkIGNzcyBpZiBuZWNlc3Nhcnlcblx0XHR2YWwgPSBjdXJDU1MoIGVsZW0sIG5hbWUsIHN0eWxlcyApO1xuXHRcdGlmICggdmFsIDwgMCB8fCB2YWwgPT0gbnVsbCApIHtcblx0XHRcdHZhbCA9IGVsZW0uc3R5bGVbIG5hbWUgXTtcblx0XHR9XG5cblx0XHQvLyBDb21wdXRlZCB1bml0IGlzIG5vdCBwaXhlbHMuIFN0b3AgaGVyZSBhbmQgcmV0dXJuLlxuXHRcdGlmICggcm51bW5vbnB4LnRlc3QodmFsKSApIHtcblx0XHRcdHJldHVybiB2YWw7XG5cdFx0fVxuXG5cdFx0Ly8gQ2hlY2sgZm9yIHN0eWxlIGluIGNhc2UgYSBicm93c2VyIHdoaWNoIHJldHVybnMgdW5yZWxpYWJsZSB2YWx1ZXNcblx0XHQvLyBmb3IgZ2V0Q29tcHV0ZWRTdHlsZSBzaWxlbnRseSBmYWxscyBiYWNrIHRvIHRoZSByZWxpYWJsZSBlbGVtLnN0eWxlXG5cdFx0dmFsdWVJc0JvcmRlckJveCA9IGlzQm9yZGVyQm94ICYmXG5cdFx0XHQoIHN1cHBvcnQuYm94U2l6aW5nUmVsaWFibGUoKSB8fCB2YWwgPT09IGVsZW0uc3R5bGVbIG5hbWUgXSApO1xuXG5cdFx0Ly8gTm9ybWFsaXplIFwiXCIsIGF1dG8sIGFuZCBwcmVwYXJlIGZvciBleHRyYVxuXHRcdHZhbCA9IHBhcnNlRmxvYXQoIHZhbCApIHx8IDA7XG5cdH1cblxuXHQvLyBVc2UgdGhlIGFjdGl2ZSBib3gtc2l6aW5nIG1vZGVsIHRvIGFkZC9zdWJ0cmFjdCBpcnJlbGV2YW50IHN0eWxlc1xuXHRyZXR1cm4gKCB2YWwgK1xuXHRcdGF1Z21lbnRXaWR0aE9ySGVpZ2h0KFxuXHRcdFx0ZWxlbSxcblx0XHRcdG5hbWUsXG5cdFx0XHRleHRyYSB8fCAoIGlzQm9yZGVyQm94ID8gXCJib3JkZXJcIiA6IFwiY29udGVudFwiICksXG5cdFx0XHR2YWx1ZUlzQm9yZGVyQm94LFxuXHRcdFx0c3R5bGVzXG5cdFx0KVxuXHQpICsgXCJweFwiO1xufVxuXG5mdW5jdGlvbiBzaG93SGlkZSggZWxlbWVudHMsIHNob3cgKSB7XG5cdHZhciBkaXNwbGF5LCBlbGVtLCBoaWRkZW4sXG5cdFx0dmFsdWVzID0gW10sXG5cdFx0aW5kZXggPSAwLFxuXHRcdGxlbmd0aCA9IGVsZW1lbnRzLmxlbmd0aDtcblxuXHRmb3IgKCA7IGluZGV4IDwgbGVuZ3RoOyBpbmRleCsrICkge1xuXHRcdGVsZW0gPSBlbGVtZW50c1sgaW5kZXggXTtcblx0XHRpZiAoICFlbGVtLnN0eWxlICkge1xuXHRcdFx0Y29udGludWU7XG5cdFx0fVxuXG5cdFx0dmFsdWVzWyBpbmRleCBdID0gZGF0YV9wcml2LmdldCggZWxlbSwgXCJvbGRkaXNwbGF5XCIgKTtcblx0XHRkaXNwbGF5ID0gZWxlbS5zdHlsZS5kaXNwbGF5O1xuXHRcdGlmICggc2hvdyApIHtcblx0XHRcdC8vIFJlc2V0IHRoZSBpbmxpbmUgZGlzcGxheSBvZiB0aGlzIGVsZW1lbnQgdG8gbGVhcm4gaWYgaXQgaXNcblx0XHRcdC8vIGJlaW5nIGhpZGRlbiBieSBjYXNjYWRlZCBydWxlcyBvciBub3Rcblx0XHRcdGlmICggIXZhbHVlc1sgaW5kZXggXSAmJiBkaXNwbGF5ID09PSBcIm5vbmVcIiApIHtcblx0XHRcdFx0ZWxlbS5zdHlsZS5kaXNwbGF5ID0gXCJcIjtcblx0XHRcdH1cblxuXHRcdFx0Ly8gU2V0IGVsZW1lbnRzIHdoaWNoIGhhdmUgYmVlbiBvdmVycmlkZGVuIHdpdGggZGlzcGxheTogbm9uZVxuXHRcdFx0Ly8gaW4gYSBzdHlsZXNoZWV0IHRvIHdoYXRldmVyIHRoZSBkZWZhdWx0IGJyb3dzZXIgc3R5bGUgaXNcblx0XHRcdC8vIGZvciBzdWNoIGFuIGVsZW1lbnRcblx0XHRcdGlmICggZWxlbS5zdHlsZS5kaXNwbGF5ID09PSBcIlwiICYmIGlzSGlkZGVuKCBlbGVtICkgKSB7XG5cdFx0XHRcdHZhbHVlc1sgaW5kZXggXSA9IGRhdGFfcHJpdi5hY2Nlc3MoIGVsZW0sIFwib2xkZGlzcGxheVwiLCBkZWZhdWx0RGlzcGxheShlbGVtLm5vZGVOYW1lKSApO1xuXHRcdFx0fVxuXHRcdH0gZWxzZSB7XG5cdFx0XHRoaWRkZW4gPSBpc0hpZGRlbiggZWxlbSApO1xuXG5cdFx0XHRpZiAoIGRpc3BsYXkgIT09IFwibm9uZVwiIHx8ICFoaWRkZW4gKSB7XG5cdFx0XHRcdGRhdGFfcHJpdi5zZXQoIGVsZW0sIFwib2xkZGlzcGxheVwiLCBoaWRkZW4gPyBkaXNwbGF5IDogalF1ZXJ5LmNzcyggZWxlbSwgXCJkaXNwbGF5XCIgKSApO1xuXHRcdFx0fVxuXHRcdH1cblx0fVxuXG5cdC8vIFNldCB0aGUgZGlzcGxheSBvZiBtb3N0IG9mIHRoZSBlbGVtZW50cyBpbiBhIHNlY29uZCBsb29wXG5cdC8vIHRvIGF2b2lkIHRoZSBjb25zdGFudCByZWZsb3dcblx0Zm9yICggaW5kZXggPSAwOyBpbmRleCA8IGxlbmd0aDsgaW5kZXgrKyApIHtcblx0XHRlbGVtID0gZWxlbWVudHNbIGluZGV4IF07XG5cdFx0aWYgKCAhZWxlbS5zdHlsZSApIHtcblx0XHRcdGNvbnRpbnVlO1xuXHRcdH1cblx0XHRpZiAoICFzaG93IHx8IGVsZW0uc3R5bGUuZGlzcGxheSA9PT0gXCJub25lXCIgfHwgZWxlbS5zdHlsZS5kaXNwbGF5ID09PSBcIlwiICkge1xuXHRcdFx0ZWxlbS5zdHlsZS5kaXNwbGF5ID0gc2hvdyA/IHZhbHVlc1sgaW5kZXggXSB8fCBcIlwiIDogXCJub25lXCI7XG5cdFx0fVxuXHR9XG5cblx0cmV0dXJuIGVsZW1lbnRzO1xufVxuXG5qUXVlcnkuZXh0ZW5kKHtcblxuXHQvLyBBZGQgaW4gc3R5bGUgcHJvcGVydHkgaG9va3MgZm9yIG92ZXJyaWRpbmcgdGhlIGRlZmF1bHRcblx0Ly8gYmVoYXZpb3Igb2YgZ2V0dGluZyBhbmQgc2V0dGluZyBhIHN0eWxlIHByb3BlcnR5XG5cdGNzc0hvb2tzOiB7XG5cdFx0b3BhY2l0eToge1xuXHRcdFx0Z2V0OiBmdW5jdGlvbiggZWxlbSwgY29tcHV0ZWQgKSB7XG5cdFx0XHRcdGlmICggY29tcHV0ZWQgKSB7XG5cblx0XHRcdFx0XHQvLyBXZSBzaG91bGQgYWx3YXlzIGdldCBhIG51bWJlciBiYWNrIGZyb20gb3BhY2l0eVxuXHRcdFx0XHRcdHZhciByZXQgPSBjdXJDU1MoIGVsZW0sIFwib3BhY2l0eVwiICk7XG5cdFx0XHRcdFx0cmV0dXJuIHJldCA9PT0gXCJcIiA/IFwiMVwiIDogcmV0O1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fVxuXHR9LFxuXG5cdC8vIERvbid0IGF1dG9tYXRpY2FsbHkgYWRkIFwicHhcIiB0byB0aGVzZSBwb3NzaWJseS11bml0bGVzcyBwcm9wZXJ0aWVzXG5cdGNzc051bWJlcjoge1xuXHRcdFwiY29sdW1uQ291bnRcIjogdHJ1ZSxcblx0XHRcImZpbGxPcGFjaXR5XCI6IHRydWUsXG5cdFx0XCJmbGV4R3Jvd1wiOiB0cnVlLFxuXHRcdFwiZmxleFNocmlua1wiOiB0cnVlLFxuXHRcdFwiZm9udFdlaWdodFwiOiB0cnVlLFxuXHRcdFwibGluZUhlaWdodFwiOiB0cnVlLFxuXHRcdFwib3BhY2l0eVwiOiB0cnVlLFxuXHRcdFwib3JkZXJcIjogdHJ1ZSxcblx0XHRcIm9ycGhhbnNcIjogdHJ1ZSxcblx0XHRcIndpZG93c1wiOiB0cnVlLFxuXHRcdFwiekluZGV4XCI6IHRydWUsXG5cdFx0XCJ6b29tXCI6IHRydWVcblx0fSxcblxuXHQvLyBBZGQgaW4gcHJvcGVydGllcyB3aG9zZSBuYW1lcyB5b3Ugd2lzaCB0byBmaXggYmVmb3JlXG5cdC8vIHNldHRpbmcgb3IgZ2V0dGluZyB0aGUgdmFsdWVcblx0Y3NzUHJvcHM6IHtcblx0XHRcImZsb2F0XCI6IFwiY3NzRmxvYXRcIlxuXHR9LFxuXG5cdC8vIEdldCBhbmQgc2V0IHRoZSBzdHlsZSBwcm9wZXJ0eSBvbiBhIERPTSBOb2RlXG5cdHN0eWxlOiBmdW5jdGlvbiggZWxlbSwgbmFtZSwgdmFsdWUsIGV4dHJhICkge1xuXG5cdFx0Ly8gRG9uJ3Qgc2V0IHN0eWxlcyBvbiB0ZXh0IGFuZCBjb21tZW50IG5vZGVzXG5cdFx0aWYgKCAhZWxlbSB8fCBlbGVtLm5vZGVUeXBlID09PSAzIHx8IGVsZW0ubm9kZVR5cGUgPT09IDggfHwgIWVsZW0uc3R5bGUgKSB7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXG5cdFx0Ly8gTWFrZSBzdXJlIHRoYXQgd2UncmUgd29ya2luZyB3aXRoIHRoZSByaWdodCBuYW1lXG5cdFx0dmFyIHJldCwgdHlwZSwgaG9va3MsXG5cdFx0XHRvcmlnTmFtZSA9IGpRdWVyeS5jYW1lbENhc2UoIG5hbWUgKSxcblx0XHRcdHN0eWxlID0gZWxlbS5zdHlsZTtcblxuXHRcdG5hbWUgPSBqUXVlcnkuY3NzUHJvcHNbIG9yaWdOYW1lIF0gfHwgKCBqUXVlcnkuY3NzUHJvcHNbIG9yaWdOYW1lIF0gPSB2ZW5kb3JQcm9wTmFtZSggc3R5bGUsIG9yaWdOYW1lICkgKTtcblxuXHRcdC8vIEdldHMgaG9vayBmb3IgdGhlIHByZWZpeGVkIHZlcnNpb24sIHRoZW4gdW5wcmVmaXhlZCB2ZXJzaW9uXG5cdFx0aG9va3MgPSBqUXVlcnkuY3NzSG9va3NbIG5hbWUgXSB8fCBqUXVlcnkuY3NzSG9va3NbIG9yaWdOYW1lIF07XG5cblx0XHQvLyBDaGVjayBpZiB3ZSdyZSBzZXR0aW5nIGEgdmFsdWVcblx0XHRpZiAoIHZhbHVlICE9PSB1bmRlZmluZWQgKSB7XG5cdFx0XHR0eXBlID0gdHlwZW9mIHZhbHVlO1xuXG5cdFx0XHQvLyBDb252ZXJ0IFwiKz1cIiBvciBcIi09XCIgdG8gcmVsYXRpdmUgbnVtYmVycyAoIzczNDUpXG5cdFx0XHRpZiAoIHR5cGUgPT09IFwic3RyaW5nXCIgJiYgKHJldCA9IHJyZWxOdW0uZXhlYyggdmFsdWUgKSkgKSB7XG5cdFx0XHRcdHZhbHVlID0gKCByZXRbMV0gKyAxICkgKiByZXRbMl0gKyBwYXJzZUZsb2F0KCBqUXVlcnkuY3NzKCBlbGVtLCBuYW1lICkgKTtcblx0XHRcdFx0Ly8gRml4ZXMgYnVnICM5MjM3XG5cdFx0XHRcdHR5cGUgPSBcIm51bWJlclwiO1xuXHRcdFx0fVxuXG5cdFx0XHQvLyBNYWtlIHN1cmUgdGhhdCBudWxsIGFuZCBOYU4gdmFsdWVzIGFyZW4ndCBzZXQgKCM3MTE2KVxuXHRcdFx0aWYgKCB2YWx1ZSA9PSBudWxsIHx8IHZhbHVlICE9PSB2YWx1ZSApIHtcblx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0fVxuXG5cdFx0XHQvLyBJZiBhIG51bWJlciwgYWRkICdweCcgdG8gdGhlIChleGNlcHQgZm9yIGNlcnRhaW4gQ1NTIHByb3BlcnRpZXMpXG5cdFx0XHRpZiAoIHR5cGUgPT09IFwibnVtYmVyXCIgJiYgIWpRdWVyeS5jc3NOdW1iZXJbIG9yaWdOYW1lIF0gKSB7XG5cdFx0XHRcdHZhbHVlICs9IFwicHhcIjtcblx0XHRcdH1cblxuXHRcdFx0Ly8gU3VwcG9ydDogSUU5LTExK1xuXHRcdFx0Ly8gYmFja2dyb3VuZC0qIHByb3BzIGFmZmVjdCBvcmlnaW5hbCBjbG9uZSdzIHZhbHVlc1xuXHRcdFx0aWYgKCAhc3VwcG9ydC5jbGVhckNsb25lU3R5bGUgJiYgdmFsdWUgPT09IFwiXCIgJiYgbmFtZS5pbmRleE9mKCBcImJhY2tncm91bmRcIiApID09PSAwICkge1xuXHRcdFx0XHRzdHlsZVsgbmFtZSBdID0gXCJpbmhlcml0XCI7XG5cdFx0XHR9XG5cblx0XHRcdC8vIElmIGEgaG9vayB3YXMgcHJvdmlkZWQsIHVzZSB0aGF0IHZhbHVlLCBvdGhlcndpc2UganVzdCBzZXQgdGhlIHNwZWNpZmllZCB2YWx1ZVxuXHRcdFx0aWYgKCAhaG9va3MgfHwgIShcInNldFwiIGluIGhvb2tzKSB8fCAodmFsdWUgPSBob29rcy5zZXQoIGVsZW0sIHZhbHVlLCBleHRyYSApKSAhPT0gdW5kZWZpbmVkICkge1xuXHRcdFx0XHRzdHlsZVsgbmFtZSBdID0gdmFsdWU7XG5cdFx0XHR9XG5cblx0XHR9IGVsc2Uge1xuXHRcdFx0Ly8gSWYgYSBob29rIHdhcyBwcm92aWRlZCBnZXQgdGhlIG5vbi1jb21wdXRlZCB2YWx1ZSBmcm9tIHRoZXJlXG5cdFx0XHRpZiAoIGhvb2tzICYmIFwiZ2V0XCIgaW4gaG9va3MgJiYgKHJldCA9IGhvb2tzLmdldCggZWxlbSwgZmFsc2UsIGV4dHJhICkpICE9PSB1bmRlZmluZWQgKSB7XG5cdFx0XHRcdHJldHVybiByZXQ7XG5cdFx0XHR9XG5cblx0XHRcdC8vIE90aGVyd2lzZSBqdXN0IGdldCB0aGUgdmFsdWUgZnJvbSB0aGUgc3R5bGUgb2JqZWN0XG5cdFx0XHRyZXR1cm4gc3R5bGVbIG5hbWUgXTtcblx0XHR9XG5cdH0sXG5cblx0Y3NzOiBmdW5jdGlvbiggZWxlbSwgbmFtZSwgZXh0cmEsIHN0eWxlcyApIHtcblx0XHR2YXIgdmFsLCBudW0sIGhvb2tzLFxuXHRcdFx0b3JpZ05hbWUgPSBqUXVlcnkuY2FtZWxDYXNlKCBuYW1lICk7XG5cblx0XHQvLyBNYWtlIHN1cmUgdGhhdCB3ZSdyZSB3b3JraW5nIHdpdGggdGhlIHJpZ2h0IG5hbWVcblx0XHRuYW1lID0galF1ZXJ5LmNzc1Byb3BzWyBvcmlnTmFtZSBdIHx8ICggalF1ZXJ5LmNzc1Byb3BzWyBvcmlnTmFtZSBdID0gdmVuZG9yUHJvcE5hbWUoIGVsZW0uc3R5bGUsIG9yaWdOYW1lICkgKTtcblxuXHRcdC8vIFRyeSBwcmVmaXhlZCBuYW1lIGZvbGxvd2VkIGJ5IHRoZSB1bnByZWZpeGVkIG5hbWVcblx0XHRob29rcyA9IGpRdWVyeS5jc3NIb29rc1sgbmFtZSBdIHx8IGpRdWVyeS5jc3NIb29rc1sgb3JpZ05hbWUgXTtcblxuXHRcdC8vIElmIGEgaG9vayB3YXMgcHJvdmlkZWQgZ2V0IHRoZSBjb21wdXRlZCB2YWx1ZSBmcm9tIHRoZXJlXG5cdFx0aWYgKCBob29rcyAmJiBcImdldFwiIGluIGhvb2tzICkge1xuXHRcdFx0dmFsID0gaG9va3MuZ2V0KCBlbGVtLCB0cnVlLCBleHRyYSApO1xuXHRcdH1cblxuXHRcdC8vIE90aGVyd2lzZSwgaWYgYSB3YXkgdG8gZ2V0IHRoZSBjb21wdXRlZCB2YWx1ZSBleGlzdHMsIHVzZSB0aGF0XG5cdFx0aWYgKCB2YWwgPT09IHVuZGVmaW5lZCApIHtcblx0XHRcdHZhbCA9IGN1ckNTUyggZWxlbSwgbmFtZSwgc3R5bGVzICk7XG5cdFx0fVxuXG5cdFx0Ly8gQ29udmVydCBcIm5vcm1hbFwiIHRvIGNvbXB1dGVkIHZhbHVlXG5cdFx0aWYgKCB2YWwgPT09IFwibm9ybWFsXCIgJiYgbmFtZSBpbiBjc3NOb3JtYWxUcmFuc2Zvcm0gKSB7XG5cdFx0XHR2YWwgPSBjc3NOb3JtYWxUcmFuc2Zvcm1bIG5hbWUgXTtcblx0XHR9XG5cblx0XHQvLyBNYWtlIG51bWVyaWMgaWYgZm9yY2VkIG9yIGEgcXVhbGlmaWVyIHdhcyBwcm92aWRlZCBhbmQgdmFsIGxvb2tzIG51bWVyaWNcblx0XHRpZiAoIGV4dHJhID09PSBcIlwiIHx8IGV4dHJhICkge1xuXHRcdFx0bnVtID0gcGFyc2VGbG9hdCggdmFsICk7XG5cdFx0XHRyZXR1cm4gZXh0cmEgPT09IHRydWUgfHwgalF1ZXJ5LmlzTnVtZXJpYyggbnVtICkgPyBudW0gfHwgMCA6IHZhbDtcblx0XHR9XG5cdFx0cmV0dXJuIHZhbDtcblx0fVxufSk7XG5cbmpRdWVyeS5lYWNoKFsgXCJoZWlnaHRcIiwgXCJ3aWR0aFwiIF0sIGZ1bmN0aW9uKCBpLCBuYW1lICkge1xuXHRqUXVlcnkuY3NzSG9va3NbIG5hbWUgXSA9IHtcblx0XHRnZXQ6IGZ1bmN0aW9uKCBlbGVtLCBjb21wdXRlZCwgZXh0cmEgKSB7XG5cdFx0XHRpZiAoIGNvbXB1dGVkICkge1xuXG5cdFx0XHRcdC8vIENlcnRhaW4gZWxlbWVudHMgY2FuIGhhdmUgZGltZW5zaW9uIGluZm8gaWYgd2UgaW52aXNpYmx5IHNob3cgdGhlbVxuXHRcdFx0XHQvLyBidXQgaXQgbXVzdCBoYXZlIGEgY3VycmVudCBkaXNwbGF5IHN0eWxlIHRoYXQgd291bGQgYmVuZWZpdFxuXHRcdFx0XHRyZXR1cm4gcmRpc3BsYXlzd2FwLnRlc3QoIGpRdWVyeS5jc3MoIGVsZW0sIFwiZGlzcGxheVwiICkgKSAmJiBlbGVtLm9mZnNldFdpZHRoID09PSAwID9cblx0XHRcdFx0XHRqUXVlcnkuc3dhcCggZWxlbSwgY3NzU2hvdywgZnVuY3Rpb24oKSB7XG5cdFx0XHRcdFx0XHRyZXR1cm4gZ2V0V2lkdGhPckhlaWdodCggZWxlbSwgbmFtZSwgZXh0cmEgKTtcblx0XHRcdFx0XHR9KSA6XG5cdFx0XHRcdFx0Z2V0V2lkdGhPckhlaWdodCggZWxlbSwgbmFtZSwgZXh0cmEgKTtcblx0XHRcdH1cblx0XHR9LFxuXG5cdFx0c2V0OiBmdW5jdGlvbiggZWxlbSwgdmFsdWUsIGV4dHJhICkge1xuXHRcdFx0dmFyIHN0eWxlcyA9IGV4dHJhICYmIGdldFN0eWxlcyggZWxlbSApO1xuXHRcdFx0cmV0dXJuIHNldFBvc2l0aXZlTnVtYmVyKCBlbGVtLCB2YWx1ZSwgZXh0cmEgP1xuXHRcdFx0XHRhdWdtZW50V2lkdGhPckhlaWdodChcblx0XHRcdFx0XHRlbGVtLFxuXHRcdFx0XHRcdG5hbWUsXG5cdFx0XHRcdFx0ZXh0cmEsXG5cdFx0XHRcdFx0alF1ZXJ5LmNzcyggZWxlbSwgXCJib3hTaXppbmdcIiwgZmFsc2UsIHN0eWxlcyApID09PSBcImJvcmRlci1ib3hcIixcblx0XHRcdFx0XHRzdHlsZXNcblx0XHRcdFx0KSA6IDBcblx0XHRcdCk7XG5cdFx0fVxuXHR9O1xufSk7XG5cbi8vIFN1cHBvcnQ6IEFuZHJvaWQgMi4zXG5qUXVlcnkuY3NzSG9va3MubWFyZ2luUmlnaHQgPSBhZGRHZXRIb29rSWYoIHN1cHBvcnQucmVsaWFibGVNYXJnaW5SaWdodCxcblx0ZnVuY3Rpb24oIGVsZW0sIGNvbXB1dGVkICkge1xuXHRcdGlmICggY29tcHV0ZWQgKSB7XG5cdFx0XHRyZXR1cm4galF1ZXJ5LnN3YXAoIGVsZW0sIHsgXCJkaXNwbGF5XCI6IFwiaW5saW5lLWJsb2NrXCIgfSxcblx0XHRcdFx0Y3VyQ1NTLCBbIGVsZW0sIFwibWFyZ2luUmlnaHRcIiBdICk7XG5cdFx0fVxuXHR9XG4pO1xuXG4vLyBUaGVzZSBob29rcyBhcmUgdXNlZCBieSBhbmltYXRlIHRvIGV4cGFuZCBwcm9wZXJ0aWVzXG5qUXVlcnkuZWFjaCh7XG5cdG1hcmdpbjogXCJcIixcblx0cGFkZGluZzogXCJcIixcblx0Ym9yZGVyOiBcIldpZHRoXCJcbn0sIGZ1bmN0aW9uKCBwcmVmaXgsIHN1ZmZpeCApIHtcblx0alF1ZXJ5LmNzc0hvb2tzWyBwcmVmaXggKyBzdWZmaXggXSA9IHtcblx0XHRleHBhbmQ6IGZ1bmN0aW9uKCB2YWx1ZSApIHtcblx0XHRcdHZhciBpID0gMCxcblx0XHRcdFx0ZXhwYW5kZWQgPSB7fSxcblxuXHRcdFx0XHQvLyBBc3N1bWVzIGEgc2luZ2xlIG51bWJlciBpZiBub3QgYSBzdHJpbmdcblx0XHRcdFx0cGFydHMgPSB0eXBlb2YgdmFsdWUgPT09IFwic3RyaW5nXCIgPyB2YWx1ZS5zcGxpdChcIiBcIikgOiBbIHZhbHVlIF07XG5cblx0XHRcdGZvciAoIDsgaSA8IDQ7IGkrKyApIHtcblx0XHRcdFx0ZXhwYW5kZWRbIHByZWZpeCArIGNzc0V4cGFuZFsgaSBdICsgc3VmZml4IF0gPVxuXHRcdFx0XHRcdHBhcnRzWyBpIF0gfHwgcGFydHNbIGkgLSAyIF0gfHwgcGFydHNbIDAgXTtcblx0XHRcdH1cblxuXHRcdFx0cmV0dXJuIGV4cGFuZGVkO1xuXHRcdH1cblx0fTtcblxuXHRpZiAoICFybWFyZ2luLnRlc3QoIHByZWZpeCApICkge1xuXHRcdGpRdWVyeS5jc3NIb29rc1sgcHJlZml4ICsgc3VmZml4IF0uc2V0ID0gc2V0UG9zaXRpdmVOdW1iZXI7XG5cdH1cbn0pO1xuXG5qUXVlcnkuZm4uZXh0ZW5kKHtcblx0Y3NzOiBmdW5jdGlvbiggbmFtZSwgdmFsdWUgKSB7XG5cdFx0cmV0dXJuIGFjY2VzcyggdGhpcywgZnVuY3Rpb24oIGVsZW0sIG5hbWUsIHZhbHVlICkge1xuXHRcdFx0dmFyIHN0eWxlcywgbGVuLFxuXHRcdFx0XHRtYXAgPSB7fSxcblx0XHRcdFx0aSA9IDA7XG5cblx0XHRcdGlmICggalF1ZXJ5LmlzQXJyYXkoIG5hbWUgKSApIHtcblx0XHRcdFx0c3R5bGVzID0gZ2V0U3R5bGVzKCBlbGVtICk7XG5cdFx0XHRcdGxlbiA9IG5hbWUubGVuZ3RoO1xuXG5cdFx0XHRcdGZvciAoIDsgaSA8IGxlbjsgaSsrICkge1xuXHRcdFx0XHRcdG1hcFsgbmFtZVsgaSBdIF0gPSBqUXVlcnkuY3NzKCBlbGVtLCBuYW1lWyBpIF0sIGZhbHNlLCBzdHlsZXMgKTtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdHJldHVybiBtYXA7XG5cdFx0XHR9XG5cblx0XHRcdHJldHVybiB2YWx1ZSAhPT0gdW5kZWZpbmVkID9cblx0XHRcdFx0alF1ZXJ5LnN0eWxlKCBlbGVtLCBuYW1lLCB2YWx1ZSApIDpcblx0XHRcdFx0alF1ZXJ5LmNzcyggZWxlbSwgbmFtZSApO1xuXHRcdH0sIG5hbWUsIHZhbHVlLCBhcmd1bWVudHMubGVuZ3RoID4gMSApO1xuXHR9LFxuXHRzaG93OiBmdW5jdGlvbigpIHtcblx0XHRyZXR1cm4gc2hvd0hpZGUoIHRoaXMsIHRydWUgKTtcblx0fSxcblx0aGlkZTogZnVuY3Rpb24oKSB7XG5cdFx0cmV0dXJuIHNob3dIaWRlKCB0aGlzICk7XG5cdH0sXG5cdHRvZ2dsZTogZnVuY3Rpb24oIHN0YXRlICkge1xuXHRcdGlmICggdHlwZW9mIHN0YXRlID09PSBcImJvb2xlYW5cIiApIHtcblx0XHRcdHJldHVybiBzdGF0ZSA/IHRoaXMuc2hvdygpIDogdGhpcy5oaWRlKCk7XG5cdFx0fVxuXG5cdFx0cmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbigpIHtcblx0XHRcdGlmICggaXNIaWRkZW4oIHRoaXMgKSApIHtcblx0XHRcdFx0alF1ZXJ5KCB0aGlzICkuc2hvdygpO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0alF1ZXJ5KCB0aGlzICkuaGlkZSgpO1xuXHRcdFx0fVxuXHRcdH0pO1xuXHR9XG59KTtcblxuXG5mdW5jdGlvbiBUd2VlbiggZWxlbSwgb3B0aW9ucywgcHJvcCwgZW5kLCBlYXNpbmcgKSB7XG5cdHJldHVybiBuZXcgVHdlZW4ucHJvdG90eXBlLmluaXQoIGVsZW0sIG9wdGlvbnMsIHByb3AsIGVuZCwgZWFzaW5nICk7XG59XG5qUXVlcnkuVHdlZW4gPSBUd2VlbjtcblxuVHdlZW4ucHJvdG90eXBlID0ge1xuXHRjb25zdHJ1Y3RvcjogVHdlZW4sXG5cdGluaXQ6IGZ1bmN0aW9uKCBlbGVtLCBvcHRpb25zLCBwcm9wLCBlbmQsIGVhc2luZywgdW5pdCApIHtcblx0XHR0aGlzLmVsZW0gPSBlbGVtO1xuXHRcdHRoaXMucHJvcCA9IHByb3A7XG5cdFx0dGhpcy5lYXNpbmcgPSBlYXNpbmcgfHwgXCJzd2luZ1wiO1xuXHRcdHRoaXMub3B0aW9ucyA9IG9wdGlvbnM7XG5cdFx0dGhpcy5zdGFydCA9IHRoaXMubm93ID0gdGhpcy5jdXIoKTtcblx0XHR0aGlzLmVuZCA9IGVuZDtcblx0XHR0aGlzLnVuaXQgPSB1bml0IHx8ICggalF1ZXJ5LmNzc051bWJlclsgcHJvcCBdID8gXCJcIiA6IFwicHhcIiApO1xuXHR9LFxuXHRjdXI6IGZ1bmN0aW9uKCkge1xuXHRcdHZhciBob29rcyA9IFR3ZWVuLnByb3BIb29rc1sgdGhpcy5wcm9wIF07XG5cblx0XHRyZXR1cm4gaG9va3MgJiYgaG9va3MuZ2V0ID9cblx0XHRcdGhvb2tzLmdldCggdGhpcyApIDpcblx0XHRcdFR3ZWVuLnByb3BIb29rcy5fZGVmYXVsdC5nZXQoIHRoaXMgKTtcblx0fSxcblx0cnVuOiBmdW5jdGlvbiggcGVyY2VudCApIHtcblx0XHR2YXIgZWFzZWQsXG5cdFx0XHRob29rcyA9IFR3ZWVuLnByb3BIb29rc1sgdGhpcy5wcm9wIF07XG5cblx0XHRpZiAoIHRoaXMub3B0aW9ucy5kdXJhdGlvbiApIHtcblx0XHRcdHRoaXMucG9zID0gZWFzZWQgPSBqUXVlcnkuZWFzaW5nWyB0aGlzLmVhc2luZyBdKFxuXHRcdFx0XHRwZXJjZW50LCB0aGlzLm9wdGlvbnMuZHVyYXRpb24gKiBwZXJjZW50LCAwLCAxLCB0aGlzLm9wdGlvbnMuZHVyYXRpb25cblx0XHRcdCk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdHRoaXMucG9zID0gZWFzZWQgPSBwZXJjZW50O1xuXHRcdH1cblx0XHR0aGlzLm5vdyA9ICggdGhpcy5lbmQgLSB0aGlzLnN0YXJ0ICkgKiBlYXNlZCArIHRoaXMuc3RhcnQ7XG5cblx0XHRpZiAoIHRoaXMub3B0aW9ucy5zdGVwICkge1xuXHRcdFx0dGhpcy5vcHRpb25zLnN0ZXAuY2FsbCggdGhpcy5lbGVtLCB0aGlzLm5vdywgdGhpcyApO1xuXHRcdH1cblxuXHRcdGlmICggaG9va3MgJiYgaG9va3Muc2V0ICkge1xuXHRcdFx0aG9va3Muc2V0KCB0aGlzICk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdFR3ZWVuLnByb3BIb29rcy5fZGVmYXVsdC5zZXQoIHRoaXMgKTtcblx0XHR9XG5cdFx0cmV0dXJuIHRoaXM7XG5cdH1cbn07XG5cblR3ZWVuLnByb3RvdHlwZS5pbml0LnByb3RvdHlwZSA9IFR3ZWVuLnByb3RvdHlwZTtcblxuVHdlZW4ucHJvcEhvb2tzID0ge1xuXHRfZGVmYXVsdDoge1xuXHRcdGdldDogZnVuY3Rpb24oIHR3ZWVuICkge1xuXHRcdFx0dmFyIHJlc3VsdDtcblxuXHRcdFx0aWYgKCB0d2Vlbi5lbGVtWyB0d2Vlbi5wcm9wIF0gIT0gbnVsbCAmJlxuXHRcdFx0XHQoIXR3ZWVuLmVsZW0uc3R5bGUgfHwgdHdlZW4uZWxlbS5zdHlsZVsgdHdlZW4ucHJvcCBdID09IG51bGwpICkge1xuXHRcdFx0XHRyZXR1cm4gdHdlZW4uZWxlbVsgdHdlZW4ucHJvcCBdO1xuXHRcdFx0fVxuXG5cdFx0XHQvLyBQYXNzaW5nIGFuIGVtcHR5IHN0cmluZyBhcyBhIDNyZCBwYXJhbWV0ZXIgdG8gLmNzcyB3aWxsIGF1dG9tYXRpY2FsbHlcblx0XHRcdC8vIGF0dGVtcHQgYSBwYXJzZUZsb2F0IGFuZCBmYWxsYmFjayB0byBhIHN0cmluZyBpZiB0aGUgcGFyc2UgZmFpbHMuXG5cdFx0XHQvLyBTaW1wbGUgdmFsdWVzIHN1Y2ggYXMgXCIxMHB4XCIgYXJlIHBhcnNlZCB0byBGbG9hdDtcblx0XHRcdC8vIGNvbXBsZXggdmFsdWVzIHN1Y2ggYXMgXCJyb3RhdGUoMXJhZClcIiBhcmUgcmV0dXJuZWQgYXMtaXMuXG5cdFx0XHRyZXN1bHQgPSBqUXVlcnkuY3NzKCB0d2Vlbi5lbGVtLCB0d2Vlbi5wcm9wLCBcIlwiICk7XG5cdFx0XHQvLyBFbXB0eSBzdHJpbmdzLCBudWxsLCB1bmRlZmluZWQgYW5kIFwiYXV0b1wiIGFyZSBjb252ZXJ0ZWQgdG8gMC5cblx0XHRcdHJldHVybiAhcmVzdWx0IHx8IHJlc3VsdCA9PT0gXCJhdXRvXCIgPyAwIDogcmVzdWx0O1xuXHRcdH0sXG5cdFx0c2V0OiBmdW5jdGlvbiggdHdlZW4gKSB7XG5cdFx0XHQvLyBVc2Ugc3RlcCBob29rIGZvciBiYWNrIGNvbXBhdC5cblx0XHRcdC8vIFVzZSBjc3NIb29rIGlmIGl0cyB0aGVyZS5cblx0XHRcdC8vIFVzZSAuc3R5bGUgaWYgYXZhaWxhYmxlIGFuZCB1c2UgcGxhaW4gcHJvcGVydGllcyB3aGVyZSBhdmFpbGFibGUuXG5cdFx0XHRpZiAoIGpRdWVyeS5meC5zdGVwWyB0d2Vlbi5wcm9wIF0gKSB7XG5cdFx0XHRcdGpRdWVyeS5meC5zdGVwWyB0d2Vlbi5wcm9wIF0oIHR3ZWVuICk7XG5cdFx0XHR9IGVsc2UgaWYgKCB0d2Vlbi5lbGVtLnN0eWxlICYmICggdHdlZW4uZWxlbS5zdHlsZVsgalF1ZXJ5LmNzc1Byb3BzWyB0d2Vlbi5wcm9wIF0gXSAhPSBudWxsIHx8IGpRdWVyeS5jc3NIb29rc1sgdHdlZW4ucHJvcCBdICkgKSB7XG5cdFx0XHRcdGpRdWVyeS5zdHlsZSggdHdlZW4uZWxlbSwgdHdlZW4ucHJvcCwgdHdlZW4ubm93ICsgdHdlZW4udW5pdCApO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0dHdlZW4uZWxlbVsgdHdlZW4ucHJvcCBdID0gdHdlZW4ubm93O1xuXHRcdFx0fVxuXHRcdH1cblx0fVxufTtcblxuLy8gU3VwcG9ydDogSUU5XG4vLyBQYW5pYyBiYXNlZCBhcHByb2FjaCB0byBzZXR0aW5nIHRoaW5ncyBvbiBkaXNjb25uZWN0ZWQgbm9kZXNcblR3ZWVuLnByb3BIb29rcy5zY3JvbGxUb3AgPSBUd2Vlbi5wcm9wSG9va3Muc2Nyb2xsTGVmdCA9IHtcblx0c2V0OiBmdW5jdGlvbiggdHdlZW4gKSB7XG5cdFx0aWYgKCB0d2Vlbi5lbGVtLm5vZGVUeXBlICYmIHR3ZWVuLmVsZW0ucGFyZW50Tm9kZSApIHtcblx0XHRcdHR3ZWVuLmVsZW1bIHR3ZWVuLnByb3AgXSA9IHR3ZWVuLm5vdztcblx0XHR9XG5cdH1cbn07XG5cbmpRdWVyeS5lYXNpbmcgPSB7XG5cdGxpbmVhcjogZnVuY3Rpb24oIHAgKSB7XG5cdFx0cmV0dXJuIHA7XG5cdH0sXG5cdHN3aW5nOiBmdW5jdGlvbiggcCApIHtcblx0XHRyZXR1cm4gMC41IC0gTWF0aC5jb3MoIHAgKiBNYXRoLlBJICkgLyAyO1xuXHR9XG59O1xuXG5qUXVlcnkuZnggPSBUd2Vlbi5wcm90b3R5cGUuaW5pdDtcblxuLy8gQmFjayBDb21wYXQgPDEuOCBleHRlbnNpb24gcG9pbnRcbmpRdWVyeS5meC5zdGVwID0ge307XG5cblxuXG5cbnZhclxuXHRmeE5vdywgdGltZXJJZCxcblx0cmZ4dHlwZXMgPSAvXig/OnRvZ2dsZXxzaG93fGhpZGUpJC8sXG5cdHJmeG51bSA9IG5ldyBSZWdFeHAoIFwiXig/OihbKy1dKT18KShcIiArIHBudW0gKyBcIikoW2EteiVdKikkXCIsIFwiaVwiICksXG5cdHJydW4gPSAvcXVldWVIb29rcyQvLFxuXHRhbmltYXRpb25QcmVmaWx0ZXJzID0gWyBkZWZhdWx0UHJlZmlsdGVyIF0sXG5cdHR3ZWVuZXJzID0ge1xuXHRcdFwiKlwiOiBbIGZ1bmN0aW9uKCBwcm9wLCB2YWx1ZSApIHtcblx0XHRcdHZhciB0d2VlbiA9IHRoaXMuY3JlYXRlVHdlZW4oIHByb3AsIHZhbHVlICksXG5cdFx0XHRcdHRhcmdldCA9IHR3ZWVuLmN1cigpLFxuXHRcdFx0XHRwYXJ0cyA9IHJmeG51bS5leGVjKCB2YWx1ZSApLFxuXHRcdFx0XHR1bml0ID0gcGFydHMgJiYgcGFydHNbIDMgXSB8fCAoIGpRdWVyeS5jc3NOdW1iZXJbIHByb3AgXSA/IFwiXCIgOiBcInB4XCIgKSxcblxuXHRcdFx0XHQvLyBTdGFydGluZyB2YWx1ZSBjb21wdXRhdGlvbiBpcyByZXF1aXJlZCBmb3IgcG90ZW50aWFsIHVuaXQgbWlzbWF0Y2hlc1xuXHRcdFx0XHRzdGFydCA9ICggalF1ZXJ5LmNzc051bWJlclsgcHJvcCBdIHx8IHVuaXQgIT09IFwicHhcIiAmJiArdGFyZ2V0ICkgJiZcblx0XHRcdFx0XHRyZnhudW0uZXhlYyggalF1ZXJ5LmNzcyggdHdlZW4uZWxlbSwgcHJvcCApICksXG5cdFx0XHRcdHNjYWxlID0gMSxcblx0XHRcdFx0bWF4SXRlcmF0aW9ucyA9IDIwO1xuXG5cdFx0XHRpZiAoIHN0YXJ0ICYmIHN0YXJ0WyAzIF0gIT09IHVuaXQgKSB7XG5cdFx0XHRcdC8vIFRydXN0IHVuaXRzIHJlcG9ydGVkIGJ5IGpRdWVyeS5jc3Ncblx0XHRcdFx0dW5pdCA9IHVuaXQgfHwgc3RhcnRbIDMgXTtcblxuXHRcdFx0XHQvLyBNYWtlIHN1cmUgd2UgdXBkYXRlIHRoZSB0d2VlbiBwcm9wZXJ0aWVzIGxhdGVyIG9uXG5cdFx0XHRcdHBhcnRzID0gcGFydHMgfHwgW107XG5cblx0XHRcdFx0Ly8gSXRlcmF0aXZlbHkgYXBwcm94aW1hdGUgZnJvbSBhIG5vbnplcm8gc3RhcnRpbmcgcG9pbnRcblx0XHRcdFx0c3RhcnQgPSArdGFyZ2V0IHx8IDE7XG5cblx0XHRcdFx0ZG8ge1xuXHRcdFx0XHRcdC8vIElmIHByZXZpb3VzIGl0ZXJhdGlvbiB6ZXJvZWQgb3V0LCBkb3VibGUgdW50aWwgd2UgZ2V0ICpzb21ldGhpbmcqLlxuXHRcdFx0XHRcdC8vIFVzZSBzdHJpbmcgZm9yIGRvdWJsaW5nIHNvIHdlIGRvbid0IGFjY2lkZW50YWxseSBzZWUgc2NhbGUgYXMgdW5jaGFuZ2VkIGJlbG93XG5cdFx0XHRcdFx0c2NhbGUgPSBzY2FsZSB8fCBcIi41XCI7XG5cblx0XHRcdFx0XHQvLyBBZGp1c3QgYW5kIGFwcGx5XG5cdFx0XHRcdFx0c3RhcnQgPSBzdGFydCAvIHNjYWxlO1xuXHRcdFx0XHRcdGpRdWVyeS5zdHlsZSggdHdlZW4uZWxlbSwgcHJvcCwgc3RhcnQgKyB1bml0ICk7XG5cblx0XHRcdFx0Ly8gVXBkYXRlIHNjYWxlLCB0b2xlcmF0aW5nIHplcm8gb3IgTmFOIGZyb20gdHdlZW4uY3VyKCksXG5cdFx0XHRcdC8vIGJyZWFrIHRoZSBsb29wIGlmIHNjYWxlIGlzIHVuY2hhbmdlZCBvciBwZXJmZWN0LCBvciBpZiB3ZSd2ZSBqdXN0IGhhZCBlbm91Z2hcblx0XHRcdFx0fSB3aGlsZSAoIHNjYWxlICE9PSAoc2NhbGUgPSB0d2Vlbi5jdXIoKSAvIHRhcmdldCkgJiYgc2NhbGUgIT09IDEgJiYgLS1tYXhJdGVyYXRpb25zICk7XG5cdFx0XHR9XG5cblx0XHRcdC8vIFVwZGF0ZSB0d2VlbiBwcm9wZXJ0aWVzXG5cdFx0XHRpZiAoIHBhcnRzICkge1xuXHRcdFx0XHRzdGFydCA9IHR3ZWVuLnN0YXJ0ID0gK3N0YXJ0IHx8ICt0YXJnZXQgfHwgMDtcblx0XHRcdFx0dHdlZW4udW5pdCA9IHVuaXQ7XG5cdFx0XHRcdC8vIElmIGEgKz0vLT0gdG9rZW4gd2FzIHByb3ZpZGVkLCB3ZSdyZSBkb2luZyBhIHJlbGF0aXZlIGFuaW1hdGlvblxuXHRcdFx0XHR0d2Vlbi5lbmQgPSBwYXJ0c1sgMSBdID9cblx0XHRcdFx0XHRzdGFydCArICggcGFydHNbIDEgXSArIDEgKSAqIHBhcnRzWyAyIF0gOlxuXHRcdFx0XHRcdCtwYXJ0c1sgMiBdO1xuXHRcdFx0fVxuXG5cdFx0XHRyZXR1cm4gdHdlZW47XG5cdFx0fSBdXG5cdH07XG5cbi8vIEFuaW1hdGlvbnMgY3JlYXRlZCBzeW5jaHJvbm91c2x5IHdpbGwgcnVuIHN5bmNocm9ub3VzbHlcbmZ1bmN0aW9uIGNyZWF0ZUZ4Tm93KCkge1xuXHRzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xuXHRcdGZ4Tm93ID0gdW5kZWZpbmVkO1xuXHR9KTtcblx0cmV0dXJuICggZnhOb3cgPSBqUXVlcnkubm93KCkgKTtcbn1cblxuLy8gR2VuZXJhdGUgcGFyYW1ldGVycyB0byBjcmVhdGUgYSBzdGFuZGFyZCBhbmltYXRpb25cbmZ1bmN0aW9uIGdlbkZ4KCB0eXBlLCBpbmNsdWRlV2lkdGggKSB7XG5cdHZhciB3aGljaCxcblx0XHRpID0gMCxcblx0XHRhdHRycyA9IHsgaGVpZ2h0OiB0eXBlIH07XG5cblx0Ly8gSWYgd2UgaW5jbHVkZSB3aWR0aCwgc3RlcCB2YWx1ZSBpcyAxIHRvIGRvIGFsbCBjc3NFeHBhbmQgdmFsdWVzLFxuXHQvLyBvdGhlcndpc2Ugc3RlcCB2YWx1ZSBpcyAyIHRvIHNraXAgb3ZlciBMZWZ0IGFuZCBSaWdodFxuXHRpbmNsdWRlV2lkdGggPSBpbmNsdWRlV2lkdGggPyAxIDogMDtcblx0Zm9yICggOyBpIDwgNCA7IGkgKz0gMiAtIGluY2x1ZGVXaWR0aCApIHtcblx0XHR3aGljaCA9IGNzc0V4cGFuZFsgaSBdO1xuXHRcdGF0dHJzWyBcIm1hcmdpblwiICsgd2hpY2ggXSA9IGF0dHJzWyBcInBhZGRpbmdcIiArIHdoaWNoIF0gPSB0eXBlO1xuXHR9XG5cblx0aWYgKCBpbmNsdWRlV2lkdGggKSB7XG5cdFx0YXR0cnMub3BhY2l0eSA9IGF0dHJzLndpZHRoID0gdHlwZTtcblx0fVxuXG5cdHJldHVybiBhdHRycztcbn1cblxuZnVuY3Rpb24gY3JlYXRlVHdlZW4oIHZhbHVlLCBwcm9wLCBhbmltYXRpb24gKSB7XG5cdHZhciB0d2Vlbixcblx0XHRjb2xsZWN0aW9uID0gKCB0d2VlbmVyc1sgcHJvcCBdIHx8IFtdICkuY29uY2F0KCB0d2VlbmVyc1sgXCIqXCIgXSApLFxuXHRcdGluZGV4ID0gMCxcblx0XHRsZW5ndGggPSBjb2xsZWN0aW9uLmxlbmd0aDtcblx0Zm9yICggOyBpbmRleCA8IGxlbmd0aDsgaW5kZXgrKyApIHtcblx0XHRpZiAoICh0d2VlbiA9IGNvbGxlY3Rpb25bIGluZGV4IF0uY2FsbCggYW5pbWF0aW9uLCBwcm9wLCB2YWx1ZSApKSApIHtcblxuXHRcdFx0Ly8gV2UncmUgZG9uZSB3aXRoIHRoaXMgcHJvcGVydHlcblx0XHRcdHJldHVybiB0d2Vlbjtcblx0XHR9XG5cdH1cbn1cblxuZnVuY3Rpb24gZGVmYXVsdFByZWZpbHRlciggZWxlbSwgcHJvcHMsIG9wdHMgKSB7XG5cdC8qIGpzaGludCB2YWxpZHRoaXM6IHRydWUgKi9cblx0dmFyIHByb3AsIHZhbHVlLCB0b2dnbGUsIHR3ZWVuLCBob29rcywgb2xkZmlyZSwgZGlzcGxheSwgY2hlY2tEaXNwbGF5LFxuXHRcdGFuaW0gPSB0aGlzLFxuXHRcdG9yaWcgPSB7fSxcblx0XHRzdHlsZSA9IGVsZW0uc3R5bGUsXG5cdFx0aGlkZGVuID0gZWxlbS5ub2RlVHlwZSAmJiBpc0hpZGRlbiggZWxlbSApLFxuXHRcdGRhdGFTaG93ID0gZGF0YV9wcml2LmdldCggZWxlbSwgXCJmeHNob3dcIiApO1xuXG5cdC8vIEhhbmRsZSBxdWV1ZTogZmFsc2UgcHJvbWlzZXNcblx0aWYgKCAhb3B0cy5xdWV1ZSApIHtcblx0XHRob29rcyA9IGpRdWVyeS5fcXVldWVIb29rcyggZWxlbSwgXCJmeFwiICk7XG5cdFx0aWYgKCBob29rcy51bnF1ZXVlZCA9PSBudWxsICkge1xuXHRcdFx0aG9va3MudW5xdWV1ZWQgPSAwO1xuXHRcdFx0b2xkZmlyZSA9IGhvb2tzLmVtcHR5LmZpcmU7XG5cdFx0XHRob29rcy5lbXB0eS5maXJlID0gZnVuY3Rpb24oKSB7XG5cdFx0XHRcdGlmICggIWhvb2tzLnVucXVldWVkICkge1xuXHRcdFx0XHRcdG9sZGZpcmUoKTtcblx0XHRcdFx0fVxuXHRcdFx0fTtcblx0XHR9XG5cdFx0aG9va3MudW5xdWV1ZWQrKztcblxuXHRcdGFuaW0uYWx3YXlzKGZ1bmN0aW9uKCkge1xuXHRcdFx0Ly8gRW5zdXJlIHRoZSBjb21wbGV0ZSBoYW5kbGVyIGlzIGNhbGxlZCBiZWZvcmUgdGhpcyBjb21wbGV0ZXNcblx0XHRcdGFuaW0uYWx3YXlzKGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRob29rcy51bnF1ZXVlZC0tO1xuXHRcdFx0XHRpZiAoICFqUXVlcnkucXVldWUoIGVsZW0sIFwiZnhcIiApLmxlbmd0aCApIHtcblx0XHRcdFx0XHRob29rcy5lbXB0eS5maXJlKCk7XG5cdFx0XHRcdH1cblx0XHRcdH0pO1xuXHRcdH0pO1xuXHR9XG5cblx0Ly8gSGVpZ2h0L3dpZHRoIG92ZXJmbG93IHBhc3Ncblx0aWYgKCBlbGVtLm5vZGVUeXBlID09PSAxICYmICggXCJoZWlnaHRcIiBpbiBwcm9wcyB8fCBcIndpZHRoXCIgaW4gcHJvcHMgKSApIHtcblx0XHQvLyBNYWtlIHN1cmUgdGhhdCBub3RoaW5nIHNuZWFrcyBvdXRcblx0XHQvLyBSZWNvcmQgYWxsIDMgb3ZlcmZsb3cgYXR0cmlidXRlcyBiZWNhdXNlIElFOS0xMCBkbyBub3Rcblx0XHQvLyBjaGFuZ2UgdGhlIG92ZXJmbG93IGF0dHJpYnV0ZSB3aGVuIG92ZXJmbG93WCBhbmRcblx0XHQvLyBvdmVyZmxvd1kgYXJlIHNldCB0byB0aGUgc2FtZSB2YWx1ZVxuXHRcdG9wdHMub3ZlcmZsb3cgPSBbIHN0eWxlLm92ZXJmbG93LCBzdHlsZS5vdmVyZmxvd1gsIHN0eWxlLm92ZXJmbG93WSBdO1xuXG5cdFx0Ly8gU2V0IGRpc3BsYXkgcHJvcGVydHkgdG8gaW5saW5lLWJsb2NrIGZvciBoZWlnaHQvd2lkdGhcblx0XHQvLyBhbmltYXRpb25zIG9uIGlubGluZSBlbGVtZW50cyB0aGF0IGFyZSBoYXZpbmcgd2lkdGgvaGVpZ2h0IGFuaW1hdGVkXG5cdFx0ZGlzcGxheSA9IGpRdWVyeS5jc3MoIGVsZW0sIFwiZGlzcGxheVwiICk7XG5cblx0XHQvLyBUZXN0IGRlZmF1bHQgZGlzcGxheSBpZiBkaXNwbGF5IGlzIGN1cnJlbnRseSBcIm5vbmVcIlxuXHRcdGNoZWNrRGlzcGxheSA9IGRpc3BsYXkgPT09IFwibm9uZVwiID9cblx0XHRcdGRhdGFfcHJpdi5nZXQoIGVsZW0sIFwib2xkZGlzcGxheVwiICkgfHwgZGVmYXVsdERpc3BsYXkoIGVsZW0ubm9kZU5hbWUgKSA6IGRpc3BsYXk7XG5cblx0XHRpZiAoIGNoZWNrRGlzcGxheSA9PT0gXCJpbmxpbmVcIiAmJiBqUXVlcnkuY3NzKCBlbGVtLCBcImZsb2F0XCIgKSA9PT0gXCJub25lXCIgKSB7XG5cdFx0XHRzdHlsZS5kaXNwbGF5ID0gXCJpbmxpbmUtYmxvY2tcIjtcblx0XHR9XG5cdH1cblxuXHRpZiAoIG9wdHMub3ZlcmZsb3cgKSB7XG5cdFx0c3R5bGUub3ZlcmZsb3cgPSBcImhpZGRlblwiO1xuXHRcdGFuaW0uYWx3YXlzKGZ1bmN0aW9uKCkge1xuXHRcdFx0c3R5bGUub3ZlcmZsb3cgPSBvcHRzLm92ZXJmbG93WyAwIF07XG5cdFx0XHRzdHlsZS5vdmVyZmxvd1ggPSBvcHRzLm92ZXJmbG93WyAxIF07XG5cdFx0XHRzdHlsZS5vdmVyZmxvd1kgPSBvcHRzLm92ZXJmbG93WyAyIF07XG5cdFx0fSk7XG5cdH1cblxuXHQvLyBzaG93L2hpZGUgcGFzc1xuXHRmb3IgKCBwcm9wIGluIHByb3BzICkge1xuXHRcdHZhbHVlID0gcHJvcHNbIHByb3AgXTtcblx0XHRpZiAoIHJmeHR5cGVzLmV4ZWMoIHZhbHVlICkgKSB7XG5cdFx0XHRkZWxldGUgcHJvcHNbIHByb3AgXTtcblx0XHRcdHRvZ2dsZSA9IHRvZ2dsZSB8fCB2YWx1ZSA9PT0gXCJ0b2dnbGVcIjtcblx0XHRcdGlmICggdmFsdWUgPT09ICggaGlkZGVuID8gXCJoaWRlXCIgOiBcInNob3dcIiApICkge1xuXG5cdFx0XHRcdC8vIElmIHRoZXJlIGlzIGRhdGFTaG93IGxlZnQgb3ZlciBmcm9tIGEgc3RvcHBlZCBoaWRlIG9yIHNob3cgYW5kIHdlIGFyZSBnb2luZyB0byBwcm9jZWVkIHdpdGggc2hvdywgd2Ugc2hvdWxkIHByZXRlbmQgdG8gYmUgaGlkZGVuXG5cdFx0XHRcdGlmICggdmFsdWUgPT09IFwic2hvd1wiICYmIGRhdGFTaG93ICYmIGRhdGFTaG93WyBwcm9wIF0gIT09IHVuZGVmaW5lZCApIHtcblx0XHRcdFx0XHRoaWRkZW4gPSB0cnVlO1xuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdGNvbnRpbnVlO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0XHRvcmlnWyBwcm9wIF0gPSBkYXRhU2hvdyAmJiBkYXRhU2hvd1sgcHJvcCBdIHx8IGpRdWVyeS5zdHlsZSggZWxlbSwgcHJvcCApO1xuXG5cdFx0Ly8gQW55IG5vbi1meCB2YWx1ZSBzdG9wcyB1cyBmcm9tIHJlc3RvcmluZyB0aGUgb3JpZ2luYWwgZGlzcGxheSB2YWx1ZVxuXHRcdH0gZWxzZSB7XG5cdFx0XHRkaXNwbGF5ID0gdW5kZWZpbmVkO1xuXHRcdH1cblx0fVxuXG5cdGlmICggIWpRdWVyeS5pc0VtcHR5T2JqZWN0KCBvcmlnICkgKSB7XG5cdFx0aWYgKCBkYXRhU2hvdyApIHtcblx0XHRcdGlmICggXCJoaWRkZW5cIiBpbiBkYXRhU2hvdyApIHtcblx0XHRcdFx0aGlkZGVuID0gZGF0YVNob3cuaGlkZGVuO1xuXHRcdFx0fVxuXHRcdH0gZWxzZSB7XG5cdFx0XHRkYXRhU2hvdyA9IGRhdGFfcHJpdi5hY2Nlc3MoIGVsZW0sIFwiZnhzaG93XCIsIHt9ICk7XG5cdFx0fVxuXG5cdFx0Ly8gU3RvcmUgc3RhdGUgaWYgaXRzIHRvZ2dsZSAtIGVuYWJsZXMgLnN0b3AoKS50b2dnbGUoKSB0byBcInJldmVyc2VcIlxuXHRcdGlmICggdG9nZ2xlICkge1xuXHRcdFx0ZGF0YVNob3cuaGlkZGVuID0gIWhpZGRlbjtcblx0XHR9XG5cdFx0aWYgKCBoaWRkZW4gKSB7XG5cdFx0XHRqUXVlcnkoIGVsZW0gKS5zaG93KCk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdGFuaW0uZG9uZShmdW5jdGlvbigpIHtcblx0XHRcdFx0alF1ZXJ5KCBlbGVtICkuaGlkZSgpO1xuXHRcdFx0fSk7XG5cdFx0fVxuXHRcdGFuaW0uZG9uZShmdW5jdGlvbigpIHtcblx0XHRcdHZhciBwcm9wO1xuXG5cdFx0XHRkYXRhX3ByaXYucmVtb3ZlKCBlbGVtLCBcImZ4c2hvd1wiICk7XG5cdFx0XHRmb3IgKCBwcm9wIGluIG9yaWcgKSB7XG5cdFx0XHRcdGpRdWVyeS5zdHlsZSggZWxlbSwgcHJvcCwgb3JpZ1sgcHJvcCBdICk7XG5cdFx0XHR9XG5cdFx0fSk7XG5cdFx0Zm9yICggcHJvcCBpbiBvcmlnICkge1xuXHRcdFx0dHdlZW4gPSBjcmVhdGVUd2VlbiggaGlkZGVuID8gZGF0YVNob3dbIHByb3AgXSA6IDAsIHByb3AsIGFuaW0gKTtcblxuXHRcdFx0aWYgKCAhKCBwcm9wIGluIGRhdGFTaG93ICkgKSB7XG5cdFx0XHRcdGRhdGFTaG93WyBwcm9wIF0gPSB0d2Vlbi5zdGFydDtcblx0XHRcdFx0aWYgKCBoaWRkZW4gKSB7XG5cdFx0XHRcdFx0dHdlZW4uZW5kID0gdHdlZW4uc3RhcnQ7XG5cdFx0XHRcdFx0dHdlZW4uc3RhcnQgPSBwcm9wID09PSBcIndpZHRoXCIgfHwgcHJvcCA9PT0gXCJoZWlnaHRcIiA/IDEgOiAwO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fVxuXG5cdC8vIElmIHRoaXMgaXMgYSBub29wIGxpa2UgLmhpZGUoKS5oaWRlKCksIHJlc3RvcmUgYW4gb3ZlcndyaXR0ZW4gZGlzcGxheSB2YWx1ZVxuXHR9IGVsc2UgaWYgKCAoZGlzcGxheSA9PT0gXCJub25lXCIgPyBkZWZhdWx0RGlzcGxheSggZWxlbS5ub2RlTmFtZSApIDogZGlzcGxheSkgPT09IFwiaW5saW5lXCIgKSB7XG5cdFx0c3R5bGUuZGlzcGxheSA9IGRpc3BsYXk7XG5cdH1cbn1cblxuZnVuY3Rpb24gcHJvcEZpbHRlciggcHJvcHMsIHNwZWNpYWxFYXNpbmcgKSB7XG5cdHZhciBpbmRleCwgbmFtZSwgZWFzaW5nLCB2YWx1ZSwgaG9va3M7XG5cblx0Ly8gY2FtZWxDYXNlLCBzcGVjaWFsRWFzaW5nIGFuZCBleHBhbmQgY3NzSG9vayBwYXNzXG5cdGZvciAoIGluZGV4IGluIHByb3BzICkge1xuXHRcdG5hbWUgPSBqUXVlcnkuY2FtZWxDYXNlKCBpbmRleCApO1xuXHRcdGVhc2luZyA9IHNwZWNpYWxFYXNpbmdbIG5hbWUgXTtcblx0XHR2YWx1ZSA9IHByb3BzWyBpbmRleCBdO1xuXHRcdGlmICggalF1ZXJ5LmlzQXJyYXkoIHZhbHVlICkgKSB7XG5cdFx0XHRlYXNpbmcgPSB2YWx1ZVsgMSBdO1xuXHRcdFx0dmFsdWUgPSBwcm9wc1sgaW5kZXggXSA9IHZhbHVlWyAwIF07XG5cdFx0fVxuXG5cdFx0aWYgKCBpbmRleCAhPT0gbmFtZSApIHtcblx0XHRcdHByb3BzWyBuYW1lIF0gPSB2YWx1ZTtcblx0XHRcdGRlbGV0ZSBwcm9wc1sgaW5kZXggXTtcblx0XHR9XG5cblx0XHRob29rcyA9IGpRdWVyeS5jc3NIb29rc1sgbmFtZSBdO1xuXHRcdGlmICggaG9va3MgJiYgXCJleHBhbmRcIiBpbiBob29rcyApIHtcblx0XHRcdHZhbHVlID0gaG9va3MuZXhwYW5kKCB2YWx1ZSApO1xuXHRcdFx0ZGVsZXRlIHByb3BzWyBuYW1lIF07XG5cblx0XHRcdC8vIE5vdCBxdWl0ZSAkLmV4dGVuZCwgdGhpcyB3b24ndCBvdmVyd3JpdGUgZXhpc3Rpbmcga2V5cy5cblx0XHRcdC8vIFJldXNpbmcgJ2luZGV4JyBiZWNhdXNlIHdlIGhhdmUgdGhlIGNvcnJlY3QgXCJuYW1lXCJcblx0XHRcdGZvciAoIGluZGV4IGluIHZhbHVlICkge1xuXHRcdFx0XHRpZiAoICEoIGluZGV4IGluIHByb3BzICkgKSB7XG5cdFx0XHRcdFx0cHJvcHNbIGluZGV4IF0gPSB2YWx1ZVsgaW5kZXggXTtcblx0XHRcdFx0XHRzcGVjaWFsRWFzaW5nWyBpbmRleCBdID0gZWFzaW5nO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fSBlbHNlIHtcblx0XHRcdHNwZWNpYWxFYXNpbmdbIG5hbWUgXSA9IGVhc2luZztcblx0XHR9XG5cdH1cbn1cblxuZnVuY3Rpb24gQW5pbWF0aW9uKCBlbGVtLCBwcm9wZXJ0aWVzLCBvcHRpb25zICkge1xuXHR2YXIgcmVzdWx0LFxuXHRcdHN0b3BwZWQsXG5cdFx0aW5kZXggPSAwLFxuXHRcdGxlbmd0aCA9IGFuaW1hdGlvblByZWZpbHRlcnMubGVuZ3RoLFxuXHRcdGRlZmVycmVkID0galF1ZXJ5LkRlZmVycmVkKCkuYWx3YXlzKCBmdW5jdGlvbigpIHtcblx0XHRcdC8vIERvbid0IG1hdGNoIGVsZW0gaW4gdGhlIDphbmltYXRlZCBzZWxlY3RvclxuXHRcdFx0ZGVsZXRlIHRpY2suZWxlbTtcblx0XHR9KSxcblx0XHR0aWNrID0gZnVuY3Rpb24oKSB7XG5cdFx0XHRpZiAoIHN0b3BwZWQgKSB7XG5cdFx0XHRcdHJldHVybiBmYWxzZTtcblx0XHRcdH1cblx0XHRcdHZhciBjdXJyZW50VGltZSA9IGZ4Tm93IHx8IGNyZWF0ZUZ4Tm93KCksXG5cdFx0XHRcdHJlbWFpbmluZyA9IE1hdGgubWF4KCAwLCBhbmltYXRpb24uc3RhcnRUaW1lICsgYW5pbWF0aW9uLmR1cmF0aW9uIC0gY3VycmVudFRpbWUgKSxcblx0XHRcdFx0Ly8gU3VwcG9ydDogQW5kcm9pZCAyLjNcblx0XHRcdFx0Ly8gQXJjaGFpYyBjcmFzaCBidWcgd29uJ3QgYWxsb3cgdXMgdG8gdXNlIGAxIC0gKCAwLjUgfHwgMCApYCAoIzEyNDk3KVxuXHRcdFx0XHR0ZW1wID0gcmVtYWluaW5nIC8gYW5pbWF0aW9uLmR1cmF0aW9uIHx8IDAsXG5cdFx0XHRcdHBlcmNlbnQgPSAxIC0gdGVtcCxcblx0XHRcdFx0aW5kZXggPSAwLFxuXHRcdFx0XHRsZW5ndGggPSBhbmltYXRpb24udHdlZW5zLmxlbmd0aDtcblxuXHRcdFx0Zm9yICggOyBpbmRleCA8IGxlbmd0aCA7IGluZGV4KysgKSB7XG5cdFx0XHRcdGFuaW1hdGlvbi50d2VlbnNbIGluZGV4IF0ucnVuKCBwZXJjZW50ICk7XG5cdFx0XHR9XG5cblx0XHRcdGRlZmVycmVkLm5vdGlmeVdpdGgoIGVsZW0sIFsgYW5pbWF0aW9uLCBwZXJjZW50LCByZW1haW5pbmcgXSk7XG5cblx0XHRcdGlmICggcGVyY2VudCA8IDEgJiYgbGVuZ3RoICkge1xuXHRcdFx0XHRyZXR1cm4gcmVtYWluaW5nO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0ZGVmZXJyZWQucmVzb2x2ZVdpdGgoIGVsZW0sIFsgYW5pbWF0aW9uIF0gKTtcblx0XHRcdFx0cmV0dXJuIGZhbHNlO1xuXHRcdFx0fVxuXHRcdH0sXG5cdFx0YW5pbWF0aW9uID0gZGVmZXJyZWQucHJvbWlzZSh7XG5cdFx0XHRlbGVtOiBlbGVtLFxuXHRcdFx0cHJvcHM6IGpRdWVyeS5leHRlbmQoIHt9LCBwcm9wZXJ0aWVzICksXG5cdFx0XHRvcHRzOiBqUXVlcnkuZXh0ZW5kKCB0cnVlLCB7IHNwZWNpYWxFYXNpbmc6IHt9IH0sIG9wdGlvbnMgKSxcblx0XHRcdG9yaWdpbmFsUHJvcGVydGllczogcHJvcGVydGllcyxcblx0XHRcdG9yaWdpbmFsT3B0aW9uczogb3B0aW9ucyxcblx0XHRcdHN0YXJ0VGltZTogZnhOb3cgfHwgY3JlYXRlRnhOb3coKSxcblx0XHRcdGR1cmF0aW9uOiBvcHRpb25zLmR1cmF0aW9uLFxuXHRcdFx0dHdlZW5zOiBbXSxcblx0XHRcdGNyZWF0ZVR3ZWVuOiBmdW5jdGlvbiggcHJvcCwgZW5kICkge1xuXHRcdFx0XHR2YXIgdHdlZW4gPSBqUXVlcnkuVHdlZW4oIGVsZW0sIGFuaW1hdGlvbi5vcHRzLCBwcm9wLCBlbmQsXG5cdFx0XHRcdFx0XHRhbmltYXRpb24ub3B0cy5zcGVjaWFsRWFzaW5nWyBwcm9wIF0gfHwgYW5pbWF0aW9uLm9wdHMuZWFzaW5nICk7XG5cdFx0XHRcdGFuaW1hdGlvbi50d2VlbnMucHVzaCggdHdlZW4gKTtcblx0XHRcdFx0cmV0dXJuIHR3ZWVuO1xuXHRcdFx0fSxcblx0XHRcdHN0b3A6IGZ1bmN0aW9uKCBnb3RvRW5kICkge1xuXHRcdFx0XHR2YXIgaW5kZXggPSAwLFxuXHRcdFx0XHRcdC8vIElmIHdlIGFyZSBnb2luZyB0byB0aGUgZW5kLCB3ZSB3YW50IHRvIHJ1biBhbGwgdGhlIHR3ZWVuc1xuXHRcdFx0XHRcdC8vIG90aGVyd2lzZSB3ZSBza2lwIHRoaXMgcGFydFxuXHRcdFx0XHRcdGxlbmd0aCA9IGdvdG9FbmQgPyBhbmltYXRpb24udHdlZW5zLmxlbmd0aCA6IDA7XG5cdFx0XHRcdGlmICggc3RvcHBlZCApIHtcblx0XHRcdFx0XHRyZXR1cm4gdGhpcztcblx0XHRcdFx0fVxuXHRcdFx0XHRzdG9wcGVkID0gdHJ1ZTtcblx0XHRcdFx0Zm9yICggOyBpbmRleCA8IGxlbmd0aCA7IGluZGV4KysgKSB7XG5cdFx0XHRcdFx0YW5pbWF0aW9uLnR3ZWVuc1sgaW5kZXggXS5ydW4oIDEgKTtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdC8vIFJlc29sdmUgd2hlbiB3ZSBwbGF5ZWQgdGhlIGxhc3QgZnJhbWU7IG90aGVyd2lzZSwgcmVqZWN0XG5cdFx0XHRcdGlmICggZ290b0VuZCApIHtcblx0XHRcdFx0XHRkZWZlcnJlZC5yZXNvbHZlV2l0aCggZWxlbSwgWyBhbmltYXRpb24sIGdvdG9FbmQgXSApO1xuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdGRlZmVycmVkLnJlamVjdFdpdGgoIGVsZW0sIFsgYW5pbWF0aW9uLCBnb3RvRW5kIF0gKTtcblx0XHRcdFx0fVxuXHRcdFx0XHRyZXR1cm4gdGhpcztcblx0XHRcdH1cblx0XHR9KSxcblx0XHRwcm9wcyA9IGFuaW1hdGlvbi5wcm9wcztcblxuXHRwcm9wRmlsdGVyKCBwcm9wcywgYW5pbWF0aW9uLm9wdHMuc3BlY2lhbEVhc2luZyApO1xuXG5cdGZvciAoIDsgaW5kZXggPCBsZW5ndGggOyBpbmRleCsrICkge1xuXHRcdHJlc3VsdCA9IGFuaW1hdGlvblByZWZpbHRlcnNbIGluZGV4IF0uY2FsbCggYW5pbWF0aW9uLCBlbGVtLCBwcm9wcywgYW5pbWF0aW9uLm9wdHMgKTtcblx0XHRpZiAoIHJlc3VsdCApIHtcblx0XHRcdHJldHVybiByZXN1bHQ7XG5cdFx0fVxuXHR9XG5cblx0alF1ZXJ5Lm1hcCggcHJvcHMsIGNyZWF0ZVR3ZWVuLCBhbmltYXRpb24gKTtcblxuXHRpZiAoIGpRdWVyeS5pc0Z1bmN0aW9uKCBhbmltYXRpb24ub3B0cy5zdGFydCApICkge1xuXHRcdGFuaW1hdGlvbi5vcHRzLnN0YXJ0LmNhbGwoIGVsZW0sIGFuaW1hdGlvbiApO1xuXHR9XG5cblx0alF1ZXJ5LmZ4LnRpbWVyKFxuXHRcdGpRdWVyeS5leHRlbmQoIHRpY2ssIHtcblx0XHRcdGVsZW06IGVsZW0sXG5cdFx0XHRhbmltOiBhbmltYXRpb24sXG5cdFx0XHRxdWV1ZTogYW5pbWF0aW9uLm9wdHMucXVldWVcblx0XHR9KVxuXHQpO1xuXG5cdC8vIGF0dGFjaCBjYWxsYmFja3MgZnJvbSBvcHRpb25zXG5cdHJldHVybiBhbmltYXRpb24ucHJvZ3Jlc3MoIGFuaW1hdGlvbi5vcHRzLnByb2dyZXNzIClcblx0XHQuZG9uZSggYW5pbWF0aW9uLm9wdHMuZG9uZSwgYW5pbWF0aW9uLm9wdHMuY29tcGxldGUgKVxuXHRcdC5mYWlsKCBhbmltYXRpb24ub3B0cy5mYWlsIClcblx0XHQuYWx3YXlzKCBhbmltYXRpb24ub3B0cy5hbHdheXMgKTtcbn1cblxualF1ZXJ5LkFuaW1hdGlvbiA9IGpRdWVyeS5leHRlbmQoIEFuaW1hdGlvbiwge1xuXG5cdHR3ZWVuZXI6IGZ1bmN0aW9uKCBwcm9wcywgY2FsbGJhY2sgKSB7XG5cdFx0aWYgKCBqUXVlcnkuaXNGdW5jdGlvbiggcHJvcHMgKSApIHtcblx0XHRcdGNhbGxiYWNrID0gcHJvcHM7XG5cdFx0XHRwcm9wcyA9IFsgXCIqXCIgXTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0cHJvcHMgPSBwcm9wcy5zcGxpdChcIiBcIik7XG5cdFx0fVxuXG5cdFx0dmFyIHByb3AsXG5cdFx0XHRpbmRleCA9IDAsXG5cdFx0XHRsZW5ndGggPSBwcm9wcy5sZW5ndGg7XG5cblx0XHRmb3IgKCA7IGluZGV4IDwgbGVuZ3RoIDsgaW5kZXgrKyApIHtcblx0XHRcdHByb3AgPSBwcm9wc1sgaW5kZXggXTtcblx0XHRcdHR3ZWVuZXJzWyBwcm9wIF0gPSB0d2VlbmVyc1sgcHJvcCBdIHx8IFtdO1xuXHRcdFx0dHdlZW5lcnNbIHByb3AgXS51bnNoaWZ0KCBjYWxsYmFjayApO1xuXHRcdH1cblx0fSxcblxuXHRwcmVmaWx0ZXI6IGZ1bmN0aW9uKCBjYWxsYmFjaywgcHJlcGVuZCApIHtcblx0XHRpZiAoIHByZXBlbmQgKSB7XG5cdFx0XHRhbmltYXRpb25QcmVmaWx0ZXJzLnVuc2hpZnQoIGNhbGxiYWNrICk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdGFuaW1hdGlvblByZWZpbHRlcnMucHVzaCggY2FsbGJhY2sgKTtcblx0XHR9XG5cdH1cbn0pO1xuXG5qUXVlcnkuc3BlZWQgPSBmdW5jdGlvbiggc3BlZWQsIGVhc2luZywgZm4gKSB7XG5cdHZhciBvcHQgPSBzcGVlZCAmJiB0eXBlb2Ygc3BlZWQgPT09IFwib2JqZWN0XCIgPyBqUXVlcnkuZXh0ZW5kKCB7fSwgc3BlZWQgKSA6IHtcblx0XHRjb21wbGV0ZTogZm4gfHwgIWZuICYmIGVhc2luZyB8fFxuXHRcdFx0alF1ZXJ5LmlzRnVuY3Rpb24oIHNwZWVkICkgJiYgc3BlZWQsXG5cdFx0ZHVyYXRpb246IHNwZWVkLFxuXHRcdGVhc2luZzogZm4gJiYgZWFzaW5nIHx8IGVhc2luZyAmJiAhalF1ZXJ5LmlzRnVuY3Rpb24oIGVhc2luZyApICYmIGVhc2luZ1xuXHR9O1xuXG5cdG9wdC5kdXJhdGlvbiA9IGpRdWVyeS5meC5vZmYgPyAwIDogdHlwZW9mIG9wdC5kdXJhdGlvbiA9PT0gXCJudW1iZXJcIiA/IG9wdC5kdXJhdGlvbiA6XG5cdFx0b3B0LmR1cmF0aW9uIGluIGpRdWVyeS5meC5zcGVlZHMgPyBqUXVlcnkuZnguc3BlZWRzWyBvcHQuZHVyYXRpb24gXSA6IGpRdWVyeS5meC5zcGVlZHMuX2RlZmF1bHQ7XG5cblx0Ly8gTm9ybWFsaXplIG9wdC5xdWV1ZSAtIHRydWUvdW5kZWZpbmVkL251bGwgLT4gXCJmeFwiXG5cdGlmICggb3B0LnF1ZXVlID09IG51bGwgfHwgb3B0LnF1ZXVlID09PSB0cnVlICkge1xuXHRcdG9wdC5xdWV1ZSA9IFwiZnhcIjtcblx0fVxuXG5cdC8vIFF1ZXVlaW5nXG5cdG9wdC5vbGQgPSBvcHQuY29tcGxldGU7XG5cblx0b3B0LmNvbXBsZXRlID0gZnVuY3Rpb24oKSB7XG5cdFx0aWYgKCBqUXVlcnkuaXNGdW5jdGlvbiggb3B0Lm9sZCApICkge1xuXHRcdFx0b3B0Lm9sZC5jYWxsKCB0aGlzICk7XG5cdFx0fVxuXG5cdFx0aWYgKCBvcHQucXVldWUgKSB7XG5cdFx0XHRqUXVlcnkuZGVxdWV1ZSggdGhpcywgb3B0LnF1ZXVlICk7XG5cdFx0fVxuXHR9O1xuXG5cdHJldHVybiBvcHQ7XG59O1xuXG5qUXVlcnkuZm4uZXh0ZW5kKHtcblx0ZmFkZVRvOiBmdW5jdGlvbiggc3BlZWQsIHRvLCBlYXNpbmcsIGNhbGxiYWNrICkge1xuXG5cdFx0Ly8gU2hvdyBhbnkgaGlkZGVuIGVsZW1lbnRzIGFmdGVyIHNldHRpbmcgb3BhY2l0eSB0byAwXG5cdFx0cmV0dXJuIHRoaXMuZmlsdGVyKCBpc0hpZGRlbiApLmNzcyggXCJvcGFjaXR5XCIsIDAgKS5zaG93KClcblxuXHRcdFx0Ly8gQW5pbWF0ZSB0byB0aGUgdmFsdWUgc3BlY2lmaWVkXG5cdFx0XHQuZW5kKCkuYW5pbWF0ZSh7IG9wYWNpdHk6IHRvIH0sIHNwZWVkLCBlYXNpbmcsIGNhbGxiYWNrICk7XG5cdH0sXG5cdGFuaW1hdGU6IGZ1bmN0aW9uKCBwcm9wLCBzcGVlZCwgZWFzaW5nLCBjYWxsYmFjayApIHtcblx0XHR2YXIgZW1wdHkgPSBqUXVlcnkuaXNFbXB0eU9iamVjdCggcHJvcCApLFxuXHRcdFx0b3B0YWxsID0galF1ZXJ5LnNwZWVkKCBzcGVlZCwgZWFzaW5nLCBjYWxsYmFjayApLFxuXHRcdFx0ZG9BbmltYXRpb24gPSBmdW5jdGlvbigpIHtcblx0XHRcdFx0Ly8gT3BlcmF0ZSBvbiBhIGNvcHkgb2YgcHJvcCBzbyBwZXItcHJvcGVydHkgZWFzaW5nIHdvbid0IGJlIGxvc3Rcblx0XHRcdFx0dmFyIGFuaW0gPSBBbmltYXRpb24oIHRoaXMsIGpRdWVyeS5leHRlbmQoIHt9LCBwcm9wICksIG9wdGFsbCApO1xuXG5cdFx0XHRcdC8vIEVtcHR5IGFuaW1hdGlvbnMsIG9yIGZpbmlzaGluZyByZXNvbHZlcyBpbW1lZGlhdGVseVxuXHRcdFx0XHRpZiAoIGVtcHR5IHx8IGRhdGFfcHJpdi5nZXQoIHRoaXMsIFwiZmluaXNoXCIgKSApIHtcblx0XHRcdFx0XHRhbmltLnN0b3AoIHRydWUgKTtcblx0XHRcdFx0fVxuXHRcdFx0fTtcblx0XHRcdGRvQW5pbWF0aW9uLmZpbmlzaCA9IGRvQW5pbWF0aW9uO1xuXG5cdFx0cmV0dXJuIGVtcHR5IHx8IG9wdGFsbC5xdWV1ZSA9PT0gZmFsc2UgP1xuXHRcdFx0dGhpcy5lYWNoKCBkb0FuaW1hdGlvbiApIDpcblx0XHRcdHRoaXMucXVldWUoIG9wdGFsbC5xdWV1ZSwgZG9BbmltYXRpb24gKTtcblx0fSxcblx0c3RvcDogZnVuY3Rpb24oIHR5cGUsIGNsZWFyUXVldWUsIGdvdG9FbmQgKSB7XG5cdFx0dmFyIHN0b3BRdWV1ZSA9IGZ1bmN0aW9uKCBob29rcyApIHtcblx0XHRcdHZhciBzdG9wID0gaG9va3Muc3RvcDtcblx0XHRcdGRlbGV0ZSBob29rcy5zdG9wO1xuXHRcdFx0c3RvcCggZ290b0VuZCApO1xuXHRcdH07XG5cblx0XHRpZiAoIHR5cGVvZiB0eXBlICE9PSBcInN0cmluZ1wiICkge1xuXHRcdFx0Z290b0VuZCA9IGNsZWFyUXVldWU7XG5cdFx0XHRjbGVhclF1ZXVlID0gdHlwZTtcblx0XHRcdHR5cGUgPSB1bmRlZmluZWQ7XG5cdFx0fVxuXHRcdGlmICggY2xlYXJRdWV1ZSAmJiB0eXBlICE9PSBmYWxzZSApIHtcblx0XHRcdHRoaXMucXVldWUoIHR5cGUgfHwgXCJmeFwiLCBbXSApO1xuXHRcdH1cblxuXHRcdHJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oKSB7XG5cdFx0XHR2YXIgZGVxdWV1ZSA9IHRydWUsXG5cdFx0XHRcdGluZGV4ID0gdHlwZSAhPSBudWxsICYmIHR5cGUgKyBcInF1ZXVlSG9va3NcIixcblx0XHRcdFx0dGltZXJzID0galF1ZXJ5LnRpbWVycyxcblx0XHRcdFx0ZGF0YSA9IGRhdGFfcHJpdi5nZXQoIHRoaXMgKTtcblxuXHRcdFx0aWYgKCBpbmRleCApIHtcblx0XHRcdFx0aWYgKCBkYXRhWyBpbmRleCBdICYmIGRhdGFbIGluZGV4IF0uc3RvcCApIHtcblx0XHRcdFx0XHRzdG9wUXVldWUoIGRhdGFbIGluZGV4IF0gKTtcblx0XHRcdFx0fVxuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0Zm9yICggaW5kZXggaW4gZGF0YSApIHtcblx0XHRcdFx0XHRpZiAoIGRhdGFbIGluZGV4IF0gJiYgZGF0YVsgaW5kZXggXS5zdG9wICYmIHJydW4udGVzdCggaW5kZXggKSApIHtcblx0XHRcdFx0XHRcdHN0b3BRdWV1ZSggZGF0YVsgaW5kZXggXSApO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0fVxuXG5cdFx0XHRmb3IgKCBpbmRleCA9IHRpbWVycy5sZW5ndGg7IGluZGV4LS07ICkge1xuXHRcdFx0XHRpZiAoIHRpbWVyc1sgaW5kZXggXS5lbGVtID09PSB0aGlzICYmICh0eXBlID09IG51bGwgfHwgdGltZXJzWyBpbmRleCBdLnF1ZXVlID09PSB0eXBlKSApIHtcblx0XHRcdFx0XHR0aW1lcnNbIGluZGV4IF0uYW5pbS5zdG9wKCBnb3RvRW5kICk7XG5cdFx0XHRcdFx0ZGVxdWV1ZSA9IGZhbHNlO1xuXHRcdFx0XHRcdHRpbWVycy5zcGxpY2UoIGluZGV4LCAxICk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblxuXHRcdFx0Ly8gU3RhcnQgdGhlIG5leHQgaW4gdGhlIHF1ZXVlIGlmIHRoZSBsYXN0IHN0ZXAgd2Fzbid0IGZvcmNlZC5cblx0XHRcdC8vIFRpbWVycyBjdXJyZW50bHkgd2lsbCBjYWxsIHRoZWlyIGNvbXBsZXRlIGNhbGxiYWNrcywgd2hpY2hcblx0XHRcdC8vIHdpbGwgZGVxdWV1ZSBidXQgb25seSBpZiB0aGV5IHdlcmUgZ290b0VuZC5cblx0XHRcdGlmICggZGVxdWV1ZSB8fCAhZ290b0VuZCApIHtcblx0XHRcdFx0alF1ZXJ5LmRlcXVldWUoIHRoaXMsIHR5cGUgKTtcblx0XHRcdH1cblx0XHR9KTtcblx0fSxcblx0ZmluaXNoOiBmdW5jdGlvbiggdHlwZSApIHtcblx0XHRpZiAoIHR5cGUgIT09IGZhbHNlICkge1xuXHRcdFx0dHlwZSA9IHR5cGUgfHwgXCJmeFwiO1xuXHRcdH1cblx0XHRyZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uKCkge1xuXHRcdFx0dmFyIGluZGV4LFxuXHRcdFx0XHRkYXRhID0gZGF0YV9wcml2LmdldCggdGhpcyApLFxuXHRcdFx0XHRxdWV1ZSA9IGRhdGFbIHR5cGUgKyBcInF1ZXVlXCIgXSxcblx0XHRcdFx0aG9va3MgPSBkYXRhWyB0eXBlICsgXCJxdWV1ZUhvb2tzXCIgXSxcblx0XHRcdFx0dGltZXJzID0galF1ZXJ5LnRpbWVycyxcblx0XHRcdFx0bGVuZ3RoID0gcXVldWUgPyBxdWV1ZS5sZW5ndGggOiAwO1xuXG5cdFx0XHQvLyBFbmFibGUgZmluaXNoaW5nIGZsYWcgb24gcHJpdmF0ZSBkYXRhXG5cdFx0XHRkYXRhLmZpbmlzaCA9IHRydWU7XG5cblx0XHRcdC8vIEVtcHR5IHRoZSBxdWV1ZSBmaXJzdFxuXHRcdFx0alF1ZXJ5LnF1ZXVlKCB0aGlzLCB0eXBlLCBbXSApO1xuXG5cdFx0XHRpZiAoIGhvb2tzICYmIGhvb2tzLnN0b3AgKSB7XG5cdFx0XHRcdGhvb2tzLnN0b3AuY2FsbCggdGhpcywgdHJ1ZSApO1xuXHRcdFx0fVxuXG5cdFx0XHQvLyBMb29rIGZvciBhbnkgYWN0aXZlIGFuaW1hdGlvbnMsIGFuZCBmaW5pc2ggdGhlbVxuXHRcdFx0Zm9yICggaW5kZXggPSB0aW1lcnMubGVuZ3RoOyBpbmRleC0tOyApIHtcblx0XHRcdFx0aWYgKCB0aW1lcnNbIGluZGV4IF0uZWxlbSA9PT0gdGhpcyAmJiB0aW1lcnNbIGluZGV4IF0ucXVldWUgPT09IHR5cGUgKSB7XG5cdFx0XHRcdFx0dGltZXJzWyBpbmRleCBdLmFuaW0uc3RvcCggdHJ1ZSApO1xuXHRcdFx0XHRcdHRpbWVycy5zcGxpY2UoIGluZGV4LCAxICk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblxuXHRcdFx0Ly8gTG9vayBmb3IgYW55IGFuaW1hdGlvbnMgaW4gdGhlIG9sZCBxdWV1ZSBhbmQgZmluaXNoIHRoZW1cblx0XHRcdGZvciAoIGluZGV4ID0gMDsgaW5kZXggPCBsZW5ndGg7IGluZGV4KysgKSB7XG5cdFx0XHRcdGlmICggcXVldWVbIGluZGV4IF0gJiYgcXVldWVbIGluZGV4IF0uZmluaXNoICkge1xuXHRcdFx0XHRcdHF1ZXVlWyBpbmRleCBdLmZpbmlzaC5jYWxsKCB0aGlzICk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblxuXHRcdFx0Ly8gVHVybiBvZmYgZmluaXNoaW5nIGZsYWdcblx0XHRcdGRlbGV0ZSBkYXRhLmZpbmlzaDtcblx0XHR9KTtcblx0fVxufSk7XG5cbmpRdWVyeS5lYWNoKFsgXCJ0b2dnbGVcIiwgXCJzaG93XCIsIFwiaGlkZVwiIF0sIGZ1bmN0aW9uKCBpLCBuYW1lICkge1xuXHR2YXIgY3NzRm4gPSBqUXVlcnkuZm5bIG5hbWUgXTtcblx0alF1ZXJ5LmZuWyBuYW1lIF0gPSBmdW5jdGlvbiggc3BlZWQsIGVhc2luZywgY2FsbGJhY2sgKSB7XG5cdFx0cmV0dXJuIHNwZWVkID09IG51bGwgfHwgdHlwZW9mIHNwZWVkID09PSBcImJvb2xlYW5cIiA/XG5cdFx0XHRjc3NGbi5hcHBseSggdGhpcywgYXJndW1lbnRzICkgOlxuXHRcdFx0dGhpcy5hbmltYXRlKCBnZW5GeCggbmFtZSwgdHJ1ZSApLCBzcGVlZCwgZWFzaW5nLCBjYWxsYmFjayApO1xuXHR9O1xufSk7XG5cbi8vIEdlbmVyYXRlIHNob3J0Y3V0cyBmb3IgY3VzdG9tIGFuaW1hdGlvbnNcbmpRdWVyeS5lYWNoKHtcblx0c2xpZGVEb3duOiBnZW5GeChcInNob3dcIiksXG5cdHNsaWRlVXA6IGdlbkZ4KFwiaGlkZVwiKSxcblx0c2xpZGVUb2dnbGU6IGdlbkZ4KFwidG9nZ2xlXCIpLFxuXHRmYWRlSW46IHsgb3BhY2l0eTogXCJzaG93XCIgfSxcblx0ZmFkZU91dDogeyBvcGFjaXR5OiBcImhpZGVcIiB9LFxuXHRmYWRlVG9nZ2xlOiB7IG9wYWNpdHk6IFwidG9nZ2xlXCIgfVxufSwgZnVuY3Rpb24oIG5hbWUsIHByb3BzICkge1xuXHRqUXVlcnkuZm5bIG5hbWUgXSA9IGZ1bmN0aW9uKCBzcGVlZCwgZWFzaW5nLCBjYWxsYmFjayApIHtcblx0XHRyZXR1cm4gdGhpcy5hbmltYXRlKCBwcm9wcywgc3BlZWQsIGVhc2luZywgY2FsbGJhY2sgKTtcblx0fTtcbn0pO1xuXG5qUXVlcnkudGltZXJzID0gW107XG5qUXVlcnkuZngudGljayA9IGZ1bmN0aW9uKCkge1xuXHR2YXIgdGltZXIsXG5cdFx0aSA9IDAsXG5cdFx0dGltZXJzID0galF1ZXJ5LnRpbWVycztcblxuXHRmeE5vdyA9IGpRdWVyeS5ub3coKTtcblxuXHRmb3IgKCA7IGkgPCB0aW1lcnMubGVuZ3RoOyBpKysgKSB7XG5cdFx0dGltZXIgPSB0aW1lcnNbIGkgXTtcblx0XHQvLyBDaGVja3MgdGhlIHRpbWVyIGhhcyBub3QgYWxyZWFkeSBiZWVuIHJlbW92ZWRcblx0XHRpZiAoICF0aW1lcigpICYmIHRpbWVyc1sgaSBdID09PSB0aW1lciApIHtcblx0XHRcdHRpbWVycy5zcGxpY2UoIGktLSwgMSApO1xuXHRcdH1cblx0fVxuXG5cdGlmICggIXRpbWVycy5sZW5ndGggKSB7XG5cdFx0alF1ZXJ5LmZ4LnN0b3AoKTtcblx0fVxuXHRmeE5vdyA9IHVuZGVmaW5lZDtcbn07XG5cbmpRdWVyeS5meC50aW1lciA9IGZ1bmN0aW9uKCB0aW1lciApIHtcblx0alF1ZXJ5LnRpbWVycy5wdXNoKCB0aW1lciApO1xuXHRpZiAoIHRpbWVyKCkgKSB7XG5cdFx0alF1ZXJ5LmZ4LnN0YXJ0KCk7XG5cdH0gZWxzZSB7XG5cdFx0alF1ZXJ5LnRpbWVycy5wb3AoKTtcblx0fVxufTtcblxualF1ZXJ5LmZ4LmludGVydmFsID0gMTM7XG5cbmpRdWVyeS5meC5zdGFydCA9IGZ1bmN0aW9uKCkge1xuXHRpZiAoICF0aW1lcklkICkge1xuXHRcdHRpbWVySWQgPSBzZXRJbnRlcnZhbCggalF1ZXJ5LmZ4LnRpY2ssIGpRdWVyeS5meC5pbnRlcnZhbCApO1xuXHR9XG59O1xuXG5qUXVlcnkuZnguc3RvcCA9IGZ1bmN0aW9uKCkge1xuXHRjbGVhckludGVydmFsKCB0aW1lcklkICk7XG5cdHRpbWVySWQgPSBudWxsO1xufTtcblxualF1ZXJ5LmZ4LnNwZWVkcyA9IHtcblx0c2xvdzogNjAwLFxuXHRmYXN0OiAyMDAsXG5cdC8vIERlZmF1bHQgc3BlZWRcblx0X2RlZmF1bHQ6IDQwMFxufTtcblxuXG4vLyBCYXNlZCBvZmYgb2YgdGhlIHBsdWdpbiBieSBDbGludCBIZWxmZXJzLCB3aXRoIHBlcm1pc3Npb24uXG4vLyBodHRwOi8vYmxpbmRzaWduYWxzLmNvbS9pbmRleC5waHAvMjAwOS8wNy9qcXVlcnktZGVsYXkvXG5qUXVlcnkuZm4uZGVsYXkgPSBmdW5jdGlvbiggdGltZSwgdHlwZSApIHtcblx0dGltZSA9IGpRdWVyeS5meCA/IGpRdWVyeS5meC5zcGVlZHNbIHRpbWUgXSB8fCB0aW1lIDogdGltZTtcblx0dHlwZSA9IHR5cGUgfHwgXCJmeFwiO1xuXG5cdHJldHVybiB0aGlzLnF1ZXVlKCB0eXBlLCBmdW5jdGlvbiggbmV4dCwgaG9va3MgKSB7XG5cdFx0dmFyIHRpbWVvdXQgPSBzZXRUaW1lb3V0KCBuZXh0LCB0aW1lICk7XG5cdFx0aG9va3Muc3RvcCA9IGZ1bmN0aW9uKCkge1xuXHRcdFx0Y2xlYXJUaW1lb3V0KCB0aW1lb3V0ICk7XG5cdFx0fTtcblx0fSk7XG59O1xuXG5cbihmdW5jdGlvbigpIHtcblx0dmFyIGlucHV0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCggXCJpbnB1dFwiICksXG5cdFx0c2VsZWN0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCggXCJzZWxlY3RcIiApLFxuXHRcdG9wdCA9IHNlbGVjdC5hcHBlbmRDaGlsZCggZG9jdW1lbnQuY3JlYXRlRWxlbWVudCggXCJvcHRpb25cIiApICk7XG5cblx0aW5wdXQudHlwZSA9IFwiY2hlY2tib3hcIjtcblxuXHQvLyBTdXBwb3J0OiBpT1M8PTUuMSwgQW5kcm9pZDw9NC4yK1xuXHQvLyBEZWZhdWx0IHZhbHVlIGZvciBhIGNoZWNrYm94IHNob3VsZCBiZSBcIm9uXCJcblx0c3VwcG9ydC5jaGVja09uID0gaW5wdXQudmFsdWUgIT09IFwiXCI7XG5cblx0Ly8gU3VwcG9ydDogSUU8PTExK1xuXHQvLyBNdXN0IGFjY2VzcyBzZWxlY3RlZEluZGV4IHRvIG1ha2UgZGVmYXVsdCBvcHRpb25zIHNlbGVjdFxuXHRzdXBwb3J0Lm9wdFNlbGVjdGVkID0gb3B0LnNlbGVjdGVkO1xuXG5cdC8vIFN1cHBvcnQ6IEFuZHJvaWQ8PTIuM1xuXHQvLyBPcHRpb25zIGluc2lkZSBkaXNhYmxlZCBzZWxlY3RzIGFyZSBpbmNvcnJlY3RseSBtYXJrZWQgYXMgZGlzYWJsZWRcblx0c2VsZWN0LmRpc2FibGVkID0gdHJ1ZTtcblx0c3VwcG9ydC5vcHREaXNhYmxlZCA9ICFvcHQuZGlzYWJsZWQ7XG5cblx0Ly8gU3VwcG9ydDogSUU8PTExK1xuXHQvLyBBbiBpbnB1dCBsb3NlcyBpdHMgdmFsdWUgYWZ0ZXIgYmVjb21pbmcgYSByYWRpb1xuXHRpbnB1dCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoIFwiaW5wdXRcIiApO1xuXHRpbnB1dC52YWx1ZSA9IFwidFwiO1xuXHRpbnB1dC50eXBlID0gXCJyYWRpb1wiO1xuXHRzdXBwb3J0LnJhZGlvVmFsdWUgPSBpbnB1dC52YWx1ZSA9PT0gXCJ0XCI7XG59KSgpO1xuXG5cbnZhciBub2RlSG9vaywgYm9vbEhvb2ssXG5cdGF0dHJIYW5kbGUgPSBqUXVlcnkuZXhwci5hdHRySGFuZGxlO1xuXG5qUXVlcnkuZm4uZXh0ZW5kKHtcblx0YXR0cjogZnVuY3Rpb24oIG5hbWUsIHZhbHVlICkge1xuXHRcdHJldHVybiBhY2Nlc3MoIHRoaXMsIGpRdWVyeS5hdHRyLCBuYW1lLCB2YWx1ZSwgYXJndW1lbnRzLmxlbmd0aCA+IDEgKTtcblx0fSxcblxuXHRyZW1vdmVBdHRyOiBmdW5jdGlvbiggbmFtZSApIHtcblx0XHRyZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uKCkge1xuXHRcdFx0alF1ZXJ5LnJlbW92ZUF0dHIoIHRoaXMsIG5hbWUgKTtcblx0XHR9KTtcblx0fVxufSk7XG5cbmpRdWVyeS5leHRlbmQoe1xuXHRhdHRyOiBmdW5jdGlvbiggZWxlbSwgbmFtZSwgdmFsdWUgKSB7XG5cdFx0dmFyIGhvb2tzLCByZXQsXG5cdFx0XHRuVHlwZSA9IGVsZW0ubm9kZVR5cGU7XG5cblx0XHQvLyBkb24ndCBnZXQvc2V0IGF0dHJpYnV0ZXMgb24gdGV4dCwgY29tbWVudCBhbmQgYXR0cmlidXRlIG5vZGVzXG5cdFx0aWYgKCAhZWxlbSB8fCBuVHlwZSA9PT0gMyB8fCBuVHlwZSA9PT0gOCB8fCBuVHlwZSA9PT0gMiApIHtcblx0XHRcdHJldHVybjtcblx0XHR9XG5cblx0XHQvLyBGYWxsYmFjayB0byBwcm9wIHdoZW4gYXR0cmlidXRlcyBhcmUgbm90IHN1cHBvcnRlZFxuXHRcdGlmICggdHlwZW9mIGVsZW0uZ2V0QXR0cmlidXRlID09PSBzdHJ1bmRlZmluZWQgKSB7XG5cdFx0XHRyZXR1cm4galF1ZXJ5LnByb3AoIGVsZW0sIG5hbWUsIHZhbHVlICk7XG5cdFx0fVxuXG5cdFx0Ly8gQWxsIGF0dHJpYnV0ZXMgYXJlIGxvd2VyY2FzZVxuXHRcdC8vIEdyYWIgbmVjZXNzYXJ5IGhvb2sgaWYgb25lIGlzIGRlZmluZWRcblx0XHRpZiAoIG5UeXBlICE9PSAxIHx8ICFqUXVlcnkuaXNYTUxEb2MoIGVsZW0gKSApIHtcblx0XHRcdG5hbWUgPSBuYW1lLnRvTG93ZXJDYXNlKCk7XG5cdFx0XHRob29rcyA9IGpRdWVyeS5hdHRySG9va3NbIG5hbWUgXSB8fFxuXHRcdFx0XHQoIGpRdWVyeS5leHByLm1hdGNoLmJvb2wudGVzdCggbmFtZSApID8gYm9vbEhvb2sgOiBub2RlSG9vayApO1xuXHRcdH1cblxuXHRcdGlmICggdmFsdWUgIT09IHVuZGVmaW5lZCApIHtcblxuXHRcdFx0aWYgKCB2YWx1ZSA9PT0gbnVsbCApIHtcblx0XHRcdFx0alF1ZXJ5LnJlbW92ZUF0dHIoIGVsZW0sIG5hbWUgKTtcblxuXHRcdFx0fSBlbHNlIGlmICggaG9va3MgJiYgXCJzZXRcIiBpbiBob29rcyAmJiAocmV0ID0gaG9va3Muc2V0KCBlbGVtLCB2YWx1ZSwgbmFtZSApKSAhPT0gdW5kZWZpbmVkICkge1xuXHRcdFx0XHRyZXR1cm4gcmV0O1xuXG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRlbGVtLnNldEF0dHJpYnV0ZSggbmFtZSwgdmFsdWUgKyBcIlwiICk7XG5cdFx0XHRcdHJldHVybiB2YWx1ZTtcblx0XHRcdH1cblxuXHRcdH0gZWxzZSBpZiAoIGhvb2tzICYmIFwiZ2V0XCIgaW4gaG9va3MgJiYgKHJldCA9IGhvb2tzLmdldCggZWxlbSwgbmFtZSApKSAhPT0gbnVsbCApIHtcblx0XHRcdHJldHVybiByZXQ7XG5cblx0XHR9IGVsc2Uge1xuXHRcdFx0cmV0ID0galF1ZXJ5LmZpbmQuYXR0ciggZWxlbSwgbmFtZSApO1xuXG5cdFx0XHQvLyBOb24tZXhpc3RlbnQgYXR0cmlidXRlcyByZXR1cm4gbnVsbCwgd2Ugbm9ybWFsaXplIHRvIHVuZGVmaW5lZFxuXHRcdFx0cmV0dXJuIHJldCA9PSBudWxsID9cblx0XHRcdFx0dW5kZWZpbmVkIDpcblx0XHRcdFx0cmV0O1xuXHRcdH1cblx0fSxcblxuXHRyZW1vdmVBdHRyOiBmdW5jdGlvbiggZWxlbSwgdmFsdWUgKSB7XG5cdFx0dmFyIG5hbWUsIHByb3BOYW1lLFxuXHRcdFx0aSA9IDAsXG5cdFx0XHRhdHRyTmFtZXMgPSB2YWx1ZSAmJiB2YWx1ZS5tYXRjaCggcm5vdHdoaXRlICk7XG5cblx0XHRpZiAoIGF0dHJOYW1lcyAmJiBlbGVtLm5vZGVUeXBlID09PSAxICkge1xuXHRcdFx0d2hpbGUgKCAobmFtZSA9IGF0dHJOYW1lc1tpKytdKSApIHtcblx0XHRcdFx0cHJvcE5hbWUgPSBqUXVlcnkucHJvcEZpeFsgbmFtZSBdIHx8IG5hbWU7XG5cblx0XHRcdFx0Ly8gQm9vbGVhbiBhdHRyaWJ1dGVzIGdldCBzcGVjaWFsIHRyZWF0bWVudCAoIzEwODcwKVxuXHRcdFx0XHRpZiAoIGpRdWVyeS5leHByLm1hdGNoLmJvb2wudGVzdCggbmFtZSApICkge1xuXHRcdFx0XHRcdC8vIFNldCBjb3JyZXNwb25kaW5nIHByb3BlcnR5IHRvIGZhbHNlXG5cdFx0XHRcdFx0ZWxlbVsgcHJvcE5hbWUgXSA9IGZhbHNlO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0ZWxlbS5yZW1vdmVBdHRyaWJ1dGUoIG5hbWUgKTtcblx0XHRcdH1cblx0XHR9XG5cdH0sXG5cblx0YXR0ckhvb2tzOiB7XG5cdFx0dHlwZToge1xuXHRcdFx0c2V0OiBmdW5jdGlvbiggZWxlbSwgdmFsdWUgKSB7XG5cdFx0XHRcdGlmICggIXN1cHBvcnQucmFkaW9WYWx1ZSAmJiB2YWx1ZSA9PT0gXCJyYWRpb1wiICYmXG5cdFx0XHRcdFx0alF1ZXJ5Lm5vZGVOYW1lKCBlbGVtLCBcImlucHV0XCIgKSApIHtcblx0XHRcdFx0XHR2YXIgdmFsID0gZWxlbS52YWx1ZTtcblx0XHRcdFx0XHRlbGVtLnNldEF0dHJpYnV0ZSggXCJ0eXBlXCIsIHZhbHVlICk7XG5cdFx0XHRcdFx0aWYgKCB2YWwgKSB7XG5cdFx0XHRcdFx0XHRlbGVtLnZhbHVlID0gdmFsO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHRyZXR1cm4gdmFsdWU7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9XG5cdH1cbn0pO1xuXG4vLyBIb29rcyBmb3IgYm9vbGVhbiBhdHRyaWJ1dGVzXG5ib29sSG9vayA9IHtcblx0c2V0OiBmdW5jdGlvbiggZWxlbSwgdmFsdWUsIG5hbWUgKSB7XG5cdFx0aWYgKCB2YWx1ZSA9PT0gZmFsc2UgKSB7XG5cdFx0XHQvLyBSZW1vdmUgYm9vbGVhbiBhdHRyaWJ1dGVzIHdoZW4gc2V0IHRvIGZhbHNlXG5cdFx0XHRqUXVlcnkucmVtb3ZlQXR0ciggZWxlbSwgbmFtZSApO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRlbGVtLnNldEF0dHJpYnV0ZSggbmFtZSwgbmFtZSApO1xuXHRcdH1cblx0XHRyZXR1cm4gbmFtZTtcblx0fVxufTtcbmpRdWVyeS5lYWNoKCBqUXVlcnkuZXhwci5tYXRjaC5ib29sLnNvdXJjZS5tYXRjaCggL1xcdysvZyApLCBmdW5jdGlvbiggaSwgbmFtZSApIHtcblx0dmFyIGdldHRlciA9IGF0dHJIYW5kbGVbIG5hbWUgXSB8fCBqUXVlcnkuZmluZC5hdHRyO1xuXG5cdGF0dHJIYW5kbGVbIG5hbWUgXSA9IGZ1bmN0aW9uKCBlbGVtLCBuYW1lLCBpc1hNTCApIHtcblx0XHR2YXIgcmV0LCBoYW5kbGU7XG5cdFx0aWYgKCAhaXNYTUwgKSB7XG5cdFx0XHQvLyBBdm9pZCBhbiBpbmZpbml0ZSBsb29wIGJ5IHRlbXBvcmFyaWx5IHJlbW92aW5nIHRoaXMgZnVuY3Rpb24gZnJvbSB0aGUgZ2V0dGVyXG5cdFx0XHRoYW5kbGUgPSBhdHRySGFuZGxlWyBuYW1lIF07XG5cdFx0XHRhdHRySGFuZGxlWyBuYW1lIF0gPSByZXQ7XG5cdFx0XHRyZXQgPSBnZXR0ZXIoIGVsZW0sIG5hbWUsIGlzWE1MICkgIT0gbnVsbCA/XG5cdFx0XHRcdG5hbWUudG9Mb3dlckNhc2UoKSA6XG5cdFx0XHRcdG51bGw7XG5cdFx0XHRhdHRySGFuZGxlWyBuYW1lIF0gPSBoYW5kbGU7XG5cdFx0fVxuXHRcdHJldHVybiByZXQ7XG5cdH07XG59KTtcblxuXG5cblxudmFyIHJmb2N1c2FibGUgPSAvXig/OmlucHV0fHNlbGVjdHx0ZXh0YXJlYXxidXR0b24pJC9pO1xuXG5qUXVlcnkuZm4uZXh0ZW5kKHtcblx0cHJvcDogZnVuY3Rpb24oIG5hbWUsIHZhbHVlICkge1xuXHRcdHJldHVybiBhY2Nlc3MoIHRoaXMsIGpRdWVyeS5wcm9wLCBuYW1lLCB2YWx1ZSwgYXJndW1lbnRzLmxlbmd0aCA+IDEgKTtcblx0fSxcblxuXHRyZW1vdmVQcm9wOiBmdW5jdGlvbiggbmFtZSApIHtcblx0XHRyZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uKCkge1xuXHRcdFx0ZGVsZXRlIHRoaXNbIGpRdWVyeS5wcm9wRml4WyBuYW1lIF0gfHwgbmFtZSBdO1xuXHRcdH0pO1xuXHR9XG59KTtcblxualF1ZXJ5LmV4dGVuZCh7XG5cdHByb3BGaXg6IHtcblx0XHRcImZvclwiOiBcImh0bWxGb3JcIixcblx0XHRcImNsYXNzXCI6IFwiY2xhc3NOYW1lXCJcblx0fSxcblxuXHRwcm9wOiBmdW5jdGlvbiggZWxlbSwgbmFtZSwgdmFsdWUgKSB7XG5cdFx0dmFyIHJldCwgaG9va3MsIG5vdHhtbCxcblx0XHRcdG5UeXBlID0gZWxlbS5ub2RlVHlwZTtcblxuXHRcdC8vIERvbid0IGdldC9zZXQgcHJvcGVydGllcyBvbiB0ZXh0LCBjb21tZW50IGFuZCBhdHRyaWJ1dGUgbm9kZXNcblx0XHRpZiAoICFlbGVtIHx8IG5UeXBlID09PSAzIHx8IG5UeXBlID09PSA4IHx8IG5UeXBlID09PSAyICkge1xuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblxuXHRcdG5vdHhtbCA9IG5UeXBlICE9PSAxIHx8ICFqUXVlcnkuaXNYTUxEb2MoIGVsZW0gKTtcblxuXHRcdGlmICggbm90eG1sICkge1xuXHRcdFx0Ly8gRml4IG5hbWUgYW5kIGF0dGFjaCBob29rc1xuXHRcdFx0bmFtZSA9IGpRdWVyeS5wcm9wRml4WyBuYW1lIF0gfHwgbmFtZTtcblx0XHRcdGhvb2tzID0galF1ZXJ5LnByb3BIb29rc1sgbmFtZSBdO1xuXHRcdH1cblxuXHRcdGlmICggdmFsdWUgIT09IHVuZGVmaW5lZCApIHtcblx0XHRcdHJldHVybiBob29rcyAmJiBcInNldFwiIGluIGhvb2tzICYmIChyZXQgPSBob29rcy5zZXQoIGVsZW0sIHZhbHVlLCBuYW1lICkpICE9PSB1bmRlZmluZWQgP1xuXHRcdFx0XHRyZXQgOlxuXHRcdFx0XHQoIGVsZW1bIG5hbWUgXSA9IHZhbHVlICk7XG5cblx0XHR9IGVsc2Uge1xuXHRcdFx0cmV0dXJuIGhvb2tzICYmIFwiZ2V0XCIgaW4gaG9va3MgJiYgKHJldCA9IGhvb2tzLmdldCggZWxlbSwgbmFtZSApKSAhPT0gbnVsbCA/XG5cdFx0XHRcdHJldCA6XG5cdFx0XHRcdGVsZW1bIG5hbWUgXTtcblx0XHR9XG5cdH0sXG5cblx0cHJvcEhvb2tzOiB7XG5cdFx0dGFiSW5kZXg6IHtcblx0XHRcdGdldDogZnVuY3Rpb24oIGVsZW0gKSB7XG5cdFx0XHRcdHJldHVybiBlbGVtLmhhc0F0dHJpYnV0ZSggXCJ0YWJpbmRleFwiICkgfHwgcmZvY3VzYWJsZS50ZXN0KCBlbGVtLm5vZGVOYW1lICkgfHwgZWxlbS5ocmVmID9cblx0XHRcdFx0XHRlbGVtLnRhYkluZGV4IDpcblx0XHRcdFx0XHQtMTtcblx0XHRcdH1cblx0XHR9XG5cdH1cbn0pO1xuXG5pZiAoICFzdXBwb3J0Lm9wdFNlbGVjdGVkICkge1xuXHRqUXVlcnkucHJvcEhvb2tzLnNlbGVjdGVkID0ge1xuXHRcdGdldDogZnVuY3Rpb24oIGVsZW0gKSB7XG5cdFx0XHR2YXIgcGFyZW50ID0gZWxlbS5wYXJlbnROb2RlO1xuXHRcdFx0aWYgKCBwYXJlbnQgJiYgcGFyZW50LnBhcmVudE5vZGUgKSB7XG5cdFx0XHRcdHBhcmVudC5wYXJlbnROb2RlLnNlbGVjdGVkSW5kZXg7XG5cdFx0XHR9XG5cdFx0XHRyZXR1cm4gbnVsbDtcblx0XHR9XG5cdH07XG59XG5cbmpRdWVyeS5lYWNoKFtcblx0XCJ0YWJJbmRleFwiLFxuXHRcInJlYWRPbmx5XCIsXG5cdFwibWF4TGVuZ3RoXCIsXG5cdFwiY2VsbFNwYWNpbmdcIixcblx0XCJjZWxsUGFkZGluZ1wiLFxuXHRcInJvd1NwYW5cIixcblx0XCJjb2xTcGFuXCIsXG5cdFwidXNlTWFwXCIsXG5cdFwiZnJhbWVCb3JkZXJcIixcblx0XCJjb250ZW50RWRpdGFibGVcIlxuXSwgZnVuY3Rpb24oKSB7XG5cdGpRdWVyeS5wcm9wRml4WyB0aGlzLnRvTG93ZXJDYXNlKCkgXSA9IHRoaXM7XG59KTtcblxuXG5cblxudmFyIHJjbGFzcyA9IC9bXFx0XFxyXFxuXFxmXS9nO1xuXG5qUXVlcnkuZm4uZXh0ZW5kKHtcblx0YWRkQ2xhc3M6IGZ1bmN0aW9uKCB2YWx1ZSApIHtcblx0XHR2YXIgY2xhc3NlcywgZWxlbSwgY3VyLCBjbGF6eiwgaiwgZmluYWxWYWx1ZSxcblx0XHRcdHByb2NlZWQgPSB0eXBlb2YgdmFsdWUgPT09IFwic3RyaW5nXCIgJiYgdmFsdWUsXG5cdFx0XHRpID0gMCxcblx0XHRcdGxlbiA9IHRoaXMubGVuZ3RoO1xuXG5cdFx0aWYgKCBqUXVlcnkuaXNGdW5jdGlvbiggdmFsdWUgKSApIHtcblx0XHRcdHJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oIGogKSB7XG5cdFx0XHRcdGpRdWVyeSggdGhpcyApLmFkZENsYXNzKCB2YWx1ZS5jYWxsKCB0aGlzLCBqLCB0aGlzLmNsYXNzTmFtZSApICk7XG5cdFx0XHR9KTtcblx0XHR9XG5cblx0XHRpZiAoIHByb2NlZWQgKSB7XG5cdFx0XHQvLyBUaGUgZGlzanVuY3Rpb24gaGVyZSBpcyBmb3IgYmV0dGVyIGNvbXByZXNzaWJpbGl0eSAoc2VlIHJlbW92ZUNsYXNzKVxuXHRcdFx0Y2xhc3NlcyA9ICggdmFsdWUgfHwgXCJcIiApLm1hdGNoKCBybm90d2hpdGUgKSB8fCBbXTtcblxuXHRcdFx0Zm9yICggOyBpIDwgbGVuOyBpKysgKSB7XG5cdFx0XHRcdGVsZW0gPSB0aGlzWyBpIF07XG5cdFx0XHRcdGN1ciA9IGVsZW0ubm9kZVR5cGUgPT09IDEgJiYgKCBlbGVtLmNsYXNzTmFtZSA/XG5cdFx0XHRcdFx0KCBcIiBcIiArIGVsZW0uY2xhc3NOYW1lICsgXCIgXCIgKS5yZXBsYWNlKCByY2xhc3MsIFwiIFwiICkgOlxuXHRcdFx0XHRcdFwiIFwiXG5cdFx0XHRcdCk7XG5cblx0XHRcdFx0aWYgKCBjdXIgKSB7XG5cdFx0XHRcdFx0aiA9IDA7XG5cdFx0XHRcdFx0d2hpbGUgKCAoY2xhenogPSBjbGFzc2VzW2orK10pICkge1xuXHRcdFx0XHRcdFx0aWYgKCBjdXIuaW5kZXhPZiggXCIgXCIgKyBjbGF6eiArIFwiIFwiICkgPCAwICkge1xuXHRcdFx0XHRcdFx0XHRjdXIgKz0gY2xhenogKyBcIiBcIjtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHQvLyBvbmx5IGFzc2lnbiBpZiBkaWZmZXJlbnQgdG8gYXZvaWQgdW5uZWVkZWQgcmVuZGVyaW5nLlxuXHRcdFx0XHRcdGZpbmFsVmFsdWUgPSBqUXVlcnkudHJpbSggY3VyICk7XG5cdFx0XHRcdFx0aWYgKCBlbGVtLmNsYXNzTmFtZSAhPT0gZmluYWxWYWx1ZSApIHtcblx0XHRcdFx0XHRcdGVsZW0uY2xhc3NOYW1lID0gZmluYWxWYWx1ZTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9XG5cblx0XHRyZXR1cm4gdGhpcztcblx0fSxcblxuXHRyZW1vdmVDbGFzczogZnVuY3Rpb24oIHZhbHVlICkge1xuXHRcdHZhciBjbGFzc2VzLCBlbGVtLCBjdXIsIGNsYXp6LCBqLCBmaW5hbFZhbHVlLFxuXHRcdFx0cHJvY2VlZCA9IGFyZ3VtZW50cy5sZW5ndGggPT09IDAgfHwgdHlwZW9mIHZhbHVlID09PSBcInN0cmluZ1wiICYmIHZhbHVlLFxuXHRcdFx0aSA9IDAsXG5cdFx0XHRsZW4gPSB0aGlzLmxlbmd0aDtcblxuXHRcdGlmICggalF1ZXJ5LmlzRnVuY3Rpb24oIHZhbHVlICkgKSB7XG5cdFx0XHRyZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uKCBqICkge1xuXHRcdFx0XHRqUXVlcnkoIHRoaXMgKS5yZW1vdmVDbGFzcyggdmFsdWUuY2FsbCggdGhpcywgaiwgdGhpcy5jbGFzc05hbWUgKSApO1xuXHRcdFx0fSk7XG5cdFx0fVxuXHRcdGlmICggcHJvY2VlZCApIHtcblx0XHRcdGNsYXNzZXMgPSAoIHZhbHVlIHx8IFwiXCIgKS5tYXRjaCggcm5vdHdoaXRlICkgfHwgW107XG5cblx0XHRcdGZvciAoIDsgaSA8IGxlbjsgaSsrICkge1xuXHRcdFx0XHRlbGVtID0gdGhpc1sgaSBdO1xuXHRcdFx0XHQvLyBUaGlzIGV4cHJlc3Npb24gaXMgaGVyZSBmb3IgYmV0dGVyIGNvbXByZXNzaWJpbGl0eSAoc2VlIGFkZENsYXNzKVxuXHRcdFx0XHRjdXIgPSBlbGVtLm5vZGVUeXBlID09PSAxICYmICggZWxlbS5jbGFzc05hbWUgP1xuXHRcdFx0XHRcdCggXCIgXCIgKyBlbGVtLmNsYXNzTmFtZSArIFwiIFwiICkucmVwbGFjZSggcmNsYXNzLCBcIiBcIiApIDpcblx0XHRcdFx0XHRcIlwiXG5cdFx0XHRcdCk7XG5cblx0XHRcdFx0aWYgKCBjdXIgKSB7XG5cdFx0XHRcdFx0aiA9IDA7XG5cdFx0XHRcdFx0d2hpbGUgKCAoY2xhenogPSBjbGFzc2VzW2orK10pICkge1xuXHRcdFx0XHRcdFx0Ly8gUmVtb3ZlICphbGwqIGluc3RhbmNlc1xuXHRcdFx0XHRcdFx0d2hpbGUgKCBjdXIuaW5kZXhPZiggXCIgXCIgKyBjbGF6eiArIFwiIFwiICkgPj0gMCApIHtcblx0XHRcdFx0XHRcdFx0Y3VyID0gY3VyLnJlcGxhY2UoIFwiIFwiICsgY2xhenogKyBcIiBcIiwgXCIgXCIgKTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHQvLyBPbmx5IGFzc2lnbiBpZiBkaWZmZXJlbnQgdG8gYXZvaWQgdW5uZWVkZWQgcmVuZGVyaW5nLlxuXHRcdFx0XHRcdGZpbmFsVmFsdWUgPSB2YWx1ZSA/IGpRdWVyeS50cmltKCBjdXIgKSA6IFwiXCI7XG5cdFx0XHRcdFx0aWYgKCBlbGVtLmNsYXNzTmFtZSAhPT0gZmluYWxWYWx1ZSApIHtcblx0XHRcdFx0XHRcdGVsZW0uY2xhc3NOYW1lID0gZmluYWxWYWx1ZTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9XG5cblx0XHRyZXR1cm4gdGhpcztcblx0fSxcblxuXHR0b2dnbGVDbGFzczogZnVuY3Rpb24oIHZhbHVlLCBzdGF0ZVZhbCApIHtcblx0XHR2YXIgdHlwZSA9IHR5cGVvZiB2YWx1ZTtcblxuXHRcdGlmICggdHlwZW9mIHN0YXRlVmFsID09PSBcImJvb2xlYW5cIiAmJiB0eXBlID09PSBcInN0cmluZ1wiICkge1xuXHRcdFx0cmV0dXJuIHN0YXRlVmFsID8gdGhpcy5hZGRDbGFzcyggdmFsdWUgKSA6IHRoaXMucmVtb3ZlQ2xhc3MoIHZhbHVlICk7XG5cdFx0fVxuXG5cdFx0aWYgKCBqUXVlcnkuaXNGdW5jdGlvbiggdmFsdWUgKSApIHtcblx0XHRcdHJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oIGkgKSB7XG5cdFx0XHRcdGpRdWVyeSggdGhpcyApLnRvZ2dsZUNsYXNzKCB2YWx1ZS5jYWxsKHRoaXMsIGksIHRoaXMuY2xhc3NOYW1lLCBzdGF0ZVZhbCksIHN0YXRlVmFsICk7XG5cdFx0XHR9KTtcblx0XHR9XG5cblx0XHRyZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uKCkge1xuXHRcdFx0aWYgKCB0eXBlID09PSBcInN0cmluZ1wiICkge1xuXHRcdFx0XHQvLyBUb2dnbGUgaW5kaXZpZHVhbCBjbGFzcyBuYW1lc1xuXHRcdFx0XHR2YXIgY2xhc3NOYW1lLFxuXHRcdFx0XHRcdGkgPSAwLFxuXHRcdFx0XHRcdHNlbGYgPSBqUXVlcnkoIHRoaXMgKSxcblx0XHRcdFx0XHRjbGFzc05hbWVzID0gdmFsdWUubWF0Y2goIHJub3R3aGl0ZSApIHx8IFtdO1xuXG5cdFx0XHRcdHdoaWxlICggKGNsYXNzTmFtZSA9IGNsYXNzTmFtZXNbIGkrKyBdKSApIHtcblx0XHRcdFx0XHQvLyBDaGVjayBlYWNoIGNsYXNzTmFtZSBnaXZlbiwgc3BhY2Ugc2VwYXJhdGVkIGxpc3Rcblx0XHRcdFx0XHRpZiAoIHNlbGYuaGFzQ2xhc3MoIGNsYXNzTmFtZSApICkge1xuXHRcdFx0XHRcdFx0c2VsZi5yZW1vdmVDbGFzcyggY2xhc3NOYW1lICk7XG5cdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdHNlbGYuYWRkQ2xhc3MoIGNsYXNzTmFtZSApO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXG5cdFx0XHQvLyBUb2dnbGUgd2hvbGUgY2xhc3MgbmFtZVxuXHRcdFx0fSBlbHNlIGlmICggdHlwZSA9PT0gc3RydW5kZWZpbmVkIHx8IHR5cGUgPT09IFwiYm9vbGVhblwiICkge1xuXHRcdFx0XHRpZiAoIHRoaXMuY2xhc3NOYW1lICkge1xuXHRcdFx0XHRcdC8vIHN0b3JlIGNsYXNzTmFtZSBpZiBzZXRcblx0XHRcdFx0XHRkYXRhX3ByaXYuc2V0KCB0aGlzLCBcIl9fY2xhc3NOYW1lX19cIiwgdGhpcy5jbGFzc05hbWUgKTtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdC8vIElmIHRoZSBlbGVtZW50IGhhcyBhIGNsYXNzIG5hbWUgb3IgaWYgd2UncmUgcGFzc2VkIGBmYWxzZWAsXG5cdFx0XHRcdC8vIHRoZW4gcmVtb3ZlIHRoZSB3aG9sZSBjbGFzc25hbWUgKGlmIHRoZXJlIHdhcyBvbmUsIHRoZSBhYm92ZSBzYXZlZCBpdCkuXG5cdFx0XHRcdC8vIE90aGVyd2lzZSBicmluZyBiYWNrIHdoYXRldmVyIHdhcyBwcmV2aW91c2x5IHNhdmVkIChpZiBhbnl0aGluZyksXG5cdFx0XHRcdC8vIGZhbGxpbmcgYmFjayB0byB0aGUgZW1wdHkgc3RyaW5nIGlmIG5vdGhpbmcgd2FzIHN0b3JlZC5cblx0XHRcdFx0dGhpcy5jbGFzc05hbWUgPSB0aGlzLmNsYXNzTmFtZSB8fCB2YWx1ZSA9PT0gZmFsc2UgPyBcIlwiIDogZGF0YV9wcml2LmdldCggdGhpcywgXCJfX2NsYXNzTmFtZV9fXCIgKSB8fCBcIlwiO1xuXHRcdFx0fVxuXHRcdH0pO1xuXHR9LFxuXG5cdGhhc0NsYXNzOiBmdW5jdGlvbiggc2VsZWN0b3IgKSB7XG5cdFx0dmFyIGNsYXNzTmFtZSA9IFwiIFwiICsgc2VsZWN0b3IgKyBcIiBcIixcblx0XHRcdGkgPSAwLFxuXHRcdFx0bCA9IHRoaXMubGVuZ3RoO1xuXHRcdGZvciAoIDsgaSA8IGw7IGkrKyApIHtcblx0XHRcdGlmICggdGhpc1tpXS5ub2RlVHlwZSA9PT0gMSAmJiAoXCIgXCIgKyB0aGlzW2ldLmNsYXNzTmFtZSArIFwiIFwiKS5yZXBsYWNlKHJjbGFzcywgXCIgXCIpLmluZGV4T2YoIGNsYXNzTmFtZSApID49IDAgKSB7XG5cdFx0XHRcdHJldHVybiB0cnVlO1xuXHRcdFx0fVxuXHRcdH1cblxuXHRcdHJldHVybiBmYWxzZTtcblx0fVxufSk7XG5cblxuXG5cbnZhciBycmV0dXJuID0gL1xcci9nO1xuXG5qUXVlcnkuZm4uZXh0ZW5kKHtcblx0dmFsOiBmdW5jdGlvbiggdmFsdWUgKSB7XG5cdFx0dmFyIGhvb2tzLCByZXQsIGlzRnVuY3Rpb24sXG5cdFx0XHRlbGVtID0gdGhpc1swXTtcblxuXHRcdGlmICggIWFyZ3VtZW50cy5sZW5ndGggKSB7XG5cdFx0XHRpZiAoIGVsZW0gKSB7XG5cdFx0XHRcdGhvb2tzID0galF1ZXJ5LnZhbEhvb2tzWyBlbGVtLnR5cGUgXSB8fCBqUXVlcnkudmFsSG9va3NbIGVsZW0ubm9kZU5hbWUudG9Mb3dlckNhc2UoKSBdO1xuXG5cdFx0XHRcdGlmICggaG9va3MgJiYgXCJnZXRcIiBpbiBob29rcyAmJiAocmV0ID0gaG9va3MuZ2V0KCBlbGVtLCBcInZhbHVlXCIgKSkgIT09IHVuZGVmaW5lZCApIHtcblx0XHRcdFx0XHRyZXR1cm4gcmV0O1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0cmV0ID0gZWxlbS52YWx1ZTtcblxuXHRcdFx0XHRyZXR1cm4gdHlwZW9mIHJldCA9PT0gXCJzdHJpbmdcIiA/XG5cdFx0XHRcdFx0Ly8gSGFuZGxlIG1vc3QgY29tbW9uIHN0cmluZyBjYXNlc1xuXHRcdFx0XHRcdHJldC5yZXBsYWNlKHJyZXR1cm4sIFwiXCIpIDpcblx0XHRcdFx0XHQvLyBIYW5kbGUgY2FzZXMgd2hlcmUgdmFsdWUgaXMgbnVsbC91bmRlZiBvciBudW1iZXJcblx0XHRcdFx0XHRyZXQgPT0gbnVsbCA/IFwiXCIgOiByZXQ7XG5cdFx0XHR9XG5cblx0XHRcdHJldHVybjtcblx0XHR9XG5cblx0XHRpc0Z1bmN0aW9uID0galF1ZXJ5LmlzRnVuY3Rpb24oIHZhbHVlICk7XG5cblx0XHRyZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uKCBpICkge1xuXHRcdFx0dmFyIHZhbDtcblxuXHRcdFx0aWYgKCB0aGlzLm5vZGVUeXBlICE9PSAxICkge1xuXHRcdFx0XHRyZXR1cm47XG5cdFx0XHR9XG5cblx0XHRcdGlmICggaXNGdW5jdGlvbiApIHtcblx0XHRcdFx0dmFsID0gdmFsdWUuY2FsbCggdGhpcywgaSwgalF1ZXJ5KCB0aGlzICkudmFsKCkgKTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdHZhbCA9IHZhbHVlO1xuXHRcdFx0fVxuXG5cdFx0XHQvLyBUcmVhdCBudWxsL3VuZGVmaW5lZCBhcyBcIlwiOyBjb252ZXJ0IG51bWJlcnMgdG8gc3RyaW5nXG5cdFx0XHRpZiAoIHZhbCA9PSBudWxsICkge1xuXHRcdFx0XHR2YWwgPSBcIlwiO1xuXG5cdFx0XHR9IGVsc2UgaWYgKCB0eXBlb2YgdmFsID09PSBcIm51bWJlclwiICkge1xuXHRcdFx0XHR2YWwgKz0gXCJcIjtcblxuXHRcdFx0fSBlbHNlIGlmICggalF1ZXJ5LmlzQXJyYXkoIHZhbCApICkge1xuXHRcdFx0XHR2YWwgPSBqUXVlcnkubWFwKCB2YWwsIGZ1bmN0aW9uKCB2YWx1ZSApIHtcblx0XHRcdFx0XHRyZXR1cm4gdmFsdWUgPT0gbnVsbCA/IFwiXCIgOiB2YWx1ZSArIFwiXCI7XG5cdFx0XHRcdH0pO1xuXHRcdFx0fVxuXG5cdFx0XHRob29rcyA9IGpRdWVyeS52YWxIb29rc1sgdGhpcy50eXBlIF0gfHwgalF1ZXJ5LnZhbEhvb2tzWyB0aGlzLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCkgXTtcblxuXHRcdFx0Ly8gSWYgc2V0IHJldHVybnMgdW5kZWZpbmVkLCBmYWxsIGJhY2sgdG8gbm9ybWFsIHNldHRpbmdcblx0XHRcdGlmICggIWhvb2tzIHx8ICEoXCJzZXRcIiBpbiBob29rcykgfHwgaG9va3Muc2V0KCB0aGlzLCB2YWwsIFwidmFsdWVcIiApID09PSB1bmRlZmluZWQgKSB7XG5cdFx0XHRcdHRoaXMudmFsdWUgPSB2YWw7XG5cdFx0XHR9XG5cdFx0fSk7XG5cdH1cbn0pO1xuXG5qUXVlcnkuZXh0ZW5kKHtcblx0dmFsSG9va3M6IHtcblx0XHRvcHRpb246IHtcblx0XHRcdGdldDogZnVuY3Rpb24oIGVsZW0gKSB7XG5cdFx0XHRcdHZhciB2YWwgPSBqUXVlcnkuZmluZC5hdHRyKCBlbGVtLCBcInZhbHVlXCIgKTtcblx0XHRcdFx0cmV0dXJuIHZhbCAhPSBudWxsID9cblx0XHRcdFx0XHR2YWwgOlxuXHRcdFx0XHRcdC8vIFN1cHBvcnQ6IElFMTAtMTErXG5cdFx0XHRcdFx0Ly8gb3B0aW9uLnRleHQgdGhyb3dzIGV4Y2VwdGlvbnMgKCMxNDY4NiwgIzE0ODU4KVxuXHRcdFx0XHRcdGpRdWVyeS50cmltKCBqUXVlcnkudGV4dCggZWxlbSApICk7XG5cdFx0XHR9XG5cdFx0fSxcblx0XHRzZWxlY3Q6IHtcblx0XHRcdGdldDogZnVuY3Rpb24oIGVsZW0gKSB7XG5cdFx0XHRcdHZhciB2YWx1ZSwgb3B0aW9uLFxuXHRcdFx0XHRcdG9wdGlvbnMgPSBlbGVtLm9wdGlvbnMsXG5cdFx0XHRcdFx0aW5kZXggPSBlbGVtLnNlbGVjdGVkSW5kZXgsXG5cdFx0XHRcdFx0b25lID0gZWxlbS50eXBlID09PSBcInNlbGVjdC1vbmVcIiB8fCBpbmRleCA8IDAsXG5cdFx0XHRcdFx0dmFsdWVzID0gb25lID8gbnVsbCA6IFtdLFxuXHRcdFx0XHRcdG1heCA9IG9uZSA/IGluZGV4ICsgMSA6IG9wdGlvbnMubGVuZ3RoLFxuXHRcdFx0XHRcdGkgPSBpbmRleCA8IDAgP1xuXHRcdFx0XHRcdFx0bWF4IDpcblx0XHRcdFx0XHRcdG9uZSA/IGluZGV4IDogMDtcblxuXHRcdFx0XHQvLyBMb29wIHRocm91Z2ggYWxsIHRoZSBzZWxlY3RlZCBvcHRpb25zXG5cdFx0XHRcdGZvciAoIDsgaSA8IG1heDsgaSsrICkge1xuXHRcdFx0XHRcdG9wdGlvbiA9IG9wdGlvbnNbIGkgXTtcblxuXHRcdFx0XHRcdC8vIElFNi05IGRvZXNuJ3QgdXBkYXRlIHNlbGVjdGVkIGFmdGVyIGZvcm0gcmVzZXQgKCMyNTUxKVxuXHRcdFx0XHRcdGlmICggKCBvcHRpb24uc2VsZWN0ZWQgfHwgaSA9PT0gaW5kZXggKSAmJlxuXHRcdFx0XHRcdFx0XHQvLyBEb24ndCByZXR1cm4gb3B0aW9ucyB0aGF0IGFyZSBkaXNhYmxlZCBvciBpbiBhIGRpc2FibGVkIG9wdGdyb3VwXG5cdFx0XHRcdFx0XHRcdCggc3VwcG9ydC5vcHREaXNhYmxlZCA/ICFvcHRpb24uZGlzYWJsZWQgOiBvcHRpb24uZ2V0QXR0cmlidXRlKCBcImRpc2FibGVkXCIgKSA9PT0gbnVsbCApICYmXG5cdFx0XHRcdFx0XHRcdCggIW9wdGlvbi5wYXJlbnROb2RlLmRpc2FibGVkIHx8ICFqUXVlcnkubm9kZU5hbWUoIG9wdGlvbi5wYXJlbnROb2RlLCBcIm9wdGdyb3VwXCIgKSApICkge1xuXG5cdFx0XHRcdFx0XHQvLyBHZXQgdGhlIHNwZWNpZmljIHZhbHVlIGZvciB0aGUgb3B0aW9uXG5cdFx0XHRcdFx0XHR2YWx1ZSA9IGpRdWVyeSggb3B0aW9uICkudmFsKCk7XG5cblx0XHRcdFx0XHRcdC8vIFdlIGRvbid0IG5lZWQgYW4gYXJyYXkgZm9yIG9uZSBzZWxlY3RzXG5cdFx0XHRcdFx0XHRpZiAoIG9uZSApIHtcblx0XHRcdFx0XHRcdFx0cmV0dXJuIHZhbHVlO1xuXHRcdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0XHQvLyBNdWx0aS1TZWxlY3RzIHJldHVybiBhbiBhcnJheVxuXHRcdFx0XHRcdFx0dmFsdWVzLnB1c2goIHZhbHVlICk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cblx0XHRcdFx0cmV0dXJuIHZhbHVlcztcblx0XHRcdH0sXG5cblx0XHRcdHNldDogZnVuY3Rpb24oIGVsZW0sIHZhbHVlICkge1xuXHRcdFx0XHR2YXIgb3B0aW9uU2V0LCBvcHRpb24sXG5cdFx0XHRcdFx0b3B0aW9ucyA9IGVsZW0ub3B0aW9ucyxcblx0XHRcdFx0XHR2YWx1ZXMgPSBqUXVlcnkubWFrZUFycmF5KCB2YWx1ZSApLFxuXHRcdFx0XHRcdGkgPSBvcHRpb25zLmxlbmd0aDtcblxuXHRcdFx0XHR3aGlsZSAoIGktLSApIHtcblx0XHRcdFx0XHRvcHRpb24gPSBvcHRpb25zWyBpIF07XG5cdFx0XHRcdFx0aWYgKCAob3B0aW9uLnNlbGVjdGVkID0galF1ZXJ5LmluQXJyYXkoIG9wdGlvbi52YWx1ZSwgdmFsdWVzICkgPj0gMCkgKSB7XG5cdFx0XHRcdFx0XHRvcHRpb25TZXQgPSB0cnVlO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXG5cdFx0XHRcdC8vIEZvcmNlIGJyb3dzZXJzIHRvIGJlaGF2ZSBjb25zaXN0ZW50bHkgd2hlbiBub24tbWF0Y2hpbmcgdmFsdWUgaXMgc2V0XG5cdFx0XHRcdGlmICggIW9wdGlvblNldCApIHtcblx0XHRcdFx0XHRlbGVtLnNlbGVjdGVkSW5kZXggPSAtMTtcblx0XHRcdFx0fVxuXHRcdFx0XHRyZXR1cm4gdmFsdWVzO1xuXHRcdFx0fVxuXHRcdH1cblx0fVxufSk7XG5cbi8vIFJhZGlvcyBhbmQgY2hlY2tib3hlcyBnZXR0ZXIvc2V0dGVyXG5qUXVlcnkuZWFjaChbIFwicmFkaW9cIiwgXCJjaGVja2JveFwiIF0sIGZ1bmN0aW9uKCkge1xuXHRqUXVlcnkudmFsSG9va3NbIHRoaXMgXSA9IHtcblx0XHRzZXQ6IGZ1bmN0aW9uKCBlbGVtLCB2YWx1ZSApIHtcblx0XHRcdGlmICggalF1ZXJ5LmlzQXJyYXkoIHZhbHVlICkgKSB7XG5cdFx0XHRcdHJldHVybiAoIGVsZW0uY2hlY2tlZCA9IGpRdWVyeS5pbkFycmF5KCBqUXVlcnkoZWxlbSkudmFsKCksIHZhbHVlICkgPj0gMCApO1xuXHRcdFx0fVxuXHRcdH1cblx0fTtcblx0aWYgKCAhc3VwcG9ydC5jaGVja09uICkge1xuXHRcdGpRdWVyeS52YWxIb29rc1sgdGhpcyBdLmdldCA9IGZ1bmN0aW9uKCBlbGVtICkge1xuXHRcdFx0cmV0dXJuIGVsZW0uZ2V0QXR0cmlidXRlKFwidmFsdWVcIikgPT09IG51bGwgPyBcIm9uXCIgOiBlbGVtLnZhbHVlO1xuXHRcdH07XG5cdH1cbn0pO1xuXG5cblxuXG4vLyBSZXR1cm4galF1ZXJ5IGZvciBhdHRyaWJ1dGVzLW9ubHkgaW5jbHVzaW9uXG5cblxualF1ZXJ5LmVhY2goIChcImJsdXIgZm9jdXMgZm9jdXNpbiBmb2N1c291dCBsb2FkIHJlc2l6ZSBzY3JvbGwgdW5sb2FkIGNsaWNrIGRibGNsaWNrIFwiICtcblx0XCJtb3VzZWRvd24gbW91c2V1cCBtb3VzZW1vdmUgbW91c2VvdmVyIG1vdXNlb3V0IG1vdXNlZW50ZXIgbW91c2VsZWF2ZSBcIiArXG5cdFwiY2hhbmdlIHNlbGVjdCBzdWJtaXQga2V5ZG93biBrZXlwcmVzcyBrZXl1cCBlcnJvciBjb250ZXh0bWVudVwiKS5zcGxpdChcIiBcIiksIGZ1bmN0aW9uKCBpLCBuYW1lICkge1xuXG5cdC8vIEhhbmRsZSBldmVudCBiaW5kaW5nXG5cdGpRdWVyeS5mblsgbmFtZSBdID0gZnVuY3Rpb24oIGRhdGEsIGZuICkge1xuXHRcdHJldHVybiBhcmd1bWVudHMubGVuZ3RoID4gMCA/XG5cdFx0XHR0aGlzLm9uKCBuYW1lLCBudWxsLCBkYXRhLCBmbiApIDpcblx0XHRcdHRoaXMudHJpZ2dlciggbmFtZSApO1xuXHR9O1xufSk7XG5cbmpRdWVyeS5mbi5leHRlbmQoe1xuXHRob3ZlcjogZnVuY3Rpb24oIGZuT3ZlciwgZm5PdXQgKSB7XG5cdFx0cmV0dXJuIHRoaXMubW91c2VlbnRlciggZm5PdmVyICkubW91c2VsZWF2ZSggZm5PdXQgfHwgZm5PdmVyICk7XG5cdH0sXG5cblx0YmluZDogZnVuY3Rpb24oIHR5cGVzLCBkYXRhLCBmbiApIHtcblx0XHRyZXR1cm4gdGhpcy5vbiggdHlwZXMsIG51bGwsIGRhdGEsIGZuICk7XG5cdH0sXG5cdHVuYmluZDogZnVuY3Rpb24oIHR5cGVzLCBmbiApIHtcblx0XHRyZXR1cm4gdGhpcy5vZmYoIHR5cGVzLCBudWxsLCBmbiApO1xuXHR9LFxuXG5cdGRlbGVnYXRlOiBmdW5jdGlvbiggc2VsZWN0b3IsIHR5cGVzLCBkYXRhLCBmbiApIHtcblx0XHRyZXR1cm4gdGhpcy5vbiggdHlwZXMsIHNlbGVjdG9yLCBkYXRhLCBmbiApO1xuXHR9LFxuXHR1bmRlbGVnYXRlOiBmdW5jdGlvbiggc2VsZWN0b3IsIHR5cGVzLCBmbiApIHtcblx0XHQvLyAoIG5hbWVzcGFjZSApIG9yICggc2VsZWN0b3IsIHR5cGVzIFssIGZuXSApXG5cdFx0cmV0dXJuIGFyZ3VtZW50cy5sZW5ndGggPT09IDEgPyB0aGlzLm9mZiggc2VsZWN0b3IsIFwiKipcIiApIDogdGhpcy5vZmYoIHR5cGVzLCBzZWxlY3RvciB8fCBcIioqXCIsIGZuICk7XG5cdH1cbn0pO1xuXG5cbnZhciBub25jZSA9IGpRdWVyeS5ub3coKTtcblxudmFyIHJxdWVyeSA9ICgvXFw/Lyk7XG5cblxuXG4vLyBTdXBwb3J0OiBBbmRyb2lkIDIuM1xuLy8gV29ya2Fyb3VuZCBmYWlsdXJlIHRvIHN0cmluZy1jYXN0IG51bGwgaW5wdXRcbmpRdWVyeS5wYXJzZUpTT04gPSBmdW5jdGlvbiggZGF0YSApIHtcblx0cmV0dXJuIEpTT04ucGFyc2UoIGRhdGEgKyBcIlwiICk7XG59O1xuXG5cbi8vIENyb3NzLWJyb3dzZXIgeG1sIHBhcnNpbmdcbmpRdWVyeS5wYXJzZVhNTCA9IGZ1bmN0aW9uKCBkYXRhICkge1xuXHR2YXIgeG1sLCB0bXA7XG5cdGlmICggIWRhdGEgfHwgdHlwZW9mIGRhdGEgIT09IFwic3RyaW5nXCIgKSB7XG5cdFx0cmV0dXJuIG51bGw7XG5cdH1cblxuXHQvLyBTdXBwb3J0OiBJRTlcblx0dHJ5IHtcblx0XHR0bXAgPSBuZXcgRE9NUGFyc2VyKCk7XG5cdFx0eG1sID0gdG1wLnBhcnNlRnJvbVN0cmluZyggZGF0YSwgXCJ0ZXh0L3htbFwiICk7XG5cdH0gY2F0Y2ggKCBlICkge1xuXHRcdHhtbCA9IHVuZGVmaW5lZDtcblx0fVxuXG5cdGlmICggIXhtbCB8fCB4bWwuZ2V0RWxlbWVudHNCeVRhZ05hbWUoIFwicGFyc2VyZXJyb3JcIiApLmxlbmd0aCApIHtcblx0XHRqUXVlcnkuZXJyb3IoIFwiSW52YWxpZCBYTUw6IFwiICsgZGF0YSApO1xuXHR9XG5cdHJldHVybiB4bWw7XG59O1xuXG5cbnZhclxuXHRyaGFzaCA9IC8jLiokLyxcblx0cnRzID0gLyhbPyZdKV89W14mXSovLFxuXHRyaGVhZGVycyA9IC9eKC4qPyk6WyBcXHRdKihbXlxcclxcbl0qKSQvbWcsXG5cdC8vICM3NjUzLCAjODEyNSwgIzgxNTI6IGxvY2FsIHByb3RvY29sIGRldGVjdGlvblxuXHRybG9jYWxQcm90b2NvbCA9IC9eKD86YWJvdXR8YXBwfGFwcC1zdG9yYWdlfC4rLWV4dGVuc2lvbnxmaWxlfHJlc3x3aWRnZXQpOiQvLFxuXHRybm9Db250ZW50ID0gL14oPzpHRVR8SEVBRCkkLyxcblx0cnByb3RvY29sID0gL15cXC9cXC8vLFxuXHRydXJsID0gL14oW1xcdy4rLV0rOikoPzpcXC9cXC8oPzpbXlxcLz8jXSpAfCkoW15cXC8/IzpdKikoPzo6KFxcZCspfCl8KS8sXG5cblx0LyogUHJlZmlsdGVyc1xuXHQgKiAxKSBUaGV5IGFyZSB1c2VmdWwgdG8gaW50cm9kdWNlIGN1c3RvbSBkYXRhVHlwZXMgKHNlZSBhamF4L2pzb25wLmpzIGZvciBhbiBleGFtcGxlKVxuXHQgKiAyKSBUaGVzZSBhcmUgY2FsbGVkOlxuXHQgKiAgICAtIEJFRk9SRSBhc2tpbmcgZm9yIGEgdHJhbnNwb3J0XG5cdCAqICAgIC0gQUZURVIgcGFyYW0gc2VyaWFsaXphdGlvbiAocy5kYXRhIGlzIGEgc3RyaW5nIGlmIHMucHJvY2Vzc0RhdGEgaXMgdHJ1ZSlcblx0ICogMykga2V5IGlzIHRoZSBkYXRhVHlwZVxuXHQgKiA0KSB0aGUgY2F0Y2hhbGwgc3ltYm9sIFwiKlwiIGNhbiBiZSB1c2VkXG5cdCAqIDUpIGV4ZWN1dGlvbiB3aWxsIHN0YXJ0IHdpdGggdHJhbnNwb3J0IGRhdGFUeXBlIGFuZCBUSEVOIGNvbnRpbnVlIGRvd24gdG8gXCIqXCIgaWYgbmVlZGVkXG5cdCAqL1xuXHRwcmVmaWx0ZXJzID0ge30sXG5cblx0LyogVHJhbnNwb3J0cyBiaW5kaW5nc1xuXHQgKiAxKSBrZXkgaXMgdGhlIGRhdGFUeXBlXG5cdCAqIDIpIHRoZSBjYXRjaGFsbCBzeW1ib2wgXCIqXCIgY2FuIGJlIHVzZWRcblx0ICogMykgc2VsZWN0aW9uIHdpbGwgc3RhcnQgd2l0aCB0cmFuc3BvcnQgZGF0YVR5cGUgYW5kIFRIRU4gZ28gdG8gXCIqXCIgaWYgbmVlZGVkXG5cdCAqL1xuXHR0cmFuc3BvcnRzID0ge30sXG5cblx0Ly8gQXZvaWQgY29tbWVudC1wcm9sb2cgY2hhciBzZXF1ZW5jZSAoIzEwMDk4KTsgbXVzdCBhcHBlYXNlIGxpbnQgYW5kIGV2YWRlIGNvbXByZXNzaW9uXG5cdGFsbFR5cGVzID0gXCIqL1wiLmNvbmNhdCggXCIqXCIgKSxcblxuXHQvLyBEb2N1bWVudCBsb2NhdGlvblxuXHRhamF4TG9jYXRpb24gPSB3aW5kb3cubG9jYXRpb24uaHJlZixcblxuXHQvLyBTZWdtZW50IGxvY2F0aW9uIGludG8gcGFydHNcblx0YWpheExvY1BhcnRzID0gcnVybC5leGVjKCBhamF4TG9jYXRpb24udG9Mb3dlckNhc2UoKSApIHx8IFtdO1xuXG4vLyBCYXNlIFwiY29uc3RydWN0b3JcIiBmb3IgalF1ZXJ5LmFqYXhQcmVmaWx0ZXIgYW5kIGpRdWVyeS5hamF4VHJhbnNwb3J0XG5mdW5jdGlvbiBhZGRUb1ByZWZpbHRlcnNPclRyYW5zcG9ydHMoIHN0cnVjdHVyZSApIHtcblxuXHQvLyBkYXRhVHlwZUV4cHJlc3Npb24gaXMgb3B0aW9uYWwgYW5kIGRlZmF1bHRzIHRvIFwiKlwiXG5cdHJldHVybiBmdW5jdGlvbiggZGF0YVR5cGVFeHByZXNzaW9uLCBmdW5jICkge1xuXG5cdFx0aWYgKCB0eXBlb2YgZGF0YVR5cGVFeHByZXNzaW9uICE9PSBcInN0cmluZ1wiICkge1xuXHRcdFx0ZnVuYyA9IGRhdGFUeXBlRXhwcmVzc2lvbjtcblx0XHRcdGRhdGFUeXBlRXhwcmVzc2lvbiA9IFwiKlwiO1xuXHRcdH1cblxuXHRcdHZhciBkYXRhVHlwZSxcblx0XHRcdGkgPSAwLFxuXHRcdFx0ZGF0YVR5cGVzID0gZGF0YVR5cGVFeHByZXNzaW9uLnRvTG93ZXJDYXNlKCkubWF0Y2goIHJub3R3aGl0ZSApIHx8IFtdO1xuXG5cdFx0aWYgKCBqUXVlcnkuaXNGdW5jdGlvbiggZnVuYyApICkge1xuXHRcdFx0Ly8gRm9yIGVhY2ggZGF0YVR5cGUgaW4gdGhlIGRhdGFUeXBlRXhwcmVzc2lvblxuXHRcdFx0d2hpbGUgKCAoZGF0YVR5cGUgPSBkYXRhVHlwZXNbaSsrXSkgKSB7XG5cdFx0XHRcdC8vIFByZXBlbmQgaWYgcmVxdWVzdGVkXG5cdFx0XHRcdGlmICggZGF0YVR5cGVbMF0gPT09IFwiK1wiICkge1xuXHRcdFx0XHRcdGRhdGFUeXBlID0gZGF0YVR5cGUuc2xpY2UoIDEgKSB8fCBcIipcIjtcblx0XHRcdFx0XHQoc3RydWN0dXJlWyBkYXRhVHlwZSBdID0gc3RydWN0dXJlWyBkYXRhVHlwZSBdIHx8IFtdKS51bnNoaWZ0KCBmdW5jICk7XG5cblx0XHRcdFx0Ly8gT3RoZXJ3aXNlIGFwcGVuZFxuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdChzdHJ1Y3R1cmVbIGRhdGFUeXBlIF0gPSBzdHJ1Y3R1cmVbIGRhdGFUeXBlIF0gfHwgW10pLnB1c2goIGZ1bmMgKTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH1cblx0fTtcbn1cblxuLy8gQmFzZSBpbnNwZWN0aW9uIGZ1bmN0aW9uIGZvciBwcmVmaWx0ZXJzIGFuZCB0cmFuc3BvcnRzXG5mdW5jdGlvbiBpbnNwZWN0UHJlZmlsdGVyc09yVHJhbnNwb3J0cyggc3RydWN0dXJlLCBvcHRpb25zLCBvcmlnaW5hbE9wdGlvbnMsIGpxWEhSICkge1xuXG5cdHZhciBpbnNwZWN0ZWQgPSB7fSxcblx0XHRzZWVraW5nVHJhbnNwb3J0ID0gKCBzdHJ1Y3R1cmUgPT09IHRyYW5zcG9ydHMgKTtcblxuXHRmdW5jdGlvbiBpbnNwZWN0KCBkYXRhVHlwZSApIHtcblx0XHR2YXIgc2VsZWN0ZWQ7XG5cdFx0aW5zcGVjdGVkWyBkYXRhVHlwZSBdID0gdHJ1ZTtcblx0XHRqUXVlcnkuZWFjaCggc3RydWN0dXJlWyBkYXRhVHlwZSBdIHx8IFtdLCBmdW5jdGlvbiggXywgcHJlZmlsdGVyT3JGYWN0b3J5ICkge1xuXHRcdFx0dmFyIGRhdGFUeXBlT3JUcmFuc3BvcnQgPSBwcmVmaWx0ZXJPckZhY3RvcnkoIG9wdGlvbnMsIG9yaWdpbmFsT3B0aW9ucywganFYSFIgKTtcblx0XHRcdGlmICggdHlwZW9mIGRhdGFUeXBlT3JUcmFuc3BvcnQgPT09IFwic3RyaW5nXCIgJiYgIXNlZWtpbmdUcmFuc3BvcnQgJiYgIWluc3BlY3RlZFsgZGF0YVR5cGVPclRyYW5zcG9ydCBdICkge1xuXHRcdFx0XHRvcHRpb25zLmRhdGFUeXBlcy51bnNoaWZ0KCBkYXRhVHlwZU9yVHJhbnNwb3J0ICk7XG5cdFx0XHRcdGluc3BlY3QoIGRhdGFUeXBlT3JUcmFuc3BvcnQgKTtcblx0XHRcdFx0cmV0dXJuIGZhbHNlO1xuXHRcdFx0fSBlbHNlIGlmICggc2Vla2luZ1RyYW5zcG9ydCApIHtcblx0XHRcdFx0cmV0dXJuICEoIHNlbGVjdGVkID0gZGF0YVR5cGVPclRyYW5zcG9ydCApO1xuXHRcdFx0fVxuXHRcdH0pO1xuXHRcdHJldHVybiBzZWxlY3RlZDtcblx0fVxuXG5cdHJldHVybiBpbnNwZWN0KCBvcHRpb25zLmRhdGFUeXBlc1sgMCBdICkgfHwgIWluc3BlY3RlZFsgXCIqXCIgXSAmJiBpbnNwZWN0KCBcIipcIiApO1xufVxuXG4vLyBBIHNwZWNpYWwgZXh0ZW5kIGZvciBhamF4IG9wdGlvbnNcbi8vIHRoYXQgdGFrZXMgXCJmbGF0XCIgb3B0aW9ucyAobm90IHRvIGJlIGRlZXAgZXh0ZW5kZWQpXG4vLyBGaXhlcyAjOTg4N1xuZnVuY3Rpb24gYWpheEV4dGVuZCggdGFyZ2V0LCBzcmMgKSB7XG5cdHZhciBrZXksIGRlZXAsXG5cdFx0ZmxhdE9wdGlvbnMgPSBqUXVlcnkuYWpheFNldHRpbmdzLmZsYXRPcHRpb25zIHx8IHt9O1xuXG5cdGZvciAoIGtleSBpbiBzcmMgKSB7XG5cdFx0aWYgKCBzcmNbIGtleSBdICE9PSB1bmRlZmluZWQgKSB7XG5cdFx0XHQoIGZsYXRPcHRpb25zWyBrZXkgXSA/IHRhcmdldCA6ICggZGVlcCB8fCAoZGVlcCA9IHt9KSApIClbIGtleSBdID0gc3JjWyBrZXkgXTtcblx0XHR9XG5cdH1cblx0aWYgKCBkZWVwICkge1xuXHRcdGpRdWVyeS5leHRlbmQoIHRydWUsIHRhcmdldCwgZGVlcCApO1xuXHR9XG5cblx0cmV0dXJuIHRhcmdldDtcbn1cblxuLyogSGFuZGxlcyByZXNwb25zZXMgdG8gYW4gYWpheCByZXF1ZXN0OlxuICogLSBmaW5kcyB0aGUgcmlnaHQgZGF0YVR5cGUgKG1lZGlhdGVzIGJldHdlZW4gY29udGVudC10eXBlIGFuZCBleHBlY3RlZCBkYXRhVHlwZSlcbiAqIC0gcmV0dXJucyB0aGUgY29ycmVzcG9uZGluZyByZXNwb25zZVxuICovXG5mdW5jdGlvbiBhamF4SGFuZGxlUmVzcG9uc2VzKCBzLCBqcVhIUiwgcmVzcG9uc2VzICkge1xuXG5cdHZhciBjdCwgdHlwZSwgZmluYWxEYXRhVHlwZSwgZmlyc3REYXRhVHlwZSxcblx0XHRjb250ZW50cyA9IHMuY29udGVudHMsXG5cdFx0ZGF0YVR5cGVzID0gcy5kYXRhVHlwZXM7XG5cblx0Ly8gUmVtb3ZlIGF1dG8gZGF0YVR5cGUgYW5kIGdldCBjb250ZW50LXR5cGUgaW4gdGhlIHByb2Nlc3Ncblx0d2hpbGUgKCBkYXRhVHlwZXNbIDAgXSA9PT0gXCIqXCIgKSB7XG5cdFx0ZGF0YVR5cGVzLnNoaWZ0KCk7XG5cdFx0aWYgKCBjdCA9PT0gdW5kZWZpbmVkICkge1xuXHRcdFx0Y3QgPSBzLm1pbWVUeXBlIHx8IGpxWEhSLmdldFJlc3BvbnNlSGVhZGVyKFwiQ29udGVudC1UeXBlXCIpO1xuXHRcdH1cblx0fVxuXG5cdC8vIENoZWNrIGlmIHdlJ3JlIGRlYWxpbmcgd2l0aCBhIGtub3duIGNvbnRlbnQtdHlwZVxuXHRpZiAoIGN0ICkge1xuXHRcdGZvciAoIHR5cGUgaW4gY29udGVudHMgKSB7XG5cdFx0XHRpZiAoIGNvbnRlbnRzWyB0eXBlIF0gJiYgY29udGVudHNbIHR5cGUgXS50ZXN0KCBjdCApICkge1xuXHRcdFx0XHRkYXRhVHlwZXMudW5zaGlmdCggdHlwZSApO1xuXHRcdFx0XHRicmVhaztcblx0XHRcdH1cblx0XHR9XG5cdH1cblxuXHQvLyBDaGVjayB0byBzZWUgaWYgd2UgaGF2ZSBhIHJlc3BvbnNlIGZvciB0aGUgZXhwZWN0ZWQgZGF0YVR5cGVcblx0aWYgKCBkYXRhVHlwZXNbIDAgXSBpbiByZXNwb25zZXMgKSB7XG5cdFx0ZmluYWxEYXRhVHlwZSA9IGRhdGFUeXBlc1sgMCBdO1xuXHR9IGVsc2Uge1xuXHRcdC8vIFRyeSBjb252ZXJ0aWJsZSBkYXRhVHlwZXNcblx0XHRmb3IgKCB0eXBlIGluIHJlc3BvbnNlcyApIHtcblx0XHRcdGlmICggIWRhdGFUeXBlc1sgMCBdIHx8IHMuY29udmVydGVyc1sgdHlwZSArIFwiIFwiICsgZGF0YVR5cGVzWzBdIF0gKSB7XG5cdFx0XHRcdGZpbmFsRGF0YVR5cGUgPSB0eXBlO1xuXHRcdFx0XHRicmVhaztcblx0XHRcdH1cblx0XHRcdGlmICggIWZpcnN0RGF0YVR5cGUgKSB7XG5cdFx0XHRcdGZpcnN0RGF0YVR5cGUgPSB0eXBlO1xuXHRcdFx0fVxuXHRcdH1cblx0XHQvLyBPciBqdXN0IHVzZSBmaXJzdCBvbmVcblx0XHRmaW5hbERhdGFUeXBlID0gZmluYWxEYXRhVHlwZSB8fCBmaXJzdERhdGFUeXBlO1xuXHR9XG5cblx0Ly8gSWYgd2UgZm91bmQgYSBkYXRhVHlwZVxuXHQvLyBXZSBhZGQgdGhlIGRhdGFUeXBlIHRvIHRoZSBsaXN0IGlmIG5lZWRlZFxuXHQvLyBhbmQgcmV0dXJuIHRoZSBjb3JyZXNwb25kaW5nIHJlc3BvbnNlXG5cdGlmICggZmluYWxEYXRhVHlwZSApIHtcblx0XHRpZiAoIGZpbmFsRGF0YVR5cGUgIT09IGRhdGFUeXBlc1sgMCBdICkge1xuXHRcdFx0ZGF0YVR5cGVzLnVuc2hpZnQoIGZpbmFsRGF0YVR5cGUgKTtcblx0XHR9XG5cdFx0cmV0dXJuIHJlc3BvbnNlc1sgZmluYWxEYXRhVHlwZSBdO1xuXHR9XG59XG5cbi8qIENoYWluIGNvbnZlcnNpb25zIGdpdmVuIHRoZSByZXF1ZXN0IGFuZCB0aGUgb3JpZ2luYWwgcmVzcG9uc2VcbiAqIEFsc28gc2V0cyB0aGUgcmVzcG9uc2VYWFggZmllbGRzIG9uIHRoZSBqcVhIUiBpbnN0YW5jZVxuICovXG5mdW5jdGlvbiBhamF4Q29udmVydCggcywgcmVzcG9uc2UsIGpxWEhSLCBpc1N1Y2Nlc3MgKSB7XG5cdHZhciBjb252MiwgY3VycmVudCwgY29udiwgdG1wLCBwcmV2LFxuXHRcdGNvbnZlcnRlcnMgPSB7fSxcblx0XHQvLyBXb3JrIHdpdGggYSBjb3B5IG9mIGRhdGFUeXBlcyBpbiBjYXNlIHdlIG5lZWQgdG8gbW9kaWZ5IGl0IGZvciBjb252ZXJzaW9uXG5cdFx0ZGF0YVR5cGVzID0gcy5kYXRhVHlwZXMuc2xpY2UoKTtcblxuXHQvLyBDcmVhdGUgY29udmVydGVycyBtYXAgd2l0aCBsb3dlcmNhc2VkIGtleXNcblx0aWYgKCBkYXRhVHlwZXNbIDEgXSApIHtcblx0XHRmb3IgKCBjb252IGluIHMuY29udmVydGVycyApIHtcblx0XHRcdGNvbnZlcnRlcnNbIGNvbnYudG9Mb3dlckNhc2UoKSBdID0gcy5jb252ZXJ0ZXJzWyBjb252IF07XG5cdFx0fVxuXHR9XG5cblx0Y3VycmVudCA9IGRhdGFUeXBlcy5zaGlmdCgpO1xuXG5cdC8vIENvbnZlcnQgdG8gZWFjaCBzZXF1ZW50aWFsIGRhdGFUeXBlXG5cdHdoaWxlICggY3VycmVudCApIHtcblxuXHRcdGlmICggcy5yZXNwb25zZUZpZWxkc1sgY3VycmVudCBdICkge1xuXHRcdFx0anFYSFJbIHMucmVzcG9uc2VGaWVsZHNbIGN1cnJlbnQgXSBdID0gcmVzcG9uc2U7XG5cdFx0fVxuXG5cdFx0Ly8gQXBwbHkgdGhlIGRhdGFGaWx0ZXIgaWYgcHJvdmlkZWRcblx0XHRpZiAoICFwcmV2ICYmIGlzU3VjY2VzcyAmJiBzLmRhdGFGaWx0ZXIgKSB7XG5cdFx0XHRyZXNwb25zZSA9IHMuZGF0YUZpbHRlciggcmVzcG9uc2UsIHMuZGF0YVR5cGUgKTtcblx0XHR9XG5cblx0XHRwcmV2ID0gY3VycmVudDtcblx0XHRjdXJyZW50ID0gZGF0YVR5cGVzLnNoaWZ0KCk7XG5cblx0XHRpZiAoIGN1cnJlbnQgKSB7XG5cblx0XHQvLyBUaGVyZSdzIG9ubHkgd29yayB0byBkbyBpZiBjdXJyZW50IGRhdGFUeXBlIGlzIG5vbi1hdXRvXG5cdFx0XHRpZiAoIGN1cnJlbnQgPT09IFwiKlwiICkge1xuXG5cdFx0XHRcdGN1cnJlbnQgPSBwcmV2O1xuXG5cdFx0XHQvLyBDb252ZXJ0IHJlc3BvbnNlIGlmIHByZXYgZGF0YVR5cGUgaXMgbm9uLWF1dG8gYW5kIGRpZmZlcnMgZnJvbSBjdXJyZW50XG5cdFx0XHR9IGVsc2UgaWYgKCBwcmV2ICE9PSBcIipcIiAmJiBwcmV2ICE9PSBjdXJyZW50ICkge1xuXG5cdFx0XHRcdC8vIFNlZWsgYSBkaXJlY3QgY29udmVydGVyXG5cdFx0XHRcdGNvbnYgPSBjb252ZXJ0ZXJzWyBwcmV2ICsgXCIgXCIgKyBjdXJyZW50IF0gfHwgY29udmVydGVyc1sgXCIqIFwiICsgY3VycmVudCBdO1xuXG5cdFx0XHRcdC8vIElmIG5vbmUgZm91bmQsIHNlZWsgYSBwYWlyXG5cdFx0XHRcdGlmICggIWNvbnYgKSB7XG5cdFx0XHRcdFx0Zm9yICggY29udjIgaW4gY29udmVydGVycyApIHtcblxuXHRcdFx0XHRcdFx0Ly8gSWYgY29udjIgb3V0cHV0cyBjdXJyZW50XG5cdFx0XHRcdFx0XHR0bXAgPSBjb252Mi5zcGxpdCggXCIgXCIgKTtcblx0XHRcdFx0XHRcdGlmICggdG1wWyAxIF0gPT09IGN1cnJlbnQgKSB7XG5cblx0XHRcdFx0XHRcdFx0Ly8gSWYgcHJldiBjYW4gYmUgY29udmVydGVkIHRvIGFjY2VwdGVkIGlucHV0XG5cdFx0XHRcdFx0XHRcdGNvbnYgPSBjb252ZXJ0ZXJzWyBwcmV2ICsgXCIgXCIgKyB0bXBbIDAgXSBdIHx8XG5cdFx0XHRcdFx0XHRcdFx0Y29udmVydGVyc1sgXCIqIFwiICsgdG1wWyAwIF0gXTtcblx0XHRcdFx0XHRcdFx0aWYgKCBjb252ICkge1xuXHRcdFx0XHRcdFx0XHRcdC8vIENvbmRlbnNlIGVxdWl2YWxlbmNlIGNvbnZlcnRlcnNcblx0XHRcdFx0XHRcdFx0XHRpZiAoIGNvbnYgPT09IHRydWUgKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRjb252ID0gY29udmVydGVyc1sgY29udjIgXTtcblxuXHRcdFx0XHRcdFx0XHRcdC8vIE90aGVyd2lzZSwgaW5zZXJ0IHRoZSBpbnRlcm1lZGlhdGUgZGF0YVR5cGVcblx0XHRcdFx0XHRcdFx0XHR9IGVsc2UgaWYgKCBjb252ZXJ0ZXJzWyBjb252MiBdICE9PSB0cnVlICkge1xuXHRcdFx0XHRcdFx0XHRcdFx0Y3VycmVudCA9IHRtcFsgMCBdO1xuXHRcdFx0XHRcdFx0XHRcdFx0ZGF0YVR5cGVzLnVuc2hpZnQoIHRtcFsgMSBdICk7XG5cdFx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cblx0XHRcdFx0Ly8gQXBwbHkgY29udmVydGVyIChpZiBub3QgYW4gZXF1aXZhbGVuY2UpXG5cdFx0XHRcdGlmICggY29udiAhPT0gdHJ1ZSApIHtcblxuXHRcdFx0XHRcdC8vIFVubGVzcyBlcnJvcnMgYXJlIGFsbG93ZWQgdG8gYnViYmxlLCBjYXRjaCBhbmQgcmV0dXJuIHRoZW1cblx0XHRcdFx0XHRpZiAoIGNvbnYgJiYgc1sgXCJ0aHJvd3NcIiBdICkge1xuXHRcdFx0XHRcdFx0cmVzcG9uc2UgPSBjb252KCByZXNwb25zZSApO1xuXHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHR0cnkge1xuXHRcdFx0XHRcdFx0XHRyZXNwb25zZSA9IGNvbnYoIHJlc3BvbnNlICk7XG5cdFx0XHRcdFx0XHR9IGNhdGNoICggZSApIHtcblx0XHRcdFx0XHRcdFx0cmV0dXJuIHsgc3RhdGU6IFwicGFyc2VyZXJyb3JcIiwgZXJyb3I6IGNvbnYgPyBlIDogXCJObyBjb252ZXJzaW9uIGZyb20gXCIgKyBwcmV2ICsgXCIgdG8gXCIgKyBjdXJyZW50IH07XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fVxuXHR9XG5cblx0cmV0dXJuIHsgc3RhdGU6IFwic3VjY2Vzc1wiLCBkYXRhOiByZXNwb25zZSB9O1xufVxuXG5qUXVlcnkuZXh0ZW5kKHtcblxuXHQvLyBDb3VudGVyIGZvciBob2xkaW5nIHRoZSBudW1iZXIgb2YgYWN0aXZlIHF1ZXJpZXNcblx0YWN0aXZlOiAwLFxuXG5cdC8vIExhc3QtTW9kaWZpZWQgaGVhZGVyIGNhY2hlIGZvciBuZXh0IHJlcXVlc3Rcblx0bGFzdE1vZGlmaWVkOiB7fSxcblx0ZXRhZzoge30sXG5cblx0YWpheFNldHRpbmdzOiB7XG5cdFx0dXJsOiBhamF4TG9jYXRpb24sXG5cdFx0dHlwZTogXCJHRVRcIixcblx0XHRpc0xvY2FsOiBybG9jYWxQcm90b2NvbC50ZXN0KCBhamF4TG9jUGFydHNbIDEgXSApLFxuXHRcdGdsb2JhbDogdHJ1ZSxcblx0XHRwcm9jZXNzRGF0YTogdHJ1ZSxcblx0XHRhc3luYzogdHJ1ZSxcblx0XHRjb250ZW50VHlwZTogXCJhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQ7IGNoYXJzZXQ9VVRGLThcIixcblx0XHQvKlxuXHRcdHRpbWVvdXQ6IDAsXG5cdFx0ZGF0YTogbnVsbCxcblx0XHRkYXRhVHlwZTogbnVsbCxcblx0XHR1c2VybmFtZTogbnVsbCxcblx0XHRwYXNzd29yZDogbnVsbCxcblx0XHRjYWNoZTogbnVsbCxcblx0XHR0aHJvd3M6IGZhbHNlLFxuXHRcdHRyYWRpdGlvbmFsOiBmYWxzZSxcblx0XHRoZWFkZXJzOiB7fSxcblx0XHQqL1xuXG5cdFx0YWNjZXB0czoge1xuXHRcdFx0XCIqXCI6IGFsbFR5cGVzLFxuXHRcdFx0dGV4dDogXCJ0ZXh0L3BsYWluXCIsXG5cdFx0XHRodG1sOiBcInRleHQvaHRtbFwiLFxuXHRcdFx0eG1sOiBcImFwcGxpY2F0aW9uL3htbCwgdGV4dC94bWxcIixcblx0XHRcdGpzb246IFwiYXBwbGljYXRpb24vanNvbiwgdGV4dC9qYXZhc2NyaXB0XCJcblx0XHR9LFxuXG5cdFx0Y29udGVudHM6IHtcblx0XHRcdHhtbDogL3htbC8sXG5cdFx0XHRodG1sOiAvaHRtbC8sXG5cdFx0XHRqc29uOiAvanNvbi9cblx0XHR9LFxuXG5cdFx0cmVzcG9uc2VGaWVsZHM6IHtcblx0XHRcdHhtbDogXCJyZXNwb25zZVhNTFwiLFxuXHRcdFx0dGV4dDogXCJyZXNwb25zZVRleHRcIixcblx0XHRcdGpzb246IFwicmVzcG9uc2VKU09OXCJcblx0XHR9LFxuXG5cdFx0Ly8gRGF0YSBjb252ZXJ0ZXJzXG5cdFx0Ly8gS2V5cyBzZXBhcmF0ZSBzb3VyY2UgKG9yIGNhdGNoYWxsIFwiKlwiKSBhbmQgZGVzdGluYXRpb24gdHlwZXMgd2l0aCBhIHNpbmdsZSBzcGFjZVxuXHRcdGNvbnZlcnRlcnM6IHtcblxuXHRcdFx0Ly8gQ29udmVydCBhbnl0aGluZyB0byB0ZXh0XG5cdFx0XHRcIiogdGV4dFwiOiBTdHJpbmcsXG5cblx0XHRcdC8vIFRleHQgdG8gaHRtbCAodHJ1ZSA9IG5vIHRyYW5zZm9ybWF0aW9uKVxuXHRcdFx0XCJ0ZXh0IGh0bWxcIjogdHJ1ZSxcblxuXHRcdFx0Ly8gRXZhbHVhdGUgdGV4dCBhcyBhIGpzb24gZXhwcmVzc2lvblxuXHRcdFx0XCJ0ZXh0IGpzb25cIjogalF1ZXJ5LnBhcnNlSlNPTixcblxuXHRcdFx0Ly8gUGFyc2UgdGV4dCBhcyB4bWxcblx0XHRcdFwidGV4dCB4bWxcIjogalF1ZXJ5LnBhcnNlWE1MXG5cdFx0fSxcblxuXHRcdC8vIEZvciBvcHRpb25zIHRoYXQgc2hvdWxkbid0IGJlIGRlZXAgZXh0ZW5kZWQ6XG5cdFx0Ly8geW91IGNhbiBhZGQgeW91ciBvd24gY3VzdG9tIG9wdGlvbnMgaGVyZSBpZlxuXHRcdC8vIGFuZCB3aGVuIHlvdSBjcmVhdGUgb25lIHRoYXQgc2hvdWxkbid0IGJlXG5cdFx0Ly8gZGVlcCBleHRlbmRlZCAoc2VlIGFqYXhFeHRlbmQpXG5cdFx0ZmxhdE9wdGlvbnM6IHtcblx0XHRcdHVybDogdHJ1ZSxcblx0XHRcdGNvbnRleHQ6IHRydWVcblx0XHR9XG5cdH0sXG5cblx0Ly8gQ3JlYXRlcyBhIGZ1bGwgZmxlZGdlZCBzZXR0aW5ncyBvYmplY3QgaW50byB0YXJnZXRcblx0Ly8gd2l0aCBib3RoIGFqYXhTZXR0aW5ncyBhbmQgc2V0dGluZ3MgZmllbGRzLlxuXHQvLyBJZiB0YXJnZXQgaXMgb21pdHRlZCwgd3JpdGVzIGludG8gYWpheFNldHRpbmdzLlxuXHRhamF4U2V0dXA6IGZ1bmN0aW9uKCB0YXJnZXQsIHNldHRpbmdzICkge1xuXHRcdHJldHVybiBzZXR0aW5ncyA/XG5cblx0XHRcdC8vIEJ1aWxkaW5nIGEgc2V0dGluZ3Mgb2JqZWN0XG5cdFx0XHRhamF4RXh0ZW5kKCBhamF4RXh0ZW5kKCB0YXJnZXQsIGpRdWVyeS5hamF4U2V0dGluZ3MgKSwgc2V0dGluZ3MgKSA6XG5cblx0XHRcdC8vIEV4dGVuZGluZyBhamF4U2V0dGluZ3Ncblx0XHRcdGFqYXhFeHRlbmQoIGpRdWVyeS5hamF4U2V0dGluZ3MsIHRhcmdldCApO1xuXHR9LFxuXG5cdGFqYXhQcmVmaWx0ZXI6IGFkZFRvUHJlZmlsdGVyc09yVHJhbnNwb3J0cyggcHJlZmlsdGVycyApLFxuXHRhamF4VHJhbnNwb3J0OiBhZGRUb1ByZWZpbHRlcnNPclRyYW5zcG9ydHMoIHRyYW5zcG9ydHMgKSxcblxuXHQvLyBNYWluIG1ldGhvZFxuXHRhamF4OiBmdW5jdGlvbiggdXJsLCBvcHRpb25zICkge1xuXG5cdFx0Ly8gSWYgdXJsIGlzIGFuIG9iamVjdCwgc2ltdWxhdGUgcHJlLTEuNSBzaWduYXR1cmVcblx0XHRpZiAoIHR5cGVvZiB1cmwgPT09IFwib2JqZWN0XCIgKSB7XG5cdFx0XHRvcHRpb25zID0gdXJsO1xuXHRcdFx0dXJsID0gdW5kZWZpbmVkO1xuXHRcdH1cblxuXHRcdC8vIEZvcmNlIG9wdGlvbnMgdG8gYmUgYW4gb2JqZWN0XG5cdFx0b3B0aW9ucyA9IG9wdGlvbnMgfHwge307XG5cblx0XHR2YXIgdHJhbnNwb3J0LFxuXHRcdFx0Ly8gVVJMIHdpdGhvdXQgYW50aS1jYWNoZSBwYXJhbVxuXHRcdFx0Y2FjaGVVUkwsXG5cdFx0XHQvLyBSZXNwb25zZSBoZWFkZXJzXG5cdFx0XHRyZXNwb25zZUhlYWRlcnNTdHJpbmcsXG5cdFx0XHRyZXNwb25zZUhlYWRlcnMsXG5cdFx0XHQvLyB0aW1lb3V0IGhhbmRsZVxuXHRcdFx0dGltZW91dFRpbWVyLFxuXHRcdFx0Ly8gQ3Jvc3MtZG9tYWluIGRldGVjdGlvbiB2YXJzXG5cdFx0XHRwYXJ0cyxcblx0XHRcdC8vIFRvIGtub3cgaWYgZ2xvYmFsIGV2ZW50cyBhcmUgdG8gYmUgZGlzcGF0Y2hlZFxuXHRcdFx0ZmlyZUdsb2JhbHMsXG5cdFx0XHQvLyBMb29wIHZhcmlhYmxlXG5cdFx0XHRpLFxuXHRcdFx0Ly8gQ3JlYXRlIHRoZSBmaW5hbCBvcHRpb25zIG9iamVjdFxuXHRcdFx0cyA9IGpRdWVyeS5hamF4U2V0dXAoIHt9LCBvcHRpb25zICksXG5cdFx0XHQvLyBDYWxsYmFja3MgY29udGV4dFxuXHRcdFx0Y2FsbGJhY2tDb250ZXh0ID0gcy5jb250ZXh0IHx8IHMsXG5cdFx0XHQvLyBDb250ZXh0IGZvciBnbG9iYWwgZXZlbnRzIGlzIGNhbGxiYWNrQ29udGV4dCBpZiBpdCBpcyBhIERPTSBub2RlIG9yIGpRdWVyeSBjb2xsZWN0aW9uXG5cdFx0XHRnbG9iYWxFdmVudENvbnRleHQgPSBzLmNvbnRleHQgJiYgKCBjYWxsYmFja0NvbnRleHQubm9kZVR5cGUgfHwgY2FsbGJhY2tDb250ZXh0LmpxdWVyeSApID9cblx0XHRcdFx0alF1ZXJ5KCBjYWxsYmFja0NvbnRleHQgKSA6XG5cdFx0XHRcdGpRdWVyeS5ldmVudCxcblx0XHRcdC8vIERlZmVycmVkc1xuXHRcdFx0ZGVmZXJyZWQgPSBqUXVlcnkuRGVmZXJyZWQoKSxcblx0XHRcdGNvbXBsZXRlRGVmZXJyZWQgPSBqUXVlcnkuQ2FsbGJhY2tzKFwib25jZSBtZW1vcnlcIiksXG5cdFx0XHQvLyBTdGF0dXMtZGVwZW5kZW50IGNhbGxiYWNrc1xuXHRcdFx0c3RhdHVzQ29kZSA9IHMuc3RhdHVzQ29kZSB8fCB7fSxcblx0XHRcdC8vIEhlYWRlcnMgKHRoZXkgYXJlIHNlbnQgYWxsIGF0IG9uY2UpXG5cdFx0XHRyZXF1ZXN0SGVhZGVycyA9IHt9LFxuXHRcdFx0cmVxdWVzdEhlYWRlcnNOYW1lcyA9IHt9LFxuXHRcdFx0Ly8gVGhlIGpxWEhSIHN0YXRlXG5cdFx0XHRzdGF0ZSA9IDAsXG5cdFx0XHQvLyBEZWZhdWx0IGFib3J0IG1lc3NhZ2Vcblx0XHRcdHN0ckFib3J0ID0gXCJjYW5jZWxlZFwiLFxuXHRcdFx0Ly8gRmFrZSB4aHJcblx0XHRcdGpxWEhSID0ge1xuXHRcdFx0XHRyZWFkeVN0YXRlOiAwLFxuXG5cdFx0XHRcdC8vIEJ1aWxkcyBoZWFkZXJzIGhhc2h0YWJsZSBpZiBuZWVkZWRcblx0XHRcdFx0Z2V0UmVzcG9uc2VIZWFkZXI6IGZ1bmN0aW9uKCBrZXkgKSB7XG5cdFx0XHRcdFx0dmFyIG1hdGNoO1xuXHRcdFx0XHRcdGlmICggc3RhdGUgPT09IDIgKSB7XG5cdFx0XHRcdFx0XHRpZiAoICFyZXNwb25zZUhlYWRlcnMgKSB7XG5cdFx0XHRcdFx0XHRcdHJlc3BvbnNlSGVhZGVycyA9IHt9O1xuXHRcdFx0XHRcdFx0XHR3aGlsZSAoIChtYXRjaCA9IHJoZWFkZXJzLmV4ZWMoIHJlc3BvbnNlSGVhZGVyc1N0cmluZyApKSApIHtcblx0XHRcdFx0XHRcdFx0XHRyZXNwb25zZUhlYWRlcnNbIG1hdGNoWzFdLnRvTG93ZXJDYXNlKCkgXSA9IG1hdGNoWyAyIF07XG5cdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdG1hdGNoID0gcmVzcG9uc2VIZWFkZXJzWyBrZXkudG9Mb3dlckNhc2UoKSBdO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHRyZXR1cm4gbWF0Y2ggPT0gbnVsbCA/IG51bGwgOiBtYXRjaDtcblx0XHRcdFx0fSxcblxuXHRcdFx0XHQvLyBSYXcgc3RyaW5nXG5cdFx0XHRcdGdldEFsbFJlc3BvbnNlSGVhZGVyczogZnVuY3Rpb24oKSB7XG5cdFx0XHRcdFx0cmV0dXJuIHN0YXRlID09PSAyID8gcmVzcG9uc2VIZWFkZXJzU3RyaW5nIDogbnVsbDtcblx0XHRcdFx0fSxcblxuXHRcdFx0XHQvLyBDYWNoZXMgdGhlIGhlYWRlclxuXHRcdFx0XHRzZXRSZXF1ZXN0SGVhZGVyOiBmdW5jdGlvbiggbmFtZSwgdmFsdWUgKSB7XG5cdFx0XHRcdFx0dmFyIGxuYW1lID0gbmFtZS50b0xvd2VyQ2FzZSgpO1xuXHRcdFx0XHRcdGlmICggIXN0YXRlICkge1xuXHRcdFx0XHRcdFx0bmFtZSA9IHJlcXVlc3RIZWFkZXJzTmFtZXNbIGxuYW1lIF0gPSByZXF1ZXN0SGVhZGVyc05hbWVzWyBsbmFtZSBdIHx8IG5hbWU7XG5cdFx0XHRcdFx0XHRyZXF1ZXN0SGVhZGVyc1sgbmFtZSBdID0gdmFsdWU7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdHJldHVybiB0aGlzO1xuXHRcdFx0XHR9LFxuXG5cdFx0XHRcdC8vIE92ZXJyaWRlcyByZXNwb25zZSBjb250ZW50LXR5cGUgaGVhZGVyXG5cdFx0XHRcdG92ZXJyaWRlTWltZVR5cGU6IGZ1bmN0aW9uKCB0eXBlICkge1xuXHRcdFx0XHRcdGlmICggIXN0YXRlICkge1xuXHRcdFx0XHRcdFx0cy5taW1lVHlwZSA9IHR5cGU7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdHJldHVybiB0aGlzO1xuXHRcdFx0XHR9LFxuXG5cdFx0XHRcdC8vIFN0YXR1cy1kZXBlbmRlbnQgY2FsbGJhY2tzXG5cdFx0XHRcdHN0YXR1c0NvZGU6IGZ1bmN0aW9uKCBtYXAgKSB7XG5cdFx0XHRcdFx0dmFyIGNvZGU7XG5cdFx0XHRcdFx0aWYgKCBtYXAgKSB7XG5cdFx0XHRcdFx0XHRpZiAoIHN0YXRlIDwgMiApIHtcblx0XHRcdFx0XHRcdFx0Zm9yICggY29kZSBpbiBtYXAgKSB7XG5cdFx0XHRcdFx0XHRcdFx0Ly8gTGF6eS1hZGQgdGhlIG5ldyBjYWxsYmFjayBpbiBhIHdheSB0aGF0IHByZXNlcnZlcyBvbGQgb25lc1xuXHRcdFx0XHRcdFx0XHRcdHN0YXR1c0NvZGVbIGNvZGUgXSA9IFsgc3RhdHVzQ29kZVsgY29kZSBdLCBtYXBbIGNvZGUgXSBdO1xuXHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0XHQvLyBFeGVjdXRlIHRoZSBhcHByb3ByaWF0ZSBjYWxsYmFja3Ncblx0XHRcdFx0XHRcdFx0anFYSFIuYWx3YXlzKCBtYXBbIGpxWEhSLnN0YXR1cyBdICk7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdHJldHVybiB0aGlzO1xuXHRcdFx0XHR9LFxuXG5cdFx0XHRcdC8vIENhbmNlbCB0aGUgcmVxdWVzdFxuXHRcdFx0XHRhYm9ydDogZnVuY3Rpb24oIHN0YXR1c1RleHQgKSB7XG5cdFx0XHRcdFx0dmFyIGZpbmFsVGV4dCA9IHN0YXR1c1RleHQgfHwgc3RyQWJvcnQ7XG5cdFx0XHRcdFx0aWYgKCB0cmFuc3BvcnQgKSB7XG5cdFx0XHRcdFx0XHR0cmFuc3BvcnQuYWJvcnQoIGZpbmFsVGV4dCApO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHRkb25lKCAwLCBmaW5hbFRleHQgKTtcblx0XHRcdFx0XHRyZXR1cm4gdGhpcztcblx0XHRcdFx0fVxuXHRcdFx0fTtcblxuXHRcdC8vIEF0dGFjaCBkZWZlcnJlZHNcblx0XHRkZWZlcnJlZC5wcm9taXNlKCBqcVhIUiApLmNvbXBsZXRlID0gY29tcGxldGVEZWZlcnJlZC5hZGQ7XG5cdFx0anFYSFIuc3VjY2VzcyA9IGpxWEhSLmRvbmU7XG5cdFx0anFYSFIuZXJyb3IgPSBqcVhIUi5mYWlsO1xuXG5cdFx0Ly8gUmVtb3ZlIGhhc2ggY2hhcmFjdGVyICgjNzUzMTogYW5kIHN0cmluZyBwcm9tb3Rpb24pXG5cdFx0Ly8gQWRkIHByb3RvY29sIGlmIG5vdCBwcm92aWRlZCAocHJlZmlsdGVycyBtaWdodCBleHBlY3QgaXQpXG5cdFx0Ly8gSGFuZGxlIGZhbHN5IHVybCBpbiB0aGUgc2V0dGluZ3Mgb2JqZWN0ICgjMTAwOTM6IGNvbnNpc3RlbmN5IHdpdGggb2xkIHNpZ25hdHVyZSlcblx0XHQvLyBXZSBhbHNvIHVzZSB0aGUgdXJsIHBhcmFtZXRlciBpZiBhdmFpbGFibGVcblx0XHRzLnVybCA9ICggKCB1cmwgfHwgcy51cmwgfHwgYWpheExvY2F0aW9uICkgKyBcIlwiICkucmVwbGFjZSggcmhhc2gsIFwiXCIgKVxuXHRcdFx0LnJlcGxhY2UoIHJwcm90b2NvbCwgYWpheExvY1BhcnRzWyAxIF0gKyBcIi8vXCIgKTtcblxuXHRcdC8vIEFsaWFzIG1ldGhvZCBvcHRpb24gdG8gdHlwZSBhcyBwZXIgdGlja2V0ICMxMjAwNFxuXHRcdHMudHlwZSA9IG9wdGlvbnMubWV0aG9kIHx8IG9wdGlvbnMudHlwZSB8fCBzLm1ldGhvZCB8fCBzLnR5cGU7XG5cblx0XHQvLyBFeHRyYWN0IGRhdGFUeXBlcyBsaXN0XG5cdFx0cy5kYXRhVHlwZXMgPSBqUXVlcnkudHJpbSggcy5kYXRhVHlwZSB8fCBcIipcIiApLnRvTG93ZXJDYXNlKCkubWF0Y2goIHJub3R3aGl0ZSApIHx8IFsgXCJcIiBdO1xuXG5cdFx0Ly8gQSBjcm9zcy1kb21haW4gcmVxdWVzdCBpcyBpbiBvcmRlciB3aGVuIHdlIGhhdmUgYSBwcm90b2NvbDpob3N0OnBvcnQgbWlzbWF0Y2hcblx0XHRpZiAoIHMuY3Jvc3NEb21haW4gPT0gbnVsbCApIHtcblx0XHRcdHBhcnRzID0gcnVybC5leGVjKCBzLnVybC50b0xvd2VyQ2FzZSgpICk7XG5cdFx0XHRzLmNyb3NzRG9tYWluID0gISEoIHBhcnRzICYmXG5cdFx0XHRcdCggcGFydHNbIDEgXSAhPT0gYWpheExvY1BhcnRzWyAxIF0gfHwgcGFydHNbIDIgXSAhPT0gYWpheExvY1BhcnRzWyAyIF0gfHxcblx0XHRcdFx0XHQoIHBhcnRzWyAzIF0gfHwgKCBwYXJ0c1sgMSBdID09PSBcImh0dHA6XCIgPyBcIjgwXCIgOiBcIjQ0M1wiICkgKSAhPT1cblx0XHRcdFx0XHRcdCggYWpheExvY1BhcnRzWyAzIF0gfHwgKCBhamF4TG9jUGFydHNbIDEgXSA9PT0gXCJodHRwOlwiID8gXCI4MFwiIDogXCI0NDNcIiApICkgKVxuXHRcdFx0KTtcblx0XHR9XG5cblx0XHQvLyBDb252ZXJ0IGRhdGEgaWYgbm90IGFscmVhZHkgYSBzdHJpbmdcblx0XHRpZiAoIHMuZGF0YSAmJiBzLnByb2Nlc3NEYXRhICYmIHR5cGVvZiBzLmRhdGEgIT09IFwic3RyaW5nXCIgKSB7XG5cdFx0XHRzLmRhdGEgPSBqUXVlcnkucGFyYW0oIHMuZGF0YSwgcy50cmFkaXRpb25hbCApO1xuXHRcdH1cblxuXHRcdC8vIEFwcGx5IHByZWZpbHRlcnNcblx0XHRpbnNwZWN0UHJlZmlsdGVyc09yVHJhbnNwb3J0cyggcHJlZmlsdGVycywgcywgb3B0aW9ucywganFYSFIgKTtcblxuXHRcdC8vIElmIHJlcXVlc3Qgd2FzIGFib3J0ZWQgaW5zaWRlIGEgcHJlZmlsdGVyLCBzdG9wIHRoZXJlXG5cdFx0aWYgKCBzdGF0ZSA9PT0gMiApIHtcblx0XHRcdHJldHVybiBqcVhIUjtcblx0XHR9XG5cblx0XHQvLyBXZSBjYW4gZmlyZSBnbG9iYWwgZXZlbnRzIGFzIG9mIG5vdyBpZiBhc2tlZCB0b1xuXHRcdC8vIERvbid0IGZpcmUgZXZlbnRzIGlmIGpRdWVyeS5ldmVudCBpcyB1bmRlZmluZWQgaW4gYW4gQU1ELXVzYWdlIHNjZW5hcmlvICgjMTUxMTgpXG5cdFx0ZmlyZUdsb2JhbHMgPSBqUXVlcnkuZXZlbnQgJiYgcy5nbG9iYWw7XG5cblx0XHQvLyBXYXRjaCBmb3IgYSBuZXcgc2V0IG9mIHJlcXVlc3RzXG5cdFx0aWYgKCBmaXJlR2xvYmFscyAmJiBqUXVlcnkuYWN0aXZlKysgPT09IDAgKSB7XG5cdFx0XHRqUXVlcnkuZXZlbnQudHJpZ2dlcihcImFqYXhTdGFydFwiKTtcblx0XHR9XG5cblx0XHQvLyBVcHBlcmNhc2UgdGhlIHR5cGVcblx0XHRzLnR5cGUgPSBzLnR5cGUudG9VcHBlckNhc2UoKTtcblxuXHRcdC8vIERldGVybWluZSBpZiByZXF1ZXN0IGhhcyBjb250ZW50XG5cdFx0cy5oYXNDb250ZW50ID0gIXJub0NvbnRlbnQudGVzdCggcy50eXBlICk7XG5cblx0XHQvLyBTYXZlIHRoZSBVUkwgaW4gY2FzZSB3ZSdyZSB0b3lpbmcgd2l0aCB0aGUgSWYtTW9kaWZpZWQtU2luY2Vcblx0XHQvLyBhbmQvb3IgSWYtTm9uZS1NYXRjaCBoZWFkZXIgbGF0ZXIgb25cblx0XHRjYWNoZVVSTCA9IHMudXJsO1xuXG5cdFx0Ly8gTW9yZSBvcHRpb25zIGhhbmRsaW5nIGZvciByZXF1ZXN0cyB3aXRoIG5vIGNvbnRlbnRcblx0XHRpZiAoICFzLmhhc0NvbnRlbnQgKSB7XG5cblx0XHRcdC8vIElmIGRhdGEgaXMgYXZhaWxhYmxlLCBhcHBlbmQgZGF0YSB0byB1cmxcblx0XHRcdGlmICggcy5kYXRhICkge1xuXHRcdFx0XHRjYWNoZVVSTCA9ICggcy51cmwgKz0gKCBycXVlcnkudGVzdCggY2FjaGVVUkwgKSA/IFwiJlwiIDogXCI/XCIgKSArIHMuZGF0YSApO1xuXHRcdFx0XHQvLyAjOTY4MjogcmVtb3ZlIGRhdGEgc28gdGhhdCBpdCdzIG5vdCB1c2VkIGluIGFuIGV2ZW50dWFsIHJldHJ5XG5cdFx0XHRcdGRlbGV0ZSBzLmRhdGE7XG5cdFx0XHR9XG5cblx0XHRcdC8vIEFkZCBhbnRpLWNhY2hlIGluIHVybCBpZiBuZWVkZWRcblx0XHRcdGlmICggcy5jYWNoZSA9PT0gZmFsc2UgKSB7XG5cdFx0XHRcdHMudXJsID0gcnRzLnRlc3QoIGNhY2hlVVJMICkgP1xuXG5cdFx0XHRcdFx0Ly8gSWYgdGhlcmUgaXMgYWxyZWFkeSBhICdfJyBwYXJhbWV0ZXIsIHNldCBpdHMgdmFsdWVcblx0XHRcdFx0XHRjYWNoZVVSTC5yZXBsYWNlKCBydHMsIFwiJDFfPVwiICsgbm9uY2UrKyApIDpcblxuXHRcdFx0XHRcdC8vIE90aGVyd2lzZSBhZGQgb25lIHRvIHRoZSBlbmRcblx0XHRcdFx0XHRjYWNoZVVSTCArICggcnF1ZXJ5LnRlc3QoIGNhY2hlVVJMICkgPyBcIiZcIiA6IFwiP1wiICkgKyBcIl89XCIgKyBub25jZSsrO1xuXHRcdFx0fVxuXHRcdH1cblxuXHRcdC8vIFNldCB0aGUgSWYtTW9kaWZpZWQtU2luY2UgYW5kL29yIElmLU5vbmUtTWF0Y2ggaGVhZGVyLCBpZiBpbiBpZk1vZGlmaWVkIG1vZGUuXG5cdFx0aWYgKCBzLmlmTW9kaWZpZWQgKSB7XG5cdFx0XHRpZiAoIGpRdWVyeS5sYXN0TW9kaWZpZWRbIGNhY2hlVVJMIF0gKSB7XG5cdFx0XHRcdGpxWEhSLnNldFJlcXVlc3RIZWFkZXIoIFwiSWYtTW9kaWZpZWQtU2luY2VcIiwgalF1ZXJ5Lmxhc3RNb2RpZmllZFsgY2FjaGVVUkwgXSApO1xuXHRcdFx0fVxuXHRcdFx0aWYgKCBqUXVlcnkuZXRhZ1sgY2FjaGVVUkwgXSApIHtcblx0XHRcdFx0anFYSFIuc2V0UmVxdWVzdEhlYWRlciggXCJJZi1Ob25lLU1hdGNoXCIsIGpRdWVyeS5ldGFnWyBjYWNoZVVSTCBdICk7XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0Ly8gU2V0IHRoZSBjb3JyZWN0IGhlYWRlciwgaWYgZGF0YSBpcyBiZWluZyBzZW50XG5cdFx0aWYgKCBzLmRhdGEgJiYgcy5oYXNDb250ZW50ICYmIHMuY29udGVudFR5cGUgIT09IGZhbHNlIHx8IG9wdGlvbnMuY29udGVudFR5cGUgKSB7XG5cdFx0XHRqcVhIUi5zZXRSZXF1ZXN0SGVhZGVyKCBcIkNvbnRlbnQtVHlwZVwiLCBzLmNvbnRlbnRUeXBlICk7XG5cdFx0fVxuXG5cdFx0Ly8gU2V0IHRoZSBBY2NlcHRzIGhlYWRlciBmb3IgdGhlIHNlcnZlciwgZGVwZW5kaW5nIG9uIHRoZSBkYXRhVHlwZVxuXHRcdGpxWEhSLnNldFJlcXVlc3RIZWFkZXIoXG5cdFx0XHRcIkFjY2VwdFwiLFxuXHRcdFx0cy5kYXRhVHlwZXNbIDAgXSAmJiBzLmFjY2VwdHNbIHMuZGF0YVR5cGVzWzBdIF0gP1xuXHRcdFx0XHRzLmFjY2VwdHNbIHMuZGF0YVR5cGVzWzBdIF0gKyAoIHMuZGF0YVR5cGVzWyAwIF0gIT09IFwiKlwiID8gXCIsIFwiICsgYWxsVHlwZXMgKyBcIjsgcT0wLjAxXCIgOiBcIlwiICkgOlxuXHRcdFx0XHRzLmFjY2VwdHNbIFwiKlwiIF1cblx0XHQpO1xuXG5cdFx0Ly8gQ2hlY2sgZm9yIGhlYWRlcnMgb3B0aW9uXG5cdFx0Zm9yICggaSBpbiBzLmhlYWRlcnMgKSB7XG5cdFx0XHRqcVhIUi5zZXRSZXF1ZXN0SGVhZGVyKCBpLCBzLmhlYWRlcnNbIGkgXSApO1xuXHRcdH1cblxuXHRcdC8vIEFsbG93IGN1c3RvbSBoZWFkZXJzL21pbWV0eXBlcyBhbmQgZWFybHkgYWJvcnRcblx0XHRpZiAoIHMuYmVmb3JlU2VuZCAmJiAoIHMuYmVmb3JlU2VuZC5jYWxsKCBjYWxsYmFja0NvbnRleHQsIGpxWEhSLCBzICkgPT09IGZhbHNlIHx8IHN0YXRlID09PSAyICkgKSB7XG5cdFx0XHQvLyBBYm9ydCBpZiBub3QgZG9uZSBhbHJlYWR5IGFuZCByZXR1cm5cblx0XHRcdHJldHVybiBqcVhIUi5hYm9ydCgpO1xuXHRcdH1cblxuXHRcdC8vIEFib3J0aW5nIGlzIG5vIGxvbmdlciBhIGNhbmNlbGxhdGlvblxuXHRcdHN0ckFib3J0ID0gXCJhYm9ydFwiO1xuXG5cdFx0Ly8gSW5zdGFsbCBjYWxsYmFja3Mgb24gZGVmZXJyZWRzXG5cdFx0Zm9yICggaSBpbiB7IHN1Y2Nlc3M6IDEsIGVycm9yOiAxLCBjb21wbGV0ZTogMSB9ICkge1xuXHRcdFx0anFYSFJbIGkgXSggc1sgaSBdICk7XG5cdFx0fVxuXG5cdFx0Ly8gR2V0IHRyYW5zcG9ydFxuXHRcdHRyYW5zcG9ydCA9IGluc3BlY3RQcmVmaWx0ZXJzT3JUcmFuc3BvcnRzKCB0cmFuc3BvcnRzLCBzLCBvcHRpb25zLCBqcVhIUiApO1xuXG5cdFx0Ly8gSWYgbm8gdHJhbnNwb3J0LCB3ZSBhdXRvLWFib3J0XG5cdFx0aWYgKCAhdHJhbnNwb3J0ICkge1xuXHRcdFx0ZG9uZSggLTEsIFwiTm8gVHJhbnNwb3J0XCIgKTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0anFYSFIucmVhZHlTdGF0ZSA9IDE7XG5cblx0XHRcdC8vIFNlbmQgZ2xvYmFsIGV2ZW50XG5cdFx0XHRpZiAoIGZpcmVHbG9iYWxzICkge1xuXHRcdFx0XHRnbG9iYWxFdmVudENvbnRleHQudHJpZ2dlciggXCJhamF4U2VuZFwiLCBbIGpxWEhSLCBzIF0gKTtcblx0XHRcdH1cblx0XHRcdC8vIFRpbWVvdXRcblx0XHRcdGlmICggcy5hc3luYyAmJiBzLnRpbWVvdXQgPiAwICkge1xuXHRcdFx0XHR0aW1lb3V0VGltZXIgPSBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRcdGpxWEhSLmFib3J0KFwidGltZW91dFwiKTtcblx0XHRcdFx0fSwgcy50aW1lb3V0ICk7XG5cdFx0XHR9XG5cblx0XHRcdHRyeSB7XG5cdFx0XHRcdHN0YXRlID0gMTtcblx0XHRcdFx0dHJhbnNwb3J0LnNlbmQoIHJlcXVlc3RIZWFkZXJzLCBkb25lICk7XG5cdFx0XHR9IGNhdGNoICggZSApIHtcblx0XHRcdFx0Ly8gUHJvcGFnYXRlIGV4Y2VwdGlvbiBhcyBlcnJvciBpZiBub3QgZG9uZVxuXHRcdFx0XHRpZiAoIHN0YXRlIDwgMiApIHtcblx0XHRcdFx0XHRkb25lKCAtMSwgZSApO1xuXHRcdFx0XHQvLyBTaW1wbHkgcmV0aHJvdyBvdGhlcndpc2Vcblx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHR0aHJvdyBlO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0Ly8gQ2FsbGJhY2sgZm9yIHdoZW4gZXZlcnl0aGluZyBpcyBkb25lXG5cdFx0ZnVuY3Rpb24gZG9uZSggc3RhdHVzLCBuYXRpdmVTdGF0dXNUZXh0LCByZXNwb25zZXMsIGhlYWRlcnMgKSB7XG5cdFx0XHR2YXIgaXNTdWNjZXNzLCBzdWNjZXNzLCBlcnJvciwgcmVzcG9uc2UsIG1vZGlmaWVkLFxuXHRcdFx0XHRzdGF0dXNUZXh0ID0gbmF0aXZlU3RhdHVzVGV4dDtcblxuXHRcdFx0Ly8gQ2FsbGVkIG9uY2Vcblx0XHRcdGlmICggc3RhdGUgPT09IDIgKSB7XG5cdFx0XHRcdHJldHVybjtcblx0XHRcdH1cblxuXHRcdFx0Ly8gU3RhdGUgaXMgXCJkb25lXCIgbm93XG5cdFx0XHRzdGF0ZSA9IDI7XG5cblx0XHRcdC8vIENsZWFyIHRpbWVvdXQgaWYgaXQgZXhpc3RzXG5cdFx0XHRpZiAoIHRpbWVvdXRUaW1lciApIHtcblx0XHRcdFx0Y2xlYXJUaW1lb3V0KCB0aW1lb3V0VGltZXIgKTtcblx0XHRcdH1cblxuXHRcdFx0Ly8gRGVyZWZlcmVuY2UgdHJhbnNwb3J0IGZvciBlYXJseSBnYXJiYWdlIGNvbGxlY3Rpb25cblx0XHRcdC8vIChubyBtYXR0ZXIgaG93IGxvbmcgdGhlIGpxWEhSIG9iamVjdCB3aWxsIGJlIHVzZWQpXG5cdFx0XHR0cmFuc3BvcnQgPSB1bmRlZmluZWQ7XG5cblx0XHRcdC8vIENhY2hlIHJlc3BvbnNlIGhlYWRlcnNcblx0XHRcdHJlc3BvbnNlSGVhZGVyc1N0cmluZyA9IGhlYWRlcnMgfHwgXCJcIjtcblxuXHRcdFx0Ly8gU2V0IHJlYWR5U3RhdGVcblx0XHRcdGpxWEhSLnJlYWR5U3RhdGUgPSBzdGF0dXMgPiAwID8gNCA6IDA7XG5cblx0XHRcdC8vIERldGVybWluZSBpZiBzdWNjZXNzZnVsXG5cdFx0XHRpc1N1Y2Nlc3MgPSBzdGF0dXMgPj0gMjAwICYmIHN0YXR1cyA8IDMwMCB8fCBzdGF0dXMgPT09IDMwNDtcblxuXHRcdFx0Ly8gR2V0IHJlc3BvbnNlIGRhdGFcblx0XHRcdGlmICggcmVzcG9uc2VzICkge1xuXHRcdFx0XHRyZXNwb25zZSA9IGFqYXhIYW5kbGVSZXNwb25zZXMoIHMsIGpxWEhSLCByZXNwb25zZXMgKTtcblx0XHRcdH1cblxuXHRcdFx0Ly8gQ29udmVydCBubyBtYXR0ZXIgd2hhdCAodGhhdCB3YXkgcmVzcG9uc2VYWFggZmllbGRzIGFyZSBhbHdheXMgc2V0KVxuXHRcdFx0cmVzcG9uc2UgPSBhamF4Q29udmVydCggcywgcmVzcG9uc2UsIGpxWEhSLCBpc1N1Y2Nlc3MgKTtcblxuXHRcdFx0Ly8gSWYgc3VjY2Vzc2Z1bCwgaGFuZGxlIHR5cGUgY2hhaW5pbmdcblx0XHRcdGlmICggaXNTdWNjZXNzICkge1xuXG5cdFx0XHRcdC8vIFNldCB0aGUgSWYtTW9kaWZpZWQtU2luY2UgYW5kL29yIElmLU5vbmUtTWF0Y2ggaGVhZGVyLCBpZiBpbiBpZk1vZGlmaWVkIG1vZGUuXG5cdFx0XHRcdGlmICggcy5pZk1vZGlmaWVkICkge1xuXHRcdFx0XHRcdG1vZGlmaWVkID0ganFYSFIuZ2V0UmVzcG9uc2VIZWFkZXIoXCJMYXN0LU1vZGlmaWVkXCIpO1xuXHRcdFx0XHRcdGlmICggbW9kaWZpZWQgKSB7XG5cdFx0XHRcdFx0XHRqUXVlcnkubGFzdE1vZGlmaWVkWyBjYWNoZVVSTCBdID0gbW9kaWZpZWQ7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdG1vZGlmaWVkID0ganFYSFIuZ2V0UmVzcG9uc2VIZWFkZXIoXCJldGFnXCIpO1xuXHRcdFx0XHRcdGlmICggbW9kaWZpZWQgKSB7XG5cdFx0XHRcdFx0XHRqUXVlcnkuZXRhZ1sgY2FjaGVVUkwgXSA9IG1vZGlmaWVkO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXG5cdFx0XHRcdC8vIGlmIG5vIGNvbnRlbnRcblx0XHRcdFx0aWYgKCBzdGF0dXMgPT09IDIwNCB8fCBzLnR5cGUgPT09IFwiSEVBRFwiICkge1xuXHRcdFx0XHRcdHN0YXR1c1RleHQgPSBcIm5vY29udGVudFwiO1xuXG5cdFx0XHRcdC8vIGlmIG5vdCBtb2RpZmllZFxuXHRcdFx0XHR9IGVsc2UgaWYgKCBzdGF0dXMgPT09IDMwNCApIHtcblx0XHRcdFx0XHRzdGF0dXNUZXh0ID0gXCJub3Rtb2RpZmllZFwiO1xuXG5cdFx0XHRcdC8vIElmIHdlIGhhdmUgZGF0YSwgbGV0J3MgY29udmVydCBpdFxuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdHN0YXR1c1RleHQgPSByZXNwb25zZS5zdGF0ZTtcblx0XHRcdFx0XHRzdWNjZXNzID0gcmVzcG9uc2UuZGF0YTtcblx0XHRcdFx0XHRlcnJvciA9IHJlc3BvbnNlLmVycm9yO1xuXHRcdFx0XHRcdGlzU3VjY2VzcyA9ICFlcnJvcjtcblx0XHRcdFx0fVxuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0Ly8gRXh0cmFjdCBlcnJvciBmcm9tIHN0YXR1c1RleHQgYW5kIG5vcm1hbGl6ZSBmb3Igbm9uLWFib3J0c1xuXHRcdFx0XHRlcnJvciA9IHN0YXR1c1RleHQ7XG5cdFx0XHRcdGlmICggc3RhdHVzIHx8ICFzdGF0dXNUZXh0ICkge1xuXHRcdFx0XHRcdHN0YXR1c1RleHQgPSBcImVycm9yXCI7XG5cdFx0XHRcdFx0aWYgKCBzdGF0dXMgPCAwICkge1xuXHRcdFx0XHRcdFx0c3RhdHVzID0gMDtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdH1cblxuXHRcdFx0Ly8gU2V0IGRhdGEgZm9yIHRoZSBmYWtlIHhociBvYmplY3Rcblx0XHRcdGpxWEhSLnN0YXR1cyA9IHN0YXR1cztcblx0XHRcdGpxWEhSLnN0YXR1c1RleHQgPSAoIG5hdGl2ZVN0YXR1c1RleHQgfHwgc3RhdHVzVGV4dCApICsgXCJcIjtcblxuXHRcdFx0Ly8gU3VjY2Vzcy9FcnJvclxuXHRcdFx0aWYgKCBpc1N1Y2Nlc3MgKSB7XG5cdFx0XHRcdGRlZmVycmVkLnJlc29sdmVXaXRoKCBjYWxsYmFja0NvbnRleHQsIFsgc3VjY2Vzcywgc3RhdHVzVGV4dCwganFYSFIgXSApO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0ZGVmZXJyZWQucmVqZWN0V2l0aCggY2FsbGJhY2tDb250ZXh0LCBbIGpxWEhSLCBzdGF0dXNUZXh0LCBlcnJvciBdICk7XG5cdFx0XHR9XG5cblx0XHRcdC8vIFN0YXR1cy1kZXBlbmRlbnQgY2FsbGJhY2tzXG5cdFx0XHRqcVhIUi5zdGF0dXNDb2RlKCBzdGF0dXNDb2RlICk7XG5cdFx0XHRzdGF0dXNDb2RlID0gdW5kZWZpbmVkO1xuXG5cdFx0XHRpZiAoIGZpcmVHbG9iYWxzICkge1xuXHRcdFx0XHRnbG9iYWxFdmVudENvbnRleHQudHJpZ2dlciggaXNTdWNjZXNzID8gXCJhamF4U3VjY2Vzc1wiIDogXCJhamF4RXJyb3JcIixcblx0XHRcdFx0XHRbIGpxWEhSLCBzLCBpc1N1Y2Nlc3MgPyBzdWNjZXNzIDogZXJyb3IgXSApO1xuXHRcdFx0fVxuXG5cdFx0XHQvLyBDb21wbGV0ZVxuXHRcdFx0Y29tcGxldGVEZWZlcnJlZC5maXJlV2l0aCggY2FsbGJhY2tDb250ZXh0LCBbIGpxWEhSLCBzdGF0dXNUZXh0IF0gKTtcblxuXHRcdFx0aWYgKCBmaXJlR2xvYmFscyApIHtcblx0XHRcdFx0Z2xvYmFsRXZlbnRDb250ZXh0LnRyaWdnZXIoIFwiYWpheENvbXBsZXRlXCIsIFsganFYSFIsIHMgXSApO1xuXHRcdFx0XHQvLyBIYW5kbGUgdGhlIGdsb2JhbCBBSkFYIGNvdW50ZXJcblx0XHRcdFx0aWYgKCAhKCAtLWpRdWVyeS5hY3RpdmUgKSApIHtcblx0XHRcdFx0XHRqUXVlcnkuZXZlbnQudHJpZ2dlcihcImFqYXhTdG9wXCIpO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0cmV0dXJuIGpxWEhSO1xuXHR9LFxuXG5cdGdldEpTT046IGZ1bmN0aW9uKCB1cmwsIGRhdGEsIGNhbGxiYWNrICkge1xuXHRcdHJldHVybiBqUXVlcnkuZ2V0KCB1cmwsIGRhdGEsIGNhbGxiYWNrLCBcImpzb25cIiApO1xuXHR9LFxuXG5cdGdldFNjcmlwdDogZnVuY3Rpb24oIHVybCwgY2FsbGJhY2sgKSB7XG5cdFx0cmV0dXJuIGpRdWVyeS5nZXQoIHVybCwgdW5kZWZpbmVkLCBjYWxsYmFjaywgXCJzY3JpcHRcIiApO1xuXHR9XG59KTtcblxualF1ZXJ5LmVhY2goIFsgXCJnZXRcIiwgXCJwb3N0XCIgXSwgZnVuY3Rpb24oIGksIG1ldGhvZCApIHtcblx0alF1ZXJ5WyBtZXRob2QgXSA9IGZ1bmN0aW9uKCB1cmwsIGRhdGEsIGNhbGxiYWNrLCB0eXBlICkge1xuXHRcdC8vIFNoaWZ0IGFyZ3VtZW50cyBpZiBkYXRhIGFyZ3VtZW50IHdhcyBvbWl0dGVkXG5cdFx0aWYgKCBqUXVlcnkuaXNGdW5jdGlvbiggZGF0YSApICkge1xuXHRcdFx0dHlwZSA9IHR5cGUgfHwgY2FsbGJhY2s7XG5cdFx0XHRjYWxsYmFjayA9IGRhdGE7XG5cdFx0XHRkYXRhID0gdW5kZWZpbmVkO1xuXHRcdH1cblxuXHRcdHJldHVybiBqUXVlcnkuYWpheCh7XG5cdFx0XHR1cmw6IHVybCxcblx0XHRcdHR5cGU6IG1ldGhvZCxcblx0XHRcdGRhdGFUeXBlOiB0eXBlLFxuXHRcdFx0ZGF0YTogZGF0YSxcblx0XHRcdHN1Y2Nlc3M6IGNhbGxiYWNrXG5cdFx0fSk7XG5cdH07XG59KTtcblxuXG5qUXVlcnkuX2V2YWxVcmwgPSBmdW5jdGlvbiggdXJsICkge1xuXHRyZXR1cm4galF1ZXJ5LmFqYXgoe1xuXHRcdHVybDogdXJsLFxuXHRcdHR5cGU6IFwiR0VUXCIsXG5cdFx0ZGF0YVR5cGU6IFwic2NyaXB0XCIsXG5cdFx0YXN5bmM6IGZhbHNlLFxuXHRcdGdsb2JhbDogZmFsc2UsXG5cdFx0XCJ0aHJvd3NcIjogdHJ1ZVxuXHR9KTtcbn07XG5cblxualF1ZXJ5LmZuLmV4dGVuZCh7XG5cdHdyYXBBbGw6IGZ1bmN0aW9uKCBodG1sICkge1xuXHRcdHZhciB3cmFwO1xuXG5cdFx0aWYgKCBqUXVlcnkuaXNGdW5jdGlvbiggaHRtbCApICkge1xuXHRcdFx0cmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbiggaSApIHtcblx0XHRcdFx0alF1ZXJ5KCB0aGlzICkud3JhcEFsbCggaHRtbC5jYWxsKHRoaXMsIGkpICk7XG5cdFx0XHR9KTtcblx0XHR9XG5cblx0XHRpZiAoIHRoaXNbIDAgXSApIHtcblxuXHRcdFx0Ly8gVGhlIGVsZW1lbnRzIHRvIHdyYXAgdGhlIHRhcmdldCBhcm91bmRcblx0XHRcdHdyYXAgPSBqUXVlcnkoIGh0bWwsIHRoaXNbIDAgXS5vd25lckRvY3VtZW50ICkuZXEoIDAgKS5jbG9uZSggdHJ1ZSApO1xuXG5cdFx0XHRpZiAoIHRoaXNbIDAgXS5wYXJlbnROb2RlICkge1xuXHRcdFx0XHR3cmFwLmluc2VydEJlZm9yZSggdGhpc1sgMCBdICk7XG5cdFx0XHR9XG5cblx0XHRcdHdyYXAubWFwKGZ1bmN0aW9uKCkge1xuXHRcdFx0XHR2YXIgZWxlbSA9IHRoaXM7XG5cblx0XHRcdFx0d2hpbGUgKCBlbGVtLmZpcnN0RWxlbWVudENoaWxkICkge1xuXHRcdFx0XHRcdGVsZW0gPSBlbGVtLmZpcnN0RWxlbWVudENoaWxkO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0cmV0dXJuIGVsZW07XG5cdFx0XHR9KS5hcHBlbmQoIHRoaXMgKTtcblx0XHR9XG5cblx0XHRyZXR1cm4gdGhpcztcblx0fSxcblxuXHR3cmFwSW5uZXI6IGZ1bmN0aW9uKCBodG1sICkge1xuXHRcdGlmICggalF1ZXJ5LmlzRnVuY3Rpb24oIGh0bWwgKSApIHtcblx0XHRcdHJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oIGkgKSB7XG5cdFx0XHRcdGpRdWVyeSggdGhpcyApLndyYXBJbm5lciggaHRtbC5jYWxsKHRoaXMsIGkpICk7XG5cdFx0XHR9KTtcblx0XHR9XG5cblx0XHRyZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uKCkge1xuXHRcdFx0dmFyIHNlbGYgPSBqUXVlcnkoIHRoaXMgKSxcblx0XHRcdFx0Y29udGVudHMgPSBzZWxmLmNvbnRlbnRzKCk7XG5cblx0XHRcdGlmICggY29udGVudHMubGVuZ3RoICkge1xuXHRcdFx0XHRjb250ZW50cy53cmFwQWxsKCBodG1sICk7XG5cblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdHNlbGYuYXBwZW5kKCBodG1sICk7XG5cdFx0XHR9XG5cdFx0fSk7XG5cdH0sXG5cblx0d3JhcDogZnVuY3Rpb24oIGh0bWwgKSB7XG5cdFx0dmFyIGlzRnVuY3Rpb24gPSBqUXVlcnkuaXNGdW5jdGlvbiggaHRtbCApO1xuXG5cdFx0cmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbiggaSApIHtcblx0XHRcdGpRdWVyeSggdGhpcyApLndyYXBBbGwoIGlzRnVuY3Rpb24gPyBodG1sLmNhbGwodGhpcywgaSkgOiBodG1sICk7XG5cdFx0fSk7XG5cdH0sXG5cblx0dW53cmFwOiBmdW5jdGlvbigpIHtcblx0XHRyZXR1cm4gdGhpcy5wYXJlbnQoKS5lYWNoKGZ1bmN0aW9uKCkge1xuXHRcdFx0aWYgKCAhalF1ZXJ5Lm5vZGVOYW1lKCB0aGlzLCBcImJvZHlcIiApICkge1xuXHRcdFx0XHRqUXVlcnkoIHRoaXMgKS5yZXBsYWNlV2l0aCggdGhpcy5jaGlsZE5vZGVzICk7XG5cdFx0XHR9XG5cdFx0fSkuZW5kKCk7XG5cdH1cbn0pO1xuXG5cbmpRdWVyeS5leHByLmZpbHRlcnMuaGlkZGVuID0gZnVuY3Rpb24oIGVsZW0gKSB7XG5cdC8vIFN1cHBvcnQ6IE9wZXJhIDw9IDEyLjEyXG5cdC8vIE9wZXJhIHJlcG9ydHMgb2Zmc2V0V2lkdGhzIGFuZCBvZmZzZXRIZWlnaHRzIGxlc3MgdGhhbiB6ZXJvIG9uIHNvbWUgZWxlbWVudHNcblx0cmV0dXJuIGVsZW0ub2Zmc2V0V2lkdGggPD0gMCAmJiBlbGVtLm9mZnNldEhlaWdodCA8PSAwO1xufTtcbmpRdWVyeS5leHByLmZpbHRlcnMudmlzaWJsZSA9IGZ1bmN0aW9uKCBlbGVtICkge1xuXHRyZXR1cm4gIWpRdWVyeS5leHByLmZpbHRlcnMuaGlkZGVuKCBlbGVtICk7XG59O1xuXG5cblxuXG52YXIgcjIwID0gLyUyMC9nLFxuXHRyYnJhY2tldCA9IC9cXFtcXF0kLyxcblx0ckNSTEYgPSAvXFxyP1xcbi9nLFxuXHRyc3VibWl0dGVyVHlwZXMgPSAvXig/OnN1Ym1pdHxidXR0b258aW1hZ2V8cmVzZXR8ZmlsZSkkL2ksXG5cdHJzdWJtaXR0YWJsZSA9IC9eKD86aW5wdXR8c2VsZWN0fHRleHRhcmVhfGtleWdlbikvaTtcblxuZnVuY3Rpb24gYnVpbGRQYXJhbXMoIHByZWZpeCwgb2JqLCB0cmFkaXRpb25hbCwgYWRkICkge1xuXHR2YXIgbmFtZTtcblxuXHRpZiAoIGpRdWVyeS5pc0FycmF5KCBvYmogKSApIHtcblx0XHQvLyBTZXJpYWxpemUgYXJyYXkgaXRlbS5cblx0XHRqUXVlcnkuZWFjaCggb2JqLCBmdW5jdGlvbiggaSwgdiApIHtcblx0XHRcdGlmICggdHJhZGl0aW9uYWwgfHwgcmJyYWNrZXQudGVzdCggcHJlZml4ICkgKSB7XG5cdFx0XHRcdC8vIFRyZWF0IGVhY2ggYXJyYXkgaXRlbSBhcyBhIHNjYWxhci5cblx0XHRcdFx0YWRkKCBwcmVmaXgsIHYgKTtcblxuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0Ly8gSXRlbSBpcyBub24tc2NhbGFyIChhcnJheSBvciBvYmplY3QpLCBlbmNvZGUgaXRzIG51bWVyaWMgaW5kZXguXG5cdFx0XHRcdGJ1aWxkUGFyYW1zKCBwcmVmaXggKyBcIltcIiArICggdHlwZW9mIHYgPT09IFwib2JqZWN0XCIgPyBpIDogXCJcIiApICsgXCJdXCIsIHYsIHRyYWRpdGlvbmFsLCBhZGQgKTtcblx0XHRcdH1cblx0XHR9KTtcblxuXHR9IGVsc2UgaWYgKCAhdHJhZGl0aW9uYWwgJiYgalF1ZXJ5LnR5cGUoIG9iaiApID09PSBcIm9iamVjdFwiICkge1xuXHRcdC8vIFNlcmlhbGl6ZSBvYmplY3QgaXRlbS5cblx0XHRmb3IgKCBuYW1lIGluIG9iaiApIHtcblx0XHRcdGJ1aWxkUGFyYW1zKCBwcmVmaXggKyBcIltcIiArIG5hbWUgKyBcIl1cIiwgb2JqWyBuYW1lIF0sIHRyYWRpdGlvbmFsLCBhZGQgKTtcblx0XHR9XG5cblx0fSBlbHNlIHtcblx0XHQvLyBTZXJpYWxpemUgc2NhbGFyIGl0ZW0uXG5cdFx0YWRkKCBwcmVmaXgsIG9iaiApO1xuXHR9XG59XG5cbi8vIFNlcmlhbGl6ZSBhbiBhcnJheSBvZiBmb3JtIGVsZW1lbnRzIG9yIGEgc2V0IG9mXG4vLyBrZXkvdmFsdWVzIGludG8gYSBxdWVyeSBzdHJpbmdcbmpRdWVyeS5wYXJhbSA9IGZ1bmN0aW9uKCBhLCB0cmFkaXRpb25hbCApIHtcblx0dmFyIHByZWZpeCxcblx0XHRzID0gW10sXG5cdFx0YWRkID0gZnVuY3Rpb24oIGtleSwgdmFsdWUgKSB7XG5cdFx0XHQvLyBJZiB2YWx1ZSBpcyBhIGZ1bmN0aW9uLCBpbnZva2UgaXQgYW5kIHJldHVybiBpdHMgdmFsdWVcblx0XHRcdHZhbHVlID0galF1ZXJ5LmlzRnVuY3Rpb24oIHZhbHVlICkgPyB2YWx1ZSgpIDogKCB2YWx1ZSA9PSBudWxsID8gXCJcIiA6IHZhbHVlICk7XG5cdFx0XHRzWyBzLmxlbmd0aCBdID0gZW5jb2RlVVJJQ29tcG9uZW50KCBrZXkgKSArIFwiPVwiICsgZW5jb2RlVVJJQ29tcG9uZW50KCB2YWx1ZSApO1xuXHRcdH07XG5cblx0Ly8gU2V0IHRyYWRpdGlvbmFsIHRvIHRydWUgZm9yIGpRdWVyeSA8PSAxLjMuMiBiZWhhdmlvci5cblx0aWYgKCB0cmFkaXRpb25hbCA9PT0gdW5kZWZpbmVkICkge1xuXHRcdHRyYWRpdGlvbmFsID0galF1ZXJ5LmFqYXhTZXR0aW5ncyAmJiBqUXVlcnkuYWpheFNldHRpbmdzLnRyYWRpdGlvbmFsO1xuXHR9XG5cblx0Ly8gSWYgYW4gYXJyYXkgd2FzIHBhc3NlZCBpbiwgYXNzdW1lIHRoYXQgaXQgaXMgYW4gYXJyYXkgb2YgZm9ybSBlbGVtZW50cy5cblx0aWYgKCBqUXVlcnkuaXNBcnJheSggYSApIHx8ICggYS5qcXVlcnkgJiYgIWpRdWVyeS5pc1BsYWluT2JqZWN0KCBhICkgKSApIHtcblx0XHQvLyBTZXJpYWxpemUgdGhlIGZvcm0gZWxlbWVudHNcblx0XHRqUXVlcnkuZWFjaCggYSwgZnVuY3Rpb24oKSB7XG5cdFx0XHRhZGQoIHRoaXMubmFtZSwgdGhpcy52YWx1ZSApO1xuXHRcdH0pO1xuXG5cdH0gZWxzZSB7XG5cdFx0Ly8gSWYgdHJhZGl0aW9uYWwsIGVuY29kZSB0aGUgXCJvbGRcIiB3YXkgKHRoZSB3YXkgMS4zLjIgb3Igb2xkZXJcblx0XHQvLyBkaWQgaXQpLCBvdGhlcndpc2UgZW5jb2RlIHBhcmFtcyByZWN1cnNpdmVseS5cblx0XHRmb3IgKCBwcmVmaXggaW4gYSApIHtcblx0XHRcdGJ1aWxkUGFyYW1zKCBwcmVmaXgsIGFbIHByZWZpeCBdLCB0cmFkaXRpb25hbCwgYWRkICk7XG5cdFx0fVxuXHR9XG5cblx0Ly8gUmV0dXJuIHRoZSByZXN1bHRpbmcgc2VyaWFsaXphdGlvblxuXHRyZXR1cm4gcy5qb2luKCBcIiZcIiApLnJlcGxhY2UoIHIyMCwgXCIrXCIgKTtcbn07XG5cbmpRdWVyeS5mbi5leHRlbmQoe1xuXHRzZXJpYWxpemU6IGZ1bmN0aW9uKCkge1xuXHRcdHJldHVybiBqUXVlcnkucGFyYW0oIHRoaXMuc2VyaWFsaXplQXJyYXkoKSApO1xuXHR9LFxuXHRzZXJpYWxpemVBcnJheTogZnVuY3Rpb24oKSB7XG5cdFx0cmV0dXJuIHRoaXMubWFwKGZ1bmN0aW9uKCkge1xuXHRcdFx0Ly8gQ2FuIGFkZCBwcm9wSG9vayBmb3IgXCJlbGVtZW50c1wiIHRvIGZpbHRlciBvciBhZGQgZm9ybSBlbGVtZW50c1xuXHRcdFx0dmFyIGVsZW1lbnRzID0galF1ZXJ5LnByb3AoIHRoaXMsIFwiZWxlbWVudHNcIiApO1xuXHRcdFx0cmV0dXJuIGVsZW1lbnRzID8galF1ZXJ5Lm1ha2VBcnJheSggZWxlbWVudHMgKSA6IHRoaXM7XG5cdFx0fSlcblx0XHQuZmlsdGVyKGZ1bmN0aW9uKCkge1xuXHRcdFx0dmFyIHR5cGUgPSB0aGlzLnR5cGU7XG5cblx0XHRcdC8vIFVzZSAuaXMoIFwiOmRpc2FibGVkXCIgKSBzbyB0aGF0IGZpZWxkc2V0W2Rpc2FibGVkXSB3b3Jrc1xuXHRcdFx0cmV0dXJuIHRoaXMubmFtZSAmJiAhalF1ZXJ5KCB0aGlzICkuaXMoIFwiOmRpc2FibGVkXCIgKSAmJlxuXHRcdFx0XHRyc3VibWl0dGFibGUudGVzdCggdGhpcy5ub2RlTmFtZSApICYmICFyc3VibWl0dGVyVHlwZXMudGVzdCggdHlwZSApICYmXG5cdFx0XHRcdCggdGhpcy5jaGVja2VkIHx8ICFyY2hlY2thYmxlVHlwZS50ZXN0KCB0eXBlICkgKTtcblx0XHR9KVxuXHRcdC5tYXAoZnVuY3Rpb24oIGksIGVsZW0gKSB7XG5cdFx0XHR2YXIgdmFsID0galF1ZXJ5KCB0aGlzICkudmFsKCk7XG5cblx0XHRcdHJldHVybiB2YWwgPT0gbnVsbCA/XG5cdFx0XHRcdG51bGwgOlxuXHRcdFx0XHRqUXVlcnkuaXNBcnJheSggdmFsICkgP1xuXHRcdFx0XHRcdGpRdWVyeS5tYXAoIHZhbCwgZnVuY3Rpb24oIHZhbCApIHtcblx0XHRcdFx0XHRcdHJldHVybiB7IG5hbWU6IGVsZW0ubmFtZSwgdmFsdWU6IHZhbC5yZXBsYWNlKCByQ1JMRiwgXCJcXHJcXG5cIiApIH07XG5cdFx0XHRcdFx0fSkgOlxuXHRcdFx0XHRcdHsgbmFtZTogZWxlbS5uYW1lLCB2YWx1ZTogdmFsLnJlcGxhY2UoIHJDUkxGLCBcIlxcclxcblwiICkgfTtcblx0XHR9KS5nZXQoKTtcblx0fVxufSk7XG5cblxualF1ZXJ5LmFqYXhTZXR0aW5ncy54aHIgPSBmdW5jdGlvbigpIHtcblx0dHJ5IHtcblx0XHRyZXR1cm4gbmV3IFhNTEh0dHBSZXF1ZXN0KCk7XG5cdH0gY2F0Y2goIGUgKSB7fVxufTtcblxudmFyIHhocklkID0gMCxcblx0eGhyQ2FsbGJhY2tzID0ge30sXG5cdHhoclN1Y2Nlc3NTdGF0dXMgPSB7XG5cdFx0Ly8gZmlsZSBwcm90b2NvbCBhbHdheXMgeWllbGRzIHN0YXR1cyBjb2RlIDAsIGFzc3VtZSAyMDBcblx0XHQwOiAyMDAsXG5cdFx0Ly8gU3VwcG9ydDogSUU5XG5cdFx0Ly8gIzE0NTA6IHNvbWV0aW1lcyBJRSByZXR1cm5zIDEyMjMgd2hlbiBpdCBzaG91bGQgYmUgMjA0XG5cdFx0MTIyMzogMjA0XG5cdH0sXG5cdHhoclN1cHBvcnRlZCA9IGpRdWVyeS5hamF4U2V0dGluZ3MueGhyKCk7XG5cbi8vIFN1cHBvcnQ6IElFOVxuLy8gT3BlbiByZXF1ZXN0cyBtdXN0IGJlIG1hbnVhbGx5IGFib3J0ZWQgb24gdW5sb2FkICgjNTI4MClcbi8vIFNlZSBodHRwczovL3N1cHBvcnQubWljcm9zb2Z0LmNvbS9rYi8yODU2NzQ2IGZvciBtb3JlIGluZm9cbmlmICggd2luZG93LmF0dGFjaEV2ZW50ICkge1xuXHR3aW5kb3cuYXR0YWNoRXZlbnQoIFwib251bmxvYWRcIiwgZnVuY3Rpb24oKSB7XG5cdFx0Zm9yICggdmFyIGtleSBpbiB4aHJDYWxsYmFja3MgKSB7XG5cdFx0XHR4aHJDYWxsYmFja3NbIGtleSBdKCk7XG5cdFx0fVxuXHR9KTtcbn1cblxuc3VwcG9ydC5jb3JzID0gISF4aHJTdXBwb3J0ZWQgJiYgKCBcIndpdGhDcmVkZW50aWFsc1wiIGluIHhoclN1cHBvcnRlZCApO1xuc3VwcG9ydC5hamF4ID0geGhyU3VwcG9ydGVkID0gISF4aHJTdXBwb3J0ZWQ7XG5cbmpRdWVyeS5hamF4VHJhbnNwb3J0KGZ1bmN0aW9uKCBvcHRpb25zICkge1xuXHR2YXIgY2FsbGJhY2s7XG5cblx0Ly8gQ3Jvc3MgZG9tYWluIG9ubHkgYWxsb3dlZCBpZiBzdXBwb3J0ZWQgdGhyb3VnaCBYTUxIdHRwUmVxdWVzdFxuXHRpZiAoIHN1cHBvcnQuY29ycyB8fCB4aHJTdXBwb3J0ZWQgJiYgIW9wdGlvbnMuY3Jvc3NEb21haW4gKSB7XG5cdFx0cmV0dXJuIHtcblx0XHRcdHNlbmQ6IGZ1bmN0aW9uKCBoZWFkZXJzLCBjb21wbGV0ZSApIHtcblx0XHRcdFx0dmFyIGksXG5cdFx0XHRcdFx0eGhyID0gb3B0aW9ucy54aHIoKSxcblx0XHRcdFx0XHRpZCA9ICsreGhySWQ7XG5cblx0XHRcdFx0eGhyLm9wZW4oIG9wdGlvbnMudHlwZSwgb3B0aW9ucy51cmwsIG9wdGlvbnMuYXN5bmMsIG9wdGlvbnMudXNlcm5hbWUsIG9wdGlvbnMucGFzc3dvcmQgKTtcblxuXHRcdFx0XHQvLyBBcHBseSBjdXN0b20gZmllbGRzIGlmIHByb3ZpZGVkXG5cdFx0XHRcdGlmICggb3B0aW9ucy54aHJGaWVsZHMgKSB7XG5cdFx0XHRcdFx0Zm9yICggaSBpbiBvcHRpb25zLnhockZpZWxkcyApIHtcblx0XHRcdFx0XHRcdHhoclsgaSBdID0gb3B0aW9ucy54aHJGaWVsZHNbIGkgXTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblxuXHRcdFx0XHQvLyBPdmVycmlkZSBtaW1lIHR5cGUgaWYgbmVlZGVkXG5cdFx0XHRcdGlmICggb3B0aW9ucy5taW1lVHlwZSAmJiB4aHIub3ZlcnJpZGVNaW1lVHlwZSApIHtcblx0XHRcdFx0XHR4aHIub3ZlcnJpZGVNaW1lVHlwZSggb3B0aW9ucy5taW1lVHlwZSApO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0Ly8gWC1SZXF1ZXN0ZWQtV2l0aCBoZWFkZXJcblx0XHRcdFx0Ly8gRm9yIGNyb3NzLWRvbWFpbiByZXF1ZXN0cywgc2VlaW5nIGFzIGNvbmRpdGlvbnMgZm9yIGEgcHJlZmxpZ2h0IGFyZVxuXHRcdFx0XHQvLyBha2luIHRvIGEgamlnc2F3IHB1enpsZSwgd2Ugc2ltcGx5IG5ldmVyIHNldCBpdCB0byBiZSBzdXJlLlxuXHRcdFx0XHQvLyAoaXQgY2FuIGFsd2F5cyBiZSBzZXQgb24gYSBwZXItcmVxdWVzdCBiYXNpcyBvciBldmVuIHVzaW5nIGFqYXhTZXR1cClcblx0XHRcdFx0Ly8gRm9yIHNhbWUtZG9tYWluIHJlcXVlc3RzLCB3b24ndCBjaGFuZ2UgaGVhZGVyIGlmIGFscmVhZHkgcHJvdmlkZWQuXG5cdFx0XHRcdGlmICggIW9wdGlvbnMuY3Jvc3NEb21haW4gJiYgIWhlYWRlcnNbXCJYLVJlcXVlc3RlZC1XaXRoXCJdICkge1xuXHRcdFx0XHRcdGhlYWRlcnNbXCJYLVJlcXVlc3RlZC1XaXRoXCJdID0gXCJYTUxIdHRwUmVxdWVzdFwiO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0Ly8gU2V0IGhlYWRlcnNcblx0XHRcdFx0Zm9yICggaSBpbiBoZWFkZXJzICkge1xuXHRcdFx0XHRcdHhoci5zZXRSZXF1ZXN0SGVhZGVyKCBpLCBoZWFkZXJzWyBpIF0gKTtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdC8vIENhbGxiYWNrXG5cdFx0XHRcdGNhbGxiYWNrID0gZnVuY3Rpb24oIHR5cGUgKSB7XG5cdFx0XHRcdFx0cmV0dXJuIGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRcdFx0aWYgKCBjYWxsYmFjayApIHtcblx0XHRcdFx0XHRcdFx0ZGVsZXRlIHhockNhbGxiYWNrc1sgaWQgXTtcblx0XHRcdFx0XHRcdFx0Y2FsbGJhY2sgPSB4aHIub25sb2FkID0geGhyLm9uZXJyb3IgPSBudWxsO1xuXG5cdFx0XHRcdFx0XHRcdGlmICggdHlwZSA9PT0gXCJhYm9ydFwiICkge1xuXHRcdFx0XHRcdFx0XHRcdHhoci5hYm9ydCgpO1xuXHRcdFx0XHRcdFx0XHR9IGVsc2UgaWYgKCB0eXBlID09PSBcImVycm9yXCIgKSB7XG5cdFx0XHRcdFx0XHRcdFx0Y29tcGxldGUoXG5cdFx0XHRcdFx0XHRcdFx0XHQvLyBmaWxlOiBwcm90b2NvbCBhbHdheXMgeWllbGRzIHN0YXR1cyAwOyBzZWUgIzg2MDUsICMxNDIwN1xuXHRcdFx0XHRcdFx0XHRcdFx0eGhyLnN0YXR1cyxcblx0XHRcdFx0XHRcdFx0XHRcdHhoci5zdGF0dXNUZXh0XG5cdFx0XHRcdFx0XHRcdFx0KTtcblx0XHRcdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdFx0XHRjb21wbGV0ZShcblx0XHRcdFx0XHRcdFx0XHRcdHhoclN1Y2Nlc3NTdGF0dXNbIHhoci5zdGF0dXMgXSB8fCB4aHIuc3RhdHVzLFxuXHRcdFx0XHRcdFx0XHRcdFx0eGhyLnN0YXR1c1RleHQsXG5cdFx0XHRcdFx0XHRcdFx0XHQvLyBTdXBwb3J0OiBJRTlcblx0XHRcdFx0XHRcdFx0XHRcdC8vIEFjY2Vzc2luZyBiaW5hcnktZGF0YSByZXNwb25zZVRleHQgdGhyb3dzIGFuIGV4Y2VwdGlvblxuXHRcdFx0XHRcdFx0XHRcdFx0Ly8gKCMxMTQyNilcblx0XHRcdFx0XHRcdFx0XHRcdHR5cGVvZiB4aHIucmVzcG9uc2VUZXh0ID09PSBcInN0cmluZ1wiID8ge1xuXHRcdFx0XHRcdFx0XHRcdFx0XHR0ZXh0OiB4aHIucmVzcG9uc2VUZXh0XG5cdFx0XHRcdFx0XHRcdFx0XHR9IDogdW5kZWZpbmVkLFxuXHRcdFx0XHRcdFx0XHRcdFx0eGhyLmdldEFsbFJlc3BvbnNlSGVhZGVycygpXG5cdFx0XHRcdFx0XHRcdFx0KTtcblx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH07XG5cdFx0XHRcdH07XG5cblx0XHRcdFx0Ly8gTGlzdGVuIHRvIGV2ZW50c1xuXHRcdFx0XHR4aHIub25sb2FkID0gY2FsbGJhY2soKTtcblx0XHRcdFx0eGhyLm9uZXJyb3IgPSBjYWxsYmFjayhcImVycm9yXCIpO1xuXG5cdFx0XHRcdC8vIENyZWF0ZSB0aGUgYWJvcnQgY2FsbGJhY2tcblx0XHRcdFx0Y2FsbGJhY2sgPSB4aHJDYWxsYmFja3NbIGlkIF0gPSBjYWxsYmFjayhcImFib3J0XCIpO1xuXG5cdFx0XHRcdHRyeSB7XG5cdFx0XHRcdFx0Ly8gRG8gc2VuZCB0aGUgcmVxdWVzdCAodGhpcyBtYXkgcmFpc2UgYW4gZXhjZXB0aW9uKVxuXHRcdFx0XHRcdHhoci5zZW5kKCBvcHRpb25zLmhhc0NvbnRlbnQgJiYgb3B0aW9ucy5kYXRhIHx8IG51bGwgKTtcblx0XHRcdFx0fSBjYXRjaCAoIGUgKSB7XG5cdFx0XHRcdFx0Ly8gIzE0NjgzOiBPbmx5IHJldGhyb3cgaWYgdGhpcyBoYXNuJ3QgYmVlbiBub3RpZmllZCBhcyBhbiBlcnJvciB5ZXRcblx0XHRcdFx0XHRpZiAoIGNhbGxiYWNrICkge1xuXHRcdFx0XHRcdFx0dGhyb3cgZTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdH0sXG5cblx0XHRcdGFib3J0OiBmdW5jdGlvbigpIHtcblx0XHRcdFx0aWYgKCBjYWxsYmFjayApIHtcblx0XHRcdFx0XHRjYWxsYmFjaygpO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fTtcblx0fVxufSk7XG5cblxuXG5cbi8vIEluc3RhbGwgc2NyaXB0IGRhdGFUeXBlXG5qUXVlcnkuYWpheFNldHVwKHtcblx0YWNjZXB0czoge1xuXHRcdHNjcmlwdDogXCJ0ZXh0L2phdmFzY3JpcHQsIGFwcGxpY2F0aW9uL2phdmFzY3JpcHQsIGFwcGxpY2F0aW9uL2VjbWFzY3JpcHQsIGFwcGxpY2F0aW9uL3gtZWNtYXNjcmlwdFwiXG5cdH0sXG5cdGNvbnRlbnRzOiB7XG5cdFx0c2NyaXB0OiAvKD86amF2YXxlY21hKXNjcmlwdC9cblx0fSxcblx0Y29udmVydGVyczoge1xuXHRcdFwidGV4dCBzY3JpcHRcIjogZnVuY3Rpb24oIHRleHQgKSB7XG5cdFx0XHRqUXVlcnkuZ2xvYmFsRXZhbCggdGV4dCApO1xuXHRcdFx0cmV0dXJuIHRleHQ7XG5cdFx0fVxuXHR9XG59KTtcblxuLy8gSGFuZGxlIGNhY2hlJ3Mgc3BlY2lhbCBjYXNlIGFuZCBjcm9zc0RvbWFpblxualF1ZXJ5LmFqYXhQcmVmaWx0ZXIoIFwic2NyaXB0XCIsIGZ1bmN0aW9uKCBzICkge1xuXHRpZiAoIHMuY2FjaGUgPT09IHVuZGVmaW5lZCApIHtcblx0XHRzLmNhY2hlID0gZmFsc2U7XG5cdH1cblx0aWYgKCBzLmNyb3NzRG9tYWluICkge1xuXHRcdHMudHlwZSA9IFwiR0VUXCI7XG5cdH1cbn0pO1xuXG4vLyBCaW5kIHNjcmlwdCB0YWcgaGFjayB0cmFuc3BvcnRcbmpRdWVyeS5hamF4VHJhbnNwb3J0KCBcInNjcmlwdFwiLCBmdW5jdGlvbiggcyApIHtcblx0Ly8gVGhpcyB0cmFuc3BvcnQgb25seSBkZWFscyB3aXRoIGNyb3NzIGRvbWFpbiByZXF1ZXN0c1xuXHRpZiAoIHMuY3Jvc3NEb21haW4gKSB7XG5cdFx0dmFyIHNjcmlwdCwgY2FsbGJhY2s7XG5cdFx0cmV0dXJuIHtcblx0XHRcdHNlbmQ6IGZ1bmN0aW9uKCBfLCBjb21wbGV0ZSApIHtcblx0XHRcdFx0c2NyaXB0ID0galF1ZXJ5KFwiPHNjcmlwdD5cIikucHJvcCh7XG5cdFx0XHRcdFx0YXN5bmM6IHRydWUsXG5cdFx0XHRcdFx0Y2hhcnNldDogcy5zY3JpcHRDaGFyc2V0LFxuXHRcdFx0XHRcdHNyYzogcy51cmxcblx0XHRcdFx0fSkub24oXG5cdFx0XHRcdFx0XCJsb2FkIGVycm9yXCIsXG5cdFx0XHRcdFx0Y2FsbGJhY2sgPSBmdW5jdGlvbiggZXZ0ICkge1xuXHRcdFx0XHRcdFx0c2NyaXB0LnJlbW92ZSgpO1xuXHRcdFx0XHRcdFx0Y2FsbGJhY2sgPSBudWxsO1xuXHRcdFx0XHRcdFx0aWYgKCBldnQgKSB7XG5cdFx0XHRcdFx0XHRcdGNvbXBsZXRlKCBldnQudHlwZSA9PT0gXCJlcnJvclwiID8gNDA0IDogMjAwLCBldnQudHlwZSApO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH1cblx0XHRcdFx0KTtcblx0XHRcdFx0ZG9jdW1lbnQuaGVhZC5hcHBlbmRDaGlsZCggc2NyaXB0WyAwIF0gKTtcblx0XHRcdH0sXG5cdFx0XHRhYm9ydDogZnVuY3Rpb24oKSB7XG5cdFx0XHRcdGlmICggY2FsbGJhY2sgKSB7XG5cdFx0XHRcdFx0Y2FsbGJhY2soKTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH07XG5cdH1cbn0pO1xuXG5cblxuXG52YXIgb2xkQ2FsbGJhY2tzID0gW10sXG5cdHJqc29ucCA9IC8oPSlcXD8oPz0mfCQpfFxcP1xcPy87XG5cbi8vIERlZmF1bHQganNvbnAgc2V0dGluZ3NcbmpRdWVyeS5hamF4U2V0dXAoe1xuXHRqc29ucDogXCJjYWxsYmFja1wiLFxuXHRqc29ucENhbGxiYWNrOiBmdW5jdGlvbigpIHtcblx0XHR2YXIgY2FsbGJhY2sgPSBvbGRDYWxsYmFja3MucG9wKCkgfHwgKCBqUXVlcnkuZXhwYW5kbyArIFwiX1wiICsgKCBub25jZSsrICkgKTtcblx0XHR0aGlzWyBjYWxsYmFjayBdID0gdHJ1ZTtcblx0XHRyZXR1cm4gY2FsbGJhY2s7XG5cdH1cbn0pO1xuXG4vLyBEZXRlY3QsIG5vcm1hbGl6ZSBvcHRpb25zIGFuZCBpbnN0YWxsIGNhbGxiYWNrcyBmb3IganNvbnAgcmVxdWVzdHNcbmpRdWVyeS5hamF4UHJlZmlsdGVyKCBcImpzb24ganNvbnBcIiwgZnVuY3Rpb24oIHMsIG9yaWdpbmFsU2V0dGluZ3MsIGpxWEhSICkge1xuXG5cdHZhciBjYWxsYmFja05hbWUsIG92ZXJ3cml0dGVuLCByZXNwb25zZUNvbnRhaW5lcixcblx0XHRqc29uUHJvcCA9IHMuanNvbnAgIT09IGZhbHNlICYmICggcmpzb25wLnRlc3QoIHMudXJsICkgP1xuXHRcdFx0XCJ1cmxcIiA6XG5cdFx0XHR0eXBlb2Ygcy5kYXRhID09PSBcInN0cmluZ1wiICYmICEoIHMuY29udGVudFR5cGUgfHwgXCJcIiApLmluZGV4T2YoXCJhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWRcIikgJiYgcmpzb25wLnRlc3QoIHMuZGF0YSApICYmIFwiZGF0YVwiXG5cdFx0KTtcblxuXHQvLyBIYW5kbGUgaWZmIHRoZSBleHBlY3RlZCBkYXRhIHR5cGUgaXMgXCJqc29ucFwiIG9yIHdlIGhhdmUgYSBwYXJhbWV0ZXIgdG8gc2V0XG5cdGlmICgganNvblByb3AgfHwgcy5kYXRhVHlwZXNbIDAgXSA9PT0gXCJqc29ucFwiICkge1xuXG5cdFx0Ly8gR2V0IGNhbGxiYWNrIG5hbWUsIHJlbWVtYmVyaW5nIHByZWV4aXN0aW5nIHZhbHVlIGFzc29jaWF0ZWQgd2l0aCBpdFxuXHRcdGNhbGxiYWNrTmFtZSA9IHMuanNvbnBDYWxsYmFjayA9IGpRdWVyeS5pc0Z1bmN0aW9uKCBzLmpzb25wQ2FsbGJhY2sgKSA/XG5cdFx0XHRzLmpzb25wQ2FsbGJhY2soKSA6XG5cdFx0XHRzLmpzb25wQ2FsbGJhY2s7XG5cblx0XHQvLyBJbnNlcnQgY2FsbGJhY2sgaW50byB1cmwgb3IgZm9ybSBkYXRhXG5cdFx0aWYgKCBqc29uUHJvcCApIHtcblx0XHRcdHNbIGpzb25Qcm9wIF0gPSBzWyBqc29uUHJvcCBdLnJlcGxhY2UoIHJqc29ucCwgXCIkMVwiICsgY2FsbGJhY2tOYW1lICk7XG5cdFx0fSBlbHNlIGlmICggcy5qc29ucCAhPT0gZmFsc2UgKSB7XG5cdFx0XHRzLnVybCArPSAoIHJxdWVyeS50ZXN0KCBzLnVybCApID8gXCImXCIgOiBcIj9cIiApICsgcy5qc29ucCArIFwiPVwiICsgY2FsbGJhY2tOYW1lO1xuXHRcdH1cblxuXHRcdC8vIFVzZSBkYXRhIGNvbnZlcnRlciB0byByZXRyaWV2ZSBqc29uIGFmdGVyIHNjcmlwdCBleGVjdXRpb25cblx0XHRzLmNvbnZlcnRlcnNbXCJzY3JpcHQganNvblwiXSA9IGZ1bmN0aW9uKCkge1xuXHRcdFx0aWYgKCAhcmVzcG9uc2VDb250YWluZXIgKSB7XG5cdFx0XHRcdGpRdWVyeS5lcnJvciggY2FsbGJhY2tOYW1lICsgXCIgd2FzIG5vdCBjYWxsZWRcIiApO1xuXHRcdFx0fVxuXHRcdFx0cmV0dXJuIHJlc3BvbnNlQ29udGFpbmVyWyAwIF07XG5cdFx0fTtcblxuXHRcdC8vIGZvcmNlIGpzb24gZGF0YVR5cGVcblx0XHRzLmRhdGFUeXBlc1sgMCBdID0gXCJqc29uXCI7XG5cblx0XHQvLyBJbnN0YWxsIGNhbGxiYWNrXG5cdFx0b3ZlcndyaXR0ZW4gPSB3aW5kb3dbIGNhbGxiYWNrTmFtZSBdO1xuXHRcdHdpbmRvd1sgY2FsbGJhY2tOYW1lIF0gPSBmdW5jdGlvbigpIHtcblx0XHRcdHJlc3BvbnNlQ29udGFpbmVyID0gYXJndW1lbnRzO1xuXHRcdH07XG5cblx0XHQvLyBDbGVhbi11cCBmdW5jdGlvbiAoZmlyZXMgYWZ0ZXIgY29udmVydGVycylcblx0XHRqcVhIUi5hbHdheXMoZnVuY3Rpb24oKSB7XG5cdFx0XHQvLyBSZXN0b3JlIHByZWV4aXN0aW5nIHZhbHVlXG5cdFx0XHR3aW5kb3dbIGNhbGxiYWNrTmFtZSBdID0gb3ZlcndyaXR0ZW47XG5cblx0XHRcdC8vIFNhdmUgYmFjayBhcyBmcmVlXG5cdFx0XHRpZiAoIHNbIGNhbGxiYWNrTmFtZSBdICkge1xuXHRcdFx0XHQvLyBtYWtlIHN1cmUgdGhhdCByZS11c2luZyB0aGUgb3B0aW9ucyBkb2Vzbid0IHNjcmV3IHRoaW5ncyBhcm91bmRcblx0XHRcdFx0cy5qc29ucENhbGxiYWNrID0gb3JpZ2luYWxTZXR0aW5ncy5qc29ucENhbGxiYWNrO1xuXG5cdFx0XHRcdC8vIHNhdmUgdGhlIGNhbGxiYWNrIG5hbWUgZm9yIGZ1dHVyZSB1c2Vcblx0XHRcdFx0b2xkQ2FsbGJhY2tzLnB1c2goIGNhbGxiYWNrTmFtZSApO1xuXHRcdFx0fVxuXG5cdFx0XHQvLyBDYWxsIGlmIGl0IHdhcyBhIGZ1bmN0aW9uIGFuZCB3ZSBoYXZlIGEgcmVzcG9uc2Vcblx0XHRcdGlmICggcmVzcG9uc2VDb250YWluZXIgJiYgalF1ZXJ5LmlzRnVuY3Rpb24oIG92ZXJ3cml0dGVuICkgKSB7XG5cdFx0XHRcdG92ZXJ3cml0dGVuKCByZXNwb25zZUNvbnRhaW5lclsgMCBdICk7XG5cdFx0XHR9XG5cblx0XHRcdHJlc3BvbnNlQ29udGFpbmVyID0gb3ZlcndyaXR0ZW4gPSB1bmRlZmluZWQ7XG5cdFx0fSk7XG5cblx0XHQvLyBEZWxlZ2F0ZSB0byBzY3JpcHRcblx0XHRyZXR1cm4gXCJzY3JpcHRcIjtcblx0fVxufSk7XG5cblxuXG5cbi8vIGRhdGE6IHN0cmluZyBvZiBodG1sXG4vLyBjb250ZXh0IChvcHRpb25hbCk6IElmIHNwZWNpZmllZCwgdGhlIGZyYWdtZW50IHdpbGwgYmUgY3JlYXRlZCBpbiB0aGlzIGNvbnRleHQsIGRlZmF1bHRzIHRvIGRvY3VtZW50XG4vLyBrZWVwU2NyaXB0cyAob3B0aW9uYWwpOiBJZiB0cnVlLCB3aWxsIGluY2x1ZGUgc2NyaXB0cyBwYXNzZWQgaW4gdGhlIGh0bWwgc3RyaW5nXG5qUXVlcnkucGFyc2VIVE1MID0gZnVuY3Rpb24oIGRhdGEsIGNvbnRleHQsIGtlZXBTY3JpcHRzICkge1xuXHRpZiAoICFkYXRhIHx8IHR5cGVvZiBkYXRhICE9PSBcInN0cmluZ1wiICkge1xuXHRcdHJldHVybiBudWxsO1xuXHR9XG5cdGlmICggdHlwZW9mIGNvbnRleHQgPT09IFwiYm9vbGVhblwiICkge1xuXHRcdGtlZXBTY3JpcHRzID0gY29udGV4dDtcblx0XHRjb250ZXh0ID0gZmFsc2U7XG5cdH1cblx0Y29udGV4dCA9IGNvbnRleHQgfHwgZG9jdW1lbnQ7XG5cblx0dmFyIHBhcnNlZCA9IHJzaW5nbGVUYWcuZXhlYyggZGF0YSApLFxuXHRcdHNjcmlwdHMgPSAha2VlcFNjcmlwdHMgJiYgW107XG5cblx0Ly8gU2luZ2xlIHRhZ1xuXHRpZiAoIHBhcnNlZCApIHtcblx0XHRyZXR1cm4gWyBjb250ZXh0LmNyZWF0ZUVsZW1lbnQoIHBhcnNlZFsxXSApIF07XG5cdH1cblxuXHRwYXJzZWQgPSBqUXVlcnkuYnVpbGRGcmFnbWVudCggWyBkYXRhIF0sIGNvbnRleHQsIHNjcmlwdHMgKTtcblxuXHRpZiAoIHNjcmlwdHMgJiYgc2NyaXB0cy5sZW5ndGggKSB7XG5cdFx0alF1ZXJ5KCBzY3JpcHRzICkucmVtb3ZlKCk7XG5cdH1cblxuXHRyZXR1cm4galF1ZXJ5Lm1lcmdlKCBbXSwgcGFyc2VkLmNoaWxkTm9kZXMgKTtcbn07XG5cblxuLy8gS2VlcCBhIGNvcHkgb2YgdGhlIG9sZCBsb2FkIG1ldGhvZFxudmFyIF9sb2FkID0galF1ZXJ5LmZuLmxvYWQ7XG5cbi8qKlxuICogTG9hZCBhIHVybCBpbnRvIGEgcGFnZVxuICovXG5qUXVlcnkuZm4ubG9hZCA9IGZ1bmN0aW9uKCB1cmwsIHBhcmFtcywgY2FsbGJhY2sgKSB7XG5cdGlmICggdHlwZW9mIHVybCAhPT0gXCJzdHJpbmdcIiAmJiBfbG9hZCApIHtcblx0XHRyZXR1cm4gX2xvYWQuYXBwbHkoIHRoaXMsIGFyZ3VtZW50cyApO1xuXHR9XG5cblx0dmFyIHNlbGVjdG9yLCB0eXBlLCByZXNwb25zZSxcblx0XHRzZWxmID0gdGhpcyxcblx0XHRvZmYgPSB1cmwuaW5kZXhPZihcIiBcIik7XG5cblx0aWYgKCBvZmYgPj0gMCApIHtcblx0XHRzZWxlY3RvciA9IGpRdWVyeS50cmltKCB1cmwuc2xpY2UoIG9mZiApICk7XG5cdFx0dXJsID0gdXJsLnNsaWNlKCAwLCBvZmYgKTtcblx0fVxuXG5cdC8vIElmIGl0J3MgYSBmdW5jdGlvblxuXHRpZiAoIGpRdWVyeS5pc0Z1bmN0aW9uKCBwYXJhbXMgKSApIHtcblxuXHRcdC8vIFdlIGFzc3VtZSB0aGF0IGl0J3MgdGhlIGNhbGxiYWNrXG5cdFx0Y2FsbGJhY2sgPSBwYXJhbXM7XG5cdFx0cGFyYW1zID0gdW5kZWZpbmVkO1xuXG5cdC8vIE90aGVyd2lzZSwgYnVpbGQgYSBwYXJhbSBzdHJpbmdcblx0fSBlbHNlIGlmICggcGFyYW1zICYmIHR5cGVvZiBwYXJhbXMgPT09IFwib2JqZWN0XCIgKSB7XG5cdFx0dHlwZSA9IFwiUE9TVFwiO1xuXHR9XG5cblx0Ly8gSWYgd2UgaGF2ZSBlbGVtZW50cyB0byBtb2RpZnksIG1ha2UgdGhlIHJlcXVlc3Rcblx0aWYgKCBzZWxmLmxlbmd0aCA+IDAgKSB7XG5cdFx0alF1ZXJ5LmFqYXgoe1xuXHRcdFx0dXJsOiB1cmwsXG5cblx0XHRcdC8vIGlmIFwidHlwZVwiIHZhcmlhYmxlIGlzIHVuZGVmaW5lZCwgdGhlbiBcIkdFVFwiIG1ldGhvZCB3aWxsIGJlIHVzZWRcblx0XHRcdHR5cGU6IHR5cGUsXG5cdFx0XHRkYXRhVHlwZTogXCJodG1sXCIsXG5cdFx0XHRkYXRhOiBwYXJhbXNcblx0XHR9KS5kb25lKGZ1bmN0aW9uKCByZXNwb25zZVRleHQgKSB7XG5cblx0XHRcdC8vIFNhdmUgcmVzcG9uc2UgZm9yIHVzZSBpbiBjb21wbGV0ZSBjYWxsYmFja1xuXHRcdFx0cmVzcG9uc2UgPSBhcmd1bWVudHM7XG5cblx0XHRcdHNlbGYuaHRtbCggc2VsZWN0b3IgP1xuXG5cdFx0XHRcdC8vIElmIGEgc2VsZWN0b3Igd2FzIHNwZWNpZmllZCwgbG9jYXRlIHRoZSByaWdodCBlbGVtZW50cyBpbiBhIGR1bW15IGRpdlxuXHRcdFx0XHQvLyBFeGNsdWRlIHNjcmlwdHMgdG8gYXZvaWQgSUUgJ1Blcm1pc3Npb24gRGVuaWVkJyBlcnJvcnNcblx0XHRcdFx0alF1ZXJ5KFwiPGRpdj5cIikuYXBwZW5kKCBqUXVlcnkucGFyc2VIVE1MKCByZXNwb25zZVRleHQgKSApLmZpbmQoIHNlbGVjdG9yICkgOlxuXG5cdFx0XHRcdC8vIE90aGVyd2lzZSB1c2UgdGhlIGZ1bGwgcmVzdWx0XG5cdFx0XHRcdHJlc3BvbnNlVGV4dCApO1xuXG5cdFx0fSkuY29tcGxldGUoIGNhbGxiYWNrICYmIGZ1bmN0aW9uKCBqcVhIUiwgc3RhdHVzICkge1xuXHRcdFx0c2VsZi5lYWNoKCBjYWxsYmFjaywgcmVzcG9uc2UgfHwgWyBqcVhIUi5yZXNwb25zZVRleHQsIHN0YXR1cywganFYSFIgXSApO1xuXHRcdH0pO1xuXHR9XG5cblx0cmV0dXJuIHRoaXM7XG59O1xuXG5cblxuXG4vLyBBdHRhY2ggYSBidW5jaCBvZiBmdW5jdGlvbnMgZm9yIGhhbmRsaW5nIGNvbW1vbiBBSkFYIGV2ZW50c1xualF1ZXJ5LmVhY2goIFsgXCJhamF4U3RhcnRcIiwgXCJhamF4U3RvcFwiLCBcImFqYXhDb21wbGV0ZVwiLCBcImFqYXhFcnJvclwiLCBcImFqYXhTdWNjZXNzXCIsIFwiYWpheFNlbmRcIiBdLCBmdW5jdGlvbiggaSwgdHlwZSApIHtcblx0alF1ZXJ5LmZuWyB0eXBlIF0gPSBmdW5jdGlvbiggZm4gKSB7XG5cdFx0cmV0dXJuIHRoaXMub24oIHR5cGUsIGZuICk7XG5cdH07XG59KTtcblxuXG5cblxualF1ZXJ5LmV4cHIuZmlsdGVycy5hbmltYXRlZCA9IGZ1bmN0aW9uKCBlbGVtICkge1xuXHRyZXR1cm4galF1ZXJ5LmdyZXAoalF1ZXJ5LnRpbWVycywgZnVuY3Rpb24oIGZuICkge1xuXHRcdHJldHVybiBlbGVtID09PSBmbi5lbGVtO1xuXHR9KS5sZW5ndGg7XG59O1xuXG5cblxuXG52YXIgZG9jRWxlbSA9IHdpbmRvdy5kb2N1bWVudC5kb2N1bWVudEVsZW1lbnQ7XG5cbi8qKlxuICogR2V0cyBhIHdpbmRvdyBmcm9tIGFuIGVsZW1lbnRcbiAqL1xuZnVuY3Rpb24gZ2V0V2luZG93KCBlbGVtICkge1xuXHRyZXR1cm4galF1ZXJ5LmlzV2luZG93KCBlbGVtICkgPyBlbGVtIDogZWxlbS5ub2RlVHlwZSA9PT0gOSAmJiBlbGVtLmRlZmF1bHRWaWV3O1xufVxuXG5qUXVlcnkub2Zmc2V0ID0ge1xuXHRzZXRPZmZzZXQ6IGZ1bmN0aW9uKCBlbGVtLCBvcHRpb25zLCBpICkge1xuXHRcdHZhciBjdXJQb3NpdGlvbiwgY3VyTGVmdCwgY3VyQ1NTVG9wLCBjdXJUb3AsIGN1ck9mZnNldCwgY3VyQ1NTTGVmdCwgY2FsY3VsYXRlUG9zaXRpb24sXG5cdFx0XHRwb3NpdGlvbiA9IGpRdWVyeS5jc3MoIGVsZW0sIFwicG9zaXRpb25cIiApLFxuXHRcdFx0Y3VyRWxlbSA9IGpRdWVyeSggZWxlbSApLFxuXHRcdFx0cHJvcHMgPSB7fTtcblxuXHRcdC8vIFNldCBwb3NpdGlvbiBmaXJzdCwgaW4tY2FzZSB0b3AvbGVmdCBhcmUgc2V0IGV2ZW4gb24gc3RhdGljIGVsZW1cblx0XHRpZiAoIHBvc2l0aW9uID09PSBcInN0YXRpY1wiICkge1xuXHRcdFx0ZWxlbS5zdHlsZS5wb3NpdGlvbiA9IFwicmVsYXRpdmVcIjtcblx0XHR9XG5cblx0XHRjdXJPZmZzZXQgPSBjdXJFbGVtLm9mZnNldCgpO1xuXHRcdGN1ckNTU1RvcCA9IGpRdWVyeS5jc3MoIGVsZW0sIFwidG9wXCIgKTtcblx0XHRjdXJDU1NMZWZ0ID0galF1ZXJ5LmNzcyggZWxlbSwgXCJsZWZ0XCIgKTtcblx0XHRjYWxjdWxhdGVQb3NpdGlvbiA9ICggcG9zaXRpb24gPT09IFwiYWJzb2x1dGVcIiB8fCBwb3NpdGlvbiA9PT0gXCJmaXhlZFwiICkgJiZcblx0XHRcdCggY3VyQ1NTVG9wICsgY3VyQ1NTTGVmdCApLmluZGV4T2YoXCJhdXRvXCIpID4gLTE7XG5cblx0XHQvLyBOZWVkIHRvIGJlIGFibGUgdG8gY2FsY3VsYXRlIHBvc2l0aW9uIGlmIGVpdGhlclxuXHRcdC8vIHRvcCBvciBsZWZ0IGlzIGF1dG8gYW5kIHBvc2l0aW9uIGlzIGVpdGhlciBhYnNvbHV0ZSBvciBmaXhlZFxuXHRcdGlmICggY2FsY3VsYXRlUG9zaXRpb24gKSB7XG5cdFx0XHRjdXJQb3NpdGlvbiA9IGN1ckVsZW0ucG9zaXRpb24oKTtcblx0XHRcdGN1clRvcCA9IGN1clBvc2l0aW9uLnRvcDtcblx0XHRcdGN1ckxlZnQgPSBjdXJQb3NpdGlvbi5sZWZ0O1xuXG5cdFx0fSBlbHNlIHtcblx0XHRcdGN1clRvcCA9IHBhcnNlRmxvYXQoIGN1ckNTU1RvcCApIHx8IDA7XG5cdFx0XHRjdXJMZWZ0ID0gcGFyc2VGbG9hdCggY3VyQ1NTTGVmdCApIHx8IDA7XG5cdFx0fVxuXG5cdFx0aWYgKCBqUXVlcnkuaXNGdW5jdGlvbiggb3B0aW9ucyApICkge1xuXHRcdFx0b3B0aW9ucyA9IG9wdGlvbnMuY2FsbCggZWxlbSwgaSwgY3VyT2Zmc2V0ICk7XG5cdFx0fVxuXG5cdFx0aWYgKCBvcHRpb25zLnRvcCAhPSBudWxsICkge1xuXHRcdFx0cHJvcHMudG9wID0gKCBvcHRpb25zLnRvcCAtIGN1ck9mZnNldC50b3AgKSArIGN1clRvcDtcblx0XHR9XG5cdFx0aWYgKCBvcHRpb25zLmxlZnQgIT0gbnVsbCApIHtcblx0XHRcdHByb3BzLmxlZnQgPSAoIG9wdGlvbnMubGVmdCAtIGN1ck9mZnNldC5sZWZ0ICkgKyBjdXJMZWZ0O1xuXHRcdH1cblxuXHRcdGlmICggXCJ1c2luZ1wiIGluIG9wdGlvbnMgKSB7XG5cdFx0XHRvcHRpb25zLnVzaW5nLmNhbGwoIGVsZW0sIHByb3BzICk7XG5cblx0XHR9IGVsc2Uge1xuXHRcdFx0Y3VyRWxlbS5jc3MoIHByb3BzICk7XG5cdFx0fVxuXHR9XG59O1xuXG5qUXVlcnkuZm4uZXh0ZW5kKHtcblx0b2Zmc2V0OiBmdW5jdGlvbiggb3B0aW9ucyApIHtcblx0XHRpZiAoIGFyZ3VtZW50cy5sZW5ndGggKSB7XG5cdFx0XHRyZXR1cm4gb3B0aW9ucyA9PT0gdW5kZWZpbmVkID9cblx0XHRcdFx0dGhpcyA6XG5cdFx0XHRcdHRoaXMuZWFjaChmdW5jdGlvbiggaSApIHtcblx0XHRcdFx0XHRqUXVlcnkub2Zmc2V0LnNldE9mZnNldCggdGhpcywgb3B0aW9ucywgaSApO1xuXHRcdFx0XHR9KTtcblx0XHR9XG5cblx0XHR2YXIgZG9jRWxlbSwgd2luLFxuXHRcdFx0ZWxlbSA9IHRoaXNbIDAgXSxcblx0XHRcdGJveCA9IHsgdG9wOiAwLCBsZWZ0OiAwIH0sXG5cdFx0XHRkb2MgPSBlbGVtICYmIGVsZW0ub3duZXJEb2N1bWVudDtcblxuXHRcdGlmICggIWRvYyApIHtcblx0XHRcdHJldHVybjtcblx0XHR9XG5cblx0XHRkb2NFbGVtID0gZG9jLmRvY3VtZW50RWxlbWVudDtcblxuXHRcdC8vIE1ha2Ugc3VyZSBpdCdzIG5vdCBhIGRpc2Nvbm5lY3RlZCBET00gbm9kZVxuXHRcdGlmICggIWpRdWVyeS5jb250YWlucyggZG9jRWxlbSwgZWxlbSApICkge1xuXHRcdFx0cmV0dXJuIGJveDtcblx0XHR9XG5cblx0XHQvLyBTdXBwb3J0OiBCbGFja0JlcnJ5IDUsIGlPUyAzIChvcmlnaW5hbCBpUGhvbmUpXG5cdFx0Ly8gSWYgd2UgZG9uJ3QgaGF2ZSBnQkNSLCBqdXN0IHVzZSAwLDAgcmF0aGVyIHRoYW4gZXJyb3Jcblx0XHRpZiAoIHR5cGVvZiBlbGVtLmdldEJvdW5kaW5nQ2xpZW50UmVjdCAhPT0gc3RydW5kZWZpbmVkICkge1xuXHRcdFx0Ym94ID0gZWxlbS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcblx0XHR9XG5cdFx0d2luID0gZ2V0V2luZG93KCBkb2MgKTtcblx0XHRyZXR1cm4ge1xuXHRcdFx0dG9wOiBib3gudG9wICsgd2luLnBhZ2VZT2Zmc2V0IC0gZG9jRWxlbS5jbGllbnRUb3AsXG5cdFx0XHRsZWZ0OiBib3gubGVmdCArIHdpbi5wYWdlWE9mZnNldCAtIGRvY0VsZW0uY2xpZW50TGVmdFxuXHRcdH07XG5cdH0sXG5cblx0cG9zaXRpb246IGZ1bmN0aW9uKCkge1xuXHRcdGlmICggIXRoaXNbIDAgXSApIHtcblx0XHRcdHJldHVybjtcblx0XHR9XG5cblx0XHR2YXIgb2Zmc2V0UGFyZW50LCBvZmZzZXQsXG5cdFx0XHRlbGVtID0gdGhpc1sgMCBdLFxuXHRcdFx0cGFyZW50T2Zmc2V0ID0geyB0b3A6IDAsIGxlZnQ6IDAgfTtcblxuXHRcdC8vIEZpeGVkIGVsZW1lbnRzIGFyZSBvZmZzZXQgZnJvbSB3aW5kb3cgKHBhcmVudE9mZnNldCA9IHt0b3A6MCwgbGVmdDogMH0sIGJlY2F1c2UgaXQgaXMgaXRzIG9ubHkgb2Zmc2V0IHBhcmVudFxuXHRcdGlmICggalF1ZXJ5LmNzcyggZWxlbSwgXCJwb3NpdGlvblwiICkgPT09IFwiZml4ZWRcIiApIHtcblx0XHRcdC8vIEFzc3VtZSBnZXRCb3VuZGluZ0NsaWVudFJlY3QgaXMgdGhlcmUgd2hlbiBjb21wdXRlZCBwb3NpdGlvbiBpcyBmaXhlZFxuXHRcdFx0b2Zmc2V0ID0gZWxlbS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcblxuXHRcdH0gZWxzZSB7XG5cdFx0XHQvLyBHZXQgKnJlYWwqIG9mZnNldFBhcmVudFxuXHRcdFx0b2Zmc2V0UGFyZW50ID0gdGhpcy5vZmZzZXRQYXJlbnQoKTtcblxuXHRcdFx0Ly8gR2V0IGNvcnJlY3Qgb2Zmc2V0c1xuXHRcdFx0b2Zmc2V0ID0gdGhpcy5vZmZzZXQoKTtcblx0XHRcdGlmICggIWpRdWVyeS5ub2RlTmFtZSggb2Zmc2V0UGFyZW50WyAwIF0sIFwiaHRtbFwiICkgKSB7XG5cdFx0XHRcdHBhcmVudE9mZnNldCA9IG9mZnNldFBhcmVudC5vZmZzZXQoKTtcblx0XHRcdH1cblxuXHRcdFx0Ly8gQWRkIG9mZnNldFBhcmVudCBib3JkZXJzXG5cdFx0XHRwYXJlbnRPZmZzZXQudG9wICs9IGpRdWVyeS5jc3MoIG9mZnNldFBhcmVudFsgMCBdLCBcImJvcmRlclRvcFdpZHRoXCIsIHRydWUgKTtcblx0XHRcdHBhcmVudE9mZnNldC5sZWZ0ICs9IGpRdWVyeS5jc3MoIG9mZnNldFBhcmVudFsgMCBdLCBcImJvcmRlckxlZnRXaWR0aFwiLCB0cnVlICk7XG5cdFx0fVxuXG5cdFx0Ly8gU3VidHJhY3QgcGFyZW50IG9mZnNldHMgYW5kIGVsZW1lbnQgbWFyZ2luc1xuXHRcdHJldHVybiB7XG5cdFx0XHR0b3A6IG9mZnNldC50b3AgLSBwYXJlbnRPZmZzZXQudG9wIC0galF1ZXJ5LmNzcyggZWxlbSwgXCJtYXJnaW5Ub3BcIiwgdHJ1ZSApLFxuXHRcdFx0bGVmdDogb2Zmc2V0LmxlZnQgLSBwYXJlbnRPZmZzZXQubGVmdCAtIGpRdWVyeS5jc3MoIGVsZW0sIFwibWFyZ2luTGVmdFwiLCB0cnVlIClcblx0XHR9O1xuXHR9LFxuXG5cdG9mZnNldFBhcmVudDogZnVuY3Rpb24oKSB7XG5cdFx0cmV0dXJuIHRoaXMubWFwKGZ1bmN0aW9uKCkge1xuXHRcdFx0dmFyIG9mZnNldFBhcmVudCA9IHRoaXMub2Zmc2V0UGFyZW50IHx8IGRvY0VsZW07XG5cblx0XHRcdHdoaWxlICggb2Zmc2V0UGFyZW50ICYmICggIWpRdWVyeS5ub2RlTmFtZSggb2Zmc2V0UGFyZW50LCBcImh0bWxcIiApICYmIGpRdWVyeS5jc3MoIG9mZnNldFBhcmVudCwgXCJwb3NpdGlvblwiICkgPT09IFwic3RhdGljXCIgKSApIHtcblx0XHRcdFx0b2Zmc2V0UGFyZW50ID0gb2Zmc2V0UGFyZW50Lm9mZnNldFBhcmVudDtcblx0XHRcdH1cblxuXHRcdFx0cmV0dXJuIG9mZnNldFBhcmVudCB8fCBkb2NFbGVtO1xuXHRcdH0pO1xuXHR9XG59KTtcblxuLy8gQ3JlYXRlIHNjcm9sbExlZnQgYW5kIHNjcm9sbFRvcCBtZXRob2RzXG5qUXVlcnkuZWFjaCggeyBzY3JvbGxMZWZ0OiBcInBhZ2VYT2Zmc2V0XCIsIHNjcm9sbFRvcDogXCJwYWdlWU9mZnNldFwiIH0sIGZ1bmN0aW9uKCBtZXRob2QsIHByb3AgKSB7XG5cdHZhciB0b3AgPSBcInBhZ2VZT2Zmc2V0XCIgPT09IHByb3A7XG5cblx0alF1ZXJ5LmZuWyBtZXRob2QgXSA9IGZ1bmN0aW9uKCB2YWwgKSB7XG5cdFx0cmV0dXJuIGFjY2VzcyggdGhpcywgZnVuY3Rpb24oIGVsZW0sIG1ldGhvZCwgdmFsICkge1xuXHRcdFx0dmFyIHdpbiA9IGdldFdpbmRvdyggZWxlbSApO1xuXG5cdFx0XHRpZiAoIHZhbCA9PT0gdW5kZWZpbmVkICkge1xuXHRcdFx0XHRyZXR1cm4gd2luID8gd2luWyBwcm9wIF0gOiBlbGVtWyBtZXRob2QgXTtcblx0XHRcdH1cblxuXHRcdFx0aWYgKCB3aW4gKSB7XG5cdFx0XHRcdHdpbi5zY3JvbGxUbyhcblx0XHRcdFx0XHQhdG9wID8gdmFsIDogd2luZG93LnBhZ2VYT2Zmc2V0LFxuXHRcdFx0XHRcdHRvcCA/IHZhbCA6IHdpbmRvdy5wYWdlWU9mZnNldFxuXHRcdFx0XHQpO1xuXG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRlbGVtWyBtZXRob2QgXSA9IHZhbDtcblx0XHRcdH1cblx0XHR9LCBtZXRob2QsIHZhbCwgYXJndW1lbnRzLmxlbmd0aCwgbnVsbCApO1xuXHR9O1xufSk7XG5cbi8vIFN1cHBvcnQ6IFNhZmFyaTw3KywgQ2hyb21lPDM3K1xuLy8gQWRkIHRoZSB0b3AvbGVmdCBjc3NIb29rcyB1c2luZyBqUXVlcnkuZm4ucG9zaXRpb25cbi8vIFdlYmtpdCBidWc6IGh0dHBzOi8vYnVncy53ZWJraXQub3JnL3Nob3dfYnVnLmNnaT9pZD0yOTA4NFxuLy8gQmxpbmsgYnVnOiBodHRwczovL2NvZGUuZ29vZ2xlLmNvbS9wL2Nocm9taXVtL2lzc3Vlcy9kZXRhaWw/aWQ9MjI5MjgwXG4vLyBnZXRDb21wdXRlZFN0eWxlIHJldHVybnMgcGVyY2VudCB3aGVuIHNwZWNpZmllZCBmb3IgdG9wL2xlZnQvYm90dG9tL3JpZ2h0O1xuLy8gcmF0aGVyIHRoYW4gbWFrZSB0aGUgY3NzIG1vZHVsZSBkZXBlbmQgb24gdGhlIG9mZnNldCBtb2R1bGUsIGp1c3QgY2hlY2sgZm9yIGl0IGhlcmVcbmpRdWVyeS5lYWNoKCBbIFwidG9wXCIsIFwibGVmdFwiIF0sIGZ1bmN0aW9uKCBpLCBwcm9wICkge1xuXHRqUXVlcnkuY3NzSG9va3NbIHByb3AgXSA9IGFkZEdldEhvb2tJZiggc3VwcG9ydC5waXhlbFBvc2l0aW9uLFxuXHRcdGZ1bmN0aW9uKCBlbGVtLCBjb21wdXRlZCApIHtcblx0XHRcdGlmICggY29tcHV0ZWQgKSB7XG5cdFx0XHRcdGNvbXB1dGVkID0gY3VyQ1NTKCBlbGVtLCBwcm9wICk7XG5cdFx0XHRcdC8vIElmIGN1ckNTUyByZXR1cm5zIHBlcmNlbnRhZ2UsIGZhbGxiYWNrIHRvIG9mZnNldFxuXHRcdFx0XHRyZXR1cm4gcm51bW5vbnB4LnRlc3QoIGNvbXB1dGVkICkgP1xuXHRcdFx0XHRcdGpRdWVyeSggZWxlbSApLnBvc2l0aW9uKClbIHByb3AgXSArIFwicHhcIiA6XG5cdFx0XHRcdFx0Y29tcHV0ZWQ7XG5cdFx0XHR9XG5cdFx0fVxuXHQpO1xufSk7XG5cblxuLy8gQ3JlYXRlIGlubmVySGVpZ2h0LCBpbm5lcldpZHRoLCBoZWlnaHQsIHdpZHRoLCBvdXRlckhlaWdodCBhbmQgb3V0ZXJXaWR0aCBtZXRob2RzXG5qUXVlcnkuZWFjaCggeyBIZWlnaHQ6IFwiaGVpZ2h0XCIsIFdpZHRoOiBcIndpZHRoXCIgfSwgZnVuY3Rpb24oIG5hbWUsIHR5cGUgKSB7XG5cdGpRdWVyeS5lYWNoKCB7IHBhZGRpbmc6IFwiaW5uZXJcIiArIG5hbWUsIGNvbnRlbnQ6IHR5cGUsIFwiXCI6IFwib3V0ZXJcIiArIG5hbWUgfSwgZnVuY3Rpb24oIGRlZmF1bHRFeHRyYSwgZnVuY05hbWUgKSB7XG5cdFx0Ly8gTWFyZ2luIGlzIG9ubHkgZm9yIG91dGVySGVpZ2h0LCBvdXRlcldpZHRoXG5cdFx0alF1ZXJ5LmZuWyBmdW5jTmFtZSBdID0gZnVuY3Rpb24oIG1hcmdpbiwgdmFsdWUgKSB7XG5cdFx0XHR2YXIgY2hhaW5hYmxlID0gYXJndW1lbnRzLmxlbmd0aCAmJiAoIGRlZmF1bHRFeHRyYSB8fCB0eXBlb2YgbWFyZ2luICE9PSBcImJvb2xlYW5cIiApLFxuXHRcdFx0XHRleHRyYSA9IGRlZmF1bHRFeHRyYSB8fCAoIG1hcmdpbiA9PT0gdHJ1ZSB8fCB2YWx1ZSA9PT0gdHJ1ZSA/IFwibWFyZ2luXCIgOiBcImJvcmRlclwiICk7XG5cblx0XHRcdHJldHVybiBhY2Nlc3MoIHRoaXMsIGZ1bmN0aW9uKCBlbGVtLCB0eXBlLCB2YWx1ZSApIHtcblx0XHRcdFx0dmFyIGRvYztcblxuXHRcdFx0XHRpZiAoIGpRdWVyeS5pc1dpbmRvdyggZWxlbSApICkge1xuXHRcdFx0XHRcdC8vIEFzIG9mIDUvOC8yMDEyIHRoaXMgd2lsbCB5aWVsZCBpbmNvcnJlY3QgcmVzdWx0cyBmb3IgTW9iaWxlIFNhZmFyaSwgYnV0IHRoZXJlXG5cdFx0XHRcdFx0Ly8gaXNuJ3QgYSB3aG9sZSBsb3Qgd2UgY2FuIGRvLiBTZWUgcHVsbCByZXF1ZXN0IGF0IHRoaXMgVVJMIGZvciBkaXNjdXNzaW9uOlxuXHRcdFx0XHRcdC8vIGh0dHBzOi8vZ2l0aHViLmNvbS9qcXVlcnkvanF1ZXJ5L3B1bGwvNzY0XG5cdFx0XHRcdFx0cmV0dXJuIGVsZW0uZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50WyBcImNsaWVudFwiICsgbmFtZSBdO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0Ly8gR2V0IGRvY3VtZW50IHdpZHRoIG9yIGhlaWdodFxuXHRcdFx0XHRpZiAoIGVsZW0ubm9kZVR5cGUgPT09IDkgKSB7XG5cdFx0XHRcdFx0ZG9jID0gZWxlbS5kb2N1bWVudEVsZW1lbnQ7XG5cblx0XHRcdFx0XHQvLyBFaXRoZXIgc2Nyb2xsW1dpZHRoL0hlaWdodF0gb3Igb2Zmc2V0W1dpZHRoL0hlaWdodF0gb3IgY2xpZW50W1dpZHRoL0hlaWdodF0sXG5cdFx0XHRcdFx0Ly8gd2hpY2hldmVyIGlzIGdyZWF0ZXN0XG5cdFx0XHRcdFx0cmV0dXJuIE1hdGgubWF4KFxuXHRcdFx0XHRcdFx0ZWxlbS5ib2R5WyBcInNjcm9sbFwiICsgbmFtZSBdLCBkb2NbIFwic2Nyb2xsXCIgKyBuYW1lIF0sXG5cdFx0XHRcdFx0XHRlbGVtLmJvZHlbIFwib2Zmc2V0XCIgKyBuYW1lIF0sIGRvY1sgXCJvZmZzZXRcIiArIG5hbWUgXSxcblx0XHRcdFx0XHRcdGRvY1sgXCJjbGllbnRcIiArIG5hbWUgXVxuXHRcdFx0XHRcdCk7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHRyZXR1cm4gdmFsdWUgPT09IHVuZGVmaW5lZCA/XG5cdFx0XHRcdFx0Ly8gR2V0IHdpZHRoIG9yIGhlaWdodCBvbiB0aGUgZWxlbWVudCwgcmVxdWVzdGluZyBidXQgbm90IGZvcmNpbmcgcGFyc2VGbG9hdFxuXHRcdFx0XHRcdGpRdWVyeS5jc3MoIGVsZW0sIHR5cGUsIGV4dHJhICkgOlxuXG5cdFx0XHRcdFx0Ly8gU2V0IHdpZHRoIG9yIGhlaWdodCBvbiB0aGUgZWxlbWVudFxuXHRcdFx0XHRcdGpRdWVyeS5zdHlsZSggZWxlbSwgdHlwZSwgdmFsdWUsIGV4dHJhICk7XG5cdFx0XHR9LCB0eXBlLCBjaGFpbmFibGUgPyBtYXJnaW4gOiB1bmRlZmluZWQsIGNoYWluYWJsZSwgbnVsbCApO1xuXHRcdH07XG5cdH0pO1xufSk7XG5cblxuLy8gVGhlIG51bWJlciBvZiBlbGVtZW50cyBjb250YWluZWQgaW4gdGhlIG1hdGNoZWQgZWxlbWVudCBzZXRcbmpRdWVyeS5mbi5zaXplID0gZnVuY3Rpb24oKSB7XG5cdHJldHVybiB0aGlzLmxlbmd0aDtcbn07XG5cbmpRdWVyeS5mbi5hbmRTZWxmID0galF1ZXJ5LmZuLmFkZEJhY2s7XG5cblxuXG5cbi8vIFJlZ2lzdGVyIGFzIGEgbmFtZWQgQU1EIG1vZHVsZSwgc2luY2UgalF1ZXJ5IGNhbiBiZSBjb25jYXRlbmF0ZWQgd2l0aCBvdGhlclxuLy8gZmlsZXMgdGhhdCBtYXkgdXNlIGRlZmluZSwgYnV0IG5vdCB2aWEgYSBwcm9wZXIgY29uY2F0ZW5hdGlvbiBzY3JpcHQgdGhhdFxuLy8gdW5kZXJzdGFuZHMgYW5vbnltb3VzIEFNRCBtb2R1bGVzLiBBIG5hbWVkIEFNRCBpcyBzYWZlc3QgYW5kIG1vc3Qgcm9idXN0XG4vLyB3YXkgdG8gcmVnaXN0ZXIuIExvd2VyY2FzZSBqcXVlcnkgaXMgdXNlZCBiZWNhdXNlIEFNRCBtb2R1bGUgbmFtZXMgYXJlXG4vLyBkZXJpdmVkIGZyb20gZmlsZSBuYW1lcywgYW5kIGpRdWVyeSBpcyBub3JtYWxseSBkZWxpdmVyZWQgaW4gYSBsb3dlcmNhc2Vcbi8vIGZpbGUgbmFtZS4gRG8gdGhpcyBhZnRlciBjcmVhdGluZyB0aGUgZ2xvYmFsIHNvIHRoYXQgaWYgYW4gQU1EIG1vZHVsZSB3YW50c1xuLy8gdG8gY2FsbCBub0NvbmZsaWN0IHRvIGhpZGUgdGhpcyB2ZXJzaW9uIG9mIGpRdWVyeSwgaXQgd2lsbCB3b3JrLlxuXG4vLyBOb3RlIHRoYXQgZm9yIG1heGltdW0gcG9ydGFiaWxpdHksIGxpYnJhcmllcyB0aGF0IGFyZSBub3QgalF1ZXJ5IHNob3VsZFxuLy8gZGVjbGFyZSB0aGVtc2VsdmVzIGFzIGFub255bW91cyBtb2R1bGVzLCBhbmQgYXZvaWQgc2V0dGluZyBhIGdsb2JhbCBpZiBhblxuLy8gQU1EIGxvYWRlciBpcyBwcmVzZW50LiBqUXVlcnkgaXMgYSBzcGVjaWFsIGNhc2UuIEZvciBtb3JlIGluZm9ybWF0aW9uLCBzZWVcbi8vIGh0dHBzOi8vZ2l0aHViLmNvbS9qcmJ1cmtlL3JlcXVpcmVqcy93aWtpL1VwZGF0aW5nLWV4aXN0aW5nLWxpYnJhcmllcyN3aWtpLWFub25cblxuaWYgKCB0eXBlb2YgZGVmaW5lID09PSBcImZ1bmN0aW9uXCIgJiYgZGVmaW5lLmFtZCApIHtcblx0ZGVmaW5lKCBcImpxdWVyeVwiLCBbXSwgZnVuY3Rpb24oKSB7XG5cdFx0cmV0dXJuIGpRdWVyeTtcblx0fSk7XG59XG5cblxuXG5cbnZhclxuXHQvLyBNYXAgb3ZlciBqUXVlcnkgaW4gY2FzZSBvZiBvdmVyd3JpdGVcblx0X2pRdWVyeSA9IHdpbmRvdy5qUXVlcnksXG5cblx0Ly8gTWFwIG92ZXIgdGhlICQgaW4gY2FzZSBvZiBvdmVyd3JpdGVcblx0XyQgPSB3aW5kb3cuJDtcblxualF1ZXJ5Lm5vQ29uZmxpY3QgPSBmdW5jdGlvbiggZGVlcCApIHtcblx0aWYgKCB3aW5kb3cuJCA9PT0galF1ZXJ5ICkge1xuXHRcdHdpbmRvdy4kID0gXyQ7XG5cdH1cblxuXHRpZiAoIGRlZXAgJiYgd2luZG93LmpRdWVyeSA9PT0galF1ZXJ5ICkge1xuXHRcdHdpbmRvdy5qUXVlcnkgPSBfalF1ZXJ5O1xuXHR9XG5cblx0cmV0dXJuIGpRdWVyeTtcbn07XG5cbi8vIEV4cG9zZSBqUXVlcnkgYW5kICQgaWRlbnRpZmllcnMsIGV2ZW4gaW4gQU1EXG4vLyAoIzcxMDIjY29tbWVudDoxMCwgaHR0cHM6Ly9naXRodWIuY29tL2pxdWVyeS9qcXVlcnkvcHVsbC81NTcpXG4vLyBhbmQgQ29tbW9uSlMgZm9yIGJyb3dzZXIgZW11bGF0b3JzICgjMTM1NjYpXG5pZiAoIHR5cGVvZiBub0dsb2JhbCA9PT0gc3RydW5kZWZpbmVkICkge1xuXHR3aW5kb3cualF1ZXJ5ID0gd2luZG93LiQgPSBqUXVlcnk7XG59XG5cblxuXG5cbnJldHVybiBqUXVlcnk7XG5cbn0pKTtcbiIsIi8vIGh0dHA6Ly9zdGFja292ZXJmbG93LmNvbS9xdWVzdGlvbnMvODM5ODk5L2hvdy1kby1pLWNhbGN1bGF0ZS1hLXBvaW50LW9uLWEtY2lyY2xlcy1jaXJjdW1mZXJlbmNlXG4vLyByYWRpYW5zID0gZGVncmVlcyAqIChwaS8xODApXG4vLyBodHRwczovL2dpdGh1Yi5jb20vYmpvcm5oYXJydGVsbC9qc3RzL2Jsb2IvbWFzdGVyL2V4YW1wbGVzL2J1ZmZlci5odG1sXG5cbnZhciBmZWF0dXJlY29sbGVjdGlvbiA9IHJlcXVpcmUoJ3R1cmYtZmVhdHVyZWNvbGxlY3Rpb24nKTtcbnZhciBqc3RzID0gcmVxdWlyZSgnanN0cycpO1xudmFyIG5vcm1hbGl6ZSA9IHJlcXVpcmUoJ2dlb2pzb24tbm9ybWFsaXplJyk7XG5cbi8qKlxuKiBDYWxjdWxhdGVzIGEgYnVmZmVyIGZvciBpbnB1dCBmZWF0dXJlcyBmb3IgYSBnaXZlbiByYWRpdXMuIFVuaXRzIHN1cHBvcnRlZCBhcmUgbWlsZXMsIGtpbG9tZXRlcnMsIGFuZCBkZWdyZWVzLlxuKlxuKiBAbW9kdWxlIHR1cmYvYnVmZmVyXG4qIEBjYXRlZ29yeSB0cmFuc2Zvcm1hdGlvblxuKiBAcGFyYW0geyhGZWF0dXJlfEZlYXR1cmVDb2xsZWN0aW9uKX0gZmVhdHVyZSBpbnB1dCB0byBiZSBidWZmZXJlZFxuKiBAcGFyYW0ge051bWJlcn0gZGlzdGFuY2UgZGlzdGFuY2UgdG8gZHJhdyB0aGUgYnVmZmVyXG4qIEBwYXJhbSB7U3RyaW5nfSB1bml0ICdtaWxlcycsICdmZWV0JywgJ2tpbG9tZXRlcnMnLCAnbWV0ZXJzJywgb3IgJ2RlZ3JlZXMnXG4qIEByZXR1cm4ge0ZlYXR1cmVDb2xsZWN0aW9uPFBvbHlnb24+fEZlYXR1cmVDb2xsZWN0aW9uPE11bHRpUG9seWdvbj58UG9seWdvbnxNdWx0aVBvbHlnb259IGJ1ZmZlcmVkIGZlYXR1cmVzXG4qXG4qIEBleGFtcGxlXG4qIHZhciBwdCA9IHtcbiogICBcInR5cGVcIjogXCJGZWF0dXJlXCIsXG4qICAgXCJwcm9wZXJ0aWVzXCI6IHt9LFxuKiAgIFwiZ2VvbWV0cnlcIjoge1xuKiAgICAgXCJ0eXBlXCI6IFwiUG9pbnRcIixcbiogICAgIFwiY29vcmRpbmF0ZXNcIjogWy05MC41NDg2MzAsIDE0LjYxNjU5OV1cbiogICB9XG4qIH07XG4qIHZhciB1bml0ID0gJ21pbGVzJztcbipcbiogdmFyIGJ1ZmZlcmVkID0gdHVyZi5idWZmZXIocHQsIDUwMCwgdW5pdCk7XG4qIHZhciByZXN1bHQgPSB0dXJmLmZlYXR1cmVjb2xsZWN0aW9uKFtidWZmZXJlZCwgcHRdKTtcbipcbiogLy89cmVzdWx0XG4qL1xuXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGZlYXR1cmUsIHJhZGl1cywgdW5pdHMpIHtcblxuICBzd2l0Y2ggKHVuaXRzKSB7XG4gICAgY2FzZSAnbWlsZXMnOlxuICAgICAgcmFkaXVzID0gcmFkaXVzIC8gNjkuMDQ3O1xuICAgIGJyZWFrO1xuICAgIGNhc2UgJ2ZlZXQnOlxuICAgICAgcmFkaXVzID0gcmFkaXVzIC8gMzY0NTY4LjA7XG4gICAgYnJlYWs7XG4gICAgY2FzZSAna2lsb21ldGVycyc6XG4gICAgICByYWRpdXMgPSByYWRpdXMgLyAxMTEuMTI7XG4gICAgYnJlYWs7XG4gICAgY2FzZSAnbWV0ZXJzJzpcbiAgICAgIHJhZGl1cyA9IHJhZGl1cyAvIDExMTEyMC4wO1xuICAgIGJyZWFrO1xuICAgIGNhc2UgJ2RlZ3JlZXMnOlxuICAgIGJyZWFrO1xuICB9XG5cbiAgdmFyIGZjID0gbm9ybWFsaXplKGZlYXR1cmUpO1xuICB2YXIgYnVmZmVyZWQgPSBub3JtYWxpemUoZmVhdHVyZWNvbGxlY3Rpb24oZmMuZmVhdHVyZXMubWFwKGZ1bmN0aW9uKGYpIHtcbiAgICByZXR1cm4gYnVmZmVyT3AoZiwgcmFkaXVzKTtcbiAgfSkpKTtcblxuICBpZihidWZmZXJlZC5mZWF0dXJlcy5sZW5ndGggPiAxKSByZXR1cm4gYnVmZmVyZWQ7XG4gIGVsc2UgaWYoYnVmZmVyZWQuZmVhdHVyZXMubGVuZ3RoID09PSAxKSByZXR1cm4gYnVmZmVyZWQuZmVhdHVyZXNbMF07XG59O1xuXG52YXIgYnVmZmVyT3AgPSBmdW5jdGlvbihmZWF0dXJlLCByYWRpdXMpIHtcbiAgdmFyIHJlYWRlciA9IG5ldyBqc3RzLmlvLkdlb0pTT05SZWFkZXIoKTtcbiAgdmFyIGdlb20gPSByZWFkZXIucmVhZChKU09OLnN0cmluZ2lmeShmZWF0dXJlLmdlb21ldHJ5KSk7XG4gIHZhciBidWZmZXJlZCA9IGdlb20uYnVmZmVyKHJhZGl1cyk7XG4gIHZhciBwYXJzZXIgPSBuZXcganN0cy5pby5HZW9KU09OUGFyc2VyKCk7XG4gIGJ1ZmZlcmVkID0gcGFyc2VyLndyaXRlKGJ1ZmZlcmVkKTtcblxuICByZXR1cm4ge1xuICAgIHR5cGU6ICdGZWF0dXJlJyxcbiAgICBnZW9tZXRyeTogYnVmZmVyZWQsXG4gICAgcHJvcGVydGllczoge31cbiAgfTtcbn07XG4iLCJtb2R1bGUuZXhwb3J0cyA9IG5vcm1hbGl6ZTtcblxudmFyIHR5cGVzID0ge1xuICAgIFBvaW50OiAnZ2VvbWV0cnknLFxuICAgIE11bHRpUG9pbnQ6ICdnZW9tZXRyeScsXG4gICAgTGluZVN0cmluZzogJ2dlb21ldHJ5JyxcbiAgICBNdWx0aUxpbmVTdHJpbmc6ICdnZW9tZXRyeScsXG4gICAgUG9seWdvbjogJ2dlb21ldHJ5JyxcbiAgICBNdWx0aVBvbHlnb246ICdnZW9tZXRyeScsXG4gICAgR2VvbWV0cnlDb2xsZWN0aW9uOiAnZ2VvbWV0cnknLFxuICAgIEZlYXR1cmU6ICdmZWF0dXJlJyxcbiAgICBGZWF0dXJlQ29sbGVjdGlvbjogJ2ZlYXR1cmVjb2xsZWN0aW9uJ1xufTtcblxuLyoqXG4gKiBOb3JtYWxpemUgYSBHZW9KU09OIGZlYXR1cmUgaW50byBhIEZlYXR1cmVDb2xsZWN0aW9uLlxuICpcbiAqIEBwYXJhbSB7b2JqZWN0fSBnaiBnZW9qc29uIGRhdGFcbiAqIEByZXR1cm5zIHtvYmplY3R9IG5vcm1hbGl6ZWQgZ2VvanNvbiBkYXRhXG4gKi9cbmZ1bmN0aW9uIG5vcm1hbGl6ZShnaikge1xuICAgIGlmICghZ2ogfHwgIWdqLnR5cGUpIHJldHVybiBudWxsO1xuICAgIHZhciB0eXBlID0gdHlwZXNbZ2oudHlwZV07XG4gICAgaWYgKCF0eXBlKSByZXR1cm4gbnVsbDtcblxuICAgIGlmICh0eXBlID09PSAnZ2VvbWV0cnknKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICB0eXBlOiAnRmVhdHVyZUNvbGxlY3Rpb24nLFxuICAgICAgICAgICAgZmVhdHVyZXM6IFt7XG4gICAgICAgICAgICAgICAgdHlwZTogJ0ZlYXR1cmUnLFxuICAgICAgICAgICAgICAgIHByb3BlcnRpZXM6IHt9LFxuICAgICAgICAgICAgICAgIGdlb21ldHJ5OiBnalxuICAgICAgICAgICAgfV1cbiAgICAgICAgfTtcbiAgICB9IGVsc2UgaWYgKHR5cGUgPT09ICdmZWF0dXJlJykge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgdHlwZTogJ0ZlYXR1cmVDb2xsZWN0aW9uJyxcbiAgICAgICAgICAgIGZlYXR1cmVzOiBbZ2pdXG4gICAgICAgIH07XG4gICAgfSBlbHNlIGlmICh0eXBlID09PSAnZmVhdHVyZWNvbGxlY3Rpb24nKSB7XG4gICAgICAgIHJldHVybiBnajtcbiAgICB9XG59XG4iLCJyZXF1aXJlKCdqYXZhc2NyaXB0LnV0aWwnKTtcbnZhciBqc3RzID0gcmVxdWlyZSgnLi9saWIvanN0cycpO1xubW9kdWxlLmV4cG9ydHMgPSBqc3RzXG4iLCIvKiBUaGUgSlNUUyBUb3BvbG9neSBTdWl0ZSBpcyBhIGNvbGxlY3Rpb24gb2YgSmF2YVNjcmlwdCBjbGFzc2VzIHRoYXRcbmltcGxlbWVudCB0aGUgZnVuZGFtZW50YWwgb3BlcmF0aW9ucyByZXF1aXJlZCB0byB2YWxpZGF0ZSBhIGdpdmVuXG5nZW8tc3BhdGlhbCBkYXRhIHNldCB0byBhIGtub3duIHRvcG9sb2dpY2FsIHNwZWNpZmljYXRpb24uXG5cbkNvcHlyaWdodCAoQykgMjAxMSBUaGUgQXV0aG9yc1xuXG5UaGlzIGxpYnJhcnkgaXMgZnJlZSBzb2Z0d2FyZTsgeW91IGNhbiByZWRpc3RyaWJ1dGUgaXQgYW5kL29yXG5tb2RpZnkgaXQgdW5kZXIgdGhlIHRlcm1zIG9mIHRoZSBHTlUgTGVzc2VyIEdlbmVyYWwgUHVibGljXG5MaWNlbnNlIGFzIHB1Ymxpc2hlZCBieSB0aGUgRnJlZSBTb2Z0d2FyZSBGb3VuZGF0aW9uOyBlaXRoZXJcbnZlcnNpb24gMi4xIG9mIHRoZSBMaWNlbnNlLCBvciAoYXQgeW91ciBvcHRpb24pIGFueSBsYXRlciB2ZXJzaW9uLlxuXG5UaGlzIGxpYnJhcnkgaXMgZGlzdHJpYnV0ZWQgaW4gdGhlIGhvcGUgdGhhdCBpdCB3aWxsIGJlIHVzZWZ1bCxcbmJ1dCBXSVRIT1VUIEFOWSBXQVJSQU5UWTsgd2l0aG91dCBldmVuIHRoZSBpbXBsaWVkIHdhcnJhbnR5IG9mXG5NRVJDSEFOVEFCSUxJVFkgb3IgRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UuICBTZWUgdGhlIEdOVVxuTGVzc2VyIEdlbmVyYWwgUHVibGljIExpY2Vuc2UgZm9yIG1vcmUgZGV0YWlscy5cblxuWW91IHNob3VsZCBoYXZlIHJlY2VpdmVkIGEgY29weSBvZiB0aGUgR05VIExlc3NlciBHZW5lcmFsIFB1YmxpY1xuTGljZW5zZSBhbG9uZyB3aXRoIHRoaXMgbGlicmFyeTsgaWYgbm90LCB3cml0ZSB0byB0aGUgRnJlZSBTb2Z0d2FyZVxuRm91bmRhdGlvbiwgSW5jLiwgNTkgVGVtcGxlIFBsYWNlLCBTdWl0ZSAzMzAsIEJvc3RvbiwgTUEgIDAyMTExLTEzMDcgIFVTQSAqL1xuanN0cz17dmVyc2lvbjonMC4xNS4wJyxhbGdvcml0aG06e2Rpc3RhbmNlOnt9LGxvY2F0ZTp7fX0sZXJyb3I6e30sZ2VvbTp7dXRpbDp7fX0sZ2VvbWdyYXBoOntpbmRleDp7fX0saW5kZXg6e2JpbnRyZWU6e30sY2hhaW46e30sa2R0cmVlOnt9LHF1YWR0cmVlOnt9LHN0cnRyZWU6e319LGlvOnt9LG5vZGluZzp7c25hcHJvdW5kOnt9fSxvcGVyYXRpb246e2J1ZmZlcjp7fSxkaXN0YW5jZTp7fSxvdmVybGF5OntzbmFwOnt9fSxwb2x5Z29uaXplOnt9LHByZWRpY2F0ZTp7fSxyZWxhdGU6e30sdW5pb246e30sdmFsaWQ6e319LHBsYW5hcmdyYXBoOnt9LHNpbXBsaWZ5Ont9LHRyaWFuZ3VsYXRlOntxdWFkZWRnZTp7fX0sdXRpbDp7fX07aWYodHlwZW9mIFN0cmluZy5wcm90b3R5cGUudHJpbSE9PSdmdW5jdGlvbicpe1N0cmluZy5wcm90b3R5cGUudHJpbT1mdW5jdGlvbigpe3JldHVybiB0aGlzLnJlcGxhY2UoL15cXHMrfFxccyskL2csJycpO307fVxuanN0cy5hYnN0cmFjdEZ1bmM9ZnVuY3Rpb24oKXt0aHJvdyBuZXcganN0cy5lcnJvci5BYnN0cmFjdE1ldGhvZEludm9jYXRpb25FcnJvcigpO307anN0cy5lcnJvcj17fTtqc3RzLmVycm9yLklsbGVnYWxBcmd1bWVudEVycm9yPWZ1bmN0aW9uKG1lc3NhZ2Upe3RoaXMubmFtZT0nSWxsZWdhbEFyZ3VtZW50RXJyb3InO3RoaXMubWVzc2FnZT1tZXNzYWdlO307anN0cy5lcnJvci5JbGxlZ2FsQXJndW1lbnRFcnJvci5wcm90b3R5cGU9bmV3IEVycm9yKCk7anN0cy5lcnJvci5Ub3BvbG9neUVycm9yPWZ1bmN0aW9uKG1lc3NhZ2UscHQpe3RoaXMubmFtZT0nVG9wb2xvZ3lFcnJvcic7dGhpcy5tZXNzYWdlPXB0P21lc3NhZ2UrJyBbICcrcHQrJyBdJzptZXNzYWdlO307anN0cy5lcnJvci5Ub3BvbG9neUVycm9yLnByb3RvdHlwZT1uZXcgRXJyb3IoKTtqc3RzLmVycm9yLkFic3RyYWN0TWV0aG9kSW52b2NhdGlvbkVycm9yPWZ1bmN0aW9uKCl7dGhpcy5uYW1lPSdBYnN0cmFjdE1ldGhvZEludm9jYXRpb25FcnJvcic7dGhpcy5tZXNzYWdlPSdBYnN0cmFjdCBtZXRob2QgY2FsbGVkLCBzaG91bGQgYmUgaW1wbGVtZW50ZWQgaW4gc3ViY2xhc3MuJzt9O2pzdHMuZXJyb3IuQWJzdHJhY3RNZXRob2RJbnZvY2F0aW9uRXJyb3IucHJvdG90eXBlPW5ldyBFcnJvcigpO2pzdHMuZXJyb3IuTm90SW1wbGVtZW50ZWRFcnJvcj1mdW5jdGlvbigpe3RoaXMubmFtZT0nTm90SW1wbGVtZW50ZWRFcnJvcic7dGhpcy5tZXNzYWdlPSdUaGlzIG1ldGhvZCBoYXMgbm90IHlldCBiZWVuIGltcGxlbWVudGVkLic7fTtqc3RzLmVycm9yLk5vdEltcGxlbWVudGVkRXJyb3IucHJvdG90eXBlPW5ldyBFcnJvcigpO2pzdHMuZXJyb3IuTm90UmVwcmVzZW50YWJsZUVycm9yPWZ1bmN0aW9uKG1lc3NhZ2Upe3RoaXMubmFtZT0nTm90UmVwcmVzZW50YWJsZUVycm9yJzt0aGlzLm1lc3NhZ2U9bWVzc2FnZTt9O2pzdHMuZXJyb3IuTm90UmVwcmVzZW50YWJsZUVycm9yLnByb3RvdHlwZT1uZXcgRXJyb3IoKTtqc3RzLmVycm9yLkxvY2F0ZUZhaWx1cmVFcnJvcj1mdW5jdGlvbihtZXNzYWdlKXt0aGlzLm5hbWU9J0xvY2F0ZUZhaWx1cmVFcnJvcic7dGhpcy5tZXNzYWdlPW1lc3NhZ2U7fTtqc3RzLmVycm9yLkxvY2F0ZUZhaWx1cmVFcnJvci5wcm90b3R5cGU9bmV3IEVycm9yKCk7aWYodHlwZW9mIG1vZHVsZSE9PVwidW5kZWZpbmVkXCIpbW9kdWxlLmV4cG9ydHM9anN0cztqc3RzLmdlb20uR2VvbWV0cnlGaWx0ZXI9ZnVuY3Rpb24oKXt9O2pzdHMuZ2VvbS5HZW9tZXRyeUZpbHRlci5wcm90b3R5cGUuZmlsdGVyPWZ1bmN0aW9uKGdlb20pe3Rocm93IG5ldyBqc3RzLmVycm9yLkFic3RyYWN0TWV0aG9kSW52b2NhdGlvbkVycm9yKCk7fTtqc3RzLmdlb20udXRpbC5Qb2x5Z29uRXh0cmFjdGVyPWZ1bmN0aW9uKGNvbXBzKXt0aGlzLmNvbXBzPWNvbXBzO307anN0cy5nZW9tLnV0aWwuUG9seWdvbkV4dHJhY3Rlci5wcm90b3R5cGU9bmV3IGpzdHMuZ2VvbS5HZW9tZXRyeUZpbHRlcigpO2pzdHMuZ2VvbS51dGlsLlBvbHlnb25FeHRyYWN0ZXIucHJvdG90eXBlLmNvbXBzPW51bGw7anN0cy5nZW9tLnV0aWwuUG9seWdvbkV4dHJhY3Rlci5nZXRQb2x5Z29ucz1mdW5jdGlvbihnZW9tLGxpc3Qpe2lmKGxpc3Q9PT11bmRlZmluZWQpe2xpc3Q9W107fVxuaWYoZ2VvbSBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5Qb2x5Z29uKXtsaXN0LnB1c2goZ2VvbSk7fWVsc2UgaWYoZ2VvbSBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5HZW9tZXRyeUNvbGxlY3Rpb24pe2dlb20uYXBwbHkobmV3IGpzdHMuZ2VvbS51dGlsLlBvbHlnb25FeHRyYWN0ZXIobGlzdCkpO31cbnJldHVybiBsaXN0O307anN0cy5nZW9tLnV0aWwuUG9seWdvbkV4dHJhY3Rlci5wcm90b3R5cGUuZmlsdGVyPWZ1bmN0aW9uKGdlb20pe2lmKGdlb20gaW5zdGFuY2VvZiBqc3RzLmdlb20uUG9seWdvbilcbnRoaXMuY29tcHMucHVzaChnZW9tKTt9O2pzdHMuaW8uV0tUUGFyc2VyPWZ1bmN0aW9uKGdlb21ldHJ5RmFjdG9yeSl7dGhpcy5nZW9tZXRyeUZhY3Rvcnk9Z2VvbWV0cnlGYWN0b3J5fHxuZXcganN0cy5nZW9tLkdlb21ldHJ5RmFjdG9yeSgpO3RoaXMucmVnRXhlcz17J3R5cGVTdHInOi9eXFxzKihcXHcrKVxccypcXChcXHMqKC4qKVxccypcXClcXHMqJC8sJ2VtcHR5VHlwZVN0cic6L15cXHMqKFxcdyspXFxzKkVNUFRZXFxzKiQvLCdzcGFjZXMnOi9cXHMrLywncGFyZW5Db21tYSc6L1xcKVxccyosXFxzKlxcKC8sJ2RvdWJsZVBhcmVuQ29tbWEnOi9cXClcXHMqXFwpXFxzKixcXHMqXFwoXFxzKlxcKC8sJ3RyaW1QYXJlbnMnOi9eXFxzKlxcKD8oLio/KVxcKT9cXHMqJC99O307anN0cy5pby5XS1RQYXJzZXIucHJvdG90eXBlLnJlYWQ9ZnVuY3Rpb24od2t0KXt2YXIgZ2VvbWV0cnksdHlwZSxzdHI7d2t0PXdrdC5yZXBsYWNlKC9bXFxuXFxyXS9nLCcgJyk7dmFyIG1hdGNoZXM9dGhpcy5yZWdFeGVzLnR5cGVTdHIuZXhlYyh3a3QpO2lmKHdrdC5zZWFyY2goJ0VNUFRZJykhPT0tMSl7bWF0Y2hlcz10aGlzLnJlZ0V4ZXMuZW1wdHlUeXBlU3RyLmV4ZWMod2t0KTttYXRjaGVzWzJdPXVuZGVmaW5lZDt9XG5pZihtYXRjaGVzKXt0eXBlPW1hdGNoZXNbMV0udG9Mb3dlckNhc2UoKTtzdHI9bWF0Y2hlc1syXTtpZih0aGlzLnBhcnNlW3R5cGVdKXtnZW9tZXRyeT10aGlzLnBhcnNlW3R5cGVdLmFwcGx5KHRoaXMsW3N0cl0pO319XG5pZihnZW9tZXRyeT09PXVuZGVmaW5lZClcbnRocm93IG5ldyBFcnJvcignQ291bGQgbm90IHBhcnNlIFdLVCAnK3drdCk7cmV0dXJuIGdlb21ldHJ5O307anN0cy5pby5XS1RQYXJzZXIucHJvdG90eXBlLndyaXRlPWZ1bmN0aW9uKGdlb21ldHJ5KXtyZXR1cm4gdGhpcy5leHRyYWN0R2VvbWV0cnkoZ2VvbWV0cnkpO307anN0cy5pby5XS1RQYXJzZXIucHJvdG90eXBlLmV4dHJhY3RHZW9tZXRyeT1mdW5jdGlvbihnZW9tZXRyeSl7dmFyIHR5cGU9Z2VvbWV0cnkuQ0xBU1NfTkFNRS5zcGxpdCgnLicpWzJdLnRvTG93ZXJDYXNlKCk7aWYoIXRoaXMuZXh0cmFjdFt0eXBlXSl7cmV0dXJuIG51bGw7fVxudmFyIHdrdFR5cGU9dHlwZS50b1VwcGVyQ2FzZSgpO3ZhciBkYXRhO2lmKGdlb21ldHJ5LmlzRW1wdHkoKSl7ZGF0YT13a3RUeXBlKycgRU1QVFknO31lbHNle2RhdGE9d2t0VHlwZSsnKCcrdGhpcy5leHRyYWN0W3R5cGVdLmFwcGx5KHRoaXMsW2dlb21ldHJ5XSkrJyknO31cbnJldHVybiBkYXRhO307anN0cy5pby5XS1RQYXJzZXIucHJvdG90eXBlLmV4dHJhY3Q9eydjb29yZGluYXRlJzpmdW5jdGlvbihjb29yZGluYXRlKXtyZXR1cm4gY29vcmRpbmF0ZS54KycgJytjb29yZGluYXRlLnk7fSwncG9pbnQnOmZ1bmN0aW9uKHBvaW50KXtyZXR1cm4gcG9pbnQuY29vcmRpbmF0ZS54KycgJytwb2ludC5jb29yZGluYXRlLnk7fSwnbXVsdGlwb2ludCc6ZnVuY3Rpb24obXVsdGlwb2ludCl7dmFyIGFycmF5PVtdO2Zvcih2YXIgaT0wLGxlbj1tdWx0aXBvaW50Lmdlb21ldHJpZXMubGVuZ3RoO2k8bGVuOysraSl7YXJyYXkucHVzaCgnKCcrXG50aGlzLmV4dHJhY3QucG9pbnQuYXBwbHkodGhpcyxbbXVsdGlwb2ludC5nZW9tZXRyaWVzW2ldXSkrJyknKTt9XG5yZXR1cm4gYXJyYXkuam9pbignLCcpO30sJ2xpbmVzdHJpbmcnOmZ1bmN0aW9uKGxpbmVzdHJpbmcpe3ZhciBhcnJheT1bXTtmb3IodmFyIGk9MCxsZW49bGluZXN0cmluZy5wb2ludHMubGVuZ3RoO2k8bGVuOysraSl7YXJyYXkucHVzaCh0aGlzLmV4dHJhY3QuY29vcmRpbmF0ZS5hcHBseSh0aGlzLFtsaW5lc3RyaW5nLnBvaW50c1tpXV0pKTt9XG5yZXR1cm4gYXJyYXkuam9pbignLCcpO30sJ211bHRpbGluZXN0cmluZyc6ZnVuY3Rpb24obXVsdGlsaW5lc3RyaW5nKXt2YXIgYXJyYXk9W107Zm9yKHZhciBpPTAsbGVuPW11bHRpbGluZXN0cmluZy5nZW9tZXRyaWVzLmxlbmd0aDtpPGxlbjsrK2kpe2FycmF5LnB1c2goJygnK1xudGhpcy5leHRyYWN0LmxpbmVzdHJpbmcuYXBwbHkodGhpcyxbbXVsdGlsaW5lc3RyaW5nLmdlb21ldHJpZXNbaV1dKSsnKScpO31cbnJldHVybiBhcnJheS5qb2luKCcsJyk7fSwncG9seWdvbic6ZnVuY3Rpb24ocG9seWdvbil7dmFyIGFycmF5PVtdO2FycmF5LnB1c2goJygnK3RoaXMuZXh0cmFjdC5saW5lc3RyaW5nLmFwcGx5KHRoaXMsW3BvbHlnb24uc2hlbGxdKSsnKScpO2Zvcih2YXIgaT0wLGxlbj1wb2x5Z29uLmhvbGVzLmxlbmd0aDtpPGxlbjsrK2kpe2FycmF5LnB1c2goJygnK3RoaXMuZXh0cmFjdC5saW5lc3RyaW5nLmFwcGx5KHRoaXMsW3BvbHlnb24uaG9sZXNbaV1dKSsnKScpO31cbnJldHVybiBhcnJheS5qb2luKCcsJyk7fSwnbXVsdGlwb2x5Z29uJzpmdW5jdGlvbihtdWx0aXBvbHlnb24pe3ZhciBhcnJheT1bXTtmb3IodmFyIGk9MCxsZW49bXVsdGlwb2x5Z29uLmdlb21ldHJpZXMubGVuZ3RoO2k8bGVuOysraSl7YXJyYXkucHVzaCgnKCcrdGhpcy5leHRyYWN0LnBvbHlnb24uYXBwbHkodGhpcyxbbXVsdGlwb2x5Z29uLmdlb21ldHJpZXNbaV1dKSsnKScpO31cbnJldHVybiBhcnJheS5qb2luKCcsJyk7fSwnZ2VvbWV0cnljb2xsZWN0aW9uJzpmdW5jdGlvbihjb2xsZWN0aW9uKXt2YXIgYXJyYXk9W107Zm9yKHZhciBpPTAsbGVuPWNvbGxlY3Rpb24uZ2VvbWV0cmllcy5sZW5ndGg7aTxsZW47KytpKXthcnJheS5wdXNoKHRoaXMuZXh0cmFjdEdlb21ldHJ5LmFwcGx5KHRoaXMsW2NvbGxlY3Rpb24uZ2VvbWV0cmllc1tpXV0pKTt9XG5yZXR1cm4gYXJyYXkuam9pbignLCcpO319O2pzdHMuaW8uV0tUUGFyc2VyLnByb3RvdHlwZS5wYXJzZT17J3BvaW50JzpmdW5jdGlvbihzdHIpe2lmKHN0cj09PXVuZGVmaW5lZCl7cmV0dXJuIHRoaXMuZ2VvbWV0cnlGYWN0b3J5LmNyZWF0ZVBvaW50KG51bGwpO31cbnZhciBjb29yZHM9c3RyLnRyaW0oKS5zcGxpdCh0aGlzLnJlZ0V4ZXMuc3BhY2VzKTtyZXR1cm4gdGhpcy5nZW9tZXRyeUZhY3RvcnkuY3JlYXRlUG9pbnQobmV3IGpzdHMuZ2VvbS5Db29yZGluYXRlKGNvb3Jkc1swXSxjb29yZHNbMV0pKTt9LCdtdWx0aXBvaW50JzpmdW5jdGlvbihzdHIpe2lmKHN0cj09PXVuZGVmaW5lZCl7cmV0dXJuIHRoaXMuZ2VvbWV0cnlGYWN0b3J5LmNyZWF0ZU11bHRpUG9pbnQobnVsbCk7fVxudmFyIHBvaW50O3ZhciBwb2ludHM9c3RyLnRyaW0oKS5zcGxpdCgnLCcpO3ZhciBjb21wb25lbnRzPVtdO2Zvcih2YXIgaT0wLGxlbj1wb2ludHMubGVuZ3RoO2k8bGVuOysraSl7cG9pbnQ9cG9pbnRzW2ldLnJlcGxhY2UodGhpcy5yZWdFeGVzLnRyaW1QYXJlbnMsJyQxJyk7Y29tcG9uZW50cy5wdXNoKHRoaXMucGFyc2UucG9pbnQuYXBwbHkodGhpcyxbcG9pbnRdKSk7fVxucmV0dXJuIHRoaXMuZ2VvbWV0cnlGYWN0b3J5LmNyZWF0ZU11bHRpUG9pbnQoY29tcG9uZW50cyk7fSwnbGluZXN0cmluZyc6ZnVuY3Rpb24oc3RyKXtpZihzdHI9PT11bmRlZmluZWQpe3JldHVybiB0aGlzLmdlb21ldHJ5RmFjdG9yeS5jcmVhdGVMaW5lU3RyaW5nKG51bGwpO31cbnZhciBwb2ludHM9c3RyLnRyaW0oKS5zcGxpdCgnLCcpO3ZhciBjb21wb25lbnRzPVtdO3ZhciBjb29yZHM7Zm9yKHZhciBpPTAsbGVuPXBvaW50cy5sZW5ndGg7aTxsZW47KytpKXtjb29yZHM9cG9pbnRzW2ldLnRyaW0oKS5zcGxpdCh0aGlzLnJlZ0V4ZXMuc3BhY2VzKTtjb21wb25lbnRzLnB1c2gobmV3IGpzdHMuZ2VvbS5Db29yZGluYXRlKGNvb3Jkc1swXSxjb29yZHNbMV0pKTt9XG5yZXR1cm4gdGhpcy5nZW9tZXRyeUZhY3RvcnkuY3JlYXRlTGluZVN0cmluZyhjb21wb25lbnRzKTt9LCdsaW5lYXJyaW5nJzpmdW5jdGlvbihzdHIpe2lmKHN0cj09PXVuZGVmaW5lZCl7cmV0dXJuIHRoaXMuZ2VvbWV0cnlGYWN0b3J5LmNyZWF0ZUxpbmVhclJpbmcobnVsbCk7fVxudmFyIHBvaW50cz1zdHIudHJpbSgpLnNwbGl0KCcsJyk7dmFyIGNvbXBvbmVudHM9W107dmFyIGNvb3Jkcztmb3IodmFyIGk9MCxsZW49cG9pbnRzLmxlbmd0aDtpPGxlbjsrK2kpe2Nvb3Jkcz1wb2ludHNbaV0udHJpbSgpLnNwbGl0KHRoaXMucmVnRXhlcy5zcGFjZXMpO2NvbXBvbmVudHMucHVzaChuZXcganN0cy5nZW9tLkNvb3JkaW5hdGUoY29vcmRzWzBdLGNvb3Jkc1sxXSkpO31cbnJldHVybiB0aGlzLmdlb21ldHJ5RmFjdG9yeS5jcmVhdGVMaW5lYXJSaW5nKGNvbXBvbmVudHMpO30sJ211bHRpbGluZXN0cmluZyc6ZnVuY3Rpb24oc3RyKXtpZihzdHI9PT11bmRlZmluZWQpe3JldHVybiB0aGlzLmdlb21ldHJ5RmFjdG9yeS5jcmVhdGVNdWx0aUxpbmVTdHJpbmcobnVsbCk7fVxudmFyIGxpbmU7dmFyIGxpbmVzPXN0ci50cmltKCkuc3BsaXQodGhpcy5yZWdFeGVzLnBhcmVuQ29tbWEpO3ZhciBjb21wb25lbnRzPVtdO2Zvcih2YXIgaT0wLGxlbj1saW5lcy5sZW5ndGg7aTxsZW47KytpKXtsaW5lPWxpbmVzW2ldLnJlcGxhY2UodGhpcy5yZWdFeGVzLnRyaW1QYXJlbnMsJyQxJyk7Y29tcG9uZW50cy5wdXNoKHRoaXMucGFyc2UubGluZXN0cmluZy5hcHBseSh0aGlzLFtsaW5lXSkpO31cbnJldHVybiB0aGlzLmdlb21ldHJ5RmFjdG9yeS5jcmVhdGVNdWx0aUxpbmVTdHJpbmcoY29tcG9uZW50cyk7fSwncG9seWdvbic6ZnVuY3Rpb24oc3RyKXtpZihzdHI9PT11bmRlZmluZWQpe3JldHVybiB0aGlzLmdlb21ldHJ5RmFjdG9yeS5jcmVhdGVQb2x5Z29uKG51bGwpO31cbnZhciByaW5nLGxpbmVzdHJpbmcsbGluZWFycmluZzt2YXIgcmluZ3M9c3RyLnRyaW0oKS5zcGxpdCh0aGlzLnJlZ0V4ZXMucGFyZW5Db21tYSk7dmFyIHNoZWxsO3ZhciBob2xlcz1bXTtmb3IodmFyIGk9MCxsZW49cmluZ3MubGVuZ3RoO2k8bGVuOysraSl7cmluZz1yaW5nc1tpXS5yZXBsYWNlKHRoaXMucmVnRXhlcy50cmltUGFyZW5zLCckMScpO2xpbmVzdHJpbmc9dGhpcy5wYXJzZS5saW5lc3RyaW5nLmFwcGx5KHRoaXMsW3JpbmddKTtsaW5lYXJyaW5nPXRoaXMuZ2VvbWV0cnlGYWN0b3J5LmNyZWF0ZUxpbmVhclJpbmcobGluZXN0cmluZy5wb2ludHMpO2lmKGk9PT0wKXtzaGVsbD1saW5lYXJyaW5nO31lbHNle2hvbGVzLnB1c2gobGluZWFycmluZyk7fX1cbnJldHVybiB0aGlzLmdlb21ldHJ5RmFjdG9yeS5jcmVhdGVQb2x5Z29uKHNoZWxsLGhvbGVzKTt9LCdtdWx0aXBvbHlnb24nOmZ1bmN0aW9uKHN0cil7aWYoc3RyPT09dW5kZWZpbmVkKXtyZXR1cm4gdGhpcy5nZW9tZXRyeUZhY3RvcnkuY3JlYXRlTXVsdGlQb2x5Z29uKG51bGwpO31cbnZhciBwb2x5Z29uO3ZhciBwb2x5Z29ucz1zdHIudHJpbSgpLnNwbGl0KHRoaXMucmVnRXhlcy5kb3VibGVQYXJlbkNvbW1hKTt2YXIgY29tcG9uZW50cz1bXTtmb3IodmFyIGk9MCxsZW49cG9seWdvbnMubGVuZ3RoO2k8bGVuOysraSl7cG9seWdvbj1wb2x5Z29uc1tpXS5yZXBsYWNlKHRoaXMucmVnRXhlcy50cmltUGFyZW5zLCckMScpO2NvbXBvbmVudHMucHVzaCh0aGlzLnBhcnNlLnBvbHlnb24uYXBwbHkodGhpcyxbcG9seWdvbl0pKTt9XG5yZXR1cm4gdGhpcy5nZW9tZXRyeUZhY3RvcnkuY3JlYXRlTXVsdGlQb2x5Z29uKGNvbXBvbmVudHMpO30sJ2dlb21ldHJ5Y29sbGVjdGlvbic6ZnVuY3Rpb24oc3RyKXtpZihzdHI9PT11bmRlZmluZWQpe3JldHVybiB0aGlzLmdlb21ldHJ5RmFjdG9yeS5jcmVhdGVHZW9tZXRyeUNvbGxlY3Rpb24obnVsbCk7fVxuc3RyPXN0ci5yZXBsYWNlKC8sXFxzKihbQS1aYS16XSkvZywnfCQxJyk7dmFyIHdrdEFycmF5PXN0ci50cmltKCkuc3BsaXQoJ3wnKTt2YXIgY29tcG9uZW50cz1bXTtmb3IodmFyIGk9MCxsZW49d2t0QXJyYXkubGVuZ3RoO2k8bGVuOysraSl7Y29tcG9uZW50cy5wdXNoKGpzdHMuaW8uV0tUUGFyc2VyLnByb3RvdHlwZS5yZWFkLmFwcGx5KHRoaXMsW3drdEFycmF5W2ldXSkpO31cbnJldHVybiB0aGlzLmdlb21ldHJ5RmFjdG9yeS5jcmVhdGVHZW9tZXRyeUNvbGxlY3Rpb24oY29tcG9uZW50cyk7fX07anN0cy5pbmRleC5JdGVtVmlzaXRvcj1mdW5jdGlvbigpe307anN0cy5pbmRleC5JdGVtVmlzaXRvci5wcm90b3R5cGUudmlzaXRJdGVtPWZ1bmN0aW9uKCl7dGhyb3cgbmV3IGpzdHMuZXJyb3IuQWJzdHJhY3RNZXRob2RJbnZvY2F0aW9uRXJyb3IoKTt9O2pzdHMuYWxnb3JpdGhtLkNHQWxnb3JpdGhtcz1mdW5jdGlvbigpe307anN0cy5hbGdvcml0aG0uQ0dBbGdvcml0aG1zLkNMT0NLV0lTRT0tMTtqc3RzLmFsZ29yaXRobS5DR0FsZ29yaXRobXMuUklHSFQ9anN0cy5hbGdvcml0aG0uQ0dBbGdvcml0aG1zLkNMT0NLV0lTRTtqc3RzLmFsZ29yaXRobS5DR0FsZ29yaXRobXMuQ09VTlRFUkNMT0NLV0lTRT0xO2pzdHMuYWxnb3JpdGhtLkNHQWxnb3JpdGhtcy5MRUZUPWpzdHMuYWxnb3JpdGhtLkNHQWxnb3JpdGhtcy5DT1VOVEVSQ0xPQ0tXSVNFO2pzdHMuYWxnb3JpdGhtLkNHQWxnb3JpdGhtcy5DT0xMSU5FQVI9MDtqc3RzLmFsZ29yaXRobS5DR0FsZ29yaXRobXMuU1RSQUlHSFQ9anN0cy5hbGdvcml0aG0uQ0dBbGdvcml0aG1zLkNPTExJTkVBUjtqc3RzLmFsZ29yaXRobS5DR0FsZ29yaXRobXMub3JpZW50YXRpb25JbmRleD1mdW5jdGlvbihwMSxwMixxKXt2YXIgZHgxLGR5MSxkeDIsZHkyO2R4MT1wMi54LXAxLng7ZHkxPXAyLnktcDEueTtkeDI9cS54LXAyLng7ZHkyPXEueS1wMi55O3JldHVybiBqc3RzLmFsZ29yaXRobS5Sb2J1c3REZXRlcm1pbmFudC5zaWduT2ZEZXQyeDIoZHgxLGR5MSxkeDIsZHkyKTt9O2pzdHMuYWxnb3JpdGhtLkNHQWxnb3JpdGhtcy5pc1BvaW50SW5SaW5nPWZ1bmN0aW9uKHAscmluZyl7cmV0dXJuIGpzdHMuYWxnb3JpdGhtLkNHQWxnb3JpdGhtcy5sb2NhdGVQb2ludEluUmluZyhwLHJpbmcpIT09anN0cy5nZW9tLkxvY2F0aW9uLkVYVEVSSU9SO307anN0cy5hbGdvcml0aG0uQ0dBbGdvcml0aG1zLmxvY2F0ZVBvaW50SW5SaW5nPWZ1bmN0aW9uKHAscmluZyl7cmV0dXJuIGpzdHMuYWxnb3JpdGhtLlJheUNyb3NzaW5nQ291bnRlci5sb2NhdGVQb2ludEluUmluZyhwLHJpbmcpO307anN0cy5hbGdvcml0aG0uQ0dBbGdvcml0aG1zLmlzT25MaW5lPWZ1bmN0aW9uKHAscHQpe3ZhciBsaW5lSW50ZXJzZWN0b3IsaSxpbCxwMCxwMTtsaW5lSW50ZXJzZWN0b3I9bmV3IGpzdHMuYWxnb3JpdGhtLlJvYnVzdExpbmVJbnRlcnNlY3RvcigpO2ZvcihpPTEsaWw9cHQubGVuZ3RoO2k8aWw7aSsrKXtwMD1wdFtpLTFdO3AxPXB0W2ldO2xpbmVJbnRlcnNlY3Rvci5jb21wdXRlSW50ZXJzZWN0aW9uKHAscDAscDEpO2lmKGxpbmVJbnRlcnNlY3Rvci5oYXNJbnRlcnNlY3Rpb24oKSl7cmV0dXJuIHRydWU7fX1cbnJldHVybiBmYWxzZTt9O2pzdHMuYWxnb3JpdGhtLkNHQWxnb3JpdGhtcy5pc0NDVz1mdW5jdGlvbihyaW5nKXt2YXIgblB0cyxoaVB0LGhpSW5kZXgscCxpUHJldixpTmV4dCxwcmV2LG5leHQsaSxkaXNjLGlzQ0NXO25QdHM9cmluZy5sZW5ndGgtMTtpZihuUHRzPDMpe3Rocm93IG5ldyBqc3RzLklsbGVnYWxBcmd1bWVudEVycm9yKCdSaW5nIGhhcyBmZXdlciB0aGFuIDMgcG9pbnRzLCBzbyBvcmllbnRhdGlvbiBjYW5ub3QgYmUgZGV0ZXJtaW5lZCcpO31cbmhpUHQ9cmluZ1swXTtoaUluZGV4PTA7aT0xO2ZvcihpO2k8PW5QdHM7aSsrKXtwPXJpbmdbaV07aWYocC55PmhpUHQueSl7aGlQdD1wO2hpSW5kZXg9aTt9fVxuaVByZXY9aGlJbmRleDtkb3tpUHJldj1pUHJldi0xO2lmKGlQcmV2PDApe2lQcmV2PW5QdHM7fX13aGlsZShyaW5nW2lQcmV2XS5lcXVhbHMyRChoaVB0KSYmaVByZXYhPT1oaUluZGV4KTtpTmV4dD1oaUluZGV4O2Rve2lOZXh0PShpTmV4dCsxKSVuUHRzO313aGlsZShyaW5nW2lOZXh0XS5lcXVhbHMyRChoaVB0KSYmaU5leHQhPT1oaUluZGV4KTtwcmV2PXJpbmdbaVByZXZdO25leHQ9cmluZ1tpTmV4dF07aWYocHJldi5lcXVhbHMyRChoaVB0KXx8bmV4dC5lcXVhbHMyRChoaVB0KXx8cHJldi5lcXVhbHMyRChuZXh0KSl7cmV0dXJuIGZhbHNlO31cbmRpc2M9anN0cy5hbGdvcml0aG0uQ0dBbGdvcml0aG1zLmNvbXB1dGVPcmllbnRhdGlvbihwcmV2LGhpUHQsbmV4dCk7aXNDQ1c9ZmFsc2U7aWYoZGlzYz09PTApe2lzQ0NXPShwcmV2Lng+bmV4dC54KTt9ZWxzZXtpc0NDVz0oZGlzYz4wKTt9XG5yZXR1cm4gaXNDQ1c7fTtqc3RzLmFsZ29yaXRobS5DR0FsZ29yaXRobXMuY29tcHV0ZU9yaWVudGF0aW9uPWZ1bmN0aW9uKHAxLHAyLHEpe3JldHVybiBqc3RzLmFsZ29yaXRobS5DR0FsZ29yaXRobXMub3JpZW50YXRpb25JbmRleChwMSxwMixxKTt9O2pzdHMuYWxnb3JpdGhtLkNHQWxnb3JpdGhtcy5kaXN0YW5jZVBvaW50TGluZT1mdW5jdGlvbihwLEEsQil7aWYoIShBIGluc3RhbmNlb2YganN0cy5nZW9tLkNvb3JkaW5hdGUpKXtqc3RzLmFsZ29yaXRobS5DR0FsZ29yaXRobXMuZGlzdGFuY2VQb2ludExpbmUyLmFwcGx5KHRoaXMsYXJndW1lbnRzKTt9XG5pZihBLng9PT1CLngmJkEueT09PUIueSl7cmV0dXJuIHAuZGlzdGFuY2UoQSk7fVxudmFyIHIscztyPSgocC54LUEueCkqKEIueC1BLngpKyhwLnktQS55KSooQi55LUEueSkpLygoQi54LUEueCkqKEIueC1BLngpKyhCLnktQS55KSooQi55LUEueSkpO2lmKHI8PTAuMCl7cmV0dXJuIHAuZGlzdGFuY2UoQSk7fVxuaWYocj49MS4wKXtyZXR1cm4gcC5kaXN0YW5jZShCKTt9XG5zPSgoQS55LXAueSkqKEIueC1BLngpLShBLngtcC54KSooQi55LUEueSkpLygoQi54LUEueCkqKEIueC1BLngpKyhCLnktQS55KSooQi55LUEueSkpO3JldHVybiBNYXRoLmFicyhzKSpNYXRoLnNxcnQoKChCLngtQS54KSooQi54LUEueCkrKEIueS1BLnkpKihCLnktQS55KSkpO307anN0cy5hbGdvcml0aG0uQ0dBbGdvcml0aG1zLmRpc3RhbmNlUG9pbnRMaW5lUGVycGVuZGljdWxhcj1mdW5jdGlvbihwLEEsQil7dmFyIHM9KChBLnktcC55KSooQi54LUEueCktKEEueC1wLngpKihCLnktQS55KSkvKChCLngtQS54KSooQi54LUEueCkrKEIueS1BLnkpKihCLnktQS55KSk7cmV0dXJuIE1hdGguYWJzKHMpKk1hdGguc3FydCgoKEIueC1BLngpKihCLngtQS54KSsoQi55LUEueSkqKEIueS1BLnkpKSk7fTtqc3RzLmFsZ29yaXRobS5DR0FsZ29yaXRobXMuZGlzdGFuY2VQb2ludExpbmUyPWZ1bmN0aW9uKHAsbGluZSl7dmFyIG1pbkRpc3RhbmNlLGksaWwsZGlzdDtpZihsaW5lLmxlbmd0aD09PTApe3Rocm93IG5ldyBqc3RzLmVycm9yLklsbGVnYWxBcmd1bWVudEVycm9yKCdMaW5lIGFycmF5IG11c3QgY29udGFpbiBhdCBsZWFzdCBvbmUgdmVydGV4Jyk7fVxubWluRGlzdGFuY2U9cC5kaXN0YW5jZShsaW5lWzBdKTtmb3IoaT0wLGlsPWxpbmUubGVuZ3RoLTE7aTxpbDtpKyspe2Rpc3Q9anN0cy5hbGdvcml0aG0uQ0dBbGdvcml0aG1zLmRpc3RhbmNlUG9pbnRMaW5lKHAsbGluZVtpXSxsaW5lW2krMV0pO2lmKGRpc3Q8bWluRGlzdGFuY2Upe21pbkRpc3RhbmNlPWRpc3Q7fX1cbnJldHVybiBtaW5EaXN0YW5jZTt9O2pzdHMuYWxnb3JpdGhtLkNHQWxnb3JpdGhtcy5kaXN0YW5jZUxpbmVMaW5lPWZ1bmN0aW9uKEEsQixDLEQpe2lmKEEuZXF1YWxzKEIpKXtyZXR1cm4ganN0cy5hbGdvcml0aG0uQ0dBbGdvcml0aG1zLmRpc3RhbmNlUG9pbnRMaW5lKEEsQyxEKTt9XG5pZihDLmVxdWFscyhEKSl7cmV0dXJuIGpzdHMuYWxnb3JpdGhtLkNHQWxnb3JpdGhtcy5kaXN0YW5jZVBvaW50TGluZShELEEsQik7fVxudmFyIHJfdG9wLHJfYm90LHNfdG9wLHNfYm90LHMscjtyX3RvcD0oQS55LUMueSkqKEQueC1DLngpLShBLngtQy54KSooRC55LUMueSk7cl9ib3Q9KEIueC1BLngpKihELnktQy55KS0oQi55LUEueSkqKEQueC1DLngpO3NfdG9wPShBLnktQy55KSooQi54LUEueCktKEEueC1DLngpKihCLnktQS55KTtzX2JvdD0oQi54LUEueCkqKEQueS1DLnkpLShCLnktQS55KSooRC54LUMueCk7aWYoKHJfYm90PT09MCl8fChzX2JvdD09PTApKXtyZXR1cm4gTWF0aC5taW4oanN0cy5hbGdvcml0aG0uQ0dBbGdvcml0aG1zLmRpc3RhbmNlUG9pbnRMaW5lKEEsQyxEKSxNYXRoLm1pbihqc3RzLmFsZ29yaXRobS5DR0FsZ29yaXRobXMuZGlzdGFuY2VQb2ludExpbmUoQixDLEQpLE1hdGgubWluKGpzdHMuYWxnb3JpdGhtLkNHQWxnb3JpdGhtcy5kaXN0YW5jZVBvaW50TGluZShDLEEsQiksanN0cy5hbGdvcml0aG0uQ0dBbGdvcml0aG1zLmRpc3RhbmNlUG9pbnRMaW5lKEQsQSxCKSkpKTt9XG5zPXNfdG9wL3NfYm90O3I9cl90b3Avcl9ib3Q7aWYoKHI8MCl8fChyPjEpfHwoczwwKXx8KHM+MSkpe3JldHVybiBNYXRoLm1pbihqc3RzLmFsZ29yaXRobS5DR0FsZ29yaXRobXMuZGlzdGFuY2VQb2ludExpbmUoQSxDLEQpLE1hdGgubWluKGpzdHMuYWxnb3JpdGhtLkNHQWxnb3JpdGhtcy5kaXN0YW5jZVBvaW50TGluZShCLEMsRCksTWF0aC5taW4oanN0cy5hbGdvcml0aG0uQ0dBbGdvcml0aG1zLmRpc3RhbmNlUG9pbnRMaW5lKEMsQSxCKSxqc3RzLmFsZ29yaXRobS5DR0FsZ29yaXRobXMuZGlzdGFuY2VQb2ludExpbmUoRCxBLEIpKSkpO31cbnJldHVybiAwLjA7fTtqc3RzLmFsZ29yaXRobS5DR0FsZ29yaXRobXMuc2lnbmVkQXJlYT1mdW5jdGlvbihyaW5nKXtpZihyaW5nLmxlbmd0aDwzKXtyZXR1cm4gMC4wO31cbnZhciBzdW0saSxpbCxieCxieSxjeCxjeTtzdW09MC4wO2ZvcihpPTAsaWw9cmluZy5sZW5ndGgtMTtpPGlsO2krKyl7Yng9cmluZ1tpXS54O2J5PXJpbmdbaV0ueTtjeD1yaW5nW2krMV0ueDtjeT1yaW5nW2krMV0ueTtzdW0rPShieCtjeCkqKGN5LWJ5KTt9XG5yZXR1cm4tc3VtLzIuMDt9O2pzdHMuYWxnb3JpdGhtLkNHQWxnb3JpdGhtcy5zaWduZWRBcmVhPWZ1bmN0aW9uKHJpbmcpe3ZhciBuLHN1bSxwLGJ4LGJ5LGksY3gsY3k7bj1yaW5nLmxlbmd0aDtpZihuPDMpe3JldHVybiAwLjA7fVxuc3VtPTAuMDtwPXJpbmdbMF07Yng9cC54O2J5PXAueTtmb3IoaT0xO2k8bjtpKyspe3A9cmluZ1tpXTtjeD1wLng7Y3k9cC55O3N1bSs9KGJ4K2N4KSooY3ktYnkpO2J4PWN4O2J5PWN5O31cbnJldHVybi1zdW0vMi4wO307anN0cy5hbGdvcml0aG0uQ0dBbGdvcml0aG1zLmNvbXB1dGVMZW5ndGg9ZnVuY3Rpb24ocHRzKXt2YXIgbj1wdHMubGVuZ3RoLGxlbix4MCx5MCx4MSx5MSxkeCxkeSxwLGksaWw7aWYobjw9MSl7cmV0dXJuIDAuMDt9XG5sZW49MC4wO3A9cHRzWzBdO3gwPXAueDt5MD1wLnk7aT0xLGlsPW47Zm9yKGk7aTxuO2krKyl7cD1wdHNbaV07eDE9cC54O3kxPXAueTtkeD14MS14MDtkeT15MS15MDtsZW4rPU1hdGguc3FydChkeCpkeCtkeSpkeSk7eDA9eDE7eTA9eTE7fVxucmV0dXJuIGxlbjt9O2pzdHMuYWxnb3JpdGhtLkNHQWxnb3JpdGhtcy5sZW5ndGg9ZnVuY3Rpb24oKXt9O2pzdHMuYWxnb3JpdGhtLkFuZ2xlPWZ1bmN0aW9uKCl7fTtqc3RzLmFsZ29yaXRobS5BbmdsZS5QSV9USU1FU18yPTIuMCpNYXRoLlBJO2pzdHMuYWxnb3JpdGhtLkFuZ2xlLlBJX09WRVJfMj1NYXRoLlBJLzIuMDtqc3RzLmFsZ29yaXRobS5BbmdsZS5QSV9PVkVSXzQ9TWF0aC5QSS80LjA7anN0cy5hbGdvcml0aG0uQW5nbGUuQ09VTlRFUkNMT0NLV0lTRT1qc3RzLmFsZ29yaXRobS5DR0FsZ29yaXRobXMuQ09VTlRFUkNMT0NLV0lTRTtqc3RzLmFsZ29yaXRobS5BbmdsZS5DTE9DS1dJU0U9anN0cy5hbGdvcml0aG0uQ0dBbGdvcml0aG1zLkNMT0NLV0lTRTtqc3RzLmFsZ29yaXRobS5BbmdsZS5OT05FPWpzdHMuYWxnb3JpdGhtLkNHQWxnb3JpdGhtcy5DT0xMSU5FQVI7anN0cy5hbGdvcml0aG0uQW5nbGUudG9EZWdyZWVzPWZ1bmN0aW9uKHJhZGlhbnMpe3JldHVybihyYWRpYW5zKjE4MCkvTWF0aC5QSTt9O2pzdHMuYWxnb3JpdGhtLkFuZ2xlLnRvUmFkaWFucz1mdW5jdGlvbihhbmdsZURlZ3JlZXMpe3JldHVybihhbmdsZURlZ3JlZXMqTWF0aC5QSSkvMTgwLjA7fTtqc3RzLmFsZ29yaXRobS5BbmdsZS5hbmdsZT1mdW5jdGlvbigpe2lmKGFyZ3VtZW50cy5sZW5ndGg9PT0xKXtyZXR1cm4ganN0cy5hbGdvcml0aG0uQW5nbGUuYW5nbGVGcm9tT3JpZ28oYXJndW1lbnRzWzBdKTt9ZWxzZXtyZXR1cm4ganN0cy5hbGdvcml0aG0uQW5nbGUuYW5nbGVCZXR3ZWVuQ29vcmRzKGFyZ3VtZW50c1swXSxhcmd1bWVudHNbMV0pO319O2pzdHMuYWxnb3JpdGhtLkFuZ2xlLmFuZ2xlQmV0d2VlbkNvb3Jkcz1mdW5jdGlvbihwMCxwMSl7dmFyIGR4LGR5O2R4PXAxLngtcDAueDtkeT1wMS55LXAwLnk7cmV0dXJuIE1hdGguYXRhbjIoZHksZHgpO307anN0cy5hbGdvcml0aG0uQW5nbGUuYW5nbGVGcm9tT3JpZ289ZnVuY3Rpb24ocCl7cmV0dXJuIE1hdGguYXRhbjIocC55LHAueCk7fTtqc3RzLmFsZ29yaXRobS5BbmdsZS5pc0FjdXRlPWZ1bmN0aW9uKHAwLHAxLHAyKXt2YXIgZHgwLGR5MCxkeDEsZHkxLGRvdHByb2Q7ZHgwPXAwLngtcDEueDtkeTA9cDAueS1wMS55O2R4MT1wMi54LXAxLng7ZHkxPXAyLnktcDEueTtkb3Rwcm9kPWR4MCpkeDErZHkwKmR5MTtyZXR1cm4gZG90cHJvZD4wO307anN0cy5hbGdvcml0aG0uQW5nbGUuaXNPYnR1c2U9ZnVuY3Rpb24ocDAscDEscDIpe3ZhciBkeDAsZHkwLGR4MSxkeTEsZG90cHJvZDtkeDA9cDAueC1wMS54O2R5MD1wMC55LXAxLnk7ZHgxPXAyLngtcDEueDtkeTE9cDIueS1wMS55O2RvdHByb2Q9ZHgwKmR4MStkeTAqZHkxO3JldHVybiBkb3Rwcm9kPDA7fTtqc3RzLmFsZ29yaXRobS5BbmdsZS5hbmdsZUJldHdlZW49ZnVuY3Rpb24odGlwMSx0YWlsLHRpcDIpe3ZhciBhMSxhMjthMT1qc3RzLmFsZ29yaXRobS5BbmdsZS5hbmdsZSh0YWlsLHRpcDEpO2EyPWpzdHMuYWxnb3JpdGhtLkFuZ2xlLmFuZ2xlKHRhaWwsdGlwMik7cmV0dXJuIGpzdHMuYWxnb3JpdGhtLkFuZ2xlLmRpZmYoYTEsYTIpO307anN0cy5hbGdvcml0aG0uQW5nbGUuYW5nbGVCZXR3ZWVuT3JpZW50ZWQ9ZnVuY3Rpb24odGlwMSx0YWlsLHRpcDIpe3ZhciBhMSxhMixhbmdEZWw7YTE9anN0cy5hbGdvcml0aG0uQW5nbGUuYW5nbGUodGFpbCx0aXAxKTthMj1qc3RzLmFsZ29yaXRobS5BbmdsZS5hbmdsZSh0YWlsLHRpcDIpO2FuZ0RlbD1hMi1hMTtpZihhbmdEZWw8PS1NYXRoLlBJKXtyZXR1cm4gYW5nRGVsK2pzdHMuYWxnb3JpdGhtLkFuZ2xlLlBJX1RJTUVTXzI7fVxuaWYoYW5nRGVsPk1hdGguUEkpe3JldHVybiBhbmdEZWwtanN0cy5hbGdvcml0aG0uQW5nbGUuUElfVElNRVNfMjt9XG5yZXR1cm4gYW5nRGVsO307anN0cy5hbGdvcml0aG0uQW5nbGUuaW50ZXJpb3JBbmdsZT1mdW5jdGlvbihwMCxwMSxwMil7dmFyIGFuZ2xlUHJldixhbmdsZU5leHQ7YW5nbGVQcmV2PWpzdHMuYWxnb3JpdGhtLkFuZ2xlLmFuZ2xlKHAxLHAwKTthbmdsZU5leHQ9anN0cy5hbGdvcml0aG0uQW5nbGUuYW5nbGUocDEscDIpO3JldHVybiBNYXRoLmFicyhhbmdsZU5leHQtYW5nbGVQcmV2KTt9O2pzdHMuYWxnb3JpdGhtLkFuZ2xlLmdldFR1cm49ZnVuY3Rpb24oYW5nMSxhbmcyKXt2YXIgY3Jvc3Nwcm9kdWN0PU1hdGguc2luKGFuZzItYW5nMSk7aWYoY3Jvc3Nwcm9kdWN0PjApe3JldHVybiBqc3RzLmFsZ29yaXRobS5BbmdsZS5DT1VOVEVSQ0xPQ0tXSVNFO31cbmlmKGNyb3NzcHJvZHVjdDwwKXtyZXR1cm4ganN0cy5hbGdvcml0aG0uQW5nbGUuQ0xPQ0tXSVNFO31cbnJldHVybiBqc3RzLmFsZ29yaXRobS5BbmdsZS5OT05FO307anN0cy5hbGdvcml0aG0uQW5nbGUubm9ybWFsaXplPWZ1bmN0aW9uKGFuZ2xlKXt3aGlsZShhbmdsZT5NYXRoLlBJKXthbmdsZS09anN0cy5hbGdvcml0aG0uQW5nbGUuUElfVElNRVNfMjt9XG53aGlsZShhbmdsZTw9LU1hdGguUEkpe2FuZ2xlKz1qc3RzLmFsZ29yaXRobS5BbmdsZS5QSV9USU1FU18yO31cbnJldHVybiBhbmdsZTt9O2pzdHMuYWxnb3JpdGhtLkFuZ2xlLm5vcm1hbGl6ZVBvc2l0aXZlPWZ1bmN0aW9uKGFuZ2xlKXtpZihhbmdsZTwwLjApe3doaWxlKGFuZ2xlPDAuMCl7YW5nbGUrPWpzdHMuYWxnb3JpdGhtLkFuZ2xlLlBJX1RJTUVTXzI7fVxuaWYoYW5nbGU+PWpzdHMuYWxnb3JpdGhtLkFuZ2xlLlBJX1RJTUVTXzIpe2FuZ2xlPTAuMDt9fVxuZWxzZXt3aGlsZShhbmdsZT49anN0cy5hbGdvcml0aG0uQW5nbGUuUElfVElNRVNfMil7YW5nbGUtPWpzdHMuYWxnb3JpdGhtLkFuZ2xlLlBJX1RJTUVTXzI7fVxuaWYoYW5nbGU8MC4wKXthbmdsZT0wLjA7fX1cbnJldHVybiBhbmdsZTt9O2pzdHMuYWxnb3JpdGhtLkFuZ2xlLmRpZmY9ZnVuY3Rpb24oYW5nMSxhbmcyKXt2YXIgZGVsQW5nbGU7aWYoYW5nMTxhbmcyKXtkZWxBbmdsZT1hbmcyLWFuZzE7fWVsc2V7ZGVsQW5nbGU9YW5nMS1hbmcyO31cbmlmKGRlbEFuZ2xlPk1hdGguUEkpe2RlbEFuZ2xlPSgyKk1hdGguUEkpLWRlbEFuZ2xlO31cbnJldHVybiBkZWxBbmdsZTt9O2pzdHMuZ2VvbS5HZW9tZXRyeUNvbXBvbmVudEZpbHRlcj1mdW5jdGlvbigpe307anN0cy5nZW9tLkdlb21ldHJ5Q29tcG9uZW50RmlsdGVyLnByb3RvdHlwZS5maWx0ZXI9ZnVuY3Rpb24oZ2VvbSl7dGhyb3cgbmV3IGpzdHMuZXJyb3IuQWJzdHJhY3RNZXRob2RJbnZvY2F0aW9uRXJyb3IoKTt9O2pzdHMuZ2VvbS51dGlsLkxpbmVhckNvbXBvbmVudEV4dHJhY3Rlcj1mdW5jdGlvbihsaW5lcyxpc0ZvcmNlZFRvTGluZVN0cmluZyl7dGhpcy5saW5lcz1saW5lczt0aGlzLmlzRm9yY2VkVG9MaW5lU3RyaW5nPWlzRm9yY2VkVG9MaW5lU3RyaW5nO307anN0cy5nZW9tLnV0aWwuTGluZWFyQ29tcG9uZW50RXh0cmFjdGVyLnByb3RvdHlwZT1uZXcganN0cy5nZW9tLkdlb21ldHJ5Q29tcG9uZW50RmlsdGVyKCk7anN0cy5nZW9tLnV0aWwuTGluZWFyQ29tcG9uZW50RXh0cmFjdGVyLnByb3RvdHlwZS5saW5lcz1udWxsO2pzdHMuZ2VvbS51dGlsLkxpbmVhckNvbXBvbmVudEV4dHJhY3Rlci5wcm90b3R5cGUuaXNGb3JjZWRUb0xpbmVTdHJpbmc9ZmFsc2U7anN0cy5nZW9tLnV0aWwuTGluZWFyQ29tcG9uZW50RXh0cmFjdGVyLmdldExpbmVzPWZ1bmN0aW9uKGdlb21zLGxpbmVzKXtpZihhcmd1bWVudHMubGVuZ3RoPT0xKXtyZXR1cm4ganN0cy5nZW9tLnV0aWwuTGluZWFyQ29tcG9uZW50RXh0cmFjdGVyLmdldExpbmVzNS5hcHBseSh0aGlzLGFyZ3VtZW50cyk7fVxuZWxzZSBpZihhcmd1bWVudHMubGVuZ3RoPT0yJiZ0eXBlb2YgbGluZXM9PT0nYm9vbGVhbicpe3JldHVybiBqc3RzLmdlb20udXRpbC5MaW5lYXJDb21wb25lbnRFeHRyYWN0ZXIuZ2V0TGluZXM2LmFwcGx5KHRoaXMsYXJndW1lbnRzKTt9XG5lbHNlIGlmKGFyZ3VtZW50cy5sZW5ndGg9PTImJmdlb21zIGluc3RhbmNlb2YganN0cy5nZW9tLkdlb21ldHJ5KXtyZXR1cm4ganN0cy5nZW9tLnV0aWwuTGluZWFyQ29tcG9uZW50RXh0cmFjdGVyLmdldExpbmVzMy5hcHBseSh0aGlzLGFyZ3VtZW50cyk7fVxuZWxzZSBpZihhcmd1bWVudHMubGVuZ3RoPT0zJiZnZW9tcyBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5HZW9tZXRyeSl7cmV0dXJuIGpzdHMuZ2VvbS51dGlsLkxpbmVhckNvbXBvbmVudEV4dHJhY3Rlci5nZXRMaW5lczQuYXBwbHkodGhpcyxhcmd1bWVudHMpO31cbmVsc2UgaWYoYXJndW1lbnRzLmxlbmd0aD09Myl7cmV0dXJuIGpzdHMuZ2VvbS51dGlsLkxpbmVhckNvbXBvbmVudEV4dHJhY3Rlci5nZXRMaW5lczIuYXBwbHkodGhpcyxhcmd1bWVudHMpO31cbmZvcih2YXIgaT0wO2k8Z2VvbXMubGVuZ3RoO2krKyl7dmFyIGc9Z2VvbXNbaV07anN0cy5nZW9tLnV0aWwuTGluZWFyQ29tcG9uZW50RXh0cmFjdGVyLmdldExpbmVzMyhnLGxpbmVzKTt9XG5yZXR1cm4gbGluZXM7fTtqc3RzLmdlb20udXRpbC5MaW5lYXJDb21wb25lbnRFeHRyYWN0ZXIuZ2V0TGluZXMyPWZ1bmN0aW9uKGdlb21zLGxpbmVzLGZvcmNlVG9MaW5lU3RyaW5nKXtmb3IodmFyIGk9MDtpPGdlb21zLmxlbmd0aDtpKyspe3ZhciBnPWdlb21zW2ldO2pzdHMuZ2VvbS51dGlsLkxpbmVhckNvbXBvbmVudEV4dHJhY3Rlci5nZXRMaW5lczQoZyxsaW5lcyxmb3JjZVRvTGluZVN0cmluZyk7fVxucmV0dXJuIGxpbmVzO307anN0cy5nZW9tLnV0aWwuTGluZWFyQ29tcG9uZW50RXh0cmFjdGVyLmdldExpbmVzMz1mdW5jdGlvbihnZW9tLGxpbmVzKXtpZihnZW9tIGluc3RhbmNlb2YgTGluZVN0cmluZyl7bGluZXMuYWRkKGdlb20pO31lbHNle2dlb20uYXBwbHkobmV3IGpzdHMuZ2VvbS51dGlsLkxpbmVhckNvbXBvbmVudEV4dHJhY3RlcihsaW5lcykpO31cbnJldHVybiBsaW5lczt9O2pzdHMuZ2VvbS51dGlsLkxpbmVhckNvbXBvbmVudEV4dHJhY3Rlci5nZXRMaW5lczQ9ZnVuY3Rpb24oZ2VvbSxsaW5lcyxmb3JjZVRvTGluZVN0cmluZyl7Z2VvbS5hcHBseShuZXcganN0cy5nZW9tLnV0aWwuTGluZWFyQ29tcG9uZW50RXh0cmFjdGVyKGxpbmVzLGZvcmNlVG9MaW5lU3RyaW5nKSk7cmV0dXJuIGxpbmVzO307anN0cy5nZW9tLnV0aWwuTGluZWFyQ29tcG9uZW50RXh0cmFjdGVyLmdldExpbmVzNT1mdW5jdGlvbihnZW9tKXtyZXR1cm4ganN0cy5nZW9tLnV0aWwuTGluZWFyQ29tcG9uZW50RXh0cmFjdGVyLmdldExpbmVzNihnZW9tLGZhbHNlKTt9O2pzdHMuZ2VvbS51dGlsLkxpbmVhckNvbXBvbmVudEV4dHJhY3Rlci5nZXRMaW5lczY9ZnVuY3Rpb24oZ2VvbSxmb3JjZVRvTGluZVN0cmluZyl7dmFyIGxpbmVzPVtdO2dlb20uYXBwbHkobmV3IGpzdHMuZ2VvbS51dGlsLkxpbmVhckNvbXBvbmVudEV4dHJhY3RlcihsaW5lcyxmb3JjZVRvTGluZVN0cmluZykpO3JldHVybiBsaW5lczt9O2pzdHMuZ2VvbS51dGlsLkxpbmVhckNvbXBvbmVudEV4dHJhY3Rlci5wcm90b3R5cGUuc2V0Rm9yY2VUb0xpbmVTdHJpbmc9ZnVuY3Rpb24oaXNGb3JjZWRUb0xpbmVTdHJpbmcpe3RoaXMuaXNGb3JjZWRUb0xpbmVTdHJpbmc9aXNGb3JjZWRUb0xpbmVTdHJpbmc7fTtqc3RzLmdlb20udXRpbC5MaW5lYXJDb21wb25lbnRFeHRyYWN0ZXIucHJvdG90eXBlLmZpbHRlcj1mdW5jdGlvbihnZW9tKXtpZih0aGlzLmlzRm9yY2VkVG9MaW5lU3RyaW5nJiZnZW9tIGluc3RhbmNlb2YganN0cy5nZW9tLkxpbmVhclJpbmcpe3ZhciBsaW5lPWdlb20uZ2V0RmFjdG9yeSgpLmNyZWF0ZUxpbmVTdHJpbmcoZ2VvbS5nZXRDb29yZGluYXRlU2VxdWVuY2UoKSk7dGhpcy5saW5lcy5wdXNoKGxpbmUpO3JldHVybjt9XG5pZihnZW9tIGluc3RhbmNlb2YganN0cy5nZW9tLkxpbmVTdHJpbmd8fGdlb20gaW5zdGFuY2VvZiBqc3RzLmdlb20uTGluZWFyUmluZylcbnRoaXMubGluZXMucHVzaChnZW9tKTt9O2pzdHMuZ2VvbS5Mb2NhdGlvbj1mdW5jdGlvbigpe307anN0cy5nZW9tLkxvY2F0aW9uLklOVEVSSU9SPTA7anN0cy5nZW9tLkxvY2F0aW9uLkJPVU5EQVJZPTE7anN0cy5nZW9tLkxvY2F0aW9uLkVYVEVSSU9SPTI7anN0cy5nZW9tLkxvY2F0aW9uLk5PTkU9LTE7anN0cy5nZW9tLkxvY2F0aW9uLnRvTG9jYXRpb25TeW1ib2w9ZnVuY3Rpb24obG9jYXRpb25WYWx1ZSl7c3dpdGNoKGxvY2F0aW9uVmFsdWUpe2Nhc2UganN0cy5nZW9tLkxvY2F0aW9uLkVYVEVSSU9SOnJldHVybidlJztjYXNlIGpzdHMuZ2VvbS5Mb2NhdGlvbi5CT1VOREFSWTpyZXR1cm4nYic7Y2FzZSBqc3RzLmdlb20uTG9jYXRpb24uSU5URVJJT1I6cmV0dXJuJ2knO2Nhc2UganN0cy5nZW9tLkxvY2F0aW9uLk5PTkU6cmV0dXJuJy0nO31cbnRocm93IG5ldyBqc3RzLklsbGVnYWxBcmd1bWVudEVycm9yKCdVbmtub3duIGxvY2F0aW9uIHZhbHVlOiAnK1xubG9jYXRpb25WYWx1ZSk7fTsoZnVuY3Rpb24oKXtqc3RzLmlvLkdlb0pTT05SZWFkZXI9ZnVuY3Rpb24oZ2VvbWV0cnlGYWN0b3J5KXt0aGlzLmdlb21ldHJ5RmFjdG9yeT1nZW9tZXRyeUZhY3Rvcnl8fG5ldyBqc3RzLmdlb20uR2VvbWV0cnlGYWN0b3J5KCk7dGhpcy5wcmVjaXNpb25Nb2RlbD10aGlzLmdlb21ldHJ5RmFjdG9yeS5nZXRQcmVjaXNpb25Nb2RlbCgpO3RoaXMucGFyc2VyPW5ldyBqc3RzLmlvLkdlb0pTT05QYXJzZXIodGhpcy5nZW9tZXRyeUZhY3RvcnkpO307anN0cy5pby5HZW9KU09OUmVhZGVyLnByb3RvdHlwZS5yZWFkPWZ1bmN0aW9uKGdlb0pzb24pe3ZhciBnZW9tZXRyeT10aGlzLnBhcnNlci5yZWFkKGdlb0pzb24pO2lmKHRoaXMucHJlY2lzaW9uTW9kZWwuZ2V0VHlwZSgpPT09anN0cy5nZW9tLlByZWNpc2lvbk1vZGVsLkZJWEVEKXt0aGlzLnJlZHVjZVByZWNpc2lvbihnZW9tZXRyeSk7fVxucmV0dXJuIGdlb21ldHJ5O307anN0cy5pby5HZW9KU09OUmVhZGVyLnByb3RvdHlwZS5yZWR1Y2VQcmVjaXNpb249ZnVuY3Rpb24oZ2VvbWV0cnkpe3ZhciBpLGxlbjtpZihnZW9tZXRyeS5jb29yZGluYXRlKXt0aGlzLnByZWNpc2lvbk1vZGVsLm1ha2VQcmVjaXNlKGdlb21ldHJ5LmNvb3JkaW5hdGUpO31lbHNlIGlmKGdlb21ldHJ5LnBvaW50cyl7Zm9yKGk9MCxsZW49Z2VvbWV0cnkucG9pbnRzLmxlbmd0aDtpPGxlbjtpKyspe3RoaXMucHJlY2lzaW9uTW9kZWwubWFrZVByZWNpc2UoZ2VvbWV0cnkucG9pbnRzW2ldKTt9fWVsc2UgaWYoZ2VvbWV0cnkuZ2VvbWV0cmllcyl7Zm9yKGk9MCxsZW49Z2VvbWV0cnkuZ2VvbWV0cmllcy5sZW5ndGg7aTxsZW47aSsrKXt0aGlzLnJlZHVjZVByZWNpc2lvbihnZW9tZXRyeS5nZW9tZXRyaWVzW2ldKTt9fX07fSkoKTtqc3RzLmdlb20uR2VvbWV0cnk9ZnVuY3Rpb24oZmFjdG9yeSl7dGhpcy5mYWN0b3J5PWZhY3Rvcnk7fTtqc3RzLmdlb20uR2VvbWV0cnkucHJvdG90eXBlLmVudmVsb3BlPW51bGw7anN0cy5nZW9tLkdlb21ldHJ5LnByb3RvdHlwZS5mYWN0b3J5PW51bGw7anN0cy5nZW9tLkdlb21ldHJ5LnByb3RvdHlwZS5nZXRHZW9tZXRyeVR5cGU9ZnVuY3Rpb24oKXtyZXR1cm4nR2VvbWV0cnknO307anN0cy5nZW9tLkdlb21ldHJ5Lmhhc05vbkVtcHR5RWxlbWVudHM9ZnVuY3Rpb24oZ2VvbWV0cmllcyl7dmFyIGk7Zm9yKGk9MDtpPGdlb21ldHJpZXMubGVuZ3RoO2krKyl7aWYoIWdlb21ldHJpZXNbaV0uaXNFbXB0eSgpKXtyZXR1cm4gdHJ1ZTt9fVxucmV0dXJuIGZhbHNlO307anN0cy5nZW9tLkdlb21ldHJ5Lmhhc051bGxFbGVtZW50cz1mdW5jdGlvbihhcnJheSl7dmFyIGk7Zm9yKGk9MDtpPGFycmF5Lmxlbmd0aDtpKyspe2lmKGFycmF5W2ldPT09bnVsbCl7cmV0dXJuIHRydWU7fX1cbnJldHVybiBmYWxzZTt9O2pzdHMuZ2VvbS5HZW9tZXRyeS5wcm90b3R5cGUuZ2V0RmFjdG9yeT1mdW5jdGlvbigpe2lmKHRoaXMuZmFjdG9yeT09PW51bGx8fHRoaXMuZmFjdG9yeT09PXVuZGVmaW5lZCl7dGhpcy5mYWN0b3J5PW5ldyBqc3RzLmdlb20uR2VvbWV0cnlGYWN0b3J5KCk7fVxucmV0dXJuIHRoaXMuZmFjdG9yeTt9O2pzdHMuZ2VvbS5HZW9tZXRyeS5wcm90b3R5cGUuZ2V0TnVtR2VvbWV0cmllcz1mdW5jdGlvbigpe3JldHVybiAxO307anN0cy5nZW9tLkdlb21ldHJ5LnByb3RvdHlwZS5nZXRHZW9tZXRyeU49ZnVuY3Rpb24obil7cmV0dXJuIHRoaXM7fTtqc3RzLmdlb20uR2VvbWV0cnkucHJvdG90eXBlLmdldFByZWNpc2lvbk1vZGVsPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZ2V0RmFjdG9yeSgpLmdldFByZWNpc2lvbk1vZGVsKCk7fTtqc3RzLmdlb20uR2VvbWV0cnkucHJvdG90eXBlLmdldENvb3JkaW5hdGU9ZnVuY3Rpb24oKXt0aHJvdyBuZXcganN0cy5lcnJvci5BYnN0cmFjdE1ldGhvZEludm9jYXRpb25FcnJvcigpO307anN0cy5nZW9tLkdlb21ldHJ5LnByb3RvdHlwZS5nZXRDb29yZGluYXRlcz1mdW5jdGlvbigpe3Rocm93IG5ldyBqc3RzLmVycm9yLkFic3RyYWN0TWV0aG9kSW52b2NhdGlvbkVycm9yKCk7fTtqc3RzLmdlb20uR2VvbWV0cnkucHJvdG90eXBlLmdldE51bVBvaW50cz1mdW5jdGlvbigpe3Rocm93IG5ldyBqc3RzLmVycm9yLkFic3RyYWN0TWV0aG9kSW52b2NhdGlvbkVycm9yKCk7fTtqc3RzLmdlb20uR2VvbWV0cnkucHJvdG90eXBlLmlzU2ltcGxlPWZ1bmN0aW9uKCl7dGhpcy5jaGVja05vdEdlb21ldHJ5Q29sbGVjdGlvbih0aGlzKTt2YXIgb3A9bmV3IGpzdHMub3BlcmF0aW9uLklzU2ltcGxlT3AodGhpcyk7cmV0dXJuIG9wLmlzU2ltcGxlKCk7fTtqc3RzLmdlb20uR2VvbWV0cnkucHJvdG90eXBlLmlzVmFsaWQ9ZnVuY3Rpb24oKXt2YXIgaXNWYWxpZE9wPW5ldyBqc3RzLm9wZXJhdGlvbi52YWxpZC5Jc1ZhbGlkT3AodGhpcyk7cmV0dXJuIGlzVmFsaWRPcC5pc1ZhbGlkKCk7fTtqc3RzLmdlb20uR2VvbWV0cnkucHJvdG90eXBlLmlzRW1wdHk9ZnVuY3Rpb24oKXt0aHJvdyBuZXcganN0cy5lcnJvci5BYnN0cmFjdE1ldGhvZEludm9jYXRpb25FcnJvcigpO307anN0cy5nZW9tLkdlb21ldHJ5LnByb3RvdHlwZS5kaXN0YW5jZT1mdW5jdGlvbihnKXtyZXR1cm4ganN0cy5vcGVyYXRpb24uZGlzdGFuY2UuRGlzdGFuY2VPcC5kaXN0YW5jZSh0aGlzLGcpO307anN0cy5nZW9tLkdlb21ldHJ5LnByb3RvdHlwZS5pc1dpdGhpbkRpc3RhbmNlPWZ1bmN0aW9uKGdlb20sZGlzdGFuY2Upe3ZhciBlbnZEaXN0PXRoaXMuZ2V0RW52ZWxvcGVJbnRlcm5hbCgpLmRpc3RhbmNlKGdlb20uZ2V0RW52ZWxvcGVJbnRlcm5hbCgpKTtpZihlbnZEaXN0PmRpc3RhbmNlKXtyZXR1cm4gZmFsc2U7fVxucmV0dXJuIERpc3RhbmNlT3AuaXNXaXRoaW5EaXN0YW5jZSh0aGlzLGdlb20sZGlzdGFuY2UpO307anN0cy5nZW9tLkdlb21ldHJ5LnByb3RvdHlwZS5pc1JlY3RhbmdsZT1mdW5jdGlvbigpe3JldHVybiBmYWxzZTt9O2pzdHMuZ2VvbS5HZW9tZXRyeS5wcm90b3R5cGUuZ2V0QXJlYT1mdW5jdGlvbigpe3JldHVybiAwLjA7fTtqc3RzLmdlb20uR2VvbWV0cnkucHJvdG90eXBlLmdldExlbmd0aD1mdW5jdGlvbigpe3JldHVybiAwLjA7fTtqc3RzLmdlb20uR2VvbWV0cnkucHJvdG90eXBlLmdldENlbnRyb2lkPWZ1bmN0aW9uKCl7aWYodGhpcy5pc0VtcHR5KCkpe3JldHVybiBudWxsO31cbnZhciBjZW50O3ZhciBjZW50UHQ9bnVsbDt2YXIgZGltPXRoaXMuZ2V0RGltZW5zaW9uKCk7aWYoZGltPT09MCl7Y2VudD1uZXcganN0cy5hbGdvcml0aG0uQ2VudHJvaWRQb2ludCgpO2NlbnQuYWRkKHRoaXMpO2NlbnRQdD1jZW50LmdldENlbnRyb2lkKCk7fWVsc2UgaWYoZGltPT09MSl7Y2VudD1uZXcganN0cy5hbGdvcml0aG0uQ2VudHJvaWRMaW5lKCk7Y2VudC5hZGQodGhpcyk7Y2VudFB0PWNlbnQuZ2V0Q2VudHJvaWQoKTt9ZWxzZXtjZW50PW5ldyBqc3RzLmFsZ29yaXRobS5DZW50cm9pZEFyZWEoKTtjZW50LmFkZCh0aGlzKTtjZW50UHQ9Y2VudC5nZXRDZW50cm9pZCgpO31cbnJldHVybiB0aGlzLmNyZWF0ZVBvaW50RnJvbUludGVybmFsQ29vcmQoY2VudFB0LHRoaXMpO307anN0cy5nZW9tLkdlb21ldHJ5LnByb3RvdHlwZS5nZXRJbnRlcmlvclBvaW50PWZ1bmN0aW9uKCl7dmFyIGludFB0O3ZhciBpbnRlcmlvclB0PW51bGw7dmFyIGRpbT10aGlzLmdldERpbWVuc2lvbigpO2lmKGRpbT09PTApe2ludFB0PW5ldyBqc3RzLmFsZ29yaXRobS5JbnRlcmlvclBvaW50UG9pbnQodGhpcyk7aW50ZXJpb3JQdD1pbnRQdC5nZXRJbnRlcmlvclBvaW50KCk7fWVsc2UgaWYoZGltPT09MSl7aW50UHQ9bmV3IGpzdHMuYWxnb3JpdGhtLkludGVyaW9yUG9pbnRMaW5lKHRoaXMpO2ludGVyaW9yUHQ9aW50UHQuZ2V0SW50ZXJpb3JQb2ludCgpO31lbHNle2ludFB0PW5ldyBqc3RzLmFsZ29yaXRobS5JbnRlcmlvclBvaW50QXJlYSh0aGlzKTtpbnRlcmlvclB0PWludFB0LmdldEludGVyaW9yUG9pbnQoKTt9XG5yZXR1cm4gdGhpcy5jcmVhdGVQb2ludEZyb21JbnRlcm5hbENvb3JkKGludGVyaW9yUHQsdGhpcyk7fTtqc3RzLmdlb20uR2VvbWV0cnkucHJvdG90eXBlLmdldERpbWVuc2lvbj1mdW5jdGlvbigpe3Rocm93IG5ldyBqc3RzLmVycm9yLkFic3RyYWN0TWV0aG9kSW52b2NhdGlvbkVycm9yKCk7fTtqc3RzLmdlb20uR2VvbWV0cnkucHJvdG90eXBlLmdldEJvdW5kYXJ5PWZ1bmN0aW9uKCl7dGhyb3cgbmV3IGpzdHMuZXJyb3IuQWJzdHJhY3RNZXRob2RJbnZvY2F0aW9uRXJyb3IoKTt9O2pzdHMuZ2VvbS5HZW9tZXRyeS5wcm90b3R5cGUuZ2V0Qm91bmRhcnlEaW1lbnNpb249ZnVuY3Rpb24oKXt0aHJvdyBuZXcganN0cy5lcnJvci5BYnN0cmFjdE1ldGhvZEludm9jYXRpb25FcnJvcigpO307anN0cy5nZW9tLkdlb21ldHJ5LnByb3RvdHlwZS5nZXRFbnZlbG9wZT1mdW5jdGlvbigpe3JldHVybiB0aGlzLmdldEZhY3RvcnkoKS50b0dlb21ldHJ5KHRoaXMuZ2V0RW52ZWxvcGVJbnRlcm5hbCgpKTt9O2pzdHMuZ2VvbS5HZW9tZXRyeS5wcm90b3R5cGUuZ2V0RW52ZWxvcGVJbnRlcm5hbD1mdW5jdGlvbigpe2lmKHRoaXMuZW52ZWxvcGU9PT1udWxsKXt0aGlzLmVudmVsb3BlPXRoaXMuY29tcHV0ZUVudmVsb3BlSW50ZXJuYWwoKTt9XG5yZXR1cm4gdGhpcy5lbnZlbG9wZTt9O2pzdHMuZ2VvbS5HZW9tZXRyeS5wcm90b3R5cGUuZGlzam9pbnQ9ZnVuY3Rpb24oZyl7cmV0dXJuIXRoaXMuaW50ZXJzZWN0cyhnKTt9O2pzdHMuZ2VvbS5HZW9tZXRyeS5wcm90b3R5cGUudG91Y2hlcz1mdW5jdGlvbihnKXtpZighdGhpcy5nZXRFbnZlbG9wZUludGVybmFsKCkuaW50ZXJzZWN0cyhnLmdldEVudmVsb3BlSW50ZXJuYWwoKSkpe3JldHVybiBmYWxzZTt9XG5yZXR1cm4gdGhpcy5yZWxhdGUoZykuaXNUb3VjaGVzKHRoaXMuZ2V0RGltZW5zaW9uKCksZy5nZXREaW1lbnNpb24oKSk7fTtqc3RzLmdlb20uR2VvbWV0cnkucHJvdG90eXBlLmludGVyc2VjdHM9ZnVuY3Rpb24oZyl7aWYoIXRoaXMuZ2V0RW52ZWxvcGVJbnRlcm5hbCgpLmludGVyc2VjdHMoZy5nZXRFbnZlbG9wZUludGVybmFsKCkpKXtyZXR1cm4gZmFsc2U7fVxuaWYodGhpcy5pc1JlY3RhbmdsZSgpKXtyZXR1cm4ganN0cy5vcGVyYXRpb24ucHJlZGljYXRlLlJlY3RhbmdsZUludGVyc2VjdHMuaW50ZXJzZWN0cyh0aGlzLGcpO31cbmlmKGcuaXNSZWN0YW5nbGUoKSl7cmV0dXJuIGpzdHMub3BlcmF0aW9uLnByZWRpY2F0ZS5SZWN0YW5nbGVJbnRlcnNlY3RzLmludGVyc2VjdHMoZyx0aGlzKTt9XG5yZXR1cm4gdGhpcy5yZWxhdGUoZykuaXNJbnRlcnNlY3RzKCk7fTtqc3RzLmdlb20uR2VvbWV0cnkucHJvdG90eXBlLmNyb3NzZXM9ZnVuY3Rpb24oZyl7aWYoIXRoaXMuZ2V0RW52ZWxvcGVJbnRlcm5hbCgpLmludGVyc2VjdHMoZy5nZXRFbnZlbG9wZUludGVybmFsKCkpKXtyZXR1cm4gZmFsc2U7fVxucmV0dXJuIHRoaXMucmVsYXRlKGcpLmlzQ3Jvc3Nlcyh0aGlzLmdldERpbWVuc2lvbigpLGcuZ2V0RGltZW5zaW9uKCkpO307anN0cy5nZW9tLkdlb21ldHJ5LnByb3RvdHlwZS53aXRoaW49ZnVuY3Rpb24oZyl7cmV0dXJuIGcuY29udGFpbnModGhpcyk7fTtqc3RzLmdlb20uR2VvbWV0cnkucHJvdG90eXBlLmNvbnRhaW5zPWZ1bmN0aW9uKGcpe2lmKCF0aGlzLmdldEVudmVsb3BlSW50ZXJuYWwoKS5jb250YWlucyhnLmdldEVudmVsb3BlSW50ZXJuYWwoKSkpe3JldHVybiBmYWxzZTt9XG5pZih0aGlzLmlzUmVjdGFuZ2xlKCkpe3JldHVybiBqc3RzLm9wZXJhdGlvbi5wcmVkaWNhdGUuUmVjdGFuZ2xlQ29udGFpbnMuY29udGFpbnModGhpcyxnKTt9XG5yZXR1cm4gdGhpcy5yZWxhdGUoZykuaXNDb250YWlucygpO307anN0cy5nZW9tLkdlb21ldHJ5LnByb3RvdHlwZS5vdmVybGFwcz1mdW5jdGlvbihnKXtpZighdGhpcy5nZXRFbnZlbG9wZUludGVybmFsKCkuaW50ZXJzZWN0cyhnLmdldEVudmVsb3BlSW50ZXJuYWwoKSkpe3JldHVybiBmYWxzZTt9XG5yZXR1cm4gdGhpcy5yZWxhdGUoZykuaXNPdmVybGFwcyh0aGlzLmdldERpbWVuc2lvbigpLGcuZ2V0RGltZW5zaW9uKCkpO307anN0cy5nZW9tLkdlb21ldHJ5LnByb3RvdHlwZS5jb3ZlcnM9ZnVuY3Rpb24oZyl7aWYoIXRoaXMuZ2V0RW52ZWxvcGVJbnRlcm5hbCgpLmNvdmVycyhnLmdldEVudmVsb3BlSW50ZXJuYWwoKSkpe3JldHVybiBmYWxzZTt9XG5pZih0aGlzLmlzUmVjdGFuZ2xlKCkpe3JldHVybiB0cnVlO31cbnJldHVybiB0aGlzLnJlbGF0ZShnKS5pc0NvdmVycygpO307anN0cy5nZW9tLkdlb21ldHJ5LnByb3RvdHlwZS5jb3ZlcmVkQnk9ZnVuY3Rpb24oZyl7cmV0dXJuIGcuY292ZXJzKHRoaXMpO307anN0cy5nZW9tLkdlb21ldHJ5LnByb3RvdHlwZS5yZWxhdGU9ZnVuY3Rpb24oZyxpbnRlcnNlY3Rpb25QYXR0ZXJuKXtpZihhcmd1bWVudHMubGVuZ3RoPT09MSl7cmV0dXJuIHRoaXMucmVsYXRlMi5hcHBseSh0aGlzLGFyZ3VtZW50cyk7fVxucmV0dXJuIHRoaXMucmVsYXRlMihnKS5tYXRjaGVzKGludGVyc2VjdGlvblBhdHRlcm4pO307anN0cy5nZW9tLkdlb21ldHJ5LnByb3RvdHlwZS5yZWxhdGUyPWZ1bmN0aW9uKGcpe3RoaXMuY2hlY2tOb3RHZW9tZXRyeUNvbGxlY3Rpb24odGhpcyk7dGhpcy5jaGVja05vdEdlb21ldHJ5Q29sbGVjdGlvbihnKTtyZXR1cm4ganN0cy5vcGVyYXRpb24ucmVsYXRlLlJlbGF0ZU9wLnJlbGF0ZSh0aGlzLGcpO307anN0cy5nZW9tLkdlb21ldHJ5LnByb3RvdHlwZS5lcXVhbHNUb3BvPWZ1bmN0aW9uKGcpe2lmKCF0aGlzLmdldEVudmVsb3BlSW50ZXJuYWwoKS5lcXVhbHMoZy5nZXRFbnZlbG9wZUludGVybmFsKCkpKXtyZXR1cm4gZmFsc2U7fVxucmV0dXJuIHRoaXMucmVsYXRlKGcpLmlzRXF1YWxzKHRoaXMuZ2V0RGltZW5zaW9uKCksZy5nZXREaW1lbnNpb24oKSk7fTtqc3RzLmdlb20uR2VvbWV0cnkucHJvdG90eXBlLmVxdWFscz1mdW5jdGlvbihvKXtpZihvIGluc3RhbmNlb2YganN0cy5nZW9tLkdlb21ldHJ5fHxvIGluc3RhbmNlb2YganN0cy5nZW9tLkxpbmVhclJpbmd8fG8gaW5zdGFuY2VvZiBqc3RzLmdlb20uUG9seWdvbnx8byBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5HZW9tZXRyeUNvbGxlY3Rpb258fG8gaW5zdGFuY2VvZiBqc3RzLmdlb20uTXVsdGlQb2ludHx8byBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5NdWx0aUxpbmVTdHJpbmd8fG8gaW5zdGFuY2VvZiBqc3RzLmdlb20uTXVsdGlQb2x5Z29uKXtyZXR1cm4gdGhpcy5lcXVhbHNFeGFjdChvKTt9XG5yZXR1cm4gZmFsc2U7fTtqc3RzLmdlb20uR2VvbWV0cnkucHJvdG90eXBlLmJ1ZmZlcj1mdW5jdGlvbihkaXN0YW5jZSxxdWFkcmFudFNlZ21lbnRzLGVuZENhcFN0eWxlKXt2YXIgcGFyYW1zPW5ldyBqc3RzLm9wZXJhdGlvbi5idWZmZXIuQnVmZmVyUGFyYW1ldGVycyhxdWFkcmFudFNlZ21lbnRzLGVuZENhcFN0eWxlKVxucmV0dXJuIGpzdHMub3BlcmF0aW9uLmJ1ZmZlci5CdWZmZXJPcC5idWZmZXJPcDIodGhpcyxkaXN0YW5jZSxwYXJhbXMpO307anN0cy5nZW9tLkdlb21ldHJ5LnByb3RvdHlwZS5jb252ZXhIdWxsPWZ1bmN0aW9uKCl7cmV0dXJuIG5ldyBqc3RzLmFsZ29yaXRobS5Db252ZXhIdWxsKHRoaXMpLmdldENvbnZleEh1bGwoKTt9O2pzdHMuZ2VvbS5HZW9tZXRyeS5wcm90b3R5cGUuaW50ZXJzZWN0aW9uPWZ1bmN0aW9uKG90aGVyKXtpZih0aGlzLmlzRW1wdHkoKSl7cmV0dXJuIHRoaXMuZ2V0RmFjdG9yeSgpLmNyZWF0ZUdlb21ldHJ5Q29sbGVjdGlvbihudWxsKTt9XG5pZihvdGhlci5pc0VtcHR5KCkpe3JldHVybiB0aGlzLmdldEZhY3RvcnkoKS5jcmVhdGVHZW9tZXRyeUNvbGxlY3Rpb24obnVsbCk7fVxuaWYodGhpcy5pc0dlb21ldHJ5Q29sbGVjdGlvbih0aGlzKSl7dmFyIGcyPW90aGVyO31cbnRoaXMuY2hlY2tOb3RHZW9tZXRyeUNvbGxlY3Rpb24odGhpcyk7dGhpcy5jaGVja05vdEdlb21ldHJ5Q29sbGVjdGlvbihvdGhlcik7cmV0dXJuIGpzdHMub3BlcmF0aW9uLm92ZXJsYXkuc25hcC5TbmFwSWZOZWVkZWRPdmVybGF5T3Aub3ZlcmxheU9wKHRoaXMsb3RoZXIsanN0cy5vcGVyYXRpb24ub3ZlcmxheS5PdmVybGF5T3AuSU5URVJTRUNUSU9OKTt9O2pzdHMuZ2VvbS5HZW9tZXRyeS5wcm90b3R5cGUudW5pb249ZnVuY3Rpb24ob3RoZXIpe2lmKGFyZ3VtZW50cy5sZW5ndGg9PT0wKXtyZXR1cm4ganN0cy5vcGVyYXRpb24udW5pb24uVW5hcnlVbmlvbk9wLnVuaW9uKHRoaXMpO31cbmlmKHRoaXMuaXNFbXB0eSgpKXtyZXR1cm4gb3RoZXIuY2xvbmUoKTt9XG5pZihvdGhlci5pc0VtcHR5KCkpe3JldHVybiB0aGlzLmNsb25lKCk7fVxudGhpcy5jaGVja05vdEdlb21ldHJ5Q29sbGVjdGlvbih0aGlzKTt0aGlzLmNoZWNrTm90R2VvbWV0cnlDb2xsZWN0aW9uKG90aGVyKTtyZXR1cm4ganN0cy5vcGVyYXRpb24ub3ZlcmxheS5zbmFwLlNuYXBJZk5lZWRlZE92ZXJsYXlPcC5vdmVybGF5T3AodGhpcyxvdGhlcixqc3RzLm9wZXJhdGlvbi5vdmVybGF5Lk92ZXJsYXlPcC5VTklPTik7fTtqc3RzLmdlb20uR2VvbWV0cnkucHJvdG90eXBlLmRpZmZlcmVuY2U9ZnVuY3Rpb24ob3RoZXIpe2lmKHRoaXMuaXNFbXB0eSgpKXtyZXR1cm4gdGhpcy5nZXRGYWN0b3J5KCkuY3JlYXRlR2VvbWV0cnlDb2xsZWN0aW9uKG51bGwpO31cbmlmKG90aGVyLmlzRW1wdHkoKSl7cmV0dXJuIHRoaXMuY2xvbmUoKTt9XG50aGlzLmNoZWNrTm90R2VvbWV0cnlDb2xsZWN0aW9uKHRoaXMpO3RoaXMuY2hlY2tOb3RHZW9tZXRyeUNvbGxlY3Rpb24ob3RoZXIpO3JldHVybiBqc3RzLm9wZXJhdGlvbi5vdmVybGF5LnNuYXAuU25hcElmTmVlZGVkT3ZlcmxheU9wLm92ZXJsYXlPcCh0aGlzLG90aGVyLGpzdHMub3BlcmF0aW9uLm92ZXJsYXkuT3ZlcmxheU9wLkRJRkZFUkVOQ0UpO307anN0cy5nZW9tLkdlb21ldHJ5LnByb3RvdHlwZS5zeW1EaWZmZXJlbmNlPWZ1bmN0aW9uKG90aGVyKXtpZih0aGlzLmlzRW1wdHkoKSl7cmV0dXJuIG90aGVyLmNsb25lKCk7fVxuaWYob3RoZXIuaXNFbXB0eSgpKXtyZXR1cm4gdGhpcy5jbG9uZSgpO31cbnRoaXMuY2hlY2tOb3RHZW9tZXRyeUNvbGxlY3Rpb24odGhpcyk7dGhpcy5jaGVja05vdEdlb21ldHJ5Q29sbGVjdGlvbihvdGhlcik7cmV0dXJuIGpzdHMub3BlcmF0aW9uLm92ZXJsYXkuc25hcC5TbmFwSWZOZWVkZWRPdmVybGF5T3Aub3ZlcmxheU9wKHRoaXMsb3RoZXIsanN0cy5vcGVyYXRpb24ub3ZlcmxheS5PdmVybGF5T3AuU1lNRElGRkVSRU5DRSk7fTtqc3RzLmdlb20uR2VvbWV0cnkucHJvdG90eXBlLmVxdWFsc0V4YWN0PWZ1bmN0aW9uKG90aGVyLHRvbGVyYW5jZSl7dGhyb3cgbmV3IGpzdHMuZXJyb3IuQWJzdHJhY3RNZXRob2RJbnZvY2F0aW9uRXJyb3IoKTt9O2pzdHMuZ2VvbS5HZW9tZXRyeS5wcm90b3R5cGUuZXF1YWxzTm9ybT1mdW5jdGlvbihnKXtpZihnPT09bnVsbHx8Zz09PXVuZGVmaW5lZClcbnJldHVybiBmYWxzZTtyZXR1cm4gdGhpcy5ub3JtKCkuZXF1YWxzRXhhY3QoZy5ub3JtKCkpO307anN0cy5nZW9tLkdlb21ldHJ5LnByb3RvdHlwZS5hcHBseT1mdW5jdGlvbihmaWx0ZXIpe3Rocm93IG5ldyBqc3RzLmVycm9yLkFic3RyYWN0TWV0aG9kSW52b2NhdGlvbkVycm9yKCk7fTtqc3RzLmdlb20uR2VvbWV0cnkucHJvdG90eXBlLmNsb25lPWZ1bmN0aW9uKCl7dGhyb3cgbmV3IGpzdHMuZXJyb3IuQWJzdHJhY3RNZXRob2RJbnZvY2F0aW9uRXJyb3IoKTt9O2pzdHMuZ2VvbS5HZW9tZXRyeS5wcm90b3R5cGUubm9ybWFsaXplPWZ1bmN0aW9uKCl7dGhyb3cgbmV3IGpzdHMuZXJyb3IuQWJzdHJhY3RNZXRob2RJbnZvY2F0aW9uRXJyb3IoKTt9O2pzdHMuZ2VvbS5HZW9tZXRyeS5wcm90b3R5cGUubm9ybT1mdW5jdGlvbigpe3ZhciBjb3B5PXRoaXMuY2xvbmUoKTtjb3B5Lm5vcm1hbGl6ZSgpO3JldHVybiBjb3B5O307anN0cy5nZW9tLkdlb21ldHJ5LnByb3RvdHlwZS5jb21wYXJlVG89ZnVuY3Rpb24obyl7dmFyIG90aGVyPW87aWYodGhpcy5nZXRDbGFzc1NvcnRJbmRleCgpIT09b3RoZXIuZ2V0Q2xhc3NTb3J0SW5kZXgoKSl7cmV0dXJuIHRoaXMuZ2V0Q2xhc3NTb3J0SW5kZXgoKS1vdGhlci5nZXRDbGFzc1NvcnRJbmRleCgpO31cbmlmKHRoaXMuaXNFbXB0eSgpJiZvdGhlci5pc0VtcHR5KCkpe3JldHVybiAwO31cbmlmKHRoaXMuaXNFbXB0eSgpKXtyZXR1cm4tMTt9XG5pZihvdGhlci5pc0VtcHR5KCkpe3JldHVybiAxO31cbnJldHVybiB0aGlzLmNvbXBhcmVUb1NhbWVDbGFzcyhvKTt9O2pzdHMuZ2VvbS5HZW9tZXRyeS5wcm90b3R5cGUuaXNFcXVpdmFsZW50Q2xhc3M9ZnVuY3Rpb24ob3RoZXIpe2lmKHRoaXMgaW5zdGFuY2VvZiBqc3RzLmdlb20uUG9pbnQmJm90aGVyIGluc3RhbmNlb2YganN0cy5nZW9tLlBvaW50KXtyZXR1cm4gdHJ1ZTt9ZWxzZSBpZih0aGlzIGluc3RhbmNlb2YganN0cy5nZW9tLkxpbmVTdHJpbmcmJihvdGhlciBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5MaW5lU3RyaW5nfG90aGVyIGluc3RhbmNlb2YganN0cy5nZW9tLkxpbmVhclJpbmcpKXtyZXR1cm4gdHJ1ZTt9ZWxzZSBpZih0aGlzIGluc3RhbmNlb2YganN0cy5nZW9tLkxpbmVhclJpbmcmJihvdGhlciBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5MaW5lU3RyaW5nfG90aGVyIGluc3RhbmNlb2YganN0cy5nZW9tLkxpbmVhclJpbmcpKXtyZXR1cm4gdHJ1ZTt9ZWxzZSBpZih0aGlzIGluc3RhbmNlb2YganN0cy5nZW9tLlBvbHlnb24mJihvdGhlciBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5Qb2x5Z29uKSl7cmV0dXJuIHRydWU7fWVsc2UgaWYodGhpcyBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5NdWx0aVBvaW50JiYob3RoZXIgaW5zdGFuY2VvZiBqc3RzLmdlb20uTXVsdGlQb2ludCkpe3JldHVybiB0cnVlO31lbHNlIGlmKHRoaXMgaW5zdGFuY2VvZiBqc3RzLmdlb20uTXVsdGlMaW5lU3RyaW5nJiYob3RoZXIgaW5zdGFuY2VvZiBqc3RzLmdlb20uTXVsdGlMaW5lU3RyaW5nKSl7cmV0dXJuIHRydWU7fWVsc2UgaWYodGhpcyBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5NdWx0aVBvbHlnb24mJihvdGhlciBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5NdWx0aVBvbHlnb24pKXtyZXR1cm4gdHJ1ZTt9ZWxzZSBpZih0aGlzIGluc3RhbmNlb2YganN0cy5nZW9tLkdlb21ldHJ5Q29sbGVjdGlvbiYmKG90aGVyIGluc3RhbmNlb2YganN0cy5nZW9tLkdlb21ldHJ5Q29sbGVjdGlvbikpe3JldHVybiB0cnVlO31cbnJldHVybiBmYWxzZTt9O2pzdHMuZ2VvbS5HZW9tZXRyeS5wcm90b3R5cGUuY2hlY2tOb3RHZW9tZXRyeUNvbGxlY3Rpb249ZnVuY3Rpb24oZyl7aWYoZy5pc0dlb21ldHJ5Q29sbGVjdGlvbkJhc2UoKSl7dGhyb3cgbmV3IGpzdHMuZXJyb3IuSWxsZWdhbEFyZ3VtZW50RXJyb3IoJ1RoaXMgbWV0aG9kIGRvZXMgbm90IHN1cHBvcnQgR2VvbWV0cnlDb2xsZWN0aW9uJyk7fX07anN0cy5nZW9tLkdlb21ldHJ5LnByb3RvdHlwZS5pc0dlb21ldHJ5Q29sbGVjdGlvbj1mdW5jdGlvbigpe3JldHVybih0aGlzIGluc3RhbmNlb2YganN0cy5nZW9tLkdlb21ldHJ5Q29sbGVjdGlvbik7fTtqc3RzLmdlb20uR2VvbWV0cnkucHJvdG90eXBlLmlzR2VvbWV0cnlDb2xsZWN0aW9uQmFzZT1mdW5jdGlvbigpe3JldHVybih0aGlzLkNMQVNTX05BTUU9PT0nanN0cy5nZW9tLkdlb21ldHJ5Q29sbGVjdGlvbicpO307anN0cy5nZW9tLkdlb21ldHJ5LnByb3RvdHlwZS5jb21wdXRlRW52ZWxvcGVJbnRlcm5hbD1mdW5jdGlvbigpe3Rocm93IG5ldyBqc3RzLmVycm9yLkFic3RyYWN0TWV0aG9kSW52b2NhdGlvbkVycm9yKCk7fTtqc3RzLmdlb20uR2VvbWV0cnkucHJvdG90eXBlLmNvbXBhcmVUb1NhbWVDbGFzcz1mdW5jdGlvbihvKXt0aHJvdyBuZXcganN0cy5lcnJvci5BYnN0cmFjdE1ldGhvZEludm9jYXRpb25FcnJvcigpO307anN0cy5nZW9tLkdlb21ldHJ5LnByb3RvdHlwZS5jb21wYXJlPWZ1bmN0aW9uKGEsYil7dmFyIGk9YS5pdGVyYXRvcigpO3ZhciBqPWIuaXRlcmF0b3IoKTt3aGlsZShpLmhhc05leHQoKSYmai5oYXNOZXh0KCkpe3ZhciBhRWxlbWVudD1pLm5leHQoKTt2YXIgYkVsZW1lbnQ9ai5uZXh0KCk7dmFyIGNvbXBhcmlzb249YUVsZW1lbnQuY29tcGFyZVRvKGJFbGVtZW50KTtpZihjb21wYXJpc29uIT09MCl7cmV0dXJuIGNvbXBhcmlzb247fX1cbmlmKGkuaGFzTmV4dCgpKXtyZXR1cm4gMTt9XG5pZihqLmhhc05leHQoKSl7cmV0dXJuLTE7fVxucmV0dXJuIDA7fTtqc3RzLmdlb20uR2VvbWV0cnkucHJvdG90eXBlLmVxdWFsPWZ1bmN0aW9uKGEsYix0b2xlcmFuY2Upe2lmKHRvbGVyYW5jZT09PXVuZGVmaW5lZHx8dG9sZXJhbmNlPT09bnVsbHx8dG9sZXJhbmNlPT09MCl7cmV0dXJuIGEuZXF1YWxzKGIpO31cbnJldHVybiBhLmRpc3RhbmNlKGIpPD10b2xlcmFuY2U7fTtqc3RzLmdlb20uR2VvbWV0cnkucHJvdG90eXBlLmdldENsYXNzU29ydEluZGV4PWZ1bmN0aW9uKCl7dmFyIHNvcnRlZENsYXNzZXM9W2pzdHMuZ2VvbS5Qb2ludCxqc3RzLmdlb20uTXVsdGlQb2ludCxqc3RzLmdlb20uTGluZVN0cmluZyxqc3RzLmdlb20uTGluZWFyUmluZyxqc3RzLmdlb20uTXVsdGlMaW5lU3RyaW5nLGpzdHMuZ2VvbS5Qb2x5Z29uLGpzdHMuZ2VvbS5NdWx0aVBvbHlnb24sanN0cy5nZW9tLkdlb21ldHJ5Q29sbGVjdGlvbl07Zm9yKHZhciBpPTA7aTxzb3J0ZWRDbGFzc2VzLmxlbmd0aDtpKyspe2lmKHRoaXMgaW5zdGFuY2VvZiBzb3J0ZWRDbGFzc2VzW2ldKVxucmV0dXJuIGk7fVxuanN0cy51dGlsLkFzc2VydC5zaG91bGROZXZlclJlYWNoSGVyZSgnQ2xhc3Mgbm90IHN1cHBvcnRlZDogJyt0aGlzKTtyZXR1cm4tMTt9O2pzdHMuZ2VvbS5HZW9tZXRyeS5wcm90b3R5cGUudG9TdHJpbmc9ZnVuY3Rpb24oKXtyZXR1cm4gbmV3IGpzdHMuaW8uV0tUV3JpdGVyKCkud3JpdGUodGhpcyk7fTtqc3RzLmdlb20uR2VvbWV0cnkucHJvdG90eXBlLmNyZWF0ZVBvaW50RnJvbUludGVybmFsQ29vcmQ9ZnVuY3Rpb24oY29vcmQsZXhlbXBsYXIpe2V4ZW1wbGFyLmdldFByZWNpc2lvbk1vZGVsKCkubWFrZVByZWNpc2UoY29vcmQpO3JldHVybiBleGVtcGxhci5nZXRGYWN0b3J5KCkuY3JlYXRlUG9pbnQoY29vcmQpO307KGZ1bmN0aW9uKCl7anN0cy5nZW9tLkNvb3JkaW5hdGU9ZnVuY3Rpb24oeCx5KXtpZih0eXBlb2YgeD09PSdudW1iZXInKXt0aGlzLng9eDt0aGlzLnk9eTt9ZWxzZSBpZih4IGluc3RhbmNlb2YganN0cy5nZW9tLkNvb3JkaW5hdGUpe3RoaXMueD1wYXJzZUZsb2F0KHgueCk7dGhpcy55PXBhcnNlRmxvYXQoeC55KTt9ZWxzZSBpZih4PT09dW5kZWZpbmVkfHx4PT09bnVsbCl7dGhpcy54PTA7dGhpcy55PTA7fWVsc2UgaWYodHlwZW9mIHg9PT0nc3RyaW5nJyl7dGhpcy54PXBhcnNlRmxvYXQoeCk7dGhpcy55PXBhcnNlRmxvYXQoeSk7fX07anN0cy5nZW9tLkNvb3JkaW5hdGUucHJvdG90eXBlLnNldENvb3JkaW5hdGU9ZnVuY3Rpb24ob3RoZXIpe3RoaXMueD1vdGhlci54O3RoaXMueT1vdGhlci55O307anN0cy5nZW9tLkNvb3JkaW5hdGUucHJvdG90eXBlLmNsb25lPWZ1bmN0aW9uKCl7cmV0dXJuIG5ldyBqc3RzLmdlb20uQ29vcmRpbmF0ZSh0aGlzLngsdGhpcy55KTt9O2pzdHMuZ2VvbS5Db29yZGluYXRlLnByb3RvdHlwZS5kaXN0YW5jZT1mdW5jdGlvbihwKXt2YXIgZHg9dGhpcy54LXAueDt2YXIgZHk9dGhpcy55LXAueTtyZXR1cm4gTWF0aC5zcXJ0KGR4KmR4K2R5KmR5KTt9O2pzdHMuZ2VvbS5Db29yZGluYXRlLnByb3RvdHlwZS5lcXVhbHMyRD1mdW5jdGlvbihvdGhlcil7aWYodGhpcy54IT09b3RoZXIueCl7cmV0dXJuIGZhbHNlO31cbmlmKHRoaXMueSE9PW90aGVyLnkpe3JldHVybiBmYWxzZTt9XG5yZXR1cm4gdHJ1ZTt9O2pzdHMuZ2VvbS5Db29yZGluYXRlLnByb3RvdHlwZS5lcXVhbHM9ZnVuY3Rpb24ob3RoZXIpe2lmKCFvdGhlciBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5Db29yZGluYXRlfHxvdGhlcj09PXVuZGVmaW5lZCl7cmV0dXJuIGZhbHNlO31cbnJldHVybiB0aGlzLmVxdWFsczJEKG90aGVyKTt9O2pzdHMuZ2VvbS5Db29yZGluYXRlLnByb3RvdHlwZS5jb21wYXJlVG89ZnVuY3Rpb24ob3RoZXIpe2lmKHRoaXMueDxvdGhlci54KXtyZXR1cm4tMTt9XG5pZih0aGlzLng+b3RoZXIueCl7cmV0dXJuIDE7fVxuaWYodGhpcy55PG90aGVyLnkpe3JldHVybi0xO31cbmlmKHRoaXMueT5vdGhlci55KXtyZXR1cm4gMTt9XG5yZXR1cm4gMDt9O2pzdHMuZ2VvbS5Db29yZGluYXRlLnByb3RvdHlwZS50b1N0cmluZz1mdW5jdGlvbigpe3JldHVybicoJyt0aGlzLngrJywgJyt0aGlzLnkrJyknO307fSkoKTtqc3RzLmdlb20uRW52ZWxvcGU9ZnVuY3Rpb24oKXtqc3RzLmdlb20uRW52ZWxvcGUucHJvdG90eXBlLmluaXQuYXBwbHkodGhpcyxhcmd1bWVudHMpO307anN0cy5nZW9tLkVudmVsb3BlLnByb3RvdHlwZS5taW54PW51bGw7anN0cy5nZW9tLkVudmVsb3BlLnByb3RvdHlwZS5tYXh4PW51bGw7anN0cy5nZW9tLkVudmVsb3BlLnByb3RvdHlwZS5taW55PW51bGw7anN0cy5nZW9tLkVudmVsb3BlLnByb3RvdHlwZS5tYXh5PW51bGw7anN0cy5nZW9tLkVudmVsb3BlLnByb3RvdHlwZS5pbml0PWZ1bmN0aW9uKCl7aWYodHlwZW9mIGFyZ3VtZW50c1swXT09PSdudW1iZXInJiZhcmd1bWVudHMubGVuZ3RoPT09NCl7dGhpcy5pbml0RnJvbVZhbHVlcyhhcmd1bWVudHNbMF0sYXJndW1lbnRzWzFdLGFyZ3VtZW50c1syXSxhcmd1bWVudHNbM10pO31lbHNlIGlmKGFyZ3VtZW50c1swXWluc3RhbmNlb2YganN0cy5nZW9tLkNvb3JkaW5hdGUmJmFyZ3VtZW50cy5sZW5ndGg9PT0xKXt0aGlzLmluaXRGcm9tQ29vcmRpbmF0ZShhcmd1bWVudHNbMF0pO31lbHNlIGlmKGFyZ3VtZW50c1swXWluc3RhbmNlb2YganN0cy5nZW9tLkNvb3JkaW5hdGUmJmFyZ3VtZW50cy5sZW5ndGg9PT0yKXt0aGlzLmluaXRGcm9tQ29vcmRpbmF0ZXMoYXJndW1lbnRzWzBdLGFyZ3VtZW50c1sxXSk7fWVsc2UgaWYoYXJndW1lbnRzWzBdaW5zdGFuY2VvZiBqc3RzLmdlb20uRW52ZWxvcGUmJmFyZ3VtZW50cy5sZW5ndGg9PT0xKXt0aGlzLmluaXRGcm9tRW52ZWxvcGUoYXJndW1lbnRzWzBdKTt9ZWxzZXt0aGlzLnNldFRvTnVsbCgpO319O2pzdHMuZ2VvbS5FbnZlbG9wZS5wcm90b3R5cGUuaW5pdEZyb21WYWx1ZXM9ZnVuY3Rpb24oeDEseDIseTEseTIpe2lmKHgxPHgyKXt0aGlzLm1pbng9eDE7dGhpcy5tYXh4PXgyO31lbHNle3RoaXMubWlueD14Mjt0aGlzLm1heHg9eDE7fVxuaWYoeTE8eTIpe3RoaXMubWlueT15MTt0aGlzLm1heHk9eTI7fWVsc2V7dGhpcy5taW55PXkyO3RoaXMubWF4eT15MTt9fTtqc3RzLmdlb20uRW52ZWxvcGUucHJvdG90eXBlLmluaXRGcm9tQ29vcmRpbmF0ZXM9ZnVuY3Rpb24ocDEscDIpe3RoaXMuaW5pdEZyb21WYWx1ZXMocDEueCxwMi54LHAxLnkscDIueSk7fTtqc3RzLmdlb20uRW52ZWxvcGUucHJvdG90eXBlLmluaXRGcm9tQ29vcmRpbmF0ZT1mdW5jdGlvbihwKXt0aGlzLmluaXRGcm9tVmFsdWVzKHAueCxwLngscC55LHAueSk7fTtqc3RzLmdlb20uRW52ZWxvcGUucHJvdG90eXBlLmluaXRGcm9tRW52ZWxvcGU9ZnVuY3Rpb24oZW52KXt0aGlzLm1pbng9ZW52Lm1pbng7dGhpcy5tYXh4PWVudi5tYXh4O3RoaXMubWlueT1lbnYubWlueTt0aGlzLm1heHk9ZW52Lm1heHk7fTtqc3RzLmdlb20uRW52ZWxvcGUucHJvdG90eXBlLnNldFRvTnVsbD1mdW5jdGlvbigpe3RoaXMubWlueD0wO3RoaXMubWF4eD0tMTt0aGlzLm1pbnk9MDt0aGlzLm1heHk9LTE7fTtqc3RzLmdlb20uRW52ZWxvcGUucHJvdG90eXBlLmlzTnVsbD1mdW5jdGlvbigpe3JldHVybiB0aGlzLm1heHg8dGhpcy5taW54O307anN0cy5nZW9tLkVudmVsb3BlLnByb3RvdHlwZS5nZXRIZWlnaHQ9ZnVuY3Rpb24oKXtpZih0aGlzLmlzTnVsbCgpKXtyZXR1cm4gMDt9XG5yZXR1cm4gdGhpcy5tYXh5LXRoaXMubWlueTt9O2pzdHMuZ2VvbS5FbnZlbG9wZS5wcm90b3R5cGUuZ2V0V2lkdGg9ZnVuY3Rpb24oKXtpZih0aGlzLmlzTnVsbCgpKXtyZXR1cm4gMDt9XG5yZXR1cm4gdGhpcy5tYXh4LXRoaXMubWlueDt9O2pzdHMuZ2VvbS5FbnZlbG9wZS5wcm90b3R5cGUuZ2V0TWluWD1mdW5jdGlvbigpe3JldHVybiB0aGlzLm1pbng7fTtqc3RzLmdlb20uRW52ZWxvcGUucHJvdG90eXBlLmdldE1heFg9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5tYXh4O307anN0cy5nZW9tLkVudmVsb3BlLnByb3RvdHlwZS5nZXRNaW5ZPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMubWlueTt9O2pzdHMuZ2VvbS5FbnZlbG9wZS5wcm90b3R5cGUuZ2V0TWF4WT1mdW5jdGlvbigpe3JldHVybiB0aGlzLm1heHk7fTtqc3RzLmdlb20uRW52ZWxvcGUucHJvdG90eXBlLmdldEFyZWE9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5nZXRXaWR0aCgpKnRoaXMuZ2V0SGVpZ2h0KCk7fTtqc3RzLmdlb20uRW52ZWxvcGUucHJvdG90eXBlLmV4cGFuZFRvSW5jbHVkZT1mdW5jdGlvbigpe2lmKGFyZ3VtZW50c1swXWluc3RhbmNlb2YganN0cy5nZW9tLkNvb3JkaW5hdGUpe3RoaXMuZXhwYW5kVG9JbmNsdWRlQ29vcmRpbmF0ZShhcmd1bWVudHNbMF0pO31lbHNlIGlmKGFyZ3VtZW50c1swXWluc3RhbmNlb2YganN0cy5nZW9tLkVudmVsb3BlKXt0aGlzLmV4cGFuZFRvSW5jbHVkZUVudmVsb3BlKGFyZ3VtZW50c1swXSk7fWVsc2V7dGhpcy5leHBhbmRUb0luY2x1ZGVWYWx1ZXMoYXJndW1lbnRzWzBdLGFyZ3VtZW50c1sxXSk7fX07anN0cy5nZW9tLkVudmVsb3BlLnByb3RvdHlwZS5leHBhbmRUb0luY2x1ZGVDb29yZGluYXRlPWZ1bmN0aW9uKHApe3RoaXMuZXhwYW5kVG9JbmNsdWRlVmFsdWVzKHAueCxwLnkpO307anN0cy5nZW9tLkVudmVsb3BlLnByb3RvdHlwZS5leHBhbmRUb0luY2x1ZGVWYWx1ZXM9ZnVuY3Rpb24oeCx5KXtpZih0aGlzLmlzTnVsbCgpKXt0aGlzLm1pbng9eDt0aGlzLm1heHg9eDt0aGlzLm1pbnk9eTt0aGlzLm1heHk9eTt9ZWxzZXtpZih4PHRoaXMubWlueCl7dGhpcy5taW54PXg7fVxuaWYoeD50aGlzLm1heHgpe3RoaXMubWF4eD14O31cbmlmKHk8dGhpcy5taW55KXt0aGlzLm1pbnk9eTt9XG5pZih5PnRoaXMubWF4eSl7dGhpcy5tYXh5PXk7fX19O2pzdHMuZ2VvbS5FbnZlbG9wZS5wcm90b3R5cGUuZXhwYW5kVG9JbmNsdWRlRW52ZWxvcGU9ZnVuY3Rpb24ob3RoZXIpe2lmKG90aGVyLmlzTnVsbCgpKXtyZXR1cm47fVxuaWYodGhpcy5pc051bGwoKSl7dGhpcy5taW54PW90aGVyLmdldE1pblgoKTt0aGlzLm1heHg9b3RoZXIuZ2V0TWF4WCgpO3RoaXMubWlueT1vdGhlci5nZXRNaW5ZKCk7dGhpcy5tYXh5PW90aGVyLmdldE1heFkoKTt9ZWxzZXtpZihvdGhlci5taW54PHRoaXMubWlueCl7dGhpcy5taW54PW90aGVyLm1pbng7fVxuaWYob3RoZXIubWF4eD50aGlzLm1heHgpe3RoaXMubWF4eD1vdGhlci5tYXh4O31cbmlmKG90aGVyLm1pbnk8dGhpcy5taW55KXt0aGlzLm1pbnk9b3RoZXIubWlueTt9XG5pZihvdGhlci5tYXh5PnRoaXMubWF4eSl7dGhpcy5tYXh5PW90aGVyLm1heHk7fX19O2pzdHMuZ2VvbS5FbnZlbG9wZS5wcm90b3R5cGUuZXhwYW5kQnk9ZnVuY3Rpb24oKXtpZihhcmd1bWVudHMubGVuZ3RoPT09MSl7dGhpcy5leHBhbmRCeURpc3RhbmNlKGFyZ3VtZW50c1swXSk7fWVsc2V7dGhpcy5leHBhbmRCeURpc3RhbmNlcyhhcmd1bWVudHNbMF0sYXJndW1lbnRzWzFdKTt9fTtqc3RzLmdlb20uRW52ZWxvcGUucHJvdG90eXBlLmV4cGFuZEJ5RGlzdGFuY2U9ZnVuY3Rpb24oZGlzdGFuY2Upe3RoaXMuZXhwYW5kQnlEaXN0YW5jZXMoZGlzdGFuY2UsZGlzdGFuY2UpO307anN0cy5nZW9tLkVudmVsb3BlLnByb3RvdHlwZS5leHBhbmRCeURpc3RhbmNlcz1mdW5jdGlvbihkZWx0YVgsZGVsdGFZKXtpZih0aGlzLmlzTnVsbCgpKXtyZXR1cm47fVxudGhpcy5taW54LT1kZWx0YVg7dGhpcy5tYXh4Kz1kZWx0YVg7dGhpcy5taW55LT1kZWx0YVk7dGhpcy5tYXh5Kz1kZWx0YVk7aWYodGhpcy5taW54PnRoaXMubWF4eHx8dGhpcy5taW55PnRoaXMubWF4eSl7dGhpcy5zZXRUb051bGwoKTt9fTtqc3RzLmdlb20uRW52ZWxvcGUucHJvdG90eXBlLnRyYW5zbGF0ZT1mdW5jdGlvbih0cmFuc1gsdHJhbnNZKXtpZih0aGlzLmlzTnVsbCgpKXtyZXR1cm47fVxudGhpcy5pbml0KHRoaXMubWlueCt0cmFuc1gsdGhpcy5tYXh4K3RyYW5zWCx0aGlzLm1pbnkrdHJhbnNZLHRoaXMubWF4eSt0cmFuc1kpO307anN0cy5nZW9tLkVudmVsb3BlLnByb3RvdHlwZS5jZW50cmU9ZnVuY3Rpb24oKXtpZih0aGlzLmlzTnVsbCgpKXtyZXR1cm4gbnVsbDt9XG5yZXR1cm4gbmV3IGpzdHMuZ2VvbS5Db29yZGluYXRlKCh0aGlzLm1pbngrdGhpcy5tYXh4KS8yLjAsKHRoaXMubWlueSt0aGlzLm1heHkpLzIuMCk7fTtqc3RzLmdlb20uRW52ZWxvcGUucHJvdG90eXBlLmludGVyc2VjdGlvbj1mdW5jdGlvbihlbnYpe2lmKHRoaXMuaXNOdWxsKCl8fGVudi5pc051bGwoKXx8IXRoaXMuaW50ZXJzZWN0cyhlbnYpKXtyZXR1cm4gbmV3IGpzdHMuZ2VvbS5FbnZlbG9wZSgpO31cbnZhciBpbnRNaW5YPXRoaXMubWlueD5lbnYubWlueD90aGlzLm1pbng6ZW52Lm1pbng7dmFyIGludE1pblk9dGhpcy5taW55PmVudi5taW55P3RoaXMubWlueTplbnYubWlueTt2YXIgaW50TWF4WD10aGlzLm1heHg8ZW52Lm1heHg/dGhpcy5tYXh4OmVudi5tYXh4O3ZhciBpbnRNYXhZPXRoaXMubWF4eTxlbnYubWF4eT90aGlzLm1heHk6ZW52Lm1heHk7cmV0dXJuIG5ldyBqc3RzLmdlb20uRW52ZWxvcGUoaW50TWluWCxpbnRNYXhYLGludE1pblksaW50TWF4WSk7fTtqc3RzLmdlb20uRW52ZWxvcGUucHJvdG90eXBlLmludGVyc2VjdHM9ZnVuY3Rpb24oKXtpZihhcmd1bWVudHNbMF1pbnN0YW5jZW9mIGpzdHMuZ2VvbS5FbnZlbG9wZSl7cmV0dXJuIHRoaXMuaW50ZXJzZWN0c0VudmVsb3BlKGFyZ3VtZW50c1swXSk7fWVsc2UgaWYoYXJndW1lbnRzWzBdaW5zdGFuY2VvZiBqc3RzLmdlb20uQ29vcmRpbmF0ZSl7cmV0dXJuIHRoaXMuaW50ZXJzZWN0c0Nvb3JkaW5hdGUoYXJndW1lbnRzWzBdKTt9ZWxzZXtyZXR1cm4gdGhpcy5pbnRlcnNlY3RzVmFsdWVzKGFyZ3VtZW50c1swXSxhcmd1bWVudHNbMV0pO319O2pzdHMuZ2VvbS5FbnZlbG9wZS5wcm90b3R5cGUuaW50ZXJzZWN0c0VudmVsb3BlPWZ1bmN0aW9uKG90aGVyKXtpZih0aGlzLmlzTnVsbCgpfHxvdGhlci5pc051bGwoKSl7cmV0dXJuIGZhbHNlO31cbnZhciByZXN1bHQ9IShvdGhlci5taW54PnRoaXMubWF4eHx8b3RoZXIubWF4eDx0aGlzLm1pbnh8fG90aGVyLm1pbnk+dGhpcy5tYXh5fHxvdGhlci5tYXh5PHRoaXMubWlueSk7cmV0dXJuIHJlc3VsdDt9O2pzdHMuZ2VvbS5FbnZlbG9wZS5wcm90b3R5cGUuaW50ZXJzZWN0c0Nvb3JkaW5hdGU9ZnVuY3Rpb24ocCl7cmV0dXJuIHRoaXMuaW50ZXJzZWN0c1ZhbHVlcyhwLngscC55KTt9O2pzdHMuZ2VvbS5FbnZlbG9wZS5wcm90b3R5cGUuaW50ZXJzZWN0c1ZhbHVlcz1mdW5jdGlvbih4LHkpe2lmKHRoaXMuaXNOdWxsKCkpe3JldHVybiBmYWxzZTt9XG5yZXR1cm4hKHg+dGhpcy5tYXh4fHx4PHRoaXMubWlueHx8eT50aGlzLm1heHl8fHk8dGhpcy5taW55KTt9O2pzdHMuZ2VvbS5FbnZlbG9wZS5wcm90b3R5cGUuY29udGFpbnM9ZnVuY3Rpb24oKXtpZihhcmd1bWVudHNbMF1pbnN0YW5jZW9mIGpzdHMuZ2VvbS5FbnZlbG9wZSl7cmV0dXJuIHRoaXMuY29udGFpbnNFbnZlbG9wZShhcmd1bWVudHNbMF0pO31lbHNlIGlmKGFyZ3VtZW50c1swXWluc3RhbmNlb2YganN0cy5nZW9tLkNvb3JkaW5hdGUpe3JldHVybiB0aGlzLmNvbnRhaW5zQ29vcmRpbmF0ZShhcmd1bWVudHNbMF0pO31lbHNle3JldHVybiB0aGlzLmNvbnRhaW5zVmFsdWVzKGFyZ3VtZW50c1swXSxhcmd1bWVudHNbMV0pO319O2pzdHMuZ2VvbS5FbnZlbG9wZS5wcm90b3R5cGUuY29udGFpbnNFbnZlbG9wZT1mdW5jdGlvbihvdGhlcil7cmV0dXJuIHRoaXMuY292ZXJzRW52ZWxvcGUob3RoZXIpO307anN0cy5nZW9tLkVudmVsb3BlLnByb3RvdHlwZS5jb250YWluc0Nvb3JkaW5hdGU9ZnVuY3Rpb24ocCl7cmV0dXJuIHRoaXMuY292ZXJzQ29vcmRpbmF0ZShwKTt9O2pzdHMuZ2VvbS5FbnZlbG9wZS5wcm90b3R5cGUuY29udGFpbnNWYWx1ZXM9ZnVuY3Rpb24oeCx5KXtyZXR1cm4gdGhpcy5jb3ZlcnNWYWx1ZXMoeCx5KTt9O2pzdHMuZ2VvbS5FbnZlbG9wZS5wcm90b3R5cGUuY292ZXJzPWZ1bmN0aW9uKCl7aWYoYXJndW1lbnRzWzBdaW5zdGFuY2VvZiBqc3RzLmdlb20uRW52ZWxvcGUpe3JldHVybiB0aGlzLmNvdmVyc0VudmVsb3BlKGFyZ3VtZW50c1swXSk7fWVsc2UgaWYoYXJndW1lbnRzWzBdaW5zdGFuY2VvZiBqc3RzLmdlb20uQ29vcmRpbmF0ZSl7cmV0dXJuIHRoaXMuY292ZXJzQ29vcmRpbmF0ZShhcmd1bWVudHNbMF0pO31lbHNle3JldHVybiB0aGlzLmNvdmVyc1ZhbHVlcyhhcmd1bWVudHNbMF0sYXJndW1lbnRzWzFdKTt9fTtqc3RzLmdlb20uRW52ZWxvcGUucHJvdG90eXBlLmNvdmVyc1ZhbHVlcz1mdW5jdGlvbih4LHkpe2lmKHRoaXMuaXNOdWxsKCkpe3JldHVybiBmYWxzZTt9XG5yZXR1cm4geD49dGhpcy5taW54JiZ4PD10aGlzLm1heHgmJnk+PXRoaXMubWlueSYmeTw9dGhpcy5tYXh5O307anN0cy5nZW9tLkVudmVsb3BlLnByb3RvdHlwZS5jb3ZlcnNDb29yZGluYXRlPWZ1bmN0aW9uKHApe3JldHVybiB0aGlzLmNvdmVyc1ZhbHVlcyhwLngscC55KTt9O2pzdHMuZ2VvbS5FbnZlbG9wZS5wcm90b3R5cGUuY292ZXJzRW52ZWxvcGU9ZnVuY3Rpb24ob3RoZXIpe2lmKHRoaXMuaXNOdWxsKCl8fG90aGVyLmlzTnVsbCgpKXtyZXR1cm4gZmFsc2U7fVxucmV0dXJuIG90aGVyLm1pbng+PXRoaXMubWlueCYmb3RoZXIubWF4eDw9dGhpcy5tYXh4JiZvdGhlci5taW55Pj10aGlzLm1pbnkmJm90aGVyLm1heHk8PXRoaXMubWF4eTt9O2pzdHMuZ2VvbS5FbnZlbG9wZS5wcm90b3R5cGUuZGlzdGFuY2U9ZnVuY3Rpb24oZW52KXtpZih0aGlzLmludGVyc2VjdHMoZW52KSl7cmV0dXJuIDA7fVxudmFyIGR4PTAuMDtpZih0aGlzLm1heHg8ZW52Lm1pbngpe2R4PWVudi5taW54LXRoaXMubWF4eDt9XG5pZih0aGlzLm1pbng+ZW52Lm1heHgpe2R4PXRoaXMubWlueC1lbnYubWF4eDt9XG52YXIgZHk9MC4wO2lmKHRoaXMubWF4eTxlbnYubWlueSl7ZHk9ZW52Lm1pbnktdGhpcy5tYXh5O31cbmlmKHRoaXMubWlueT5lbnYubWF4eSl7ZHk9dGhpcy5taW55LWVudi5tYXh5O31cbmlmKGR4PT09MC4wKXtyZXR1cm4gZHk7fVxuaWYoZHk9PT0wLjApe3JldHVybiBkeDt9XG5yZXR1cm4gTWF0aC5zcXJ0KGR4KmR4K2R5KmR5KTt9O2pzdHMuZ2VvbS5FbnZlbG9wZS5wcm90b3R5cGUuZXF1YWxzPWZ1bmN0aW9uKG90aGVyKXtpZih0aGlzLmlzTnVsbCgpKXtyZXR1cm4gb3RoZXIuaXNOdWxsKCk7fVxucmV0dXJuIHRoaXMubWF4eD09PW90aGVyLm1heHgmJnRoaXMubWF4eT09PW90aGVyLm1heHkmJnRoaXMubWlueD09PW90aGVyLm1pbngmJnRoaXMubWlueT09PW90aGVyLm1pbnk7fTtqc3RzLmdlb20uRW52ZWxvcGUucHJvdG90eXBlLnRvU3RyaW5nPWZ1bmN0aW9uKCl7cmV0dXJuJ0VudlsnK3RoaXMubWlueCsnIDogJyt0aGlzLm1heHgrJywgJyt0aGlzLm1pbnkrJyA6ICcrXG50aGlzLm1heHkrJ10nO307anN0cy5nZW9tLkVudmVsb3BlLmludGVyc2VjdHM9ZnVuY3Rpb24ocDEscDIscSl7aWYoYXJndW1lbnRzLmxlbmd0aD09PTQpe3JldHVybiBqc3RzLmdlb20uRW52ZWxvcGUuaW50ZXJzZWN0c0VudmVsb3BlKGFyZ3VtZW50c1swXSxhcmd1bWVudHNbMV0sYXJndW1lbnRzWzJdLGFyZ3VtZW50c1szXSk7fVxudmFyIHhjMT1wMS54PHAyLng/cDEueDpwMi54O3ZhciB4YzI9cDEueD5wMi54P3AxLng6cDIueDt2YXIgeWMxPXAxLnk8cDIueT9wMS55OnAyLnk7dmFyIHljMj1wMS55PnAyLnk/cDEueTpwMi55O2lmKCgocS54Pj14YzEpJiYocS54PD14YzIpKSYmKChxLnk+PXljMSkmJihxLnk8PXljMikpKXtyZXR1cm4gdHJ1ZTt9XG5yZXR1cm4gZmFsc2U7fTtqc3RzLmdlb20uRW52ZWxvcGUuaW50ZXJzZWN0c0VudmVsb3BlPWZ1bmN0aW9uKHAxLHAyLHExLHEyKXt2YXIgbWlucT1NYXRoLm1pbihxMS54LHEyLngpO3ZhciBtYXhxPU1hdGgubWF4KHExLngscTIueCk7dmFyIG1pbnA9TWF0aC5taW4ocDEueCxwMi54KTt2YXIgbWF4cD1NYXRoLm1heChwMS54LHAyLngpO2lmKG1pbnA+bWF4cSl7cmV0dXJuIGZhbHNlO31cbmlmKG1heHA8bWlucSl7cmV0dXJuIGZhbHNlO31cbm1pbnE9TWF0aC5taW4ocTEueSxxMi55KTttYXhxPU1hdGgubWF4KHExLnkscTIueSk7bWlucD1NYXRoLm1pbihwMS55LHAyLnkpO21heHA9TWF0aC5tYXgocDEueSxwMi55KTtpZihtaW5wPm1heHEpe3JldHVybiBmYWxzZTt9XG5pZihtYXhwPG1pbnEpe3JldHVybiBmYWxzZTt9XG5yZXR1cm4gdHJ1ZTt9O2pzdHMuZ2VvbS5FbnZlbG9wZS5wcm90b3R5cGUuY2xvbmU9ZnVuY3Rpb24oKXtyZXR1cm4gbmV3IGpzdHMuZ2VvbS5FbnZlbG9wZSh0aGlzLm1pbngsdGhpcy5tYXh4LHRoaXMubWlueSx0aGlzLm1heHkpO307anN0cy5nZW9tLnV0aWwuR2VvbWV0cnlDb21iaW5lcj1mdW5jdGlvbihnZW9tcyl7dGhpcy5nZW9tRmFjdG9yeT1qc3RzLmdlb20udXRpbC5HZW9tZXRyeUNvbWJpbmVyLmV4dHJhY3RGYWN0b3J5KGdlb21zKTt0aGlzLmlucHV0R2VvbXM9Z2VvbXM7fTtqc3RzLmdlb20udXRpbC5HZW9tZXRyeUNvbWJpbmVyLmNvbWJpbmU9ZnVuY3Rpb24oZ2VvbXMpe2lmKGFyZ3VtZW50cy5sZW5ndGg+MSlyZXR1cm4gdGhpcy5jb21iaW5lMi5hcHBseSh0aGlzLGFyZ3VtZW50cyk7dmFyIGNvbWJpbmVyPW5ldyBqc3RzLmdlb20udXRpbC5HZW9tZXRyeUNvbWJpbmVyKGdlb21zKTtyZXR1cm4gY29tYmluZXIuY29tYmluZSgpO307anN0cy5nZW9tLnV0aWwuR2VvbWV0cnlDb21iaW5lci5jb21iaW5lMj1mdW5jdGlvbigpe3ZhciBhcnJheUxpc3Q9bmV3IGphdmFzY3JpcHQudXRpbC5BcnJheUxpc3QoKTtBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMpLmZvckVhY2goZnVuY3Rpb24oYSl7YXJyYXlMaXN0LmFkZChhKTt9KTt2YXIgY29tYmluZXI9bmV3IGpzdHMuZ2VvbS51dGlsLkdlb21ldHJ5Q29tYmluZXIoYXJyYXlMaXN0KTtyZXR1cm4gY29tYmluZXIuY29tYmluZSgpO307anN0cy5nZW9tLnV0aWwuR2VvbWV0cnlDb21iaW5lci5wcm90b3R5cGUuZ2VvbUZhY3Rvcnk9bnVsbDtqc3RzLmdlb20udXRpbC5HZW9tZXRyeUNvbWJpbmVyLnByb3RvdHlwZS5za2lwRW1wdHk9ZmFsc2U7anN0cy5nZW9tLnV0aWwuR2VvbWV0cnlDb21iaW5lci5wcm90b3R5cGUuaW5wdXRHZW9tcztqc3RzLmdlb20udXRpbC5HZW9tZXRyeUNvbWJpbmVyLmV4dHJhY3RGYWN0b3J5PWZ1bmN0aW9uKGdlb21zKXtpZihnZW9tcy5pc0VtcHR5KCkpcmV0dXJuIG51bGw7cmV0dXJuIGdlb21zLml0ZXJhdG9yKCkubmV4dCgpLmdldEZhY3RvcnkoKTt9O2pzdHMuZ2VvbS51dGlsLkdlb21ldHJ5Q29tYmluZXIucHJvdG90eXBlLmNvbWJpbmU9ZnVuY3Rpb24oKXt2YXIgZWxlbXM9bmV3IGphdmFzY3JpcHQudXRpbC5BcnJheUxpc3QoKSxpO2ZvcihpPXRoaXMuaW5wdXRHZW9tcy5pdGVyYXRvcigpO2kuaGFzTmV4dCgpOyl7dmFyIGc9aS5uZXh0KCk7dGhpcy5leHRyYWN0RWxlbWVudHMoZyxlbGVtcyk7fVxuaWYoZWxlbXMuc2l6ZSgpPT09MCl7aWYodGhpcy5nZW9tRmFjdG9yeSE9PW51bGwpe3JldHVybiB0aGlzLmdlb21GYWN0b3J5LmNyZWF0ZUdlb21ldHJ5Q29sbGVjdGlvbihudWxsKTt9XG5yZXR1cm4gbnVsbDt9XG5yZXR1cm4gdGhpcy5nZW9tRmFjdG9yeS5idWlsZEdlb21ldHJ5KGVsZW1zKTt9O2pzdHMuZ2VvbS51dGlsLkdlb21ldHJ5Q29tYmluZXIucHJvdG90eXBlLmV4dHJhY3RFbGVtZW50cz1mdW5jdGlvbihnZW9tLGVsZW1zKXtpZihnZW9tPT09bnVsbCl7cmV0dXJuO31cbmZvcih2YXIgaT0wO2k8Z2VvbS5nZXROdW1HZW9tZXRyaWVzKCk7aSsrKXt2YXIgZWxlbUdlb209Z2VvbS5nZXRHZW9tZXRyeU4oaSk7aWYodGhpcy5za2lwRW1wdHkmJmVsZW1HZW9tLmlzRW1wdHkoKSl7Y29udGludWU7fVxuZWxlbXMuYWRkKGVsZW1HZW9tKTt9fTtqc3RzLmdlb20uUHJlY2lzaW9uTW9kZWw9ZnVuY3Rpb24obW9kZWxUeXBlKXtpZih0eXBlb2YgbW9kZWxUeXBlPT09J251bWJlcicpe3RoaXMubW9kZWxUeXBlPWpzdHMuZ2VvbS5QcmVjaXNpb25Nb2RlbC5GSVhFRDt0aGlzLnNjYWxlPW1vZGVsVHlwZTtyZXR1cm47fVxudGhpcy5tb2RlbFR5cGU9bW9kZWxUeXBlfHxqc3RzLmdlb20uUHJlY2lzaW9uTW9kZWwuRkxPQVRJTkc7aWYodGhpcy5tb2RlbFR5cGU9PT1qc3RzLmdlb20uUHJlY2lzaW9uTW9kZWwuRklYRUQpe3RoaXMuc2NhbGU9MS4wO319O2pzdHMuZ2VvbS5QcmVjaXNpb25Nb2RlbC5GTE9BVElORz0nRkxPQVRJTkcnO2pzdHMuZ2VvbS5QcmVjaXNpb25Nb2RlbC5GSVhFRD0nRklYRUQnO2pzdHMuZ2VvbS5QcmVjaXNpb25Nb2RlbC5GTE9BVElOR19TSU5HTEU9J0ZMT0FUSU5HX1NJTkdMRSc7anN0cy5nZW9tLlByZWNpc2lvbk1vZGVsLnByb3RvdHlwZS5zY2FsZT1udWxsO2pzdHMuZ2VvbS5QcmVjaXNpb25Nb2RlbC5wcm90b3R5cGUubW9kZWxUeXBlPW51bGw7anN0cy5nZW9tLlByZWNpc2lvbk1vZGVsLnByb3RvdHlwZS5pc0Zsb2F0aW5nPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMubW9kZWxUeXBlPT09anN0cy5nZW9tLlByZWNpc2lvbk1vZGVsLkZMT0FUSU5HfHx0aGlzLm1vZGVsVHlwZT09PWpzdHMuZ2VvbS5QcmVjaXNpb25Nb2RlbC5GTE9BVElOR19TSU5MR0U7fTtqc3RzLmdlb20uUHJlY2lzaW9uTW9kZWwucHJvdG90eXBlLmdldFNjYWxlPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuc2NhbGU7fTtqc3RzLmdlb20uUHJlY2lzaW9uTW9kZWwucHJvdG90eXBlLmdldFR5cGU9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5tb2RlbFR5cGU7fTtqc3RzLmdlb20uUHJlY2lzaW9uTW9kZWwucHJvdG90eXBlLmVxdWFscz1mdW5jdGlvbihvdGhlcil7cmV0dXJuIHRydWU7aWYoIShvdGhlciBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5QcmVjaXNpb25Nb2RlbCkpe3JldHVybiBmYWxzZTt9XG52YXIgb3RoZXJQcmVjaXNpb25Nb2RlbD1vdGhlcjtyZXR1cm4gdGhpcy5tb2RlbFR5cGU9PT1vdGhlclByZWNpc2lvbk1vZGVsLm1vZGVsVHlwZSYmdGhpcy5zY2FsZT09PW90aGVyUHJlY2lzaW9uTW9kZWwuc2NhbGU7fTtqc3RzLmdlb20uUHJlY2lzaW9uTW9kZWwucHJvdG90eXBlLm1ha2VQcmVjaXNlPWZ1bmN0aW9uKHZhbCl7aWYodmFsIGluc3RhbmNlb2YganN0cy5nZW9tLkNvb3JkaW5hdGUpe3RoaXMubWFrZVByZWNpc2UyKHZhbCk7cmV0dXJuO31cbmlmKGlzTmFOKHZhbCkpXG5yZXR1cm4gdmFsO2lmKHRoaXMubW9kZWxUeXBlPT09anN0cy5nZW9tLlByZWNpc2lvbk1vZGVsLkZJWEVEKXtyZXR1cm4gTWF0aC5yb3VuZCh2YWwqdGhpcy5zY2FsZSkvdGhpcy5zY2FsZTt9XG5yZXR1cm4gdmFsO307anN0cy5nZW9tLlByZWNpc2lvbk1vZGVsLnByb3RvdHlwZS5tYWtlUHJlY2lzZTI9ZnVuY3Rpb24oY29vcmQpe2lmKHRoaXMubW9kZWxUeXBlPT09anN0cy5nZW9tLlByZWNpc2lvbk1vZGVsLkZMT0FUSU5HKVxucmV0dXJuO2Nvb3JkLng9dGhpcy5tYWtlUHJlY2lzZShjb29yZC54KTtjb29yZC55PXRoaXMubWFrZVByZWNpc2UoY29vcmQueSk7fTtqc3RzLmdlb20uUHJlY2lzaW9uTW9kZWwucHJvdG90eXBlLmNvbXBhcmVUbz1mdW5jdGlvbihvKXt2YXIgb3RoZXI9bztyZXR1cm4gMDt9O2pzdHMuZ2VvbS5Db29yZGluYXRlRmlsdGVyPWZ1bmN0aW9uKCl7fTtqc3RzLmdlb20uQ29vcmRpbmF0ZUZpbHRlci5wcm90b3R5cGUuZmlsdGVyPWZ1bmN0aW9uKGNvb3JkKXt0aHJvdyBuZXcganN0cy5lcnJvci5BYnN0cmFjdE1ldGhvZEludm9jYXRpb25FcnJvcigpO307anN0cy5zaW1wbGlmeS5Eb3VnbGFzUGV1Y2tlckxpbmVTaW1wbGlmaWVyPWZ1bmN0aW9uKHB0cyl7dGhpcy5wdHM9cHRzO3RoaXMuc2VnPW5ldyBqc3RzLmdlb20uTGluZVNlZ21lbnQoKTt9O2pzdHMuc2ltcGxpZnkuRG91Z2xhc1BldWNrZXJMaW5lU2ltcGxpZmllci5wcm90b3R5cGUucHRzPW51bGw7anN0cy5zaW1wbGlmeS5Eb3VnbGFzUGV1Y2tlckxpbmVTaW1wbGlmaWVyLnByb3RvdHlwZS51c2VQdD1udWxsO2pzdHMuc2ltcGxpZnkuRG91Z2xhc1BldWNrZXJMaW5lU2ltcGxpZmllci5wcm90b3R5cGUuZGlzdGFuY2VUb2xlcmFuY2U9bnVsbDtqc3RzLnNpbXBsaWZ5LkRvdWdsYXNQZXVja2VyTGluZVNpbXBsaWZpZXIuc2ltcGxpZnk9ZnVuY3Rpb24ocHRzLGRpc3RhbmNlVG9sZXJhbmNlKXt2YXIgc2ltcD1uZXcganN0cy5zaW1wbGlmeS5Eb3VnbGFzUGV1Y2tlckxpbmVTaW1wbGlmaWVyKHB0cyk7c2ltcC5zZXREaXN0YW5jZVRvbGVyYW5jZShkaXN0YW5jZVRvbGVyYW5jZSk7cmV0dXJuIHNpbXAuc2ltcGxpZnkoKTt9O2pzdHMuc2ltcGxpZnkuRG91Z2xhc1BldWNrZXJMaW5lU2ltcGxpZmllci5wcm90b3R5cGUuc2V0RGlzdGFuY2VUb2xlcmFuY2U9ZnVuY3Rpb24oZGlzdGFuY2VUb2xlcmFuY2Upe3RoaXMuZGlzdGFuY2VUb2xlcmFuY2U9ZGlzdGFuY2VUb2xlcmFuY2U7fTtqc3RzLnNpbXBsaWZ5LkRvdWdsYXNQZXVja2VyTGluZVNpbXBsaWZpZXIucHJvdG90eXBlLnNpbXBsaWZ5PWZ1bmN0aW9uKCl7dGhpcy51c2VQdD1bXTtmb3IodmFyIGk9MDtpPHRoaXMucHRzLmxlbmd0aDtpKyspe3RoaXMudXNlUHRbaV09dHJ1ZTt9XG50aGlzLnNpbXBsaWZ5U2VjdGlvbigwLHRoaXMucHRzLmxlbmd0aC0xKTt2YXIgY29vcmRMaXN0PW5ldyBqc3RzLmdlb20uQ29vcmRpbmF0ZUxpc3QoKTtmb3IodmFyIGo9MDtqPHRoaXMucHRzLmxlbmd0aDtqKyspe2lmKHRoaXMudXNlUHRbal0pe2Nvb3JkTGlzdC5hZGQobmV3IGpzdHMuZ2VvbS5Db29yZGluYXRlKHRoaXMucHRzW2pdKSk7fX1cbnJldHVybiBjb29yZExpc3QudG9Db29yZGluYXRlQXJyYXkoKTt9O2pzdHMuc2ltcGxpZnkuRG91Z2xhc1BldWNrZXJMaW5lU2ltcGxpZmllci5wcm90b3R5cGUuc2VnPW51bGw7anN0cy5zaW1wbGlmeS5Eb3VnbGFzUGV1Y2tlckxpbmVTaW1wbGlmaWVyLnByb3RvdHlwZS5zaW1wbGlmeVNlY3Rpb249ZnVuY3Rpb24oaSxqKXtpZihpKzE9PWope3JldHVybjt9XG50aGlzLnNlZy5wMD10aGlzLnB0c1tpXTt0aGlzLnNlZy5wMT10aGlzLnB0c1tqXTt2YXIgbWF4RGlzdGFuY2U9LTEuMDt2YXIgbWF4SW5kZXg9aTtmb3IodmFyIGs9aSsxO2s8ajtrKyspe3ZhciBkaXN0YW5jZT10aGlzLnNlZy5kaXN0YW5jZSh0aGlzLnB0c1trXSk7aWYoZGlzdGFuY2U+bWF4RGlzdGFuY2Upe21heERpc3RhbmNlPWRpc3RhbmNlO21heEluZGV4PWs7fX1cbmlmKG1heERpc3RhbmNlPD10aGlzLmRpc3RhbmNlVG9sZXJhbmNlKXtmb3IodmFyIGw9aSsxO2w8ajtsKyspe3RoaXMudXNlUHRbbF09ZmFsc2U7fX1lbHNle3RoaXMuc2ltcGxpZnlTZWN0aW9uKGksbWF4SW5kZXgpO3RoaXMuc2ltcGxpZnlTZWN0aW9uKG1heEluZGV4LGopO319O2pzdHMuZ2VvbWdyYXBoLkVkZ2VJbnRlcnNlY3Rpb249ZnVuY3Rpb24oY29vcmQsc2VnbWVudEluZGV4LGRpc3Qpe3RoaXMuY29vcmQ9bmV3IGpzdHMuZ2VvbS5Db29yZGluYXRlKGNvb3JkKTt0aGlzLnNlZ21lbnRJbmRleD1zZWdtZW50SW5kZXg7dGhpcy5kaXN0PWRpc3Q7fTtqc3RzLmdlb21ncmFwaC5FZGdlSW50ZXJzZWN0aW9uLnByb3RvdHlwZS5jb29yZD1udWxsO2pzdHMuZ2VvbWdyYXBoLkVkZ2VJbnRlcnNlY3Rpb24ucHJvdG90eXBlLnNlZ21lbnRJbmRleD1udWxsO2pzdHMuZ2VvbWdyYXBoLkVkZ2VJbnRlcnNlY3Rpb24ucHJvdG90eXBlLmRpc3Q9bnVsbDtqc3RzLmdlb21ncmFwaC5FZGdlSW50ZXJzZWN0aW9uLnByb3RvdHlwZS5nZXRDb29yZGluYXRlPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuY29vcmQ7fTtqc3RzLmdlb21ncmFwaC5FZGdlSW50ZXJzZWN0aW9uLnByb3RvdHlwZS5nZXRTZWdtZW50SW5kZXg9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5zZWdtZW50SW5kZXg7fTtqc3RzLmdlb21ncmFwaC5FZGdlSW50ZXJzZWN0aW9uLnByb3RvdHlwZS5nZXREaXN0YW5jZT1mdW5jdGlvbigpe3JldHVybiB0aGlzLmRpc3Q7fTtqc3RzLmdlb21ncmFwaC5FZGdlSW50ZXJzZWN0aW9uLnByb3RvdHlwZS5jb21wYXJlVG89ZnVuY3Rpb24ob3RoZXIpe3JldHVybiB0aGlzLmNvbXBhcmUob3RoZXIuc2VnbWVudEluZGV4LG90aGVyLmRpc3QpO307anN0cy5nZW9tZ3JhcGguRWRnZUludGVyc2VjdGlvbi5wcm90b3R5cGUuY29tcGFyZT1mdW5jdGlvbihzZWdtZW50SW5kZXgsZGlzdCl7aWYodGhpcy5zZWdtZW50SW5kZXg8c2VnbWVudEluZGV4KVxucmV0dXJuLTE7aWYodGhpcy5zZWdtZW50SW5kZXg+c2VnbWVudEluZGV4KVxucmV0dXJuIDE7aWYodGhpcy5kaXN0PGRpc3QpXG5yZXR1cm4tMTtpZih0aGlzLmRpc3Q+ZGlzdClcbnJldHVybiAxO3JldHVybiAwO307anN0cy5nZW9tZ3JhcGguRWRnZUludGVyc2VjdGlvbi5wcm90b3R5cGUuaXNFbmRQb2ludD1mdW5jdGlvbihtYXhTZWdtZW50SW5kZXgpe2lmKHRoaXMuc2VnbWVudEluZGV4PT09MCYmdGhpcy5kaXN0PT09MC4wKVxucmV0dXJuIHRydWU7aWYodGhpcy5zZWdtZW50SW5kZXg9PT1tYXhTZWdtZW50SW5kZXgpXG5yZXR1cm4gdHJ1ZTtyZXR1cm4gZmFsc2U7fTtqc3RzLmdlb21ncmFwaC5FZGdlSW50ZXJzZWN0aW9uLnByb3RvdHlwZS50b1N0cmluZz1mdW5jdGlvbigpe3JldHVybicnK3RoaXMuc2VnbWVudEluZGV4K3RoaXMuZGlzdDt9OyhmdW5jdGlvbigpe3ZhciBFZGdlSW50ZXJzZWN0aW9uPWpzdHMuZ2VvbWdyYXBoLkVkZ2VJbnRlcnNlY3Rpb247dmFyIFRyZWVNYXA9amF2YXNjcmlwdC51dGlsLlRyZWVNYXA7anN0cy5nZW9tZ3JhcGguRWRnZUludGVyc2VjdGlvbkxpc3Q9ZnVuY3Rpb24oZWRnZSl7dGhpcy5ub2RlTWFwPW5ldyBUcmVlTWFwKCk7dGhpcy5lZGdlPWVkZ2U7fTtqc3RzLmdlb21ncmFwaC5FZGdlSW50ZXJzZWN0aW9uTGlzdC5wcm90b3R5cGUubm9kZU1hcD1udWxsO2pzdHMuZ2VvbWdyYXBoLkVkZ2VJbnRlcnNlY3Rpb25MaXN0LnByb3RvdHlwZS5lZGdlPW51bGw7anN0cy5nZW9tZ3JhcGguRWRnZUludGVyc2VjdGlvbkxpc3QucHJvdG90eXBlLmlzSW50ZXJzZWN0aW9uPWZ1bmN0aW9uKHB0KXtmb3IodmFyIGl0PXRoaXMuaXRlcmF0b3IoKTtpdC5oYXNOZXh0KCk7KXt2YXIgZWk9aXQubmV4dCgpO2lmKGVpLmNvb3JkLmVxdWFscyhwdCkpe3JldHVybiB0cnVlO319XG5yZXR1cm4gZmFsc2U7fTtqc3RzLmdlb21ncmFwaC5FZGdlSW50ZXJzZWN0aW9uTGlzdC5wcm90b3R5cGUuYWRkPWZ1bmN0aW9uKGludFB0LHNlZ21lbnRJbmRleCxkaXN0KXt2YXIgZWlOZXc9bmV3IEVkZ2VJbnRlcnNlY3Rpb24oaW50UHQsc2VnbWVudEluZGV4LGRpc3QpO3ZhciBlaT10aGlzLm5vZGVNYXAuZ2V0KGVpTmV3KTtpZihlaSE9PW51bGwpe3JldHVybiBlaTt9XG50aGlzLm5vZGVNYXAucHV0KGVpTmV3LGVpTmV3KTtyZXR1cm4gZWlOZXc7fTtqc3RzLmdlb21ncmFwaC5FZGdlSW50ZXJzZWN0aW9uTGlzdC5wcm90b3R5cGUuaXRlcmF0b3I9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5ub2RlTWFwLnZhbHVlcygpLml0ZXJhdG9yKCk7fTtqc3RzLmdlb21ncmFwaC5FZGdlSW50ZXJzZWN0aW9uTGlzdC5wcm90b3R5cGUuYWRkRW5kcG9pbnRzPWZ1bmN0aW9uKCl7dmFyIG1heFNlZ0luZGV4PXRoaXMuZWRnZS5wdHMubGVuZ3RoLTE7dGhpcy5hZGQodGhpcy5lZGdlLnB0c1swXSwwLDAuMCk7dGhpcy5hZGQodGhpcy5lZGdlLnB0c1ttYXhTZWdJbmRleF0sbWF4U2VnSW5kZXgsMC4wKTt9O2pzdHMuZ2VvbWdyYXBoLkVkZ2VJbnRlcnNlY3Rpb25MaXN0LnByb3RvdHlwZS5hZGRTcGxpdEVkZ2VzPWZ1bmN0aW9uKGVkZ2VMaXN0KVxue3RoaXMuYWRkRW5kcG9pbnRzKCk7dmFyIGl0PXRoaXMuaXRlcmF0b3IoKTt2YXIgZWlQcmV2PWl0Lm5leHQoKTt3aGlsZShpdC5oYXNOZXh0KCkpe3ZhciBlaT1pdC5uZXh0KCk7dmFyIG5ld0VkZ2U9dGhpcy5jcmVhdGVTcGxpdEVkZ2UoZWlQcmV2LGVpKTtlZGdlTGlzdC5hZGQobmV3RWRnZSk7ZWlQcmV2PWVpO319O2pzdHMuZ2VvbWdyYXBoLkVkZ2VJbnRlcnNlY3Rpb25MaXN0LnByb3RvdHlwZS5jcmVhdGVTcGxpdEVkZ2U9ZnVuY3Rpb24oZWkwLGVpMSl7dmFyIG5wdHM9ZWkxLnNlZ21lbnRJbmRleC1laTAuc2VnbWVudEluZGV4KzI7dmFyIGxhc3RTZWdTdGFydFB0PXRoaXMuZWRnZS5wdHNbZWkxLnNlZ21lbnRJbmRleF07dmFyIHVzZUludFB0MT1laTEuZGlzdD4wLjB8fCFlaTEuY29vcmQuZXF1YWxzMkQobGFzdFNlZ1N0YXJ0UHQpO2lmKCF1c2VJbnRQdDEpe25wdHMtLTt9XG52YXIgcHRzPVtdO3ZhciBpcHQ9MDtwdHNbaXB0KytdPW5ldyBqc3RzLmdlb20uQ29vcmRpbmF0ZShlaTAuY29vcmQpO2Zvcih2YXIgaT1laTAuc2VnbWVudEluZGV4KzE7aTw9ZWkxLnNlZ21lbnRJbmRleDtpKyspe3B0c1tpcHQrK109dGhpcy5lZGdlLnB0c1tpXTt9XG5pZih1c2VJbnRQdDEpcHRzW2lwdF09ZWkxLmNvb3JkO3JldHVybiBuZXcganN0cy5nZW9tZ3JhcGguRWRnZShwdHMsbmV3IGpzdHMuZ2VvbWdyYXBoLkxhYmVsKHRoaXMuZWRnZS5sYWJlbCkpO307fSkoKTsoZnVuY3Rpb24oKXt2YXIgQXNzZXJ0aW9uRmFpbGVkRXhjZXB0aW9uPWZ1bmN0aW9uKG1lc3NhZ2Upe3RoaXMubWVzc2FnZT1tZXNzYWdlO307QXNzZXJ0aW9uRmFpbGVkRXhjZXB0aW9uLnByb3RvdHlwZT1uZXcgRXJyb3IoKTtBc3NlcnRpb25GYWlsZWRFeGNlcHRpb24ucHJvdG90eXBlLm5hbWU9J0Fzc2VydGlvbkZhaWxlZEV4Y2VwdGlvbic7anN0cy51dGlsLkFzc2VydGlvbkZhaWxlZEV4Y2VwdGlvbj1Bc3NlcnRpb25GYWlsZWRFeGNlcHRpb247fSkoKTsoZnVuY3Rpb24oKXt2YXIgQXNzZXJ0aW9uRmFpbGVkRXhjZXB0aW9uPWpzdHMudXRpbC5Bc3NlcnRpb25GYWlsZWRFeGNlcHRpb247anN0cy51dGlsLkFzc2VydD1mdW5jdGlvbigpe307anN0cy51dGlsLkFzc2VydC5pc1RydWU9ZnVuY3Rpb24oYXNzZXJ0aW9uLG1lc3NhZ2Upe2lmKCFhc3NlcnRpb24pe2lmKG1lc3NhZ2U9PT1udWxsKXt0aHJvdyBuZXcgQXNzZXJ0aW9uRmFpbGVkRXhjZXB0aW9uKCk7fWVsc2V7dGhyb3cgbmV3IEFzc2VydGlvbkZhaWxlZEV4Y2VwdGlvbihtZXNzYWdlKTt9fX07anN0cy51dGlsLkFzc2VydC5lcXVhbHM9ZnVuY3Rpb24oZXhwZWN0ZWRWYWx1ZSxhY3R1YWxWYWx1ZSxtZXNzYWdlKXtpZighYWN0dWFsVmFsdWUuZXF1YWxzKGV4cGVjdGVkVmFsdWUpKXt0aHJvdyBuZXcgQXNzZXJ0aW9uRmFpbGVkRXhjZXB0aW9uKCdFeHBlY3RlZCAnK2V4cGVjdGVkVmFsdWUrJyBidXQgZW5jb3VudGVyZWQgJythY3R1YWxWYWx1ZStcbihtZXNzYWdlIT1udWxsPyc6ICcrbWVzc2FnZTonJykpO319O2pzdHMudXRpbC5Bc3NlcnQuc2hvdWxkTmV2ZXJSZWFjaEhlcmU9ZnVuY3Rpb24obWVzc2FnZSl7dGhyb3cgbmV3IEFzc2VydGlvbkZhaWxlZEV4Y2VwdGlvbignU2hvdWxkIG5ldmVyIHJlYWNoIGhlcmUnK1xuKG1lc3NhZ2UhPW51bGw/JzogJyttZXNzYWdlOicnKSk7fTt9KSgpOyhmdW5jdGlvbigpe3ZhciBMb2NhdGlvbj1qc3RzLmdlb20uTG9jYXRpb247dmFyIEFzc2VydD1qc3RzLnV0aWwuQXNzZXJ0O3ZhciBBcnJheUxpc3Q9amF2YXNjcmlwdC51dGlsLkFycmF5TGlzdDtqc3RzLm9wZXJhdGlvbi5yZWxhdGUuUmVsYXRlQ29tcHV0ZXI9ZnVuY3Rpb24oYXJnKXt0aGlzLmxpPW5ldyBqc3RzLmFsZ29yaXRobS5Sb2J1c3RMaW5lSW50ZXJzZWN0b3IoKTt0aGlzLnB0TG9jYXRvcj1uZXcganN0cy5hbGdvcml0aG0uUG9pbnRMb2NhdG9yKCk7dGhpcy5ub2Rlcz1uZXcganN0cy5nZW9tZ3JhcGguTm9kZU1hcChuZXcganN0cy5vcGVyYXRpb24ucmVsYXRlLlJlbGF0ZU5vZGVGYWN0b3J5KCkpO3RoaXMuaXNvbGF0ZWRFZGdlcz1uZXcgQXJyYXlMaXN0KCk7dGhpcy5hcmc9YXJnO307anN0cy5vcGVyYXRpb24ucmVsYXRlLlJlbGF0ZUNvbXB1dGVyLnByb3RvdHlwZS5saT1udWxsO2pzdHMub3BlcmF0aW9uLnJlbGF0ZS5SZWxhdGVDb21wdXRlci5wcm90b3R5cGUucHRMb2NhdG9yPW51bGw7anN0cy5vcGVyYXRpb24ucmVsYXRlLlJlbGF0ZUNvbXB1dGVyLnByb3RvdHlwZS5hcmc9bnVsbDtqc3RzLm9wZXJhdGlvbi5yZWxhdGUuUmVsYXRlQ29tcHV0ZXIucHJvdG90eXBlLm5vZGVzPW51bGw7anN0cy5vcGVyYXRpb24ucmVsYXRlLlJlbGF0ZUNvbXB1dGVyLnByb3RvdHlwZS5pbT1udWxsO2pzdHMub3BlcmF0aW9uLnJlbGF0ZS5SZWxhdGVDb21wdXRlci5wcm90b3R5cGUuaXNvbGF0ZWRFZGdlcz1udWxsO2pzdHMub3BlcmF0aW9uLnJlbGF0ZS5SZWxhdGVDb21wdXRlci5wcm90b3R5cGUuaW52YWxpZFBvaW50PW51bGw7anN0cy5vcGVyYXRpb24ucmVsYXRlLlJlbGF0ZUNvbXB1dGVyLnByb3RvdHlwZS5jb21wdXRlSU09ZnVuY3Rpb24oKXt2YXIgaW09bmV3IGpzdHMuZ2VvbS5JbnRlcnNlY3Rpb25NYXRyaXgoKTtpbS5zZXQoTG9jYXRpb24uRVhURVJJT1IsTG9jYXRpb24uRVhURVJJT1IsMik7aWYoIXRoaXMuYXJnWzBdLmdldEdlb21ldHJ5KCkuZ2V0RW52ZWxvcGVJbnRlcm5hbCgpLmludGVyc2VjdHModGhpcy5hcmdbMV0uZ2V0R2VvbWV0cnkoKS5nZXRFbnZlbG9wZUludGVybmFsKCkpKXt0aGlzLmNvbXB1dGVEaXNqb2ludElNKGltKTtyZXR1cm4gaW07fVxudGhpcy5hcmdbMF0uY29tcHV0ZVNlbGZOb2Rlcyh0aGlzLmxpLGZhbHNlKTt0aGlzLmFyZ1sxXS5jb21wdXRlU2VsZk5vZGVzKHRoaXMubGksZmFsc2UpO3ZhciBpbnRlcnNlY3Rvcj10aGlzLmFyZ1swXS5jb21wdXRlRWRnZUludGVyc2VjdGlvbnModGhpcy5hcmdbMV0sdGhpcy5saSxmYWxzZSk7dGhpcy5jb21wdXRlSW50ZXJzZWN0aW9uTm9kZXMoMCk7dGhpcy5jb21wdXRlSW50ZXJzZWN0aW9uTm9kZXMoMSk7dGhpcy5jb3B5Tm9kZXNBbmRMYWJlbHMoMCk7dGhpcy5jb3B5Tm9kZXNBbmRMYWJlbHMoMSk7dGhpcy5sYWJlbElzb2xhdGVkTm9kZXMoKTt0aGlzLmNvbXB1dGVQcm9wZXJJbnRlcnNlY3Rpb25JTShpbnRlcnNlY3RvcixpbSk7dmFyIGVlQnVpbGRlcj1uZXcganN0cy5vcGVyYXRpb24ucmVsYXRlLkVkZ2VFbmRCdWlsZGVyKCk7dmFyIGVlMD1lZUJ1aWxkZXIuY29tcHV0ZUVkZ2VFbmRzKHRoaXMuYXJnWzBdLmdldEVkZ2VJdGVyYXRvcigpKTt0aGlzLmluc2VydEVkZ2VFbmRzKGVlMCk7dmFyIGVlMT1lZUJ1aWxkZXIuY29tcHV0ZUVkZ2VFbmRzKHRoaXMuYXJnWzFdLmdldEVkZ2VJdGVyYXRvcigpKTt0aGlzLmluc2VydEVkZ2VFbmRzKGVlMSk7dGhpcy5sYWJlbE5vZGVFZGdlcygpO3RoaXMubGFiZWxJc29sYXRlZEVkZ2VzKDAsMSk7dGhpcy5sYWJlbElzb2xhdGVkRWRnZXMoMSwwKTt0aGlzLnVwZGF0ZUlNKGltKTtyZXR1cm4gaW07fTtqc3RzLm9wZXJhdGlvbi5yZWxhdGUuUmVsYXRlQ29tcHV0ZXIucHJvdG90eXBlLmluc2VydEVkZ2VFbmRzPWZ1bmN0aW9uKGVlKXtmb3IodmFyIGk9ZWUuaXRlcmF0b3IoKTtpLmhhc05leHQoKTspe3ZhciBlPWkubmV4dCgpO3RoaXMubm9kZXMuYWRkKGUpO319O2pzdHMub3BlcmF0aW9uLnJlbGF0ZS5SZWxhdGVDb21wdXRlci5wcm90b3R5cGUuY29tcHV0ZVByb3BlckludGVyc2VjdGlvbklNPWZ1bmN0aW9uKGludGVyc2VjdG9yLGltKXt2YXIgZGltQT10aGlzLmFyZ1swXS5nZXRHZW9tZXRyeSgpLmdldERpbWVuc2lvbigpO3ZhciBkaW1CPXRoaXMuYXJnWzFdLmdldEdlb21ldHJ5KCkuZ2V0RGltZW5zaW9uKCk7dmFyIGhhc1Byb3Blcj1pbnRlcnNlY3Rvci5oYXNQcm9wZXJJbnRlcnNlY3Rpb24oKTt2YXIgaGFzUHJvcGVySW50ZXJpb3I9aW50ZXJzZWN0b3IuaGFzUHJvcGVySW50ZXJpb3JJbnRlcnNlY3Rpb24oKTtpZihkaW1BPT09MiYmZGltQj09PTIpe2lmKGhhc1Byb3BlcilcbmltLnNldEF0TGVhc3QoJzIxMjEwMTIxMicpO31cbmVsc2UgaWYoZGltQT09PTImJmRpbUI9PT0xKXtpZihoYXNQcm9wZXIpXG5pbS5zZXRBdExlYXN0KCdGRkYwRkZGRjInKTtpZihoYXNQcm9wZXJJbnRlcmlvcilcbmltLnNldEF0TGVhc3QoJzFGRkZGRjFGRicpO31lbHNlIGlmKGRpbUE9PT0xJiZkaW1CPT09Mil7aWYoaGFzUHJvcGVyKVxuaW0uc2V0QXRMZWFzdCgnRjBGRkZGRkYyJyk7aWYoaGFzUHJvcGVySW50ZXJpb3IpXG5pbS5zZXRBdExlYXN0KCcxRjFGRkZGRkYnKTt9XG5lbHNlIGlmKGRpbUE9PT0xJiZkaW1CPT09MSl7aWYoaGFzUHJvcGVySW50ZXJpb3IpXG5pbS5zZXRBdExlYXN0KCcwRkZGRkZGRkYnKTt9fTtqc3RzLm9wZXJhdGlvbi5yZWxhdGUuUmVsYXRlQ29tcHV0ZXIucHJvdG90eXBlLmNvcHlOb2Rlc0FuZExhYmVscz1mdW5jdGlvbihhcmdJbmRleCl7Zm9yKHZhciBpPXRoaXMuYXJnW2FyZ0luZGV4XS5nZXROb2RlSXRlcmF0b3IoKTtpLmhhc05leHQoKTspe3ZhciBncmFwaE5vZGU9aS5uZXh0KCk7dmFyIG5ld05vZGU9dGhpcy5ub2Rlcy5hZGROb2RlKGdyYXBoTm9kZS5nZXRDb29yZGluYXRlKCkpO25ld05vZGUuc2V0TGFiZWwoYXJnSW5kZXgsZ3JhcGhOb2RlLmdldExhYmVsKCkuZ2V0TG9jYXRpb24oYXJnSW5kZXgpKTt9fTtqc3RzLm9wZXJhdGlvbi5yZWxhdGUuUmVsYXRlQ29tcHV0ZXIucHJvdG90eXBlLmNvbXB1dGVJbnRlcnNlY3Rpb25Ob2Rlcz1mdW5jdGlvbihhcmdJbmRleCl7Zm9yKHZhciBpPXRoaXMuYXJnW2FyZ0luZGV4XS5nZXRFZGdlSXRlcmF0b3IoKTtpLmhhc05leHQoKTspe3ZhciBlPWkubmV4dCgpO3ZhciBlTG9jPWUuZ2V0TGFiZWwoKS5nZXRMb2NhdGlvbihhcmdJbmRleCk7Zm9yKHZhciBlaUl0PWUuZ2V0RWRnZUludGVyc2VjdGlvbkxpc3QoKS5pdGVyYXRvcigpO2VpSXQuaGFzTmV4dCgpOyl7dmFyIGVpPWVpSXQubmV4dCgpO3ZhciBuPXRoaXMubm9kZXMuYWRkTm9kZShlaS5jb29yZCk7aWYoZUxvYz09PUxvY2F0aW9uLkJPVU5EQVJZKVxubi5zZXRMYWJlbEJvdW5kYXJ5KGFyZ0luZGV4KTtlbHNle2lmKG4uZ2V0TGFiZWwoKS5pc051bGwoYXJnSW5kZXgpKVxubi5zZXRMYWJlbChhcmdJbmRleCxMb2NhdGlvbi5JTlRFUklPUik7fX19fTtqc3RzLm9wZXJhdGlvbi5yZWxhdGUuUmVsYXRlQ29tcHV0ZXIucHJvdG90eXBlLmxhYmVsSW50ZXJzZWN0aW9uTm9kZXM9ZnVuY3Rpb24oYXJnSW5kZXgpe2Zvcih2YXIgaT10aGlzLmFyZ1thcmdJbmRleF0uZ2V0RWRnZUl0ZXJhdG9yKCk7aS5oYXNOZXh0KCk7KXt2YXIgZT1pLm5leHQoKTt2YXIgZUxvYz1lLmdldExhYmVsKCkuZ2V0TG9jYXRpb24oYXJnSW5kZXgpO2Zvcih2YXIgZWlJdD1lLmdldEVkZ2VJbnRlcnNlY3Rpb25MaXN0KCkuaXRlcmF0b3IoKTtlaUl0Lmhhc05leHQoKTspe3ZhciBlaT1laUl0Lm5leHQoKTt2YXIgbj10aGlzLm5vZGVzLmZpbmQoZWkuY29vcmQpO2lmKG4uZ2V0TGFiZWwoKS5pc051bGwoYXJnSW5kZXgpKXtpZihlTG9jPT09TG9jYXRpb24uQk9VTkRBUlkpXG5uLnNldExhYmVsQm91bmRhcnkoYXJnSW5kZXgpO2Vsc2Vcbm4uc2V0TGFiZWwoYXJnSW5kZXgsTG9jYXRpb24uSU5URVJJT1IpO319fX07anN0cy5vcGVyYXRpb24ucmVsYXRlLlJlbGF0ZUNvbXB1dGVyLnByb3RvdHlwZS5jb21wdXRlRGlzam9pbnRJTT1mdW5jdGlvbihpbSl7dmFyIGdhPXRoaXMuYXJnWzBdLmdldEdlb21ldHJ5KCk7aWYoIWdhLmlzRW1wdHkoKSl7aW0uc2V0KExvY2F0aW9uLklOVEVSSU9SLExvY2F0aW9uLkVYVEVSSU9SLGdhLmdldERpbWVuc2lvbigpKTtpbS5zZXQoTG9jYXRpb24uQk9VTkRBUlksTG9jYXRpb24uRVhURVJJT1IsZ2EuZ2V0Qm91bmRhcnlEaW1lbnNpb24oKSk7fVxudmFyIGdiPXRoaXMuYXJnWzFdLmdldEdlb21ldHJ5KCk7aWYoIWdiLmlzRW1wdHkoKSl7aW0uc2V0KExvY2F0aW9uLkVYVEVSSU9SLExvY2F0aW9uLklOVEVSSU9SLGdiLmdldERpbWVuc2lvbigpKTtpbS5zZXQoTG9jYXRpb24uRVhURVJJT1IsTG9jYXRpb24uQk9VTkRBUlksZ2IuZ2V0Qm91bmRhcnlEaW1lbnNpb24oKSk7fX07anN0cy5vcGVyYXRpb24ucmVsYXRlLlJlbGF0ZUNvbXB1dGVyLnByb3RvdHlwZS5sYWJlbE5vZGVFZGdlcz1mdW5jdGlvbigpe2Zvcih2YXIgbmk9dGhpcy5ub2Rlcy5pdGVyYXRvcigpO25pLmhhc05leHQoKTspe3ZhciBub2RlPW5pLm5leHQoKTtub2RlLmdldEVkZ2VzKCkuY29tcHV0ZUxhYmVsbGluZyh0aGlzLmFyZyk7fX07anN0cy5vcGVyYXRpb24ucmVsYXRlLlJlbGF0ZUNvbXB1dGVyLnByb3RvdHlwZS51cGRhdGVJTT1mdW5jdGlvbihpbSl7Zm9yKHZhciBlaT10aGlzLmlzb2xhdGVkRWRnZXMuaXRlcmF0b3IoKTtlaS5oYXNOZXh0KCk7KXt2YXIgZT1laS5uZXh0KCk7ZS51cGRhdGVJTShpbSk7fVxuZm9yKHZhciBuaT10aGlzLm5vZGVzLml0ZXJhdG9yKCk7bmkuaGFzTmV4dCgpOyl7dmFyIG5vZGU9bmkubmV4dCgpO25vZGUudXBkYXRlSU0oaW0pO25vZGUudXBkYXRlSU1Gcm9tRWRnZXMoaW0pO319O2pzdHMub3BlcmF0aW9uLnJlbGF0ZS5SZWxhdGVDb21wdXRlci5wcm90b3R5cGUubGFiZWxJc29sYXRlZEVkZ2VzPWZ1bmN0aW9uKHRoaXNJbmRleCx0YXJnZXRJbmRleCl7Zm9yKHZhciBlaT10aGlzLmFyZ1t0aGlzSW5kZXhdLmdldEVkZ2VJdGVyYXRvcigpO2VpLmhhc05leHQoKTspe3ZhciBlPWVpLm5leHQoKTtpZihlLmlzSXNvbGF0ZWQoKSl7dGhpcy5sYWJlbElzb2xhdGVkRWRnZShlLHRhcmdldEluZGV4LHRoaXMuYXJnW3RhcmdldEluZGV4XS5nZXRHZW9tZXRyeSgpKTt0aGlzLmlzb2xhdGVkRWRnZXMuYWRkKGUpO319fTtqc3RzLm9wZXJhdGlvbi5yZWxhdGUuUmVsYXRlQ29tcHV0ZXIucHJvdG90eXBlLmxhYmVsSXNvbGF0ZWRFZGdlPWZ1bmN0aW9uKGUsdGFyZ2V0SW5kZXgsdGFyZ2V0KXtpZih0YXJnZXQuZ2V0RGltZW5zaW9uKCk+MCl7dmFyIGxvYz10aGlzLnB0TG9jYXRvci5sb2NhdGUoZS5nZXRDb29yZGluYXRlKCksdGFyZ2V0KTtlLmdldExhYmVsKCkuc2V0QWxsTG9jYXRpb25zKHRhcmdldEluZGV4LGxvYyk7fWVsc2V7ZS5nZXRMYWJlbCgpLnNldEFsbExvY2F0aW9ucyh0YXJnZXRJbmRleCxMb2NhdGlvbi5FWFRFUklPUik7fX07anN0cy5vcGVyYXRpb24ucmVsYXRlLlJlbGF0ZUNvbXB1dGVyLnByb3RvdHlwZS5sYWJlbElzb2xhdGVkTm9kZXM9ZnVuY3Rpb24oKXtmb3IodmFyIG5pPXRoaXMubm9kZXMuaXRlcmF0b3IoKTtuaS5oYXNOZXh0KCk7KXt2YXIgbj1uaS5uZXh0KCk7dmFyIGxhYmVsPW4uZ2V0TGFiZWwoKTtBc3NlcnQuaXNUcnVlKGxhYmVsLmdldEdlb21ldHJ5Q291bnQoKT4wLCdub2RlIHdpdGggZW1wdHkgbGFiZWwgZm91bmQnKTtpZihuLmlzSXNvbGF0ZWQoKSl7aWYobGFiZWwuaXNOdWxsKDApKVxudGhpcy5sYWJlbElzb2xhdGVkTm9kZShuLDApO2Vsc2VcbnRoaXMubGFiZWxJc29sYXRlZE5vZGUobiwxKTt9fX07anN0cy5vcGVyYXRpb24ucmVsYXRlLlJlbGF0ZUNvbXB1dGVyLnByb3RvdHlwZS5sYWJlbElzb2xhdGVkTm9kZT1mdW5jdGlvbihuLHRhcmdldEluZGV4KXt2YXIgbG9jPXRoaXMucHRMb2NhdG9yLmxvY2F0ZShuLmdldENvb3JkaW5hdGUoKSx0aGlzLmFyZ1t0YXJnZXRJbmRleF0uZ2V0R2VvbWV0cnkoKSk7bi5nZXRMYWJlbCgpLnNldEFsbExvY2F0aW9ucyh0YXJnZXRJbmRleCxsb2MpO307fSkoKTsoZnVuY3Rpb24oKXt2YXIgQXNzZXJ0PWpzdHMudXRpbC5Bc3NlcnQ7anN0cy5nZW9tZ3JhcGguR3JhcGhDb21wb25lbnQ9ZnVuY3Rpb24obGFiZWwpe3RoaXMubGFiZWw9bGFiZWw7fTtqc3RzLmdlb21ncmFwaC5HcmFwaENvbXBvbmVudC5wcm90b3R5cGUubGFiZWw9bnVsbDtqc3RzLmdlb21ncmFwaC5HcmFwaENvbXBvbmVudC5wcm90b3R5cGUuX2lzSW5SZXN1bHQ9ZmFsc2U7anN0cy5nZW9tZ3JhcGguR3JhcGhDb21wb25lbnQucHJvdG90eXBlLl9pc0NvdmVyZWQ9ZmFsc2U7anN0cy5nZW9tZ3JhcGguR3JhcGhDb21wb25lbnQucHJvdG90eXBlLl9pc0NvdmVyZWRTZXQ9ZmFsc2U7anN0cy5nZW9tZ3JhcGguR3JhcGhDb21wb25lbnQucHJvdG90eXBlLl9pc1Zpc2l0ZWQ9ZmFsc2U7anN0cy5nZW9tZ3JhcGguR3JhcGhDb21wb25lbnQucHJvdG90eXBlLmdldExhYmVsPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMubGFiZWw7fTtqc3RzLmdlb21ncmFwaC5HcmFwaENvbXBvbmVudC5wcm90b3R5cGUuc2V0TGFiZWw9ZnVuY3Rpb24obGFiZWwpe2lmKGFyZ3VtZW50cy5sZW5ndGg9PT0yKXt0aGlzLnNldExhYmVsMi5hcHBseSh0aGlzLGFyZ3VtZW50cyk7cmV0dXJuO31cbnRoaXMubGFiZWw9bGFiZWw7fTtqc3RzLmdlb21ncmFwaC5HcmFwaENvbXBvbmVudC5wcm90b3R5cGUuc2V0SW5SZXN1bHQ9ZnVuY3Rpb24oaXNJblJlc3VsdCl7dGhpcy5faXNJblJlc3VsdD1pc0luUmVzdWx0O307anN0cy5nZW9tZ3JhcGguR3JhcGhDb21wb25lbnQucHJvdG90eXBlLmlzSW5SZXN1bHQ9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5faXNJblJlc3VsdDt9O2pzdHMuZ2VvbWdyYXBoLkdyYXBoQ29tcG9uZW50LnByb3RvdHlwZS5zZXRDb3ZlcmVkPWZ1bmN0aW9uKGlzQ292ZXJlZCl7dGhpcy5faXNDb3ZlcmVkPWlzQ292ZXJlZDt0aGlzLl9pc0NvdmVyZWRTZXQ9dHJ1ZTt9O2pzdHMuZ2VvbWdyYXBoLkdyYXBoQ29tcG9uZW50LnByb3RvdHlwZS5pc0NvdmVyZWQ9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5faXNDb3ZlcmVkO307anN0cy5nZW9tZ3JhcGguR3JhcGhDb21wb25lbnQucHJvdG90eXBlLmlzQ292ZXJlZFNldD1mdW5jdGlvbigpe3JldHVybiB0aGlzLl9pc0NvdmVyZWRTZXQ7fTtqc3RzLmdlb21ncmFwaC5HcmFwaENvbXBvbmVudC5wcm90b3R5cGUuaXNWaXNpdGVkPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2lzVmlzaXRlZDt9O2pzdHMuZ2VvbWdyYXBoLkdyYXBoQ29tcG9uZW50LnByb3RvdHlwZS5zZXRWaXNpdGVkPWZ1bmN0aW9uKGlzVmlzaXRlZCl7dGhpcy5faXNWaXNpdGVkPWlzVmlzaXRlZDt9O2pzdHMuZ2VvbWdyYXBoLkdyYXBoQ29tcG9uZW50LnByb3RvdHlwZS5nZXRDb29yZGluYXRlPWZ1bmN0aW9uKCl7dGhyb3cgbmV3IGpzdHMuZXJyb3IuQWJzdHJhY3RNZXRob2RJbnZvY2F0aW9uRXJyb3IoKTt9O2pzdHMuZ2VvbWdyYXBoLkdyYXBoQ29tcG9uZW50LnByb3RvdHlwZS5jb21wdXRlSU09ZnVuY3Rpb24oaW0pe3Rocm93IG5ldyBqc3RzLmVycm9yLkFic3RyYWN0TWV0aG9kSW52b2NhdGlvbkVycm9yKCk7fTtqc3RzLmdlb21ncmFwaC5HcmFwaENvbXBvbmVudC5wcm90b3R5cGUuaXNJc29sYXRlZD1mdW5jdGlvbigpe3Rocm93IG5ldyBqc3RzLmVycm9yLkFic3RyYWN0TWV0aG9kSW52b2NhdGlvbkVycm9yKCk7fTtqc3RzLmdlb21ncmFwaC5HcmFwaENvbXBvbmVudC5wcm90b3R5cGUudXBkYXRlSU09ZnVuY3Rpb24oaW0pe0Fzc2VydC5pc1RydWUodGhpcy5sYWJlbC5nZXRHZW9tZXRyeUNvdW50KCk+PTIsJ2ZvdW5kIHBhcnRpYWwgbGFiZWwnKTt0aGlzLmNvbXB1dGVJTShpbSk7fTt9KSgpO2pzdHMuZ2VvbWdyYXBoLk5vZGU9ZnVuY3Rpb24oY29vcmQsZWRnZXMpe3RoaXMuY29vcmQ9Y29vcmQ7dGhpcy5lZGdlcz1lZGdlczt0aGlzLmxhYmVsPW5ldyBqc3RzLmdlb21ncmFwaC5MYWJlbCgwLGpzdHMuZ2VvbS5Mb2NhdGlvbi5OT05FKTt9O2pzdHMuZ2VvbWdyYXBoLk5vZGUucHJvdG90eXBlPW5ldyBqc3RzLmdlb21ncmFwaC5HcmFwaENvbXBvbmVudCgpO2pzdHMuZ2VvbWdyYXBoLk5vZGUucHJvdG90eXBlLmNvb3JkPW51bGw7anN0cy5nZW9tZ3JhcGguTm9kZS5wcm90b3R5cGUuZWRnZXM9bnVsbDtqc3RzLmdlb21ncmFwaC5Ob2RlLnByb3RvdHlwZS5pc0lzb2xhdGVkPWZ1bmN0aW9uKCl7cmV0dXJuKHRoaXMubGFiZWwuZ2V0R2VvbWV0cnlDb3VudCgpPT0xKTt9O2pzdHMuZ2VvbWdyYXBoLk5vZGUucHJvdG90eXBlLnNldExhYmVsMj1mdW5jdGlvbihhcmdJbmRleCxvbkxvY2F0aW9uKXtpZih0aGlzLmxhYmVsPT09bnVsbCl7dGhpcy5sYWJlbD1uZXcganN0cy5nZW9tZ3JhcGguTGFiZWwoYXJnSW5kZXgsb25Mb2NhdGlvbik7fWVsc2VcbnRoaXMubGFiZWwuc2V0TG9jYXRpb24oYXJnSW5kZXgsb25Mb2NhdGlvbik7fTtqc3RzLmdlb21ncmFwaC5Ob2RlLnByb3RvdHlwZS5zZXRMYWJlbEJvdW5kYXJ5PWZ1bmN0aW9uKGFyZ0luZGV4KXt2YXIgbG9jPWpzdHMuZ2VvbS5Mb2NhdGlvbi5OT05FO2lmKHRoaXMubGFiZWwhPT1udWxsKVxubG9jPXRoaXMubGFiZWwuZ2V0TG9jYXRpb24oYXJnSW5kZXgpO3ZhciBuZXdMb2M7c3dpdGNoKGxvYyl7Y2FzZSBqc3RzLmdlb20uTG9jYXRpb24uQk9VTkRBUlk6bmV3TG9jPWpzdHMuZ2VvbS5Mb2NhdGlvbi5JTlRFUklPUjticmVhaztjYXNlIGpzdHMuZ2VvbS5Mb2NhdGlvbi5JTlRFUklPUjpuZXdMb2M9anN0cy5nZW9tLkxvY2F0aW9uLkJPVU5EQVJZO2JyZWFrO2RlZmF1bHQ6bmV3TG9jPWpzdHMuZ2VvbS5Mb2NhdGlvbi5CT1VOREFSWTticmVhazt9XG50aGlzLmxhYmVsLnNldExvY2F0aW9uKGFyZ0luZGV4LG5ld0xvYyk7fTtqc3RzLmdlb21ncmFwaC5Ob2RlLnByb3RvdHlwZS5hZGQ9ZnVuY3Rpb24oZSl7dGhpcy5lZGdlcy5pbnNlcnQoZSk7ZS5zZXROb2RlKHRoaXMpO307anN0cy5nZW9tZ3JhcGguTm9kZS5wcm90b3R5cGUuZ2V0Q29vcmRpbmF0ZT1mdW5jdGlvbigpe3JldHVybiB0aGlzLmNvb3JkO307anN0cy5nZW9tZ3JhcGguTm9kZS5wcm90b3R5cGUuZ2V0RWRnZXM9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5lZGdlczt9O2pzdHMuZ2VvbWdyYXBoLk5vZGUucHJvdG90eXBlLmlzSW5jaWRlbnRFZGdlSW5SZXN1bHQ9ZnVuY3Rpb24oKXtmb3IodmFyIGl0PXRoaXMuZ2V0RWRnZXMoKS5nZXRFZGdlcygpLml0ZXJhdG9yKCk7aXQuaGFzTmV4dCgpOyl7dmFyIGRlPWl0Lm5leHQoKTtpZihkZS5nZXRFZGdlKCkuaXNJblJlc3VsdCgpKVxucmV0dXJuIHRydWU7fVxucmV0dXJuIGZhbHNlO307anN0cy5nZW9tLlBvaW50PWZ1bmN0aW9uKGNvb3JkaW5hdGUsZmFjdG9yeSl7dGhpcy5mYWN0b3J5PWZhY3Rvcnk7aWYoY29vcmRpbmF0ZT09PXVuZGVmaW5lZClcbnJldHVybjt0aGlzLmNvb3JkaW5hdGU9Y29vcmRpbmF0ZTt9O2pzdHMuZ2VvbS5Qb2ludC5wcm90b3R5cGU9bmV3IGpzdHMuZ2VvbS5HZW9tZXRyeSgpO2pzdHMuZ2VvbS5Qb2ludC5jb25zdHJ1Y3Rvcj1qc3RzLmdlb20uUG9pbnQ7anN0cy5nZW9tLlBvaW50LkNMQVNTX05BTUU9J2pzdHMuZ2VvbS5Qb2ludCc7anN0cy5nZW9tLlBvaW50LnByb3RvdHlwZS5jb29yZGluYXRlPW51bGw7anN0cy5nZW9tLlBvaW50LnByb3RvdHlwZS5nZXRYPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuY29vcmRpbmF0ZS54O307anN0cy5nZW9tLlBvaW50LnByb3RvdHlwZS5nZXRZPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuY29vcmRpbmF0ZS55O307anN0cy5nZW9tLlBvaW50LnByb3RvdHlwZS5nZXRDb29yZGluYXRlPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuY29vcmRpbmF0ZTt9O2pzdHMuZ2VvbS5Qb2ludC5wcm90b3R5cGUuZ2V0Q29vcmRpbmF0ZXM9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5pc0VtcHR5KCk/W106W3RoaXMuY29vcmRpbmF0ZV07fTtqc3RzLmdlb20uUG9pbnQucHJvdG90eXBlLmdldENvb3JkaW5hdGVTZXF1ZW5jZT1mdW5jdGlvbigpe3JldHVybiB0aGlzLmlzRW1wdHkoKT9bXTpbdGhpcy5jb29yZGluYXRlXTt9O2pzdHMuZ2VvbS5Qb2ludC5wcm90b3R5cGUuaXNFbXB0eT1mdW5jdGlvbigpe3JldHVybiB0aGlzLmNvb3JkaW5hdGU9PT1udWxsO307anN0cy5nZW9tLlBvaW50LnByb3RvdHlwZS5lcXVhbHNFeGFjdD1mdW5jdGlvbihvdGhlcix0b2xlcmFuY2Upe2lmKCF0aGlzLmlzRXF1aXZhbGVudENsYXNzKG90aGVyKSl7cmV0dXJuIGZhbHNlO31cbmlmKHRoaXMuaXNFbXB0eSgpJiZvdGhlci5pc0VtcHR5KCkpe3JldHVybiB0cnVlO31cbnJldHVybiB0aGlzLmVxdWFsKG90aGVyLmdldENvb3JkaW5hdGUoKSx0aGlzLmdldENvb3JkaW5hdGUoKSx0b2xlcmFuY2UpO307anN0cy5nZW9tLlBvaW50LnByb3RvdHlwZS5nZXROdW1Qb2ludHM9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5pc0VtcHR5KCk/MDoxO307anN0cy5nZW9tLlBvaW50LnByb3RvdHlwZS5pc1NpbXBsZT1mdW5jdGlvbigpe3JldHVybiB0cnVlO307anN0cy5nZW9tLlBvaW50LnByb3RvdHlwZS5nZXRCb3VuZGFyeT1mdW5jdGlvbigpe3JldHVybiBuZXcganN0cy5nZW9tLkdlb21ldHJ5Q29sbGVjdGlvbihudWxsKTt9O2pzdHMuZ2VvbS5Qb2ludC5wcm90b3R5cGUuY29tcHV0ZUVudmVsb3BlSW50ZXJuYWw9ZnVuY3Rpb24oKXtpZih0aGlzLmlzRW1wdHkoKSl7cmV0dXJuIG5ldyBqc3RzLmdlb20uRW52ZWxvcGUoKTt9XG5yZXR1cm4gbmV3IGpzdHMuZ2VvbS5FbnZlbG9wZSh0aGlzLmNvb3JkaW5hdGUpO307anN0cy5nZW9tLlBvaW50LnByb3RvdHlwZS5hcHBseT1mdW5jdGlvbihmaWx0ZXIpe2lmKGZpbHRlciBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5HZW9tZXRyeUZpbHRlcnx8ZmlsdGVyIGluc3RhbmNlb2YganN0cy5nZW9tLkdlb21ldHJ5Q29tcG9uZW50RmlsdGVyKXtmaWx0ZXIuZmlsdGVyKHRoaXMpO31lbHNlIGlmKGZpbHRlciBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5Db29yZGluYXRlRmlsdGVyKXtpZih0aGlzLmlzRW1wdHkoKSl7cmV0dXJuO31cbmZpbHRlci5maWx0ZXIodGhpcy5nZXRDb29yZGluYXRlKCkpO319O2pzdHMuZ2VvbS5Qb2ludC5wcm90b3R5cGUuY2xvbmU9ZnVuY3Rpb24oKXtyZXR1cm4gbmV3IGpzdHMuZ2VvbS5Qb2ludCh0aGlzLmNvb3JkaW5hdGUuY2xvbmUoKSx0aGlzLmZhY3RvcnkpO307anN0cy5nZW9tLlBvaW50LnByb3RvdHlwZS5nZXREaW1lbnNpb249ZnVuY3Rpb24oKXtyZXR1cm4gMDt9O2pzdHMuZ2VvbS5Qb2ludC5wcm90b3R5cGUuZ2V0Qm91bmRhcnlEaW1lbnNpb249ZnVuY3Rpb24oKXtyZXR1cm4ganN0cy5nZW9tLkRpbWVuc2lvbi5GQUxTRTt9O2pzdHMuZ2VvbS5Qb2ludC5wcm90b3R5cGUucmV2ZXJzZT1mdW5jdGlvbigpe3JldHVybiB0aGlzLmNsb25lKCk7fTtqc3RzLmdlb20uUG9pbnQucHJvdG90eXBlLmlzVmFsaWQ9ZnVuY3Rpb24oKXtpZighanN0cy5vcGVyYXRpb24udmFsaWQuSXNWYWxpZE9wLmlzVmFsaWQodGhpcy5nZXRDb29yZGluYXRlKCkpKXtyZXR1cm4gZmFsc2U7fVxucmV0dXJuIHRydWU7fTtqc3RzLmdlb20uUG9pbnQucHJvdG90eXBlLm5vcm1hbGl6ZT1mdW5jdGlvbigpe307anN0cy5nZW9tLlBvaW50LnByb3RvdHlwZS5jb21wYXJlVG9TYW1lQ2xhc3M9ZnVuY3Rpb24ob3RoZXIpe3ZhciBwb2ludD1vdGhlcjtyZXR1cm4gdGhpcy5nZXRDb29yZGluYXRlKCkuY29tcGFyZVRvKHBvaW50LmdldENvb3JkaW5hdGUoKSk7fTtqc3RzLmdlb20uUG9pbnQucHJvdG90eXBlLmdldEdlb21ldHJ5VHlwZT1mdW5jdGlvbigpe3JldHVybidQb2ludCc7fTtqc3RzLmdlb20uUG9pbnQucHJvdG90eXBlLmhhc2hDb2RlPWZ1bmN0aW9uKCl7cmV0dXJuJ1BvaW50XycrdGhpcy5jb29yZGluYXRlLmhhc2hDb2RlKCk7fTtqc3RzLmdlb20uUG9pbnQucHJvdG90eXBlLkNMQVNTX05BTUU9J2pzdHMuZ2VvbS5Qb2ludCc7anN0cy5nZW9tLkRpbWVuc2lvbj1mdW5jdGlvbigpe307anN0cy5nZW9tLkRpbWVuc2lvbi5QPTA7anN0cy5nZW9tLkRpbWVuc2lvbi5MPTE7anN0cy5nZW9tLkRpbWVuc2lvbi5BPTI7anN0cy5nZW9tLkRpbWVuc2lvbi5GQUxTRT0tMTtqc3RzLmdlb20uRGltZW5zaW9uLlRSVUU9LTI7anN0cy5nZW9tLkRpbWVuc2lvbi5ET05UQ0FSRT0tMztqc3RzLmdlb20uRGltZW5zaW9uLnRvRGltZW5zaW9uU3ltYm9sPWZ1bmN0aW9uKGRpbWVuc2lvblZhbHVlKXtzd2l0Y2goZGltZW5zaW9uVmFsdWUpe2Nhc2UganN0cy5nZW9tLkRpbWVuc2lvbi5GQUxTRTpyZXR1cm4nRic7Y2FzZSBqc3RzLmdlb20uRGltZW5zaW9uLlRSVUU6cmV0dXJuJ1QnO2Nhc2UganN0cy5nZW9tLkRpbWVuc2lvbi5ET05UQ0FSRTpyZXR1cm4nKic7Y2FzZSBqc3RzLmdlb20uRGltZW5zaW9uLlA6cmV0dXJuJzAnO2Nhc2UganN0cy5nZW9tLkRpbWVuc2lvbi5MOnJldHVybicxJztjYXNlIGpzdHMuZ2VvbS5EaW1lbnNpb24uQTpyZXR1cm4nMic7fVxudGhyb3cgbmV3IGpzdHMuSWxsZWdhbEFyZ3VtZW50RXJyb3IoJ1Vua25vd24gZGltZW5zaW9uIHZhbHVlOiAnK1xuZGltZW5zaW9uVmFsdWUpO307anN0cy5nZW9tLkRpbWVuc2lvbi50b0RpbWVuc2lvblZhbHVlPWZ1bmN0aW9uKGRpbWVuc2lvblN5bWJvbCl7c3dpdGNoKGRpbWVuc2lvblN5bWJvbC50b1VwcGVyQ2FzZSgpKXtjYXNlJ0YnOnJldHVybiBqc3RzLmdlb20uRGltZW5zaW9uLkZBTFNFO2Nhc2UnVCc6cmV0dXJuIGpzdHMuZ2VvbS5EaW1lbnNpb24uVFJVRTtjYXNlJyonOnJldHVybiBqc3RzLmdlb20uRGltZW5zaW9uLkRPTlRDQVJFO2Nhc2UnMCc6cmV0dXJuIGpzdHMuZ2VvbS5EaW1lbnNpb24uUDtjYXNlJzEnOnJldHVybiBqc3RzLmdlb20uRGltZW5zaW9uLkw7Y2FzZScyJzpyZXR1cm4ganN0cy5nZW9tLkRpbWVuc2lvbi5BO31cbnRocm93IG5ldyBqc3RzLmVycm9yLklsbGVnYWxBcmd1bWVudEVycm9yKCdVbmtub3duIGRpbWVuc2lvbiBzeW1ib2w6ICcrXG5kaW1lbnNpb25TeW1ib2wpO307KGZ1bmN0aW9uKCl7dmFyIERpbWVuc2lvbj1qc3RzLmdlb20uRGltZW5zaW9uO2pzdHMuZ2VvbS5MaW5lU3RyaW5nPWZ1bmN0aW9uKHBvaW50cyxmYWN0b3J5KXt0aGlzLmZhY3Rvcnk9ZmFjdG9yeTt0aGlzLnBvaW50cz1wb2ludHN8fFtdO307anN0cy5nZW9tLkxpbmVTdHJpbmcucHJvdG90eXBlPW5ldyBqc3RzLmdlb20uR2VvbWV0cnkoKTtqc3RzLmdlb20uTGluZVN0cmluZy5jb25zdHJ1Y3Rvcj1qc3RzLmdlb20uTGluZVN0cmluZztqc3RzLmdlb20uTGluZVN0cmluZy5wcm90b3R5cGUucG9pbnRzPW51bGw7anN0cy5nZW9tLkxpbmVTdHJpbmcucHJvdG90eXBlLmdldENvb3JkaW5hdGVzPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMucG9pbnRzO307anN0cy5nZW9tLkxpbmVTdHJpbmcucHJvdG90eXBlLmdldENvb3JkaW5hdGVTZXF1ZW5jZT1mdW5jdGlvbigpe3JldHVybiB0aGlzLnBvaW50czt9O2pzdHMuZ2VvbS5MaW5lU3RyaW5nLnByb3RvdHlwZS5nZXRDb29yZGluYXRlTj1mdW5jdGlvbihuKXtyZXR1cm4gdGhpcy5wb2ludHNbbl07fTtqc3RzLmdlb20uTGluZVN0cmluZy5wcm90b3R5cGUuZ2V0Q29vcmRpbmF0ZT1mdW5jdGlvbigpe2lmKHRoaXMuaXNFbXB0eSgpKXtyZXR1cm4gbnVsbDt9XG5yZXR1cm4gdGhpcy5nZXRDb29yZGluYXRlTigwKTt9O2pzdHMuZ2VvbS5MaW5lU3RyaW5nLnByb3RvdHlwZS5nZXREaW1lbnNpb249ZnVuY3Rpb24oKXtyZXR1cm4gMTt9O2pzdHMuZ2VvbS5MaW5lU3RyaW5nLnByb3RvdHlwZS5nZXRCb3VuZGFyeURpbWVuc2lvbj1mdW5jdGlvbigpe2lmKHRoaXMuaXNDbG9zZWQoKSl7cmV0dXJuIERpbWVuc2lvbi5GQUxTRTt9XG5yZXR1cm4gMDt9O2pzdHMuZ2VvbS5MaW5lU3RyaW5nLnByb3RvdHlwZS5pc0VtcHR5PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMucG9pbnRzLmxlbmd0aD09PTA7fTtqc3RzLmdlb20uTGluZVN0cmluZy5wcm90b3R5cGUuZ2V0TnVtUG9pbnRzPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMucG9pbnRzLmxlbmd0aDt9O2pzdHMuZ2VvbS5MaW5lU3RyaW5nLnByb3RvdHlwZS5nZXRQb2ludE49ZnVuY3Rpb24obil7cmV0dXJuIHRoaXMuZ2V0RmFjdG9yeSgpLmNyZWF0ZVBvaW50KHRoaXMucG9pbnRzW25dKTt9O2pzdHMuZ2VvbS5MaW5lU3RyaW5nLnByb3RvdHlwZS5nZXRTdGFydFBvaW50PWZ1bmN0aW9uKCl7aWYodGhpcy5pc0VtcHR5KCkpe3JldHVybiBudWxsO31cbnJldHVybiB0aGlzLmdldFBvaW50TigwKTt9O2pzdHMuZ2VvbS5MaW5lU3RyaW5nLnByb3RvdHlwZS5nZXRFbmRQb2ludD1mdW5jdGlvbigpe2lmKHRoaXMuaXNFbXB0eSgpKXtyZXR1cm4gbnVsbDt9XG5yZXR1cm4gdGhpcy5nZXRQb2ludE4odGhpcy5nZXROdW1Qb2ludHMoKS0xKTt9O2pzdHMuZ2VvbS5MaW5lU3RyaW5nLnByb3RvdHlwZS5pc0Nsb3NlZD1mdW5jdGlvbigpe2lmKHRoaXMuaXNFbXB0eSgpKXtyZXR1cm4gZmFsc2U7fVxucmV0dXJuIHRoaXMuZ2V0Q29vcmRpbmF0ZU4oMCkuZXF1YWxzMkQodGhpcy5nZXRDb29yZGluYXRlTih0aGlzLnBvaW50cy5sZW5ndGgtMSkpO307anN0cy5nZW9tLkxpbmVTdHJpbmcucHJvdG90eXBlLmlzUmluZz1mdW5jdGlvbigpe3JldHVybiB0aGlzLmlzQ2xvc2VkKCkmJnRoaXMuaXNTaW1wbGUoKTt9O2pzdHMuZ2VvbS5MaW5lU3RyaW5nLnByb3RvdHlwZS5nZXRHZW9tZXRyeVR5cGU9ZnVuY3Rpb24oKXtyZXR1cm4nTGluZVN0cmluZyc7fTtqc3RzLmdlb20uTGluZVN0cmluZy5wcm90b3R5cGUuZ2V0TGVuZ3RoPWZ1bmN0aW9uKCl7cmV0dXJuIGpzdHMuYWxnb3JpdGhtLkNHQWxnb3JpdGhtcy5jb21wdXRlTGVuZ3RoKHRoaXMucG9pbnRzKTt9O2pzdHMuZ2VvbS5MaW5lU3RyaW5nLnByb3RvdHlwZS5nZXRCb3VuZGFyeT1mdW5jdGlvbigpe3JldHVybihuZXcganN0cy5vcGVyYXRpb24uQm91bmRhcnlPcCh0aGlzKSkuZ2V0Qm91bmRhcnkoKTt9O2pzdHMuZ2VvbS5MaW5lU3RyaW5nLnByb3RvdHlwZS5jb21wdXRlRW52ZWxvcGVJbnRlcm5hbD1mdW5jdGlvbigpe2lmKHRoaXMuaXNFbXB0eSgpKXtyZXR1cm4gbmV3IGpzdHMuZ2VvbS5FbnZlbG9wZSgpO31cbnZhciBlbnY9bmV3IGpzdHMuZ2VvbS5FbnZlbG9wZSgpO3RoaXMucG9pbnRzLmZvckVhY2goZnVuY3Rpb24oY29tcG9uZW50KXtlbnYuZXhwYW5kVG9JbmNsdWRlKGNvbXBvbmVudCk7fSk7cmV0dXJuIGVudjt9O2pzdHMuZ2VvbS5MaW5lU3RyaW5nLnByb3RvdHlwZS5lcXVhbHNFeGFjdD1mdW5jdGlvbihvdGhlcix0b2xlcmFuY2Upe2lmKCF0aGlzLmlzRXF1aXZhbGVudENsYXNzKG90aGVyKSl7cmV0dXJuIGZhbHNlO31cbmlmKHRoaXMucG9pbnRzLmxlbmd0aCE9PW90aGVyLnBvaW50cy5sZW5ndGgpe3JldHVybiBmYWxzZTt9XG5pZih0aGlzLmlzRW1wdHkoKSYmb3RoZXIuaXNFbXB0eSgpKXtyZXR1cm4gdHJ1ZTt9XG5yZXR1cm4gdGhpcy5wb2ludHMucmVkdWNlKGZ1bmN0aW9uKGVxdWFsLHBvaW50LGkpe3JldHVybiBlcXVhbCYmanN0cy5nZW9tLkdlb21ldHJ5LnByb3RvdHlwZS5lcXVhbChwb2ludCxvdGhlci5wb2ludHNbaV0sdG9sZXJhbmNlKTt9KTt9O2pzdHMuZ2VvbS5MaW5lU3RyaW5nLnByb3RvdHlwZS5pc0VxdWl2YWxlbnRDbGFzcz1mdW5jdGlvbihvdGhlcil7cmV0dXJuIG90aGVyIGluc3RhbmNlb2YganN0cy5nZW9tLkxpbmVTdHJpbmc7fTtqc3RzLmdlb20uTGluZVN0cmluZy5wcm90b3R5cGUuY29tcGFyZVRvU2FtZUNsYXNzPWZ1bmN0aW9uKG8pe3ZhciBsaW5lPW87dmFyIGk9MCxpbD10aGlzLnBvaW50cy5sZW5ndGg7dmFyIGo9MCxqbD1saW5lLnBvaW50cy5sZW5ndGg7d2hpbGUoaTxpbCYmajxqbCl7dmFyIGNvbXBhcmlzb249dGhpcy5wb2ludHNbaV0uY29tcGFyZVRvKGxpbmUucG9pbnRzW2pdKTtpZihjb21wYXJpc29uIT09MCl7cmV0dXJuIGNvbXBhcmlzb247fVxuaSsrO2orKzt9XG5pZihpPGlsKXtyZXR1cm4gMTt9XG5pZihqPGpsKXtyZXR1cm4tMTt9XG5yZXR1cm4gMDt9O2pzdHMuZ2VvbS5MaW5lU3RyaW5nLnByb3RvdHlwZS5hcHBseT1mdW5jdGlvbihmaWx0ZXIpe2lmKGZpbHRlciBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5HZW9tZXRyeUZpbHRlcnx8ZmlsdGVyIGluc3RhbmNlb2YganN0cy5nZW9tLkdlb21ldHJ5Q29tcG9uZW50RmlsdGVyKXtmaWx0ZXIuZmlsdGVyKHRoaXMpO31lbHNlIGlmKGZpbHRlciBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5Db29yZGluYXRlRmlsdGVyKXtmb3IodmFyIGk9MCxsZW49dGhpcy5wb2ludHMubGVuZ3RoO2k8bGVuO2krKyl7ZmlsdGVyLmZpbHRlcih0aGlzLnBvaW50c1tpXSk7fX1lbHNlIGlmKGZpbHRlciBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5Db29yZGluYXRlU2VxdWVuY2VGaWx0ZXIpe3RoaXMuYXBwbHkyLmFwcGx5KHRoaXMsYXJndW1lbnRzKTt9fTtqc3RzLmdlb20uTGluZVN0cmluZy5wcm90b3R5cGUuYXBwbHkyPWZ1bmN0aW9uKGZpbHRlcil7aWYodGhpcy5wb2ludHMubGVuZ3RoPT09MClcbnJldHVybjtmb3IodmFyIGk9MDtpPHRoaXMucG9pbnRzLmxlbmd0aDtpKyspe2ZpbHRlci5maWx0ZXIodGhpcy5wb2ludHMsaSk7aWYoZmlsdGVyLmlzRG9uZSgpKVxuYnJlYWs7fVxuaWYoZmlsdGVyLmlzR2VvbWV0cnlDaGFuZ2VkKCkpe319O2pzdHMuZ2VvbS5MaW5lU3RyaW5nLnByb3RvdHlwZS5jbG9uZT1mdW5jdGlvbigpe3ZhciBwb2ludHM9W107Zm9yKHZhciBpPTAsbGVuPXRoaXMucG9pbnRzLmxlbmd0aDtpPGxlbjtpKyspe3BvaW50cy5wdXNoKHRoaXMucG9pbnRzW2ldLmNsb25lKCkpO31cbnJldHVybiB0aGlzLmZhY3RvcnkuY3JlYXRlTGluZVN0cmluZyhwb2ludHMpO307anN0cy5nZW9tLkxpbmVTdHJpbmcucHJvdG90eXBlLm5vcm1hbGl6ZT1mdW5jdGlvbigpe3ZhciBpLGlsLGosY2ksY2osbGVuO2xlbj10aGlzLnBvaW50cy5sZW5ndGg7aWw9cGFyc2VJbnQobGVuLzIpO2ZvcihpPTA7aTxpbDtpKyspe2o9bGVuLTEtaTtjaT10aGlzLnBvaW50c1tpXTtjaj10aGlzLnBvaW50c1tqXTtpZighY2kuZXF1YWxzKGNqKSl7aWYoY2kuY29tcGFyZVRvKGNqKT4wKXt0aGlzLnBvaW50cy5yZXZlcnNlKCk7fVxucmV0dXJuO319fTtqc3RzLmdlb20uTGluZVN0cmluZy5wcm90b3R5cGUuQ0xBU1NfTkFNRT0nanN0cy5nZW9tLkxpbmVTdHJpbmcnO30pKCk7KGZ1bmN0aW9uKCl7anN0cy5nZW9tLlBvbHlnb249ZnVuY3Rpb24oc2hlbGwsaG9sZXMsZmFjdG9yeSl7dGhpcy5zaGVsbD1zaGVsbHx8ZmFjdG9yeS5jcmVhdGVMaW5lYXJSaW5nKG51bGwpO3RoaXMuaG9sZXM9aG9sZXN8fFtdO3RoaXMuZmFjdG9yeT1mYWN0b3J5O307anN0cy5nZW9tLlBvbHlnb24ucHJvdG90eXBlPW5ldyBqc3RzLmdlb20uR2VvbWV0cnkoKTtqc3RzLmdlb20uUG9seWdvbi5jb25zdHJ1Y3Rvcj1qc3RzLmdlb20uUG9seWdvbjtqc3RzLmdlb20uUG9seWdvbi5wcm90b3R5cGUuZ2V0Q29vcmRpbmF0ZT1mdW5jdGlvbigpe3JldHVybiB0aGlzLnNoZWxsLmdldENvb3JkaW5hdGUoKTt9O2pzdHMuZ2VvbS5Qb2x5Z29uLnByb3RvdHlwZS5nZXRDb29yZGluYXRlcz1mdW5jdGlvbigpe2lmKHRoaXMuaXNFbXB0eSgpKXtyZXR1cm5bXTt9XG52YXIgY29vcmRpbmF0ZXM9W107dmFyIGs9LTE7dmFyIHNoZWxsQ29vcmRpbmF0ZXM9dGhpcy5zaGVsbC5nZXRDb29yZGluYXRlcygpO2Zvcih2YXIgeD0wO3g8c2hlbGxDb29yZGluYXRlcy5sZW5ndGg7eCsrKXtrKys7Y29vcmRpbmF0ZXNba109c2hlbGxDb29yZGluYXRlc1t4XTt9XG5mb3IodmFyIGk9MDtpPHRoaXMuaG9sZXMubGVuZ3RoO2krKyl7dmFyIGNoaWxkQ29vcmRpbmF0ZXM9dGhpcy5ob2xlc1tpXS5nZXRDb29yZGluYXRlcygpO2Zvcih2YXIgaj0wO2o8Y2hpbGRDb29yZGluYXRlcy5sZW5ndGg7aisrKXtrKys7Y29vcmRpbmF0ZXNba109Y2hpbGRDb29yZGluYXRlc1tqXTt9fVxucmV0dXJuIGNvb3JkaW5hdGVzO307anN0cy5nZW9tLlBvbHlnb24ucHJvdG90eXBlLmdldE51bVBvaW50cz1mdW5jdGlvbigpe3ZhciBudW1Qb2ludHM9dGhpcy5zaGVsbC5nZXROdW1Qb2ludHMoKTtmb3IodmFyIGk9MDtpPHRoaXMuaG9sZXMubGVuZ3RoO2krKyl7bnVtUG9pbnRzKz10aGlzLmhvbGVzW2ldLmdldE51bVBvaW50cygpO31cbnJldHVybiBudW1Qb2ludHM7fTtqc3RzLmdlb20uUG9seWdvbi5wcm90b3R5cGUuaXNFbXB0eT1mdW5jdGlvbigpe3JldHVybiB0aGlzLnNoZWxsLmlzRW1wdHkoKTt9O2pzdHMuZ2VvbS5Qb2x5Z29uLnByb3RvdHlwZS5pc1JlY3RhbmdsZT1mdW5jdGlvbigpe2lmKHRoaXMuZ2V0TnVtSW50ZXJpb3JSaW5nKCkhPTApcmV0dXJuIGZhbHNlO2lmKHRoaXMuc2hlbGw9PW51bGwpcmV0dXJuIGZhbHNlO2lmKHRoaXMuc2hlbGwuZ2V0TnVtUG9pbnRzKCkhPTUpcmV0dXJuIGZhbHNlO3ZhciBzZXE9dGhpcy5zaGVsbC5nZXRDb29yZGluYXRlU2VxdWVuY2UoKTt2YXIgZW52PXRoaXMuZ2V0RW52ZWxvcGVJbnRlcm5hbCgpO2Zvcih2YXIgaT0wO2k8NTtpKyspe3ZhciB4PXNlcVtpXS54O2lmKCEoeD09ZW52LmdldE1pblgoKXx8eD09ZW52LmdldE1heFgoKSkpcmV0dXJuIGZhbHNlO3ZhciB5PXNlcVtpXS55O2lmKCEoeT09ZW52LmdldE1pblkoKXx8eT09ZW52LmdldE1heFkoKSkpcmV0dXJuIGZhbHNlO31cbnZhciBwcmV2WD1zZXFbMF0ueDt2YXIgcHJldlk9c2VxWzBdLnk7Zm9yKHZhciBpPTE7aTw9NDtpKyspe3ZhciB4PXNlcVtpXS54O3ZhciB5PXNlcVtpXS55O3ZhciB4Q2hhbmdlZD14IT1wcmV2WDt2YXIgeUNoYW5nZWQ9eSE9cHJldlk7aWYoeENoYW5nZWQ9PXlDaGFuZ2VkKVxucmV0dXJuIGZhbHNlO3ByZXZYPXg7cHJldlk9eTt9XG5yZXR1cm4gdHJ1ZTt9O2pzdHMuZ2VvbS5Qb2x5Z29uLnByb3RvdHlwZS5nZXRFeHRlcmlvclJpbmc9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5zaGVsbDt9O2pzdHMuZ2VvbS5Qb2x5Z29uLnByb3RvdHlwZS5nZXRJbnRlcmlvclJpbmdOPWZ1bmN0aW9uKG4pe3JldHVybiB0aGlzLmhvbGVzW25dO307anN0cy5nZW9tLlBvbHlnb24ucHJvdG90eXBlLmdldE51bUludGVyaW9yUmluZz1mdW5jdGlvbigpe3JldHVybiB0aGlzLmhvbGVzLmxlbmd0aDt9O2pzdHMuZ2VvbS5Qb2x5Z29uLnByb3RvdHlwZS5nZXRBcmVhPWZ1bmN0aW9uKCl7dmFyIGFyZWE9MC4wO2FyZWErPU1hdGguYWJzKGpzdHMuYWxnb3JpdGhtLkNHQWxnb3JpdGhtcy5zaWduZWRBcmVhKHRoaXMuc2hlbGwuZ2V0Q29vcmRpbmF0ZVNlcXVlbmNlKCkpKTtmb3IodmFyIGk9MDtpPHRoaXMuaG9sZXMubGVuZ3RoO2krKyl7YXJlYS09TWF0aC5hYnMoanN0cy5hbGdvcml0aG0uQ0dBbGdvcml0aG1zLnNpZ25lZEFyZWEodGhpcy5ob2xlc1tpXS5nZXRDb29yZGluYXRlU2VxdWVuY2UoKSkpO31cbnJldHVybiBhcmVhO307anN0cy5nZW9tLlBvbHlnb24ucHJvdG90eXBlLmdldExlbmd0aD1mdW5jdGlvbigpe3ZhciBsZW49MC4wO2xlbis9dGhpcy5zaGVsbC5nZXRMZW5ndGgoKTtmb3IodmFyIGk9MDtpPHRoaXMuaG9sZXMubGVuZ3RoO2krKyl7bGVuKz10aGlzLmhvbGVzW2ldLmdldExlbmd0aCgpO31cbnJldHVybiBsZW47fTtqc3RzLmdlb20uUG9seWdvbi5wcm90b3R5cGUuZ2V0Qm91bmRhcnk9ZnVuY3Rpb24oKXtpZih0aGlzLmlzRW1wdHkoKSl7cmV0dXJuIHRoaXMuZ2V0RmFjdG9yeSgpLmNyZWF0ZU11bHRpTGluZVN0cmluZyhudWxsKTt9XG52YXIgcmluZ3M9W107cmluZ3NbMF09dGhpcy5zaGVsbC5jbG9uZSgpO2Zvcih2YXIgaT0wLGxlbj10aGlzLmhvbGVzLmxlbmd0aDtpPGxlbjtpKyspe3JpbmdzW2krMV09dGhpcy5ob2xlc1tpXS5jbG9uZSgpO31cbmlmKHJpbmdzLmxlbmd0aDw9MSlcbnJldHVybiByaW5nc1swXTtyZXR1cm4gdGhpcy5nZXRGYWN0b3J5KCkuY3JlYXRlTXVsdGlMaW5lU3RyaW5nKHJpbmdzKTt9O2pzdHMuZ2VvbS5Qb2x5Z29uLnByb3RvdHlwZS5jb21wdXRlRW52ZWxvcGVJbnRlcm5hbD1mdW5jdGlvbigpe3JldHVybiB0aGlzLnNoZWxsLmdldEVudmVsb3BlSW50ZXJuYWwoKTt9O2pzdHMuZ2VvbS5Qb2x5Z29uLnByb3RvdHlwZS5nZXREaW1lbnNpb249ZnVuY3Rpb24oKXtyZXR1cm4gMjt9O2pzdHMuZ2VvbS5Qb2x5Z29uLnByb3RvdHlwZS5nZXRCb3VuZGFyeURpbWVuc2lvbj1mdW5jdGlvbigpe3JldHVybiAxO307anN0cy5nZW9tLlBvbHlnb24ucHJvdG90eXBlLmVxdWFsc0V4YWN0PWZ1bmN0aW9uKG90aGVyLHRvbGVyYW5jZSl7aWYoIXRoaXMuaXNFcXVpdmFsZW50Q2xhc3Mob3RoZXIpKXtyZXR1cm4gZmFsc2U7fVxuaWYodGhpcy5pc0VtcHR5KCkmJm90aGVyLmlzRW1wdHkoKSl7cmV0dXJuIHRydWU7fVxuaWYodGhpcy5pc0VtcHR5KCkhPT1vdGhlci5pc0VtcHR5KCkpe3JldHVybiBmYWxzZTt9XG5pZighdGhpcy5zaGVsbC5lcXVhbHNFeGFjdChvdGhlci5zaGVsbCx0b2xlcmFuY2UpKXtyZXR1cm4gZmFsc2U7fVxuaWYodGhpcy5ob2xlcy5sZW5ndGghPT1vdGhlci5ob2xlcy5sZW5ndGgpe3JldHVybiBmYWxzZTt9XG5pZih0aGlzLmhvbGVzLmxlbmd0aCE9PW90aGVyLmhvbGVzLmxlbmd0aCl7cmV0dXJuIGZhbHNlO31cbmZvcih2YXIgaT0wO2k8dGhpcy5ob2xlcy5sZW5ndGg7aSsrKXtpZighKHRoaXMuaG9sZXNbaV0pLmVxdWFsc0V4YWN0KG90aGVyLmhvbGVzW2ldLHRvbGVyYW5jZSkpe3JldHVybiBmYWxzZTt9fVxucmV0dXJuIHRydWU7fTtqc3RzLmdlb20uUG9seWdvbi5wcm90b3R5cGUuY29tcGFyZVRvU2FtZUNsYXNzPWZ1bmN0aW9uKG8pe3JldHVybiB0aGlzLnNoZWxsLmNvbXBhcmVUb1NhbWVDbGFzcyhvLnNoZWxsKTt9O2pzdHMuZ2VvbS5Qb2x5Z29uLnByb3RvdHlwZS5hcHBseT1mdW5jdGlvbihmaWx0ZXIpe2lmKGZpbHRlciBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5HZW9tZXRyeUNvbXBvbmVudEZpbHRlcil7ZmlsdGVyLmZpbHRlcih0aGlzKTt0aGlzLnNoZWxsLmFwcGx5KGZpbHRlcik7Zm9yKHZhciBpPTAsbGVuPXRoaXMuaG9sZXMubGVuZ3RoO2k8bGVuO2krKyl7dGhpcy5ob2xlc1tpXS5hcHBseShmaWx0ZXIpO319ZWxzZSBpZihmaWx0ZXIgaW5zdGFuY2VvZiBqc3RzLmdlb20uR2VvbWV0cnlGaWx0ZXIpe2ZpbHRlci5maWx0ZXIodGhpcyk7fWVsc2UgaWYoZmlsdGVyIGluc3RhbmNlb2YganN0cy5nZW9tLkNvb3JkaW5hdGVGaWx0ZXIpe3RoaXMuc2hlbGwuYXBwbHkoZmlsdGVyKTtmb3IodmFyIGk9MCxsZW49dGhpcy5ob2xlcy5sZW5ndGg7aTxsZW47aSsrKXt0aGlzLmhvbGVzW2ldLmFwcGx5KGZpbHRlcik7fX1lbHNlIGlmKGZpbHRlciBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5Db29yZGluYXRlU2VxdWVuY2VGaWx0ZXIpe3RoaXMuYXBwbHkyLmFwcGx5KHRoaXMsYXJndW1lbnRzKTt9fTtqc3RzLmdlb20uUG9seWdvbi5wcm90b3R5cGUuYXBwbHkyPWZ1bmN0aW9uKGZpbHRlcil7dGhpcy5zaGVsbC5hcHBseShmaWx0ZXIpO2lmKCFmaWx0ZXIuaXNEb25lKCkpe2Zvcih2YXIgaT0wO2k8dGhpcy5ob2xlcy5sZW5ndGg7aSsrKXt0aGlzLmhvbGVzW2ldLmFwcGx5KGZpbHRlcik7aWYoZmlsdGVyLmlzRG9uZSgpKVxuYnJlYWs7fX1cbmlmKGZpbHRlci5pc0dlb21ldHJ5Q2hhbmdlZCgpKXt9fTtqc3RzLmdlb20uUG9seWdvbi5wcm90b3R5cGUuY2xvbmU9ZnVuY3Rpb24oKXt2YXIgaG9sZXM9W107Zm9yKHZhciBpPTAsbGVuPXRoaXMuaG9sZXMubGVuZ3RoO2k8bGVuO2krKyl7aG9sZXMucHVzaCh0aGlzLmhvbGVzW2ldLmNsb25lKCkpO31cbnJldHVybiB0aGlzLmZhY3RvcnkuY3JlYXRlUG9seWdvbih0aGlzLnNoZWxsLmNsb25lKCksaG9sZXMpO307anN0cy5nZW9tLlBvbHlnb24ucHJvdG90eXBlLm5vcm1hbGl6ZT1mdW5jdGlvbigpe3RoaXMubm9ybWFsaXplMih0aGlzLnNoZWxsLHRydWUpO2Zvcih2YXIgaT0wLGxlbj10aGlzLmhvbGVzLmxlbmd0aDtpPGxlbjtpKyspe3RoaXMubm9ybWFsaXplMih0aGlzLmhvbGVzW2ldLGZhbHNlKTt9XG50aGlzLmhvbGVzLnNvcnQoKTt9O2pzdHMuZ2VvbS5Qb2x5Z29uLnByb3RvdHlwZS5ub3JtYWxpemUyPWZ1bmN0aW9uKHJpbmcsY2xvY2t3aXNlKXtpZihyaW5nLmlzRW1wdHkoKSl7cmV0dXJuO31cbnZhciB1bmlxdWVDb29yZGluYXRlcz1yaW5nLnBvaW50cy5zbGljZSgwLHJpbmcucG9pbnRzLmxlbmd0aC0xKTt2YXIgbWluQ29vcmRpbmF0ZT1qc3RzLmdlb20uQ29vcmRpbmF0ZUFycmF5cy5taW5Db29yZGluYXRlKHJpbmcucG9pbnRzKTtqc3RzLmdlb20uQ29vcmRpbmF0ZUFycmF5cy5zY3JvbGwodW5pcXVlQ29vcmRpbmF0ZXMsbWluQ29vcmRpbmF0ZSk7cmluZy5wb2ludHM9dW5pcXVlQ29vcmRpbmF0ZXMuY29uY2F0KCk7cmluZy5wb2ludHNbdW5pcXVlQ29vcmRpbmF0ZXMubGVuZ3RoXT11bmlxdWVDb29yZGluYXRlc1swXTtpZihqc3RzLmFsZ29yaXRobS5DR0FsZ29yaXRobXMuaXNDQ1cocmluZy5wb2ludHMpPT09Y2xvY2t3aXNlKXtyaW5nLnBvaW50cy5yZXZlcnNlKCk7fX07anN0cy5nZW9tLlBvbHlnb24ucHJvdG90eXBlLmdldEdlb21ldHJ5VHlwZT1mdW5jdGlvbigpe3JldHVybidQb2x5Z29uJzt9O2pzdHMuZ2VvbS5Qb2x5Z29uLnByb3RvdHlwZS5DTEFTU19OQU1FPSdqc3RzLmdlb20uUG9seWdvbic7fSkoKTsoZnVuY3Rpb24oKXt2YXIgR2VvbWV0cnk9anN0cy5nZW9tLkdlb21ldHJ5O3ZhciBUcmVlU2V0PWphdmFzY3JpcHQudXRpbC5UcmVlU2V0O3ZhciBBcnJheXM9amF2YXNjcmlwdC51dGlsLkFycmF5cztqc3RzLmdlb20uR2VvbWV0cnlDb2xsZWN0aW9uPWZ1bmN0aW9uKGdlb21ldHJpZXMsZmFjdG9yeSl7dGhpcy5nZW9tZXRyaWVzPWdlb21ldHJpZXN8fFtdO3RoaXMuZmFjdG9yeT1mYWN0b3J5O307anN0cy5nZW9tLkdlb21ldHJ5Q29sbGVjdGlvbi5wcm90b3R5cGU9bmV3IEdlb21ldHJ5KCk7anN0cy5nZW9tLkdlb21ldHJ5Q29sbGVjdGlvbi5jb25zdHJ1Y3Rvcj1qc3RzLmdlb20uR2VvbWV0cnlDb2xsZWN0aW9uO2pzdHMuZ2VvbS5HZW9tZXRyeUNvbGxlY3Rpb24ucHJvdG90eXBlLmlzRW1wdHk9ZnVuY3Rpb24oKXtmb3IodmFyIGk9MCxsZW49dGhpcy5nZW9tZXRyaWVzLmxlbmd0aDtpPGxlbjtpKyspe3ZhciBnZW9tZXRyeT10aGlzLmdldEdlb21ldHJ5TihpKTtpZighZ2VvbWV0cnkuaXNFbXB0eSgpKXtyZXR1cm4gZmFsc2U7fX1cbnJldHVybiB0cnVlO307anN0cy5nZW9tLkdlb21ldHJ5Q29sbGVjdGlvbi5wcm90b3R5cGUuZ2V0QXJlYT1mdW5jdGlvbigpe3ZhciBhcmVhPTAuMDtmb3IodmFyIGk9MCxsZW49dGhpcy5nZW9tZXRyaWVzLmxlbmd0aDtpPGxlbjtpKyspe2FyZWErPXRoaXMuZ2V0R2VvbWV0cnlOKGkpLmdldEFyZWEoKTt9XG5yZXR1cm4gYXJlYTt9O2pzdHMuZ2VvbS5HZW9tZXRyeUNvbGxlY3Rpb24ucHJvdG90eXBlLmdldExlbmd0aD1mdW5jdGlvbigpe3ZhciBsZW5ndGg9MC4wO2Zvcih2YXIgaT0wLGxlbj10aGlzLmdlb21ldHJpZXMubGVuZ3RoO2k8bGVuO2krKyl7bGVuZ3RoKz10aGlzLmdldEdlb21ldHJ5TihpKS5nZXRMZW5ndGgoKTt9XG5yZXR1cm4gbGVuZ3RoO307anN0cy5nZW9tLkdlb21ldHJ5Q29sbGVjdGlvbi5wcm90b3R5cGUuZ2V0Q29vcmRpbmF0ZT1mdW5jdGlvbigpe2lmKHRoaXMuaXNFbXB0eSgpKVxucmV0dXJuIG51bGw7cmV0dXJuIHRoaXMuZ2V0R2VvbWV0cnlOKDApLmdldENvb3JkaW5hdGUoKTt9O2pzdHMuZ2VvbS5HZW9tZXRyeUNvbGxlY3Rpb24ucHJvdG90eXBlLmdldENvb3JkaW5hdGVzPWZ1bmN0aW9uKCl7dmFyIGNvb3JkaW5hdGVzPVtdO3ZhciBrPS0xO2Zvcih2YXIgaT0wLGxlbj10aGlzLmdlb21ldHJpZXMubGVuZ3RoO2k8bGVuO2krKyl7dmFyIGdlb21ldHJ5PXRoaXMuZ2V0R2VvbWV0cnlOKGkpO3ZhciBjaGlsZENvb3JkaW5hdGVzPWdlb21ldHJ5LmdldENvb3JkaW5hdGVzKCk7Zm9yKHZhciBqPTA7ajxjaGlsZENvb3JkaW5hdGVzLmxlbmd0aDtqKyspe2srKztjb29yZGluYXRlc1trXT1jaGlsZENvb3JkaW5hdGVzW2pdO319XG5yZXR1cm4gY29vcmRpbmF0ZXM7fTtqc3RzLmdlb20uR2VvbWV0cnlDb2xsZWN0aW9uLnByb3RvdHlwZS5nZXROdW1HZW9tZXRyaWVzPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZ2VvbWV0cmllcy5sZW5ndGg7fTtqc3RzLmdlb20uR2VvbWV0cnlDb2xsZWN0aW9uLnByb3RvdHlwZS5nZXRHZW9tZXRyeU49ZnVuY3Rpb24obil7dmFyIGdlb21ldHJ5PXRoaXMuZ2VvbWV0cmllc1tuXTtpZihnZW9tZXRyeSBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5Db29yZGluYXRlKXtnZW9tZXRyeT1uZXcganN0cy5nZW9tLlBvaW50KGdlb21ldHJ5KTt9XG5yZXR1cm4gZ2VvbWV0cnk7fTtqc3RzLmdlb20uR2VvbWV0cnlDb2xsZWN0aW9uLnByb3RvdHlwZS5nZXROdW1Qb2ludHM9ZnVuY3Rpb24obil7dmFyIG51bVBvaW50cz0wO2Zvcih2YXIgaT0wO2k8dGhpcy5nZW9tZXRyaWVzLmxlbmd0aDtpKyspe251bVBvaW50cys9dGhpcy5nZW9tZXRyaWVzW2ldLmdldE51bVBvaW50cygpO31cbnJldHVybiBudW1Qb2ludHM7fVxuanN0cy5nZW9tLkdlb21ldHJ5Q29sbGVjdGlvbi5wcm90b3R5cGUuZXF1YWxzRXhhY3Q9ZnVuY3Rpb24ob3RoZXIsdG9sZXJhbmNlKXtpZighdGhpcy5pc0VxdWl2YWxlbnRDbGFzcyhvdGhlcikpe3JldHVybiBmYWxzZTt9XG5pZih0aGlzLmdlb21ldHJpZXMubGVuZ3RoIT09b3RoZXIuZ2VvbWV0cmllcy5sZW5ndGgpe3JldHVybiBmYWxzZTt9XG5mb3IodmFyIGk9MCxsZW49dGhpcy5nZW9tZXRyaWVzLmxlbmd0aDtpPGxlbjtpKyspe3ZhciBnZW9tZXRyeT10aGlzLmdldEdlb21ldHJ5TihpKTtpZighZ2VvbWV0cnkuZXF1YWxzRXhhY3Qob3RoZXIuZ2V0R2VvbWV0cnlOKGkpLHRvbGVyYW5jZSkpe3JldHVybiBmYWxzZTt9fVxucmV0dXJuIHRydWU7fTtqc3RzLmdlb20uR2VvbWV0cnlDb2xsZWN0aW9uLnByb3RvdHlwZS5jbG9uZT1mdW5jdGlvbigpe3ZhciBnZW9tZXRyaWVzPVtdO2Zvcih2YXIgaT0wLGxlbj10aGlzLmdlb21ldHJpZXMubGVuZ3RoO2k8bGVuO2krKyl7Z2VvbWV0cmllcy5wdXNoKHRoaXMuZ2VvbWV0cmllc1tpXS5jbG9uZSgpKTt9XG5yZXR1cm4gdGhpcy5mYWN0b3J5LmNyZWF0ZUdlb21ldHJ5Q29sbGVjdGlvbihnZW9tZXRyaWVzKTt9O2pzdHMuZ2VvbS5HZW9tZXRyeUNvbGxlY3Rpb24ucHJvdG90eXBlLm5vcm1hbGl6ZT1mdW5jdGlvbigpe2Zvcih2YXIgaT0wLGxlbj10aGlzLmdlb21ldHJpZXMubGVuZ3RoO2k8bGVuO2krKyl7dGhpcy5nZXRHZW9tZXRyeU4oaSkubm9ybWFsaXplKCk7fVxudGhpcy5nZW9tZXRyaWVzLnNvcnQoKTt9O2pzdHMuZ2VvbS5HZW9tZXRyeUNvbGxlY3Rpb24ucHJvdG90eXBlLmNvbXBhcmVUb1NhbWVDbGFzcz1mdW5jdGlvbihvKXt2YXIgdGhlc2VFbGVtZW50cz1uZXcgVHJlZVNldChBcnJheXMuYXNMaXN0KHRoaXMuZ2VvbWV0cmllcykpO3ZhciBvdGhlckVsZW1lbnRzPW5ldyBUcmVlU2V0KEFycmF5cy5hc0xpc3Qoby5nZW9tZXRyaWVzKSk7cmV0dXJuIHRoaXMuY29tcGFyZSh0aGVzZUVsZW1lbnRzLG90aGVyRWxlbWVudHMpO307anN0cy5nZW9tLkdlb21ldHJ5Q29sbGVjdGlvbi5wcm90b3R5cGUuYXBwbHk9ZnVuY3Rpb24oZmlsdGVyKXtpZihmaWx0ZXIgaW5zdGFuY2VvZiBqc3RzLmdlb20uR2VvbWV0cnlGaWx0ZXJ8fGZpbHRlciBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5HZW9tZXRyeUNvbXBvbmVudEZpbHRlcil7ZmlsdGVyLmZpbHRlcih0aGlzKTtmb3IodmFyIGk9MCxsZW49dGhpcy5nZW9tZXRyaWVzLmxlbmd0aDtpPGxlbjtpKyspe3RoaXMuZ2V0R2VvbWV0cnlOKGkpLmFwcGx5KGZpbHRlcik7fX1lbHNlIGlmKGZpbHRlciBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5Db29yZGluYXRlRmlsdGVyKXtmb3IodmFyIGk9MCxsZW49dGhpcy5nZW9tZXRyaWVzLmxlbmd0aDtpPGxlbjtpKyspe3RoaXMuZ2V0R2VvbWV0cnlOKGkpLmFwcGx5KGZpbHRlcik7fX1lbHNlIGlmKGZpbHRlciBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5Db29yZGluYXRlU2VxdWVuY2VGaWx0ZXIpe3RoaXMuYXBwbHkyLmFwcGx5KHRoaXMsYXJndW1lbnRzKTt9fTtqc3RzLmdlb20uR2VvbWV0cnlDb2xsZWN0aW9uLnByb3RvdHlwZS5hcHBseTI9ZnVuY3Rpb24oZmlsdGVyKXtpZih0aGlzLmdlb21ldHJpZXMubGVuZ3RoPT0wKVxucmV0dXJuO2Zvcih2YXIgaT0wO2k8dGhpcy5nZW9tZXRyaWVzLmxlbmd0aDtpKyspe3RoaXMuZ2VvbWV0cmllc1tpXS5hcHBseShmaWx0ZXIpO2lmKGZpbHRlci5pc0RvbmUoKSl7YnJlYWs7fX1cbmlmKGZpbHRlci5pc0dlb21ldHJ5Q2hhbmdlZCgpKXt9fTtqc3RzLmdlb20uR2VvbWV0cnlDb2xsZWN0aW9uLnByb3RvdHlwZS5nZXREaW1lbnNpb249ZnVuY3Rpb24oKXt2YXIgZGltZW5zaW9uPWpzdHMuZ2VvbS5EaW1lbnNpb24uRkFMU0U7Zm9yKHZhciBpPTAsbGVuPXRoaXMuZ2VvbWV0cmllcy5sZW5ndGg7aTxsZW47aSsrKXt2YXIgZ2VvbWV0cnk9dGhpcy5nZXRHZW9tZXRyeU4oaSk7ZGltZW5zaW9uPU1hdGgubWF4KGRpbWVuc2lvbixnZW9tZXRyeS5nZXREaW1lbnNpb24oKSk7fVxucmV0dXJuIGRpbWVuc2lvbjt9O2pzdHMuZ2VvbS5HZW9tZXRyeUNvbGxlY3Rpb24ucHJvdG90eXBlLmNvbXB1dGVFbnZlbG9wZUludGVybmFsPWZ1bmN0aW9uKCl7dmFyIGVudmVsb3BlPW5ldyBqc3RzLmdlb20uRW52ZWxvcGUoKTtmb3IodmFyIGk9MCxsZW49dGhpcy5nZW9tZXRyaWVzLmxlbmd0aDtpPGxlbjtpKyspe3ZhciBnZW9tZXRyeT10aGlzLmdldEdlb21ldHJ5TihpKTtlbnZlbG9wZS5leHBhbmRUb0luY2x1ZGUoZ2VvbWV0cnkuZ2V0RW52ZWxvcGVJbnRlcm5hbCgpKTt9XG5yZXR1cm4gZW52ZWxvcGU7fTtqc3RzLmdlb20uR2VvbWV0cnlDb2xsZWN0aW9uLnByb3RvdHlwZS5DTEFTU19OQU1FPSdqc3RzLmdlb20uR2VvbWV0cnlDb2xsZWN0aW9uJzt9KSgpO2pzdHMuYWxnb3JpdGhtLkNlbnRyb2lkPWZ1bmN0aW9uKGdlb21ldHJ5KXt0aGlzLmFyZWFCYXNlUHQ9bnVsbDt0aGlzLnRyaWFuZ2xlQ2VudDM9bmV3IGpzdHMuZ2VvbS5Db29yZGluYXRlKCk7dGhpcy5hcmVhc3VtMj0wO3RoaXMuY2czPW5ldyBqc3RzLmdlb20uQ29vcmRpbmF0ZSgpO3RoaXMubGluZUNlbnRTdW09bmV3IGpzdHMuZ2VvbS5Db29yZGluYXRlKCk7dGhpcy50b3RhbExlbmd0aD0wO3RoaXMucHRDb3VudD0wO3RoaXMucHRDZW50U3VtPW5ldyBqc3RzLmdlb20uQ29vcmRpbmF0ZSgpO3RoaXMuYWRkKGdlb21ldHJ5KTt9O2pzdHMuYWxnb3JpdGhtLkNlbnRyb2lkLmdldENlbnRyb2lkPWZ1bmN0aW9uKGdlb21ldHJ5KXt2YXIgY2VudD1uZXcganN0cy5hbGdvcml0aG0uQ2VudHJvaWQoZ2VvbWV0cnkpO3JldHVybiBjZW50LmdldENlbnRyb2lkKCk7fTtqc3RzLmFsZ29yaXRobS5DZW50cm9pZC5jZW50cm9pZDM9ZnVuY3Rpb24ocDEscDIscDMsYyl7Yy54PXAxLngrcDIueCtwMy54O2MueT1wMS55K3AyLnkrcDMueTt9O2pzdHMuYWxnb3JpdGhtLkNlbnRyb2lkLmFyZWEyPWZ1bmN0aW9uKHAxLHAyLHAzKXtyZXR1cm4ocDIueC1wMS54KSoocDMueS1wMS55KS0ocDMueC1wMS54KSoocDIueS1wMS55KTt9O2pzdHMuYWxnb3JpdGhtLkNlbnRyb2lkLnByb3RvdHlwZS5hZGQ9ZnVuY3Rpb24oZ2VvbSl7aWYoZ2VvbS5pc0VtcHR5KCkpe3JldHVybjt9XG5pZihnZW9tIGluc3RhbmNlb2YganN0cy5nZW9tLlBvaW50KXt0aGlzLmFkZFBvaW50KGdlb20uZ2V0Q29vcmRpbmF0ZSgpKTt9ZWxzZSBpZihnZW9tIGluc3RhbmNlb2YganN0cy5nZW9tLkxpbmVTdHJpbmcpe3RoaXMuYWRkTGluZVNlZ21lbnRzKGdlb20uZ2V0Q29vcmRpbmF0ZXMoKSk7fWVsc2UgaWYoZ2VvbSBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5Qb2x5Z29uKXt0aGlzLmFkZFBvbHlnb24oZ2VvbSk7fWVsc2UgaWYoZ2VvbSBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5HZW9tZXRyeUNvbGxlY3Rpb24pe2Zvcih2YXIgaT0wO2k8Z2VvbS5nZXROdW1HZW9tZXRyaWVzKCk7aSsrKXt0aGlzLmFkZChnZW9tLmdldEdlb21ldHJ5TihpKSk7fX19O2pzdHMuYWxnb3JpdGhtLkNlbnRyb2lkLnByb3RvdHlwZS5nZXRDZW50cm9pZD1mdW5jdGlvbigpe3ZhciBjZW50PW5ldyBqc3RzLmdlb20uQ29vcmRpbmF0ZSgpO2lmKE1hdGguYWJzKHRoaXMuYXJlYXN1bTIpPjApe2NlbnQueD10aGlzLmNnMy54LzMvdGhpcy5hcmVhc3VtMjtjZW50Lnk9dGhpcy5jZzMueS8zL3RoaXMuYXJlYXN1bTI7fWVsc2UgaWYodGhpcy50b3RhbExlbmd0aD4wKXtjZW50Lng9dGhpcy5saW5lQ2VudFN1bS54L3RoaXMudG90YWxMZW5ndGg7Y2VudC55PXRoaXMubGluZUNlbnRTdW0ueS90aGlzLnRvdGFsTGVuZ3RoO31lbHNlIGlmKHRoaXMucHRDb3VudD4wKXtjZW50Lng9dGhpcy5wdENlbnRTdW0ueC90aGlzLnB0Q291bnQ7Y2VudC55PXRoaXMucHRDZW50U3VtLnkvdGhpcy5wdENvdW50O31lbHNle3JldHVybiBudWxsO31cbnJldHVybiBjZW50O307anN0cy5hbGdvcml0aG0uQ2VudHJvaWQucHJvdG90eXBlLnNldEJhc2VQb2ludD1mdW5jdGlvbihiYXNlUHQpe2lmKHRoaXMuYXJlYUJhc2VQdD09PW51bGwpe3RoaXMuYXJlYUJhc2VQdD1iYXNlUHQ7fX07anN0cy5hbGdvcml0aG0uQ2VudHJvaWQucHJvdG90eXBlLmFkZFBvbHlnb249ZnVuY3Rpb24ocG9seSl7dGhpcy5hZGRTaGVsbChwb2x5LmdldEV4dGVyaW9yUmluZygpLmdldENvb3JkaW5hdGVzKCkpO2Zvcih2YXIgaT0wO2k8cG9seS5nZXROdW1JbnRlcmlvclJpbmcoKTtpKyspe3RoaXMuYWRkSG9sZShwb2x5LmdldEludGVyaW9yUmluZ04oaSkuZ2V0Q29vcmRpbmF0ZXMoKSk7fX07anN0cy5hbGdvcml0aG0uQ2VudHJvaWQucHJvdG90eXBlLmFkZFNoZWxsPWZ1bmN0aW9uKHB0cyl7aWYocHRzLmxlbmd0aD4wKXt0aGlzLnNldEJhc2VQb2ludChwdHNbMF0pO31cbnZhciBpc1Bvc2l0aXZlQXJlYT0hanN0cy5hbGdvcml0aG0uQ0dBbGdvcml0aG1zLmlzQ0NXKHB0cyk7Zm9yKHZhciBpPTA7aTxwdHMubGVuZ3RoLTE7aSsrKXt0aGlzLmFkZFRyaWFuZ2xlKHRoaXMuYXJlYUJhc2VQdCxwdHNbaV0scHRzW2krMV0saXNQb3NpdGl2ZUFyZWEpO31cbnRoaXMuYWRkTGluZVNlZ21lbnRzKHB0cyk7fTtqc3RzLmFsZ29yaXRobS5DZW50cm9pZC5wcm90b3R5cGUuYWRkSG9sZT1mdW5jdGlvbihwdHMpe3ZhciBpc1Bvc2l0aXZlQXJlYT1qc3RzLmFsZ29yaXRobS5DR0FsZ29yaXRobXMuaXNDQ1cocHRzKTtmb3IodmFyIGk9MDtpPHB0cy5sZW5ndGgtMTtpKyspe3RoaXMuYWRkVHJpYW5nbGUodGhpcy5hcmVhQmFzZVB0LHB0c1tpXSxwdHNbaSsxXSxpc1Bvc2l0aXZlQXJlYSk7fVxudGhpcy5hZGRMaW5lU2VnbWVudHMocHRzKTt9O2pzdHMuYWxnb3JpdGhtLkNlbnRyb2lkLnByb3RvdHlwZS5hZGRUcmlhbmdsZT1mdW5jdGlvbihwMCxwMSxwMixpc1Bvc2l0aXZlQXJlYSl7dmFyIHNpZ249KGlzUG9zaXRpdmVBcmVhKT8xOi0xO2pzdHMuYWxnb3JpdGhtLkNlbnRyb2lkLmNlbnRyb2lkMyhwMCxwMSxwMix0aGlzLnRyaWFuZ2xlQ2VudDMpO3ZhciBhcmVhMj1qc3RzLmFsZ29yaXRobS5DZW50cm9pZC5hcmVhMihwMCxwMSxwMik7dGhpcy5jZzMueCs9c2lnbiphcmVhMip0aGlzLnRyaWFuZ2xlQ2VudDMueDt0aGlzLmNnMy55Kz1zaWduKmFyZWEyKnRoaXMudHJpYW5nbGVDZW50My55O3RoaXMuYXJlYXN1bTIrPXNpZ24qYXJlYTI7fTtqc3RzLmFsZ29yaXRobS5DZW50cm9pZC5wcm90b3R5cGUuYWRkTGluZVNlZ21lbnRzPWZ1bmN0aW9uKHB0cyl7dmFyIGxpbmVMZW49MDtmb3IodmFyIGk9MDtpPHB0cy5sZW5ndGgtMTtpKyspe3ZhciBzZWdtZW50TGVuPXB0c1tpXS5kaXN0YW5jZShwdHNbaSsxXSk7aWYoc2VnbWVudExlbj09PTApe2NvbnRpbnVlO31cbmxpbmVMZW4rPXNlZ21lbnRMZW47dmFyIG1pZHg9KHB0c1tpXS54K3B0c1tpKzFdLngpLzI7dGhpcy5saW5lQ2VudFN1bS54Kz1zZWdtZW50TGVuKm1pZHg7dmFyIG1pZHk9KHB0c1tpXS55K3B0c1tpKzFdLnkpLzI7dGhpcy5saW5lQ2VudFN1bS55Kz1zZWdtZW50TGVuKm1pZHk7fVxudGhpcy50b3RhbExlbmd0aCs9bGluZUxlbjtpZihsaW5lTGVuPT09MCYmcHRzLmxlbmd0aD4wKXt0aGlzLmFkZFBvaW50KHB0c1swXSk7fX07anN0cy5hbGdvcml0aG0uQ2VudHJvaWQucHJvdG90eXBlLmFkZFBvaW50PWZ1bmN0aW9uKHB0KXt0aGlzLnB0Q291bnQrPTE7dGhpcy5wdENlbnRTdW0ueCs9cHQueDt0aGlzLnB0Q2VudFN1bS55Kz1wdC55O307KGZ1bmN0aW9uKCl7dmFyIEVkZ2VSaW5nPWZ1bmN0aW9uKGZhY3Rvcnkpe3RoaXMuZGVMaXN0PW5ldyBqYXZhc2NyaXB0LnV0aWwuQXJyYXlMaXN0KCk7dGhpcy5mYWN0b3J5PWZhY3Rvcnk7fTtFZGdlUmluZy5maW5kRWRnZVJpbmdDb250YWluaW5nPWZ1bmN0aW9uKHRlc3RFcixzaGVsbExpc3Qpe3ZhciB0ZXN0UmluZz10ZXN0RXIuZ2V0UmluZygpO3ZhciB0ZXN0RW52PXRlc3RSaW5nLmdldEVudmVsb3BlSW50ZXJuYWwoKTt2YXIgdGVzdFB0PXRlc3RSaW5nLmdldENvb3JkaW5hdGVOKDApO3ZhciBtaW5TaGVsbD1udWxsO3ZhciBtaW5FbnY9bnVsbDtmb3IodmFyIGl0PXNoZWxsTGlzdC5pdGVyYXRvcigpO2l0Lmhhc05leHQoKTspe3ZhciB0cnlTaGVsbD1pdC5uZXh0KCk7dmFyIHRyeVJpbmc9dHJ5U2hlbGwuZ2V0UmluZygpO3ZhciB0cnlFbnY9dHJ5UmluZy5nZXRFbnZlbG9wZUludGVybmFsKCk7aWYobWluU2hlbGwhPW51bGwpXG5taW5FbnY9bWluU2hlbGwuZ2V0UmluZygpLmdldEVudmVsb3BlSW50ZXJuYWwoKTt2YXIgaXNDb250YWluZWQ9ZmFsc2U7aWYodHJ5RW52LmVxdWFscyh0ZXN0RW52KSlcbmNvbnRpbnVlO3Rlc3RQdD1qc3RzLmdlb20uQ29vcmRpbmF0ZUFycmF5cy5wdE5vdEluTGlzdCh0ZXN0UmluZy5nZXRDb29yZGluYXRlcygpLHRyeVJpbmcuZ2V0Q29vcmRpbmF0ZXMoKSk7aWYodHJ5RW52LmNvbnRhaW5zKHRlc3RFbnYpJiZqc3RzLmFsZ29yaXRobS5DR0FsZ29yaXRobXMuaXNQb2ludEluUmluZyh0ZXN0UHQsdHJ5UmluZy5nZXRDb29yZGluYXRlcygpKSlcbmlzQ29udGFpbmVkPXRydWU7aWYoaXNDb250YWluZWQpe2lmKG1pblNoZWxsPT1udWxsfHxtaW5FbnYuY29udGFpbnModHJ5RW52KSl7bWluU2hlbGw9dHJ5U2hlbGw7fX19XG5yZXR1cm4gbWluU2hlbGw7fTtFZGdlUmluZy5wdE5vdEluTGlzdD1mdW5jdGlvbih0ZXN0UHRzLHB0cyl7Zm9yKHZhciBpPTA7aTx0ZXN0UHRzLmxlbmd0aDtpKyspe3ZhciB0ZXN0UHQ9dGVzdFB0c1tpXTtpZighaXNJbkxpc3QodGVzdFB0LHB0cykpXG5yZXR1cm4gdGVzdFB0O31cbnJldHVybiBudWxsO307RWRnZVJpbmcuaXNJbkxpc3Q9ZnVuY3Rpb24ocHQscHRzKXtmb3IodmFyIGk9MDtpPHB0cy5sZW5ndGg7aSsrKXtpZihwdC5lcXVhbHMocHRzW2ldKSlcbnJldHVybiB0cnVlO31cbnJldHVybiBmYWxzZTt9XG5FZGdlUmluZy5wcm90b3R5cGUuZmFjdG9yeT1udWxsO0VkZ2VSaW5nLnByb3RvdHlwZS5kZUxpc3Q9bnVsbDtFZGdlUmluZy5wcm90b3R5cGUucmluZz1udWxsO0VkZ2VSaW5nLnByb3RvdHlwZS5yaW5nUHRzPW51bGw7RWRnZVJpbmcucHJvdG90eXBlLmhvbGVzPW51bGw7RWRnZVJpbmcucHJvdG90eXBlLmFkZD1mdW5jdGlvbihkZSl7dGhpcy5kZUxpc3QuYWRkKGRlKTt9O0VkZ2VSaW5nLnByb3RvdHlwZS5pc0hvbGU9ZnVuY3Rpb24oKXt2YXIgcmluZz10aGlzLmdldFJpbmcoKTtyZXR1cm4ganN0cy5hbGdvcml0aG0uQ0dBbGdvcml0aG1zLmlzQ0NXKHJpbmcuZ2V0Q29vcmRpbmF0ZXMoKSk7fTtFZGdlUmluZy5wcm90b3R5cGUuYWRkSG9sZT1mdW5jdGlvbihob2xlKXtpZih0aGlzLmhvbGVzPT1udWxsKVxudGhpcy5ob2xlcz1uZXcgamF2YXNjcmlwdC51dGlsLkFycmF5TGlzdCgpO3RoaXMuaG9sZXMuYWRkKGhvbGUpO307RWRnZVJpbmcucHJvdG90eXBlLmdldFBvbHlnb249ZnVuY3Rpb24oKXt2YXIgaG9sZUxSPW51bGw7aWYodGhpcy5ob2xlcyE9bnVsbCl7aG9sZUxSPVtdO2Zvcih2YXIgaT0wO2k8dGhpcy5ob2xlcy5zaXplKCk7aSsrKXtob2xlTFJbaV09dGhpcy5ob2xlcy5nZXQoaSk7fX1cbnZhciBwb2x5PXRoaXMuZmFjdG9yeS5jcmVhdGVQb2x5Z29uKHRoaXMucmluZyxob2xlTFIpO3JldHVybiBwb2x5O307RWRnZVJpbmcucHJvdG90eXBlLmlzVmFsaWQ9ZnVuY3Rpb24oKXt0aGlzLmdldENvb3JkaW5hdGVzKCk7aWYodGhpcy5yaW5nUHRzLmxlbmd0aDw9MylcbnJldHVybiBmYWxzZTt0aGlzLmdldFJpbmcoKTtyZXR1cm4gdGhpcy5yaW5nLmlzVmFsaWQoKTt9O0VkZ2VSaW5nLnByb3RvdHlwZS5nZXRDb29yZGluYXRlcz1mdW5jdGlvbigpe2lmKHRoaXMucmluZ1B0cz09bnVsbCl7dmFyIGNvb3JkTGlzdD1uZXcganN0cy5nZW9tLkNvb3JkaW5hdGVMaXN0KCk7Zm9yKHZhciBpPXRoaXMuZGVMaXN0Lml0ZXJhdG9yKCk7aS5oYXNOZXh0KCk7KXt2YXIgZGU9aS5uZXh0KCk7dmFyIGVkZ2U9ZGUuZ2V0RWRnZSgpO0VkZ2VSaW5nLmFkZEVkZ2UoZWRnZS5nZXRMaW5lKCkuZ2V0Q29vcmRpbmF0ZXMoKSxkZS5nZXRFZGdlRGlyZWN0aW9uKCksY29vcmRMaXN0KTt9XG50aGlzLnJpbmdQdHM9Y29vcmRMaXN0LnRvQ29vcmRpbmF0ZUFycmF5KCk7fVxucmV0dXJuIHRoaXMucmluZ1B0czt9O0VkZ2VSaW5nLnByb3RvdHlwZS5nZXRMaW5lU3RyaW5nPWZ1bmN0aW9uKCl7dGhpcy5nZXRDb29yZGluYXRlcygpO3JldHVybiB0aGlzLmZhY3RvcnkuY3JlYXRlTGluZVN0cmluZyh0aGlzLnJpbmdQdHMpO307RWRnZVJpbmcucHJvdG90eXBlLmdldFJpbmc9ZnVuY3Rpb24oKXtpZih0aGlzLnJpbmchPW51bGwpXG5yZXR1cm4gdGhpcy5yaW5nO3RoaXMuZ2V0Q29vcmRpbmF0ZXMoKTtpZih0aGlzLnJpbmdQdHMubGVuZ3RoPDMpXG5jb25zb2xlLmxvZyh0aGlzLnJpbmdQdHMpO3RyeXt0aGlzLnJpbmc9dGhpcy5mYWN0b3J5LmNyZWF0ZUxpbmVhclJpbmcodGhpcy5yaW5nUHRzKTt9Y2F0Y2goZXgpe2NvbnNvbGUubG9nKHRoaXMucmluZ1B0cyk7fVxucmV0dXJuIHRoaXMucmluZzt9O0VkZ2VSaW5nLmFkZEVkZ2U9ZnVuY3Rpb24oY29vcmRzLGlzRm9yd2FyZCxjb29yZExpc3Qpe2lmKGlzRm9yd2FyZCl7Zm9yKHZhciBpPTA7aTxjb29yZHMubGVuZ3RoO2krKyl7Y29vcmRMaXN0LmFkZChjb29yZHNbaV0sZmFsc2UpO319ZWxzZXtmb3IodmFyIGk9Y29vcmRzLmxlbmd0aC0xO2k+PTA7aS0tKXtjb29yZExpc3QuYWRkKGNvb3Jkc1tpXSxmYWxzZSk7fX19O2pzdHMub3BlcmF0aW9uLnBvbHlnb25pemUuRWRnZVJpbmc9RWRnZVJpbmc7fSkoKTsoZnVuY3Rpb24oKXt2YXIgR3JhcGhDb21wb25lbnQ9ZnVuY3Rpb24oKXt9O0dyYXBoQ29tcG9uZW50LnNldFZpc2l0ZWQ9ZnVuY3Rpb24oaSx2aXNpdGVkKXt3aGlsZShpLmhhc05leHQoKSl7dmFyIGNvbXA9aS5uZXh0KCk7Y29tcC5zZXRWaXNpdGVkKHZpc2l0ZWQpO319O0dyYXBoQ29tcG9uZW50LnNldE1hcmtlZD1mdW5jdGlvbihpLG1hcmtlZCl7d2hpbGUoaS5oYXNOZXh0KCkpe3ZhciBjb21wPWkubmV4dCgpO2NvbXAuc2V0TWFya2VkKG1hcmtlZCk7fX07R3JhcGhDb21wb25lbnQuZ2V0Q29tcG9uZW50V2l0aFZpc2l0ZWRTdGF0ZT1mdW5jdGlvbihpLHZpc2l0ZWRTdGF0ZSl7d2hpbGUoaS5oYXNOZXh0KCkpe3ZhciBjb21wPWkubmV4dCgpO2lmKGNvbXAuaXNWaXNpdGVkKCk9PXZpc2l0ZWRTdGF0ZSlcbnJldHVybiBjb21wO31cbnJldHVybiBudWxsO307R3JhcGhDb21wb25lbnQucHJvdG90eXBlLl9pc01hcmtlZD1mYWxzZTtHcmFwaENvbXBvbmVudC5wcm90b3R5cGUuX2lzVmlzaXRlZD1mYWxzZTtHcmFwaENvbXBvbmVudC5wcm90b3R5cGUuZGF0YTtHcmFwaENvbXBvbmVudC5wcm90b3R5cGUuaXNWaXNpdGVkPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2lzVmlzaXRlZDt9O0dyYXBoQ29tcG9uZW50LnByb3RvdHlwZS5zZXRWaXNpdGVkPWZ1bmN0aW9uKGlzVmlzaXRlZCl7dGhpcy5faXNWaXNpdGVkPWlzVmlzaXRlZDt9O0dyYXBoQ29tcG9uZW50LnByb3RvdHlwZS5pc01hcmtlZD1mdW5jdGlvbigpe3JldHVybiB0aGlzLl9pc01hcmtlZDt9O0dyYXBoQ29tcG9uZW50LnByb3RvdHlwZS5zZXRNYXJrZWQ9ZnVuY3Rpb24oaXNNYXJrZWQpe3RoaXMuX2lzTWFya2VkPWlzTWFya2VkO307R3JhcGhDb21wb25lbnQucHJvdG90eXBlLnNldENvbnRleHQ9ZnVuY3Rpb24oZGF0YSl7dGhpcy5kYXRhPWRhdGE7fTtHcmFwaENvbXBvbmVudC5wcm90b3R5cGUuZ2V0Q29udGV4dD1mdW5jdGlvbigpe3JldHVybiBkYXRhO307R3JhcGhDb21wb25lbnQucHJvdG90eXBlLnNldERhdGE9ZnVuY3Rpb24oZGF0YSl7dGhpcy5kYXRhPWRhdGE7fTtHcmFwaENvbXBvbmVudC5wcm90b3R5cGUuZ2V0RGF0YT1mdW5jdGlvbigpe3JldHVybiBkYXRhO307R3JhcGhDb21wb25lbnQucHJvdG90eXBlLmlzUmVtb3ZlZD1mdW5jdGlvbigpe3Rocm93IG5ldyBqc3RzLmVycm9yLkFic3RyYWN0TWV0aG9kSW52b2NhdGlvbkVycm9yKCk7fTtqc3RzLnBsYW5hcmdyYXBoLkdyYXBoQ29tcG9uZW50PUdyYXBoQ29tcG9uZW50O30pKCk7KGZ1bmN0aW9uKCl7dmFyIEdyYXBoQ29tcG9uZW50PWpzdHMucGxhbmFyZ3JhcGguR3JhcGhDb21wb25lbnQ7dmFyIEVkZ2U9ZnVuY3Rpb24oZGUwLGRlMSl7aWYoZGUwPT09dW5kZWZpbmVkKXtyZXR1cm47fVxudGhpcy5zZXREaXJlY3RlZEVkZ2VzKGRlMCxkZTEpO307RWRnZS5wcm90b3R5cGU9bmV3IEdyYXBoQ29tcG9uZW50KCk7RWRnZS5wcm90b3R5cGUuZGlyRWRnZT1udWxsO0VkZ2UucHJvdG90eXBlLnNldERpcmVjdGVkRWRnZXM9ZnVuY3Rpb24oZGUwLGRlMSl7dGhpcy5kaXJFZGdlPVtkZTAsZGUxXTtkZTAuc2V0RWRnZSh0aGlzKTtkZTEuc2V0RWRnZSh0aGlzKTtkZTAuc2V0U3ltKGRlMSk7ZGUxLnNldFN5bShkZTApO2RlMC5nZXRGcm9tTm9kZSgpLmFkZE91dEVkZ2UoZGUwKTtkZTEuZ2V0RnJvbU5vZGUoKS5hZGRPdXRFZGdlKGRlMSk7fTtFZGdlLnByb3RvdHlwZS5nZXREaXJFZGdlPWZ1bmN0aW9uKGkpe2lmKGkgaW5zdGFuY2VvZiBqc3RzLnBsYW5hcmdyYXBoLk5vZGUpe3RoaXMuZ2V0RGlyRWRnZTIoaSk7fVxucmV0dXJuIHRoaXMuZGlyRWRnZVtpXTt9O0VkZ2UucHJvdG90eXBlLmdldERpckVkZ2UyPWZ1bmN0aW9uKGZyb21Ob2RlKXtpZih0aGlzLmRpckVkZ2VbMF0uZ2V0RnJvbU5vZGUoKT09ZnJvbU5vZGUpXG5yZXR1cm4gdGhpcy5kaXJFZGdlWzBdO2lmKHRoaXMuZGlyRWRnZVsxXS5nZXRGcm9tTm9kZSgpPT1mcm9tTm9kZSlcbnJldHVybiB0aGlzLmRpckVkZ2VbMV07cmV0dXJuIG51bGw7fTtFZGdlLnByb3RvdHlwZS5nZXRPcHBvc2l0ZU5vZGU9ZnVuY3Rpb24obm9kZSl7aWYodGhpcy5kaXJFZGdlWzBdLmdldEZyb21Ob2RlKCk9PW5vZGUpXG5yZXR1cm4gdGhpcy5kaXJFZGdlWzBdLmdldFRvTm9kZSgpO2lmKHRoaXMuZGlyRWRnZVsxXS5nZXRGcm9tTm9kZSgpPT1ub2RlKVxucmV0dXJuIHRoaXMuZGlyRWRnZVsxXS5nZXRUb05vZGUoKTtyZXR1cm4gbnVsbDt9O0VkZ2UucHJvdG90eXBlLnJlbW92ZT1mdW5jdGlvbigpe3RoaXMuZGlyRWRnZT1udWxsO307RWRnZS5wcm90b3R5cGUuaXNSZW1vdmVkPWZ1bmN0aW9uKCl7cmV0dXJuIGRpckVkZ2U9PW51bGw7fTtqc3RzLnBsYW5hcmdyYXBoLkVkZ2U9RWRnZTt9KSgpO2pzdHMub3BlcmF0aW9uLnBvbHlnb25pemUuUG9seWdvbml6ZUVkZ2U9ZnVuY3Rpb24obGluZSl7dGhpcy5saW5lPWxpbmU7fTtqc3RzLm9wZXJhdGlvbi5wb2x5Z29uaXplLlBvbHlnb25pemVFZGdlLnByb3RvdHlwZT1uZXcganN0cy5wbGFuYXJncmFwaC5FZGdlKCk7anN0cy5vcGVyYXRpb24ucG9seWdvbml6ZS5Qb2x5Z29uaXplRWRnZS5wcm90b3R5cGUubGluZT1udWxsO2pzdHMub3BlcmF0aW9uLnBvbHlnb25pemUuUG9seWdvbml6ZUVkZ2UucHJvdG90eXBlLmdldExpbmU9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5saW5lO307KGZ1bmN0aW9uKCl7dmFyIEFycmF5TGlzdD1qYXZhc2NyaXB0LnV0aWwuQXJyYXlMaXN0O3ZhciBHcmFwaENvbXBvbmVudD1qc3RzLnBsYW5hcmdyYXBoLkdyYXBoQ29tcG9uZW50O3ZhciBEaXJlY3RlZEVkZ2U9ZnVuY3Rpb24oZnJvbSx0byxkaXJlY3Rpb25QdCxlZGdlRGlyZWN0aW9uKXtpZihmcm9tPT09dW5kZWZpbmVkKXtyZXR1cm47fVxudGhpcy5mcm9tPWZyb207dGhpcy50bz10bzt0aGlzLmVkZ2VEaXJlY3Rpb249ZWRnZURpcmVjdGlvbjt0aGlzLnAwPWZyb20uZ2V0Q29vcmRpbmF0ZSgpO3RoaXMucDE9ZGlyZWN0aW9uUHQ7dmFyIGR4PXRoaXMucDEueC10aGlzLnAwLng7dmFyIGR5PXRoaXMucDEueS10aGlzLnAwLnk7dGhpcy5xdWFkcmFudD1qc3RzLmdlb21ncmFwaC5RdWFkcmFudC5xdWFkcmFudChkeCxkeSk7dGhpcy5hbmdsZT1NYXRoLmF0YW4yKGR5LGR4KTt9O0RpcmVjdGVkRWRnZS5wcm90b3R5cGU9bmV3IEdyYXBoQ29tcG9uZW50KCk7RGlyZWN0ZWRFZGdlLnRvRWRnZXM9ZnVuY3Rpb24oZGlyRWRnZXMpe3ZhciBlZGdlcz1uZXcgQXJyYXlMaXN0KCk7Zm9yKHZhciBpPWRpckVkZ2VzLml0ZXJhdG9yKCk7aS5oYXNOZXh0KCk7KXtlZGdlcy5hZGQoKGkubmV4dCgpKS5wYXJlbnRFZGdlKTt9XG5yZXR1cm4gZWRnZXM7fTtEaXJlY3RlZEVkZ2UucHJvdG90eXBlLnBhcmVudEVkZ2U9bnVsbDtEaXJlY3RlZEVkZ2UucHJvdG90eXBlLmZyb209bnVsbDtEaXJlY3RlZEVkZ2UucHJvdG90eXBlLnRvPW51bGw7RGlyZWN0ZWRFZGdlLnByb3RvdHlwZS5wMD1udWxsO0RpcmVjdGVkRWRnZS5wcm90b3R5cGUucDE9bnVsbDtEaXJlY3RlZEVkZ2UucHJvdG90eXBlLnN5bT1udWxsO0RpcmVjdGVkRWRnZS5wcm90b3R5cGUuZWRnZURpcmVjdGlvbj1udWxsO0RpcmVjdGVkRWRnZS5wcm90b3R5cGUucXVhZHJhbnQ9bnVsbDtEaXJlY3RlZEVkZ2UucHJvdG90eXBlLmFuZ2xlPW51bGw7RGlyZWN0ZWRFZGdlLnByb3RvdHlwZS5nZXRFZGdlPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMucGFyZW50RWRnZTt9O0RpcmVjdGVkRWRnZS5wcm90b3R5cGUuc2V0RWRnZT1mdW5jdGlvbihwYXJlbnRFZGdlKXt0aGlzLnBhcmVudEVkZ2U9cGFyZW50RWRnZTt9O0RpcmVjdGVkRWRnZS5wcm90b3R5cGUuZ2V0UXVhZHJhbnQ9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5xdWFkcmFudDt9O0RpcmVjdGVkRWRnZS5wcm90b3R5cGUuZ2V0RGlyZWN0aW9uUHQ9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5wMTt9O0RpcmVjdGVkRWRnZS5wcm90b3R5cGUuZ2V0RWRnZURpcmVjdGlvbj1mdW5jdGlvbigpe3JldHVybiB0aGlzLmVkZ2VEaXJlY3Rpb247fTtEaXJlY3RlZEVkZ2UucHJvdG90eXBlLmdldEZyb21Ob2RlPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZnJvbTt9O0RpcmVjdGVkRWRnZS5wcm90b3R5cGUuZ2V0VG9Ob2RlPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMudG87fTtEaXJlY3RlZEVkZ2UucHJvdG90eXBlLmdldENvb3JkaW5hdGU9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5mcm9tLmdldENvb3JkaW5hdGUoKTt9O0RpcmVjdGVkRWRnZS5wcm90b3R5cGUuZ2V0QW5nbGU9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5hbmdsZTt9O0RpcmVjdGVkRWRnZS5wcm90b3R5cGUuZ2V0U3ltPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuc3ltO307RGlyZWN0ZWRFZGdlLnByb3RvdHlwZS5zZXRTeW09ZnVuY3Rpb24oc3ltKXt0aGlzLnN5bT1zeW07fTtEaXJlY3RlZEVkZ2UucHJvdG90eXBlLnJlbW92ZT1mdW5jdGlvbigpe3RoaXMuc3ltPW51bGw7dGhpcy5wYXJlbnRFZGdlPW51bGw7fTtEaXJlY3RlZEVkZ2UucHJvdG90eXBlLmlzUmVtb3ZlZD1mdW5jdGlvbigpe3JldHVybiB0aGlzLnBhcmVudEVkZ2U9PW51bGw7fTtEaXJlY3RlZEVkZ2UucHJvdG90eXBlLmNvbXBhcmVUbz1mdW5jdGlvbihvYmope3ZhciBkZT1vYmo7cmV0dXJuIHRoaXMuY29tcGFyZURpcmVjdGlvbihkZSk7fTtEaXJlY3RlZEVkZ2UucHJvdG90eXBlLmNvbXBhcmVEaXJlY3Rpb249ZnVuY3Rpb24oZSl7aWYodGhpcy5xdWFkcmFudD5lLnF1YWRyYW50KVxucmV0dXJuIDE7aWYodGhpcy5xdWFkcmFudDxlLnF1YWRyYW50KVxucmV0dXJuLTE7cmV0dXJuIGpzdHMuYWxnb3JpdGhtLkNHQWxnb3JpdGhtcy5jb21wdXRlT3JpZW50YXRpb24oZS5wMCxlLnAxLHRoaXMucDEpO307anN0cy5wbGFuYXJncmFwaC5EaXJlY3RlZEVkZ2U9RGlyZWN0ZWRFZGdlO30pKCk7KGZ1bmN0aW9uKCl7dmFyIERpcmVjdGVkRWRnZT1qc3RzLnBsYW5hcmdyYXBoLkRpcmVjdGVkRWRnZTt2YXIgUG9seWdvbml6ZURpcmVjdGVkRWRnZT1mdW5jdGlvbihmcm9tLHRvLGRpcmVjdGlvblB0LGVkZ2VEaXJlY3Rpb24pe0RpcmVjdGVkRWRnZS5hcHBseSh0aGlzLGFyZ3VtZW50cyk7fTtQb2x5Z29uaXplRGlyZWN0ZWRFZGdlLnByb3RvdHlwZT1uZXcgRGlyZWN0ZWRFZGdlKCk7UG9seWdvbml6ZURpcmVjdGVkRWRnZS5wcm90b3R5cGUuZWRnZVJpbmc9bnVsbDtQb2x5Z29uaXplRGlyZWN0ZWRFZGdlLnByb3RvdHlwZS5uZXh0PW51bGw7UG9seWdvbml6ZURpcmVjdGVkRWRnZS5wcm90b3R5cGUubGFiZWw9LTE7UG9seWdvbml6ZURpcmVjdGVkRWRnZS5wcm90b3R5cGUuZ2V0TGFiZWw9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5sYWJlbDt9O1BvbHlnb25pemVEaXJlY3RlZEVkZ2UucHJvdG90eXBlLnNldExhYmVsPWZ1bmN0aW9uKGxhYmVsKXt0aGlzLmxhYmVsPWxhYmVsO307UG9seWdvbml6ZURpcmVjdGVkRWRnZS5wcm90b3R5cGUuZ2V0TmV4dD1mdW5jdGlvbigpe3JldHVybiB0aGlzLm5leHQ7fTtQb2x5Z29uaXplRGlyZWN0ZWRFZGdlLnByb3RvdHlwZS5zZXROZXh0PWZ1bmN0aW9uKG5leHQpe3RoaXMubmV4dD1uZXh0O307UG9seWdvbml6ZURpcmVjdGVkRWRnZS5wcm90b3R5cGUuaXNJblJpbmc9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5lZGdlUmluZyE9bnVsbDt9O1BvbHlnb25pemVEaXJlY3RlZEVkZ2UucHJvdG90eXBlLnNldFJpbmc9ZnVuY3Rpb24oZWRnZVJpbmcpe3RoaXMuZWRnZVJpbmc9ZWRnZVJpbmc7fTtqc3RzLm9wZXJhdGlvbi5wb2x5Z29uaXplLlBvbHlnb25pemVEaXJlY3RlZEVkZ2U9UG9seWdvbml6ZURpcmVjdGVkRWRnZTt9KSgpOyhmdW5jdGlvbigpe3ZhciBBcnJheUxpc3Q9amF2YXNjcmlwdC51dGlsLkFycmF5TGlzdDt2YXIgRGlyZWN0ZWRFZGdlU3Rhcj1mdW5jdGlvbigpe3RoaXMub3V0RWRnZXM9bmV3IEFycmF5TGlzdCgpO307RGlyZWN0ZWRFZGdlU3Rhci5wcm90b3R5cGUub3V0RWRnZXM9bnVsbDtEaXJlY3RlZEVkZ2VTdGFyLnByb3RvdHlwZS5zb3J0ZWQ9ZmFsc2U7RGlyZWN0ZWRFZGdlU3Rhci5wcm90b3R5cGUuYWRkPWZ1bmN0aW9uKGRlKXt0aGlzLm91dEVkZ2VzLmFkZChkZSk7dGhpcy5zb3J0ZWQ9ZmFsc2U7fTtEaXJlY3RlZEVkZ2VTdGFyLnByb3RvdHlwZS5yZW1vdmU9ZnVuY3Rpb24oZGUpe3RoaXMub3V0RWRnZXMucmVtb3ZlKGRlKTt9O0RpcmVjdGVkRWRnZVN0YXIucHJvdG90eXBlLml0ZXJhdG9yPWZ1bmN0aW9uKCl7dGhpcy5zb3J0RWRnZXMoKTtyZXR1cm4gdGhpcy5vdXRFZGdlcy5pdGVyYXRvcigpO307RGlyZWN0ZWRFZGdlU3Rhci5wcm90b3R5cGUuZ2V0RGVncmVlPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMub3V0RWRnZXMuc2l6ZSgpO307RGlyZWN0ZWRFZGdlU3Rhci5wcm90b3R5cGUuZ2V0Q29vcmRpbmF0ZT1mdW5jdGlvbigpe3ZhciBpdD1pdGVyYXRvcigpO2lmKCFpdC5oYXNOZXh0KCkpXG5yZXR1cm4gbnVsbDt2YXIgZT1pdC5uZXh0KCk7cmV0dXJuIGUuZ2V0Q29vcmRpbmF0ZSgpO307RGlyZWN0ZWRFZGdlU3Rhci5wcm90b3R5cGUuZ2V0RWRnZXM9ZnVuY3Rpb24oKXt0aGlzLnNvcnRFZGdlcygpO3JldHVybiB0aGlzLm91dEVkZ2VzO307RGlyZWN0ZWRFZGdlU3Rhci5wcm90b3R5cGUuc29ydEVkZ2VzPWZ1bmN0aW9uKCl7aWYoIXRoaXMuc29ydGVkKXt2YXIgYXJyYXk9dGhpcy5vdXRFZGdlcy50b0FycmF5KCk7YXJyYXkuc29ydChmdW5jdGlvbihhLGIpe3JldHVybiBhLmNvbXBhcmVUbyhiKTt9KTt0aGlzLm91dEVkZ2VzPWphdmFzY3JpcHQudXRpbC5BcnJheXMuYXNMaXN0KGFycmF5KTt0aGlzLnNvcnRlZD10cnVlO319O0RpcmVjdGVkRWRnZVN0YXIucHJvdG90eXBlLmdldEluZGV4PWZ1bmN0aW9uKGVkZ2Upe2lmKGVkZ2UgaW5zdGFuY2VvZiBqc3RzLnBsYW5hcmdyYXBoLkRpcmVjdGVkRWRnZSl7cmV0dXJuIHRoaXMuZ2V0SW5kZXgyKGVkZ2UpO31lbHNlIGlmKHR5cGVvZihlZGdlKT09PSdudW1iZXInKXtyZXR1cm4gdGhpcy5nZXRJbmRleDMoZWRnZSk7fVxudGhpcy5zb3J0RWRnZXMoKTtmb3IodmFyIGk9MDtpPHRoaXMub3V0RWRnZXMuc2l6ZSgpO2krKyl7dmFyIGRlPXRoaXMub3V0RWRnZXMuZ2V0KGkpO2lmKGRlLmdldEVkZ2UoKT09ZWRnZSlcbnJldHVybiBpO31cbnJldHVybi0xO307RGlyZWN0ZWRFZGdlU3Rhci5wcm90b3R5cGUuZ2V0SW5kZXgyPWZ1bmN0aW9uKGRpckVkZ2Upe3RoaXMuc29ydEVkZ2VzKCk7Zm9yKHZhciBpPTA7aTx0aGlzLm91dEVkZ2VzLnNpemUoKTtpKyspe3ZhciBkZT10aGlzLm91dEVkZ2VzLmdldChpKTtpZihkZT09ZGlyRWRnZSlcbnJldHVybiBpO31cbnJldHVybi0xO307RGlyZWN0ZWRFZGdlU3Rhci5wcm90b3R5cGUuZ2V0SW5kZXgzPWZ1bmN0aW9uKGkpe3ZhciBtb2RpPXRvSW50KGkldGhpcy5vdXRFZGdlcy5zaXplKCkpO2lmKG1vZGk8MClcbm1vZGkrPXRoaXMub3V0RWRnZXMuc2l6ZSgpO3JldHVybiBtb2RpO307RGlyZWN0ZWRFZGdlU3Rhci5wcm90b3R5cGUuZ2V0TmV4dEVkZ2U9ZnVuY3Rpb24oZGlyRWRnZSl7dmFyIGk9dGhpcy5nZXRJbmRleChkaXJFZGdlKTtyZXR1cm4gdGhpcy5vdXRFZGdlcy5nZXQoZ2V0SW5kZXgoaSsxKSk7fTtEaXJlY3RlZEVkZ2VTdGFyLnByb3RvdHlwZS5nZXROZXh0Q1dFZGdlPWZ1bmN0aW9uKGRpckVkZ2Upe3ZhciBpPXRoaXMuZ2V0SW5kZXgoZGlyRWRnZSk7cmV0dXJuIHRoaXMub3V0RWRnZXMuZ2V0KGdldEluZGV4KGktMSkpO307anN0cy5wbGFuYXJncmFwaC5EaXJlY3RlZEVkZ2VTdGFyPURpcmVjdGVkRWRnZVN0YXI7fSkoKTsoZnVuY3Rpb24oKXt2YXIgR3JhcGhDb21wb25lbnQ9anN0cy5wbGFuYXJncmFwaC5HcmFwaENvbXBvbmVudDt2YXIgRGlyZWN0ZWRFZGdlU3Rhcj1qc3RzLnBsYW5hcmdyYXBoLkRpcmVjdGVkRWRnZVN0YXI7dmFyIE5vZGU9ZnVuY3Rpb24ocHQsZGVTdGFyKXt0aGlzLnB0PXB0O3RoaXMuZGVTdGFyPWRlU3Rhcnx8bmV3IERpcmVjdGVkRWRnZVN0YXIoKTt9O05vZGUucHJvdG90eXBlPW5ldyBHcmFwaENvbXBvbmVudCgpO05vZGUuZ2V0RWRnZXNCZXR3ZWVuPWZ1bmN0aW9uKG5vZGUwLG5vZGUxKXt2YXIgZWRnZXMwPURpcmVjdGVkRWRnZS50b0VkZ2VzKG5vZGUwLmdldE91dEVkZ2VzKCkuZ2V0RWRnZXMoKSk7dmFyIGNvbW1vbkVkZ2VzPW5ldyBqYXZhc2NyaXB0LnV0aWwuSGFzaFNldChlZGdlczApO3ZhciBlZGdlczE9RGlyZWN0ZWRFZGdlLnRvRWRnZXMobm9kZTEuZ2V0T3V0RWRnZXMoKS5nZXRFZGdlcygpKTtjb21tb25FZGdlcy5yZXRhaW5BbGwoZWRnZXMxKTtyZXR1cm4gY29tbW9uRWRnZXM7fTtOb2RlLnByb3RvdHlwZS5wdD1udWxsO05vZGUucHJvdG90eXBlLmRlU3Rhcj1udWxsO05vZGUucHJvdG90eXBlLmdldENvb3JkaW5hdGU9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5wdDt9O05vZGUucHJvdG90eXBlLmFkZE91dEVkZ2U9ZnVuY3Rpb24oZGUpe3RoaXMuZGVTdGFyLmFkZChkZSk7fTtOb2RlLnByb3RvdHlwZS5nZXRPdXRFZGdlcz1mdW5jdGlvbigpe3JldHVybiB0aGlzLmRlU3Rhcjt9O05vZGUucHJvdG90eXBlLmdldERlZ3JlZT1mdW5jdGlvbigpe3JldHVybiB0aGlzLmRlU3Rhci5nZXREZWdyZWUoKTt9O05vZGUucHJvdG90eXBlLmdldEluZGV4PWZ1bmN0aW9uKGVkZ2Upe3JldHVybiB0aGlzLmRlU3Rhci5nZXRJbmRleChlZGdlKTt9O05vZGUucHJvdG90eXBlLnJlbW92ZT1mdW5jdGlvbihkZSl7aWYoZGU9PT11bmRlZmluZWQpe3JldHVybiB0aGlzLnJlbW92ZTIoKTt9XG50aGlzLmRlU3Rhci5yZW1vdmUoZGUpO307Tm9kZS5wcm90b3R5cGUucmVtb3ZlMj1mdW5jdGlvbigpe3RoaXMucHQ9bnVsbDt9O05vZGUucHJvdG90eXBlLmlzUmVtb3ZlZD1mdW5jdGlvbigpe3JldHVybiB0aGlzLnB0PT1udWxsO307anN0cy5wbGFuYXJncmFwaC5Ob2RlPU5vZGU7fSkoKTsoZnVuY3Rpb24oKXt2YXIgTm9kZU1hcD1mdW5jdGlvbigpe3RoaXMubm9kZU1hcD1uZXcgamF2YXNjcmlwdC51dGlsLlRyZWVNYXAoKTt9O05vZGVNYXAucHJvdG90eXBlLm5vZGVNYXA9bnVsbDtOb2RlTWFwLnByb3RvdHlwZS5hZGQ9ZnVuY3Rpb24obil7dGhpcy5ub2RlTWFwLnB1dChuLmdldENvb3JkaW5hdGUoKSxuKTtyZXR1cm4gbjt9O05vZGVNYXAucHJvdG90eXBlLnJlbW92ZT1mdW5jdGlvbihwdCl7cmV0dXJuIHRoaXMubm9kZU1hcC5yZW1vdmUocHQpO307Tm9kZU1hcC5wcm90b3R5cGUuZmluZD1mdW5jdGlvbihjb29yZCl7cmV0dXJuIHRoaXMubm9kZU1hcC5nZXQoY29vcmQpO307Tm9kZU1hcC5wcm90b3R5cGUuaXRlcmF0b3I9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5ub2RlTWFwLnZhbHVlcygpLml0ZXJhdG9yKCk7fTtOb2RlTWFwLnByb3RvdHlwZS52YWx1ZXM9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5ub2RlTWFwLnZhbHVlcygpO307anN0cy5wbGFuYXJncmFwaC5Ob2RlTWFwPU5vZGVNYXA7fSkoKTsoZnVuY3Rpb24oKXt2YXIgQXJyYXlMaXN0PWphdmFzY3JpcHQudXRpbC5BcnJheUxpc3Q7dmFyIFBsYW5hckdyYXBoPWZ1bmN0aW9uKCl7dGhpcy5lZGdlcz1uZXcgamF2YXNjcmlwdC51dGlsLkhhc2hTZXQoKTt0aGlzLmRpckVkZ2VzPW5ldyBqYXZhc2NyaXB0LnV0aWwuSGFzaFNldCgpO3RoaXMubm9kZU1hcD1uZXcganN0cy5wbGFuYXJncmFwaC5Ob2RlTWFwKCk7fTtQbGFuYXJHcmFwaC5wcm90b3R5cGUuZWRnZXM9bnVsbDtQbGFuYXJHcmFwaC5wcm90b3R5cGUuZGlyRWRnZXM9bnVsbDtQbGFuYXJHcmFwaC5wcm90b3R5cGUubm9kZU1hcD1udWxsO1BsYW5hckdyYXBoLnByb3RvdHlwZS5maW5kTm9kZT1mdW5jdGlvbihwdCl7cmV0dXJuIHRoaXMubm9kZU1hcC5maW5kKHB0KTt9O1BsYW5hckdyYXBoLnByb3RvdHlwZS5hZGQ9ZnVuY3Rpb24obm9kZSl7aWYobm9kZSBpbnN0YW5jZW9mIGpzdHMucGxhbmFyZ3JhcGguRWRnZSl7cmV0dXJuIHRoaXMuYWRkMihub2RlKTt9ZWxzZSBpZihub2RlIGluc3RhbmNlb2YganN0cy5wbGFuYXJncmFwaC5EaXJlY3RlZEVkZ2Upe3JldHVybiB0aGlzLmFkZDMobm9kZSk7fVxudGhpcy5ub2RlTWFwLmFkZChub2RlKTt9O1BsYW5hckdyYXBoLnByb3RvdHlwZS5hZGQyPWZ1bmN0aW9uKGVkZ2Upe3RoaXMuZWRnZXMuYWRkKGVkZ2UpO3RoaXMuYWRkKGVkZ2UuZ2V0RGlyRWRnZSgwKSk7dGhpcy5hZGQoZWRnZS5nZXREaXJFZGdlKDEpKTt9O1BsYW5hckdyYXBoLnByb3RvdHlwZS5hZGQzPWZ1bmN0aW9uKGRpckVkZ2Upe3RoaXMuZGlyRWRnZXMuYWRkKGRpckVkZ2UpO307UGxhbmFyR3JhcGgucHJvdG90eXBlLm5vZGVJdGVyYXRvcj1mdW5jdGlvbigpe3JldHVybiB0aGlzLm5vZGVNYXAuaXRlcmF0b3IoKTt9O1BsYW5hckdyYXBoLnByb3RvdHlwZS5jb250YWlucz1mdW5jdGlvbihlKXtpZihlIGluc3RhbmNlb2YganN0cy5wbGFuYXJncmFwaC5EaXJlY3RlZEVkZ2Upe3JldHVybiB0aGlzLmNvbnRhaW5zMihlKTt9XG5yZXR1cm4gdGhpcy5lZGdlcy5jb250YWlucyhlKTt9O1BsYW5hckdyYXBoLnByb3RvdHlwZS5jb250YWluczI9ZnVuY3Rpb24oZGUpe3JldHVybiB0aGlzLmRpckVkZ2VzLmNvbnRhaW5zKGRlKTt9O1BsYW5hckdyYXBoLnByb3RvdHlwZS5nZXROb2Rlcz1mdW5jdGlvbigpe3JldHVybiB0aGlzLm5vZGVNYXAudmFsdWVzKCk7fTtQbGFuYXJHcmFwaC5wcm90b3R5cGUuZGlyRWRnZUl0ZXJhdG9yPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZGlyRWRnZXMuaXRlcmF0b3IoKTt9O1BsYW5hckdyYXBoLnByb3RvdHlwZS5lZGdlSXRlcmF0b3I9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5lZGdlcy5pdGVyYXRvcigpO307UGxhbmFyR3JhcGgucHJvdG90eXBlLmdldEVkZ2VzPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZWRnZXM7fTtQbGFuYXJHcmFwaC5wcm90b3R5cGUucmVtb3ZlPWZ1bmN0aW9uKGVkZ2Upe2lmKGVkZ2UgaW5zdGFuY2VvZiBqc3RzLnBsYW5hcmdyYXBoLkRpcmVjdGVkRWRnZSl7cmV0dXJuIHRoaXMucmVtb3ZlMihlZGdlKTt9XG50aGlzLnJlbW92ZShlZGdlLmdldERpckVkZ2UoMCkpO3RoaXMucmVtb3ZlKGVkZ2UuZ2V0RGlyRWRnZSgxKSk7dGhpcy5lZGdlcy5yZW1vdmUoZWRnZSk7dGhpcy5lZGdlLnJlbW92ZSgpO307UGxhbmFyR3JhcGgucHJvdG90eXBlLnJlbW92ZTI9ZnVuY3Rpb24oZGUpe2lmKGRlIGluc3RhbmNlb2YganN0cy5wbGFuYXJncmFwaC5Ob2RlKXtyZXR1cm4gdGhpcy5yZW1vdmUzKGRlKTt9XG52YXIgc3ltPWRlLmdldFN5bSgpO2lmKHN5bSE9bnVsbClcbnN5bS5zZXRTeW0obnVsbCk7ZGUuZ2V0RnJvbU5vZGUoKS5yZW1vdmUoZGUpO2RlLnJlbW92ZSgpO3RoaXMuZGlyRWRnZXMucmVtb3ZlKGRlKTt9O1BsYW5hckdyYXBoLnByb3RvdHlwZS5yZW1vdmUzPWZ1bmN0aW9uKG5vZGUpe3ZhciBvdXRFZGdlcz1ub2RlLmdldE91dEVkZ2VzKCkuZ2V0RWRnZXMoKTtmb3IodmFyIGk9b3V0RWRnZXMuaXRlcmF0b3IoKTtpLmhhc05leHQoKTspe3ZhciBkZT1pLm5leHQoKTt2YXIgc3ltPWRlLmdldFN5bSgpO2lmKHN5bSE9bnVsbClcbnRoaXMucmVtb3ZlKHN5bSk7dGhpcy5kaXJFZGdlcy5yZW1vdmUoZGUpO3ZhciBlZGdlPWRlLmdldEVkZ2UoKTtpZihlZGdlIT1udWxsKXt0aGlzLmVkZ2VzLnJlbW92ZShlZGdlKTt9fVxudGhpcy5ub2RlTWFwLnJlbW92ZShub2RlLmdldENvb3JkaW5hdGUoKSk7bm9kZS5yZW1vdmUoKTt9O1BsYW5hckdyYXBoLnByb3RvdHlwZS5maW5kTm9kZXNPZkRlZ3JlZT1mdW5jdGlvbihkZWdyZWUpe3ZhciBub2Rlc0ZvdW5kPW5ldyBBcnJheUxpc3QoKTtmb3IodmFyIGk9dGhpcy5ub2RlSXRlcmF0b3IoKTtpLmhhc05leHQoKTspe3ZhciBub2RlPWkubmV4dCgpO2lmKG5vZGUuZ2V0RGVncmVlKCk9PWRlZ3JlZSlcbm5vZGVzRm91bmQuYWRkKG5vZGUpO31cbnJldHVybiBub2Rlc0ZvdW5kO307anN0cy5wbGFuYXJncmFwaC5QbGFuYXJHcmFwaD1QbGFuYXJHcmFwaDt9KSgpOyhmdW5jdGlvbigpe3ZhciBBcnJheUxpc3Q9amF2YXNjcmlwdC51dGlsLkFycmF5TGlzdDt2YXIgU3RhY2s9amF2YXNjcmlwdC51dGlsLlN0YWNrO3ZhciBIYXNoU2V0PWphdmFzY3JpcHQudXRpbC5IYXNoU2V0O3ZhciBBc3NlcnQ9anN0cy51dGlsLkFzc2VydDt2YXIgRWRnZVJpbmc9anN0cy5vcGVyYXRpb24ucG9seWdvbml6ZS5FZGdlUmluZzt2YXIgUG9seWdvbml6ZUVkZ2U9anN0cy5vcGVyYXRpb24ucG9seWdvbml6ZS5Qb2x5Z29uaXplRWRnZTt2YXIgUG9seWdvbml6ZURpcmVjdGVkRWRnZT1qc3RzLm9wZXJhdGlvbi5wb2x5Z29uaXplLlBvbHlnb25pemVEaXJlY3RlZEVkZ2U7dmFyIFBsYW5hckdyYXBoPWpzdHMucGxhbmFyZ3JhcGguUGxhbmFyR3JhcGg7dmFyIE5vZGU9anN0cy5wbGFuYXJncmFwaC5Ob2RlO3ZhciBQb2x5Z29uaXplR3JhcGg9ZnVuY3Rpb24oZmFjdG9yeSl7UGxhbmFyR3JhcGguYXBwbHkodGhpcyk7dGhpcy5mYWN0b3J5PWZhY3Rvcnk7fTtQb2x5Z29uaXplR3JhcGgucHJvdG90eXBlPW5ldyBQbGFuYXJHcmFwaCgpO1BvbHlnb25pemVHcmFwaC5nZXREZWdyZWVOb25EZWxldGVkPWZ1bmN0aW9uKG5vZGUpe3ZhciBlZGdlcz1ub2RlLmdldE91dEVkZ2VzKCkuZ2V0RWRnZXMoKTt2YXIgZGVncmVlPTA7Zm9yKHZhciBpPWVkZ2VzLml0ZXJhdG9yKCk7aS5oYXNOZXh0KCk7KXt2YXIgZGU9aS5uZXh0KCk7aWYoIWRlLmlzTWFya2VkKCkpXG5kZWdyZWUrKzt9XG5yZXR1cm4gZGVncmVlO307UG9seWdvbml6ZUdyYXBoLmdldERlZ3JlZT1mdW5jdGlvbihub2RlLGxhYmVsKXt2YXIgZWRnZXM9bm9kZS5nZXRPdXRFZGdlcygpLmdldEVkZ2VzKCk7dmFyIGRlZ3JlZT0wO2Zvcih2YXIgaT1lZGdlcy5pdGVyYXRvcigpO2kuaGFzTmV4dCgpOyl7dmFyIGRlPWkubmV4dCgpO2lmKGRlLmdldExhYmVsKCk9PWxhYmVsKVxuZGVncmVlKys7fVxucmV0dXJuIGRlZ3JlZTt9O1BvbHlnb25pemVHcmFwaC5kZWxldGVBbGxFZGdlcz1mdW5jdGlvbihub2RlKXt2YXIgZWRnZXM9bm9kZS5nZXRPdXRFZGdlcygpLmdldEVkZ2VzKCk7Zm9yKHZhciBpPWVkZ2VzLml0ZXJhdG9yKCk7aS5oYXNOZXh0KCk7KXt2YXIgZGU9aS5uZXh0KCk7ZGUuc2V0TWFya2VkKHRydWUpO3ZhciBzeW09ZGUuZ2V0U3ltKCk7aWYoc3ltIT1udWxsKVxuc3ltLnNldE1hcmtlZCh0cnVlKTt9fTtQb2x5Z29uaXplR3JhcGgucHJvdG90eXBlLmZhY3Rvcnk9bnVsbDtQb2x5Z29uaXplR3JhcGgucHJvdG90eXBlLmFkZEVkZ2U9ZnVuY3Rpb24obGluZSl7aWYobGluZS5pc0VtcHR5KCkpe3JldHVybjt9XG52YXIgbGluZVB0cz1qc3RzLmdlb20uQ29vcmRpbmF0ZUFycmF5cy5yZW1vdmVSZXBlYXRlZFBvaW50cyhsaW5lLmdldENvb3JkaW5hdGVzKCkpO2lmKGxpbmVQdHMubGVuZ3RoPDIpe3JldHVybjt9XG52YXIgc3RhcnRQdD1saW5lUHRzWzBdO3ZhciBlbmRQdD1saW5lUHRzW2xpbmVQdHMubGVuZ3RoLTFdO3ZhciBuU3RhcnQ9dGhpcy5nZXROb2RlKHN0YXJ0UHQpO3ZhciBuRW5kPXRoaXMuZ2V0Tm9kZShlbmRQdCk7dmFyIGRlMD1uZXcgUG9seWdvbml6ZURpcmVjdGVkRWRnZShuU3RhcnQsbkVuZCxsaW5lUHRzWzFdLHRydWUpO3ZhciBkZTE9bmV3IFBvbHlnb25pemVEaXJlY3RlZEVkZ2UobkVuZCxuU3RhcnQsbGluZVB0c1tsaW5lUHRzLmxlbmd0aC0yXSxmYWxzZSk7dmFyIGVkZ2U9bmV3IFBvbHlnb25pemVFZGdlKGxpbmUpO2VkZ2Uuc2V0RGlyZWN0ZWRFZGdlcyhkZTAsZGUxKTt0aGlzLmFkZChlZGdlKTt9O1BvbHlnb25pemVHcmFwaC5wcm90b3R5cGUuZ2V0Tm9kZT1mdW5jdGlvbihwdCl7dmFyIG5vZGU9dGhpcy5maW5kTm9kZShwdCk7aWYobm9kZT09bnVsbCl7bm9kZT1uZXcgTm9kZShwdCk7dGhpcy5hZGQobm9kZSk7fVxucmV0dXJuIG5vZGU7fTtQb2x5Z29uaXplR3JhcGgucHJvdG90eXBlLmNvbXB1dGVOZXh0Q1dFZGdlcz1mdW5jdGlvbigpe2Zvcih2YXIgaU5vZGU9dGhpcy5ub2RlSXRlcmF0b3IoKTtpTm9kZS5oYXNOZXh0KCk7KXt2YXIgbm9kZT1pTm9kZS5uZXh0KCk7UG9seWdvbml6ZUdyYXBoLmNvbXB1dGVOZXh0Q1dFZGdlcyhub2RlKTt9fTtQb2x5Z29uaXplR3JhcGgucHJvdG90eXBlLmNvbnZlcnRNYXhpbWFsVG9NaW5pbWFsRWRnZVJpbmdzPWZ1bmN0aW9uKHJpbmdFZGdlcyl7Zm9yKHZhciBpPXJpbmdFZGdlcy5pdGVyYXRvcigpO2kuaGFzTmV4dCgpOyl7dmFyIGRlPWkubmV4dCgpO3ZhciBsYWJlbD1kZS5nZXRMYWJlbCgpO3ZhciBpbnROb2Rlcz1Qb2x5Z29uaXplR3JhcGguZmluZEludGVyc2VjdGlvbk5vZGVzKGRlLGxhYmVsKTtpZihpbnROb2Rlcz09bnVsbClcbmNvbnRpbnVlO2Zvcih2YXIgaU5vZGU9aW50Tm9kZXMuaXRlcmF0b3IoKTtpTm9kZS5oYXNOZXh0KCk7KXt2YXIgbm9kZT1pTm9kZS5uZXh0KCk7UG9seWdvbml6ZUdyYXBoLmNvbXB1dGVOZXh0Q0NXRWRnZXMobm9kZSxsYWJlbCk7fX19O1BvbHlnb25pemVHcmFwaC5maW5kSW50ZXJzZWN0aW9uTm9kZXM9ZnVuY3Rpb24oc3RhcnRERSxsYWJlbCl7dmFyIGRlPXN0YXJ0REU7dmFyIGludE5vZGVzPW51bGw7ZG97dmFyIG5vZGU9ZGUuZ2V0RnJvbU5vZGUoKTtpZihQb2x5Z29uaXplR3JhcGguZ2V0RGVncmVlKG5vZGUsbGFiZWwpPjEpe2lmKGludE5vZGVzPT1udWxsKVxuaW50Tm9kZXM9bmV3IEFycmF5TGlzdCgpO2ludE5vZGVzLmFkZChub2RlKTt9XG5kZT1kZS5nZXROZXh0KCk7QXNzZXJ0LmlzVHJ1ZShkZSE9bnVsbCwnZm91bmQgbnVsbCBERSBpbiByaW5nJyk7QXNzZXJ0LmlzVHJ1ZShkZT09c3RhcnRERXx8IWRlLmlzSW5SaW5nKCksJ2ZvdW5kIERFIGFscmVhZHkgaW4gcmluZycpO313aGlsZShkZSE9c3RhcnRERSk7cmV0dXJuIGludE5vZGVzO307UG9seWdvbml6ZUdyYXBoLnByb3RvdHlwZS5nZXRFZGdlUmluZ3M9ZnVuY3Rpb24oKXt0aGlzLmNvbXB1dGVOZXh0Q1dFZGdlcygpO1BvbHlnb25pemVHcmFwaC5sYWJlbCh0aGlzLmRpckVkZ2VzLC0xKTt2YXIgbWF4aW1hbFJpbmdzPVBvbHlnb25pemVHcmFwaC5maW5kTGFiZWxlZEVkZ2VSaW5ncyh0aGlzLmRpckVkZ2VzKTt0aGlzLmNvbnZlcnRNYXhpbWFsVG9NaW5pbWFsRWRnZVJpbmdzKG1heGltYWxSaW5ncyk7dmFyIGVkZ2VSaW5nTGlzdD1uZXcgQXJyYXlMaXN0KCk7Zm9yKHZhciBpPXRoaXMuZGlyRWRnZXMuaXRlcmF0b3IoKTtpLmhhc05leHQoKTspe3ZhciBkZT1pLm5leHQoKTtpZihkZS5pc01hcmtlZCgpKVxuY29udGludWU7aWYoZGUuaXNJblJpbmcoKSlcbmNvbnRpbnVlO3ZhciBlcj10aGlzLmZpbmRFZGdlUmluZyhkZSk7ZWRnZVJpbmdMaXN0LmFkZChlcik7fVxucmV0dXJuIGVkZ2VSaW5nTGlzdDt9O1BvbHlnb25pemVHcmFwaC5maW5kTGFiZWxlZEVkZ2VSaW5ncz1mdW5jdGlvbihkaXJFZGdlcyl7dmFyIGVkZ2VSaW5nU3RhcnRzPW5ldyBBcnJheUxpc3QoKTt2YXIgY3VyckxhYmVsPTE7Zm9yKHZhciBpPWRpckVkZ2VzLml0ZXJhdG9yKCk7aS5oYXNOZXh0KCk7KXt2YXIgZGU9aS5uZXh0KCk7aWYoZGUuaXNNYXJrZWQoKSlcbmNvbnRpbnVlO2lmKGRlLmdldExhYmVsKCk+PTApXG5jb250aW51ZTtlZGdlUmluZ1N0YXJ0cy5hZGQoZGUpO3ZhciBlZGdlcz1Qb2x5Z29uaXplR3JhcGguZmluZERpckVkZ2VzSW5SaW5nKGRlKTtQb2x5Z29uaXplR3JhcGgubGFiZWwoZWRnZXMsY3VyckxhYmVsKTtjdXJyTGFiZWwrKzt9XG5yZXR1cm4gZWRnZVJpbmdTdGFydHM7fTtQb2x5Z29uaXplR3JhcGgucHJvdG90eXBlLmRlbGV0ZUN1dEVkZ2VzPWZ1bmN0aW9uKCl7dGhpcy5jb21wdXRlTmV4dENXRWRnZXMoKTtQb2x5Z29uaXplR3JhcGguZmluZExhYmVsZWRFZGdlUmluZ3ModGhpcy5kaXJFZGdlcyk7dmFyIGN1dExpbmVzPW5ldyBBcnJheUxpc3QoKTtmb3IodmFyIGk9dGhpcy5kaXJFZGdlcy5pdGVyYXRvcigpO2kuaGFzTmV4dCgpOyl7dmFyIGRlPWkubmV4dCgpO2lmKGRlLmlzTWFya2VkKCkpXG5jb250aW51ZTt2YXIgc3ltPWRlLmdldFN5bSgpO2lmKGRlLmdldExhYmVsKCk9PXN5bS5nZXRMYWJlbCgpKXtkZS5zZXRNYXJrZWQodHJ1ZSk7c3ltLnNldE1hcmtlZCh0cnVlKTt2YXIgZT1kZS5nZXRFZGdlKCk7Y3V0TGluZXMuYWRkKGUuZ2V0TGluZSgpKTt9fVxucmV0dXJuIGN1dExpbmVzO307UG9seWdvbml6ZUdyYXBoLmxhYmVsPWZ1bmN0aW9uKGRpckVkZ2VzLGxhYmVsKXtmb3IodmFyIGk9ZGlyRWRnZXMuaXRlcmF0b3IoKTtpLmhhc05leHQoKTspe3ZhciBkZT1pLm5leHQoKTtkZS5zZXRMYWJlbChsYWJlbCk7fX07UG9seWdvbml6ZUdyYXBoLmNvbXB1dGVOZXh0Q1dFZGdlcz1mdW5jdGlvbihub2RlKXt2YXIgZGVTdGFyPW5vZGUuZ2V0T3V0RWRnZXMoKTt2YXIgc3RhcnRERT1udWxsO3ZhciBwcmV2REU9bnVsbDtmb3IodmFyIGk9ZGVTdGFyLmdldEVkZ2VzKCkuaXRlcmF0b3IoKTtpLmhhc05leHQoKTspe3ZhciBvdXRERT1pLm5leHQoKTtpZihvdXRERS5pc01hcmtlZCgpKVxuY29udGludWU7aWYoc3RhcnRERT09bnVsbClcbnN0YXJ0REU9b3V0REU7aWYocHJldkRFIT1udWxsKXt2YXIgc3ltPXByZXZERS5nZXRTeW0oKTtzeW0uc2V0TmV4dChvdXRERSk7fVxucHJldkRFPW91dERFO31cbmlmKHByZXZERSE9bnVsbCl7dmFyIHN5bT1wcmV2REUuZ2V0U3ltKCk7c3ltLnNldE5leHQoc3RhcnRERSk7fX07UG9seWdvbml6ZUdyYXBoLmNvbXB1dGVOZXh0Q0NXRWRnZXM9ZnVuY3Rpb24obm9kZSxsYWJlbCl7dmFyIGRlU3Rhcj1ub2RlLmdldE91dEVkZ2VzKCk7dmFyIGZpcnN0T3V0REU9bnVsbDt2YXIgcHJldkluREU9bnVsbDt2YXIgZWRnZXM9ZGVTdGFyLmdldEVkZ2VzKCk7Zm9yKHZhciBpPWVkZ2VzLnNpemUoKS0xO2k+PTA7aS0tKXt2YXIgZGU9ZWRnZXMuZ2V0KGkpO3ZhciBzeW09ZGUuZ2V0U3ltKCk7dmFyIG91dERFPW51bGw7aWYoZGUuZ2V0TGFiZWwoKT09bGFiZWwpXG5vdXRERT1kZTt2YXIgaW5ERT1udWxsO2lmKHN5bS5nZXRMYWJlbCgpPT1sYWJlbClcbmluREU9c3ltO2lmKG91dERFPT1udWxsJiZpbkRFPT1udWxsKVxuY29udGludWU7aWYoaW5ERSE9bnVsbCl7cHJldkluREU9aW5ERTt9XG5pZihvdXRERSE9bnVsbCl7aWYocHJldkluREUhPW51bGwpe3ByZXZJbkRFLnNldE5leHQob3V0REUpO3ByZXZJbkRFPW51bGw7fVxuaWYoZmlyc3RPdXRERT09bnVsbClcbmZpcnN0T3V0REU9b3V0REU7fX1cbmlmKHByZXZJbkRFIT1udWxsKXtBc3NlcnQuaXNUcnVlKGZpcnN0T3V0REUhPW51bGwpO3ByZXZJbkRFLnNldE5leHQoZmlyc3RPdXRERSk7fX07UG9seWdvbml6ZUdyYXBoLmZpbmREaXJFZGdlc0luUmluZz1mdW5jdGlvbihzdGFydERFKXt2YXIgZGU9c3RhcnRERTt2YXIgZWRnZXM9bmV3IEFycmF5TGlzdCgpO2Rve2VkZ2VzLmFkZChkZSk7ZGU9ZGUuZ2V0TmV4dCgpO0Fzc2VydC5pc1RydWUoZGUhPW51bGwsJ2ZvdW5kIG51bGwgREUgaW4gcmluZycpO0Fzc2VydC5pc1RydWUoZGU9PXN0YXJ0REV8fCFkZS5pc0luUmluZygpLCdmb3VuZCBERSBhbHJlYWR5IGluIHJpbmcnKTt9d2hpbGUoZGUhPXN0YXJ0REUpO3JldHVybiBlZGdlczt9O1BvbHlnb25pemVHcmFwaC5wcm90b3R5cGUuZmluZEVkZ2VSaW5nPWZ1bmN0aW9uKHN0YXJ0REUpe3ZhciBkZT1zdGFydERFO3ZhciBlcj1uZXcgRWRnZVJpbmcodGhpcy5mYWN0b3J5KTtkb3tlci5hZGQoZGUpO2RlLnNldFJpbmcoZXIpO2RlPWRlLmdldE5leHQoKTtBc3NlcnQuaXNUcnVlKGRlIT1udWxsLCdmb3VuZCBudWxsIERFIGluIHJpbmcnKTtBc3NlcnQuaXNUcnVlKGRlPT1zdGFydERFfHwhZGUuaXNJblJpbmcoKSwnZm91bmQgREUgYWxyZWFkeSBpbiByaW5nJyk7fXdoaWxlKGRlIT1zdGFydERFKTtyZXR1cm4gZXI7fTtQb2x5Z29uaXplR3JhcGgucHJvdG90eXBlLmRlbGV0ZURhbmdsZXM9ZnVuY3Rpb24oKXt2YXIgbm9kZXNUb1JlbW92ZT10aGlzLmZpbmROb2Rlc09mRGVncmVlKDEpO3ZhciBkYW5nbGVMaW5lcz1uZXcgSGFzaFNldCgpO3ZhciBub2RlU3RhY2s9bmV3IFN0YWNrKCk7Zm9yKHZhciBpPW5vZGVzVG9SZW1vdmUuaXRlcmF0b3IoKTtpLmhhc05leHQoKTspe25vZGVTdGFjay5wdXNoKGkubmV4dCgpKTt9XG53aGlsZSghbm9kZVN0YWNrLmlzRW1wdHkoKSl7dmFyIG5vZGU9bm9kZVN0YWNrLnBvcCgpO1BvbHlnb25pemVHcmFwaC5kZWxldGVBbGxFZGdlcyhub2RlKTt2YXIgbm9kZU91dEVkZ2VzPW5vZGUuZ2V0T3V0RWRnZXMoKS5nZXRFZGdlcygpO2Zvcih2YXIgaT1ub2RlT3V0RWRnZXMuaXRlcmF0b3IoKTtpLmhhc05leHQoKTspe3ZhciBkZT1pLm5leHQoKTtkZS5zZXRNYXJrZWQodHJ1ZSk7dmFyIHN5bT1kZS5nZXRTeW0oKTtpZihzeW0hPW51bGwpXG5zeW0uc2V0TWFya2VkKHRydWUpO3ZhciBlPWRlLmdldEVkZ2UoKTtkYW5nbGVMaW5lcy5hZGQoZS5nZXRMaW5lKCkpO3ZhciB0b05vZGU9ZGUuZ2V0VG9Ob2RlKCk7aWYoUG9seWdvbml6ZUdyYXBoLmdldERlZ3JlZU5vbkRlbGV0ZWQodG9Ob2RlKT09MSlcbm5vZGVTdGFjay5wdXNoKHRvTm9kZSk7fX1cbnJldHVybiBkYW5nbGVMaW5lczt9O1BvbHlnb25pemVHcmFwaC5wcm90b3R5cGUuY29tcHV0ZURlcHRoUGFyaXR5PWZ1bmN0aW9uKCl7d2hpbGUodHJ1ZSl7dmFyIGRlPW51bGw7aWYoZGU9PW51bGwpXG5yZXR1cm47dGhpcy5jb21wdXRlRGVwdGhQYXJpdHkoZGUpO319O1BvbHlnb25pemVHcmFwaC5wcm90b3R5cGUuY29tcHV0ZURlcHRoUGFyaXR5PWZ1bmN0aW9uKGRlKXt9O2pzdHMub3BlcmF0aW9uLnBvbHlnb25pemUuUG9seWdvbml6ZUdyYXBoPVBvbHlnb25pemVHcmFwaDt9KSgpO2pzdHMuaW5kZXguc3RydHJlZS5JbnRlcnZhbD1mdW5jdGlvbigpe3ZhciBvdGhlcjtpZihhcmd1bWVudHMubGVuZ3RoPT09MSl7b3RoZXI9YXJndW1lbnRzWzBdO3JldHVybiBqc3RzLmluZGV4LnN0cnRyZWUuSW50ZXJ2YWwob3RoZXIubWluLG90aGVyLm1heCk7fWVsc2UgaWYoYXJndW1lbnRzLmxlbmd0aD09PTIpe2pzdHMudXRpbC5Bc3NlcnQuaXNUcnVlKHRoaXMubWluPD10aGlzLm1heCk7dGhpcy5taW49YXJndW1lbnRzWzBdO3RoaXMubWF4PWFyZ3VtZW50c1sxXTt9fTtqc3RzLmluZGV4LnN0cnRyZWUuSW50ZXJ2YWwucHJvdG90eXBlLm1pbj1udWxsO2pzdHMuaW5kZXguc3RydHJlZS5JbnRlcnZhbC5wcm90b3R5cGUubWF4PW51bGw7anN0cy5pbmRleC5zdHJ0cmVlLkludGVydmFsLnByb3RvdHlwZS5nZXRDZW50cmU9ZnVuY3Rpb24oKXtyZXR1cm4odGhpcy5taW4rdGhpcy5tYXgpLzI7fTtqc3RzLmluZGV4LnN0cnRyZWUuSW50ZXJ2YWwucHJvdG90eXBlLmV4cGFuZFRvSW5jbHVkZT1mdW5jdGlvbihvdGhlcil7dGhpcy5tYXg9TWF0aC5tYXgodGhpcy5tYXgsb3RoZXIubWF4KTt0aGlzLm1pbj1NYXRoLm1pbih0aGlzLm1pbixvdGhlci5taW4pO3JldHVybiB0aGlzO307anN0cy5pbmRleC5zdHJ0cmVlLkludGVydmFsLnByb3RvdHlwZS5pbnRlcnNlY3RzPWZ1bmN0aW9uKG90aGVyKXtyZXR1cm4hKG90aGVyLm1pbj50aGlzLm1heHx8b3RoZXIubWF4PHRoaXMubWluKTt9O2pzdHMuaW5kZXguc3RydHJlZS5JbnRlcnZhbC5wcm90b3R5cGUuZXF1YWxzPWZ1bmN0aW9uKG8pe2lmKCEobyBpbnN0YW5jZW9mIGpzdHMuaW5kZXguc3RydHJlZS5JbnRlcnZhbCkpe3JldHVybiBmYWxzZTt9XG5vdGhlcj1vO3JldHVybiB0aGlzLm1pbj09PW90aGVyLm1pbiYmdGhpcy5tYXg9PT1vdGhlci5tYXg7fTtqc3RzLmdlb20uR2VvbWV0cnlGYWN0b3J5PWZ1bmN0aW9uKHByZWNpc2lvbk1vZGVsKXt0aGlzLnByZWNpc2lvbk1vZGVsPXByZWNpc2lvbk1vZGVsfHxuZXcganN0cy5nZW9tLlByZWNpc2lvbk1vZGVsKCk7fTtqc3RzLmdlb20uR2VvbWV0cnlGYWN0b3J5LnByb3RvdHlwZS5wcmVjaXNpb25Nb2RlbD1udWxsO2pzdHMuZ2VvbS5HZW9tZXRyeUZhY3RvcnkucHJvdG90eXBlLmdldFByZWNpc2lvbk1vZGVsPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMucHJlY2lzaW9uTW9kZWw7fTtqc3RzLmdlb20uR2VvbWV0cnlGYWN0b3J5LnByb3RvdHlwZS5jcmVhdGVQb2ludD1mdW5jdGlvbihjb29yZGluYXRlKXt2YXIgcG9pbnQ9bmV3IGpzdHMuZ2VvbS5Qb2ludChjb29yZGluYXRlLHRoaXMpO3JldHVybiBwb2ludDt9O2pzdHMuZ2VvbS5HZW9tZXRyeUZhY3RvcnkucHJvdG90eXBlLmNyZWF0ZUxpbmVTdHJpbmc9ZnVuY3Rpb24oY29vcmRpbmF0ZXMpe3ZhciBsaW5lU3RyaW5nPW5ldyBqc3RzLmdlb20uTGluZVN0cmluZyhjb29yZGluYXRlcyx0aGlzKTtyZXR1cm4gbGluZVN0cmluZzt9O2pzdHMuZ2VvbS5HZW9tZXRyeUZhY3RvcnkucHJvdG90eXBlLmNyZWF0ZUxpbmVhclJpbmc9ZnVuY3Rpb24oY29vcmRpbmF0ZXMpe3ZhciBsaW5lYXJSaW5nPW5ldyBqc3RzLmdlb20uTGluZWFyUmluZyhjb29yZGluYXRlcyx0aGlzKTtyZXR1cm4gbGluZWFyUmluZzt9O2pzdHMuZ2VvbS5HZW9tZXRyeUZhY3RvcnkucHJvdG90eXBlLmNyZWF0ZVBvbHlnb249ZnVuY3Rpb24oc2hlbGwsaG9sZXMpe3ZhciBwb2x5Z29uPW5ldyBqc3RzLmdlb20uUG9seWdvbihzaGVsbCxob2xlcyx0aGlzKTtyZXR1cm4gcG9seWdvbjt9O2pzdHMuZ2VvbS5HZW9tZXRyeUZhY3RvcnkucHJvdG90eXBlLmNyZWF0ZU11bHRpUG9pbnQ9ZnVuY3Rpb24ocG9pbnRzKXtpZihwb2ludHMmJnBvaW50c1swXWluc3RhbmNlb2YganN0cy5nZW9tLkNvb3JkaW5hdGUpe3ZhciBjb252ZXJ0ZWQ9W107dmFyIGk7Zm9yKGk9MDtpPHBvaW50cy5sZW5ndGg7aSsrKXtjb252ZXJ0ZWQucHVzaCh0aGlzLmNyZWF0ZVBvaW50KHBvaW50c1tpXSkpO31cbnBvaW50cz1jb252ZXJ0ZWQ7fVxucmV0dXJuIG5ldyBqc3RzLmdlb20uTXVsdGlQb2ludChwb2ludHMsdGhpcyk7fTtqc3RzLmdlb20uR2VvbWV0cnlGYWN0b3J5LnByb3RvdHlwZS5jcmVhdGVNdWx0aUxpbmVTdHJpbmc9ZnVuY3Rpb24obGluZVN0cmluZ3Mpe3JldHVybiBuZXcganN0cy5nZW9tLk11bHRpTGluZVN0cmluZyhsaW5lU3RyaW5ncyx0aGlzKTt9O2pzdHMuZ2VvbS5HZW9tZXRyeUZhY3RvcnkucHJvdG90eXBlLmNyZWF0ZU11bHRpUG9seWdvbj1mdW5jdGlvbihwb2x5Z29ucyl7cmV0dXJuIG5ldyBqc3RzLmdlb20uTXVsdGlQb2x5Z29uKHBvbHlnb25zLHRoaXMpO307anN0cy5nZW9tLkdlb21ldHJ5RmFjdG9yeS5wcm90b3R5cGUuYnVpbGRHZW9tZXRyeT1mdW5jdGlvbihnZW9tTGlzdCl7dmFyIGdlb21DbGFzcz1udWxsO3ZhciBpc0hldGVyb2dlbmVvdXM9ZmFsc2U7dmFyIGhhc0dlb21ldHJ5Q29sbGVjdGlvbj1mYWxzZTtmb3IodmFyIGk9Z2VvbUxpc3QuaXRlcmF0b3IoKTtpLmhhc05leHQoKTspe3ZhciBnZW9tPWkubmV4dCgpO3ZhciBwYXJ0Q2xhc3M9Z2VvbS5DTEFTU19OQU1FO2lmKGdlb21DbGFzcz09PW51bGwpe2dlb21DbGFzcz1wYXJ0Q2xhc3M7fVxuaWYoIShwYXJ0Q2xhc3M9PT1nZW9tQ2xhc3MpKXtpc0hldGVyb2dlbmVvdXM9dHJ1ZTt9XG5pZihnZW9tLmlzR2VvbWV0cnlDb2xsZWN0aW9uQmFzZSgpKVxuaGFzR2VvbWV0cnlDb2xsZWN0aW9uPXRydWU7fVxuaWYoZ2VvbUNsYXNzPT09bnVsbCl7cmV0dXJuIHRoaXMuY3JlYXRlR2VvbWV0cnlDb2xsZWN0aW9uKG51bGwpO31cbmlmKGlzSGV0ZXJvZ2VuZW91c3x8aGFzR2VvbWV0cnlDb2xsZWN0aW9uKXtyZXR1cm4gdGhpcy5jcmVhdGVHZW9tZXRyeUNvbGxlY3Rpb24oZ2VvbUxpc3QudG9BcnJheSgpKTt9XG52YXIgZ2VvbTA9Z2VvbUxpc3QuZ2V0KDApO3ZhciBpc0NvbGxlY3Rpb249Z2VvbUxpc3Quc2l6ZSgpPjE7aWYoaXNDb2xsZWN0aW9uKXtpZihnZW9tMCBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5Qb2x5Z29uKXtyZXR1cm4gdGhpcy5jcmVhdGVNdWx0aVBvbHlnb24oZ2VvbUxpc3QudG9BcnJheSgpKTt9ZWxzZSBpZihnZW9tMCBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5MaW5lU3RyaW5nKXtyZXR1cm4gdGhpcy5jcmVhdGVNdWx0aUxpbmVTdHJpbmcoZ2VvbUxpc3QudG9BcnJheSgpKTt9ZWxzZSBpZihnZW9tMCBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5Qb2ludCl7cmV0dXJuIHRoaXMuY3JlYXRlTXVsdGlQb2ludChnZW9tTGlzdC50b0FycmF5KCkpO31cbmpzdHMudXRpbC5Bc3NlcnQuc2hvdWxkTmV2ZXJSZWFjaEhlcmUoJ1VuaGFuZGxlZCBjbGFzczogJytnZW9tMCk7fVxucmV0dXJuIGdlb20wO307anN0cy5nZW9tLkdlb21ldHJ5RmFjdG9yeS5wcm90b3R5cGUuY3JlYXRlR2VvbWV0cnlDb2xsZWN0aW9uPWZ1bmN0aW9uKGdlb21ldHJpZXMpe3JldHVybiBuZXcganN0cy5nZW9tLkdlb21ldHJ5Q29sbGVjdGlvbihnZW9tZXRyaWVzLHRoaXMpO307anN0cy5nZW9tLkdlb21ldHJ5RmFjdG9yeS5wcm90b3R5cGUudG9HZW9tZXRyeT1mdW5jdGlvbihlbnZlbG9wZSl7aWYoZW52ZWxvcGUuaXNOdWxsKCkpe3JldHVybiB0aGlzLmNyZWF0ZVBvaW50KG51bGwpO31cbmlmKGVudmVsb3BlLmdldE1pblgoKT09PWVudmVsb3BlLmdldE1heFgoKSYmZW52ZWxvcGUuZ2V0TWluWSgpPT09ZW52ZWxvcGUuZ2V0TWF4WSgpKXtyZXR1cm4gdGhpcy5jcmVhdGVQb2ludChuZXcganN0cy5nZW9tLkNvb3JkaW5hdGUoZW52ZWxvcGUuZ2V0TWluWCgpLGVudmVsb3BlLmdldE1pblkoKSkpO31cbmlmKGVudmVsb3BlLmdldE1pblgoKT09PWVudmVsb3BlLmdldE1heFgoKXx8ZW52ZWxvcGUuZ2V0TWluWSgpPT09ZW52ZWxvcGUuZ2V0TWF4WSgpKXtyZXR1cm4gdGhpcy5jcmVhdGVMaW5lU3RyaW5nKFtuZXcganN0cy5nZW9tLkNvb3JkaW5hdGUoZW52ZWxvcGUuZ2V0TWluWCgpLGVudmVsb3BlLmdldE1pblkoKSksbmV3IGpzdHMuZ2VvbS5Db29yZGluYXRlKGVudmVsb3BlLmdldE1heFgoKSxlbnZlbG9wZS5nZXRNYXhZKCkpXSk7fVxucmV0dXJuIHRoaXMuY3JlYXRlUG9seWdvbih0aGlzLmNyZWF0ZUxpbmVhclJpbmcoW25ldyBqc3RzLmdlb20uQ29vcmRpbmF0ZShlbnZlbG9wZS5nZXRNaW5YKCksZW52ZWxvcGUuZ2V0TWluWSgpKSxuZXcganN0cy5nZW9tLkNvb3JkaW5hdGUoZW52ZWxvcGUuZ2V0TWluWCgpLGVudmVsb3BlLmdldE1heFkoKSksbmV3IGpzdHMuZ2VvbS5Db29yZGluYXRlKGVudmVsb3BlLmdldE1heFgoKSxlbnZlbG9wZS5nZXRNYXhZKCkpLG5ldyBqc3RzLmdlb20uQ29vcmRpbmF0ZShlbnZlbG9wZS5nZXRNYXhYKCksZW52ZWxvcGUuZ2V0TWluWSgpKSxuZXcganN0cy5nZW9tLkNvb3JkaW5hdGUoZW52ZWxvcGUuZ2V0TWluWCgpLGVudmVsb3BlLmdldE1pblkoKSldKSxudWxsKTt9O2pzdHMuZ2VvbWdyYXBoLk5vZGVGYWN0b3J5PWZ1bmN0aW9uKCl7fTtqc3RzLmdlb21ncmFwaC5Ob2RlRmFjdG9yeS5wcm90b3R5cGUuY3JlYXRlTm9kZT1mdW5jdGlvbihjb29yZCl7cmV0dXJuIG5ldyBqc3RzLmdlb21ncmFwaC5Ob2RlKGNvb3JkLG51bGwpO307KGZ1bmN0aW9uKCl7anN0cy5nZW9tZ3JhcGguUG9zaXRpb249ZnVuY3Rpb24oKXt9O2pzdHMuZ2VvbWdyYXBoLlBvc2l0aW9uLk9OPTA7anN0cy5nZW9tZ3JhcGguUG9zaXRpb24uTEVGVD0xO2pzdHMuZ2VvbWdyYXBoLlBvc2l0aW9uLlJJR0hUPTI7anN0cy5nZW9tZ3JhcGguUG9zaXRpb24ub3Bwb3NpdGU9ZnVuY3Rpb24ocG9zaXRpb24pe2lmKHBvc2l0aW9uPT09anN0cy5nZW9tZ3JhcGguUG9zaXRpb24uTEVGVCl7cmV0dXJuIGpzdHMuZ2VvbWdyYXBoLlBvc2l0aW9uLlJJR0hUO31cbmlmKHBvc2l0aW9uPT09anN0cy5nZW9tZ3JhcGguUG9zaXRpb24uUklHSFQpe3JldHVybiBqc3RzLmdlb21ncmFwaC5Qb3NpdGlvbi5MRUZUO31cbnJldHVybiBwb3NpdGlvbjt9O30pKCk7anN0cy5nZW9tZ3JhcGguVG9wb2xvZ3lMb2NhdGlvbj1mdW5jdGlvbigpe3RoaXMubG9jYXRpb249W107aWYoYXJndW1lbnRzLmxlbmd0aD09PTMpe3ZhciBvbj1hcmd1bWVudHNbMF07dmFyIGxlZnQ9YXJndW1lbnRzWzFdO3ZhciByaWdodD1hcmd1bWVudHNbMl07dGhpcy5pbml0KDMpO3RoaXMubG9jYXRpb25banN0cy5nZW9tZ3JhcGguUG9zaXRpb24uT05dPW9uO3RoaXMubG9jYXRpb25banN0cy5nZW9tZ3JhcGguUG9zaXRpb24uTEVGVF09bGVmdDt0aGlzLmxvY2F0aW9uW2pzdHMuZ2VvbWdyYXBoLlBvc2l0aW9uLlJJR0hUXT1yaWdodDt9ZWxzZSBpZihhcmd1bWVudHNbMF1pbnN0YW5jZW9mIGpzdHMuZ2VvbWdyYXBoLlRvcG9sb2d5TG9jYXRpb24pe3ZhciBnbD1hcmd1bWVudHNbMF07dGhpcy5pbml0KGdsLmxvY2F0aW9uLmxlbmd0aCk7aWYoZ2whPW51bGwpe2Zvcih2YXIgaT0wO2k8dGhpcy5sb2NhdGlvbi5sZW5ndGg7aSsrKXt0aGlzLmxvY2F0aW9uW2ldPWdsLmxvY2F0aW9uW2ldO319fWVsc2UgaWYodHlwZW9mIGFyZ3VtZW50c1swXT09PSdudW1iZXInKXt2YXIgb249YXJndW1lbnRzWzBdO3RoaXMuaW5pdCgxKTt0aGlzLmxvY2F0aW9uW2pzdHMuZ2VvbWdyYXBoLlBvc2l0aW9uLk9OXT1vbjt9ZWxzZSBpZihhcmd1bWVudHNbMF1pbnN0YW5jZW9mIEFycmF5KXt2YXIgbG9jYXRpb249YXJndW1lbnRzWzBdO3RoaXMuaW5pdChsb2NhdGlvbi5sZW5ndGgpO319O2pzdHMuZ2VvbWdyYXBoLlRvcG9sb2d5TG9jYXRpb24ucHJvdG90eXBlLmxvY2F0aW9uPW51bGw7anN0cy5nZW9tZ3JhcGguVG9wb2xvZ3lMb2NhdGlvbi5wcm90b3R5cGUuaW5pdD1mdW5jdGlvbihzaXplKXt0aGlzLmxvY2F0aW9uW3NpemUtMV09bnVsbDt0aGlzLnNldEFsbExvY2F0aW9ucyhqc3RzLmdlb20uTG9jYXRpb24uTk9ORSk7fTtqc3RzLmdlb21ncmFwaC5Ub3BvbG9neUxvY2F0aW9uLnByb3RvdHlwZS5nZXQ9ZnVuY3Rpb24ocG9zSW5kZXgpe2lmKHBvc0luZGV4PHRoaXMubG9jYXRpb24ubGVuZ3RoKVxucmV0dXJuIHRoaXMubG9jYXRpb25bcG9zSW5kZXhdO3JldHVybiBqc3RzLmdlb20uTG9jYXRpb24uTk9ORTt9O2pzdHMuZ2VvbWdyYXBoLlRvcG9sb2d5TG9jYXRpb24ucHJvdG90eXBlLmlzTnVsbD1mdW5jdGlvbigpe2Zvcih2YXIgaT0wO2k8dGhpcy5sb2NhdGlvbi5sZW5ndGg7aSsrKXtpZih0aGlzLmxvY2F0aW9uW2ldIT09anN0cy5nZW9tLkxvY2F0aW9uLk5PTkUpXG5yZXR1cm4gZmFsc2U7fVxucmV0dXJuIHRydWU7fTtqc3RzLmdlb21ncmFwaC5Ub3BvbG9neUxvY2F0aW9uLnByb3RvdHlwZS5pc0FueU51bGw9ZnVuY3Rpb24oKXtmb3IodmFyIGk9MDtpPHRoaXMubG9jYXRpb24ubGVuZ3RoO2krKyl7aWYodGhpcy5sb2NhdGlvbltpXT09PWpzdHMuZ2VvbS5Mb2NhdGlvbi5OT05FKVxucmV0dXJuIHRydWU7fVxucmV0dXJuIGZhbHNlO307anN0cy5nZW9tZ3JhcGguVG9wb2xvZ3lMb2NhdGlvbi5wcm90b3R5cGUuaXNFcXVhbE9uU2lkZT1mdW5jdGlvbihsZSxsb2NJbmRleCl7cmV0dXJuIHRoaXMubG9jYXRpb25bbG9jSW5kZXhdPT1sZS5sb2NhdGlvbltsb2NJbmRleF07fTtqc3RzLmdlb21ncmFwaC5Ub3BvbG9neUxvY2F0aW9uLnByb3RvdHlwZS5pc0FyZWE9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5sb2NhdGlvbi5sZW5ndGg+MTt9O2pzdHMuZ2VvbWdyYXBoLlRvcG9sb2d5TG9jYXRpb24ucHJvdG90eXBlLmlzTGluZT1mdW5jdGlvbigpe3JldHVybiB0aGlzLmxvY2F0aW9uLmxlbmd0aD09PTE7fTtqc3RzLmdlb21ncmFwaC5Ub3BvbG9neUxvY2F0aW9uLnByb3RvdHlwZS5mbGlwPWZ1bmN0aW9uKCl7aWYodGhpcy5sb2NhdGlvbi5sZW5ndGg8PTEpXG5yZXR1cm47dmFyIHRlbXA9dGhpcy5sb2NhdGlvbltqc3RzLmdlb21ncmFwaC5Qb3NpdGlvbi5MRUZUXTt0aGlzLmxvY2F0aW9uW2pzdHMuZ2VvbWdyYXBoLlBvc2l0aW9uLkxFRlRdPXRoaXMubG9jYXRpb25banN0cy5nZW9tZ3JhcGguUG9zaXRpb24uUklHSFRdO3RoaXMubG9jYXRpb25banN0cy5nZW9tZ3JhcGguUG9zaXRpb24uUklHSFRdPXRlbXA7fTtqc3RzLmdlb21ncmFwaC5Ub3BvbG9neUxvY2F0aW9uLnByb3RvdHlwZS5zZXRBbGxMb2NhdGlvbnM9ZnVuY3Rpb24obG9jVmFsdWUpe2Zvcih2YXIgaT0wO2k8dGhpcy5sb2NhdGlvbi5sZW5ndGg7aSsrKXt0aGlzLmxvY2F0aW9uW2ldPWxvY1ZhbHVlO319O2pzdHMuZ2VvbWdyYXBoLlRvcG9sb2d5TG9jYXRpb24ucHJvdG90eXBlLnNldEFsbExvY2F0aW9uc0lmTnVsbD1mdW5jdGlvbihsb2NWYWx1ZSl7Zm9yKHZhciBpPTA7aTx0aGlzLmxvY2F0aW9uLmxlbmd0aDtpKyspe2lmKHRoaXMubG9jYXRpb25baV09PT1qc3RzLmdlb20uTG9jYXRpb24uTk9ORSlcbnRoaXMubG9jYXRpb25baV09bG9jVmFsdWU7fX07anN0cy5nZW9tZ3JhcGguVG9wb2xvZ3lMb2NhdGlvbi5wcm90b3R5cGUuc2V0TG9jYXRpb249ZnVuY3Rpb24obG9jSW5kZXgsbG9jVmFsdWUpe2lmKGxvY1ZhbHVlIT09dW5kZWZpbmVkKXt0aGlzLmxvY2F0aW9uW2xvY0luZGV4XT1sb2NWYWx1ZTt9ZWxzZXt0aGlzLnNldExvY2F0aW9uKGpzdHMuZ2VvbWdyYXBoLlBvc2l0aW9uLk9OLGxvY0luZGV4KTt9fTtqc3RzLmdlb21ncmFwaC5Ub3BvbG9neUxvY2F0aW9uLnByb3RvdHlwZS5nZXRMb2NhdGlvbnM9ZnVuY3Rpb24oKXtyZXR1cm4gbG9jYXRpb247fTtqc3RzLmdlb21ncmFwaC5Ub3BvbG9neUxvY2F0aW9uLnByb3RvdHlwZS5zZXRMb2NhdGlvbnM9ZnVuY3Rpb24ob24sbGVmdCxyaWdodCl7dGhpcy5sb2NhdGlvbltqc3RzLmdlb21ncmFwaC5Qb3NpdGlvbi5PTl09b247dGhpcy5sb2NhdGlvbltqc3RzLmdlb21ncmFwaC5Qb3NpdGlvbi5MRUZUXT1sZWZ0O3RoaXMubG9jYXRpb25banN0cy5nZW9tZ3JhcGguUG9zaXRpb24uUklHSFRdPXJpZ2h0O307anN0cy5nZW9tZ3JhcGguVG9wb2xvZ3lMb2NhdGlvbi5wcm90b3R5cGUuYWxsUG9zaXRpb25zRXF1YWw9ZnVuY3Rpb24obG9jKXtmb3IodmFyIGk9MDtpPHRoaXMubG9jYXRpb24ubGVuZ3RoO2krKyl7aWYodGhpcy5sb2NhdGlvbltpXSE9PWxvYylcbnJldHVybiBmYWxzZTt9XG5yZXR1cm4gdHJ1ZTt9O2pzdHMuZ2VvbWdyYXBoLlRvcG9sb2d5TG9jYXRpb24ucHJvdG90eXBlLm1lcmdlPWZ1bmN0aW9uKGdsKXtpZihnbC5sb2NhdGlvbi5sZW5ndGg+dGhpcy5sb2NhdGlvbi5sZW5ndGgpe3ZhciBuZXdMb2M9W107bmV3TG9jW2pzdHMuZ2VvbWdyYXBoLlBvc2l0aW9uLk9OXT10aGlzLmxvY2F0aW9uW2pzdHMuZ2VvbWdyYXBoLlBvc2l0aW9uLk9OXTtuZXdMb2NbanN0cy5nZW9tZ3JhcGguUG9zaXRpb24uTEVGVF09anN0cy5nZW9tLkxvY2F0aW9uLk5PTkU7bmV3TG9jW2pzdHMuZ2VvbWdyYXBoLlBvc2l0aW9uLlJJR0hUXT1qc3RzLmdlb20uTG9jYXRpb24uTk9ORTt0aGlzLmxvY2F0aW9uPW5ld0xvYzt9XG5mb3IodmFyIGk9MDtpPHRoaXMubG9jYXRpb24ubGVuZ3RoO2krKyl7aWYodGhpcy5sb2NhdGlvbltpXT09PWpzdHMuZ2VvbS5Mb2NhdGlvbi5OT05FJiZpPGdsLmxvY2F0aW9uLmxlbmd0aClcbnRoaXMubG9jYXRpb25baV09Z2wubG9jYXRpb25baV07fX07anN0cy5nZW9tZ3JhcGguTGFiZWw9ZnVuY3Rpb24oKXt0aGlzLmVsdD1bXTt2YXIgZ2VvbUluZGV4LG9uTG9jLGxlZnRMb2MsbGJsLHJpZ2h0TG9jO2lmKGFyZ3VtZW50cy5sZW5ndGg9PT00KXtnZW9tSW5kZXg9YXJndW1lbnRzWzBdO29uTG9jPWFyZ3VtZW50c1sxXTtsZWZ0TG9jPWFyZ3VtZW50c1syXTtyaWdodExvYz1hcmd1bWVudHNbM107dGhpcy5lbHRbMF09bmV3IGpzdHMuZ2VvbWdyYXBoLlRvcG9sb2d5TG9jYXRpb24oanN0cy5nZW9tLkxvY2F0aW9uLk5PTkUsanN0cy5nZW9tLkxvY2F0aW9uLk5PTkUsanN0cy5nZW9tLkxvY2F0aW9uLk5PTkUpO3RoaXMuZWx0WzFdPW5ldyBqc3RzLmdlb21ncmFwaC5Ub3BvbG9neUxvY2F0aW9uKGpzdHMuZ2VvbS5Mb2NhdGlvbi5OT05FLGpzdHMuZ2VvbS5Mb2NhdGlvbi5OT05FLGpzdHMuZ2VvbS5Mb2NhdGlvbi5OT05FKTt0aGlzLmVsdFtnZW9tSW5kZXhdLnNldExvY2F0aW9ucyhvbkxvYyxsZWZ0TG9jLHJpZ2h0TG9jKTt9ZWxzZSBpZihhcmd1bWVudHMubGVuZ3RoPT09Myl7b25Mb2M9YXJndW1lbnRzWzBdO2xlZnRMb2M9YXJndW1lbnRzWzFdO3JpZ2h0TG9jPWFyZ3VtZW50c1syXTt0aGlzLmVsdFswXT1uZXcganN0cy5nZW9tZ3JhcGguVG9wb2xvZ3lMb2NhdGlvbihvbkxvYyxsZWZ0TG9jLHJpZ2h0TG9jKTt0aGlzLmVsdFsxXT1uZXcganN0cy5nZW9tZ3JhcGguVG9wb2xvZ3lMb2NhdGlvbihvbkxvYyxsZWZ0TG9jLHJpZ2h0TG9jKTt9ZWxzZSBpZihhcmd1bWVudHMubGVuZ3RoPT09Mil7Z2VvbUluZGV4PWFyZ3VtZW50c1swXTtvbkxvYz1hcmd1bWVudHNbMV07dGhpcy5lbHRbMF09bmV3IGpzdHMuZ2VvbWdyYXBoLlRvcG9sb2d5TG9jYXRpb24oanN0cy5nZW9tLkxvY2F0aW9uLk5PTkUpO3RoaXMuZWx0WzFdPW5ldyBqc3RzLmdlb21ncmFwaC5Ub3BvbG9neUxvY2F0aW9uKGpzdHMuZ2VvbS5Mb2NhdGlvbi5OT05FKTt0aGlzLmVsdFtnZW9tSW5kZXhdLnNldExvY2F0aW9uKG9uTG9jKTt9ZWxzZSBpZihhcmd1bWVudHNbMF1pbnN0YW5jZW9mIGpzdHMuZ2VvbWdyYXBoLkxhYmVsKXtsYmw9YXJndW1lbnRzWzBdO3RoaXMuZWx0WzBdPW5ldyBqc3RzLmdlb21ncmFwaC5Ub3BvbG9neUxvY2F0aW9uKGxibC5lbHRbMF0pO3RoaXMuZWx0WzFdPW5ldyBqc3RzLmdlb21ncmFwaC5Ub3BvbG9neUxvY2F0aW9uKGxibC5lbHRbMV0pO31lbHNlIGlmKHR5cGVvZiBhcmd1bWVudHNbMF09PT0nbnVtYmVyJyl7b25Mb2M9YXJndW1lbnRzWzBdO3RoaXMuZWx0WzBdPW5ldyBqc3RzLmdlb21ncmFwaC5Ub3BvbG9neUxvY2F0aW9uKG9uTG9jKTt0aGlzLmVsdFsxXT1uZXcganN0cy5nZW9tZ3JhcGguVG9wb2xvZ3lMb2NhdGlvbihvbkxvYyk7fX07anN0cy5nZW9tZ3JhcGguTGFiZWwudG9MaW5lTGFiZWw9ZnVuY3Rpb24obGFiZWwpe3ZhciBpLGxpbmVMYWJlbD1uZXcganN0cy5nZW9tZ3JhcGguTGFiZWwoanN0cy5nZW9tLkxvY2F0aW9uLk5PTkUpO2ZvcihpPTA7aTwyO2krKyl7bGluZUxhYmVsLnNldExvY2F0aW9uKGksbGFiZWwuZ2V0TG9jYXRpb24oaSkpO31cbnJldHVybiBsaW5lTGFiZWw7fTtqc3RzLmdlb21ncmFwaC5MYWJlbC5wcm90b3R5cGUuZWx0PW51bGw7anN0cy5nZW9tZ3JhcGguTGFiZWwucHJvdG90eXBlLmZsaXA9ZnVuY3Rpb24oKXt0aGlzLmVsdFswXS5mbGlwKCk7dGhpcy5lbHRbMV0uZmxpcCgpO307anN0cy5nZW9tZ3JhcGguTGFiZWwucHJvdG90eXBlLmdldExvY2F0aW9uPWZ1bmN0aW9uKGdlb21JbmRleCxwb3NJbmRleCl7aWYoYXJndW1lbnRzLmxlbmd0aD09MSl7cmV0dXJuIHRoaXMuZ2V0TG9jYXRpb24yLmFwcGx5KHRoaXMsYXJndW1lbnRzKTt9XG5yZXR1cm4gdGhpcy5lbHRbZ2VvbUluZGV4XS5nZXQocG9zSW5kZXgpO307anN0cy5nZW9tZ3JhcGguTGFiZWwucHJvdG90eXBlLmdldExvY2F0aW9uMj1mdW5jdGlvbihnZW9tSW5kZXgpe3JldHVybiB0aGlzLmVsdFtnZW9tSW5kZXhdLmdldChqc3RzLmdlb21ncmFwaC5Qb3NpdGlvbi5PTik7fTtqc3RzLmdlb21ncmFwaC5MYWJlbC5wcm90b3R5cGUuc2V0TG9jYXRpb249ZnVuY3Rpb24oZ2VvbUluZGV4LHBvc0luZGV4LGxvY2F0aW9uKXtpZihhcmd1bWVudHMubGVuZ3RoPT0yKXt0aGlzLnNldExvY2F0aW9uMi5hcHBseSh0aGlzLGFyZ3VtZW50cyk7cmV0dXJuO31cbnRoaXMuZWx0W2dlb21JbmRleF0uc2V0TG9jYXRpb24ocG9zSW5kZXgsbG9jYXRpb24pO307anN0cy5nZW9tZ3JhcGguTGFiZWwucHJvdG90eXBlLnNldExvY2F0aW9uMj1mdW5jdGlvbihnZW9tSW5kZXgsbG9jYXRpb24pe3RoaXMuZWx0W2dlb21JbmRleF0uc2V0TG9jYXRpb24oanN0cy5nZW9tZ3JhcGguUG9zaXRpb24uT04sbG9jYXRpb24pO307anN0cy5nZW9tZ3JhcGguTGFiZWwucHJvdG90eXBlLnNldEFsbExvY2F0aW9ucz1mdW5jdGlvbihnZW9tSW5kZXgsbG9jYXRpb24pe3RoaXMuZWx0W2dlb21JbmRleF0uc2V0QWxsTG9jYXRpb25zKGxvY2F0aW9uKTt9O2pzdHMuZ2VvbWdyYXBoLkxhYmVsLnByb3RvdHlwZS5zZXRBbGxMb2NhdGlvbnNJZk51bGw9ZnVuY3Rpb24oZ2VvbUluZGV4LGxvY2F0aW9uKXtpZihhcmd1bWVudHMubGVuZ3RoPT0xKXt0aGlzLnNldEFsbExvY2F0aW9uc0lmTnVsbDIuYXBwbHkodGhpcyxhcmd1bWVudHMpO3JldHVybjt9XG50aGlzLmVsdFtnZW9tSW5kZXhdLnNldEFsbExvY2F0aW9uc0lmTnVsbChsb2NhdGlvbik7fTtqc3RzLmdlb21ncmFwaC5MYWJlbC5wcm90b3R5cGUuc2V0QWxsTG9jYXRpb25zSWZOdWxsMj1mdW5jdGlvbihsb2NhdGlvbil7dGhpcy5zZXRBbGxMb2NhdGlvbnNJZk51bGwoMCxsb2NhdGlvbik7dGhpcy5zZXRBbGxMb2NhdGlvbnNJZk51bGwoMSxsb2NhdGlvbik7fTtqc3RzLmdlb21ncmFwaC5MYWJlbC5wcm90b3R5cGUubWVyZ2U9ZnVuY3Rpb24obGJsKXt2YXIgaTtmb3IoaT0wO2k8MjtpKyspe2lmKHRoaXMuZWx0W2ldPT09bnVsbCYmbGJsLmVsdFtpXSE9PW51bGwpe3RoaXMuZWx0W2ldPW5ldyBqc3RzLmdlb21ncmFwaC5Ub3BvbG9neUxvY2F0aW9uKGxibC5lbHRbaV0pO31lbHNle3RoaXMuZWx0W2ldLm1lcmdlKGxibC5lbHRbaV0pO319fTtqc3RzLmdlb21ncmFwaC5MYWJlbC5wcm90b3R5cGUuZ2V0R2VvbWV0cnlDb3VudD1mdW5jdGlvbigpe3ZhciBjb3VudD0wO2lmKCF0aGlzLmVsdFswXS5pc051bGwoKSl7Y291bnQrKzt9XG5pZighdGhpcy5lbHRbMV0uaXNOdWxsKCkpe2NvdW50Kys7fVxucmV0dXJuIGNvdW50O307anN0cy5nZW9tZ3JhcGguTGFiZWwucHJvdG90eXBlLmlzTnVsbD1mdW5jdGlvbihnZW9tSW5kZXgpe3JldHVybiB0aGlzLmVsdFtnZW9tSW5kZXhdLmlzTnVsbCgpO307anN0cy5nZW9tZ3JhcGguTGFiZWwucHJvdG90eXBlLmlzQW55TnVsbD1mdW5jdGlvbihnZW9tSW5kZXgpe3JldHVybiB0aGlzLmVsdFtnZW9tSW5kZXhdLmlzQW55TnVsbCgpO307anN0cy5nZW9tZ3JhcGguTGFiZWwucHJvdG90eXBlLmlzQXJlYT1mdW5jdGlvbigpe2lmKGFyZ3VtZW50cy5sZW5ndGg9PTEpe3JldHVybiB0aGlzLmlzQXJlYTIoYXJndW1lbnRzWzBdKTt9XG5yZXR1cm4gdGhpcy5lbHRbMF0uaXNBcmVhKCl8fHRoaXMuZWx0WzFdLmlzQXJlYSgpO307anN0cy5nZW9tZ3JhcGguTGFiZWwucHJvdG90eXBlLmlzQXJlYTI9ZnVuY3Rpb24oZ2VvbUluZGV4KXtyZXR1cm4gdGhpcy5lbHRbZ2VvbUluZGV4XS5pc0FyZWEoKTt9O2pzdHMuZ2VvbWdyYXBoLkxhYmVsLnByb3RvdHlwZS5pc0xpbmU9ZnVuY3Rpb24oZ2VvbUluZGV4KXtyZXR1cm4gdGhpcy5lbHRbZ2VvbUluZGV4XS5pc0xpbmUoKTt9O2pzdHMuZ2VvbWdyYXBoLkxhYmVsLnByb3RvdHlwZS5pc0VxdWFsT25TaWRlPWZ1bmN0aW9uKGxibCxzaWRlKXtyZXR1cm4gdGhpcy5lbHRbMF0uaXNFcXVhbE9uU2lkZShsYmwuZWx0WzBdLHNpZGUpJiZ0aGlzLmVsdFsxXS5pc0VxdWFsT25TaWRlKGxibC5lbHRbMV0sc2lkZSk7fTtqc3RzLmdlb21ncmFwaC5MYWJlbC5wcm90b3R5cGUuYWxsUG9zaXRpb25zRXF1YWw9ZnVuY3Rpb24oZ2VvbUluZGV4LGxvYyl7cmV0dXJuIHRoaXMuZWx0W2dlb21JbmRleF0uYWxsUG9zaXRpb25zRXF1YWwobG9jKTt9O2pzdHMuZ2VvbWdyYXBoLkxhYmVsLnByb3RvdHlwZS50b0xpbmU9ZnVuY3Rpb24oZ2VvbUluZGV4KXtpZih0aGlzLmVsdFtnZW9tSW5kZXhdLmlzQXJlYSgpKXt0aGlzLmVsdFtnZW9tSW5kZXhdPW5ldyBqc3RzLmdlb21ncmFwaC5Ub3BvbG9neUxvY2F0aW9uKHRoaXMuZWx0W2dlb21JbmRleF0ubG9jYXRpb25bMF0pO319O2pzdHMuZ2VvbWdyYXBoLkVkZ2VSaW5nPWZ1bmN0aW9uKHN0YXJ0LGdlb21ldHJ5RmFjdG9yeSl7dGhpcy5lZGdlcz1bXTt0aGlzLnB0cz1bXTt0aGlzLmhvbGVzPVtdO3RoaXMubGFiZWw9bmV3IGpzdHMuZ2VvbWdyYXBoLkxhYmVsKGpzdHMuZ2VvbS5Mb2NhdGlvbi5OT05FKTt0aGlzLmdlb21ldHJ5RmFjdG9yeT1nZW9tZXRyeUZhY3Rvcnk7aWYoc3RhcnQpe3RoaXMuY29tcHV0ZVBvaW50cyhzdGFydCk7dGhpcy5jb21wdXRlUmluZygpO319O2pzdHMuZ2VvbWdyYXBoLkVkZ2VSaW5nLnByb3RvdHlwZS5zdGFydERlPW51bGw7anN0cy5nZW9tZ3JhcGguRWRnZVJpbmcucHJvdG90eXBlLm1heE5vZGVEZWdyZWU9LTE7anN0cy5nZW9tZ3JhcGguRWRnZVJpbmcucHJvdG90eXBlLmVkZ2VzPW51bGw7anN0cy5nZW9tZ3JhcGguRWRnZVJpbmcucHJvdG90eXBlLnB0cz1udWxsO2pzdHMuZ2VvbWdyYXBoLkVkZ2VSaW5nLnByb3RvdHlwZS5sYWJlbD1udWxsO2pzdHMuZ2VvbWdyYXBoLkVkZ2VSaW5nLnByb3RvdHlwZS5yaW5nPW51bGw7anN0cy5nZW9tZ3JhcGguRWRnZVJpbmcucHJvdG90eXBlLl9pc0hvbGU9bnVsbDtqc3RzLmdlb21ncmFwaC5FZGdlUmluZy5wcm90b3R5cGUuc2hlbGw9bnVsbDtqc3RzLmdlb21ncmFwaC5FZGdlUmluZy5wcm90b3R5cGUuaG9sZXM9bnVsbDtqc3RzLmdlb21ncmFwaC5FZGdlUmluZy5wcm90b3R5cGUuZ2VvbWV0cnlGYWN0b3J5PW51bGw7anN0cy5nZW9tZ3JhcGguRWRnZVJpbmcucHJvdG90eXBlLmlzSXNvbGF0ZWQ9ZnVuY3Rpb24oKXtyZXR1cm4odGhpcy5sYWJlbC5nZXRHZW9tZXRyeUNvdW50KCk9PTEpO307anN0cy5nZW9tZ3JhcGguRWRnZVJpbmcucHJvdG90eXBlLmlzSG9sZT1mdW5jdGlvbigpe3JldHVybiB0aGlzLl9pc0hvbGU7fTtqc3RzLmdlb21ncmFwaC5FZGdlUmluZy5wcm90b3R5cGUuZ2V0Q29vcmRpbmF0ZT1mdW5jdGlvbihpKXtyZXR1cm4gdGhpcy5wdHNbaV07fTtqc3RzLmdlb21ncmFwaC5FZGdlUmluZy5wcm90b3R5cGUuZ2V0TGluZWFyUmluZz1mdW5jdGlvbigpe3JldHVybiB0aGlzLnJpbmc7fTtqc3RzLmdlb21ncmFwaC5FZGdlUmluZy5wcm90b3R5cGUuZ2V0TGFiZWw9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5sYWJlbDt9O2pzdHMuZ2VvbWdyYXBoLkVkZ2VSaW5nLnByb3RvdHlwZS5pc1NoZWxsPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuc2hlbGw9PT1udWxsO307anN0cy5nZW9tZ3JhcGguRWRnZVJpbmcucHJvdG90eXBlLmdldFNoZWxsPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuc2hlbGw7fTtqc3RzLmdlb21ncmFwaC5FZGdlUmluZy5wcm90b3R5cGUuc2V0U2hlbGw9ZnVuY3Rpb24oc2hlbGwpe3RoaXMuc2hlbGw9c2hlbGw7aWYoc2hlbGwhPT1udWxsKVxuc2hlbGwuYWRkSG9sZSh0aGlzKTt9O2pzdHMuZ2VvbWdyYXBoLkVkZ2VSaW5nLnByb3RvdHlwZS5hZGRIb2xlPWZ1bmN0aW9uKHJpbmcpe3RoaXMuaG9sZXMucHVzaChyaW5nKTt9O2pzdHMuZ2VvbWdyYXBoLkVkZ2VSaW5nLnByb3RvdHlwZS50b1BvbHlnb249ZnVuY3Rpb24oZ2VvbWV0cnlGYWN0b3J5KXt2YXIgaG9sZUxSPVtdO2Zvcih2YXIgaT0wO2k8dGhpcy5ob2xlcy5sZW5ndGg7aSsrKXtob2xlTFJbaV09dGhpcy5ob2xlc1tpXS5nZXRMaW5lYXJSaW5nKCk7fVxudmFyIHBvbHk9dGhpcy5nZW9tZXRyeUZhY3RvcnkuY3JlYXRlUG9seWdvbih0aGlzLmdldExpbmVhclJpbmcoKSxob2xlTFIpO3JldHVybiBwb2x5O307anN0cy5nZW9tZ3JhcGguRWRnZVJpbmcucHJvdG90eXBlLmNvbXB1dGVSaW5nPWZ1bmN0aW9uKCl7aWYodGhpcy5yaW5nIT09bnVsbClcbnJldHVybjt2YXIgY29vcmQ9W107Zm9yKHZhciBpPTA7aTx0aGlzLnB0cy5sZW5ndGg7aSsrKXtjb29yZFtpXT10aGlzLnB0c1tpXTt9XG50aGlzLnJpbmc9dGhpcy5nZW9tZXRyeUZhY3RvcnkuY3JlYXRlTGluZWFyUmluZyhjb29yZCk7dGhpcy5faXNIb2xlPWpzdHMuYWxnb3JpdGhtLkNHQWxnb3JpdGhtcy5pc0NDVyh0aGlzLnJpbmcuZ2V0Q29vcmRpbmF0ZXMoKSk7fTtqc3RzLmdlb21ncmFwaC5FZGdlUmluZy5wcm90b3R5cGUuZ2V0TmV4dD1mdW5jdGlvbihkZSl7dGhyb3cgbmV3IGpzdHMuZXJyb3IuQWJzdHJhY3RJbnZvY2F0aW9uRXJyb3IoKTt9O2pzdHMuZ2VvbWdyYXBoLkVkZ2VSaW5nLnByb3RvdHlwZS5zZXRFZGdlUmluZz1mdW5jdGlvbihkZSxlcil7dGhyb3cgbmV3IGpzdHMuZXJyb3IuQWJzdHJhY3RJbnZvY2F0aW9uRXJyb3IoKTt9O2pzdHMuZ2VvbWdyYXBoLkVkZ2VSaW5nLnByb3RvdHlwZS5nZXRFZGdlcz1mdW5jdGlvbigpe3JldHVybiB0aGlzLmVkZ2VzO307anN0cy5nZW9tZ3JhcGguRWRnZVJpbmcucHJvdG90eXBlLmNvbXB1dGVQb2ludHM9ZnVuY3Rpb24oc3RhcnQpe3RoaXMuc3RhcnREZT1zdGFydDt2YXIgZGU9c3RhcnQ7dmFyIGlzRmlyc3RFZGdlPXRydWU7ZG97aWYoZGU9PT1udWxsKVxudGhyb3cgbmV3IGpzdHMuZXJyb3IuVG9wb2xvZ3lFcnJvcignRm91bmQgbnVsbCBEaXJlY3RlZEVkZ2UnKTtpZihkZS5nZXRFZGdlUmluZygpPT09dGhpcylcbnRocm93IG5ldyBqc3RzLmVycm9yLlRvcG9sb2d5RXJyb3IoJ0RpcmVjdGVkIEVkZ2UgdmlzaXRlZCB0d2ljZSBkdXJpbmcgcmluZy1idWlsZGluZyBhdCAnK1xuZGUuZ2V0Q29vcmRpbmF0ZSgpKTt0aGlzLmVkZ2VzLnB1c2goZGUpO3ZhciBsYWJlbD1kZS5nZXRMYWJlbCgpO2pzdHMudXRpbC5Bc3NlcnQuaXNUcnVlKGxhYmVsLmlzQXJlYSgpKTt0aGlzLm1lcmdlTGFiZWwobGFiZWwpO3RoaXMuYWRkUG9pbnRzKGRlLmdldEVkZ2UoKSxkZS5pc0ZvcndhcmQoKSxpc0ZpcnN0RWRnZSk7aXNGaXJzdEVkZ2U9ZmFsc2U7dGhpcy5zZXRFZGdlUmluZyhkZSx0aGlzKTtkZT10aGlzLmdldE5leHQoZGUpO313aGlsZShkZSE9PXRoaXMuc3RhcnREZSk7fTtqc3RzLmdlb21ncmFwaC5FZGdlUmluZy5wcm90b3R5cGUuZ2V0TWF4Tm9kZURlZ3JlZT1mdW5jdGlvbigpe2lmKHRoaXMubWF4Tm9kZURlZ3JlZTwwKVxudGhpcy5jb21wdXRlTWF4Tm9kZURlZ3JlZSgpO3JldHVybiB0aGlzLm1heE5vZGVEZWdyZWU7fTtqc3RzLmdlb21ncmFwaC5FZGdlUmluZy5wcm90b3R5cGUuY29tcHV0ZU1heE5vZGVEZWdyZWU9ZnVuY3Rpb24oKXt0aGlzLm1heE5vZGVEZWdyZWU9MDt2YXIgZGU9dGhpcy5zdGFydERlO2Rve3ZhciBub2RlPWRlLmdldE5vZGUoKTt2YXIgZGVncmVlPW5vZGUuZ2V0RWRnZXMoKS5nZXRPdXRnb2luZ0RlZ3JlZSh0aGlzKTtpZihkZWdyZWU+dGhpcy5tYXhOb2RlRGVncmVlKVxudGhpcy5tYXhOb2RlRGVncmVlPWRlZ3JlZTtkZT10aGlzLmdldE5leHQoZGUpO313aGlsZShkZSE9PXRoaXMuc3RhcnREZSk7dGhpcy5tYXhOb2RlRGVncmVlKj0yO307anN0cy5nZW9tZ3JhcGguRWRnZVJpbmcucHJvdG90eXBlLnNldEluUmVzdWx0PWZ1bmN0aW9uKCl7dmFyIGRlPXRoaXMuc3RhcnREZTtkb3tkZS5nZXRFZGdlKCkuc2V0SW5SZXN1bHQodHJ1ZSk7ZGU9ZGUuZ2V0TmV4dCgpO313aGlsZShkZSE9dGhpcy5zdGFydERlKTt9O2pzdHMuZ2VvbWdyYXBoLkVkZ2VSaW5nLnByb3RvdHlwZS5tZXJnZUxhYmVsPWZ1bmN0aW9uKGRlTGFiZWwpe3RoaXMubWVyZ2VMYWJlbDIoZGVMYWJlbCwwKTt0aGlzLm1lcmdlTGFiZWwyKGRlTGFiZWwsMSk7fTtqc3RzLmdlb21ncmFwaC5FZGdlUmluZy5wcm90b3R5cGUubWVyZ2VMYWJlbDI9ZnVuY3Rpb24oZGVMYWJlbCxnZW9tSW5kZXgpe3ZhciBsb2M9ZGVMYWJlbC5nZXRMb2NhdGlvbihnZW9tSW5kZXgsanN0cy5nZW9tZ3JhcGguUG9zaXRpb24uUklHSFQpO2lmKGxvYz09anN0cy5nZW9tLkxvY2F0aW9uLk5PTkUpXG5yZXR1cm47aWYodGhpcy5sYWJlbC5nZXRMb2NhdGlvbihnZW9tSW5kZXgpPT09anN0cy5nZW9tLkxvY2F0aW9uLk5PTkUpe3RoaXMubGFiZWwuc2V0TG9jYXRpb24oZ2VvbUluZGV4LGxvYyk7cmV0dXJuO319O2pzdHMuZ2VvbWdyYXBoLkVkZ2VSaW5nLnByb3RvdHlwZS5hZGRQb2ludHM9ZnVuY3Rpb24oZWRnZSxpc0ZvcndhcmQsaXNGaXJzdEVkZ2Upe3ZhciBlZGdlUHRzPWVkZ2UuZ2V0Q29vcmRpbmF0ZXMoKTtpZihpc0ZvcndhcmQpe3ZhciBzdGFydEluZGV4PTE7aWYoaXNGaXJzdEVkZ2UpXG5zdGFydEluZGV4PTA7Zm9yKHZhciBpPXN0YXJ0SW5kZXg7aTxlZGdlUHRzLmxlbmd0aDtpKyspe3RoaXMucHRzLnB1c2goZWRnZVB0c1tpXSk7fX1lbHNle3ZhciBzdGFydEluZGV4PWVkZ2VQdHMubGVuZ3RoLTI7aWYoaXNGaXJzdEVkZ2UpXG5zdGFydEluZGV4PWVkZ2VQdHMubGVuZ3RoLTE7Zm9yKHZhciBpPXN0YXJ0SW5kZXg7aT49MDtpLS0pe3RoaXMucHRzLnB1c2goZWRnZVB0c1tpXSk7fX19O2pzdHMuZ2VvbWdyYXBoLkVkZ2VSaW5nLnByb3RvdHlwZS5jb250YWluc1BvaW50PWZ1bmN0aW9uKHApe3ZhciBzaGVsbD10aGlzLmdldExpbmVhclJpbmcoKTt2YXIgZW52PXNoZWxsLmdldEVudmVsb3BlSW50ZXJuYWwoKTtpZighZW52LmNvbnRhaW5zKHApKVxucmV0dXJuIGZhbHNlO2lmKCFqc3RzLmFsZ29yaXRobS5DR0FsZ29yaXRobXMuaXNQb2ludEluUmluZyhwLHNoZWxsLmdldENvb3JkaW5hdGVzKCkpKVxucmV0dXJuIGZhbHNlO2Zvcih2YXIgaT0wO2k8dGhpcy5ob2xlcy5sZW5ndGg7aSsrKXt2YXIgaG9sZT10aGlzLmhvbGVzW2ldO2lmKGhvbGUuY29udGFpbnNQb2ludChwKSlcbnJldHVybiBmYWxzZTt9XG5yZXR1cm4gdHJ1ZTt9OyhmdW5jdGlvbigpe2pzdHMuZ2VvbS5MaW5lYXJSaW5nPWZ1bmN0aW9uKHBvaW50cyxmYWN0b3J5KXtqc3RzLmdlb20uTGluZVN0cmluZy5hcHBseSh0aGlzLGFyZ3VtZW50cyk7fTtqc3RzLmdlb20uTGluZWFyUmluZy5wcm90b3R5cGU9bmV3IGpzdHMuZ2VvbS5MaW5lU3RyaW5nKCk7anN0cy5nZW9tLkxpbmVhclJpbmcuY29uc3RydWN0b3I9anN0cy5nZW9tLkxpbmVhclJpbmc7anN0cy5nZW9tLkxpbmVhclJpbmcucHJvdG90eXBlLmdldEJvdW5kYXJ5RGltZW5zaW9uPWZ1bmN0aW9uKCl7cmV0dXJuIGpzdHMuZ2VvbS5EaW1lbnNpb24uRkFMU0U7fTtqc3RzLmdlb20uTGluZWFyUmluZy5wcm90b3R5cGUuaXNTaW1wbGU9ZnVuY3Rpb24oKXtyZXR1cm4gdHJ1ZTt9O2pzdHMuZ2VvbS5MaW5lYXJSaW5nLnByb3RvdHlwZS5nZXRHZW9tZXRyeVR5cGU9ZnVuY3Rpb24oKXtyZXR1cm4nTGluZWFyUmluZyc7fTtqc3RzLmdlb20uTGluZWFyUmluZy5NSU5JTVVNX1ZBTElEX1NJWkU9NDtqc3RzLmdlb20uTGluZWFyUmluZy5wcm90b3R5cGUuQ0xBU1NfTkFNRT0nanN0cy5nZW9tLkxpbmVhclJpbmcnO30pKCk7anN0cy5pbmRleC5zdHJ0cmVlLkJvdW5kYWJsZT1mdW5jdGlvbigpe307anN0cy5pbmRleC5zdHJ0cmVlLkJvdW5kYWJsZS5wcm90b3R5cGUuZ2V0Qm91bmRzPWZ1bmN0aW9uKCl7dGhyb3cgbmV3IGpzdHMuZXJyb3IuQWJzdHJhY3RNZXRob2RJbnZvY2F0aW9uRXJyb3IoKTt9O2pzdHMuaW5kZXguc3RydHJlZS5BYnN0cmFjdE5vZGU9ZnVuY3Rpb24obGV2ZWwpe3RoaXMubGV2ZWw9bGV2ZWw7dGhpcy5jaGlsZEJvdW5kYWJsZXM9W107fTtqc3RzLmluZGV4LnN0cnRyZWUuQWJzdHJhY3ROb2RlLnByb3RvdHlwZT1uZXcganN0cy5pbmRleC5zdHJ0cmVlLkJvdW5kYWJsZSgpO2pzdHMuaW5kZXguc3RydHJlZS5BYnN0cmFjdE5vZGUuY29uc3RydWN0b3I9anN0cy5pbmRleC5zdHJ0cmVlLkFic3RyYWN0Tm9kZTtqc3RzLmluZGV4LnN0cnRyZWUuQWJzdHJhY3ROb2RlLnByb3RvdHlwZS5jaGlsZEJvdW5kYWJsZXM9bnVsbDtqc3RzLmluZGV4LnN0cnRyZWUuQWJzdHJhY3ROb2RlLnByb3RvdHlwZS5ib3VuZHM9bnVsbDtqc3RzLmluZGV4LnN0cnRyZWUuQWJzdHJhY3ROb2RlLnByb3RvdHlwZS5sZXZlbD1udWxsO2pzdHMuaW5kZXguc3RydHJlZS5BYnN0cmFjdE5vZGUucHJvdG90eXBlLmdldENoaWxkQm91bmRhYmxlcz1mdW5jdGlvbigpe3JldHVybiB0aGlzLmNoaWxkQm91bmRhYmxlczt9O2pzdHMuaW5kZXguc3RydHJlZS5BYnN0cmFjdE5vZGUucHJvdG90eXBlLmNvbXB1dGVCb3VuZHM9ZnVuY3Rpb24oKXt0aHJvdyBuZXcganN0cy5lcnJvci5BYnN0cmFjdE1ldGhvZEludm9jYXRpb25FcnJvcigpO307anN0cy5pbmRleC5zdHJ0cmVlLkFic3RyYWN0Tm9kZS5wcm90b3R5cGUuZ2V0Qm91bmRzPWZ1bmN0aW9uKCl7aWYodGhpcy5ib3VuZHM9PT1udWxsKXt0aGlzLmJvdW5kcz10aGlzLmNvbXB1dGVCb3VuZHMoKTt9XG5yZXR1cm4gdGhpcy5ib3VuZHM7fTtqc3RzLmluZGV4LnN0cnRyZWUuQWJzdHJhY3ROb2RlLnByb3RvdHlwZS5nZXRMZXZlbD1mdW5jdGlvbigpe3JldHVybiB0aGlzLmxldmVsO307anN0cy5pbmRleC5zdHJ0cmVlLkFic3RyYWN0Tm9kZS5wcm90b3R5cGUuYWRkQ2hpbGRCb3VuZGFibGU9ZnVuY3Rpb24oY2hpbGRCb3VuZGFibGUpe3RoaXMuY2hpbGRCb3VuZGFibGVzLnB1c2goY2hpbGRCb3VuZGFibGUpO307KGZ1bmN0aW9uKCl7anN0cy5ub2RpbmcuTm9kZXI9ZnVuY3Rpb24oKXt9O2pzdHMubm9kaW5nLk5vZGVyLnByb3RvdHlwZS5jb21wdXRlTm9kZXM9anN0cy5hYnN0cmFjdEZ1bmM7anN0cy5ub2RpbmcuTm9kZXIucHJvdG90eXBlLmdldE5vZGVkU3Vic3RyaW5ncz1qc3RzLmFic3RyYWN0RnVuYzt9KSgpOyhmdW5jdGlvbigpe3ZhciBOb2Rlcj1qc3RzLm5vZGluZy5Ob2Rlcjtqc3RzLm5vZGluZy5TaW5nbGVQYXNzTm9kZXI9ZnVuY3Rpb24oKXt9O2pzdHMubm9kaW5nLlNpbmdsZVBhc3NOb2Rlci5wcm90b3R5cGU9bmV3IE5vZGVyKCk7anN0cy5ub2RpbmcuU2luZ2xlUGFzc05vZGVyLmNvbnN0cnVjdG9yPWpzdHMubm9kaW5nLlNpbmdsZVBhc3NOb2Rlcjtqc3RzLm5vZGluZy5TaW5nbGVQYXNzTm9kZXIucHJvdG90eXBlLnNlZ0ludD1udWxsO2pzdHMubm9kaW5nLlNpbmdsZVBhc3NOb2Rlci5wcm90b3R5cGUuc2V0U2VnbWVudEludGVyc2VjdG9yPWZ1bmN0aW9uKHNlZ0ludCl7dGhpcy5zZWdJbnQ9c2VnSW50O307fSkoKTtqc3RzLmluZGV4LlNwYXRpYWxJbmRleD1mdW5jdGlvbigpe307anN0cy5pbmRleC5TcGF0aWFsSW5kZXgucHJvdG90eXBlLmluc2VydD1mdW5jdGlvbihpdGVtRW52LGl0ZW0pe3Rocm93IG5ldyBqc3RzLmVycm9yLkFic3RyYWN0TWV0aG9kSW52b2NhdGlvbkVycm9yKCk7fTtqc3RzLmluZGV4LlNwYXRpYWxJbmRleC5wcm90b3R5cGUucXVlcnk9ZnVuY3Rpb24oc2VhcmNoRW52LHZpc2l0b3Ipe3Rocm93IG5ldyBqc3RzLmVycm9yLkFic3RyYWN0TWV0aG9kSW52b2NhdGlvbkVycm9yKCk7fTtqc3RzLmluZGV4LlNwYXRpYWxJbmRleC5wcm90b3R5cGUucmVtb3ZlPWZ1bmN0aW9uKGl0ZW1FbnYsaXRlbSl7dGhyb3cgbmV3IGpzdHMuZXJyb3IuQWJzdHJhY3RNZXRob2RJbnZvY2F0aW9uRXJyb3IoKTt9O2pzdHMuaW5kZXguc3RydHJlZS5BYnN0cmFjdFNUUnRyZWU9ZnVuY3Rpb24obm9kZUNhcGFjaXR5KXtpZihub2RlQ2FwYWNpdHk9PT11bmRlZmluZWQpXG5yZXR1cm47dGhpcy5pdGVtQm91bmRhYmxlcz1bXTtqc3RzLnV0aWwuQXNzZXJ0LmlzVHJ1ZShub2RlQ2FwYWNpdHk+MSwnTm9kZSBjYXBhY2l0eSBtdXN0IGJlIGdyZWF0ZXIgdGhhbiAxJyk7dGhpcy5ub2RlQ2FwYWNpdHk9bm9kZUNhcGFjaXR5O307anN0cy5pbmRleC5zdHJ0cmVlLkFic3RyYWN0U1RSdHJlZS5JbnRlcnNlY3RzT3A9ZnVuY3Rpb24oKXt9O2pzdHMuaW5kZXguc3RydHJlZS5BYnN0cmFjdFNUUnRyZWUuSW50ZXJzZWN0c09wLnByb3RvdHlwZS5pbnRlcnNlY3RzPWZ1bmN0aW9uKGFCb3VuZHMsYkJvdW5kcyl7dGhyb3cgbmV3IGpzdHMuZXJyb3IuQWJzdHJhY3RNZXRob2RJbnZvY2F0aW9uRXJyb3IoKTt9O2pzdHMuaW5kZXguc3RydHJlZS5BYnN0cmFjdFNUUnRyZWUucHJvdG90eXBlLnJvb3Q9bnVsbDtqc3RzLmluZGV4LnN0cnRyZWUuQWJzdHJhY3RTVFJ0cmVlLnByb3RvdHlwZS5idWlsdD1mYWxzZTtqc3RzLmluZGV4LnN0cnRyZWUuQWJzdHJhY3RTVFJ0cmVlLnByb3RvdHlwZS5pdGVtQm91bmRhYmxlcz1udWxsO2pzdHMuaW5kZXguc3RydHJlZS5BYnN0cmFjdFNUUnRyZWUucHJvdG90eXBlLm5vZGVDYXBhY2l0eT1udWxsO2pzdHMuaW5kZXguc3RydHJlZS5BYnN0cmFjdFNUUnRyZWUucHJvdG90eXBlLmJ1aWxkPWZ1bmN0aW9uKCl7anN0cy51dGlsLkFzc2VydC5pc1RydWUoIXRoaXMuYnVpbHQpO3RoaXMucm9vdD10aGlzLml0ZW1Cb3VuZGFibGVzLmxlbmd0aD09PTA/dGhpcy5jcmVhdGVOb2RlKDApOnRoaXMuY3JlYXRlSGlnaGVyTGV2ZWxzKHRoaXMuaXRlbUJvdW5kYWJsZXMsLTEpO3RoaXMuYnVpbHQ9dHJ1ZTt9O2pzdHMuaW5kZXguc3RydHJlZS5BYnN0cmFjdFNUUnRyZWUucHJvdG90eXBlLmNyZWF0ZU5vZGU9ZnVuY3Rpb24obGV2ZWwpe3Rocm93IG5ldyBqc3RzLmVycm9yLkFic3RyYWN0TWV0aG9kSW52b2NhdGlvbkVycm9yKCk7fTtqc3RzLmluZGV4LnN0cnRyZWUuQWJzdHJhY3RTVFJ0cmVlLnByb3RvdHlwZS5jcmVhdGVQYXJlbnRCb3VuZGFibGVzPWZ1bmN0aW9uKGNoaWxkQm91bmRhYmxlcyxuZXdMZXZlbCl7anN0cy51dGlsLkFzc2VydC5pc1RydWUoIShjaGlsZEJvdW5kYWJsZXMubGVuZ3RoPT09MCkpO3ZhciBwYXJlbnRCb3VuZGFibGVzPVtdO3BhcmVudEJvdW5kYWJsZXMucHVzaCh0aGlzLmNyZWF0ZU5vZGUobmV3TGV2ZWwpKTt2YXIgc29ydGVkQ2hpbGRCb3VuZGFibGVzPVtdO2Zvcih2YXIgaT0wO2k8Y2hpbGRCb3VuZGFibGVzLmxlbmd0aDtpKyspe3NvcnRlZENoaWxkQm91bmRhYmxlcy5wdXNoKGNoaWxkQm91bmRhYmxlc1tpXSk7fVxuc29ydGVkQ2hpbGRCb3VuZGFibGVzLnNvcnQodGhpcy5nZXRDb21wYXJhdG9yKCkpO2Zvcih2YXIgaT0wO2k8c29ydGVkQ2hpbGRCb3VuZGFibGVzLmxlbmd0aDtpKyspe3ZhciBjaGlsZEJvdW5kYWJsZT1zb3J0ZWRDaGlsZEJvdW5kYWJsZXNbaV07aWYodGhpcy5sYXN0Tm9kZShwYXJlbnRCb3VuZGFibGVzKS5nZXRDaGlsZEJvdW5kYWJsZXMoKS5sZW5ndGg9PT10aGlzLmdldE5vZGVDYXBhY2l0eSgpKXtwYXJlbnRCb3VuZGFibGVzLnB1c2godGhpcy5jcmVhdGVOb2RlKG5ld0xldmVsKSk7fVxudGhpcy5sYXN0Tm9kZShwYXJlbnRCb3VuZGFibGVzKS5hZGRDaGlsZEJvdW5kYWJsZShjaGlsZEJvdW5kYWJsZSk7fVxucmV0dXJuIHBhcmVudEJvdW5kYWJsZXM7fTtqc3RzLmluZGV4LnN0cnRyZWUuQWJzdHJhY3RTVFJ0cmVlLnByb3RvdHlwZS5sYXN0Tm9kZT1mdW5jdGlvbihub2Rlcyl7cmV0dXJuIG5vZGVzW25vZGVzLmxlbmd0aC0xXTt9O2pzdHMuaW5kZXguc3RydHJlZS5BYnN0cmFjdFNUUnRyZWUucHJvdG90eXBlLmNvbXBhcmVEb3VibGVzPWZ1bmN0aW9uKGEsYil7cmV0dXJuIGE+Yj8xOmE8Yj8tMTowO307anN0cy5pbmRleC5zdHJ0cmVlLkFic3RyYWN0U1RSdHJlZS5wcm90b3R5cGUuY3JlYXRlSGlnaGVyTGV2ZWxzPWZ1bmN0aW9uKGJvdW5kYWJsZXNPZkFMZXZlbCxsZXZlbCl7anN0cy51dGlsLkFzc2VydC5pc1RydWUoIShib3VuZGFibGVzT2ZBTGV2ZWwubGVuZ3RoPT09MCkpO3ZhciBwYXJlbnRCb3VuZGFibGVzPXRoaXMuY3JlYXRlUGFyZW50Qm91bmRhYmxlcyhib3VuZGFibGVzT2ZBTGV2ZWwsbGV2ZWwrMSk7aWYocGFyZW50Qm91bmRhYmxlcy5sZW5ndGg9PT0xKXtyZXR1cm4gcGFyZW50Qm91bmRhYmxlc1swXTt9XG5yZXR1cm4gdGhpcy5jcmVhdGVIaWdoZXJMZXZlbHMocGFyZW50Qm91bmRhYmxlcyxsZXZlbCsxKTt9O2pzdHMuaW5kZXguc3RydHJlZS5BYnN0cmFjdFNUUnRyZWUucHJvdG90eXBlLmdldFJvb3Q9ZnVuY3Rpb24oKXtpZighdGhpcy5idWlsdClcbnRoaXMuYnVpbGQoKTtyZXR1cm4gdGhpcy5yb290O307anN0cy5pbmRleC5zdHJ0cmVlLkFic3RyYWN0U1RSdHJlZS5wcm90b3R5cGUuZ2V0Tm9kZUNhcGFjaXR5PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMubm9kZUNhcGFjaXR5O307anN0cy5pbmRleC5zdHJ0cmVlLkFic3RyYWN0U1RSdHJlZS5wcm90b3R5cGUuc2l6ZT1mdW5jdGlvbigpe2lmKGFyZ3VtZW50cy5sZW5ndGg9PT0xKXtyZXR1cm4gdGhpcy5zaXplMihhcmd1bWVudHNbMF0pO31cbmlmKCF0aGlzLmJ1aWx0KXt0aGlzLmJ1aWxkKCk7fVxuaWYodGhpcy5pdGVtQm91bmRhYmxlcy5sZW5ndGg9PT0wKXtyZXR1cm4gMDt9XG5yZXR1cm4gdGhpcy5zaXplMihyb290KTt9O2pzdHMuaW5kZXguc3RydHJlZS5BYnN0cmFjdFNUUnRyZWUucHJvdG90eXBlLnNpemUyPWZ1bmN0aW9uKG5vZGUpe3ZhciBzaXplPTA7dmFyIGNoaWxkQm91bmRhYmxlcz1ub2RlLmdldENoaWxkQm91bmRhYmxlcygpO2Zvcih2YXIgaT0wO2k8Y2hpbGRCb3VuZGFibGVzLmxlbmd0aDtpKyspe3ZhciBjaGlsZEJvdW5kYWJsZT1jaGlsZEJvdW5kYWJsZXNbaV07aWYoY2hpbGRCb3VuZGFibGUgaW5zdGFuY2VvZiBqc3RzLmluZGV4LnN0cnRyZWUuQWJzdHJhY3ROb2RlKXtzaXplKz10aGlzLnNpemUoY2hpbGRCb3VuZGFibGUpO31lbHNlIGlmKGNoaWxkQm91bmRhYmxlIGluc3RhbmNlb2YganN0cy5pbmRleC5zdHJ0cmVlLkl0ZW1Cb3VuZGFibGUpe3NpemUrPTE7fX1cbnJldHVybiBzaXplO307anN0cy5pbmRleC5zdHJ0cmVlLkFic3RyYWN0U1RSdHJlZS5wcm90b3R5cGUuZGVwdGg9ZnVuY3Rpb24oKXtpZihhcmd1bWVudHMubGVuZ3RoPT09MSl7cmV0dXJuIHRoaXMuZGVwdGgyKGFyZ3VtZW50c1swXSk7fVxuaWYoIXRoaXMuYnVpbHQpe3RoaXMuYnVpbGQoKTt9XG5pZih0aGlzLml0ZW1Cb3VuZGFibGVzLmxlbmd0aD09PTApe3JldHVybiAwO31cbnJldHVybiB0aGlzLmRlcHRoMihyb290KTt9O2pzdHMuaW5kZXguc3RydHJlZS5BYnN0cmFjdFNUUnRyZWUucHJvdG90eXBlLmRlcHRoMj1mdW5jdGlvbigpe3ZhciBtYXhDaGlsZERlcHRoPTA7dmFyIGNoaWxkQm91bmRhYmxlcz1ub2RlLmdldENoaWxkQm91bmRhYmxlcygpO2Zvcih2YXIgaT0wO2k8Y2hpbGRCb3VuZGFibGVzLmxlbmd0aDtpKyspe3ZhciBjaGlsZEJvdW5kYWJsZT1jaGlsZEJvdW5kYWJsZXNbaV07aWYoY2hpbGRCb3VuZGFibGUgaW5zdGFuY2VvZiBqc3RzLmluZGV4LnN0cnRyZWUuQWJzdHJhY3ROb2RlKXt2YXIgY2hpbGREZXB0aD10aGlzLmRlcHRoKGNoaWxkQm91bmRhYmxlKTtpZihjaGlsZERlcHRoPm1heENoaWxkRGVwdGgpXG5tYXhDaGlsZERlcHRoPWNoaWxkRGVwdGg7fX1cbnJldHVybiBtYXhDaGlsZERlcHRoKzE7fTtqc3RzLmluZGV4LnN0cnRyZWUuQWJzdHJhY3RTVFJ0cmVlLnByb3RvdHlwZS5pbnNlcnQ9ZnVuY3Rpb24oYm91bmRzLGl0ZW0pe2pzdHMudXRpbC5Bc3NlcnQuaXNUcnVlKCF0aGlzLmJ1aWx0LCdDYW5ub3QgaW5zZXJ0IGl0ZW1zIGludG8gYW4gU1RSIHBhY2tlZCBSLXRyZWUgYWZ0ZXIgaXQgaGFzIGJlZW4gYnVpbHQuJyk7dGhpcy5pdGVtQm91bmRhYmxlcy5wdXNoKG5ldyBqc3RzLmluZGV4LnN0cnRyZWUuSXRlbUJvdW5kYWJsZShib3VuZHMsaXRlbSkpO307anN0cy5pbmRleC5zdHJ0cmVlLkFic3RyYWN0U1RSdHJlZS5wcm90b3R5cGUucXVlcnk9ZnVuY3Rpb24oc2VhcmNoQm91bmRzKXtpZihhcmd1bWVudHMubGVuZ3RoPjEpe3RoaXMucXVlcnkyLmFwcGx5KHRoaXMsYXJndW1lbnRzKTt9XG5pZighdGhpcy5idWlsdCl7dGhpcy5idWlsZCgpO31cbnZhciBtYXRjaGVzPVtdO2lmKHRoaXMuaXRlbUJvdW5kYWJsZXMubGVuZ3RoPT09MCl7anN0cy51dGlsLkFzc2VydC5pc1RydWUodGhpcy5yb290LmdldEJvdW5kcygpPT09bnVsbCk7cmV0dXJuIG1hdGNoZXM7fVxuaWYodGhpcy5nZXRJbnRlcnNlY3RzT3AoKS5pbnRlcnNlY3RzKHRoaXMucm9vdC5nZXRCb3VuZHMoKSxzZWFyY2hCb3VuZHMpKXt0aGlzLnF1ZXJ5MyhzZWFyY2hCb3VuZHMsdGhpcy5yb290LG1hdGNoZXMpO31cbnJldHVybiBtYXRjaGVzO307anN0cy5pbmRleC5zdHJ0cmVlLkFic3RyYWN0U1RSdHJlZS5wcm90b3R5cGUucXVlcnkyPWZ1bmN0aW9uKHNlYXJjaEJvdW5kcyx2aXNpdG9yKXtpZihhcmd1bWVudHMubGVuZ3RoPjIpe3RoaXMucXVlcnkzLmFwcGx5KHRoaXMsYXJndW1lbnRzKTt9XG5pZighdGhpcy5idWlsdCl7dGhpcy5idWlsZCgpO31cbmlmKHRoaXMuaXRlbUJvdW5kYWJsZXMubGVuZ3RoPT09MCl7anN0cy51dGlsLkFzc2VydC5pc1RydWUodGhpcy5yb290LmdldEJvdW5kcygpPT09bnVsbCk7fVxuaWYodGhpcy5nZXRJbnRlcnNlY3RzT3AoKS5pbnRlcnNlY3RzKHRoaXMucm9vdC5nZXRCb3VuZHMoKSxzZWFyY2hCb3VuZHMpKXt0aGlzLnF1ZXJ5NChzZWFyY2hCb3VuZHMsdGhpcy5yb290LHZpc2l0b3IpO319O2pzdHMuaW5kZXguc3RydHJlZS5BYnN0cmFjdFNUUnRyZWUucHJvdG90eXBlLnF1ZXJ5Mz1mdW5jdGlvbihzZWFyY2hCb3VuZHMsbm9kZSxtYXRjaGVzKXtpZighKGFyZ3VtZW50c1syXWluc3RhbmNlb2YgQXJyYXkpKXt0aGlzLnF1ZXJ5NC5hcHBseSh0aGlzLGFyZ3VtZW50cyk7fVxudmFyIGNoaWxkQm91bmRhYmxlcz1ub2RlLmdldENoaWxkQm91bmRhYmxlcygpO2Zvcih2YXIgaT0wO2k8Y2hpbGRCb3VuZGFibGVzLmxlbmd0aDtpKyspe3ZhciBjaGlsZEJvdW5kYWJsZT1jaGlsZEJvdW5kYWJsZXNbaV07aWYoIXRoaXMuZ2V0SW50ZXJzZWN0c09wKCkuaW50ZXJzZWN0cyhjaGlsZEJvdW5kYWJsZS5nZXRCb3VuZHMoKSxzZWFyY2hCb3VuZHMpKXtjb250aW51ZTt9XG5pZihjaGlsZEJvdW5kYWJsZSBpbnN0YW5jZW9mIGpzdHMuaW5kZXguc3RydHJlZS5BYnN0cmFjdE5vZGUpe3RoaXMucXVlcnkzKHNlYXJjaEJvdW5kcyxjaGlsZEJvdW5kYWJsZSxtYXRjaGVzKTt9ZWxzZSBpZihjaGlsZEJvdW5kYWJsZSBpbnN0YW5jZW9mIGpzdHMuaW5kZXguc3RydHJlZS5JdGVtQm91bmRhYmxlKXttYXRjaGVzLnB1c2goY2hpbGRCb3VuZGFibGUuZ2V0SXRlbSgpKTt9ZWxzZXtqc3RzLnV0aWwuQXNzZXJ0LnNob3VsZE5ldmVyUmVhY2hIZXJlKCk7fX19O2pzdHMuaW5kZXguc3RydHJlZS5BYnN0cmFjdFNUUnRyZWUucHJvdG90eXBlLnF1ZXJ5ND1mdW5jdGlvbihzZWFyY2hCb3VuZHMsbm9kZSx2aXNpdG9yKXt2YXIgY2hpbGRCb3VuZGFibGVzPW5vZGUuZ2V0Q2hpbGRCb3VuZGFibGVzKCk7Zm9yKHZhciBpPTA7aTxjaGlsZEJvdW5kYWJsZXMubGVuZ3RoO2krKyl7dmFyIGNoaWxkQm91bmRhYmxlPWNoaWxkQm91bmRhYmxlc1tpXTtpZighdGhpcy5nZXRJbnRlcnNlY3RzT3AoKS5pbnRlcnNlY3RzKGNoaWxkQm91bmRhYmxlLmdldEJvdW5kcygpLHNlYXJjaEJvdW5kcykpe2NvbnRpbnVlO31cbmlmKGNoaWxkQm91bmRhYmxlIGluc3RhbmNlb2YganN0cy5pbmRleC5zdHJ0cmVlLkFic3RyYWN0Tm9kZSl7dGhpcy5xdWVyeTQoc2VhcmNoQm91bmRzLGNoaWxkQm91bmRhYmxlLHZpc2l0b3IpO31lbHNlIGlmKGNoaWxkQm91bmRhYmxlIGluc3RhbmNlb2YganN0cy5pbmRleC5zdHJ0cmVlLkl0ZW1Cb3VuZGFibGUpe3Zpc2l0b3IudmlzaXRJdGVtKGNoaWxkQm91bmRhYmxlLmdldEl0ZW0oKSk7fWVsc2V7anN0cy51dGlsLkFzc2VydC5zaG91bGROZXZlclJlYWNoSGVyZSgpO319fTtqc3RzLmluZGV4LnN0cnRyZWUuQWJzdHJhY3RTVFJ0cmVlLnByb3RvdHlwZS5nZXRJbnRlcnNlY3RzT3A9ZnVuY3Rpb24oKXt0aHJvdyBuZXcganN0cy5lcnJvci5BYnN0cmFjdE1ldGhvZEludm9jYXRpb25FcnJvcigpO307anN0cy5pbmRleC5zdHJ0cmVlLkFic3RyYWN0U1RSdHJlZS5wcm90b3R5cGUuaXRlbXNUcmVlPWZ1bmN0aW9uKCl7aWYoYXJndW1lbnRzLmxlbmd0aD09PTEpe3JldHVybiB0aGlzLml0ZW1zVHJlZTIuYXBwbHkodGhpcyxhcmd1bWVudHMpO31cbmlmKCF0aGlzLmJ1aWx0KXt0aGlzLmJ1aWxkKCk7fVxudmFyIHZhbHVlc1RyZWU9dGhpcy5pdGVtc1RyZWUyKHRoaXMucm9vdCk7aWYodmFsdWVzVHJlZT09PW51bGwpXG5yZXR1cm5bXTtyZXR1cm4gdmFsdWVzVHJlZTt9O2pzdHMuaW5kZXguc3RydHJlZS5BYnN0cmFjdFNUUnRyZWUucHJvdG90eXBlLml0ZW1zVHJlZTI9ZnVuY3Rpb24obm9kZSl7dmFyIHZhbHVlc1RyZWVGb3JOb2RlPVtdO3ZhciBjaGlsZEJvdW5kYWJsZXM9bm9kZS5nZXRDaGlsZEJvdW5kYWJsZXMoKTtmb3IodmFyIGk9MDtpPGNoaWxkQm91bmRhYmxlcy5sZW5ndGg7aSsrKXt2YXIgY2hpbGRCb3VuZGFibGU9Y2hpbGRCb3VuZGFibGVzW2ldO2lmKGNoaWxkQm91bmRhYmxlIGluc3RhbmNlb2YganN0cy5pbmRleC5zdHJ0cmVlLkFic3RyYWN0Tm9kZSl7dmFyIHZhbHVlc1RyZWVGb3JDaGlsZD10aGlzLml0ZW1zVHJlZShjaGlsZEJvdW5kYWJsZSk7aWYodmFsdWVzVHJlZUZvckNoaWxkIT1udWxsKVxudmFsdWVzVHJlZUZvck5vZGUucHVzaCh2YWx1ZXNUcmVlRm9yQ2hpbGQpO31lbHNlIGlmKGNoaWxkQm91bmRhYmxlIGluc3RhbmNlb2YganN0cy5pbmRleC5zdHJ0cmVlLkl0ZW1Cb3VuZGFibGUpe3ZhbHVlc1RyZWVGb3JOb2RlLnB1c2goY2hpbGRCb3VuZGFibGUuZ2V0SXRlbSgpKTt9ZWxzZXtqc3RzLnV0aWwuQXNzZXJ0LnNob3VsZE5ldmVyUmVhY2hIZXJlKCk7fX1cbmlmKHZhbHVlc1RyZWVGb3JOb2RlLmxlbmd0aDw9MClcbnJldHVybiBudWxsO3JldHVybiB2YWx1ZXNUcmVlRm9yTm9kZTt9O2pzdHMuaW5kZXguc3RydHJlZS5BYnN0cmFjdFNUUnRyZWUucHJvdG90eXBlLnJlbW92ZT1mdW5jdGlvbihzZWFyY2hCb3VuZHMsaXRlbSl7aWYoIXRoaXMuYnVpbHQpe3RoaXMuYnVpbGQoKTt9XG5pZih0aGlzLml0ZW1Cb3VuZGFibGVzLmxlbmd0aD09PTApe2pzdHMudXRpbC5Bc3NlcnQuaXNUcnVlKHRoaXMucm9vdC5nZXRCb3VuZHMoKT09bnVsbCk7fVxuaWYodGhpcy5nZXRJbnRlcnNlY3RzT3AoKS5pbnRlcnNlY3RzKHRoaXMucm9vdC5nZXRCb3VuZHMoKSxzZWFyY2hCb3VuZHMpKXtyZXR1cm4gdGhpcy5yZW1vdmUyKHNlYXJjaEJvdW5kcyx0aGlzLnJvb3QsaXRlbSk7fVxucmV0dXJuIGZhbHNlO307anN0cy5pbmRleC5zdHJ0cmVlLkFic3RyYWN0U1RSdHJlZS5wcm90b3R5cGUucmVtb3ZlMj1mdW5jdGlvbihzZWFyY2hCb3VuZHMsbm9kZSxpdGVtKXt2YXIgZm91bmQ9dGhpcy5yZW1vdmVJdGVtKG5vZGUsaXRlbSk7aWYoZm91bmQpXG5yZXR1cm4gdHJ1ZTt2YXIgY2hpbGRUb1BydW5lPW51bGw7dmFyIGNoaWxkQm91bmRhYmxlcz1ub2RlLmdldENoaWxkQm91bmRhYmxlcygpO2Zvcih2YXIgaT0wO2k8Y2hpbGRCb3VuZGFibGVzLmxlbmd0aDtpKyspe3ZhciBjaGlsZEJvdW5kYWJsZT1jaGlsZEJvdW5kYWJsZXNbaV07aWYoIXRoaXMuZ2V0SW50ZXJzZWN0c09wKCkuaW50ZXJzZWN0cyhjaGlsZEJvdW5kYWJsZS5nZXRCb3VuZHMoKSxzZWFyY2hCb3VuZHMpKXtjb250aW51ZTt9XG5pZihjaGlsZEJvdW5kYWJsZSBpbnN0YW5jZW9mIGpzdHMuaW5kZXguc3RydHJlZS5BYnN0cmFjdE5vZGUpe2ZvdW5kPXRoaXMucmVtb3ZlKHNlYXJjaEJvdW5kcyxjaGlsZEJvdW5kYWJsZSxpdGVtKTtpZihmb3VuZCl7Y2hpbGRUb1BydW5lPWNoaWxkQm91bmRhYmxlO2JyZWFrO319fVxuaWYoY2hpbGRUb1BydW5lIT1udWxsKXtpZihjaGlsZFRvUHJ1bmUuZ2V0Q2hpbGRCb3VuZGFibGVzKCkubGVuZ3RoPT09MCl7Y2hpbGRCb3VuZGFibGVzLnNwbGljZShjaGlsZEJvdW5kYWJsZXMuaW5kZXhPZihjaGlsZFRvUHJ1bmUpLDEpO319XG5yZXR1cm4gZm91bmQ7fTtqc3RzLmluZGV4LnN0cnRyZWUuQWJzdHJhY3RTVFJ0cmVlLnByb3RvdHlwZS5yZW1vdmVJdGVtPWZ1bmN0aW9uKG5vZGUsaXRlbSl7dmFyIGNoaWxkVG9SZW1vdmU9bnVsbDt2YXIgY2hpbGRCb3VuZGFibGVzPW5vZGUuZ2V0Q2hpbGRCb3VuZGFibGVzKCk7Zm9yKHZhciBpPTA7aTxjaGlsZEJvdW5kYWJsZXMubGVuZ3RoO2krKyl7dmFyIGNoaWxkQm91bmRhYmxlPWNoaWxkQm91bmRhYmxlc1tpXTtpZihjaGlsZEJvdW5kYWJsZSBpbnN0YW5jZW9mIGpzdHMuaW5kZXguc3RydHJlZS5JdGVtQm91bmRhYmxlKXtpZihjaGlsZEJvdW5kYWJsZS5nZXRJdGVtKCk9PT1pdGVtKVxuY2hpbGRUb1JlbW92ZT1jaGlsZEJvdW5kYWJsZTt9fVxuaWYoY2hpbGRUb1JlbW92ZSE9PW51bGwpe2NoaWxkQm91bmRhYmxlcy5zcGxpY2UoY2hpbGRCb3VuZGFibGVzLmluZGV4T2YoY2hpbGRUb1JlbW92ZSksMSk7cmV0dXJuIHRydWU7fVxucmV0dXJuIGZhbHNlO307anN0cy5pbmRleC5zdHJ0cmVlLkFic3RyYWN0U1RSdHJlZS5wcm90b3R5cGUuYm91bmRhYmxlc0F0TGV2ZWw9ZnVuY3Rpb24obGV2ZWwpe2lmKGFyZ3VtZW50cy5sZW5ndGg+MSl7dGhpcy5ib3VuZGFibGVzQXRMZXZlbDIuYXBwbHkodGhpcyxhcmd1bWVudHMpO3JldHVybjt9XG52YXIgYm91bmRhYmxlcz1bXTt0aGlzLmJvdW5kYWJsZXNBdExldmVsMihsZXZlbCx0aGlzLnJvb3QsYm91bmRhYmxlcyk7cmV0dXJuIGJvdW5kYWJsZXM7fTtqc3RzLmluZGV4LnN0cnRyZWUuQWJzdHJhY3RTVFJ0cmVlLnByb3RvdHlwZS5ib3VuZGFibGVzQXRMZXZlbDI9ZnVuY3Rpb24obGV2ZWwsdG9wLGJvdW5kYWJsZXMpe2pzdHMudXRpbC5Bc3NlcnQuaXNUcnVlKGxldmVsPi0yKTtpZih0b3AuZ2V0TGV2ZWwoKT09PWxldmVsKXtib3VuZGFibGVzLmFkZCh0b3ApO3JldHVybjt9XG52YXIgY2hpbGRCb3VuZGFibGVzPW5vZGUuZ2V0Q2hpbGRCb3VuZGFibGVzKCk7Zm9yKHZhciBpPTA7aTxjaGlsZEJvdW5kYWJsZXMubGVuZ3RoO2krKyl7dmFyIGJvdW5kYWJsZT1jaGlsZEJvdW5kYWJsZXNbaV07aWYoYm91bmRhYmxlIGluc3RhbmNlb2YganN0cy5pbmRleC5zdHJ0cmVlLkFic3RyYWN0Tm9kZSl7dGhpcy5ib3VuZGFibGVzQXRMZXZlbChsZXZlbCxib3VuZGFibGUsYm91bmRhYmxlcyk7fWVsc2V7anN0cy51dGlsLkFzc2VydC5pc1RydWUoYm91bmRhYmxlIGluc3RhbmNlb2YganN0cy5pbmRleC5zdHJ0cmVlLkl0ZW1Cb3VuZGFibGUpO2lmKGxldmVsPT09LTEpe2JvdW5kYWJsZXMuYWRkKGJvdW5kYWJsZSk7fX19XG5yZXR1cm47fTtqc3RzLmluZGV4LnN0cnRyZWUuQWJzdHJhY3RTVFJ0cmVlLnByb3RvdHlwZS5nZXRDb21wYXJhdG9yPWZ1bmN0aW9uKCl7dGhyb3cgbmV3IGpzdHMuZXJyb3IuQWJzdHJhY3RNZXRob2RJbnZvY2F0aW9uRXJyb3IoKTt9O2pzdHMuaW5kZXguc3RydHJlZS5TVFJ0cmVlPWZ1bmN0aW9uKG5vZGVDYXBhY2l0eSl7bm9kZUNhcGFjaXR5PW5vZGVDYXBhY2l0eXx8anN0cy5pbmRleC5zdHJ0cmVlLlNUUnRyZWUuREVGQVVMVF9OT0RFX0NBUEFDSVRZO2pzdHMuaW5kZXguc3RydHJlZS5BYnN0cmFjdFNUUnRyZWUuY2FsbCh0aGlzLG5vZGVDYXBhY2l0eSk7fTtqc3RzLmluZGV4LnN0cnRyZWUuU1RSdHJlZS5wcm90b3R5cGU9bmV3IGpzdHMuaW5kZXguc3RydHJlZS5BYnN0cmFjdFNUUnRyZWUoKTtqc3RzLmluZGV4LnN0cnRyZWUuU1RSdHJlZS5jb25zdHJ1Y3Rvcj1qc3RzLmluZGV4LnN0cnRyZWUuU1RSdHJlZTtqc3RzLmluZGV4LnN0cnRyZWUuU1RSdHJlZS5wcm90b3R5cGUueENvbXBhcmF0b3I9ZnVuY3Rpb24obzEsbzIpe3JldHVybiBqc3RzLmluZGV4LnN0cnRyZWUuQWJzdHJhY3RTVFJ0cmVlLnByb3RvdHlwZS5jb21wYXJlRG91Ymxlcyhqc3RzLmluZGV4LnN0cnRyZWUuU1RSdHJlZS5wcm90b3R5cGUuY2VudHJlWChvMS5nZXRCb3VuZHMoKSksanN0cy5pbmRleC5zdHJ0cmVlLlNUUnRyZWUucHJvdG90eXBlLmNlbnRyZVgobzIuZ2V0Qm91bmRzKCkpKTt9O2pzdHMuaW5kZXguc3RydHJlZS5TVFJ0cmVlLnByb3RvdHlwZS55Q29tcGFyYXRvcj1mdW5jdGlvbihvMSxvMil7cmV0dXJuIGpzdHMuaW5kZXguc3RydHJlZS5BYnN0cmFjdFNUUnRyZWUucHJvdG90eXBlLmNvbXBhcmVEb3VibGVzKGpzdHMuaW5kZXguc3RydHJlZS5TVFJ0cmVlLnByb3RvdHlwZS5jZW50cmVZKG8xLmdldEJvdW5kcygpKSxqc3RzLmluZGV4LnN0cnRyZWUuU1RSdHJlZS5wcm90b3R5cGUuY2VudHJlWShvMi5nZXRCb3VuZHMoKSkpO307anN0cy5pbmRleC5zdHJ0cmVlLlNUUnRyZWUucHJvdG90eXBlLmNlbnRyZVg9ZnVuY3Rpb24oZSl7cmV0dXJuIGpzdHMuaW5kZXguc3RydHJlZS5TVFJ0cmVlLnByb3RvdHlwZS5hdmcoZS5nZXRNaW5YKCksZS5nZXRNYXhYKCkpO307anN0cy5pbmRleC5zdHJ0cmVlLlNUUnRyZWUucHJvdG90eXBlLmNlbnRyZVk9ZnVuY3Rpb24oZSl7cmV0dXJuIGpzdHMuaW5kZXguc3RydHJlZS5TVFJ0cmVlLnByb3RvdHlwZS5hdmcoZS5nZXRNaW5ZKCksZS5nZXRNYXhZKCkpO307anN0cy5pbmRleC5zdHJ0cmVlLlNUUnRyZWUucHJvdG90eXBlLmF2Zz1mdW5jdGlvbihhLGIpe3JldHVybihhK2IpLzIuMDt9O2pzdHMuaW5kZXguc3RydHJlZS5TVFJ0cmVlLnByb3RvdHlwZS5pbnRlcnNlY3RzT3A9e2ludGVyc2VjdHM6ZnVuY3Rpb24oYUJvdW5kcyxiQm91bmRzKXtyZXR1cm4gYUJvdW5kcy5pbnRlcnNlY3RzKGJCb3VuZHMpO319O2pzdHMuaW5kZXguc3RydHJlZS5TVFJ0cmVlLnByb3RvdHlwZS5jcmVhdGVQYXJlbnRCb3VuZGFibGVzPWZ1bmN0aW9uKGNoaWxkQm91bmRhYmxlcyxuZXdMZXZlbCl7anN0cy51dGlsLkFzc2VydC5pc1RydWUoIShjaGlsZEJvdW5kYWJsZXMubGVuZ3RoPT09MCkpO3ZhciBtaW5MZWFmQ291bnQ9TWF0aC5jZWlsKGNoaWxkQm91bmRhYmxlcy5sZW5ndGgvdGhpcy5nZXROb2RlQ2FwYWNpdHkoKSk7dmFyIHNvcnRlZENoaWxkQm91bmRhYmxlcz1bXTtmb3IodmFyIGk9MDtpPGNoaWxkQm91bmRhYmxlcy5sZW5ndGg7aSsrKXtzb3J0ZWRDaGlsZEJvdW5kYWJsZXMucHVzaChjaGlsZEJvdW5kYWJsZXNbaV0pO31cbnNvcnRlZENoaWxkQm91bmRhYmxlcy5zb3J0KHRoaXMueENvbXBhcmF0b3IpO3ZhciB2ZXJ0aWNhbFNsaWNlcz10aGlzLnZlcnRpY2FsU2xpY2VzKHNvcnRlZENoaWxkQm91bmRhYmxlcyxNYXRoLmNlaWwoTWF0aC5zcXJ0KG1pbkxlYWZDb3VudCkpKTtyZXR1cm4gdGhpcy5jcmVhdGVQYXJlbnRCb3VuZGFibGVzRnJvbVZlcnRpY2FsU2xpY2VzKHZlcnRpY2FsU2xpY2VzLG5ld0xldmVsKTt9O2pzdHMuaW5kZXguc3RydHJlZS5TVFJ0cmVlLnByb3RvdHlwZS5jcmVhdGVQYXJlbnRCb3VuZGFibGVzRnJvbVZlcnRpY2FsU2xpY2VzPWZ1bmN0aW9uKHZlcnRpY2FsU2xpY2VzLG5ld0xldmVsKXtqc3RzLnV0aWwuQXNzZXJ0LmlzVHJ1ZSh2ZXJ0aWNhbFNsaWNlcy5sZW5ndGg+MCk7dmFyIHBhcmVudEJvdW5kYWJsZXM9W107Zm9yKHZhciBpPTA7aTx2ZXJ0aWNhbFNsaWNlcy5sZW5ndGg7aSsrKXtwYXJlbnRCb3VuZGFibGVzPXBhcmVudEJvdW5kYWJsZXMuY29uY2F0KHRoaXMuY3JlYXRlUGFyZW50Qm91bmRhYmxlc0Zyb21WZXJ0aWNhbFNsaWNlKHZlcnRpY2FsU2xpY2VzW2ldLG5ld0xldmVsKSk7fVxucmV0dXJuIHBhcmVudEJvdW5kYWJsZXM7fTtqc3RzLmluZGV4LnN0cnRyZWUuU1RSdHJlZS5wcm90b3R5cGUuY3JlYXRlUGFyZW50Qm91bmRhYmxlc0Zyb21WZXJ0aWNhbFNsaWNlPWZ1bmN0aW9uKGNoaWxkQm91bmRhYmxlcyxuZXdMZXZlbCl7cmV0dXJuIGpzdHMuaW5kZXguc3RydHJlZS5BYnN0cmFjdFNUUnRyZWUucHJvdG90eXBlLmNyZWF0ZVBhcmVudEJvdW5kYWJsZXMuY2FsbCh0aGlzLGNoaWxkQm91bmRhYmxlcyxuZXdMZXZlbCk7fTtqc3RzLmluZGV4LnN0cnRyZWUuU1RSdHJlZS5wcm90b3R5cGUudmVydGljYWxTbGljZXM9ZnVuY3Rpb24oY2hpbGRCb3VuZGFibGVzLHNsaWNlQ291bnQpe3ZhciBzbGljZUNhcGFjaXR5PU1hdGguY2VpbChjaGlsZEJvdW5kYWJsZXMubGVuZ3RoL3NsaWNlQ291bnQpO3ZhciBzbGljZXM9W107dmFyIGk9MCxib3VuZGFibGVzQWRkZWRUb1NsaWNlLGNoaWxkQm91bmRhYmxlO2Zvcih2YXIgaj0wO2o8c2xpY2VDb3VudDtqKyspe3NsaWNlc1tqXT1bXTtib3VuZGFibGVzQWRkZWRUb1NsaWNlPTA7d2hpbGUoaTxjaGlsZEJvdW5kYWJsZXMubGVuZ3RoJiZib3VuZGFibGVzQWRkZWRUb1NsaWNlPHNsaWNlQ2FwYWNpdHkpe2NoaWxkQm91bmRhYmxlPWNoaWxkQm91bmRhYmxlc1tpKytdO3NsaWNlc1tqXS5wdXNoKGNoaWxkQm91bmRhYmxlKTtib3VuZGFibGVzQWRkZWRUb1NsaWNlKys7fX1cbnJldHVybiBzbGljZXM7fTtqc3RzLmluZGV4LnN0cnRyZWUuU1RSdHJlZS5ERUZBVUxUX05PREVfQ0FQQUNJVFk9MTA7anN0cy5pbmRleC5zdHJ0cmVlLlNUUnRyZWUucHJvdG90eXBlLmNyZWF0ZU5vZGU9ZnVuY3Rpb24obGV2ZWwpe3ZhciBhYnN0cmFjdE5vZGU9bmV3IGpzdHMuaW5kZXguc3RydHJlZS5BYnN0cmFjdE5vZGUobGV2ZWwpO2Fic3RyYWN0Tm9kZS5jb21wdXRlQm91bmRzPWZ1bmN0aW9uKCl7dmFyIGJvdW5kcz1udWxsO3ZhciBjaGlsZEJvdW5kYWJsZXM9dGhpcy5nZXRDaGlsZEJvdW5kYWJsZXMoKTtmb3IodmFyIGk9MDtpPGNoaWxkQm91bmRhYmxlcy5sZW5ndGg7aSsrKXt2YXIgY2hpbGRCb3VuZGFibGU9Y2hpbGRCb3VuZGFibGVzW2ldO2lmKGJvdW5kcz09PW51bGwpe2JvdW5kcz1uZXcganN0cy5nZW9tLkVudmVsb3BlKGNoaWxkQm91bmRhYmxlLmdldEJvdW5kcygpKTt9ZWxzZXtib3VuZHMuZXhwYW5kVG9JbmNsdWRlKGNoaWxkQm91bmRhYmxlLmdldEJvdW5kcygpKTt9fVxucmV0dXJuIGJvdW5kczt9O3JldHVybiBhYnN0cmFjdE5vZGU7fTtqc3RzLmluZGV4LnN0cnRyZWUuU1RSdHJlZS5wcm90b3R5cGUuZ2V0SW50ZXJzZWN0c09wPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuaW50ZXJzZWN0c09wO307anN0cy5pbmRleC5zdHJ0cmVlLlNUUnRyZWUucHJvdG90eXBlLmluc2VydD1mdW5jdGlvbihpdGVtRW52LGl0ZW0pe2lmKGl0ZW1FbnYuaXNOdWxsKCkpe3JldHVybjt9XG5qc3RzLmluZGV4LnN0cnRyZWUuQWJzdHJhY3RTVFJ0cmVlLnByb3RvdHlwZS5pbnNlcnQuY2FsbCh0aGlzLGl0ZW1FbnYsaXRlbSk7fTtqc3RzLmluZGV4LnN0cnRyZWUuU1RSdHJlZS5wcm90b3R5cGUucXVlcnk9ZnVuY3Rpb24oc2VhcmNoRW52LHZpc2l0b3Ipe3JldHVybiBqc3RzLmluZGV4LnN0cnRyZWUuQWJzdHJhY3RTVFJ0cmVlLnByb3RvdHlwZS5xdWVyeS5hcHBseSh0aGlzLGFyZ3VtZW50cyk7fTtqc3RzLmluZGV4LnN0cnRyZWUuU1RSdHJlZS5wcm90b3R5cGUucmVtb3ZlPWZ1bmN0aW9uKGl0ZW1FbnYsaXRlbSl7cmV0dXJuIGpzdHMuaW5kZXguc3RydHJlZS5BYnN0cmFjdFNUUnRyZWUucHJvdG90eXBlLnJlbW92ZS5jYWxsKHRoaXMsaXRlbUVudixpdGVtKTt9O2pzdHMuaW5kZXguc3RydHJlZS5TVFJ0cmVlLnByb3RvdHlwZS5zaXplPWZ1bmN0aW9uKCl7cmV0dXJuIGpzdHMuaW5kZXguc3RydHJlZS5BYnN0cmFjdFNUUnRyZWUucHJvdG90eXBlLnNpemUuY2FsbCh0aGlzKTt9O2pzdHMuaW5kZXguc3RydHJlZS5TVFJ0cmVlLnByb3RvdHlwZS5kZXB0aD1mdW5jdGlvbigpe3JldHVybiBqc3RzLmluZGV4LnN0cnRyZWUuQWJzdHJhY3RTVFJ0cmVlLnByb3RvdHlwZS5kZXB0aC5jYWxsKHRoaXMpO307anN0cy5pbmRleC5zdHJ0cmVlLlNUUnRyZWUucHJvdG90eXBlLmdldENvbXBhcmF0b3I9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy55Q29tcGFyYXRvcjt9O2pzdHMuaW5kZXguc3RydHJlZS5TVFJ0cmVlLnByb3RvdHlwZS5uZWFyZXN0TmVpZ2hib3VyPWZ1bmN0aW9uKGl0ZW1EaXN0KXt2YXIgYnA9bmV3IGpzdHMuaW5kZXguc3RydHJlZS5Cb3VuZGFibGVQYWlyKHRoaXMuZ2V0Um9vdCgpLHRoaXMuZ2V0Um9vdCgpLGl0ZW1EaXN0KTtyZXR1cm4gdGhpcy5uZWFyZXN0TmVpZ2hib3VyNChicCk7fTtqc3RzLmluZGV4LnN0cnRyZWUuU1RSdHJlZS5wcm90b3R5cGUubmVhcmVzdE5laWdoYm91cjI9ZnVuY3Rpb24oZW52LGl0ZW0saXRlbURpc3Qpe3ZhciBibmQ9bmV3IGpzdHMuaW5kZXguc3RydHJlZS5JdGVtQm91bmRhYmxlKGVudixpdGVtKTt2YXIgYnA9bmV3IGpzdHMuaW5kZXguc3RydHJlZS5Cb3VuZGFibGVQYWlyKHRoaXMuZ2V0Um9vdCgpLGJuZCxpdGVtRGlzdCk7cmV0dXJuIHRoaXMubmVhcmVzdE5laWdoYm91cjQoYnApWzBdO307anN0cy5pbmRleC5zdHJ0cmVlLlNUUnRyZWUucHJvdG90eXBlLm5lYXJlc3ROZWlnaGJvdXIzPWZ1bmN0aW9uKHRyZWUsaXRlbURpc3Qpe3ZhciBicD1uZXcganN0cy5pbmRleC5zdHJ0cmVlLkJvdW5kYWJsZVBhaXIodGhpcy5nZXRSb290KCksdHJlZS5nZXRSb290KCksaXRlbURpc3QpO3JldHVybiB0aGlzLm5lYXJlc3ROZWlnaGJvdXI0KGJwKTt9O2pzdHMuaW5kZXguc3RydHJlZS5TVFJ0cmVlLnByb3RvdHlwZS5uZWFyZXN0TmVpZ2hib3VyND1mdW5jdGlvbihpbml0Qm5kUGFpcil7cmV0dXJuIHRoaXMubmVhcmVzdE5laWdoYm91cjUoaW5pdEJuZFBhaXIsRG91YmxlLlBPU0lUSVZFX0lORklOSVRZKTt9O2pzdHMuaW5kZXguc3RydHJlZS5TVFJ0cmVlLnByb3RvdHlwZS5uZWFyZXN0TmVpZ2hib3VyNT1mdW5jdGlvbihpbml0Qm5kUGFpcixtYXhEaXN0YW5jZSl7dmFyIGRpc3RhbmNlTG93ZXJCb3VuZD1tYXhEaXN0YW5jZTt2YXIgbWluUGFpcj1udWxsO3ZhciBwcmlRPVtdO3ByaVEucHVzaChpbml0Qm5kUGFpcik7d2hpbGUoIXByaVEuaXNFbXB0eSgpJiZkaXN0YW5jZUxvd2VyQm91bmQ+MC4wKXt2YXIgYm5kUGFpcj1wcmlRLnBvcCgpO3ZhciBjdXJyZW50RGlzdGFuY2U9Ym5kUGFpci5nZXREaXN0YW5jZSgpO2lmKGN1cnJlbnREaXN0YW5jZT49ZGlzdGFuY2VMb3dlckJvdW5kKVxuYnJlYWs7aWYoYm5kUGFpci5pc0xlYXZlcygpKXtkaXN0YW5jZUxvd2VyQm91bmQ9Y3VycmVudERpc3RhbmNlO21pblBhaXI9Ym5kUGFpcjt9ZWxzZXtibmRQYWlyLmV4cGFuZFRvUXVldWUocHJpUSxkaXN0YW5jZUxvd2VyQm91bmQpO319XG5yZXR1cm5bbWluUGFpci5nZXRCb3VuZGFibGUoMCkuZ2V0SXRlbSgpLG1pblBhaXIuZ2V0Qm91bmRhYmxlKDEpLmdldEl0ZW0oKV07fTtqc3RzLm5vZGluZy5TZWdtZW50U3RyaW5nPWZ1bmN0aW9uKCl7fTtqc3RzLm5vZGluZy5TZWdtZW50U3RyaW5nLnByb3RvdHlwZS5nZXREYXRhPWpzdHMuYWJzdHJhY3RGdW5jO2pzdHMubm9kaW5nLlNlZ21lbnRTdHJpbmcucHJvdG90eXBlLnNldERhdGE9anN0cy5hYnN0cmFjdEZ1bmM7anN0cy5ub2RpbmcuU2VnbWVudFN0cmluZy5wcm90b3R5cGUuc2l6ZT1qc3RzLmFic3RyYWN0RnVuYztqc3RzLm5vZGluZy5TZWdtZW50U3RyaW5nLnByb3RvdHlwZS5nZXRDb29yZGluYXRlPWpzdHMuYWJzdHJhY3RGdW5jO2pzdHMubm9kaW5nLlNlZ21lbnRTdHJpbmcucHJvdG90eXBlLmdldENvb3JkaW5hdGVzPWpzdHMuYWJzdHJhY3RGdW5jO2pzdHMubm9kaW5nLlNlZ21lbnRTdHJpbmcucHJvdG90eXBlLmlzQ2xvc2VkPWpzdHMuYWJzdHJhY3RGdW5jO2pzdHMubm9kaW5nLk5vZGFibGVTZWdtZW50U3RyaW5nPWZ1bmN0aW9uKCl7fTtqc3RzLm5vZGluZy5Ob2RhYmxlU2VnbWVudFN0cmluZy5wcm90b3R5cGU9bmV3IGpzdHMubm9kaW5nLlNlZ21lbnRTdHJpbmcoKTtqc3RzLm5vZGluZy5Ob2RhYmxlU2VnbWVudFN0cmluZy5wcm90b3R5cGUuYWRkSW50ZXJzZWN0aW9uPWpzdHMuYWJzdHJhY3RGdW5jO2pzdHMubm9kaW5nLk5vZGVkU2VnbWVudFN0cmluZz1mdW5jdGlvbihwdHMsZGF0YSl7dGhpcy5ub2RlTGlzdD1uZXcganN0cy5ub2RpbmcuU2VnbWVudE5vZGVMaXN0KHRoaXMpO3RoaXMucHRzPXB0czt0aGlzLmRhdGE9ZGF0YTt9O2pzdHMubm9kaW5nLk5vZGVkU2VnbWVudFN0cmluZy5wcm90b3R5cGU9bmV3IGpzdHMubm9kaW5nLk5vZGFibGVTZWdtZW50U3RyaW5nKCk7anN0cy5ub2RpbmcuTm9kZWRTZWdtZW50U3RyaW5nLmNvbnN0cnVjdG9yPWpzdHMubm9kaW5nLk5vZGVkU2VnbWVudFN0cmluZztqc3RzLm5vZGluZy5Ob2RlZFNlZ21lbnRTdHJpbmcuZ2V0Tm9kZWRTdWJzdHJpbmdzPWZ1bmN0aW9uKHNlZ1N0cmluZ3Mpe2lmKGFyZ3VtZW50cy5sZW5ndGg9PT0yKXtqc3RzLm5vZGluZy5Ob2RlZFNlZ21lbnRTdHJpbmcuZ2V0Tm9kZWRTdWJzdHJpbmdzMi5hcHBseSh0aGlzLGFyZ3VtZW50cyk7cmV0dXJuO31cbnZhciByZXN1bHRFZGdlbGlzdD1uZXcgamF2YXNjcmlwdC51dGlsLkFycmF5TGlzdCgpO2pzdHMubm9kaW5nLk5vZGVkU2VnbWVudFN0cmluZy5nZXROb2RlZFN1YnN0cmluZ3MyKHNlZ1N0cmluZ3MscmVzdWx0RWRnZWxpc3QpO3JldHVybiByZXN1bHRFZGdlbGlzdDt9O2pzdHMubm9kaW5nLk5vZGVkU2VnbWVudFN0cmluZy5nZXROb2RlZFN1YnN0cmluZ3MyPWZ1bmN0aW9uKHNlZ1N0cmluZ3MscmVzdWx0RWRnZWxpc3Qpe2Zvcih2YXIgaT1zZWdTdHJpbmdzLml0ZXJhdG9yKCk7aS5oYXNOZXh0KCk7KXt2YXIgc3M9aS5uZXh0KCk7c3MuZ2V0Tm9kZUxpc3QoKS5hZGRTcGxpdEVkZ2VzKHJlc3VsdEVkZ2VsaXN0KTt9fTtqc3RzLm5vZGluZy5Ob2RlZFNlZ21lbnRTdHJpbmcucHJvdG90eXBlLm5vZGVMaXN0PW51bGw7anN0cy5ub2RpbmcuTm9kZWRTZWdtZW50U3RyaW5nLnByb3RvdHlwZS5wdHM9bnVsbDtqc3RzLm5vZGluZy5Ob2RlZFNlZ21lbnRTdHJpbmcucHJvdG90eXBlLmRhdGE9bnVsbDtqc3RzLm5vZGluZy5Ob2RlZFNlZ21lbnRTdHJpbmcucHJvdG90eXBlLmdldERhdGE9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5kYXRhO307anN0cy5ub2RpbmcuTm9kZWRTZWdtZW50U3RyaW5nLnByb3RvdHlwZS5zZXREYXRhPWZ1bmN0aW9uKGRhdGEpe3RoaXMuZGF0YT1kYXRhO307anN0cy5ub2RpbmcuTm9kZWRTZWdtZW50U3RyaW5nLnByb3RvdHlwZS5nZXROb2RlTGlzdD1mdW5jdGlvbigpe3JldHVybiB0aGlzLm5vZGVMaXN0O307anN0cy5ub2RpbmcuTm9kZWRTZWdtZW50U3RyaW5nLnByb3RvdHlwZS5zaXplPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMucHRzLmxlbmd0aDt9O2pzdHMubm9kaW5nLk5vZGVkU2VnbWVudFN0cmluZy5wcm90b3R5cGUuZ2V0Q29vcmRpbmF0ZT1mdW5jdGlvbihpKXtyZXR1cm4gdGhpcy5wdHNbaV07fTtqc3RzLm5vZGluZy5Ob2RlZFNlZ21lbnRTdHJpbmcucHJvdG90eXBlLmdldENvb3JkaW5hdGVzPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMucHRzO307anN0cy5ub2RpbmcuTm9kZWRTZWdtZW50U3RyaW5nLnByb3RvdHlwZS5pc0Nsb3NlZD1mdW5jdGlvbigpe3JldHVybiB0aGlzLnB0c1swXS5lcXVhbHModGhpcy5wdHNbdGhpcy5wdHMubGVuZ3RoLTFdKTt9O2pzdHMubm9kaW5nLk5vZGVkU2VnbWVudFN0cmluZy5wcm90b3R5cGUuZ2V0U2VnbWVudE9jdGFudD1mdW5jdGlvbihpbmRleCl7aWYoaW5kZXg9PT10aGlzLnB0cy5sZW5ndGgtMSlcbnJldHVybi0xO3JldHVybiB0aGlzLnNhZmVPY3RhbnQodGhpcy5nZXRDb29yZGluYXRlKGluZGV4KSx0aGlzLmdldENvb3JkaW5hdGUoaW5kZXgrMSkpO307anN0cy5ub2RpbmcuTm9kZWRTZWdtZW50U3RyaW5nLnByb3RvdHlwZS5zYWZlT2N0YW50PWZ1bmN0aW9uKHAwLHAxKXtpZihwMC5lcXVhbHMyRChwMSkpXG5yZXR1cm4gMDtyZXR1cm4ganN0cy5ub2RpbmcuT2N0YW50Lm9jdGFudChwMCxwMSk7fTtqc3RzLm5vZGluZy5Ob2RlZFNlZ21lbnRTdHJpbmcucHJvdG90eXBlLmFkZEludGVyc2VjdGlvbnM9ZnVuY3Rpb24obGksc2VnbWVudEluZGV4LGdlb21JbmRleCl7Zm9yKHZhciBpPTA7aTxsaS5nZXRJbnRlcnNlY3Rpb25OdW0oKTtpKyspe3RoaXMuYWRkSW50ZXJzZWN0aW9uKGxpLHNlZ21lbnRJbmRleCxnZW9tSW5kZXgsaSk7fX07anN0cy5ub2RpbmcuTm9kZWRTZWdtZW50U3RyaW5nLnByb3RvdHlwZS5hZGRJbnRlcnNlY3Rpb249ZnVuY3Rpb24obGksc2VnbWVudEluZGV4LGdlb21JbmRleCxpbnRJbmRleCl7aWYobGkgaW5zdGFuY2VvZiBqc3RzLmdlb20uQ29vcmRpbmF0ZSl7dGhpcy5hZGRJbnRlcnNlY3Rpb24yLmFwcGx5KHRoaXMsYXJndW1lbnRzKTtyZXR1cm47fVxudmFyIGludFB0PW5ldyBqc3RzLmdlb20uQ29vcmRpbmF0ZShsaS5nZXRJbnRlcnNlY3Rpb24oaW50SW5kZXgpKTt0aGlzLmFkZEludGVyc2VjdGlvbjIoaW50UHQsc2VnbWVudEluZGV4KTt9O2pzdHMubm9kaW5nLk5vZGVkU2VnbWVudFN0cmluZy5wcm90b3R5cGUuYWRkSW50ZXJzZWN0aW9uMj1mdW5jdGlvbihpbnRQdCxzZWdtZW50SW5kZXgpe3RoaXMuYWRkSW50ZXJzZWN0aW9uTm9kZShpbnRQdCxzZWdtZW50SW5kZXgpO307anN0cy5ub2RpbmcuTm9kZWRTZWdtZW50U3RyaW5nLnByb3RvdHlwZS5hZGRJbnRlcnNlY3Rpb25Ob2RlPWZ1bmN0aW9uKGludFB0LHNlZ21lbnRJbmRleCl7dmFyIG5vcm1hbGl6ZWRTZWdtZW50SW5kZXg9c2VnbWVudEluZGV4O3ZhciBuZXh0U2VnSW5kZXg9bm9ybWFsaXplZFNlZ21lbnRJbmRleCsxO2lmKG5leHRTZWdJbmRleDx0aGlzLnB0cy5sZW5ndGgpe3ZhciBuZXh0UHQ9dGhpcy5wdHNbbmV4dFNlZ0luZGV4XTtpZihpbnRQdC5lcXVhbHMyRChuZXh0UHQpKXtub3JtYWxpemVkU2VnbWVudEluZGV4PW5leHRTZWdJbmRleDt9fVxudmFyIGVpPXRoaXMubm9kZUxpc3QuYWRkKGludFB0LG5vcm1hbGl6ZWRTZWdtZW50SW5kZXgpO3JldHVybiBlaTt9O2pzdHMubm9kaW5nLk5vZGVkU2VnbWVudFN0cmluZy5wcm90b3R5cGUudG9TdHJpbmc9ZnVuY3Rpb24oKXt2YXIgZ2VvbWV0cnlGYWN0b3J5PW5ldyBqc3RzLmdlb20uR2VvbWV0cnlGYWN0b3J5KCk7cmV0dXJuIG5ldyBqc3RzLmlvLldLVFdyaXRlcigpLndyaXRlKGdlb21ldHJ5RmFjdG9yeS5jcmVhdGVMaW5lU3RyaW5nKHRoaXMucHRzKSk7fTtqc3RzLmluZGV4LmNoYWluLk1vbm90b25lQ2hhaW5CdWlsZGVyPWZ1bmN0aW9uKCl7fTtqc3RzLmluZGV4LmNoYWluLk1vbm90b25lQ2hhaW5CdWlsZGVyLnRvSW50QXJyYXk9ZnVuY3Rpb24obGlzdCl7dmFyIGFycmF5PVtdO2Zvcih2YXIgaT0wO2k8bGlzdC5sZW5ndGg7aSsrKXthcnJheVtpXT1saXN0W2ldO31cbnJldHVybiBhcnJheTt9O2pzdHMuaW5kZXguY2hhaW4uTW9ub3RvbmVDaGFpbkJ1aWxkZXIuZ2V0Q2hhaW5zPWZ1bmN0aW9uKHB0cyl7aWYoYXJndW1lbnRzLmxlbmd0aD09PTIpe3JldHVybiBqc3RzLmluZGV4LmNoYWluLk1vbm90b25lQ2hhaW5CdWlsZGVyLmdldENoYWluczIuYXBwbHkodGhpcyxhcmd1bWVudHMpO31cbnJldHVybiBqc3RzLmluZGV4LmNoYWluLk1vbm90b25lQ2hhaW5CdWlsZGVyLmdldENoYWluczIocHRzLG51bGwpO307anN0cy5pbmRleC5jaGFpbi5Nb25vdG9uZUNoYWluQnVpbGRlci5nZXRDaGFpbnMyPWZ1bmN0aW9uKHB0cyxjb250ZXh0KXt2YXIgbWNMaXN0PVtdO3ZhciBzdGFydEluZGV4PWpzdHMuaW5kZXguY2hhaW4uTW9ub3RvbmVDaGFpbkJ1aWxkZXIuZ2V0Q2hhaW5TdGFydEluZGljZXMocHRzKTtmb3IodmFyIGk9MDtpPHN0YXJ0SW5kZXgubGVuZ3RoLTE7aSsrKXt2YXIgbWM9bmV3IGpzdHMuaW5kZXguY2hhaW4uTW9ub3RvbmVDaGFpbihwdHMsc3RhcnRJbmRleFtpXSxzdGFydEluZGV4W2krMV0sY29udGV4dCk7bWNMaXN0LnB1c2gobWMpO31cbnJldHVybiBtY0xpc3Q7fTtqc3RzLmluZGV4LmNoYWluLk1vbm90b25lQ2hhaW5CdWlsZGVyLmdldENoYWluU3RhcnRJbmRpY2VzPWZ1bmN0aW9uKHB0cyl7dmFyIHN0YXJ0PTA7dmFyIHN0YXJ0SW5kZXhMaXN0PVtdO3N0YXJ0SW5kZXhMaXN0LnB1c2goc3RhcnQpO2Rve3ZhciBsYXN0PWpzdHMuaW5kZXguY2hhaW4uTW9ub3RvbmVDaGFpbkJ1aWxkZXIuZmluZENoYWluRW5kKHB0cyxzdGFydCk7c3RhcnRJbmRleExpc3QucHVzaChsYXN0KTtzdGFydD1sYXN0O313aGlsZShzdGFydDxwdHMubGVuZ3RoLTEpO3ZhciBzdGFydEluZGV4PWpzdHMuaW5kZXguY2hhaW4uTW9ub3RvbmVDaGFpbkJ1aWxkZXIudG9JbnRBcnJheShzdGFydEluZGV4TGlzdCk7cmV0dXJuIHN0YXJ0SW5kZXg7fTtqc3RzLmluZGV4LmNoYWluLk1vbm90b25lQ2hhaW5CdWlsZGVyLmZpbmRDaGFpbkVuZD1mdW5jdGlvbihwdHMsc3RhcnQpe3ZhciBzYWZlU3RhcnQ9c3RhcnQ7d2hpbGUoc2FmZVN0YXJ0PHB0cy5sZW5ndGgtMSYmcHRzW3NhZmVTdGFydF0uZXF1YWxzMkQocHRzW3NhZmVTdGFydCsxXSkpe3NhZmVTdGFydCsrO31cbmlmKHNhZmVTdGFydD49cHRzLmxlbmd0aC0xKXtyZXR1cm4gcHRzLmxlbmd0aC0xO31cbnZhciBjaGFpblF1YWQ9anN0cy5nZW9tZ3JhcGguUXVhZHJhbnQucXVhZHJhbnQocHRzW3NhZmVTdGFydF0scHRzW3NhZmVTdGFydCsxXSk7dmFyIGxhc3Q9c3RhcnQrMTt3aGlsZShsYXN0PHB0cy5sZW5ndGgpe2lmKCFwdHNbbGFzdC0xXS5lcXVhbHMyRChwdHNbbGFzdF0pKXt2YXIgcXVhZD1qc3RzLmdlb21ncmFwaC5RdWFkcmFudC5xdWFkcmFudChwdHNbbGFzdC0xXSxwdHNbbGFzdF0pO2lmKHF1YWQhPT1jaGFpblF1YWQpXG5icmVhazt9XG5sYXN0Kys7fVxucmV0dXJuIGxhc3QtMTt9O2pzdHMuYWxnb3JpdGhtLkxpbmVJbnRlcnNlY3Rvcj1mdW5jdGlvbigpe3RoaXMuaW5wdXRMaW5lcz1bW10sW11dO3RoaXMuaW50UHQ9W251bGwsbnVsbF07dGhpcy5wYT10aGlzLmludFB0WzBdO3RoaXMucGI9dGhpcy5pbnRQdFsxXTt0aGlzLnJlc3VsdD1qc3RzLmFsZ29yaXRobS5MaW5lSW50ZXJzZWN0b3IuTk9fSU5URVJTRUNUSU9OO307anN0cy5hbGdvcml0aG0uTGluZUludGVyc2VjdG9yLk5PX0lOVEVSU0VDVElPTj0wO2pzdHMuYWxnb3JpdGhtLkxpbmVJbnRlcnNlY3Rvci5QT0lOVF9JTlRFUlNFQ1RJT049MTtqc3RzLmFsZ29yaXRobS5MaW5lSW50ZXJzZWN0b3IuQ09MTElORUFSX0lOVEVSU0VDVElPTj0yO2pzdHMuYWxnb3JpdGhtLkxpbmVJbnRlcnNlY3Rvci5wcm90b3R5cGUuc2V0UHJlY2lzaW9uTW9kZWw9ZnVuY3Rpb24ocHJlY2lzaW9uTW9kZWwpe3RoaXMucHJlY2lzaW9uTW9kZWw9cHJlY2lzaW9uTW9kZWw7fTtqc3RzLmFsZ29yaXRobS5MaW5lSW50ZXJzZWN0b3IucHJvdG90eXBlLmdldEVuZHBvaW50PWZ1bmN0aW9uKHNlZ21lbnRJbmRleCxwdEluZGV4KXtyZXR1cm4gdGhpcy5pbnB1dExpbmVzW3NlZ21lbnRJbmRleF1bcHRJbmRleF07fTtqc3RzLmFsZ29yaXRobS5MaW5lSW50ZXJzZWN0b3IuY29tcHV0ZUVkZ2VEaXN0YW5jZT1mdW5jdGlvbihwLHAwLHAxKXt2YXIgZHg9TWF0aC5hYnMocDEueC1wMC54KTt2YXIgZHk9TWF0aC5hYnMocDEueS1wMC55KTt2YXIgZGlzdD0tMS4wO2lmKHAuZXF1YWxzKHAwKSl7ZGlzdD0wLjA7fWVsc2UgaWYocC5lcXVhbHMocDEpKXtpZihkeD5keSl7ZGlzdD1keDt9ZWxzZXtkaXN0PWR5O319ZWxzZXt2YXIgcGR4PU1hdGguYWJzKHAueC1wMC54KTt2YXIgcGR5PU1hdGguYWJzKHAueS1wMC55KTtpZihkeD5keSl7ZGlzdD1wZHg7fWVsc2V7ZGlzdD1wZHk7fVxuaWYoZGlzdD09PTAuMCYmIXAuZXF1YWxzKHAwKSl7ZGlzdD1NYXRoLm1heChwZHgscGR5KTt9fVxuaWYoZGlzdD09PTAuMCYmIXAuZXF1YWxzKHAwKSl7dGhyb3cgbmV3IGpzdHMuZXJyb3IuSWxsZWdhbEFyZ3VtZW50RXJyb3IoJ0JhZCBkaXN0YW5jZSBjYWxjdWxhdGlvbicpO31cbnJldHVybiBkaXN0O307anN0cy5hbGdvcml0aG0uTGluZUludGVyc2VjdG9yLm5vblJvYnVzdENvbXB1dGVFZGdlRGlzdGFuY2U9ZnVuY3Rpb24ocCxwMSxwMil7dmFyIGR4PXAueC1wMS54O3ZhciBkeT1wLnktcDEueTt2YXIgZGlzdD1NYXRoLnNxcnQoZHgqZHgrZHkqZHkpO2lmKCEoZGlzdD09PTAuMCYmIXAuZXF1YWxzKHAxKSkpe3Rocm93IG5ldyBqc3RzLmVycm9yLklsbGVnYWxBcmd1bWVudEVycm9yKCdJbnZhbGlkIGRpc3RhbmNlIGNhbGN1bGF0aW9uJyk7fVxucmV0dXJuIGRpc3Q7fTtqc3RzLmFsZ29yaXRobS5MaW5lSW50ZXJzZWN0b3IucHJvdG90eXBlLnJlc3VsdD1udWxsO2pzdHMuYWxnb3JpdGhtLkxpbmVJbnRlcnNlY3Rvci5wcm90b3R5cGUuaW5wdXRMaW5lcz1udWxsO2pzdHMuYWxnb3JpdGhtLkxpbmVJbnRlcnNlY3Rvci5wcm90b3R5cGUuaW50UHQ9bnVsbDtqc3RzLmFsZ29yaXRobS5MaW5lSW50ZXJzZWN0b3IucHJvdG90eXBlLmludExpbmVJbmRleD1udWxsO2pzdHMuYWxnb3JpdGhtLkxpbmVJbnRlcnNlY3Rvci5wcm90b3R5cGUuX2lzUHJvcGVyPW51bGw7anN0cy5hbGdvcml0aG0uTGluZUludGVyc2VjdG9yLnByb3RvdHlwZS5wYT1udWxsO2pzdHMuYWxnb3JpdGhtLkxpbmVJbnRlcnNlY3Rvci5wcm90b3R5cGUucGI9bnVsbDtqc3RzLmFsZ29yaXRobS5MaW5lSW50ZXJzZWN0b3IucHJvdG90eXBlLnByZWNpc2lvbk1vZGVsPW51bGw7anN0cy5hbGdvcml0aG0uTGluZUludGVyc2VjdG9yLnByb3RvdHlwZS5jb21wdXRlSW50ZXJzZWN0aW9uPWZ1bmN0aW9uKHAscDEscDIpe3Rocm93IG5ldyBqc3RzLmVycm9yLkFic3RyYWN0TWV0aG9kSW52b2NhdGlvbkVycm9yKCk7fTtqc3RzLmFsZ29yaXRobS5MaW5lSW50ZXJzZWN0b3IucHJvdG90eXBlLmlzQ29sbGluZWFyPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMucmVzdWx0PT09anN0cy5hbGdvcml0aG0uTGluZUludGVyc2VjdG9yLkNPTExJTkVBUl9JTlRFUlNFQ1RJT047fTtqc3RzLmFsZ29yaXRobS5MaW5lSW50ZXJzZWN0b3IucHJvdG90eXBlLmNvbXB1dGVJbnRlcnNlY3Rpb249ZnVuY3Rpb24ocDEscDIscDMscDQpe3RoaXMuaW5wdXRMaW5lc1swXVswXT1wMTt0aGlzLmlucHV0TGluZXNbMF1bMV09cDI7dGhpcy5pbnB1dExpbmVzWzFdWzBdPXAzO3RoaXMuaW5wdXRMaW5lc1sxXVsxXT1wNDt0aGlzLnJlc3VsdD10aGlzLmNvbXB1dGVJbnRlcnNlY3QocDEscDIscDMscDQpO307anN0cy5hbGdvcml0aG0uTGluZUludGVyc2VjdG9yLnByb3RvdHlwZS5jb21wdXRlSW50ZXJzZWN0PWZ1bmN0aW9uKHAxLHAyLHExLHEyKXt0aHJvdyBuZXcganN0cy5lcnJvci5BYnN0cmFjdE1ldGhvZEludm9jYXRpb25FcnJvcigpO307anN0cy5hbGdvcml0aG0uTGluZUludGVyc2VjdG9yLnByb3RvdHlwZS5pc0VuZFBvaW50PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuaGFzSW50ZXJzZWN0aW9uKCkmJiF0aGlzLl9pc1Byb3Blcjt9O2pzdHMuYWxnb3JpdGhtLkxpbmVJbnRlcnNlY3Rvci5wcm90b3R5cGUuaGFzSW50ZXJzZWN0aW9uPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMucmVzdWx0IT09anN0cy5hbGdvcml0aG0uTGluZUludGVyc2VjdG9yLk5PX0lOVEVSU0VDVElPTjt9O2pzdHMuYWxnb3JpdGhtLkxpbmVJbnRlcnNlY3Rvci5wcm90b3R5cGUuZ2V0SW50ZXJzZWN0aW9uTnVtPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMucmVzdWx0O307anN0cy5hbGdvcml0aG0uTGluZUludGVyc2VjdG9yLnByb3RvdHlwZS5nZXRJbnRlcnNlY3Rpb249ZnVuY3Rpb24oaW50SW5kZXgpe3JldHVybiB0aGlzLmludFB0W2ludEluZGV4XTt9O2pzdHMuYWxnb3JpdGhtLkxpbmVJbnRlcnNlY3Rvci5wcm90b3R5cGUuY29tcHV0ZUludExpbmVJbmRleD1mdW5jdGlvbigpe2lmKHRoaXMuaW50TGluZUluZGV4PT09bnVsbCl7dGhpcy5pbnRMaW5lSW5kZXg9W1tdLFtdXTt0aGlzLmNvbXB1dGVJbnRMaW5lSW5kZXgoMCk7dGhpcy5jb21wdXRlSW50TGluZUluZGV4KDEpO319O2pzdHMuYWxnb3JpdGhtLkxpbmVJbnRlcnNlY3Rvci5wcm90b3R5cGUuaXNJbnRlcnNlY3Rpb249ZnVuY3Rpb24ocHQpe3ZhciBpO2ZvcihpPTA7aTx0aGlzLnJlc3VsdDtpKyspe2lmKHRoaXMuaW50UHRbaV0uZXF1YWxzMkQocHQpKXtyZXR1cm4gdHJ1ZTt9fVxucmV0dXJuIGZhbHNlO307anN0cy5hbGdvcml0aG0uTGluZUludGVyc2VjdG9yLnByb3RvdHlwZS5pc0ludGVyaW9ySW50ZXJzZWN0aW9uPWZ1bmN0aW9uKCl7aWYoYXJndW1lbnRzLmxlbmd0aD09PTEpe3JldHVybiB0aGlzLmlzSW50ZXJpb3JJbnRlcnNlY3Rpb24yLmFwcGx5KHRoaXMsYXJndW1lbnRzKTt9XG5pZih0aGlzLmlzSW50ZXJpb3JJbnRlcnNlY3Rpb24oMCkpe3JldHVybiB0cnVlO31cbmlmKHRoaXMuaXNJbnRlcmlvckludGVyc2VjdGlvbigxKSl7cmV0dXJuIHRydWU7fVxucmV0dXJuIGZhbHNlO307anN0cy5hbGdvcml0aG0uTGluZUludGVyc2VjdG9yLnByb3RvdHlwZS5pc0ludGVyaW9ySW50ZXJzZWN0aW9uMj1mdW5jdGlvbihpbnB1dExpbmVJbmRleCl7dmFyIGk7Zm9yKGk9MDtpPHRoaXMucmVzdWx0O2krKyl7aWYoISh0aGlzLmludFB0W2ldLmVxdWFsczJEKHRoaXMuaW5wdXRMaW5lc1tpbnB1dExpbmVJbmRleF1bMF0pfHx0aGlzLmludFB0W2ldLmVxdWFsczJEKHRoaXMuaW5wdXRMaW5lc1tpbnB1dExpbmVJbmRleF1bMV0pKSl7cmV0dXJuIHRydWU7fX1cbnJldHVybiBmYWxzZTt9O2pzdHMuYWxnb3JpdGhtLkxpbmVJbnRlcnNlY3Rvci5wcm90b3R5cGUuaXNQcm9wZXI9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5oYXNJbnRlcnNlY3Rpb24oKSYmdGhpcy5faXNQcm9wZXI7fTtqc3RzLmFsZ29yaXRobS5MaW5lSW50ZXJzZWN0b3IucHJvdG90eXBlLmdldEludGVyc2VjdGlvbkFsb25nU2VnbWVudD1mdW5jdGlvbihzZWdtZW50SW5kZXgsaW50SW5kZXgpe3RoaXMuY29tcHV0ZUludExpbmVJbmRleCgpO3JldHVybiB0aGlzLmludFB0W2ludExpbmVJbmRleFtzZWdtZW50SW5kZXhdW2ludEluZGV4XV07fTtqc3RzLmFsZ29yaXRobS5MaW5lSW50ZXJzZWN0b3IucHJvdG90eXBlLmdldEluZGV4QWxvbmdTZWdtZW50PWZ1bmN0aW9uKHNlZ21lbnRJbmRleCxpbnRJbmRleCl7dGhpcy5jb21wdXRlSW50TGluZUluZGV4KCk7cmV0dXJuIHRoaXMuaW50TGluZUluZGV4W3NlZ21lbnRJbmRleF1baW50SW5kZXhdO307anN0cy5hbGdvcml0aG0uTGluZUludGVyc2VjdG9yLnByb3RvdHlwZS5jb21wdXRlSW50TGluZUluZGV4PWZ1bmN0aW9uKHNlZ21lbnRJbmRleCl7dmFyIGRpc3QwPXRoaXMuZ2V0RWRnZURpc3RhbmNlKHNlZ21lbnRJbmRleCwwKTt2YXIgZGlzdDE9dGhpcy5nZXRFZGdlRGlzdGFuY2Uoc2VnbWVudEluZGV4LDEpO2lmKGRpc3QwPmRpc3QxKXt0aGlzLmludExpbmVJbmRleFtzZWdtZW50SW5kZXhdWzBdPTA7dGhpcy5pbnRMaW5lSW5kZXhbc2VnbWVudEluZGV4XVsxXT0xO31lbHNle3RoaXMuaW50TGluZUluZGV4W3NlZ21lbnRJbmRleF1bMF09MTt0aGlzLmludExpbmVJbmRleFtzZWdtZW50SW5kZXhdWzFdPTA7fX07anN0cy5hbGdvcml0aG0uTGluZUludGVyc2VjdG9yLnByb3RvdHlwZS5nZXRFZGdlRGlzdGFuY2U9ZnVuY3Rpb24oc2VnbWVudEluZGV4LGludEluZGV4KXt2YXIgZGlzdD1qc3RzLmFsZ29yaXRobS5MaW5lSW50ZXJzZWN0b3IuY29tcHV0ZUVkZ2VEaXN0YW5jZSh0aGlzLmludFB0W2ludEluZGV4XSx0aGlzLmlucHV0TGluZXNbc2VnbWVudEluZGV4XVswXSx0aGlzLmlucHV0TGluZXNbc2VnbWVudEluZGV4XVsxXSk7cmV0dXJuIGRpc3Q7fTtqc3RzLmFsZ29yaXRobS5Sb2J1c3RMaW5lSW50ZXJzZWN0b3I9ZnVuY3Rpb24oKXtqc3RzLmFsZ29yaXRobS5Sb2J1c3RMaW5lSW50ZXJzZWN0b3IucHJvdG90eXBlLmNvbnN0cnVjdG9yLmNhbGwodGhpcyk7fTtqc3RzLmFsZ29yaXRobS5Sb2J1c3RMaW5lSW50ZXJzZWN0b3IucHJvdG90eXBlPW5ldyBqc3RzLmFsZ29yaXRobS5MaW5lSW50ZXJzZWN0b3IoKTtqc3RzLmFsZ29yaXRobS5Sb2J1c3RMaW5lSW50ZXJzZWN0b3IucHJvdG90eXBlLmNvbXB1dGVJbnRlcnNlY3Rpb249ZnVuY3Rpb24ocCxwMSxwMil7aWYoYXJndW1lbnRzLmxlbmd0aD09PTQpe2pzdHMuYWxnb3JpdGhtLkxpbmVJbnRlcnNlY3Rvci5wcm90b3R5cGUuY29tcHV0ZUludGVyc2VjdGlvbi5hcHBseSh0aGlzLGFyZ3VtZW50cyk7cmV0dXJuO31cbnRoaXMuX2lzUHJvcGVyPWZhbHNlO2lmKGpzdHMuZ2VvbS5FbnZlbG9wZS5pbnRlcnNlY3RzKHAxLHAyLHApKXtpZigoanN0cy5hbGdvcml0aG0uQ0dBbGdvcml0aG1zLm9yaWVudGF0aW9uSW5kZXgocDEscDIscCk9PT0wKSYmKGpzdHMuYWxnb3JpdGhtLkNHQWxnb3JpdGhtcy5vcmllbnRhdGlvbkluZGV4KHAyLHAxLHApPT09MCkpe3RoaXMuX2lzUHJvcGVyPXRydWU7aWYocC5lcXVhbHMocDEpfHxwLmVxdWFscyhwMikpe3RoaXMuX2lzUHJvcGVyPWZhbHNlO31cbnRoaXMucmVzdWx0PWpzdHMuYWxnb3JpdGhtLkxpbmVJbnRlcnNlY3Rvci5QT0lOVF9JTlRFUlNFQ1RJT047cmV0dXJuO319XG50aGlzLnJlc3VsdD1qc3RzLmFsZ29yaXRobS5MaW5lSW50ZXJzZWN0b3IuTk9fSU5URVJTRUNUSU9OO307anN0cy5hbGdvcml0aG0uUm9idXN0TGluZUludGVyc2VjdG9yLnByb3RvdHlwZS5jb21wdXRlSW50ZXJzZWN0PWZ1bmN0aW9uKHAxLHAyLHExLHEyKXt0aGlzLl9pc1Byb3Blcj1mYWxzZTtpZighanN0cy5nZW9tLkVudmVsb3BlLmludGVyc2VjdHMocDEscDIscTEscTIpKXtyZXR1cm4ganN0cy5hbGdvcml0aG0uTGluZUludGVyc2VjdG9yLk5PX0lOVEVSU0VDVElPTjt9XG52YXIgUHExPWpzdHMuYWxnb3JpdGhtLkNHQWxnb3JpdGhtcy5vcmllbnRhdGlvbkluZGV4KHAxLHAyLHExKTt2YXIgUHEyPWpzdHMuYWxnb3JpdGhtLkNHQWxnb3JpdGhtcy5vcmllbnRhdGlvbkluZGV4KHAxLHAyLHEyKTtpZigoUHExPjAmJlBxMj4wKXx8KFBxMTwwJiZQcTI8MCkpe3JldHVybiBqc3RzLmFsZ29yaXRobS5MaW5lSW50ZXJzZWN0b3IuTk9fSU5URVJTRUNUSU9OO31cbnZhciBRcDE9anN0cy5hbGdvcml0aG0uQ0dBbGdvcml0aG1zLm9yaWVudGF0aW9uSW5kZXgocTEscTIscDEpO3ZhciBRcDI9anN0cy5hbGdvcml0aG0uQ0dBbGdvcml0aG1zLm9yaWVudGF0aW9uSW5kZXgocTEscTIscDIpO2lmKChRcDE+MCYmUXAyPjApfHwoUXAxPDAmJlFwMjwwKSl7cmV0dXJuIGpzdHMuYWxnb3JpdGhtLkxpbmVJbnRlcnNlY3Rvci5OT19JTlRFUlNFQ1RJT047fVxudmFyIGNvbGxpbmVhcj1QcTE9PT0wJiZQcTI9PT0wJiZRcDE9PT0wJiZRcDI9PT0wO2lmKGNvbGxpbmVhcil7cmV0dXJuIHRoaXMuY29tcHV0ZUNvbGxpbmVhckludGVyc2VjdGlvbihwMSxwMixxMSxxMik7fVxuaWYoUHExPT09MHx8UHEyPT09MHx8UXAxPT09MHx8UXAyPT09MCl7dGhpcy5faXNQcm9wZXI9ZmFsc2U7aWYocDEuZXF1YWxzMkQocTEpfHxwMS5lcXVhbHMyRChxMikpe3RoaXMuaW50UHRbMF09cDE7fWVsc2UgaWYocDIuZXF1YWxzMkQocTEpfHxwMi5lcXVhbHMyRChxMikpe3RoaXMuaW50UHRbMF09cDI7fVxuZWxzZSBpZihQcTE9PT0wKXt0aGlzLmludFB0WzBdPW5ldyBqc3RzLmdlb20uQ29vcmRpbmF0ZShxMSk7fWVsc2UgaWYoUHEyPT09MCl7dGhpcy5pbnRQdFswXT1uZXcganN0cy5nZW9tLkNvb3JkaW5hdGUocTIpO31lbHNlIGlmKFFwMT09PTApe3RoaXMuaW50UHRbMF09bmV3IGpzdHMuZ2VvbS5Db29yZGluYXRlKHAxKTt9ZWxzZSBpZihRcDI9PT0wKXt0aGlzLmludFB0WzBdPW5ldyBqc3RzLmdlb20uQ29vcmRpbmF0ZShwMik7fX1lbHNle3RoaXMuX2lzUHJvcGVyPXRydWU7dGhpcy5pbnRQdFswXT10aGlzLmludGVyc2VjdGlvbihwMSxwMixxMSxxMik7fVxucmV0dXJuIGpzdHMuYWxnb3JpdGhtLkxpbmVJbnRlcnNlY3Rvci5QT0lOVF9JTlRFUlNFQ1RJT047fTtqc3RzLmFsZ29yaXRobS5Sb2J1c3RMaW5lSW50ZXJzZWN0b3IucHJvdG90eXBlLmNvbXB1dGVDb2xsaW5lYXJJbnRlcnNlY3Rpb249ZnVuY3Rpb24ocDEscDIscTEscTIpe3ZhciBwMXExcDI9anN0cy5nZW9tLkVudmVsb3BlLmludGVyc2VjdHMocDEscDIscTEpO3ZhciBwMXEycDI9anN0cy5nZW9tLkVudmVsb3BlLmludGVyc2VjdHMocDEscDIscTIpO3ZhciBxMXAxcTI9anN0cy5nZW9tLkVudmVsb3BlLmludGVyc2VjdHMocTEscTIscDEpO3ZhciBxMXAycTI9anN0cy5nZW9tLkVudmVsb3BlLmludGVyc2VjdHMocTEscTIscDIpO2lmKHAxcTFwMiYmcDFxMnAyKXt0aGlzLmludFB0WzBdPXExO3RoaXMuaW50UHRbMV09cTI7cmV0dXJuIGpzdHMuYWxnb3JpdGhtLkxpbmVJbnRlcnNlY3Rvci5DT0xMSU5FQVJfSU5URVJTRUNUSU9OO31cbmlmKHExcDFxMiYmcTFwMnEyKXt0aGlzLmludFB0WzBdPXAxO3RoaXMuaW50UHRbMV09cDI7cmV0dXJuIGpzdHMuYWxnb3JpdGhtLkxpbmVJbnRlcnNlY3Rvci5DT0xMSU5FQVJfSU5URVJTRUNUSU9OO31cbmlmKHAxcTFwMiYmcTFwMXEyKXt0aGlzLmludFB0WzBdPXExO3RoaXMuaW50UHRbMV09cDE7cmV0dXJuIHExLmVxdWFscyhwMSkmJiFwMXEycDImJiFxMXAycTI/anN0cy5hbGdvcml0aG0uTGluZUludGVyc2VjdG9yLlBPSU5UX0lOVEVSU0VDVElPTjpqc3RzLmFsZ29yaXRobS5MaW5lSW50ZXJzZWN0b3IuQ09MTElORUFSX0lOVEVSU0VDVElPTjt9XG5pZihwMXExcDImJnExcDJxMil7dGhpcy5pbnRQdFswXT1xMTt0aGlzLmludFB0WzFdPXAyO3JldHVybiBxMS5lcXVhbHMocDIpJiYhcDFxMnAyJiYhcTFwMXEyP2pzdHMuYWxnb3JpdGhtLkxpbmVJbnRlcnNlY3Rvci5QT0lOVF9JTlRFUlNFQ1RJT046anN0cy5hbGdvcml0aG0uTGluZUludGVyc2VjdG9yLkNPTExJTkVBUl9JTlRFUlNFQ1RJT047fVxuaWYocDFxMnAyJiZxMXAxcTIpe3RoaXMuaW50UHRbMF09cTI7dGhpcy5pbnRQdFsxXT1wMTtyZXR1cm4gcTIuZXF1YWxzKHAxKSYmIXAxcTFwMiYmIXExcDJxMj9qc3RzLmFsZ29yaXRobS5MaW5lSW50ZXJzZWN0b3IuUE9JTlRfSU5URVJTRUNUSU9OOmpzdHMuYWxnb3JpdGhtLkxpbmVJbnRlcnNlY3Rvci5DT0xMSU5FQVJfSU5URVJTRUNUSU9OO31cbmlmKHAxcTJwMiYmcTFwMnEyKXt0aGlzLmludFB0WzBdPXEyO3RoaXMuaW50UHRbMV09cDI7cmV0dXJuIHEyLmVxdWFscyhwMikmJiFwMXExcDImJiFxMXAxcTI/anN0cy5hbGdvcml0aG0uTGluZUludGVyc2VjdG9yLlBPSU5UX0lOVEVSU0VDVElPTjpqc3RzLmFsZ29yaXRobS5MaW5lSW50ZXJzZWN0b3IuQ09MTElORUFSX0lOVEVSU0VDVElPTjt9XG5yZXR1cm4ganN0cy5hbGdvcml0aG0uTGluZUludGVyc2VjdG9yLk5PX0lOVEVSU0VDVElPTjt9O2pzdHMuYWxnb3JpdGhtLlJvYnVzdExpbmVJbnRlcnNlY3Rvci5wcm90b3R5cGUuaW50ZXJzZWN0aW9uPWZ1bmN0aW9uKHAxLHAyLHExLHEyKXt2YXIgaW50UHQ9dGhpcy5pbnRlcnNlY3Rpb25XaXRoTm9ybWFsaXphdGlvbihwMSxwMixxMSxxMik7aWYoIXRoaXMuaXNJblNlZ21lbnRFbnZlbG9wZXMoaW50UHQpKXtpbnRQdD1qc3RzLmFsZ29yaXRobS5DZW50cmFsRW5kcG9pbnRJbnRlcnNlY3Rvci5nZXRJbnRlcnNlY3Rpb24ocDEscDIscTEscTIpO31cbmlmKHRoaXMucHJlY2lzaW9uTW9kZWwhPT1udWxsKXt0aGlzLnByZWNpc2lvbk1vZGVsLm1ha2VQcmVjaXNlKGludFB0KTt9XG5yZXR1cm4gaW50UHQ7fTtqc3RzLmFsZ29yaXRobS5Sb2J1c3RMaW5lSW50ZXJzZWN0b3IucHJvdG90eXBlLmludGVyc2VjdGlvbldpdGhOb3JtYWxpemF0aW9uPWZ1bmN0aW9uKHAxLHAyLHExLHEyKXt2YXIgbjE9bmV3IGpzdHMuZ2VvbS5Db29yZGluYXRlKHAxKTt2YXIgbjI9bmV3IGpzdHMuZ2VvbS5Db29yZGluYXRlKHAyKTt2YXIgbjM9bmV3IGpzdHMuZ2VvbS5Db29yZGluYXRlKHExKTt2YXIgbjQ9bmV3IGpzdHMuZ2VvbS5Db29yZGluYXRlKHEyKTt2YXIgbm9ybVB0PW5ldyBqc3RzLmdlb20uQ29vcmRpbmF0ZSgpO3RoaXMubm9ybWFsaXplVG9FbnZDZW50cmUobjEsbjIsbjMsbjQsbm9ybVB0KTt2YXIgaW50UHQ9dGhpcy5zYWZlSENvb3JkaW5hdGVJbnRlcnNlY3Rpb24objEsbjIsbjMsbjQpO2ludFB0LngrPW5vcm1QdC54O2ludFB0LnkrPW5vcm1QdC55O3JldHVybiBpbnRQdDt9O2pzdHMuYWxnb3JpdGhtLlJvYnVzdExpbmVJbnRlcnNlY3Rvci5wcm90b3R5cGUuc2FmZUhDb29yZGluYXRlSW50ZXJzZWN0aW9uPWZ1bmN0aW9uKHAxLHAyLHExLHEyKXt2YXIgaW50UHQ9bnVsbDt0cnl7aW50UHQ9anN0cy5hbGdvcml0aG0uSENvb3JkaW5hdGUuaW50ZXJzZWN0aW9uKHAxLHAyLHExLHEyKTt9Y2F0Y2goZSl7aWYoZSBpbnN0YW5jZW9mIGpzdHMuZXJyb3IuTm90UmVwcmVzZW50YWJsZUVycm9yKXtpbnRQdD1qc3RzLmFsZ29yaXRobS5DZW50cmFsRW5kcG9pbnRJbnRlcnNlY3Rvci5nZXRJbnRlcnNlY3Rpb24ocDEscDIscTEscTIpO31lbHNle3Rocm93IGU7fX1cbnJldHVybiBpbnRQdDt9O2pzdHMuYWxnb3JpdGhtLlJvYnVzdExpbmVJbnRlcnNlY3Rvci5wcm90b3R5cGUubm9ybWFsaXplVG9NaW5pbXVtPWZ1bmN0aW9uKG4xLG4yLG4zLG40LG5vcm1QdCl7bm9ybVB0Lng9dGhpcy5zbWFsbGVzdEluQWJzVmFsdWUobjEueCxuMi54LG4zLngsbjQueCk7bm9ybVB0Lnk9dGhpcy5zbWFsbGVzdEluQWJzVmFsdWUobjEueSxuMi55LG4zLnksbjQueSk7bjEueC09bm9ybVB0Lng7bjEueS09bm9ybVB0Lnk7bjIueC09bm9ybVB0Lng7bjIueS09bm9ybVB0Lnk7bjMueC09bm9ybVB0Lng7bjMueS09bm9ybVB0Lnk7bjQueC09bm9ybVB0Lng7bjQueS09bm9ybVB0Lnk7fTtqc3RzLmFsZ29yaXRobS5Sb2J1c3RMaW5lSW50ZXJzZWN0b3IucHJvdG90eXBlLm5vcm1hbGl6ZVRvRW52Q2VudHJlPWZ1bmN0aW9uKG4wMCxuMDEsbjEwLG4xMSxub3JtUHQpe3ZhciBtaW5YMD1uMDAueDxuMDEueD9uMDAueDpuMDEueDt2YXIgbWluWTA9bjAwLnk8bjAxLnk/bjAwLnk6bjAxLnk7dmFyIG1heFgwPW4wMC54Pm4wMS54P24wMC54Om4wMS54O3ZhciBtYXhZMD1uMDAueT5uMDEueT9uMDAueTpuMDEueTt2YXIgbWluWDE9bjEwLng8bjExLng/bjEwLng6bjExLng7dmFyIG1pblkxPW4xMC55PG4xMS55P24xMC55Om4xMS55O3ZhciBtYXhYMT1uMTAueD5uMTEueD9uMTAueDpuMTEueDt2YXIgbWF4WTE9bjEwLnk+bjExLnk/bjEwLnk6bjExLnk7dmFyIGludE1pblg9bWluWDA+bWluWDE/bWluWDA6bWluWDE7dmFyIGludE1heFg9bWF4WDA8bWF4WDE/bWF4WDA6bWF4WDE7dmFyIGludE1pblk9bWluWTA+bWluWTE/bWluWTA6bWluWTE7dmFyIGludE1heFk9bWF4WTA8bWF4WTE/bWF4WTA6bWF4WTE7dmFyIGludE1pZFg9KGludE1pblgraW50TWF4WCkvMi4wO3ZhciBpbnRNaWRZPShpbnRNaW5ZK2ludE1heFkpLzIuMDtub3JtUHQueD1pbnRNaWRYO25vcm1QdC55PWludE1pZFk7bjAwLngtPW5vcm1QdC54O24wMC55LT1ub3JtUHQueTtuMDEueC09bm9ybVB0Lng7bjAxLnktPW5vcm1QdC55O24xMC54LT1ub3JtUHQueDtuMTAueS09bm9ybVB0Lnk7bjExLngtPW5vcm1QdC54O24xMS55LT1ub3JtUHQueTt9O2pzdHMuYWxnb3JpdGhtLlJvYnVzdExpbmVJbnRlcnNlY3Rvci5wcm90b3R5cGUuc21hbGxlc3RJbkFic1ZhbHVlPWZ1bmN0aW9uKHgxLHgyLHgzLHg0KXt2YXIgeD14MTt2YXIgeGFicz1NYXRoLmFicyh4KTtpZihNYXRoLmFicyh4Mik8eGFicyl7eD14Mjt4YWJzPU1hdGguYWJzKHgyKTt9XG5pZihNYXRoLmFicyh4Myk8eGFicyl7eD14Mzt4YWJzPU1hdGguYWJzKHgzKTt9XG5pZihNYXRoLmFicyh4NCk8eGFicyl7eD14NDt9XG5yZXR1cm4geDt9O2pzdHMuYWxnb3JpdGhtLlJvYnVzdExpbmVJbnRlcnNlY3Rvci5wcm90b3R5cGUuaXNJblNlZ21lbnRFbnZlbG9wZXM9ZnVuY3Rpb24oaW50UHQpe3ZhciBlbnYwPW5ldyBqc3RzLmdlb20uRW52ZWxvcGUodGhpcy5pbnB1dExpbmVzWzBdWzBdLHRoaXMuaW5wdXRMaW5lc1swXVsxXSk7dmFyIGVudjE9bmV3IGpzdHMuZ2VvbS5FbnZlbG9wZSh0aGlzLmlucHV0TGluZXNbMV1bMF0sdGhpcy5pbnB1dExpbmVzWzFdWzFdKTtyZXR1cm4gZW52MC5jb250YWlucyhpbnRQdCkmJmVudjEuY29udGFpbnMoaW50UHQpO307anN0cy5hbGdvcml0aG0uSENvb3JkaW5hdGU9ZnVuY3Rpb24oKXt0aGlzLng9MC4wO3RoaXMueT0wLjA7dGhpcy53PTEuMDtpZihhcmd1bWVudHMubGVuZ3RoPT09MSl7dGhpcy5pbml0RnJvbTFDb29yZGluYXRlKGFyZ3VtZW50c1swXSk7fWVsc2UgaWYoYXJndW1lbnRzLmxlbmd0aD09PTImJmFyZ3VtZW50c1swXWluc3RhbmNlb2YganN0cy5nZW9tLkNvb3JkaW5hdGUpe3RoaXMuaW5pdEZyb20yQ29vcmRpbmF0ZXMoYXJndW1lbnRzWzBdLGFyZ3VtZW50c1sxXSk7fWVsc2UgaWYoYXJndW1lbnRzLmxlbmd0aD09PTImJmFyZ3VtZW50c1swXWluc3RhbmNlb2YganN0cy5hbGdvcml0aG0uSENvb3JkaW5hdGUpe3RoaXMuaW5pdEZyb20ySENvb3JkaW5hdGVzKGFyZ3VtZW50c1swXSxhcmd1bWVudHNbMV0pO31lbHNlIGlmKGFyZ3VtZW50cy5sZW5ndGg9PT0yKXt0aGlzLmluaXRGcm9tWFkoYXJndW1lbnRzWzBdLGFyZ3VtZW50c1sxXSk7fWVsc2UgaWYoYXJndW1lbnRzLmxlbmd0aD09PTMpe3RoaXMuaW5pdEZyb21YWVcoYXJndW1lbnRzWzBdLGFyZ3VtZW50c1sxXSxhcmd1bWVudHNbMl0pO31lbHNlIGlmKGFyZ3VtZW50cy5sZW5ndGg9PT00KXt0aGlzLmluaXRGcm9tWFlXKGFyZ3VtZW50c1swXSxhcmd1bWVudHNbMV0sYXJndW1lbnRzWzJdLGFyZ3VtZW50c1szXSk7fX07anN0cy5hbGdvcml0aG0uSENvb3JkaW5hdGUuaW50ZXJzZWN0aW9uPWZ1bmN0aW9uKHAxLHAyLHExLHEyKXt2YXIgcHgscHkscHcscXgscXkscXcseCx5LHcseEludCx5SW50O3B4PXAxLnktcDIueTtweT1wMi54LXAxLng7cHc9cDEueCpwMi55LXAyLngqcDEueTtxeD1xMS55LXEyLnk7cXk9cTIueC1xMS54O3F3PXExLngqcTIueS1xMi54KnExLnk7eD1weSpxdy1xeSpwdzt5PXF4KnB3LXB4KnF3O3c9cHgqcXktcXgqcHk7eEludD14L3c7eUludD15L3c7aWYoIWlzRmluaXRlKHhJbnQpfHwhaXNGaW5pdGUoeUludCkpe3Rocm93IG5ldyBqc3RzLmVycm9yLk5vdFJlcHJlc2VudGFibGVFcnJvcigpO31cbnJldHVybiBuZXcganN0cy5nZW9tLkNvb3JkaW5hdGUoeEludCx5SW50KTt9O2pzdHMuYWxnb3JpdGhtLkhDb29yZGluYXRlLnByb3RvdHlwZS5pbml0RnJvbTFDb29yZGluYXRlPWZ1bmN0aW9uKHApe3RoaXMueD1wLng7dGhpcy55PXAueTt0aGlzLnc9MS4wO307anN0cy5hbGdvcml0aG0uSENvb3JkaW5hdGUucHJvdG90eXBlLmluaXRGcm9tMkNvb3JkaW5hdGVzPWZ1bmN0aW9uKHAxLHAyKXt0aGlzLng9cDEueS1wMi55O3RoaXMueT1wMi54LXAxLng7dGhpcy53PXAxLngqcDIueS1wMi54KnAxLnk7fTtqc3RzLmFsZ29yaXRobS5IQ29vcmRpbmF0ZS5wcm90b3R5cGUuaW5pdEZyb20ySENvb3JkaW5hdGVzPWZ1bmN0aW9uKHAxLHAyKXt0aGlzLng9cDEueSpwMi53LXAyLnkqcDEudzt0aGlzLnk9cDIueCpwMS53LXAxLngqcDIudzt0aGlzLnc9cDEueCpwMi55LXAyLngqcDEueTt9O2pzdHMuYWxnb3JpdGhtLkhDb29yZGluYXRlLnByb3RvdHlwZS5pbml0RnJvbVhZVz1mdW5jdGlvbih4LHksdyl7dGhpcy54PXg7dGhpcy55PXk7dGhpcy53PXc7fTtqc3RzLmFsZ29yaXRobS5IQ29vcmRpbmF0ZS5wcm90b3R5cGUuaW5pdEZyb21YWT1mdW5jdGlvbih4LHkpe3RoaXMueD14O3RoaXMueT15O3RoaXMudz0xLjA7fTtqc3RzLmFsZ29yaXRobS5IQ29vcmRpbmF0ZS5wcm90b3R5cGUuaW5pdEZyb200Q29vcmRpbmF0ZXM9ZnVuY3Rpb24ocDEscDIscTEscTIpe3ZhciBweCxweSxwdyxxeCxxeSxxdztweD1wMS55LXAyLnk7cHk9cDIueC1wMS54O3B3PXAxLngqcDIueS1wMi54KnAxLnk7cXg9cTEueS1xMi55O3F5PXEyLngtcTEueDtxdz1xMS54KnEyLnktcTIueCpxMS55O3RoaXMueD1weSpxdy1xeSpwdzt0aGlzLnk9cXgqcHctcHgqcXc7dGhpcy53PXB4KnF5LXF4KnB5O307anN0cy5hbGdvcml0aG0uSENvb3JkaW5hdGUucHJvdG90eXBlLmdldFg9ZnVuY3Rpb24oKXt2YXIgYT10aGlzLngvdGhpcy53O2lmKCFpc0Zpbml0ZShhKSl7dGhyb3cgbmV3IGpzdHMuZXJyb3IuTm90UmVwcmVzZW50YWJsZUVycm9yKCk7fVxucmV0dXJuIGE7fTtqc3RzLmFsZ29yaXRobS5IQ29vcmRpbmF0ZS5wcm90b3R5cGUuZ2V0WT1mdW5jdGlvbigpe3ZhciBhPXRoaXMueS90aGlzLnc7aWYoIWlzRmluaXRlKGEpKXt0aHJvdyBuZXcganN0cy5lcnJvci5Ob3RSZXByZXNlbnRhYmxlRXJyb3IoKTt9XG5yZXR1cm4gYTt9O2pzdHMuYWxnb3JpdGhtLkhDb29yZGluYXRlLnByb3RvdHlwZS5nZXRDb29yZGluYXRlPWZ1bmN0aW9uKCl7dmFyIHA9bmV3IGpzdHMuZ2VvbS5Db29yZGluYXRlKCk7cC54PXRoaXMuZ2V0WCgpO3AueT10aGlzLmdldFkoKTtyZXR1cm4gcDt9O2pzdHMuZ2VvbS5MaW5lU2VnbWVudD1mdW5jdGlvbigpe2lmKGFyZ3VtZW50cy5sZW5ndGg9PT0wKXt0aGlzLnAwPW5ldyBqc3RzLmdlb20uQ29vcmRpbmF0ZSgpO3RoaXMucDE9bmV3IGpzdHMuZ2VvbS5Db29yZGluYXRlKCk7fWVsc2UgaWYoYXJndW1lbnRzLmxlbmd0aD09PTEpe3RoaXMucDA9YXJndW1lbnRzWzBdLnAwO3RoaXMucDE9YXJndW1lbnRzWzBdLnAxO31lbHNlIGlmKGFyZ3VtZW50cy5sZW5ndGg9PT0yKXt0aGlzLnAwPWFyZ3VtZW50c1swXTt0aGlzLnAxPWFyZ3VtZW50c1sxXTt9ZWxzZSBpZihhcmd1bWVudHMubGVuZ3RoPT09NCl7dGhpcy5wMD1uZXcganN0cy5nZW9tLkNvb3JkaW5hdGUoYXJndW1lbnRzWzBdLGFyZ3VtZW50c1sxXSk7dGhpcy5wMT1uZXcganN0cy5nZW9tLkNvb3JkaW5hdGUoYXJndW1lbnRzWzJdLGFyZ3VtZW50c1szXSk7fX07anN0cy5nZW9tLkxpbmVTZWdtZW50LnByb3RvdHlwZS5wMD1udWxsO2pzdHMuZ2VvbS5MaW5lU2VnbWVudC5wcm90b3R5cGUucDE9bnVsbDtqc3RzLmdlb20uTGluZVNlZ21lbnQubWlkUG9pbnQ9ZnVuY3Rpb24ocDAscDEpe3JldHVybiBuZXcganN0cy5nZW9tLkNvb3JkaW5hdGUoKHAwLngrcDEueCkvMiwocDAueStwMS55KS8yKTt9O2pzdHMuZ2VvbS5MaW5lU2VnbWVudC5wcm90b3R5cGUuZ2V0Q29vcmRpbmF0ZT1mdW5jdGlvbihpKXtpZihpPT09MClyZXR1cm4gdGhpcy5wMDtyZXR1cm4gdGhpcy5wMTt9O2pzdHMuZ2VvbS5MaW5lU2VnbWVudC5wcm90b3R5cGUuZ2V0TGVuZ3RoPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMucDAuZGlzdGFuY2UodGhpcy5wMSk7fTtqc3RzLmdlb20uTGluZVNlZ21lbnQucHJvdG90eXBlLmlzSG9yaXpvbnRhbD1mdW5jdGlvbigpe3JldHVybiB0aGlzLnAwLnk9PT10aGlzLnAxLnk7fTtqc3RzLmdlb20uTGluZVNlZ21lbnQucHJvdG90eXBlLmlzVmVydGljYWw9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5wMC54PT09dGhpcy5wMS54O307anN0cy5nZW9tLkxpbmVTZWdtZW50LnByb3RvdHlwZS5vcmllbnRhdGlvbkluZGV4PWZ1bmN0aW9uKGFyZyl7aWYoYXJnIGluc3RhbmNlb2YganN0cy5nZW9tLkxpbmVTZWdtZW50KXtyZXR1cm4gdGhpcy5vcmllbnRhdGlvbkluZGV4MShhcmcpO31lbHNlIGlmKGFyZyBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5Db29yZGluYXRlKXtyZXR1cm4gdGhpcy5vcmllbnRhdGlvbkluZGV4MihhcmcpO319O2pzdHMuZ2VvbS5MaW5lU2VnbWVudC5wcm90b3R5cGUub3JpZW50YXRpb25JbmRleDE9ZnVuY3Rpb24oc2VnKXt2YXIgb3JpZW50MD1qc3RzLmFsZ29yaXRobS5DR0FsZ29yaXRobXMub3JpZW50YXRpb25JbmRleCh0aGlzLnAwLHRoaXMucDEsc2VnLnAwKTt2YXIgb3JpZW50MT1qc3RzLmFsZ29yaXRobS5DR0FsZ29yaXRobXMub3JpZW50YXRpb25JbmRleCh0aGlzLnAwLHRoaXMucDEsc2VnLnAxKTtpZihvcmllbnQwPj0wJiZvcmllbnQxPj0wKXtyZXR1cm4gTWF0aC5tYXgob3JpZW50MCxvcmllbnQxKTt9XG5pZihvcmllbnQwPD0wJiZvcmllbnQxPD0wKXtyZXR1cm4gTWF0aC5tYXgob3JpZW50MCxvcmllbnQxKTt9XG5yZXR1cm4gMDt9O2pzdHMuZ2VvbS5MaW5lU2VnbWVudC5wcm90b3R5cGUub3JpZW50YXRpb25JbmRleDI9ZnVuY3Rpb24ocCl7cmV0dXJuIGpzdHMuYWxnb3JpdGhtLkNHQWxnb3JpdGhtcy5vcmllbnRhdGlvbkluZGV4KHRoaXMucDAsdGhpcy5wMSxwKTt9O2pzdHMuZ2VvbS5MaW5lU2VnbWVudC5wcm90b3R5cGUucmV2ZXJzZT1mdW5jdGlvbigpe3ZhciB0ZW1wPXRoaXMucDA7dGhpcy5wMD10aGlzLnAxO3RoaXMucDE9dGVtcDt9O2pzdHMuZ2VvbS5MaW5lU2VnbWVudC5wcm90b3R5cGUubm9ybWFsaXplPWZ1bmN0aW9uKCl7aWYodGhpcy5wMS5jb21wYXJlVG8odGhpcy5wMCk8MCl0aGlzLnJldmVyc2UoKTt9O2pzdHMuZ2VvbS5MaW5lU2VnbWVudC5wcm90b3R5cGUuYW5nbGU9ZnVuY3Rpb24oKXtyZXR1cm4gTWF0aC5hdGFuMih0aGlzLnAxLnktdGhpcy5wMC55LHRoaXMucDEueC10aGlzLnAwLngpO307anN0cy5nZW9tLkxpbmVTZWdtZW50LnByb3RvdHlwZS5taWRQb2ludD1mdW5jdGlvbigpe3JldHVybiBqc3RzLmdlb20uTGluZVNlZ21lbnQubWlkUG9pbnQodGhpcy5wMCx0aGlzLnAxKTt9O2pzdHMuZ2VvbS5MaW5lU2VnbWVudC5wcm90b3R5cGUuZGlzdGFuY2U9ZnVuY3Rpb24oYXJnKXtpZihhcmcgaW5zdGFuY2VvZiBqc3RzLmdlb20uTGluZVNlZ21lbnQpe3JldHVybiB0aGlzLmRpc3RhbmNlMShhcmcpO31lbHNlIGlmKGFyZyBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5Db29yZGluYXRlKXtyZXR1cm4gdGhpcy5kaXN0YW5jZTIoYXJnKTt9fTtqc3RzLmdlb20uTGluZVNlZ21lbnQucHJvdG90eXBlLmRpc3RhbmNlMT1mdW5jdGlvbihscyl7cmV0dXJuIGpzdHMuYWxnb3JpdGhtLkNHQWxnb3JpdGhtcy5kaXN0YW5jZUxpbmVMaW5lKHRoaXMucDAsdGhpcy5wMSxscy5wMCxscy5wMSk7fTtqc3RzLmdlb20uTGluZVNlZ21lbnQucHJvdG90eXBlLmRpc3RhbmNlMj1mdW5jdGlvbihwKXtyZXR1cm4ganN0cy5hbGdvcml0aG0uQ0dBbGdvcml0aG1zLmRpc3RhbmNlUG9pbnRMaW5lKHAsdGhpcy5wMCx0aGlzLnAxKTt9O2pzdHMuZ2VvbS5MaW5lU2VnbWVudC5wcm90b3R5cGUucG9pbnRBbG9uZz1mdW5jdGlvbihzZWdtZW50TGVuZ3RoRnJhY3Rpb24pe3ZhciBjb29yZD1uZXcganN0cy5nZW9tLkNvb3JkaW5hdGUoKTtjb29yZC54PXRoaXMucDAueCtzZWdtZW50TGVuZ3RoRnJhY3Rpb24qKHRoaXMucDEueC10aGlzLnAwLngpO2Nvb3JkLnk9dGhpcy5wMC55K3NlZ21lbnRMZW5ndGhGcmFjdGlvbioodGhpcy5wMS55LXRoaXMucDAueSk7cmV0dXJuIGNvb3JkO307anN0cy5nZW9tLkxpbmVTZWdtZW50LnByb3RvdHlwZS5wb2ludEFsb25nT2Zmc2V0PWZ1bmN0aW9uKHNlZ21lbnRMZW5ndGhGcmFjdGlvbixvZmZzZXREaXN0YW5jZSl7dmFyIHNlZ3g9dGhpcy5wMC54K3NlZ21lbnRMZW5ndGhGcmFjdGlvbioodGhpcy5wMS54LXRoaXMucDAueCk7dmFyIHNlZ3k9dGhpcy5wMC55K3NlZ21lbnRMZW5ndGhGcmFjdGlvbioodGhpcy5wMS55LXRoaXMucDAueSk7dmFyIGR4PXRoaXMucDEueC10aGlzLnAwLng7dmFyIGR5PXRoaXMucDEueS10aGlzLnAwLnk7dmFyIGxlbj1NYXRoLnNxcnQoZHgqZHgrZHkqZHkpO3ZhciB1eD0wO3ZhciB1eT0wO2lmKG9mZnNldERpc3RhbmNlIT09MCl7aWYobGVuPD0wKXt0aHJvd1wiQ2Fubm90IGNvbXB1dGUgb2Zmc2V0IGZyb20gemVyby1sZW5ndGggbGluZSBzZWdtZW50XCI7fVxudXg9b2Zmc2V0RGlzdGFuY2UqZHgvbGVuO3V5PW9mZnNldERpc3RhbmNlKmR5L2xlbjt9XG52YXIgb2Zmc2V0eD1zZWd4LXV5O3ZhciBvZmZzZXR5PXNlZ3krdXg7dmFyIGNvb3JkPW5ldyBqc3RzLmdlb20uQ29vcmRpbmF0ZShvZmZzZXR4LG9mZnNldHkpO3JldHVybiBjb29yZDt9O2pzdHMuZ2VvbS5MaW5lU2VnbWVudC5wcm90b3R5cGUucHJvamVjdGlvbkZhY3Rvcj1mdW5jdGlvbihwKXtpZihwLmVxdWFscyh0aGlzLnAwKSlcbnJldHVybiAwLjA7aWYocC5lcXVhbHModGhpcy5wMSkpXG5yZXR1cm4gMS4wO3ZhciBkeD10aGlzLnAxLngtdGhpcy5wMC54O3ZhciBkeT10aGlzLnAxLnktdGhpcy5wMC55O3ZhciBsZW4yPWR4KmR4K2R5KmR5O3ZhciByPSgocC54LXRoaXMucDAueCkqZHgrKHAueS10aGlzLnAwLnkpKmR5KS9sZW4yO3JldHVybiByO307anN0cy5nZW9tLkxpbmVTZWdtZW50LnByb3RvdHlwZS5zZWdtZW50RnJhY3Rpb249ZnVuY3Rpb24oaW5wdXRQdCl7dmFyIHNlZ0ZyYWM9dGhpcy5wcm9qZWN0aW9uRmFjdG9yKGlucHV0UHQpO2lmKHNlZ0ZyYWM8MCl7c2VnRnJhYz0wO31lbHNlIGlmKHNlZ0ZyYWM+MXx8aXNOYU4oc2VnRnJhYykpe3NlZ0ZyYWM9MTt9XG5yZXR1cm4gc2VnRnJhYzt9O2pzdHMuZ2VvbS5MaW5lU2VnbWVudC5wcm90b3R5cGUucHJvamVjdD1mdW5jdGlvbihhcmcpe2lmKGFyZyBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5Db29yZGluYXRlKXtyZXR1cm4gdGhpcy5wcm9qZWN0MShhcmcpO31lbHNlIGlmKGFyZyBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5MaW5lU2VnbWVudCl7cmV0dXJuIHRoaXMucHJvamVjdDIoYXJnKTt9fTtqc3RzLmdlb20uTGluZVNlZ21lbnQucHJvdG90eXBlLnByb2plY3QxPWZ1bmN0aW9uKHApe2lmKHAuZXF1YWxzKHRoaXMucDApfHxwLmVxdWFscyh0aGlzLnAxKSl7cmV0dXJuIG5ldyBqc3RzLmdlb20uQ29vcmRpbmF0ZShwKTt9XG52YXIgcj10aGlzLnByb2plY3Rpb25GYWN0b3IocCk7dmFyIGNvb3JkPW5ldyBqc3RzLmdlb20uQ29vcmRpbmF0ZSgpO2Nvb3JkLng9dGhpcy5wMC54K3IqKHRoaXMucDEueC10aGlzLnAwLngpO2Nvb3JkLnk9dGhpcy5wMC55K3IqKHRoaXMucDEueS10aGlzLnAwLnkpO3JldHVybiBjb29yZDt9O2pzdHMuZ2VvbS5MaW5lU2VnbWVudC5wcm90b3R5cGUucHJvamVjdDI9ZnVuY3Rpb24oc2VnKXt2YXIgcGYwPXRoaXMucHJvamVjdGlvbkZhY3RvcihzZWcucDApO3ZhciBwZjE9dGhpcy5wcm9qZWN0aW9uRmFjdG9yKHNlZy5wMSk7aWYocGYwPj0xJiZwZjE+PTEpcmV0dXJuIG51bGw7aWYocGYwPD0wJiZwZjE8PTApcmV0dXJuIG51bGw7dmFyIG5ld3AwPXRoaXMucHJvamVjdChzZWcucDApO2lmKHBmMDwwKW5ld3AwPXAwO2lmKHBmMD4xKW5ld3AwPXAxO3ZhciBuZXdwMT10aGlzLnByb2plY3Qoc2VnLnAxKTtpZihwZjE8MC4wKW5ld3AxPXAwO2lmKHBmMT4xLjApbmV3cDE9cDE7cmV0dXJuIG5ldyBqc3RzLmdlb20uTGluZVNlZ21lbnQobmV3cDAsbmV3cDEpO307anN0cy5nZW9tLkxpbmVTZWdtZW50LnByb3RvdHlwZS5jbG9zZXN0UG9pbnQ9ZnVuY3Rpb24ocCl7dmFyIGZhY3Rvcj10aGlzLnByb2plY3Rpb25GYWN0b3IocCk7aWYoZmFjdG9yPjAmJmZhY3RvcjwxKXtyZXR1cm4gdGhpcy5wcm9qZWN0KHApO31cbnZhciBkaXN0MD10aGlzLnAwLmRpc3RhbmNlKHApO3ZhciBkaXN0MT10aGlzLnAxLmRpc3RhbmNlKHApO2lmKGRpc3QwPGRpc3QxKVxucmV0dXJuIHRoaXMucDA7cmV0dXJuIHRoaXMucDE7fTtqc3RzLmdlb20uTGluZVNlZ21lbnQucHJvdG90eXBlLmNsb3Nlc3RQb2ludHM9ZnVuY3Rpb24obGluZSl7dmFyIGludFB0PXRoaXMuaW50ZXJzZWN0aW9uKGxpbmUpO2lmKGludFB0IT09bnVsbCl7cmV0dXJuW2ludFB0LGludFB0XTt9XG52YXIgY2xvc2VzdFB0PVtdO3ZhciBtaW5EaXN0YW5jZT1OdW1iZXIuTUFYX1ZBTFVFO3ZhciBkaXN0O3ZhciBjbG9zZTAwPXRoaXMuY2xvc2VzdFBvaW50KGxpbmUucDApO21pbkRpc3RhbmNlPWNsb3NlMDAuZGlzdGFuY2UobGluZS5wMCk7Y2xvc2VzdFB0WzBdPWNsb3NlMDA7Y2xvc2VzdFB0WzFdPWxpbmUucDA7dmFyIGNsb3NlMDE9dGhpcy5jbG9zZXN0UG9pbnQobGluZS5wMSk7ZGlzdD1jbG9zZTAxLmRpc3RhbmNlKGxpbmUucDEpO2lmKGRpc3Q8bWluRGlzdGFuY2Upe21pbkRpc3RhbmNlPWRpc3Q7Y2xvc2VzdFB0WzBdPWNsb3NlMDE7Y2xvc2VzdFB0WzFdPWxpbmUucDE7fVxudmFyIGNsb3NlMTA9bGluZS5jbG9zZXN0UG9pbnQodGhpcy5wMCk7ZGlzdD1jbG9zZTEwLmRpc3RhbmNlKHRoaXMucDApO2lmKGRpc3Q8bWluRGlzdGFuY2Upe21pbkRpc3RhbmNlPWRpc3Q7Y2xvc2VzdFB0WzBdPXRoaXMucDA7Y2xvc2VzdFB0WzFdPWNsb3NlMTA7fVxudmFyIGNsb3NlMTE9bGluZS5jbG9zZXN0UG9pbnQodGhpcy5wMSk7ZGlzdD1jbG9zZTExLmRpc3RhbmNlKHRoaXMucDEpO2lmKGRpc3Q8bWluRGlzdGFuY2Upe21pbkRpc3RhbmNlPWRpc3Q7Y2xvc2VzdFB0WzBdPXRoaXMucDE7Y2xvc2VzdFB0WzFdPWNsb3NlMTE7fVxucmV0dXJuIGNsb3Nlc3RQdDt9O2pzdHMuZ2VvbS5MaW5lU2VnbWVudC5wcm90b3R5cGUuaW50ZXJzZWN0aW9uPWZ1bmN0aW9uKGxpbmUpe3ZhciBsaT1uZXcganN0cy5hbGdvcml0aG0uUm9idXN0TGluZUludGVyc2VjdG9yKCk7bGkuY29tcHV0ZUludGVyc2VjdGlvbih0aGlzLnAwLHRoaXMucDEsbGluZS5wMCxsaW5lLnAxKTtpZihsaS5oYXNJbnRlcnNlY3Rpb24oKSlcbnJldHVybiBsaS5nZXRJbnRlcnNlY3Rpb24oMCk7cmV0dXJuIG51bGw7fTtqc3RzLmdlb20uTGluZVNlZ21lbnQucHJvdG90eXBlLnNldENvb3JkaW5hdGVzPWZ1bmN0aW9uKGxzKXtpZihscyBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5Db29yZGluYXRlKXt0aGlzLnNldENvb3JkaW5hdGVzMi5hcHBseSh0aGlzLGFyZ3VtZW50cyk7cmV0dXJuO31cbnRoaXMuc2V0Q29vcmRpbmF0ZXMyKGxzLnAwLGxzLnAxKTt9O2pzdHMuZ2VvbS5MaW5lU2VnbWVudC5wcm90b3R5cGUuc2V0Q29vcmRpbmF0ZXMyPWZ1bmN0aW9uKHAwLHAxKXt0aGlzLnAwLng9cDAueDt0aGlzLnAwLnk9cDAueTt0aGlzLnAxLng9cDEueDt0aGlzLnAxLnk9cDEueTt9O2pzdHMuZ2VvbS5MaW5lU2VnbWVudC5wcm90b3R5cGUuZGlzdGFuY2VQZXJwZW5kaWN1bGFyPWZ1bmN0aW9uKHApe3JldHVybiBqc3RzLmFsZ29yaXRobS5DR0FsZ29yaXRobXMuZGlzdGFuY2VQb2ludExpbmVQZXJwZW5kaWN1bGFyKHAsdGhpcy5wMCx0aGlzLnAxKTt9O2pzdHMuZ2VvbS5MaW5lU2VnbWVudC5wcm90b3R5cGUubGluZUludGVyc2VjdGlvbj1mdW5jdGlvbihsaW5lKXt0cnl7dmFyIGludFB0PWpzdHMuYWxnb3JpdGhtLkhDb29yZGluYXRlLmludGVyc2VjdGlvbih0aGlzLnAwLHRoaXMucDEsbGluZS5wMCxsaW5lLnAxKTtyZXR1cm4gaW50UHQ7fWNhdGNoKGV4KXt9XG5yZXR1cm4gbnVsbDt9O2pzdHMuZ2VvbS5MaW5lU2VnbWVudC5wcm90b3R5cGUudG9HZW9tZXRyeT1mdW5jdGlvbihnZW9tRmFjdG9yeSl7cmV0dXJuIGdlb21GYWN0b3J5LmNyZWF0ZUxpbmVTdHJpbmcoW3RoaXMucDAsdGhpcy5wMV0pO307anN0cy5nZW9tLkxpbmVTZWdtZW50LnByb3RvdHlwZS5lcXVhbHM9ZnVuY3Rpb24obyl7aWYoIShvIGluc3RhbmNlb2YganN0cy5nZW9tLkxpbmVTZWdtZW50KSl7cmV0dXJuIGZhbHNlO31cbnJldHVybiB0aGlzLnAwLmVxdWFscyhvLnAwKSYmdGhpcy5wMS5lcXVhbHMoby5wMSk7fTtqc3RzLmdlb20uTGluZVNlZ21lbnQucHJvdG90eXBlLmNvbXBhcmVUbz1mdW5jdGlvbihvKXt2YXIgY29tcDA9dGhpcy5wMC5jb21wYXJlVG8oby5wMCk7aWYoY29tcDAhPT0wKXJldHVybiBjb21wMDtyZXR1cm4gdGhpcy5wMS5jb21wYXJlVG8oby5wMSk7fTtqc3RzLmdlb20uTGluZVNlZ21lbnQucHJvdG90eXBlLmVxdWFsc1RvcG89ZnVuY3Rpb24ob3RoZXIpe3JldHVybiB0aGlzLnAwLmVxdWFscyhvdGhlci5wMCkmJnRoaXMucDEuZXF1YWxzKG90aGVyLnAxKXx8dGhpcy5wMC5lcXVhbHMob3RoZXIucDEpJiZ0aGlzLnAxLmVxdWFscyhvdGhlci5wMCk7fTtqc3RzLmdlb20uTGluZVNlZ21lbnQucHJvdG90eXBlLnRvU3RyaW5nPWZ1bmN0aW9uKCl7cmV0dXJuXCJMSU5FU1RSSU5HKFwiK1xudGhpcy5wMC54K1wiIFwiK3RoaXMucDAueVxuK1wiLCBcIitcbnRoaXMucDEueCtcIiBcIit0aGlzLnAxLnkrXCIpXCI7fTtqc3RzLmluZGV4LmNoYWluLk1vbm90b25lQ2hhaW5PdmVybGFwQWN0aW9uPWZ1bmN0aW9uKCl7dGhpcy50ZW1wRW52MT1uZXcganN0cy5nZW9tLkVudmVsb3BlKCk7dGhpcy50ZW1wRW52Mj1uZXcganN0cy5nZW9tLkVudmVsb3BlKCk7dGhpcy5vdmVybGFwU2VnMT1uZXcganN0cy5nZW9tLkxpbmVTZWdtZW50KCk7dGhpcy5vdmVybGFwU2VnMj1uZXcganN0cy5nZW9tLkxpbmVTZWdtZW50KCk7fTtqc3RzLmluZGV4LmNoYWluLk1vbm90b25lQ2hhaW5PdmVybGFwQWN0aW9uLnByb3RvdHlwZS50ZW1wRW52MT1udWxsO2pzdHMuaW5kZXguY2hhaW4uTW9ub3RvbmVDaGFpbk92ZXJsYXBBY3Rpb24ucHJvdG90eXBlLnRlbXBFbnYyPW51bGw7anN0cy5pbmRleC5jaGFpbi5Nb25vdG9uZUNoYWluT3ZlcmxhcEFjdGlvbi5wcm90b3R5cGUub3ZlcmxhcFNlZzE9bnVsbDtqc3RzLmluZGV4LmNoYWluLk1vbm90b25lQ2hhaW5PdmVybGFwQWN0aW9uLnByb3RvdHlwZS5vdmVybGFwU2VnMj1udWxsO2pzdHMuaW5kZXguY2hhaW4uTW9ub3RvbmVDaGFpbk92ZXJsYXBBY3Rpb24ucHJvdG90eXBlLm92ZXJsYXA9ZnVuY3Rpb24obWMxLHN0YXJ0MSxtYzIsc3RhcnQyKXt0aGlzLm1jMS5nZXRMaW5lU2VnbWVudChzdGFydDEsdGhpcy5vdmVybGFwU2VnMSk7dGhpcy5tYzIuZ2V0TGluZVNlZ21lbnQoc3RhcnQyLHRoaXMub3ZlcmxhcFNlZzIpO3RoaXMub3ZlcmxhcDIodGhpcy5vdmVybGFwU2VnMSx0aGlzLm92ZXJsYXBTZWcyKTt9O2pzdHMuaW5kZXguY2hhaW4uTW9ub3RvbmVDaGFpbk92ZXJsYXBBY3Rpb24ucHJvdG90eXBlLm92ZXJsYXAyPWZ1bmN0aW9uKHNlZzEsc2VnMil7fTsoZnVuY3Rpb24oKXt2YXIgTW9ub3RvbmVDaGFpbk92ZXJsYXBBY3Rpb249anN0cy5pbmRleC5jaGFpbi5Nb25vdG9uZUNoYWluT3ZlcmxhcEFjdGlvbjt2YXIgU2luZ2xlUGFzc05vZGVyPWpzdHMubm9kaW5nLlNpbmdsZVBhc3NOb2Rlcjt2YXIgU1RSdHJlZT1qc3RzLmluZGV4LnN0cnRyZWUuU1RSdHJlZTt2YXIgTm9kZWRTZWdtZW50U3RyaW5nPWpzdHMubm9kaW5nLk5vZGVkU2VnbWVudFN0cmluZzt2YXIgTW9ub3RvbmVDaGFpbkJ1aWxkZXI9anN0cy5pbmRleC5jaGFpbi5Nb25vdG9uZUNoYWluQnVpbGRlcjt2YXIgU2VnbWVudE92ZXJsYXBBY3Rpb249ZnVuY3Rpb24oc2kpe3RoaXMuc2k9c2k7fTtTZWdtZW50T3ZlcmxhcEFjdGlvbi5wcm90b3R5cGU9bmV3IE1vbm90b25lQ2hhaW5PdmVybGFwQWN0aW9uKCk7U2VnbWVudE92ZXJsYXBBY3Rpb24uY29uc3RydWN0b3I9U2VnbWVudE92ZXJsYXBBY3Rpb247U2VnbWVudE92ZXJsYXBBY3Rpb24ucHJvdG90eXBlLnNpPW51bGw7U2VnbWVudE92ZXJsYXBBY3Rpb24ucHJvdG90eXBlLm92ZXJsYXA9ZnVuY3Rpb24obWMxLHN0YXJ0MSxtYzIsc3RhcnQyKXt2YXIgc3MxPW1jMS5nZXRDb250ZXh0KCk7dmFyIHNzMj1tYzIuZ2V0Q29udGV4dCgpO3RoaXMuc2kucHJvY2Vzc0ludGVyc2VjdGlvbnMoc3MxLHN0YXJ0MSxzczIsc3RhcnQyKTt9O2pzdHMubm9kaW5nLk1DSW5kZXhOb2Rlcj1mdW5jdGlvbigpe3RoaXMubW9ub0NoYWlucz1bXTt0aGlzLmluZGV4PW5ldyBTVFJ0cmVlKCk7fTtqc3RzLm5vZGluZy5NQ0luZGV4Tm9kZXIucHJvdG90eXBlPW5ldyBTaW5nbGVQYXNzTm9kZXIoKTtqc3RzLm5vZGluZy5NQ0luZGV4Tm9kZXIuY29uc3RydWN0b3I9anN0cy5ub2RpbmcuTUNJbmRleE5vZGVyO2pzdHMubm9kaW5nLk1DSW5kZXhOb2Rlci5wcm90b3R5cGUubW9ub0NoYWlucz1udWxsO2pzdHMubm9kaW5nLk1DSW5kZXhOb2Rlci5wcm90b3R5cGUuaW5kZXg9bnVsbDtqc3RzLm5vZGluZy5NQ0luZGV4Tm9kZXIucHJvdG90eXBlLmlkQ291bnRlcj0wO2pzdHMubm9kaW5nLk1DSW5kZXhOb2Rlci5wcm90b3R5cGUubm9kZWRTZWdTdHJpbmdzPW51bGw7anN0cy5ub2RpbmcuTUNJbmRleE5vZGVyLnByb3RvdHlwZS5uT3ZlcmxhcHM9MDtqc3RzLm5vZGluZy5NQ0luZGV4Tm9kZXIucHJvdG90eXBlLmdldE1vbm90b25lQ2hhaW5zPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMubW9ub0NoYWluczt9O2pzdHMubm9kaW5nLk1DSW5kZXhOb2Rlci5wcm90b3R5cGUuZ2V0SW5kZXg9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5pbmRleDt9O2pzdHMubm9kaW5nLk1DSW5kZXhOb2Rlci5wcm90b3R5cGUuZ2V0Tm9kZWRTdWJzdHJpbmdzPWZ1bmN0aW9uKCl7cmV0dXJuIE5vZGVkU2VnbWVudFN0cmluZy5nZXROb2RlZFN1YnN0cmluZ3ModGhpcy5ub2RlZFNlZ1N0cmluZ3MpO307anN0cy5ub2RpbmcuTUNJbmRleE5vZGVyLnByb3RvdHlwZS5jb21wdXRlTm9kZXM9ZnVuY3Rpb24oaW5wdXRTZWdTdHJpbmdzKXt0aGlzLm5vZGVkU2VnU3RyaW5ncz1pbnB1dFNlZ1N0cmluZ3M7Zm9yKHZhciBpPWlucHV0U2VnU3RyaW5ncy5pdGVyYXRvcigpO2kuaGFzTmV4dCgpOyl7dGhpcy5hZGQoaS5uZXh0KCkpO31cbnRoaXMuaW50ZXJzZWN0Q2hhaW5zKCk7fTtqc3RzLm5vZGluZy5NQ0luZGV4Tm9kZXIucHJvdG90eXBlLmludGVyc2VjdENoYWlucz1mdW5jdGlvbigpe3ZhciBvdmVybGFwQWN0aW9uPW5ldyBTZWdtZW50T3ZlcmxhcEFjdGlvbih0aGlzLnNlZ0ludCk7Zm9yKHZhciBpPTA7aTx0aGlzLm1vbm9DaGFpbnMubGVuZ3RoO2krKyl7dmFyIHF1ZXJ5Q2hhaW49dGhpcy5tb25vQ2hhaW5zW2ldO3ZhciBvdmVybGFwQ2hhaW5zPXRoaXMuaW5kZXgucXVlcnkocXVlcnlDaGFpbi5nZXRFbnZlbG9wZSgpKTtmb3IodmFyIGo9MDtqPG92ZXJsYXBDaGFpbnMubGVuZ3RoO2orKyl7dmFyIHRlc3RDaGFpbj1vdmVybGFwQ2hhaW5zW2pdO2lmKHRlc3RDaGFpbi5nZXRJZCgpPnF1ZXJ5Q2hhaW4uZ2V0SWQoKSl7cXVlcnlDaGFpbi5jb21wdXRlT3ZlcmxhcHModGVzdENoYWluLG92ZXJsYXBBY3Rpb24pO3RoaXMubk92ZXJsYXBzKys7fVxuaWYodGhpcy5zZWdJbnQuaXNEb25lKCkpXG5yZXR1cm47fX19O2pzdHMubm9kaW5nLk1DSW5kZXhOb2Rlci5wcm90b3R5cGUuYWRkPWZ1bmN0aW9uKHNlZ1N0cil7dmFyIHNlZ0NoYWlucz1Nb25vdG9uZUNoYWluQnVpbGRlci5nZXRDaGFpbnMoc2VnU3RyLmdldENvb3JkaW5hdGVzKCksc2VnU3RyKTtmb3IodmFyIGk9MDtpPHNlZ0NoYWlucy5sZW5ndGg7aSsrKXt2YXIgbWM9c2VnQ2hhaW5zW2ldO21jLnNldElkKHRoaXMuaWRDb3VudGVyKyspO3RoaXMuaW5kZXguaW5zZXJ0KG1jLmdldEVudmVsb3BlKCksbWMpO3RoaXMubW9ub0NoYWlucy5wdXNoKG1jKTt9fTt9KSgpO2pzdHMuc2ltcGxpZnkuTGluZVNlZ21lbnRJbmRleD1mdW5jdGlvbigpe3RoaXMuaW5kZXg9bmV3IGpzdHMuaW5kZXgucXVhZHRyZWUuUXVhZHRyZWUoKTt9O2pzdHMuc2ltcGxpZnkuTGluZVNlZ21lbnRJbmRleC5wcm90b3R5cGUuaW5kZXg9bnVsbDtqc3RzLnNpbXBsaWZ5LkxpbmVTZWdtZW50SW5kZXgucHJvdG90eXBlLmFkZD1mdW5jdGlvbihsaW5lKXtpZihsaW5lIGluc3RhbmNlb2YganN0cy5nZW9tLkxpbmVTZWdtZW50KXt0aGlzLmFkZDIobGluZSk7cmV0dXJuO31cbnZhciBzZWdzPWxpbmUuZ2V0U2VnbWVudHMoKTtmb3IodmFyIGk9MDtpPHNlZ3MubGVuZ3RoO2krKyl7dmFyIHNlZz1zZWdzW2ldO3RoaXMuYWRkMihzZWcpO319O2pzdHMuc2ltcGxpZnkuTGluZVNlZ21lbnRJbmRleC5wcm90b3R5cGUuYWRkMj1mdW5jdGlvbihzZWcpe3RoaXMuaW5kZXguaW5zZXJ0KG5ldyBqc3RzLmdlb20uRW52ZWxvcGUoc2VnLnAwLHNlZy5wMSksc2VnKTt9O2pzdHMuc2ltcGxpZnkuTGluZVNlZ21lbnRJbmRleC5wcm90b3R5cGUucmVtb3ZlPWZ1bmN0aW9uKHNlZyl7dGhpcy5pbmRleC5yZW1vdmUobmV3IGpzdHMuZ2VvbS5FbnZlbG9wZShzZWcucDAsc2VnLnAxKSxzZWcpO307anN0cy5zaW1wbGlmeS5MaW5lU2VnbWVudEluZGV4LnByb3RvdHlwZS5xdWVyeT1mdW5jdGlvbihxdWVyeVNlZyl7dmFyIGVudj1uZXcganN0cy5nZW9tLkVudmVsb3BlKHF1ZXJ5U2VnLnAwLHF1ZXJ5U2VnLnAxKTt2YXIgdmlzaXRvcj1uZXcganN0cy5zaW1wbGlmeS5MaW5lU2VnbWVudEluZGV4LkxpbmVTZWdtZW50VmlzaXRvcihxdWVyeVNlZyk7dGhpcy5pbmRleC5xdWVyeShlbnYsdmlzaXRvcik7dmFyIGl0ZW1zRm91bmQ9dmlzaXRvci5nZXRJdGVtcygpO3JldHVybiBpdGVtc0ZvdW5kO307anN0cy5zaW1wbGlmeS5MaW5lU2VnbWVudEluZGV4LkxpbmVTZWdtZW50VmlzaXRvcj1mdW5jdGlvbihxdWVyeVNlZyl7dGhpcy5pdGVtcz1bXTt0aGlzLnF1ZXJ5U2VnPXF1ZXJ5U2VnO307anN0cy5zaW1wbGlmeS5MaW5lU2VnbWVudEluZGV4LkxpbmVTZWdtZW50VmlzaXRvci5wcm90b3R5cGU9bmV3IGpzdHMuaW5kZXguSXRlbVZpc2l0b3IoKTtqc3RzLnNpbXBsaWZ5LkxpbmVTZWdtZW50SW5kZXguTGluZVNlZ21lbnRWaXNpdG9yLnByb3RvdHlwZS5xdWVyeVNlZz1udWxsO2pzdHMuc2ltcGxpZnkuTGluZVNlZ21lbnRJbmRleC5MaW5lU2VnbWVudFZpc2l0b3IucHJvdG90eXBlLml0ZW1zPW51bGw7anN0cy5zaW1wbGlmeS5MaW5lU2VnbWVudEluZGV4LkxpbmVTZWdtZW50VmlzaXRvci5wcm90b3R5cGUudmlzaXRJdGVtPWZ1bmN0aW9uKGl0ZW0pe3ZhciBzZWc9aXRlbTtpZihqc3RzLmdlb20uRW52ZWxvcGUuaW50ZXJzZWN0cyhzZWcucDAsc2VnLnAxLHRoaXMucXVlcnlTZWcucDAsdGhpcy5xdWVyeVNlZy5wMSkpXG50aGlzLml0ZW1zLnB1c2goaXRlbSk7fTtqc3RzLnNpbXBsaWZ5LkxpbmVTZWdtZW50SW5kZXguTGluZVNlZ21lbnRWaXNpdG9yLnByb3RvdHlwZS5nZXRJdGVtcz1mdW5jdGlvbigpe3JldHVybiB0aGlzLml0ZW1zO307anN0cy5nZW9tZ3JhcGguRWRnZUVuZFN0YXI9ZnVuY3Rpb24oKXt0aGlzLmVkZ2VNYXA9bmV3IGphdmFzY3JpcHQudXRpbC5UcmVlTWFwKCk7dGhpcy5lZGdlTGlzdD1udWxsO3RoaXMucHRJbkFyZWFMb2NhdGlvbj1banN0cy5nZW9tLkxvY2F0aW9uLk5PTkUsanN0cy5nZW9tLkxvY2F0aW9uLk5PTkVdO307anN0cy5nZW9tZ3JhcGguRWRnZUVuZFN0YXIucHJvdG90eXBlLmVkZ2VNYXA9bnVsbDtqc3RzLmdlb21ncmFwaC5FZGdlRW5kU3Rhci5wcm90b3R5cGUuZWRnZUxpc3Q9bnVsbDtqc3RzLmdlb21ncmFwaC5FZGdlRW5kU3Rhci5wcm90b3R5cGUucHRJbkFyZWFMb2NhdGlvbj1udWxsO2pzdHMuZ2VvbWdyYXBoLkVkZ2VFbmRTdGFyLnByb3RvdHlwZS5pbnNlcnQ9ZnVuY3Rpb24oZSl7dGhyb3cgbmV3IGpzdHMuZXJyb3IuQWJzdHJhY3RNZXRob2RJbnZvY2F0aW9uRXJyb3IoKTt9O2pzdHMuZ2VvbWdyYXBoLkVkZ2VFbmRTdGFyLnByb3RvdHlwZS5pbnNlcnRFZGdlRW5kPWZ1bmN0aW9uKGUsb2JqKXt0aGlzLmVkZ2VNYXAucHV0KGUsb2JqKTt0aGlzLmVkZ2VMaXN0PW51bGw7fTtqc3RzLmdlb21ncmFwaC5FZGdlRW5kU3Rhci5wcm90b3R5cGUuZ2V0Q29vcmRpbmF0ZT1mdW5jdGlvbigpe3ZhciBpdD10aGlzLml0ZXJhdG9yKCk7aWYoIWl0Lmhhc05leHQoKSlcbnJldHVybiBudWxsO3ZhciBlPWl0Lm5leHQoKTtyZXR1cm4gZS5nZXRDb29yZGluYXRlKCk7fTtqc3RzLmdlb21ncmFwaC5FZGdlRW5kU3Rhci5wcm90b3R5cGUuZ2V0RGVncmVlPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZWRnZU1hcC5zaXplKCk7fTtqc3RzLmdlb21ncmFwaC5FZGdlRW5kU3Rhci5wcm90b3R5cGUuaXRlcmF0b3I9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5nZXRFZGdlcygpLml0ZXJhdG9yKCk7fTtqc3RzLmdlb21ncmFwaC5FZGdlRW5kU3Rhci5wcm90b3R5cGUuZ2V0RWRnZXM9ZnVuY3Rpb24oKXtpZih0aGlzLmVkZ2VMaXN0PT09bnVsbCl7dGhpcy5lZGdlTGlzdD1uZXcgamF2YXNjcmlwdC51dGlsLkFycmF5TGlzdCh0aGlzLmVkZ2VNYXAudmFsdWVzKCkpO31cbnJldHVybiB0aGlzLmVkZ2VMaXN0O307anN0cy5nZW9tZ3JhcGguRWRnZUVuZFN0YXIucHJvdG90eXBlLmdldE5leHRDVz1mdW5jdGlvbihlZSl7dGhpcy5nZXRFZGdlcygpO3ZhciBpPXRoaXMuZWRnZUxpc3QuaW5kZXhPZihlZSk7dmFyIGlOZXh0Q1c9aS0xO2lmKGk9PT0wKVxuaU5leHRDVz10aGlzLmVkZ2VMaXN0Lmxlbmd0aC0xO3JldHVybiB0aGlzLmVkZ2VMaXN0W2lOZXh0Q1ddO307anN0cy5nZW9tZ3JhcGguRWRnZUVuZFN0YXIucHJvdG90eXBlLmNvbXB1dGVMYWJlbGxpbmc9ZnVuY3Rpb24oZ2VvbUdyYXBoKXt0aGlzLmNvbXB1dGVFZGdlRW5kTGFiZWxzKGdlb21HcmFwaFswXS5nZXRCb3VuZGFyeU5vZGVSdWxlKCkpO3RoaXMucHJvcGFnYXRlU2lkZUxhYmVscygwKTt0aGlzLnByb3BhZ2F0ZVNpZGVMYWJlbHMoMSk7dmFyIGhhc0RpbWVuc2lvbmFsQ29sbGFwc2VFZGdlPVtmYWxzZSxmYWxzZV07Zm9yKHZhciBpdD10aGlzLml0ZXJhdG9yKCk7aXQuaGFzTmV4dCgpOyl7dmFyIGU9aXQubmV4dCgpO3ZhciBsYWJlbD1lLmdldExhYmVsKCk7Zm9yKHZhciBnZW9taT0wO2dlb21pPDI7Z2VvbWkrKyl7aWYobGFiZWwuaXNMaW5lKGdlb21pKSYmbGFiZWwuZ2V0TG9jYXRpb24oZ2VvbWkpPT09anN0cy5nZW9tLkxvY2F0aW9uLkJPVU5EQVJZKVxuaGFzRGltZW5zaW9uYWxDb2xsYXBzZUVkZ2VbZ2VvbWldPXRydWU7fX1cbmZvcih2YXIgaXQ9dGhpcy5pdGVyYXRvcigpO2l0Lmhhc05leHQoKTspe3ZhciBlPWl0Lm5leHQoKTt2YXIgbGFiZWw9ZS5nZXRMYWJlbCgpO2Zvcih2YXIgZ2VvbWk9MDtnZW9taTwyO2dlb21pKyspe2lmKGxhYmVsLmlzQW55TnVsbChnZW9taSkpe3ZhciBsb2M9anN0cy5nZW9tLkxvY2F0aW9uLk5PTkU7aWYoaGFzRGltZW5zaW9uYWxDb2xsYXBzZUVkZ2VbZ2VvbWldKXtsb2M9anN0cy5nZW9tLkxvY2F0aW9uLkVYVEVSSU9SO31lbHNle3ZhciBwPWUuZ2V0Q29vcmRpbmF0ZSgpO2xvYz10aGlzLmdldExvY2F0aW9uKGdlb21pLHAsZ2VvbUdyYXBoKTt9XG5sYWJlbC5zZXRBbGxMb2NhdGlvbnNJZk51bGwoZ2VvbWksbG9jKTt9fX19O2pzdHMuZ2VvbWdyYXBoLkVkZ2VFbmRTdGFyLnByb3RvdHlwZS5jb21wdXRlRWRnZUVuZExhYmVscz1mdW5jdGlvbihib3VuZGFyeU5vZGVSdWxlKXtmb3IodmFyIGl0PXRoaXMuaXRlcmF0b3IoKTtpdC5oYXNOZXh0KCk7KXt2YXIgZWU9aXQubmV4dCgpO2VlLmNvbXB1dGVMYWJlbChib3VuZGFyeU5vZGVSdWxlKTt9fTtqc3RzLmdlb21ncmFwaC5FZGdlRW5kU3Rhci5wcm90b3R5cGUuZ2V0TG9jYXRpb249ZnVuY3Rpb24oZ2VvbUluZGV4LHAsZ2VvbSl7aWYodGhpcy5wdEluQXJlYUxvY2F0aW9uW2dlb21JbmRleF09PT1qc3RzLmdlb20uTG9jYXRpb24uTk9ORSl7dGhpcy5wdEluQXJlYUxvY2F0aW9uW2dlb21JbmRleF09anN0cy5hbGdvcml0aG0ubG9jYXRlLlNpbXBsZVBvaW50SW5BcmVhTG9jYXRvci5sb2NhdGUocCxnZW9tW2dlb21JbmRleF0uZ2V0R2VvbWV0cnkoKSk7fVxucmV0dXJuIHRoaXMucHRJbkFyZWFMb2NhdGlvbltnZW9tSW5kZXhdO307anN0cy5nZW9tZ3JhcGguRWRnZUVuZFN0YXIucHJvdG90eXBlLmlzQXJlYUxhYmVsc0NvbnNpc3RlbnQ9ZnVuY3Rpb24oZ2VvbUdyYXBoKXt0aGlzLmNvbXB1dGVFZGdlRW5kTGFiZWxzKGdlb21HcmFwaC5nZXRCb3VuZGFyeU5vZGVSdWxlKCkpO3JldHVybiB0aGlzLmNoZWNrQXJlYUxhYmVsc0NvbnNpc3RlbnQoMCk7fTtqc3RzLmdlb21ncmFwaC5FZGdlRW5kU3Rhci5wcm90b3R5cGUuY2hlY2tBcmVhTGFiZWxzQ29uc2lzdGVudD1mdW5jdGlvbihnZW9tSW5kZXgpe3ZhciBlZGdlcz10aGlzLmdldEVkZ2VzKCk7aWYoZWRnZXMuc2l6ZSgpPD0wKVxucmV0dXJuIHRydWU7dmFyIGxhc3RFZGdlSW5kZXg9ZWRnZXMuc2l6ZSgpLTE7dmFyIHN0YXJ0TGFiZWw9ZWRnZXMuZ2V0KGxhc3RFZGdlSW5kZXgpLmdldExhYmVsKCk7dmFyIHN0YXJ0TG9jPXN0YXJ0TGFiZWwuZ2V0TG9jYXRpb24oZ2VvbUluZGV4LGpzdHMuZ2VvbWdyYXBoLlBvc2l0aW9uLkxFRlQpO2pzdHMudXRpbC5Bc3NlcnQuaXNUcnVlKHN0YXJ0TG9jIT1qc3RzLmdlb20uTG9jYXRpb24uTk9ORSwnRm91bmQgdW5sYWJlbGxlZCBhcmVhIGVkZ2UnKTt2YXIgY3VyckxvYz1zdGFydExvYztmb3IodmFyIGl0PXRoaXMuaXRlcmF0b3IoKTtpdC5oYXNOZXh0KCk7KXt2YXIgZT1pdC5uZXh0KCk7dmFyIGxhYmVsPWUuZ2V0TGFiZWwoKTtqc3RzLnV0aWwuQXNzZXJ0LmlzVHJ1ZShsYWJlbC5pc0FyZWEoZ2VvbUluZGV4KSwnRm91bmQgbm9uLWFyZWEgZWRnZScpO3ZhciBsZWZ0TG9jPWxhYmVsLmdldExvY2F0aW9uKGdlb21JbmRleCxqc3RzLmdlb21ncmFwaC5Qb3NpdGlvbi5MRUZUKTt2YXIgcmlnaHRMb2M9bGFiZWwuZ2V0TG9jYXRpb24oZ2VvbUluZGV4LGpzdHMuZ2VvbWdyYXBoLlBvc2l0aW9uLlJJR0hUKTtpZihsZWZ0TG9jPT09cmlnaHRMb2Mpe3JldHVybiBmYWxzZTt9XG5pZihyaWdodExvYyE9PWN1cnJMb2Mpe3JldHVybiBmYWxzZTt9XG5jdXJyTG9jPWxlZnRMb2M7fVxucmV0dXJuIHRydWU7fTtqc3RzLmdlb21ncmFwaC5FZGdlRW5kU3Rhci5wcm90b3R5cGUucHJvcGFnYXRlU2lkZUxhYmVscz1mdW5jdGlvbihnZW9tSW5kZXgpe3ZhciBzdGFydExvYz1qc3RzLmdlb20uTG9jYXRpb24uTk9ORTtmb3IodmFyIGl0PXRoaXMuaXRlcmF0b3IoKTtpdC5oYXNOZXh0KCk7KXt2YXIgZT1pdC5uZXh0KCk7dmFyIGxhYmVsPWUuZ2V0TGFiZWwoKTtpZihsYWJlbC5pc0FyZWEoZ2VvbUluZGV4KSYmbGFiZWwuZ2V0TG9jYXRpb24oZ2VvbUluZGV4LGpzdHMuZ2VvbWdyYXBoLlBvc2l0aW9uLkxFRlQpIT09anN0cy5nZW9tLkxvY2F0aW9uLk5PTkUpXG5zdGFydExvYz1sYWJlbC5nZXRMb2NhdGlvbihnZW9tSW5kZXgsanN0cy5nZW9tZ3JhcGguUG9zaXRpb24uTEVGVCk7fVxuaWYoc3RhcnRMb2M9PT1qc3RzLmdlb20uTG9jYXRpb24uTk9ORSlcbnJldHVybjt2YXIgY3VyckxvYz1zdGFydExvYztmb3IodmFyIGl0PXRoaXMuaXRlcmF0b3IoKTtpdC5oYXNOZXh0KCk7KXt2YXIgZT1pdC5uZXh0KCk7dmFyIGxhYmVsPWUuZ2V0TGFiZWwoKTtpZihsYWJlbC5nZXRMb2NhdGlvbihnZW9tSW5kZXgsanN0cy5nZW9tZ3JhcGguUG9zaXRpb24uT04pPT09anN0cy5nZW9tLkxvY2F0aW9uLk5PTkUpXG5sYWJlbC5zZXRMb2NhdGlvbihnZW9tSW5kZXgsanN0cy5nZW9tZ3JhcGguUG9zaXRpb24uT04sY3VyckxvYyk7aWYobGFiZWwuaXNBcmVhKGdlb21JbmRleCkpe3ZhciBsZWZ0TG9jPWxhYmVsLmdldExvY2F0aW9uKGdlb21JbmRleCxqc3RzLmdlb21ncmFwaC5Qb3NpdGlvbi5MRUZUKTt2YXIgcmlnaHRMb2M9bGFiZWwuZ2V0TG9jYXRpb24oZ2VvbUluZGV4LGpzdHMuZ2VvbWdyYXBoLlBvc2l0aW9uLlJJR0hUKTtpZihyaWdodExvYyE9PWpzdHMuZ2VvbS5Mb2NhdGlvbi5OT05FKXtpZihyaWdodExvYyE9PWN1cnJMb2MpXG50aHJvdyBuZXcganN0cy5lcnJvci5Ub3BvbG9neUVycm9yKCdzaWRlIGxvY2F0aW9uIGNvbmZsaWN0JyxlLmdldENvb3JkaW5hdGUoKSk7aWYobGVmdExvYz09PWpzdHMuZ2VvbS5Mb2NhdGlvbi5OT05FKXtqc3RzLnV0aWwuQXNzZXJ0LnNob3VsZE5ldmVyUmVhY2hIZXJlKCdmb3VuZCBzaW5nbGUgbnVsbCBzaWRlIChhdCAnK1xuZS5nZXRDb29yZGluYXRlKCkrJyknKTt9XG5jdXJyTG9jPWxlZnRMb2M7fWVsc2V7anN0cy51dGlsLkFzc2VydC5pc1RydWUobGFiZWwuZ2V0TG9jYXRpb24oZ2VvbUluZGV4LGpzdHMuZ2VvbWdyYXBoLlBvc2l0aW9uLkxFRlQpPT09anN0cy5nZW9tLkxvY2F0aW9uLk5PTkUsJ2ZvdW5kIHNpbmdsZSBudWxsIHNpZGUnKTtsYWJlbC5zZXRMb2NhdGlvbihnZW9tSW5kZXgsanN0cy5nZW9tZ3JhcGguUG9zaXRpb24uUklHSFQsY3VyckxvYyk7bGFiZWwuc2V0TG9jYXRpb24oZ2VvbUluZGV4LGpzdHMuZ2VvbWdyYXBoLlBvc2l0aW9uLkxFRlQsY3VyckxvYyk7fX19fTtqc3RzLmdlb21ncmFwaC5FZGdlRW5kU3Rhci5wcm90b3R5cGUuZmluZEluZGV4PWZ1bmN0aW9uKGVTZWFyY2gpe3RoaXMuaXRlcmF0b3IoKTtmb3IodmFyIGk9MDtpPHRoaXMuZWRnZUxpc3Quc2l6ZSgpO2krKyl7dmFyIGU9dGhpcy5lZGdlTGlzdC5nZXQoaSk7aWYoZT09PWVTZWFyY2gpXG5yZXR1cm4gaTt9XG5yZXR1cm4tMTt9O2pzdHMub3BlcmF0aW9uLnJlbGF0ZS5FZGdlRW5kQnVuZGxlU3Rhcj1mdW5jdGlvbigpe2pzdHMuZ2VvbWdyYXBoLkVkZ2VFbmRTdGFyLmFwcGx5KHRoaXMsYXJndW1lbnRzKTt9O2pzdHMub3BlcmF0aW9uLnJlbGF0ZS5FZGdlRW5kQnVuZGxlU3Rhci5wcm90b3R5cGU9bmV3IGpzdHMuZ2VvbWdyYXBoLkVkZ2VFbmRTdGFyKCk7anN0cy5vcGVyYXRpb24ucmVsYXRlLkVkZ2VFbmRCdW5kbGVTdGFyLnByb3RvdHlwZS5pbnNlcnQ9ZnVuY3Rpb24oZSl7dmFyIGViPXRoaXMuZWRnZU1hcC5nZXQoZSk7aWYoZWI9PT1udWxsKXtlYj1uZXcganN0cy5vcGVyYXRpb24ucmVsYXRlLkVkZ2VFbmRCdW5kbGUoZSk7dGhpcy5pbnNlcnRFZGdlRW5kKGUsZWIpO31cbmVsc2V7ZWIuaW5zZXJ0KGUpO319O2pzdHMub3BlcmF0aW9uLnJlbGF0ZS5FZGdlRW5kQnVuZGxlU3Rhci5wcm90b3R5cGUudXBkYXRlSU09ZnVuY3Rpb24oaW0pe2Zvcih2YXIgaXQ9dGhpcy5pdGVyYXRvcigpO2l0Lmhhc05leHQoKTspe3ZhciBlc2I9aXQubmV4dCgpO2VzYi51cGRhdGVJTShpbSk7fX07anN0cy5pbmRleC5BcnJheUxpc3RWaXNpdG9yPWZ1bmN0aW9uKCl7dGhpcy5pdGVtcz1bXTt9O2pzdHMuaW5kZXguQXJyYXlMaXN0VmlzaXRvci5wcm90b3R5cGUudmlzaXRJdGVtPWZ1bmN0aW9uKGl0ZW0pe3RoaXMuaXRlbXMucHVzaChpdGVtKTt9O2pzdHMuaW5kZXguQXJyYXlMaXN0VmlzaXRvci5wcm90b3R5cGUuZ2V0SXRlbXM9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5pdGVtczt9O2pzdHMuYWxnb3JpdGhtLmRpc3RhbmNlLkRpc3RhbmNlVG9Qb2ludD1mdW5jdGlvbigpe307anN0cy5hbGdvcml0aG0uZGlzdGFuY2UuRGlzdGFuY2VUb1BvaW50LmNvbXB1dGVEaXN0YW5jZT1mdW5jdGlvbihnZW9tLHB0LHB0RGlzdCl7aWYoZ2VvbSBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5MaW5lU3RyaW5nKXtqc3RzLmFsZ29yaXRobS5kaXN0YW5jZS5EaXN0YW5jZVRvUG9pbnQuY29tcHV0ZURpc3RhbmNlMihnZW9tLHB0LHB0RGlzdCk7fWVsc2UgaWYoZ2VvbSBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5Qb2x5Z29uKXtqc3RzLmFsZ29yaXRobS5kaXN0YW5jZS5EaXN0YW5jZVRvUG9pbnQuY29tcHV0ZURpc3RhbmNlNChnZW9tLHB0LHB0RGlzdCk7fWVsc2UgaWYoZ2VvbSBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5HZW9tZXRyeUNvbGxlY3Rpb24pe3ZhciBnYz1nZW9tO2Zvcih2YXIgaT0wO2k8Z2MuZ2V0TnVtR2VvbWV0cmllcygpO2krKyl7dmFyIGc9Z2MuZ2V0R2VvbWV0cnlOKGkpO2pzdHMuYWxnb3JpdGhtLmRpc3RhbmNlLkRpc3RhbmNlVG9Qb2ludC5jb21wdXRlRGlzdGFuY2UoZyxwdCxwdERpc3QpO319ZWxzZXtwdERpc3Quc2V0TWluaW11bShnZW9tLmdldENvb3JkaW5hdGUoKSxwdCk7fX07anN0cy5hbGdvcml0aG0uZGlzdGFuY2UuRGlzdGFuY2VUb1BvaW50LmNvbXB1dGVEaXN0YW5jZTI9ZnVuY3Rpb24obGluZSxwdCxwdERpc3Qpe3ZhciB0ZW1wU2VnbWVudD1uZXcganN0cy5nZW9tLkxpbmVTZWdtZW50KCk7dmFyIGNvb3Jkcz1saW5lLmdldENvb3JkaW5hdGVzKCk7Zm9yKHZhciBpPTA7aTxjb29yZHMubGVuZ3RoLTE7aSsrKXt0ZW1wU2VnbWVudC5zZXRDb29yZGluYXRlcyhjb29yZHNbaV0sY29vcmRzW2krMV0pO3ZhciBjbG9zZXN0UHQ9dGVtcFNlZ21lbnQuY2xvc2VzdFBvaW50KHB0KTtwdERpc3Quc2V0TWluaW11bShjbG9zZXN0UHQscHQpO319O2pzdHMuYWxnb3JpdGhtLmRpc3RhbmNlLkRpc3RhbmNlVG9Qb2ludC5jb21wdXRlRGlzdGFuY2UzPWZ1bmN0aW9uKHNlZ21lbnQscHQscHREaXN0KXt2YXIgY2xvc2VzdFB0PXNlZ21lbnQuY2xvc2VzdFBvaW50KHB0KTtwdERpc3Quc2V0TWluaW11bShjbG9zZXN0UHQscHQpO307anN0cy5hbGdvcml0aG0uZGlzdGFuY2UuRGlzdGFuY2VUb1BvaW50LmNvbXB1dGVEaXN0YW5jZTQ9ZnVuY3Rpb24ocG9seSxwdCxwdERpc3Qpe2pzdHMuYWxnb3JpdGhtLmRpc3RhbmNlLkRpc3RhbmNlVG9Qb2ludC5jb21wdXRlRGlzdGFuY2UyKHBvbHkuZ2V0RXh0ZXJpb3JSaW5nKCkscHQscHREaXN0KTtmb3IodmFyIGk9MDtpPHBvbHkuZ2V0TnVtSW50ZXJpb3JSaW5nKCk7aSsrKXtqc3RzLmFsZ29yaXRobS5kaXN0YW5jZS5EaXN0YW5jZVRvUG9pbnQuY29tcHV0ZURpc3RhbmNlMihwb2x5LmdldEludGVyaW9yUmluZ04oaSkscHQscHREaXN0KTt9fTtqc3RzLmluZGV4LnN0cnRyZWUuSXRlbUJvdW5kYWJsZT1mdW5jdGlvbihib3VuZHMsaXRlbSl7dGhpcy5ib3VuZHM9Ym91bmRzO3RoaXMuaXRlbT1pdGVtO307anN0cy5pbmRleC5zdHJ0cmVlLkl0ZW1Cb3VuZGFibGUucHJvdG90eXBlPW5ldyBqc3RzLmluZGV4LnN0cnRyZWUuQm91bmRhYmxlKCk7anN0cy5pbmRleC5zdHJ0cmVlLkl0ZW1Cb3VuZGFibGUuY29uc3RydWN0b3I9anN0cy5pbmRleC5zdHJ0cmVlLkl0ZW1Cb3VuZGFibGU7anN0cy5pbmRleC5zdHJ0cmVlLkl0ZW1Cb3VuZGFibGUucHJvdG90eXBlLmJvdW5kcz1udWxsO2pzdHMuaW5kZXguc3RydHJlZS5JdGVtQm91bmRhYmxlLnByb3RvdHlwZS5pdGVtPW51bGw7anN0cy5pbmRleC5zdHJ0cmVlLkl0ZW1Cb3VuZGFibGUucHJvdG90eXBlLmdldEJvdW5kcz1mdW5jdGlvbigpe3JldHVybiB0aGlzLmJvdW5kczt9O2pzdHMuaW5kZXguc3RydHJlZS5JdGVtQm91bmRhYmxlLnByb3RvdHlwZS5nZXRJdGVtPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuaXRlbTt9OyhmdW5jdGlvbigpe3ZhciBBcnJheUxpc3Q9amF2YXNjcmlwdC51dGlsLkFycmF5TGlzdDt2YXIgVHJlZU1hcD1qYXZhc2NyaXB0LnV0aWwuVHJlZU1hcDtqc3RzLmdlb21ncmFwaC5FZGdlTGlzdD1mdW5jdGlvbigpe3RoaXMuZWRnZXM9bmV3IEFycmF5TGlzdCgpO3RoaXMub2NhTWFwPW5ldyBUcmVlTWFwKCk7fTtqc3RzLmdlb21ncmFwaC5FZGdlTGlzdC5wcm90b3R5cGUuZWRnZXM9bnVsbDtqc3RzLmdlb21ncmFwaC5FZGdlTGlzdC5wcm90b3R5cGUub2NhTWFwPW51bGw7anN0cy5nZW9tZ3JhcGguRWRnZUxpc3QucHJvdG90eXBlLmFkZD1mdW5jdGlvbihlKXt0aGlzLmVkZ2VzLmFkZChlKTt2YXIgb2NhPW5ldyBqc3RzLm5vZGluZy5PcmllbnRlZENvb3JkaW5hdGVBcnJheShlLmdldENvb3JkaW5hdGVzKCkpO3RoaXMub2NhTWFwLnB1dChvY2EsZSk7fTtqc3RzLmdlb21ncmFwaC5FZGdlTGlzdC5wcm90b3R5cGUuYWRkQWxsPWZ1bmN0aW9uKGVkZ2VDb2xsKXtmb3IodmFyIGk9ZWRnZUNvbGwuaXRlcmF0b3IoKTtpLmhhc05leHQoKTspe3RoaXMuYWRkKGkubmV4dCgpKTt9fTtqc3RzLmdlb21ncmFwaC5FZGdlTGlzdC5wcm90b3R5cGUuZ2V0RWRnZXM9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5lZGdlczt9O2pzdHMuZ2VvbWdyYXBoLkVkZ2VMaXN0LnByb3RvdHlwZS5maW5kRXF1YWxFZGdlPWZ1bmN0aW9uKGUpe3ZhciBvY2E9bmV3IGpzdHMubm9kaW5nLk9yaWVudGVkQ29vcmRpbmF0ZUFycmF5KGUuZ2V0Q29vcmRpbmF0ZXMoKSk7dmFyIG1hdGNoRWRnZT10aGlzLm9jYU1hcC5nZXQob2NhKTtyZXR1cm4gbWF0Y2hFZGdlO307anN0cy5nZW9tZ3JhcGguRWRnZUxpc3QucHJvdG90eXBlLmdldEVkZ2VzPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZWRnZXM7fTtqc3RzLmdlb21ncmFwaC5FZGdlTGlzdC5wcm90b3R5cGUuaXRlcmF0b3I9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5lZGdlcy5pdGVyYXRvcigpO307anN0cy5nZW9tZ3JhcGguRWRnZUxpc3QucHJvdG90eXBlLmdldD1mdW5jdGlvbihpKXtyZXR1cm4gdGhpcy5lZGdlcy5nZXQoaSk7fTtqc3RzLmdlb21ncmFwaC5FZGdlTGlzdC5wcm90b3R5cGUuZmluZEVkZ2VJbmRleD1mdW5jdGlvbihlKXtmb3IodmFyIGk9MDtpPHRoaXMuZWRnZXMuc2l6ZSgpO2krKyl7aWYodGhpcy5lZGdlcy5nZXQoaSkuZXF1YWxzKGUpKVxucmV0dXJuIGk7fVxucmV0dXJuLTE7fTt9KSgpO2pzdHMub3BlcmF0aW9uLklzU2ltcGxlT3A9ZnVuY3Rpb24oZ2VvbSl7dGhpcy5nZW9tPWdlb207fTtqc3RzLm9wZXJhdGlvbi5Jc1NpbXBsZU9wLnByb3RvdHlwZS5nZW9tPW51bGw7anN0cy5vcGVyYXRpb24uSXNTaW1wbGVPcC5wcm90b3R5cGUuaXNDbG9zZWRFbmRwb2ludHNJbkludGVyaW9yPXRydWU7anN0cy5vcGVyYXRpb24uSXNTaW1wbGVPcC5wcm90b3R5cGUubm9uU2ltcGxlTG9jYXRpb249bnVsbDtqc3RzLm9wZXJhdGlvbi5Jc1NpbXBsZU9wLnByb3RvdHlwZS5Jc1NpbXBsZU9wPWZ1bmN0aW9uKGdlb20pe3RoaXMuZ2VvbT1nZW9tO307anN0cy5vcGVyYXRpb24uSXNTaW1wbGVPcC5wcm90b3R5cGUuaXNTaW1wbGU9ZnVuY3Rpb24oKXt0aGlzLm5vblNpbXBsZUxvY2F0aW9uPW51bGw7aWYodGhpcy5nZW9tIGluc3RhbmNlb2YganN0cy5nZW9tLkxpbmVTdHJpbmcpe3JldHVybiB0aGlzLmlzU2ltcGxlTGluZWFyR2VvbWV0cnkodGhpcy5nZW9tKTt9XG5pZih0aGlzLmdlb20gaW5zdGFuY2VvZiBqc3RzLmdlb20uTXVsdGlMaW5lU3RyaW5nKXtyZXR1cm4gdGhpcy5pc1NpbXBsZUxpbmVhckdlb21ldHJ5KHRoaXMuZ2VvbSk7fVxuaWYodGhpcy5nZW9tIGluc3RhbmNlb2YganN0cy5nZW9tLk11bHRpUG9pbnQpe3JldHVybiB0aGlzLmlzU2ltcGxlTXVsdGlQb2ludCh0aGlzLmdlb20pO31cbnJldHVybiB0cnVlO307anN0cy5vcGVyYXRpb24uSXNTaW1wbGVPcC5wcm90b3R5cGUuaXNTaW1wbGVNdWx0aVBvaW50PWZ1bmN0aW9uKG1wKXtpZihtcC5pc0VtcHR5KCkpXG5yZXR1cm4gdHJ1ZTt2YXIgcG9pbnRzPVtdO2Zvcih2YXIgaT0wO2k8bXAuZ2V0TnVtR2VvbWV0cmllcygpO2krKyl7dmFyIHB0PW1wLmdldEdlb21ldHJ5TihpKTt2YXIgcD1wdC5nZXRDb29yZGluYXRlKCk7Zm9yKHZhciBqPTA7ajxwb2ludHMubGVuZ3RoO2orKyl7dmFyIHBvaW50PXBvaW50c1tqXTtpZihwLmVxdWFsczJEKHBvaW50KSl7dGhpcy5ub25TaW1wbGVMb2NhdGlvbj1wO3JldHVybiBmYWxzZTt9fVxucG9pbnRzLnB1c2gocCk7fVxucmV0dXJuIHRydWU7fTtqc3RzLm9wZXJhdGlvbi5Jc1NpbXBsZU9wLnByb3RvdHlwZS5pc1NpbXBsZUxpbmVhckdlb21ldHJ5PWZ1bmN0aW9uKGdlb20pe2lmKGdlb20uaXNFbXB0eSgpKVxucmV0dXJuIHRydWU7dmFyIGdyYXBoPW5ldyBqc3RzLmdlb21ncmFwaC5HZW9tZXRyeUdyYXBoKDAsZ2VvbSk7dmFyIGxpPW5ldyBqc3RzLmFsZ29yaXRobS5Sb2J1c3RMaW5lSW50ZXJzZWN0b3IoKTt2YXIgc2k9Z3JhcGguY29tcHV0ZVNlbGZOb2RlcyhsaSx0cnVlKTtpZighc2kuaGFzSW50ZXJzZWN0aW9uKCkpXG5yZXR1cm4gdHJ1ZTtpZihzaS5oYXNQcm9wZXJJbnRlcnNlY3Rpb24oKSl7dGhpcy5ub25TaW1wbGVMb2NhdGlvbj1zaS5nZXRQcm9wZXJJbnRlcnNlY3Rpb25Qb2ludCgpO3JldHVybiBmYWxzZTt9XG5pZih0aGlzLmhhc05vbkVuZHBvaW50SW50ZXJzZWN0aW9uKGdyYXBoKSlcbnJldHVybiBmYWxzZTtpZih0aGlzLmlzQ2xvc2VkRW5kcG9pbnRzSW5JbnRlcmlvcil7aWYodGhpcy5oYXNDbG9zZWRFbmRwb2ludEludGVyc2VjdGlvbihncmFwaCkpXG5yZXR1cm4gZmFsc2U7fVxucmV0dXJuIHRydWU7fTtqc3RzLm9wZXJhdGlvbi5Jc1NpbXBsZU9wLnByb3RvdHlwZS5oYXNOb25FbmRwb2ludEludGVyc2VjdGlvbj1mdW5jdGlvbihncmFwaCl7Zm9yKHZhciBpPWdyYXBoLmdldEVkZ2VJdGVyYXRvcigpO2kuaGFzTmV4dCgpOyl7dmFyIGU9aS5uZXh0KCk7dmFyIG1heFNlZ21lbnRJbmRleD1lLmdldE1heGltdW1TZWdtZW50SW5kZXgoKTtmb3IodmFyIGVpSXQ9ZS5nZXRFZGdlSW50ZXJzZWN0aW9uTGlzdCgpLml0ZXJhdG9yKCk7ZWlJdC5oYXNOZXh0KCk7KXt2YXIgZWk9ZWlJdC5uZXh0KCk7aWYoIWVpLmlzRW5kUG9pbnQobWF4U2VnbWVudEluZGV4KSl7dGhpcy5ub25TaW1wbGVMb2NhdGlvbj1laS5nZXRDb29yZGluYXRlKCk7cmV0dXJuIHRydWU7fX19XG5yZXR1cm4gZmFsc2U7fTtqc3RzLm9wZXJhdGlvbi5Jc1NpbXBsZU9wLnByb3RvdHlwZS5oYXNDbG9zZWRFbmRwb2ludEludGVyc2VjdGlvbj1mdW5jdGlvbihncmFwaCl7dmFyIGVuZFBvaW50cz1uZXcgamF2YXNjcmlwdC51dGlsLlRyZWVNYXAoKTtmb3IodmFyIGk9Z3JhcGguZ2V0RWRnZUl0ZXJhdG9yKCk7aS5oYXNOZXh0KCk7KXt2YXIgZT1pLm5leHQoKTt2YXIgbWF4U2VnbWVudEluZGV4PWUuZ2V0TWF4aW11bVNlZ21lbnRJbmRleCgpO3ZhciBpc0Nsb3NlZD1lLmlzQ2xvc2VkKCk7dmFyIHAwPWUuZ2V0Q29vcmRpbmF0ZSgwKTt0aGlzLmFkZEVuZHBvaW50KGVuZFBvaW50cyxwMCxpc0Nsb3NlZCk7dmFyIHAxPWUuZ2V0Q29vcmRpbmF0ZShlLmdldE51bVBvaW50cygpLTEpO3RoaXMuYWRkRW5kcG9pbnQoZW5kUG9pbnRzLHAxLGlzQ2xvc2VkKTt9XG5mb3IodmFyIGk9ZW5kUG9pbnRzLnZhbHVlcygpLml0ZXJhdG9yKCk7aS5oYXNOZXh0KCk7KXt2YXIgZWlJbmZvPWkubmV4dCgpO2lmKGVpSW5mby5pc0Nsb3NlZCYmZWlJbmZvLmRlZ3JlZSE9Mil7dGhpcy5ub25TaW1wbGVMb2NhdGlvbj1laUluZm8uZ2V0Q29vcmRpbmF0ZSgpO3JldHVybiB0cnVlO319XG5yZXR1cm4gZmFsc2U7fTtqc3RzLm9wZXJhdGlvbi5Jc1NpbXBsZU9wLkVuZHBvaW50SW5mbz1mdW5jdGlvbihwdCl7dGhpcy5wdD1wdDt0aGlzLmlzQ2xvc2VkPWZhbHNlO3RoaXMuZGVncmVlPTA7fTtqc3RzLm9wZXJhdGlvbi5Jc1NpbXBsZU9wLkVuZHBvaW50SW5mby5wcm90b3R5cGUucHQ9bnVsbDtqc3RzLm9wZXJhdGlvbi5Jc1NpbXBsZU9wLkVuZHBvaW50SW5mby5wcm90b3R5cGUuaXNDbG9zZWQ9bnVsbDtqc3RzLm9wZXJhdGlvbi5Jc1NpbXBsZU9wLkVuZHBvaW50SW5mby5wcm90b3R5cGUuZGVncmVlPW51bGw7anN0cy5vcGVyYXRpb24uSXNTaW1wbGVPcC5FbmRwb2ludEluZm8ucHJvdG90eXBlLmdldENvb3JkaW5hdGU9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5wdDt9O2pzdHMub3BlcmF0aW9uLklzU2ltcGxlT3AuRW5kcG9pbnRJbmZvLnByb3RvdHlwZS5hZGRFbmRwb2ludD1mdW5jdGlvbihpc0Nsb3NlZCl7dGhpcy5kZWdyZWUrKzt0aGlzLmlzQ2xvc2VkPXRoaXMuaXNDbG9zZWR8fGlzQ2xvc2VkO307anN0cy5vcGVyYXRpb24uSXNTaW1wbGVPcC5wcm90b3R5cGUuYWRkRW5kcG9pbnQ9ZnVuY3Rpb24oZW5kUG9pbnRzLHAsaXNDbG9zZWQpe3ZhciBlaUluZm89ZW5kUG9pbnRzLmdldChwKTtpZihlaUluZm89PT1udWxsKXtlaUluZm89bmV3IGpzdHMub3BlcmF0aW9uLklzU2ltcGxlT3AuRW5kcG9pbnRJbmZvKHApO2VuZFBvaW50cy5wdXQocCxlaUluZm8pO31cbmVpSW5mby5hZGRFbmRwb2ludChpc0Nsb3NlZCk7fTsoZnVuY3Rpb24oKXt2YXIgTGluZVN0cmluZ1NuYXBwZXI9ZnVuY3Rpb24oKXt0aGlzLnNuYXBUb2xlcmFuY2U9MC4wO3RoaXMuc2VnPW5ldyBqc3RzLmdlb20uTGluZVNlZ21lbnQoKTt0aGlzLmFsbG93U25hcHBpbmdUb1NvdXJjZVZlcnRpY2VzPWZhbHNlO3RoaXMuaXNDbG9zZWQ9ZmFsc2U7dGhpcy5zcmNQdHM9W107aWYoYXJndW1lbnRzWzBdaW5zdGFuY2VvZiBqc3RzLmdlb20uTGluZVN0cmluZyl7dGhpcy5pbml0RnJvbUxpbmUuYXBwbHkodGhpcyxhcmd1bWVudHMpO31lbHNle3RoaXMuaW5pdEZyb21Qb2ludHMuYXBwbHkodGhpcyxhcmd1bWVudHMpO319O0xpbmVTdHJpbmdTbmFwcGVyLnByb3RvdHlwZS5pbml0RnJvbUxpbmU9ZnVuY3Rpb24oc3JjTGluZSxzbmFwVG9sZXJhbmNlKXt0aGlzLmluaXRGcm9tUG9pbnRzKHNyY0xpbmUuZ2V0Q29vcmRpbmF0ZXMoKSxzbmFwVG9sZXJhbmNlKTt9O0xpbmVTdHJpbmdTbmFwcGVyLnByb3RvdHlwZS5pbml0RnJvbVBvaW50cz1mdW5jdGlvbihzcmNQdHMsc25hcFRvbGVyYW5jZSl7dGhpcy5zcmNQdHM9c3JjUHRzO3RoaXMuaXNDbG9zZWQ9dGhpcy5jYWxjSXNDbG9zZWQoc3JjUHRzKTt0aGlzLnNuYXBUb2xlcmFuY2U9c25hcFRvbGVyYW5jZTt9O0xpbmVTdHJpbmdTbmFwcGVyLnByb3RvdHlwZS5zZXRBbGxvd1NuYXBwaW5nVG9Tb3VyY2VWZXJ0aWNlcz1mdW5jdGlvbihhbGxvd1NuYXBwaW5nVG9Tb3VyY2VWZXJ0aWNlcyl7dGhpcy5hbGxvd1NuYXBwaW5nVG9Tb3VyY2VWZXJ0aWNlcz1hbGxvd1NuYXBwaW5nVG9Tb3VyY2VWZXJ0aWNlczt9O0xpbmVTdHJpbmdTbmFwcGVyLnByb3RvdHlwZS5jYWxjSXNDbG9zZWQ9ZnVuY3Rpb24ocHRzKXtpZihwdHMubGVuZ3RoPD0xKXtyZXR1cm4gZmFsc2U7fVxucmV0dXJuIHB0c1swXS5lcXVhbHMocHRzW3B0cy5sZW5ndGgtMV0pO307TGluZVN0cmluZ1NuYXBwZXIucHJvdG90eXBlLnNuYXBUbz1mdW5jdGlvbihzbmFwUHRzKXt2YXIgY29vcmRMaXN0PW5ldyBqc3RzLmdlb20uQ29vcmRpbmF0ZUxpc3QodGhpcy5zcmNQdHMpO3RoaXMuc25hcFZlcnRpY2VzKGNvb3JkTGlzdCxzbmFwUHRzKTt0aGlzLnNuYXBTZWdtZW50cyhjb29yZExpc3Qsc25hcFB0cyk7cmV0dXJuIGNvb3JkTGlzdC50b0Nvb3JkaW5hdGVBcnJheSgpO307TGluZVN0cmluZ1NuYXBwZXIucHJvdG90eXBlLnNuYXBWZXJ0aWNlcz1mdW5jdGlvbihzcmNDb29yZHMsc25hcFB0cyl7dmFyIGVuZD10aGlzLmlzQ2xvc2VkP3NyY0Nvb3Jkcy5zaXplKCktMTpzcmNDb29yZHMuc2l6ZSgpLGk9MCxzcmNQdCxzbmFwVmVydDtmb3IoaTtpPGVuZDtpKyspe3NyY1B0PXNyY0Nvb3Jkcy5nZXQoaSk7c25hcFZlcnQ9dGhpcy5maW5kU25hcEZvclZlcnRleChzcmNQdCxzbmFwUHRzKTtpZihzbmFwVmVydCE9PW51bGwpe3NyY0Nvb3Jkcy5zZXQoaSxuZXcganN0cy5nZW9tLkNvb3JkaW5hdGUoc25hcFZlcnQpKTtpZihpPT09MCYmdGhpcy5pc0Nsb3NlZClcbnNyY0Nvb3Jkcy5zZXQoc3JjQ29vcmRzLnNpemUoKS0xLG5ldyBqc3RzLmdlb20uQ29vcmRpbmF0ZShzbmFwVmVydCkpO319fTtMaW5lU3RyaW5nU25hcHBlci5wcm90b3R5cGUuZmluZFNuYXBGb3JWZXJ0ZXg9ZnVuY3Rpb24ocHQsc25hcFB0cyl7dmFyIGk9MCxpbD1zbmFwUHRzLmxlbmd0aDtmb3IoaT0wO2k8aWw7aSsrKXtpZihwdC5lcXVhbHMoc25hcFB0c1tpXSkpe3JldHVybiBudWxsO31cbmlmKHB0LmRpc3RhbmNlKHNuYXBQdHNbaV0pPHRoaXMuc25hcFRvbGVyYW5jZSl7cmV0dXJuIHNuYXBQdHNbaV07fX1cbnJldHVybiBudWxsO307TGluZVN0cmluZ1NuYXBwZXIucHJvdG90eXBlLnNuYXBTZWdtZW50cz1mdW5jdGlvbihzcmNDb29yZHMsc25hcFB0cyl7aWYoc25hcFB0cy5sZW5ndGg9PT0wKXtyZXR1cm47fVxudmFyIGRpc3RpbmN0UHRDb3VudD1zbmFwUHRzLmxlbmd0aCxpLHNuYXBQdCxpbmRleDtpZihzbmFwUHRzLmxlbmd0aD4xJiZzbmFwUHRzWzBdLmVxdWFsczJEKHNuYXBQdHNbc25hcFB0cy5sZW5ndGgtMV0pKXtkaXN0aW5jdFB0Q291bnQ9c25hcFB0cy5sZW5ndGgtMTt9XG5pPTA7Zm9yKGk7aTxkaXN0aW5jdFB0Q291bnQ7aSsrKXtzbmFwUHQ9c25hcFB0c1tpXTtpbmRleD10aGlzLmZpbmRTZWdtZW50SW5kZXhUb1NuYXAoc25hcFB0LHNyY0Nvb3Jkcyk7aWYoaW5kZXg+PTApe3NyY0Nvb3Jkcy5hZGQoaW5kZXgrMSxuZXcganN0cy5nZW9tLkNvb3JkaW5hdGUoc25hcFB0KSxmYWxzZSk7fX19O0xpbmVTdHJpbmdTbmFwcGVyLnByb3RvdHlwZS5maW5kU2VnbWVudEluZGV4VG9TbmFwPWZ1bmN0aW9uKHNuYXBQdCxzcmNDb29yZHMpe3ZhciBtaW5EaXN0PU51bWJlci5NQVhfVkFMVUUsc25hcEluZGV4PS0xLGk9MCxkaXN0O2ZvcihpO2k8c3JjQ29vcmRzLnNpemUoKS0xO2krKyl7dGhpcy5zZWcucDA9c3JjQ29vcmRzLmdldChpKTt0aGlzLnNlZy5wMT1zcmNDb29yZHMuZ2V0KGkrMSk7aWYodGhpcy5zZWcucDAuZXF1YWxzKHNuYXBQdCl8fHRoaXMuc2VnLnAxLmVxdWFscyhzbmFwUHQpKXtpZih0aGlzLmFsbG93U25hcHBpbmdUb1NvdXJjZVZlcnRpY2VzKXtjb250aW51ZTt9ZWxzZXtyZXR1cm4tMTt9fVxuZGlzdD10aGlzLnNlZy5kaXN0YW5jZShzbmFwUHQpO2lmKGRpc3Q8dGhpcy5zbmFwVG9sZXJhbmNlJiZkaXN0PG1pbkRpc3Qpe21pbkRpc3Q9ZGlzdDtzbmFwSW5kZXg9aTt9fVxucmV0dXJuIHNuYXBJbmRleDt9O2pzdHMub3BlcmF0aW9uLm92ZXJsYXkuc25hcC5MaW5lU3RyaW5nU25hcHBlcj1MaW5lU3RyaW5nU25hcHBlcjt9KSgpOyhmdW5jdGlvbigpe3ZhciBBcnJheUxpc3Q9amF2YXNjcmlwdC51dGlsLkFycmF5TGlzdDt2YXIgR2VvbWV0cnlDb21wb25lbnRGaWx0ZXI9anN0cy5nZW9tLkdlb21ldHJ5Q29tcG9uZW50RmlsdGVyO3ZhciBMaW5lU3RyaW5nPWpzdHMuZ2VvbS5MaW5lU3RyaW5nO3ZhciBFZGdlUmluZz1qc3RzLm9wZXJhdGlvbi5wb2x5Z29uaXplLkVkZ2VSaW5nO3ZhciBQb2x5Z29uaXplR3JhcGg9anN0cy5vcGVyYXRpb24ucG9seWdvbml6ZS5Qb2x5Z29uaXplR3JhcGg7dmFyIFBvbHlnb25pemVyPWZ1bmN0aW9uKCl7dmFyIHRoYXQ9dGhpczt2YXIgTGluZVN0cmluZ0FkZGVyPWZ1bmN0aW9uKCl7fTtMaW5lU3RyaW5nQWRkZXIucHJvdG90eXBlPW5ldyBHZW9tZXRyeUNvbXBvbmVudEZpbHRlcigpO0xpbmVTdHJpbmdBZGRlci5wcm90b3R5cGUuZmlsdGVyPWZ1bmN0aW9uKGcpe2lmKGcgaW5zdGFuY2VvZiBMaW5lU3RyaW5nKVxudGhhdC5hZGQoZyk7fTt0aGlzLmxpbmVTdHJpbmdBZGRlcj1uZXcgTGluZVN0cmluZ0FkZGVyKCk7dGhpcy5kYW5nbGVzPW5ldyBBcnJheUxpc3QoKTt0aGlzLmN1dEVkZ2VzPW5ldyBBcnJheUxpc3QoKTt0aGlzLmludmFsaWRSaW5nTGluZXM9bmV3IEFycmF5TGlzdCgpO307UG9seWdvbml6ZXIucHJvdG90eXBlLmxpbmVTdHJpbmdBZGRlcj1udWxsO1BvbHlnb25pemVyLnByb3RvdHlwZS5ncmFwaD1udWxsO1BvbHlnb25pemVyLnByb3RvdHlwZS5kYW5nbGVzPW51bGw7UG9seWdvbml6ZXIucHJvdG90eXBlLmN1dEVkZ2VzPW51bGw7UG9seWdvbml6ZXIucHJvdG90eXBlLmludmFsaWRSaW5nTGluZXM9bnVsbDtQb2x5Z29uaXplci5wcm90b3R5cGUuaG9sZUxpc3Q9bnVsbDtQb2x5Z29uaXplci5wcm90b3R5cGUuc2hlbGxMaXN0PW51bGw7UG9seWdvbml6ZXIucHJvdG90eXBlLnBvbHlMaXN0PW51bGw7UG9seWdvbml6ZXIucHJvdG90eXBlLmFkZD1mdW5jdGlvbihnZW9tTGlzdCl7aWYoZ2VvbUxpc3QgaW5zdGFuY2VvZiBqc3RzLmdlb20uTGluZVN0cmluZyl7cmV0dXJuIHRoaXMuYWRkMyhnZW9tTGlzdCk7fWVsc2UgaWYoZ2VvbUxpc3QgaW5zdGFuY2VvZiBqc3RzLmdlb20uR2VvbWV0cnkpe3JldHVybiB0aGlzLmFkZDIoZ2VvbUxpc3QpO31cbmZvcih2YXIgaT1nZW9tTGlzdC5pdGVyYXRvcigpO2kuaGFzTmV4dCgpOyl7dmFyIGdlb21ldHJ5PWkubmV4dCgpO3RoaXMuYWRkMihnZW9tZXRyeSk7fX07UG9seWdvbml6ZXIucHJvdG90eXBlLmFkZDI9ZnVuY3Rpb24oZyl7Zy5hcHBseSh0aGlzLmxpbmVTdHJpbmdBZGRlcik7fTtQb2x5Z29uaXplci5wcm90b3R5cGUuYWRkMz1mdW5jdGlvbihsaW5lKXtpZih0aGlzLmdyYXBoPT1udWxsKVxudGhpcy5ncmFwaD1uZXcgUG9seWdvbml6ZUdyYXBoKGxpbmUuZ2V0RmFjdG9yeSgpKTt0aGlzLmdyYXBoLmFkZEVkZ2UobGluZSk7fTtQb2x5Z29uaXplci5wcm90b3R5cGUuZ2V0UG9seWdvbnM9ZnVuY3Rpb24oKXt0aGlzLnBvbHlnb25pemUoKTtyZXR1cm4gdGhpcy5wb2x5TGlzdDt9O1BvbHlnb25pemVyLnByb3RvdHlwZS5nZXREYW5nbGVzPWZ1bmN0aW9uKCl7dGhpcy5wb2x5Z29uaXplKCk7cmV0dXJuIHRoaXMuZGFuZ2xlczt9O1BvbHlnb25pemVyLnByb3RvdHlwZS5nZXRDdXRFZGdlcz1mdW5jdGlvbigpe3RoaXMucG9seWdvbml6ZSgpO3JldHVybiB0aGlzLmN1dEVkZ2VzO307UG9seWdvbml6ZXIucHJvdG90eXBlLmdldEludmFsaWRSaW5nTGluZXM9ZnVuY3Rpb24oKXt0aGlzLnBvbHlnb25pemUoKTtyZXR1cm4gdGhpcy5pbnZhbGlkUmluZ0xpbmVzO307UG9seWdvbml6ZXIucHJvdG90eXBlLnBvbHlnb25pemU9ZnVuY3Rpb24oKXtpZih0aGlzLnBvbHlMaXN0IT1udWxsKVxucmV0dXJuO3RoaXMucG9seUxpc3Q9bmV3IEFycmF5TGlzdCgpO2lmKHRoaXMuZ3JhcGg9PW51bGwpXG5yZXR1cm47dGhpcy5kYW5nbGVzPXRoaXMuZ3JhcGguZGVsZXRlRGFuZ2xlcygpO3RoaXMuY3V0RWRnZXM9dGhpcy5ncmFwaC5kZWxldGVDdXRFZGdlcygpO3ZhciBlZGdlUmluZ0xpc3Q9dGhpcy5ncmFwaC5nZXRFZGdlUmluZ3MoKTt2YXIgdmFsaWRFZGdlUmluZ0xpc3Q9bmV3IEFycmF5TGlzdCgpO3RoaXMuaW52YWxpZFJpbmdMaW5lcz1uZXcgQXJyYXlMaXN0KCk7dGhpcy5maW5kVmFsaWRSaW5ncyhlZGdlUmluZ0xpc3QsdmFsaWRFZGdlUmluZ0xpc3QsdGhpcy5pbnZhbGlkUmluZ0xpbmVzKTt0aGlzLmZpbmRTaGVsbHNBbmRIb2xlcyh2YWxpZEVkZ2VSaW5nTGlzdCk7UG9seWdvbml6ZXIuYXNzaWduSG9sZXNUb1NoZWxscyh0aGlzLmhvbGVMaXN0LHRoaXMuc2hlbGxMaXN0KTt0aGlzLnBvbHlMaXN0PW5ldyBBcnJheUxpc3QoKTtmb3IodmFyIGk9dGhpcy5zaGVsbExpc3QuaXRlcmF0b3IoKTtpLmhhc05leHQoKTspe3ZhciBlcj1pLm5leHQoKTt0aGlzLnBvbHlMaXN0LmFkZChlci5nZXRQb2x5Z29uKCkpO319O1BvbHlnb25pemVyLnByb3RvdHlwZS5maW5kVmFsaWRSaW5ncz1mdW5jdGlvbihlZGdlUmluZ0xpc3QsdmFsaWRFZGdlUmluZ0xpc3QsaW52YWxpZFJpbmdMaXN0KXtmb3IodmFyIGk9ZWRnZVJpbmdMaXN0Lml0ZXJhdG9yKCk7aS5oYXNOZXh0KCk7KXt2YXIgZXI9aS5uZXh0KCk7aWYoZXIuaXNWYWxpZCgpKVxudmFsaWRFZGdlUmluZ0xpc3QuYWRkKGVyKTtlbHNlXG5pbnZhbGlkUmluZ0xpc3QuYWRkKGVyLmdldExpbmVTdHJpbmcoKSk7fX07UG9seWdvbml6ZXIucHJvdG90eXBlLmZpbmRTaGVsbHNBbmRIb2xlcz1mdW5jdGlvbihlZGdlUmluZ0xpc3Qpe3RoaXMuaG9sZUxpc3Q9bmV3IEFycmF5TGlzdCgpO3RoaXMuc2hlbGxMaXN0PW5ldyBBcnJheUxpc3QoKTtmb3IodmFyIGk9ZWRnZVJpbmdMaXN0Lml0ZXJhdG9yKCk7aS5oYXNOZXh0KCk7KXt2YXIgZXI9aS5uZXh0KCk7aWYoZXIuaXNIb2xlKCkpXG50aGlzLmhvbGVMaXN0LmFkZChlcik7ZWxzZVxudGhpcy5zaGVsbExpc3QuYWRkKGVyKTt9fTtQb2x5Z29uaXplci5hc3NpZ25Ib2xlc1RvU2hlbGxzPWZ1bmN0aW9uKGhvbGVMaXN0LHNoZWxsTGlzdCl7Zm9yKHZhciBpPWhvbGVMaXN0Lml0ZXJhdG9yKCk7aS5oYXNOZXh0KCk7KXt2YXIgaG9sZUVSPWkubmV4dCgpO1BvbHlnb25pemVyLmFzc2lnbkhvbGVUb1NoZWxsKGhvbGVFUixzaGVsbExpc3QpO319O1BvbHlnb25pemVyLmFzc2lnbkhvbGVUb1NoZWxsPWZ1bmN0aW9uKGhvbGVFUixzaGVsbExpc3Qpe3ZhciBzaGVsbD1FZGdlUmluZy5maW5kRWRnZVJpbmdDb250YWluaW5nKGhvbGVFUixzaGVsbExpc3QpO2lmKHNoZWxsIT1udWxsKVxuc2hlbGwuYWRkSG9sZShob2xlRVIuZ2V0UmluZygpKTt9O2pzdHMub3BlcmF0aW9uLnBvbHlnb25pemUuUG9seWdvbml6ZXI9UG9seWdvbml6ZXI7fSkoKTsoZnVuY3Rpb24oKXt2YXIgQXJyYXlMaXN0PWphdmFzY3JpcHQudXRpbC5BcnJheUxpc3Q7dmFyIEdlb21ldHJ5VHJhbnNmb3JtZXI9ZnVuY3Rpb24oKXt9O0dlb21ldHJ5VHJhbnNmb3JtZXIucHJvdG90eXBlLmlucHV0R2VvbT1udWxsO0dlb21ldHJ5VHJhbnNmb3JtZXIucHJvdG90eXBlLmZhY3Rvcnk9bnVsbDtHZW9tZXRyeVRyYW5zZm9ybWVyLnByb3RvdHlwZS5wcnVuZUVtcHR5R2VvbWV0cnk9dHJ1ZTtHZW9tZXRyeVRyYW5zZm9ybWVyLnByb3RvdHlwZS5wcmVzZXJ2ZUdlb21ldHJ5Q29sbGVjdGlvblR5cGU9dHJ1ZTtHZW9tZXRyeVRyYW5zZm9ybWVyLnByb3RvdHlwZS5wcmVzZXJ2ZUNvbGxlY3Rpb25zPWZhbHNlO0dlb21ldHJ5VHJhbnNmb3JtZXIucHJvdG90eXBlLnJlc2VydmVUeXBlPWZhbHNlO0dlb21ldHJ5VHJhbnNmb3JtZXIucHJvdG90eXBlLmdldElucHV0R2VvbWV0cnk9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5pbnB1dEdlb207fTtHZW9tZXRyeVRyYW5zZm9ybWVyLnByb3RvdHlwZS50cmFuc2Zvcm09ZnVuY3Rpb24oaW5wdXRHZW9tKXt0aGlzLmlucHV0R2VvbT1pbnB1dEdlb207dGhpcy5mYWN0b3J5PWlucHV0R2VvbS5nZXRGYWN0b3J5KCk7aWYoaW5wdXRHZW9tIGluc3RhbmNlb2YganN0cy5nZW9tLlBvaW50KVxucmV0dXJuIHRoaXMudHJhbnNmb3JtUG9pbnQoaW5wdXRHZW9tLG51bGwpO2lmKGlucHV0R2VvbSBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5NdWx0aVBvaW50KVxucmV0dXJuIHRoaXMudHJhbnNmb3JtTXVsdGlQb2ludChpbnB1dEdlb20sbnVsbCk7aWYoaW5wdXRHZW9tIGluc3RhbmNlb2YganN0cy5nZW9tLkxpbmVhclJpbmcpXG5yZXR1cm4gdGhpcy50cmFuc2Zvcm1MaW5lYXJSaW5nKGlucHV0R2VvbSxudWxsKTtpZihpbnB1dEdlb20gaW5zdGFuY2VvZiBqc3RzLmdlb20uTGluZVN0cmluZylcbnJldHVybiB0aGlzLnRyYW5zZm9ybUxpbmVTdHJpbmcoaW5wdXRHZW9tLG51bGwpO2lmKGlucHV0R2VvbSBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5NdWx0aUxpbmVTdHJpbmcpXG5yZXR1cm4gdGhpcy50cmFuc2Zvcm1NdWx0aUxpbmVTdHJpbmcoaW5wdXRHZW9tLG51bGwpO2lmKGlucHV0R2VvbSBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5Qb2x5Z29uKVxucmV0dXJuIHRoaXMudHJhbnNmb3JtUG9seWdvbihpbnB1dEdlb20sbnVsbCk7aWYoaW5wdXRHZW9tIGluc3RhbmNlb2YganN0cy5nZW9tLk11bHRpUG9seWdvbilcbnJldHVybiB0aGlzLnRyYW5zZm9ybU11bHRpUG9seWdvbihpbnB1dEdlb20sbnVsbCk7aWYoaW5wdXRHZW9tIGluc3RhbmNlb2YganN0cy5nZW9tLkdlb21ldHJ5Q29sbGVjdGlvbilcbnJldHVybiB0aGlzLnRyYW5zZm9ybUdlb21ldHJ5Q29sbGVjdGlvbihpbnB1dEdlb20sbnVsbCk7dGhyb3cgbmV3IGpzdHMuZXJyb3IuSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uKCdVbmtub3duIEdlb21ldHJ5IHN1YnR5cGU6ICcrXG5pbnB1dEdlb20uZ2V0Q2xhc3MoKS5nZXROYW1lKCkpO307R2VvbWV0cnlUcmFuc2Zvcm1lci5wcm90b3R5cGUuY3JlYXRlQ29vcmRpbmF0ZVNlcXVlbmNlPWZ1bmN0aW9uKGNvb3Jkcyl7cmV0dXJuIHRoaXMuZmFjdG9yeS5nZXRDb29yZGluYXRlU2VxdWVuY2VGYWN0b3J5KCkuY3JlYXRlKGNvb3Jkcyk7fTtHZW9tZXRyeVRyYW5zZm9ybWVyLnByb3RvdHlwZS5jb3B5PWZ1bmN0aW9uKHNlcSl7cmV0dXJuIHNlcS5jbG9uZSgpO307R2VvbWV0cnlUcmFuc2Zvcm1lci5wcm90b3R5cGUudHJhbnNmb3JtQ29vcmRpbmF0ZXM9ZnVuY3Rpb24oY29vcmRzLHBhcmVudCl7cmV0dXJuIHRoaXMuY29weShjb29yZHMpO307R2VvbWV0cnlUcmFuc2Zvcm1lci5wcm90b3R5cGUudHJhbnNmb3JtUG9pbnQ9ZnVuY3Rpb24oZ2VvbSxwYXJlbnQpe3JldHVybiB0aGlzLmZhY3RvcnkuY3JlYXRlUG9pbnQodGhpcy50cmFuc2Zvcm1Db29yZGluYXRlcyhnZW9tLmdldENvb3JkaW5hdGVTZXF1ZW5jZSgpLGdlb20pKTt9O0dlb21ldHJ5VHJhbnNmb3JtZXIucHJvdG90eXBlLnRyYW5zZm9ybU11bHRpUG9pbnQ9ZnVuY3Rpb24oZ2VvbSxwYXJlbnQpe3ZhciB0cmFuc0dlb21MaXN0PW5ldyBBcnJheUxpc3QoKTtmb3IodmFyIGk9MDtpPGdlb20uZ2V0TnVtR2VvbWV0cmllcygpO2krKyl7dmFyIHRyYW5zZm9ybUdlb209dGhpcy50cmFuc2Zvcm1Qb2ludChnZW9tLmdldEdlb21ldHJ5TihpKSxnZW9tKTtpZih0cmFuc2Zvcm1HZW9tPT1udWxsKVxuY29udGludWU7aWYodHJhbnNmb3JtR2VvbS5pc0VtcHR5KCkpXG5jb250aW51ZTt0cmFuc0dlb21MaXN0LmFkZCh0cmFuc2Zvcm1HZW9tKTt9XG5yZXR1cm4gdGhpcy5mYWN0b3J5LmJ1aWxkR2VvbWV0cnkodHJhbnNHZW9tTGlzdCk7fTtHZW9tZXRyeVRyYW5zZm9ybWVyLnByb3RvdHlwZS50cmFuc2Zvcm1MaW5lYXJSaW5nPWZ1bmN0aW9uKGdlb20scGFyZW50KXt2YXIgc2VxPXRoaXMudHJhbnNmb3JtQ29vcmRpbmF0ZXMoZ2VvbS5nZXRDb29yZGluYXRlU2VxdWVuY2UoKSxnZW9tKTt2YXIgc2VxU2l6ZT1zZXEubGVuZ3RoO2lmKHNlcVNpemU+MCYmc2VxU2l6ZTw0JiYhdGhpcy5wcmVzZXJ2ZVR5cGUpXG5yZXR1cm4gdGhpcy5mYWN0b3J5LmNyZWF0ZUxpbmVTdHJpbmcoc2VxKTtyZXR1cm4gdGhpcy5mYWN0b3J5LmNyZWF0ZUxpbmVhclJpbmcoc2VxKTt9O0dlb21ldHJ5VHJhbnNmb3JtZXIucHJvdG90eXBlLnRyYW5zZm9ybUxpbmVTdHJpbmc9ZnVuY3Rpb24oZ2VvbSxwYXJlbnQpe3JldHVybiB0aGlzLmZhY3RvcnkuY3JlYXRlTGluZVN0cmluZyh0aGlzLnRyYW5zZm9ybUNvb3JkaW5hdGVzKGdlb20uZ2V0Q29vcmRpbmF0ZVNlcXVlbmNlKCksZ2VvbSkpO307R2VvbWV0cnlUcmFuc2Zvcm1lci5wcm90b3R5cGUudHJhbnNmb3JtTXVsdGlMaW5lU3RyaW5nPWZ1bmN0aW9uKGdlb20scGFyZW50KXt2YXIgdHJhbnNHZW9tTGlzdD1uZXcgQXJyYXlMaXN0KCk7Zm9yKHZhciBpPTA7aTxnZW9tLmdldE51bUdlb21ldHJpZXMoKTtpKyspe3ZhciB0cmFuc2Zvcm1HZW9tPXRoaXMudHJhbnNmb3JtTGluZVN0cmluZyhnZW9tLmdldEdlb21ldHJ5TihpKSxnZW9tKTtpZih0cmFuc2Zvcm1HZW9tPT1udWxsKVxuY29udGludWU7aWYodHJhbnNmb3JtR2VvbS5pc0VtcHR5KCkpXG5jb250aW51ZTt0cmFuc0dlb21MaXN0LmFkZCh0cmFuc2Zvcm1HZW9tKTt9XG5yZXR1cm4gdGhpcy5mYWN0b3J5LmJ1aWxkR2VvbWV0cnkodHJhbnNHZW9tTGlzdCk7fTtHZW9tZXRyeVRyYW5zZm9ybWVyLnByb3RvdHlwZS50cmFuc2Zvcm1Qb2x5Z29uPWZ1bmN0aW9uKGdlb20scGFyZW50KXt2YXIgaXNBbGxWYWxpZExpbmVhclJpbmdzPXRydWU7dmFyIHNoZWxsPXRoaXMudHJhbnNmb3JtTGluZWFyUmluZyhnZW9tLmdldEV4dGVyaW9yUmluZygpLGdlb20pO2lmKHNoZWxsPT1udWxsfHwhKHNoZWxsIGluc3RhbmNlb2YganN0cy5nZW9tLkxpbmVhclJpbmcpfHxzaGVsbC5pc0VtcHR5KCkpXG5pc0FsbFZhbGlkTGluZWFyUmluZ3M9ZmFsc2U7dmFyIGhvbGVzPW5ldyBBcnJheUxpc3QoKTtmb3IodmFyIGk9MDtpPGdlb20uZ2V0TnVtSW50ZXJpb3JSaW5nKCk7aSsrKXt2YXIgaG9sZT10aGlzLnRyYW5zZm9ybUxpbmVhclJpbmcoZ2VvbS5nZXRJbnRlcmlvclJpbmdOKGkpLGdlb20pO2lmKGhvbGU9PW51bGx8fGhvbGUuaXNFbXB0eSgpKXtjb250aW51ZTt9XG5pZighKGhvbGUgaW5zdGFuY2VvZiBqc3RzLmdlb20uTGluZWFyUmluZykpXG5pc0FsbFZhbGlkTGluZWFyUmluZ3M9ZmFsc2U7aG9sZXMuYWRkKGhvbGUpO31cbmlmKGlzQWxsVmFsaWRMaW5lYXJSaW5ncylcbnJldHVybiB0aGlzLmZhY3RvcnkuY3JlYXRlUG9seWdvbihzaGVsbCxob2xlcy50b0FycmF5KCkpO2Vsc2V7dmFyIGNvbXBvbmVudHM9bmV3IEFycmF5TGlzdCgpO2lmKHNoZWxsIT1udWxsKVxuY29tcG9uZW50cy5hZGQoc2hlbGwpO2NvbXBvbmVudHMuYWRkQWxsKGhvbGVzKTtyZXR1cm4gdGhpcy5mYWN0b3J5LmJ1aWxkR2VvbWV0cnkoY29tcG9uZW50cyk7fX07R2VvbWV0cnlUcmFuc2Zvcm1lci5wcm90b3R5cGUudHJhbnNmb3JtTXVsdGlQb2x5Z29uPWZ1bmN0aW9uKGdlb20scGFyZW50KXt2YXIgdHJhbnNHZW9tTGlzdD1uZXcgQXJyYXlMaXN0KCk7Zm9yKHZhciBpPTA7aTxnZW9tLmdldE51bUdlb21ldHJpZXMoKTtpKyspe3ZhciB0cmFuc2Zvcm1HZW9tPXRoaXMudHJhbnNmb3JtUG9seWdvbihnZW9tLmdldEdlb21ldHJ5TihpKSxnZW9tKTtpZih0cmFuc2Zvcm1HZW9tPT1udWxsKVxuY29udGludWU7aWYodHJhbnNmb3JtR2VvbS5pc0VtcHR5KCkpXG5jb250aW51ZTt0cmFuc0dlb21MaXN0LmFkZCh0cmFuc2Zvcm1HZW9tKTt9XG5yZXR1cm4gdGhpcy5mYWN0b3J5LmJ1aWxkR2VvbWV0cnkodHJhbnNHZW9tTGlzdCk7fTtHZW9tZXRyeVRyYW5zZm9ybWVyLnByb3RvdHlwZS50cmFuc2Zvcm1HZW9tZXRyeUNvbGxlY3Rpb249ZnVuY3Rpb24oZ2VvbSxwYXJlbnQpe3ZhciB0cmFuc0dlb21MaXN0PW5ldyBBcnJheUxpc3QoKTtmb3IodmFyIGk9MDtpPGdlb20uZ2V0TnVtR2VvbWV0cmllcygpO2krKyl7dmFyIHRyYW5zZm9ybUdlb209dGhpcy50cmFuc2Zvcm0oZ2VvbS5nZXRHZW9tZXRyeU4oaSkpO2lmKHRyYW5zZm9ybUdlb209PW51bGwpXG5jb250aW51ZTtpZih0aGlzLnBydW5lRW1wdHlHZW9tZXRyeSYmdHJhbnNmb3JtR2VvbS5pc0VtcHR5KCkpXG5jb250aW51ZTt0cmFuc0dlb21MaXN0LmFkZCh0cmFuc2Zvcm1HZW9tKTt9XG5pZih0aGlzLnByZXNlcnZlR2VvbWV0cnlDb2xsZWN0aW9uVHlwZSlcbnJldHVybiB0aGlzLmZhY3RvcnkuY3JlYXRlR2VvbWV0cnlDb2xsZWN0aW9uKEdlb21ldHJ5RmFjdG9yeS50b0dlb21ldHJ5QXJyYXkodHJhbnNHZW9tTGlzdCkpO3JldHVybiB0aGlzLmZhY3RvcnkuYnVpbGRHZW9tZXRyeSh0cmFuc0dlb21MaXN0KTt9O2pzdHMuZ2VvbS51dGlsLkdlb21ldHJ5VHJhbnNmb3JtZXI9R2VvbWV0cnlUcmFuc2Zvcm1lcjt9KSgpOyhmdW5jdGlvbigpe3ZhciBMaW5lU3RyaW5nU25hcHBlcj1qc3RzLm9wZXJhdGlvbi5vdmVybGF5LnNuYXAuTGluZVN0cmluZ1NuYXBwZXI7dmFyIFByZWNpc2lvbk1vZGVsPWpzdHMuZ2VvbS5QcmVjaXNpb25Nb2RlbDt2YXIgVHJlZVNldD1qYXZhc2NyaXB0LnV0aWwuVHJlZVNldDt2YXIgU25hcFRyYW5zZm9ybWVyPWZ1bmN0aW9uKHNuYXBUb2xlcmFuY2Usc25hcFB0cyxpc1NlbGZTbmFwKXt0aGlzLnNuYXBUb2xlcmFuY2U9c25hcFRvbGVyYW5jZTt0aGlzLnNuYXBQdHM9c25hcFB0czt0aGlzLmlzU2VsZlNuYXA9aXNTZWxmU25hcHx8ZmFsc2U7fTtTbmFwVHJhbnNmb3JtZXIucHJvdG90eXBlPW5ldyBqc3RzLmdlb20udXRpbC5HZW9tZXRyeVRyYW5zZm9ybWVyKCk7U25hcFRyYW5zZm9ybWVyLnByb3RvdHlwZS5zbmFwVG9sZXJhbmNlPW51bGw7U25hcFRyYW5zZm9ybWVyLnByb3RvdHlwZS5zbmFwUHRzPW51bGw7U25hcFRyYW5zZm9ybWVyLnByb3RvdHlwZS5pc1NlbGZTbmFwPWZhbHNlO1NuYXBUcmFuc2Zvcm1lci5wcm90b3R5cGUudHJhbnNmb3JtQ29vcmRpbmF0ZXM9ZnVuY3Rpb24oY29vcmRzLHBhcmVudCl7dmFyIHNyY1B0cz1jb29yZHM7dmFyIG5ld1B0cz10aGlzLnNuYXBMaW5lKHNyY1B0cyx0aGlzLnNuYXBQdHMpO3JldHVybiBuZXdQdHM7fTtTbmFwVHJhbnNmb3JtZXIucHJvdG90eXBlLnNuYXBMaW5lPWZ1bmN0aW9uKHNyY1B0cyxzbmFwUHRzKXt2YXIgc25hcHBlcj1uZXcgTGluZVN0cmluZ1NuYXBwZXIoc3JjUHRzLHRoaXMuc25hcFRvbGVyYW5jZSk7c25hcHBlci5zZXRBbGxvd1NuYXBwaW5nVG9Tb3VyY2VWZXJ0aWNlcyh0aGlzLmlzU2VsZlNuYXApO3JldHVybiBzbmFwcGVyLnNuYXBUbyhzbmFwUHRzKTt9O3ZhciBHZW9tZXRyeVNuYXBwZXI9ZnVuY3Rpb24oc3JjR2VvbSl7dGhpcy5zcmNHZW9tPXNyY0dlb207fTtHZW9tZXRyeVNuYXBwZXIuU05BUF9QUkVDSVNJT05fRkFDVE9SPTFlLTk7R2VvbWV0cnlTbmFwcGVyLmNvbXB1dGVPdmVybGF5U25hcFRvbGVyYW5jZT1mdW5jdGlvbihnKXtpZihhcmd1bWVudHMubGVuZ3RoPT09Mil7cmV0dXJuIEdlb21ldHJ5U25hcHBlci5jb21wdXRlT3ZlcmxheVNuYXBUb2xlcmFuY2UyLmFwcGx5KHRoaXMsYXJndW1lbnRzKTt9XG52YXIgc25hcFRvbGVyYW5jZT10aGlzLmNvbXB1dGVTaXplQmFzZWRTbmFwVG9sZXJhbmNlKGcpO3ZhciBwbT1nLmdldFByZWNpc2lvbk1vZGVsKCk7aWYocG0uZ2V0VHlwZSgpPT1QcmVjaXNpb25Nb2RlbC5GSVhFRCl7dmFyIGZpeGVkU25hcFRvbD0oMS9wbS5nZXRTY2FsZSgpKSoyLzEuNDE1O2lmKGZpeGVkU25hcFRvbD5zbmFwVG9sZXJhbmNlKVxuc25hcFRvbGVyYW5jZT1maXhlZFNuYXBUb2w7fVxucmV0dXJuIHNuYXBUb2xlcmFuY2U7fTtHZW9tZXRyeVNuYXBwZXIuY29tcHV0ZVNpemVCYXNlZFNuYXBUb2xlcmFuY2U9ZnVuY3Rpb24oZyl7dmFyIGVudj1nLmdldEVudmVsb3BlSW50ZXJuYWwoKTt2YXIgbWluRGltZW5zaW9uPU1hdGgubWluKGVudi5nZXRIZWlnaHQoKSxlbnYuZ2V0V2lkdGgoKSk7dmFyIHNuYXBUb2w9bWluRGltZW5zaW9uKkdlb21ldHJ5U25hcHBlci5TTkFQX1BSRUNJU0lPTl9GQUNUT1I7cmV0dXJuIHNuYXBUb2w7fTtHZW9tZXRyeVNuYXBwZXIuY29tcHV0ZU92ZXJsYXlTbmFwVG9sZXJhbmNlMj1mdW5jdGlvbihnMCxnMSl7cmV0dXJuIE1hdGgubWluKHRoaXMuY29tcHV0ZU92ZXJsYXlTbmFwVG9sZXJhbmNlKGcwKSx0aGlzLmNvbXB1dGVPdmVybGF5U25hcFRvbGVyYW5jZShnMSkpO307R2VvbWV0cnlTbmFwcGVyLnNuYXA9ZnVuY3Rpb24oZzAsZzEsc25hcFRvbGVyYW5jZSl7dmFyIHNuYXBHZW9tPVtdO3ZhciBzbmFwcGVyMD1uZXcgR2VvbWV0cnlTbmFwcGVyKGcwKTtzbmFwR2VvbVswXT1zbmFwcGVyMC5zbmFwVG8oZzEsc25hcFRvbGVyYW5jZSk7dmFyIHNuYXBwZXIxPW5ldyBHZW9tZXRyeVNuYXBwZXIoZzEpO3NuYXBHZW9tWzFdPXNuYXBwZXIxLnNuYXBUbyhzbmFwR2VvbVswXSxzbmFwVG9sZXJhbmNlKTtyZXR1cm4gc25hcEdlb207fTtHZW9tZXRyeVNuYXBwZXIuc25hcFRvU2VsZj1mdW5jdGlvbihnMCxzbmFwVG9sZXJhbmNlLGNsZWFuUmVzdWx0KXt2YXIgc25hcHBlcjA9bmV3IEdlb21ldHJ5U25hcHBlcihnMCk7cmV0dXJuIHNuYXBwZXIwLnNuYXBUb1NlbGYoc25hcFRvbGVyYW5jZSxjbGVhblJlc3VsdCk7fTtHZW9tZXRyeVNuYXBwZXIucHJvdG90eXBlLnNyY0dlb209bnVsbDtHZW9tZXRyeVNuYXBwZXIucHJvdG90eXBlLnNuYXBUbz1mdW5jdGlvbihzbmFwR2VvbSxzbmFwVG9sZXJhbmNlKXt2YXIgc25hcFB0cz10aGlzLmV4dHJhY3RUYXJnZXRDb29yZGluYXRlcyhzbmFwR2VvbSk7dmFyIHNuYXBUcmFucz1uZXcgU25hcFRyYW5zZm9ybWVyKHNuYXBUb2xlcmFuY2Usc25hcFB0cyk7cmV0dXJuIHNuYXBUcmFucy50cmFuc2Zvcm0odGhpcy5zcmNHZW9tKTt9O0dlb21ldHJ5U25hcHBlci5wcm90b3R5cGUuc25hcFRvU2VsZj1mdW5jdGlvbihzbmFwVG9sZXJhbmNlLGNsZWFuUmVzdWx0KXt2YXIgc25hcFB0cz10aGlzLmV4dHJhY3RUYXJnZXRDb29yZGluYXRlcyhzcmNHZW9tKTt2YXIgc25hcFRyYW5zPW5ldyBTbmFwVHJhbnNmb3JtZXIoc25hcFRvbGVyYW5jZSxzbmFwUHRzLHRydWUpO3ZhciBzbmFwcGVkR2VvbT1zbmFwVHJhbnMudHJhbnNmb3JtKHNyY0dlb20pO3ZhciByZXN1bHQ9c25hcHBlZEdlb207aWYoY2xlYW5SZXN1bHQmJnJlc3VsdCBpbnN0YW5jZW9mIFBvbHlnb25hbCl7cmVzdWx0PXNuYXBwZWRHZW9tLmJ1ZmZlcigwKTt9XG5yZXR1cm4gcmVzdWx0O307R2VvbWV0cnlTbmFwcGVyLnByb3RvdHlwZS5leHRyYWN0VGFyZ2V0Q29vcmRpbmF0ZXM9ZnVuY3Rpb24oZyl7dmFyIHB0U2V0PW5ldyBUcmVlU2V0KCk7dmFyIHB0cz1nLmdldENvb3JkaW5hdGVzKCk7Zm9yKHZhciBpPTA7aTxwdHMubGVuZ3RoO2krKyl7cHRTZXQuYWRkKHB0c1tpXSk7fVxucmV0dXJuIHB0U2V0LnRvQXJyYXkoKTt9O0dlb21ldHJ5U25hcHBlci5wcm90b3R5cGUuY29tcHV0ZVNuYXBUb2xlcmFuY2U9ZnVuY3Rpb24ocmluZ1B0cyl7dmFyIG1pblNlZ0xlbj10aGlzLmNvbXB1dGVNaW5pbXVtU2VnbWVudExlbmd0aChyaW5nUHRzKTt2YXIgc25hcFRvbD1taW5TZWdMZW4vMTA7cmV0dXJuIHNuYXBUb2w7fTtHZW9tZXRyeVNuYXBwZXIucHJvdG90eXBlLmNvbXB1dGVNaW5pbXVtU2VnbWVudExlbmd0aD1mdW5jdGlvbihwdHMpe3ZhciBtaW5TZWdMZW49TnVtYmVyLk1BWF9WQUxVRTtmb3IodmFyIGk9MDtpPHB0cy5sZW5ndGgtMTtpKyspe3ZhciBzZWdMZW49cHRzW2ldLmRpc3RhbmNlKHB0c1tpKzFdKTtpZihzZWdMZW48bWluU2VnTGVuKVxubWluU2VnTGVuPXNlZ0xlbjt9XG5yZXR1cm4gbWluU2VnTGVuO307anN0cy5vcGVyYXRpb24ub3ZlcmxheS5zbmFwLkdlb21ldHJ5U25hcHBlcj1HZW9tZXRyeVNuYXBwZXI7fSkoKTtqc3RzLmFsZ29yaXRobS5Qb2ludExvY2F0b3I9ZnVuY3Rpb24oYm91bmRhcnlSdWxlKXt0aGlzLmJvdW5kYXJ5UnVsZT1ib3VuZGFyeVJ1bGU/Ym91bmRhcnlSdWxlOmpzdHMuYWxnb3JpdGhtLkJvdW5kYXJ5Tm9kZVJ1bGUuT0dDX1NGU19CT1VOREFSWV9SVUxFO307anN0cy5hbGdvcml0aG0uUG9pbnRMb2NhdG9yLnByb3RvdHlwZS5ib3VuZGFyeVJ1bGU9bnVsbDtqc3RzLmFsZ29yaXRobS5Qb2ludExvY2F0b3IucHJvdG90eXBlLmlzSW49bnVsbDtqc3RzLmFsZ29yaXRobS5Qb2ludExvY2F0b3IucHJvdG90eXBlLm51bUJvdW5kYXJpZXM9bnVsbDtqc3RzLmFsZ29yaXRobS5Qb2ludExvY2F0b3IucHJvdG90eXBlLmludGVyc2VjdHM9ZnVuY3Rpb24ocCxnZW9tKXtyZXR1cm4gdGhpcy5sb2NhdGUocCxnZW9tKSE9PWpzdHMuZ2VvbS5Mb2NhdGlvbi5FWFRFUklPUjt9O2pzdHMuYWxnb3JpdGhtLlBvaW50TG9jYXRvci5wcm90b3R5cGUubG9jYXRlPWZ1bmN0aW9uKHAsZ2VvbSl7aWYoZ2VvbS5pc0VtcHR5KCkpXG5yZXR1cm4ganN0cy5nZW9tLkxvY2F0aW9uLkVYVEVSSU9SO2lmKGdlb20gaW5zdGFuY2VvZiBqc3RzLmdlb20uUG9pbnQpe3JldHVybiB0aGlzLmxvY2F0ZTIocCxnZW9tKTt9ZWxzZSBpZihnZW9tIGluc3RhbmNlb2YganN0cy5nZW9tLkxpbmVTdHJpbmcpe3JldHVybiB0aGlzLmxvY2F0ZTMocCxnZW9tKTt9ZWxzZSBpZihnZW9tIGluc3RhbmNlb2YganN0cy5nZW9tLlBvbHlnb24pe3JldHVybiB0aGlzLmxvY2F0ZTQocCxnZW9tKTt9XG50aGlzLmlzSW49ZmFsc2U7dGhpcy5udW1Cb3VuZGFyaWVzPTA7dGhpcy5jb21wdXRlTG9jYXRpb24ocCxnZW9tKTtpZih0aGlzLmJvdW5kYXJ5UnVsZS5pc0luQm91bmRhcnkodGhpcy5udW1Cb3VuZGFyaWVzKSlcbnJldHVybiBqc3RzLmdlb20uTG9jYXRpb24uQk9VTkRBUlk7aWYodGhpcy5udW1Cb3VuZGFyaWVzPjB8fHRoaXMuaXNJbilcbnJldHVybiBqc3RzLmdlb20uTG9jYXRpb24uSU5URVJJT1I7cmV0dXJuIGpzdHMuZ2VvbS5Mb2NhdGlvbi5FWFRFUklPUjt9O2pzdHMuYWxnb3JpdGhtLlBvaW50TG9jYXRvci5wcm90b3R5cGUuY29tcHV0ZUxvY2F0aW9uPWZ1bmN0aW9uKHAsZ2VvbSl7aWYoZ2VvbSBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5Qb2ludHx8Z2VvbSBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5MaW5lU3RyaW5nfHxnZW9tIGluc3RhbmNlb2YganN0cy5nZW9tLlBvbHlnb24pe3RoaXMudXBkYXRlTG9jYXRpb25JbmZvKHRoaXMubG9jYXRlKHAsZ2VvbSkpO31lbHNlIGlmKGdlb20gaW5zdGFuY2VvZiBqc3RzLmdlb20uTXVsdGlMaW5lU3RyaW5nKXt2YXIgbWw9Z2VvbTtmb3IodmFyIGk9MDtpPG1sLmdldE51bUdlb21ldHJpZXMoKTtpKyspe3ZhciBsPW1sLmdldEdlb21ldHJ5TihpKTt0aGlzLnVwZGF0ZUxvY2F0aW9uSW5mbyh0aGlzLmxvY2F0ZShwLGwpKTt9fWVsc2UgaWYoZ2VvbSBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5NdWx0aVBvbHlnb24pe3ZhciBtcG9seT1nZW9tO2Zvcih2YXIgaT0wO2k8bXBvbHkuZ2V0TnVtR2VvbWV0cmllcygpO2krKyl7dmFyIHBvbHk9bXBvbHkuZ2V0R2VvbWV0cnlOKGkpO3RoaXMudXBkYXRlTG9jYXRpb25JbmZvKHRoaXMubG9jYXRlKHAscG9seSkpO319ZWxzZSBpZihnZW9tIGluc3RhbmNlb2YganN0cy5nZW9tLk11bHRpUG9pbnR8fGdlb20gaW5zdGFuY2VvZiBqc3RzLmdlb20uR2VvbWV0cnlDb2xsZWN0aW9uKXtmb3IodmFyIGk9MDtpPGdlb20uZ2V0TnVtR2VvbWV0cmllcygpO2krKyl7dmFyIHBhcnQ9Z2VvbS5nZXRHZW9tZXRyeU4oaSk7aWYocGFydCE9PWdlb20pe3RoaXMuY29tcHV0ZUxvY2F0aW9uKHAscGFydCk7fX19fTtqc3RzLmFsZ29yaXRobS5Qb2ludExvY2F0b3IucHJvdG90eXBlLnVwZGF0ZUxvY2F0aW9uSW5mbz1mdW5jdGlvbihsb2Mpe2lmKGxvYz09PWpzdHMuZ2VvbS5Mb2NhdGlvbi5JTlRFUklPUilcbnRoaXMuaXNJbj10cnVlO2lmKGxvYz09PWpzdHMuZ2VvbS5Mb2NhdGlvbi5CT1VOREFSWSlcbnRoaXMubnVtQm91bmRhcmllcysrO307anN0cy5hbGdvcml0aG0uUG9pbnRMb2NhdG9yLnByb3RvdHlwZS5sb2NhdGUyPWZ1bmN0aW9uKHAscHQpe3ZhciBwdENvb3JkPXB0LmdldENvb3JkaW5hdGUoKTtpZihwdENvb3JkLmVxdWFsczJEKHApKVxucmV0dXJuIGpzdHMuZ2VvbS5Mb2NhdGlvbi5JTlRFUklPUjtyZXR1cm4ganN0cy5nZW9tLkxvY2F0aW9uLkVYVEVSSU9SO307anN0cy5hbGdvcml0aG0uUG9pbnRMb2NhdG9yLnByb3RvdHlwZS5sb2NhdGUzPWZ1bmN0aW9uKHAsbCl7aWYoIWwuZ2V0RW52ZWxvcGVJbnRlcm5hbCgpLmludGVyc2VjdHMocCkpXG5yZXR1cm4ganN0cy5nZW9tLkxvY2F0aW9uLkVYVEVSSU9SO3ZhciBwdD1sLmdldENvb3JkaW5hdGVzKCk7aWYoIWwuaXNDbG9zZWQoKSl7aWYocC5lcXVhbHMocHRbMF0pfHxwLmVxdWFscyhwdFtwdC5sZW5ndGgtMV0pKXtyZXR1cm4ganN0cy5nZW9tLkxvY2F0aW9uLkJPVU5EQVJZO319XG5pZihqc3RzLmFsZ29yaXRobS5DR0FsZ29yaXRobXMuaXNPbkxpbmUocCxwdCkpXG5yZXR1cm4ganN0cy5nZW9tLkxvY2F0aW9uLklOVEVSSU9SO3JldHVybiBqc3RzLmdlb20uTG9jYXRpb24uRVhURVJJT1I7fTtqc3RzLmFsZ29yaXRobS5Qb2ludExvY2F0b3IucHJvdG90eXBlLmxvY2F0ZUluUG9seWdvblJpbmc9ZnVuY3Rpb24ocCxyaW5nKXtpZighcmluZy5nZXRFbnZlbG9wZUludGVybmFsKCkuaW50ZXJzZWN0cyhwKSlcbnJldHVybiBqc3RzLmdlb20uTG9jYXRpb24uRVhURVJJT1I7cmV0dXJuIGpzdHMuYWxnb3JpdGhtLkNHQWxnb3JpdGhtcy5sb2NhdGVQb2ludEluUmluZyhwLHJpbmcuZ2V0Q29vcmRpbmF0ZXMoKSk7fTtqc3RzLmFsZ29yaXRobS5Qb2ludExvY2F0b3IucHJvdG90eXBlLmxvY2F0ZTQ9ZnVuY3Rpb24ocCxwb2x5KXtpZihwb2x5LmlzRW1wdHkoKSlcbnJldHVybiBqc3RzLmdlb20uTG9jYXRpb24uRVhURVJJT1I7dmFyIHNoZWxsPXBvbHkuZ2V0RXh0ZXJpb3JSaW5nKCk7dmFyIHNoZWxsTG9jPXRoaXMubG9jYXRlSW5Qb2x5Z29uUmluZyhwLHNoZWxsKTtpZihzaGVsbExvYz09PWpzdHMuZ2VvbS5Mb2NhdGlvbi5FWFRFUklPUilcbnJldHVybiBqc3RzLmdlb20uTG9jYXRpb24uRVhURVJJT1I7aWYoc2hlbGxMb2M9PT1qc3RzLmdlb20uTG9jYXRpb24uQk9VTkRBUlkpXG5yZXR1cm4ganN0cy5nZW9tLkxvY2F0aW9uLkJPVU5EQVJZO2Zvcih2YXIgaT0wO2k8cG9seS5nZXROdW1JbnRlcmlvclJpbmcoKTtpKyspe3ZhciBob2xlPXBvbHkuZ2V0SW50ZXJpb3JSaW5nTihpKTt2YXIgaG9sZUxvYz10aGlzLmxvY2F0ZUluUG9seWdvblJpbmcocCxob2xlKTtpZihob2xlTG9jPT09anN0cy5nZW9tLkxvY2F0aW9uLklOVEVSSU9SKVxucmV0dXJuIGpzdHMuZ2VvbS5Mb2NhdGlvbi5FWFRFUklPUjtpZihob2xlTG9jPT09anN0cy5nZW9tLkxvY2F0aW9uLkJPVU5EQVJZKVxucmV0dXJuIGpzdHMuZ2VvbS5Mb2NhdGlvbi5CT1VOREFSWTt9XG5yZXR1cm4ganN0cy5nZW9tLkxvY2F0aW9uLklOVEVSSU9SO307KGZ1bmN0aW9uKCl7dmFyIExvY2F0aW9uPWpzdHMuZ2VvbS5Mb2NhdGlvbjt2YXIgQXJyYXlMaXN0PWphdmFzY3JpcHQudXRpbC5BcnJheUxpc3Q7dmFyIFRyZWVNYXA9amF2YXNjcmlwdC51dGlsLlRyZWVNYXA7anN0cy5nZW9tZ3JhcGguTm9kZU1hcD1mdW5jdGlvbihub2RlRmFjdG9yeSl7dGhpcy5ub2RlTWFwPW5ldyBUcmVlTWFwKCk7dGhpcy5ub2RlRmFjdD1ub2RlRmFjdG9yeTt9O2pzdHMuZ2VvbWdyYXBoLk5vZGVNYXAucHJvdG90eXBlLm5vZGVNYXA9bnVsbDtqc3RzLmdlb21ncmFwaC5Ob2RlTWFwLnByb3RvdHlwZS5ub2RlRmFjdD1udWxsO2pzdHMuZ2VvbWdyYXBoLk5vZGVNYXAucHJvdG90eXBlLmFkZE5vZGU9ZnVuY3Rpb24oYXJnKXt2YXIgbm9kZSxjb29yZDtpZihhcmcgaW5zdGFuY2VvZiBqc3RzLmdlb20uQ29vcmRpbmF0ZSl7Y29vcmQ9YXJnO25vZGU9dGhpcy5ub2RlTWFwLmdldChjb29yZCk7aWYobm9kZT09PW51bGwpe25vZGU9dGhpcy5ub2RlRmFjdC5jcmVhdGVOb2RlKGNvb3JkKTt0aGlzLm5vZGVNYXAucHV0KGNvb3JkLG5vZGUpO31cbnJldHVybiBub2RlO31lbHNlIGlmKGFyZyBpbnN0YW5jZW9mIGpzdHMuZ2VvbWdyYXBoLk5vZGUpe3ZhciBuPWFyZztjb29yZD1uLmdldENvb3JkaW5hdGUoKTtub2RlPXRoaXMubm9kZU1hcC5nZXQoY29vcmQpO2lmKG5vZGU9PT1udWxsKXt0aGlzLm5vZGVNYXAucHV0KGNvb3JkLG4pO3JldHVybiBuO31cbm5vZGUubWVyZ2VMYWJlbChuKTtyZXR1cm4gbm9kZTt9fTtqc3RzLmdlb21ncmFwaC5Ob2RlTWFwLnByb3RvdHlwZS5hZGQ9ZnVuY3Rpb24oZSl7dmFyIHA9ZS5nZXRDb29yZGluYXRlKCk7dmFyIG49dGhpcy5hZGROb2RlKHApO24uYWRkKGUpO307anN0cy5nZW9tZ3JhcGguTm9kZU1hcC5wcm90b3R5cGUuZmluZD1mdW5jdGlvbihjb29yZCl7cmV0dXJuIHRoaXMubm9kZU1hcC5nZXQoY29vcmQpO307anN0cy5nZW9tZ3JhcGguTm9kZU1hcC5wcm90b3R5cGUudmFsdWVzPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMubm9kZU1hcC52YWx1ZXMoKTt9O2pzdHMuZ2VvbWdyYXBoLk5vZGVNYXAucHJvdG90eXBlLml0ZXJhdG9yPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMudmFsdWVzKCkuaXRlcmF0b3IoKTt9O2pzdHMuZ2VvbWdyYXBoLk5vZGVNYXAucHJvdG90eXBlLmdldEJvdW5kYXJ5Tm9kZXM9ZnVuY3Rpb24oZ2VvbUluZGV4KXt2YXIgYmR5Tm9kZXM9bmV3IEFycmF5TGlzdCgpO2Zvcih2YXIgaT10aGlzLml0ZXJhdG9yKCk7aS5oYXNOZXh0KCk7KXt2YXIgbm9kZT1pLm5leHQoKTtpZihub2RlLmdldExhYmVsKCkuZ2V0TG9jYXRpb24oZ2VvbUluZGV4KT09PUxvY2F0aW9uLkJPVU5EQVJZKXtiZHlOb2Rlcy5hZGQobm9kZSk7fX1cbnJldHVybiBiZHlOb2Rlczt9O30pKCk7KGZ1bmN0aW9uKCl7dmFyIEFycmF5TGlzdD1qYXZhc2NyaXB0LnV0aWwuQXJyYXlMaXN0O2pzdHMuZ2VvbWdyYXBoLlBsYW5hckdyYXBoPWZ1bmN0aW9uKG5vZGVGYWN0b3J5KXt0aGlzLmVkZ2VzPW5ldyBBcnJheUxpc3QoKTt0aGlzLmVkZ2VFbmRMaXN0PW5ldyBBcnJheUxpc3QoKTt0aGlzLm5vZGVzPW5ldyBqc3RzLmdlb21ncmFwaC5Ob2RlTWFwKG5vZGVGYWN0b3J5fHxuZXcganN0cy5nZW9tZ3JhcGguTm9kZUZhY3RvcnkoKSk7fTtqc3RzLmdlb21ncmFwaC5QbGFuYXJHcmFwaC5wcm90b3R5cGUuZWRnZXM9bnVsbDtqc3RzLmdlb21ncmFwaC5QbGFuYXJHcmFwaC5wcm90b3R5cGUubm9kZXM9bnVsbDtqc3RzLmdlb21ncmFwaC5QbGFuYXJHcmFwaC5wcm90b3R5cGUuZWRnZUVuZExpc3Q9bnVsbDtqc3RzLmdlb21ncmFwaC5QbGFuYXJHcmFwaC5saW5rUmVzdWx0RGlyZWN0ZWRFZGdlcz1mdW5jdGlvbihub2Rlcyl7Zm9yKHZhciBub2RlaXQ9bm9kZXMuaXRlcmF0b3IoKTtub2RlaXQuaGFzTmV4dCgpOyl7dmFyIG5vZGU9bm9kZWl0Lm5leHQoKTtub2RlLmdldEVkZ2VzKCkubGlua1Jlc3VsdERpcmVjdGVkRWRnZXMoKTt9fTtqc3RzLmdlb21ncmFwaC5QbGFuYXJHcmFwaC5wcm90b3R5cGUuZ2V0RWRnZUl0ZXJhdG9yPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZWRnZXMuaXRlcmF0b3IoKTt9O2pzdHMuZ2VvbWdyYXBoLlBsYW5hckdyYXBoLnByb3RvdHlwZS5nZXRFZGdlRW5kcz1mdW5jdGlvbigpe3JldHVybiB0aGlzLmVkZ2VFbmRMaXN0O307anN0cy5nZW9tZ3JhcGguUGxhbmFyR3JhcGgucHJvdG90eXBlLmlzQm91bmRhcnlOb2RlPWZ1bmN0aW9uKGdlb21JbmRleCxjb29yZCl7dmFyIG5vZGU9dGhpcy5ub2Rlcy5maW5kKGNvb3JkKTtpZihub2RlPT09bnVsbClcbnJldHVybiBmYWxzZTt2YXIgbGFiZWw9bm9kZS5nZXRMYWJlbCgpO2lmKGxhYmVsIT09bnVsbCYmbGFiZWwuZ2V0TG9jYXRpb24oZ2VvbUluZGV4KT09PWpzdHMuZ2VvbS5Mb2NhdGlvbi5CT1VOREFSWSlcbnJldHVybiB0cnVlO3JldHVybiBmYWxzZTt9O2pzdHMuZ2VvbWdyYXBoLlBsYW5hckdyYXBoLnByb3RvdHlwZS5pbnNlcnRFZGdlPWZ1bmN0aW9uKGUpe3RoaXMuZWRnZXMuYWRkKGUpO307anN0cy5nZW9tZ3JhcGguUGxhbmFyR3JhcGgucHJvdG90eXBlLmFkZD1mdW5jdGlvbihlKXt0aGlzLm5vZGVzLmFkZChlKTt0aGlzLmVkZ2VFbmRMaXN0LmFkZChlKTt9O2pzdHMuZ2VvbWdyYXBoLlBsYW5hckdyYXBoLnByb3RvdHlwZS5nZXROb2RlSXRlcmF0b3I9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5ub2Rlcy5pdGVyYXRvcigpO307anN0cy5nZW9tZ3JhcGguUGxhbmFyR3JhcGgucHJvdG90eXBlLmdldE5vZGVzPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMubm9kZXMudmFsdWVzKCk7fTtqc3RzLmdlb21ncmFwaC5QbGFuYXJHcmFwaC5wcm90b3R5cGUuYWRkTm9kZT1mdW5jdGlvbihub2RlKXtyZXR1cm4gdGhpcy5ub2Rlcy5hZGROb2RlKG5vZGUpO307anN0cy5nZW9tZ3JhcGguUGxhbmFyR3JhcGgucHJvdG90eXBlLmFkZEVkZ2VzPWZ1bmN0aW9uKGVkZ2VzVG9BZGQpe2Zvcih2YXIgaXQ9ZWRnZXNUb0FkZC5pdGVyYXRvcigpO2l0Lmhhc05leHQoKTspe3ZhciBlPWl0Lm5leHQoKTt0aGlzLmVkZ2VzLmFkZChlKTt2YXIgZGUxPW5ldyBqc3RzLmdlb21ncmFwaC5EaXJlY3RlZEVkZ2UoZSx0cnVlKTt2YXIgZGUyPW5ldyBqc3RzLmdlb21ncmFwaC5EaXJlY3RlZEVkZ2UoZSxmYWxzZSk7ZGUxLnNldFN5bShkZTIpO2RlMi5zZXRTeW0oZGUxKTt0aGlzLmFkZChkZTEpO3RoaXMuYWRkKGRlMik7fX07anN0cy5nZW9tZ3JhcGguUGxhbmFyR3JhcGgucHJvdG90eXBlLmxpbmtSZXN1bHREaXJlY3RlZEVkZ2VzPWZ1bmN0aW9uKCl7Zm9yKHZhciBub2RlaXQ9dGhpcy5ub2Rlcy5pdGVyYXRvcigpO25vZGVpdC5oYXNOZXh0KCk7KXt2YXIgbm9kZT1ub2RlaXQubmV4dCgpO25vZGUuZ2V0RWRnZXMoKS5saW5rUmVzdWx0RGlyZWN0ZWRFZGdlcygpO319O2pzdHMuZ2VvbWdyYXBoLlBsYW5hckdyYXBoLnByb3RvdHlwZS5maW5kRWRnZUluU2FtZURpcmVjdGlvbj1mdW5jdGlvbihwMCxwMSl7dmFyIGk9MCxpbD10aGlzLmVkZ2VzLnNpemUoKSxlLGVDb29yZDtmb3IoaTtpPGlsO2krKyl7ZT10aGlzLmVkZ2VzLmdldChpKTtlQ29vcmQ9ZS5nZXRDb29yZGluYXRlcygpO2lmKHRoaXMubWF0Y2hJblNhbWVEaXJlY3Rpb24ocDAscDEsZUNvb3JkWzBdLGVDb29yZFsxXSkpe3JldHVybiBlO31cbmlmKHRoaXMubWF0Y2hJblNhbWVEaXJlY3Rpb24ocDAscDEsZUNvb3JkW2VDb29yZC5sZW5ndGgtMV0sZUNvb3JkW2VDb29yZC5sZW5ndGgtMl0pKXtyZXR1cm4gZTt9fVxucmV0dXJuIG51bGw7fTtqc3RzLmdlb21ncmFwaC5QbGFuYXJHcmFwaC5wcm90b3R5cGUubWF0Y2hJblNhbWVEaXJlY3Rpb249ZnVuY3Rpb24ocDAscDEsZXAwLGVwMSl7aWYoIXAwLmVxdWFscyhlcDApKXtyZXR1cm4gZmFsc2U7fVxuaWYoanN0cy5hbGdvcml0aG0uQ0dBbGdvcml0aG1zLmNvbXB1dGVPcmllbnRhdGlvbihwMCxwMSxlcDEpPT09anN0cy5hbGdvcml0aG0uQ0dBbGdvcml0aG1zLkNPTExJTkVBUiYmanN0cy5nZW9tZ3JhcGguUXVhZHJhbnQucXVhZHJhbnQocDAscDEpPT09anN0cy5nZW9tZ3JhcGguUXVhZHJhbnQucXVhZHJhbnQoZXAwLGVwMSkpe3JldHVybiB0cnVlO31cbnJldHVybiBmYWxzZTt9O2pzdHMuZ2VvbWdyYXBoLlBsYW5hckdyYXBoLnByb3RvdHlwZS5maW5kRWRnZUVuZD1mdW5jdGlvbihlKXtmb3IodmFyIGk9dGhpcy5nZXRFZGdlRW5kcygpLml0ZXJhdG9yKCk7aS5oYXNOZXh0KCk7KXt2YXIgZWU9aS5uZXh0KCk7aWYoZWUuZ2V0RWRnZSgpPT09ZSl7cmV0dXJuIGVlO319XG5yZXR1cm4gbnVsbDt9O30pKCk7anN0cy5ub2RpbmcuU2VnbWVudEludGVyc2VjdG9yPWZ1bmN0aW9uKCl7fTtqc3RzLm5vZGluZy5TZWdtZW50SW50ZXJzZWN0b3IucHJvdG90eXBlLnByb2Nlc3NJbnRlcnNlY3Rpb25zPWpzdHMuYWJzdHJhY3RGdW5jO2pzdHMubm9kaW5nLlNlZ21lbnRJbnRlcnNlY3Rvci5wcm90b3R5cGUuaXNEb25lPWpzdHMuYWJzdHJhY3RGdW5jOyhmdW5jdGlvbigpe3ZhciBTZWdtZW50SW50ZXJzZWN0b3I9anN0cy5ub2RpbmcuU2VnbWVudEludGVyc2VjdG9yO3ZhciBBcnJheUxpc3Q9amF2YXNjcmlwdC51dGlsLkFycmF5TGlzdDtqc3RzLm5vZGluZy5JbnRlcmlvckludGVyc2VjdGlvbkZpbmRlcj1mdW5jdGlvbihsaSl7dGhpcy5saT1saTt0aGlzLmludGVyc2VjdGlvbnM9bmV3IEFycmF5TGlzdCgpO3RoaXMuaW50ZXJpb3JJbnRlcnNlY3Rpb249bnVsbDt9O2pzdHMubm9kaW5nLkludGVyaW9ySW50ZXJzZWN0aW9uRmluZGVyLnByb3RvdHlwZT1uZXcgU2VnbWVudEludGVyc2VjdG9yKCk7anN0cy5ub2RpbmcuSW50ZXJpb3JJbnRlcnNlY3Rpb25GaW5kZXIuY29uc3RydWN0b3I9anN0cy5ub2RpbmcuSW50ZXJpb3JJbnRlcnNlY3Rpb25GaW5kZXI7anN0cy5ub2RpbmcuSW50ZXJpb3JJbnRlcnNlY3Rpb25GaW5kZXIucHJvdG90eXBlLmZpbmRBbGxJbnRlcnNlY3Rpb25zPWZhbHNlO2pzdHMubm9kaW5nLkludGVyaW9ySW50ZXJzZWN0aW9uRmluZGVyLnByb3RvdHlwZS5pc0NoZWNrRW5kU2VnbWVudHNPbmx5PWZhbHNlO2pzdHMubm9kaW5nLkludGVyaW9ySW50ZXJzZWN0aW9uRmluZGVyLnByb3RvdHlwZS5saT1udWxsO2pzdHMubm9kaW5nLkludGVyaW9ySW50ZXJzZWN0aW9uRmluZGVyLnByb3RvdHlwZS5pbnRlcmlvckludGVyc2VjdGlvbj1udWxsO2pzdHMubm9kaW5nLkludGVyaW9ySW50ZXJzZWN0aW9uRmluZGVyLnByb3RvdHlwZS5pbnRTZWdtZW50cz1udWxsO2pzdHMubm9kaW5nLkludGVyaW9ySW50ZXJzZWN0aW9uRmluZGVyLnByb3RvdHlwZS5pbnRlcnNlY3Rpb25zPW51bGw7anN0cy5ub2RpbmcuSW50ZXJpb3JJbnRlcnNlY3Rpb25GaW5kZXIucHJvdG90eXBlLnNldEZpbmRBbGxJbnRlcnNlY3Rpb25zPWZ1bmN0aW9uKGZpbmRBbGxJbnRlcnNlY3Rpb25zKXt0aGlzLmZpbmRBbGxJbnRlcnNlY3Rpb25zPWZpbmRBbGxJbnRlcnNlY3Rpb25zO307anN0cy5ub2RpbmcuSW50ZXJpb3JJbnRlcnNlY3Rpb25GaW5kZXIucHJvdG90eXBlLmdldEludGVyc2VjdGlvbnM9ZnVuY3Rpb24oKXtyZXR1cm4gaW50ZXJzZWN0aW9uczt9O2pzdHMubm9kaW5nLkludGVyaW9ySW50ZXJzZWN0aW9uRmluZGVyLnByb3RvdHlwZS5zZXRDaGVja0VuZFNlZ21lbnRzT25seT1mdW5jdGlvbihpc0NoZWNrRW5kU2VnbWVudHNPbmx5KXt0aGlzLmlzQ2hlY2tFbmRTZWdtZW50c09ubHk9aXNDaGVja0VuZFNlZ21lbnRzT25seTt9XG5qc3RzLm5vZGluZy5JbnRlcmlvckludGVyc2VjdGlvbkZpbmRlci5wcm90b3R5cGUuaGFzSW50ZXJzZWN0aW9uPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuaW50ZXJpb3JJbnRlcnNlY3Rpb24hPW51bGw7fTtqc3RzLm5vZGluZy5JbnRlcmlvckludGVyc2VjdGlvbkZpbmRlci5wcm90b3R5cGUuZ2V0SW50ZXJpb3JJbnRlcnNlY3Rpb249ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5pbnRlcmlvckludGVyc2VjdGlvbjt9O2pzdHMubm9kaW5nLkludGVyaW9ySW50ZXJzZWN0aW9uRmluZGVyLnByb3RvdHlwZS5nZXRJbnRlcnNlY3Rpb25TZWdtZW50cz1mdW5jdGlvbigpe3JldHVybiB0aGlzLmludFNlZ21lbnRzO307anN0cy5ub2RpbmcuSW50ZXJpb3JJbnRlcnNlY3Rpb25GaW5kZXIucHJvdG90eXBlLnByb2Nlc3NJbnRlcnNlY3Rpb25zPWZ1bmN0aW9uKGUwLHNlZ0luZGV4MCxlMSxzZWdJbmRleDEpe2lmKHRoaXMuaGFzSW50ZXJzZWN0aW9uKCkpXG5yZXR1cm47aWYoZTA9PWUxJiZzZWdJbmRleDA9PXNlZ0luZGV4MSlcbnJldHVybjtpZih0aGlzLmlzQ2hlY2tFbmRTZWdtZW50c09ubHkpe3ZhciBpc0VuZFNlZ1ByZXNlbnQ9dGhpcy5pc0VuZFNlZ21lbnQoZTAsc2VnSW5kZXgwKXx8aXNFbmRTZWdtZW50KGUxLHNlZ0luZGV4MSk7aWYoIWlzRW5kU2VnUHJlc2VudClcbnJldHVybjt9XG52YXIgcDAwPWUwLmdldENvb3JkaW5hdGVzKClbc2VnSW5kZXgwXTt2YXIgcDAxPWUwLmdldENvb3JkaW5hdGVzKClbc2VnSW5kZXgwKzFdO3ZhciBwMTA9ZTEuZ2V0Q29vcmRpbmF0ZXMoKVtzZWdJbmRleDFdO3ZhciBwMTE9ZTEuZ2V0Q29vcmRpbmF0ZXMoKVtzZWdJbmRleDErMV07dGhpcy5saS5jb21wdXRlSW50ZXJzZWN0aW9uKHAwMCxwMDEscDEwLHAxMSk7aWYodGhpcy5saS5oYXNJbnRlcnNlY3Rpb24oKSl7aWYodGhpcy5saS5pc0ludGVyaW9ySW50ZXJzZWN0aW9uKCkpe3RoaXMuaW50U2VnbWVudHM9W107dGhpcy5pbnRTZWdtZW50c1swXT1wMDA7dGhpcy5pbnRTZWdtZW50c1sxXT1wMDE7dGhpcy5pbnRTZWdtZW50c1syXT1wMTA7dGhpcy5pbnRTZWdtZW50c1szXT1wMTE7dGhpcy5pbnRlcmlvckludGVyc2VjdGlvbj10aGlzLmxpLmdldEludGVyc2VjdGlvbigwKTt0aGlzLmludGVyc2VjdGlvbnMuYWRkKHRoaXMuaW50ZXJpb3JJbnRlcnNlY3Rpb24pO319fTtqc3RzLm5vZGluZy5JbnRlcmlvckludGVyc2VjdGlvbkZpbmRlci5wcm90b3R5cGUuaXNFbmRTZWdtZW50PWZ1bmN0aW9uKHNlZ1N0cixpbmRleCl7aWYoaW5kZXg9PTApXG5yZXR1cm4gdHJ1ZTtpZihpbmRleD49c2VnU3RyLnNpemUoKS0yKVxucmV0dXJuIHRydWU7cmV0dXJuIGZhbHNlO307anN0cy5ub2RpbmcuSW50ZXJpb3JJbnRlcnNlY3Rpb25GaW5kZXIucHJvdG90eXBlLmlzRG9uZT1mdW5jdGlvbigpe2lmKHRoaXMuZmluZEFsbEludGVyc2VjdGlvbnMpXG5yZXR1cm4gZmFsc2U7cmV0dXJuIHRoaXMuaW50ZXJpb3JJbnRlcnNlY3Rpb24hPW51bGw7fTt9KSgpOyhmdW5jdGlvbigpe3ZhciBSb2J1c3RMaW5lSW50ZXJzZWN0b3I9anN0cy5hbGdvcml0aG0uUm9idXN0TGluZUludGVyc2VjdG9yO3ZhciBJbnRlcmlvckludGVyc2VjdGlvbkZpbmRlcj1qc3RzLm5vZGluZy5JbnRlcmlvckludGVyc2VjdGlvbkZpbmRlcjt2YXIgTUNJbmRleE5vZGVyPWpzdHMubm9kaW5nLk1DSW5kZXhOb2Rlcjtqc3RzLm5vZGluZy5GYXN0Tm9kaW5nVmFsaWRhdG9yPWZ1bmN0aW9uKHNlZ1N0cmluZ3Mpe3RoaXMubGk9bmV3IFJvYnVzdExpbmVJbnRlcnNlY3RvcigpO3RoaXMuc2VnU3RyaW5ncz1zZWdTdHJpbmdzO307anN0cy5ub2RpbmcuRmFzdE5vZGluZ1ZhbGlkYXRvci5wcm90b3R5cGUubGk9bnVsbDtqc3RzLm5vZGluZy5GYXN0Tm9kaW5nVmFsaWRhdG9yLnByb3RvdHlwZS5zZWdTdHJpbmdzPW51bGw7anN0cy5ub2RpbmcuRmFzdE5vZGluZ1ZhbGlkYXRvci5wcm90b3R5cGUuZmluZEFsbEludGVyc2VjdGlvbnM9ZmFsc2U7anN0cy5ub2RpbmcuRmFzdE5vZGluZ1ZhbGlkYXRvci5wcm90b3R5cGUuc2VnSW50PW51bGw7anN0cy5ub2RpbmcuRmFzdE5vZGluZ1ZhbGlkYXRvci5wcm90b3R5cGUuX2lzVmFsaWQ9dHJ1ZTtqc3RzLm5vZGluZy5GYXN0Tm9kaW5nVmFsaWRhdG9yLnByb3RvdHlwZS5zZXRGaW5kQWxsSW50ZXJzZWN0aW9ucz1mdW5jdGlvbihmaW5kQWxsSW50ZXJzZWN0aW9ucyl7dGhpcy5maW5kQWxsSW50ZXJzZWN0aW9ucz1maW5kQWxsSW50ZXJzZWN0aW9uczt9O2pzdHMubm9kaW5nLkZhc3ROb2RpbmdWYWxpZGF0b3IucHJvdG90eXBlLmdldEludGVyc2VjdGlvbnM9ZnVuY3Rpb24oKXtyZXR1cm4gc2VnSW50LmdldEludGVyc2VjdGlvbnMoKTt9O2pzdHMubm9kaW5nLkZhc3ROb2RpbmdWYWxpZGF0b3IucHJvdG90eXBlLmlzVmFsaWQ9ZnVuY3Rpb24oKXt0aGlzLmV4ZWN1dGUoKTtyZXR1cm4gdGhpcy5faXNWYWxpZDt9O2pzdHMubm9kaW5nLkZhc3ROb2RpbmdWYWxpZGF0b3IucHJvdG90eXBlLmdldEVycm9yTWVzc2FnZT1mdW5jdGlvbigpe2lmKHRoaXMuX2lzVmFsaWQpXG5yZXR1cm4nbm8gaW50ZXJzZWN0aW9ucyBmb3VuZCc7dmFyIGludFNlZ3M9dGhpcy5zZWdJbnQuZ2V0SW50ZXJzZWN0aW9uU2VnbWVudHMoKTtyZXR1cm4nZm91bmQgbm9uLW5vZGVkIGludGVyc2VjdGlvbiBiZXR3ZWVuICcrXG5qc3RzLmlvLldLVFdyaXRlci50b0xpbmVTdHJpbmcoaW50U2Vnc1swXSxpbnRTZWdzWzFdKSsnIGFuZCAnK1xuanN0cy5pby5XS1RXcml0ZXIudG9MaW5lU3RyaW5nKGludFNlZ3NbMl0saW50U2Vnc1szXSk7fTtqc3RzLm5vZGluZy5GYXN0Tm9kaW5nVmFsaWRhdG9yLnByb3RvdHlwZS5jaGVja1ZhbGlkPWZ1bmN0aW9uKCl7dGhpcy5leGVjdXRlKCk7aWYoIXRoaXMuX2lzVmFsaWQpXG50aHJvdyBuZXcganN0cy5lcnJvci5Ub3BvbG9neUVycm9yKHRoaXMuZ2V0RXJyb3JNZXNzYWdlKCksdGhpcy5zZWdJbnQuZ2V0SW50ZXJpb3JJbnRlcnNlY3Rpb24oKSk7fTtqc3RzLm5vZGluZy5GYXN0Tm9kaW5nVmFsaWRhdG9yLnByb3RvdHlwZS5leGVjdXRlPWZ1bmN0aW9uKCl7aWYodGhpcy5zZWdJbnQhPW51bGwpXG5yZXR1cm47dGhpcy5jaGVja0ludGVyaW9ySW50ZXJzZWN0aW9ucygpO307anN0cy5ub2RpbmcuRmFzdE5vZGluZ1ZhbGlkYXRvci5wcm90b3R5cGUuY2hlY2tJbnRlcmlvckludGVyc2VjdGlvbnM9ZnVuY3Rpb24oKXt0aGlzLl9pc1ZhbGlkPXRydWU7dGhpcy5zZWdJbnQ9bmV3IEludGVyaW9ySW50ZXJzZWN0aW9uRmluZGVyKHRoaXMubGkpO3RoaXMuc2VnSW50LnNldEZpbmRBbGxJbnRlcnNlY3Rpb25zKHRoaXMuZmluZEFsbEludGVyc2VjdGlvbnMpO3ZhciBub2Rlcj1uZXcgTUNJbmRleE5vZGVyKCk7bm9kZXIuc2V0U2VnbWVudEludGVyc2VjdG9yKHRoaXMuc2VnSW50KTtub2Rlci5jb21wdXRlTm9kZXModGhpcy5zZWdTdHJpbmdzKTtpZih0aGlzLnNlZ0ludC5oYXNJbnRlcnNlY3Rpb24oKSl7dGhpcy5faXNWYWxpZD1mYWxzZTtyZXR1cm47fX07fSkoKTsoZnVuY3Rpb24oKXtqc3RzLm5vZGluZy5CYXNpY1NlZ21lbnRTdHJpbmc9ZnVuY3Rpb24ocHRzLGRhdGEpe3RoaXMucHRzPXB0czt0aGlzLmRhdGE9ZGF0YTt9O2pzdHMubm9kaW5nLkJhc2ljU2VnbWVudFN0cmluZy5wcm90b3R5cGU9bmV3IGpzdHMubm9kaW5nLlNlZ21lbnRTdHJpbmcoKTtqc3RzLm5vZGluZy5CYXNpY1NlZ21lbnRTdHJpbmcucHJvdG90eXBlLnB0cz1udWxsO2pzdHMubm9kaW5nLkJhc2ljU2VnbWVudFN0cmluZy5wcm90b3R5cGUuZGF0YT1udWxsO2pzdHMubm9kaW5nLkJhc2ljU2VnbWVudFN0cmluZy5wcm90b3R5cGUuZ2V0RGF0YT1mdW5jdGlvbigpe3JldHVybiB0aGlzLmRhdGE7fVxuanN0cy5ub2RpbmcuQmFzaWNTZWdtZW50U3RyaW5nLnByb3RvdHlwZS5zZXREYXRhPWZ1bmN0aW9uKGRhdGEpe3RoaXMuZGF0YT1kYXRhO307anN0cy5ub2RpbmcuQmFzaWNTZWdtZW50U3RyaW5nLnByb3RvdHlwZS5zaXplPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMucHRzLmxlbmd0aDt9O2pzdHMubm9kaW5nLkJhc2ljU2VnbWVudFN0cmluZy5wcm90b3R5cGUuZ2V0Q29vcmRpbmF0ZT1mdW5jdGlvbihpKXtyZXR1cm4gdGhpcy5wdHNbaV07fTtqc3RzLm5vZGluZy5CYXNpY1NlZ21lbnRTdHJpbmcucHJvdG90eXBlLmdldENvb3JkaW5hdGVzPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMucHRzO307anN0cy5ub2RpbmcuQmFzaWNTZWdtZW50U3RyaW5nLnByb3RvdHlwZS5pc0Nsb3NlZD1mdW5jdGlvbigpe3JldHVybiB0aGlzLnB0c1swXS5lcXVhbHModGhpcy5wdHNbdGhpcy5wdHMubGVuZ3RoLTFdKTt9O2pzdHMubm9kaW5nLkJhc2ljU2VnbWVudFN0cmluZy5wcm90b3R5cGUuZ2V0U2VnbWVudE9jdGFudD1mdW5jdGlvbihpbmRleCl7aWYoaW5kZXg9PXRoaXMucHRzLmxlbmd0aC0xKVxucmV0dXJuLTE7cmV0dXJuIGpzdHMubm9kaW5nLk9jdGFudC5vY3RhbnQodGhpcy5nZXRDb29yZGluYXRlKGluZGV4KSx0aGlzLmdldENvb3JkaW5hdGUoaW5kZXgrMSkpO307fSkoKTsoZnVuY3Rpb24oKXt2YXIgRmFzdE5vZGluZ1ZhbGlkYXRvcj1qc3RzLm5vZGluZy5GYXN0Tm9kaW5nVmFsaWRhdG9yO3ZhciBCYXNpY1NlZ21lbnRTdHJpbmc9anN0cy5ub2RpbmcuQmFzaWNTZWdtZW50U3RyaW5nO3ZhciBBcnJheUxpc3Q9amF2YXNjcmlwdC51dGlsLkFycmF5TGlzdDtqc3RzLmdlb21ncmFwaC5FZGdlTm9kaW5nVmFsaWRhdG9yPWZ1bmN0aW9uKGVkZ2VzKXt0aGlzLm52PW5ldyBGYXN0Tm9kaW5nVmFsaWRhdG9yKGpzdHMuZ2VvbWdyYXBoLkVkZ2VOb2RpbmdWYWxpZGF0b3IudG9TZWdtZW50U3RyaW5ncyhlZGdlcykpO307anN0cy5nZW9tZ3JhcGguRWRnZU5vZGluZ1ZhbGlkYXRvci5jaGVja1ZhbGlkPWZ1bmN0aW9uKGVkZ2VzKXt2YXIgdmFsaWRhdG9yPW5ldyBqc3RzLmdlb21ncmFwaC5FZGdlTm9kaW5nVmFsaWRhdG9yKGVkZ2VzKTt2YWxpZGF0b3IuY2hlY2tWYWxpZCgpO307anN0cy5nZW9tZ3JhcGguRWRnZU5vZGluZ1ZhbGlkYXRvci50b1NlZ21lbnRTdHJpbmdzPWZ1bmN0aW9uKGVkZ2VzKXt2YXIgc2VnU3RyaW5ncz1uZXcgQXJyYXlMaXN0KCk7Zm9yKHZhciBpPWVkZ2VzLml0ZXJhdG9yKCk7aS5oYXNOZXh0KCk7KXt2YXIgZT1pLm5leHQoKTtzZWdTdHJpbmdzLmFkZChuZXcgQmFzaWNTZWdtZW50U3RyaW5nKGUuZ2V0Q29vcmRpbmF0ZXMoKSxlKSk7fVxucmV0dXJuIHNlZ1N0cmluZ3M7fTtqc3RzLmdlb21ncmFwaC5FZGdlTm9kaW5nVmFsaWRhdG9yLnByb3RvdHlwZS5udj1udWxsO2pzdHMuZ2VvbWdyYXBoLkVkZ2VOb2RpbmdWYWxpZGF0b3IucHJvdG90eXBlLmNoZWNrVmFsaWQ9ZnVuY3Rpb24oKXt0aGlzLm52LmNoZWNrVmFsaWQoKTt9O30pKCk7anN0cy5vcGVyYXRpb24uR2VvbWV0cnlHcmFwaE9wZXJhdGlvbj1mdW5jdGlvbihnMCxnMSxib3VuZGFyeU5vZGVSdWxlKXt0aGlzLmxpPW5ldyBqc3RzLmFsZ29yaXRobS5Sb2J1c3RMaW5lSW50ZXJzZWN0b3IoKTt0aGlzLmFyZz1bXTtpZihnMD09PXVuZGVmaW5lZCl7cmV0dXJuO31cbmlmKGcxPT09dW5kZWZpbmVkKXt0aGlzLnNldENvbXB1dGF0aW9uUHJlY2lzaW9uKGcwLmdldFByZWNpc2lvbk1vZGVsKCkpO3RoaXMuYXJnWzBdPW5ldyBqc3RzLmdlb21ncmFwaC5HZW9tZXRyeUdyYXBoKDAsZzApO3JldHVybjt9XG5ib3VuZGFyeU5vZGVSdWxlPWJvdW5kYXJ5Tm9kZVJ1bGV8fGpzdHMuYWxnb3JpdGhtLkJvdW5kYXJ5Tm9kZVJ1bGUuT0dDX1NGU19CT1VOREFSWV9SVUxFO2lmKGcwLmdldFByZWNpc2lvbk1vZGVsKCkuY29tcGFyZVRvKGcxLmdldFByZWNpc2lvbk1vZGVsKCkpPj0wKVxudGhpcy5zZXRDb21wdXRhdGlvblByZWNpc2lvbihnMC5nZXRQcmVjaXNpb25Nb2RlbCgpKTtlbHNlXG50aGlzLnNldENvbXB1dGF0aW9uUHJlY2lzaW9uKGcxLmdldFByZWNpc2lvbk1vZGVsKCkpO3RoaXMuYXJnWzBdPW5ldyBqc3RzLmdlb21ncmFwaC5HZW9tZXRyeUdyYXBoKDAsZzAsYm91bmRhcnlOb2RlUnVsZSk7dGhpcy5hcmdbMV09bmV3IGpzdHMuZ2VvbWdyYXBoLkdlb21ldHJ5R3JhcGgoMSxnMSxib3VuZGFyeU5vZGVSdWxlKTt9O2pzdHMub3BlcmF0aW9uLkdlb21ldHJ5R3JhcGhPcGVyYXRpb24ucHJvdG90eXBlLmxpPW51bGw7anN0cy5vcGVyYXRpb24uR2VvbWV0cnlHcmFwaE9wZXJhdGlvbi5wcm90b3R5cGUucmVzdWx0UHJlY2lzaW9uTW9kZWw9bnVsbDtqc3RzLm9wZXJhdGlvbi5HZW9tZXRyeUdyYXBoT3BlcmF0aW9uLnByb3RvdHlwZS5hcmc9bnVsbDtqc3RzLm9wZXJhdGlvbi5HZW9tZXRyeUdyYXBoT3BlcmF0aW9uLnByb3RvdHlwZS5nZXRBcmdHZW9tZXRyeT1mdW5jdGlvbihpKXtyZXR1cm4gYXJnW2ldLmdldEdlb21ldHJ5KCk7fTtqc3RzLm9wZXJhdGlvbi5HZW9tZXRyeUdyYXBoT3BlcmF0aW9uLnByb3RvdHlwZS5zZXRDb21wdXRhdGlvblByZWNpc2lvbj1mdW5jdGlvbihwbSl7dGhpcy5yZXN1bHRQcmVjaXNpb25Nb2RlbD1wbTt0aGlzLmxpLnNldFByZWNpc2lvbk1vZGVsKHRoaXMucmVzdWx0UHJlY2lzaW9uTW9kZWwpO307anN0cy5vcGVyYXRpb24ub3ZlcmxheS5PdmVybGF5Tm9kZUZhY3Rvcnk9ZnVuY3Rpb24oKXt9O2pzdHMub3BlcmF0aW9uLm92ZXJsYXkuT3ZlcmxheU5vZGVGYWN0b3J5LnByb3RvdHlwZT1uZXcganN0cy5nZW9tZ3JhcGguTm9kZUZhY3RvcnkoKTtqc3RzLm9wZXJhdGlvbi5vdmVybGF5Lk92ZXJsYXlOb2RlRmFjdG9yeS5jb25zdHJ1Y3Rvcj1qc3RzLm9wZXJhdGlvbi5vdmVybGF5Lk92ZXJsYXlOb2RlRmFjdG9yeTtqc3RzLm9wZXJhdGlvbi5vdmVybGF5Lk92ZXJsYXlOb2RlRmFjdG9yeS5wcm90b3R5cGUuY3JlYXRlTm9kZT1mdW5jdGlvbihjb29yZCl7cmV0dXJuIG5ldyBqc3RzLmdlb21ncmFwaC5Ob2RlKGNvb3JkLG5ldyBqc3RzLmdlb21ncmFwaC5EaXJlY3RlZEVkZ2VTdGFyKCkpO307anN0cy5vcGVyYXRpb24ub3ZlcmxheS5Qb2x5Z29uQnVpbGRlcj1mdW5jdGlvbihnZW9tZXRyeUZhY3Rvcnkpe3RoaXMuc2hlbGxMaXN0PVtdO3RoaXMuZ2VvbWV0cnlGYWN0b3J5PWdlb21ldHJ5RmFjdG9yeTt9O2pzdHMub3BlcmF0aW9uLm92ZXJsYXkuUG9seWdvbkJ1aWxkZXIucHJvdG90eXBlLmdlb21ldHJ5RmFjdG9yeT1udWxsO2pzdHMub3BlcmF0aW9uLm92ZXJsYXkuUG9seWdvbkJ1aWxkZXIucHJvdG90eXBlLnNoZWxsTGlzdD1udWxsO2pzdHMub3BlcmF0aW9uLm92ZXJsYXkuUG9seWdvbkJ1aWxkZXIucHJvdG90eXBlLmFkZD1mdW5jdGlvbihncmFwaCl7aWYoYXJndW1lbnRzLmxlbmd0aD09PTIpe3RoaXMuYWRkMi5hcHBseSh0aGlzLGFyZ3VtZW50cyk7cmV0dXJuO31cbnRoaXMuYWRkMihncmFwaC5nZXRFZGdlRW5kcygpLGdyYXBoLmdldE5vZGVzKCkpO307anN0cy5vcGVyYXRpb24ub3ZlcmxheS5Qb2x5Z29uQnVpbGRlci5wcm90b3R5cGUuYWRkMj1mdW5jdGlvbihkaXJFZGdlcyxub2Rlcyl7anN0cy5nZW9tZ3JhcGguUGxhbmFyR3JhcGgubGlua1Jlc3VsdERpcmVjdGVkRWRnZXMobm9kZXMpO3ZhciBtYXhFZGdlUmluZ3M9dGhpcy5idWlsZE1heGltYWxFZGdlUmluZ3MoZGlyRWRnZXMpO3ZhciBmcmVlSG9sZUxpc3Q9W107dmFyIGVkZ2VSaW5ncz10aGlzLmJ1aWxkTWluaW1hbEVkZ2VSaW5ncyhtYXhFZGdlUmluZ3MsdGhpcy5zaGVsbExpc3QsZnJlZUhvbGVMaXN0KTt0aGlzLnNvcnRTaGVsbHNBbmRIb2xlcyhlZGdlUmluZ3MsdGhpcy5zaGVsbExpc3QsZnJlZUhvbGVMaXN0KTt0aGlzLnBsYWNlRnJlZUhvbGVzKHRoaXMuc2hlbGxMaXN0LGZyZWVIb2xlTGlzdCk7fTtqc3RzLm9wZXJhdGlvbi5vdmVybGF5LlBvbHlnb25CdWlsZGVyLnByb3RvdHlwZS5nZXRQb2x5Z29ucz1mdW5jdGlvbigpe3ZhciByZXN1bHRQb2x5TGlzdD10aGlzLmNvbXB1dGVQb2x5Z29ucyh0aGlzLnNoZWxsTGlzdCk7cmV0dXJuIHJlc3VsdFBvbHlMaXN0O307anN0cy5vcGVyYXRpb24ub3ZlcmxheS5Qb2x5Z29uQnVpbGRlci5wcm90b3R5cGUuYnVpbGRNYXhpbWFsRWRnZVJpbmdzPWZ1bmN0aW9uKGRpckVkZ2VzKXt2YXIgbWF4RWRnZVJpbmdzPVtdO2Zvcih2YXIgaXQ9ZGlyRWRnZXMuaXRlcmF0b3IoKTtpdC5oYXNOZXh0KCk7KXt2YXIgZGU9aXQubmV4dCgpO2lmKGRlLmlzSW5SZXN1bHQoKSYmZGUuZ2V0TGFiZWwoKS5pc0FyZWEoKSl7aWYoZGUuZ2V0RWRnZVJpbmcoKT09bnVsbCl7dmFyIGVyPW5ldyBqc3RzLm9wZXJhdGlvbi5vdmVybGF5Lk1heGltYWxFZGdlUmluZyhkZSx0aGlzLmdlb21ldHJ5RmFjdG9yeSk7bWF4RWRnZVJpbmdzLnB1c2goZXIpO2VyLnNldEluUmVzdWx0KCk7fX19XG5yZXR1cm4gbWF4RWRnZVJpbmdzO307anN0cy5vcGVyYXRpb24ub3ZlcmxheS5Qb2x5Z29uQnVpbGRlci5wcm90b3R5cGUuYnVpbGRNaW5pbWFsRWRnZVJpbmdzPWZ1bmN0aW9uKG1heEVkZ2VSaW5ncyxzaGVsbExpc3QsZnJlZUhvbGVMaXN0KXt2YXIgZWRnZVJpbmdzPVtdO2Zvcih2YXIgaT0wO2k8bWF4RWRnZVJpbmdzLmxlbmd0aDtpKyspe3ZhciBlcj1tYXhFZGdlUmluZ3NbaV07aWYoZXIuZ2V0TWF4Tm9kZURlZ3JlZSgpPjIpe2VyLmxpbmtEaXJlY3RlZEVkZ2VzRm9yTWluaW1hbEVkZ2VSaW5ncygpO3ZhciBtaW5FZGdlUmluZ3M9ZXIuYnVpbGRNaW5pbWFsUmluZ3MoKTt2YXIgc2hlbGw9dGhpcy5maW5kU2hlbGwobWluRWRnZVJpbmdzKTtpZihzaGVsbCE9PW51bGwpe3RoaXMucGxhY2VQb2x5Z29uSG9sZXMoc2hlbGwsbWluRWRnZVJpbmdzKTtzaGVsbExpc3QucHVzaChzaGVsbCk7fWVsc2V7ZnJlZUhvbGVMaXN0PWZyZWVIb2xlTGlzdC5jb25jYXQobWluRWRnZVJpbmdzKTt9fWVsc2V7ZWRnZVJpbmdzLnB1c2goZXIpO319XG5yZXR1cm4gZWRnZVJpbmdzO307anN0cy5vcGVyYXRpb24ub3ZlcmxheS5Qb2x5Z29uQnVpbGRlci5wcm90b3R5cGUuZmluZFNoZWxsPWZ1bmN0aW9uKG1pbkVkZ2VSaW5ncyl7dmFyIHNoZWxsQ291bnQ9MDt2YXIgc2hlbGw9bnVsbDtmb3IodmFyIGk9MDtpPG1pbkVkZ2VSaW5ncy5sZW5ndGg7aSsrKXt2YXIgZXI9bWluRWRnZVJpbmdzW2ldO2lmKCFlci5pc0hvbGUoKSl7c2hlbGw9ZXI7c2hlbGxDb3VudCsrO319XG5qc3RzLnV0aWwuQXNzZXJ0LmlzVHJ1ZShzaGVsbENvdW50PD0xLCdmb3VuZCB0d28gc2hlbGxzIGluIE1pbmltYWxFZGdlUmluZyBsaXN0Jyk7cmV0dXJuIHNoZWxsO307anN0cy5vcGVyYXRpb24ub3ZlcmxheS5Qb2x5Z29uQnVpbGRlci5wcm90b3R5cGUucGxhY2VQb2x5Z29uSG9sZXM9ZnVuY3Rpb24oc2hlbGwsbWluRWRnZVJpbmdzKXtmb3IodmFyIGk9MDtpPG1pbkVkZ2VSaW5ncy5sZW5ndGg7aSsrKXt2YXIgZXI9bWluRWRnZVJpbmdzW2ldO2lmKGVyLmlzSG9sZSgpKXtlci5zZXRTaGVsbChzaGVsbCk7fX19O2pzdHMub3BlcmF0aW9uLm92ZXJsYXkuUG9seWdvbkJ1aWxkZXIucHJvdG90eXBlLnNvcnRTaGVsbHNBbmRIb2xlcz1mdW5jdGlvbihlZGdlUmluZ3Msc2hlbGxMaXN0LGZyZWVIb2xlTGlzdCl7Zm9yKHZhciBpPTA7aTxlZGdlUmluZ3MubGVuZ3RoO2krKyl7dmFyIGVyPWVkZ2VSaW5nc1tpXTtpZihlci5pc0hvbGUoKSl7ZnJlZUhvbGVMaXN0LnB1c2goZXIpO31lbHNle3NoZWxsTGlzdC5wdXNoKGVyKTt9fX07anN0cy5vcGVyYXRpb24ub3ZlcmxheS5Qb2x5Z29uQnVpbGRlci5wcm90b3R5cGUucGxhY2VGcmVlSG9sZXM9ZnVuY3Rpb24oc2hlbGxMaXN0LGZyZWVIb2xlTGlzdCl7Zm9yKHZhciBpPTA7aTxmcmVlSG9sZUxpc3QubGVuZ3RoO2krKyl7dmFyIGhvbGU9ZnJlZUhvbGVMaXN0W2ldO2lmKGhvbGUuZ2V0U2hlbGwoKT09bnVsbCl7dmFyIHNoZWxsPXRoaXMuZmluZEVkZ2VSaW5nQ29udGFpbmluZyhob2xlLHNoZWxsTGlzdCk7aWYoc2hlbGw9PT1udWxsKVxudGhyb3cgbmV3IGpzdHMuZXJyb3IuVG9wb2xvZ3lFcnJvcigndW5hYmxlIHRvIGFzc2lnbiBob2xlIHRvIGEgc2hlbGwnLGhvbGUuZ2V0Q29vcmRpbmF0ZSgwKSk7aG9sZS5zZXRTaGVsbChzaGVsbCk7fX19O2pzdHMub3BlcmF0aW9uLm92ZXJsYXkuUG9seWdvbkJ1aWxkZXIucHJvdG90eXBlLmZpbmRFZGdlUmluZ0NvbnRhaW5pbmc9ZnVuY3Rpb24odGVzdEVyLHNoZWxsTGlzdCl7dmFyIHRlc3RSaW5nPXRlc3RFci5nZXRMaW5lYXJSaW5nKCk7dmFyIHRlc3RFbnY9dGVzdFJpbmcuZ2V0RW52ZWxvcGVJbnRlcm5hbCgpO3ZhciB0ZXN0UHQ9dGVzdFJpbmcuZ2V0Q29vcmRpbmF0ZU4oMCk7dmFyIG1pblNoZWxsPW51bGw7dmFyIG1pbkVudj1udWxsO2Zvcih2YXIgaT0wO2k8c2hlbGxMaXN0Lmxlbmd0aDtpKyspe3ZhciB0cnlTaGVsbD1zaGVsbExpc3RbaV07dmFyIHRyeVJpbmc9dHJ5U2hlbGwuZ2V0TGluZWFyUmluZygpO3ZhciB0cnlFbnY9dHJ5UmluZy5nZXRFbnZlbG9wZUludGVybmFsKCk7aWYobWluU2hlbGwhPT1udWxsKVxubWluRW52PW1pblNoZWxsLmdldExpbmVhclJpbmcoKS5nZXRFbnZlbG9wZUludGVybmFsKCk7dmFyIGlzQ29udGFpbmVkPWZhbHNlO2lmKHRyeUVudi5jb250YWlucyh0ZXN0RW52KSYmanN0cy5hbGdvcml0aG0uQ0dBbGdvcml0aG1zLmlzUG9pbnRJblJpbmcodGVzdFB0LHRyeVJpbmcuZ2V0Q29vcmRpbmF0ZXMoKSkpXG5pc0NvbnRhaW5lZD10cnVlO2lmKGlzQ29udGFpbmVkKXtpZihtaW5TaGVsbD09bnVsbHx8bWluRW52LmNvbnRhaW5zKHRyeUVudikpe21pblNoZWxsPXRyeVNoZWxsO319fVxucmV0dXJuIG1pblNoZWxsO307anN0cy5vcGVyYXRpb24ub3ZlcmxheS5Qb2x5Z29uQnVpbGRlci5wcm90b3R5cGUuY29tcHV0ZVBvbHlnb25zPWZ1bmN0aW9uKHNoZWxsTGlzdCl7dmFyIHJlc3VsdFBvbHlMaXN0PW5ldyBqYXZhc2NyaXB0LnV0aWwuQXJyYXlMaXN0KCk7Zm9yKHZhciBpPTA7aTxzaGVsbExpc3QubGVuZ3RoO2krKyl7dmFyIGVyPXNoZWxsTGlzdFtpXTt2YXIgcG9seT1lci50b1BvbHlnb24odGhpcy5nZW9tZXRyeUZhY3RvcnkpO3Jlc3VsdFBvbHlMaXN0LmFkZChwb2x5KTt9XG5yZXR1cm4gcmVzdWx0UG9seUxpc3Q7fTtqc3RzLm9wZXJhdGlvbi5vdmVybGF5LlBvbHlnb25CdWlsZGVyLnByb3RvdHlwZS5jb250YWluc1BvaW50PWZ1bmN0aW9uKHApe2Zvcih2YXIgaT0wO2k8dGhpcy5zaGVsbExpc3QubGVuZ3RoO2krKyl7dmFyIGVyPXRoaXMuc2hlbGxMaXN0W2ldO2lmKGVyLmNvbnRhaW5zUG9pbnQocCkpXG5yZXR1cm4gdHJ1ZTt9XG5yZXR1cm4gZmFsc2U7fTsoZnVuY3Rpb24oKXt2YXIgQXNzZXJ0PWpzdHMudXRpbC5Bc3NlcnQ7dmFyIEFycmF5TGlzdD1qYXZhc2NyaXB0LnV0aWwuQXJyYXlMaXN0O3ZhciBMaW5lQnVpbGRlcj1mdW5jdGlvbihvcCxnZW9tZXRyeUZhY3RvcnkscHRMb2NhdG9yKXt0aGlzLmxpbmVFZGdlc0xpc3Q9bmV3IEFycmF5TGlzdCgpO3RoaXMucmVzdWx0TGluZUxpc3Q9bmV3IEFycmF5TGlzdCgpO3RoaXMub3A9b3A7dGhpcy5nZW9tZXRyeUZhY3Rvcnk9Z2VvbWV0cnlGYWN0b3J5O3RoaXMucHRMb2NhdG9yPXB0TG9jYXRvcjt9O0xpbmVCdWlsZGVyLnByb3RvdHlwZS5vcD1udWxsO0xpbmVCdWlsZGVyLnByb3RvdHlwZS5nZW9tZXRyeUZhY3Rvcnk9bnVsbDtMaW5lQnVpbGRlci5wcm90b3R5cGUucHRMb2NhdG9yPW51bGw7TGluZUJ1aWxkZXIucHJvdG90eXBlLmxpbmVFZGdlc0xpc3Q9bnVsbDtMaW5lQnVpbGRlci5wcm90b3R5cGUucmVzdWx0TGluZUxpc3Q9bnVsbDtMaW5lQnVpbGRlci5wcm90b3R5cGUuYnVpbGQ9ZnVuY3Rpb24ob3BDb2RlKXt0aGlzLmZpbmRDb3ZlcmVkTGluZUVkZ2VzKCk7dGhpcy5jb2xsZWN0TGluZXMob3BDb2RlKTt0aGlzLmJ1aWxkTGluZXMob3BDb2RlKTtyZXR1cm4gdGhpcy5yZXN1bHRMaW5lTGlzdDt9O0xpbmVCdWlsZGVyLnByb3RvdHlwZS5maW5kQ292ZXJlZExpbmVFZGdlcz1mdW5jdGlvbigpe2Zvcih2YXIgbm9kZWl0PXRoaXMub3AuZ2V0R3JhcGgoKS5nZXROb2RlcygpLml0ZXJhdG9yKCk7bm9kZWl0Lmhhc05leHQoKTspe3ZhciBub2RlPW5vZGVpdC5uZXh0KCk7bm9kZS5nZXRFZGdlcygpLmZpbmRDb3ZlcmVkTGluZUVkZ2VzKCk7fVxuZm9yKHZhciBpdD10aGlzLm9wLmdldEdyYXBoKCkuZ2V0RWRnZUVuZHMoKS5pdGVyYXRvcigpO2l0Lmhhc05leHQoKTspe3ZhciBkZT1pdC5uZXh0KCk7dmFyIGU9ZGUuZ2V0RWRnZSgpO2lmKGRlLmlzTGluZUVkZ2UoKSYmIWUuaXNDb3ZlcmVkU2V0KCkpe3ZhciBpc0NvdmVyZWQ9dGhpcy5vcC5pc0NvdmVyZWRCeUEoZGUuZ2V0Q29vcmRpbmF0ZSgpKTtlLnNldENvdmVyZWQoaXNDb3ZlcmVkKTt9fX07TGluZUJ1aWxkZXIucHJvdG90eXBlLmNvbGxlY3RMaW5lcz1mdW5jdGlvbihvcENvZGUpe2Zvcih2YXIgaXQ9dGhpcy5vcC5nZXRHcmFwaCgpLmdldEVkZ2VFbmRzKCkuaXRlcmF0b3IoKTtpdC5oYXNOZXh0KCk7KXt2YXIgZGU9aXQubmV4dCgpO3RoaXMuY29sbGVjdExpbmVFZGdlKGRlLG9wQ29kZSx0aGlzLmxpbmVFZGdlc0xpc3QpO3RoaXMuY29sbGVjdEJvdW5kYXJ5VG91Y2hFZGdlKGRlLG9wQ29kZSx0aGlzLmxpbmVFZGdlc0xpc3QpO319O0xpbmVCdWlsZGVyLnByb3RvdHlwZS5jb2xsZWN0TGluZUVkZ2U9ZnVuY3Rpb24oZGUsb3BDb2RlLGVkZ2VzKXt2YXIgbGFiZWw9ZGUuZ2V0TGFiZWwoKTt2YXIgZT1kZS5nZXRFZGdlKCk7aWYoZGUuaXNMaW5lRWRnZSgpKXtpZighZGUuaXNWaXNpdGVkKCkmJmpzdHMub3BlcmF0aW9uLm92ZXJsYXkuT3ZlcmxheU9wLmlzUmVzdWx0T2ZPcChsYWJlbCxvcENvZGUpJiYhZS5pc0NvdmVyZWQoKSl7ZWRnZXMuYWRkKGUpO2RlLnNldFZpc2l0ZWRFZGdlKHRydWUpO319fTtMaW5lQnVpbGRlci5wcm90b3R5cGUuY29sbGVjdEJvdW5kYXJ5VG91Y2hFZGdlPWZ1bmN0aW9uKGRlLG9wQ29kZSxlZGdlcyl7dmFyIGxhYmVsPWRlLmdldExhYmVsKCk7aWYoZGUuaXNMaW5lRWRnZSgpKVxucmV0dXJuO2lmKGRlLmlzVmlzaXRlZCgpKVxucmV0dXJuO2lmKGRlLmlzSW50ZXJpb3JBcmVhRWRnZSgpKVxucmV0dXJuO2lmKGRlLmdldEVkZ2UoKS5pc0luUmVzdWx0KCkpXG5yZXR1cm47QXNzZXJ0LmlzVHJ1ZSghKGRlLmlzSW5SZXN1bHQoKXx8ZGUuZ2V0U3ltKCkuaXNJblJlc3VsdCgpKXx8IWRlLmdldEVkZ2UoKS5pc0luUmVzdWx0KCkpO2lmKGpzdHMub3BlcmF0aW9uLm92ZXJsYXkuT3ZlcmxheU9wLmlzUmVzdWx0T2ZPcChsYWJlbCxvcENvZGUpJiZvcENvZGU9PT1qc3RzLm9wZXJhdGlvbi5vdmVybGF5Lk92ZXJsYXlPcC5JTlRFUlNFQ1RJT04pe2VkZ2VzLmFkZChkZS5nZXRFZGdlKCkpO2RlLnNldFZpc2l0ZWRFZGdlKHRydWUpO319O0xpbmVCdWlsZGVyLnByb3RvdHlwZS5idWlsZExpbmVzPWZ1bmN0aW9uKG9wQ29kZSl7Zm9yKHZhciBpdD10aGlzLmxpbmVFZGdlc0xpc3QuaXRlcmF0b3IoKTtpdC5oYXNOZXh0KCk7KXt2YXIgZT1pdC5uZXh0KCk7dmFyIGxhYmVsPWUuZ2V0TGFiZWwoKTt2YXIgbGluZT10aGlzLmdlb21ldHJ5RmFjdG9yeS5jcmVhdGVMaW5lU3RyaW5nKGUuZ2V0Q29vcmRpbmF0ZXMoKSk7dGhpcy5yZXN1bHRMaW5lTGlzdC5hZGQobGluZSk7ZS5zZXRJblJlc3VsdCh0cnVlKTt9fTtMaW5lQnVpbGRlci5wcm90b3R5cGUubGFiZWxJc29sYXRlZExpbmVzPWZ1bmN0aW9uKGVkZ2VzTGlzdCl7Zm9yKHZhciBpdD1lZGdlc0xpc3QuaXRlcmF0b3IoKTtpdC5oYXNOZXh0KCk7KXt2YXIgZT1pdC5uZXh0KCk7dmFyIGxhYmVsPWUuZ2V0TGFiZWwoKTtpZihlLmlzSXNvbGF0ZWQoKSl7aWYobGFiZWwuaXNOdWxsKDApKVxudGhpcy5sYWJlbElzb2xhdGVkTGluZShlLDApO2Vsc2VcbnRoaXMubGFiZWxJc29sYXRlZExpbmUoZSwxKTt9fX07TGluZUJ1aWxkZXIucHJvdG90eXBlLmxhYmVsSXNvbGF0ZWRMaW5lPWZ1bmN0aW9uKGUsdGFyZ2V0SW5kZXgpe3ZhciBsb2M9cHRMb2NhdG9yLmxvY2F0ZShlLmdldENvb3JkaW5hdGUoKSxvcC5nZXRBcmdHZW9tZXRyeSh0YXJnZXRJbmRleCkpO2UuZ2V0TGFiZWwoKS5zZXRMb2NhdGlvbih0YXJnZXRJbmRleCxsb2MpO307anN0cy5vcGVyYXRpb24ub3ZlcmxheS5MaW5lQnVpbGRlcj1MaW5lQnVpbGRlcjt9KSgpOyhmdW5jdGlvbigpe3ZhciBBcnJheUxpc3Q9amF2YXNjcmlwdC51dGlsLkFycmF5TGlzdDt2YXIgUG9pbnRCdWlsZGVyPWZ1bmN0aW9uKG9wLGdlb21ldHJ5RmFjdG9yeSxwdExvY2F0b3Ipe3RoaXMucmVzdWx0UG9pbnRMaXN0PW5ldyBBcnJheUxpc3QoKTt0aGlzLm9wPW9wO3RoaXMuZ2VvbWV0cnlGYWN0b3J5PWdlb21ldHJ5RmFjdG9yeTt9O1BvaW50QnVpbGRlci5wcm90b3R5cGUub3A9bnVsbDtQb2ludEJ1aWxkZXIucHJvdG90eXBlLmdlb21ldHJ5RmFjdG9yeT1udWxsO1BvaW50QnVpbGRlci5wcm90b3R5cGUucmVzdWx0UG9pbnRMaXN0PW51bGw7UG9pbnRCdWlsZGVyLnByb3RvdHlwZS5idWlsZD1mdW5jdGlvbihvcENvZGUpe3RoaXMuZXh0cmFjdE5vbkNvdmVyZWRSZXN1bHROb2RlcyhvcENvZGUpO3JldHVybiB0aGlzLnJlc3VsdFBvaW50TGlzdDt9O1BvaW50QnVpbGRlci5wcm90b3R5cGUuZXh0cmFjdE5vbkNvdmVyZWRSZXN1bHROb2Rlcz1mdW5jdGlvbihvcENvZGUpe2Zvcih2YXIgbm9kZWl0PXRoaXMub3AuZ2V0R3JhcGgoKS5nZXROb2RlcygpLml0ZXJhdG9yKCk7bm9kZWl0Lmhhc05leHQoKTspe3ZhciBuPW5vZGVpdC5uZXh0KCk7aWYobi5pc0luUmVzdWx0KCkpXG5jb250aW51ZTtpZihuLmlzSW5jaWRlbnRFZGdlSW5SZXN1bHQoKSlcbmNvbnRpbnVlO2lmKG4uZ2V0RWRnZXMoKS5nZXREZWdyZWUoKT09PTB8fG9wQ29kZT09PWpzdHMub3BlcmF0aW9uLm92ZXJsYXkuT3ZlcmxheU9wLklOVEVSU0VDVElPTil7dmFyIGxhYmVsPW4uZ2V0TGFiZWwoKTtpZihqc3RzLm9wZXJhdGlvbi5vdmVybGF5Lk92ZXJsYXlPcC5pc1Jlc3VsdE9mT3AobGFiZWwsb3BDb2RlKSl7dGhpcy5maWx0ZXJDb3ZlcmVkTm9kZVRvUG9pbnQobik7fX19fTtQb2ludEJ1aWxkZXIucHJvdG90eXBlLmZpbHRlckNvdmVyZWROb2RlVG9Qb2ludD1mdW5jdGlvbihuKXt2YXIgY29vcmQ9bi5nZXRDb29yZGluYXRlKCk7aWYoIXRoaXMub3AuaXNDb3ZlcmVkQnlMQShjb29yZCkpe3ZhciBwdD10aGlzLmdlb21ldHJ5RmFjdG9yeS5jcmVhdGVQb2ludChjb29yZCk7dGhpcy5yZXN1bHRQb2ludExpc3QuYWRkKHB0KTt9fTtqc3RzLm9wZXJhdGlvbi5vdmVybGF5LlBvaW50QnVpbGRlcj1Qb2ludEJ1aWxkZXI7fSkoKTsoZnVuY3Rpb24oKXt2YXIgUG9pbnRMb2NhdG9yPWpzdHMuYWxnb3JpdGhtLlBvaW50TG9jYXRvcjt2YXIgTG9jYXRpb249anN0cy5nZW9tLkxvY2F0aW9uO3ZhciBFZGdlTGlzdD1qc3RzLmdlb21ncmFwaC5FZGdlTGlzdDt2YXIgTGFiZWw9anN0cy5nZW9tZ3JhcGguTGFiZWw7dmFyIFBsYW5hckdyYXBoPWpzdHMuZ2VvbWdyYXBoLlBsYW5hckdyYXBoO3ZhciBQb3NpdGlvbj1qc3RzLmdlb21ncmFwaC5Qb3NpdGlvbjt2YXIgRWRnZU5vZGluZ1ZhbGlkYXRvcj1qc3RzLmdlb21ncmFwaC5FZGdlTm9kaW5nVmFsaWRhdG9yO3ZhciBHZW9tZXRyeUdyYXBoT3BlcmF0aW9uPWpzdHMub3BlcmF0aW9uLkdlb21ldHJ5R3JhcGhPcGVyYXRpb247dmFyIE92ZXJsYXlOb2RlRmFjdG9yeT1qc3RzLm9wZXJhdGlvbi5vdmVybGF5Lk92ZXJsYXlOb2RlRmFjdG9yeTt2YXIgUG9seWdvbkJ1aWxkZXI9anN0cy5vcGVyYXRpb24ub3ZlcmxheS5Qb2x5Z29uQnVpbGRlcjt2YXIgTGluZUJ1aWxkZXI9anN0cy5vcGVyYXRpb24ub3ZlcmxheS5MaW5lQnVpbGRlcjt2YXIgUG9pbnRCdWlsZGVyPWpzdHMub3BlcmF0aW9uLm92ZXJsYXkuUG9pbnRCdWlsZGVyO3ZhciBBc3NlcnQ9anN0cy51dGlsLkFzc2VydDt2YXIgQXJyYXlMaXN0PWphdmFzY3JpcHQudXRpbC5BcnJheUxpc3Q7anN0cy5vcGVyYXRpb24ub3ZlcmxheS5PdmVybGF5T3A9ZnVuY3Rpb24oZzAsZzEpe3RoaXMucHRMb2NhdG9yPW5ldyBQb2ludExvY2F0b3IoKTt0aGlzLmVkZ2VMaXN0PW5ldyBFZGdlTGlzdCgpO3RoaXMucmVzdWx0UG9seUxpc3Q9bmV3IEFycmF5TGlzdCgpO3RoaXMucmVzdWx0TGluZUxpc3Q9bmV3IEFycmF5TGlzdCgpO3RoaXMucmVzdWx0UG9pbnRMaXN0PW5ldyBBcnJheUxpc3QoKTtHZW9tZXRyeUdyYXBoT3BlcmF0aW9uLmNhbGwodGhpcyxnMCxnMSk7dGhpcy5ncmFwaD1uZXcgUGxhbmFyR3JhcGgobmV3IE92ZXJsYXlOb2RlRmFjdG9yeSgpKTt0aGlzLmdlb21GYWN0PWcwLmdldEZhY3RvcnkoKTt9O2pzdHMub3BlcmF0aW9uLm92ZXJsYXkuT3ZlcmxheU9wLnByb3RvdHlwZT1uZXcgR2VvbWV0cnlHcmFwaE9wZXJhdGlvbigpO2pzdHMub3BlcmF0aW9uLm92ZXJsYXkuT3ZlcmxheU9wLmNvbnN0cnVjdG9yPWpzdHMub3BlcmF0aW9uLm92ZXJsYXkuT3ZlcmxheU9wO2pzdHMub3BlcmF0aW9uLm92ZXJsYXkuT3ZlcmxheU9wLklOVEVSU0VDVElPTj0xO2pzdHMub3BlcmF0aW9uLm92ZXJsYXkuT3ZlcmxheU9wLlVOSU9OPTI7anN0cy5vcGVyYXRpb24ub3ZlcmxheS5PdmVybGF5T3AuRElGRkVSRU5DRT0zO2pzdHMub3BlcmF0aW9uLm92ZXJsYXkuT3ZlcmxheU9wLlNZTURJRkZFUkVOQ0U9NDtqc3RzLm9wZXJhdGlvbi5vdmVybGF5Lk92ZXJsYXlPcC5vdmVybGF5T3A9ZnVuY3Rpb24oZ2VvbTAsZ2VvbTEsb3BDb2RlKXt2YXIgZ292PW5ldyBqc3RzLm9wZXJhdGlvbi5vdmVybGF5Lk92ZXJsYXlPcChnZW9tMCxnZW9tMSk7dmFyIGdlb21Pdj1nb3YuZ2V0UmVzdWx0R2VvbWV0cnkob3BDb2RlKTtyZXR1cm4gZ2VvbU92O31cbmpzdHMub3BlcmF0aW9uLm92ZXJsYXkuT3ZlcmxheU9wLmlzUmVzdWx0T2ZPcD1mdW5jdGlvbihsYWJlbCxvcENvZGUpe2lmKGFyZ3VtZW50cy5sZW5ndGg9PT0zKXtyZXR1cm4ganN0cy5vcGVyYXRpb24ub3ZlcmxheS5PdmVybGF5T3AuaXNSZXN1bHRPZk9wMi5hcHBseSh0aGlzLGFyZ3VtZW50cyk7fVxudmFyIGxvYzA9bGFiZWwuZ2V0TG9jYXRpb24oMCk7dmFyIGxvYzE9bGFiZWwuZ2V0TG9jYXRpb24oMSk7cmV0dXJuIGpzdHMub3BlcmF0aW9uLm92ZXJsYXkuT3ZlcmxheU9wLmlzUmVzdWx0T2ZPcDIobG9jMCxsb2MxLG9wQ29kZSk7fVxuanN0cy5vcGVyYXRpb24ub3ZlcmxheS5PdmVybGF5T3AuaXNSZXN1bHRPZk9wMj1mdW5jdGlvbihsb2MwLGxvYzEsb3BDb2RlKXtpZihsb2MwPT1Mb2NhdGlvbi5CT1VOREFSWSlcbmxvYzA9TG9jYXRpb24uSU5URVJJT1I7aWYobG9jMT09TG9jYXRpb24uQk9VTkRBUlkpXG5sb2MxPUxvY2F0aW9uLklOVEVSSU9SO3N3aXRjaChvcENvZGUpe2Nhc2UganN0cy5vcGVyYXRpb24ub3ZlcmxheS5PdmVybGF5T3AuSU5URVJTRUNUSU9OOnJldHVybiBsb2MwPT1Mb2NhdGlvbi5JTlRFUklPUiYmbG9jMT09TG9jYXRpb24uSU5URVJJT1I7Y2FzZSBqc3RzLm9wZXJhdGlvbi5vdmVybGF5Lk92ZXJsYXlPcC5VTklPTjpyZXR1cm4gbG9jMD09TG9jYXRpb24uSU5URVJJT1J8fGxvYzE9PUxvY2F0aW9uLklOVEVSSU9SO2Nhc2UganN0cy5vcGVyYXRpb24ub3ZlcmxheS5PdmVybGF5T3AuRElGRkVSRU5DRTpyZXR1cm4gbG9jMD09TG9jYXRpb24uSU5URVJJT1ImJmxvYzEhPUxvY2F0aW9uLklOVEVSSU9SO2Nhc2UganN0cy5vcGVyYXRpb24ub3ZlcmxheS5PdmVybGF5T3AuU1lNRElGRkVSRU5DRTpyZXR1cm4obG9jMD09TG9jYXRpb24uSU5URVJJT1ImJmxvYzEhPUxvY2F0aW9uLklOVEVSSU9SKXx8KGxvYzAhPUxvY2F0aW9uLklOVEVSSU9SJiZsb2MxPT1Mb2NhdGlvbi5JTlRFUklPUik7fVxucmV0dXJuIGZhbHNlO31cbmpzdHMub3BlcmF0aW9uLm92ZXJsYXkuT3ZlcmxheU9wLnByb3RvdHlwZS5wdExvY2F0b3I9bnVsbDtqc3RzLm9wZXJhdGlvbi5vdmVybGF5Lk92ZXJsYXlPcC5wcm90b3R5cGUuZ2VvbUZhY3Q9bnVsbDtqc3RzLm9wZXJhdGlvbi5vdmVybGF5Lk92ZXJsYXlPcC5wcm90b3R5cGUucmVzdWx0R2VvbT1udWxsO2pzdHMub3BlcmF0aW9uLm92ZXJsYXkuT3ZlcmxheU9wLnByb3RvdHlwZS5ncmFwaD1udWxsO2pzdHMub3BlcmF0aW9uLm92ZXJsYXkuT3ZlcmxheU9wLnByb3RvdHlwZS5lZGdlTGlzdD1udWxsO2pzdHMub3BlcmF0aW9uLm92ZXJsYXkuT3ZlcmxheU9wLnByb3RvdHlwZS5yZXN1bHRQb2x5TGlzdD1udWxsO2pzdHMub3BlcmF0aW9uLm92ZXJsYXkuT3ZlcmxheU9wLnByb3RvdHlwZS5yZXN1bHRMaW5lTGlzdD1udWxsO2pzdHMub3BlcmF0aW9uLm92ZXJsYXkuT3ZlcmxheU9wLnByb3RvdHlwZS5yZXN1bHRQb2ludExpc3Q9bnVsbDtqc3RzLm9wZXJhdGlvbi5vdmVybGF5Lk92ZXJsYXlPcC5wcm90b3R5cGUuZ2V0UmVzdWx0R2VvbWV0cnk9ZnVuY3Rpb24oZnVuY0NvZGUpe3RoaXMuY29tcHV0ZU92ZXJsYXkoZnVuY0NvZGUpO3JldHVybiB0aGlzLnJlc3VsdEdlb207fVxuanN0cy5vcGVyYXRpb24ub3ZlcmxheS5PdmVybGF5T3AucHJvdG90eXBlLmdldEdyYXBoPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZ3JhcGg7fVxuanN0cy5vcGVyYXRpb24ub3ZlcmxheS5PdmVybGF5T3AucHJvdG90eXBlLmNvbXB1dGVPdmVybGF5PWZ1bmN0aW9uKG9wQ29kZSl7dGhpcy5jb3B5UG9pbnRzKDApO3RoaXMuY29weVBvaW50cygxKTt0aGlzLmFyZ1swXS5jb21wdXRlU2VsZk5vZGVzKHRoaXMubGksZmFsc2UpO3RoaXMuYXJnWzFdLmNvbXB1dGVTZWxmTm9kZXModGhpcy5saSxmYWxzZSk7dGhpcy5hcmdbMF0uY29tcHV0ZUVkZ2VJbnRlcnNlY3Rpb25zKHRoaXMuYXJnWzFdLHRoaXMubGksdHJ1ZSk7dmFyIGJhc2VTcGxpdEVkZ2VzPW5ldyBBcnJheUxpc3QoKTt0aGlzLmFyZ1swXS5jb21wdXRlU3BsaXRFZGdlcyhiYXNlU3BsaXRFZGdlcyk7dGhpcy5hcmdbMV0uY29tcHV0ZVNwbGl0RWRnZXMoYmFzZVNwbGl0RWRnZXMpO3ZhciBzcGxpdEVkZ2VzPWJhc2VTcGxpdEVkZ2VzO3RoaXMuaW5zZXJ0VW5pcXVlRWRnZXMoYmFzZVNwbGl0RWRnZXMpO3RoaXMuY29tcHV0ZUxhYmVsc0Zyb21EZXB0aHMoKTt0aGlzLnJlcGxhY2VDb2xsYXBzZWRFZGdlcygpO0VkZ2VOb2RpbmdWYWxpZGF0b3IuY2hlY2tWYWxpZCh0aGlzLmVkZ2VMaXN0LmdldEVkZ2VzKCkpO3RoaXMuZ3JhcGguYWRkRWRnZXModGhpcy5lZGdlTGlzdC5nZXRFZGdlcygpKTt0aGlzLmNvbXB1dGVMYWJlbGxpbmcoKTt0aGlzLmxhYmVsSW5jb21wbGV0ZU5vZGVzKCk7dGhpcy5maW5kUmVzdWx0QXJlYUVkZ2VzKG9wQ29kZSk7dGhpcy5jYW5jZWxEdXBsaWNhdGVSZXN1bHRFZGdlcygpO3ZhciBwb2x5QnVpbGRlcj1uZXcgUG9seWdvbkJ1aWxkZXIodGhpcy5nZW9tRmFjdCk7cG9seUJ1aWxkZXIuYWRkKHRoaXMuZ3JhcGgpO3RoaXMucmVzdWx0UG9seUxpc3Q9cG9seUJ1aWxkZXIuZ2V0UG9seWdvbnMoKTt2YXIgbGluZUJ1aWxkZXI9bmV3IExpbmVCdWlsZGVyKHRoaXMsdGhpcy5nZW9tRmFjdCx0aGlzLnB0TG9jYXRvcik7dGhpcy5yZXN1bHRMaW5lTGlzdD1saW5lQnVpbGRlci5idWlsZChvcENvZGUpO3ZhciBwb2ludEJ1aWxkZXI9bmV3IFBvaW50QnVpbGRlcih0aGlzLHRoaXMuZ2VvbUZhY3QsdGhpcy5wdExvY2F0b3IpO3RoaXMucmVzdWx0UG9pbnRMaXN0PXBvaW50QnVpbGRlci5idWlsZChvcENvZGUpO3RoaXMucmVzdWx0R2VvbT10aGlzLmNvbXB1dGVHZW9tZXRyeSh0aGlzLnJlc3VsdFBvaW50TGlzdCx0aGlzLnJlc3VsdExpbmVMaXN0LHRoaXMucmVzdWx0UG9seUxpc3Qsb3BDb2RlKTt9XG5qc3RzLm9wZXJhdGlvbi5vdmVybGF5Lk92ZXJsYXlPcC5wcm90b3R5cGUuaW5zZXJ0VW5pcXVlRWRnZXM9ZnVuY3Rpb24oZWRnZXMpe2Zvcih2YXIgaT1lZGdlcy5pdGVyYXRvcigpO2kuaGFzTmV4dCgpOyl7dmFyIGU9aS5uZXh0KCk7dGhpcy5pbnNlcnRVbmlxdWVFZGdlKGUpO319XG5qc3RzLm9wZXJhdGlvbi5vdmVybGF5Lk92ZXJsYXlPcC5wcm90b3R5cGUuaW5zZXJ0VW5pcXVlRWRnZT1mdW5jdGlvbihlKXt2YXIgZXhpc3RpbmdFZGdlPXRoaXMuZWRnZUxpc3QuZmluZEVxdWFsRWRnZShlKTtpZihleGlzdGluZ0VkZ2UhPT1udWxsKXt2YXIgZXhpc3RpbmdMYWJlbD1leGlzdGluZ0VkZ2UuZ2V0TGFiZWwoKTt2YXIgbGFiZWxUb01lcmdlPWUuZ2V0TGFiZWwoKTtpZighZXhpc3RpbmdFZGdlLmlzUG9pbnR3aXNlRXF1YWwoZSkpe2xhYmVsVG9NZXJnZT1uZXcgTGFiZWwoZS5nZXRMYWJlbCgpKTtsYWJlbFRvTWVyZ2UuZmxpcCgpO31cbnZhciBkZXB0aD1leGlzdGluZ0VkZ2UuZ2V0RGVwdGgoKTtpZihkZXB0aC5pc051bGwoKSl7ZGVwdGguYWRkKGV4aXN0aW5nTGFiZWwpO31cbmRlcHRoLmFkZChsYWJlbFRvTWVyZ2UpO2V4aXN0aW5nTGFiZWwubWVyZ2UobGFiZWxUb01lcmdlKTt9ZWxzZXt0aGlzLmVkZ2VMaXN0LmFkZChlKTt9fTtqc3RzLm9wZXJhdGlvbi5vdmVybGF5Lk92ZXJsYXlPcC5wcm90b3R5cGUuY29tcHV0ZUxhYmVsc0Zyb21EZXB0aHM9ZnVuY3Rpb24oKXtmb3IodmFyIGl0PXRoaXMuZWRnZUxpc3QuaXRlcmF0b3IoKTtpdC5oYXNOZXh0KCk7KXt2YXIgZT1pdC5uZXh0KCk7dmFyIGxibD1lLmdldExhYmVsKCk7dmFyIGRlcHRoPWUuZ2V0RGVwdGgoKTtpZighZGVwdGguaXNOdWxsKCkpe2RlcHRoLm5vcm1hbGl6ZSgpO2Zvcih2YXIgaT0wO2k8MjtpKyspe2lmKCFsYmwuaXNOdWxsKGkpJiZsYmwuaXNBcmVhKCkmJiFkZXB0aC5pc051bGwoaSkpe2lmKGRlcHRoLmdldERlbHRhKGkpPT0wKXtsYmwudG9MaW5lKGkpO31lbHNle0Fzc2VydC5pc1RydWUoIWRlcHRoLmlzTnVsbChpLFBvc2l0aW9uLkxFRlQpLCdkZXB0aCBvZiBMRUZUIHNpZGUgaGFzIG5vdCBiZWVuIGluaXRpYWxpemVkJyk7bGJsLnNldExvY2F0aW9uKGksUG9zaXRpb24uTEVGVCxkZXB0aC5nZXRMb2NhdGlvbihpLFBvc2l0aW9uLkxFRlQpKTtBc3NlcnQuaXNUcnVlKCFkZXB0aC5pc051bGwoaSxQb3NpdGlvbi5SSUdIVCksJ2RlcHRoIG9mIFJJR0hUIHNpZGUgaGFzIG5vdCBiZWVuIGluaXRpYWxpemVkJyk7bGJsLnNldExvY2F0aW9uKGksUG9zaXRpb24uUklHSFQsZGVwdGguZ2V0TG9jYXRpb24oaSxQb3NpdGlvbi5SSUdIVCkpO319fX19fVxuanN0cy5vcGVyYXRpb24ub3ZlcmxheS5PdmVybGF5T3AucHJvdG90eXBlLnJlcGxhY2VDb2xsYXBzZWRFZGdlcz1mdW5jdGlvbigpe3ZhciBuZXdFZGdlcz1uZXcgQXJyYXlMaXN0KCk7Zm9yKHZhciBpdD10aGlzLmVkZ2VMaXN0Lml0ZXJhdG9yKCk7aXQuaGFzTmV4dCgpOyl7dmFyIGU9aXQubmV4dCgpO2lmKGUuaXNDb2xsYXBzZWQoKSl7aXQucmVtb3ZlKCk7bmV3RWRnZXMuYWRkKGUuZ2V0Q29sbGFwc2VkRWRnZSgpKTt9fVxudGhpcy5lZGdlTGlzdC5hZGRBbGwobmV3RWRnZXMpO31cbmpzdHMub3BlcmF0aW9uLm92ZXJsYXkuT3ZlcmxheU9wLnByb3RvdHlwZS5jb3B5UG9pbnRzPWZ1bmN0aW9uKGFyZ0luZGV4KXtmb3IodmFyIGk9dGhpcy5hcmdbYXJnSW5kZXhdLmdldE5vZGVJdGVyYXRvcigpO2kuaGFzTmV4dCgpOyl7dmFyIGdyYXBoTm9kZT1pLm5leHQoKTt2YXIgbmV3Tm9kZT10aGlzLmdyYXBoLmFkZE5vZGUoZ3JhcGhOb2RlLmdldENvb3JkaW5hdGUoKSk7bmV3Tm9kZS5zZXRMYWJlbChhcmdJbmRleCxncmFwaE5vZGUuZ2V0TGFiZWwoKS5nZXRMb2NhdGlvbihhcmdJbmRleCkpO319XG5qc3RzLm9wZXJhdGlvbi5vdmVybGF5Lk92ZXJsYXlPcC5wcm90b3R5cGUuY29tcHV0ZUxhYmVsbGluZz1mdW5jdGlvbigpe2Zvcih2YXIgbm9kZWl0PXRoaXMuZ3JhcGguZ2V0Tm9kZXMoKS5pdGVyYXRvcigpO25vZGVpdC5oYXNOZXh0KCk7KXt2YXIgbm9kZT1ub2RlaXQubmV4dCgpO25vZGUuZ2V0RWRnZXMoKS5jb21wdXRlTGFiZWxsaW5nKHRoaXMuYXJnKTt9XG50aGlzLm1lcmdlU3ltTGFiZWxzKCk7dGhpcy51cGRhdGVOb2RlTGFiZWxsaW5nKCk7fVxuanN0cy5vcGVyYXRpb24ub3ZlcmxheS5PdmVybGF5T3AucHJvdG90eXBlLm1lcmdlU3ltTGFiZWxzPWZ1bmN0aW9uKCl7Zm9yKHZhciBub2RlaXQ9dGhpcy5ncmFwaC5nZXROb2RlcygpLml0ZXJhdG9yKCk7bm9kZWl0Lmhhc05leHQoKTspe3ZhciBub2RlPW5vZGVpdC5uZXh0KCk7bm9kZS5nZXRFZGdlcygpLm1lcmdlU3ltTGFiZWxzKCk7fX1cbmpzdHMub3BlcmF0aW9uLm92ZXJsYXkuT3ZlcmxheU9wLnByb3RvdHlwZS51cGRhdGVOb2RlTGFiZWxsaW5nPWZ1bmN0aW9uKCl7Zm9yKHZhciBub2RlaXQ9dGhpcy5ncmFwaC5nZXROb2RlcygpLml0ZXJhdG9yKCk7bm9kZWl0Lmhhc05leHQoKTspe3ZhciBub2RlPW5vZGVpdC5uZXh0KCk7dmFyIGxibD1ub2RlLmdldEVkZ2VzKCkuZ2V0TGFiZWwoKTtub2RlLmdldExhYmVsKCkubWVyZ2UobGJsKTt9fVxuanN0cy5vcGVyYXRpb24ub3ZlcmxheS5PdmVybGF5T3AucHJvdG90eXBlLmxhYmVsSW5jb21wbGV0ZU5vZGVzPWZ1bmN0aW9uKCl7dmFyIG5vZGVDb3VudD0wO2Zvcih2YXIgbmk9dGhpcy5ncmFwaC5nZXROb2RlcygpLml0ZXJhdG9yKCk7bmkuaGFzTmV4dCgpOyl7dmFyIG49bmkubmV4dCgpO3ZhciBsYWJlbD1uLmdldExhYmVsKCk7aWYobi5pc0lzb2xhdGVkKCkpe25vZGVDb3VudCsrO2lmKGxhYmVsLmlzTnVsbCgwKSlcbnRoaXMubGFiZWxJbmNvbXBsZXRlTm9kZShuLDApO2Vsc2VcbnRoaXMubGFiZWxJbmNvbXBsZXRlTm9kZShuLDEpO31cbm4uZ2V0RWRnZXMoKS51cGRhdGVMYWJlbGxpbmcobGFiZWwpO319O2pzdHMub3BlcmF0aW9uLm92ZXJsYXkuT3ZlcmxheU9wLnByb3RvdHlwZS5sYWJlbEluY29tcGxldGVOb2RlPWZ1bmN0aW9uKG4sdGFyZ2V0SW5kZXgpe3ZhciBsb2M9dGhpcy5wdExvY2F0b3IubG9jYXRlKG4uZ2V0Q29vcmRpbmF0ZSgpLHRoaXMuYXJnW3RhcmdldEluZGV4XS5nZXRHZW9tZXRyeSgpKTtuLmdldExhYmVsKCkuc2V0TG9jYXRpb24odGFyZ2V0SW5kZXgsbG9jKTt9O2pzdHMub3BlcmF0aW9uLm92ZXJsYXkuT3ZlcmxheU9wLnByb3RvdHlwZS5maW5kUmVzdWx0QXJlYUVkZ2VzPWZ1bmN0aW9uKG9wQ29kZSl7Zm9yKHZhciBpdD10aGlzLmdyYXBoLmdldEVkZ2VFbmRzKCkuaXRlcmF0b3IoKTtpdC5oYXNOZXh0KCk7KXt2YXIgZGU9aXQubmV4dCgpO3ZhciBsYWJlbD1kZS5nZXRMYWJlbCgpO2lmKGxhYmVsLmlzQXJlYSgpJiYhZGUuaXNJbnRlcmlvckFyZWFFZGdlKCkmJmpzdHMub3BlcmF0aW9uLm92ZXJsYXkuT3ZlcmxheU9wLmlzUmVzdWx0T2ZPcChsYWJlbC5nZXRMb2NhdGlvbigwLFBvc2l0aW9uLlJJR0hUKSxsYWJlbC5nZXRMb2NhdGlvbigxLFBvc2l0aW9uLlJJR0hUKSxvcENvZGUpKXtkZS5zZXRJblJlc3VsdCh0cnVlKTt9fX07anN0cy5vcGVyYXRpb24ub3ZlcmxheS5PdmVybGF5T3AucHJvdG90eXBlLmNhbmNlbER1cGxpY2F0ZVJlc3VsdEVkZ2VzPWZ1bmN0aW9uKCl7Zm9yKHZhciBpdD10aGlzLmdyYXBoLmdldEVkZ2VFbmRzKCkuaXRlcmF0b3IoKTtpdC5oYXNOZXh0KCk7KXt2YXIgZGU9aXQubmV4dCgpO3ZhciBzeW09ZGUuZ2V0U3ltKCk7aWYoZGUuaXNJblJlc3VsdCgpJiZzeW0uaXNJblJlc3VsdCgpKXtkZS5zZXRJblJlc3VsdChmYWxzZSk7c3ltLnNldEluUmVzdWx0KGZhbHNlKTt9fX07anN0cy5vcGVyYXRpb24ub3ZlcmxheS5PdmVybGF5T3AucHJvdG90eXBlLmlzQ292ZXJlZEJ5TEE9ZnVuY3Rpb24oY29vcmQpe2lmKHRoaXMuaXNDb3ZlcmVkKGNvb3JkLHRoaXMucmVzdWx0TGluZUxpc3QpKVxucmV0dXJuIHRydWU7aWYodGhpcy5pc0NvdmVyZWQoY29vcmQsdGhpcy5yZXN1bHRQb2x5TGlzdCkpXG5yZXR1cm4gdHJ1ZTtyZXR1cm4gZmFsc2U7fTtqc3RzLm9wZXJhdGlvbi5vdmVybGF5Lk92ZXJsYXlPcC5wcm90b3R5cGUuaXNDb3ZlcmVkQnlBPWZ1bmN0aW9uKGNvb3JkKXtpZih0aGlzLmlzQ292ZXJlZChjb29yZCx0aGlzLnJlc3VsdFBvbHlMaXN0KSlcbnJldHVybiB0cnVlO3JldHVybiBmYWxzZTt9O2pzdHMub3BlcmF0aW9uLm92ZXJsYXkuT3ZlcmxheU9wLnByb3RvdHlwZS5pc0NvdmVyZWQ9ZnVuY3Rpb24oY29vcmQsZ2VvbUxpc3Qpe2Zvcih2YXIgaXQ9Z2VvbUxpc3QuaXRlcmF0b3IoKTtpdC5oYXNOZXh0KCk7KXt2YXIgZ2VvbT1pdC5uZXh0KCk7dmFyIGxvYz10aGlzLnB0TG9jYXRvci5sb2NhdGUoY29vcmQsZ2VvbSk7aWYobG9jIT1Mb2NhdGlvbi5FWFRFUklPUilcbnJldHVybiB0cnVlO31cbnJldHVybiBmYWxzZTt9O2pzdHMub3BlcmF0aW9uLm92ZXJsYXkuT3ZlcmxheU9wLnByb3RvdHlwZS5jb21wdXRlR2VvbWV0cnk9ZnVuY3Rpb24ocmVzdWx0UG9pbnRMaXN0LHJlc3VsdExpbmVMaXN0LHJlc3VsdFBvbHlMaXN0LG9wY29kZSl7dmFyIGdlb21MaXN0PW5ldyBBcnJheUxpc3QoKTtnZW9tTGlzdC5hZGRBbGwocmVzdWx0UG9pbnRMaXN0KTtnZW9tTGlzdC5hZGRBbGwocmVzdWx0TGluZUxpc3QpO2dlb21MaXN0LmFkZEFsbChyZXN1bHRQb2x5TGlzdCk7cmV0dXJuIHRoaXMuZ2VvbUZhY3QuYnVpbGRHZW9tZXRyeShnZW9tTGlzdCk7fTtqc3RzLm9wZXJhdGlvbi5vdmVybGF5Lk92ZXJsYXlPcC5wcm90b3R5cGUuY3JlYXRlRW1wdHlSZXN1bHQ9ZnVuY3Rpb24ob3BDb2RlKXt2YXIgcmVzdWx0PW51bGw7c3dpdGNoKHJlc3VsdERpbWVuc2lvbihvcENvZGUsdGhpcy5hcmdbMF0uZ2V0R2VvbWV0cnkoKSx0aGlzLmFyZ1sxXS5nZXRHZW9tZXRyeSgpKSl7Y2FzZS0xOnJlc3VsdD1nZW9tRmFjdC5jcmVhdGVHZW9tZXRyeUNvbGxlY3Rpb24oKTticmVhaztjYXNlIDA6cmVzdWx0PWdlb21GYWN0LmNyZWF0ZVBvaW50KG51bGwpO2JyZWFrO2Nhc2UgMTpyZXN1bHQ9Z2VvbUZhY3QuY3JlYXRlTGluZVN0cmluZyhudWxsKTticmVhaztjYXNlIDI6cmVzdWx0PWdlb21GYWN0LmNyZWF0ZVBvbHlnb24obnVsbCxudWxsKTticmVhazt9XG5yZXR1cm4gcmVzdWx0O307anN0cy5vcGVyYXRpb24ub3ZlcmxheS5PdmVybGF5T3AucHJvdG90eXBlLnJlc3VsdERpbWVuc2lvbj1mdW5jdGlvbihvcENvZGUsZzAsZzEpe3ZhciBkaW0wPWcwLmdldERpbWVuc2lvbigpO3ZhciBkaW0xPWcxLmdldERpbWVuc2lvbigpO3ZhciByZXN1bHREaW1lbnNpb249LTE7c3dpdGNoKG9wQ29kZSl7Y2FzZSBqc3RzLm9wZXJhdGlvbi5vdmVybGF5Lk92ZXJsYXlPcC5JTlRFUlNFQ1RJT046cmVzdWx0RGltZW5zaW9uPU1hdGgubWluKGRpbTAsZGltMSk7YnJlYWs7Y2FzZSBqc3RzLm9wZXJhdGlvbi5vdmVybGF5Lk92ZXJsYXlPcC5VTklPTjpyZXN1bHREaW1lbnNpb249TWF0aC5tYXgoZGltMCxkaW0xKTticmVhaztjYXNlIGpzdHMub3BlcmF0aW9uLm92ZXJsYXkuT3ZlcmxheU9wLkRJRkZFUkVOQ0U6cmVzdWx0RGltZW5zaW9uPWRpbTA7YnJlYWs7Y2FzZSBqc3RzLm9wZXJhdGlvbi5vdmVybGF5Lk92ZXJsYXlPcC5TWU1ESUZGRVJFTkNFOnJlc3VsdERpbWVuc2lvbj1NYXRoLm1heChkaW0wLGRpbTEpO2JyZWFrO31cbnJldHVybiByZXN1bHREaW1lbnNpb247fTt9KSgpOyhmdW5jdGlvbigpe3ZhciBPdmVybGF5T3A9anN0cy5vcGVyYXRpb24ub3ZlcmxheS5PdmVybGF5T3A7dmFyIEdlb21ldHJ5U25hcHBlcj1qc3RzLm9wZXJhdGlvbi5vdmVybGF5LnNuYXAuR2VvbWV0cnlTbmFwcGVyO3ZhciBTbmFwT3ZlcmxheU9wPWZ1bmN0aW9uKGcxLGcyKXt0aGlzLmdlb209W107dGhpcy5nZW9tWzBdPWcxO3RoaXMuZ2VvbVsxXT1nMjt0aGlzLmNvbXB1dGVTbmFwVG9sZXJhbmNlKCk7fTtTbmFwT3ZlcmxheU9wLm92ZXJsYXlPcD1mdW5jdGlvbihnMCxnMSxvcENvZGUpe3ZhciBvcD1uZXcgU25hcE92ZXJsYXlPcChnMCxnMSk7cmV0dXJuIG9wLmdldFJlc3VsdEdlb21ldHJ5KG9wQ29kZSk7fTtTbmFwT3ZlcmxheU9wLmludGVyc2VjdGlvbj1mdW5jdGlvbihnMCxnMSl7cmV0dXJuIHRoaXMub3ZlcmxheU9wKGcwLGcxLE92ZXJsYXlPcC5JTlRFUlNFQ1RJT04pO307U25hcE92ZXJsYXlPcC51bmlvbj1mdW5jdGlvbihnMCxnMSl7cmV0dXJuIHRoaXMub3ZlcmxheU9wKGcwLGcxLE92ZXJsYXlPcC5VTklPTik7fTtTbmFwT3ZlcmxheU9wLmRpZmZlcmVuY2U9ZnVuY3Rpb24oZzAsZzEpe3JldHVybiBvdmVybGF5T3AoZzAsZzEsT3ZlcmxheU9wLkRJRkZFUkVOQ0UpO307U25hcE92ZXJsYXlPcC5zeW1EaWZmZXJlbmNlPWZ1bmN0aW9uKGcwLGcxKXtyZXR1cm4gb3ZlcmxheU9wKGcwLGcxLE92ZXJsYXlPcC5TWU1ESUZGRVJFTkNFKTt9O1NuYXBPdmVybGF5T3AucHJvdG90eXBlLmdlb209bnVsbDtTbmFwT3ZlcmxheU9wLnByb3RvdHlwZS5zbmFwVG9sZXJhbmNlPW51bGw7U25hcE92ZXJsYXlPcC5wcm90b3R5cGUuY29tcHV0ZVNuYXBUb2xlcmFuY2U9ZnVuY3Rpb24oKXt0aGlzLnNuYXBUb2xlcmFuY2U9R2VvbWV0cnlTbmFwcGVyLmNvbXB1dGVPdmVybGF5U25hcFRvbGVyYW5jZSh0aGlzLmdlb21bMF0sdGhpcy5nZW9tWzFdKTt9O1NuYXBPdmVybGF5T3AucHJvdG90eXBlLmdldFJlc3VsdEdlb21ldHJ5PWZ1bmN0aW9uKG9wQ29kZSl7dmFyIHByZXBHZW9tPXRoaXMuc25hcCh0aGlzLmdlb20pO3ZhciByZXN1bHQ9T3ZlcmxheU9wLm92ZXJsYXlPcChwcmVwR2VvbVswXSxwcmVwR2VvbVsxXSxvcENvZGUpO3JldHVybiB0aGlzLnByZXBhcmVSZXN1bHQocmVzdWx0KTt9O1NuYXBPdmVybGF5T3AucHJvdG90eXBlLnNlbGZTbmFwPWZ1bmN0aW9uKGdlb20pe3ZhciBzbmFwcGVyMD1uZXcgR2VvbWV0cnlTbmFwcGVyKGdlb20pO3ZhciBzbmFwR2VvbT1zbmFwcGVyMC5zbmFwVG8oZ2VvbSx0aGlzLnNuYXBUb2xlcmFuY2UpO3JldHVybiBzbmFwR2VvbTt9O1NuYXBPdmVybGF5T3AucHJvdG90eXBlLnNuYXA9ZnVuY3Rpb24oZ2VvbSl7dmFyIHJlbUdlb209Z2VvbTt2YXIgc25hcEdlb209R2VvbWV0cnlTbmFwcGVyLnNuYXAocmVtR2VvbVswXSxyZW1HZW9tWzFdLHRoaXMuc25hcFRvbGVyYW5jZSk7cmV0dXJuIHNuYXBHZW9tO307U25hcE92ZXJsYXlPcC5wcm90b3R5cGUucHJlcGFyZVJlc3VsdD1mdW5jdGlvbihnZW9tKXtyZXR1cm4gZ2VvbTt9O1NuYXBPdmVybGF5T3AucHJvdG90eXBlLmNicj1udWxsO1NuYXBPdmVybGF5T3AucHJvdG90eXBlLnJlbW92ZUNvbW1vbkJpdHM9ZnVuY3Rpb24oZ2VvbSl7dGhpcy5jYnI9bmV3IGpzdHMucHJlY2lzaW9uLkNvbW1vbkJpdHNSZW1vdmVyKCk7dGhpcy5jYnIuYWRkKHRoaXMuZ2VvbVswXSk7dGhpcy5jYnIuYWRkKHRoaXMuZ2VvbVsxXSk7dmFyIHJlbUdlb209W107cmVtR2VvbVswXT1jYnIucmVtb3ZlQ29tbW9uQml0cyh0aGlzLmdlb21bMF0uY2xvbmUoKSk7cmVtR2VvbVsxXT1jYnIucmVtb3ZlQ29tbW9uQml0cyh0aGlzLmdlb21bMV0uY2xvbmUoKSk7cmV0dXJuIHJlbUdlb207fTtqc3RzLm9wZXJhdGlvbi5vdmVybGF5LnNuYXAuU25hcE92ZXJsYXlPcD1TbmFwT3ZlcmxheU9wO30pKCk7anN0cy5nZW9tZ3JhcGguaW5kZXguRWRnZVNldEludGVyc2VjdG9yPWZ1bmN0aW9uKCl7fTtqc3RzLmdlb21ncmFwaC5pbmRleC5FZGdlU2V0SW50ZXJzZWN0b3IucHJvdG90eXBlLmNvbXB1dGVJbnRlcnNlY3Rpb25zPWZ1bmN0aW9uKGVkZ2VzLHNpLHRlc3RBbGxTZWdtZW50cyl7dGhyb3cgbmV3IGpzdHMuZXJyb3IuQWJzdHJhY3RNZXRob2RJbnZvY2F0aW9uRXJyb3IoKTt9O2pzdHMuZ2VvbWdyYXBoLmluZGV4LkVkZ2VTZXRJbnRlcnNlY3Rvci5wcm90b3R5cGUuY29tcHV0ZUludGVyc2VjdGlvbnMyPWZ1bmN0aW9uKGVkZ2VzMCxlZGdlczEsc2kpe3Rocm93IG5ldyBqc3RzLmVycm9yLkFic3RyYWN0TWV0aG9kSW52b2NhdGlvbkVycm9yKCk7fTtqc3RzLmdlb21ncmFwaC5pbmRleC5TaW1wbGVNQ1N3ZWVwTGluZUludGVyc2VjdG9yPWZ1bmN0aW9uKCl7dGhpcy5ldmVudHM9W107fTtqc3RzLmdlb21ncmFwaC5pbmRleC5TaW1wbGVNQ1N3ZWVwTGluZUludGVyc2VjdG9yLnByb3RvdHlwZT1uZXcganN0cy5nZW9tZ3JhcGguaW5kZXguRWRnZVNldEludGVyc2VjdG9yKCk7anN0cy5nZW9tZ3JhcGguaW5kZXguU2ltcGxlTUNTd2VlcExpbmVJbnRlcnNlY3Rvci5wcm90b3R5cGUuZXZlbnRzPW51bGw7anN0cy5nZW9tZ3JhcGguaW5kZXguU2ltcGxlTUNTd2VlcExpbmVJbnRlcnNlY3Rvci5wcm90b3R5cGUubk92ZXJsYXBzPTA7anN0cy5nZW9tZ3JhcGguaW5kZXguU2ltcGxlTUNTd2VlcExpbmVJbnRlcnNlY3Rvci5wcm90b3R5cGUuY29tcHV0ZUludGVyc2VjdGlvbnM9ZnVuY3Rpb24oZWRnZXMsc2ksdGVzdEFsbFNlZ21lbnRzKXtpZihzaSBpbnN0YW5jZW9mIGphdmFzY3JpcHQudXRpbC5MaXN0KXt0aGlzLmNvbXB1dGVJbnRlcnNlY3Rpb25zMi5hcHBseSh0aGlzLGFyZ3VtZW50cyk7cmV0dXJuO31cbmlmKHRlc3RBbGxTZWdtZW50cyl7dGhpcy5hZGRMaXN0MihlZGdlcyxudWxsKTt9ZWxzZXt0aGlzLmFkZExpc3QoZWRnZXMpO31cbnRoaXMuY29tcHV0ZUludGVyc2VjdGlvbnMzKHNpKTt9O2pzdHMuZ2VvbWdyYXBoLmluZGV4LlNpbXBsZU1DU3dlZXBMaW5lSW50ZXJzZWN0b3IucHJvdG90eXBlLmNvbXB1dGVJbnRlcnNlY3Rpb25zMj1mdW5jdGlvbihlZGdlczAsZWRnZXMxLHNpKXt0aGlzLmFkZExpc3QyKGVkZ2VzMCxlZGdlczApO3RoaXMuYWRkTGlzdDIoZWRnZXMxLGVkZ2VzMSk7dGhpcy5jb21wdXRlSW50ZXJzZWN0aW9uczMoc2kpO307anN0cy5nZW9tZ3JhcGguaW5kZXguU2ltcGxlTUNTd2VlcExpbmVJbnRlcnNlY3Rvci5wcm90b3R5cGUuYWRkPWZ1bmN0aW9uKGVkZ2UsZWRnZVNldCl7aWYoZWRnZSBpbnN0YW5jZW9mIGphdmFzY3JpcHQudXRpbC5MaXN0KXt0aGlzLmFkZExpc3QuYXBwbHkodGhpcyxhcmd1bWVudHMpO3JldHVybjt9XG52YXIgbWNlPWVkZ2UuZ2V0TW9ub3RvbmVDaGFpbkVkZ2UoKTt2YXIgc3RhcnRJbmRleD1tY2UuZ2V0U3RhcnRJbmRleGVzKCk7Zm9yKHZhciBpPTA7aTxzdGFydEluZGV4Lmxlbmd0aC0xO2krKyl7dmFyIG1jPW5ldyBqc3RzLmdlb21ncmFwaC5pbmRleC5Nb25vdG9uZUNoYWluKG1jZSxpKTt2YXIgaW5zZXJ0RXZlbnQ9bmV3IGpzdHMuZ2VvbWdyYXBoLmluZGV4LlN3ZWVwTGluZUV2ZW50KG1jZS5nZXRNaW5YKGkpLG1jLGVkZ2VTZXQpO3RoaXMuZXZlbnRzLnB1c2goaW5zZXJ0RXZlbnQpO3RoaXMuZXZlbnRzLnB1c2gobmV3IGpzdHMuZ2VvbWdyYXBoLmluZGV4LlN3ZWVwTGluZUV2ZW50KG1jZS5nZXRNYXhYKGkpLGluc2VydEV2ZW50KSk7fX07anN0cy5nZW9tZ3JhcGguaW5kZXguU2ltcGxlTUNTd2VlcExpbmVJbnRlcnNlY3Rvci5wcm90b3R5cGUuYWRkTGlzdD1mdW5jdGlvbihlZGdlcyl7Zm9yKHZhciBpPWVkZ2VzLml0ZXJhdG9yKCk7aS5oYXNOZXh0KCk7KXt2YXIgZWRnZT1pLm5leHQoKTt0aGlzLmFkZChlZGdlLGVkZ2UpO319O2pzdHMuZ2VvbWdyYXBoLmluZGV4LlNpbXBsZU1DU3dlZXBMaW5lSW50ZXJzZWN0b3IucHJvdG90eXBlLmFkZExpc3QyPWZ1bmN0aW9uKGVkZ2VzLGVkZ2VTZXQpe2Zvcih2YXIgaT1lZGdlcy5pdGVyYXRvcigpO2kuaGFzTmV4dCgpOyl7dmFyIGVkZ2U9aS5uZXh0KCk7dGhpcy5hZGQoZWRnZSxlZGdlU2V0KTt9fTtqc3RzLmdlb21ncmFwaC5pbmRleC5TaW1wbGVNQ1N3ZWVwTGluZUludGVyc2VjdG9yLnByb3RvdHlwZS5wcmVwYXJlRXZlbnRzPWZ1bmN0aW9uKCl7dGhpcy5ldmVudHMuc29ydChmdW5jdGlvbihhLGIpe3JldHVybiBhLmNvbXBhcmVUbyhiKTt9KTtmb3IodmFyIGk9MDtpPHRoaXMuZXZlbnRzLmxlbmd0aDtpKyspe3ZhciBldj10aGlzLmV2ZW50c1tpXTtpZihldi5pc0RlbGV0ZSgpKXtldi5nZXRJbnNlcnRFdmVudCgpLnNldERlbGV0ZUV2ZW50SW5kZXgoaSk7fX19O2pzdHMuZ2VvbWdyYXBoLmluZGV4LlNpbXBsZU1DU3dlZXBMaW5lSW50ZXJzZWN0b3IucHJvdG90eXBlLmNvbXB1dGVJbnRlcnNlY3Rpb25zMz1mdW5jdGlvbihzaSl7dGhpcy5uT3ZlcmxhcHM9MDt0aGlzLnByZXBhcmVFdmVudHMoKTtmb3IodmFyIGk9MDtpPHRoaXMuZXZlbnRzLmxlbmd0aDtpKyspe3ZhciBldj10aGlzLmV2ZW50c1tpXTtpZihldi5pc0luc2VydCgpKXt0aGlzLnByb2Nlc3NPdmVybGFwcyhpLGV2LmdldERlbGV0ZUV2ZW50SW5kZXgoKSxldixzaSk7fX19O2pzdHMuZ2VvbWdyYXBoLmluZGV4LlNpbXBsZU1DU3dlZXBMaW5lSW50ZXJzZWN0b3IucHJvdG90eXBlLnByb2Nlc3NPdmVybGFwcz1mdW5jdGlvbihzdGFydCxlbmQsZXYwLHNpKXt2YXIgbWMwPWV2MC5nZXRPYmplY3QoKTtmb3IodmFyIGk9c3RhcnQ7aTxlbmQ7aSsrKXt2YXIgZXYxPXRoaXMuZXZlbnRzW2ldO2lmKGV2MS5pc0luc2VydCgpKXt2YXIgbWMxPWV2MS5nZXRPYmplY3QoKTtpZighZXYwLmlzU2FtZUxhYmVsKGV2MSkpe21jMC5jb21wdXRlSW50ZXJzZWN0aW9ucyhtYzEsc2kpO3RoaXMubk92ZXJsYXBzKys7fX19fTtqc3RzLmFsZ29yaXRobS5sb2NhdGUuU2ltcGxlUG9pbnRJbkFyZWFMb2NhdG9yPWZ1bmN0aW9uKGdlb20pe3RoaXMuZ2VvbT1nZW9tO307anN0cy5hbGdvcml0aG0ubG9jYXRlLlNpbXBsZVBvaW50SW5BcmVhTG9jYXRvci5sb2NhdGU9ZnVuY3Rpb24ocCxnZW9tKXtpZihnZW9tLmlzRW1wdHkoKSlcbnJldHVybiBqc3RzLmdlb20uTG9jYXRpb24uRVhURVJJT1I7aWYoanN0cy5hbGdvcml0aG0ubG9jYXRlLlNpbXBsZVBvaW50SW5BcmVhTG9jYXRvci5jb250YWluc1BvaW50KHAsZ2VvbSkpXG5yZXR1cm4ganN0cy5nZW9tLkxvY2F0aW9uLklOVEVSSU9SO3JldHVybiBqc3RzLmdlb20uTG9jYXRpb24uRVhURVJJT1I7fTtqc3RzLmFsZ29yaXRobS5sb2NhdGUuU2ltcGxlUG9pbnRJbkFyZWFMb2NhdG9yLmNvbnRhaW5zUG9pbnQ9ZnVuY3Rpb24ocCxnZW9tKXtpZihnZW9tIGluc3RhbmNlb2YganN0cy5nZW9tLlBvbHlnb24pe3JldHVybiBqc3RzLmFsZ29yaXRobS5sb2NhdGUuU2ltcGxlUG9pbnRJbkFyZWFMb2NhdG9yLmNvbnRhaW5zUG9pbnRJblBvbHlnb24ocCxnZW9tKTt9ZWxzZSBpZihnZW9tIGluc3RhbmNlb2YganN0cy5nZW9tLkdlb21ldHJ5Q29sbGVjdGlvbnx8Z2VvbSBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5NdWx0aVBvaW50fHxnZW9tIGluc3RhbmNlb2YganN0cy5nZW9tLk11bHRpTGluZVN0cmluZ3x8Z2VvbSBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5NdWx0aVBvbHlnb24pe2Zvcih2YXIgaT0wO2k8Z2VvbS5nZW9tZXRyaWVzLmxlbmd0aDtpKyspe3ZhciBnMj1nZW9tLmdlb21ldHJpZXNbaV07aWYoZzIhPT1nZW9tKVxuaWYoanN0cy5hbGdvcml0aG0ubG9jYXRlLlNpbXBsZVBvaW50SW5BcmVhTG9jYXRvci5jb250YWluc1BvaW50KHAsZzIpKVxucmV0dXJuIHRydWU7fX1cbnJldHVybiBmYWxzZTt9O2pzdHMuYWxnb3JpdGhtLmxvY2F0ZS5TaW1wbGVQb2ludEluQXJlYUxvY2F0b3IuY29udGFpbnNQb2ludEluUG9seWdvbj1mdW5jdGlvbihwLHBvbHkpe2lmKHBvbHkuaXNFbXB0eSgpKVxucmV0dXJuIGZhbHNlO3ZhciBzaGVsbD1wb2x5LmdldEV4dGVyaW9yUmluZygpO2lmKCFqc3RzLmFsZ29yaXRobS5sb2NhdGUuU2ltcGxlUG9pbnRJbkFyZWFMb2NhdG9yLmlzUG9pbnRJblJpbmcocCxzaGVsbCkpXG5yZXR1cm4gZmFsc2U7Zm9yKHZhciBpPTA7aTxwb2x5LmdldE51bUludGVyaW9yUmluZygpO2krKyl7dmFyIGhvbGU9cG9seS5nZXRJbnRlcmlvclJpbmdOKGkpO2lmKGpzdHMuYWxnb3JpdGhtLmxvY2F0ZS5TaW1wbGVQb2ludEluQXJlYUxvY2F0b3IuaXNQb2ludEluUmluZyhwLGhvbGUpKVxucmV0dXJuIGZhbHNlO31cbnJldHVybiB0cnVlO307anN0cy5hbGdvcml0aG0ubG9jYXRlLlNpbXBsZVBvaW50SW5BcmVhTG9jYXRvci5pc1BvaW50SW5SaW5nPWZ1bmN0aW9uKHAscmluZyl7aWYoIXJpbmcuZ2V0RW52ZWxvcGVJbnRlcm5hbCgpLmludGVyc2VjdHMocCkpXG5yZXR1cm4gZmFsc2U7cmV0dXJuIGpzdHMuYWxnb3JpdGhtLkNHQWxnb3JpdGhtcy5pc1BvaW50SW5SaW5nKHAscmluZy5nZXRDb29yZGluYXRlcygpKTt9O2pzdHMuYWxnb3JpdGhtLmxvY2F0ZS5TaW1wbGVQb2ludEluQXJlYUxvY2F0b3IucHJvdG90eXBlLmdlb209bnVsbDtqc3RzLmFsZ29yaXRobS5sb2NhdGUuU2ltcGxlUG9pbnRJbkFyZWFMb2NhdG9yLnByb3RvdHlwZS5sb2NhdGU9ZnVuY3Rpb24ocCl7cmV0dXJuIGpzdHMuYWxnb3JpdGhtLmxvY2F0ZS5TaW1wbGVQb2ludEluQXJlYUxvY2F0b3IubG9jYXRlKHAsZ2VvbSk7fTsoZnVuY3Rpb24oKXt2YXIgTG9jYXRpb249anN0cy5nZW9tLkxvY2F0aW9uO3ZhciBQb3NpdGlvbj1qc3RzLmdlb21ncmFwaC5Qb3NpdGlvbjt2YXIgRWRnZUVuZFN0YXI9anN0cy5nZW9tZ3JhcGguRWRnZUVuZFN0YXI7dmFyIEFzc2VydD1qc3RzLnV0aWwuQXNzZXJ0O2pzdHMuZ2VvbWdyYXBoLkRpcmVjdGVkRWRnZVN0YXI9ZnVuY3Rpb24oKXtqc3RzLmdlb21ncmFwaC5FZGdlRW5kU3Rhci5jYWxsKHRoaXMpO307anN0cy5nZW9tZ3JhcGguRGlyZWN0ZWRFZGdlU3Rhci5wcm90b3R5cGU9bmV3IEVkZ2VFbmRTdGFyKCk7anN0cy5nZW9tZ3JhcGguRGlyZWN0ZWRFZGdlU3Rhci5jb25zdHJ1Y3Rvcj1qc3RzLmdlb21ncmFwaC5EaXJlY3RlZEVkZ2VTdGFyO2pzdHMuZ2VvbWdyYXBoLkRpcmVjdGVkRWRnZVN0YXIucHJvdG90eXBlLnJlc3VsdEFyZWFFZGdlTGlzdD1udWxsO2pzdHMuZ2VvbWdyYXBoLkRpcmVjdGVkRWRnZVN0YXIucHJvdG90eXBlLmxhYmVsPW51bGw7anN0cy5nZW9tZ3JhcGguRGlyZWN0ZWRFZGdlU3Rhci5wcm90b3R5cGUuaW5zZXJ0PWZ1bmN0aW9uKGVlKXt2YXIgZGU9ZWU7dGhpcy5pbnNlcnRFZGdlRW5kKGRlLGRlKTt9O2pzdHMuZ2VvbWdyYXBoLkRpcmVjdGVkRWRnZVN0YXIucHJvdG90eXBlLmdldExhYmVsPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMubGFiZWw7fTtqc3RzLmdlb21ncmFwaC5EaXJlY3RlZEVkZ2VTdGFyLnByb3RvdHlwZS5nZXRPdXRnb2luZ0RlZ3JlZT1mdW5jdGlvbigpe3ZhciBkZWdyZWU9MDtmb3IodmFyIGl0PXRoaXMuaXRlcmF0b3IoKTtpdC5oYXNOZXh0KCk7KXt2YXIgZGU9aXQubmV4dCgpO2lmKGRlLmlzSW5SZXN1bHQoKSlcbmRlZ3JlZSsrO31cbnJldHVybiBkZWdyZWU7fTtqc3RzLmdlb21ncmFwaC5EaXJlY3RlZEVkZ2VTdGFyLnByb3RvdHlwZS5nZXRPdXRnb2luZ0RlZ3JlZT1mdW5jdGlvbihlcil7dmFyIGRlZ3JlZT0wO2Zvcih2YXIgaXQ9dGhpcy5pdGVyYXRvcigpO2l0Lmhhc05leHQoKTspe3ZhciBkZT1pdC5uZXh0KCk7aWYoZGUuZ2V0RWRnZVJpbmcoKT09PWVyKVxuZGVncmVlKys7fVxucmV0dXJuIGRlZ3JlZTt9O2pzdHMuZ2VvbWdyYXBoLkRpcmVjdGVkRWRnZVN0YXIucHJvdG90eXBlLmdldFJpZ2h0bW9zdEVkZ2U9ZnVuY3Rpb24oKXt2YXIgZWRnZXM9dGhpcy5nZXRFZGdlcygpO3ZhciBzaXplPWVkZ2VzLnNpemUoKTtpZihzaXplPDEpXG5yZXR1cm4gbnVsbDt2YXIgZGUwPWVkZ2VzLmdldCgwKTtpZihzaXplPT0xKVxucmV0dXJuIGRlMDt2YXIgZGVMYXN0PWVkZ2VzLmdldChzaXplLTEpO3ZhciBxdWFkMD1kZTAuZ2V0UXVhZHJhbnQoKTt2YXIgcXVhZDE9ZGVMYXN0LmdldFF1YWRyYW50KCk7aWYoanN0cy5nZW9tZ3JhcGguUXVhZHJhbnQuaXNOb3J0aGVybihxdWFkMCkmJmpzdHMuZ2VvbWdyYXBoLlF1YWRyYW50LmlzTm9ydGhlcm4ocXVhZDEpKVxucmV0dXJuIGRlMDtlbHNlIGlmKCFqc3RzLmdlb21ncmFwaC5RdWFkcmFudC5pc05vcnRoZXJuKHF1YWQwKSYmIWpzdHMuZ2VvbWdyYXBoLlF1YWRyYW50LmlzTm9ydGhlcm4ocXVhZDEpKVxucmV0dXJuIGRlTGFzdDtlbHNle3ZhciBub25Ib3Jpem9udGFsRWRnZT1udWxsO2lmKGRlMC5nZXREeSgpIT0wKVxucmV0dXJuIGRlMDtlbHNlIGlmKGRlTGFzdC5nZXREeSgpIT0wKVxucmV0dXJuIGRlTGFzdDt9XG5Bc3NlcnQuc2hvdWxkTmV2ZXJSZWFjaEhlcmUoJ2ZvdW5kIHR3byBob3Jpem9udGFsIGVkZ2VzIGluY2lkZW50IG9uIG5vZGUnKTtyZXR1cm4gbnVsbDt9O2pzdHMuZ2VvbWdyYXBoLkRpcmVjdGVkRWRnZVN0YXIucHJvdG90eXBlLmNvbXB1dGVMYWJlbGxpbmc9ZnVuY3Rpb24oZ2VvbSl7RWRnZUVuZFN0YXIucHJvdG90eXBlLmNvbXB1dGVMYWJlbGxpbmcuY2FsbCh0aGlzLGdlb20pO3RoaXMubGFiZWw9bmV3IGpzdHMuZ2VvbWdyYXBoLkxhYmVsKExvY2F0aW9uLk5PTkUpO2Zvcih2YXIgaXQ9dGhpcy5pdGVyYXRvcigpO2l0Lmhhc05leHQoKTspe3ZhciBlZT1pdC5uZXh0KCk7dmFyIGU9ZWUuZ2V0RWRnZSgpO3ZhciBlTGFiZWw9ZS5nZXRMYWJlbCgpO2Zvcih2YXIgaT0wO2k8MjtpKyspe3ZhciBlTG9jPWVMYWJlbC5nZXRMb2NhdGlvbihpKTtpZihlTG9jPT09TG9jYXRpb24uSU5URVJJT1J8fGVMb2M9PT1Mb2NhdGlvbi5CT1VOREFSWSlcbnRoaXMubGFiZWwuc2V0TG9jYXRpb24oaSxMb2NhdGlvbi5JTlRFUklPUik7fX19O2pzdHMuZ2VvbWdyYXBoLkRpcmVjdGVkRWRnZVN0YXIucHJvdG90eXBlLm1lcmdlU3ltTGFiZWxzPWZ1bmN0aW9uKCl7Zm9yKHZhciBpdD10aGlzLml0ZXJhdG9yKCk7aXQuaGFzTmV4dCgpOyl7dmFyIGRlPWl0Lm5leHQoKTt2YXIgbGFiZWw9ZGUuZ2V0TGFiZWwoKTtsYWJlbC5tZXJnZShkZS5nZXRTeW0oKS5nZXRMYWJlbCgpKTt9fTtqc3RzLmdlb21ncmFwaC5EaXJlY3RlZEVkZ2VTdGFyLnByb3RvdHlwZS51cGRhdGVMYWJlbGxpbmc9ZnVuY3Rpb24obm9kZUxhYmVsKXtmb3IodmFyIGl0PXRoaXMuaXRlcmF0b3IoKTtpdC5oYXNOZXh0KCk7KXt2YXIgZGU9aXQubmV4dCgpO3ZhciBsYWJlbD1kZS5nZXRMYWJlbCgpO2xhYmVsLnNldEFsbExvY2F0aW9uc0lmTnVsbCgwLG5vZGVMYWJlbC5nZXRMb2NhdGlvbigwKSk7bGFiZWwuc2V0QWxsTG9jYXRpb25zSWZOdWxsKDEsbm9kZUxhYmVsLmdldExvY2F0aW9uKDEpKTt9fTtqc3RzLmdlb21ncmFwaC5EaXJlY3RlZEVkZ2VTdGFyLnByb3RvdHlwZS5nZXRSZXN1bHRBcmVhRWRnZXM9ZnVuY3Rpb24oKXtpZih0aGlzLnJlc3VsdEFyZWFFZGdlTGlzdCE9PW51bGwpXG5yZXR1cm4gdGhpcy5yZXN1bHRBcmVhRWRnZUxpc3Q7dGhpcy5yZXN1bHRBcmVhRWRnZUxpc3Q9bmV3IGphdmFzY3JpcHQudXRpbC5BcnJheUxpc3QoKTtmb3IodmFyIGl0PXRoaXMuaXRlcmF0b3IoKTtpdC5oYXNOZXh0KCk7KXt2YXIgZGU9aXQubmV4dCgpO2lmKGRlLmlzSW5SZXN1bHQoKXx8ZGUuZ2V0U3ltKCkuaXNJblJlc3VsdCgpKVxudGhpcy5yZXN1bHRBcmVhRWRnZUxpc3QuYWRkKGRlKTt9XG5yZXR1cm4gdGhpcy5yZXN1bHRBcmVhRWRnZUxpc3Q7fTtqc3RzLmdlb21ncmFwaC5EaXJlY3RlZEVkZ2VTdGFyLnByb3RvdHlwZS5TQ0FOTklOR19GT1JfSU5DT01JTkc9MTtqc3RzLmdlb21ncmFwaC5EaXJlY3RlZEVkZ2VTdGFyLnByb3RvdHlwZS5MSU5LSU5HX1RPX09VVEdPSU5HPTI7anN0cy5nZW9tZ3JhcGguRGlyZWN0ZWRFZGdlU3Rhci5wcm90b3R5cGUubGlua1Jlc3VsdERpcmVjdGVkRWRnZXM9ZnVuY3Rpb24oKXt0aGlzLmdldFJlc3VsdEFyZWFFZGdlcygpO3ZhciBmaXJzdE91dD1udWxsO3ZhciBpbmNvbWluZz1udWxsO3ZhciBzdGF0ZT10aGlzLlNDQU5OSU5HX0ZPUl9JTkNPTUlORztmb3IodmFyIGk9MDtpPHRoaXMucmVzdWx0QXJlYUVkZ2VMaXN0LnNpemUoKTtpKyspe3ZhciBuZXh0T3V0PXRoaXMucmVzdWx0QXJlYUVkZ2VMaXN0LmdldChpKTt2YXIgbmV4dEluPW5leHRPdXQuZ2V0U3ltKCk7aWYoIW5leHRPdXQuZ2V0TGFiZWwoKS5pc0FyZWEoKSlcbmNvbnRpbnVlO2lmKGZpcnN0T3V0PT09bnVsbCYmbmV4dE91dC5pc0luUmVzdWx0KCkpXG5maXJzdE91dD1uZXh0T3V0O3N3aXRjaChzdGF0ZSl7Y2FzZSB0aGlzLlNDQU5OSU5HX0ZPUl9JTkNPTUlORzppZighbmV4dEluLmlzSW5SZXN1bHQoKSlcbmNvbnRpbnVlO2luY29taW5nPW5leHRJbjtzdGF0ZT10aGlzLkxJTktJTkdfVE9fT1VUR09JTkc7YnJlYWs7Y2FzZSB0aGlzLkxJTktJTkdfVE9fT1VUR09JTkc6aWYoIW5leHRPdXQuaXNJblJlc3VsdCgpKVxuY29udGludWU7aW5jb21pbmcuc2V0TmV4dChuZXh0T3V0KTtzdGF0ZT10aGlzLlNDQU5OSU5HX0ZPUl9JTkNPTUlORzticmVhazt9fVxuaWYoc3RhdGU9PT10aGlzLkxJTktJTkdfVE9fT1VUR09JTkcpe2lmKGZpcnN0T3V0PT09bnVsbClcbnRocm93IG5ldyBqc3RzLmVycm9yLlRvcG9sb2d5RXJyb3IoJ25vIG91dGdvaW5nIGRpckVkZ2UgZm91bmQnLHRoaXMuZ2V0Q29vcmRpbmF0ZSgpKTtBc3NlcnQuaXNUcnVlKGZpcnN0T3V0LmlzSW5SZXN1bHQoKSwndW5hYmxlIHRvIGxpbmsgbGFzdCBpbmNvbWluZyBkaXJFZGdlJyk7aW5jb21pbmcuc2V0TmV4dChmaXJzdE91dCk7fX07anN0cy5nZW9tZ3JhcGguRGlyZWN0ZWRFZGdlU3Rhci5wcm90b3R5cGUubGlua01pbmltYWxEaXJlY3RlZEVkZ2VzPWZ1bmN0aW9uKGVyKXt2YXIgZmlyc3RPdXQ9bnVsbDt2YXIgaW5jb21pbmc9bnVsbDt2YXIgc3RhdGU9dGhpcy5TQ0FOTklOR19GT1JfSU5DT01JTkc7Zm9yKHZhciBpPXRoaXMucmVzdWx0QXJlYUVkZ2VMaXN0LnNpemUoKS0xO2k+PTA7aS0tKXt2YXIgbmV4dE91dD10aGlzLnJlc3VsdEFyZWFFZGdlTGlzdC5nZXQoaSk7dmFyIG5leHRJbj1uZXh0T3V0LmdldFN5bSgpO2lmKGZpcnN0T3V0PT09bnVsbCYmbmV4dE91dC5nZXRFZGdlUmluZygpPT09ZXIpXG5maXJzdE91dD1uZXh0T3V0O3N3aXRjaChzdGF0ZSl7Y2FzZSB0aGlzLlNDQU5OSU5HX0ZPUl9JTkNPTUlORzppZihuZXh0SW4uZ2V0RWRnZVJpbmcoKSE9ZXIpXG5jb250aW51ZTtpbmNvbWluZz1uZXh0SW47c3RhdGU9dGhpcy5MSU5LSU5HX1RPX09VVEdPSU5HO2JyZWFrO2Nhc2UgdGhpcy5MSU5LSU5HX1RPX09VVEdPSU5HOmlmKG5leHRPdXQuZ2V0RWRnZVJpbmcoKSE9PWVyKVxuY29udGludWU7aW5jb21pbmcuc2V0TmV4dE1pbihuZXh0T3V0KTtzdGF0ZT10aGlzLlNDQU5OSU5HX0ZPUl9JTkNPTUlORzticmVhazt9fVxuaWYoc3RhdGU9PT10aGlzLkxJTktJTkdfVE9fT1VUR09JTkcpe0Fzc2VydC5pc1RydWUoZmlyc3RPdXQhPT1udWxsLCdmb3VuZCBudWxsIGZvciBmaXJzdCBvdXRnb2luZyBkaXJFZGdlJyk7QXNzZXJ0LmlzVHJ1ZShmaXJzdE91dC5nZXRFZGdlUmluZygpPT09ZXIsJ3VuYWJsZSB0byBsaW5rIGxhc3QgaW5jb21pbmcgZGlyRWRnZScpO2luY29taW5nLnNldE5leHRNaW4oZmlyc3RPdXQpO319O2pzdHMuZ2VvbWdyYXBoLkRpcmVjdGVkRWRnZVN0YXIucHJvdG90eXBlLmxpbmtBbGxEaXJlY3RlZEVkZ2VzPWZ1bmN0aW9uKCl7dGhpcy5nZXRFZGdlcygpO3ZhciBwcmV2T3V0PW51bGw7dmFyIGZpcnN0SW49bnVsbDtmb3IodmFyIGk9dGhpcy5lZGdlTGlzdC5zaXplKCktMTtpPj0wO2ktLSl7dmFyIG5leHRPdXQ9dGhpcy5lZGdlTGlzdC5nZXQoaSk7dmFyIG5leHRJbj1uZXh0T3V0LmdldFN5bSgpO2lmKGZpcnN0SW49PT1udWxsKVxuZmlyc3RJbj1uZXh0SW47aWYocHJldk91dCE9PW51bGwpXG5uZXh0SW4uc2V0TmV4dChwcmV2T3V0KTtwcmV2T3V0PW5leHRPdXQ7fVxuZmlyc3RJbi5zZXROZXh0KHByZXZPdXQpO307anN0cy5nZW9tZ3JhcGguRGlyZWN0ZWRFZGdlU3Rhci5wcm90b3R5cGUuZmluZENvdmVyZWRMaW5lRWRnZXM9ZnVuY3Rpb24oKXt2YXIgc3RhcnRMb2M9TG9jYXRpb24uTk9ORTtmb3IodmFyIGl0PXRoaXMuaXRlcmF0b3IoKTtpdC5oYXNOZXh0KCk7KXt2YXIgbmV4dE91dD1pdC5uZXh0KCk7dmFyIG5leHRJbj1uZXh0T3V0LmdldFN5bSgpO2lmKCFuZXh0T3V0LmlzTGluZUVkZ2UoKSl7aWYobmV4dE91dC5pc0luUmVzdWx0KCkpe3N0YXJ0TG9jPUxvY2F0aW9uLklOVEVSSU9SO2JyZWFrO31cbmlmKG5leHRJbi5pc0luUmVzdWx0KCkpe3N0YXJ0TG9jPUxvY2F0aW9uLkVYVEVSSU9SO2JyZWFrO319fVxuaWYoc3RhcnRMb2M9PT1Mb2NhdGlvbi5OT05FKVxucmV0dXJuO3ZhciBjdXJyTG9jPXN0YXJ0TG9jO2Zvcih2YXIgaXQ9dGhpcy5pdGVyYXRvcigpO2l0Lmhhc05leHQoKTspe3ZhciBuZXh0T3V0PWl0Lm5leHQoKTt2YXIgbmV4dEluPW5leHRPdXQuZ2V0U3ltKCk7aWYobmV4dE91dC5pc0xpbmVFZGdlKCkpe25leHRPdXQuZ2V0RWRnZSgpLnNldENvdmVyZWQoY3VyckxvYz09PUxvY2F0aW9uLklOVEVSSU9SKTt9ZWxzZXtpZihuZXh0T3V0LmlzSW5SZXN1bHQoKSlcbmN1cnJMb2M9TG9jYXRpb24uRVhURVJJT1I7aWYobmV4dEluLmlzSW5SZXN1bHQoKSlcbmN1cnJMb2M9TG9jYXRpb24uSU5URVJJT1I7fX19O2pzdHMuZ2VvbWdyYXBoLkRpcmVjdGVkRWRnZVN0YXIucHJvdG90eXBlLmNvbXB1dGVEZXB0aHM9ZnVuY3Rpb24oZGUpe2lmKGFyZ3VtZW50cy5sZW5ndGg9PT0yKXt0aGlzLmNvbXB1dGVEZXB0aHMyLmFwcGx5KHRoaXMsYXJndW1lbnRzKTtyZXR1cm47fVxudmFyIGVkZ2VJbmRleD10aGlzLmZpbmRJbmRleChkZSk7dmFyIGxhYmVsPWRlLmdldExhYmVsKCk7dmFyIHN0YXJ0RGVwdGg9ZGUuZ2V0RGVwdGgoUG9zaXRpb24uTEVGVCk7dmFyIHRhcmdldExhc3REZXB0aD1kZS5nZXREZXB0aChQb3NpdGlvbi5SSUdIVCk7dmFyIG5leHREZXB0aD10aGlzLmNvbXB1dGVEZXB0aHMyKGVkZ2VJbmRleCsxLHRoaXMuZWRnZUxpc3Quc2l6ZSgpLHN0YXJ0RGVwdGgpO3ZhciBsYXN0RGVwdGg9dGhpcy5jb21wdXRlRGVwdGhzMigwLGVkZ2VJbmRleCxuZXh0RGVwdGgpO2lmKGxhc3REZXB0aCE9dGFyZ2V0TGFzdERlcHRoKVxudGhyb3cgbmV3IGpzdHMuZXJyb3IuVG9wb2xvZ3lFcnJvcignZGVwdGggbWlzbWF0Y2ggYXQgJytcbmRlLmdldENvb3JkaW5hdGUoKSk7fTtqc3RzLmdlb21ncmFwaC5EaXJlY3RlZEVkZ2VTdGFyLnByb3RvdHlwZS5jb21wdXRlRGVwdGhzMj1mdW5jdGlvbihzdGFydEluZGV4LGVuZEluZGV4LHN0YXJ0RGVwdGgpe3ZhciBjdXJyRGVwdGg9c3RhcnREZXB0aDtmb3IodmFyIGk9c3RhcnRJbmRleDtpPGVuZEluZGV4O2krKyl7dmFyIG5leHREZT10aGlzLmVkZ2VMaXN0LmdldChpKTt2YXIgbGFiZWw9bmV4dERlLmdldExhYmVsKCk7bmV4dERlLnNldEVkZ2VEZXB0aHMoUG9zaXRpb24uUklHSFQsY3VyckRlcHRoKTtjdXJyRGVwdGg9bmV4dERlLmdldERlcHRoKFBvc2l0aW9uLkxFRlQpO31cbnJldHVybiBjdXJyRGVwdGg7fTt9KSgpO2pzdHMuYWxnb3JpdGhtLkNlbnRyb2lkTGluZT1mdW5jdGlvbigpe3RoaXMuY2VudFN1bT1uZXcganN0cy5nZW9tLkNvb3JkaW5hdGUoKTt9O2pzdHMuYWxnb3JpdGhtLkNlbnRyb2lkTGluZS5wcm90b3R5cGUuY2VudFN1bT1udWxsO2pzdHMuYWxnb3JpdGhtLkNlbnRyb2lkTGluZS5wcm90b3R5cGUudG90YWxMZW5ndGg9MC4wO2pzdHMuYWxnb3JpdGhtLkNlbnRyb2lkTGluZS5wcm90b3R5cGUuYWRkPWZ1bmN0aW9uKGdlb20pe2lmKGdlb20gaW5zdGFuY2VvZiBBcnJheSl7dGhpcy5hZGQyLmFwcGx5KHRoaXMsYXJndW1lbnRzKTtyZXR1cm47fVxuaWYoZ2VvbSBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5MaW5lU3RyaW5nKXt0aGlzLmFkZChnZW9tLmdldENvb3JkaW5hdGVzKCkpO31lbHNlIGlmKGdlb20gaW5zdGFuY2VvZiBqc3RzLmdlb20uUG9seWdvbil7dmFyIHBvbHk9Z2VvbTt0aGlzLmFkZChwb2x5LmdldEV4dGVyaW9yUmluZygpLmdldENvb3JkaW5hdGVzKCkpO2Zvcih2YXIgaT0wO2k8cG9seS5nZXROdW1JbnRlcmlvclJpbmcoKTtpKyspe3RoaXMuYWRkKHBvbHkuZ2V0SW50ZXJpb3JSaW5nTihpKS5nZXRDb29yZGluYXRlcygpKTt9fWVsc2UgaWYoZ2VvbSBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5HZW9tZXRyeUNvbGxlY3Rpb258fGdlb20gaW5zdGFuY2VvZiBqc3RzLmdlb20uTXVsdGlQb2ludHx8Z2VvbSBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5NdWx0aUxpbmVTdHJpbmd8fGdlb20gaW5zdGFuY2VvZiBqc3RzLmdlb20uTXVsdGlQb2x5Z29uKXt2YXIgZ2M9Z2VvbTtmb3IodmFyIGk9MDtpPGdjLmdldE51bUdlb21ldHJpZXMoKTtpKyspe3RoaXMuYWRkKGdjLmdldEdlb21ldHJ5TihpKSk7fX19O2pzdHMuYWxnb3JpdGhtLkNlbnRyb2lkTGluZS5wcm90b3R5cGUuZ2V0Q2VudHJvaWQ9ZnVuY3Rpb24oKXt2YXIgY2VudD1uZXcganN0cy5nZW9tLkNvb3JkaW5hdGUoKTtjZW50Lng9dGhpcy5jZW50U3VtLngvdGhpcy50b3RhbExlbmd0aDtjZW50Lnk9dGhpcy5jZW50U3VtLnkvdGhpcy50b3RhbExlbmd0aDtyZXR1cm4gY2VudDt9O2pzdHMuYWxnb3JpdGhtLkNlbnRyb2lkTGluZS5wcm90b3R5cGUuYWRkMj1mdW5jdGlvbihwdHMpe2Zvcih2YXIgaT0wO2k8cHRzLmxlbmd0aC0xO2krKyl7dmFyIHNlZ21lbnRMZW49cHRzW2ldLmRpc3RhbmNlKHB0c1tpKzFdKTt0aGlzLnRvdGFsTGVuZ3RoKz1zZWdtZW50TGVuO3ZhciBtaWR4PShwdHNbaV0ueCtwdHNbaSsxXS54KS8yO3RoaXMuY2VudFN1bS54Kz1zZWdtZW50TGVuKm1pZHg7dmFyIG1pZHk9KHB0c1tpXS55K3B0c1tpKzFdLnkpLzI7dGhpcy5jZW50U3VtLnkrPXNlZ21lbnRMZW4qbWlkeTt9fTtqc3RzLmluZGV4LkludGVydmFsU2l6ZT1mdW5jdGlvbigpe307anN0cy5pbmRleC5JbnRlcnZhbFNpemUuTUlOX0JJTkFSWV9FWFBPTkVOVD0tNTA7anN0cy5pbmRleC5JbnRlcnZhbFNpemUuaXNaZXJvV2lkdGg9ZnVuY3Rpb24obWluLG1heCl7dmFyIHdpZHRoPW1heC1taW47aWYod2lkdGg9PT0wLjApe3JldHVybiB0cnVlO31cbnZhciBtYXhBYnMsc2NhbGVkSW50ZXJ2YWwsbGV2ZWw7bWF4QWJzPU1hdGgubWF4KE1hdGguYWJzKG1pbiksTWF0aC5hYnMobWF4KSk7c2NhbGVkSW50ZXJ2YWw9d2lkdGgvbWF4QWJzO2xldmVsPWpzdHMuaW5kZXguRG91YmxlQml0cy5leHBvbmVudChzY2FsZWRJbnRlcnZhbCk7cmV0dXJuIGxldmVsPD1qc3RzLmluZGV4LkludGVydmFsU2l6ZS5NSU5fQklOQVJZX0VYUE9ORU5UO307anN0cy5nZW9tZ3JhcGguaW5kZXguU2ltcGxlRWRnZVNldEludGVyc2VjdG9yPWZ1bmN0aW9uKCl7fTtqc3RzLmdlb21ncmFwaC5pbmRleC5TaW1wbGVFZGdlU2V0SW50ZXJzZWN0b3IucHJvdG90eXBlPW5ldyBqc3RzLmdlb21ncmFwaC5pbmRleC5FZGdlU2V0SW50ZXJzZWN0b3IoKTtqc3RzLmdlb21ncmFwaC5pbmRleC5TaW1wbGVFZGdlU2V0SW50ZXJzZWN0b3IucHJvdG90eXBlLm5PdmVybGFwcz0wO2pzdHMuZ2VvbWdyYXBoLmluZGV4LlNpbXBsZUVkZ2VTZXRJbnRlcnNlY3Rvci5wcm90b3R5cGUuY29tcHV0ZUludGVyc2VjdGlvbnM9ZnVuY3Rpb24oZWRnZXMsc2ksdGVzdEFsbFNlZ21lbnRzKXtpZihzaSBpbnN0YW5jZW9mIGphdmFzY3JpcHQudXRpbC5MaXN0KXt0aGlzLmNvbXB1dGVJbnRlcnNlY3Rpb25zMi5hcHBseSh0aGlzLGFyZ3VtZW50cyk7cmV0dXJuO31cbnRoaXMubk92ZXJsYXBzPTA7Zm9yKHZhciBpMD1lZGdlcy5pdGVyYXRvcigpO2kwLmhhc05leHQoKTspe3ZhciBlZGdlMD1pMC5uZXh0KCk7Zm9yKHZhciBpMT1lZGdlcy5pdGVyYXRvcigpO2kxLmhhc05leHQoKTspe3ZhciBlZGdlMT1pMS5uZXh0KCk7aWYodGVzdEFsbFNlZ21lbnRzfHxlZGdlMCE9ZWRnZTEpXG50aGlzLmNvbXB1dGVJbnRlcnNlY3RzKGVkZ2UwLGVkZ2UxLHNpKTt9fX07anN0cy5nZW9tZ3JhcGguaW5kZXguU2ltcGxlRWRnZVNldEludGVyc2VjdG9yLnByb3RvdHlwZS5jb21wdXRlSW50ZXJzZWN0aW9uczI9ZnVuY3Rpb24oZWRnZXMwLGVkZ2VzMSxzaSl7dGhpcy5uT3ZlcmxhcHM9MDtmb3IodmFyIGkwPWVkZ2VzMC5pdGVyYXRvcigpO2kwLmhhc05leHQoKTspe3ZhciBlZGdlMD1pMC5uZXh0KCk7Zm9yKHZhciBpMT1lZGdlczEuaXRlcmF0b3IoKTtpMS5oYXNOZXh0KCk7KXt2YXIgZWRnZTE9aTEubmV4dCgpO3RoaXMuY29tcHV0ZUludGVyc2VjdHMoZWRnZTAsZWRnZTEsc2kpO319fTtqc3RzLmdlb21ncmFwaC5pbmRleC5TaW1wbGVFZGdlU2V0SW50ZXJzZWN0b3IucHJvdG90eXBlLmNvbXB1dGVJbnRlcnNlY3RzPWZ1bmN0aW9uKGUwLGUxLHNpKXt2YXIgcHRzMD1lMC5nZXRDb29yZGluYXRlcygpO3ZhciBwdHMxPWUxLmdldENvb3JkaW5hdGVzKCk7dmFyIGkwLGkxO2ZvcihpMD0wO2kwPHB0czAubGVuZ3RoLTE7aTArKyl7Zm9yKGkxPTA7aTE8cHRzMS5sZW5ndGgtMTtpMSsrKXtzaS5hZGRJbnRlcnNlY3Rpb25zKGUwLGkwLGUxLGkxKTt9fX07anN0cy5nZW9tZ3JhcGguRWRnZT1mdW5jdGlvbihwdHMsbGFiZWwpe3RoaXMucHRzPXB0czt0aGlzLmxhYmVsPWxhYmVsO3RoaXMuZWlMaXN0PW5ldyBqc3RzLmdlb21ncmFwaC5FZGdlSW50ZXJzZWN0aW9uTGlzdCh0aGlzKTt0aGlzLmRlcHRoPW5ldyBqc3RzLmdlb21ncmFwaC5EZXB0aCgpO307anN0cy5nZW9tZ3JhcGguRWRnZS5wcm90b3R5cGU9bmV3IGpzdHMuZ2VvbWdyYXBoLkdyYXBoQ29tcG9uZW50KCk7anN0cy5nZW9tZ3JhcGguRWRnZS5jb25zdHJ1Y3Rvcj1qc3RzLmdlb21ncmFwaC5FZGdlO2pzdHMuZ2VvbWdyYXBoLkVkZ2UudXBkYXRlSU09ZnVuY3Rpb24obGFiZWwsaW0pe2ltLnNldEF0TGVhc3RJZlZhbGlkKGxhYmVsLmdldExvY2F0aW9uKDAsanN0cy5nZW9tZ3JhcGguUG9zaXRpb24uT04pLGxhYmVsLmdldExvY2F0aW9uKDEsanN0cy5nZW9tZ3JhcGguUG9zaXRpb24uT04pLDEpO2lmKGxhYmVsLmlzQXJlYSgpKXtpbS5zZXRBdExlYXN0SWZWYWxpZChsYWJlbC5nZXRMb2NhdGlvbigwLGpzdHMuZ2VvbWdyYXBoLlBvc2l0aW9uLkxFRlQpLGxhYmVsLmdldExvY2F0aW9uKDEsanN0cy5nZW9tZ3JhcGguUG9zaXRpb24uTEVGVCksMik7aW0uc2V0QXRMZWFzdElmVmFsaWQobGFiZWwuZ2V0TG9jYXRpb24oMCxqc3RzLmdlb21ncmFwaC5Qb3NpdGlvbi5SSUdIVCksbGFiZWwuZ2V0TG9jYXRpb24oMSxqc3RzLmdlb21ncmFwaC5Qb3NpdGlvbi5SSUdIVCksMik7fX07anN0cy5nZW9tZ3JhcGguRWRnZS5wcm90b3R5cGUucHRzPW51bGw7anN0cy5nZW9tZ3JhcGguRWRnZS5wcm90b3R5cGUuZW52PW51bGw7anN0cy5nZW9tZ3JhcGguRWRnZS5wcm90b3R5cGUubmFtZT1udWxsO2pzdHMuZ2VvbWdyYXBoLkVkZ2UucHJvdG90eXBlLm1jZT1udWxsO2pzdHMuZ2VvbWdyYXBoLkVkZ2UucHJvdG90eXBlLl9pc0lzb2xhdGVkPXRydWU7anN0cy5nZW9tZ3JhcGguRWRnZS5wcm90b3R5cGUuZGVwdGg9bnVsbDtqc3RzLmdlb21ncmFwaC5FZGdlLnByb3RvdHlwZS5kZXB0aERlbHRhPTA7anN0cy5nZW9tZ3JhcGguRWRnZS5wcm90b3R5cGUuZWlMaXN0PW51bGw7anN0cy5nZW9tZ3JhcGguRWRnZS5wcm90b3R5cGUuZ2V0TnVtUG9pbnRzPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMucHRzLmxlbmd0aDt9O2pzdHMuZ2VvbWdyYXBoLkVkZ2UucHJvdG90eXBlLmdldEVudmVsb3BlPWZ1bmN0aW9uKCl7aWYodGhpcy5lbnY9PT1udWxsKXt0aGlzLmVudj1uZXcganN0cy5nZW9tLkVudmVsb3BlKCk7Zm9yKHZhciBpPTA7aTx0aGlzLnB0cy5sZW5ndGg7aSsrKXt0aGlzLmVudi5leHBhbmRUb0luY2x1ZGUocHRzW2ldKTt9fVxucmV0dXJuIGVudjt9O2pzdHMuZ2VvbWdyYXBoLkVkZ2UucHJvdG90eXBlLmdldERlcHRoPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZGVwdGg7fTtqc3RzLmdlb21ncmFwaC5FZGdlLnByb3RvdHlwZS5nZXREZXB0aERlbHRhPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZGVwdGhEZWx0YTt9O2pzdHMuZ2VvbWdyYXBoLkVkZ2UucHJvdG90eXBlLnNldERlcHRoRGVsdGE9ZnVuY3Rpb24oZGVwdGhEZWx0YSl7dGhpcy5kZXB0aERlbHRhPWRlcHRoRGVsdGE7fTtqc3RzLmdlb21ncmFwaC5FZGdlLnByb3RvdHlwZS5nZXRDb29yZGluYXRlcz1mdW5jdGlvbigpe3JldHVybiB0aGlzLnB0czt9O2pzdHMuZ2VvbWdyYXBoLkVkZ2UucHJvdG90eXBlLmdldENvb3JkaW5hdGU9ZnVuY3Rpb24oaSl7aWYoaT09PXVuZGVmaW5lZCl7aWYodGhpcy5wdHMubGVuZ3RoPjApe3JldHVybiB0aGlzLnB0c1swXTt9ZWxzZXtyZXR1cm4gbnVsbDt9fVxucmV0dXJuIHRoaXMucHRzW2ldO307anN0cy5nZW9tZ3JhcGguRWRnZS5wcm90b3R5cGUuaXNDbG9zZWQ9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5wdHNbMF0uZXF1YWxzKHRoaXMucHRzW3RoaXMucHRzLmxlbmd0aC0xXSk7fTtqc3RzLmdlb21ncmFwaC5FZGdlLnByb3RvdHlwZS5zZXRJc29sYXRlZD1mdW5jdGlvbihpc0lzb2xhdGVkKXt0aGlzLl9pc0lzb2xhdGVkPWlzSXNvbGF0ZWQ7fTtqc3RzLmdlb21ncmFwaC5FZGdlLnByb3RvdHlwZS5pc0lzb2xhdGVkPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2lzSXNvbGF0ZWQ7fTtqc3RzLmdlb21ncmFwaC5FZGdlLnByb3RvdHlwZS5hZGRJbnRlcnNlY3Rpb25zPWZ1bmN0aW9uKGxpLHNlZ21lbnRJbmRleCxnZW9tSW5kZXgpe2Zvcih2YXIgaT0wO2k8bGkuZ2V0SW50ZXJzZWN0aW9uTnVtKCk7aSsrKXt0aGlzLmFkZEludGVyc2VjdGlvbihsaSxzZWdtZW50SW5kZXgsZ2VvbUluZGV4LGkpO319O2pzdHMuZ2VvbWdyYXBoLkVkZ2UucHJvdG90eXBlLmFkZEludGVyc2VjdGlvbj1mdW5jdGlvbihsaSxzZWdtZW50SW5kZXgsZ2VvbUluZGV4LGludEluZGV4KXt2YXIgaW50UHQ9bmV3IGpzdHMuZ2VvbS5Db29yZGluYXRlKGxpLmdldEludGVyc2VjdGlvbihpbnRJbmRleCkpO3ZhciBub3JtYWxpemVkU2VnbWVudEluZGV4PXNlZ21lbnRJbmRleDt2YXIgZGlzdD1saS5nZXRFZGdlRGlzdGFuY2UoZ2VvbUluZGV4LGludEluZGV4KTt2YXIgbmV4dFNlZ0luZGV4PW5vcm1hbGl6ZWRTZWdtZW50SW5kZXgrMTtpZihuZXh0U2VnSW5kZXg8dGhpcy5wdHMubGVuZ3RoKXt2YXIgbmV4dFB0PXRoaXMucHRzW25leHRTZWdJbmRleF07aWYoaW50UHQuZXF1YWxzMkQobmV4dFB0KSl7bm9ybWFsaXplZFNlZ21lbnRJbmRleD1uZXh0U2VnSW5kZXg7ZGlzdD0wLjA7fX1cbnZhciBlaT10aGlzLmVpTGlzdC5hZGQoaW50UHQsbm9ybWFsaXplZFNlZ21lbnRJbmRleCxkaXN0KTt9O2pzdHMuZ2VvbWdyYXBoLkVkZ2UucHJvdG90eXBlLmdldE1heGltdW1TZWdtZW50SW5kZXg9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5wdHMubGVuZ3RoLTE7fTtqc3RzLmdlb21ncmFwaC5FZGdlLnByb3RvdHlwZS5nZXRFZGdlSW50ZXJzZWN0aW9uTGlzdD1mdW5jdGlvbigpe3JldHVybiB0aGlzLmVpTGlzdDt9O2pzdHMuZ2VvbWdyYXBoLkVkZ2UucHJvdG90eXBlLmdldE1vbm90b25lQ2hhaW5FZGdlPWZ1bmN0aW9uKCl7aWYodGhpcy5tY2U9PW51bGwpe3RoaXMubWNlPW5ldyBqc3RzLmdlb21ncmFwaC5pbmRleC5Nb25vdG9uZUNoYWluRWRnZSh0aGlzKTt9XG5yZXR1cm4gdGhpcy5tY2U7fTtqc3RzLmdlb21ncmFwaC5FZGdlLnByb3RvdHlwZS5pc0Nsb3NlZD1mdW5jdGlvbigpXG57cmV0dXJuIHRoaXMucHRzWzBdLmVxdWFscyh0aGlzLnB0c1t0aGlzLnB0cy5sZW5ndGgtMV0pO307anN0cy5nZW9tZ3JhcGguRWRnZS5wcm90b3R5cGUuaXNDb2xsYXBzZWQ9ZnVuY3Rpb24oKVxue2lmKCF0aGlzLmxhYmVsLmlzQXJlYSgpKXJldHVybiBmYWxzZTtpZih0aGlzLnB0cy5sZW5ndGghPTMpcmV0dXJuIGZhbHNlO2lmKHRoaXMucHRzWzBdLmVxdWFscyh0aGlzLnB0c1syXSkpcmV0dXJuIHRydWU7cmV0dXJuIGZhbHNlO307anN0cy5nZW9tZ3JhcGguRWRnZS5wcm90b3R5cGUuZ2V0Q29sbGFwc2VkRWRnZT1mdW5jdGlvbigpXG57dmFyIG5ld1B0cz1bXTtuZXdQdHNbMF09dGhpcy5wdHNbMF07bmV3UHRzWzFdPXRoaXMucHRzWzFdO3ZhciBuZXdlPW5ldyBqc3RzLmdlb21ncmFwaC5FZGdlKG5ld1B0cyxqc3RzLmdlb21ncmFwaC5MYWJlbC50b0xpbmVMYWJlbCh0aGlzLmxhYmVsKSk7cmV0dXJuIG5ld2U7fTtqc3RzLmdlb21ncmFwaC5FZGdlLnByb3RvdHlwZS5jb21wdXRlSU09ZnVuY3Rpb24oaW0pe2pzdHMuZ2VvbWdyYXBoLkVkZ2UudXBkYXRlSU0odGhpcy5sYWJlbCxpbSk7fTtqc3RzLmdlb21ncmFwaC5FZGdlLnByb3RvdHlwZS5pc1BvaW50d2lzZUVxdWFsPWZ1bmN0aW9uKGUpXG57aWYodGhpcy5wdHMubGVuZ3RoIT1lLnB0cy5sZW5ndGgpcmV0dXJuIGZhbHNlO2Zvcih2YXIgaT0wO2k8dGhpcy5wdHMubGVuZ3RoO2krKyl7aWYoIXRoaXMucHRzW2ldLmVxdWFsczJEKGUucHRzW2ldKSl7cmV0dXJuIGZhbHNlO319XG5yZXR1cm4gdHJ1ZTt9O2pzdHMubm9kaW5nLk9jdGFudD1mdW5jdGlvbigpe3Rocm93IGpzdHMuZXJyb3IuQWJzdHJhY3RNZXRob2RJbnZvY2F0aW9uRXJyb3IoKTt9O2pzdHMubm9kaW5nLk9jdGFudC5vY3RhbnQ9ZnVuY3Rpb24oZHgsZHkpe2lmKGR4IGluc3RhbmNlb2YganN0cy5nZW9tLkNvb3JkaW5hdGUpe3JldHVybiBqc3RzLm5vZGluZy5PY3RhbnQub2N0YW50Mi5hcHBseSh0aGlzLGFyZ3VtZW50cyk7fVxuaWYoZHg9PT0wLjAmJmR5PT09MC4wKVxudGhyb3cgbmV3IGpzdHMuZXJyb3IuSWxsZWdhbEFyZ3VtZW50RXJyb3IoJ0Nhbm5vdCBjb21wdXRlIHRoZSBvY3RhbnQgZm9yIHBvaW50ICggJytkeCsnLCAnK2R5KycgKScpO3ZhciBhZHg9TWF0aC5hYnMoZHgpO3ZhciBhZHk9TWF0aC5hYnMoZHkpO2lmKGR4Pj0wKXtpZihkeT49MCl7aWYoYWR4Pj1hZHkpXG5yZXR1cm4gMDtlbHNlXG5yZXR1cm4gMTt9XG5lbHNle2lmKGFkeD49YWR5KVxucmV0dXJuIDc7ZWxzZVxucmV0dXJuIDY7fX1cbmVsc2V7aWYoZHk+PTApe2lmKGFkeD49YWR5KVxucmV0dXJuIDM7ZWxzZVxucmV0dXJuIDI7fVxuZWxzZXtpZihhZHg+PWFkeSlcbnJldHVybiA0O2Vsc2VcbnJldHVybiA1O319fTtqc3RzLm5vZGluZy5PY3RhbnQub2N0YW50Mj1mdW5jdGlvbihwMCxwMSl7dmFyIGR4PXAxLngtcDAueDt2YXIgZHk9cDEueS1wMC55O2lmKGR4PT09MC4wJiZkeT09PTAuMClcbnRocm93IG5ldyBqc3RzLmVycm9yLklsbGVnYWxBcmd1bWVudEVycm9yKCdDYW5ub3QgY29tcHV0ZSB0aGUgb2N0YW50IGZvciB0d28gaWRlbnRpY2FsIHBvaW50cyAnK3AwKTtyZXR1cm4ganN0cy5ub2RpbmcuT2N0YW50Lm9jdGFudChkeCxkeSk7fTtqc3RzLm9wZXJhdGlvbi51bmlvbi5VbmlvbkludGVyYWN0aW5nPWZ1bmN0aW9uKGcwLGcxKXt0aGlzLmcwPWcwO3RoaXMuZzE9ZzE7dGhpcy5nZW9tRmFjdG9yeT1nMC5nZXRGYWN0b3J5KCk7dGhpcy5pbnRlcmFjdHMwPVtdO3RoaXMuaW50ZXJhY3RzMT1bXTt9O2pzdHMub3BlcmF0aW9uLnVuaW9uLlVuaW9uSW50ZXJhY3RpbmcudW5pb249ZnVuY3Rpb24oZzAsZzEpe3ZhciB1dWU9bmV3IGpzdHMub3BlcmF0aW9uLnVuaW9uLlVuaW9uSW50ZXJhY3RpbmcoZzAsZzEpO3JldHVybiB1dWUudW5pb24oKTt9O2pzdHMub3BlcmF0aW9uLnVuaW9uLlVuaW9uSW50ZXJhY3RpbmcucHJvdG90eXBlLmdlb21GYWN0b3J5PW51bGw7anN0cy5vcGVyYXRpb24udW5pb24uVW5pb25JbnRlcmFjdGluZy5wcm90b3R5cGUuZzA9bnVsbDtqc3RzLm9wZXJhdGlvbi51bmlvbi5VbmlvbkludGVyYWN0aW5nLnByb3RvdHlwZS5nMT1udWxsO2pzdHMub3BlcmF0aW9uLnVuaW9uLlVuaW9uSW50ZXJhY3RpbmcucHJvdG90eXBlLmludGVyYWN0czA9bnVsbDtqc3RzLm9wZXJhdGlvbi51bmlvbi5VbmlvbkludGVyYWN0aW5nLnByb3RvdHlwZS5pbnRlcmFjdHMxPW51bGw7anN0cy5vcGVyYXRpb24udW5pb24uVW5pb25JbnRlcmFjdGluZy5wcm90b3R5cGUudW5pb249ZnVuY3Rpb24oKXt0aGlzLmNvbXB1dGVJbnRlcmFjdGluZygpO3ZhciBpbnQwPXRoaXMuZXh0cmFjdEVsZW1lbnRzKHRoaXMuZzAsdGhpcy5pbnRlcmFjdHMwLHRydWUpO3ZhciBpbnQxPXRoaXMuZXh0cmFjdEVsZW1lbnRzKHRoaXMuZzEsdGhpcy5pbnRlcmFjdHMxLHRydWUpO2lmKGludDAuaXNFbXB0eSgpfHxpbnQxLmlzRW1wdHkoKSl7fVxudmFyIHVuaW9uPWluMC51bmlvbihpbnQxKTt2YXIgZGlzam9pbnQwPXRoaXMuZXh0cmFjdEVsZW1lbnRzKHRoaXMuZzAsdGhpcy5pbnRlcmFjdHMwLGZhbHNlKTt2YXIgZGlzam9pbnQxPXRoaXMuZXh0cmFjdEVsZW1lbnRzKHRoaXMuZzEsdGhpcy5pbnRlcmFjdHMxLGZhbHNlKTt2YXIgb3ZlcmFsbFVuaW9uPWpzdHMuZ2VvbS51dGlsLkdlb21ldHJ5Q29tYmluZXIuY29tYmluZSh1bmlvbixkaXNqb2ludDAsZGlzam9pbnQxKTtyZXR1cm4gb3ZlcmFsbFVuaW9uO307anN0cy5vcGVyYXRpb24udW5pb24uVW5pb25JbnRlcmFjdGluZy5wcm90b3R5cGUuYnVmZmVyVW5pb249ZnVuY3Rpb24oZzAsZzEpe3ZhciBmYWN0b3J5PWcwLmdldEZhY3RvcnkoKTt2YXIgZ0NvbGw9ZmFjdG9yeS5jcmVhdGVHZW9tZXRyeUNvbGxlY3Rpb24oW2cwLGcxXSk7dmFyIHVuaW9uQWxsPWdDb2xsLmJ1ZmZlcigwLjApO3JldHVybiB1bmlvbkFsbDt9O2pzdHMub3BlcmF0aW9uLnVuaW9uLlVuaW9uSW50ZXJhY3RpbmcucHJvdG90eXBlLmNvbXB1dGVJbnRlcmFjdGluZz1mdW5jdGlvbihlbGVtMCl7aWYoIWVsZW0wKXtmb3IodmFyIGk9MCxsPXRoaXMuZzAuZ2V0TnVtR2VvbWV0cmllcygpO2k8bDtpKyspe3ZhciBlbGVtPXRoaXMuZzAuZ2V0R2VvbWV0cnlOKGkpO3RoaXMuaW50ZXJhY3RzMFtpXT10aGlzLmNvbXB1dGVJbnRlcmFjdGluZyhlbGVtKTt9fVxuZWxzZXt2YXIgaW50ZXJhY3RzV2l0aEFueT1mYWxzZTtmb3IodmFyIGk9MCxsPWcxLmdldE51bUdlb21ldHJpZXMoKTtpPGw7aSsrKXt2YXIgZWxlbTE9dGhpcy5nMS5nZXRHZW9tZXRyeU4oaSk7dmFyIGludGVyYWN0cz1lbGVtMS5nZXRFbnZlbG9wZUludGVybmFsKCkuaW50ZXJzZWN0cyhlbGVtMC5nZXRFbnZlbG9wZUludGVybmFsKCkpO2lmKGludGVyYWN0cyl7dGhpcy5pbnRlcmFjdHMxW2ldPXRydWU7aW50ZXJhY3RzV2l0aEFueT10cnVlO319XG5yZXR1cm4gaW50ZXJhY3RzV2l0aEFueTt9fTtqc3RzLm9wZXJhdGlvbi51bmlvbi5VbmlvbkludGVyYWN0aW5nLnByb3RvdHlwZS5leHRyYWN0RWxlbWVudHM9ZnVuY3Rpb24oZ2VvbSxpbnRlcmFjdHMsaXNJbnRlcmFjdGluZyl7dmFyIGV4dHJhY3RlZEdlb21zPVtdO2Zvcih2YXIgaT0wLGw9Z2VvbS5nZXROdW1HZW9tZXRyaWVzKCk7aTxsO2krKyl7dmFyIGVsZW09Z2VvbS5nZXRHZW9tZXRyeU4oaSk7aWYoaW50ZXJhY3RzW2ldPT09aXNJbnRlcmFjdGluZyl7ZXh0cmFjdGVkR2VvbXMucHVzaChlbGVtKTt9fVxucmV0dXJuIHRoaXMuZ2VvbUZhY3RvcnkuYnVpbGRHZW9tZXRyeShleHRyYWN0ZWRHZW9tcyk7fTtqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlRyaWFuZ2xlUHJlZGljYXRlPWZ1bmN0aW9uKCl7fTtqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlRyaWFuZ2xlUHJlZGljYXRlLmlzSW5DaXJjbGVOb25Sb2J1c3Q9ZnVuY3Rpb24oYSxiLGMscCl7dmFyIGlzSW5DaXJjbGU9KGEueCphLngrYS55KmEueSkqanN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5UcmlhbmdsZVByZWRpY2F0ZS50cmlBcmVhKGIsYyxwKS1cbihiLngqYi54K2IueSpiLnkpKmpzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuVHJpYW5nbGVQcmVkaWNhdGUudHJpQXJlYShhLGMscCkrXG4oYy54KmMueCtjLnkqYy55KSpqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlRyaWFuZ2xlUHJlZGljYXRlLnRyaUFyZWEoYSxiLHApLVxuKHAueCpwLngrcC55KnAueSkqanN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5UcmlhbmdsZVByZWRpY2F0ZS50cmlBcmVhKGEsYixjKT4wO3JldHVybiBpc0luQ2lyY2xlO307anN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5UcmlhbmdsZVByZWRpY2F0ZS5pc0luQ2lyY2xlTm9ybWFsaXplZD1mdW5jdGlvbihhLGIsYyxwKXt2YXIgYWR4LGFkeSxiZHgsYmR5LGNkeCxjZHksYWJkZXQsYmNkZXQsY2FkZXQsYWxpZnQsYmxpZnQsY2xpZnQsZGlzYzthZHg9YS54LXAueDthZHk9YS55LXAueTtiZHg9Yi54LXAueDtiZHk9Yi55LXAueTtjZHg9Yy54LXAueDtjZHk9Yy55LXAueTthYmRldD1hZHgqYmR5LWJkeCphZHk7YmNkZXQ9YmR4KmNkeS1jZHgqYmR5O2NhZGV0PWNkeCphZHktYWR4KmNkeTthbGlmdD1hZHgqYWR4K2FkeSphZHk7YmxpZnQ9YmR4KmJkeCtiZHkqYmR5O2NsaWZ0PWNkeCpjZHgrY2R5KmNkeTtkaXNjPWFsaWZ0KmJjZGV0K2JsaWZ0KmNhZGV0K2NsaWZ0KmFiZGV0O3JldHVybiBkaXNjPjA7fTtqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlRyaWFuZ2xlUHJlZGljYXRlLnRyaUFyZWE9ZnVuY3Rpb24oYSxiLGMpe3JldHVybihiLngtYS54KSooYy55LWEueSktKGIueS1hLnkpKihjLngtYS54KTt9O2pzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuVHJpYW5nbGVQcmVkaWNhdGUuaXNJbkNpcmNsZVJvYnVzdD1mdW5jdGlvbihhLGIsYyxwKXtyZXR1cm4ganN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5UcmlhbmdsZVByZWRpY2F0ZS5pc0luQ2lyY2xlTm9ybWFsaXplZChhLGIsYyxwKTt9O2pzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuVHJpYW5nbGVQcmVkaWNhdGUuaXNJbkNpcmNsZUREU2xvdz1mdW5jdGlvbihhLGIsYyxwKXt2YXIgcHgscHksYXgsYXksYngsYnksY3gsY3ksYVRlcm0sYlRlcm0sY1Rlcm0scFRlcm0sc3VtLGlzSW5DaXJjbGU7cHg9anN0cy5tYXRoLkRELnZhbHVlT2YocC54KTtweT1qc3RzLm1hdGguREQudmFsdWVPZihwLnkpO2F4PWpzdHMubWF0aC5ERC52YWx1ZU9mKGEueCk7YXk9anN0cy5tYXRoLkRELnZhbHVlT2YoYS55KTtieD1qc3RzLm1hdGguREQudmFsdWVPZihiLngpO2J5PWpzdHMubWF0aC5ERC52YWx1ZU9mKGIueSk7Y3g9anN0cy5tYXRoLkRELnZhbHVlT2YoYy54KTtjeT1qc3RzLm1hdGguREQudmFsdWVPZihjLnkpO2FUZXJtPShheC5tdWx0aXBseShheCkuYWRkKGF5Lm11bHRpcGx5KGF5KSkpLm11bHRpcGx5KGpzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuVHJpYW5nbGVQcmVkaWNhdGUudHJpQXJlYUREU2xvdyhieCxieSxjeCxjeSxweCxweSkpO2JUZXJtPShieC5tdWx0aXBseShieCkuYWRkKGJ5Lm11bHRpcGx5KGJ5KSkpLm11bHRpcGx5KGpzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuVHJpYW5nbGVQcmVkaWNhdGUudHJpQXJlYUREU2xvdyhheCxheSxjeCxjeSxweCxweSkpO2NUZXJtPShjeC5tdWx0aXBseShjeCkuYWRkKGN5Lm11bHRpcGx5KGN5KSkpLm11bHRpcGx5KGpzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuVHJpYW5nbGVQcmVkaWNhdGUudHJpQXJlYUREU2xvdyhheCxheSxieCxieSxweCxweSkpO3BUZXJtPShweC5tdWx0aXBseShweCkuYWRkKHB5Lm11bHRpcGx5KHB5KSkpLm11bHRpcGx5KGpzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuVHJpYW5nbGVQcmVkaWNhdGUudHJpQXJlYUREU2xvdyhheCxheSxieCxieSxjeCxjeSkpO3N1bT1hVGVybS5zdWJ0cmFjdChiVGVybSkuYWRkKGNUZXJtKS5zdWJ0cmFjdChwVGVybSk7aXNJbkNpcmNsZT1zdW0uZG91YmxlVmFsdWUoKT4wO3JldHVybiBpc0luQ2lyY2xlO307anN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5UcmlhbmdsZVByZWRpY2F0ZS50cmlBcmVhRERTbG93PWZ1bmN0aW9uKGF4LGF5LGJ4LGJ5LGN4LGN5KXtyZXR1cm4oYnguc3VidHJhY3QoYXgpLm11bHRpcGx5KGN5LnN1YnRyYWN0KGF5KSkuc3VidHJhY3QoYnkuc3VidHJhY3QoYXkpLm11bHRpcGx5KGN4LnN1YnRyYWN0KGF4KSkpKTt9O2pzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuVHJpYW5nbGVQcmVkaWNhdGUuaXNJbkNpcmNsZURERmFzdD1mdW5jdGlvbihhLGIsYyxwKXt2YXIgYVRlcm0sYlRlcm0sY1Rlcm0scFRlcm0sc3VtLGlzSW5DaXJjbGU7YVRlcm09KGpzdHMubWF0aC5ERC5zcXIoYS54KS5zZWxmQWRkKGpzdHMubWF0aC5ERC5zcXIoYS55KSkpLnNlbGZNdWx0aXBseShqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlRyaWFuZ2xlUHJlZGljYXRlLnRyaUFyZWFEREZhc3QoYixjLHApKTtiVGVybT0oanN0cy5tYXRoLkRELnNxcihiLngpLnNlbGZBZGQoanN0cy5tYXRoLkRELnNxcihiLnkpKSkuc2VsZk11bHRpcGx5KGpzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuVHJpYW5nbGVQcmVkaWNhdGUudHJpQXJlYURERmFzdChhLGMscCkpO2NUZXJtPShqc3RzLm1hdGguREQuc3FyKGMueCkuc2VsZkFkZChqc3RzLm1hdGguREQuc3FyKGMueSkpKS5zZWxmTXVsdGlwbHkoanN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5UcmlhbmdsZVByZWRpY2F0ZS50cmlBcmVhRERGYXN0KGEsYixwKSk7cFRlcm09KGpzdHMubWF0aC5ERC5zcXIocC54KS5zZWxmQWRkKGpzdHMubWF0aC5ERC5zcXIocC55KSkpLnNlbGZNdWx0aXBseShqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlRyaWFuZ2xlUHJlZGljYXRlLnRyaUFyZWFEREZhc3QoYSxiLGMpKTtzdW09YVRlcm0uc2VsZlN1YnRyYWN0KGJUZXJtKS5zZWxmQWRkKGNUZXJtKS5zZWxmU3VidHJhY3QocFRlcm0pO2lzSW5DaXJjbGU9c3VtLmRvdWJsZVZhbHVlKCk+MDtyZXR1cm4gaXNJbkNpcmNsZTt9O2pzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuVHJpYW5nbGVQcmVkaWNhdGUudHJpQXJlYURERmFzdD1mdW5jdGlvbihhLGIsYyl7dmFyIHQxLHQyO3QxPWpzdHMubWF0aC5ERC52YWx1ZU9mKGIueCkuc2VsZlN1YnRyYWN0KGEueCkuc2VsZk11bHRpcGx5KGpzdHMubWF0aC5ERC52YWx1ZU9mKGMueSkuc2VsZlN1YnRyYWN0KGEueSkpO3QyPWpzdHMubWF0aC5ERC52YWx1ZU9mKGIueSkuc2VsU3VidHJhY3QoYS55KS5zZWxmTXVsdGlwbHkoanN0cy5tYXRoLkRELnZhbHVlT2YoYy54KS5zZWxmU3VidHJhY3QoYS54KSk7cmV0dXJuIHQxLnNlbGZTdWJ0cmFjdCh0Mik7fTtqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlRyaWFuZ2xlUHJlZGljYXRlLmlzSW5DaXJjbGVERE5vcm1hbGl6ZWQ9ZnVuY3Rpb24oYSxiLGMscCl7dmFyIGFkeCxhZHksYmR4LGJkeSxjZHgsY2R5LGFiZGV0LGJjZGV0LGNhZGV0LGFsaWZ0LGJsaWZ0LGNsaWZ0LHN1bSxpc0luQ2lyY2xlO2FkeD1qc3RzLm1hdGguREQudmFsdWVPZihhLngpLnNlbGZTdWJ0cmFjdChwLngpO2FkeT1qc3RzLm1hdGguREQudmFsdWVPZihhLnkpLnNlbGZTdWJ0cmFjdChwLnkpO2JkeD1qc3RzLm1hdGguREQudmFsdWVPZihiLngpLnNlbGZTdWJ0cmFjdChwLngpO2JkeD1qc3RzLm1hdGguREQudmFsdWVPZihiLnkpLnNlbGZTdWJ0cmFjdChwLnkpO2NkeD1qc3RzLm1hdGguREQudmFsdWVPZihjLngpLnNlbGZTdWJ0cmFjdChwLngpO2NkeD1qc3RzLm1hdGguREQudmFsdWVPZihjLnkpLnNlbGZTdWJ0cmFjdChwLnkpO2FiZGV0PWFkeC5tdWx0aXBseShiZHkpLnNlbGZTdWJ0cmFjdChiZHgubXVsdGlwbHkoYWR5KSk7YmNkZXQ9YmR4Lm11bHRpcGx5KGNkeSkuc2VsZlN1YnRyYWN0KGNkeC5tdWx0aXBseShiZHkpKTtjYWRldD1jZHgubXVsdGlwbHkoYWR5KS5zZWxmU3VidHJhY3QoYWR4Lm11bHRpcGx5KGNkeSkpO2FsaWZ0PWFkeC5tdWx0aXBseShhZHgpLnNlbGZBZGQoYWR5Lm11bHRpcGx5KGFkeSkpO2JsaWZ0PWJkeC5tdWx0aXBseShiZHgpLnNlbGZBZGQoYmR5Lm11bHRpcGx5KGJkeSkpO2NsaWZ0PWNkeC5tdWx0aXBseShjZHgpLnNlbGZBZGQoY2R5Lm11bHRpcGx5KGNkeSkpO3N1bT1hbGlmdC5zZWxmTXVsdGlwbHkoYmNkZXQpLnNlbGZBZGQoYmxpZnQuc2VsZk11bHRpcGx5KGNhZGV0KSkuc2VsZkFkZChjbGlmdC5zZWxmTXVsdGlwbHkoYWJkZXQpKTtpc0luQ2lyY2xlPXN1bS5kb3VibGVWYWx1ZSgpPjA7cmV0dXJuIGlzSW5DaXJjbGU7fTtqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlRyaWFuZ2xlUHJlZGljYXRlLmlzSW5DaXJjbGVDQz1mdW5jdGlvbihhLGIsYyxwKXt2YXIgY2MsY2NSYWRpdXMscFJhZGl1c0RpZmY7Y2M9anN0cy5nZW9tLlRyaWFuZ2xlLmNpcmN1bWNlbnRyZShhLGIsYyk7Y2NSYWRpdXM9YS5kaXN0YW5jZShjYyk7cFJhZGl1c0RpZmY9cC5kaXN0YW5jZShjYyktY2NSYWRpdXM7cmV0dXJuIHBSYWRpdXNEaWZmPD0wO307anN0cy5vcGVyYXRpb24udW5pb24uUG9pbnRHZW9tZXRyeVVuaW9uPWZ1bmN0aW9uKHBvaW50R2VvbSxvdGhlckdlb20pe3RoaXMucG9pbnRHZW9tPXBvaW50R2VvbTt0aGlzLm90aGVyR2VvbT1vdGhlckdlb207dGhpcy5nZW9tRmFjdD1vdGhlckdlb20uZ2V0RmFjdG9yeSgpO307anN0cy5vcGVyYXRpb24udW5pb24uUG9pbnRHZW9tZXRyeVVuaW9uLnVuaW9uPWZ1bmN0aW9uKHBvaW50R2VvbSxvdGhlckdlb20pe3ZhciB1bmlvbmVyPW5ldyBqc3RzLm9wZXJhdGlvbi51bmlvbi5Qb2ludEdlb21ldHJ5VW5pb24ocG9pbnRHZW9tLG90aGVyR2VvbSk7cmV0dXJuIHVuaW9uZXIudW5pb24oKTt9O2pzdHMub3BlcmF0aW9uLnVuaW9uLlBvaW50R2VvbWV0cnlVbmlvbi5wcm90b3R5cGUucG9pbnRHZW9tPW51bGw7anN0cy5vcGVyYXRpb24udW5pb24uUG9pbnRHZW9tZXRyeVVuaW9uLnByb3RvdHlwZS5vdGhlckdlb209bnVsbDtqc3RzLm9wZXJhdGlvbi51bmlvbi5Qb2ludEdlb21ldHJ5VW5pb24ucHJvdG90eXBlLmdlb21GYWN0PW51bGw7anN0cy5vcGVyYXRpb24udW5pb24uUG9pbnRHZW9tZXRyeVVuaW9uLnByb3RvdHlwZS51bmlvbj1mdW5jdGlvbigpe3ZhciBsb2NhdG9yPW5ldyBqc3RzLmFsZ29yaXRobS5Qb2ludExvY2F0b3IoKTt2YXIgZXh0ZXJpb3JDb29yZHM9W107Zm9yKHZhciBpPTAsbD10aGlzLnBvaW50R2VvbS5nZXROdW1HZW9tZXRyaWVzKCk7aTxsO2krKyl7dmFyIHBvaW50PXRoaXMucG9pbnRHZW9tLmdldEdlb21ldHJ5TihpKTt2YXIgY29vcmQ9cG9pbnQuZ2V0Q29vcmRpbmF0ZSgpO3ZhciBsb2M9bG9jYXRvci5sb2NhdGUoY29vcmQsdGhpcy5vdGhlckdlb20pO2lmKGxvYz09PWpzdHMuZ2VvbS5Mb2NhdGlvbi5FWFRFUklPUil7dmFyIGluY2x1ZGU9dHJ1ZTtmb3IodmFyIGo9ZXh0ZXJpb3JDb29yZHMubGVuZ3RoO2ktLTspe2lmKGV4dGVyaW9yQ29vcmRzW2pdLmVxdWFscyhjb29yZCkpe2luY2x1ZGU9ZmFsc2U7YnJlYWs7fX1cbmlmKGluY2x1ZGUpe2V4dGVyaW9yQ29vcmRzLnB1c2goY29vcmQpO319fVxuZXh0ZXJpb3JDb29yZHMuc29ydChmdW5jdGlvbih4LHkpe3JldHVybiB4LmNvbXBhcmVUbyh5KTt9KTtpZihleHRlcmlvckNvb3Jkcy5sZW5ndGg9PT0wKXtyZXR1cm4gdGhpcy5vdGhlckdlb207fVxudmFyIHB0Q29tcD1udWxsO3ZhciBjb29yZHM9anN0cy5nZW9tLkNvb3JkaW5hdGVBcnJheXMudG9Db29yZGluYXRlQXJyYXkoZXh0ZXJpb3JDb29yZHMpO2lmKGNvb3Jkcy5sZW5ndGg9PT0xKXtwdENvbXA9dGhpcy5nZW9tRmFjdC5jcmVhdGVQb2ludChjb29yZHNbMF0pO31cbmVsc2V7cHRDb21wPXRoaXMuZ2VvbUZhY3QuY3JlYXRlTXVsdGlQb2ludChjb29yZHMpO31cbnJldHVybiBqc3RzLmdlb20udXRpbC5HZW9tZXRyeUNvbWJpbmVyLmNvbWJpbmUocHRDb21wLHRoaXMub3RoZXJHZW9tKTt9O2pzdHMubm9kaW5nLkludGVyc2VjdGlvbkZpbmRlckFkZGVyPWZ1bmN0aW9uKGxpKXt0aGlzLmxpPWxpO3RoaXMuaW50ZXJpb3JJbnRlcnNlY3Rpb25zPW5ldyBqYXZhc2NyaXB0LnV0aWwuQXJyYXlMaXN0KCk7fTtqc3RzLm5vZGluZy5JbnRlcnNlY3Rpb25GaW5kZXJBZGRlci5wcm90b3R5cGU9bmV3IGpzdHMubm9kaW5nLlNlZ21lbnRJbnRlcnNlY3RvcigpO2pzdHMubm9kaW5nLkludGVyc2VjdGlvbkZpbmRlckFkZGVyLmNvbnN0cnVjdG9yPWpzdHMubm9kaW5nLkludGVyc2VjdGlvbkZpbmRlckFkZGVyO2pzdHMubm9kaW5nLkludGVyc2VjdGlvbkZpbmRlckFkZGVyLnByb3RvdHlwZS5saT1udWxsO2pzdHMubm9kaW5nLkludGVyc2VjdGlvbkZpbmRlckFkZGVyLnByb3RvdHlwZS5pbnRlcmlvckludGVyc2VjdGlvbnM9bnVsbDtqc3RzLm5vZGluZy5JbnRlcnNlY3Rpb25GaW5kZXJBZGRlci5wcm90b3R5cGUuZ2V0SW50ZXJpb3JJbnRlcnNlY3Rpb25zPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuaW50ZXJpb3JJbnRlcnNlY3Rpb25zO307anN0cy5ub2RpbmcuSW50ZXJzZWN0aW9uRmluZGVyQWRkZXIucHJvdG90eXBlLnByb2Nlc3NJbnRlcnNlY3Rpb25zPWZ1bmN0aW9uKGUwLHNlZ0luZGV4MCxlMSxzZWdJbmRleDEpe2lmKGUwPT09ZTEmJnNlZ0luZGV4MD09PXNlZ0luZGV4MSlcbnJldHVybjt2YXIgcDAwPWUwLmdldENvb3JkaW5hdGVzKClbc2VnSW5kZXgwXTt2YXIgcDAxPWUwLmdldENvb3JkaW5hdGVzKClbc2VnSW5kZXgwKzFdO3ZhciBwMTA9ZTEuZ2V0Q29vcmRpbmF0ZXMoKVtzZWdJbmRleDFdO3ZhciBwMTE9ZTEuZ2V0Q29vcmRpbmF0ZXMoKVtzZWdJbmRleDErMV07dGhpcy5saS5jb21wdXRlSW50ZXJzZWN0aW9uKHAwMCxwMDEscDEwLHAxMSk7aWYodGhpcy5saS5oYXNJbnRlcnNlY3Rpb24oKSl7aWYodGhpcy5saS5pc0ludGVyaW9ySW50ZXJzZWN0aW9uKCkpe2Zvcih2YXIgaW50SW5kZXg9MDtpbnRJbmRleDx0aGlzLmxpLmdldEludGVyc2VjdGlvbk51bSgpO2ludEluZGV4Kyspe3RoaXMuaW50ZXJpb3JJbnRlcnNlY3Rpb25zLmFkZCh0aGlzLmxpLmdldEludGVyc2VjdGlvbihpbnRJbmRleCkpO31cbmUwLmFkZEludGVyc2VjdGlvbnModGhpcy5saSxzZWdJbmRleDAsMCk7ZTEuYWRkSW50ZXJzZWN0aW9ucyh0aGlzLmxpLHNlZ0luZGV4MSwxKTt9fX07anN0cy5ub2RpbmcuSW50ZXJzZWN0aW9uRmluZGVyQWRkZXIucHJvdG90eXBlLmlzRG9uZT1mdW5jdGlvbigpe3JldHVybiBmYWxzZTt9O2pzdHMubm9kaW5nLnNuYXByb3VuZC5NQ0luZGV4U25hcFJvdW5kZXI9ZnVuY3Rpb24ocG0pe3RoaXMucG09cG07dGhpcy5saT1uZXcganN0cy5hbGdvcml0aG0uUm9idXN0TGluZUludGVyc2VjdG9yKCk7dGhpcy5saS5zZXRQcmVjaXNpb25Nb2RlbChwbSk7dGhpcy5zY2FsZUZhY3Rvcj1wbS5nZXRTY2FsZSgpO307anN0cy5ub2Rpbmcuc25hcHJvdW5kLk1DSW5kZXhTbmFwUm91bmRlci5wcm90b3R5cGU9bmV3IGpzdHMubm9kaW5nLk5vZGVyKCk7anN0cy5ub2Rpbmcuc25hcHJvdW5kLk1DSW5kZXhTbmFwUm91bmRlci5jb25zdHJ1Y3Rvcj1qc3RzLm5vZGluZy5zbmFwcm91bmQuTUNJbmRleFNuYXBSb3VuZGVyO2pzdHMubm9kaW5nLnNuYXByb3VuZC5NQ0luZGV4U25hcFJvdW5kZXIucHJvdG90eXBlLnBtPW51bGw7anN0cy5ub2Rpbmcuc25hcHJvdW5kLk1DSW5kZXhTbmFwUm91bmRlci5wcm90b3R5cGUubGk9bnVsbDtqc3RzLm5vZGluZy5zbmFwcm91bmQuTUNJbmRleFNuYXBSb3VuZGVyLnByb3RvdHlwZS5zY2FsZUZhY3Rvcj1udWxsO2pzdHMubm9kaW5nLnNuYXByb3VuZC5NQ0luZGV4U25hcFJvdW5kZXIucHJvdG90eXBlLm5vZGVyPW51bGw7anN0cy5ub2Rpbmcuc25hcHJvdW5kLk1DSW5kZXhTbmFwUm91bmRlci5wcm90b3R5cGUucG9pbnRTbmFwcGVyPW51bGw7anN0cy5ub2Rpbmcuc25hcHJvdW5kLk1DSW5kZXhTbmFwUm91bmRlci5wcm90b3R5cGUubm9kZWRTZWdTdHJpbmdzPW51bGw7anN0cy5ub2Rpbmcuc25hcHJvdW5kLk1DSW5kZXhTbmFwUm91bmRlci5wcm90b3R5cGUuZ2V0Tm9kZWRTdWJzdHJpbmdzPWZ1bmN0aW9uKCl7cmV0dXJuIGpzdHMubm9kaW5nLk5vZGVkU2VnbWVudFN0cmluZy5nZXROb2RlZFN1YnN0cmluZ3ModGhpcy5ub2RlZFNlZ1N0cmluZ3MpO307anN0cy5ub2Rpbmcuc25hcHJvdW5kLk1DSW5kZXhTbmFwUm91bmRlci5wcm90b3R5cGUuY29tcHV0ZU5vZGVzPWZ1bmN0aW9uKGlucHV0U2VnbWVudFN0cmluZ3Mpe3RoaXMubm9kZWRTZWdTdHJpbmdzPWlucHV0U2VnbWVudFN0cmluZ3M7dGhpcy5ub2Rlcj1uZXcganN0cy5ub2RpbmcuTUNJbmRleE5vZGVyKCk7dGhpcy5wb2ludFNuYXBwZXI9bmV3IGpzdHMubm9kaW5nLnNuYXByb3VuZC5NQ0luZGV4UG9pbnRTbmFwcGVyKHRoaXMubm9kZXIuZ2V0SW5kZXgoKSk7dGhpcy5zbmFwUm91bmQoaW5wdXRTZWdtZW50U3RyaW5ncyx0aGlzLmxpKTt9O2pzdHMubm9kaW5nLnNuYXByb3VuZC5NQ0luZGV4U25hcFJvdW5kZXIucHJvdG90eXBlLnNuYXBSb3VuZD1mdW5jdGlvbihzZWdTdHJpbmdzLGxpKXt2YXIgaW50ZXJzZWN0aW9ucz10aGlzLmZpbmRJbnRlcmlvckludGVyc2VjdGlvbnMoc2VnU3RyaW5ncyxsaSk7dGhpcy5jb21wdXRlSW50ZXJzZWN0aW9uU25hcHMoaW50ZXJzZWN0aW9ucyk7dGhpcy5jb21wdXRlVmVydGV4U25hcHMoc2VnU3RyaW5ncyk7fTtqc3RzLm5vZGluZy5zbmFwcm91bmQuTUNJbmRleFNuYXBSb3VuZGVyLnByb3RvdHlwZS5maW5kSW50ZXJpb3JJbnRlcnNlY3Rpb25zPWZ1bmN0aW9uKHNlZ1N0cmluZ3MsbGkpe3ZhciBpbnRGaW5kZXJBZGRlcj1uZXcganN0cy5ub2RpbmcuSW50ZXJzZWN0aW9uRmluZGVyQWRkZXIobGkpO3RoaXMubm9kZXIuc2V0U2VnbWVudEludGVyc2VjdG9yKGludEZpbmRlckFkZGVyKTt0aGlzLm5vZGVyLmNvbXB1dGVOb2RlcyhzZWdTdHJpbmdzKTtyZXR1cm4gaW50RmluZGVyQWRkZXIuZ2V0SW50ZXJpb3JJbnRlcnNlY3Rpb25zKCk7fTtqc3RzLm5vZGluZy5zbmFwcm91bmQuTUNJbmRleFNuYXBSb3VuZGVyLnByb3RvdHlwZS5jb21wdXRlSW50ZXJzZWN0aW9uU25hcHM9ZnVuY3Rpb24oc25hcFB0cyl7Zm9yKHZhciBpdD1zbmFwUHRzLml0ZXJhdG9yKCk7aXQuaGFzTmV4dCgpOyl7dmFyIHNuYXBQdD1pdC5uZXh0KCk7dmFyIGhvdFBpeGVsPW5ldyBqc3RzLm5vZGluZy5zbmFwcm91bmQuSG90UGl4ZWwoc25hcFB0LHRoaXMuc2NhbGVGYWN0b3IsdGhpcy5saSk7dGhpcy5wb2ludFNuYXBwZXIuc25hcChob3RQaXhlbCk7fX07anN0cy5ub2Rpbmcuc25hcHJvdW5kLk1DSW5kZXhTbmFwUm91bmRlci5wcm90b3R5cGUuY29tcHV0ZVZlcnRleFNuYXBzPWZ1bmN0aW9uKGVkZ2VzKXtpZihlZGdlcyBpbnN0YW5jZW9mIGpzdHMubm9kaW5nLk5vZGVkU2VnbWVudFN0cmluZyl7dGhpcy5jb21wdXRlVmVydGV4U25hcHMyLmFwcGx5KHRoaXMsYXJndW1lbnRzKTtyZXR1cm47fVxuZm9yKHZhciBpMD1lZGdlcy5pdGVyYXRvcigpO2kwLmhhc05leHQoKTspe3ZhciBlZGdlMD1pMC5uZXh0KCk7dGhpcy5jb21wdXRlVmVydGV4U25hcHMoZWRnZTApO319O2pzdHMubm9kaW5nLnNuYXByb3VuZC5NQ0luZGV4U25hcFJvdW5kZXIucHJvdG90eXBlLmNvbXB1dGVWZXJ0ZXhTbmFwczI9ZnVuY3Rpb24oZSl7dmFyIHB0czA9ZS5nZXRDb29yZGluYXRlcygpO2Zvcih2YXIgaT0wO2k8cHRzMC5sZW5ndGgtMTtpKyspe3ZhciBob3RQaXhlbD1uZXcganN0cy5ub2Rpbmcuc25hcHJvdW5kLkhvdFBpeGVsKHB0czBbaV0sdGhpcy5zY2FsZUZhY3Rvcix0aGlzLmxpKTt2YXIgaXNOb2RlQWRkZWQ9dGhpcy5wb2ludFNuYXBwZXIuc25hcChob3RQaXhlbCxlLGkpO2lmKGlzTm9kZUFkZGVkKXtlLmFkZEludGVyc2VjdGlvbihwdHMwW2ldLGkpO319fTtqc3RzLm9wZXJhdGlvbi52YWxpZC5Db25uZWN0ZWRJbnRlcmlvclRlc3Rlcj1mdW5jdGlvbihnZW9tR3JhcGgpe3RoaXMuZ2VvbUdyYXBoPWdlb21HcmFwaDt0aGlzLmdlb21ldHJ5RmFjdG9yeT1uZXcganN0cy5nZW9tLkdlb21ldHJ5RmFjdG9yeSgpO3RoaXMuZGlzY29ubmVjdGVkUmluZ2Nvb3JkPW51bGw7fTtqc3RzLm9wZXJhdGlvbi52YWxpZC5Db25uZWN0ZWRJbnRlcmlvclRlc3Rlci5maW5kRGlmZmVyZW50UG9pbnQ9ZnVuY3Rpb24oY29vcmQscHQpe3ZhciBpPTAsaWw9Y29vcmQubGVuZ3RoO2ZvcihpO2k8aWw7aSsrKXtpZighY29vcmRbaV0uZXF1YWxzKHB0KSlcbnJldHVybiBjb29yZFtpXTt9XG5yZXR1cm4gbnVsbDt9O2pzdHMub3BlcmF0aW9uLnZhbGlkLkNvbm5lY3RlZEludGVyaW9yVGVzdGVyLnByb3RvdHlwZS5nZXRDb29yZGluYXRlPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZGlzY29ubmVjdGVkUmluZ2Nvb3JkO307anN0cy5vcGVyYXRpb24udmFsaWQuQ29ubmVjdGVkSW50ZXJpb3JUZXN0ZXIucHJvdG90eXBlLmlzSW50ZXJpb3JzQ29ubmVjdGVkPWZ1bmN0aW9uKCl7dmFyIHNwbGl0RWRnZXM9bmV3IGphdmFzY3JpcHQudXRpbC5BcnJheUxpc3QoKTt0aGlzLmdlb21HcmFwaC5jb21wdXRlU3BsaXRFZGdlcyhzcGxpdEVkZ2VzKTt2YXIgZ3JhcGg9bmV3IGpzdHMuZ2VvbWdyYXBoLlBsYW5hckdyYXBoKG5ldyBqc3RzLm9wZXJhdGlvbi5vdmVybGF5Lk92ZXJsYXlOb2RlRmFjdG9yeSgpKTtncmFwaC5hZGRFZGdlcyhzcGxpdEVkZ2VzKTt0aGlzLnNldEludGVyaW9yRWRnZXNJblJlc3VsdChncmFwaCk7Z3JhcGgubGlua1Jlc3VsdERpcmVjdGVkRWRnZXMoKTt2YXIgZWRnZVJpbmdzPXRoaXMuYnVpbGRFZGdlUmluZ3MoZ3JhcGguZ2V0RWRnZUVuZHMoKSk7dGhpcy52aXNpdFNoZWxsSW50ZXJpb3JzKHRoaXMuZ2VvbUdyYXBoLmdldEdlb21ldHJ5KCksZ3JhcGgpO3JldHVybiF0aGlzLmhhc1VudmlzaXRlZFNoZWxsRWRnZShlZGdlUmluZ3MpO307anN0cy5vcGVyYXRpb24udmFsaWQuQ29ubmVjdGVkSW50ZXJpb3JUZXN0ZXIucHJvdG90eXBlLnNldEludGVyaW9yRWRnZXNJblJlc3VsdD1mdW5jdGlvbihncmFwaCl7dmFyIGl0PWdyYXBoLmdldEVkZ2VFbmRzKCkuaXRlcmF0b3IoKSxkZTt3aGlsZShpdC5oYXNOZXh0KCkpe2RlPWl0Lm5leHQoKTtpZihkZS5nZXRMYWJlbCgpLmdldExvY2F0aW9uKDAsanN0cy5nZW9tZ3JhcGguUG9zaXRpb24uUklHSFQpPT1qc3RzLmdlb20uTG9jYXRpb24uSU5URVJJT1Ipe2RlLnNldEluUmVzdWx0KHRydWUpO319fTtqc3RzLm9wZXJhdGlvbi52YWxpZC5Db25uZWN0ZWRJbnRlcmlvclRlc3Rlci5wcm90b3R5cGUuYnVpbGRFZGdlUmluZ3M9ZnVuY3Rpb24oZGlyRWRnZXMpe3ZhciBlZGdlUmluZ3M9bmV3IGphdmFzY3JpcHQudXRpbC5BcnJheUxpc3QoKTtmb3IodmFyIGl0PWRpckVkZ2VzLml0ZXJhdG9yKCk7aXQuaGFzTmV4dCgpOyl7dmFyIGRlPWl0Lm5leHQoKTtpZihkZS5pc0luUmVzdWx0KCkmJmRlLmdldEVkZ2VSaW5nKCk9PW51bGwpe3ZhciBlcj1uZXcganN0cy5vcGVyYXRpb24ub3ZlcmxheS5NYXhpbWFsRWRnZVJpbmcoZGUsdGhpcy5nZW9tZXRyeUZhY3RvcnkpO2VyLmxpbmtEaXJlY3RlZEVkZ2VzRm9yTWluaW1hbEVkZ2VSaW5ncygpO3ZhciBtaW5FZGdlUmluZ3M9ZXIuYnVpbGRNaW5pbWFsUmluZ3MoKTt2YXIgaT0wLGlsPW1pbkVkZ2VSaW5ncy5sZW5ndGg7Zm9yKGk7aTxpbDtpKyspe2VkZ2VSaW5ncy5hZGQobWluRWRnZVJpbmdzW2ldKTt9fX1cbnJldHVybiBlZGdlUmluZ3M7fTtqc3RzLm9wZXJhdGlvbi52YWxpZC5Db25uZWN0ZWRJbnRlcmlvclRlc3Rlci5wcm90b3R5cGUudmlzaXRTaGVsbEludGVyaW9ycz1mdW5jdGlvbihnLGdyYXBoKXtpZihnIGluc3RhbmNlb2YganN0cy5nZW9tLlBvbHlnb24pe3ZhciBwPWc7dGhpcy52aXNpdEludGVyaW9yUmluZyhwLmdldEV4dGVyaW9yUmluZygpLGdyYXBoKTt9XG5pZihnIGluc3RhbmNlb2YganN0cy5nZW9tLk11bHRpUG9seWdvbil7dmFyIG1wPWc7Zm9yKHZhciBpPTA7aTxtcC5nZXROdW1HZW9tZXRyaWVzKCk7aSsrKXt2YXIgcD1tcC5nZXRHZW9tZXRyeU4oaSk7dGhpcy52aXNpdEludGVyaW9yUmluZyhwLmdldEV4dGVyaW9yUmluZygpLGdyYXBoKTt9fX07anN0cy5vcGVyYXRpb24udmFsaWQuQ29ubmVjdGVkSW50ZXJpb3JUZXN0ZXIucHJvdG90eXBlLnZpc2l0SW50ZXJpb3JSaW5nPWZ1bmN0aW9uKHJpbmcsZ3JhcGgpe3ZhciBwdHM9cmluZy5nZXRDb29yZGluYXRlcygpO3ZhciBwdDA9cHRzWzBdO3ZhciBwdDE9anN0cy5vcGVyYXRpb24udmFsaWQuQ29ubmVjdGVkSW50ZXJpb3JUZXN0ZXIuZmluZERpZmZlcmVudFBvaW50KHB0cyxwdDApO3ZhciBlPWdyYXBoLmZpbmRFZGdlSW5TYW1lRGlyZWN0aW9uKHB0MCxwdDEpO3ZhciBkZT1ncmFwaC5maW5kRWRnZUVuZChlKTt2YXIgaW50RGU9bnVsbDtpZihkZS5nZXRMYWJlbCgpLmdldExvY2F0aW9uKDAsanN0cy5nZW9tZ3JhcGguUG9zaXRpb24uUklHSFQpPT1qc3RzLmdlb20uTG9jYXRpb24uSU5URVJJT1Ipe2ludERlPWRlO31lbHNlIGlmKGRlLmdldFN5bSgpLmdldExhYmVsKCkuZ2V0TG9jYXRpb24oMCxqc3RzLmdlb21ncmFwaC5Qb3NpdGlvbi5SSUdIVCk9PWpzdHMuZ2VvbS5Mb2NhdGlvbi5JTlRFUklPUil7aW50RGU9ZGUuZ2V0U3ltKCk7fVxudGhpcy52aXNpdExpbmtlZERpcmVjdGVkRWRnZXMoaW50RGUpO307anN0cy5vcGVyYXRpb24udmFsaWQuQ29ubmVjdGVkSW50ZXJpb3JUZXN0ZXIucHJvdG90eXBlLnZpc2l0TGlua2VkRGlyZWN0ZWRFZGdlcz1mdW5jdGlvbihzdGFydCl7dmFyIHN0YXJ0RGU9c3RhcnQ7dmFyIGRlPXN0YXJ0O2Rve2RlLnNldFZpc2l0ZWQodHJ1ZSk7ZGU9ZGUuZ2V0TmV4dCgpO313aGlsZShkZSE9c3RhcnREZSk7fTtqc3RzLm9wZXJhdGlvbi52YWxpZC5Db25uZWN0ZWRJbnRlcmlvclRlc3Rlci5wcm90b3R5cGUuaGFzVW52aXNpdGVkU2hlbGxFZGdlPWZ1bmN0aW9uKGVkZ2VSaW5ncyl7Zm9yKHZhciBpPTA7aTxlZGdlUmluZ3Muc2l6ZSgpO2krKyl7dmFyIGVyPWVkZ2VSaW5ncy5nZXQoaSk7aWYoZXIuaXNIb2xlKCkpe2NvbnRpbnVlO31cbnZhciBlZGdlcz1lci5nZXRFZGdlcygpO3ZhciBkZT1lZGdlc1swXTtpZihkZS5nZXRMYWJlbCgpLmdldExvY2F0aW9uKDAsanN0cy5nZW9tZ3JhcGguUG9zaXRpb24uUklHSFQpIT1qc3RzLmdlb20uTG9jYXRpb24uSU5URVJJT1Ipe2NvbnRpbnVlO31cbmZvcih2YXIgaj0wO2o8ZWRnZXMubGVuZ3RoO2orKyl7ZGU9ZWRnZXNbal07aWYoIWRlLmlzVmlzaXRlZCgpKXtkaXNjb25uZWN0ZWRSaW5nY29vcmQ9ZGUuZ2V0Q29vcmRpbmF0ZSgpO3JldHVybiB0cnVlO319fVxucmV0dXJuIGZhbHNlO307anN0cy5hbGdvcml0aG0uSW50ZXJpb3JQb2ludExpbmU9ZnVuY3Rpb24oZ2VvbWV0cnkpe3RoaXMuY2VudHJvaWQ7dGhpcy5taW5EaXN0YW5jZT1OdW1iZXIuTUFYX1ZBTFVFO3RoaXMuaW50ZXJpb3JQb2ludD1udWxsO3RoaXMuY2VudHJvaWQ9Z2VvbWV0cnkuZ2V0Q2VudHJvaWQoKS5nZXRDb29yZGluYXRlKCk7dGhpcy5hZGRJbnRlcmlvcihnZW9tZXRyeSk7aWYodGhpcy5pbnRlcmlvclBvaW50PT1udWxsKXt0aGlzLmFkZEVuZHBvaW50cyhnZW9tZXRyeSk7fX07anN0cy5hbGdvcml0aG0uSW50ZXJpb3JQb2ludExpbmUucHJvdG90eXBlLmdldEludGVyaW9yUG9pbnQ9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5pbnRlcmlvclBvaW50O307anN0cy5hbGdvcml0aG0uSW50ZXJpb3JQb2ludExpbmUucHJvdG90eXBlLmFkZEludGVyaW9yPWZ1bmN0aW9uKGdlb21ldHJ5KXtpZihnZW9tZXRyeSBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5MaW5lU3RyaW5nKXt0aGlzLmFkZEludGVyaW9yQ29vcmQoZ2VvbWV0cnkuZ2V0Q29vcmRpbmF0ZXMoKSk7fWVsc2UgaWYoZ2VvbWV0cnkgaW5zdGFuY2VvZiBqc3RzLmdlb20uR2VvbWV0cnlDb2xsZWN0aW9uKXtmb3IodmFyIGk9MDtpPGdlb21ldHJ5LmdldE51bUdlb21ldHJpZXMoKTtpKyspe3RoaXMuYWRkSW50ZXJpb3IoZ2VvbWV0cnkuZ2V0R2VvbWV0cnlOKGkpKTt9fX07anN0cy5hbGdvcml0aG0uSW50ZXJpb3JQb2ludExpbmUucHJvdG90eXBlLmFkZEludGVyaW9yQ29vcmQ9ZnVuY3Rpb24ocHRzKXtmb3IodmFyIGk9MTtpPHB0cy5sZW5ndGgtMTtpKyspe3RoaXMuYWRkKHB0c1tpXSk7fX07anN0cy5hbGdvcml0aG0uSW50ZXJpb3JQb2ludExpbmUucHJvdG90eXBlLmFkZEVuZHBvaW50cz1mdW5jdGlvbihnZW9tZXRyeSl7aWYoZ2VvbWV0cnkgaW5zdGFuY2VvZiBqc3RzLmdlb20uTGluZVN0cmluZyl7dGhpcy5hZGRFbmRwb2ludHNDb29yZChnZW9tZXRyeS5nZXRDb29yZGluYXRlcygpKTt9ZWxzZSBpZihnZW9tZXRyeSBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5HZW9tZXRyeUNvbGxlY3Rpb24pe2Zvcih2YXIgaT0wO2k8Z2VvbWV0cnkuZ2V0TnVtR2VvbWV0cmllcygpO2krKyl7dGhpcy5hZGRFbmRwb2ludHMoZ2VvbWV0cnkuZ2V0R2VvbWV0cnlOKGkpKTt9fX07anN0cy5hbGdvcml0aG0uSW50ZXJpb3JQb2ludExpbmUucHJvdG90eXBlLmFkZEVuZHBvaW50c0Nvb3JkPWZ1bmN0aW9uKHB0cyl7dGhpcy5hZGQocHRzWzBdKTt0aGlzLmFkZChwdHNbcHRzLmxlbmd0aC0xXSk7fTtqc3RzLmFsZ29yaXRobS5JbnRlcmlvclBvaW50TGluZS5wcm90b3R5cGUuYWRkPWZ1bmN0aW9uKHBvaW50KXt2YXIgZGlzdD1wb2ludC5kaXN0YW5jZSh0aGlzLmNlbnRyb2lkKTtpZihkaXN0PHRoaXMubWluRGlzdGFuY2Upe3RoaXMuaW50ZXJpb3JQb2ludD1uZXcganN0cy5nZW9tLkNvb3JkaW5hdGUocG9pbnQpO3RoaXMubWluRGlzdGFuY2U9ZGlzdDt9fTtqc3RzLmluZGV4LmNoYWluLk1vbm90b25lQ2hhaW5TZWxlY3RBY3Rpb249ZnVuY3Rpb24oKXt0aGlzLnRlbXBFbnYxPW5ldyBqc3RzLmdlb20uRW52ZWxvcGUoKTt0aGlzLnNlbGVjdGVkU2VnbWVudD1uZXcganN0cy5nZW9tLkxpbmVTZWdtZW50KCk7fTtqc3RzLmluZGV4LmNoYWluLk1vbm90b25lQ2hhaW5TZWxlY3RBY3Rpb24ucHJvdG90eXBlLnRlbXBFbnYxPW51bGw7anN0cy5pbmRleC5jaGFpbi5Nb25vdG9uZUNoYWluU2VsZWN0QWN0aW9uLnByb3RvdHlwZS5zZWxlY3RlZFNlZ21lbnQ9bnVsbDtqc3RzLmluZGV4LmNoYWluLk1vbm90b25lQ2hhaW5TZWxlY3RBY3Rpb24ucHJvdG90eXBlLnNlbGVjdD1mdW5jdGlvbihtYyxzdGFydCl7bWMuZ2V0TGluZVNlZ21lbnQoc3RhcnQsdGhpcy5zZWxlY3RlZFNlZ21lbnQpO3RoaXMuc2VsZWN0Mih0aGlzLnNlbGVjdGVkU2VnbWVudCk7fTtqc3RzLmluZGV4LmNoYWluLk1vbm90b25lQ2hhaW5TZWxlY3RBY3Rpb24ucHJvdG90eXBlLnNlbGVjdDI9ZnVuY3Rpb24oc2VnKXt9O2pzdHMuYWxnb3JpdGhtLk1DUG9pbnRJblJpbmc9ZnVuY3Rpb24ocmluZyl7dGhpcy5yaW5nPXJpbmc7dGhpcy50cmVlPW51bGw7dGhpcy5jcm9zc2luZ3M9MDt0aGlzLmludGVydmFsPW5ldyBqc3RzLmluZGV4LmJpbnRyZWUuSW50ZXJ2YWwoKTt0aGlzLmJ1aWxkSW5kZXgoKTt9O2pzdHMuYWxnb3JpdGhtLk1DUG9pbnRJblJpbmcuTUNTZWxlY3Rlcj1mdW5jdGlvbihwLHBhcmVudCl7dGhpcy5wYXJlbnQ9cGFyZW50O3RoaXMucD1wO307anN0cy5hbGdvcml0aG0uTUNQb2ludEluUmluZy5NQ1NlbGVjdGVyLnByb3RvdHlwZT1uZXcganN0cy5pbmRleC5jaGFpbi5Nb25vdG9uZUNoYWluU2VsZWN0QWN0aW9uO2pzdHMuYWxnb3JpdGhtLk1DUG9pbnRJblJpbmcuTUNTZWxlY3Rlci5wcm90b3R5cGUuY29uc3RydWN0b3I9anN0cy5hbGdvcml0aG0uTUNQb2ludEluUmluZy5NQ1NlbGVjdGVyO2pzdHMuYWxnb3JpdGhtLk1DUG9pbnRJblJpbmcuTUNTZWxlY3Rlci5wcm90b3R5cGUuc2VsZWN0Mj1mdW5jdGlvbihscyl7dGhpcy5wYXJlbnQudGVzdExpbmVTZWdtZW50LmFwcGx5KHRoaXMucGFyZW50LFt0aGlzLnAsbHNdKTt9O2pzdHMuYWxnb3JpdGhtLk1DUG9pbnRJblJpbmcucHJvdG90eXBlLmJ1aWxkSW5kZXg9ZnVuY3Rpb24oKXt0aGlzLnRyZWU9bmV3IGpzdHMuaW5kZXguYmludHJlZS5CaW50cmVlKCk7dmFyIHB0cz1qc3RzLmdlb20uQ29vcmRpbmF0ZUFycmF5cy5yZW1vdmVSZXBlYXRlZFBvaW50cyh0aGlzLnJpbmcuZ2V0Q29vcmRpbmF0ZXMoKSk7dmFyIG1jTGlzdD1qc3RzLmluZGV4LmNoYWluLk1vbm90b25lQ2hhaW5CdWlsZGVyLmdldENoYWlucyhwdHMpO2Zvcih2YXIgaT0wO2k8bWNMaXN0Lmxlbmd0aDtpKyspe3ZhciBtYz1tY0xpc3RbaV07dmFyIG1jRW52PW1jLmdldEVudmVsb3BlKCk7dGhpcy5pbnRlcnZhbC5taW49bWNFbnYuZ2V0TWluWSgpO3RoaXMuaW50ZXJ2YWwubWF4PW1jRW52LmdldE1heFkoKTt0aGlzLnRyZWUuaW5zZXJ0KHRoaXMuaW50ZXJ2YWwsbWMpO319O2pzdHMuYWxnb3JpdGhtLk1DUG9pbnRJblJpbmcucHJvdG90eXBlLmlzSW5zaWRlPWZ1bmN0aW9uKHB0KXt0aGlzLmNyb3NzaW5ncz0wO3ZhciByYXlFbnY9bmV3IGpzdHMuZ2VvbS5FbnZlbG9wZSgtTnVtYmVyLk1BWF9WQUxVRSxOdW1iZXIuTUFYX1ZBTFVFLHB0LnkscHQueSk7dGhpcy5pbnRlcnZhbC5taW49cHQueTt0aGlzLmludGVydmFsLm1heD1wdC55O3ZhciBzZWdzPXRoaXMudHJlZS5xdWVyeSh0aGlzLmludGVydmFsKTt2YXIgbWNTZWxlY3Rlcj1uZXcganN0cy5hbGdvcml0aG0uTUNQb2ludEluUmluZy5NQ1NlbGVjdGVyKHB0LHRoaXMpO2Zvcih2YXIgaT1zZWdzLml0ZXJhdG9yKCk7aS5oYXNOZXh0KCk7KXt2YXIgbWM9aS5uZXh0KCk7dGhpcy50ZXN0TW9ub3RvbmVDaGFpbihyYXlFbnYsbWNTZWxlY3RlcixtYyk7fVxuaWYoKHRoaXMuY3Jvc3NpbmdzJTIpPT0xKXtyZXR1cm4gdHJ1ZTt9XG5yZXR1cm4gZmFsc2U7fTtqc3RzLmFsZ29yaXRobS5NQ1BvaW50SW5SaW5nLnByb3RvdHlwZS50ZXN0TW9ub3RvbmVDaGFpbj1mdW5jdGlvbihyYXlFbnYsbWNTZWxlY3RlcixtYyl7bWMuc2VsZWN0KHJheUVudixtY1NlbGVjdGVyKTt9O2pzdHMuYWxnb3JpdGhtLk1DUG9pbnRJblJpbmcucHJvdG90eXBlLnRlc3RMaW5lU2VnbWVudD1mdW5jdGlvbihwLHNlZyl7dmFyIHhJbnQseDEseTEseDIseTIscDEscDI7cDE9c2VnLnAwO3AyPXNlZy5wMTt4MT1wMS54LXAueDt5MT1wMS55LXAueTt4Mj1wMi54LXAueDt5Mj1wMi55LXAueTtpZigoKHkxPjApJiYoeTI8PTApKXx8KCh5Mj4wKSYmKHkxPD0wKSkpe3hJbnQ9anN0cy5hbGdvcml0aG0uUm9idXN0RGV0ZXJtaW5hbnQuc2lnbk9mRGV0MngyKHgxLHkxLHgyLHkyKS8oeTIteTEpO2lmKDAuMDx4SW50KXt0aGlzLmNyb3NzaW5ncysrO319fTtqc3RzLm9wZXJhdGlvbi52YWxpZC5Ub3BvbG9neVZhbGlkYXRpb25FcnJvcj1mdW5jdGlvbihlcnJvclR5cGUscHQpe3RoaXMuZXJyb3JUeXBlPWVycm9yVHlwZTt0aGlzLnB0PW51bGw7aWYocHQhPW51bGwpe3RoaXMucHQ9cHQuY2xvbmUoKTt9fTtqc3RzLm9wZXJhdGlvbi52YWxpZC5Ub3BvbG9neVZhbGlkYXRpb25FcnJvci5IT0xFX09VVFNJREVfU0hFTEw9Mjtqc3RzLm9wZXJhdGlvbi52YWxpZC5Ub3BvbG9neVZhbGlkYXRpb25FcnJvci5ORVNURURfSE9MRVM9Mztqc3RzLm9wZXJhdGlvbi52YWxpZC5Ub3BvbG9neVZhbGlkYXRpb25FcnJvci5ESVNDT05ORUNURURfSU5URVJJT1I9NDtqc3RzLm9wZXJhdGlvbi52YWxpZC5Ub3BvbG9neVZhbGlkYXRpb25FcnJvci5TRUxGX0lOVEVSU0VDVElPTj01O2pzdHMub3BlcmF0aW9uLnZhbGlkLlRvcG9sb2d5VmFsaWRhdGlvbkVycm9yLlJJTkdfU0VMRl9JTlRFUlNFQ1RJT049Njtqc3RzLm9wZXJhdGlvbi52YWxpZC5Ub3BvbG9neVZhbGlkYXRpb25FcnJvci5ORVNURURfU0hFTExTPTc7anN0cy5vcGVyYXRpb24udmFsaWQuVG9wb2xvZ3lWYWxpZGF0aW9uRXJyb3IuRFVQTElDQVRFX1JJTkdTPTg7anN0cy5vcGVyYXRpb24udmFsaWQuVG9wb2xvZ3lWYWxpZGF0aW9uRXJyb3IuVE9PX0ZFV19QT0lOVFM9OTtqc3RzLm9wZXJhdGlvbi52YWxpZC5Ub3BvbG9neVZhbGlkYXRpb25FcnJvci5JTlZBTElEX0NPT1JESU5BVEU9MTA7anN0cy5vcGVyYXRpb24udmFsaWQuVG9wb2xvZ3lWYWxpZGF0aW9uRXJyb3IuUklOR19OT1RfQ0xPU0VEPTExO2pzdHMub3BlcmF0aW9uLnZhbGlkLlRvcG9sb2d5VmFsaWRhdGlvbkVycm9yLnByb3RvdHlwZS5lcnJNc2c9WydUb3BvbG9neSBWYWxpZGF0aW9uIEVycm9yJywnUmVwZWF0ZWQgUG9pbnQnLCdIb2xlIGxpZXMgb3V0c2lkZSBzaGVsbCcsJ0hvbGVzIGFyZSBuZXN0ZWQnLCdJbnRlcmlvciBpcyBkaXNjb25uZWN0ZWQnLCdTZWxmLWludGVyc2VjdGlvbicsJ1JpbmcgU2VsZi1pbnRlcnNlY3Rpb24nLCdOZXN0ZWQgc2hlbGxzJywnRHVwbGljYXRlIFJpbmdzJywnVG9vIGZldyBkaXN0aW5jdCBwb2ludHMgaW4gZ2VvbWV0cnkgY29tcG9uZW50JywnSW52YWxpZCBDb29yZGluYXRlJywnUmluZyBpcyBub3QgY2xvc2VkJ107anN0cy5vcGVyYXRpb24udmFsaWQuVG9wb2xvZ3lWYWxpZGF0aW9uRXJyb3IucHJvdG90eXBlLmdldENvb3JkaW5hdGU9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5wdDt9O2pzdHMub3BlcmF0aW9uLnZhbGlkLlRvcG9sb2d5VmFsaWRhdGlvbkVycm9yLnByb3RvdHlwZS5nZXRFcnJvclR5cGU9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5lcnJvclR5cGU7fTtqc3RzLm9wZXJhdGlvbi52YWxpZC5Ub3BvbG9neVZhbGlkYXRpb25FcnJvci5wcm90b3R5cGUuZ2V0TWVzc2FnZT1mdW5jdGlvbigpe3JldHVybiB0aGlzLmVyck1zZ1t0aGlzLmVycm9yVHlwZV07fTtqc3RzLm9wZXJhdGlvbi52YWxpZC5Ub3BvbG9neVZhbGlkYXRpb25FcnJvci5wcm90b3R5cGUudG9TdHJpbmc9ZnVuY3Rpb24oKXt2YXIgbG9jU3RyPScnO2lmKHRoaXMucHQhPW51bGwpe2xvY1N0cj0nIGF0IG9yIG5lYXIgcG9pbnQgJyt0aGlzLnB0O3JldHVybiB0aGlzLmdldE1lc3NhZ2UoKStsb2NTdHI7fVxucmV0dXJuIGxvY1N0cjt9OyhmdW5jdGlvbigpe2pzdHMuZ2VvbS5NdWx0aVBvbHlnb249ZnVuY3Rpb24oZ2VvbWV0cmllcyxmYWN0b3J5KXt0aGlzLmdlb21ldHJpZXM9Z2VvbWV0cmllc3x8W107dGhpcy5mYWN0b3J5PWZhY3Rvcnk7fTtqc3RzLmdlb20uTXVsdGlQb2x5Z29uLnByb3RvdHlwZT1uZXcganN0cy5nZW9tLkdlb21ldHJ5Q29sbGVjdGlvbigpO2pzdHMuZ2VvbS5NdWx0aVBvbHlnb24uY29uc3RydWN0b3I9anN0cy5nZW9tLk11bHRpUG9seWdvbjtqc3RzLmdlb20uTXVsdGlQb2x5Z29uLnByb3RvdHlwZS5nZXRCb3VuZGFyeT1mdW5jdGlvbigpe2lmKHRoaXMuaXNFbXB0eSgpKXtyZXR1cm4gdGhpcy5nZXRGYWN0b3J5KCkuY3JlYXRlTXVsdGlMaW5lU3RyaW5nKG51bGwpO31cbnZhciBhbGxSaW5ncz1bXTtmb3IodmFyIGk9MDtpPHRoaXMuZ2VvbWV0cmllcy5sZW5ndGg7aSsrKXt2YXIgcG9seWdvbj10aGlzLmdlb21ldHJpZXNbaV07dmFyIHJpbmdzPXBvbHlnb24uZ2V0Qm91bmRhcnkoKTtmb3IodmFyIGo9MDtqPHJpbmdzLmdldE51bUdlb21ldHJpZXMoKTtqKyspe2FsbFJpbmdzLnB1c2gocmluZ3MuZ2V0R2VvbWV0cnlOKGopKTt9fVxucmV0dXJuIHRoaXMuZ2V0RmFjdG9yeSgpLmNyZWF0ZU11bHRpTGluZVN0cmluZyhhbGxSaW5ncyk7fTtqc3RzLmdlb20uTXVsdGlQb2x5Z29uLnByb3RvdHlwZS5lcXVhbHNFeGFjdD1mdW5jdGlvbihvdGhlcix0b2xlcmFuY2Upe2lmKCF0aGlzLmlzRXF1aXZhbGVudENsYXNzKG90aGVyKSl7cmV0dXJuIGZhbHNlO31cbnJldHVybiBqc3RzLmdlb20uR2VvbWV0cnlDb2xsZWN0aW9uLnByb3RvdHlwZS5lcXVhbHNFeGFjdC5jYWxsKHRoaXMsb3RoZXIsdG9sZXJhbmNlKTt9O2pzdHMuZ2VvbS5NdWx0aVBvbHlnb24ucHJvdG90eXBlLkNMQVNTX05BTUU9J2pzdHMuZ2VvbS5NdWx0aVBvbHlnb24nO30pKCk7anN0cy5nZW9tLkNvb3JkaW5hdGVTZXF1ZW5jZUZpbHRlcj1mdW5jdGlvbigpe307anN0cy5nZW9tLkNvb3JkaW5hdGVTZXF1ZW5jZUZpbHRlci5wcm90b3R5cGUuZmlsdGVyPWpzdHMuYWJzdHJhY3RGdW5jO2pzdHMuZ2VvbS5Db29yZGluYXRlU2VxdWVuY2VGaWx0ZXIucHJvdG90eXBlLmlzRG9uZT1qc3RzLmFic3RyYWN0RnVuYztqc3RzLmdlb20uQ29vcmRpbmF0ZVNlcXVlbmNlRmlsdGVyLnByb3RvdHlwZS5pc0dlb21ldHJ5Q2hhbmdlZD1qc3RzLmFic3RyYWN0RnVuYzsoZnVuY3Rpb24oKXt2YXIgSW50ZXJ2YWw9ZnVuY3Rpb24oKXt0aGlzLm1pbj0wLjA7dGhpcy5tYXg9MC4wO2lmKGFyZ3VtZW50cy5sZW5ndGg9PT0xKXt2YXIgaW50ZXJ2YWw9YXJndW1lbnRzWzBdO3RoaXMuaW5pdChpbnRlcnZhbC5taW4saW50ZXJ2YWwubWF4KTt9ZWxzZSBpZihhcmd1bWVudHMubGVuZ3RoPT09Mil7dGhpcy5pbml0KGFyZ3VtZW50c1swXSxhcmd1bWVudHNbMV0pO319O0ludGVydmFsLnByb3RvdHlwZS5pbml0PWZ1bmN0aW9uKG1pbixtYXgpe3RoaXMubWluPW1pbjt0aGlzLm1heD1tYXg7aWYobWluPm1heCl7dGhpcy5taW49bWF4O3RoaXMubWF4PW1pbjt9fTtJbnRlcnZhbC5wcm90b3R5cGUuZ2V0TWluPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMubWluO307SW50ZXJ2YWwucHJvdG90eXBlLmdldE1heD1mdW5jdGlvbigpe3JldHVybiB0aGlzLm1heDt9O0ludGVydmFsLnByb3RvdHlwZS5nZXRXaWR0aD1mdW5jdGlvbigpe3JldHVybih0aGlzLm1heC10aGlzLm1pbik7fTtJbnRlcnZhbC5wcm90b3R5cGUuZXhwYW5kVG9JbmNsdWRlPWZ1bmN0aW9uKGludGVydmFsKXtpZihpbnRlcnZhbC5tYXg+dGhpcy5tYXgpe3RoaXMubWF4PWludGVydmFsLm1heDt9XG5pZihpbnRlcnZhbC5taW48dGhpcy5taW4pe3RoaXMubWluPWludGVydmFsLm1pbjt9fTtJbnRlcnZhbC5wcm90b3R5cGUub3ZlcmxhcHM9ZnVuY3Rpb24oKXtpZihhcmd1bWVudHMubGVuZ3RoPT09MSl7cmV0dXJuIHRoaXMub3ZlcmxhcHNJbnRlcnZhbC5hcHBseSh0aGlzLGFyZ3VtZW50cyk7fWVsc2V7cmV0dXJuIHRoaXMub3ZlcmxhcHNNaW5NYXguYXBwbHkodGhpcyxhcmd1bWVudHMpO319O0ludGVydmFsLnByb3RvdHlwZS5vdmVybGFwc0ludGVydmFsPWZ1bmN0aW9uKGludGVydmFsKXtyZXR1cm4gdGhpcy5vdmVybGFwcyhpbnRlcnZhbC5taW4saW50ZXJ2YWwubWF4KTt9O0ludGVydmFsLnByb3RvdHlwZS5vdmVybGFwc01pbk1heD1mdW5jdGlvbihtaW4sbWF4KXtpZih0aGlzLm1pbj5tYXh8fHRoaXMubWF4PG1pbil7cmV0dXJuIGZhbHNlO31cbnJldHVybiB0cnVlO307SW50ZXJ2YWwucHJvdG90eXBlLmNvbnRhaW5zPWZ1bmN0aW9uKCl7dmFyIGludGVydmFsO2lmKGFyZ3VtZW50c1swXWluc3RhbmNlb2YganN0cy5pbmRleC5iaW50cmVlLkludGVydmFsKXtpbnRlcnZhbD1hcmd1bWVudHNbMF07cmV0dXJuIHRoaXMuY29udGFpbnNNaW5NYXgoaW50ZXJ2YWwubWluLGludGVydmFsLm1heCk7fWVsc2UgaWYoYXJndW1lbnRzLmxlbmd0aD09PTEpe3JldHVybiB0aGlzLmNvbnRhaW5zUG9pbnQoYXJndW1lbnRzWzBdKTt9ZWxzZXtyZXR1cm4gdGhpcy5jb250YWluc01pbk1heChhcmd1bWVudHNbMF0sYXJndW1lbnRzWzFdKTt9fTtJbnRlcnZhbC5wcm90b3R5cGUuY29udGFpbnNNaW5NYXg9ZnVuY3Rpb24obWluLG1heCl7cmV0dXJuKG1pbj49dGhpcy5taW4mJm1heDw9dGhpcy5tYXgpO307SW50ZXJ2YWwucHJvdG90eXBlLmNvbnRhaW5zUG9pbnQ9ZnVuY3Rpb24ocCl7cmV0dXJuKHA+PXRoaXMubWluJiZwPD10aGlzLm1heCk7fTtqc3RzLmluZGV4LmJpbnRyZWUuSW50ZXJ2YWw9SW50ZXJ2YWw7fSkoKTtqc3RzLmluZGV4LkRvdWJsZUJpdHM9ZnVuY3Rpb24oKXt9O2pzdHMuaW5kZXguRG91YmxlQml0cy5wb3dlck9mMj1mdW5jdGlvbihleHApe3JldHVybiBNYXRoLnBvdygyLGV4cCk7fTtqc3RzLmluZGV4LkRvdWJsZUJpdHMuZXhwb25lbnQ9ZnVuY3Rpb24oZCl7cmV0dXJuIGpzdHMuaW5kZXguRG91YmxlQml0cy5DVlRGV0QoNjQsZCktMTAyMzt9O2pzdHMuaW5kZXguRG91YmxlQml0cy5DVlRGV0Q9ZnVuY3Rpb24oTnVtVyxRdHkpe3ZhciBTaWduLEV4cG8sTWFudCxCaW4sbmIwMT0nJzt2YXIgSW5mPXszMjp7ZDoweDdGLGM6MHg4MCxiOjAsYTowfSw2NDp7ZDoweDdGRjAsYzowLGI6MCxhOjB9fTt2YXIgRXhXPXszMjo4LDY0OjExfVtOdW1XXSxNdFc9TnVtVy1FeFctMTtpZighQmluKXtTaWduPVF0eTwwfHwxL1F0eTwwO2lmKCFpc0Zpbml0ZShRdHkpKXtCaW49SW5mW051bVddO2lmKFNpZ24pe0Jpbi5kKz0xPDwoTnVtVy80LTEpO31cbkV4cG89TWF0aC5wb3coMixFeFcpLTE7TWFudD0wO319XG5pZighQmluKXtFeHBvPXszMjoxMjcsNjQ6MTAyM31bTnVtV107TWFudD1NYXRoLmFicyhRdHkpO3doaWxlKE1hbnQ+PTIpe0V4cG8rKztNYW50Lz0yO31cbndoaWxlKE1hbnQ8MSYmRXhwbz4wKXtFeHBvLS07TWFudCo9Mjt9XG5pZihFeHBvPD0wKXtNYW50Lz0yO25iMDE9J1plcm8gb3IgRGVub3JtYWwnO31cbmlmKE51bVc9PT0zMiYmRXhwbz4yNTQpe25iMDE9J1RvbyBiaWcgZm9yIFNpbmdsZSc7QmluPXtkOlNpZ24/MHhGRjoweDdGLGM6MHg4MCxiOjAsYTowfTtFeHBvPU1hdGgucG93KDIsRXhXKS0xO01hbnQ9MDt9fVxucmV0dXJuIEV4cG87fTsoZnVuY3Rpb24oKXt2YXIgRG91YmxlQml0cz1qc3RzLmluZGV4LkRvdWJsZUJpdHM7dmFyIEludGVydmFsPWpzdHMuaW5kZXguYmludHJlZS5JbnRlcnZhbDt2YXIgS2V5PWZ1bmN0aW9uKGludGVydmFsKXt0aGlzLnB0PTAuMDt0aGlzLmxldmVsPTA7dGhpcy5jb21wdXRlS2V5KGludGVydmFsKTt9O0tleS5jb21wdXRlTGV2ZWw9ZnVuY3Rpb24oaW50ZXJ2YWwpe3ZhciBkeD1pbnRlcnZhbC5nZXRXaWR0aCgpLGxldmVsO2xldmVsPURvdWJsZUJpdHMuZXhwb25lbnQoZHgpKzE7cmV0dXJuIGxldmVsO307S2V5LnByb3RvdHlwZS5nZXRQb2ludD1mdW5jdGlvbigpe3JldHVybiB0aGlzLnB0O307S2V5LnByb3RvdHlwZS5nZXRMZXZlbD1mdW5jdGlvbigpe3JldHVybiB0aGlzLmxldmVsO307S2V5LnByb3RvdHlwZS5nZXRJbnRlcnZhbD1mdW5jdGlvbigpe3JldHVybiB0aGlzLmludGVydmFsO307S2V5LnByb3RvdHlwZS5jb21wdXRlS2V5PWZ1bmN0aW9uKGl0ZW1JbnRlcnZhbCl7dGhpcy5sZXZlbD1LZXkuY29tcHV0ZUxldmVsKGl0ZW1JbnRlcnZhbCk7dGhpcy5pbnRlcnZhbD1uZXcgSW50ZXJ2YWwoKTt0aGlzLmNvbXB1dGVJbnRlcnZhbCh0aGlzLmxldmVsLGl0ZW1JbnRlcnZhbCk7d2hpbGUoIXRoaXMuaW50ZXJ2YWwuY29udGFpbnMoaXRlbUludGVydmFsKSl7dGhpcy5sZXZlbCs9MTt0aGlzLmNvbXB1dGVJbnRlcnZhbCh0aGlzLmxldmVsLGl0ZW1JbnRlcnZhbCk7fX07S2V5LnByb3RvdHlwZS5jb21wdXRlSW50ZXJ2YWw9ZnVuY3Rpb24obGV2ZWwsaXRlbUludGVydmFsKXt2YXIgc2l6ZT1Eb3VibGVCaXRzLnBvd2VyT2YyKGxldmVsKTt0aGlzLnB0PU1hdGguZmxvb3IoaXRlbUludGVydmFsLmdldE1pbigpL3NpemUpKnNpemU7dGhpcy5pbnRlcnZhbC5pbml0KHRoaXMucHQsdGhpcy5wdCtzaXplKTt9O2pzdHMuaW5kZXguYmludHJlZS5LZXk9S2V5O30pKCk7anN0cy5vcGVyYXRpb24uYnVmZmVyLlN1YmdyYXBoRGVwdGhMb2NhdGVyPWZ1bmN0aW9uKHN1YmdyYXBocyl7dGhpcy5zdWJncmFwaHM9W107dGhpcy5zZWc9bmV3IGpzdHMuZ2VvbS5MaW5lU2VnbWVudCgpO3RoaXMuc3ViZ3JhcGhzPXN1YmdyYXBoczt9O2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5TdWJncmFwaERlcHRoTG9jYXRlci5wcm90b3R5cGUuc3ViZ3JhcGhzPW51bGw7anN0cy5vcGVyYXRpb24uYnVmZmVyLlN1YmdyYXBoRGVwdGhMb2NhdGVyLnByb3RvdHlwZS5zZWc9bnVsbDtqc3RzLm9wZXJhdGlvbi5idWZmZXIuU3ViZ3JhcGhEZXB0aExvY2F0ZXIucHJvdG90eXBlLmdldERlcHRoPWZ1bmN0aW9uKHApe3ZhciBzdGFiYmVkU2VnbWVudHM9dGhpcy5maW5kU3RhYmJlZFNlZ21lbnRzKHApO2lmKHN0YWJiZWRTZWdtZW50cy5sZW5ndGg9PT0wKVxucmV0dXJuIDA7c3RhYmJlZFNlZ21lbnRzLnNvcnQoKTt2YXIgZHM9c3RhYmJlZFNlZ21lbnRzWzBdO3JldHVybiBkcy5sZWZ0RGVwdGg7fTtqc3RzLm9wZXJhdGlvbi5idWZmZXIuU3ViZ3JhcGhEZXB0aExvY2F0ZXIucHJvdG90eXBlLmZpbmRTdGFiYmVkU2VnbWVudHM9ZnVuY3Rpb24oc3RhYmJpbmdSYXlMZWZ0UHQpe2lmKGFyZ3VtZW50cy5sZW5ndGg9PT0zKXt0aGlzLmZpbmRTdGFiYmVkU2VnbWVudHMyLmFwcGx5KHRoaXMsYXJndW1lbnRzKTtyZXR1cm47fVxudmFyIHN0YWJiZWRTZWdtZW50cz1bXTtmb3IodmFyIGk9MDtpPHRoaXMuc3ViZ3JhcGhzLmxlbmd0aDtpKyspe3ZhciBic2c9dGhpcy5zdWJncmFwaHNbaV07dmFyIGVudj1ic2cuZ2V0RW52ZWxvcGUoKTtpZihzdGFiYmluZ1JheUxlZnRQdC55PGVudi5nZXRNaW5ZKCl8fHN0YWJiaW5nUmF5TGVmdFB0Lnk+ZW52LmdldE1heFkoKSlcbmNvbnRpbnVlO3RoaXMuZmluZFN0YWJiZWRTZWdtZW50czIoc3RhYmJpbmdSYXlMZWZ0UHQsYnNnLmdldERpcmVjdGVkRWRnZXMoKSxzdGFiYmVkU2VnbWVudHMpO31cbnJldHVybiBzdGFiYmVkU2VnbWVudHM7fTtqc3RzLm9wZXJhdGlvbi5idWZmZXIuU3ViZ3JhcGhEZXB0aExvY2F0ZXIucHJvdG90eXBlLmZpbmRTdGFiYmVkU2VnbWVudHMyPWZ1bmN0aW9uKHN0YWJiaW5nUmF5TGVmdFB0LGRpckVkZ2VzLHN0YWJiZWRTZWdtZW50cyl7aWYoYXJndW1lbnRzWzFdaW5zdGFuY2VvZiBqc3RzLmdlb21ncmFwaC5EaXJlY3RlZEVkZ2Upe3RoaXMuZmluZFN0YWJiZWRTZWdtZW50czMoc3RhYmJpbmdSYXlMZWZ0UHQsZGlyRWRnZXMsc3RhYmJlZFNlZ21lbnRzKTtyZXR1cm47fVxuZm9yKHZhciBpPWRpckVkZ2VzLml0ZXJhdG9yKCk7aS5oYXNOZXh0KCk7KXt2YXIgZGU9aS5uZXh0KCk7aWYoIWRlLmlzRm9yd2FyZCgpKVxuY29udGludWU7dGhpcy5maW5kU3RhYmJlZFNlZ21lbnRzMyhzdGFiYmluZ1JheUxlZnRQdCxkZSxzdGFiYmVkU2VnbWVudHMpO319O2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5TdWJncmFwaERlcHRoTG9jYXRlci5wcm90b3R5cGUuZmluZFN0YWJiZWRTZWdtZW50czM9ZnVuY3Rpb24oc3RhYmJpbmdSYXlMZWZ0UHQsZGlyRWRnZSxzdGFiYmVkU2VnbWVudHMpe3ZhciBwdHM9ZGlyRWRnZS5nZXRFZGdlKCkuZ2V0Q29vcmRpbmF0ZXMoKTtmb3IodmFyIGk9MDtpPHB0cy5sZW5ndGgtMTtpKyspe3RoaXMuc2VnLnAwPXB0c1tpXTt0aGlzLnNlZy5wMT1wdHNbaSsxXTtpZih0aGlzLnNlZy5wMC55PnRoaXMuc2VnLnAxLnkpXG50aGlzLnNlZy5yZXZlcnNlKCk7dmFyIG1heHg9TWF0aC5tYXgodGhpcy5zZWcucDAueCx0aGlzLnNlZy5wMS54KTtpZihtYXh4PHN0YWJiaW5nUmF5TGVmdFB0LngpXG5jb250aW51ZTtpZih0aGlzLnNlZy5pc0hvcml6b250YWwoKSlcbmNvbnRpbnVlO2lmKHN0YWJiaW5nUmF5TGVmdFB0Lnk8dGhpcy5zZWcucDAueXx8c3RhYmJpbmdSYXlMZWZ0UHQueT50aGlzLnNlZy5wMS55KVxuY29udGludWU7aWYoanN0cy5hbGdvcml0aG0uQ0dBbGdvcml0aG1zLmNvbXB1dGVPcmllbnRhdGlvbih0aGlzLnNlZy5wMCx0aGlzLnNlZy5wMSxzdGFiYmluZ1JheUxlZnRQdCk9PT1qc3RzLmFsZ29yaXRobS5DR0FsZ29yaXRobXMuUklHSFQpXG5jb250aW51ZTt2YXIgZGVwdGg9ZGlyRWRnZS5nZXREZXB0aChqc3RzLmdlb21ncmFwaC5Qb3NpdGlvbi5MRUZUKTtpZighdGhpcy5zZWcucDAuZXF1YWxzKHB0c1tpXSkpXG5kZXB0aD1kaXJFZGdlLmdldERlcHRoKGpzdHMuZ2VvbWdyYXBoLlBvc2l0aW9uLlJJR0hUKTt2YXIgZHM9bmV3IGpzdHMub3BlcmF0aW9uLmJ1ZmZlci5TdWJncmFwaERlcHRoTG9jYXRlci5EZXB0aFNlZ21lbnQodGhpcy5zZWcsZGVwdGgpO3N0YWJiZWRTZWdtZW50cy5wdXNoKGRzKTt9fTtqc3RzLm9wZXJhdGlvbi5idWZmZXIuU3ViZ3JhcGhEZXB0aExvY2F0ZXIuRGVwdGhTZWdtZW50PWZ1bmN0aW9uKHNlZyxkZXB0aCl7dGhpcy51cHdhcmRTZWc9bmV3IGpzdHMuZ2VvbS5MaW5lU2VnbWVudChzZWcpO3RoaXMubGVmdERlcHRoPWRlcHRoO307anN0cy5vcGVyYXRpb24uYnVmZmVyLlN1YmdyYXBoRGVwdGhMb2NhdGVyLkRlcHRoU2VnbWVudC5wcm90b3R5cGUudXB3YXJkU2VnPW51bGw7anN0cy5vcGVyYXRpb24uYnVmZmVyLlN1YmdyYXBoRGVwdGhMb2NhdGVyLkRlcHRoU2VnbWVudC5wcm90b3R5cGUubGVmdERlcHRoPW51bGw7anN0cy5vcGVyYXRpb24uYnVmZmVyLlN1YmdyYXBoRGVwdGhMb2NhdGVyLkRlcHRoU2VnbWVudC5wcm90b3R5cGUuY29tcGFyZVRvPWZ1bmN0aW9uKG9iail7dmFyIG90aGVyPW9iajt2YXIgb3JpZW50SW5kZXg9dGhpcy51cHdhcmRTZWcub3JpZW50YXRpb25JbmRleChvdGhlci51cHdhcmRTZWcpO2lmKG9yaWVudEluZGV4PT09MClcbm9yaWVudEluZGV4PS0xKm90aGVyLnVwd2FyZFNlZy5vcmllbnRhdGlvbkluZGV4KHVwd2FyZFNlZyk7aWYob3JpZW50SW5kZXghPT0wKVxucmV0dXJuIG9yaWVudEluZGV4O3JldHVybiB0aGlzLmNvbXBhcmVYKHRoaXMudXB3YXJkU2VnLG90aGVyLnVwd2FyZFNlZyk7fTtqc3RzLm9wZXJhdGlvbi5idWZmZXIuU3ViZ3JhcGhEZXB0aExvY2F0ZXIuRGVwdGhTZWdtZW50LnByb3RvdHlwZS5jb21wYXJlWD1mdW5jdGlvbihzZWcwLHNlZzEpe3ZhciBjb21wYXJlMD1zZWcwLnAwLmNvbXBhcmVUbyhzZWcxLnAwKTtpZihjb21wYXJlMCE9PTApXG5yZXR1cm4gY29tcGFyZTA7cmV0dXJuIHNlZzAucDEuY29tcGFyZVRvKHNlZzEucDEpO307anN0cy5ub2Rpbmcuc25hcHJvdW5kLkhvdFBpeGVsPWZ1bmN0aW9uKHB0LHNjYWxlRmFjdG9yLGxpKXt0aGlzLmNvcm5lcj1bXTt0aGlzLm9yaWdpbmFsUHQ9cHQ7dGhpcy5wdD1wdDt0aGlzLnNjYWxlRmFjdG9yPXNjYWxlRmFjdG9yO3RoaXMubGk9bGk7aWYodGhpcy5zY2FsZUZhY3RvciE9PTEuMCl7dGhpcy5wdD1uZXcganN0cy5nZW9tLkNvb3JkaW5hdGUodGhpcy5zY2FsZShwdC54KSx0aGlzLnNjYWxlKHB0LnkpKTt0aGlzLnAwU2NhbGVkPW5ldyBqc3RzLmdlb20uQ29vcmRpbmF0ZSgpO3RoaXMucDFTY2FsZWQ9bmV3IGpzdHMuZ2VvbS5Db29yZGluYXRlKCk7fVxudGhpcy5pbml0Q29ybmVycyh0aGlzLnB0KTt9O2pzdHMubm9kaW5nLnNuYXByb3VuZC5Ib3RQaXhlbC5wcm90b3R5cGUubGk9bnVsbDtqc3RzLm5vZGluZy5zbmFwcm91bmQuSG90UGl4ZWwucHJvdG90eXBlLnB0PW51bGw7anN0cy5ub2Rpbmcuc25hcHJvdW5kLkhvdFBpeGVsLnByb3RvdHlwZS5vcmlnaW5hbFB0PW51bGw7anN0cy5ub2Rpbmcuc25hcHJvdW5kLkhvdFBpeGVsLnByb3RvdHlwZS5wdFNjYWxlZD1udWxsO2pzdHMubm9kaW5nLnNuYXByb3VuZC5Ib3RQaXhlbC5wcm90b3R5cGUucDBTY2FsZWQ9bnVsbDtqc3RzLm5vZGluZy5zbmFwcm91bmQuSG90UGl4ZWwucHJvdG90eXBlLnAxU2NhbGVkPW51bGw7anN0cy5ub2Rpbmcuc25hcHJvdW5kLkhvdFBpeGVsLnByb3RvdHlwZS5zY2FsZUZhY3Rvcj11bmRlZmluZWQ7anN0cy5ub2Rpbmcuc25hcHJvdW5kLkhvdFBpeGVsLnByb3RvdHlwZS5taW54PXVuZGVmaW5lZDtqc3RzLm5vZGluZy5zbmFwcm91bmQuSG90UGl4ZWwucHJvdG90eXBlLm1heHg9dW5kZWZpbmVkO2pzdHMubm9kaW5nLnNuYXByb3VuZC5Ib3RQaXhlbC5wcm90b3R5cGUubWlueT11bmRlZmluZWQ7anN0cy5ub2Rpbmcuc25hcHJvdW5kLkhvdFBpeGVsLnByb3RvdHlwZS5tYXh5PXVuZGVmaW5lZDtqc3RzLm5vZGluZy5zbmFwcm91bmQuSG90UGl4ZWwucHJvdG90eXBlLmNvcm5lcj1udWxsO2pzdHMubm9kaW5nLnNuYXByb3VuZC5Ib3RQaXhlbC5wcm90b3R5cGUuc2FmZUVudj1udWxsO2pzdHMubm9kaW5nLnNuYXByb3VuZC5Ib3RQaXhlbC5wcm90b3R5cGUuZ2V0Q29vcmRpbmF0ZT1mdW5jdGlvbigpe3JldHVybiB0aGlzLm9yaWdpbmFsUHQ7fTtqc3RzLm5vZGluZy5zbmFwcm91bmQuSG90UGl4ZWwuU0FGRV9FTlZfRVhQQU5TSU9OX0ZBQ1RPUj0wLjc1O2pzdHMubm9kaW5nLnNuYXByb3VuZC5Ib3RQaXhlbC5wcm90b3R5cGUuZ2V0U2FmZUVudmVsb3BlPWZ1bmN0aW9uKCl7aWYodGhpcy5zYWZlRW52PT09bnVsbCl7dmFyIHNhZmVUb2xlcmFuY2U9anN0cy5ub2Rpbmcuc25hcHJvdW5kLkhvdFBpeGVsLlNBRkVfRU5WX0VYUEFOU0lPTl9GQUNUT1IvdGhpcy5zY2FsZUZhY3Rvcjt0aGlzLnNhZmVFbnY9bmV3IGpzdHMuZ2VvbS5FbnZlbG9wZSh0aGlzLm9yaWdpbmFsUHQueC1zYWZlVG9sZXJhbmNlLHRoaXMub3JpZ2luYWxQdC54K3NhZmVUb2xlcmFuY2UsdGhpcy5vcmlnaW5hbFB0Lnktc2FmZVRvbGVyYW5jZSx0aGlzLm9yaWdpbmFsUHQueStzYWZlVG9sZXJhbmNlKTt9XG5yZXR1cm4gdGhpcy5zYWZlRW52O307anN0cy5ub2Rpbmcuc25hcHJvdW5kLkhvdFBpeGVsLnByb3RvdHlwZS5pbml0Q29ybmVycz1mdW5jdGlvbihwdCl7dmFyIHRvbGVyYW5jZT0wLjU7dGhpcy5taW54PXB0LngtdG9sZXJhbmNlO3RoaXMubWF4eD1wdC54K3RvbGVyYW5jZTt0aGlzLm1pbnk9cHQueS10b2xlcmFuY2U7dGhpcy5tYXh5PXB0LnkrdG9sZXJhbmNlO3RoaXMuY29ybmVyWzBdPW5ldyBqc3RzLmdlb20uQ29vcmRpbmF0ZSh0aGlzLm1heHgsdGhpcy5tYXh5KTt0aGlzLmNvcm5lclsxXT1uZXcganN0cy5nZW9tLkNvb3JkaW5hdGUodGhpcy5taW54LHRoaXMubWF4eSk7dGhpcy5jb3JuZXJbMl09bmV3IGpzdHMuZ2VvbS5Db29yZGluYXRlKHRoaXMubWlueCx0aGlzLm1pbnkpO3RoaXMuY29ybmVyWzNdPW5ldyBqc3RzLmdlb20uQ29vcmRpbmF0ZSh0aGlzLm1heHgsdGhpcy5taW55KTt9O2pzdHMubm9kaW5nLnNuYXByb3VuZC5Ib3RQaXhlbC5wcm90b3R5cGUuc2NhbGU9ZnVuY3Rpb24odmFsKXtyZXR1cm4gTWF0aC5yb3VuZCh2YWwqdGhpcy5zY2FsZUZhY3Rvcik7fTtqc3RzLm5vZGluZy5zbmFwcm91bmQuSG90UGl4ZWwucHJvdG90eXBlLmludGVyc2VjdHM9ZnVuY3Rpb24ocDAscDEpe2lmKHRoaXMuc2NhbGVGYWN0b3I9PT0xLjApXG5yZXR1cm4gdGhpcy5pbnRlcnNlY3RzU2NhbGVkKHAwLHAxKTt0aGlzLmNvcHlTY2FsZWQocDAsdGhpcy5wMFNjYWxlZCk7dGhpcy5jb3B5U2NhbGVkKHAxLHRoaXMucDFTY2FsZWQpO3JldHVybiB0aGlzLmludGVyc2VjdHNTY2FsZWQodGhpcy5wMFNjYWxlZCx0aGlzLnAxU2NhbGVkKTt9O2pzdHMubm9kaW5nLnNuYXByb3VuZC5Ib3RQaXhlbC5wcm90b3R5cGUuY29weVNjYWxlZD1mdW5jdGlvbihwLHBTY2FsZWQpe3BTY2FsZWQueD10aGlzLnNjYWxlKHAueCk7cFNjYWxlZC55PXRoaXMuc2NhbGUocC55KTt9O2pzdHMubm9kaW5nLnNuYXByb3VuZC5Ib3RQaXhlbC5wcm90b3R5cGUuaW50ZXJzZWN0c1NjYWxlZD1mdW5jdGlvbihwMCxwMSl7dmFyIHNlZ01pbng9TWF0aC5taW4ocDAueCxwMS54KTt2YXIgc2VnTWF4eD1NYXRoLm1heChwMC54LHAxLngpO3ZhciBzZWdNaW55PU1hdGgubWluKHAwLnkscDEueSk7dmFyIHNlZ01heHk9TWF0aC5tYXgocDAueSxwMS55KTt2YXIgaXNPdXRzaWRlUGl4ZWxFbnY9dGhpcy5tYXh4PHNlZ01pbnh8fHRoaXMubWlueD5zZWdNYXh4fHx0aGlzLm1heHk8c2VnTWlueXx8dGhpcy5taW55PnNlZ01heHk7aWYoaXNPdXRzaWRlUGl4ZWxFbnYpXG5yZXR1cm4gZmFsc2U7dmFyIGludGVyc2VjdHM9dGhpcy5pbnRlcnNlY3RzVG9sZXJhbmNlU3F1YXJlKHAwLHAxKTtqc3RzLnV0aWwuQXNzZXJ0LmlzVHJ1ZSghKGlzT3V0c2lkZVBpeGVsRW52JiZpbnRlcnNlY3RzKSwnRm91bmQgYmFkIGVudmVsb3BlIHRlc3QnKTtyZXR1cm4gaW50ZXJzZWN0czt9O2pzdHMubm9kaW5nLnNuYXByb3VuZC5Ib3RQaXhlbC5wcm90b3R5cGUuaW50ZXJzZWN0c1RvbGVyYW5jZVNxdWFyZT1mdW5jdGlvbihwMCxwMSl7dmFyIGludGVyc2VjdHNMZWZ0PWZhbHNlO3ZhciBpbnRlcnNlY3RzQm90dG9tPWZhbHNlO3RoaXMubGkuY29tcHV0ZUludGVyc2VjdGlvbihwMCxwMSx0aGlzLmNvcm5lclswXSx0aGlzLmNvcm5lclsxXSk7aWYodGhpcy5saS5pc1Byb3BlcigpKVxucmV0dXJuIHRydWU7dGhpcy5saS5jb21wdXRlSW50ZXJzZWN0aW9uKHAwLHAxLHRoaXMuY29ybmVyWzFdLHRoaXMuY29ybmVyWzJdKTtpZih0aGlzLmxpLmlzUHJvcGVyKCkpXG5yZXR1cm4gdHJ1ZTtpZih0aGlzLmxpLmhhc0ludGVyc2VjdGlvbigpKVxuaW50ZXJzZWN0c0xlZnQ9dHJ1ZTt0aGlzLmxpLmNvbXB1dGVJbnRlcnNlY3Rpb24ocDAscDEsdGhpcy5jb3JuZXJbMl0sdGhpcy5jb3JuZXJbM10pO2lmKHRoaXMubGkuaXNQcm9wZXIoKSlcbnJldHVybiB0cnVlO2lmKHRoaXMubGkuaGFzSW50ZXJzZWN0aW9uKCkpXG5pbnRlcnNlY3RzQm90dG9tPXRydWU7dGhpcy5saS5jb21wdXRlSW50ZXJzZWN0aW9uKHAwLHAxLHRoaXMuY29ybmVyWzNdLHRoaXMuY29ybmVyWzBdKTtpZih0aGlzLmxpLmlzUHJvcGVyKCkpXG5yZXR1cm4gdHJ1ZTtpZihpbnRlcnNlY3RzTGVmdCYmaW50ZXJzZWN0c0JvdHRvbSlcbnJldHVybiB0cnVlO2lmKHAwLmVxdWFscyh0aGlzLnB0KSlcbnJldHVybiB0cnVlO2lmKHAxLmVxdWFscyh0aGlzLnB0KSlcbnJldHVybiB0cnVlO3JldHVybiBmYWxzZTt9O2pzdHMubm9kaW5nLnNuYXByb3VuZC5Ib3RQaXhlbC5wcm90b3R5cGUuaW50ZXJzZWN0c1BpeGVsQ2xvc3VyZT1mdW5jdGlvbihwMCxwMSl7dGhpcy5saS5jb21wdXRlSW50ZXJzZWN0aW9uKHAwLHAxLHRoaXMuY29ybmVyWzBdLHRoaXMuY29ybmVyWzFdKTtpZih0aGlzLmxpLmhhc0ludGVyc2VjdGlvbigpKVxucmV0dXJuIHRydWU7dGhpcy5saS5jb21wdXRlSW50ZXJzZWN0aW9uKHAwLHAxLHRoaXMuY29ybmVyWzFdLHRoaXMuY29ybmVyWzJdKTtpZih0aGlzLmxpLmhhc0ludGVyc2VjdGlvbigpKVxucmV0dXJuIHRydWU7dGhpcy5saS5jb21wdXRlSW50ZXJzZWN0aW9uKHAwLHAxLHRoaXMuY29ybmVyWzJdLHRoaXMuY29ybmVyWzNdKTtpZih0aGlzLmxpLmhhc0ludGVyc2VjdGlvbigpKVxucmV0dXJuIHRydWU7dGhpcy5saS5jb21wdXRlSW50ZXJzZWN0aW9uKHAwLHAxLHRoaXMuY29ybmVyWzNdLHRoaXMuY29ybmVyWzBdKTtpZih0aGlzLmxpLmhhc0ludGVyc2VjdGlvbigpKVxucmV0dXJuIHRydWU7cmV0dXJuIGZhbHNlO307anN0cy5ub2Rpbmcuc25hcHJvdW5kLkhvdFBpeGVsLnByb3RvdHlwZS5hZGRTbmFwcGVkTm9kZT1mdW5jdGlvbihzZWdTdHIsc2VnSW5kZXgpe3ZhciBwMD1zZWdTdHIuZ2V0Q29vcmRpbmF0ZShzZWdJbmRleCk7dmFyIHAxPXNlZ1N0ci5nZXRDb29yZGluYXRlKHNlZ0luZGV4KzEpO2lmKHRoaXMuaW50ZXJzZWN0cyhwMCxwMSkpe3NlZ1N0ci5hZGRJbnRlcnNlY3Rpb24odGhpcy5nZXRDb29yZGluYXRlKCksc2VnSW5kZXgpO3JldHVybiB0cnVlO31cbnJldHVybiBmYWxzZTt9O2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5CdWZmZXJJbnB1dExpbmVTaW1wbGlmaWVyPWZ1bmN0aW9uKGlucHV0TGluZSl7dGhpcy5pbnB1dExpbmU9aW5wdXRMaW5lO307anN0cy5vcGVyYXRpb24uYnVmZmVyLkJ1ZmZlcklucHV0TGluZVNpbXBsaWZpZXIuc2ltcGxpZnk9ZnVuY3Rpb24oaW5wdXRMaW5lLGRpc3RhbmNlVG9sKXt2YXIgc2ltcD1uZXcganN0cy5vcGVyYXRpb24uYnVmZmVyLkJ1ZmZlcklucHV0TGluZVNpbXBsaWZpZXIoaW5wdXRMaW5lKTtyZXR1cm4gc2ltcC5zaW1wbGlmeShkaXN0YW5jZVRvbCk7fTtqc3RzLm9wZXJhdGlvbi5idWZmZXIuQnVmZmVySW5wdXRMaW5lU2ltcGxpZmllci5JTklUPTA7anN0cy5vcGVyYXRpb24uYnVmZmVyLkJ1ZmZlcklucHV0TGluZVNpbXBsaWZpZXIuREVMRVRFPTE7anN0cy5vcGVyYXRpb24uYnVmZmVyLkJ1ZmZlcklucHV0TGluZVNpbXBsaWZpZXIuS0VFUD0xO2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5CdWZmZXJJbnB1dExpbmVTaW1wbGlmaWVyLnByb3RvdHlwZS5pbnB1dExpbmU9bnVsbDtqc3RzLm9wZXJhdGlvbi5idWZmZXIuQnVmZmVySW5wdXRMaW5lU2ltcGxpZmllci5wcm90b3R5cGUuZGlzdGFuY2VUb2w9bnVsbDtqc3RzLm9wZXJhdGlvbi5idWZmZXIuQnVmZmVySW5wdXRMaW5lU2ltcGxpZmllci5wcm90b3R5cGUuaXNEZWxldGVkPW51bGw7anN0cy5vcGVyYXRpb24uYnVmZmVyLkJ1ZmZlcklucHV0TGluZVNpbXBsaWZpZXIucHJvdG90eXBlLmFuZ2xlT3JpZW50YXRpb249anN0cy5hbGdvcml0aG0uQ0dBbGdvcml0aG1zLkNPVU5URVJDTE9DS1dJU0U7anN0cy5vcGVyYXRpb24uYnVmZmVyLkJ1ZmZlcklucHV0TGluZVNpbXBsaWZpZXIucHJvdG90eXBlLnNpbXBsaWZ5PWZ1bmN0aW9uKGRpc3RhbmNlVG9sKXt0aGlzLmRpc3RhbmNlVG9sPU1hdGguYWJzKGRpc3RhbmNlVG9sKTtpZihkaXN0YW5jZVRvbDwwKVxudGhpcy5hbmdsZU9yaWVudGF0aW9uPWpzdHMuYWxnb3JpdGhtLkNHQWxnb3JpdGhtcy5DTE9DS1dJU0U7dGhpcy5pc0RlbGV0ZWQ9W107dGhpcy5pc0RlbGV0ZWQubGVuZ3RoPXRoaXMuaW5wdXRMaW5lLmxlbmd0aDt2YXIgaXNDaGFuZ2VkPWZhbHNlO2Rve2lzQ2hhbmdlZD10aGlzLmRlbGV0ZVNoYWxsb3dDb25jYXZpdGllcygpO313aGlsZShpc0NoYW5nZWQpO3JldHVybiB0aGlzLmNvbGxhcHNlTGluZSgpO307anN0cy5vcGVyYXRpb24uYnVmZmVyLkJ1ZmZlcklucHV0TGluZVNpbXBsaWZpZXIucHJvdG90eXBlLmRlbGV0ZVNoYWxsb3dDb25jYXZpdGllcz1mdW5jdGlvbigpe3ZhciBpbmRleD0xO3ZhciBtYXhJbmRleD10aGlzLmlucHV0TGluZS5sZW5ndGgtMTt2YXIgbWlkSW5kZXg9dGhpcy5maW5kTmV4dE5vbkRlbGV0ZWRJbmRleChpbmRleCk7dmFyIGxhc3RJbmRleD10aGlzLmZpbmROZXh0Tm9uRGVsZXRlZEluZGV4KG1pZEluZGV4KTt2YXIgaXNDaGFuZ2VkPWZhbHNlO3doaWxlKGxhc3RJbmRleDx0aGlzLmlucHV0TGluZS5sZW5ndGgpe3ZhciBpc01pZGRsZVZlcnRleERlbGV0ZWQ9ZmFsc2U7aWYodGhpcy5pc0RlbGV0YWJsZShpbmRleCxtaWRJbmRleCxsYXN0SW5kZXgsdGhpcy5kaXN0YW5jZVRvbCkpe3RoaXMuaXNEZWxldGVkW21pZEluZGV4XT1qc3RzLm9wZXJhdGlvbi5idWZmZXIuQnVmZmVySW5wdXRMaW5lU2ltcGxpZmllci5ERUxFVEU7aXNNaWRkbGVWZXJ0ZXhEZWxldGVkPXRydWU7aXNDaGFuZ2VkPXRydWU7fVxuaWYoaXNNaWRkbGVWZXJ0ZXhEZWxldGVkKVxuaW5kZXg9bGFzdEluZGV4O2Vsc2VcbmluZGV4PW1pZEluZGV4O21pZEluZGV4PXRoaXMuZmluZE5leHROb25EZWxldGVkSW5kZXgoaW5kZXgpO2xhc3RJbmRleD10aGlzLmZpbmROZXh0Tm9uRGVsZXRlZEluZGV4KG1pZEluZGV4KTt9XG5yZXR1cm4gaXNDaGFuZ2VkO307anN0cy5vcGVyYXRpb24uYnVmZmVyLkJ1ZmZlcklucHV0TGluZVNpbXBsaWZpZXIucHJvdG90eXBlLmZpbmROZXh0Tm9uRGVsZXRlZEluZGV4PWZ1bmN0aW9uKGluZGV4KXt2YXIgbmV4dD1pbmRleCsxO3doaWxlKG5leHQ8dGhpcy5pbnB1dExpbmUubGVuZ3RoJiZ0aGlzLmlzRGVsZXRlZFtuZXh0XT09PWpzdHMub3BlcmF0aW9uLmJ1ZmZlci5CdWZmZXJJbnB1dExpbmVTaW1wbGlmaWVyLkRFTEVURSlcbm5leHQrKztyZXR1cm4gbmV4dDt9O2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5CdWZmZXJJbnB1dExpbmVTaW1wbGlmaWVyLnByb3RvdHlwZS5jb2xsYXBzZUxpbmU9ZnVuY3Rpb24oKXt2YXIgY29vcmRMaXN0PVtdO2Zvcih2YXIgaT0wO2k8dGhpcy5pbnB1dExpbmUubGVuZ3RoO2krKyl7aWYodGhpcy5pc0RlbGV0ZWRbaV0hPT1qc3RzLm9wZXJhdGlvbi5idWZmZXIuQnVmZmVySW5wdXRMaW5lU2ltcGxpZmllci5ERUxFVEUpXG5jb29yZExpc3QucHVzaCh0aGlzLmlucHV0TGluZVtpXSk7fVxucmV0dXJuIGNvb3JkTGlzdDt9O2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5CdWZmZXJJbnB1dExpbmVTaW1wbGlmaWVyLnByb3RvdHlwZS5pc0RlbGV0YWJsZT1mdW5jdGlvbihpMCxpMSxpMixkaXN0YW5jZVRvbCl7dmFyIHAwPXRoaXMuaW5wdXRMaW5lW2kwXTt2YXIgcDE9dGhpcy5pbnB1dExpbmVbaTFdO3ZhciBwMj10aGlzLmlucHV0TGluZVtpMl07aWYoIXRoaXMuaXNDb25jYXZlKHAwLHAxLHAyKSlcbnJldHVybiBmYWxzZTtpZighdGhpcy5pc1NoYWxsb3cocDAscDEscDIsZGlzdGFuY2VUb2wpKVxucmV0dXJuIGZhbHNlO3JldHVybiB0aGlzLmlzU2hhbGxvd1NhbXBsZWQocDAscDEsaTAsaTIsZGlzdGFuY2VUb2wpO307anN0cy5vcGVyYXRpb24uYnVmZmVyLkJ1ZmZlcklucHV0TGluZVNpbXBsaWZpZXIucHJvdG90eXBlLmlzU2hhbGxvd0NvbmNhdml0eT1mdW5jdGlvbihwMCxwMSxwMixkaXN0YW5jZVRvbCl7dmFyIG9yaWVudGF0aW9uPWpzdHMuYWxnb3JpdGhtLkNHQWxnb3JpdGhtcy5jb21wdXRlT3JpZW50YXRpb24ocDAscDEscDIpO3ZhciBpc0FuZ2xlVG9TaW1wbGlmeT0ob3JpZW50YXRpb249PT10aGlzLmFuZ2xlT3JpZW50YXRpb24pO2lmKCFpc0FuZ2xlVG9TaW1wbGlmeSlcbnJldHVybiBmYWxzZTt2YXIgZGlzdD1qc3RzLmFsZ29yaXRobS5DR0FsZ29yaXRobXMuZGlzdGFuY2VQb2ludExpbmUocDEscDAscDIpO3JldHVybiBkaXN0PGRpc3RhbmNlVG9sO307anN0cy5vcGVyYXRpb24uYnVmZmVyLkJ1ZmZlcklucHV0TGluZVNpbXBsaWZpZXIuTlVNX1BUU19UT19DSEVDSz0xMDtqc3RzLm9wZXJhdGlvbi5idWZmZXIuQnVmZmVySW5wdXRMaW5lU2ltcGxpZmllci5wcm90b3R5cGUuaXNTaGFsbG93U2FtcGxlZD1mdW5jdGlvbihwMCxwMixpMCxpMixkaXN0YW5jZVRvbCl7dmFyIGluYz1wYXJzZUludCgoaTItaTApL2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5CdWZmZXJJbnB1dExpbmVTaW1wbGlmaWVyLk5VTV9QVFNfVE9fQ0hFQ0spO2lmKGluYzw9MClcbmluYz0xO2Zvcih2YXIgaT1pMDtpPGkyO2krPWluYyl7aWYoIXRoaXMuaXNTaGFsbG93KHAwLHAyLHRoaXMuaW5wdXRMaW5lW2ldLGRpc3RhbmNlVG9sKSlcbnJldHVybiBmYWxzZTt9XG5yZXR1cm4gdHJ1ZTt9O2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5CdWZmZXJJbnB1dExpbmVTaW1wbGlmaWVyLnByb3RvdHlwZS5pc1NoYWxsb3c9ZnVuY3Rpb24ocDAscDEscDIsZGlzdGFuY2VUb2wpe3ZhciBkaXN0PWpzdHMuYWxnb3JpdGhtLkNHQWxnb3JpdGhtcy5kaXN0YW5jZVBvaW50TGluZShwMSxwMCxwMik7cmV0dXJuIGRpc3Q8ZGlzdGFuY2VUb2w7fTtqc3RzLm9wZXJhdGlvbi5idWZmZXIuQnVmZmVySW5wdXRMaW5lU2ltcGxpZmllci5wcm90b3R5cGUuaXNDb25jYXZlPWZ1bmN0aW9uKHAwLHAxLHAyKXt2YXIgb3JpZW50YXRpb249anN0cy5hbGdvcml0aG0uQ0dBbGdvcml0aG1zLmNvbXB1dGVPcmllbnRhdGlvbihwMCxwMSxwMik7dmFyIGlzQ29uY2F2ZT0ob3JpZW50YXRpb249PT10aGlzLmFuZ2xlT3JpZW50YXRpb24pO3JldHVybiBpc0NvbmNhdmU7fTtqc3RzLmdlb21ncmFwaC5pbmRleC5Td2VlcExpbmVFdmVudD1mdW5jdGlvbih4LG9iaixsYWJlbCl7aWYoIShvYmogaW5zdGFuY2VvZiBqc3RzLmdlb21ncmFwaC5pbmRleC5Td2VlcExpbmVFdmVudCkpe3RoaXMuZXZlbnRUeXBlPWpzdHMuZ2VvbWdyYXBoLmluZGV4LlN3ZWVwTGluZUV2ZW50LklOU0VSVDt0aGlzLmxhYmVsPWxhYmVsO3RoaXMueFZhbHVlPXg7dGhpcy5vYmo9b2JqO3JldHVybjt9XG50aGlzLmV2ZW50VHlwZT1qc3RzLmdlb21ncmFwaC5pbmRleC5Td2VlcExpbmVFdmVudC5ERUxFVEU7dGhpcy54VmFsdWU9eDt0aGlzLmluc2VydEV2ZW50PW9iajt9O2pzdHMuZ2VvbWdyYXBoLmluZGV4LlN3ZWVwTGluZUV2ZW50LklOU0VSVD0xO2pzdHMuZ2VvbWdyYXBoLmluZGV4LlN3ZWVwTGluZUV2ZW50LkRFTEVURT0yO2pzdHMuZ2VvbWdyYXBoLmluZGV4LlN3ZWVwTGluZUV2ZW50LnByb3RvdHlwZS5sYWJlbD1udWxsO2pzdHMuZ2VvbWdyYXBoLmluZGV4LlN3ZWVwTGluZUV2ZW50LnByb3RvdHlwZS54VmFsdWU9bnVsbDtqc3RzLmdlb21ncmFwaC5pbmRleC5Td2VlcExpbmVFdmVudC5wcm90b3R5cGUuZXZlbnRUeXBlPW51bGw7anN0cy5nZW9tZ3JhcGguaW5kZXguU3dlZXBMaW5lRXZlbnQucHJvdG90eXBlLmluc2VydEV2ZW50PW51bGw7anN0cy5nZW9tZ3JhcGguaW5kZXguU3dlZXBMaW5lRXZlbnQucHJvdG90eXBlLmRlbGV0ZUV2ZW50SW5kZXg9bnVsbDtqc3RzLmdlb21ncmFwaC5pbmRleC5Td2VlcExpbmVFdmVudC5wcm90b3R5cGUub2JqPW51bGw7anN0cy5nZW9tZ3JhcGguaW5kZXguU3dlZXBMaW5lRXZlbnQucHJvdG90eXBlLmlzSW5zZXJ0PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZXZlbnRUeXBlPT1qc3RzLmdlb21ncmFwaC5pbmRleC5Td2VlcExpbmVFdmVudC5JTlNFUlQ7fTtqc3RzLmdlb21ncmFwaC5pbmRleC5Td2VlcExpbmVFdmVudC5wcm90b3R5cGUuaXNEZWxldGU9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5ldmVudFR5cGU9PWpzdHMuZ2VvbWdyYXBoLmluZGV4LlN3ZWVwTGluZUV2ZW50LkRFTEVURTt9O2pzdHMuZ2VvbWdyYXBoLmluZGV4LlN3ZWVwTGluZUV2ZW50LnByb3RvdHlwZS5nZXRJbnNlcnRFdmVudD1mdW5jdGlvbigpe3JldHVybiB0aGlzLmluc2VydEV2ZW50O307anN0cy5nZW9tZ3JhcGguaW5kZXguU3dlZXBMaW5lRXZlbnQucHJvdG90eXBlLmdldERlbGV0ZUV2ZW50SW5kZXg9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5kZWxldGVFdmVudEluZGV4O307anN0cy5nZW9tZ3JhcGguaW5kZXguU3dlZXBMaW5lRXZlbnQucHJvdG90eXBlLnNldERlbGV0ZUV2ZW50SW5kZXg9ZnVuY3Rpb24oZGVsZXRlRXZlbnRJbmRleCl7dGhpcy5kZWxldGVFdmVudEluZGV4PWRlbGV0ZUV2ZW50SW5kZXg7fTtqc3RzLmdlb21ncmFwaC5pbmRleC5Td2VlcExpbmVFdmVudC5wcm90b3R5cGUuZ2V0T2JqZWN0PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMub2JqO307anN0cy5nZW9tZ3JhcGguaW5kZXguU3dlZXBMaW5lRXZlbnQucHJvdG90eXBlLmlzU2FtZUxhYmVsPWZ1bmN0aW9uKGV2KXtpZih0aGlzLmxhYmVsPT1udWxsKXtyZXR1cm4gZmFsc2U7fVxucmV0dXJuIHRoaXMubGFiZWw9PWV2LmxhYmVsO307anN0cy5nZW9tZ3JhcGguaW5kZXguU3dlZXBMaW5lRXZlbnQucHJvdG90eXBlLmNvbXBhcmVUbz1mdW5jdGlvbihwZSl7aWYodGhpcy54VmFsdWU8cGUueFZhbHVlKXtyZXR1cm4tMTt9XG5pZih0aGlzLnhWYWx1ZT5wZS54VmFsdWUpe3JldHVybiAxO31cbmlmKHRoaXMuZXZlbnRUeXBlPHBlLmV2ZW50VHlwZSl7cmV0dXJuLTE7fVxuaWYodGhpcy5ldmVudFR5cGU+cGUuZXZlbnRUeXBlKXtyZXR1cm4gMTt9XG5yZXR1cm4gMDt9O2pzdHMuZ2VvbS5Db29yZGluYXRlTGlzdD1mdW5jdGlvbihjb29yZCxhbGxvd1JlcGVhdGVkKXt0aGlzLmFycmF5PVtdO2FsbG93UmVwZWF0ZWQ9KGFsbG93UmVwZWF0ZWQ9PT11bmRlZmluZWQpP3RydWU6YWxsb3dSZXBlYXRlZDtpZihjb29yZCE9PXVuZGVmaW5lZCl7dGhpcy5hZGQoY29vcmQsYWxsb3dSZXBlYXRlZCk7fX07anN0cy5nZW9tLkNvb3JkaW5hdGVMaXN0LnByb3RvdHlwZT1uZXcgamF2YXNjcmlwdC51dGlsLkFycmF5TGlzdCgpO2pzdHMuZ2VvbS5Db29yZGluYXRlTGlzdC5wcm90b3R5cGUuaXRlcmF0b3I9bnVsbDtqc3RzLmdlb20uQ29vcmRpbmF0ZUxpc3QucHJvdG90eXBlLnJlbW92ZT1udWxsO2pzdHMuZ2VvbS5Db29yZGluYXRlTGlzdC5wcm90b3R5cGUuZ2V0PWZ1bmN0aW9uKGkpe3JldHVybiB0aGlzLmFycmF5W2ldO307anN0cy5nZW9tLkNvb3JkaW5hdGVMaXN0LnByb3RvdHlwZS5zZXQ9ZnVuY3Rpb24oaSxlKXt2YXIgbz10aGlzLmFycmF5W2ldO3RoaXMuYXJyYXlbaV09ZTtyZXR1cm4gbzt9O2pzdHMuZ2VvbS5Db29yZGluYXRlTGlzdC5wcm90b3R5cGUuc2l6ZT1mdW5jdGlvbigpe3JldHVybiB0aGlzLmFycmF5Lmxlbmd0aDt9O2pzdHMuZ2VvbS5Db29yZGluYXRlTGlzdC5wcm90b3R5cGUuYWRkPWZ1bmN0aW9uKCl7aWYoYXJndW1lbnRzLmxlbmd0aD4xKXtyZXR1cm4gdGhpcy5hZGRDb29yZGluYXRlcy5hcHBseSh0aGlzLGFyZ3VtZW50cyk7fWVsc2V7cmV0dXJuIHRoaXMuYXJyYXkucHVzaChhcmd1bWVudHNbMF0pO319O2pzdHMuZ2VvbS5Db29yZGluYXRlTGlzdC5wcm90b3R5cGUuYWRkQ29vcmRpbmF0ZXM9ZnVuY3Rpb24oY29vcmQsYWxsb3dSZXBlYXRlZCxkaXJlY3Rpb24pe2lmKGNvb3JkIGluc3RhbmNlb2YganN0cy5nZW9tLkNvb3JkaW5hdGUpe3JldHVybiB0aGlzLmFkZENvb3JkaW5hdGUuYXBwbHkodGhpcyxhcmd1bWVudHMpO31lbHNlIGlmKHR5cGVvZiBjb29yZD09PSdudW1iZXInKXtyZXR1cm4gdGhpcy5pbnNlcnRDb29yZGluYXRlLmFwcGx5KHRoaXMsYXJndW1lbnRzKTt9XG5kaXJlY3Rpb249ZGlyZWN0aW9ufHx0cnVlO2lmKGRpcmVjdGlvbil7Zm9yKHZhciBpPTA7aTxjb29yZC5sZW5ndGg7aSsrKXt0aGlzLmFkZENvb3JkaW5hdGUoY29vcmRbaV0sYWxsb3dSZXBlYXRlZCk7fX1lbHNle2Zvcih2YXIgaT1jb29yZC5sZW5ndGgtMTtpPj0wO2ktLSl7dGhpcy5hZGRDb29yZGluYXRlKGNvb3JkW2ldLGFsbG93UmVwZWF0ZWQpO319XG5yZXR1cm4gdHJ1ZTt9O2pzdHMuZ2VvbS5Db29yZGluYXRlTGlzdC5wcm90b3R5cGUuYWRkQ29vcmRpbmF0ZT1mdW5jdGlvbihjb29yZCxhbGxvd1JlcGVhdGVkKXtpZighYWxsb3dSZXBlYXRlZCl7aWYodGhpcy5zaXplKCk+PTEpe3ZhciBsYXN0PXRoaXMuZ2V0KHRoaXMuc2l6ZSgpLTEpO2lmKGxhc3QuZXF1YWxzMkQoY29vcmQpKXJldHVybjt9fVxudGhpcy5hZGQoY29vcmQpO307anN0cy5nZW9tLkNvb3JkaW5hdGVMaXN0LnByb3RvdHlwZS5pbnNlcnRDb29yZGluYXRlPWZ1bmN0aW9uKGluZGV4LGNvb3JkLGFsbG93UmVwZWF0ZWQpe2lmKCFhbGxvd1JlcGVhdGVkKXt2YXIgYmVmb3JlPWluZGV4PjA/aW5kZXgtMTotMTtpZihiZWZvcmUhPT0tMSYmdGhpcy5nZXQoYmVmb3JlKS5lcXVhbHMyRChjb29yZCkpe3JldHVybjt9XG52YXIgYWZ0ZXI9aW5kZXg8dGhpcy5zaXplKCktMT9pbmRleCsxOi0xO2lmKGFmdGVyIT09LTEmJnRoaXMuZ2V0KGFmdGVyKS5lcXVhbHMyRChjb29yZCkpe3JldHVybjt9fVxudGhpcy5hcnJheS5zcGxpY2UoaW5kZXgsMCxjb29yZCk7fTtqc3RzLmdlb20uQ29vcmRpbmF0ZUxpc3QucHJvdG90eXBlLmNsb3NlUmluZz1mdW5jdGlvbigpe2lmKHRoaXMuc2l6ZSgpPjApe3RoaXMuYWRkQ29vcmRpbmF0ZShuZXcganN0cy5nZW9tLkNvb3JkaW5hdGUodGhpcy5nZXQoMCkpLGZhbHNlKTt9fTtqc3RzLmdlb20uQ29vcmRpbmF0ZUxpc3QucHJvdG90eXBlLnRvQXJyYXk9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5hcnJheTt9O2pzdHMuZ2VvbS5Db29yZGluYXRlTGlzdC5wcm90b3R5cGUudG9Db29yZGluYXRlQXJyYXk9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5hcnJheTt9O2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5PZmZzZXRTZWdtZW50R2VuZXJhdG9yPWZ1bmN0aW9uKHByZWNpc2lvbk1vZGVsLGJ1ZlBhcmFtcyxkaXN0YW5jZSl7dGhpcy5zZWcwPW5ldyBqc3RzLmdlb20uTGluZVNlZ21lbnQoKTt0aGlzLnNlZzE9bmV3IGpzdHMuZ2VvbS5MaW5lU2VnbWVudCgpO3RoaXMub2Zmc2V0MD1uZXcganN0cy5nZW9tLkxpbmVTZWdtZW50KCk7dGhpcy5vZmZzZXQxPW5ldyBqc3RzLmdlb20uTGluZVNlZ21lbnQoKTt0aGlzLnByZWNpc2lvbk1vZGVsPXByZWNpc2lvbk1vZGVsO3RoaXMuYnVmUGFyYW1zPWJ1ZlBhcmFtczt0aGlzLmxpPW5ldyBqc3RzLmFsZ29yaXRobS5Sb2J1c3RMaW5lSW50ZXJzZWN0b3IoKTt0aGlzLmZpbGxldEFuZ2xlUXVhbnR1bT1NYXRoLlBJLzIuMC9idWZQYXJhbXMuZ2V0UXVhZHJhbnRTZWdtZW50cygpO2lmKHRoaXMuYnVmUGFyYW1zLmdldFF1YWRyYW50U2VnbWVudHMoKT49OCYmdGhpcy5idWZQYXJhbXMuZ2V0Sm9pblN0eWxlKCk9PT1qc3RzLm9wZXJhdGlvbi5idWZmZXIuQnVmZmVyUGFyYW1ldGVycy5KT0lOX1JPVU5EKXt0aGlzLmNsb3NpbmdTZWdMZW5ndGhGYWN0b3I9anN0cy5vcGVyYXRpb24uYnVmZmVyLk9mZnNldFNlZ21lbnRHZW5lcmF0b3IuTUFYX0NMT1NJTkdfU0VHX0xFTl9GQUNUT1I7fVxudGhpcy5pbml0KGRpc3RhbmNlKTt9O2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5PZmZzZXRTZWdtZW50R2VuZXJhdG9yLk9GRlNFVF9TRUdNRU5UX1NFUEFSQVRJT05fRkFDVE9SPTEuMEUtMztqc3RzLm9wZXJhdGlvbi5idWZmZXIuT2Zmc2V0U2VnbWVudEdlbmVyYXRvci5JTlNJREVfVFVSTl9WRVJURVhfU05BUF9ESVNUQU5DRV9GQUNUT1I9MS4wRS0zO2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5PZmZzZXRTZWdtZW50R2VuZXJhdG9yLkNVUlZFX1ZFUlRFWF9TTkFQX0RJU1RBTkNFX0ZBQ1RPUj0xLjBFLTY7anN0cy5vcGVyYXRpb24uYnVmZmVyLk9mZnNldFNlZ21lbnRHZW5lcmF0b3IuTUFYX0NMT1NJTkdfU0VHX0xFTl9GQUNUT1I9ODA7anN0cy5vcGVyYXRpb24uYnVmZmVyLk9mZnNldFNlZ21lbnRHZW5lcmF0b3IucHJvdG90eXBlLm1heEN1cnZlU2VnbWVudEVycm9yPTAuMDtqc3RzLm9wZXJhdGlvbi5idWZmZXIuT2Zmc2V0U2VnbWVudEdlbmVyYXRvci5wcm90b3R5cGUuZmlsbGV0QW5nbGVRdWFudHVtPW51bGw7anN0cy5vcGVyYXRpb24uYnVmZmVyLk9mZnNldFNlZ21lbnRHZW5lcmF0b3IucHJvdG90eXBlLmNsb3NpbmdTZWdMZW5ndGhGYWN0b3I9MTtqc3RzLm9wZXJhdGlvbi5idWZmZXIuT2Zmc2V0U2VnbWVudEdlbmVyYXRvci5wcm90b3R5cGUuc2VnTGlzdD1udWxsO2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5PZmZzZXRTZWdtZW50R2VuZXJhdG9yLnByb3RvdHlwZS5kaXN0YW5jZT0wLjA7anN0cy5vcGVyYXRpb24uYnVmZmVyLk9mZnNldFNlZ21lbnRHZW5lcmF0b3IucHJvdG90eXBlLnByZWNpc2lvbk1vZGVsPW51bGw7anN0cy5vcGVyYXRpb24uYnVmZmVyLk9mZnNldFNlZ21lbnRHZW5lcmF0b3IucHJvdG90eXBlLmJ1ZlBhcmFtcz1udWxsO2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5PZmZzZXRTZWdtZW50R2VuZXJhdG9yLnByb3RvdHlwZS5saT1udWxsO2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5PZmZzZXRTZWdtZW50R2VuZXJhdG9yLnByb3RvdHlwZS5zMD1udWxsO2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5PZmZzZXRTZWdtZW50R2VuZXJhdG9yLnByb3RvdHlwZS5zMT1udWxsO2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5PZmZzZXRTZWdtZW50R2VuZXJhdG9yLnByb3RvdHlwZS5zMj1udWxsO2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5PZmZzZXRTZWdtZW50R2VuZXJhdG9yLnByb3RvdHlwZS5zZWcwPW51bGw7anN0cy5vcGVyYXRpb24uYnVmZmVyLk9mZnNldFNlZ21lbnRHZW5lcmF0b3IucHJvdG90eXBlLnNlZzE9bnVsbDtqc3RzLm9wZXJhdGlvbi5idWZmZXIuT2Zmc2V0U2VnbWVudEdlbmVyYXRvci5wcm90b3R5cGUub2Zmc2V0MD1udWxsO2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5PZmZzZXRTZWdtZW50R2VuZXJhdG9yLnByb3RvdHlwZS5vZmZzZXQxPW51bGw7anN0cy5vcGVyYXRpb24uYnVmZmVyLk9mZnNldFNlZ21lbnRHZW5lcmF0b3IucHJvdG90eXBlLnNpZGU9MDtqc3RzLm9wZXJhdGlvbi5idWZmZXIuT2Zmc2V0U2VnbWVudEdlbmVyYXRvci5wcm90b3R5cGUuaGFzTmFycm93Q29uY2F2ZUFuZ2xlPWZhbHNlO2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5PZmZzZXRTZWdtZW50R2VuZXJhdG9yLnByb3RvdHlwZS5oYXNOYXJyb3dDb25jYXZlQW5nbGU9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5oYXNOYXJyb3dDb25jYXZlQW5nbGU7fTtqc3RzLm9wZXJhdGlvbi5idWZmZXIuT2Zmc2V0U2VnbWVudEdlbmVyYXRvci5wcm90b3R5cGUuaW5pdD1mdW5jdGlvbihkaXN0YW5jZSl7dGhpcy5kaXN0YW5jZT1kaXN0YW5jZTt0aGlzLm1heEN1cnZlU2VnbWVudEVycm9yPXRoaXMuZGlzdGFuY2UqKDEtTWF0aC5jb3ModGhpcy5maWxsZXRBbmdsZVF1YW50dW0vMi4wKSk7dGhpcy5zZWdMaXN0PW5ldyBqc3RzLm9wZXJhdGlvbi5idWZmZXIuT2Zmc2V0U2VnbWVudFN0cmluZygpO3RoaXMuc2VnTGlzdC5zZXRQcmVjaXNpb25Nb2RlbCh0aGlzLnByZWNpc2lvbk1vZGVsKTt0aGlzLnNlZ0xpc3Quc2V0TWluaW11bVZlcnRleERpc3RhbmNlKHRoaXMuZGlzdGFuY2UqanN0cy5vcGVyYXRpb24uYnVmZmVyLk9mZnNldFNlZ21lbnRHZW5lcmF0b3IuQ1VSVkVfVkVSVEVYX1NOQVBfRElTVEFOQ0VfRkFDVE9SKTt9O2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5PZmZzZXRTZWdtZW50R2VuZXJhdG9yLnByb3RvdHlwZS5pbml0U2lkZVNlZ21lbnRzPWZ1bmN0aW9uKHMxLHMyLHNpZGUpe3RoaXMuczE9czE7dGhpcy5zMj1zMjt0aGlzLnNpZGU9c2lkZTt0aGlzLnNlZzEuc2V0Q29vcmRpbmF0ZXModGhpcy5zMSx0aGlzLnMyKTt0aGlzLmNvbXB1dGVPZmZzZXRTZWdtZW50KHRoaXMuc2VnMSx0aGlzLnNpZGUsdGhpcy5kaXN0YW5jZSx0aGlzLm9mZnNldDEpO307anN0cy5vcGVyYXRpb24uYnVmZmVyLk9mZnNldFNlZ21lbnRHZW5lcmF0b3IucHJvdG90eXBlLmdldENvb3JkaW5hdGVzPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuc2VnTGlzdC5nZXRDb29yZGluYXRlcygpO307anN0cy5vcGVyYXRpb24uYnVmZmVyLk9mZnNldFNlZ21lbnRHZW5lcmF0b3IucHJvdG90eXBlLmNsb3NlUmluZz1mdW5jdGlvbigpe3RoaXMuc2VnTGlzdC5jbG9zZVJpbmcoKTt9O2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5PZmZzZXRTZWdtZW50R2VuZXJhdG9yLnByb3RvdHlwZS5hZGRTZWdtZW50cz1mdW5jdGlvbihwdCxpc0ZvcndhcmQpe3RoaXMuc2VnTGlzdC5hZGRQdHMocHQsaXNGb3J3YXJkKTt9O2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5PZmZzZXRTZWdtZW50R2VuZXJhdG9yLnByb3RvdHlwZS5hZGRGaXJzdFNlZ21lbnQ9ZnVuY3Rpb24oKXt0aGlzLnNlZ0xpc3QuYWRkUHQodGhpcy5vZmZzZXQxLnAwKTt9O2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5PZmZzZXRTZWdtZW50R2VuZXJhdG9yLnByb3RvdHlwZS5hZGRMYXN0U2VnbWVudD1mdW5jdGlvbigpe3RoaXMuc2VnTGlzdC5hZGRQdCh0aGlzLm9mZnNldDEucDEpO307anN0cy5vcGVyYXRpb24uYnVmZmVyLk9mZnNldFNlZ21lbnRHZW5lcmF0b3IucHJvdG90eXBlLmFkZE5leHRTZWdtZW50PWZ1bmN0aW9uKHAsYWRkU3RhcnRQb2ludCl7dGhpcy5zMD10aGlzLnMxO3RoaXMuczE9dGhpcy5zMjt0aGlzLnMyPXA7dGhpcy5zZWcwLnNldENvb3JkaW5hdGVzKHRoaXMuczAsdGhpcy5zMSk7dGhpcy5jb21wdXRlT2Zmc2V0U2VnbWVudCh0aGlzLnNlZzAsdGhpcy5zaWRlLHRoaXMuZGlzdGFuY2UsdGhpcy5vZmZzZXQwKTt0aGlzLnNlZzEuc2V0Q29vcmRpbmF0ZXModGhpcy5zMSx0aGlzLnMyKTt0aGlzLmNvbXB1dGVPZmZzZXRTZWdtZW50KHRoaXMuc2VnMSx0aGlzLnNpZGUsdGhpcy5kaXN0YW5jZSx0aGlzLm9mZnNldDEpO2lmKHRoaXMuczEuZXF1YWxzKHRoaXMuczIpKVxucmV0dXJuO3ZhciBvcmllbnRhdGlvbj1qc3RzLmFsZ29yaXRobS5DR0FsZ29yaXRobXMuY29tcHV0ZU9yaWVudGF0aW9uKHRoaXMuczAsdGhpcy5zMSx0aGlzLnMyKTt2YXIgb3V0c2lkZVR1cm49KG9yaWVudGF0aW9uPT09anN0cy5hbGdvcml0aG0uQ0dBbGdvcml0aG1zLkNMT0NLV0lTRSYmdGhpcy5zaWRlPT09anN0cy5nZW9tZ3JhcGguUG9zaXRpb24uTEVGVCl8fChvcmllbnRhdGlvbj09PWpzdHMuYWxnb3JpdGhtLkNHQWxnb3JpdGhtcy5DT1VOVEVSQ0xPQ0tXSVNFJiZ0aGlzLnNpZGU9PT1qc3RzLmdlb21ncmFwaC5Qb3NpdGlvbi5SSUdIVCk7aWYob3JpZW50YXRpb249PTApe3RoaXMuYWRkQ29sbGluZWFyKGFkZFN0YXJ0UG9pbnQpO31lbHNlIGlmKG91dHNpZGVUdXJuKXt0aGlzLmFkZE91dHNpZGVUdXJuKG9yaWVudGF0aW9uLGFkZFN0YXJ0UG9pbnQpO31lbHNle3RoaXMuYWRkSW5zaWRlVHVybihvcmllbnRhdGlvbixhZGRTdGFydFBvaW50KTt9fTtqc3RzLm9wZXJhdGlvbi5idWZmZXIuT2Zmc2V0U2VnbWVudEdlbmVyYXRvci5wcm90b3R5cGUuYWRkQ29sbGluZWFyPWZ1bmN0aW9uKGFkZFN0YXJ0UG9pbnQpe3RoaXMubGkuY29tcHV0ZUludGVyc2VjdGlvbih0aGlzLnMwLHRoaXMuczEsdGhpcy5zMSx0aGlzLnMyKTt2YXIgbnVtSW50PXRoaXMubGkuZ2V0SW50ZXJzZWN0aW9uTnVtKCk7aWYobnVtSW50Pj0yKXtpZih0aGlzLmJ1ZlBhcmFtcy5nZXRKb2luU3R5bGUoKT09PWpzdHMub3BlcmF0aW9uLmJ1ZmZlci5CdWZmZXJQYXJhbWV0ZXJzLkpPSU5fQkVWRUx8fHRoaXMuYnVmUGFyYW1zLmdldEpvaW5TdHlsZSgpPT09anN0cy5vcGVyYXRpb24uYnVmZmVyLkJ1ZmZlclBhcmFtZXRlcnMuSk9JTl9NSVRSRSl7aWYoYWRkU3RhcnRQb2ludClcbnRoaXMuc2VnTGlzdC5hZGRQdCh0aGlzLm9mZnNldDAucDEpO3RoaXMuc2VnTGlzdC5hZGRQdCh0aGlzLm9mZnNldDEucDApO31lbHNle3RoaXMuYWRkRmlsbGV0KHRoaXMuczEsdGhpcy5vZmZzZXQwLnAxLHRoaXMub2Zmc2V0MS5wMCxqc3RzLmFsZ29yaXRobS5DR0FsZ29yaXRobXMuQ0xPQ0tXSVNFLHRoaXMuZGlzdGFuY2UpO319fTtqc3RzLm9wZXJhdGlvbi5idWZmZXIuT2Zmc2V0U2VnbWVudEdlbmVyYXRvci5wcm90b3R5cGUuYWRkT3V0c2lkZVR1cm49ZnVuY3Rpb24ob3JpZW50YXRpb24sYWRkU3RhcnRQb2ludCl7aWYodGhpcy5vZmZzZXQwLnAxLmRpc3RhbmNlKHRoaXMub2Zmc2V0MS5wMCk8dGhpcy5kaXN0YW5jZSpqc3RzLm9wZXJhdGlvbi5idWZmZXIuT2Zmc2V0U2VnbWVudEdlbmVyYXRvci5PRkZTRVRfU0VHTUVOVF9TRVBBUkFUSU9OX0ZBQ1RPUil7dGhpcy5zZWdMaXN0LmFkZFB0KHRoaXMub2Zmc2V0MC5wMSk7cmV0dXJuO31cbmlmKHRoaXMuYnVmUGFyYW1zLmdldEpvaW5TdHlsZSgpPT09anN0cy5vcGVyYXRpb24uYnVmZmVyLkJ1ZmZlclBhcmFtZXRlcnMuSk9JTl9NSVRSRSl7dGhpcy5hZGRNaXRyZUpvaW4odGhpcy5zMSx0aGlzLm9mZnNldDAsdGhpcy5vZmZzZXQxLHRoaXMuZGlzdGFuY2UpO31lbHNlIGlmKHRoaXMuYnVmUGFyYW1zLmdldEpvaW5TdHlsZSgpPT09anN0cy5vcGVyYXRpb24uYnVmZmVyLkJ1ZmZlclBhcmFtZXRlcnMuSk9JTl9CRVZFTCl7dGhpcy5hZGRCZXZlbEpvaW4odGhpcy5vZmZzZXQwLHRoaXMub2Zmc2V0MSk7fWVsc2V7aWYoYWRkU3RhcnRQb2ludClcbnRoaXMuc2VnTGlzdC5hZGRQdCh0aGlzLm9mZnNldDAucDEpO3RoaXMuYWRkRmlsbGV0KHRoaXMuczEsdGhpcy5vZmZzZXQwLnAxLHRoaXMub2Zmc2V0MS5wMCxvcmllbnRhdGlvbix0aGlzLmRpc3RhbmNlKTt0aGlzLnNlZ0xpc3QuYWRkUHQodGhpcy5vZmZzZXQxLnAwKTt9fTtqc3RzLm9wZXJhdGlvbi5idWZmZXIuT2Zmc2V0U2VnbWVudEdlbmVyYXRvci5wcm90b3R5cGUuYWRkSW5zaWRlVHVybj1mdW5jdGlvbihvcmllbnRhdGlvbixhZGRTdGFydFBvaW50KXt0aGlzLmxpLmNvbXB1dGVJbnRlcnNlY3Rpb24odGhpcy5vZmZzZXQwLnAwLHRoaXMub2Zmc2V0MC5wMSx0aGlzLm9mZnNldDEucDAsdGhpcy5vZmZzZXQxLnAxKTtpZih0aGlzLmxpLmhhc0ludGVyc2VjdGlvbigpKXt0aGlzLnNlZ0xpc3QuYWRkUHQodGhpcy5saS5nZXRJbnRlcnNlY3Rpb24oMCkpO31lbHNle3RoaXMuaGFzTmFycm93Q29uY2F2ZUFuZ2xlPXRydWU7aWYodGhpcy5vZmZzZXQwLnAxLmRpc3RhbmNlKHRoaXMub2Zmc2V0MS5wMCk8dGhpcy5kaXN0YW5jZSpqc3RzLm9wZXJhdGlvbi5idWZmZXIuT2Zmc2V0U2VnbWVudEdlbmVyYXRvci5JTlNJREVfVFVSTl9WRVJURVhfU05BUF9ESVNUQU5DRV9GQUNUT1Ipe3RoaXMuc2VnTGlzdC5hZGRQdCh0aGlzLm9mZnNldDAucDEpO31lbHNle3RoaXMuc2VnTGlzdC5hZGRQdCh0aGlzLm9mZnNldDAucDEpO2lmKHRoaXMuY2xvc2luZ1NlZ0xlbmd0aEZhY3Rvcj4wKXt2YXIgbWlkMD1uZXcganN0cy5nZW9tLkNvb3JkaW5hdGUoKHRoaXMuY2xvc2luZ1NlZ0xlbmd0aEZhY3Rvcip0aGlzLm9mZnNldDAucDEueCt0aGlzLnMxLngpLyh0aGlzLmNsb3NpbmdTZWdMZW5ndGhGYWN0b3IrMSksKHRoaXMuY2xvc2luZ1NlZ0xlbmd0aEZhY3Rvcip0aGlzLm9mZnNldDAucDEueSt0aGlzLnMxLnkpLyh0aGlzLmNsb3NpbmdTZWdMZW5ndGhGYWN0b3IrMSkpO3RoaXMuc2VnTGlzdC5hZGRQdChtaWQwKTt2YXIgbWlkMT1uZXcganN0cy5nZW9tLkNvb3JkaW5hdGUoKHRoaXMuY2xvc2luZ1NlZ0xlbmd0aEZhY3Rvcip0aGlzLm9mZnNldDEucDAueCt0aGlzLnMxLngpLyh0aGlzLmNsb3NpbmdTZWdMZW5ndGhGYWN0b3IrMSksKHRoaXMuY2xvc2luZ1NlZ0xlbmd0aEZhY3Rvcip0aGlzLm9mZnNldDEucDAueSt0aGlzLnMxLnkpLyh0aGlzLmNsb3NpbmdTZWdMZW5ndGhGYWN0b3IrMSkpO3RoaXMuc2VnTGlzdC5hZGRQdChtaWQxKTt9ZWxzZXt0aGlzLnNlZ0xpc3QuYWRkUHQodGhpcy5zMSk7fVxudGhpcy5zZWdMaXN0LmFkZFB0KHRoaXMub2Zmc2V0MS5wMCk7fX19O2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5PZmZzZXRTZWdtZW50R2VuZXJhdG9yLnByb3RvdHlwZS5jb21wdXRlT2Zmc2V0U2VnbWVudD1mdW5jdGlvbihzZWcsc2lkZSxkaXN0YW5jZSxvZmZzZXQpe3ZhciBzaWRlU2lnbj1zaWRlPT09anN0cy5nZW9tZ3JhcGguUG9zaXRpb24uTEVGVD8xOi0xO3ZhciBkeD1zZWcucDEueC1zZWcucDAueDt2YXIgZHk9c2VnLnAxLnktc2VnLnAwLnk7dmFyIGxlbj1NYXRoLnNxcnQoZHgqZHgrZHkqZHkpO3ZhciB1eD1zaWRlU2lnbipkaXN0YW5jZSpkeC9sZW47dmFyIHV5PXNpZGVTaWduKmRpc3RhbmNlKmR5L2xlbjtvZmZzZXQucDAueD1zZWcucDAueC11eTtvZmZzZXQucDAueT1zZWcucDAueSt1eDtvZmZzZXQucDEueD1zZWcucDEueC11eTtvZmZzZXQucDEueT1zZWcucDEueSt1eDt9O2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5PZmZzZXRTZWdtZW50R2VuZXJhdG9yLnByb3RvdHlwZS5hZGRMaW5lRW5kQ2FwPWZ1bmN0aW9uKHAwLHAxKXt2YXIgc2VnPW5ldyBqc3RzLmdlb20uTGluZVNlZ21lbnQocDAscDEpO3ZhciBvZmZzZXRMPW5ldyBqc3RzLmdlb20uTGluZVNlZ21lbnQoKTt0aGlzLmNvbXB1dGVPZmZzZXRTZWdtZW50KHNlZyxqc3RzLmdlb21ncmFwaC5Qb3NpdGlvbi5MRUZULHRoaXMuZGlzdGFuY2Usb2Zmc2V0TCk7dmFyIG9mZnNldFI9bmV3IGpzdHMuZ2VvbS5MaW5lU2VnbWVudCgpO3RoaXMuY29tcHV0ZU9mZnNldFNlZ21lbnQoc2VnLGpzdHMuZ2VvbWdyYXBoLlBvc2l0aW9uLlJJR0hULHRoaXMuZGlzdGFuY2Usb2Zmc2V0Uik7dmFyIGR4PXAxLngtcDAueDt2YXIgZHk9cDEueS1wMC55O3ZhciBhbmdsZT1NYXRoLmF0YW4yKGR5LGR4KTtzd2l0Y2godGhpcy5idWZQYXJhbXMuZ2V0RW5kQ2FwU3R5bGUoKSl7Y2FzZSBqc3RzLm9wZXJhdGlvbi5idWZmZXIuQnVmZmVyUGFyYW1ldGVycy5DQVBfUk9VTkQ6dGhpcy5zZWdMaXN0LmFkZFB0KG9mZnNldEwucDEpO3RoaXMuYWRkRmlsbGV0KHAxLGFuZ2xlK01hdGguUEkvMixhbmdsZS1NYXRoLlBJLzIsanN0cy5hbGdvcml0aG0uQ0dBbGdvcml0aG1zLkNMT0NLV0lTRSx0aGlzLmRpc3RhbmNlKTt0aGlzLnNlZ0xpc3QuYWRkUHQob2Zmc2V0Ui5wMSk7YnJlYWs7Y2FzZSBqc3RzLm9wZXJhdGlvbi5idWZmZXIuQnVmZmVyUGFyYW1ldGVycy5DQVBfRkxBVDp0aGlzLnNlZ0xpc3QuYWRkUHQob2Zmc2V0TC5wMSk7dGhpcy5zZWdMaXN0LmFkZFB0KG9mZnNldFIucDEpO2JyZWFrO2Nhc2UganN0cy5vcGVyYXRpb24uYnVmZmVyLkJ1ZmZlclBhcmFtZXRlcnMuQ0FQX1NRVUFSRTp2YXIgc3F1YXJlQ2FwU2lkZU9mZnNldD1uZXcganN0cy5nZW9tLkNvb3JkaW5hdGUoKTtzcXVhcmVDYXBTaWRlT2Zmc2V0Lng9TWF0aC5hYnModGhpcy5kaXN0YW5jZSkqTWF0aC5jb3MoYW5nbGUpO3NxdWFyZUNhcFNpZGVPZmZzZXQueT1NYXRoLmFicyh0aGlzLmRpc3RhbmNlKSpNYXRoLnNpbihhbmdsZSk7dmFyIHNxdWFyZUNhcExPZmZzZXQ9bmV3IGpzdHMuZ2VvbS5Db29yZGluYXRlKG9mZnNldEwucDEueCtcbnNxdWFyZUNhcFNpZGVPZmZzZXQueCxvZmZzZXRMLnAxLnkrc3F1YXJlQ2FwU2lkZU9mZnNldC55KTt2YXIgc3F1YXJlQ2FwUk9mZnNldD1uZXcganN0cy5nZW9tLkNvb3JkaW5hdGUob2Zmc2V0Ui5wMS54K1xuc3F1YXJlQ2FwU2lkZU9mZnNldC54LG9mZnNldFIucDEueStzcXVhcmVDYXBTaWRlT2Zmc2V0LnkpO3RoaXMuc2VnTGlzdC5hZGRQdChzcXVhcmVDYXBMT2Zmc2V0KTt0aGlzLnNlZ0xpc3QuYWRkUHQoc3F1YXJlQ2FwUk9mZnNldCk7YnJlYWs7fX07anN0cy5vcGVyYXRpb24uYnVmZmVyLk9mZnNldFNlZ21lbnRHZW5lcmF0b3IucHJvdG90eXBlLmFkZE1pdHJlSm9pbj1mdW5jdGlvbihwLG9mZnNldDAsb2Zmc2V0MSxkaXN0YW5jZSl7dmFyIGlzTWl0cmVXaXRoaW5MaW1pdD10cnVlO3ZhciBpbnRQdD1udWxsO3RyeXtpbnRQdD1qc3RzLmFsZ29yaXRobS5IQ29vcmRpbmF0ZS5pbnRlcnNlY3Rpb24ob2Zmc2V0MC5wMCxvZmZzZXQwLnAxLG9mZnNldDEucDAsb2Zmc2V0MS5wMSk7dmFyIG1pdHJlUmF0aW89ZGlzdGFuY2U8PTAuMD8xLjA6aW50UHQuZGlzdGFuY2UocCkvTWF0aC5hYnMoZGlzdGFuY2UpO2lmKG1pdHJlUmF0aW8+dGhpcy5idWZQYXJhbXMuZ2V0TWl0cmVMaW1pdCgpKVxudGhpcy5pc01pdHJlV2l0aGluTGltaXQ9ZmFsc2U7fWNhdGNoKGUpe2lmKGUgaW5zdGFuY2VvZiBqc3RzLmVycm9yLk5vdFJlcHJlc2VudGFibGVFcnJvcil7aW50UHQ9bmV3IGpzdHMuZ2VvbS5Db29yZGluYXRlKDAsMCk7dGhpcy5pc01pdHJlV2l0aGluTGltaXQ9ZmFsc2U7fX1cbmlmKGlzTWl0cmVXaXRoaW5MaW1pdCl7dGhpcy5zZWdMaXN0LmFkZFB0KGludFB0KTt9ZWxzZXt0aGlzLmFkZExpbWl0ZWRNaXRyZUpvaW4ob2Zmc2V0MCxvZmZzZXQxLGRpc3RhbmNlLGJ1ZlBhcmFtcy5nZXRNaXRyZUxpbWl0KCkpO319O2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5PZmZzZXRTZWdtZW50R2VuZXJhdG9yLnByb3RvdHlwZS5hZGRMaW1pdGVkTWl0cmVKb2luPWZ1bmN0aW9uKG9mZnNldDAsb2Zmc2V0MSxkaXN0YW5jZSxtaXRyZUxpbWl0KXt2YXIgYmFzZVB0PXRoaXMuc2VnMC5wMTt2YXIgYW5nMD1qc3RzLmFsZ29yaXRobS5BbmdsZS5hbmdsZShiYXNlUHQsdGhpcy5zZWcwLnAwKTt2YXIgYW5nMT1qc3RzLmFsZ29yaXRobS5BbmdsZS5hbmdsZShiYXNlUHQsdGhpcy5zZWcxLnAxKTt2YXIgYW5nRGlmZj1qc3RzLmFsZ29yaXRobS5BbmdsZS5hbmdsZUJldHdlZW5PcmllbnRlZCh0aGlzLnNlZzAucDAsYmFzZVB0LHRoaXMuc2VnMS5wMSk7dmFyIGFuZ0RpZmZIYWxmPWFuZ0RpZmYvMjt2YXIgbWlkQW5nPWpzdHMuYWxnb3JpdGhtLkFuZ2xlLm5vcm1hbGl6ZShhbmcwK2FuZ0RpZmZIYWxmKTt2YXIgbWl0cmVNaWRBbmc9anN0cy5hbGdvcml0aG0uQW5nbGUubm9ybWFsaXplKG1pZEFuZytNYXRoLlBJKTt2YXIgbWl0cmVEaXN0PW1pdHJlTGltaXQqZGlzdGFuY2U7dmFyIGJldmVsRGVsdGE9bWl0cmVEaXN0Kk1hdGguYWJzKE1hdGguc2luKGFuZ0RpZmZIYWxmKSk7dmFyIGJldmVsSGFsZkxlbj1kaXN0YW5jZS1iZXZlbERlbHRhO3ZhciBiZXZlbE1pZFg9YmFzZVB0LngrbWl0cmVEaXN0Kk1hdGguY29zKG1pdHJlTWlkQW5nKTt2YXIgYmV2ZWxNaWRZPWJhc2VQdC55K21pdHJlRGlzdCpNYXRoLnNpbihtaXRyZU1pZEFuZyk7dmFyIGJldmVsTWlkUHQ9bmV3IGpzdHMuZ2VvbS5Db29yZGluYXRlKGJldmVsTWlkWCxiZXZlbE1pZFkpO3ZhciBtaXRyZU1pZExpbmU9bmV3IGpzdHMuZ2VvbS5MaW5lU2VnbWVudChiYXNlUHQsYmV2ZWxNaWRQdCk7dmFyIGJldmVsRW5kTGVmdD1taXRyZU1pZExpbmUucG9pbnRBbG9uZ09mZnNldCgxLjAsYmV2ZWxIYWxmTGVuKTt2YXIgYmV2ZWxFbmRSaWdodD1taXRyZU1pZExpbmUucG9pbnRBbG9uZ09mZnNldCgxLjAsLWJldmVsSGFsZkxlbik7aWYodGhpcy5zaWRlPT1qc3RzLmdlb21ncmFwaC5Qb3NpdGlvbi5MRUZUKXt0aGlzLnNlZ0xpc3QuYWRkUHQoYmV2ZWxFbmRMZWZ0KTt0aGlzLnNlZ0xpc3QuYWRkUHQoYmV2ZWxFbmRSaWdodCk7fWVsc2V7dGhpcy5zZWdMaXN0LmFkZFB0KGJldmVsRW5kUmlnaHQpO3RoaXMuc2VnTGlzdC5hZGRQdChiZXZlbEVuZExlZnQpO319O2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5PZmZzZXRTZWdtZW50R2VuZXJhdG9yLnByb3RvdHlwZS5hZGRCZXZlbEpvaW49ZnVuY3Rpb24ob2Zmc2V0MCxvZmZzZXQxKXt0aGlzLnNlZ0xpc3QuYWRkUHQob2Zmc2V0MC5wMSk7dGhpcy5zZWdMaXN0LmFkZFB0KG9mZnNldDEucDApO307anN0cy5vcGVyYXRpb24uYnVmZmVyLk9mZnNldFNlZ21lbnRHZW5lcmF0b3IucHJvdG90eXBlLmFkZEZpbGxldD1mdW5jdGlvbihwLHAwLHAxLGRpcmVjdGlvbixyYWRpdXMpe2lmKCEocDEgaW5zdGFuY2VvZiBqc3RzLmdlb20uQ29vcmRpbmF0ZSkpe3RoaXMuYWRkRmlsbGV0Mi5hcHBseSh0aGlzLGFyZ3VtZW50cyk7cmV0dXJuO31cbnZhciBkeDA9cDAueC1wLng7dmFyIGR5MD1wMC55LXAueTt2YXIgc3RhcnRBbmdsZT1NYXRoLmF0YW4yKGR5MCxkeDApO3ZhciBkeDE9cDEueC1wLng7dmFyIGR5MT1wMS55LXAueTt2YXIgZW5kQW5nbGU9TWF0aC5hdGFuMihkeTEsZHgxKTtpZihkaXJlY3Rpb249PT1qc3RzLmFsZ29yaXRobS5DR0FsZ29yaXRobXMuQ0xPQ0tXSVNFKXtpZihzdGFydEFuZ2xlPD1lbmRBbmdsZSlcbnN0YXJ0QW5nbGUrPTIuMCpNYXRoLlBJO31lbHNle2lmKHN0YXJ0QW5nbGU+PWVuZEFuZ2xlKVxuc3RhcnRBbmdsZS09Mi4wKk1hdGguUEk7fVxudGhpcy5zZWdMaXN0LmFkZFB0KHAwKTt0aGlzLmFkZEZpbGxldChwLHN0YXJ0QW5nbGUsZW5kQW5nbGUsZGlyZWN0aW9uLHJhZGl1cyk7dGhpcy5zZWdMaXN0LmFkZFB0KHAxKTt9O2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5PZmZzZXRTZWdtZW50R2VuZXJhdG9yLnByb3RvdHlwZS5hZGRGaWxsZXQyPWZ1bmN0aW9uKHAsc3RhcnRBbmdsZSxlbmRBbmdsZSxkaXJlY3Rpb24scmFkaXVzKXt2YXIgZGlyZWN0aW9uRmFjdG9yPWRpcmVjdGlvbj09PWpzdHMuYWxnb3JpdGhtLkNHQWxnb3JpdGhtcy5DTE9DS1dJU0U/LTE6MTt2YXIgdG90YWxBbmdsZT1NYXRoLmFicyhzdGFydEFuZ2xlLWVuZEFuZ2xlKTt2YXIgblNlZ3M9cGFyc2VJbnQoKHRvdGFsQW5nbGUvdGhpcy5maWxsZXRBbmdsZVF1YW50dW0rMC41KSk7aWYoblNlZ3M8MSlcbnJldHVybjt2YXIgaW5pdEFuZ2xlLGN1cnJBbmdsZUluYztpbml0QW5nbGU9MC4wO2N1cnJBbmdsZUluYz10b3RhbEFuZ2xlL25TZWdzO3ZhciBjdXJyQW5nbGU9aW5pdEFuZ2xlO3ZhciBwdD1uZXcganN0cy5nZW9tLkNvb3JkaW5hdGUoKTt3aGlsZShjdXJyQW5nbGU8dG90YWxBbmdsZSl7dmFyIGFuZ2xlPXN0YXJ0QW5nbGUrZGlyZWN0aW9uRmFjdG9yKmN1cnJBbmdsZTtwdC54PXAueCtyYWRpdXMqTWF0aC5jb3MoYW5nbGUpO3B0Lnk9cC55K3JhZGl1cypNYXRoLnNpbihhbmdsZSk7dGhpcy5zZWdMaXN0LmFkZFB0KHB0KTtjdXJyQW5nbGUrPWN1cnJBbmdsZUluYzt9fTtqc3RzLm9wZXJhdGlvbi5idWZmZXIuT2Zmc2V0U2VnbWVudEdlbmVyYXRvci5wcm90b3R5cGUuY3JlYXRlQ2lyY2xlPWZ1bmN0aW9uKHApe3ZhciBwdD1uZXcganN0cy5nZW9tLkNvb3JkaW5hdGUocC54K3RoaXMuZGlzdGFuY2UscC55KTt0aGlzLnNlZ0xpc3QuYWRkUHQocHQpO3RoaXMuYWRkRmlsbGV0KHAsMC4wLDIuMCpNYXRoLlBJLC0xLHRoaXMuZGlzdGFuY2UpO3RoaXMuc2VnTGlzdC5jbG9zZVJpbmcoKTt9O2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5PZmZzZXRTZWdtZW50R2VuZXJhdG9yLnByb3RvdHlwZS5jcmVhdGVTcXVhcmU9ZnVuY3Rpb24ocCl7dGhpcy5zZWdMaXN0LmFkZFB0KG5ldyBqc3RzLmdlb20uQ29vcmRpbmF0ZShwLngrZGlzdGFuY2UscC55K2Rpc3RhbmNlKSk7dGhpcy5zZWdMaXN0LmFkZFB0KG5ldyBqc3RzLmdlb20uQ29vcmRpbmF0ZShwLngrZGlzdGFuY2UscC55LWRpc3RhbmNlKSk7dGhpcy5zZWdMaXN0LmFkZFB0KG5ldyBqc3RzLmdlb20uQ29vcmRpbmF0ZShwLngtZGlzdGFuY2UscC55LWRpc3RhbmNlKSk7dGhpcy5zZWdMaXN0LmFkZFB0KG5ldyBqc3RzLmdlb20uQ29vcmRpbmF0ZShwLngtZGlzdGFuY2UscC55K2Rpc3RhbmNlKSk7dGhpcy5zZWdMaXN0LmNsb3NlUmluZygpO307anN0cy5vcGVyYXRpb24ub3ZlcmxheS5NYXhpbWFsRWRnZVJpbmc9ZnVuY3Rpb24oc3RhcnQsZ2VvbWV0cnlGYWN0b3J5KXtqc3RzLmdlb21ncmFwaC5FZGdlUmluZy5jYWxsKHRoaXMsc3RhcnQsZ2VvbWV0cnlGYWN0b3J5KTt9O2pzdHMub3BlcmF0aW9uLm92ZXJsYXkuTWF4aW1hbEVkZ2VSaW5nLnByb3RvdHlwZT1uZXcganN0cy5nZW9tZ3JhcGguRWRnZVJpbmcoKTtqc3RzLm9wZXJhdGlvbi5vdmVybGF5Lk1heGltYWxFZGdlUmluZy5jb25zdHJ1Y3Rvcj1qc3RzLm9wZXJhdGlvbi5vdmVybGF5Lk1heGltYWxFZGdlUmluZztqc3RzLm9wZXJhdGlvbi5vdmVybGF5Lk1heGltYWxFZGdlUmluZy5wcm90b3R5cGUuZ2V0TmV4dD1mdW5jdGlvbihkZSlcbntyZXR1cm4gZGUuZ2V0TmV4dCgpO307anN0cy5vcGVyYXRpb24ub3ZlcmxheS5NYXhpbWFsRWRnZVJpbmcucHJvdG90eXBlLnNldEVkZ2VSaW5nPWZ1bmN0aW9uKGRlLGVyKVxue2RlLnNldEVkZ2VSaW5nKGVyKTt9O2pzdHMub3BlcmF0aW9uLm92ZXJsYXkuTWF4aW1hbEVkZ2VSaW5nLnByb3RvdHlwZS5saW5rRGlyZWN0ZWRFZGdlc0Zvck1pbmltYWxFZGdlUmluZ3M9ZnVuY3Rpb24oKVxue3ZhciBkZT10aGlzLnN0YXJ0RGU7ZG97dmFyIG5vZGU9ZGUuZ2V0Tm9kZSgpO25vZGUuZ2V0RWRnZXMoKS5saW5rTWluaW1hbERpcmVjdGVkRWRnZXModGhpcyk7ZGU9ZGUuZ2V0TmV4dCgpO313aGlsZShkZSE9dGhpcy5zdGFydERlKTt9O2pzdHMub3BlcmF0aW9uLm92ZXJsYXkuTWF4aW1hbEVkZ2VSaW5nLnByb3RvdHlwZS5idWlsZE1pbmltYWxSaW5ncz1mdW5jdGlvbigpXG57dmFyIG1pbkVkZ2VSaW5ncz1bXTt2YXIgZGU9dGhpcy5zdGFydERlO2Rve2lmKGRlLmdldE1pbkVkZ2VSaW5nKCk9PT1udWxsKXt2YXIgbWluRXI9bmV3IGpzdHMub3BlcmF0aW9uLm92ZXJsYXkuTWluaW1hbEVkZ2VSaW5nKGRlLHRoaXMuZ2VvbWV0cnlGYWN0b3J5KTttaW5FZGdlUmluZ3MucHVzaChtaW5Fcik7fVxuZGU9ZGUuZ2V0TmV4dCgpO313aGlsZShkZSE9dGhpcy5zdGFydERlKTtyZXR1cm4gbWluRWRnZVJpbmdzO307anN0cy5hbGdvcml0aG0uQ2VudHJvaWRQb2ludD1mdW5jdGlvbigpe3RoaXMuY2VudFN1bT1uZXcganN0cy5nZW9tLkNvb3JkaW5hdGUoKTt9O2pzdHMuYWxnb3JpdGhtLkNlbnRyb2lkUG9pbnQucHJvdG90eXBlLnB0Q291bnQ9MDtqc3RzLmFsZ29yaXRobS5DZW50cm9pZFBvaW50LnByb3RvdHlwZS5jZW50U3VtPW51bGw7anN0cy5hbGdvcml0aG0uQ2VudHJvaWRQb2ludC5wcm90b3R5cGUuYWRkPWZ1bmN0aW9uKGdlb20pe2lmKGdlb20gaW5zdGFuY2VvZiBqc3RzLmdlb20uUG9pbnQpe3RoaXMuYWRkMihnZW9tLmdldENvb3JkaW5hdGUoKSk7fWVsc2UgaWYoZ2VvbSBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5HZW9tZXRyeUNvbGxlY3Rpb258fGdlb20gaW5zdGFuY2VvZiBqc3RzLmdlb20uTXVsdGlQb2ludHx8Z2VvbSBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5NdWx0aUxpbmVTdHJpbmd8fGdlb20gaW5zdGFuY2VvZiBqc3RzLmdlb20uTXVsdGlQb2x5Z29uKXt2YXIgZ2M9Z2VvbTtmb3IodmFyIGk9MDtpPGdjLmdldE51bUdlb21ldHJpZXMoKTtpKyspe3RoaXMuYWRkKGdjLmdldEdlb21ldHJ5TihpKSk7fX19O2pzdHMuYWxnb3JpdGhtLkNlbnRyb2lkUG9pbnQucHJvdG90eXBlLmFkZDI9ZnVuY3Rpb24ocHQpe3RoaXMucHRDb3VudCs9MTt0aGlzLmNlbnRTdW0ueCs9cHQueDt0aGlzLmNlbnRTdW0ueSs9cHQueTt9O2pzdHMuYWxnb3JpdGhtLkNlbnRyb2lkUG9pbnQucHJvdG90eXBlLmdldENlbnRyb2lkPWZ1bmN0aW9uKCl7dmFyIGNlbnQ9bmV3IGpzdHMuZ2VvbS5Db29yZGluYXRlKCk7Y2VudC54PXRoaXMuY2VudFN1bS54L3RoaXMucHRDb3VudDtjZW50Lnk9dGhpcy5jZW50U3VtLnkvdGhpcy5wdENvdW50O3JldHVybiBjZW50O307anN0cy5vcGVyYXRpb24uZGlzdGFuY2UuQ29ubmVjdGVkRWxlbWVudExvY2F0aW9uRmlsdGVyPWZ1bmN0aW9uKGxvY2F0aW9ucyl7dGhpcy5sb2NhdGlvbnM9bG9jYXRpb25zO307anN0cy5vcGVyYXRpb24uZGlzdGFuY2UuQ29ubmVjdGVkRWxlbWVudExvY2F0aW9uRmlsdGVyLnByb3RvdHlwZT1uZXcganN0cy5nZW9tLkdlb21ldHJ5RmlsdGVyKCk7anN0cy5vcGVyYXRpb24uZGlzdGFuY2UuQ29ubmVjdGVkRWxlbWVudExvY2F0aW9uRmlsdGVyLnByb3RvdHlwZS5sb2NhdGlvbnM9bnVsbDtqc3RzLm9wZXJhdGlvbi5kaXN0YW5jZS5Db25uZWN0ZWRFbGVtZW50TG9jYXRpb25GaWx0ZXIuZ2V0TG9jYXRpb25zPWZ1bmN0aW9uKGdlb20pe3ZhciBsb2NhdGlvbnM9W107Z2VvbS5hcHBseShuZXcganN0cy5vcGVyYXRpb24uZGlzdGFuY2UuQ29ubmVjdGVkRWxlbWVudExvY2F0aW9uRmlsdGVyKGxvY2F0aW9ucykpO3JldHVybiBsb2NhdGlvbnM7fTtqc3RzLm9wZXJhdGlvbi5kaXN0YW5jZS5Db25uZWN0ZWRFbGVtZW50TG9jYXRpb25GaWx0ZXIucHJvdG90eXBlLmZpbHRlcj1mdW5jdGlvbihnZW9tKXtpZihnZW9tIGluc3RhbmNlb2YganN0cy5nZW9tLlBvaW50fHxnZW9tIGluc3RhbmNlb2YganN0cy5nZW9tLkxpbmVTdHJpbmd8fGdlb20gaW5zdGFuY2VvZiBqc3RzLmdlb20uUG9seWdvbilcbnRoaXMubG9jYXRpb25zLnB1c2gobmV3IGpzdHMub3BlcmF0aW9uLmRpc3RhbmNlLkdlb21ldHJ5TG9jYXRpb24oZ2VvbSwwLGdlb20uZ2V0Q29vcmRpbmF0ZSgpKSk7fTtqc3RzLmdlb21ncmFwaC5pbmRleC5Nb25vdG9uZUNoYWluRWRnZT1mdW5jdGlvbihlKXt0aGlzLmU9ZTt0aGlzLnB0cz1lLmdldENvb3JkaW5hdGVzKCk7dmFyIG1jYj1uZXcganN0cy5nZW9tZ3JhcGguaW5kZXguTW9ub3RvbmVDaGFpbkluZGV4ZXIoKTt0aGlzLnN0YXJ0SW5kZXg9bWNiLmdldENoYWluU3RhcnRJbmRpY2VzKHRoaXMucHRzKTt9O2pzdHMuZ2VvbWdyYXBoLmluZGV4Lk1vbm90b25lQ2hhaW5FZGdlLnByb3RvdHlwZS5lPW51bGw7anN0cy5nZW9tZ3JhcGguaW5kZXguTW9ub3RvbmVDaGFpbkVkZ2UucHJvdG90eXBlLnB0cz1udWxsO2pzdHMuZ2VvbWdyYXBoLmluZGV4Lk1vbm90b25lQ2hhaW5FZGdlLnByb3RvdHlwZS5zdGFydEluZGV4PW51bGw7anN0cy5nZW9tZ3JhcGguaW5kZXguTW9ub3RvbmVDaGFpbkVkZ2UucHJvdG90eXBlLmVudjE9bmV3IGpzdHMuZ2VvbS5FbnZlbG9wZSgpO2pzdHMuZ2VvbWdyYXBoLmluZGV4Lk1vbm90b25lQ2hhaW5FZGdlLnByb3RvdHlwZS5lbnYyPW5ldyBqc3RzLmdlb20uRW52ZWxvcGUoKTtqc3RzLmdlb21ncmFwaC5pbmRleC5Nb25vdG9uZUNoYWluRWRnZS5wcm90b3R5cGUuZ2V0Q29vcmRpbmF0ZXM9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5wdHM7fTtqc3RzLmdlb21ncmFwaC5pbmRleC5Nb25vdG9uZUNoYWluRWRnZS5wcm90b3R5cGUuZ2V0U3RhcnRJbmRleGVzPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuc3RhcnRJbmRleDt9O2pzdHMuZ2VvbWdyYXBoLmluZGV4Lk1vbm90b25lQ2hhaW5FZGdlLnByb3RvdHlwZS5nZXRNaW5YPWZ1bmN0aW9uKGNoYWluSW5kZXgpe3ZhciB4MT10aGlzLnB0c1t0aGlzLnN0YXJ0SW5kZXhbY2hhaW5JbmRleF1dLng7dmFyIHgyPXRoaXMucHRzW3RoaXMuc3RhcnRJbmRleFtjaGFpbkluZGV4KzFdXS54O2lmKHgxPHgyKXtyZXR1cm4geDE7fVxucmV0dXJuIHgyO307anN0cy5nZW9tZ3JhcGguaW5kZXguTW9ub3RvbmVDaGFpbkVkZ2UucHJvdG90eXBlLmdldE1heFg9ZnVuY3Rpb24oY2hhaW5JbmRleCl7dmFyIHgxPXRoaXMucHRzW3RoaXMuc3RhcnRJbmRleFtjaGFpbkluZGV4XV0ueDt2YXIgeDI9dGhpcy5wdHNbdGhpcy5zdGFydEluZGV4W2NoYWluSW5kZXgrMV1dLng7aWYoeDE+eDIpe3JldHVybiB4MTt9XG5yZXR1cm4geDI7fTtqc3RzLmdlb21ncmFwaC5pbmRleC5Nb25vdG9uZUNoYWluRWRnZS5wcm90b3R5cGUuY29tcHV0ZUludGVyc2VjdHM9ZnVuY3Rpb24obWNlLHNpKXtmb3IodmFyIGk9MDtpPHRoaXMuc3RhcnRJbmRleC5sZW5ndGgtMTtpKyspe2Zvcih2YXIgaj0wO2o8bWNlLnN0YXJ0SW5kZXgubGVuZ3RoLTE7aisrKXt0aGlzLmNvbXB1dGVJbnRlcnNlY3RzRm9yQ2hhaW4oaSxtY2UsaixzaSk7fX19O2pzdHMuZ2VvbWdyYXBoLmluZGV4Lk1vbm90b25lQ2hhaW5FZGdlLnByb3RvdHlwZS5jb21wdXRlSW50ZXJzZWN0c0ZvckNoYWluPWZ1bmN0aW9uKGNoYWluSW5kZXgwLG1jZSxjaGFpbkluZGV4MSxzaSl7dGhpcy5jb21wdXRlSW50ZXJzZWN0c0ZvckNoYWluMih0aGlzLnN0YXJ0SW5kZXhbY2hhaW5JbmRleDBdLHRoaXMuc3RhcnRJbmRleFtjaGFpbkluZGV4MCsxXSxtY2UsbWNlLnN0YXJ0SW5kZXhbY2hhaW5JbmRleDFdLG1jZS5zdGFydEluZGV4W2NoYWluSW5kZXgxKzFdLHNpKTt9O2pzdHMuZ2VvbWdyYXBoLmluZGV4Lk1vbm90b25lQ2hhaW5FZGdlLnByb3RvdHlwZS5jb21wdXRlSW50ZXJzZWN0c0ZvckNoYWluMj1mdW5jdGlvbihzdGFydDAsZW5kMCxtY2Usc3RhcnQxLGVuZDEsZWkpe3ZhciBwMDA9dGhpcy5wdHNbc3RhcnQwXTt2YXIgcDAxPXRoaXMucHRzW2VuZDBdO3ZhciBwMTA9bWNlLnB0c1tzdGFydDFdO3ZhciBwMTE9bWNlLnB0c1tlbmQxXTtpZihlbmQwLXN0YXJ0MD09MSYmZW5kMS1zdGFydDE9PTEpe2VpLmFkZEludGVyc2VjdGlvbnModGhpcy5lLHN0YXJ0MCxtY2UuZSxzdGFydDEpO3JldHVybjt9XG50aGlzLmVudjEuaW5pdChwMDAscDAxKTt0aGlzLmVudjIuaW5pdChwMTAscDExKTtpZighdGhpcy5lbnYxLmludGVyc2VjdHModGhpcy5lbnYyKSl7cmV0dXJuO31cbnZhciBtaWQwPU1hdGguZmxvb3IoKHN0YXJ0MCtlbmQwKS8yKTt2YXIgbWlkMT1NYXRoLmZsb29yKChzdGFydDErZW5kMSkvMik7aWYoc3RhcnQwPG1pZDApe2lmKHN0YXJ0MTxtaWQxKXt0aGlzLmNvbXB1dGVJbnRlcnNlY3RzRm9yQ2hhaW4yKHN0YXJ0MCxtaWQwLG1jZSxzdGFydDEsbWlkMSxlaSk7fVxuaWYobWlkMTxlbmQxKXt0aGlzLmNvbXB1dGVJbnRlcnNlY3RzRm9yQ2hhaW4yKHN0YXJ0MCxtaWQwLG1jZSxtaWQxLGVuZDEsZWkpO319XG5pZihtaWQwPGVuZDApe2lmKHN0YXJ0MTxtaWQxKXt0aGlzLmNvbXB1dGVJbnRlcnNlY3RzRm9yQ2hhaW4yKG1pZDAsZW5kMCxtY2Usc3RhcnQxLG1pZDEsZWkpO31cbmlmKG1pZDE8ZW5kMSl7dGhpcy5jb21wdXRlSW50ZXJzZWN0c0ZvckNoYWluMihtaWQwLGVuZDAsbWNlLG1pZDEsZW5kMSxlaSk7fX19OyhmdW5jdGlvbigpe3ZhciBBcnJheUxpc3Q9amF2YXNjcmlwdC51dGlsLkFycmF5TGlzdDtqc3RzLm9wZXJhdGlvbi5yZWxhdGUuRWRnZUVuZEJ1aWxkZXI9ZnVuY3Rpb24oKXt9O2pzdHMub3BlcmF0aW9uLnJlbGF0ZS5FZGdlRW5kQnVpbGRlci5wcm90b3R5cGUuY29tcHV0ZUVkZ2VFbmRzPWZ1bmN0aW9uKGVkZ2VzKXtpZihhcmd1bWVudHMubGVuZ3RoPT0yKXt0aGlzLmNvbXB1dGVFZGdlRW5kczIuYXBwbHkodGhpcyxhcmd1bWVudHMpO3JldHVybjt9XG52YXIgbD1uZXcgQXJyYXlMaXN0KCk7Zm9yKHZhciBpPWVkZ2VzO2kuaGFzTmV4dCgpOyl7dmFyIGU9aS5uZXh0KCk7dGhpcy5jb21wdXRlRWRnZUVuZHMyKGUsbCk7fVxucmV0dXJuIGw7fTtqc3RzLm9wZXJhdGlvbi5yZWxhdGUuRWRnZUVuZEJ1aWxkZXIucHJvdG90eXBlLmNvbXB1dGVFZGdlRW5kczI9ZnVuY3Rpb24oZWRnZSxsKXt2YXIgZWlMaXN0PWVkZ2UuZ2V0RWRnZUludGVyc2VjdGlvbkxpc3QoKTtlaUxpc3QuYWRkRW5kcG9pbnRzKCk7dmFyIGl0PWVpTGlzdC5pdGVyYXRvcigpO3ZhciBlaVByZXY9bnVsbDt2YXIgZWlDdXJyPW51bGw7aWYoIWl0Lmhhc05leHQoKSlcbnJldHVybjt2YXIgZWlOZXh0PWl0Lm5leHQoKTtkb3tlaVByZXY9ZWlDdXJyO2VpQ3Vycj1laU5leHQ7ZWlOZXh0PW51bGw7aWYoaXQuaGFzTmV4dCgpKVxuZWlOZXh0PWl0Lm5leHQoKTtpZihlaUN1cnIhPT1udWxsKXt0aGlzLmNyZWF0ZUVkZ2VFbmRGb3JQcmV2KGVkZ2UsbCxlaUN1cnIsZWlQcmV2KTt0aGlzLmNyZWF0ZUVkZ2VFbmRGb3JOZXh0KGVkZ2UsbCxlaUN1cnIsZWlOZXh0KTt9fXdoaWxlKGVpQ3VyciE9PW51bGwpO307anN0cy5vcGVyYXRpb24ucmVsYXRlLkVkZ2VFbmRCdWlsZGVyLnByb3RvdHlwZS5jcmVhdGVFZGdlRW5kRm9yUHJldj1mdW5jdGlvbihlZGdlLGwsZWlDdXJyLGVpUHJldil7dmFyIGlQcmV2PWVpQ3Vyci5zZWdtZW50SW5kZXg7aWYoZWlDdXJyLmRpc3Q9PT0wLjApe2lmKGlQcmV2PT09MClcbnJldHVybjtpUHJldi0tO31cbnZhciBwUHJldj1lZGdlLmdldENvb3JkaW5hdGUoaVByZXYpO2lmKGVpUHJldiE9PW51bGwmJmVpUHJldi5zZWdtZW50SW5kZXg+PWlQcmV2KVxucFByZXY9ZWlQcmV2LmNvb3JkO3ZhciBsYWJlbD1uZXcganN0cy5nZW9tZ3JhcGguTGFiZWwoZWRnZS5nZXRMYWJlbCgpKTtsYWJlbC5mbGlwKCk7dmFyIGU9bmV3IGpzdHMuZ2VvbWdyYXBoLkVkZ2VFbmQoZWRnZSxlaUN1cnIuY29vcmQscFByZXYsbGFiZWwpO2wuYWRkKGUpO307anN0cy5vcGVyYXRpb24ucmVsYXRlLkVkZ2VFbmRCdWlsZGVyLnByb3RvdHlwZS5jcmVhdGVFZGdlRW5kRm9yTmV4dD1mdW5jdGlvbihlZGdlLGwsZWlDdXJyLGVpTmV4dCl7dmFyIGlOZXh0PWVpQ3Vyci5zZWdtZW50SW5kZXgrMTtpZihpTmV4dD49ZWRnZS5nZXROdW1Qb2ludHMoKSYmZWlOZXh0PT09bnVsbClcbnJldHVybjt2YXIgcE5leHQ9ZWRnZS5nZXRDb29yZGluYXRlKGlOZXh0KTtpZihlaU5leHQhPT1udWxsJiZlaU5leHQuc2VnbWVudEluZGV4PT09ZWlDdXJyLnNlZ21lbnRJbmRleClcbnBOZXh0PWVpTmV4dC5jb29yZDt2YXIgZT1uZXcganN0cy5nZW9tZ3JhcGguRWRnZUVuZChlZGdlLGVpQ3Vyci5jb29yZCxwTmV4dCxuZXcganN0cy5nZW9tZ3JhcGguTGFiZWwoZWRnZS5nZXRMYWJlbCgpKSk7bC5hZGQoZSk7fTt9KSgpOyhmdW5jdGlvbigpe3ZhciBBcnJheUxpc3Q9amF2YXNjcmlwdC51dGlsLkFycmF5TGlzdDt2YXIgVHJlZVNldD1qYXZhc2NyaXB0LnV0aWwuVHJlZVNldDt2YXIgQ29vcmRpbmF0ZUZpbHRlcj1qc3RzLmdlb20uQ29vcmRpbmF0ZUZpbHRlcjtqc3RzLnV0aWwuVW5pcXVlQ29vcmRpbmF0ZUFycmF5RmlsdGVyPWZ1bmN0aW9uKCl7dGhpcy50cmVlU2V0PW5ldyBUcmVlU2V0KCk7dGhpcy5saXN0PW5ldyBBcnJheUxpc3QoKTt9O2pzdHMudXRpbC5VbmlxdWVDb29yZGluYXRlQXJyYXlGaWx0ZXIucHJvdG90eXBlPW5ldyBDb29yZGluYXRlRmlsdGVyKCk7anN0cy51dGlsLlVuaXF1ZUNvb3JkaW5hdGVBcnJheUZpbHRlci5wcm90b3R5cGUudHJlZVNldD1udWxsO2pzdHMudXRpbC5VbmlxdWVDb29yZGluYXRlQXJyYXlGaWx0ZXIucHJvdG90eXBlLmxpc3Q9bnVsbDtqc3RzLnV0aWwuVW5pcXVlQ29vcmRpbmF0ZUFycmF5RmlsdGVyLnByb3RvdHlwZS5nZXRDb29yZGluYXRlcz1mdW5jdGlvbigpe3JldHVybiB0aGlzLmxpc3QudG9BcnJheSgpO307anN0cy51dGlsLlVuaXF1ZUNvb3JkaW5hdGVBcnJheUZpbHRlci5wcm90b3R5cGUuZmlsdGVyPWZ1bmN0aW9uKGNvb3JkKXtpZighdGhpcy50cmVlU2V0LmNvbnRhaW5zKGNvb3JkKSl7dGhpcy5saXN0LmFkZChjb29yZCk7dGhpcy50cmVlU2V0LmFkZChjb29yZCk7fX07fSkoKTsoZnVuY3Rpb24oKXt2YXIgQ0dBbGdvcml0aG1zPWpzdHMuYWxnb3JpdGhtLkNHQWxnb3JpdGhtczt2YXIgVW5pcXVlQ29vcmRpbmF0ZUFycmF5RmlsdGVyPWpzdHMudXRpbC5VbmlxdWVDb29yZGluYXRlQXJyYXlGaWx0ZXI7dmFyIEFzc2VydD1qc3RzLnV0aWwuQXNzZXJ0O3ZhciBTdGFjaz1qYXZhc2NyaXB0LnV0aWwuU3RhY2s7dmFyIEFycmF5TGlzdD1qYXZhc2NyaXB0LnV0aWwuQXJyYXlMaXN0O3ZhciBBcnJheXM9amF2YXNjcmlwdC51dGlsLkFycmF5czt2YXIgUmFkaWFsQ29tcGFyYXRvcj1mdW5jdGlvbihvcmlnaW4pe3RoaXMub3JpZ2luPW9yaWdpbjt9O1JhZGlhbENvbXBhcmF0b3IucHJvdG90eXBlLm9yaWdpbj1udWxsO1JhZGlhbENvbXBhcmF0b3IucHJvdG90eXBlLmNvbXBhcmU9ZnVuY3Rpb24obzEsbzIpe3ZhciBwMT1vMTt2YXIgcDI9bzI7cmV0dXJuIFJhZGlhbENvbXBhcmF0b3IucG9sYXJDb21wYXJlKHRoaXMub3JpZ2luLHAxLHAyKTt9O1JhZGlhbENvbXBhcmF0b3IucG9sYXJDb21wYXJlPWZ1bmN0aW9uKG8scCxxKXt2YXIgZHhwPXAueC1vLng7dmFyIGR5cD1wLnktby55O3ZhciBkeHE9cS54LW8ueDt2YXIgZHlxPXEueS1vLnk7dmFyIG9yaWVudD1DR0FsZ29yaXRobXMuY29tcHV0ZU9yaWVudGF0aW9uKG8scCxxKTtpZihvcmllbnQ9PUNHQWxnb3JpdGhtcy5DT1VOVEVSQ0xPQ0tXSVNFKVxucmV0dXJuIDE7aWYob3JpZW50PT1DR0FsZ29yaXRobXMuQ0xPQ0tXSVNFKVxucmV0dXJuLTE7dmFyIG9wPWR4cCpkeHArZHlwKmR5cDt2YXIgb3E9ZHhxKmR4cStkeXEqZHlxO2lmKG9wPG9xKXtyZXR1cm4tMTt9XG5pZihvcD5vcSl7cmV0dXJuIDE7fVxucmV0dXJuIDA7fTtqc3RzLmFsZ29yaXRobS5Db252ZXhIdWxsPWZ1bmN0aW9uKCl7aWYoYXJndW1lbnRzLmxlbmd0aD09PTEpe3ZhciBnZW9tZXRyeT1hcmd1bWVudHNbMF07dGhpcy5pbnB1dFB0cz1qc3RzLmFsZ29yaXRobS5Db252ZXhIdWxsLmV4dHJhY3RDb29yZGluYXRlcyhnZW9tZXRyeSk7dGhpcy5nZW9tRmFjdG9yeT1nZW9tZXRyeS5nZXRGYWN0b3J5KCk7fWVsc2V7dGhpcy5wdHM9YXJndW1lbnRzWzBdO3RoaXMuZ2VvbUZhY3Rvcnk9YXJndW1lbnRzWzFdO319O2pzdHMuYWxnb3JpdGhtLkNvbnZleEh1bGwucHJvdG90eXBlLmdlb21GYWN0b3J5PW51bGw7anN0cy5hbGdvcml0aG0uQ29udmV4SHVsbC5wcm90b3R5cGUuaW5wdXRQdHM9bnVsbDtqc3RzLmFsZ29yaXRobS5Db252ZXhIdWxsLmV4dHJhY3RDb29yZGluYXRlcz1mdW5jdGlvbihnZW9tKXt2YXIgZmlsdGVyPW5ldyBVbmlxdWVDb29yZGluYXRlQXJyYXlGaWx0ZXIoKTtnZW9tLmFwcGx5KGZpbHRlcik7cmV0dXJuIGZpbHRlci5nZXRDb29yZGluYXRlcygpO307anN0cy5hbGdvcml0aG0uQ29udmV4SHVsbC5wcm90b3R5cGUuZ2V0Q29udmV4SHVsbD1mdW5jdGlvbigpe2lmKHRoaXMuaW5wdXRQdHMubGVuZ3RoPT0wKXtyZXR1cm4gdGhpcy5nZW9tRmFjdG9yeS5jcmVhdGVHZW9tZXRyeUNvbGxlY3Rpb24obnVsbCk7fVxuaWYodGhpcy5pbnB1dFB0cy5sZW5ndGg9PTEpe3JldHVybiB0aGlzLmdlb21GYWN0b3J5LmNyZWF0ZVBvaW50KHRoaXMuaW5wdXRQdHNbMF0pO31cbmlmKHRoaXMuaW5wdXRQdHMubGVuZ3RoPT0yKXtyZXR1cm4gdGhpcy5nZW9tRmFjdG9yeS5jcmVhdGVMaW5lU3RyaW5nKHRoaXMuaW5wdXRQdHMpO31cbnZhciByZWR1Y2VkUHRzPXRoaXMuaW5wdXRQdHM7aWYodGhpcy5pbnB1dFB0cy5sZW5ndGg+NTApe3JlZHVjZWRQdHM9dGhpcy5yZWR1Y2UodGhpcy5pbnB1dFB0cyk7fVxudmFyIHNvcnRlZFB0cz10aGlzLnByZVNvcnQocmVkdWNlZFB0cyk7dmFyIGNIUz10aGlzLmdyYWhhbVNjYW4oc29ydGVkUHRzKTt2YXIgY0g9Y0hTLnRvQXJyYXkoKTtyZXR1cm4gdGhpcy5saW5lT3JQb2x5Z29uKGNIKTt9O2pzdHMuYWxnb3JpdGhtLkNvbnZleEh1bGwucHJvdG90eXBlLnJlZHVjZT1mdW5jdGlvbihpbnB1dFB0cyl7dmFyIHBvbHlQdHM9dGhpcy5jb21wdXRlT2N0UmluZyhpbnB1dFB0cyk7aWYocG9seVB0cz09bnVsbClcbnJldHVybiB0aGlzLmlucHV0UHRzO3ZhciByZWR1Y2VkU2V0PW5ldyBqYXZhc2NyaXB0LnV0aWwuVHJlZVNldCgpO2Zvcih2YXIgaT0wO2k8cG9seVB0cy5sZW5ndGg7aSsrKXtyZWR1Y2VkU2V0LmFkZChwb2x5UHRzW2ldKTt9XG5mb3IodmFyIGk9MDtpPGlucHV0UHRzLmxlbmd0aDtpKyspe2lmKCFDR0FsZ29yaXRobXMuaXNQb2ludEluUmluZyhpbnB1dFB0c1tpXSxwb2x5UHRzKSl7cmVkdWNlZFNldC5hZGQoaW5wdXRQdHNbaV0pO319XG52YXIgcmVkdWNlZFB0cz1yZWR1Y2VkU2V0LnRvQXJyYXkoKTtpZihyZWR1Y2VkUHRzLmxlbmd0aDwzKVxucmV0dXJuIHRoaXMucGFkQXJyYXkzKHJlZHVjZWRQdHMpO3JldHVybiByZWR1Y2VkUHRzO307anN0cy5hbGdvcml0aG0uQ29udmV4SHVsbC5wcm90b3R5cGUucGFkQXJyYXkzPWZ1bmN0aW9uKHB0cyl7dmFyIHBhZD1bXTtmb3IodmFyIGk9MDtpPHBhZC5sZW5ndGg7aSsrKXtpZihpPHB0cy5sZW5ndGgpe3BhZFtpXT1wdHNbaV07fWVsc2VcbnBhZFtpXT1wdHNbMF07fVxucmV0dXJuIHBhZDt9O2pzdHMuYWxnb3JpdGhtLkNvbnZleEh1bGwucHJvdG90eXBlLnByZVNvcnQ9ZnVuY3Rpb24ocHRzKXt2YXIgdDtmb3IodmFyIGk9MTtpPHB0cy5sZW5ndGg7aSsrKXtpZigocHRzW2ldLnk8cHRzWzBdLnkpfHwoKHB0c1tpXS55PT1wdHNbMF0ueSkmJihwdHNbaV0ueDxwdHNbMF0ueCkpKXt0PXB0c1swXTtwdHNbMF09cHRzW2ldO3B0c1tpXT10O319XG5BcnJheXMuc29ydChwdHMsMSxwdHMubGVuZ3RoLG5ldyBSYWRpYWxDb21wYXJhdG9yKHB0c1swXSkpO3JldHVybiBwdHM7fTtqc3RzLmFsZ29yaXRobS5Db252ZXhIdWxsLnByb3RvdHlwZS5ncmFoYW1TY2FuPWZ1bmN0aW9uKGMpe3ZhciBwO3ZhciBwcz1uZXcgU3RhY2soKTtwPXBzLnB1c2goY1swXSk7cD1wcy5wdXNoKGNbMV0pO3A9cHMucHVzaChjWzJdKTtmb3IodmFyIGk9MztpPGMubGVuZ3RoO2krKyl7cD1wcy5wb3AoKTt3aGlsZSghcHMuZW1wdHkoKSYmQ0dBbGdvcml0aG1zLmNvbXB1dGVPcmllbnRhdGlvbihwcy5wZWVrKCkscCxjW2ldKT4wKXtwPXBzLnBvcCgpO31cbnA9cHMucHVzaChwKTtwPXBzLnB1c2goY1tpXSk7fVxucD1wcy5wdXNoKGNbMF0pO3JldHVybiBwczt9O2pzdHMuYWxnb3JpdGhtLkNvbnZleEh1bGwucHJvdG90eXBlLmlzQmV0d2Vlbj1mdW5jdGlvbihjMSxjMixjMyl7aWYoQ0dBbGdvcml0aG1zLmNvbXB1dGVPcmllbnRhdGlvbihjMSxjMixjMykhPT0wKXtyZXR1cm4gZmFsc2U7fVxuaWYoYzEueCE9YzMueCl7aWYoYzEueDw9YzIueCYmYzIueDw9YzMueCl7cmV0dXJuIHRydWU7fVxuaWYoYzMueDw9YzIueCYmYzIueDw9YzEueCl7cmV0dXJuIHRydWU7fX1cbmlmKGMxLnkhPWMzLnkpe2lmKGMxLnk8PWMyLnkmJmMyLnk8PWMzLnkpe3JldHVybiB0cnVlO31cbmlmKGMzLnk8PWMyLnkmJmMyLnk8PWMxLnkpe3JldHVybiB0cnVlO319XG5yZXR1cm4gZmFsc2U7fTtqc3RzLmFsZ29yaXRobS5Db252ZXhIdWxsLnByb3RvdHlwZS5jb21wdXRlT2N0UmluZz1mdW5jdGlvbihpbnB1dFB0cyl7dmFyIG9jdFB0cz10aGlzLmNvbXB1dGVPY3RQdHMoaW5wdXRQdHMpO3ZhciBjb29yZExpc3Q9bmV3IGpzdHMuZ2VvbS5Db29yZGluYXRlTGlzdCgpO2Nvb3JkTGlzdC5hZGQob2N0UHRzLGZhbHNlKTtpZihjb29yZExpc3Quc2l6ZSgpPDMpe3JldHVybiBudWxsO31cbmNvb3JkTGlzdC5jbG9zZVJpbmcoKTtyZXR1cm4gY29vcmRMaXN0LnRvQ29vcmRpbmF0ZUFycmF5KCk7fTtqc3RzLmFsZ29yaXRobS5Db252ZXhIdWxsLnByb3RvdHlwZS5jb21wdXRlT2N0UHRzPWZ1bmN0aW9uKGlucHV0UHRzKXt2YXIgcHRzPVtdO2Zvcih2YXIgaj0wO2o8ODtqKyspe3B0c1tqXT1pbnB1dFB0c1swXTt9XG5mb3IodmFyIGk9MTtpPGlucHV0UHRzLmxlbmd0aDtpKyspe2lmKGlucHV0UHRzW2ldLng8cHRzWzBdLngpe3B0c1swXT1pbnB1dFB0c1tpXTt9XG5pZihpbnB1dFB0c1tpXS54LWlucHV0UHRzW2ldLnk8cHRzWzFdLngtcHRzWzFdLnkpe3B0c1sxXT1pbnB1dFB0c1tpXTt9XG5pZihpbnB1dFB0c1tpXS55PnB0c1syXS55KXtwdHNbMl09aW5wdXRQdHNbaV07fVxuaWYoaW5wdXRQdHNbaV0ueCtpbnB1dFB0c1tpXS55PnB0c1szXS54K3B0c1szXS55KXtwdHNbM109aW5wdXRQdHNbaV07fVxuaWYoaW5wdXRQdHNbaV0ueD5wdHNbNF0ueCl7cHRzWzRdPWlucHV0UHRzW2ldO31cbmlmKGlucHV0UHRzW2ldLngtaW5wdXRQdHNbaV0ueT5wdHNbNV0ueC1wdHNbNV0ueSl7cHRzWzVdPWlucHV0UHRzW2ldO31cbmlmKGlucHV0UHRzW2ldLnk8cHRzWzZdLnkpe3B0c1s2XT1pbnB1dFB0c1tpXTt9XG5pZihpbnB1dFB0c1tpXS54K2lucHV0UHRzW2ldLnk8cHRzWzddLngrcHRzWzddLnkpe3B0c1s3XT1pbnB1dFB0c1tpXTt9fVxucmV0dXJuIHB0czt9O2pzdHMuYWxnb3JpdGhtLkNvbnZleEh1bGwucHJvdG90eXBlLmxpbmVPclBvbHlnb249ZnVuY3Rpb24oY29vcmRpbmF0ZXMpe2Nvb3JkaW5hdGVzPXRoaXMuY2xlYW5SaW5nKGNvb3JkaW5hdGVzKTtpZihjb29yZGluYXRlcy5sZW5ndGg9PTMpe3JldHVybiB0aGlzLmdlb21GYWN0b3J5LmNyZWF0ZUxpbmVTdHJpbmcoW2Nvb3JkaW5hdGVzWzBdLGNvb3JkaW5hdGVzWzFdXSk7fVxudmFyIGxpbmVhclJpbmc9dGhpcy5nZW9tRmFjdG9yeS5jcmVhdGVMaW5lYXJSaW5nKGNvb3JkaW5hdGVzKTtyZXR1cm4gdGhpcy5nZW9tRmFjdG9yeS5jcmVhdGVQb2x5Z29uKGxpbmVhclJpbmcsbnVsbCk7fTtqc3RzLmFsZ29yaXRobS5Db252ZXhIdWxsLnByb3RvdHlwZS5jbGVhblJpbmc9ZnVuY3Rpb24ob3JpZ2luYWwpe0Fzc2VydC5lcXVhbHMob3JpZ2luYWxbMF0sb3JpZ2luYWxbb3JpZ2luYWwubGVuZ3RoLTFdKTt2YXIgY2xlYW5lZFJpbmc9bmV3IEFycmF5TGlzdCgpO3ZhciBwcmV2aW91c0Rpc3RpbmN0Q29vcmRpbmF0ZT1udWxsO2Zvcih2YXIgaT0wO2k8PW9yaWdpbmFsLmxlbmd0aC0yO2krKyl7dmFyIGN1cnJlbnRDb29yZGluYXRlPW9yaWdpbmFsW2ldO3ZhciBuZXh0Q29vcmRpbmF0ZT1vcmlnaW5hbFtpKzFdO2lmKGN1cnJlbnRDb29yZGluYXRlLmVxdWFscyhuZXh0Q29vcmRpbmF0ZSkpe2NvbnRpbnVlO31cbmlmKHByZXZpb3VzRGlzdGluY3RDb29yZGluYXRlIT1udWxsJiZ0aGlzLmlzQmV0d2VlbihwcmV2aW91c0Rpc3RpbmN0Q29vcmRpbmF0ZSxjdXJyZW50Q29vcmRpbmF0ZSxuZXh0Q29vcmRpbmF0ZSkpe2NvbnRpbnVlO31cbmNsZWFuZWRSaW5nLmFkZChjdXJyZW50Q29vcmRpbmF0ZSk7cHJldmlvdXNEaXN0aW5jdENvb3JkaW5hdGU9Y3VycmVudENvb3JkaW5hdGU7fVxuY2xlYW5lZFJpbmcuYWRkKG9yaWdpbmFsW29yaWdpbmFsLmxlbmd0aC0xXSk7dmFyIGNsZWFuZWRSaW5nQ29vcmRpbmF0ZXM9W107cmV0dXJuIGNsZWFuZWRSaW5nLnRvQXJyYXkoY2xlYW5lZFJpbmdDb29yZGluYXRlcyk7fTt9KSgpO2pzdHMuYWxnb3JpdGhtLk1pbmltdW1EaWFtZXRlcj1mdW5jdGlvbihpbnB1dEdlb20saXNDb252ZXgpe3RoaXMuY29udmV4SHVsbFB0cz1udWxsO3RoaXMubWluQmFzZVNlZz1uZXcganN0cy5nZW9tLkxpbmVTZWdtZW50KCk7dGhpcy5taW5XaWR0aFB0PW51bGw7dGhpcy5taW5QdEluZGV4PTA7dGhpcy5taW5XaWR0aD0wO2pzdHMuYWxnb3JpdGhtLk1pbmltdW1EaWFtZXRlci5pbnB1dEdlb209aW5wdXRHZW9tO2pzdHMuYWxnb3JpdGhtLk1pbmltdW1EaWFtZXRlci5pc0NvbnZleD1pc0NvbnZleHx8ZmFsc2U7fTtqc3RzLmFsZ29yaXRobS5NaW5pbXVtRGlhbWV0ZXIuaW5wdXRHZW9tPW51bGw7anN0cy5hbGdvcml0aG0uTWluaW11bURpYW1ldGVyLmlzQ29udmV4PWZhbHNlO2pzdHMuYWxnb3JpdGhtLk1pbmltdW1EaWFtZXRlci5uZXh0SW5kZXg9ZnVuY3Rpb24ocHRzLGluZGV4KXtpbmRleCsrO2lmKGluZGV4Pj1wdHMubGVuZ3RoKXtpbmRleD0wO31cbnJldHVybiBpbmRleDt9O2pzdHMuYWxnb3JpdGhtLk1pbmltdW1EaWFtZXRlci5jb21wdXRlQz1mdW5jdGlvbihhLGIscCl7cmV0dXJuIGEqcC55LWIqcC54O307anN0cy5hbGdvcml0aG0uTWluaW11bURpYW1ldGVyLmNvbXB1dGVTZWdtZW50Rm9yTGluZT1mdW5jdGlvbihhLGIsYyl7dmFyIHAwO3ZhciBwMTtpZihNYXRoLmFicyhiKT5NYXRoLmFicyhhKSl7cDA9bmV3IGpzdHMuZ2VvbS5Db29yZGluYXRlKDAsYy9iKTtwMT1uZXcganN0cy5nZW9tLkNvb3JkaW5hdGUoMSxjL2ItYS9iKTt9XG5lbHNle3AwPW5ldyBqc3RzLmdlb20uQ29vcmRpbmF0ZShjL2EsMCk7cDE9bmV3IGpzdHMuZ2VvbS5Db29yZGluYXRlKGMvYS1iL2EsMSk7fVxucmV0dXJuIG5ldyBqc3RzLmdlb20uTGluZVNlZ21lbnQocDAscDEpO307anN0cy5hbGdvcml0aG0uTWluaW11bURpYW1ldGVyLnByb3RvdHlwZS5nZXRMZW5ndGg9ZnVuY3Rpb24oKXt0aGlzLmNvbXB1dGVNaW5pbXVtRGlhbWV0ZXIoKTtyZXR1cm4gdGhpcy5taW5XaWR0aDt9O2pzdHMuYWxnb3JpdGhtLk1pbmltdW1EaWFtZXRlci5wcm90b3R5cGUuZ2V0V2lkdGhDb29yZGluYXRlPWZ1bmN0aW9uKCl7dGhpcy5jb21wdXRlTWluaW11bURpYW1ldGVyKCk7cmV0dXJuIHRoaXMubWluV2lkdGhQdDt9O2pzdHMuYWxnb3JpdGhtLk1pbmltdW1EaWFtZXRlci5wcm90b3R5cGUuZ2V0U3VwcG9ydGluZ1NlZ21lbnQ9ZnVuY3Rpb24oKXt0aGlzLmNvbXB1dGVNaW5pbXVtRGlhbWV0ZXIoKTt2YXIgY29vcmQ9W3RoaXMubWluQmFzZVNlZy5wMCx0aGlzLm1pbkJhc2VTZWcucDFdO3JldHVybiBqc3RzLmFsZ29yaXRobS5NaW5pbXVtRGlhbWV0ZXIuaW5wdXRHZW9tLmdldEZhY3RvcnkoKS5jcmVhdGVMaW5lU3RyaW5nKGNvb3JkKTt9O2pzdHMuYWxnb3JpdGhtLk1pbmltdW1EaWFtZXRlci5wcm90b3R5cGUuZ2V0RGlhbWV0ZXI9ZnVuY3Rpb24oKXt0aGlzLmNvbXB1dGVNaW5pbXVtRGlhbWV0ZXIoKTtpZih0aGlzLm1pbldpZHRoUHQ9PT1udWxsKXtyZXR1cm4ganN0cy5hbGdvcml0aG0uTWluaW11bURpYW1ldGVyLmlucHV0R2VvbS5nZXRGYWN0b3J5KCkuY3JlYXRlTGluZVN0cmluZyhudWxsKTt9XG52YXIgYmFzZVB0PXRoaXMubWluQmFzZVNlZy5wcm9qZWN0KHRoaXMubWluV2lkdGhQdCk7cmV0dXJuIGpzdHMuYWxnb3JpdGhtLk1pbmltdW1EaWFtZXRlci5pbnB1dEdlb20uZ2V0RmFjdG9yeSgpLmNyZWF0ZUxpbmVTdHJpbmcoW2Jhc2VQdCx0aGlzLm1pbldpZHRoUHRdKTt9O2pzdHMuYWxnb3JpdGhtLk1pbmltdW1EaWFtZXRlci5wcm90b3R5cGUuY29tcHV0ZU1pbmltdW1EaWFtZXRlcj1mdW5jdGlvbigpe2lmKHRoaXMubWluV2lkdGhQdCE9PW51bGwpe3JldHVybjt9XG5pZihqc3RzLmFsZ29yaXRobS5NaW5pbXVtRGlhbWV0ZXIuaXNDb252ZXgpXG50aGlzLmNvbXB1dGVXaWR0aENvbnZleChqc3RzLmFsZ29yaXRobS5NaW5pbXVtRGlhbWV0ZXIuaW5wdXRHZW9tKTtlbHNle3ZhciBjb252ZXhHZW9tPW5ldyBqc3RzLmFsZ29yaXRobS5Db252ZXhIdWxsKGpzdHMuYWxnb3JpdGhtLk1pbmltdW1EaWFtZXRlci5pbnB1dEdlb20pLmdldENvbnZleEh1bGwoKTt0aGlzLmNvbXB1dGVXaWR0aENvbnZleChjb252ZXhHZW9tKTt9fTtqc3RzLmFsZ29yaXRobS5NaW5pbXVtRGlhbWV0ZXIucHJvdG90eXBlLmNvbXB1dGVXaWR0aENvbnZleD1mdW5jdGlvbihjb252ZXhHZW9tKXtpZihjb252ZXhHZW9tIGluc3RhbmNlb2YganN0cy5nZW9tLlBvbHlnb24pe3RoaXMuY29udmV4SHVsbFB0cz1jb252ZXhHZW9tLmdldEV4dGVyaW9yUmluZygpLmdldENvb3JkaW5hdGVzKCk7fWVsc2V7dGhpcy5jb252ZXhIdWxsUHRzPWNvbnZleEdlb20uZ2V0Q29vcmRpbmF0ZXMoKTt9XG5pZih0aGlzLmNvbnZleEh1bGxQdHMubGVuZ3RoPT09MCl7dGhpcy5taW5XaWR0aD0wO3RoaXMubWluV2lkdGhQdD1udWxsO3RoaXMubWluQmFzZVNlZz1udWxsO31lbHNlIGlmKHRoaXMuY29udmV4SHVsbFB0cy5sZW5ndGg9PT0xKXt0aGlzLm1pbldpZHRoPTA7dGhpcy5taW5XaWR0aFB0PXRoaXMuY29udmV4SHVsbFB0c1swXTt0aGlzLm1pbkJhc2VTZWcucDA9dGhpcy5jb252ZXhIdWxsUHRzWzBdO3RoaXMubWluQmFzZVNlZy5wMT10aGlzLmNvbnZleEh1bGxQdHNbMF07fWVsc2UgaWYodGhpcy5jb252ZXhIdWxsUHRzLmxlbmd0aD09PTJ8fHRoaXMuY29udmV4SHVsbFB0cy5sZW5ndGg9PT0zKXt0aGlzLm1pbldpZHRoPTA7dGhpcy5taW5XaWR0aFB0PXRoaXMuY29udmV4SHVsbFB0c1swXTt0aGlzLm1pbkJhc2VTZWcucDA9dGhpcy5jb252ZXhIdWxsUHRzWzBdO3RoaXMubWluQmFzZVNlZy5wMT10aGlzLmNvbnZleEh1bGxQdHNbMV07fWVsc2V7dGhpcy5jb21wdXRlQ29udmV4UmluZ01pbkRpYW1ldGVyKHRoaXMuY29udmV4SHVsbFB0cyk7fX07anN0cy5hbGdvcml0aG0uTWluaW11bURpYW1ldGVyLnByb3RvdHlwZS5jb21wdXRlQ29udmV4UmluZ01pbkRpYW1ldGVyPWZ1bmN0aW9uKHB0cyl7dGhpcy5taW5XaWR0aD1OdW1iZXIuTUFYX1ZBTFVFO3ZhciBjdXJyTWF4SW5kZXg9MTt2YXIgc2VnPW5ldyBqc3RzLmdlb20uTGluZVNlZ21lbnQoKTtmb3IodmFyIGk9MDtpPHB0cy5sZW5ndGgtMTtpKyspe3NlZy5wMD1wdHNbaV07c2VnLnAxPXB0c1tpKzFdO2N1cnJNYXhJbmRleD10aGlzLmZpbmRNYXhQZXJwRGlzdGFuY2UocHRzLHNlZyxjdXJyTWF4SW5kZXgpO319O2pzdHMuYWxnb3JpdGhtLk1pbmltdW1EaWFtZXRlci5wcm90b3R5cGUuZmluZE1heFBlcnBEaXN0YW5jZT1mdW5jdGlvbihwdHMsc2VnLHN0YXJ0SW5kZXgpe3ZhciBtYXhQZXJwRGlzdGFuY2U9c2VnLmRpc3RhbmNlUGVycGVuZGljdWxhcihwdHNbc3RhcnRJbmRleF0pO3ZhciBuZXh0UGVycERpc3RhbmNlPW1heFBlcnBEaXN0YW5jZTt2YXIgbWF4SW5kZXg9c3RhcnRJbmRleDt2YXIgbmV4dEluZGV4PW1heEluZGV4O3doaWxlKG5leHRQZXJwRGlzdGFuY2U+PW1heFBlcnBEaXN0YW5jZSl7bWF4UGVycERpc3RhbmNlPW5leHRQZXJwRGlzdGFuY2U7bWF4SW5kZXg9bmV4dEluZGV4O25leHRJbmRleD1qc3RzLmFsZ29yaXRobS5NaW5pbXVtRGlhbWV0ZXIubmV4dEluZGV4KHB0cyxtYXhJbmRleCk7bmV4dFBlcnBEaXN0YW5jZT1zZWcuZGlzdGFuY2VQZXJwZW5kaWN1bGFyKHB0c1tuZXh0SW5kZXhdKTt9XG5pZihtYXhQZXJwRGlzdGFuY2U8dGhpcy5taW5XaWR0aCl7dGhpcy5taW5QdEluZGV4PW1heEluZGV4O3RoaXMubWluV2lkdGg9bWF4UGVycERpc3RhbmNlO3RoaXMubWluV2lkdGhQdD1wdHNbdGhpcy5taW5QdEluZGV4XTt0aGlzLm1pbkJhc2VTZWc9bmV3IGpzdHMuZ2VvbS5MaW5lU2VnbWVudChzZWcpO31cbnJldHVybiBtYXhJbmRleDt9O2pzdHMuYWxnb3JpdGhtLk1pbmltdW1EaWFtZXRlci5wcm90b3R5cGUuZ2V0TWluaW11bVJlY3RhbmdsZT1mdW5jdGlvbigpe3RoaXMuY29tcHV0ZU1pbmltdW1EaWFtZXRlcigpO2lmKHRoaXMubWluV2lkdGg9PT0wKXtpZih0aGlzLm1pbkJhc2VTZWcucDAuZXF1YWxzMkQodGhpcy5taW5CYXNlU2VnLnAxKSl7cmV0dXJuIGpzdHMuYWxnb3JpdGhtLk1pbmltdW1EaWFtZXRlci5pbnB1dEdlb20uZ2V0RmFjdG9yeSgpLmNyZWF0ZVBvaW50KHRoaXMubWluQmFzZVNlZy5wMCk7fVxucmV0dXJuIHRoaXMubWluQmFzZVNlZy50b0dlb21ldHJ5KGpzdHMuYWxnb3JpdGhtLk1pbmltdW1EaWFtZXRlci5pbnB1dEdlb20uZ2V0RmFjdG9yeSgpKTt9XG52YXIgZHg9dGhpcy5taW5CYXNlU2VnLnAxLngtdGhpcy5taW5CYXNlU2VnLnAwLng7dmFyIGR5PXRoaXMubWluQmFzZVNlZy5wMS55LXRoaXMubWluQmFzZVNlZy5wMC55O3ZhciBtaW5QYXJhPU51bWJlci5NQVhfVkFMVUU7dmFyIG1heFBhcmE9LU51bWJlci5NQVhfVkFMVUU7dmFyIG1pblBlcnA9TnVtYmVyLk1BWF9WQUxVRTt2YXIgbWF4UGVycD0tTnVtYmVyLk1BWF9WQUxVRTtmb3IodmFyIGk9MDtpPHRoaXMuY29udmV4SHVsbFB0cy5sZW5ndGg7aSsrKXt2YXIgcGFyYUM9anN0cy5hbGdvcml0aG0uTWluaW11bURpYW1ldGVyLmNvbXB1dGVDKGR4LGR5LHRoaXMuY29udmV4SHVsbFB0c1tpXSk7aWYocGFyYUM+bWF4UGFyYSltYXhQYXJhPXBhcmFDO2lmKHBhcmFDPG1pblBhcmEpbWluUGFyYT1wYXJhQzt2YXIgcGVycEM9anN0cy5hbGdvcml0aG0uTWluaW11bURpYW1ldGVyLmNvbXB1dGVDKC1keSxkeCx0aGlzLmNvbnZleEh1bGxQdHNbaV0pO2lmKHBlcnBDPm1heFBlcnApbWF4UGVycD1wZXJwQztpZihwZXJwQzxtaW5QZXJwKW1pblBlcnA9cGVycEM7fVxudmFyIG1heFBlcnBMaW5lPWpzdHMuYWxnb3JpdGhtLk1pbmltdW1EaWFtZXRlci5jb21wdXRlU2VnbWVudEZvckxpbmUoLWR4LC1keSxtYXhQZXJwKTt2YXIgbWluUGVycExpbmU9anN0cy5hbGdvcml0aG0uTWluaW11bURpYW1ldGVyLmNvbXB1dGVTZWdtZW50Rm9yTGluZSgtZHgsLWR5LG1pblBlcnApO3ZhciBtYXhQYXJhTGluZT1qc3RzLmFsZ29yaXRobS5NaW5pbXVtRGlhbWV0ZXIuY29tcHV0ZVNlZ21lbnRGb3JMaW5lKC1keSxkeCxtYXhQYXJhKTt2YXIgbWluUGFyYUxpbmU9anN0cy5hbGdvcml0aG0uTWluaW11bURpYW1ldGVyLmNvbXB1dGVTZWdtZW50Rm9yTGluZSgtZHksZHgsbWluUGFyYSk7dmFyIHAwPW1heFBhcmFMaW5lLmxpbmVJbnRlcnNlY3Rpb24obWF4UGVycExpbmUpO3ZhciBwMT1taW5QYXJhTGluZS5saW5lSW50ZXJzZWN0aW9uKG1heFBlcnBMaW5lKTt2YXIgcDI9bWluUGFyYUxpbmUubGluZUludGVyc2VjdGlvbihtaW5QZXJwTGluZSk7dmFyIHAzPW1heFBhcmFMaW5lLmxpbmVJbnRlcnNlY3Rpb24obWluUGVycExpbmUpO3ZhciBzaGVsbD1qc3RzLmFsZ29yaXRobS5NaW5pbXVtRGlhbWV0ZXIuaW5wdXRHZW9tLmdldEZhY3RvcnkoKS5jcmVhdGVMaW5lYXJSaW5nKFtwMCxwMSxwMixwMyxwMF0pO3JldHVybiBqc3RzLmFsZ29yaXRobS5NaW5pbXVtRGlhbWV0ZXIuaW5wdXRHZW9tLmdldEZhY3RvcnkoKS5jcmVhdGVQb2x5Z29uKHNoZWxsLG51bGwpO307KGZ1bmN0aW9uKCl7anN0cy5pby5HZW9KU09OUGFyc2VyPWZ1bmN0aW9uKGdlb21ldHJ5RmFjdG9yeSl7dGhpcy5nZW9tZXRyeUZhY3Rvcnk9Z2VvbWV0cnlGYWN0b3J5fHxuZXcganN0cy5nZW9tLkdlb21ldHJ5RmFjdG9yeSgpO3RoaXMuZ2VvbWV0cnlUeXBlcz1bJ1BvaW50JywnTXVsdGlQb2ludCcsJ0xpbmVTdHJpbmcnLCdNdWx0aUxpbmVTdHJpbmcnLCdQb2x5Z29uJywnTXVsdGlQb2x5Z29uJ107fTtqc3RzLmlvLkdlb0pTT05QYXJzZXIucHJvdG90eXBlLnJlYWQ9ZnVuY3Rpb24oanNvbil7dmFyIG9iajtpZih0eXBlb2YganNvbj09PSdzdHJpbmcnKXtvYmo9SlNPTi5wYXJzZShqc29uKTt9ZWxzZXtvYmo9anNvbjt9XG52YXIgdHlwZT1vYmoudHlwZTtpZighdGhpcy5wYXJzZVt0eXBlXSl7dGhyb3cgbmV3IEVycm9yKCdVbmtub3duIEdlb0pTT04gdHlwZTogJytvYmoudHlwZSk7fVxuaWYodGhpcy5nZW9tZXRyeVR5cGVzLmluZGV4T2YodHlwZSkhPS0xKXtyZXR1cm4gdGhpcy5wYXJzZVt0eXBlXS5hcHBseSh0aGlzLFtvYmouY29vcmRpbmF0ZXNdKTt9ZWxzZSBpZih0eXBlPT09J0dlb21ldHJ5Q29sbGVjdGlvbicpe3JldHVybiB0aGlzLnBhcnNlW3R5cGVdLmFwcGx5KHRoaXMsW29iai5nZW9tZXRyaWVzXSk7fVxucmV0dXJuIHRoaXMucGFyc2VbdHlwZV0uYXBwbHkodGhpcyxbb2JqXSk7fTtqc3RzLmlvLkdlb0pTT05QYXJzZXIucHJvdG90eXBlLnBhcnNlPXsnRmVhdHVyZSc6ZnVuY3Rpb24ob2JqKXt2YXIgZmVhdHVyZT17fTtmb3IodmFyIGtleSBpbiBvYmope2ZlYXR1cmVba2V5XT1vYmpba2V5XTt9XG5pZihvYmouZ2VvbWV0cnkpe3ZhciB0eXBlPW9iai5nZW9tZXRyeS50eXBlO2lmKCF0aGlzLnBhcnNlW3R5cGVdKXt0aHJvdyBuZXcgRXJyb3IoJ1Vua25vd24gR2VvSlNPTiB0eXBlOiAnK29iai50eXBlKTt9XG5mZWF0dXJlLmdlb21ldHJ5PXRoaXMucmVhZChvYmouZ2VvbWV0cnkpO31cbmlmKG9iai5iYm94KXtmZWF0dXJlLmJib3g9dGhpcy5wYXJzZS5iYm94LmFwcGx5KHRoaXMsW29iai5iYm94XSk7fVxucmV0dXJuIGZlYXR1cmU7fSwnRmVhdHVyZUNvbGxlY3Rpb24nOmZ1bmN0aW9uKG9iail7dmFyIGZlYXR1cmVDb2xsZWN0aW9uPXt9O2lmKG9iai5mZWF0dXJlcyl7ZmVhdHVyZUNvbGxlY3Rpb24uZmVhdHVyZXM9W107Zm9yKHZhciBpPTA7aTxvYmouZmVhdHVyZXMubGVuZ3RoOysraSl7ZmVhdHVyZUNvbGxlY3Rpb24uZmVhdHVyZXMucHVzaCh0aGlzLnJlYWQob2JqLmZlYXR1cmVzW2ldKSk7fX1cbmlmKG9iai5iYm94KXtmZWF0dXJlQ29sbGVjdGlvbi5iYm94PXRoaXMucGFyc2UuYmJveC5hcHBseSh0aGlzLFtvYmouYmJveF0pO31cbnJldHVybiBmZWF0dXJlQ29sbGVjdGlvbjt9LCdjb29yZGluYXRlcyc6ZnVuY3Rpb24oYXJyYXkpe3ZhciBjb29yZGluYXRlcz1bXTtmb3IodmFyIGk9MDtpPGFycmF5Lmxlbmd0aDsrK2kpe3ZhciBzdWI9YXJyYXlbaV07Y29vcmRpbmF0ZXMucHVzaChuZXcganN0cy5nZW9tLkNvb3JkaW5hdGUoc3ViWzBdLHN1YlsxXSkpO31cbnJldHVybiBjb29yZGluYXRlczt9LCdiYm94JzpmdW5jdGlvbihhcnJheSl7cmV0dXJuIHRoaXMuZ2VvbWV0cnlGYWN0b3J5LmNyZWF0ZUxpbmVhclJpbmcoW25ldyBqc3RzLmdlb20uQ29vcmRpbmF0ZShhcnJheVswXSxhcnJheVsxXSksbmV3IGpzdHMuZ2VvbS5Db29yZGluYXRlKGFycmF5WzJdLGFycmF5WzFdKSxuZXcganN0cy5nZW9tLkNvb3JkaW5hdGUoYXJyYXlbMl0sYXJyYXlbM10pLG5ldyBqc3RzLmdlb20uQ29vcmRpbmF0ZShhcnJheVswXSxhcnJheVszXSksbmV3IGpzdHMuZ2VvbS5Db29yZGluYXRlKGFycmF5WzBdLGFycmF5WzFdKV0pO30sJ1BvaW50JzpmdW5jdGlvbihhcnJheSl7dmFyIGNvb3JkaW5hdGU9bmV3IGpzdHMuZ2VvbS5Db29yZGluYXRlKGFycmF5WzBdLGFycmF5WzFdKTtyZXR1cm4gdGhpcy5nZW9tZXRyeUZhY3RvcnkuY3JlYXRlUG9pbnQoY29vcmRpbmF0ZSk7fSwnTXVsdGlQb2ludCc6ZnVuY3Rpb24oYXJyYXkpe3ZhciBwb2ludHM9W107Zm9yKHZhciBpPTA7aTxhcnJheS5sZW5ndGg7KytpKXtwb2ludHMucHVzaCh0aGlzLnBhcnNlLlBvaW50LmFwcGx5KHRoaXMsW2FycmF5W2ldXSkpO31cbnJldHVybiB0aGlzLmdlb21ldHJ5RmFjdG9yeS5jcmVhdGVNdWx0aVBvaW50KHBvaW50cyk7fSwnTGluZVN0cmluZyc6ZnVuY3Rpb24oYXJyYXkpe3ZhciBjb29yZGluYXRlcz10aGlzLnBhcnNlLmNvb3JkaW5hdGVzLmFwcGx5KHRoaXMsW2FycmF5XSk7cmV0dXJuIHRoaXMuZ2VvbWV0cnlGYWN0b3J5LmNyZWF0ZUxpbmVTdHJpbmcoY29vcmRpbmF0ZXMpO30sJ011bHRpTGluZVN0cmluZyc6ZnVuY3Rpb24oYXJyYXkpe3ZhciBsaW5lU3RyaW5ncz1bXTtmb3IodmFyIGk9MDtpPGFycmF5Lmxlbmd0aDsrK2kpe2xpbmVTdHJpbmdzLnB1c2godGhpcy5wYXJzZS5MaW5lU3RyaW5nLmFwcGx5KHRoaXMsW2FycmF5W2ldXSkpO31cbnJldHVybiB0aGlzLmdlb21ldHJ5RmFjdG9yeS5jcmVhdGVNdWx0aUxpbmVTdHJpbmcobGluZVN0cmluZ3MpO30sJ1BvbHlnb24nOmZ1bmN0aW9uKGFycmF5KXt2YXIgc2hlbGxDb29yZGluYXRlcz10aGlzLnBhcnNlLmNvb3JkaW5hdGVzLmFwcGx5KHRoaXMsW2FycmF5WzBdXSk7dmFyIHNoZWxsPXRoaXMuZ2VvbWV0cnlGYWN0b3J5LmNyZWF0ZUxpbmVhclJpbmcoc2hlbGxDb29yZGluYXRlcyk7dmFyIGhvbGVzPVtdO2Zvcih2YXIgaT0xO2k8YXJyYXkubGVuZ3RoOysraSl7dmFyIGhvbGU9YXJyYXlbaV07dmFyIGNvb3JkaW5hdGVzPXRoaXMucGFyc2UuY29vcmRpbmF0ZXMuYXBwbHkodGhpcyxbaG9sZV0pO3ZhciBsaW5lYXJSaW5nPXRoaXMuZ2VvbWV0cnlGYWN0b3J5LmNyZWF0ZUxpbmVhclJpbmcoY29vcmRpbmF0ZXMpO2hvbGVzLnB1c2gobGluZWFyUmluZyk7fVxucmV0dXJuIHRoaXMuZ2VvbWV0cnlGYWN0b3J5LmNyZWF0ZVBvbHlnb24oc2hlbGwsaG9sZXMpO30sJ011bHRpUG9seWdvbic6ZnVuY3Rpb24oYXJyYXkpe3ZhciBwb2x5Z29ucz1bXTtmb3IodmFyIGk9MDtpPGFycmF5Lmxlbmd0aDsrK2kpe3ZhciBwb2x5Z29uPWFycmF5W2ldO3BvbHlnb25zLnB1c2godGhpcy5wYXJzZS5Qb2x5Z29uLmFwcGx5KHRoaXMsW3BvbHlnb25dKSk7fVxucmV0dXJuIHRoaXMuZ2VvbWV0cnlGYWN0b3J5LmNyZWF0ZU11bHRpUG9seWdvbihwb2x5Z29ucyk7fSwnR2VvbWV0cnlDb2xsZWN0aW9uJzpmdW5jdGlvbihhcnJheSl7dmFyIGdlb21ldHJpZXM9W107Zm9yKHZhciBpPTA7aTxhcnJheS5sZW5ndGg7KytpKXt2YXIgZ2VvbWV0cnk9YXJyYXlbaV07Z2VvbWV0cmllcy5wdXNoKHRoaXMucmVhZChnZW9tZXRyeSkpO31cbnJldHVybiB0aGlzLmdlb21ldHJ5RmFjdG9yeS5jcmVhdGVHZW9tZXRyeUNvbGxlY3Rpb24oZ2VvbWV0cmllcyk7fX07anN0cy5pby5HZW9KU09OUGFyc2VyLnByb3RvdHlwZS53cml0ZT1mdW5jdGlvbihnZW9tZXRyeSl7dmFyIHR5cGU9Z2VvbWV0cnkuQ0xBU1NfTkFNRS5zbGljZSgxMCk7aWYoIXRoaXMuZXh0cmFjdFt0eXBlXSl7dGhyb3cgbmV3IEVycm9yKCdHZW9tZXRyeSBpcyBub3Qgc3VwcG9ydGVkJyk7fVxucmV0dXJuIHRoaXMuZXh0cmFjdFt0eXBlXS5hcHBseSh0aGlzLFtnZW9tZXRyeV0pO307anN0cy5pby5HZW9KU09OUGFyc2VyLnByb3RvdHlwZS5leHRyYWN0PXsnY29vcmRpbmF0ZSc6ZnVuY3Rpb24oY29vcmRpbmF0ZSl7cmV0dXJuW2Nvb3JkaW5hdGUueCxjb29yZGluYXRlLnldO30sJ1BvaW50JzpmdW5jdGlvbihwb2ludCl7dmFyIGFycmF5PXRoaXMuZXh0cmFjdC5jb29yZGluYXRlLmFwcGx5KHRoaXMsW3BvaW50LmNvb3JkaW5hdGVdKTtyZXR1cm57dHlwZTonUG9pbnQnLGNvb3JkaW5hdGVzOmFycmF5fTt9LCdNdWx0aVBvaW50JzpmdW5jdGlvbihtdWx0aXBvaW50KXt2YXIgYXJyYXk9W107Zm9yKHZhciBpPTA7aTxtdWx0aXBvaW50Lmdlb21ldHJpZXMubGVuZ3RoOysraSl7dmFyIHBvaW50PW11bHRpcG9pbnQuZ2VvbWV0cmllc1tpXTt2YXIgZ2VvSnNvbj10aGlzLmV4dHJhY3QuUG9pbnQuYXBwbHkodGhpcyxbcG9pbnRdKTthcnJheS5wdXNoKGdlb0pzb24uY29vcmRpbmF0ZXMpO31cbnJldHVybnt0eXBlOidNdWx0aVBvaW50Jyxjb29yZGluYXRlczphcnJheX07fSwnTGluZVN0cmluZyc6ZnVuY3Rpb24obGluZXN0cmluZyl7dmFyIGFycmF5PVtdO2Zvcih2YXIgaT0wO2k8bGluZXN0cmluZy5wb2ludHMubGVuZ3RoOysraSl7dmFyIGNvb3JkaW5hdGU9bGluZXN0cmluZy5wb2ludHNbaV07YXJyYXkucHVzaCh0aGlzLmV4dHJhY3QuY29vcmRpbmF0ZS5hcHBseSh0aGlzLFtjb29yZGluYXRlXSkpO31cbnJldHVybnt0eXBlOidMaW5lU3RyaW5nJyxjb29yZGluYXRlczphcnJheX07fSwnTXVsdGlMaW5lU3RyaW5nJzpmdW5jdGlvbihtdWx0aWxpbmVzdHJpbmcpe3ZhciBhcnJheT1bXTtmb3IodmFyIGk9MDtpPG11bHRpbGluZXN0cmluZy5nZW9tZXRyaWVzLmxlbmd0aDsrK2kpe3ZhciBsaW5lc3RyaW5nPW11bHRpbGluZXN0cmluZy5nZW9tZXRyaWVzW2ldO3ZhciBnZW9Kc29uPXRoaXMuZXh0cmFjdC5MaW5lU3RyaW5nLmFwcGx5KHRoaXMsW2xpbmVzdHJpbmddKTthcnJheS5wdXNoKGdlb0pzb24uY29vcmRpbmF0ZXMpO31cbnJldHVybnt0eXBlOidNdWx0aUxpbmVTdHJpbmcnLGNvb3JkaW5hdGVzOmFycmF5fTt9LCdQb2x5Z29uJzpmdW5jdGlvbihwb2x5Z29uKXt2YXIgYXJyYXk9W107dmFyIHNoZWxsR2VvSnNvbj10aGlzLmV4dHJhY3QuTGluZVN0cmluZy5hcHBseSh0aGlzLFtwb2x5Z29uLnNoZWxsXSk7YXJyYXkucHVzaChzaGVsbEdlb0pzb24uY29vcmRpbmF0ZXMpO2Zvcih2YXIgaT0wO2k8cG9seWdvbi5ob2xlcy5sZW5ndGg7KytpKXt2YXIgaG9sZT1wb2x5Z29uLmhvbGVzW2ldO3ZhciBob2xlR2VvSnNvbj10aGlzLmV4dHJhY3QuTGluZVN0cmluZy5hcHBseSh0aGlzLFtob2xlXSk7YXJyYXkucHVzaChob2xlR2VvSnNvbi5jb29yZGluYXRlcyk7fVxucmV0dXJue3R5cGU6J1BvbHlnb24nLGNvb3JkaW5hdGVzOmFycmF5fTt9LCdNdWx0aVBvbHlnb24nOmZ1bmN0aW9uKG11bHRpcG9seWdvbil7dmFyIGFycmF5PVtdO2Zvcih2YXIgaT0wO2k8bXVsdGlwb2x5Z29uLmdlb21ldHJpZXMubGVuZ3RoOysraSl7dmFyIHBvbHlnb249bXVsdGlwb2x5Z29uLmdlb21ldHJpZXNbaV07dmFyIGdlb0pzb249dGhpcy5leHRyYWN0LlBvbHlnb24uYXBwbHkodGhpcyxbcG9seWdvbl0pO2FycmF5LnB1c2goZ2VvSnNvbi5jb29yZGluYXRlcyk7fVxucmV0dXJue3R5cGU6J011bHRpUG9seWdvbicsY29vcmRpbmF0ZXM6YXJyYXl9O30sJ0dlb21ldHJ5Q29sbGVjdGlvbic6ZnVuY3Rpb24oY29sbGVjdGlvbil7dmFyIGFycmF5PVtdO2Zvcih2YXIgaT0wO2k8Y29sbGVjdGlvbi5nZW9tZXRyaWVzLmxlbmd0aDsrK2kpe3ZhciBnZW9tZXRyeT1jb2xsZWN0aW9uLmdlb21ldHJpZXNbaV07dmFyIHR5cGU9Z2VvbWV0cnkuQ0xBU1NfTkFNRS5zbGljZSgxMCk7YXJyYXkucHVzaCh0aGlzLmV4dHJhY3RbdHlwZV0uYXBwbHkodGhpcyxbZ2VvbWV0cnldKSk7fVxucmV0dXJue3R5cGU6J0dlb21ldHJ5Q29sbGVjdGlvbicsZ2VvbWV0cmllczphcnJheX07fX07fSkoKTtqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlZlcnRleD1mdW5jdGlvbigpe2lmKGFyZ3VtZW50cy5sZW5ndGg9PT0xKXt0aGlzLmluaXRGcm9tQ29vcmRpbmF0ZShhcmd1bWVudHNbMF0pO31lbHNle3RoaXMuaW5pdEZyb21YWShhcmd1bWVudHNbMF0sYXJndW1lbnRzWzFdKTt9fTtqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlZlcnRleC5MRUZUPTA7anN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5WZXJ0ZXguUklHSFQ9MTtqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlZlcnRleC5CRVlPTkQ9Mjtqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlZlcnRleC5CRUhJTkQ9Mztqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlZlcnRleC5CRVRXRUVOPTQ7anN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5WZXJ0ZXguT1JJR0lOPTU7anN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5WZXJ0ZXguREVTVElOQVRJT049Njtqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlZlcnRleC5wcm90b3R5cGUuaW5pdEZyb21YWT1mdW5jdGlvbih4LHkpe3RoaXMucD1uZXcganN0cy5nZW9tLkNvb3JkaW5hdGUoeCx5KTt9O2pzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuVmVydGV4LnByb3RvdHlwZS5pbml0RnJvbUNvb3JkaW5hdGU9ZnVuY3Rpb24oX3Ape3RoaXMucD1uZXcganN0cy5nZW9tLkNvb3JkaW5hdGUoX3ApO307anN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5WZXJ0ZXgucHJvdG90eXBlLmdldFg9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5wLng7fTtqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlZlcnRleC5wcm90b3R5cGUuZ2V0WT1mdW5jdGlvbigpe3JldHVybiB0aGlzLnAueTt9O2pzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuVmVydGV4LnByb3RvdHlwZS5nZXRaPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMucC56O307anN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5WZXJ0ZXgucHJvdG90eXBlLnNldFo9ZnVuY3Rpb24oeil7dGhpcy5wLno9ejt9O2pzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuVmVydGV4LnByb3RvdHlwZS5nZXRDb29yZGluYXRlPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMucDt9O2pzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuVmVydGV4LnByb3RvdHlwZS50b1N0cmluZz1mdW5jdGlvbigpe3JldHVybidQT0lOVCAoJyt0aGlzLnAueCsnICcrdGhpcy5wLnkrJyknO307anN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5WZXJ0ZXgucHJvdG90eXBlLmVxdWFscz1mdW5jdGlvbigpe2lmKGFyZ3VtZW50cy5sZW5ndGg9PT0xKXtyZXR1cm4gdGhpcy5lcXVhbHNFeGFjdChhcmd1bWVudHNbMF0pO31lbHNle3JldHVybiB0aGlzLmVxdWFsc1dpdGhUb2xlcmFuY2UoYXJndW1lbnRzWzBdLGFyZ3VtZW50c1sxXSk7fX07anN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5WZXJ0ZXgucHJvdG90eXBlLmVxdWFsc0V4YWN0PWZ1bmN0aW9uKG90aGVyKXtyZXR1cm4odGhpcy5wLng9PT1vdGhlci5nZXRYKCkmJnRoaXMucC55PT09b3RoZXIuZ2V0WSgpKTt9O2pzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuVmVydGV4LnByb3RvdHlwZS5lcXVhbHNXaXRoVG9sZXJhbmNlPWZ1bmN0aW9uKG90aGVyLHRvbGVyYW5jZSl7cmV0dXJuKHRoaXMucC5kaXN0YW5jZShvdGhlci5nZXRDb29yZGluYXRlKCkpPHRvbGVyYW5jZSk7fTtqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlZlcnRleC5wcm90b3R5cGUuY2xhc3NpZnk9ZnVuY3Rpb24ocDAscDEpe3ZhciBwMixhLGIsc2E7cDI9dGhpczthPXAxLnN1YihwMCk7Yj1wMi5zdWIocDApO3NhPWEuY3Jvc3NQcm9kdWN0KGIpO2lmKHNhPjAuMCl7cmV0dXJuIGpzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuVmVydGV4LkxFRlQ7fVxuaWYoc2E8MC4wKXtyZXR1cm4ganN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5WZXJ0ZXguUklHSFQ7fVxuaWYoKGEuZ2V0WCgpKmIuZ2V0WCgpPDAuMCl8fChhLmdldFkoKSpiLmdldFkoKTwwLjApKXtyZXR1cm4ganN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5WZXJ0ZXguQkVISU5EO31cbmlmKGEubWFnbigpPGIubWFnbigpKXtyZXR1cm4ganN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5WZXJ0ZXguQkVZT05EO31cbmlmKHAwLmVxdWFscyhwMikpe3JldHVybiBqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlZlcnRleC5PUklHSU47fVxuaWYocDEuZXF1YWxzKHAyKSl7cmV0dXJuIGpzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuVmVydGV4LkRFU1RJTkFUSU9OO31cbnJldHVybiBqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlZlcnRleC5CRVRXRUVOO307anN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5WZXJ0ZXgucHJvdG90eXBlLmNyb3NzUHJvZHVjdD1mdW5jdGlvbih2KXtyZXR1cm4oKHRoaXMucC54KnYuZ2V0WSgpKS0odGhpcy5wLnkqdi5nZXRYKCkpKTt9O2pzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuVmVydGV4LnByb3RvdHlwZS5kb3Q9ZnVuY3Rpb24odil7cmV0dXJuKCh0aGlzLnAueCp2LmdldFgoKSkrKHRoaXMucC55KnYuZ2V0WSgpKSk7fTtqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlZlcnRleC5wcm90b3R5cGUudGltZXM9ZnVuY3Rpb24oYyl7cmV0dXJuIG5ldyBqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlZlcnRleChjKnRoaXMucC54LGMqdGhpcy5wLnkpO307anN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5WZXJ0ZXgucHJvdG90eXBlLnN1bT1mdW5jdGlvbih2KXtyZXR1cm4gbmV3IGpzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuVmVydGV4KHRoaXMucC54K3YuZ2V0WCgpLHRoaXMucC55K1xudi5nZXRZKCkpO307anN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5WZXJ0ZXgucHJvdG90eXBlLnN1Yj1mdW5jdGlvbih2KXtyZXR1cm4gbmV3IGpzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuVmVydGV4KHRoaXMucC54LXYuZ2V0WCgpLHRoaXMucC55LVxudi5nZXRZKCkpO307anN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5WZXJ0ZXgucHJvdG90eXBlLm1hZ249ZnVuY3Rpb24oKXtyZXR1cm4oTWF0aC5zcXJ0KCh0aGlzLnAueCp0aGlzLnAueCkrKHRoaXMucC55KnRoaXMucC55KSkpO307anN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5WZXJ0ZXgucHJvdG90eXBlLmNyb3NzPWZ1bmN0aW9uKCl7cmV0dXJuIG5ldyBWZXJ0ZXgodGhpcy5wLnksLXRoaXMucC54KTt9O2pzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuVmVydGV4LnByb3RvdHlwZS5pc0luQ2lyY2xlPWZ1bmN0aW9uKGEsYixjKXtyZXR1cm4ganN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5UcmlhbmdsZVByZWRpY2F0ZS5pc0luQ2lyY2xlUm9idXN0KGEucCxiLnAsYy5wLHRoaXMucCk7fTtqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlZlcnRleC5wcm90b3R5cGUuaXNDQ1c9ZnVuY3Rpb24oYixjKXtyZXR1cm4oKGIucC54LXRoaXMucC54KSooYy5wLnktdGhpcy5wLnkpLShiLnAueS10aGlzLnAueSkqKGMucC54LXRoaXMucC54KT4wKTt9O2pzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuVmVydGV4LnByb3RvdHlwZS5yaWdodE9mPWZ1bmN0aW9uKGUpe3JldHVybiB0aGlzLmlzQ0NXKGUuZGVzdCgpLGUub3JpZygpKTt9O2pzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuVmVydGV4LnByb3RvdHlwZS5sZWZ0T2Y9ZnVuY3Rpb24oZSl7cmV0dXJuIHRoaXMuaXNDQ1coZS5vcmlnKCksZS5kZXN0KCkpO307anN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5WZXJ0ZXgucHJvdG90eXBlLmJpc2VjdG9yPWZ1bmN0aW9uKGEsYil7dmFyIGR4LGR5LGwxLGwyO2R4PWIuZ2V0WCgpLWEuZ2V0WCgpO2R5PWIuZ2V0WSgpLWEuZ2V0WSgpO2wxPW5ldyBqc3RzLmFsZ29yaXRobS5IQ29vcmRpbmF0ZShhLmdldFgoKSsoZHgvMi4wKSxhLmdldFkoKStcbihkeS8yLjApLDEuMCk7bDI9bmV3IGpzdHMuYWxnb3JpdGhtLkhDb29yZGluYXRlKGEuZ2V0WCgpLWR5KyhkeC8yLjApLGEuZ2V0WSgpK1xuZHgrKGR5LzIuMCksMS4wKTtyZXR1cm4gbmV3IGpzdHMuYWxnb3JpdGhtLkhDb29yZGluYXRlKGwxLGwyKTt9O2pzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuVmVydGV4LnByb3RvdHlwZS5kaXN0YW5jZT1mdW5jdGlvbih2MSx2Mil7cmV0dXJuIHYxLnAuZGlzdGFuY2UodjIucCk7fTtqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlZlcnRleC5wcm90b3R5cGUuY2lyY3VtUmFkaXVzUmF0aW89ZnVuY3Rpb24oYixjKXt2YXIgeCxyYWRpdXMsZWRnZUxlbmd0aCxlbDt4PXRoaXMuY2lyY2xlQ2VudGVyKGIsYyk7cmFkaXVzPXRoaXMuZGlzdGFuY2UoeCxiKTtlZGdlTGVuZ3RoPXRoaXMuZGlzdGFuY2UodGhpcyxiKTtlbD10aGlzLmRpc3RhbmNlKGIsYyk7aWYoZWw8ZWRnZUxlbmd0aCl7ZWRnZUxlbmd0aD1lbDt9XG5lbD10aGlzLmRpc3RhbmNlKGMsdGhpcyk7aWYoZWw8ZWRnZUxlbmd0aCl7ZWRnZUxlbmd0aD1lbDt9XG5yZXR1cm4gcmFkaXVzL2VkZ2VMZW5ndGg7fTtqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlZlcnRleC5wcm90b3R5cGUubWlkUG9pbnQ9ZnVuY3Rpb24oYSl7dmFyIHhtLHltO3htPSh0aGlzLnAueCthLmdldFgoKSkvMi4wO3ltPSh0aGlzLnAueSthLmdldFkoKSkvMi4wO3JldHVybiBuZXcganN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5WZXJ0ZXgoeG0seW0pO307anN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5WZXJ0ZXgucHJvdG90eXBlLmNpcmNsZUNlbnRlcj1mdW5jdGlvbihiLGMpe3ZhciBhLGNhYixjYmMsaGNjLGNjO2E9bmV3IGpzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuVmVydGV4KHRoaXMuZ2V0WCgpLHRoaXMuZ2V0WSgpKTtjYWI9dGhpcy5iaXNlY3RvcihhLGIpO2NiYz10aGlzLmJpc2VjdG9yKGIsYyk7aGNjPW5ldyBqc3RzLmFsZ29yaXRobS5IQ29vcmRpbmF0ZShjYWIsY2JjKTtjYz1udWxsO3RyeXtjYz1uZXcganN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5WZXJ0ZXgoaGNjLmdldFgoKSxoY2MuZ2V0WSgpKTt9Y2F0Y2goZXJyKXt9XG5yZXR1cm4gY2M7fTtqc3RzLm9wZXJhdGlvbi52YWxpZC5Jc1ZhbGlkT3A9ZnVuY3Rpb24ocGFyZW50R2VvbWV0cnkpe3RoaXMucGFyZW50R2VvbWV0cnk9cGFyZW50R2VvbWV0cnk7dGhpcy5pc1NlbGZUb3VjaGluZ1JpbmdGb3JtaW5nSG9sZVZhbGlkPWZhbHNlO3RoaXMudmFsaWRFcnI9bnVsbDt9O2pzdHMub3BlcmF0aW9uLnZhbGlkLklzVmFsaWRPcC5pc1ZhbGlkPWZ1bmN0aW9uKGFyZyl7aWYoYXJndW1lbnRzWzBdaW5zdGFuY2VvZiBqc3RzLmdlb20uQ29vcmRpbmF0ZSl7aWYoaXNOYU4oYXJnLngpKXtyZXR1cm4gZmFsc2U7fVxuaWYoIWlzRmluaXRlKGFyZy54KSYmIWlzTmFOKGFyZy54KSl7cmV0dXJuIGZhbHNlO31cbmlmKGlzTmFOKGFyZy55KSl7cmV0dXJuIGZhbHNlO31cbmlmKCFpc0Zpbml0ZShhcmcueSkmJiFpc05hTihhcmcueSkpe3JldHVybiBmYWxzZTt9XG5yZXR1cm4gdHJ1ZTt9ZWxzZXt2YXIgaXNWYWxpZE9wPW5ldyBqc3RzLm9wZXJhdGlvbi52YWxpZC5Jc1ZhbGlkT3AoYXJnKTtyZXR1cm4gaXNWYWxpZE9wLmlzVmFsaWQoKTt9fTtqc3RzLm9wZXJhdGlvbi52YWxpZC5Jc1ZhbGlkT3AuZmluZFB0Tm90Tm9kZT1mdW5jdGlvbih0ZXN0Q29vcmRzLHNlYXJjaFJpbmcsZ3JhcGgpe3ZhciBzZWFyY2hFZGdlPWdyYXBoLmZpbmRFZGdlKHNlYXJjaFJpbmcpO3ZhciBlaUxpc3Q9c2VhcmNoRWRnZS5nZXRFZGdlSW50ZXJzZWN0aW9uTGlzdCgpO2Zvcih2YXIgaT0wO2k8dGVzdENvb3Jkcy5sZW5ndGg7aSsrKXt2YXIgcHQ9dGVzdENvb3Jkc1tpXTtpZighZWlMaXN0LmlzSW50ZXJzZWN0aW9uKHB0KSl7cmV0dXJuIHB0O319XG5yZXR1cm4gbnVsbDt9O2pzdHMub3BlcmF0aW9uLnZhbGlkLklzVmFsaWRPcC5wcm90b3R5cGUuc2V0U2VsZlRvdWNoaW5nUmluZ0Zvcm1pbmdIb2xlVmFsaWQ9ZnVuY3Rpb24oaXNWYWxpZCl7dGhpcy5pc1NlbGZUb3VjaGluZ1JpbmdGb3JtaW5nSG9sZVZhbGlkPWlzVmFsaWQ7fTtqc3RzLm9wZXJhdGlvbi52YWxpZC5Jc1ZhbGlkT3AucHJvdG90eXBlLmlzVmFsaWQ9ZnVuY3Rpb24oKXt0aGlzLmNoZWNrVmFsaWQodGhpcy5wYXJlbnRHZW9tZXRyeSk7cmV0dXJuIHRoaXMudmFsaWRFcnI9PW51bGw7fTtqc3RzLm9wZXJhdGlvbi52YWxpZC5Jc1ZhbGlkT3AucHJvdG90eXBlLmdldFZhbGlkYXRpb25FcnJvcj1mdW5jdGlvbigpe3RoaXMuY2hlY2tWYWxpZCh0aGlzLnBhcmVudEdlb21ldHJ5KTtyZXR1cm4gdGhpcy52YWxpZEVycjt9O2pzdHMub3BlcmF0aW9uLnZhbGlkLklzVmFsaWRPcC5wcm90b3R5cGUuY2hlY2tWYWxpZD1mdW5jdGlvbihnKXt0aGlzLnZhbGlkRXJyPW51bGw7aWYoZy5pc0VtcHR5KCkpe3JldHVybjt9XG5pZihnIGluc3RhbmNlb2YganN0cy5nZW9tLlBvaW50KXt0aGlzLmNoZWNrVmFsaWRQb2ludChnKTt9ZWxzZSBpZihnIGluc3RhbmNlb2YganN0cy5nZW9tLk11bHRpUG9pbnQpe3RoaXMuY2hlY2tWYWxpZE11bHRpUG9pbnQoZyk7fWVsc2UgaWYoZyBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5MaW5lYXJSaW5nKXt0aGlzLmNoZWNrVmFsaWRMaW5lYXJSaW5nKGcpO31lbHNlIGlmKGcgaW5zdGFuY2VvZiBqc3RzLmdlb20uTGluZVN0cmluZyl7dGhpcy5jaGVja1ZhbGlkTGluZVN0cmluZyhnKTt9ZWxzZSBpZihnIGluc3RhbmNlb2YganN0cy5nZW9tLlBvbHlnb24pe3RoaXMuY2hlY2tWYWxpZFBvbHlnb24oZyk7fWVsc2UgaWYoZyBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5NdWx0aVBvbHlnb24pe3RoaXMuY2hlY2tWYWxpZE11bHRpUG9seWdvbihnKTt9ZWxzZSBpZihnIGluc3RhbmNlb2YganN0cy5nZW9tLkdlb21ldHJ5Q29sbGVjdGlvbil7dGhpcy5jaGVja1ZhbGlkR2VvbWV0cnlDb2xsZWN0aW9uKGcpO31lbHNle3Rocm93IGcuY29uc3RydWN0b3I7fX07anN0cy5vcGVyYXRpb24udmFsaWQuSXNWYWxpZE9wLnByb3RvdHlwZS5jaGVja1ZhbGlkUG9pbnQ9ZnVuY3Rpb24oZyl7dGhpcy5jaGVja0ludmFsaWRDb29yZGluYXRlcyhnLmdldENvb3JkaW5hdGVzKCkpO307anN0cy5vcGVyYXRpb24udmFsaWQuSXNWYWxpZE9wLnByb3RvdHlwZS5jaGVja1ZhbGlkTXVsdGlQb2ludD1mdW5jdGlvbihnKXt0aGlzLmNoZWNrSW52YWxpZENvb3JkaW5hdGVzKGcuZ2V0Q29vcmRpbmF0ZXMoKSk7fTtqc3RzLm9wZXJhdGlvbi52YWxpZC5Jc1ZhbGlkT3AucHJvdG90eXBlLmNoZWNrVmFsaWRMaW5lU3RyaW5nPWZ1bmN0aW9uKGcpe3RoaXMuY2hlY2tJbnZhbGlkQ29vcmRpbmF0ZXMoZy5nZXRDb29yZGluYXRlcygpKTtpZih0aGlzLnZhbGlkRXJyIT1udWxsKXtyZXR1cm47fVxudmFyIGdyYXBoPW5ldyBqc3RzLmdlb21ncmFwaC5HZW9tZXRyeUdyYXBoKDAsZyk7dGhpcy5jaGVja1Rvb0Zld1BvaW50cyhncmFwaCk7fTtqc3RzLm9wZXJhdGlvbi52YWxpZC5Jc1ZhbGlkT3AucHJvdG90eXBlLmNoZWNrVmFsaWRMaW5lYXJSaW5nPWZ1bmN0aW9uKGcpe3RoaXMuY2hlY2tJbnZhbGlkQ29vcmRpbmF0ZXMoZy5nZXRDb29yZGluYXRlcygpKTtpZih0aGlzLnZhbGlkRXJyIT1udWxsKXtyZXR1cm47fVxudGhpcy5jaGVja0Nsb3NlZFJpbmcoZyk7aWYodGhpcy52YWxpZEVyciE9bnVsbCl7cmV0dXJuO31cbnZhciBncmFwaD1uZXcganN0cy5nZW9tZ3JhcGguR2VvbWV0cnlHcmFwaCgwLGcpO3RoaXMuY2hlY2tUb29GZXdQb2ludHMoZ3JhcGgpO2lmKHRoaXMudmFsaWRFcnIhPW51bGwpe3JldHVybjt9XG52YXIgbGk9bmV3IGpzdHMuYWxnb3JpdGhtLlJvYnVzdExpbmVJbnRlcnNlY3RvcigpO2dyYXBoLmNvbXB1dGVTZWxmTm9kZXMobGksdHJ1ZSk7dGhpcy5jaGVja05vU2VsZkludGVyc2VjdGluZ1JpbmdzKGdyYXBoKTt9O2pzdHMub3BlcmF0aW9uLnZhbGlkLklzVmFsaWRPcC5wcm90b3R5cGUuY2hlY2tWYWxpZFBvbHlnb249ZnVuY3Rpb24oZyl7dGhpcy5jaGVja0ludmFsaWRDb29yZGluYXRlcyhnKTtpZih0aGlzLnZhbGlkRXJyIT1udWxsKXtyZXR1cm47fVxudGhpcy5jaGVja0Nsb3NlZFJpbmdzKGcpO2lmKHRoaXMudmFsaWRFcnIhPW51bGwpe3JldHVybjt9XG52YXIgZ3JhcGg9bmV3IGpzdHMuZ2VvbWdyYXBoLkdlb21ldHJ5R3JhcGgoMCxnKTt0aGlzLmNoZWNrVG9vRmV3UG9pbnRzKGdyYXBoKTtpZih0aGlzLnZhbGlkRXJyIT1udWxsKXtyZXR1cm47fVxudGhpcy5jaGVja0NvbnNpc3RlbnRBcmVhKGdyYXBoKTtpZih0aGlzLnZhbGlkRXJyIT1udWxsKXtyZXR1cm47fVxuaWYoIXRoaXMuaXNTZWxmVG91Y2hpbmdSaW5nRm9ybWluZ0hvbGVWYWxpZCl7dGhpcy5jaGVja05vU2VsZkludGVyc2VjdGluZ1JpbmdzKGdyYXBoKTtpZih0aGlzLnZhbGlkRXJyIT1udWxsKXtyZXR1cm47fX1cbnRoaXMuY2hlY2tIb2xlc0luU2hlbGwoZyxncmFwaCk7aWYodGhpcy52YWxpZEVyciE9bnVsbCl7cmV0dXJuO31cbnRoaXMuY2hlY2tIb2xlc05vdE5lc3RlZChnLGdyYXBoKTtpZih0aGlzLnZhbGlkRXJyIT1udWxsKXtyZXR1cm47fVxudGhpcy5jaGVja0Nvbm5lY3RlZEludGVyaW9ycyhncmFwaCk7fTtqc3RzLm9wZXJhdGlvbi52YWxpZC5Jc1ZhbGlkT3AucHJvdG90eXBlLmNoZWNrVmFsaWRNdWx0aVBvbHlnb249ZnVuY3Rpb24oZyl7dmFyIGlsPWcuZ2V0TnVtR2VvbWV0cmllcygpO2Zvcih2YXIgaT0wO2k8aWw7aSsrKXt2YXIgcD1nLmdldEdlb21ldHJ5TihpKTt0aGlzLmNoZWNrSW52YWxpZENvb3JkaW5hdGVzKHApO2lmKHRoaXMudmFsaWRFcnIhPW51bGwpe3JldHVybjt9XG50aGlzLmNoZWNrQ2xvc2VkUmluZ3MocCk7aWYodGhpcy52YWxpZEVyciE9bnVsbCl7cmV0dXJuO319XG52YXIgZ3JhcGg9bmV3IGpzdHMuZ2VvbWdyYXBoLkdlb21ldHJ5R3JhcGgoMCxnKTt0aGlzLmNoZWNrVG9vRmV3UG9pbnRzKGdyYXBoKTtpZih0aGlzLnZhbGlkRXJyIT1udWxsKXtyZXR1cm47fVxudGhpcy5jaGVja0NvbnNpc3RlbnRBcmVhKGdyYXBoKTtpZih0aGlzLnZhbGlkRXJyIT1udWxsKXtyZXR1cm47fVxuaWYoIXRoaXMuaXNTZWxmVG91Y2hpbmdSaW5nRm9ybWluZ0hvbGVWYWxpZCl7dGhpcy5jaGVja05vU2VsZkludGVyc2VjdGluZ1JpbmdzKGdyYXBoKTtpZih0aGlzLnZhbGlkRXJyIT1udWxsKXtyZXR1cm47fX1cbmZvcih2YXIgaT0wO2k8Zy5nZXROdW1HZW9tZXRyaWVzKCk7aSsrKXt2YXIgcD1nLmdldEdlb21ldHJ5TihpKTt0aGlzLmNoZWNrSG9sZXNJblNoZWxsKHAsZ3JhcGgpO2lmKHRoaXMudmFsaWRFcnIhPW51bGwpe3JldHVybjt9fVxuZm9yKHZhciBpPTA7aTxnLmdldE51bUdlb21ldHJpZXMoKTtpKyspe3ZhciBwPWcuZ2V0R2VvbWV0cnlOKGkpO3RoaXMuY2hlY2tIb2xlc05vdE5lc3RlZChwLGdyYXBoKTtpZih0aGlzLnZhbGlkRXJyIT1udWxsKXtyZXR1cm47fX1cbnRoaXMuY2hlY2tTaGVsbHNOb3ROZXN0ZWQoZyxncmFwaCk7aWYodGhpcy52YWxpZEVyciE9bnVsbCl7cmV0dXJuO31cbnRoaXMuY2hlY2tDb25uZWN0ZWRJbnRlcmlvcnMoZ3JhcGgpO307anN0cy5vcGVyYXRpb24udmFsaWQuSXNWYWxpZE9wLnByb3RvdHlwZS5jaGVja1ZhbGlkR2VvbWV0cnlDb2xsZWN0aW9uPWZ1bmN0aW9uKGdjKXtmb3IodmFyIGk9MDtpPGdjLmdldE51bUdlb21ldHJpZXMoKTtpKyspe3ZhciBnPWdjLmdldEdlb21ldHJ5TihpKTt0aGlzLmNoZWNrVmFsaWQoZyk7aWYodGhpcy52YWxpZEVyciE9bnVsbCl7cmV0dXJuO319fTtqc3RzLm9wZXJhdGlvbi52YWxpZC5Jc1ZhbGlkT3AucHJvdG90eXBlLmNoZWNrSW52YWxpZENvb3JkaW5hdGVzPWZ1bmN0aW9uKGFyZyl7aWYoYXJnIGluc3RhbmNlb2YganN0cy5nZW9tLlBvbHlnb24pe3ZhciBwb2x5PWFyZzt0aGlzLmNoZWNrSW52YWxpZENvb3JkaW5hdGVzKHBvbHkuZ2V0RXh0ZXJpb3JSaW5nKCkuZ2V0Q29vcmRpbmF0ZXMoKSk7aWYodGhpcy52YWxpZEVyciE9bnVsbCl7cmV0dXJuO31cbmZvcih2YXIgaT0wO2k8cG9seS5nZXROdW1JbnRlcmlvclJpbmcoKTtpKyspe3RoaXMuY2hlY2tJbnZhbGlkQ29vcmRpbmF0ZXMocG9seS5nZXRJbnRlcmlvclJpbmdOKGkpLmdldENvb3JkaW5hdGVzKCkpO2lmKHRoaXMudmFsaWRFcnIhPW51bGwpe3JldHVybjt9fX1lbHNle3ZhciBjb29yZHM9YXJnO2Zvcih2YXIgaT0wO2k8Y29vcmRzLmxlbmd0aDtpKyspe2lmKCFqc3RzLm9wZXJhdGlvbi52YWxpZC5Jc1ZhbGlkT3AuaXNWYWxpZChjb29yZHNbaV0pKXt0aGlzLnZhbGlkRXJyPW5ldyBqc3RzLm9wZXJhdGlvbi52YWxpZC5Ub3BvbG9neVZhbGlkYXRpb25FcnJvcihqc3RzLm9wZXJhdGlvbi52YWxpZC5Ub3BvbG9neVZhbGlkYXRpb25FcnJvci5JTlZBTElEX0NPT1JESU5BVEUsY29vcmRzW2ldKTtyZXR1cm47fX19fTtqc3RzLm9wZXJhdGlvbi52YWxpZC5Jc1ZhbGlkT3AucHJvdG90eXBlLmNoZWNrQ2xvc2VkUmluZ3M9ZnVuY3Rpb24ocG9seSl7dGhpcy5jaGVja0Nsb3NlZFJpbmcocG9seS5nZXRFeHRlcmlvclJpbmcoKSk7aWYodGhpcy52YWxpZEVyciE9bnVsbCl7cmV0dXJuO31cbmZvcih2YXIgaT0wO2k8cG9seS5nZXROdW1JbnRlcmlvclJpbmcoKTtpKyspe3RoaXMuY2hlY2tDbG9zZWRSaW5nKHBvbHkuZ2V0SW50ZXJpb3JSaW5nTihpKSk7aWYodGhpcy52YWxpZEVyciE9bnVsbCl7cmV0dXJuO319fTtqc3RzLm9wZXJhdGlvbi52YWxpZC5Jc1ZhbGlkT3AucHJvdG90eXBlLmNoZWNrQ2xvc2VkUmluZz1mdW5jdGlvbihyaW5nKXtpZighcmluZy5pc0Nsb3NlZCgpKXt2YXIgcHQ9bnVsbDtpZihyaW5nLmdldE51bVBvaW50cygpPj0xKXtwdD1yaW5nLmdldENvb3JkaW5hdGVOKDApO31cbnRoaXMudmFsaWRFcnI9bmV3IGpzdHMub3BlcmF0aW9uLnZhbGlkLlRvcG9sb2d5VmFsaWRhdGlvbkVycm9yKGpzdHMub3BlcmF0aW9uLnZhbGlkLlRvcG9sb2d5VmFsaWRhdGlvbkVycm9yLlJJTkdfTk9UX0NMT1NFRCxwdCk7fX07anN0cy5vcGVyYXRpb24udmFsaWQuSXNWYWxpZE9wLnByb3RvdHlwZS5jaGVja1Rvb0Zld1BvaW50cz1mdW5jdGlvbihncmFwaCl7aWYoZ3JhcGguaGFzVG9vRmV3UG9pbnRzKXt0aGlzLnZhbGlkRXJyPW5ldyBqc3RzLm9wZXJhdGlvbi52YWxpZC5Ub3BvbG9neVZhbGlkYXRpb25FcnJvcihqc3RzLm9wZXJhdGlvbi52YWxpZC5Ub3BvbG9neVZhbGlkYXRpb25FcnJvci5UT09fRkVXX1BPSU5UUyxncmFwaC5nZXRJbnZhbGlkUG9pbnQoKSk7cmV0dXJuO319O2pzdHMub3BlcmF0aW9uLnZhbGlkLklzVmFsaWRPcC5wcm90b3R5cGUuY2hlY2tDb25zaXN0ZW50QXJlYT1mdW5jdGlvbihncmFwaCl7dmFyIGNhdD1uZXcganN0cy5vcGVyYXRpb24udmFsaWQuQ29uc2lzdGVudEFyZWFUZXN0ZXIoZ3JhcGgpO3ZhciBpc1ZhbGlkQXJlYT1jYXQuaXNOb2RlQ29uc2lzdGVudEFyZWEoKTtpZighaXNWYWxpZEFyZWEpe3RoaXMudmFsaWRFcnI9bmV3IGpzdHMub3BlcmF0aW9uLnZhbGlkLlRvcG9sb2d5VmFsaWRhdGlvbkVycm9yKGpzdHMub3BlcmF0aW9uLnZhbGlkLlRvcG9sb2d5VmFsaWRhdGlvbkVycm9yLlNFTEZfSU5URVJTRUNUSU9OLGNhdC5nZXRJbnZhbGlkUG9pbnQoKSk7cmV0dXJuO31cbmlmKGNhdC5oYXNEdXBsaWNhdGVSaW5ncygpKXt0aGlzLnZhbGlkRXJyPW5ldyBqc3RzLm9wZXJhdGlvbi52YWxpZC5Ub3BvbG9neVZhbGlkYXRpb25FcnJvcihqc3RzLm9wZXJhdGlvbi52YWxpZC5Ub3BvbG9neVZhbGlkYXRpb25FcnJvci5EVVBMSUNBVEVfUklOR1MsY2F0LmdldEludmFsaWRQb2ludCgpKTt9fTtqc3RzLm9wZXJhdGlvbi52YWxpZC5Jc1ZhbGlkT3AucHJvdG90eXBlLmNoZWNrTm9TZWxmSW50ZXJzZWN0aW5nUmluZ3M9ZnVuY3Rpb24oZ3JhcGgpe2Zvcih2YXIgaT1ncmFwaC5nZXRFZGdlSXRlcmF0b3IoKTtpLmhhc05leHQoKTspe3ZhciBlPWkubmV4dCgpO3RoaXMuY2hlY2tOb1NlbGZJbnRlcnNlY3RpbmdSaW5nKGUuZ2V0RWRnZUludGVyc2VjdGlvbkxpc3QoKSk7aWYodGhpcy52YWxpZEVyciE9bnVsbCl7cmV0dXJuO319fTtqc3RzLm9wZXJhdGlvbi52YWxpZC5Jc1ZhbGlkT3AucHJvdG90eXBlLmNoZWNrTm9TZWxmSW50ZXJzZWN0aW5nUmluZz1mdW5jdGlvbihlaUxpc3Qpe3ZhciBub2RlU2V0PVtdO3ZhciBpc0ZpcnN0PXRydWU7Zm9yKHZhciBpPWVpTGlzdC5pdGVyYXRvcigpO2kuaGFzTmV4dCgpOyl7dmFyIGVpPWkubmV4dCgpO2lmKGlzRmlyc3Qpe2lzRmlyc3Q9ZmFsc2U7Y29udGludWU7fVxuaWYobm9kZVNldC5pbmRleE9mKGVpLmNvb3JkKT49MCl7dGhpcy52YWxpZEVycj1uZXcganN0cy5vcGVyYXRpb24udmFsaWQuVG9wb2xvZ3lWYWxpZGF0aW9uRXJyb3IoanN0cy5vcGVyYXRpb24udmFsaWQuVG9wb2xvZ3lWYWxpZGF0aW9uRXJyb3IuUklOR19TRUxGX0lOVEVSU0VDVElPTixlaS5jb29yZCk7cmV0dXJuO31lbHNle25vZGVTZXQucHVzaChlaS5jb29yZCk7fX19O2pzdHMub3BlcmF0aW9uLnZhbGlkLklzVmFsaWRPcC5wcm90b3R5cGUuY2hlY2tIb2xlc0luU2hlbGw9ZnVuY3Rpb24ocCxncmFwaCl7dmFyIHNoZWxsPXAuZ2V0RXh0ZXJpb3JSaW5nKCk7dmFyIHBpcj1uZXcganN0cy5hbGdvcml0aG0uTUNQb2ludEluUmluZyhzaGVsbCk7Zm9yKHZhciBpPTA7aTxwLmdldE51bUludGVyaW9yUmluZygpO2krKyl7dmFyIGhvbGU9cC5nZXRJbnRlcmlvclJpbmdOKGkpO3ZhciBob2xlUHQ9anN0cy5vcGVyYXRpb24udmFsaWQuSXNWYWxpZE9wLmZpbmRQdE5vdE5vZGUoaG9sZS5nZXRDb29yZGluYXRlcygpLHNoZWxsLGdyYXBoKTtpZihob2xlUHQ9PW51bGwpe3JldHVybjt9XG52YXIgb3V0c2lkZT0hcGlyLmlzSW5zaWRlKGhvbGVQdCk7aWYob3V0c2lkZSl7dGhpcy52YWxpZEVycj1uZXcganN0cy5vcGVyYXRpb24udmFsaWQuVG9wb2xvZ3lWYWxpZGF0aW9uRXJyb3IoanN0cy5vcGVyYXRpb24udmFsaWQuVG9wb2xvZ3lWYWxpZGF0aW9uRXJyb3IuSE9MRV9PVVRTSURFX1NIRUxMLGhvbGVQdCk7cmV0dXJuO319fTtqc3RzLm9wZXJhdGlvbi52YWxpZC5Jc1ZhbGlkT3AucHJvdG90eXBlLmNoZWNrSG9sZXNOb3ROZXN0ZWQ9ZnVuY3Rpb24ocCxncmFwaCl7dmFyIG5lc3RlZFRlc3Rlcj1uZXcganN0cy5vcGVyYXRpb24udmFsaWQuSW5kZXhlZE5lc3RlZFJpbmdUZXN0ZXIoZ3JhcGgpO2Zvcih2YXIgaT0wO2k8cC5nZXROdW1JbnRlcmlvclJpbmcoKTtpKyspe3ZhciBpbm5lckhvbGU9cC5nZXRJbnRlcmlvclJpbmdOKGkpO25lc3RlZFRlc3Rlci5hZGQoaW5uZXJIb2xlKTt9XG52YXIgaXNOb25OZXN0ZWQ9bmVzdGVkVGVzdGVyLmlzTm9uTmVzdGVkKCk7aWYoIWlzTm9uTmVzdGVkKXt0aGlzLnZhbGlkRXJyPW5ldyBqc3RzLm9wZXJhdGlvbi52YWxpZC5Ub3BvbG9neVZhbGlkYXRpb25FcnJvcihqc3RzLm9wZXJhdGlvbi52YWxpZC5Ub3BvbG9neVZhbGlkYXRpb25FcnJvci5ORVNURURfSE9MRVMsbmVzdGVkVGVzdGVyLmdldE5lc3RlZFBvaW50KCkpO319O2pzdHMub3BlcmF0aW9uLnZhbGlkLklzVmFsaWRPcC5wcm90b3R5cGUuY2hlY2tTaGVsbHNOb3ROZXN0ZWQ9ZnVuY3Rpb24obXAsZ3JhcGgpe2Zvcih2YXIgaT0wO2k8bXAuZ2V0TnVtR2VvbWV0cmllcygpO2krKyl7dmFyIHA9bXAuZ2V0R2VvbWV0cnlOKGkpO3ZhciBzaGVsbD1wLmdldEV4dGVyaW9yUmluZygpO2Zvcih2YXIgaj0wO2o8bXAuZ2V0TnVtR2VvbWV0cmllcygpO2orKyl7aWYoaT09ail7Y29udGludWU7fVxudmFyIHAyPW1wLmdldEdlb21ldHJ5TihqKTt0aGlzLmNoZWNrU2hlbGxOb3ROZXN0ZWQoc2hlbGwscDIsZ3JhcGgpO2lmKHRoaXMudmFsaWRFcnIhPW51bGwpe3JldHVybjt9fX19O2pzdHMub3BlcmF0aW9uLnZhbGlkLklzVmFsaWRPcC5wcm90b3R5cGUuY2hlY2tTaGVsbE5vdE5lc3RlZD1mdW5jdGlvbihzaGVsbCxwLGdyYXBoKXt2YXIgc2hlbGxQdHM9c2hlbGwuZ2V0Q29vcmRpbmF0ZXMoKTt2YXIgcG9seVNoZWxsPXAuZ2V0RXh0ZXJpb3JSaW5nKCk7dmFyIHBvbHlQdHM9cG9seVNoZWxsLmdldENvb3JkaW5hdGVzKCk7dmFyIHNoZWxsUHQ9anN0cy5vcGVyYXRpb24udmFsaWQuSXNWYWxpZE9wLmZpbmRQdE5vdE5vZGUoc2hlbGxQdHMscG9seVNoZWxsLGdyYXBoKTtpZihzaGVsbFB0PT1udWxsKXtyZXR1cm47fVxudmFyIGluc2lkZVBvbHlTaGVsbD1qc3RzLmFsZ29yaXRobS5DR0FsZ29yaXRobXMuaXNQb2ludEluUmluZyhzaGVsbFB0LHBvbHlQdHMpO2lmKCFpbnNpZGVQb2x5U2hlbGwpe3JldHVybjt9XG5pZihwLmdldE51bUludGVyaW9yUmluZygpPD0wKXt0aGlzLnZhbGlkRXJyPW5ldyBqc3RzLm9wZXJhdGlvbi52YWxpZC5Ub3BvbG9neVZhbGlkYXRpb25FcnJvcihqc3RzLm9wZXJhdGlvbi52YWxpZC5Ub3BvbG9neVZhbGlkYXRpb25FcnJvci5ORVNURURfU0hFTExTLHNoZWxsUHQpO3JldHVybjt9XG52YXIgYmFkTmVzdGVkUHQ9bnVsbDtmb3IodmFyIGk9MDtpPHAuZ2V0TnVtSW50ZXJpb3JSaW5nKCk7aSsrKXt2YXIgaG9sZT1wLmdldEludGVyaW9yUmluZ04oaSk7YmFkTmVzdGVkUHQ9dGhpcy5jaGVja1NoZWxsSW5zaWRlSG9sZShzaGVsbCxob2xlLGdyYXBoKTtpZihiYWROZXN0ZWRQdD09bnVsbCl7cmV0dXJuO319XG50aGlzLnZhbGlkRXJyPW5ldyBqc3RzLm9wZXJhdGlvbi52YWxpZC5Ub3BvbG9neVZhbGlkYXRpb25FcnJvcihqc3RzLm9wZXJhdGlvbi52YWxpZC5Ub3BvbG9neVZhbGlkYXRpb25FcnJvci5ORVNURURfU0hFTExTLGJhZE5lc3RlZFB0KTt9O2pzdHMub3BlcmF0aW9uLnZhbGlkLklzVmFsaWRPcC5wcm90b3R5cGUuY2hlY2tTaGVsbEluc2lkZUhvbGU9ZnVuY3Rpb24oc2hlbGwsaG9sZSxncmFwaCl7dmFyIHNoZWxsUHRzPXNoZWxsLmdldENvb3JkaW5hdGVzKCk7dmFyIGhvbGVQdHM9aG9sZS5nZXRDb29yZGluYXRlcygpO3ZhciBzaGVsbFB0PWpzdHMub3BlcmF0aW9uLnZhbGlkLklzVmFsaWRPcC5maW5kUHROb3ROb2RlKHNoZWxsUHRzLGhvbGUsZ3JhcGgpO2lmKHNoZWxsUHQhPW51bGwpe3ZhciBpbnNpZGVIb2xlPWpzdHMuYWxnb3JpdGhtLkNHQWxnb3JpdGhtcy5pc1BvaW50SW5SaW5nKHNoZWxsUHQsaG9sZVB0cyk7aWYoIWluc2lkZUhvbGUpe3JldHVybiBzaGVsbFB0O319XG52YXIgaG9sZVB0PWpzdHMub3BlcmF0aW9uLnZhbGlkLklzVmFsaWRPcC5maW5kUHROb3ROb2RlKGhvbGVQdHMsc2hlbGwsZ3JhcGgpO2lmKGhvbGVQdCE9bnVsbCl7dmFyIGluc2lkZVNoZWxsPWpzdHMuYWxnb3JpdGhtLkNHQWxnb3JpdGhtcy5pc1BvaW50SW5SaW5nKGhvbGVQdCxzaGVsbFB0cyk7aWYoaW5zaWRlU2hlbGwpe3JldHVybiBob2xlUHQ7fVxucmV0dXJuIG51bGw7fVxuanN0cy51dGlsLkFzc2VydC5zaG91bGROZXZlclJlYWNoSGVyZSgncG9pbnRzIGluIHNoZWxsIGFuZCBob2xlIGFwcGVhciB0byBiZSBlcXVhbCcpO3JldHVybiBudWxsO307anN0cy5vcGVyYXRpb24udmFsaWQuSXNWYWxpZE9wLnByb3RvdHlwZS5jaGVja0Nvbm5lY3RlZEludGVyaW9ycz1mdW5jdGlvbihncmFwaCl7dmFyIGNpdD1uZXcganN0cy5vcGVyYXRpb24udmFsaWQuQ29ubmVjdGVkSW50ZXJpb3JUZXN0ZXIoZ3JhcGgpO2lmKCFjaXQuaXNJbnRlcmlvcnNDb25uZWN0ZWQoKSl7dGhpcy52YWxpZEVycj1uZXcganN0cy5vcGVyYXRpb24udmFsaWQuVG9wb2xvZ3lWYWxpZGF0aW9uRXJyb3IoanN0cy5vcGVyYXRpb24udmFsaWQuVG9wb2xvZ3lWYWxpZGF0aW9uRXJyb3IuRElTQ09OTkVDVEVEX0lOVEVSSU9SLGNpdC5nZXRDb29yZGluYXRlKCkpO319O2pzdHMuYWxnb3JpdGhtLlJvYnVzdERldGVybWluYW50PWZ1bmN0aW9uKCl7fTtqc3RzLmFsZ29yaXRobS5Sb2J1c3REZXRlcm1pbmFudC5zaWduT2ZEZXQyeDI9ZnVuY3Rpb24oeDEseTEseDIseTIpe3ZhciBzaWduLHN3YXAsayxjb3VudDtjb3VudD0wO3NpZ249MTtpZigoeDE9PT0wLjApfHwoeTI9PT0wLjApKXtpZigoeTE9PT0wLjApfHwoeDI9PT0wLjApKXtyZXR1cm4gMDt9XG5lbHNlIGlmKHkxPjApe2lmKHgyPjApe3JldHVybi1zaWduO31cbmVsc2V7cmV0dXJuIHNpZ247fX1cbmVsc2V7aWYoeDI+MCl7cmV0dXJuIHNpZ247fVxuZWxzZXtyZXR1cm4tc2lnbjt9fX1cbmlmKCh5MT09PTAuMCl8fCh4Mj09PTAuMCkpe2lmKHkyPjApe2lmKHgxPjApe3JldHVybiBzaWduO31cbmVsc2V7cmV0dXJuLXNpZ247fX1cbmVsc2V7aWYoeDE+MCl7cmV0dXJuLXNpZ247fVxuZWxzZXtyZXR1cm4gc2lnbjt9fX1cbmlmKDAuMDx5MSl7aWYoMC4wPHkyKXtpZih5MT55Mil7c2lnbj0tc2lnbjtzd2FwPXgxO3gxPXgyO3gyPXN3YXA7c3dhcD15MTt5MT15Mjt5Mj1zd2FwO319XG5lbHNle2lmKHkxPD0teTIpe3NpZ249LXNpZ247eDI9LXgyO3kyPS15Mjt9XG5lbHNle3N3YXA9eDE7eDE9LXgyO3gyPXN3YXA7c3dhcD15MTt5MT0teTI7eTI9c3dhcDt9fX1cbmVsc2V7aWYoMC4wPHkyKXtpZigteTE8PXkyKXtzaWduPS1zaWduO3gxPS14MTt5MT0teTE7fVxuZWxzZXtzd2FwPS14MTt4MT14Mjt4Mj1zd2FwO3N3YXA9LXkxO3kxPXkyO3kyPXN3YXA7fX1cbmVsc2V7aWYoeTE+PXkyKXt4MT0teDE7eTE9LXkxO3gyPS14Mjt5Mj0teTI7fVxuZWxzZXtzaWduPS1zaWduO3N3YXA9LXgxO3gxPS14Mjt4Mj1zd2FwO3N3YXA9LXkxO3kxPS15Mjt5Mj1zd2FwO319fVxuaWYoMC4wPHgxKXtpZigwLjA8eDIpe2lmKHgxPngyKXtyZXR1cm4gc2lnbjt9fVxuZWxzZXtyZXR1cm4gc2lnbjt9fVxuZWxzZXtpZigwLjA8eDIpe3JldHVybi1zaWduO31cbmVsc2V7aWYoeDE+PXgyKXtzaWduPS1zaWduO3gxPS14MTt4Mj0teDI7fVxuZWxzZXtyZXR1cm4tc2lnbjt9fX1cbndoaWxlKHRydWUpe2NvdW50PWNvdW50KzE7az1NYXRoLmZsb29yKHgyL3gxKTt4Mj14Mi1rKngxO3kyPXkyLWsqeTE7aWYoeTI8MC4wKXtyZXR1cm4tc2lnbjt9XG5pZih5Mj55MSl7cmV0dXJuIHNpZ247fVxuaWYoeDE+eDIreDIpe2lmKHkxPHkyK3kyKXtyZXR1cm4gc2lnbjt9fVxuZWxzZXtpZih5MT55Mit5Mil7cmV0dXJuLXNpZ247fVxuZWxzZXt4Mj14MS14Mjt5Mj15MS15MjtzaWduPS1zaWduO319XG5pZih5Mj09PTAuMCl7aWYoeDI9PT0wLjApe3JldHVybiAwO31cbmVsc2V7cmV0dXJuLXNpZ247fX1cbmlmKHgyPT09MC4wKXtyZXR1cm4gc2lnbjt9XG5rPU1hdGguZmxvb3IoeDEveDIpO3gxPXgxLWsqeDI7eTE9eTEtayp5MjtpZih5MTwwLjApe3JldHVybiBzaWduO31cbmlmKHkxPnkyKXtyZXR1cm4tc2lnbjt9XG5pZih4Mj54MSt4MSl7aWYoeTI8eTEreTEpe3JldHVybi1zaWduO319XG5lbHNle2lmKHkyPnkxK3kxKXtyZXR1cm4gc2lnbjt9XG5lbHNle3gxPXgyLXgxO3kxPXkyLXkxO3NpZ249LXNpZ247fX1cbmlmKHkxPT09MC4wKXtpZih4MT09PTAuMCl7cmV0dXJuIDA7fVxuZWxzZXtyZXR1cm4gc2lnbjt9fVxuaWYoeDE9PT0wLjApe3JldHVybi1zaWduO319fTtqc3RzLmFsZ29yaXRobS5Sb2J1c3REZXRlcm1pbmFudC5vcmllbnRhdGlvbkluZGV4PWZ1bmN0aW9uKHAxLHAyLHEpe3ZhciBkeDE9cDIueC1wMS54O3ZhciBkeTE9cDIueS1wMS55O3ZhciBkeDI9cS54LXAyLng7dmFyIGR5Mj1xLnktcDIueTtyZXR1cm4ganN0cy5hbGdvcml0aG0uUm9idXN0RGV0ZXJtaW5hbnQuc2lnbk9mRGV0MngyKGR4MSxkeTEsZHgyLGR5Mik7fTtqc3RzLmluZGV4LnF1YWR0cmVlLk5vZGVCYXNlPWZ1bmN0aW9uKCl7dGhpcy5zdWJub2RlPW5ldyBBcnJheSg0KTt0aGlzLnN1Ym5vZGVbMF09bnVsbDt0aGlzLnN1Ym5vZGVbMV09bnVsbDt0aGlzLnN1Ym5vZGVbMl09bnVsbDt0aGlzLnN1Ym5vZGVbM109bnVsbDt0aGlzLml0ZW1zPVtdO307anN0cy5pbmRleC5xdWFkdHJlZS5Ob2RlQmFzZS5wcm90b3R5cGUuZ2V0U3Vibm9kZUluZGV4PWZ1bmN0aW9uKGVudixjZW50cmUpe3ZhciBzdWJub2RlSW5kZXg9LTE7aWYoZW52LmdldE1pblgoKT49Y2VudHJlLngpe2lmKGVudi5nZXRNaW5ZKCk+PWNlbnRyZS55KXtzdWJub2RlSW5kZXg9Mzt9XG5pZihlbnYuZ2V0TWF4WSgpPD1jZW50cmUueSl7c3Vibm9kZUluZGV4PTE7fX1cbmlmKGVudi5nZXRNYXhYKCk8PWNlbnRyZS54KXtpZihlbnYuZ2V0TWluWSgpPj1jZW50cmUueSl7c3Vibm9kZUluZGV4PTI7fVxuaWYoZW52LmdldE1heFkoKTw9Y2VudHJlLnkpe3N1Ym5vZGVJbmRleD0wO319XG5yZXR1cm4gc3Vibm9kZUluZGV4O307anN0cy5pbmRleC5xdWFkdHJlZS5Ob2RlQmFzZS5wcm90b3R5cGUuZ2V0SXRlbXM9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5pdGVtczt9O2pzdHMuaW5kZXgucXVhZHRyZWUuTm9kZUJhc2UucHJvdG90eXBlLmhhc0l0ZW1zPWZ1bmN0aW9uKCl7cmV0dXJuKHRoaXMuaXRlbXMubGVuZ3RoPjApO307anN0cy5pbmRleC5xdWFkdHJlZS5Ob2RlQmFzZS5wcm90b3R5cGUuYWRkPWZ1bmN0aW9uKGl0ZW0pe3RoaXMuaXRlbXMucHVzaChpdGVtKTt9O2pzdHMuaW5kZXgucXVhZHRyZWUuTm9kZUJhc2UucHJvdG90eXBlLnJlbW92ZT1mdW5jdGlvbihpdGVtRW52LGl0ZW0pe2lmKCF0aGlzLmlzU2VhcmNoTWF0Y2goaXRlbUVudikpe3JldHVybiBmYWxzZTt9XG52YXIgZm91bmQ9ZmFsc2UsaT0wO2ZvcihpO2k8NDtpKyspe2lmKHRoaXMuc3Vibm9kZVtpXSE9PW51bGwpe2ZvdW5kPXRoaXMuc3Vibm9kZVtpXS5yZW1vdmUoaXRlbUVudixpdGVtKTtpZihmb3VuZCl7aWYodGhpcy5zdWJub2RlW2ldLmlzUHJ1bmFibGUoKSl7dGhpcy5zdWJub2RlW2ldPW51bGw7fVxuYnJlYWs7fX19XG5pZihmb3VuZCl7cmV0dXJuIGZvdW5kO31cbmlmKHRoaXMuaXRlbXMuaW5kZXhPZihpdGVtKSE9PS0xKXtmb3IodmFyIGk9dGhpcy5pdGVtcy5sZW5ndGgtMTtpPj0wO2ktLSl7aWYodGhpcy5pdGVtc1tpXT09PWl0ZW0pe3RoaXMuaXRlbXMuc3BsaWNlKGksMSk7fX1cbmZvdW5kPXRydWU7fVxucmV0dXJuIGZvdW5kO307anN0cy5pbmRleC5xdWFkdHJlZS5Ob2RlQmFzZS5wcm90b3R5cGUuaXNQcnVuYWJsZT1mdW5jdGlvbigpe3JldHVybiEodGhpcy5oYXNDaGlsZHJlbigpfHx0aGlzLmhhc0l0ZW1zKCkpO307anN0cy5pbmRleC5xdWFkdHJlZS5Ob2RlQmFzZS5wcm90b3R5cGUuaGFzQ2hpbGRyZW49ZnVuY3Rpb24oKXt2YXIgaT0wO2ZvcihpO2k8NDtpKyspe2lmKHRoaXMuc3Vibm9kZVtpXSE9PW51bGwpe3JldHVybiB0cnVlO319XG5yZXR1cm4gZmFsc2U7fTtqc3RzLmluZGV4LnF1YWR0cmVlLk5vZGVCYXNlLnByb3RvdHlwZS5pc0VtcHR5PWZ1bmN0aW9uKCl7dmFyIGlzRW1wdHk9dHJ1ZTtpZih0aGlzLml0ZW1zLmxlbmd0aD4wKXtpc0VtcHR5PWZhbHNlO31cbnZhciBpPTA7Zm9yKGk7aTw0O2krKyl7aWYodGhpcy5zdWJub2RlW2ldIT09bnVsbCl7aWYoIXRoaXMuc3Vibm9kZVtpXS5pc0VtcHR5KCkpe2lzRW1wdHk9ZmFsc2U7fX19XG5yZXR1cm4gaXNFbXB0eTt9O2pzdHMuaW5kZXgucXVhZHRyZWUuTm9kZUJhc2UucHJvdG90eXBlLmFkZEFsbEl0ZW1zPWZ1bmN0aW9uKHJlc3VsdEl0ZW1zKXtyZXN1bHRJdGVtcz1yZXN1bHRJdGVtcy5jb25jYXQodGhpcy5pdGVtcyk7dmFyIGk9MDtmb3IoaTtpPDQ7aSsrKXtpZih0aGlzLnN1Ym5vZGVbaV0hPT1udWxsKXtyZXN1bHRJdGVtcz10aGlzLnN1Ym5vZGVbaV0uYWRkQWxsSXRlbXMocmVzdWx0SXRlbXMpO319XG5yZXR1cm4gcmVzdWx0SXRlbXM7fTtqc3RzLmluZGV4LnF1YWR0cmVlLk5vZGVCYXNlLnByb3RvdHlwZS5hZGRBbGxJdGVtc0Zyb21PdmVybGFwcGluZz1mdW5jdGlvbihzZWFyY2hFbnYscmVzdWx0SXRlbXMpe2lmKCF0aGlzLmlzU2VhcmNoTWF0Y2goc2VhcmNoRW52KSl7cmV0dXJuO31cbnJlc3VsdEl0ZW1zPXJlc3VsdEl0ZW1zLmNvbmNhdCh0aGlzLml0ZW1zKTt2YXIgaT0wO2ZvcihpO2k8NDtpKyspe2lmKHRoaXMuc3Vibm9kZVtpXSE9PW51bGwpe3Jlc3VsdEl0ZW1zPXRoaXMuc3Vibm9kZVtpXS5hZGRBbGxJdGVtc0Zyb21PdmVybGFwcGluZyhzZWFyY2hFbnYscmVzdWx0SXRlbXMpO319fTtqc3RzLmluZGV4LnF1YWR0cmVlLk5vZGVCYXNlLnByb3RvdHlwZS52aXNpdD1mdW5jdGlvbihzZWFyY2hFbnYsdmlzaXRvcil7aWYoIXRoaXMuaXNTZWFyY2hNYXRjaChzZWFyY2hFbnYpKXtyZXR1cm47fVxudGhpcy52aXNpdEl0ZW1zKHNlYXJjaEVudix2aXNpdG9yKTt2YXIgaT0wO2ZvcihpO2k8NDtpKyspe2lmKHRoaXMuc3Vibm9kZVtpXSE9PW51bGwpe3RoaXMuc3Vibm9kZVtpXS52aXNpdChzZWFyY2hFbnYsdmlzaXRvcik7fX19O2pzdHMuaW5kZXgucXVhZHRyZWUuTm9kZUJhc2UucHJvdG90eXBlLnZpc2l0SXRlbXM9ZnVuY3Rpb24oZW52LHZpc2l0b3Ipe3ZhciBpPTAsaWw9dGhpcy5pdGVtcy5sZW5ndGg7Zm9yKGk7aTxpbDtpKyspe3Zpc2l0b3IudmlzaXRJdGVtKHRoaXMuaXRlbXNbaV0pO319O2pzdHMuaW5kZXgucXVhZHRyZWUuTm9kZUJhc2UucHJvdG90eXBlLmRlcHRoPWZ1bmN0aW9uKCl7dmFyIG1heFN1YkRlcHRoPTAsaT0wLHNxZDtmb3IoaTtpPDQ7aSsrKXtpZih0aGlzLnN1Ym5vZGVbaV0hPT1udWxsKXtzcWQ9dGhpcy5zdWJub2RlW2ldLmRlcHRoKCk7aWYoc3FkPm1heFN1YkRlcHRoKXttYXhTdWJEZXB0aD1zcWQ7fX19XG5yZXR1cm4gbWF4U3ViRGVwdGgrMTt9O2pzdHMuaW5kZXgucXVhZHRyZWUuTm9kZUJhc2UucHJvdG90eXBlLnNpemU9ZnVuY3Rpb24oKXt2YXIgc3ViU2l6ZT0wLGk9MDtmb3IoaTtpPDQ7aSsrKXtpZih0aGlzLnN1Ym5vZGVbaV0hPT1udWxsKXtzdWJTaXplKz10aGlzLnN1Ym5vZGVbaV0uc2l6ZSgpO319XG5yZXR1cm4gc3ViU2l6ZSt0aGlzLml0ZW1zLmxlbmd0aDt9O2pzdHMuaW5kZXgucXVhZHRyZWUuTm9kZUJhc2UucHJvdG90eXBlLmdldE5vZGVDb3VudD1mdW5jdGlvbigpe3ZhciBzdWJTaXplPTAsaT0wO2ZvcihpO2k8NDtpKyspe2lmKHRoaXMuc3Vibm9kZVtpXSE9PW51bGwpe3N1YlNpemUrPXRoaXMuc3Vibm9kZVtpXS5zaXplKCk7fX1cbnJldHVybiBzdWJTaXplKzE7fTtqc3RzLmluZGV4LnF1YWR0cmVlLk5vZGU9ZnVuY3Rpb24oZW52LGxldmVsKXtqc3RzLmluZGV4LnF1YWR0cmVlLk5vZGVCYXNlLnByb3RvdHlwZS5jb25zdHJ1Y3Rvci5hcHBseSh0aGlzLGFyZ3VtZW50cyk7dGhpcy5lbnY9ZW52O3RoaXMubGV2ZWw9bGV2ZWw7dGhpcy5jZW50cmU9bmV3IGpzdHMuZ2VvbS5Db29yZGluYXRlKCk7dGhpcy5jZW50cmUueD0oZW52LmdldE1pblgoKStlbnYuZ2V0TWF4WCgpKS8yO3RoaXMuY2VudHJlLnk9KGVudi5nZXRNaW5ZKCkrZW52LmdldE1heFkoKSkvMjt9O2pzdHMuaW5kZXgucXVhZHRyZWUuTm9kZS5wcm90b3R5cGU9bmV3IGpzdHMuaW5kZXgucXVhZHRyZWUuTm9kZUJhc2UoKTtqc3RzLmluZGV4LnF1YWR0cmVlLk5vZGUuY3JlYXRlTm9kZT1mdW5jdGlvbihlbnYpe3ZhciBrZXksbm9kZTtrZXk9bmV3IGpzdHMuaW5kZXgucXVhZHRyZWUuS2V5KGVudik7bm9kZT1uZXcganN0cy5pbmRleC5xdWFkdHJlZS5Ob2RlKGtleS5nZXRFbnZlbG9wZSgpLGtleS5nZXRMZXZlbCgpKTtyZXR1cm4gbm9kZTt9O2pzdHMuaW5kZXgucXVhZHRyZWUuTm9kZS5jcmVhdGVFeHBhbmRlZD1mdW5jdGlvbihub2RlLGFkZEVudil7dmFyIGV4cGFuZEVudj1uZXcganN0cy5nZW9tLkVudmVsb3BlKGFkZEVudiksbGFyZ2VyTm9kZTtpZihub2RlIT09bnVsbCl7ZXhwYW5kRW52LmV4cGFuZFRvSW5jbHVkZShub2RlLmVudik7fVxubGFyZ2VyTm9kZT1qc3RzLmluZGV4LnF1YWR0cmVlLk5vZGUuY3JlYXRlTm9kZShleHBhbmRFbnYpO2lmKG5vZGUhPT1udWxsKXtsYXJnZXJOb2RlLmluc2VydE5vZGUobm9kZSk7fVxucmV0dXJuIGxhcmdlck5vZGU7fTtqc3RzLmluZGV4LnF1YWR0cmVlLk5vZGUucHJvdG90eXBlLmdldEVudmVsb3BlPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZW52O307anN0cy5pbmRleC5xdWFkdHJlZS5Ob2RlLnByb3RvdHlwZS5pc1NlYXJjaE1hdGNoPWZ1bmN0aW9uKHNlYXJjaEVudil7cmV0dXJuIHRoaXMuZW52LmludGVyc2VjdHMoc2VhcmNoRW52KTt9O2pzdHMuaW5kZXgucXVhZHRyZWUuTm9kZS5wcm90b3R5cGUuZ2V0Tm9kZT1mdW5jdGlvbihzZWFyY2hFbnYpe3ZhciBzdWJub2RlSW5kZXg9dGhpcy5nZXRTdWJub2RlSW5kZXgoc2VhcmNoRW52LHRoaXMuY2VudHJlKSxub2RlO2lmKHN1Ym5vZGVJbmRleCE9PS0xKXtub2RlPXRoaXMuZ2V0U3Vibm9kZShzdWJub2RlSW5kZXgpO3JldHVybiBub2RlLmdldE5vZGUoc2VhcmNoRW52KTt9ZWxzZXtyZXR1cm4gdGhpczt9fTtqc3RzLmluZGV4LnF1YWR0cmVlLk5vZGUucHJvdG90eXBlLmZpbmQ9ZnVuY3Rpb24oc2VhcmNoRW52KXt2YXIgc3Vibm9kZUluZGV4PXRoaXMuZ2V0U3Vibm9kZUluZGV4KHNlYXJjaEVudix0aGlzLmNlbnRyZSksbm9kZTtpZihzdWJub2RlSW5kZXg9PT0tMSl7cmV0dXJuIHRoaXM7fVxuaWYodGhpcy5zdWJub2RlW3N1Ym5vZGVJbmRleF0hPT1udWxsKXtub2RlPXRoaXMuc3Vibm9kZVtzdWJub2RlSW5kZXhdO3JldHVybiBub2RlLmZpbmQoc2VhcmNoRW52KTt9XG5yZXR1cm4gdGhpczt9O2pzdHMuaW5kZXgucXVhZHRyZWUuTm9kZS5wcm90b3R5cGUuaW5zZXJ0Tm9kZT1mdW5jdGlvbihub2RlKXt2YXIgaW5kZXg9dGhpcy5nZXRTdWJub2RlSW5kZXgobm9kZS5lbnYsdGhpcy5jZW50cmUpLGNoaWxkTm9kZTtpZihub2RlLmxldmVsPT09dGhpcy5sZXZlbC0xKXt0aGlzLnN1Ym5vZGVbaW5kZXhdPW5vZGU7fWVsc2V7Y2hpbGROb2RlPXRoaXMuY3JlYXRlU3Vibm9kZShpbmRleCk7Y2hpbGROb2RlLmluc2VydE5vZGUobm9kZSk7dGhpcy5zdWJub2RlW2luZGV4XT1jaGlsZE5vZGU7fX07anN0cy5pbmRleC5xdWFkdHJlZS5Ob2RlLnByb3RvdHlwZS5nZXRTdWJub2RlPWZ1bmN0aW9uKGluZGV4KXtpZih0aGlzLnN1Ym5vZGVbaW5kZXhdPT09bnVsbCl7dGhpcy5zdWJub2RlW2luZGV4XT10aGlzLmNyZWF0ZVN1Ym5vZGUoaW5kZXgpO31cbnJldHVybiB0aGlzLnN1Ym5vZGVbaW5kZXhdO307anN0cy5pbmRleC5xdWFkdHJlZS5Ob2RlLnByb3RvdHlwZS5jcmVhdGVTdWJub2RlPWZ1bmN0aW9uKGluZGV4KXt2YXIgbWlueD0wLjAsbWF4eD0wLjAsbWlueT0wLjAsbWF4eT0wLjAsc3FFbnYsbm9kZTtzd2l0Y2goaW5kZXgpe2Nhc2UgMDptaW54PXRoaXMuZW52LmdldE1pblgoKTttYXh4PXRoaXMuY2VudHJlLng7bWlueT10aGlzLmVudi5nZXRNaW5ZKCk7bWF4eT10aGlzLmNlbnRyZS55O2JyZWFrO2Nhc2UgMTptaW54PXRoaXMuY2VudHJlLng7bWF4eD10aGlzLmVudi5nZXRNYXhYKCk7bWlueT10aGlzLmVudi5nZXRNaW5ZKCk7bWF4eT10aGlzLmNlbnRyZS55O2JyZWFrO2Nhc2UgMjptaW54PXRoaXMuZW52LmdldE1pblgoKTttYXh4PXRoaXMuY2VudHJlLng7bWlueT10aGlzLmNlbnRyZS55O21heHk9dGhpcy5lbnYuZ2V0TWF4WSgpO2JyZWFrO2Nhc2UgMzptaW54PXRoaXMuY2VudHJlLng7bWF4eD10aGlzLmVudi5nZXRNYXhYKCk7bWlueT10aGlzLmNlbnRyZS55O21heHk9dGhpcy5lbnYuZ2V0TWF4WSgpO2JyZWFrO31cbnNxRW52PW5ldyBqc3RzLmdlb20uRW52ZWxvcGUobWlueCxtYXh4LG1pbnksbWF4eSk7bm9kZT1uZXcganN0cy5pbmRleC5xdWFkdHJlZS5Ob2RlKHNxRW52LHRoaXMubGV2ZWwtMSk7cmV0dXJuIG5vZGU7fTsoZnVuY3Rpb24oKXtqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlF1YWRFZGdlPWZ1bmN0aW9uKCl7dGhpcy5yb3Q9bnVsbDt0aGlzLnZlcnRleD1udWxsO3RoaXMubmV4dD1udWxsO3RoaXMuZGF0YT1udWxsO307dmFyIFF1YWRFZGdlPWpzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuUXVhZEVkZ2U7anN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5RdWFkRWRnZS5tYWtlRWRnZT1mdW5jdGlvbihvLGQpe3ZhciBxMCxxMSxxMixxMyxiYXNlO3EwPW5ldyBRdWFkRWRnZSgpO3ExPW5ldyBRdWFkRWRnZSgpO3EyPW5ldyBRdWFkRWRnZSgpO3EzPW5ldyBRdWFkRWRnZSgpO3EwLnJvdD1xMTtxMS5yb3Q9cTI7cTIucm90PXEzO3EzLnJvdD1xMDtxMC5zZXROZXh0KHEwKTtxMS5zZXROZXh0KHEzKTtxMi5zZXROZXh0KHEyKTtxMy5zZXROZXh0KHExKTtiYXNlPXEwO2Jhc2Uuc2V0T3JpZyhvKTtiYXNlLnNldERlc3QoZCk7cmV0dXJuIGJhc2U7fTtqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlF1YWRFZGdlLmNvbm5lY3Q9ZnVuY3Rpb24oYSxiKXt2YXIgZT1RdWFkRWRnZS5tYWtlRWRnZShhLmRlc3QoKSxiLm9yaWcoKSk7UXVhZEVkZ2Uuc3BsaWNlKGUsYS5sTmV4dCgpKTtRdWFkRWRnZS5zcGxpY2UoZS5zeW0oKSxiKTtyZXR1cm4gZTt9O2pzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuUXVhZEVkZ2Uuc3BsaWNlPWZ1bmN0aW9uKGEsYil7dmFyIGFscGhhLGJldGEsdDEsdDIsdDMsdDQ7YWxwaGE9YS5vTmV4dCgpLnJvdDtiZXRhPWIub05leHQoKS5yb3Q7dDE9Yi5vTmV4dCgpO3QyPWEub05leHQoKTt0Mz1iZXRhLm9OZXh0KCk7dDQ9YWxwaGEub05leHQoKTthLnNldE5leHQodDEpO2Iuc2V0TmV4dCh0Mik7YWxwaGEuc2V0TmV4dCh0Myk7YmV0YS5zZXROZXh0KHQ0KTt9O2pzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuUXVhZEVkZ2Uuc3dhcD1mdW5jdGlvbihlKXt2YXIgYSxiO2E9ZS5vUHJldigpO2I9ZS5zeW0oKS5vUHJldigpO1F1YWRFZGdlLnNwbGljZShlLGEpO1F1YWRFZGdlLnNwbGljZShlLnN5bSgpLGIpO1F1YWRFZGdlLnNwbGljZShlLGEubE5leHQoKSk7UXVhZEVkZ2Uuc3BsaWNlKGUuc3ltKCksYi5sTmV4dCgpKTtlLnNldE9yaWcoYS5kZXN0KCkpO2Uuc2V0RGVzdChiLmRlc3QoKSk7fTtqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlF1YWRFZGdlLnByb3RvdHlwZS5nZXRQcmltYXJ5PWZ1bmN0aW9uKCl7aWYodGhpcy5vcmlnKCkuZ2V0Q29vcmRpbmF0ZSgpLmNvbXBhcmVUbyh0aGlzLmRlc3QoKS5nZXRDb29yZGluYXRlKCkpPD0wKXtyZXR1cm4gdGhpczt9XG5lbHNle3JldHVybiB0aGlzLnN5bSgpO319O2pzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuUXVhZEVkZ2UucHJvdG90eXBlLnNldERhdGE9ZnVuY3Rpb24oZGF0YSl7dGhpcy5kYXRhPWRhdGE7fTtqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlF1YWRFZGdlLnByb3RvdHlwZS5nZXREYXRhPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZGF0YTt9O2pzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuUXVhZEVkZ2UucHJvdG90eXBlLmRlbGV0ZV9qc3RzPWZ1bmN0aW9uKCl7dGhpcy5yb3Q9bnVsbDt9O2pzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuUXVhZEVkZ2UucHJvdG90eXBlLmlzTGl2ZT1mdW5jdGlvbigpe3JldHVybiB0aGlzLnJvdCE9PW51bGw7fTtqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlF1YWRFZGdlLnByb3RvdHlwZS5zZXROZXh0PWZ1bmN0aW9uKG5leHQpe3RoaXMubmV4dD1uZXh0O307anN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5RdWFkRWRnZS5wcm90b3R5cGUuaW52Um90PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMucm90LnN5bSgpO307anN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5RdWFkRWRnZS5wcm90b3R5cGUuc3ltPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMucm90LnJvdDt9O2pzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuUXVhZEVkZ2UucHJvdG90eXBlLm9OZXh0PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMubmV4dDt9O2pzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuUXVhZEVkZ2UucHJvdG90eXBlLm9QcmV2PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMucm90Lm5leHQucm90O307anN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5RdWFkRWRnZS5wcm90b3R5cGUuZE5leHQ9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5zeW0oKS5vTmV4dCgpLnN5bSgpO307anN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5RdWFkRWRnZS5wcm90b3R5cGUuZFByZXY9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5pbnZSb3QoKS5vTmV4dCgpLmludlJvdCgpO307anN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5RdWFkRWRnZS5wcm90b3R5cGUubE5leHQ9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5pbnZSb3QoKS5vTmV4dCgpLnJvdDt9O2pzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuUXVhZEVkZ2UucHJvdG90eXBlLmxQcmV2PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMubmV4dC5zeW0oKTt9O2pzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuUXVhZEVkZ2UucHJvdG90eXBlLnJOZXh0PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMucm90Lm5leHQuaW52Um90KCk7fTtqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlF1YWRFZGdlLnByb3RvdHlwZS5yUHJldj1mdW5jdGlvbigpe3JldHVybiB0aGlzLnN5bSgpLm9OZXh0KCk7fTtqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlF1YWRFZGdlLnByb3RvdHlwZS5zZXRPcmlnPWZ1bmN0aW9uKG8pe3RoaXMudmVydGV4PW87fTtqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlF1YWRFZGdlLnByb3RvdHlwZS5zZXREZXN0PWZ1bmN0aW9uKGQpe3RoaXMuc3ltKCkuc2V0T3JpZyhkKTt9O2pzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuUXVhZEVkZ2UucHJvdG90eXBlLm9yaWc9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy52ZXJ0ZXg7fTtqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlF1YWRFZGdlLnByb3RvdHlwZS5kZXN0PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuc3ltKCkub3JpZygpO307anN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5RdWFkRWRnZS5wcm90b3R5cGUuZ2V0TGVuZ3RoPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMub3JpZygpLmdldENvb3JkaW5hdGUoKS5kaXN0YW5jZShkZXN0KCkuZ2V0Q29vcmRpbmF0ZSgpKTt9O2pzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuUXVhZEVkZ2UucHJvdG90eXBlLmVxdWFsc05vbk9yaWVudGVkPWZ1bmN0aW9uKHFlKXtpZih0aGlzLmVxdWFsc09yaWVudGVkKHFlKSl7cmV0dXJuIHRydWU7fVxuaWYodGhpcy5lcXVhbHNPcmllbnRlZChxZS5zeW0oKSkpe3JldHVybiB0cnVlO31cbnJldHVybiBmYWxzZTt9O2pzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuUXVhZEVkZ2UucHJvdG90eXBlLmVxdWFsc09yaWVudGVkPWZ1bmN0aW9uKHFlKXtpZih0aGlzLm9yaWcoKS5nZXRDb29yZGluYXRlKCkuZXF1YWxzMkQocWUub3JpZygpLmdldENvb3JkaW5hdGUoKSkmJnRoaXMuZGVzdCgpLmdldENvb3JkaW5hdGUoKS5lcXVhbHMyRChxZS5kZXN0KCkuZ2V0Q29vcmRpbmF0ZSgpKSl7cmV0dXJuIHRydWU7fVxucmV0dXJuIGZhbHNlO307anN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5RdWFkRWRnZS5wcm90b3R5cGUudG9MaW5lU2VnbWVudD1mdW5jdGlvbigpXG57cmV0dXJuIG5ldyBqc3RzLmdlb20uTGluZVNlZ21lbnQodGhpcy52ZXJ0ZXguZ2V0Q29vcmRpbmF0ZSgpLHRoaXMuZGVzdCgpLmdldENvb3JkaW5hdGUoKSk7fTtqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlF1YWRFZGdlLnByb3RvdHlwZS50b1N0cmluZz1mdW5jdGlvbigpe3ZhciBwMCxwMTtwMD10aGlzLnZlcnRleC5nZXRDb29yZGluYXRlKCk7cDE9dGhpcy5kZXN0KCkuZ2V0Q29vcmRpbmF0ZSgpO3JldHVybiBqc3RzLmlvLldLVFdyaXRlci50b0xpbmVTdHJpbmcocDAscDEpO307fSkoKTsoZnVuY3Rpb24oKXt2YXIgQXNzZXJ0PWpzdHMudXRpbC5Bc3NlcnQ7anN0cy5nZW9tZ3JhcGguRWRnZUVuZD1mdW5jdGlvbihlZGdlLHAwLHAxLGxhYmVsKXt0aGlzLmVkZ2U9ZWRnZTtpZihwMCYmcDEpe3RoaXMuaW5pdChwMCxwMSk7fVxuaWYobGFiZWwpe3RoaXMubGFiZWw9bGFiZWx8fG51bGw7fX07anN0cy5nZW9tZ3JhcGguRWRnZUVuZC5wcm90b3R5cGUuZWRnZT1udWxsO2pzdHMuZ2VvbWdyYXBoLkVkZ2VFbmQucHJvdG90eXBlLmxhYmVsPW51bGw7anN0cy5nZW9tZ3JhcGguRWRnZUVuZC5wcm90b3R5cGUubm9kZT1udWxsO2pzdHMuZ2VvbWdyYXBoLkVkZ2VFbmQucHJvdG90eXBlLnAwPW51bGw7anN0cy5nZW9tZ3JhcGguRWRnZUVuZC5wcm90b3R5cGUucDE9bnVsbDtqc3RzLmdlb21ncmFwaC5FZGdlRW5kLnByb3RvdHlwZS5keD1udWxsO2pzdHMuZ2VvbWdyYXBoLkVkZ2VFbmQucHJvdG90eXBlLmR5PW51bGw7anN0cy5nZW9tZ3JhcGguRWRnZUVuZC5wcm90b3R5cGUucXVhZHJhbnQ9bnVsbDtqc3RzLmdlb21ncmFwaC5FZGdlRW5kLnByb3RvdHlwZS5pbml0PWZ1bmN0aW9uKHAwLHAxKXt0aGlzLnAwPXAwO3RoaXMucDE9cDE7dGhpcy5keD1wMS54LXAwLng7dGhpcy5keT1wMS55LXAwLnk7dGhpcy5xdWFkcmFudD1qc3RzLmdlb21ncmFwaC5RdWFkcmFudC5xdWFkcmFudCh0aGlzLmR4LHRoaXMuZHkpO0Fzc2VydC5pc1RydWUoISh0aGlzLmR4PT09MCYmdGhpcy5keT09PTApLCdFZGdlRW5kIHdpdGggaWRlbnRpY2FsIGVuZHBvaW50cyBmb3VuZCcpO307anN0cy5nZW9tZ3JhcGguRWRnZUVuZC5wcm90b3R5cGUuZ2V0RWRnZT1mdW5jdGlvbigpe3JldHVybiB0aGlzLmVkZ2U7fTtqc3RzLmdlb21ncmFwaC5FZGdlRW5kLnByb3RvdHlwZS5nZXRMYWJlbD1mdW5jdGlvbigpe3JldHVybiB0aGlzLmxhYmVsO307anN0cy5nZW9tZ3JhcGguRWRnZUVuZC5wcm90b3R5cGUuZ2V0Q29vcmRpbmF0ZT1mdW5jdGlvbigpe3JldHVybiB0aGlzLnAwO307anN0cy5nZW9tZ3JhcGguRWRnZUVuZC5wcm90b3R5cGUuZ2V0RGlyZWN0ZWRDb29yZGluYXRlPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMucDE7fTtqc3RzLmdlb21ncmFwaC5FZGdlRW5kLnByb3RvdHlwZS5nZXRRdWFkcmFudD1mdW5jdGlvbigpe3JldHVybiB0aGlzLnF1YWRyYW50O307anN0cy5nZW9tZ3JhcGguRWRnZUVuZC5wcm90b3R5cGUuZ2V0RHg9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5keDt9O2pzdHMuZ2VvbWdyYXBoLkVkZ2VFbmQucHJvdG90eXBlLmdldER5PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZHk7fTtqc3RzLmdlb21ncmFwaC5FZGdlRW5kLnByb3RvdHlwZS5zZXROb2RlPWZ1bmN0aW9uKG5vZGUpe3RoaXMubm9kZT1ub2RlO307anN0cy5nZW9tZ3JhcGguRWRnZUVuZC5wcm90b3R5cGUuZ2V0Tm9kZT1mdW5jdGlvbigpe3JldHVybiB0aGlzLm5vZGU7fTtqc3RzLmdlb21ncmFwaC5FZGdlRW5kLnByb3RvdHlwZS5jb21wYXJlVG89ZnVuY3Rpb24oZSl7cmV0dXJuIHRoaXMuY29tcGFyZURpcmVjdGlvbihlKTt9O2pzdHMuZ2VvbWdyYXBoLkVkZ2VFbmQucHJvdG90eXBlLmNvbXBhcmVEaXJlY3Rpb249ZnVuY3Rpb24oZSl7aWYodGhpcy5keD09PWUuZHgmJnRoaXMuZHk9PT1lLmR5KVxucmV0dXJuIDA7aWYodGhpcy5xdWFkcmFudD5lLnF1YWRyYW50KVxucmV0dXJuIDE7aWYodGhpcy5xdWFkcmFudDxlLnF1YWRyYW50KVxucmV0dXJuLTE7cmV0dXJuIGpzdHMuYWxnb3JpdGhtLkNHQWxnb3JpdGhtcy5jb21wdXRlT3JpZW50YXRpb24oZS5wMCxlLnAxLHRoaXMucDEpO307anN0cy5nZW9tZ3JhcGguRWRnZUVuZC5wcm90b3R5cGUuY29tcHV0ZUxhYmVsPWZ1bmN0aW9uKGJvdW5kYXJ5Tm9kZVJ1bGUpe307fSkoKTtqc3RzLm9wZXJhdGlvbi5idWZmZXIuUmlnaHRtb3N0RWRnZUZpbmRlcj1mdW5jdGlvbigpe307anN0cy5vcGVyYXRpb24uYnVmZmVyLlJpZ2h0bW9zdEVkZ2VGaW5kZXIucHJvdG90eXBlLm1pbkluZGV4PS0xO2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5SaWdodG1vc3RFZGdlRmluZGVyLnByb3RvdHlwZS5taW5Db29yZD1udWxsO2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5SaWdodG1vc3RFZGdlRmluZGVyLnByb3RvdHlwZS5taW5EZT1udWxsO2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5SaWdodG1vc3RFZGdlRmluZGVyLnByb3RvdHlwZS5vcmllbnRlZERlPW51bGw7anN0cy5vcGVyYXRpb24uYnVmZmVyLlJpZ2h0bW9zdEVkZ2VGaW5kZXIucHJvdG90eXBlLmdldEVkZ2U9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5vcmllbnRlZERlO307anN0cy5vcGVyYXRpb24uYnVmZmVyLlJpZ2h0bW9zdEVkZ2VGaW5kZXIucHJvdG90eXBlLmdldENvb3JkaW5hdGU9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5taW5Db29yZDt9O2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5SaWdodG1vc3RFZGdlRmluZGVyLnByb3RvdHlwZS5maW5kRWRnZT1mdW5jdGlvbihkaXJFZGdlTGlzdCl7Zm9yKHZhciBpPWRpckVkZ2VMaXN0Lml0ZXJhdG9yKCk7aS5oYXNOZXh0KCk7KXt2YXIgZGU9aS5uZXh0KCk7aWYoIWRlLmlzRm9yd2FyZCgpKVxuY29udGludWU7dGhpcy5jaGVja0ZvclJpZ2h0bW9zdENvb3JkaW5hdGUoZGUpO31cbmpzdHMudXRpbC5Bc3NlcnQuaXNUcnVlKHRoaXMubWluSW5kZXghPT0wfHx0aGlzLm1pbkNvb3JkLmVxdWFscyh0aGlzLm1pbkRlLmdldENvb3JkaW5hdGUoKSksJ2luY29uc2lzdGVuY3kgaW4gcmlnaHRtb3N0IHByb2Nlc3NpbmcnKTtpZih0aGlzLm1pbkluZGV4PT09MCl7dGhpcy5maW5kUmlnaHRtb3N0RWRnZUF0Tm9kZSgpO31lbHNle3RoaXMuZmluZFJpZ2h0bW9zdEVkZ2VBdFZlcnRleCgpO31cbnRoaXMub3JpZW50ZWREZT10aGlzLm1pbkRlO3ZhciByaWdodG1vc3RTaWRlPXRoaXMuZ2V0UmlnaHRtb3N0U2lkZSh0aGlzLm1pbkRlLHRoaXMubWluSW5kZXgpO2lmKHJpZ2h0bW9zdFNpZGU9PWpzdHMuZ2VvbWdyYXBoLlBvc2l0aW9uLkxFRlQpe3RoaXMub3JpZW50ZWREZT10aGlzLm1pbkRlLmdldFN5bSgpO319O2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5SaWdodG1vc3RFZGdlRmluZGVyLnByb3RvdHlwZS5maW5kUmlnaHRtb3N0RWRnZUF0Tm9kZT1mdW5jdGlvbigpe3ZhciBub2RlPXRoaXMubWluRGUuZ2V0Tm9kZSgpO3ZhciBzdGFyPW5vZGUuZ2V0RWRnZXMoKTt0aGlzLm1pbkRlPXN0YXIuZ2V0UmlnaHRtb3N0RWRnZSgpO2lmKCF0aGlzLm1pbkRlLmlzRm9yd2FyZCgpKXt0aGlzLm1pbkRlPXRoaXMubWluRGUuZ2V0U3ltKCk7dGhpcy5taW5JbmRleD10aGlzLm1pbkRlLmdldEVkZ2UoKS5nZXRDb29yZGluYXRlcygpLmxlbmd0aC0xO319O2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5SaWdodG1vc3RFZGdlRmluZGVyLnByb3RvdHlwZS5maW5kUmlnaHRtb3N0RWRnZUF0VmVydGV4PWZ1bmN0aW9uKCl7dmFyIHB0cz10aGlzLm1pbkRlLmdldEVkZ2UoKS5nZXRDb29yZGluYXRlcygpO2pzdHMudXRpbC5Bc3NlcnQuaXNUcnVlKHRoaXMubWluSW5kZXg+MCYmdGhpcy5taW5JbmRleDxwdHMubGVuZ3RoLCdyaWdodG1vc3QgcG9pbnQgZXhwZWN0ZWQgdG8gYmUgaW50ZXJpb3IgdmVydGV4IG9mIGVkZ2UnKTt2YXIgcFByZXY9cHRzW3RoaXMubWluSW5kZXgtMV07dmFyIHBOZXh0PXB0c1t0aGlzLm1pbkluZGV4KzFdO3ZhciBvcmllbnRhdGlvbj1qc3RzLmFsZ29yaXRobS5DR0FsZ29yaXRobXMuY29tcHV0ZU9yaWVudGF0aW9uKHRoaXMubWluQ29vcmQscE5leHQscFByZXYpO3ZhciB1c2VQcmV2PWZhbHNlO2lmKHBQcmV2Lnk8dGhpcy5taW5Db29yZC55JiZwTmV4dC55PHRoaXMubWluQ29vcmQueSYmb3JpZW50YXRpb249PT1qc3RzLmFsZ29yaXRobS5DR0FsZ29yaXRobXMuQ09VTlRFUkNMT0NLV0lTRSl7dXNlUHJldj10cnVlO31lbHNlIGlmKHBQcmV2Lnk+dGhpcy5taW5Db29yZC55JiZwTmV4dC55PnRoaXMubWluQ29vcmQueSYmb3JpZW50YXRpb249PT1qc3RzLmFsZ29yaXRobS5DR0FsZ29yaXRobXMuQ0xPQ0tXSVNFKXt1c2VQcmV2PXRydWU7fVxuaWYodXNlUHJldil7dGhpcy5taW5JbmRleD10aGlzLm1pbkluZGV4LTE7fX07anN0cy5vcGVyYXRpb24uYnVmZmVyLlJpZ2h0bW9zdEVkZ2VGaW5kZXIucHJvdG90eXBlLmNoZWNrRm9yUmlnaHRtb3N0Q29vcmRpbmF0ZT1mdW5jdGlvbihkZSl7dmFyIGNvb3JkPWRlLmdldEVkZ2UoKS5nZXRDb29yZGluYXRlcygpO2Zvcih2YXIgaT0wO2k8Y29vcmQubGVuZ3RoLTE7aSsrKXtpZih0aGlzLm1pbkNvb3JkPT09bnVsbHx8Y29vcmRbaV0ueD50aGlzLm1pbkNvb3JkLngpe3RoaXMubWluRGU9ZGU7dGhpcy5taW5JbmRleD1pO3RoaXMubWluQ29vcmQ9Y29vcmRbaV07fX19O2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5SaWdodG1vc3RFZGdlRmluZGVyLnByb3RvdHlwZS5nZXRSaWdodG1vc3RTaWRlPWZ1bmN0aW9uKGRlLGluZGV4KXt2YXIgc2lkZT10aGlzLmdldFJpZ2h0bW9zdFNpZGVPZlNlZ21lbnQoZGUsaW5kZXgpO2lmKHNpZGU8MClcbnNpZGU9dGhpcy5nZXRSaWdodG1vc3RTaWRlT2ZTZWdtZW50KGRlLGluZGV4LTEpO2lmKHNpZGU8MCl7dGhpcy5taW5Db29yZD1udWxsO3RoaXMuY2hlY2tGb3JSaWdodG1vc3RDb29yZGluYXRlKGRlKTt9XG5yZXR1cm4gc2lkZTt9O2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5SaWdodG1vc3RFZGdlRmluZGVyLnByb3RvdHlwZS5nZXRSaWdodG1vc3RTaWRlT2ZTZWdtZW50PWZ1bmN0aW9uKGRlLGkpe3ZhciBlPWRlLmdldEVkZ2UoKTt2YXIgY29vcmQ9ZS5nZXRDb29yZGluYXRlcygpO2lmKGk8MHx8aSsxPj1jb29yZC5sZW5ndGgpXG5yZXR1cm4tMTtpZihjb29yZFtpXS55PT1jb29yZFtpKzFdLnkpXG5yZXR1cm4tMTt2YXIgcG9zPWpzdHMuZ2VvbWdyYXBoLlBvc2l0aW9uLkxFRlQ7aWYoY29vcmRbaV0ueTxjb29yZFtpKzFdLnkpXG5wb3M9anN0cy5nZW9tZ3JhcGguUG9zaXRpb24uUklHSFQ7cmV0dXJuIHBvczt9OyhmdW5jdGlvbigpe2pzdHMudHJpYW5ndWxhdGUuSW5jcmVtZW50YWxEZWxhdW5heVRyaWFuZ3VsYXRvcj1mdW5jdGlvbihzdWJkaXYpe3RoaXMuc3ViZGl2PXN1YmRpdjt0aGlzLmlzVXNpbmdUb2xlcmFuY2U9c3ViZGl2LmdldFRvbGVyYW5jZSgpPjAuMDt9O2pzdHMudHJpYW5ndWxhdGUuSW5jcmVtZW50YWxEZWxhdW5heVRyaWFuZ3VsYXRvci5wcm90b3R5cGUuaW5zZXJ0U2l0ZXM9ZnVuY3Rpb24odmVydGljZXMpe3ZhciBpPTAsaWw9dmVydGljZXMubGVuZ3RoLHY7Zm9yKGk7aTxpbDtpKyspe3Y9dmVydGljZXNbaV07dGhpcy5pbnNlcnRTaXRlKHYpO319O2pzdHMudHJpYW5ndWxhdGUuSW5jcmVtZW50YWxEZWxhdW5heVRyaWFuZ3VsYXRvci5wcm90b3R5cGUuaW5zZXJ0U2l0ZT1mdW5jdGlvbih2KXt2YXIgZSxiYXNlLHN0YXJ0RWRnZSx0O2U9dGhpcy5zdWJkaXYubG9jYXRlKHYpO2lmKHRoaXMuc3ViZGl2LmlzVmVydGV4T2ZFZGdlKGUsdikpe3JldHVybiBlO31cbmVsc2UgaWYodGhpcy5zdWJkaXYuaXNPbkVkZ2UoZSx2LmdldENvb3JkaW5hdGUoKSkpe2U9ZS5vUHJldigpO3RoaXMuc3ViZGl2LmRlbGV0ZV9qc3RzKGUub05leHQoKSk7fVxuYmFzZT10aGlzLnN1YmRpdi5tYWtlRWRnZShlLm9yaWcoKSx2KTtqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlF1YWRFZGdlLnNwbGljZShiYXNlLGUpO3N0YXJ0RWRnZT1iYXNlO2Rve2Jhc2U9dGhpcy5zdWJkaXYuY29ubmVjdChlLGJhc2Uuc3ltKCkpO2U9YmFzZS5vUHJldigpO313aGlsZShlLmxOZXh0KCkhPXN0YXJ0RWRnZSk7ZG97dD1lLm9QcmV2KCk7aWYodC5kZXN0KCkucmlnaHRPZihlKSYmdi5pc0luQ2lyY2xlKGUub3JpZygpLHQuZGVzdCgpLGUuZGVzdCgpKSl7anN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5RdWFkRWRnZS5zd2FwKGUpO2U9ZS5vUHJldigpO31lbHNlIGlmKGUub05leHQoKT09c3RhcnRFZGdlKXtyZXR1cm4gYmFzZTt9ZWxzZXtlPWUub05leHQoKS5sUHJldigpO319d2hpbGUodHJ1ZSk7fTt9KCkpO2pzdHMuYWxnb3JpdGhtLkNlbnRyb2lkQXJlYT1mdW5jdGlvbigpe3RoaXMuYmFzZVB0PW51bGw7dGhpcy50cmlhbmdsZUNlbnQzPW5ldyBqc3RzLmdlb20uQ29vcmRpbmF0ZSgpO3RoaXMuY2VudFN1bT1uZXcganN0cy5nZW9tLkNvb3JkaW5hdGUoKTt0aGlzLmNnMz1uZXcganN0cy5nZW9tLkNvb3JkaW5hdGUoKTt9O2pzdHMuYWxnb3JpdGhtLkNlbnRyb2lkQXJlYS5wcm90b3R5cGUuYmFzZVB0PW51bGw7anN0cy5hbGdvcml0aG0uQ2VudHJvaWRBcmVhLnByb3RvdHlwZS50cmlhbmdsZUNlbnQzPW51bGw7anN0cy5hbGdvcml0aG0uQ2VudHJvaWRBcmVhLnByb3RvdHlwZS5hcmVhc3VtMj0wO2pzdHMuYWxnb3JpdGhtLkNlbnRyb2lkQXJlYS5wcm90b3R5cGUuY2czPW51bGw7anN0cy5hbGdvcml0aG0uQ2VudHJvaWRBcmVhLnByb3RvdHlwZS5jZW50U3VtPW51bGw7anN0cy5hbGdvcml0aG0uQ2VudHJvaWRBcmVhLnByb3RvdHlwZS50b3RhbExlbmd0aD0wLjA7anN0cy5hbGdvcml0aG0uQ2VudHJvaWRBcmVhLnByb3RvdHlwZS5hZGQ9ZnVuY3Rpb24oZ2VvbSl7aWYoZ2VvbSBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5Qb2x5Z29uKXt2YXIgcG9seT1nZW9tO3RoaXMuc2V0QmFzZVBvaW50KHBvbHkuZ2V0RXh0ZXJpb3JSaW5nKCkuZ2V0Q29vcmRpbmF0ZU4oMCkpO3RoaXMuYWRkMyhwb2x5KTt9ZWxzZSBpZihnZW9tIGluc3RhbmNlb2YganN0cy5nZW9tLkdlb21ldHJ5Q29sbGVjdGlvbnx8Z2VvbSBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5NdWx0aVBvbHlnb24pe3ZhciBnYz1nZW9tO2Zvcih2YXIgaT0wO2k8Z2MuZ2V0TnVtR2VvbWV0cmllcygpO2krKyl7dGhpcy5hZGQoZ2MuZ2V0R2VvbWV0cnlOKGkpKTt9fWVsc2UgaWYoZ2VvbSBpbnN0YW5jZW9mIEFycmF5KXt0aGlzLmFkZDIoZ2VvbSk7fX07anN0cy5hbGdvcml0aG0uQ2VudHJvaWRBcmVhLnByb3RvdHlwZS5hZGQyPWZ1bmN0aW9uKHJpbmcpe3RoaXMuc2V0QmFzZVBvaW50KHJpbmdbMF0pO3RoaXMuYWRkU2hlbGwocmluZyk7fTtqc3RzLmFsZ29yaXRobS5DZW50cm9pZEFyZWEucHJvdG90eXBlLmdldENlbnRyb2lkPWZ1bmN0aW9uKCl7dmFyIGNlbnQ9bmV3IGpzdHMuZ2VvbS5Db29yZGluYXRlKCk7aWYoTWF0aC5hYnModGhpcy5hcmVhc3VtMik+MC4wKXtjZW50Lng9dGhpcy5jZzMueC8zL3RoaXMuYXJlYXN1bTI7Y2VudC55PXRoaXMuY2czLnkvMy90aGlzLmFyZWFzdW0yO31lbHNle2NlbnQueD10aGlzLmNlbnRTdW0ueC90aGlzLnRvdGFsTGVuZ3RoO2NlbnQueT10aGlzLmNlbnRTdW0ueS90aGlzLnRvdGFsTGVuZ3RoO31cbnJldHVybiBjZW50O307anN0cy5hbGdvcml0aG0uQ2VudHJvaWRBcmVhLnByb3RvdHlwZS5zZXRCYXNlUG9pbnQ9ZnVuY3Rpb24oYmFzZVB0KXtpZih0aGlzLmJhc2VQdD09bnVsbClcbnRoaXMuYmFzZVB0PWJhc2VQdDt9O2pzdHMuYWxnb3JpdGhtLkNlbnRyb2lkQXJlYS5wcm90b3R5cGUuYWRkMz1mdW5jdGlvbihwb2x5KXt0aGlzLmFkZFNoZWxsKHBvbHkuZ2V0RXh0ZXJpb3JSaW5nKCkuZ2V0Q29vcmRpbmF0ZXMoKSk7Zm9yKHZhciBpPTA7aTxwb2x5LmdldE51bUludGVyaW9yUmluZygpO2krKyl7dGhpcy5hZGRIb2xlKHBvbHkuZ2V0SW50ZXJpb3JSaW5nTihpKS5nZXRDb29yZGluYXRlcygpKTt9fTtqc3RzLmFsZ29yaXRobS5DZW50cm9pZEFyZWEucHJvdG90eXBlLmFkZFNoZWxsPWZ1bmN0aW9uKHB0cyl7dmFyIGlzUG9zaXRpdmVBcmVhPSFqc3RzLmFsZ29yaXRobS5DR0FsZ29yaXRobXMuaXNDQ1cocHRzKTtmb3IodmFyIGk9MDtpPHB0cy5sZW5ndGgtMTtpKyspe3RoaXMuYWRkVHJpYW5nbGUodGhpcy5iYXNlUHQscHRzW2ldLHB0c1tpKzFdLGlzUG9zaXRpdmVBcmVhKTt9XG50aGlzLmFkZExpbmVhclNlZ21lbnRzKHB0cyk7fTtqc3RzLmFsZ29yaXRobS5DZW50cm9pZEFyZWEucHJvdG90eXBlLmFkZEhvbGU9ZnVuY3Rpb24ocHRzKXt2YXIgaXNQb3NpdGl2ZUFyZWE9anN0cy5hbGdvcml0aG0uQ0dBbGdvcml0aG1zLmlzQ0NXKHB0cyk7Zm9yKHZhciBpPTA7aTxwdHMubGVuZ3RoLTE7aSsrKXt0aGlzLmFkZFRyaWFuZ2xlKHRoaXMuYmFzZVB0LHB0c1tpXSxwdHNbaSsxXSxpc1Bvc2l0aXZlQXJlYSk7fVxudGhpcy5hZGRMaW5lYXJTZWdtZW50cyhwdHMpO307anN0cy5hbGdvcml0aG0uQ2VudHJvaWRBcmVhLnByb3RvdHlwZS5hZGRUcmlhbmdsZT1mdW5jdGlvbihwMCxwMSxwMixpc1Bvc2l0aXZlQXJlYSl7dmFyIHNpZ249KGlzUG9zaXRpdmVBcmVhKT8xLjA6LTEuMDtqc3RzLmFsZ29yaXRobS5DZW50cm9pZEFyZWEuY2VudHJvaWQzKHAwLHAxLHAyLHRoaXMudHJpYW5nbGVDZW50Myk7dmFyIGFyZWEyPWpzdHMuYWxnb3JpdGhtLkNlbnRyb2lkQXJlYS5hcmVhMihwMCxwMSxwMik7dGhpcy5jZzMueCs9c2lnbiphcmVhMip0aGlzLnRyaWFuZ2xlQ2VudDMueDt0aGlzLmNnMy55Kz1zaWduKmFyZWEyKnRoaXMudHJpYW5nbGVDZW50My55O3RoaXMuYXJlYXN1bTIrPXNpZ24qYXJlYTI7fTtqc3RzLmFsZ29yaXRobS5DZW50cm9pZEFyZWEuY2VudHJvaWQzPWZ1bmN0aW9uKHAxLHAyLHAzLGMpe2MueD1wMS54K3AyLngrcDMueDtjLnk9cDEueStwMi55K3AzLnk7cmV0dXJuO307anN0cy5hbGdvcml0aG0uQ2VudHJvaWRBcmVhLmFyZWEyPWZ1bmN0aW9uKHAxLHAyLHAzKXtyZXR1cm4ocDIueC1wMS54KSoocDMueS1wMS55KS0ocDMueC1wMS54KSoocDIueS1wMS55KTt9O2pzdHMuYWxnb3JpdGhtLkNlbnRyb2lkQXJlYS5wcm90b3R5cGUuYWRkTGluZWFyU2VnbWVudHM9ZnVuY3Rpb24ocHRzKXtmb3IodmFyIGk9MDtpPHB0cy5sZW5ndGgtMTtpKyspe3ZhciBzZWdtZW50TGVuPXB0c1tpXS5kaXN0YW5jZShwdHNbaSsxXSk7dGhpcy50b3RhbExlbmd0aCs9c2VnbWVudExlbjt2YXIgbWlkeD0ocHRzW2ldLngrcHRzW2krMV0ueCkvMjt0aGlzLmNlbnRTdW0ueCs9c2VnbWVudExlbiptaWR4O3ZhciBtaWR5PShwdHNbaV0ueStwdHNbaSsxXS55KS8yO3RoaXMuY2VudFN1bS55Kz1zZWdtZW50TGVuKm1pZHk7fX07anN0cy5nZW9tZ3JhcGguaW5kZXguU3dlZXBMaW5lU2VnbWVudD1mdW5jdGlvbihlZGdlLHB0SW5kZXgpe3RoaXMuZWRnZT1lZGdlO3RoaXMucHRJbmRleD1wdEluZGV4O3RoaXMucHRzPWVkZ2UuZ2V0Q29vcmRpbmF0ZXMoKTt9O2pzdHMuZ2VvbWdyYXBoLmluZGV4LlN3ZWVwTGluZVNlZ21lbnQucHJvdG90eXBlLmVkZ2U9bnVsbDtqc3RzLmdlb21ncmFwaC5pbmRleC5Td2VlcExpbmVTZWdtZW50LnByb3RvdHlwZS5wdHM9bnVsbDtqc3RzLmdlb21ncmFwaC5pbmRleC5Td2VlcExpbmVTZWdtZW50LnByb3RvdHlwZS5wdEluZGV4PW51bGw7anN0cy5nZW9tZ3JhcGguaW5kZXguU3dlZXBMaW5lU2VnbWVudC5wcm90b3R5cGUuZ2V0TWluWD1mdW5jdGlvbigpe3ZhciB4MT10aGlzLnB0c1t0aGlzLnB0SW5kZXhdLng7dmFyIHgyPXRoaXMucHRzW3RoaXMucHRJbmRleCsxXS54O2lmKHgxPHgyKXtyZXR1cm4geDE7fVxucmV0dXJuIHgyO307anN0cy5nZW9tZ3JhcGguaW5kZXguU3dlZXBMaW5lU2VnbWVudC5wcm90b3R5cGUuZ2V0TWF4WD1mdW5jdGlvbigpe3ZhciB4MT10aGlzLnB0c1t0aGlzLnB0SW5kZXhdLng7dmFyIHgyPXRoaXMucHRzW3RoaXMucHRJbmRleCsxXS54O2lmKHgxPngyKXtyZXR1cm4geDE7fVxucmV0dXJuIHgyO307anN0cy5nZW9tZ3JhcGguaW5kZXguU3dlZXBMaW5lU2VnbWVudC5wcm90b3R5cGUuY29tcHV0ZUludGVyc2VjdGlvbnM9ZnVuY3Rpb24oc3Msc2kpe3NpLmFkZEludGVyc2VjdGlvbnModGhpcy5lZGdlLHRoaXMucHRJbmRleCxzcy5lZGdlLHNzLnB0SW5kZXgpO307anN0cy5pbmRleC5xdWFkdHJlZS5Sb290PWZ1bmN0aW9uKCl7anN0cy5pbmRleC5xdWFkdHJlZS5Ob2RlQmFzZS5wcm90b3R5cGUuY29uc3RydWN0b3IuYXBwbHkodGhpcyxhcmd1bWVudHMpO3RoaXMub3JpZ2luPW5ldyBqc3RzLmdlb20uQ29vcmRpbmF0ZSgwLjAsMC4wKTt9O2pzdHMuaW5kZXgucXVhZHRyZWUuUm9vdC5wcm90b3R5cGU9bmV3IGpzdHMuaW5kZXgucXVhZHRyZWUuTm9kZUJhc2UoKTtqc3RzLmluZGV4LnF1YWR0cmVlLlJvb3QucHJvdG90eXBlLmluc2VydD1mdW5jdGlvbihpdGVtRW52LGl0ZW0pe3ZhciBpbmRleD10aGlzLmdldFN1Ym5vZGVJbmRleChpdGVtRW52LHRoaXMub3JpZ2luKTtpZihpbmRleD09PS0xKXt0aGlzLmFkZChpdGVtKTtyZXR1cm47fVxudmFyIG5vZGU9dGhpcy5zdWJub2RlW2luZGV4XTtpZihub2RlPT09bnVsbHx8IW5vZGUuZ2V0RW52ZWxvcGUoKS5jb250YWlucyhpdGVtRW52KSl7dmFyIGxhcmdlck5vZGU9anN0cy5pbmRleC5xdWFkdHJlZS5Ob2RlLmNyZWF0ZUV4cGFuZGVkKG5vZGUsaXRlbUVudik7dGhpcy5zdWJub2RlW2luZGV4XT1sYXJnZXJOb2RlO31cbnRoaXMuaW5zZXJ0Q29udGFpbmVkKHRoaXMuc3Vibm9kZVtpbmRleF0saXRlbUVudixpdGVtKTt9O2pzdHMuaW5kZXgucXVhZHRyZWUuUm9vdC5wcm90b3R5cGUuaW5zZXJ0Q29udGFpbmVkPWZ1bmN0aW9uKHRyZWUsaXRlbUVudixpdGVtKXt2YXIgaXNaZXJvWCxpc1plcm9ZLG5vZGU7aXNaZXJvWD1qc3RzLmluZGV4LkludGVydmFsU2l6ZS5pc1plcm9XaWR0aChpdGVtRW52LmdldE1pblgoKSxpdGVtRW52LmdldE1heFgoKSk7aXNaZXJvWT1qc3RzLmluZGV4LkludGVydmFsU2l6ZS5pc1plcm9XaWR0aChpdGVtRW52LmdldE1pblkoKSxpdGVtRW52LmdldE1heFkoKSk7aWYoaXNaZXJvWHx8aXNaZXJvWSl7bm9kZT10cmVlLmZpbmQoaXRlbUVudik7fWVsc2V7bm9kZT10cmVlLmdldE5vZGUoaXRlbUVudik7fVxubm9kZS5hZGQoaXRlbSk7fTtqc3RzLmluZGV4LnF1YWR0cmVlLlJvb3QucHJvdG90eXBlLmlzU2VhcmNoTWF0Y2g9ZnVuY3Rpb24oc2VhcmNoRW52KXtyZXR1cm4gdHJ1ZTt9O2pzdHMuZ2VvbWdyYXBoLmluZGV4Lk1vbm90b25lQ2hhaW5JbmRleGVyPWZ1bmN0aW9uKCl7fTtqc3RzLmdlb21ncmFwaC5pbmRleC5Nb25vdG9uZUNoYWluSW5kZXhlci50b0ludEFycmF5PWZ1bmN0aW9uKGxpc3Qpe3ZhciBhcnJheT1bXTtmb3IodmFyIGk9bGlzdC5pdGVyYXRvcigpO2kuaGFzTmV4dCgpOyl7dmFyIGVsZW1lbnQ9aS5uZXh0KCk7YXJyYXkucHVzaChlbGVtZW50KTt9XG5yZXR1cm4gYXJyYXk7fTtqc3RzLmdlb21ncmFwaC5pbmRleC5Nb25vdG9uZUNoYWluSW5kZXhlci5wcm90b3R5cGUuZ2V0Q2hhaW5TdGFydEluZGljZXM9ZnVuY3Rpb24ocHRzKXt2YXIgc3RhcnQ9MDt2YXIgc3RhcnRJbmRleExpc3Q9bmV3IGphdmFzY3JpcHQudXRpbC5BcnJheUxpc3QoKTtzdGFydEluZGV4TGlzdC5hZGQoc3RhcnQpO2Rve3ZhciBsYXN0PXRoaXMuZmluZENoYWluRW5kKHB0cyxzdGFydCk7c3RhcnRJbmRleExpc3QuYWRkKGxhc3QpO3N0YXJ0PWxhc3Q7fXdoaWxlKHN0YXJ0PHB0cy5sZW5ndGgtMSk7dmFyIHN0YXJ0SW5kZXg9anN0cy5nZW9tZ3JhcGguaW5kZXguTW9ub3RvbmVDaGFpbkluZGV4ZXIudG9JbnRBcnJheShzdGFydEluZGV4TGlzdCk7cmV0dXJuIHN0YXJ0SW5kZXg7fTtqc3RzLmdlb21ncmFwaC5pbmRleC5Nb25vdG9uZUNoYWluSW5kZXhlci5wcm90b3R5cGUuZmluZENoYWluRW5kPWZ1bmN0aW9uKHB0cyxzdGFydCl7dmFyIGNoYWluUXVhZD1qc3RzLmdlb21ncmFwaC5RdWFkcmFudC5xdWFkcmFudChwdHNbc3RhcnRdLHB0c1tzdGFydCsxXSk7dmFyIGxhc3Q9c3RhcnQrMTt3aGlsZShsYXN0PHB0cy5sZW5ndGgpe3ZhciBxdWFkPWpzdHMuZ2VvbWdyYXBoLlF1YWRyYW50LnF1YWRyYW50KHB0c1tsYXN0LTFdLHB0c1tsYXN0XSk7aWYocXVhZCE9Y2hhaW5RdWFkKXticmVhazt9XG5sYXN0Kys7fVxucmV0dXJuIGxhc3QtMTt9O2pzdHMubm9kaW5nLkludGVyc2VjdGlvbkFkZGVyPWZ1bmN0aW9uKGxpKXt0aGlzLmxpPWxpO307anN0cy5ub2RpbmcuSW50ZXJzZWN0aW9uQWRkZXIucHJvdG90eXBlPW5ldyBqc3RzLm5vZGluZy5TZWdtZW50SW50ZXJzZWN0b3IoKTtqc3RzLm5vZGluZy5JbnRlcnNlY3Rpb25BZGRlci5jb25zdHJ1Y3Rvcj1qc3RzLm5vZGluZy5JbnRlcnNlY3Rpb25BZGRlcjtqc3RzLm5vZGluZy5JbnRlcnNlY3Rpb25BZGRlci5pc0FkamFjZW50U2VnbWVudHM9ZnVuY3Rpb24oaTEsaTIpe3JldHVybiBNYXRoLmFicyhpMS1pMik9PT0xO307anN0cy5ub2RpbmcuSW50ZXJzZWN0aW9uQWRkZXIucHJvdG90eXBlLl9oYXNJbnRlcnNlY3Rpb249ZmFsc2U7anN0cy5ub2RpbmcuSW50ZXJzZWN0aW9uQWRkZXIucHJvdG90eXBlLmhhc1Byb3Blcj1mYWxzZTtqc3RzLm5vZGluZy5JbnRlcnNlY3Rpb25BZGRlci5wcm90b3R5cGUuaGFzUHJvcGVySW50ZXJpb3I9ZmFsc2U7anN0cy5ub2RpbmcuSW50ZXJzZWN0aW9uQWRkZXIucHJvdG90eXBlLmhhc0ludGVyaW9yPWZhbHNlO2pzdHMubm9kaW5nLkludGVyc2VjdGlvbkFkZGVyLnByb3RvdHlwZS5wcm9wZXJJbnRlcnNlY3Rpb25Qb2ludD1udWxsO2pzdHMubm9kaW5nLkludGVyc2VjdGlvbkFkZGVyLnByb3RvdHlwZS5saT1udWxsO2pzdHMubm9kaW5nLkludGVyc2VjdGlvbkFkZGVyLnByb3RvdHlwZS5pc1NlbGZJbnRlcnNlY3Rpb249bnVsbDtqc3RzLm5vZGluZy5JbnRlcnNlY3Rpb25BZGRlci5wcm90b3R5cGUubnVtSW50ZXJzZWN0aW9ucz0wO2pzdHMubm9kaW5nLkludGVyc2VjdGlvbkFkZGVyLnByb3RvdHlwZS5udW1JbnRlcmlvckludGVyc2VjdGlvbnM9MDtqc3RzLm5vZGluZy5JbnRlcnNlY3Rpb25BZGRlci5wcm90b3R5cGUubnVtUHJvcGVySW50ZXJzZWN0aW9ucz0wO2pzdHMubm9kaW5nLkludGVyc2VjdGlvbkFkZGVyLnByb3RvdHlwZS5udW1UZXN0cz0wO2pzdHMubm9kaW5nLkludGVyc2VjdGlvbkFkZGVyLnByb3RvdHlwZS5nZXRMaW5lSW50ZXJzZWN0b3I9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5saTt9O2pzdHMubm9kaW5nLkludGVyc2VjdGlvbkFkZGVyLnByb3RvdHlwZS5nZXRQcm9wZXJJbnRlcnNlY3Rpb25Qb2ludD1mdW5jdGlvbigpe3JldHVybiB0aGlzLnByb3BlckludGVyc2VjdGlvblBvaW50O307anN0cy5ub2RpbmcuSW50ZXJzZWN0aW9uQWRkZXIucHJvdG90eXBlLmhhc0ludGVyc2VjdGlvbj1mdW5jdGlvbigpe3JldHVybiB0aGlzLl9oYXNJbnRlcnNlY3Rpb247fTtqc3RzLm5vZGluZy5JbnRlcnNlY3Rpb25BZGRlci5wcm90b3R5cGUuaGFzUHJvcGVySW50ZXJzZWN0aW9uPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuaGFzUHJvcGVyO307anN0cy5ub2RpbmcuSW50ZXJzZWN0aW9uQWRkZXIucHJvdG90eXBlLmhhc1Byb3BlckludGVyaW9ySW50ZXJzZWN0aW9uPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuaGFzUHJvcGVySW50ZXJpb3I7fTtqc3RzLm5vZGluZy5JbnRlcnNlY3Rpb25BZGRlci5wcm90b3R5cGUuaGFzSW50ZXJpb3JJbnRlcnNlY3Rpb249ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5oYXNJbnRlcmlvcjt9O2pzdHMubm9kaW5nLkludGVyc2VjdGlvbkFkZGVyLnByb3RvdHlwZS5pc1RyaXZpYWxJbnRlcnNlY3Rpb249ZnVuY3Rpb24oZTAsc2VnSW5kZXgwLGUxLHNlZ0luZGV4MSl7aWYoZTA9PWUxKXtpZih0aGlzLmxpLmdldEludGVyc2VjdGlvbk51bSgpPT0xKXtpZihqc3RzLm5vZGluZy5JbnRlcnNlY3Rpb25BZGRlci5pc0FkamFjZW50U2VnbWVudHMoc2VnSW5kZXgwLHNlZ0luZGV4MSkpXG5yZXR1cm4gdHJ1ZTtpZihlMC5pc0Nsb3NlZCgpKXt2YXIgbWF4U2VnSW5kZXg9ZTAuc2l6ZSgpLTE7aWYoKHNlZ0luZGV4MD09PTAmJnNlZ0luZGV4MT09PW1heFNlZ0luZGV4KXx8KHNlZ0luZGV4MT09PTAmJnNlZ0luZGV4MD09PW1heFNlZ0luZGV4KSl7cmV0dXJuIHRydWU7fX19fVxucmV0dXJuIGZhbHNlO307anN0cy5ub2RpbmcuSW50ZXJzZWN0aW9uQWRkZXIucHJvdG90eXBlLnByb2Nlc3NJbnRlcnNlY3Rpb25zPWZ1bmN0aW9uKGUwLHNlZ0luZGV4MCxlMSxzZWdJbmRleDEpe2lmKGUwPT09ZTEmJnNlZ0luZGV4MD09PXNlZ0luZGV4MSlcbnJldHVybjt0aGlzLm51bVRlc3RzKys7dmFyIHAwMD1lMC5nZXRDb29yZGluYXRlcygpW3NlZ0luZGV4MF07dmFyIHAwMT1lMC5nZXRDb29yZGluYXRlcygpW3NlZ0luZGV4MCsxXTt2YXIgcDEwPWUxLmdldENvb3JkaW5hdGVzKClbc2VnSW5kZXgxXTt2YXIgcDExPWUxLmdldENvb3JkaW5hdGVzKClbc2VnSW5kZXgxKzFdO3RoaXMubGkuY29tcHV0ZUludGVyc2VjdGlvbihwMDAscDAxLHAxMCxwMTEpO2lmKHRoaXMubGkuaGFzSW50ZXJzZWN0aW9uKCkpe3RoaXMubnVtSW50ZXJzZWN0aW9ucysrO2lmKHRoaXMubGkuaXNJbnRlcmlvckludGVyc2VjdGlvbigpKXt0aGlzLm51bUludGVyaW9ySW50ZXJzZWN0aW9ucysrO3RoaXMuaGFzSW50ZXJpb3I9dHJ1ZTt9XG5pZighdGhpcy5pc1RyaXZpYWxJbnRlcnNlY3Rpb24oZTAsc2VnSW5kZXgwLGUxLHNlZ0luZGV4MSkpe3RoaXMuX2hhc0ludGVyc2VjdGlvbj10cnVlO2UwLmFkZEludGVyc2VjdGlvbnModGhpcy5saSxzZWdJbmRleDAsMCk7ZTEuYWRkSW50ZXJzZWN0aW9ucyh0aGlzLmxpLHNlZ0luZGV4MSwxKTtpZih0aGlzLmxpLmlzUHJvcGVyKCkpe3RoaXMubnVtUHJvcGVySW50ZXJzZWN0aW9ucysrO3RoaXMuaGFzUHJvcGVyPXRydWU7dGhpcy5oYXNQcm9wZXJJbnRlcmlvcj10cnVlO319fX07anN0cy5ub2RpbmcuSW50ZXJzZWN0aW9uQWRkZXIucHJvdG90eXBlLmlzRG9uZT1mdW5jdGlvbigpe3JldHVybiBmYWxzZTt9O2pzdHMub3BlcmF0aW9uLnVuaW9uLkNhc2NhZGVkUG9seWdvblVuaW9uPWZ1bmN0aW9uKHBvbHlzKXt0aGlzLmlucHV0UG9seXM9cG9seXM7fTtqc3RzLm9wZXJhdGlvbi51bmlvbi5DYXNjYWRlZFBvbHlnb25Vbmlvbi51bmlvbj1mdW5jdGlvbihwb2x5cyl7dmFyIG9wPW5ldyBqc3RzLm9wZXJhdGlvbi51bmlvbi5DYXNjYWRlZFBvbHlnb25Vbmlvbihwb2x5cyk7cmV0dXJuIG9wLnVuaW9uKCk7fTtqc3RzLm9wZXJhdGlvbi51bmlvbi5DYXNjYWRlZFBvbHlnb25Vbmlvbi5wcm90b3R5cGUuaW5wdXRQb2x5cztqc3RzLm9wZXJhdGlvbi51bmlvbi5DYXNjYWRlZFBvbHlnb25Vbmlvbi5wcm90b3R5cGUuZ2VvbUZhY3Rvcnk9bnVsbDtqc3RzLm9wZXJhdGlvbi51bmlvbi5DYXNjYWRlZFBvbHlnb25Vbmlvbi5wcm90b3R5cGUuU1RSVFJFRV9OT0RFX0NBUEFDSVRZPTQ7anN0cy5vcGVyYXRpb24udW5pb24uQ2FzY2FkZWRQb2x5Z29uVW5pb24ucHJvdG90eXBlLnVuaW9uPWZ1bmN0aW9uKCl7aWYodGhpcy5pbnB1dFBvbHlzLmxlbmd0aD09PTApe3JldHVybiBudWxsO31cbnRoaXMuZ2VvbUZhY3Rvcnk9dGhpcy5pbnB1dFBvbHlzWzBdLmdldEZhY3RvcnkoKTt2YXIgaW5kZXg9bmV3IGpzdHMuaW5kZXguc3RydHJlZS5TVFJ0cmVlKHRoaXMuU1RSVFJFRV9OT0RFX0NBUEFDSVRZKTtmb3IodmFyIGk9MCxsPXRoaXMuaW5wdXRQb2x5cy5sZW5ndGg7aTxsO2krKyl7dmFyIGl0ZW09dGhpcy5pbnB1dFBvbHlzW2ldO2luZGV4Lmluc2VydChpdGVtLmdldEVudmVsb3BlSW50ZXJuYWwoKSxpdGVtKTt9XG52YXIgaXRlbVRyZWU9aW5kZXguaXRlbXNUcmVlKCk7dmFyIHVuaW9uQWxsPXRoaXMudW5pb25UcmVlKGl0ZW1UcmVlKTtyZXR1cm4gdW5pb25BbGw7fTtqc3RzLm9wZXJhdGlvbi51bmlvbi5DYXNjYWRlZFBvbHlnb25Vbmlvbi5wcm90b3R5cGUudW5pb25UcmVlPWZ1bmN0aW9uKGdlb21UcmVlKXt2YXIgZ2VvbXM9dGhpcy5yZWR1Y2VUb0dlb21ldHJpZXMoZ2VvbVRyZWUpO3ZhciB1bmlvbj10aGlzLmJpbmFyeVVuaW9uKGdlb21zKTtyZXR1cm4gdW5pb247fTtqc3RzLm9wZXJhdGlvbi51bmlvbi5DYXNjYWRlZFBvbHlnb25Vbmlvbi5wcm90b3R5cGUuYmluYXJ5VW5pb249ZnVuY3Rpb24oZ2VvbXMsc3RhcnQsZW5kKXtzdGFydD1zdGFydHx8MDtlbmQ9ZW5kfHxnZW9tcy5sZW5ndGg7aWYoZW5kLXN0YXJ0PD0xKXt2YXIgZzA9dGhpcy5nZXRHZW9tZXRyeShnZW9tcyxzdGFydCk7cmV0dXJuIHRoaXMudW5pb25TYWZlKGcwLG51bGwpO31cbmVsc2UgaWYoZW5kLXN0YXJ0PT09Mil7cmV0dXJuIHRoaXMudW5pb25TYWZlKHRoaXMuZ2V0R2VvbWV0cnkoZ2VvbXMsc3RhcnQpLHRoaXMuZ2V0R2VvbWV0cnkoZ2VvbXMsc3RhcnQrMSkpO31cbmVsc2V7dmFyIG1pZD1wYXJzZUludCgoZW5kK3N0YXJ0KS8yKTt2YXIgZzA9dGhpcy5iaW5hcnlVbmlvbihnZW9tcyxzdGFydCxtaWQpO3ZhciBnMT10aGlzLmJpbmFyeVVuaW9uKGdlb21zLG1pZCxlbmQpO3JldHVybiB0aGlzLnVuaW9uU2FmZShnMCxnMSk7fX07anN0cy5vcGVyYXRpb24udW5pb24uQ2FzY2FkZWRQb2x5Z29uVW5pb24ucHJvdG90eXBlLmdldEdlb21ldHJ5PWZ1bmN0aW9uKGxpc3QsaW5kZXgpe2lmKGluZGV4Pj1saXN0Lmxlbmd0aCl7cmV0dXJuIG51bGw7fVxucmV0dXJuIGxpc3RbaW5kZXhdO307anN0cy5vcGVyYXRpb24udW5pb24uQ2FzY2FkZWRQb2x5Z29uVW5pb24ucHJvdG90eXBlLnJlZHVjZVRvR2VvbWV0cmllcz1mdW5jdGlvbihnZW9tVHJlZSl7dmFyIGdlb21zPVtdO2Zvcih2YXIgaT0wLGw9Z2VvbVRyZWUubGVuZ3RoO2k8bDtpKyspe3ZhciBvPWdlb21UcmVlW2ldLGdlb209bnVsbDtpZihvIGluc3RhbmNlb2YgQXJyYXkpe2dlb209dGhpcy51bmlvblRyZWUobyk7fVxuZWxzZSBpZihvIGluc3RhbmNlb2YganN0cy5nZW9tLkdlb21ldHJ5KXtnZW9tPW87fVxuZ2VvbXMucHVzaChnZW9tKTt9XG5yZXR1cm4gZ2VvbXM7fTtqc3RzLm9wZXJhdGlvbi51bmlvbi5DYXNjYWRlZFBvbHlnb25Vbmlvbi5wcm90b3R5cGUudW5pb25TYWZlPWZ1bmN0aW9uKGcwLGcxKXtpZihnMD09PW51bGwmJmcxPT09bnVsbCl7cmV0dXJuIG51bGw7fVxuaWYoZzA9PT1udWxsKXtyZXR1cm4gZzEuY2xvbmUoKTt9XG5pZihnMT09PW51bGwpe3JldHVybiBnMC5jbG9uZSgpO31cbnJldHVybiB0aGlzLnVuaW9uT3B0aW1pemVkKGcwLGcxKTt9O2pzdHMub3BlcmF0aW9uLnVuaW9uLkNhc2NhZGVkUG9seWdvblVuaW9uLnByb3RvdHlwZS51bmlvbk9wdGltaXplZD1mdW5jdGlvbihnMCxnMSl7dmFyIGcwRW52PWcwLmdldEVudmVsb3BlSW50ZXJuYWwoKSxnMUVudj1nMS5nZXRFbnZlbG9wZUludGVybmFsKCk7aWYoIWcwRW52LmludGVyc2VjdHMoZzFFbnYpKXt2YXIgY29tYm89anN0cy5nZW9tLnV0aWwuR2VvbWV0cnlDb21iaW5lci5jb21iaW5lKGcwLGcxKTtyZXR1cm4gY29tYm87fVxuaWYoZzAuZ2V0TnVtR2VvbWV0cmllczw9MSYmZzEuZ2V0TnVtR2VvbWV0cmllczw9MSl7cmV0dXJuIHRoaXMudW5pb25BY3R1YWwoZzAsZzEpO31cbnZhciBjb21tb25FbnY9ZzBFbnYuaW50ZXJzZWN0aW9uKGcxRW52KTtyZXR1cm4gdGhpcy51bmlvblVzaW5nRW52ZWxvcGVJbnRlcnNlY3Rpb24oZzAsZzEsY29tbW9uRW52KTt9O2pzdHMub3BlcmF0aW9uLnVuaW9uLkNhc2NhZGVkUG9seWdvblVuaW9uLnByb3RvdHlwZS51bmlvblVzaW5nRW52ZWxvcGVJbnRlcnNlY3Rpb249ZnVuY3Rpb24oZzAsZzEsY29tbW9uKXt2YXIgZGlzam9pbnRQb2x5cz1uZXcgamF2YXNjcmlwdC51dGlsLkFycmF5TGlzdCgpO3ZhciBnMEludD10aGlzLmV4dHJhY3RCeUVudmVsb3BlKGNvbW1vbixnMCxkaXNqb2ludFBvbHlzKTt2YXIgZzFJbnQ9dGhpcy5leHRyYWN0QnlFbnZlbG9wZShjb21tb24sZzEsZGlzam9pbnRQb2x5cyk7dmFyIHVuaW9uPXRoaXMudW5pb25BY3R1YWwoZzBJbnQsZzFJbnQpO2Rpc2pvaW50UG9seXMuYWRkKHVuaW9uKTt2YXIgb3ZlcmFsbFVuaW9uPWpzdHMuZ2VvbS51dGlsLkdlb21ldHJ5Q29tYmluZXIuY29tYmluZShkaXNqb2ludFBvbHlzKTtyZXR1cm4gb3ZlcmFsbFVuaW9uO307anN0cy5vcGVyYXRpb24udW5pb24uQ2FzY2FkZWRQb2x5Z29uVW5pb24ucHJvdG90eXBlLmV4dHJhY3RCeUVudmVsb3BlPWZ1bmN0aW9uKGVudixnZW9tLGRpc2pvaW50R2VvbXMpe3ZhciBpbnRlcnNlY3RpbmdHZW9tcz1uZXcgamF2YXNjcmlwdC51dGlsLkFycmF5TGlzdCgpO2Zvcih2YXIgaT0wO2k8Z2VvbS5nZXROdW1HZW9tZXRyaWVzKCk7aSsrKXt2YXIgZWxlbT1nZW9tLmdldEdlb21ldHJ5TihpKTtpZihlbGVtLmdldEVudmVsb3BlSW50ZXJuYWwoKS5pbnRlcnNlY3RzKGVudikpe2ludGVyc2VjdGluZ0dlb21zLmFkZChlbGVtKTt9XG5lbHNle2Rpc2pvaW50R2VvbXMuYWRkKGVsZW0pO319XG5yZXR1cm4gdGhpcy5nZW9tRmFjdG9yeS5idWlsZEdlb21ldHJ5KGludGVyc2VjdGluZ0dlb21zKTt9O2pzdHMub3BlcmF0aW9uLnVuaW9uLkNhc2NhZGVkUG9seWdvblVuaW9uLnByb3RvdHlwZS51bmlvbkFjdHVhbD1mdW5jdGlvbihnMCxnMSl7cmV0dXJuIGcwLnVuaW9uKGcxKTt9OyhmdW5jdGlvbigpe2pzdHMuZ2VvbS5NdWx0aVBvaW50PWZ1bmN0aW9uKHBvaW50cyxmYWN0b3J5KXt0aGlzLmdlb21ldHJpZXM9cG9pbnRzfHxbXTt0aGlzLmZhY3Rvcnk9ZmFjdG9yeTt9O2pzdHMuZ2VvbS5NdWx0aVBvaW50LnByb3RvdHlwZT1uZXcganN0cy5nZW9tLkdlb21ldHJ5Q29sbGVjdGlvbigpO2pzdHMuZ2VvbS5NdWx0aVBvaW50LmNvbnN0cnVjdG9yPWpzdHMuZ2VvbS5NdWx0aVBvaW50O2pzdHMuZ2VvbS5NdWx0aVBvaW50LnByb3RvdHlwZS5nZXRCb3VuZGFyeT1mdW5jdGlvbigpe3JldHVybiB0aGlzLmdldEZhY3RvcnkoKS5jcmVhdGVHZW9tZXRyeUNvbGxlY3Rpb24obnVsbCk7fTtqc3RzLmdlb20uTXVsdGlQb2ludC5wcm90b3R5cGUuZ2V0R2VvbWV0cnlOPWZ1bmN0aW9uKG4pe3JldHVybiB0aGlzLmdlb21ldHJpZXNbbl07fTtqc3RzLmdlb20uTXVsdGlQb2ludC5wcm90b3R5cGUuZXF1YWxzRXhhY3Q9ZnVuY3Rpb24ob3RoZXIsdG9sZXJhbmNlKXtpZighdGhpcy5pc0VxdWl2YWxlbnRDbGFzcyhvdGhlcikpe3JldHVybiBmYWxzZTt9XG5yZXR1cm4ganN0cy5nZW9tLkdlb21ldHJ5Q29sbGVjdGlvbi5wcm90b3R5cGUuZXF1YWxzRXhhY3QuY2FsbCh0aGlzLG90aGVyLHRvbGVyYW5jZSk7fTtqc3RzLmdlb20uTXVsdGlQb2ludC5wcm90b3R5cGUuQ0xBU1NfTkFNRT0nanN0cy5nZW9tLk11bHRpUG9pbnQnO30pKCk7anN0cy5vcGVyYXRpb24uYnVmZmVyLk9mZnNldEN1cnZlQnVpbGRlcj1mdW5jdGlvbihwcmVjaXNpb25Nb2RlbCxidWZQYXJhbXMpe3RoaXMucHJlY2lzaW9uTW9kZWw9cHJlY2lzaW9uTW9kZWw7dGhpcy5idWZQYXJhbXM9YnVmUGFyYW1zO307anN0cy5vcGVyYXRpb24uYnVmZmVyLk9mZnNldEN1cnZlQnVpbGRlci5wcm90b3R5cGUuZGlzdGFuY2U9MC4wO2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5PZmZzZXRDdXJ2ZUJ1aWxkZXIucHJvdG90eXBlLnByZWNpc2lvbk1vZGVsPW51bGw7anN0cy5vcGVyYXRpb24uYnVmZmVyLk9mZnNldEN1cnZlQnVpbGRlci5wcm90b3R5cGUuYnVmUGFyYW1zPW51bGw7anN0cy5vcGVyYXRpb24uYnVmZmVyLk9mZnNldEN1cnZlQnVpbGRlci5wcm90b3R5cGUuZ2V0QnVmZmVyUGFyYW1ldGVycz1mdW5jdGlvbigpe3JldHVybiB0aGlzLmJ1ZlBhcmFtczt9O2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5PZmZzZXRDdXJ2ZUJ1aWxkZXIucHJvdG90eXBlLmdldExpbmVDdXJ2ZT1mdW5jdGlvbihpbnB1dFB0cyxkaXN0YW5jZSl7dGhpcy5kaXN0YW5jZT1kaXN0YW5jZTtpZih0aGlzLmRpc3RhbmNlPDAuMCYmIXRoaXMuYnVmUGFyYW1zLmlzU2luZ2xlU2lkZWQoKSlcbnJldHVybiBudWxsO2lmKHRoaXMuZGlzdGFuY2U9PTAuMClcbnJldHVybiBudWxsO3ZhciBwb3NEaXN0YW5jZT1NYXRoLmFicyh0aGlzLmRpc3RhbmNlKTt2YXIgc2VnR2VuPXRoaXMuZ2V0U2VnR2VuKHBvc0Rpc3RhbmNlKTtpZihpbnB1dFB0cy5sZW5ndGg8PTEpe3RoaXMuY29tcHV0ZVBvaW50Q3VydmUoaW5wdXRQdHNbMF0sc2VnR2VuKTt9ZWxzZXtpZih0aGlzLmJ1ZlBhcmFtcy5pc1NpbmdsZVNpZGVkKCkpe3ZhciBpc1JpZ2h0U2lkZT1kaXN0YW5jZTwwLjA7dGhpcy5jb21wdXRlU2luZ2xlU2lkZWRCdWZmZXJDdXJ2ZShpbnB1dFB0cyxpc1JpZ2h0U2lkZSxzZWdHZW4pO31lbHNlXG50aGlzLmNvbXB1dGVMaW5lQnVmZmVyQ3VydmUoaW5wdXRQdHMsc2VnR2VuKTt9XG52YXIgbGluZUNvb3JkPXNlZ0dlbi5nZXRDb29yZGluYXRlcygpO3JldHVybiBsaW5lQ29vcmQ7fTtqc3RzLm9wZXJhdGlvbi5idWZmZXIuT2Zmc2V0Q3VydmVCdWlsZGVyLnByb3RvdHlwZS5nZXRSaW5nQ3VydmU9ZnVuY3Rpb24oaW5wdXRQdHMsc2lkZSxkaXN0YW5jZSl7dGhpcy5kaXN0YW5jZT1kaXN0YW5jZTtpZihpbnB1dFB0cy5sZW5ndGg8PTIpXG5yZXR1cm4gdGhpcy5nZXRMaW5lQ3VydmUoaW5wdXRQdHMsZGlzdGFuY2UpO2lmKHRoaXMuZGlzdGFuY2U9PTAuMCl7cmV0dXJuIGpzdHMub3BlcmF0aW9uLmJ1ZmZlci5PZmZzZXRDdXJ2ZUJ1aWxkZXIuY29weUNvb3JkaW5hdGVzKGlucHV0UHRzKTt9XG52YXIgc2VnR2VuPXRoaXMuZ2V0U2VnR2VuKHRoaXMuZGlzdGFuY2UpO3RoaXMuY29tcHV0ZVJpbmdCdWZmZXJDdXJ2ZShpbnB1dFB0cyxzaWRlLHNlZ0dlbik7cmV0dXJuIHNlZ0dlbi5nZXRDb29yZGluYXRlcygpO307anN0cy5vcGVyYXRpb24uYnVmZmVyLk9mZnNldEN1cnZlQnVpbGRlci5wcm90b3R5cGUuZ2V0T2Zmc2V0Q3VydmU9ZnVuY3Rpb24oaW5wdXRQdHMsZGlzdGFuY2Upe3RoaXMuZGlzdGFuY2U9ZGlzdGFuY2U7aWYodGhpcy5kaXN0YW5jZT09PTAuMClcbnJldHVybiBudWxsO3ZhciBpc1JpZ2h0U2lkZT10aGlzLmRpc3RhbmNlPDAuMDt2YXIgcG9zRGlzdGFuY2U9TWF0aC5hYnModGhpcy5kaXN0YW5jZSk7dmFyIHNlZ0dlbj10aGlzLmdldFNlZ0dlbihwb3NEaXN0YW5jZSk7aWYoaW5wdXRQdHMubGVuZ3RoPD0xKXt0aGlzLmNvbXB1dGVQb2ludEN1cnZlKGlucHV0UHRzWzBdLHNlZ0dlbik7fWVsc2V7dGhpcy5jb21wdXRlT2Zmc2V0Q3VydmUoaW5wdXRQdHMsaXNSaWdodFNpZGUsc2VnR2VuKTt9XG52YXIgY3VydmVQdHM9c2VnR2VuLmdldENvb3JkaW5hdGVzKCk7aWYoaXNSaWdodFNpZGUpXG5jdXJ2ZVB0cy5yZXZlcnNlKCk7cmV0dXJuIGN1cnZlUHRzO307anN0cy5vcGVyYXRpb24uYnVmZmVyLk9mZnNldEN1cnZlQnVpbGRlci5jb3B5Q29vcmRpbmF0ZXM9ZnVuY3Rpb24ocHRzKXt2YXIgY29weT1bXTtmb3IodmFyIGk9MDtpPHB0cy5sZW5ndGg7aSsrKXtjb3B5LnB1c2gocHRzW2ldLmNsb25lKCkpO31cbnJldHVybiBjb3B5O307anN0cy5vcGVyYXRpb24uYnVmZmVyLk9mZnNldEN1cnZlQnVpbGRlci5wcm90b3R5cGUuZ2V0U2VnR2VuPWZ1bmN0aW9uKGRpc3RhbmNlKXtyZXR1cm4gbmV3IGpzdHMub3BlcmF0aW9uLmJ1ZmZlci5PZmZzZXRTZWdtZW50R2VuZXJhdG9yKHRoaXMucHJlY2lzaW9uTW9kZWwsdGhpcy5idWZQYXJhbXMsZGlzdGFuY2UpO307anN0cy5vcGVyYXRpb24uYnVmZmVyLk9mZnNldEN1cnZlQnVpbGRlci5TSU1QTElGWV9GQUNUT1I9MTAwLjA7anN0cy5vcGVyYXRpb24uYnVmZmVyLk9mZnNldEN1cnZlQnVpbGRlci5zaW1wbGlmeVRvbGVyYW5jZT1mdW5jdGlvbihidWZEaXN0YW5jZSl7cmV0dXJuIGJ1ZkRpc3RhbmNlL2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5PZmZzZXRDdXJ2ZUJ1aWxkZXIuU0lNUExJRllfRkFDVE9SO307anN0cy5vcGVyYXRpb24uYnVmZmVyLk9mZnNldEN1cnZlQnVpbGRlci5wcm90b3R5cGUuY29tcHV0ZVBvaW50Q3VydmU9ZnVuY3Rpb24ocHQsc2VnR2VuKXtzd2l0Y2godGhpcy5idWZQYXJhbXMuZ2V0RW5kQ2FwU3R5bGUoKSl7Y2FzZSBqc3RzLm9wZXJhdGlvbi5idWZmZXIuQnVmZmVyUGFyYW1ldGVycy5DQVBfUk9VTkQ6c2VnR2VuLmNyZWF0ZUNpcmNsZShwdCk7YnJlYWs7Y2FzZSBqc3RzLm9wZXJhdGlvbi5idWZmZXIuQnVmZmVyUGFyYW1ldGVycy5DQVBfU1FVQVJFOnNlZ0dlbi5jcmVhdGVTcXVhcmUocHQpO2JyZWFrO319O2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5PZmZzZXRDdXJ2ZUJ1aWxkZXIucHJvdG90eXBlLmNvbXB1dGVMaW5lQnVmZmVyQ3VydmU9ZnVuY3Rpb24oaW5wdXRQdHMsc2VnR2VuKXt2YXIgZGlzdFRvbD1qc3RzLm9wZXJhdGlvbi5idWZmZXIuT2Zmc2V0Q3VydmVCdWlsZGVyLnNpbXBsaWZ5VG9sZXJhbmNlKHRoaXMuZGlzdGFuY2UpO3ZhciBzaW1wMT1qc3RzLm9wZXJhdGlvbi5idWZmZXIuQnVmZmVySW5wdXRMaW5lU2ltcGxpZmllci5zaW1wbGlmeShpbnB1dFB0cyxkaXN0VG9sKTt2YXIgbjE9c2ltcDEubGVuZ3RoLTE7c2VnR2VuLmluaXRTaWRlU2VnbWVudHMoc2ltcDFbMF0sc2ltcDFbMV0sanN0cy5nZW9tZ3JhcGguUG9zaXRpb24uTEVGVCk7Zm9yKHZhciBpPTI7aTw9bjE7aSsrKXtzZWdHZW4uYWRkTmV4dFNlZ21lbnQoc2ltcDFbaV0sdHJ1ZSk7fVxuc2VnR2VuLmFkZExhc3RTZWdtZW50KCk7c2VnR2VuLmFkZExpbmVFbmRDYXAoc2ltcDFbbjEtMV0sc2ltcDFbbjFdKTt2YXIgc2ltcDI9anN0cy5vcGVyYXRpb24uYnVmZmVyLkJ1ZmZlcklucHV0TGluZVNpbXBsaWZpZXIuc2ltcGxpZnkoaW5wdXRQdHMsLWRpc3RUb2wpO3ZhciBuMj1zaW1wMi5sZW5ndGgtMTtzZWdHZW4uaW5pdFNpZGVTZWdtZW50cyhzaW1wMltuMl0sc2ltcDJbbjItMV0sanN0cy5nZW9tZ3JhcGguUG9zaXRpb24uTEVGVCk7Zm9yKHZhciBpPW4yLTI7aT49MDtpLS0pe3NlZ0dlbi5hZGROZXh0U2VnbWVudChzaW1wMltpXSx0cnVlKTt9XG5zZWdHZW4uYWRkTGFzdFNlZ21lbnQoKTtzZWdHZW4uYWRkTGluZUVuZENhcChzaW1wMlsxXSxzaW1wMlswXSk7c2VnR2VuLmNsb3NlUmluZygpO307anN0cy5vcGVyYXRpb24uYnVmZmVyLk9mZnNldEN1cnZlQnVpbGRlci5wcm90b3R5cGUuY29tcHV0ZVNpbmdsZVNpZGVkQnVmZmVyQ3VydmU9ZnVuY3Rpb24oaW5wdXRQdHMsaXNSaWdodFNpZGUsc2VnR2VuKXt2YXIgZGlzdFRvbD1qc3RzLm9wZXJhdGlvbi5idWZmZXIuT2Zmc2V0Q3VydmVCdWlsZGVyLnNpbXBsaWZ5VG9sZXJhbmNlKHRoaXMuZGlzdGFuY2UpO2lmKGlzUmlnaHRTaWRlKXtzZWdHZW4uYWRkU2VnbWVudHMoaW5wdXRQdHMsdHJ1ZSk7dmFyIHNpbXAyPWpzdHMub3BlcmF0aW9uLmJ1ZmZlci5CdWZmZXJJbnB1dExpbmVTaW1wbGlmaWVyLnNpbXBsaWZ5KGlucHV0UHRzLC1kaXN0VG9sKTt2YXIgbjI9c2ltcDIubGVuZ3RoLTE7c2VnR2VuLmluaXRTaWRlU2VnbWVudHMoc2ltcDJbbjJdLHNpbXAyW24yLTFdLGpzdHMuZ2VvbWdyYXBoLlBvc2l0aW9uLkxFRlQpO3NlZ0dlbi5hZGRGaXJzdFNlZ21lbnQoKTtmb3IodmFyIGk9bjItMjtpPj0wO2ktLSl7c2VnR2VuLmFkZE5leHRTZWdtZW50KHNpbXAyW2ldLHRydWUpO319ZWxzZXtzZWdHZW4uYWRkU2VnbWVudHMoaW5wdXRQdHMsZmFsc2UpO3ZhciBzaW1wMT1qc3RzLm9wZXJhdGlvbi5idWZmZXIuQnVmZmVySW5wdXRMaW5lU2ltcGxpZmllci5zaW1wbGlmeShpbnB1dFB0cyxkaXN0VG9sKTt2YXIgbjE9c2ltcDEubGVuZ3RoLTE7c2VnR2VuLmluaXRTaWRlU2VnbWVudHMoc2ltcDFbMF0sc2ltcDFbMV0sanN0cy5nZW9tZ3JhcGguUG9zaXRpb24uTEVGVCk7c2VnR2VuLmFkZEZpcnN0U2VnbWVudCgpO2Zvcih2YXIgaT0yO2k8PW4xO2krKyl7c2VnR2VuLmFkZE5leHRTZWdtZW50KHNpbXAxW2ldLHRydWUpO319XG5zZWdHZW4uYWRkTGFzdFNlZ21lbnQoKTtzZWdHZW4uY2xvc2VSaW5nKCk7fTtqc3RzLm9wZXJhdGlvbi5idWZmZXIuT2Zmc2V0Q3VydmVCdWlsZGVyLnByb3RvdHlwZS5jb21wdXRlT2Zmc2V0Q3VydmU9ZnVuY3Rpb24oaW5wdXRQdHMsaXNSaWdodFNpZGUsc2VnR2VuKXt2YXIgZGlzdFRvbD1qc3RzLm9wZXJhdGlvbi5idWZmZXIuT2Zmc2V0Q3VydmVCdWlsZGVyLnNpbXBsaWZ5VG9sZXJhbmNlKHRoaXMuZGlzdGFuY2UpO2lmKGlzUmlnaHRTaWRlKXt2YXIgc2ltcDI9anN0cy5vcGVyYXRpb24uYnVmZmVyLkJ1ZmZlcklucHV0TGluZVNpbXBsaWZpZXIuc2ltcGxpZnkoaW5wdXRQdHMsLWRpc3RUb2wpO3ZhciBuMj1zaW1wMi5sZW5ndGgtMTtzZWdHZW4uaW5pdFNpZGVTZWdtZW50cyhzaW1wMltuMl0sc2ltcDJbbjItMV0sanN0cy5nZW9tZ3JhcGguUG9zaXRpb24uTEVGVCk7c2VnR2VuLmFkZEZpcnN0U2VnbWVudCgpO2Zvcih2YXIgaT1uMi0yO2k+PTA7aS0tKXtzZWdHZW4uYWRkTmV4dFNlZ21lbnQoc2ltcDJbaV0sdHJ1ZSk7fX1lbHNle3ZhciBzaW1wMT1qc3RzLm9wZXJhdGlvbi5idWZmZXIuQnVmZmVySW5wdXRMaW5lU2ltcGxpZmllci5zaW1wbGlmeShpbnB1dFB0cyxkaXN0VG9sKTt2YXIgbjE9c2ltcDEubGVuZ3RoLTE7c2VnR2VuLmluaXRTaWRlU2VnbWVudHMoc2ltcDFbMF0sc2ltcDFbMV0sanN0cy5nZW9tZ3JhcGguUG9zaXRpb24uTEVGVCk7c2VnR2VuLmFkZEZpcnN0U2VnbWVudCgpO2Zvcih2YXIgaT0yO2k8PW4xO2krKyl7c2VnR2VuLmFkZE5leHRTZWdtZW50KHNpbXAxW2ldLHRydWUpO319XG5zZWdHZW4uYWRkTGFzdFNlZ21lbnQoKTt9O2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5PZmZzZXRDdXJ2ZUJ1aWxkZXIucHJvdG90eXBlLmNvbXB1dGVSaW5nQnVmZmVyQ3VydmU9ZnVuY3Rpb24oaW5wdXRQdHMsc2lkZSxzZWdHZW4pe3ZhciBkaXN0VG9sPWpzdHMub3BlcmF0aW9uLmJ1ZmZlci5PZmZzZXRDdXJ2ZUJ1aWxkZXIuc2ltcGxpZnlUb2xlcmFuY2UodGhpcy5kaXN0YW5jZSk7aWYoc2lkZT09PWpzdHMuZ2VvbWdyYXBoLlBvc2l0aW9uLlJJR0hUKVxuZGlzdFRvbD0tZGlzdFRvbDt2YXIgc2ltcD1qc3RzLm9wZXJhdGlvbi5idWZmZXIuQnVmZmVySW5wdXRMaW5lU2ltcGxpZmllci5zaW1wbGlmeShpbnB1dFB0cyxkaXN0VG9sKTt2YXIgbj1zaW1wLmxlbmd0aC0xO3NlZ0dlbi5pbml0U2lkZVNlZ21lbnRzKHNpbXBbbi0xXSxzaW1wWzBdLHNpZGUpO2Zvcih2YXIgaT0xO2k8PW47aSsrKXt2YXIgYWRkU3RhcnRQb2ludD1pIT09MTtzZWdHZW4uYWRkTmV4dFNlZ21lbnQoc2ltcFtpXSxhZGRTdGFydFBvaW50KTt9XG5zZWdHZW4uY2xvc2VSaW5nKCk7fTsoZnVuY3Rpb24oKXt2YXIgSG90UGl4ZWxTbmFwQWN0aW9uPWZ1bmN0aW9uKGhvdFBpeGVsLHBhcmVudEVkZ2UsdmVydGV4SW5kZXgpe3RoaXMuaG90UGl4ZWw9aG90UGl4ZWw7dGhpcy5wYXJlbnRFZGdlPXBhcmVudEVkZ2U7dGhpcy52ZXJ0ZXhJbmRleD12ZXJ0ZXhJbmRleDt9O0hvdFBpeGVsU25hcEFjdGlvbi5wcm90b3R5cGU9bmV3IGpzdHMuaW5kZXguY2hhaW4uTW9ub3RvbmVDaGFpblNlbGVjdEFjdGlvbigpO0hvdFBpeGVsU25hcEFjdGlvbi5jb25zdHJ1Y3Rvcj1Ib3RQaXhlbFNuYXBBY3Rpb247SG90UGl4ZWxTbmFwQWN0aW9uLnByb3RvdHlwZS5ob3RQaXhlbD1udWxsO0hvdFBpeGVsU25hcEFjdGlvbi5wcm90b3R5cGUucGFyZW50RWRnZT1udWxsO0hvdFBpeGVsU25hcEFjdGlvbi5wcm90b3R5cGUudmVydGV4SW5kZXg9bnVsbDtIb3RQaXhlbFNuYXBBY3Rpb24ucHJvdG90eXBlLl9pc05vZGVBZGRlZD1mYWxzZTtIb3RQaXhlbFNuYXBBY3Rpb24ucHJvdG90eXBlLmlzTm9kZUFkZGVkPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2lzTm9kZUFkZGVkO307SG90UGl4ZWxTbmFwQWN0aW9uLnByb3RvdHlwZS5zZWxlY3Q9ZnVuY3Rpb24obWMsc3RhcnRJbmRleCl7dmFyIHNzPW1jLmdldENvbnRleHQoKTtpZih0aGlzLnBhcmVudEVkZ2UhPT1udWxsKXtpZihzcz09PXRoaXMucGFyZW50RWRnZSYmc3RhcnRJbmRleD09PXRoaXMudmVydGV4SW5kZXgpXG5yZXR1cm47fVxudGhpcy5faXNOb2RlQWRkZWQ9dGhpcy5ob3RQaXhlbC5hZGRTbmFwcGVkTm9kZShzcyxzdGFydEluZGV4KTt9O2pzdHMubm9kaW5nLnNuYXByb3VuZC5NQ0luZGV4UG9pbnRTbmFwcGVyPWZ1bmN0aW9uKGluZGV4KXt0aGlzLmluZGV4PWluZGV4O307anN0cy5ub2Rpbmcuc25hcHJvdW5kLk1DSW5kZXhQb2ludFNuYXBwZXIucHJvdG90eXBlLmluZGV4PW51bGw7anN0cy5ub2Rpbmcuc25hcHJvdW5kLk1DSW5kZXhQb2ludFNuYXBwZXIucHJvdG90eXBlLnNuYXA9ZnVuY3Rpb24oaG90UGl4ZWwscGFyZW50RWRnZSx2ZXJ0ZXhJbmRleCl7aWYoYXJndW1lbnRzLmxlbmd0aD09PTEpe3RoaXMuc25hcDIuYXBwbHkodGhpcyxhcmd1bWVudHMpO3JldHVybjt9XG52YXIgcGl4ZWxFbnY9aG90UGl4ZWwuZ2V0U2FmZUVudmVsb3BlKCk7dmFyIGhvdFBpeGVsU25hcEFjdGlvbj1uZXcgSG90UGl4ZWxTbmFwQWN0aW9uKGhvdFBpeGVsLHBhcmVudEVkZ2UsdmVydGV4SW5kZXgpO3RoaXMuaW5kZXgucXVlcnkocGl4ZWxFbnYse3Zpc2l0SXRlbTpmdW5jdGlvbih0ZXN0Q2hhaW4pe3Rlc3RDaGFpbi5zZWxlY3QocGl4ZWxFbnYsaG90UGl4ZWxTbmFwQWN0aW9uKTt9fSk7cmV0dXJuIGhvdFBpeGVsU25hcEFjdGlvbi5pc05vZGVBZGRlZCgpO307anN0cy5ub2Rpbmcuc25hcHJvdW5kLk1DSW5kZXhQb2ludFNuYXBwZXIucHJvdG90eXBlLnNuYXAyPWZ1bmN0aW9uKGhvdFBpeGVsKXtyZXR1cm4gdGhpcy5zbmFwKGhvdFBpeGVsLG51bGwsLTEpO307fSkoKTsoZnVuY3Rpb24oKXt2YXIgTm9kZUJhc2U9ZnVuY3Rpb24oKXt0aGlzLml0ZW1zPW5ldyBqYXZhc2NyaXB0LnV0aWwuQXJyYXlMaXN0KCk7dGhpcy5zdWJub2RlPVtudWxsLG51bGxdO307Tm9kZUJhc2UuZ2V0U3Vibm9kZUluZGV4PWZ1bmN0aW9uKGludGVydmFsLGNlbnRyZSl7dmFyIHN1Ym5vZGVJbmRleD0tMTtpZihpbnRlcnZhbC5taW4+PWNlbnRyZSl7c3Vibm9kZUluZGV4PTE7fVxuaWYoaW50ZXJ2YWwubWF4PD1jZW50cmUpe3N1Ym5vZGVJbmRleD0wO31cbnJldHVybiBzdWJub2RlSW5kZXg7fTtOb2RlQmFzZS5wcm90b3R5cGUuZ2V0SXRlbXM9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5pdGVtczt9O05vZGVCYXNlLnByb3RvdHlwZS5hZGQ9ZnVuY3Rpb24oaXRlbSl7dGhpcy5pdGVtcy5hZGQoaXRlbSk7fTtOb2RlQmFzZS5wcm90b3R5cGUuYWRkQWxsSXRlbXM9ZnVuY3Rpb24oaXRlbXMpe2l0ZW1zLmFkZEFsbCh0aGlzLml0ZW1zKTt2YXIgaT0wLGlsPTI7Zm9yKGk7aTxpbDtpKyspe2lmKHRoaXMuc3Vibm9kZVtpXSE9PW51bGwpe3RoaXMuc3Vibm9kZVtpXS5hZGRBbGxJdGVtcyhpdGVtcyk7fX1cbnJldHVybiBpdGVtczt9O05vZGVCYXNlLnByb3RvdHlwZS5hZGRBbGxJdGVtc0Zyb21PdmVybGFwcGluZz1mdW5jdGlvbihpbnRlcnZhbCxyZXN1bHRJdGVtcyl7aWYoaW50ZXJ2YWwhPT1udWxsJiYhdGhpcy5pc1NlYXJjaE1hdGNoKGludGVydmFsKSl7cmV0dXJuO31cbnJlc3VsdEl0ZW1zLmFkZEFsbCh0aGlzLml0ZW1zKTtpZih0aGlzLnN1Ym5vZGVbMF0hPT1udWxsKXt0aGlzLnN1Ym5vZGVbMF0uYWRkQWxsSXRlbXNGcm9tT3ZlcmxhcHBpbmcoaW50ZXJ2YWwscmVzdWx0SXRlbXMpO31cbmlmKHRoaXMuc3Vibm9kZVsxXSE9PW51bGwpe3RoaXMuc3Vibm9kZVsxXS5hZGRBbGxJdGVtc0Zyb21PdmVybGFwcGluZyhpbnRlcnZhbCxyZXN1bHRJdGVtcyk7fX07Tm9kZUJhc2UucHJvdG90eXBlLnJlbW92ZT1mdW5jdGlvbihpdGVtSW50ZXJ2YWwsaXRlbSl7aWYoIXRoaXMuaXNTZWFyY2hNYXRjaChpdGVtSW50ZXJ2YWwpKXtyZXR1cm4gZmFsc2U7fVxudmFyIGZvdW5kPWZhbHNlLGk9MCxpbD0yO2ZvcihpO2k8aWw7aSsrKXtpZih0aGlzLnN1Ym5vZGVbaV0hPT1udWxsKXtmb3VuZD10aGlzLnN1Ym5vZGVbaV0ucmVtb3ZlKGl0ZW1JbnRlcnZhbCxpdGVtKTtpZihmb3VuZCl7aWYodGhpcy5zdWJub2RlW2ldLmlzUHJ1bmFibGUoKSl7dGhpcy5zdWJub2RlW2ldPW51bGw7fVxuYnJlYWs7fX19XG5pZihmb3VuZCl7cmV0dXJuIGZvdW5kO31cbmZvdW5kPXRoaXMuaXRlbXMucmVtb3ZlKGl0ZW0pO3JldHVybiBmb3VuZDt9O05vZGVCYXNlLnByb3RvdHlwZS5pc1BydW5hYmxlPWZ1bmN0aW9uKCl7cmV0dXJuISh0aGlzLmhhc0NoaWxkcmVuKCl8fHRoaXMuaGFzSXRlbXMoKSk7fTtOb2RlQmFzZS5wcm90b3R5cGUuaGFzQ2hpbGRyZW49ZnVuY3Rpb24oKXt2YXIgaT0wLGlsPTI7Zm9yKGk7aTxpbDtpKyspe2lmKHRoaXMuc3Vibm9kZVtpXSE9PW51bGwpe3JldHVybiB0cnVlO319XG5yZXR1cm4gZmFsc2U7fTtOb2RlQmFzZS5wcm90b3R5cGUuaGFzSXRlbXM9ZnVuY3Rpb24oKXtyZXR1cm4hdGhpcy5pdGVtcy5pc0VtcHR5KCk7fTtOb2RlQmFzZS5wcm90b3R5cGUuZGVwdGg9ZnVuY3Rpb24oKXt2YXIgbWF4U3ViRGVwdGg9MCxpPTAsaWw9MixzcWQ7Zm9yKGk7aTxpbDtpKyspe2lmKHRoaXMuc3Vibm9kZVtpXSE9PW51bGwpe3NxZD10aGlzLnN1Ym5vZGVbaV0uZGVwdGgoKTtpZihzcWQ+bWF4U3ViRGVwdGgpe21heFN1YkRlcHRoPXNxZDt9fX1cbnJldHVybiBtYXhTdWJEZXB0aCsxO307Tm9kZUJhc2UucHJvdG90eXBlLnNpemU9ZnVuY3Rpb24oKXt2YXIgc3ViU2l6ZT0wLGk9MCxpbD0yO2ZvcihpO2k8aWw7aSsrKXtpZih0aGlzLnN1Ym5vZGVbaV0hPT1udWxsKXtzdWJTaXplKz10aGlzLnN1Ym5vZGVbaV0uc2l6ZSgpO319XG5yZXR1cm4gc3ViU2l6ZSt0aGlzLml0ZW1zLnNpemUoKTt9O05vZGVCYXNlLnByb3RvdHlwZS5ub2RlU2l6ZT1mdW5jdGlvbigpe3ZhciBzdWJTaXplPTAsaT0wLGlsPTI7Zm9yKGk7aTxpbDtpKyspe2lmKHRoaXMuc3Vibm9kZVtpXSE9PW51bGwpe3N1YlNpemUrPXRoaXMuc3Vibm9kZVtpXS5ub2RlU2l6ZSgpO319XG5yZXR1cm4gc3ViU2l6ZSsxO307anN0cy5pbmRleC5iaW50cmVlLk5vZGVCYXNlPU5vZGVCYXNlO30pKCk7KGZ1bmN0aW9uKCl7dmFyIE5vZGVCYXNlPWpzdHMuaW5kZXguYmludHJlZS5Ob2RlQmFzZTt2YXIgS2V5PWpzdHMuaW5kZXguYmludHJlZS5LZXk7dmFyIEludGVydmFsPWpzdHMuaW5kZXguYmludHJlZS5JbnRlcnZhbDt2YXIgTm9kZT1mdW5jdGlvbihpbnRlcnZhbCxsZXZlbCl7dGhpcy5pdGVtcz1uZXcgamF2YXNjcmlwdC51dGlsLkFycmF5TGlzdCgpO3RoaXMuc3Vibm9kZT1bbnVsbCxudWxsXTt0aGlzLmludGVydmFsPWludGVydmFsO3RoaXMubGV2ZWw9bGV2ZWw7dGhpcy5jZW50cmU9KGludGVydmFsLmdldE1pbigpK2ludGVydmFsLmdldE1heCgpKS8yO307Tm9kZS5wcm90b3R5cGU9bmV3IE5vZGVCYXNlKCk7Tm9kZS5jb25zdHJ1Y3Rvcj1Ob2RlO05vZGUuY3JlYXRlTm9kZT1mdW5jdGlvbihpdGVtSW50ZXJ2YWwpe3ZhciBrZXksbm9kZTtrZXk9bmV3IEtleShpdGVtSW50ZXJ2YWwpO25vZGU9bmV3IE5vZGUoa2V5LmdldEludGVydmFsKCksa2V5LmdldExldmVsKCkpO3JldHVybiBub2RlO307Tm9kZS5jcmVhdGVFeHBhbmRlZD1mdW5jdGlvbihub2RlLGFkZEludGVydmFsKXt2YXIgZXhwYW5kSW50LGxhcmdlck5vZGU7ZXhwYW5kSW50PW5ldyBJbnRlcnZhbChhZGRJbnRlcnZhbCk7aWYobm9kZSE9PW51bGwpe2V4cGFuZEludC5leHBhbmRUb0luY2x1ZGUobm9kZS5pbnRlcnZhbCk7fVxubGFyZ2VyTm9kZT1Ob2RlLmNyZWF0ZU5vZGUoZXhwYW5kSW50KTtpZihub2RlIT09bnVsbCl7bGFyZ2VyTm9kZS5pbnNlcnQobm9kZSk7fVxucmV0dXJuIGxhcmdlck5vZGU7fTtOb2RlLnByb3RvdHlwZS5nZXRJbnRlcnZhbD1mdW5jdGlvbigpe3JldHVybiB0aGlzLmludGVydmFsO307Tm9kZS5wcm90b3R5cGUuaXNTZWFyY2hNYXRjaD1mdW5jdGlvbihpdGVtSW50ZXJ2YWwpe3JldHVybiBpdGVtSW50ZXJ2YWwub3ZlcmxhcHModGhpcy5pbnRlcnZhbCk7fTtOb2RlLnByb3RvdHlwZS5nZXROb2RlPWZ1bmN0aW9uKHNlYXJjaEludGVydmFsKXt2YXIgc3Vibm9kZUluZGV4PU5vZGVCYXNlLmdldFN1Ym5vZGVJbmRleChzZWFyY2hJbnRlcnZhbCx0aGlzLmNlbnRyZSksbm9kZTtpZihzdWJub2RlSW5kZXghPS0xKXtub2RlPXRoaXMuZ2V0U3Vibm9kZShzdWJub2RlSW5kZXgpO3JldHVybiBub2RlLmdldE5vZGUoc2VhcmNoSW50ZXJ2YWwpO31lbHNle3JldHVybiB0aGlzO319O05vZGUucHJvdG90eXBlLmZpbmQ9ZnVuY3Rpb24oc2VhcmNoSW50ZXJ2YWwpe3ZhciBzdWJub2RlSW5kZXg9Tm9kZUJhc2UuZ2V0U3Vibm9kZUluZGV4KHNlYXJjaEludGVydmFsLHRoaXMuY2VudHJlKSxub2RlO2lmKHN1Ym5vZGVJbmRleD09PS0xKXtyZXR1cm4gdGhpczt9XG5pZih0aGlzLnN1Ym5vZGVbc3Vibm9kZUluZGV4XSE9PW51bGwpe25vZGU9dGhpcy5zdWJub2RlW3N1Ym5vZGVJbmRleF07cmV0dXJuIG5vZGUuZmluZChzZWFyY2hJbnRlcnZhbCk7fVxucmV0dXJuIHRoaXM7fTtOb2RlLnByb3RvdHlwZS5pbnNlcnQ9ZnVuY3Rpb24obm9kZSl7dmFyIGluZGV4PU5vZGVCYXNlLmdldFN1Ym5vZGVJbmRleChub2RlLmludGVydmFsLHRoaXMuY2VudHJlKSxjaGlsZE5vZGU7aWYobm9kZS5sZXZlbD09PXRoaXMubGV2ZWwtMSl7dGhpcy5zdWJub2RlW2luZGV4XT1ub2RlO31lbHNle2NoaWxkTm9kZT10aGlzLmNyZWF0ZVN1Ym5vZGUoaW5kZXgpO2NoaWxkTm9kZS5pbnNlcnQobm9kZSk7dGhpcy5zdWJub2RlW2luZGV4XT1jaGlsZE5vZGU7fX07Tm9kZS5wcm90b3R5cGUuZ2V0U3Vibm9kZT1mdW5jdGlvbihpbmRleCl7aWYodGhpcy5zdWJub2RlW2luZGV4XT09PW51bGwpe3RoaXMuc3Vibm9kZVtpbmRleF09dGhpcy5jcmVhdGVTdWJub2RlKGluZGV4KTt9XG5yZXR1cm4gdGhpcy5zdWJub2RlW2luZGV4XTt9O05vZGUucHJvdG90eXBlLmNyZWF0ZVN1Ym5vZGU9ZnVuY3Rpb24oaW5kZXgpe3ZhciBtaW4sbWF4LHN1YkludCxub2RlO21pbj0wLjA7bWF4PTAuMDtzd2l0Y2goaW5kZXgpe2Nhc2UgMDptaW49dGhpcy5pbnRlcnZhbC5nZXRNaW4oKTttYXg9dGhpcy5jZW50cmU7YnJlYWs7Y2FzZSAxOm1pbj10aGlzLmNlbnRyZTttYXg9dGhpcy5pbnRlcnZhbC5nZXRNYXgoKTticmVhazt9XG5zdWJJbnQ9bmV3IEludGVydmFsKG1pbixtYXgpO25vZGU9bmV3IE5vZGUoc3ViSW50LHRoaXMubGV2ZWwtMSk7cmV0dXJuIG5vZGU7fTtqc3RzLmluZGV4LmJpbnRyZWUuTm9kZT1Ob2RlO30pKCk7KGZ1bmN0aW9uKCl7dmFyIE5vZGU9anN0cy5pbmRleC5iaW50cmVlLk5vZGU7dmFyIE5vZGVCYXNlPWpzdHMuaW5kZXguYmludHJlZS5Ob2RlQmFzZTt2YXIgUm9vdD1mdW5jdGlvbigpe3RoaXMuc3Vibm9kZT1bbnVsbCxudWxsXTt0aGlzLml0ZW1zPW5ldyBqYXZhc2NyaXB0LnV0aWwuQXJyYXlMaXN0KCk7fTtSb290LnByb3RvdHlwZT1uZXcganN0cy5pbmRleC5iaW50cmVlLk5vZGVCYXNlKCk7Um9vdC5jb25zdHJ1Y3Rvcj1Sb290O1Jvb3Qub3JpZ2luPTAuMDtSb290LnByb3RvdHlwZS5pbnNlcnQ9ZnVuY3Rpb24oaXRlbUludGVydmFsLGl0ZW0pe3ZhciBpbmRleD1Ob2RlQmFzZS5nZXRTdWJub2RlSW5kZXgoaXRlbUludGVydmFsLFJvb3Qub3JpZ2luKSxub2RlLGxhcmdlck5vZGU7aWYoaW5kZXg9PT0tMSl7dGhpcy5hZGQoaXRlbSk7cmV0dXJuO31cbm5vZGU9dGhpcy5zdWJub2RlW2luZGV4XTtpZihub2RlPT09bnVsbHx8IW5vZGUuZ2V0SW50ZXJ2YWwoKS5jb250YWlucyhpdGVtSW50ZXJ2YWwpKXtsYXJnZXJOb2RlPU5vZGUuY3JlYXRlRXhwYW5kZWQobm9kZSxpdGVtSW50ZXJ2YWwpO3RoaXMuc3Vibm9kZVtpbmRleF09bGFyZ2VyTm9kZTt9XG50aGlzLmluc2VydENvbnRhaW5lZCh0aGlzLnN1Ym5vZGVbaW5kZXhdLGl0ZW1JbnRlcnZhbCxpdGVtKTt9O1Jvb3QucHJvdG90eXBlLmluc2VydENvbnRhaW5lZD1mdW5jdGlvbih0cmVlLGl0ZW1JbnRlcnZhbCxpdGVtKXt2YXIgaXNaZXJvQXJlYSxub2RlO2lzWmVyb0FyZWE9anN0cy5pbmRleC5JbnRlcnZhbFNpemUuaXNaZXJvV2lkdGgoaXRlbUludGVydmFsLmdldE1pbigpLGl0ZW1JbnRlcnZhbC5nZXRNYXgoKSk7bm9kZT1pc1plcm9BcmVhP3RyZWUuZmluZChpdGVtSW50ZXJ2YWwpOnRyZWUuZ2V0Tm9kZShpdGVtSW50ZXJ2YWwpO25vZGUuYWRkKGl0ZW0pO307Um9vdC5wcm90b3R5cGUuaXNTZWFyY2hNYXRjaD1mdW5jdGlvbihpbnRlcnZhbCl7cmV0dXJuIHRydWU7fTtqc3RzLmluZGV4LmJpbnRyZWUuUm9vdD1Sb290O30pKCk7anN0cy5nZW9tZ3JhcGguUXVhZHJhbnQ9ZnVuY3Rpb24oKXt9O2pzdHMuZ2VvbWdyYXBoLlF1YWRyYW50Lk5FPTA7anN0cy5nZW9tZ3JhcGguUXVhZHJhbnQuTlc9MTtqc3RzLmdlb21ncmFwaC5RdWFkcmFudC5TVz0yO2pzdHMuZ2VvbWdyYXBoLlF1YWRyYW50LlNFPTM7anN0cy5nZW9tZ3JhcGguUXVhZHJhbnQucXVhZHJhbnQ9ZnVuY3Rpb24oZHgsZHkpe2lmKGR4IGluc3RhbmNlb2YganN0cy5nZW9tLkNvb3JkaW5hdGUpe3JldHVybiBqc3RzLmdlb21ncmFwaC5RdWFkcmFudC5xdWFkcmFudDIuYXBwbHkodGhpcyxhcmd1bWVudHMpO31cbmlmKGR4PT09MC4wJiZkeT09PTAuMClcbnRocm93IG5ldyBqc3RzLmVycm9yLklsbGVnYWxBcmd1bWVudEVycm9yKCdDYW5ub3QgY29tcHV0ZSB0aGUgcXVhZHJhbnQgZm9yIHBvaW50ICggJytkeCsnLCAnK2R5KycgKScpO2lmKGR4Pj0wLjApe2lmKGR5Pj0wLjApXG5yZXR1cm4ganN0cy5nZW9tZ3JhcGguUXVhZHJhbnQuTkU7ZWxzZVxucmV0dXJuIGpzdHMuZ2VvbWdyYXBoLlF1YWRyYW50LlNFO31lbHNle2lmKGR5Pj0wLjApXG5yZXR1cm4ganN0cy5nZW9tZ3JhcGguUXVhZHJhbnQuTlc7ZWxzZVxucmV0dXJuIGpzdHMuZ2VvbWdyYXBoLlF1YWRyYW50LlNXO319O2pzdHMuZ2VvbWdyYXBoLlF1YWRyYW50LnF1YWRyYW50Mj1mdW5jdGlvbihwMCxwMSl7aWYocDEueD09PXAwLngmJnAxLnk9PT1wMC55KVxudGhyb3cgbmV3IGpzdHMuZXJyb3IuSWxsZWdhbEFyZ3VtZW50RXJyb3IoJ0Nhbm5vdCBjb21wdXRlIHRoZSBxdWFkcmFudCBmb3IgdHdvIGlkZW50aWNhbCBwb2ludHMgJytwMCk7aWYocDEueD49cDAueCl7aWYocDEueT49cDAueSlcbnJldHVybiBqc3RzLmdlb21ncmFwaC5RdWFkcmFudC5ORTtlbHNlXG5yZXR1cm4ganN0cy5nZW9tZ3JhcGguUXVhZHJhbnQuU0U7fWVsc2V7aWYocDEueT49cDAueSlcbnJldHVybiBqc3RzLmdlb21ncmFwaC5RdWFkcmFudC5OVztlbHNlXG5yZXR1cm4ganN0cy5nZW9tZ3JhcGguUXVhZHJhbnQuU1c7fX07anN0cy5nZW9tZ3JhcGguUXVhZHJhbnQuaXNPcHBvc2l0ZT1mdW5jdGlvbihxdWFkMSxxdWFkMil7aWYocXVhZDE9PT1xdWFkMilcbnJldHVybiBmYWxzZTt2YXIgZGlmZj0ocXVhZDEtcXVhZDIrNCklNDtpZihkaWZmPT09MilcbnJldHVybiB0cnVlO3JldHVybiBmYWxzZTt9O2pzdHMuZ2VvbWdyYXBoLlF1YWRyYW50LmNvbW1vbkhhbGZQbGFuZT1mdW5jdGlvbihxdWFkMSxxdWFkMil7aWYocXVhZDE9PT1xdWFkMilcbnJldHVybiBxdWFkMTt2YXIgZGlmZj0ocXVhZDEtcXVhZDIrNCklNDtpZihkaWZmPT09MilcbnJldHVybi0xO3ZhciBtaW49KHF1YWQxPHF1YWQyKT9xdWFkMTpxdWFkMjt2YXIgbWF4PShxdWFkMT5xdWFkMik/cXVhZDE6cXVhZDI7aWYobWluPT09MCYmbWF4PT09MylcbnJldHVybiAzO3JldHVybiBtaW47fTtqc3RzLmdlb21ncmFwaC5RdWFkcmFudC5pc0luSGFsZlBsYW5lPWZ1bmN0aW9uKHF1YWQsaGFsZlBsYW5lKXtpZihoYWxmUGxhbmU9PT1qc3RzLmdlb21ncmFwaC5RdWFkcmFudC5TRSl7cmV0dXJuIHF1YWQ9PT1qc3RzLmdlb21ncmFwaC5RdWFkcmFudC5TRXx8cXVhZD09PWpzdHMuZ2VvbWdyYXBoLlF1YWRyYW50LlNXO31cbnJldHVybiBxdWFkPT09aGFsZlBsYW5lfHxxdWFkPT09aGFsZlBsYW5lKzE7fTtqc3RzLmdlb21ncmFwaC5RdWFkcmFudC5pc05vcnRoZXJuPWZ1bmN0aW9uKHF1YWQpe3JldHVybiBxdWFkPT09anN0cy5nZW9tZ3JhcGguUXVhZHJhbnQuTkV8fHF1YWQ9PT1qc3RzLmdlb21ncmFwaC5RdWFkcmFudC5OVzt9O2pzdHMub3BlcmF0aW9uLnZhbGlkLkNvbnNpc3RlbnRBcmVhVGVzdGVyPWZ1bmN0aW9uKGdlb21HcmFwaCl7dGhpcy5nZW9tR3JhcGg9Z2VvbUdyYXBoO3RoaXMubGk9bmV3IGpzdHMuYWxnb3JpdGhtLlJvYnVzdExpbmVJbnRlcnNlY3RvcigpO3RoaXMubm9kZUdyYXBoPW5ldyBqc3RzLm9wZXJhdGlvbi5yZWxhdGUuUmVsYXRlTm9kZUdyYXBoKCk7dGhpcy5pbnZhbGlkUG9pbnQ9bnVsbDt9O2pzdHMub3BlcmF0aW9uLnZhbGlkLkNvbnNpc3RlbnRBcmVhVGVzdGVyLnByb3RvdHlwZS5nZXRJbnZhbGlkUG9pbnQ9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5pbnZhbGlkUG9pbnQ7fTtqc3RzLm9wZXJhdGlvbi52YWxpZC5Db25zaXN0ZW50QXJlYVRlc3Rlci5wcm90b3R5cGUuaXNOb2RlQ29uc2lzdGVudEFyZWE9ZnVuY3Rpb24oKXt2YXIgaW50ZXJzZWN0b3I9dGhpcy5nZW9tR3JhcGguY29tcHV0ZVNlbGZOb2Rlcyh0aGlzLmxpLHRydWUpO2lmKGludGVyc2VjdG9yLmhhc1Byb3BlckludGVyc2VjdGlvbigpKXt0aGlzLmludmFsaWRQb2ludD1pbnRlcnNlY3Rvci5nZXRQcm9wZXJJbnRlcnNlY3Rpb25Qb2ludCgpO3JldHVybiBmYWxzZTt9XG50aGlzLm5vZGVHcmFwaC5idWlsZCh0aGlzLmdlb21HcmFwaCk7cmV0dXJuIHRoaXMuaXNOb2RlRWRnZUFyZWFMYWJlbHNDb25zaXN0ZW50KCk7fTtqc3RzLm9wZXJhdGlvbi52YWxpZC5Db25zaXN0ZW50QXJlYVRlc3Rlci5wcm90b3R5cGUuaXNOb2RlRWRnZUFyZWFMYWJlbHNDb25zaXN0ZW50PWZ1bmN0aW9uKCl7Zm9yKHZhciBub2RlSXQ9dGhpcy5ub2RlR3JhcGguZ2V0Tm9kZUl0ZXJhdG9yKCk7bm9kZUl0Lmhhc05leHQoKTspe3ZhciBub2RlPW5vZGVJdC5uZXh0KCk7aWYoIW5vZGUuZ2V0RWRnZXMoKS5pc0FyZWFMYWJlbHNDb25zaXN0ZW50KHRoaXMuZ2VvbUdyYXBoKSl7dGhpcy5pbnZhbGlkUG9pbnQ9bm9kZS5nZXRDb29yZGluYXRlKCkuY2xvbmUoKTtyZXR1cm4gZmFsc2U7fX1cbnJldHVybiB0cnVlO307anN0cy5vcGVyYXRpb24udmFsaWQuQ29uc2lzdGVudEFyZWFUZXN0ZXIucHJvdG90eXBlLmhhc0R1cGxpY2F0ZVJpbmdzPWZ1bmN0aW9uKCl7Zm9yKHZhciBub2RlSXQ9dGhpcy5ub2RlR3JhcGguZ2V0Tm9kZUl0ZXJhdG9yKCk7bm9kZUl0Lmhhc05leHQoKTspe3ZhciBub2RlPW5vZGVJdC5uZXh0KCk7Zm9yKHZhciBpPW5vZGUuZ2V0RWRnZXMoKS5pdGVyYXRvcigpO2kuaGFzTmV4dCgpOyl7dmFyIGVlYj1pLm5leHQoKTtpZihlZWIuZ2V0RWRnZUVuZHMoKS5sZW5ndGg+MSl7aW52YWxpZFBvaW50PWVlYi5nZXRFZGdlKCkuZ2V0Q29vcmRpbmF0ZSgwKTtyZXR1cm4gdHJ1ZTt9fX1cbnJldHVybiBmYWxzZTt9O2pzdHMub3BlcmF0aW9uLnJlbGF0ZS5SZWxhdGVOb2RlPWZ1bmN0aW9uKGNvb3JkLGVkZ2VzKXtqc3RzLmdlb21ncmFwaC5Ob2RlLmFwcGx5KHRoaXMsYXJndW1lbnRzKTt9O2pzdHMub3BlcmF0aW9uLnJlbGF0ZS5SZWxhdGVOb2RlLnByb3RvdHlwZT1uZXcganN0cy5nZW9tZ3JhcGguTm9kZSgpO2pzdHMub3BlcmF0aW9uLnJlbGF0ZS5SZWxhdGVOb2RlLnByb3RvdHlwZS5jb21wdXRlSU09ZnVuY3Rpb24oaW0pe2ltLnNldEF0TGVhc3RJZlZhbGlkKHRoaXMubGFiZWwuZ2V0TG9jYXRpb24oMCksdGhpcy5sYWJlbC5nZXRMb2NhdGlvbigxKSwwKTt9O2pzdHMub3BlcmF0aW9uLnJlbGF0ZS5SZWxhdGVOb2RlLnByb3RvdHlwZS51cGRhdGVJTUZyb21FZGdlcz1mdW5jdGlvbihpbSl7dGhpcy5lZGdlcy51cGRhdGVJTShpbSk7fTsoZnVuY3Rpb24oKXt2YXIgTG9jYXRpb249anN0cy5nZW9tLkxvY2F0aW9uO3ZhciBQb3NpdGlvbj1qc3RzLmdlb21ncmFwaC5Qb3NpdGlvbjt2YXIgRWRnZUVuZD1qc3RzLmdlb21ncmFwaC5FZGdlRW5kO2pzdHMuZ2VvbWdyYXBoLkRpcmVjdGVkRWRnZT1mdW5jdGlvbihlZGdlLGlzRm9yd2FyZCl7RWRnZUVuZC5jYWxsKHRoaXMsZWRnZSk7dGhpcy5kZXB0aD1bMCwtOTk5LC05OTldO3RoaXMuX2lzRm9yd2FyZD1pc0ZvcndhcmQ7aWYoaXNGb3J3YXJkKXt0aGlzLmluaXQoZWRnZS5nZXRDb29yZGluYXRlKDApLGVkZ2UuZ2V0Q29vcmRpbmF0ZSgxKSk7fWVsc2V7dmFyIG49ZWRnZS5nZXROdW1Qb2ludHMoKS0xO3RoaXMuaW5pdChlZGdlLmdldENvb3JkaW5hdGUobiksZWRnZS5nZXRDb29yZGluYXRlKG4tMSkpO31cbnRoaXMuY29tcHV0ZURpcmVjdGVkTGFiZWwoKTt9O2pzdHMuZ2VvbWdyYXBoLkRpcmVjdGVkRWRnZS5wcm90b3R5cGU9bmV3IEVkZ2VFbmQoKTtqc3RzLmdlb21ncmFwaC5EaXJlY3RlZEVkZ2UuY29uc3RydWN0b3I9anN0cy5nZW9tZ3JhcGguRGlyZWN0ZWRFZGdlO2pzdHMuZ2VvbWdyYXBoLkRpcmVjdGVkRWRnZS5kZXB0aEZhY3Rvcj1mdW5jdGlvbihjdXJyTG9jYXRpb24sbmV4dExvY2F0aW9uKXtpZihjdXJyTG9jYXRpb249PT1Mb2NhdGlvbi5FWFRFUklPUiYmbmV4dExvY2F0aW9uPT09TG9jYXRpb24uSU5URVJJT1IpXG5yZXR1cm4gMTtlbHNlIGlmKGN1cnJMb2NhdGlvbj09PUxvY2F0aW9uLklOVEVSSU9SJiZuZXh0TG9jYXRpb249PT1Mb2NhdGlvbi5FWFRFUklPUilcbnJldHVybi0xO3JldHVybiAwO307anN0cy5nZW9tZ3JhcGguRGlyZWN0ZWRFZGdlLnByb3RvdHlwZS5faXNGb3J3YXJkPW51bGw7anN0cy5nZW9tZ3JhcGguRGlyZWN0ZWRFZGdlLnByb3RvdHlwZS5faXNJblJlc3VsdD1mYWxzZTtqc3RzLmdlb21ncmFwaC5EaXJlY3RlZEVkZ2UucHJvdG90eXBlLl9pc1Zpc2l0ZWQ9ZmFsc2U7anN0cy5nZW9tZ3JhcGguRGlyZWN0ZWRFZGdlLnByb3RvdHlwZS5zeW09bnVsbDtqc3RzLmdlb21ncmFwaC5EaXJlY3RlZEVkZ2UucHJvdG90eXBlLm5leHQ9bnVsbDtqc3RzLmdlb21ncmFwaC5EaXJlY3RlZEVkZ2UucHJvdG90eXBlLm5leHRNaW49bnVsbDtqc3RzLmdlb21ncmFwaC5EaXJlY3RlZEVkZ2UucHJvdG90eXBlLmVkZ2VSaW5nPW51bGw7anN0cy5nZW9tZ3JhcGguRGlyZWN0ZWRFZGdlLnByb3RvdHlwZS5taW5FZGdlUmluZz1udWxsO2pzdHMuZ2VvbWdyYXBoLkRpcmVjdGVkRWRnZS5wcm90b3R5cGUuZGVwdGg9bnVsbDtqc3RzLmdlb21ncmFwaC5EaXJlY3RlZEVkZ2UucHJvdG90eXBlLmdldEVkZ2U9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5lZGdlO307anN0cy5nZW9tZ3JhcGguRGlyZWN0ZWRFZGdlLnByb3RvdHlwZS5zZXRJblJlc3VsdD1mdW5jdGlvbihpc0luUmVzdWx0KXt0aGlzLl9pc0luUmVzdWx0PWlzSW5SZXN1bHQ7fTtqc3RzLmdlb21ncmFwaC5EaXJlY3RlZEVkZ2UucHJvdG90eXBlLmlzSW5SZXN1bHQ9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5faXNJblJlc3VsdDt9O2pzdHMuZ2VvbWdyYXBoLkRpcmVjdGVkRWRnZS5wcm90b3R5cGUuaXNWaXNpdGVkPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2lzVmlzaXRlZDt9O2pzdHMuZ2VvbWdyYXBoLkRpcmVjdGVkRWRnZS5wcm90b3R5cGUuc2V0VmlzaXRlZD1mdW5jdGlvbihpc1Zpc2l0ZWQpe3RoaXMuX2lzVmlzaXRlZD1pc1Zpc2l0ZWQ7fTtqc3RzLmdlb21ncmFwaC5EaXJlY3RlZEVkZ2UucHJvdG90eXBlLnNldEVkZ2VSaW5nPWZ1bmN0aW9uKGVkZ2VSaW5nKXt0aGlzLmVkZ2VSaW5nPWVkZ2VSaW5nO307anN0cy5nZW9tZ3JhcGguRGlyZWN0ZWRFZGdlLnByb3RvdHlwZS5nZXRFZGdlUmluZz1mdW5jdGlvbigpe3JldHVybiB0aGlzLmVkZ2VSaW5nO307anN0cy5nZW9tZ3JhcGguRGlyZWN0ZWRFZGdlLnByb3RvdHlwZS5zZXRNaW5FZGdlUmluZz1mdW5jdGlvbihtaW5FZGdlUmluZyl7dGhpcy5taW5FZGdlUmluZz1taW5FZGdlUmluZzt9O2pzdHMuZ2VvbWdyYXBoLkRpcmVjdGVkRWRnZS5wcm90b3R5cGUuZ2V0TWluRWRnZVJpbmc9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5taW5FZGdlUmluZzt9O2pzdHMuZ2VvbWdyYXBoLkRpcmVjdGVkRWRnZS5wcm90b3R5cGUuZ2V0RGVwdGg9ZnVuY3Rpb24ocG9zaXRpb24pe3JldHVybiB0aGlzLmRlcHRoW3Bvc2l0aW9uXTt9O2pzdHMuZ2VvbWdyYXBoLkRpcmVjdGVkRWRnZS5wcm90b3R5cGUuc2V0RGVwdGg9ZnVuY3Rpb24ocG9zaXRpb24sZGVwdGhWYWwpe2lmKHRoaXMuZGVwdGhbcG9zaXRpb25dIT09LTk5OSl7aWYodGhpcy5kZXB0aFtwb3NpdGlvbl0hPT1kZXB0aFZhbClcbnRocm93IG5ldyBqc3RzLmVycm9yLlRvcG9sb2d5RXJyb3IoJ2Fzc2lnbmVkIGRlcHRocyBkbyBub3QgbWF0Y2gnLHRoaXMuZ2V0Q29vcmRpbmF0ZSgpKTt9XG50aGlzLmRlcHRoW3Bvc2l0aW9uXT1kZXB0aFZhbDt9O2pzdHMuZ2VvbWdyYXBoLkRpcmVjdGVkRWRnZS5wcm90b3R5cGUuZ2V0RGVwdGhEZWx0YT1mdW5jdGlvbigpe3ZhciBkZXB0aERlbHRhPXRoaXMuZWRnZS5nZXREZXB0aERlbHRhKCk7aWYoIXRoaXMuX2lzRm9yd2FyZClcbmRlcHRoRGVsdGE9LWRlcHRoRGVsdGE7cmV0dXJuIGRlcHRoRGVsdGE7fTtqc3RzLmdlb21ncmFwaC5EaXJlY3RlZEVkZ2UucHJvdG90eXBlLnNldFZpc2l0ZWRFZGdlPWZ1bmN0aW9uKGlzVmlzaXRlZCl7dGhpcy5zZXRWaXNpdGVkKGlzVmlzaXRlZCk7dGhpcy5zeW0uc2V0VmlzaXRlZChpc1Zpc2l0ZWQpO307anN0cy5nZW9tZ3JhcGguRGlyZWN0ZWRFZGdlLnByb3RvdHlwZS5nZXRTeW09ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5zeW07fTtqc3RzLmdlb21ncmFwaC5EaXJlY3RlZEVkZ2UucHJvdG90eXBlLmlzRm9yd2FyZD1mdW5jdGlvbigpe3JldHVybiB0aGlzLl9pc0ZvcndhcmQ7fTtqc3RzLmdlb21ncmFwaC5EaXJlY3RlZEVkZ2UucHJvdG90eXBlLnNldFN5bT1mdW5jdGlvbihkZSl7dGhpcy5zeW09ZGU7fTtqc3RzLmdlb21ncmFwaC5EaXJlY3RlZEVkZ2UucHJvdG90eXBlLmdldE5leHQ9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5uZXh0O307anN0cy5nZW9tZ3JhcGguRGlyZWN0ZWRFZGdlLnByb3RvdHlwZS5zZXROZXh0PWZ1bmN0aW9uKG5leHQpe3RoaXMubmV4dD1uZXh0O307anN0cy5nZW9tZ3JhcGguRGlyZWN0ZWRFZGdlLnByb3RvdHlwZS5nZXROZXh0TWluPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMubmV4dE1pbjt9O2pzdHMuZ2VvbWdyYXBoLkRpcmVjdGVkRWRnZS5wcm90b3R5cGUuc2V0TmV4dE1pbj1mdW5jdGlvbihuZXh0TWluKXt0aGlzLm5leHRNaW49bmV4dE1pbjt9O2pzdHMuZ2VvbWdyYXBoLkRpcmVjdGVkRWRnZS5wcm90b3R5cGUuaXNMaW5lRWRnZT1mdW5jdGlvbigpe3ZhciBpc0xpbmU9dGhpcy5sYWJlbC5pc0xpbmUoMCl8fHRoaXMubGFiZWwuaXNMaW5lKDEpO3ZhciBpc0V4dGVyaW9ySWZBcmVhMD0hdGhpcy5sYWJlbC5pc0FyZWEoMCl8fHRoaXMubGFiZWwuYWxsUG9zaXRpb25zRXF1YWwoMCxMb2NhdGlvbi5FWFRFUklPUik7dmFyIGlzRXh0ZXJpb3JJZkFyZWExPSF0aGlzLmxhYmVsLmlzQXJlYSgxKXx8dGhpcy5sYWJlbC5hbGxQb3NpdGlvbnNFcXVhbCgxLExvY2F0aW9uLkVYVEVSSU9SKTtyZXR1cm4gaXNMaW5lJiZpc0V4dGVyaW9ySWZBcmVhMCYmaXNFeHRlcmlvcklmQXJlYTE7fTtqc3RzLmdlb21ncmFwaC5EaXJlY3RlZEVkZ2UucHJvdG90eXBlLmlzSW50ZXJpb3JBcmVhRWRnZT1mdW5jdGlvbigpe3ZhciBpc0ludGVyaW9yQXJlYUVkZ2U9dHJ1ZTtmb3IodmFyIGk9MDtpPDI7aSsrKXtpZighKHRoaXMubGFiZWwuaXNBcmVhKGkpJiZ0aGlzLmxhYmVsLmdldExvY2F0aW9uKGksUG9zaXRpb24uTEVGVCk9PT1Mb2NhdGlvbi5JTlRFUklPUiYmdGhpcy5sYWJlbC5nZXRMb2NhdGlvbihpLFBvc2l0aW9uLlJJR0hUKT09PUxvY2F0aW9uLklOVEVSSU9SKSl7aXNJbnRlcmlvckFyZWFFZGdlPWZhbHNlO319XG5yZXR1cm4gaXNJbnRlcmlvckFyZWFFZGdlO307anN0cy5nZW9tZ3JhcGguRGlyZWN0ZWRFZGdlLnByb3RvdHlwZS5jb21wdXRlRGlyZWN0ZWRMYWJlbD1mdW5jdGlvbigpe3RoaXMubGFiZWw9bmV3IGpzdHMuZ2VvbWdyYXBoLkxhYmVsKHRoaXMuZWRnZS5nZXRMYWJlbCgpKTtpZighdGhpcy5faXNGb3J3YXJkKVxudGhpcy5sYWJlbC5mbGlwKCk7fTtqc3RzLmdlb21ncmFwaC5EaXJlY3RlZEVkZ2UucHJvdG90eXBlLnNldEVkZ2VEZXB0aHM9ZnVuY3Rpb24ocG9zaXRpb24sZGVwdGgpe3ZhciBkZXB0aERlbHRhPXRoaXMuZ2V0RWRnZSgpLmdldERlcHRoRGVsdGEoKTtpZighdGhpcy5faXNGb3J3YXJkKVxuZGVwdGhEZWx0YT0tZGVwdGhEZWx0YTt2YXIgZGlyZWN0aW9uRmFjdG9yPTE7aWYocG9zaXRpb249PT1Qb3NpdGlvbi5MRUZUKVxuZGlyZWN0aW9uRmFjdG9yPS0xO3ZhciBvcHBvc2l0ZVBvcz1Qb3NpdGlvbi5vcHBvc2l0ZShwb3NpdGlvbik7dmFyIGRlbHRhPWRlcHRoRGVsdGEqZGlyZWN0aW9uRmFjdG9yO3ZhciBvcHBvc2l0ZURlcHRoPWRlcHRoK2RlbHRhO3RoaXMuc2V0RGVwdGgocG9zaXRpb24sZGVwdGgpO3RoaXMuc2V0RGVwdGgob3Bwb3NpdGVQb3Msb3Bwb3NpdGVEZXB0aCk7fTt9KSgpO2pzdHMub3BlcmF0aW9uLmRpc3RhbmNlLkRpc3RhbmNlT3A9ZnVuY3Rpb24oZzAsZzEsdGVybWluYXRlRGlzdGFuY2Upe3RoaXMucHRMb2NhdG9yPW5ldyBqc3RzLmFsZ29yaXRobS5Qb2ludExvY2F0b3IoKTt0aGlzLmdlb209W107dGhpcy5nZW9tWzBdPWcwO3RoaXMuZ2VvbVsxXT1nMTt0aGlzLnRlcm1pbmF0ZURpc3RhbmNlPXRlcm1pbmF0ZURpc3RhbmNlO307anN0cy5vcGVyYXRpb24uZGlzdGFuY2UuRGlzdGFuY2VPcC5wcm90b3R5cGUuZ2VvbT1udWxsO2pzdHMub3BlcmF0aW9uLmRpc3RhbmNlLkRpc3RhbmNlT3AucHJvdG90eXBlLnRlcm1pbmF0ZURpc3RhbmNlPTAuMDtqc3RzLm9wZXJhdGlvbi5kaXN0YW5jZS5EaXN0YW5jZU9wLnByb3RvdHlwZS5wdExvY2F0b3I9bnVsbDtqc3RzLm9wZXJhdGlvbi5kaXN0YW5jZS5EaXN0YW5jZU9wLnByb3RvdHlwZS5taW5EaXN0YW5jZUxvY2F0aW9uPW51bGw7anN0cy5vcGVyYXRpb24uZGlzdGFuY2UuRGlzdGFuY2VPcC5wcm90b3R5cGUubWluRGlzdGFuY2U9TnVtYmVyLk1BWF9WQUxVRTtqc3RzLm9wZXJhdGlvbi5kaXN0YW5jZS5EaXN0YW5jZU9wLmRpc3RhbmNlPWZ1bmN0aW9uKGcwLGcxKXt2YXIgZGlzdE9wPW5ldyBqc3RzLm9wZXJhdGlvbi5kaXN0YW5jZS5EaXN0YW5jZU9wKGcwLGcxLDAuMCk7cmV0dXJuIGRpc3RPcC5kaXN0YW5jZSgpO307anN0cy5vcGVyYXRpb24uZGlzdGFuY2UuRGlzdGFuY2VPcC5pc1dpdGhpbkRpc3RhbmNlPWZ1bmN0aW9uKGcwLGcxLGRpc3RhbmNlKXt2YXIgZGlzdE9wPW5ldyBqc3RzLm9wZXJhdGlvbi5kaXN0YW5jZS5EaXN0YW5jZU9wKGcwLGcxLGRpc3RhbmNlKTtyZXR1cm4gZGlzdE9wLmRpc3RhbmNlKCk8PWRpc3RhbmNlO307anN0cy5vcGVyYXRpb24uZGlzdGFuY2UuRGlzdGFuY2VPcC5uZWFyZXN0UG9pbnRzPWZ1bmN0aW9uKGcwLGcxKXt2YXIgZGlzdE9wPW5ldyBqc3RzLm9wZXJhdGlvbi5kaXN0YW5jZS5EaXN0YW5jZU9wKGcwLGcxLDAuMCk7cmV0dXJuIGRpc3RPcC5uZWFyZXN0UG9pbnRzKCk7fTtqc3RzLm9wZXJhdGlvbi5kaXN0YW5jZS5EaXN0YW5jZU9wLnByb3RvdHlwZS5kaXN0YW5jZT1mdW5jdGlvbigpe2lmKHRoaXMuZ2VvbVswXT09PW51bGx8fHRoaXMuZ2VvbVsxXT09PW51bGwpXG50aHJvdyBuZXcganN0cy5lcnJvci5JbGxlZ2FsQXJndW1lbnRFcnJvcignbnVsbCBnZW9tZXRyaWVzIGFyZSBub3Qgc3VwcG9ydGVkJyk7aWYodGhpcy5nZW9tWzBdLmlzRW1wdHkoKXx8dGhpcy5nZW9tWzFdLmlzRW1wdHkoKSlcbnJldHVybiAwLjA7dGhpcy5jb21wdXRlTWluRGlzdGFuY2UoKTtyZXR1cm4gdGhpcy5taW5EaXN0YW5jZTt9O2pzdHMub3BlcmF0aW9uLmRpc3RhbmNlLkRpc3RhbmNlT3AucHJvdG90eXBlLm5lYXJlc3RQb2ludHM9ZnVuY3Rpb24oKXt0aGlzLmNvbXB1dGVNaW5EaXN0YW5jZSgpO3ZhciBuZWFyZXN0UHRzPVt0aGlzLm1pbkRpc3RhbmNlTG9jYXRpb25bMF0uZ2V0Q29vcmRpbmF0ZSgpLHRoaXMubWluRGlzdGFuY2VMb2NhdGlvblsxXS5nZXRDb29yZGluYXRlKCldO3JldHVybiBuZWFyZXN0UHRzO307anN0cy5vcGVyYXRpb24uZGlzdGFuY2UuRGlzdGFuY2VPcC5wcm90b3R5cGUubmVhcmVzdExvY2F0aW9ucz1mdW5jdGlvbigpe3RoaXMuY29tcHV0ZU1pbkRpc3RhbmNlKCk7cmV0dXJuIHRoaXMubWluRGlzdGFuY2VMb2NhdGlvbjt9O2pzdHMub3BlcmF0aW9uLmRpc3RhbmNlLkRpc3RhbmNlT3AucHJvdG90eXBlLnVwZGF0ZU1pbkRpc3RhbmNlPWZ1bmN0aW9uKGxvY0dlb20sZmxpcCl7aWYobG9jR2VvbVswXT09PW51bGwpXG5yZXR1cm47aWYoZmxpcCl7dGhpcy5taW5EaXN0YW5jZUxvY2F0aW9uWzBdPWxvY0dlb21bMV07dGhpcy5taW5EaXN0YW5jZUxvY2F0aW9uWzFdPWxvY0dlb21bMF07fWVsc2V7dGhpcy5taW5EaXN0YW5jZUxvY2F0aW9uWzBdPWxvY0dlb21bMF07dGhpcy5taW5EaXN0YW5jZUxvY2F0aW9uWzFdPWxvY0dlb21bMV07fX07anN0cy5vcGVyYXRpb24uZGlzdGFuY2UuRGlzdGFuY2VPcC5wcm90b3R5cGUuY29tcHV0ZU1pbkRpc3RhbmNlPWZ1bmN0aW9uKCl7aWYoYXJndW1lbnRzLmxlbmd0aD4wKXt0aGlzLmNvbXB1dGVNaW5EaXN0YW5jZTIuYXBwbHkodGhpcyxhcmd1bWVudHMpO3JldHVybjt9XG5pZih0aGlzLm1pbkRpc3RhbmNlTG9jYXRpb24hPT1udWxsKVxucmV0dXJuO3RoaXMubWluRGlzdGFuY2VMb2NhdGlvbj1bXTt0aGlzLmNvbXB1dGVDb250YWlubWVudERpc3RhbmNlKCk7aWYodGhpcy5taW5EaXN0YW5jZTw9dGhpcy50ZXJtaW5hdGVEaXN0YW5jZSlcbnJldHVybjt0aGlzLmNvbXB1dGVGYWNldERpc3RhbmNlKCk7fTtqc3RzLm9wZXJhdGlvbi5kaXN0YW5jZS5EaXN0YW5jZU9wLnByb3RvdHlwZS5jb21wdXRlQ29udGFpbm1lbnREaXN0YW5jZT1mdW5jdGlvbigpe2lmKGFyZ3VtZW50cy5sZW5ndGg9PT0yKXt0aGlzLmNvbXB1dGVDb250YWlubWVudERpc3RhbmNlMi5hcHBseSh0aGlzLGFyZ3VtZW50cyk7cmV0dXJuO31lbHNlIGlmKGFyZ3VtZW50cy5sZW5ndGg9PT0zJiYoIWFyZ3VtZW50c1swXWluc3RhbmNlb2YganN0cy5vcGVyYXRpb24uZGlzdGFuY2UuR2VvbWV0cnlMb2NhdGlvbikpe3RoaXMuY29tcHV0ZUNvbnRhaW5tZW50RGlzdGFuY2UzLmFwcGx5KHRoaXMsYXJndW1lbnRzKTtyZXR1cm47fWVsc2UgaWYoYXJndW1lbnRzLmxlbmd0aD09PTMpe3RoaXMuY29tcHV0ZUNvbnRhaW5tZW50RGlzdGFuY2U0LmFwcGx5KHRoaXMsYXJndW1lbnRzKTtyZXR1cm47fVxudmFyIGxvY1B0UG9seT1bXTt0aGlzLmNvbXB1dGVDb250YWlubWVudERpc3RhbmNlMigwLGxvY1B0UG9seSk7aWYodGhpcy5taW5EaXN0YW5jZTw9dGhpcy50ZXJtaW5hdGVEaXN0YW5jZSlcbnJldHVybjt0aGlzLmNvbXB1dGVDb250YWlubWVudERpc3RhbmNlMigxLGxvY1B0UG9seSk7fTtqc3RzLm9wZXJhdGlvbi5kaXN0YW5jZS5EaXN0YW5jZU9wLnByb3RvdHlwZS5jb21wdXRlQ29udGFpbm1lbnREaXN0YW5jZTI9ZnVuY3Rpb24ocG9seUdlb21JbmRleCxsb2NQdFBvbHkpe3ZhciBsb2NhdGlvbnNJbmRleD0xLXBvbHlHZW9tSW5kZXg7dmFyIHBvbHlzPWpzdHMuZ2VvbS51dGlsLlBvbHlnb25FeHRyYWN0ZXIuZ2V0UG9seWdvbnModGhpcy5nZW9tW3BvbHlHZW9tSW5kZXhdKTtpZihwb2x5cy5sZW5ndGg+MCl7dmFyIGluc2lkZUxvY3M9anN0cy5vcGVyYXRpb24uZGlzdGFuY2UuQ29ubmVjdGVkRWxlbWVudExvY2F0aW9uRmlsdGVyLmdldExvY2F0aW9ucyh0aGlzLmdlb21bbG9jYXRpb25zSW5kZXhdKTt0aGlzLmNvbXB1dGVDb250YWlubWVudERpc3RhbmNlMyhpbnNpZGVMb2NzLHBvbHlzLGxvY1B0UG9seSk7aWYodGhpcy5taW5EaXN0YW5jZTw9dGhpcy50ZXJtaW5hdGVEaXN0YW5jZSl7dGhpcy5taW5EaXN0YW5jZUxvY2F0aW9uW2xvY2F0aW9uc0luZGV4XT1sb2NQdFBvbHlbMF07dGhpcy5taW5EaXN0YW5jZUxvY2F0aW9uW3BvbHlHZW9tSW5kZXhdPWxvY1B0UG9seVsxXTtyZXR1cm47fX19O2pzdHMub3BlcmF0aW9uLmRpc3RhbmNlLkRpc3RhbmNlT3AucHJvdG90eXBlLmNvbXB1dGVDb250YWlubWVudERpc3RhbmNlMz1mdW5jdGlvbihsb2NzLHBvbHlzLGxvY1B0UG9seSl7Zm9yKHZhciBpPTA7aTxsb2NzLmxlbmd0aDtpKyspe3ZhciBsb2M9bG9jc1tpXTtmb3IodmFyIGo9MDtqPHBvbHlzLmxlbmd0aDtqKyspe3RoaXMuY29tcHV0ZUNvbnRhaW5tZW50RGlzdGFuY2U0KGxvYyxwb2x5c1tqXSxsb2NQdFBvbHkpO2lmKHRoaXMubWluRGlzdGFuY2U8PXRoaXMudGVybWluYXRlRGlzdGFuY2UpXG5yZXR1cm47fX19O2pzdHMub3BlcmF0aW9uLmRpc3RhbmNlLkRpc3RhbmNlT3AucHJvdG90eXBlLmNvbXB1dGVDb250YWlubWVudERpc3RhbmNlND1mdW5jdGlvbihwdExvYyxwb2x5LGxvY1B0UG9seSl7dmFyIHB0PXB0TG9jLmdldENvb3JkaW5hdGUoKTtpZihqc3RzLmdlb20uTG9jYXRpb24uRVhURVJJT1IhPT10aGlzLnB0TG9jYXRvci5sb2NhdGUocHQscG9seSkpe3RoaXMubWluRGlzdGFuY2U9MC4wO2xvY1B0UG9seVswXT1wdExvYztsb2NQdFBvbHlbMV09bmV3IGpzdHMub3BlcmF0aW9uLmRpc3RhbmNlLkdlb21ldHJ5TG9jYXRpb24ocG9seSxwdCk7cmV0dXJuO319O2pzdHMub3BlcmF0aW9uLmRpc3RhbmNlLkRpc3RhbmNlT3AucHJvdG90eXBlLmNvbXB1dGVGYWNldERpc3RhbmNlPWZ1bmN0aW9uKCl7dmFyIGxvY0dlb209W107dmFyIGxpbmVzMD1qc3RzLmdlb20udXRpbC5MaW5lYXJDb21wb25lbnRFeHRyYWN0ZXIuZ2V0TGluZXModGhpcy5nZW9tWzBdKTt2YXIgbGluZXMxPWpzdHMuZ2VvbS51dGlsLkxpbmVhckNvbXBvbmVudEV4dHJhY3Rlci5nZXRMaW5lcyh0aGlzLmdlb21bMV0pO3ZhciBwdHMwPWpzdHMuZ2VvbS51dGlsLlBvaW50RXh0cmFjdGVyLmdldFBvaW50cyh0aGlzLmdlb21bMF0pO3ZhciBwdHMxPWpzdHMuZ2VvbS51dGlsLlBvaW50RXh0cmFjdGVyLmdldFBvaW50cyh0aGlzLmdlb21bMV0pO3RoaXMuY29tcHV0ZU1pbkRpc3RhbmNlTGluZXMobGluZXMwLGxpbmVzMSxsb2NHZW9tKTt0aGlzLnVwZGF0ZU1pbkRpc3RhbmNlKGxvY0dlb20sZmFsc2UpO2lmKHRoaXMubWluRGlzdGFuY2U8PXRoaXMudGVybWluYXRlRGlzdGFuY2UpXG5yZXR1cm47bG9jR2VvbVswXT1udWxsO2xvY0dlb21bMV09bnVsbDt0aGlzLmNvbXB1dGVNaW5EaXN0YW5jZUxpbmVzUG9pbnRzKGxpbmVzMCxwdHMxLGxvY0dlb20pO3RoaXMudXBkYXRlTWluRGlzdGFuY2UobG9jR2VvbSxmYWxzZSk7aWYodGhpcy5taW5EaXN0YW5jZTw9dGhpcy50ZXJtaW5hdGVEaXN0YW5jZSlcbnJldHVybjtsb2NHZW9tWzBdPW51bGw7bG9jR2VvbVsxXT1udWxsO3RoaXMuY29tcHV0ZU1pbkRpc3RhbmNlTGluZXNQb2ludHMobGluZXMxLHB0czAsbG9jR2VvbSk7dGhpcy51cGRhdGVNaW5EaXN0YW5jZShsb2NHZW9tLHRydWUpO2lmKHRoaXMubWluRGlzdGFuY2U8PXRoaXMudGVybWluYXRlRGlzdGFuY2UpXG5yZXR1cm47bG9jR2VvbVswXT1udWxsO2xvY0dlb21bMV09bnVsbDt0aGlzLmNvbXB1dGVNaW5EaXN0YW5jZVBvaW50cyhwdHMwLHB0czEsbG9jR2VvbSk7dGhpcy51cGRhdGVNaW5EaXN0YW5jZShsb2NHZW9tLGZhbHNlKTt9O2pzdHMub3BlcmF0aW9uLmRpc3RhbmNlLkRpc3RhbmNlT3AucHJvdG90eXBlLmNvbXB1dGVNaW5EaXN0YW5jZUxpbmVzPWZ1bmN0aW9uKGxpbmVzMCxsaW5lczEsbG9jR2VvbSl7Zm9yKHZhciBpPTA7aTxsaW5lczAubGVuZ3RoO2krKyl7dmFyIGxpbmUwPWxpbmVzMFtpXTtmb3IodmFyIGo9MDtqPGxpbmVzMS5sZW5ndGg7aisrKXt2YXIgbGluZTE9bGluZXMxW2pdO3RoaXMuY29tcHV0ZU1pbkRpc3RhbmNlKGxpbmUwLGxpbmUxLGxvY0dlb20pO2lmKHRoaXMubWluRGlzdGFuY2U8PXRoaXMudGVybWluYXRlRGlzdGFuY2UpXG5yZXR1cm47fX19O2pzdHMub3BlcmF0aW9uLmRpc3RhbmNlLkRpc3RhbmNlT3AucHJvdG90eXBlLmNvbXB1dGVNaW5EaXN0YW5jZVBvaW50cz1mdW5jdGlvbihwb2ludHMwLHBvaW50czEsbG9jR2VvbSl7Zm9yKHZhciBpPTA7aTxwb2ludHMwLmxlbmd0aDtpKyspe3ZhciBwdDA9cG9pbnRzMFtpXTtmb3IodmFyIGo9MDtqPHBvaW50czEubGVuZ3RoO2orKyl7dmFyIHB0MT1wb2ludHMxW2pdO3ZhciBkaXN0PXB0MC5nZXRDb29yZGluYXRlKCkuZGlzdGFuY2UocHQxLmdldENvb3JkaW5hdGUoKSk7aWYoZGlzdDx0aGlzLm1pbkRpc3RhbmNlKXt0aGlzLm1pbkRpc3RhbmNlPWRpc3Q7bG9jR2VvbVswXT1uZXcganN0cy5vcGVyYXRpb24uZGlzdGFuY2UuR2VvbWV0cnlMb2NhdGlvbihwdDAsMCxwdDAuZ2V0Q29vcmRpbmF0ZSgpKTtsb2NHZW9tWzFdPW5ldyBqc3RzLm9wZXJhdGlvbi5kaXN0YW5jZS5HZW9tZXRyeUxvY2F0aW9uKHB0MSwwLHB0MS5nZXRDb29yZGluYXRlKCkpO31cbmlmKHRoaXMubWluRGlzdGFuY2U8PXRoaXMudGVybWluYXRlRGlzdGFuY2UpXG5yZXR1cm47fX19O2pzdHMub3BlcmF0aW9uLmRpc3RhbmNlLkRpc3RhbmNlT3AucHJvdG90eXBlLmNvbXB1dGVNaW5EaXN0YW5jZUxpbmVzUG9pbnRzPWZ1bmN0aW9uKGxpbmVzLHBvaW50cyxsb2NHZW9tKXtmb3IodmFyIGk9MDtpPGxpbmVzLmxlbmd0aDtpKyspe3ZhciBsaW5lPWxpbmVzW2ldO2Zvcih2YXIgaj0wO2o8cG9pbnRzLmxlbmd0aDtqKyspe3ZhciBwdD1wb2ludHNbal07dGhpcy5jb21wdXRlTWluRGlzdGFuY2UobGluZSxwdCxsb2NHZW9tKTtpZih0aGlzLm1pbkRpc3RhbmNlPD10aGlzLnRlcm1pbmF0ZURpc3RhbmNlKVxucmV0dXJuO319fTtqc3RzLm9wZXJhdGlvbi5kaXN0YW5jZS5EaXN0YW5jZU9wLnByb3RvdHlwZS5jb21wdXRlTWluRGlzdGFuY2UyPWZ1bmN0aW9uKGxpbmUwLGxpbmUxLGxvY0dlb20pe2lmKGxpbmUxIGluc3RhbmNlb2YganN0cy5nZW9tLlBvaW50KXt0aGlzLmNvbXB1dGVNaW5EaXN0YW5jZTMobGluZTAsbGluZTEsbG9jR2VvbSk7cmV0dXJuO31cbmlmKGxpbmUwLmdldEVudmVsb3BlSW50ZXJuYWwoKS5kaXN0YW5jZShsaW5lMS5nZXRFbnZlbG9wZUludGVybmFsKCkpPnRoaXMubWluRGlzdGFuY2Upe3JldHVybjt9XG52YXIgY29vcmQwPWxpbmUwLmdldENvb3JkaW5hdGVzKCk7dmFyIGNvb3JkMT1saW5lMS5nZXRDb29yZGluYXRlcygpO2Zvcih2YXIgaT0wO2k8Y29vcmQwLmxlbmd0aC0xO2krKyl7Zm9yKHZhciBqPTA7ajxjb29yZDEubGVuZ3RoLTE7aisrKXt2YXIgZGlzdD1qc3RzLmFsZ29yaXRobS5DR0FsZ29yaXRobXMuZGlzdGFuY2VMaW5lTGluZShjb29yZDBbaV0sY29vcmQwW2krMV0sY29vcmQxW2pdLGNvb3JkMVtqKzFdKTtpZihkaXN0PHRoaXMubWluRGlzdGFuY2Upe3RoaXMubWluRGlzdGFuY2U9ZGlzdDt2YXIgc2VnMD1uZXcganN0cy5nZW9tLkxpbmVTZWdtZW50KGNvb3JkMFtpXSxjb29yZDBbaSsxXSk7dmFyIHNlZzE9bmV3IGpzdHMuZ2VvbS5MaW5lU2VnbWVudChjb29yZDFbal0sY29vcmQxW2orMV0pO3ZhciBjbG9zZXN0UHQ9c2VnMC5jbG9zZXN0UG9pbnRzKHNlZzEpO2xvY0dlb21bMF09bmV3IGpzdHMub3BlcmF0aW9uLmRpc3RhbmNlLkdlb21ldHJ5TG9jYXRpb24obGluZTAsaSxjbG9zZXN0UHRbMF0pO2xvY0dlb21bMV09bmV3IGpzdHMub3BlcmF0aW9uLmRpc3RhbmNlLkdlb21ldHJ5TG9jYXRpb24obGluZTEsaixjbG9zZXN0UHRbMV0pO31cbmlmKHRoaXMubWluRGlzdGFuY2U8PXRoaXMudGVybWluYXRlRGlzdGFuY2Upe3JldHVybjt9fX19O2pzdHMub3BlcmF0aW9uLmRpc3RhbmNlLkRpc3RhbmNlT3AucHJvdG90eXBlLmNvbXB1dGVNaW5EaXN0YW5jZTM9ZnVuY3Rpb24obGluZSxwdCxsb2NHZW9tKXtpZihsaW5lLmdldEVudmVsb3BlSW50ZXJuYWwoKS5kaXN0YW5jZShwdC5nZXRFbnZlbG9wZUludGVybmFsKCkpPnRoaXMubWluRGlzdGFuY2Upe3JldHVybjt9XG52YXIgY29vcmQwPWxpbmUuZ2V0Q29vcmRpbmF0ZXMoKTt2YXIgY29vcmQ9cHQuZ2V0Q29vcmRpbmF0ZSgpO2Zvcih2YXIgaT0wO2k8Y29vcmQwLmxlbmd0aC0xO2krKyl7dmFyIGRpc3Q9anN0cy5hbGdvcml0aG0uQ0dBbGdvcml0aG1zLmRpc3RhbmNlUG9pbnRMaW5lKGNvb3JkLGNvb3JkMFtpXSxjb29yZDBbaSsxXSk7aWYoZGlzdDx0aGlzLm1pbkRpc3RhbmNlKXt0aGlzLm1pbkRpc3RhbmNlPWRpc3Q7dmFyIHNlZz1uZXcganN0cy5nZW9tLkxpbmVTZWdtZW50KGNvb3JkMFtpXSxjb29yZDBbaSsxXSk7dmFyIHNlZ0Nsb3Nlc3RQb2ludD1zZWcuY2xvc2VzdFBvaW50KGNvb3JkKTtsb2NHZW9tWzBdPW5ldyBqc3RzLm9wZXJhdGlvbi5kaXN0YW5jZS5HZW9tZXRyeUxvY2F0aW9uKGxpbmUsaSxzZWdDbG9zZXN0UG9pbnQpO2xvY0dlb21bMV09bmV3IGpzdHMub3BlcmF0aW9uLmRpc3RhbmNlLkdlb21ldHJ5TG9jYXRpb24ocHQsMCxjb29yZCk7fVxuaWYodGhpcy5taW5EaXN0YW5jZTw9dGhpcy50ZXJtaW5hdGVEaXN0YW5jZSl7cmV0dXJuO319fTtqc3RzLmluZGV4LnN0cnRyZWUuU0lSdHJlZT1mdW5jdGlvbihub2RlQ2FwYWNpdHkpe25vZGVDYXBhY2l0eT1ub2RlQ2FwYWNpdHl8fDEwO2pzdHMuaW5kZXguc3RydHJlZS5BYnN0cmFjdFNUUnRyZWUuY2FsbCh0aGlzLG5vZGVDYXBhY2l0eSk7fTtqc3RzLmluZGV4LnN0cnRyZWUuU0lSdHJlZS5wcm90b3R5cGU9bmV3IGpzdHMuaW5kZXguc3RydHJlZS5BYnN0cmFjdFNUUnRyZWUoKTtqc3RzLmluZGV4LnN0cnRyZWUuU0lSdHJlZS5jb25zdHJ1Y3Rvcj1qc3RzLmluZGV4LnN0cnRyZWUuU0lSdHJlZTtqc3RzLmluZGV4LnN0cnRyZWUuU0lSdHJlZS5wcm90b3R5cGUuY29tcGVyYXRvcj17Y29tcGFyZTpmdW5jdGlvbihvMSxvMil7cmV0dXJuIG8xLmdldEJvdW5kcygpLmdldENlbnRyZSgpLW8yLmdldEJvdW5kcygpLmdldENlbnRyZSgpO319O2pzdHMuaW5kZXguc3RydHJlZS5TSVJ0cmVlLnByb3RvdHlwZS5pbnRlcnNlY3Rpb25PcD17aW50ZXJzZWN0czpmdW5jdGlvbihhQm91bmRzLGJCb3VuZHMpe3JldHVybiBhQm91bmRzLmludGVyc2VjdHMoYkJvdW5kcyk7fX07anN0cy5pbmRleC5zdHJ0cmVlLlNJUnRyZWUucHJvdG90eXBlLmNyZWF0ZU5vZGU9ZnVuY3Rpb24obGV2ZWwpe3ZhciBBYnN0cmFjdE5vZGU9ZnVuY3Rpb24obGV2ZWwpe2pzdHMuaW5kZXguc3RydHJlZS5BYnN0cmFjdE5vZGUuYXBwbHkodGhpcyxhcmd1bWVudHMpO307QWJzdHJhY3ROb2RlLnByb3RvdHlwZT1uZXcganN0cy5pbmRleC5zdHJ0cmVlLkFic3RyYWN0Tm9kZSgpO0Fic3RyYWN0Tm9kZS5jb25zdHJ1Y3Rvcj1BYnN0cmFjdE5vZGU7QWJzdHJhY3ROb2RlLnByb3RvdHlwZS5jb21wdXRlQm91bmRzPWZ1bmN0aW9uKCl7dmFyIGJvdW5kcz1udWxsLGNoaWxkQm91bmRhYmxlcz10aGlzLmdldENoaWxkQm91bmRhYmxlcygpLGNoaWxkQm91bmRhYmxlO2Zvcih2YXIgaT0wLGw9Y2hpbGRCb3VuZGFibGVzLmxlbmd0aDtpPGw7aSsrKXtjaGlsZEJvdW5kYWJsZT1jaGlsZEJvdW5kYWJsZXNbaV07aWYoYm91bmRzPT09bnVsbCl7Ym91bmRzPW5ldyBqc3RzLmluZGV4LnN0cnRyZWUuSW50ZXJ2YWwoY2hpbGRCb3VuZGFibGUuZ2V0Qm91bmRzKCkpO31cbmVsc2V7Ym91bmRzLmV4cGFuZFRvSW5jbHVkZShjaGlsZEJvdW5kYWJsZS5nZXRCb3VuZHMoKSk7fX1cbnJldHVybiBib3VuZHM7fTtyZXR1cm4gQWJzdHJhY3ROb2RlO307anN0cy5pbmRleC5zdHJ0cmVlLlNJUnRyZWUucHJvdG90eXBlLmluc2VydD1mdW5jdGlvbih4MSx4MixpdGVtKXtqc3RzLmluZGV4LnN0cnRyZWUuQWJzdHJhY3RTVFJ0cmVlLnByb3RvdHlwZS5pbnNlcnQobmV3IGpzdHMuaW5kZXguc3RydHJlZS5JbnRlcnZhbChNYXRoLm1pbih4MSx4MiksTWF0aC5tYXgoeDEseDIpKSxpdGVtKTt9O2pzdHMuaW5kZXguc3RydHJlZS5TSVJ0cmVlLnByb3RvdHlwZS5xdWVyeT1mdW5jdGlvbih4MSx4Mil7eDI9eDJ8fHgxO2pzdHMuaW5kZXguc3RydHJlZS5BYnN0cmFjdFNUUnRyZWUucHJvdG90eXBlLnF1ZXJ5KG5ldyBqc3RzLmluZGV4LnN0cnRyZWUuSW50ZXJ2YWwoTWF0aC5taW4oeDEseDIpLE1hdGgubWF4KHgxLHgyKSkpO307anN0cy5pbmRleC5zdHJ0cmVlLlNJUnRyZWUucHJvdG90eXBlLmdldEludGVyc2VjdHNPcD1mdW5jdGlvbigpe3JldHVybiB0aGlzLmludGVyc2VjdGlvbk9wO307anN0cy5pbmRleC5zdHJ0cmVlLlNJUnRyZWUucHJvdG90eXBlLmdldENvbXBhcmF0b3I9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5jb21wZXJhdG9yO307anN0cy5zaW1wbGlmeS5Eb3VnbGFzUGV1Y2tlclNpbXBsaWZpZXI9ZnVuY3Rpb24oaW5wdXRHZW9tKXt0aGlzLmlucHV0R2VvbT1pbnB1dEdlb207dGhpcy5pc0Vuc3VyZVZhbGlkVG9wb2xvZ3k9dHJ1ZTt9O2pzdHMuc2ltcGxpZnkuRG91Z2xhc1BldWNrZXJTaW1wbGlmaWVyLnByb3RvdHlwZS5pbnB1dEdlb209bnVsbDtqc3RzLnNpbXBsaWZ5LkRvdWdsYXNQZXVja2VyU2ltcGxpZmllci5wcm90b3R5cGUuZGlzdGFuY2VUb2xlcmFuY2U9bnVsbDtqc3RzLnNpbXBsaWZ5LkRvdWdsYXNQZXVja2VyU2ltcGxpZmllci5wcm90b3R5cGUuaXNFbnN1cmVWYWxpZFRvcG9sb2d5PW51bGw7anN0cy5zaW1wbGlmeS5Eb3VnbGFzUGV1Y2tlclNpbXBsaWZpZXIuc2ltcGxpZnk9ZnVuY3Rpb24oZ2VvbSxkaXN0YW5jZVRvbGVyYW5jZSl7dmFyIHRzcz1uZXcganN0cy5zaW1wbGlmeS5Eb3VnbGFzUGV1Y2tlclNpbXBsaWZpZXIoZ2VvbSk7dHNzLnNldERpc3RhbmNlVG9sZXJhbmNlKGRpc3RhbmNlVG9sZXJhbmNlKTtyZXR1cm4gdHNzLmdldFJlc3VsdEdlb21ldHJ5KCk7fTtqc3RzLnNpbXBsaWZ5LkRvdWdsYXNQZXVja2VyU2ltcGxpZmllci5wcm90b3R5cGUuc2V0RGlzdGFuY2VUb2xlcmFuY2U9ZnVuY3Rpb24oZGlzdGFuY2VUb2xlcmFuY2Upe2lmKGRpc3RhbmNlVG9sZXJhbmNlPDAuMCl7dGhyb3dcIlRvbGVyYW5jZSBtdXN0IGJlIG5vbi1uZWdhdGl2ZVwiO31cbnRoaXMuZGlzdGFuY2VUb2xlcmFuY2U9ZGlzdGFuY2VUb2xlcmFuY2U7fTtqc3RzLnNpbXBsaWZ5LkRvdWdsYXNQZXVja2VyU2ltcGxpZmllci5wcm90b3R5cGUuc2V0RW5zdXJlVmFsaWQ9ZnVuY3Rpb24oaXNFbnN1cmVWYWxpZFRvcG9sb2d5KXt0aGlzLmlzRW5zdXJlVmFsaWRUb3BvbG9neT1pc0Vuc3VyZVZhbGlkVG9wb2xvZ3k7fTtqc3RzLnNpbXBsaWZ5LkRvdWdsYXNQZXVja2VyU2ltcGxpZmllci5wcm90b3R5cGUuZ2V0UmVzdWx0R2VvbWV0cnk9ZnVuY3Rpb24oKXtpZih0aGlzLmlucHV0R2VvbS5pc0VtcHR5KCkpe3JldHVybiB0aGlzLmlucHV0R2VvbS5jbG9uZSgpO31cbnJldHVybihuZXcganN0cy5zaW1wbGlmeS5EUFRyYW5zZm9ybWVyKHRoaXMuZGlzdGFuY2VUb2xlcmFuY2UsdGhpcy5pc0Vuc3VyZVZhbGlkVG9wb2xvZ3kpKS50cmFuc2Zvcm0odGhpcy5pbnB1dEdlb20pO307KGZ1bmN0aW9uKCl7anN0cy5vcGVyYXRpb24ucHJlZGljYXRlLlJlY3RhbmdsZUNvbnRhaW5zPWZ1bmN0aW9uKHJlY3RhbmdsZSl7dGhpcy5yZWN0RW52PXJlY3RhbmdsZS5nZXRFbnZlbG9wZUludGVybmFsKCk7fVxuanN0cy5vcGVyYXRpb24ucHJlZGljYXRlLlJlY3RhbmdsZUNvbnRhaW5zLmNvbnRhaW5zPWZ1bmN0aW9uKHJlY3RhbmdsZSxiKXt2YXIgcmM9bmV3IGpzdHMub3BlcmF0aW9uLnByZWRpY2F0ZS5SZWN0YW5nbGVDb250YWlucyhyZWN0YW5nbGUpO3JldHVybiByYy5jb250YWlucyhiKTt9XG5qc3RzLm9wZXJhdGlvbi5wcmVkaWNhdGUuUmVjdGFuZ2xlQ29udGFpbnMucHJvdG90eXBlLnJlY3RFbnY9bnVsbDtqc3RzLm9wZXJhdGlvbi5wcmVkaWNhdGUuUmVjdGFuZ2xlQ29udGFpbnMucHJvdG90eXBlLmNvbnRhaW5zPWZ1bmN0aW9uKGdlb20pe2lmKCF0aGlzLnJlY3RFbnYuY29udGFpbnMoZ2VvbS5nZXRFbnZlbG9wZUludGVybmFsKCkpKVxucmV0dXJuIGZhbHNlO2lmKHRoaXMuaXNDb250YWluZWRJbkJvdW5kYXJ5KGdlb20pKVxucmV0dXJuIGZhbHNlO3JldHVybiB0cnVlO31cbmpzdHMub3BlcmF0aW9uLnByZWRpY2F0ZS5SZWN0YW5nbGVDb250YWlucy5wcm90b3R5cGUuaXNDb250YWluZWRJbkJvdW5kYXJ5PWZ1bmN0aW9uKGdlb20pe2lmKGdlb20gaW5zdGFuY2VvZiBqc3RzLmdlb20uUG9seWdvbilyZXR1cm4gZmFsc2U7aWYoZ2VvbSBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5Qb2ludClyZXR1cm4gdGhpcy5pc1BvaW50Q29udGFpbmVkSW5Cb3VuZGFyeShnZW9tLmdldENvb3JkaW5hdGUoKSk7aWYoZ2VvbSBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5MaW5lU3RyaW5nKXJldHVybiB0aGlzLmlzTGluZVN0cmluZ0NvbnRhaW5lZEluQm91bmRhcnkoZ2VvbSk7Zm9yKHZhciBpPTA7aTxnZW9tLmdldE51bUdlb21ldHJpZXMoKTtpKyspe3ZhciBjb21wPWdlb20uZ2V0R2VvbWV0cnlOKGkpO2lmKCF0aGlzLmlzQ29udGFpbmVkSW5Cb3VuZGFyeShjb21wKSlcbnJldHVybiBmYWxzZTt9XG5yZXR1cm4gdHJ1ZTt9XG5qc3RzLm9wZXJhdGlvbi5wcmVkaWNhdGUuUmVjdGFuZ2xlQ29udGFpbnMucHJvdG90eXBlLmlzUG9pbnRDb250YWluZWRJbkJvdW5kYXJ5PWZ1bmN0aW9uKHB0KXtyZXR1cm4gcHQueD09dGhpcy5yZWN0RW52LmdldE1pblgoKXx8cHQueD09dGhpcy5yZWN0RW52LmdldE1heFgoKXx8cHQueT09dGhpcy5yZWN0RW52LmdldE1pblkoKXx8cHQueT09dGhpcy5yZWN0RW52LmdldE1heFkoKTt9XG5qc3RzLm9wZXJhdGlvbi5wcmVkaWNhdGUuUmVjdGFuZ2xlQ29udGFpbnMucHJvdG90eXBlLmlzTGluZVN0cmluZ0NvbnRhaW5lZEluQm91bmRhcnk9ZnVuY3Rpb24obGluZSl7dmFyIHNlcT1saW5lLmdldENvb3JkaW5hdGVTZXF1ZW5jZSgpO2Zvcih2YXIgaT0wO2k8c2VxLmxlbmd0aC0xO2krKyl7dmFyIHAwPXNlcVtpXTt2YXIgcDE9c2VxW2krMV07aWYoIXRoaXMuaXNMaW5lU2VnbWVudENvbnRhaW5lZEluQm91bmRhcnkocDAscDEpKVxucmV0dXJuIGZhbHNlO31cbnJldHVybiB0cnVlO31cbmpzdHMub3BlcmF0aW9uLnByZWRpY2F0ZS5SZWN0YW5nbGVDb250YWlucy5wcm90b3R5cGUuaXNMaW5lU2VnbWVudENvbnRhaW5lZEluQm91bmRhcnk9ZnVuY3Rpb24ocDAscDEpe2lmKHAwLmVxdWFscyhwMSkpXG5yZXR1cm4gdGhpcy5pc1BvaW50Q29udGFpbmVkSW5Cb3VuZGFyeShwMCk7aWYocDAueD09cDEueCl7aWYocDAueD09dGhpcy5yZWN0RW52LmdldE1pblgoKXx8cDAueD09dGhpcy5yZWN0RW52LmdldE1heFgoKSlcbnJldHVybiB0cnVlO31cbmVsc2UgaWYocDAueT09cDEueSl7aWYocDAueT09dGhpcy5yZWN0RW52LmdldE1pblkoKXx8cDAueT09dGhpcy5yZWN0RW52LmdldE1heFkoKSlcbnJldHVybiB0cnVlO31cbnJldHVybiBmYWxzZTt9fSkoKTsoZnVuY3Rpb24oKXt2YXIgTG9jYXRpb249anN0cy5nZW9tLkxvY2F0aW9uO3ZhciBQb3NpdGlvbj1qc3RzLmdlb21ncmFwaC5Qb3NpdGlvbjtqc3RzLmdlb21ncmFwaC5EZXB0aD1mdW5jdGlvbigpe3RoaXMuZGVwdGg9W1tdLFtdXTtmb3IodmFyIGk9MDtpPDI7aSsrKXtmb3IodmFyIGo9MDtqPDM7aisrKXt0aGlzLmRlcHRoW2ldW2pdPWpzdHMuZ2VvbWdyYXBoLkRlcHRoLk5VTExfVkFMVUU7fX19O2pzdHMuZ2VvbWdyYXBoLkRlcHRoLk5VTExfVkFMVUU9LTE7anN0cy5nZW9tZ3JhcGguRGVwdGguZGVwdGhBdExvY2F0aW9uPWZ1bmN0aW9uKGxvY2F0aW9uKXtpZihsb2NhdGlvbj09PUxvY2F0aW9uLkVYVEVSSU9SKVxucmV0dXJuIDA7aWYobG9jYXRpb249PT1Mb2NhdGlvbi5JTlRFUklPUilcbnJldHVybiAxO3JldHVybiBqc3RzLmdlb21ncmFwaC5EZXB0aC5OVUxMX1ZBTFVFO307anN0cy5nZW9tZ3JhcGguRGVwdGgucHJvdG90eXBlLmRlcHRoPW51bGw7anN0cy5nZW9tZ3JhcGguRGVwdGgucHJvdG90eXBlLmdldERlcHRoPWZ1bmN0aW9uKGdlb21JbmRleCxwb3NJbmRleCl7cmV0dXJuIHRoaXMuZGVwdGhbZ2VvbUluZGV4XVtwb3NJbmRleF07fTtqc3RzLmdlb21ncmFwaC5EZXB0aC5wcm90b3R5cGUuc2V0RGVwdGg9ZnVuY3Rpb24oZ2VvbUluZGV4LHBvc0luZGV4LGRlcHRoVmFsdWUpe3RoaXMuZGVwdGhbZ2VvbUluZGV4XVtwb3NJbmRleF09ZGVwdGhWYWx1ZTt9O2pzdHMuZ2VvbWdyYXBoLkRlcHRoLnByb3RvdHlwZS5nZXRMb2NhdGlvbj1mdW5jdGlvbihnZW9tSW5kZXgscG9zSW5kZXgpe2lmKHRoaXMuZGVwdGhbZ2VvbUluZGV4XVtwb3NJbmRleF08PTApXG5yZXR1cm4gTG9jYXRpb24uRVhURVJJT1I7cmV0dXJuIExvY2F0aW9uLklOVEVSSU9SO307anN0cy5nZW9tZ3JhcGguRGVwdGgucHJvdG90eXBlLmFkZD1mdW5jdGlvbihnZW9tSW5kZXgscG9zSW5kZXgsbG9jYXRpb24pe2lmKGxvY2F0aW9uPT09TG9jYXRpb24uSU5URVJJT1IpXG50aGlzLmRlcHRoW2dlb21JbmRleF1bcG9zSW5kZXhdKys7fTtqc3RzLmdlb21ncmFwaC5EZXB0aC5wcm90b3R5cGUuaXNOdWxsPWZ1bmN0aW9uKCl7aWYoYXJndW1lbnRzLmxlbmd0aD4wKXtyZXR1cm4gdGhpcy5pc051bGwyLmFwcGx5KHRoaXMsYXJndW1lbnRzKTt9XG5mb3IodmFyIGk9MDtpPDI7aSsrKXtmb3IodmFyIGo9MDtqPDM7aisrKXtpZih0aGlzLmRlcHRoW2ldW2pdIT09anN0cy5nZW9tZ3JhcGguRGVwdGguTlVMTF9WQUxVRSlcbnJldHVybiBmYWxzZTt9fVxucmV0dXJuIHRydWU7fTtqc3RzLmdlb21ncmFwaC5EZXB0aC5wcm90b3R5cGUuaXNOdWxsMj1mdW5jdGlvbihnZW9tSW5kZXgpe2lmKGFyZ3VtZW50cy5sZW5ndGg+MSl7cmV0dXJuIHRoaXMuaXNOdWxsMy5hcHBseSh0aGlzLGFyZ3VtZW50cyk7fVxucmV0dXJuIHRoaXMuZGVwdGhbZ2VvbUluZGV4XVsxXT09anN0cy5nZW9tZ3JhcGguRGVwdGguTlVMTF9WQUxVRTt9O2pzdHMuZ2VvbWdyYXBoLkRlcHRoLnByb3RvdHlwZS5pc051bGwzPWZ1bmN0aW9uKGdlb21JbmRleCxwb3NJbmRleCl7cmV0dXJuIHRoaXMuZGVwdGhbZ2VvbUluZGV4XVtwb3NJbmRleF09PWpzdHMuZ2VvbWdyYXBoLkRlcHRoLk5VTExfVkFMVUU7fTtqc3RzLmdlb21ncmFwaC5EZXB0aC5wcm90b3R5cGUuYWRkPWZ1bmN0aW9uKGxibCl7Zm9yKHZhciBpPTA7aTwyO2krKyl7Zm9yKHZhciBqPTE7ajwzO2orKyl7dmFyIGxvYz1sYmwuZ2V0TG9jYXRpb24oaSxqKTtpZihsb2M9PT1Mb2NhdGlvbi5FWFRFUklPUnx8bG9jPT09TG9jYXRpb24uSU5URVJJT1Ipe2lmKHRoaXMuaXNOdWxsKGksaikpe3RoaXMuZGVwdGhbaV1bal09anN0cy5nZW9tZ3JhcGguRGVwdGguZGVwdGhBdExvY2F0aW9uKGxvYyk7fWVsc2VcbnRoaXMuZGVwdGhbaV1bal0rPWpzdHMuZ2VvbWdyYXBoLkRlcHRoLmRlcHRoQXRMb2NhdGlvbihsb2MpO319fX07anN0cy5nZW9tZ3JhcGguRGVwdGgucHJvdG90eXBlLmdldERlbHRhPWZ1bmN0aW9uKGdlb21JbmRleCl7cmV0dXJuIHRoaXMuZGVwdGhbZ2VvbUluZGV4XVtQb3NpdGlvbi5SSUdIVF0tXG50aGlzLmRlcHRoW2dlb21JbmRleF1bUG9zaXRpb24uTEVGVF07fTtqc3RzLmdlb21ncmFwaC5EZXB0aC5wcm90b3R5cGUubm9ybWFsaXplPWZ1bmN0aW9uKCl7Zm9yKHZhciBpPTA7aTwyO2krKyl7aWYoIXRoaXMuaXNOdWxsKGkpKXt2YXIgbWluRGVwdGg9dGhpcy5kZXB0aFtpXVsxXTtpZih0aGlzLmRlcHRoW2ldWzJdPG1pbkRlcHRoKVxubWluRGVwdGg9dGhpcy5kZXB0aFtpXVsyXTtpZihtaW5EZXB0aDwwKVxubWluRGVwdGg9MDtmb3IodmFyIGo9MTtqPDM7aisrKXt2YXIgbmV3VmFsdWU9MDtpZih0aGlzLmRlcHRoW2ldW2pdPm1pbkRlcHRoKVxubmV3VmFsdWU9MTt0aGlzLmRlcHRoW2ldW2pdPW5ld1ZhbHVlO319fX07anN0cy5nZW9tZ3JhcGguRGVwdGgucHJvdG90eXBlLnRvU3RyaW5nPWZ1bmN0aW9uKCl7cmV0dXJuJ0E6ICcrdGhpcy5kZXB0aFswXVsxXSsnLCcrdGhpcy5kZXB0aFswXVsyXSsnIEI6ICcrXG50aGlzLmRlcHRoWzFdWzFdKycsJyt0aGlzLmRlcHRoWzFdWzJdO307fSkoKTtqc3RzLmFsZ29yaXRobS5Cb3VuZGFyeU5vZGVSdWxlPWZ1bmN0aW9uKCl7fTtqc3RzLmFsZ29yaXRobS5Cb3VuZGFyeU5vZGVSdWxlLnByb3RvdHlwZS5pc0luQm91bmRhcnk9ZnVuY3Rpb24oYm91bmRhcnlDb3VudCl7dGhyb3cgbmV3IGpzdHMuZXJyb3IuQWJzdHJhY3RNZXRob2RJbnZvY2F0aW9uRXJyb3IoKTt9O2pzdHMuYWxnb3JpdGhtLk1vZDJCb3VuZGFyeU5vZGVSdWxlPWZ1bmN0aW9uKCl7fTtqc3RzLmFsZ29yaXRobS5Nb2QyQm91bmRhcnlOb2RlUnVsZS5wcm90b3R5cGU9bmV3IGpzdHMuYWxnb3JpdGhtLkJvdW5kYXJ5Tm9kZVJ1bGUoKTtqc3RzLmFsZ29yaXRobS5Nb2QyQm91bmRhcnlOb2RlUnVsZS5wcm90b3R5cGUuaXNJbkJvdW5kYXJ5PWZ1bmN0aW9uKGJvdW5kYXJ5Q291bnQpe3JldHVybiBib3VuZGFyeUNvdW50JTI9PT0xO307anN0cy5hbGdvcml0aG0uQm91bmRhcnlOb2RlUnVsZS5NT0QyX0JPVU5EQVJZX1JVTEU9bmV3IGpzdHMuYWxnb3JpdGhtLk1vZDJCb3VuZGFyeU5vZGVSdWxlKCk7anN0cy5hbGdvcml0aG0uQm91bmRhcnlOb2RlUnVsZS5PR0NfU0ZTX0JPVU5EQVJZX1JVTEU9anN0cy5hbGdvcml0aG0uQm91bmRhcnlOb2RlUnVsZS5NT0QyX0JPVU5EQVJZX1JVTEU7anN0cy5vcGVyYXRpb24uZGlzdGFuY2UuR2VvbWV0cnlMb2NhdGlvbj1mdW5jdGlvbihjb21wb25lbnQsc2VnSW5kZXgscHQpe3RoaXMuY29tcG9uZW50PWNvbXBvbmVudDt0aGlzLnNlZ0luZGV4PXNlZ0luZGV4O3RoaXMucHQ9cHQ7fTtqc3RzLm9wZXJhdGlvbi5kaXN0YW5jZS5HZW9tZXRyeUxvY2F0aW9uLklOU0lERV9BUkVBPS0xO2pzdHMub3BlcmF0aW9uLmRpc3RhbmNlLkdlb21ldHJ5TG9jYXRpb24ucHJvdG90eXBlLmNvbXBvbmVudD1udWxsO2pzdHMub3BlcmF0aW9uLmRpc3RhbmNlLkdlb21ldHJ5TG9jYXRpb24ucHJvdG90eXBlLnNlZ0luZGV4PW51bGw7anN0cy5vcGVyYXRpb24uZGlzdGFuY2UuR2VvbWV0cnlMb2NhdGlvbi5wcm90b3R5cGUucHQ9bnVsbDtqc3RzLm9wZXJhdGlvbi5kaXN0YW5jZS5HZW9tZXRyeUxvY2F0aW9uLnByb3RvdHlwZS5nZXRHZW9tZXRyeUNvbXBvbmVudD1mdW5jdGlvbigpe3JldHVybiB0aGlzLmNvbXBvbmVudDt9O2pzdHMub3BlcmF0aW9uLmRpc3RhbmNlLkdlb21ldHJ5TG9jYXRpb24ucHJvdG90eXBlLmdldFNlZ21lbnRJbmRleD1mdW5jdGlvbigpe3JldHVybiB0aGlzLnNlZ0luZGV4O307anN0cy5vcGVyYXRpb24uZGlzdGFuY2UuR2VvbWV0cnlMb2NhdGlvbi5wcm90b3R5cGUuZ2V0Q29vcmRpbmF0ZT1mdW5jdGlvbigpe3JldHVybiB0aGlzLnB0O307anN0cy5vcGVyYXRpb24uZGlzdGFuY2UuR2VvbWV0cnlMb2NhdGlvbi5wcm90b3R5cGUuaXNJbnNpZGVBcmVhPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuc2VnSW5kZXg9PT1qc3RzLm9wZXJhdGlvbi5kaXN0YW5jZS5HZW9tZXRyeUxvY2F0aW9uLklOU0lERV9BUkVBO307anN0cy5nZW9tLnV0aWwuUG9pbnRFeHRyYWN0ZXI9ZnVuY3Rpb24ocHRzKXt0aGlzLnB0cz1wdHM7fTtqc3RzLmdlb20udXRpbC5Qb2ludEV4dHJhY3Rlci5wcm90b3R5cGU9bmV3IGpzdHMuZ2VvbS5HZW9tZXRyeUZpbHRlcigpO2pzdHMuZ2VvbS51dGlsLlBvaW50RXh0cmFjdGVyLnByb3RvdHlwZS5wdHM9bnVsbDtqc3RzLmdlb20udXRpbC5Qb2ludEV4dHJhY3Rlci5nZXRQb2ludHM9ZnVuY3Rpb24oZ2VvbSxsaXN0KXtpZihsaXN0PT09dW5kZWZpbmVkKXtsaXN0PVtdO31cbmlmKGdlb20gaW5zdGFuY2VvZiBqc3RzLmdlb20uUG9pbnQpe2xpc3QucHVzaChnZW9tKTt9ZWxzZSBpZihnZW9tIGluc3RhbmNlb2YganN0cy5nZW9tLkdlb21ldHJ5Q29sbGVjdGlvbnx8Z2VvbSBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5NdWx0aVBvaW50fHxnZW9tIGluc3RhbmNlb2YganN0cy5nZW9tLk11bHRpTGluZVN0cmluZ3x8Z2VvbSBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5NdWx0aVBvbHlnb24pe2dlb20uYXBwbHkobmV3IGpzdHMuZ2VvbS51dGlsLlBvaW50RXh0cmFjdGVyKGxpc3QpKTt9XG5yZXR1cm4gbGlzdDt9O2pzdHMuZ2VvbS51dGlsLlBvaW50RXh0cmFjdGVyLnByb3RvdHlwZS5maWx0ZXI9ZnVuY3Rpb24oZ2VvbSl7aWYoZ2VvbSBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5Qb2ludClcbnRoaXMucHRzLnB1c2goZ2VvbSk7fTsoZnVuY3Rpb24oKXt2YXIgTG9jYXRpb249anN0cy5nZW9tLkxvY2F0aW9uO2pzdHMub3BlcmF0aW9uLnJlbGF0ZS5SZWxhdGVOb2RlR3JhcGg9ZnVuY3Rpb24oKXt0aGlzLm5vZGVzPW5ldyBqc3RzLmdlb21ncmFwaC5Ob2RlTWFwKG5ldyBqc3RzLm9wZXJhdGlvbi5yZWxhdGUuUmVsYXRlTm9kZUZhY3RvcnkoKSk7fTtqc3RzLm9wZXJhdGlvbi5yZWxhdGUuUmVsYXRlTm9kZUdyYXBoLnByb3RvdHlwZS5ub2Rlcz1udWxsO2pzdHMub3BlcmF0aW9uLnJlbGF0ZS5SZWxhdGVOb2RlR3JhcGgucHJvdG90eXBlLmJ1aWxkPWZ1bmN0aW9uKGdlb21HcmFwaCl7dGhpcy5jb21wdXRlSW50ZXJzZWN0aW9uTm9kZXMoZ2VvbUdyYXBoLDApO3RoaXMuY29weU5vZGVzQW5kTGFiZWxzKGdlb21HcmFwaCwwKTt2YXIgZWVCdWlsZGVyPW5ldyBqc3RzLm9wZXJhdGlvbi5yZWxhdGUuRWRnZUVuZEJ1aWxkZXIoKTt2YXIgZWVMaXN0PWVlQnVpbGRlci5jb21wdXRlRWRnZUVuZHMoZ2VvbUdyYXBoLmdldEVkZ2VJdGVyYXRvcigpKTt0aGlzLmluc2VydEVkZ2VFbmRzKGVlTGlzdCk7fTtqc3RzLm9wZXJhdGlvbi5yZWxhdGUuUmVsYXRlTm9kZUdyYXBoLnByb3RvdHlwZS5jb21wdXRlSW50ZXJzZWN0aW9uTm9kZXM9ZnVuY3Rpb24oZ2VvbUdyYXBoLGFyZ0luZGV4KXtmb3IodmFyIGVkZ2VJdD1nZW9tR3JhcGguZ2V0RWRnZUl0ZXJhdG9yKCk7ZWRnZUl0Lmhhc05leHQoKTspe3ZhciBlPWVkZ2VJdC5uZXh0KCk7dmFyIGVMb2M9ZS5nZXRMYWJlbCgpLmdldExvY2F0aW9uKGFyZ0luZGV4KTtmb3IodmFyIGVpSXQ9ZS5nZXRFZGdlSW50ZXJzZWN0aW9uTGlzdCgpLml0ZXJhdG9yKCk7ZWlJdC5oYXNOZXh0KCk7KXt2YXIgZWk9ZWlJdC5uZXh0KCk7dmFyIG49dGhpcy5ub2Rlcy5hZGROb2RlKGVpLmNvb3JkKTtpZihlTG9jPT09TG9jYXRpb24uQk9VTkRBUlkpXG5uLnNldExhYmVsQm91bmRhcnkoYXJnSW5kZXgpO2Vsc2V7aWYobi5nZXRMYWJlbCgpLmlzTnVsbChhcmdJbmRleCkpXG5uLnNldExhYmVsKGFyZ0luZGV4LExvY2F0aW9uLklOVEVSSU9SKTt9fX19O2pzdHMub3BlcmF0aW9uLnJlbGF0ZS5SZWxhdGVOb2RlR3JhcGgucHJvdG90eXBlLmNvcHlOb2Rlc0FuZExhYmVscz1mdW5jdGlvbihnZW9tR3JhcGgsYXJnSW5kZXgpe2Zvcih2YXIgbm9kZUl0PWdlb21HcmFwaC5nZXROb2RlSXRlcmF0b3IoKTtub2RlSXQuaGFzTmV4dCgpOyl7dmFyIGdyYXBoTm9kZT1ub2RlSXQubmV4dCgpO3ZhciBuZXdOb2RlPXRoaXMubm9kZXMuYWRkTm9kZShncmFwaE5vZGUuZ2V0Q29vcmRpbmF0ZSgpKTtuZXdOb2RlLnNldExhYmVsKGFyZ0luZGV4LGdyYXBoTm9kZS5nZXRMYWJlbCgpLmdldExvY2F0aW9uKGFyZ0luZGV4KSk7fX07anN0cy5vcGVyYXRpb24ucmVsYXRlLlJlbGF0ZU5vZGVHcmFwaC5wcm90b3R5cGUuaW5zZXJ0RWRnZUVuZHM9ZnVuY3Rpb24oZWUpe2Zvcih2YXIgaT1lZS5pdGVyYXRvcigpO2kuaGFzTmV4dCgpOyl7dmFyIGU9aS5uZXh0KCk7dGhpcy5ub2Rlcy5hZGQoZSk7fX07anN0cy5vcGVyYXRpb24ucmVsYXRlLlJlbGF0ZU5vZGVHcmFwaC5wcm90b3R5cGUuZ2V0Tm9kZUl0ZXJhdG9yPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMubm9kZXMuaXRlcmF0b3IoKTt9O30pKCk7anN0cy5nZW9tZ3JhcGguaW5kZXguU2ltcGxlU3dlZXBMaW5lSW50ZXJzZWN0b3I9ZnVuY3Rpb24oKXt9O2pzdHMuZ2VvbWdyYXBoLmluZGV4LlNpbXBsZVN3ZWVwTGluZUludGVyc2VjdG9yLnByb3RvdHlwZT1uZXcganN0cy5nZW9tZ3JhcGguaW5kZXguRWRnZVNldEludGVyc2VjdG9yKCk7anN0cy5nZW9tZ3JhcGguaW5kZXguU2ltcGxlU3dlZXBMaW5lSW50ZXJzZWN0b3IucHJvdG90eXBlLmV2ZW50cz1bXTtqc3RzLmdlb21ncmFwaC5pbmRleC5TaW1wbGVTd2VlcExpbmVJbnRlcnNlY3Rvci5wcm90b3R5cGUubk92ZXJsYXBzPW51bGw7anN0cy5nZW9tZ3JhcGguaW5kZXguU2ltcGxlU3dlZXBMaW5lSW50ZXJzZWN0b3IucHJvdG90eXBlLmNvbXB1dGVJbnRlcnNlY3Rpb25zPWZ1bmN0aW9uKGVkZ2VzLHNpLHRlc3RBbGxTZWdtZW50cyl7aWYoc2kgaW5zdGFuY2VvZiBqYXZhc2NyaXB0LnV0aWwuTGlzdCl7dGhpcy5jb21wdXRlSW50ZXJzZWN0aW9uczIuYXBwbHkodGhpcyxhcmd1bWVudHMpO3JldHVybjt9XG5pZih0ZXN0QWxsU2VnbWVudHMpe3RoaXMuYWRkKGVkZ2VzLG51bGwpO31lbHNle3RoaXMuYWRkKGVkZ2VzKTt9XG50aGlzLmNvbXB1dGVJbnRlcnNlY3Rpb25zMyhzaSk7fTtqc3RzLmdlb21ncmFwaC5pbmRleC5TaW1wbGVTd2VlcExpbmVJbnRlcnNlY3Rvci5wcm90b3R5cGUuY29tcHV0ZUludGVyc2VjdGlvbnMyPWZ1bmN0aW9uKGVkZ2VzMCxlZGdlczEsc2kpe3RoaXMuYWRkKGVkZ2VzMCxlZGdlczApO3RoaXMuYWRkKGVkZ2VzMSxlZGdlczEpO3RoaXMuY29tcHV0ZUludGVyc2VjdGlvbnMzKHNpKTt9O2pzdHMuZ2VvbWdyYXBoLmluZGV4LlNpbXBsZVN3ZWVwTGluZUludGVyc2VjdG9yLnByb3RvdHlwZS5hZGQ9ZnVuY3Rpb24oZWRnZSxlZGdlU2V0KXtpZihlZGdlIGluc3RhbmNlb2YgamF2YXNjcmlwdC51dGlsLkxpc3Qpe3RoaXMuYWRkMi5hcHBseSh0aGlzLGFyZ3VtZW50cyk7cmV0dXJuO31cbnZhciBwdHM9ZWRnZS5nZXRDb29yZGluYXRlcygpO2Zvcih2YXIgaT0wO2k8cHRzLmxlbmd0aC0xO2krKyl7dmFyIHNzPW5ldyBqc3RzLmdlb21ncmFwaC5pbmRleC5Td2VlcExpbmVTZWdtZW50KGVkZ2UsaSk7dmFyIGluc2VydEV2ZW50PW5ldyBqc3RzLmdlb21ncmFwaC5pbmRleC5Td2VlcExpbmVFdmVudChzcy5nZXRNaW5YKCksc3MsZWRnZVNldCk7dGhpcy5ldmVudHMucHVzaChpbnNlcnRFdmVudCk7dGhpcy5ldmVudHMucHVzaChuZXcganN0cy5nZW9tZ3JhcGguaW5kZXguU3dlZXBMaW5lRXZlbnQoc3MuZ2V0TWF4WCgpLGluc2VydEV2ZW50KSk7fX07anN0cy5nZW9tZ3JhcGguaW5kZXguU2ltcGxlU3dlZXBMaW5lSW50ZXJzZWN0b3IucHJvdG90eXBlLmFkZDI9ZnVuY3Rpb24oZWRnZXMsZWRnZVNldCl7Zm9yKHZhciBpPWVkZ2VzLml0ZXJhdG9yKCk7aS5oYXNOZXh0KCk7KXt2YXIgZWRnZT1pLm5leHQoKTtpZihlZGdlU2V0KXt0aGlzLmFkZChlZGdlLGVkZ2VTZXQpO31lbHNle3RoaXMuYWRkKGVkZ2UsZWRnZSk7fX19O2pzdHMuZ2VvbWdyYXBoLmluZGV4LlNpbXBsZVN3ZWVwTGluZUludGVyc2VjdG9yLnByb3RvdHlwZS5wcmVwYXJlRXZlbnRzPWZ1bmN0aW9uKCl7dGhpcy5ldmVudHMuc29ydChmdW5jdGlvbihhLGIpe3JldHVybiBhLmNvbXBhcmVUbyhiKTt9KTtmb3IodmFyIGk9MDtpPHRoaXMuZXZlbnRzLmxlbmd0aDtpKyspe3ZhciBldj10aGlzLmV2ZW50c1tpXTtpZihldi5pc0RlbGV0ZSgpKXtldi5nZXRJbnNlcnRFdmVudCgpLnNldERlbGV0ZUV2ZW50SW5kZXgoaSk7fX19O2pzdHMuZ2VvbWdyYXBoLmluZGV4LlNpbXBsZVN3ZWVwTGluZUludGVyc2VjdG9yLnByb3RvdHlwZS5jb21wdXRlSW50ZXJzZWN0aW9uczM9ZnVuY3Rpb24oc2kpe3RoaXMubk92ZXJsYXBzPTA7dGhpcy5wcmVwYXJlRXZlbnRzKCk7Zm9yKHZhciBpPTA7aTx0aGlzLmV2ZW50cy5sZW5ndGg7aSsrKXt2YXIgZXY9dGhpcy5ldmVudHNbaV07aWYoZXYuaXNJbnNlcnQoKSl7dGhpcy5wcm9jZXNzT3ZlcmxhcHMoaSxldi5nZXREZWxldGVFdmVudEluZGV4KCksZXYsc2kpO319fTtqc3RzLmdlb21ncmFwaC5pbmRleC5TaW1wbGVTd2VlcExpbmVJbnRlcnNlY3Rvci5wcm90b3R5cGUucHJvY2Vzc092ZXJsYXBzPWZ1bmN0aW9uKHN0YXJ0LGVuZCxldjAsc2kpe3ZhciBzczA9ZXYwLmdldE9iamVjdCgpO2Zvcih2YXIgaT1zdGFydDtpPGVuZDtpKyspe3ZhciBldjE9dGhpcy5ldmVudHNbaV07aWYoZXYxLmlzSW5zZXJ0KCkpe3ZhciBzczE9ZXYxLmdldE9iamVjdCgpO2lmKCFldjAuaXNTYW1lTGFiZWwoZXYxKSl7c3MwLmNvbXB1dGVJbnRlcnNlY3Rpb25zKHNzMSxzaSk7dGhpcy5uT3ZlcmxhcHMrKzt9fX19XG5qc3RzLnRyaWFuZ3VsYXRlLlZvcm9ub2lEaWFncmFtQnVpbGRlcj1mdW5jdGlvbigpe3RoaXMuc2l0ZUNvb3Jkcz1udWxsO3RoaXMudG9sZXJhbmNlPTAuMDt0aGlzLnN1YmRpdj1udWxsO3RoaXMuY2xpcEVudj1udWxsO3RoaXMuZGlhZ3JhbUVudj1udWxsO307anN0cy50cmlhbmd1bGF0ZS5Wb3Jvbm9pRGlhZ3JhbUJ1aWxkZXIucHJvdG90eXBlLnNldFNpdGVzPWZ1bmN0aW9uKCl7dmFyIGFyZz1hcmd1bWVudHNbMF07aWYoYXJnIGluc3RhbmNlb2YganN0cy5nZW9tLkdlb21ldHJ5fHxhcmcgaW5zdGFuY2VvZiBqc3RzLmdlb20uQ29vcmRpbmF0ZXx8YXJnIGluc3RhbmNlb2YganN0cy5nZW9tLlBvaW50fHxhcmcgaW5zdGFuY2VvZiBqc3RzLmdlb20uTXVsdGlQb2ludHx8YXJnIGluc3RhbmNlb2YganN0cy5nZW9tLkxpbmVTdHJpbmd8fGFyZyBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5NdWx0aUxpbmVTdHJpbmd8fGFyZyBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5MaW5lYXJSaW5nfHxhcmcgaW5zdGFuY2VvZiBqc3RzLmdlb20uUG9seWdvbnx8YXJnIGluc3RhbmNlb2YganN0cy5nZW9tLk11bHRpUG9seWdvbil7dGhpcy5zZXRTaXRlc0J5R2VvbWV0cnkoYXJnKTt9ZWxzZXt0aGlzLnNldFNpdGVzQnlBcnJheShhcmcpO319O2pzdHMudHJpYW5ndWxhdGUuVm9yb25vaURpYWdyYW1CdWlsZGVyLnByb3RvdHlwZS5zZXRTaXRlc0J5R2VvbWV0cnk9ZnVuY3Rpb24oZ2VvbSl7dGhpcy5zaXRlQ29vcmRzPWpzdHMudHJpYW5ndWxhdGUuRGVsYXVuYXlUcmlhbmd1bGF0aW9uQnVpbGRlci5leHRyYWN0VW5pcXVlQ29vcmRpbmF0ZXMoZ2VvbSk7fTtqc3RzLnRyaWFuZ3VsYXRlLlZvcm9ub2lEaWFncmFtQnVpbGRlci5wcm90b3R5cGUuc2V0U2l0ZXNCeUFycmF5PWZ1bmN0aW9uKGNvb3Jkcyl7dGhpcy5zaXRlQ29vcmRzPWpzdHMudHJpYW5ndWxhdGUuRGVsYXVuYXlUcmlhbmd1bGF0aW9uQnVpbGRlci51bmlxdWUoY29vcmRzKTt9O2pzdHMudHJpYW5ndWxhdGUuVm9yb25vaURpYWdyYW1CdWlsZGVyLnByb3RvdHlwZS5zZXRDbGlwRW52ZWxvcGU9ZnVuY3Rpb24oY2xpcEVudil7dGhpcy5jbGlwRW52PWNsaXBFbnY7fTtqc3RzLnRyaWFuZ3VsYXRlLlZvcm9ub2lEaWFncmFtQnVpbGRlci5wcm90b3R5cGUuc2V0VG9sZXJhbmNlPWZ1bmN0aW9uKHRvbGVyYW5jZSlcbnt0aGlzLnRvbGVyYW5jZT10b2xlcmFuY2U7fTtqc3RzLnRyaWFuZ3VsYXRlLlZvcm9ub2lEaWFncmFtQnVpbGRlci5wcm90b3R5cGUuY3JlYXRlPWZ1bmN0aW9uKCl7aWYodGhpcy5zdWJkaXYhPT1udWxsKXtyZXR1cm47fVxudmFyIHNpdGVFbnYsZXhwYW5kQnksdmVydGljZXMsdHJpYW5ndWxhdG9yO3NpdGVFbnY9anN0cy50cmlhbmd1bGF0ZS5EZWxhdW5heVRyaWFuZ3VsYXRpb25CdWlsZGVyLmVudmVsb3BlKHRoaXMuc2l0ZUNvb3Jkcyk7dGhpcy5kaWFncmFtRW52PXNpdGVFbnY7ZXhwYW5kQnk9TWF0aC5tYXgodGhpcy5kaWFncmFtRW52LmdldFdpZHRoKCksdGhpcy5kaWFncmFtRW52LmdldEhlaWdodCgpKTt0aGlzLmRpYWdyYW1FbnYuZXhwYW5kQnkoZXhwYW5kQnkpO2lmKHRoaXMuY2xpcEVudiE9PW51bGwpe3RoaXMuZGlhZ3JhbUVudi5leHBhbmRUb0luY2x1ZGUodGhpcy5jbGlwRW52KTt9XG52ZXJ0aWNlcz1qc3RzLnRyaWFuZ3VsYXRlLkRlbGF1bmF5VHJpYW5ndWxhdGlvbkJ1aWxkZXIudG9WZXJ0aWNlcyh0aGlzLnNpdGVDb29yZHMpO3RoaXMuc3ViZGl2PW5ldyBqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlF1YWRFZGdlU3ViZGl2aXNpb24oc2l0ZUVudix0aGlzLnRvbGVyYW5jZSk7dHJpYW5ndWxhdG9yPW5ldyBqc3RzLnRyaWFuZ3VsYXRlLkluY3JlbWVudGFsRGVsYXVuYXlUcmlhbmd1bGF0b3IodGhpcy5zdWJkaXYpO3RyaWFuZ3VsYXRvci5pbnNlcnRTaXRlcyh2ZXJ0aWNlcyk7fTtqc3RzLnRyaWFuZ3VsYXRlLlZvcm9ub2lEaWFncmFtQnVpbGRlci5wcm90b3R5cGUuZ2V0U3ViZGl2aXNpb249ZnVuY3Rpb24oKXt0aGlzLmNyZWF0ZSgpO3JldHVybiB0aGlzLnN1YmRpdjt9O2pzdHMudHJpYW5ndWxhdGUuVm9yb25vaURpYWdyYW1CdWlsZGVyLnByb3RvdHlwZS5nZXREaWFncmFtPWZ1bmN0aW9uKGdlb21GYWN0KXt0aGlzLmNyZWF0ZSgpO3ZhciBwb2x5cz10aGlzLnN1YmRpdi5nZXRWb3Jvbm9pRGlhZ3JhbShnZW9tRmFjdCk7cmV0dXJuIHRoaXMuY2xpcEdlb21ldHJ5Q29sbGVjdGlvbihwb2x5cyx0aGlzLmRpYWdyYW1FbnYpO307anN0cy50cmlhbmd1bGF0ZS5Wb3Jvbm9pRGlhZ3JhbUJ1aWxkZXIucHJvdG90eXBlLmNsaXBHZW9tZXRyeUNvbGxlY3Rpb249ZnVuY3Rpb24oZ2VvbSxjbGlwRW52KXt2YXIgY2xpcFBvbHksY2xpcHBlZCxpLGlsLGcscmVzdWx0O2NsaXBQb2x5PWdlb20uZ2V0RmFjdG9yeSgpLnRvR2VvbWV0cnkoY2xpcEVudik7Y2xpcHBlZD1bXTtpPTAsaWw9Z2VvbS5nZXROdW1HZW9tZXRyaWVzKCk7Zm9yKGk7aTxpbDtpKyspe2c9Z2VvbS5nZXRHZW9tZXRyeU4oaSk7cmVzdWx0PW51bGw7aWYoY2xpcEVudi5jb250YWlucyhnLmdldEVudmVsb3BlSW50ZXJuYWwoKSkpe3Jlc3VsdD1nO31cbmVsc2UgaWYoY2xpcEVudi5pbnRlcnNlY3RzKGcuZ2V0RW52ZWxvcGVJbnRlcm5hbCgpKSl7cmVzdWx0PWNsaXBQb2x5LmludGVyc2VjdGlvbihnKTt9XG5pZihyZXN1bHQhPT1udWxsJiYhcmVzdWx0LmlzRW1wdHkoKSl7Y2xpcHBlZC5wdXNoKHJlc3VsdCk7fX1cbnJldHVybiBnZW9tLmdldEZhY3RvcnkoKS5jcmVhdGVHZW9tZXRyeUNvbGxlY3Rpb24oY2xpcHBlZCk7fTtqc3RzLm9wZXJhdGlvbi52YWxpZC5JbmRleGVkTmVzdGVkUmluZ1Rlc3Rlcj1mdW5jdGlvbihncmFwaCl7dGhpcy5ncmFwaD1ncmFwaDt0aGlzLnJpbmdzPW5ldyBqYXZhc2NyaXB0LnV0aWwuQXJyYXlMaXN0KCk7dGhpcy50b3RhbEVudj1uZXcganN0cy5nZW9tLkVudmVsb3BlKCk7dGhpcy5pbmRleD1udWxsO3RoaXMubmVzdGVkUHQ9bnVsbDt9O2pzdHMub3BlcmF0aW9uLnZhbGlkLkluZGV4ZWROZXN0ZWRSaW5nVGVzdGVyLnByb3RvdHlwZS5nZXROZXN0ZWRQb2ludD1mdW5jdGlvbigpe3JldHVybiB0aGlzLm5lc3RlZFB0O307anN0cy5vcGVyYXRpb24udmFsaWQuSW5kZXhlZE5lc3RlZFJpbmdUZXN0ZXIucHJvdG90eXBlLmFkZD1mdW5jdGlvbihyaW5nKXt0aGlzLnJpbmdzLmFkZChyaW5nKTt0aGlzLnRvdGFsRW52LmV4cGFuZFRvSW5jbHVkZShyaW5nLmdldEVudmVsb3BlSW50ZXJuYWwoKSk7fTtqc3RzLm9wZXJhdGlvbi52YWxpZC5JbmRleGVkTmVzdGVkUmluZ1Rlc3Rlci5wcm90b3R5cGUuaXNOb25OZXN0ZWQ9ZnVuY3Rpb24oKXt0aGlzLmJ1aWxkSW5kZXgoKTtmb3IodmFyIGk9MDtpPHRoaXMucmluZ3Muc2l6ZSgpO2krKyl7dmFyIGlubmVyUmluZz10aGlzLnJpbmdzLmdldChpKTt2YXIgaW5uZXJSaW5nUHRzPWlubmVyUmluZy5nZXRDb29yZGluYXRlcygpO3ZhciByZXN1bHRzPXRoaXMuaW5kZXgucXVlcnkoaW5uZXJSaW5nLmdldEVudmVsb3BlSW50ZXJuYWwoKSk7Zm9yKHZhciBqPTA7ajxyZXN1bHRzLmxlbmd0aDtqKyspe3ZhciBzZWFyY2hSaW5nPXJlc3VsdHNbal07dmFyIHNlYXJjaFJpbmdQdHM9c2VhcmNoUmluZy5nZXRDb29yZGluYXRlcygpO2lmKGlubmVyUmluZz09c2VhcmNoUmluZyl7Y29udGludWU7fVxuaWYoIWlubmVyUmluZy5nZXRFbnZlbG9wZUludGVybmFsKCkuaW50ZXJzZWN0cyhzZWFyY2hSaW5nLmdldEVudmVsb3BlSW50ZXJuYWwoKSkpe2NvbnRpbnVlO31cbnZhciBpbm5lclJpbmdQdD1qc3RzLm9wZXJhdGlvbi52YWxpZC5Jc1ZhbGlkT3AuZmluZFB0Tm90Tm9kZShpbm5lclJpbmdQdHMsc2VhcmNoUmluZyx0aGlzLmdyYXBoKTtpZihpbm5lclJpbmdQdD09bnVsbCl7Y29udGludWU7fVxudmFyIGlzSW5zaWRlPWpzdHMuYWxnb3JpdGhtLkNHQWxnb3JpdGhtcy5pc1BvaW50SW5SaW5nKGlubmVyUmluZ1B0LHNlYXJjaFJpbmdQdHMpO2lmKGlzSW5zaWRlKXt0aGlzLm5lc3RlZFB0PWlubmVyUmluZ1B0O3JldHVybiBmYWxzZTt9fX1cbnJldHVybiB0cnVlO307anN0cy5vcGVyYXRpb24udmFsaWQuSW5kZXhlZE5lc3RlZFJpbmdUZXN0ZXIucHJvdG90eXBlLmJ1aWxkSW5kZXg9ZnVuY3Rpb24oKXt0aGlzLmluZGV4PW5ldyBqc3RzLmluZGV4LnN0cnRyZWUuU1RSdHJlZSgpO2Zvcih2YXIgaT0wO2k8dGhpcy5yaW5ncy5zaXplKCk7aSsrKXt2YXIgcmluZz10aGlzLnJpbmdzLmdldChpKTt2YXIgZW52PXJpbmcuZ2V0RW52ZWxvcGVJbnRlcm5hbCgpO3RoaXMuaW5kZXguaW5zZXJ0KGVudixyaW5nKTt9fTtqc3RzLmdlb21ncmFwaC5pbmRleC5Nb25vdG9uZUNoYWluPWZ1bmN0aW9uKG1jZSxjaGFpbkluZGV4KXt0aGlzLm1jZT1tY2U7dGhpcy5jaGFpbkluZGV4PWNoYWluSW5kZXg7fTtqc3RzLmdlb21ncmFwaC5pbmRleC5Nb25vdG9uZUNoYWluLnByb3RvdHlwZS5tY2U9bnVsbDtqc3RzLmdlb21ncmFwaC5pbmRleC5Nb25vdG9uZUNoYWluLnByb3RvdHlwZS5jaGFpbkluZGV4PW51bGw7anN0cy5nZW9tZ3JhcGguaW5kZXguTW9ub3RvbmVDaGFpbi5wcm90b3R5cGUuY29tcHV0ZUludGVyc2VjdGlvbnM9ZnVuY3Rpb24obWMsc2kpe3RoaXMubWNlLmNvbXB1dGVJbnRlcnNlY3RzRm9yQ2hhaW4odGhpcy5jaGFpbkluZGV4LG1jLm1jZSxtYy5jaGFpbkluZGV4LHNpKTt9O2pzdHMubm9kaW5nLlNlZ21lbnROb2RlPWZ1bmN0aW9uKHNlZ1N0cmluZyxjb29yZCxzZWdtZW50SW5kZXgsc2VnbWVudE9jdGFudCl7dGhpcy5zZWdTdHJpbmc9c2VnU3RyaW5nO3RoaXMuY29vcmQ9bmV3IGpzdHMuZ2VvbS5Db29yZGluYXRlKGNvb3JkKTt0aGlzLnNlZ21lbnRJbmRleD1zZWdtZW50SW5kZXg7dGhpcy5zZWdtZW50T2N0YW50PXNlZ21lbnRPY3RhbnQ7dGhpcy5faXNJbnRlcmlvcj0hY29vcmQuZXF1YWxzMkQoc2VnU3RyaW5nLmdldENvb3JkaW5hdGUoc2VnbWVudEluZGV4KSk7fTtqc3RzLm5vZGluZy5TZWdtZW50Tm9kZS5wcm90b3R5cGUuc2VnU3RyaW5nPW51bGw7anN0cy5ub2RpbmcuU2VnbWVudE5vZGUucHJvdG90eXBlLmNvb3JkPW51bGw7anN0cy5ub2RpbmcuU2VnbWVudE5vZGUucHJvdG90eXBlLnNlZ21lbnRJbmRleD1udWxsO2pzdHMubm9kaW5nLlNlZ21lbnROb2RlLnByb3RvdHlwZS5zZWdtZW50T2N0YW50PW51bGw7anN0cy5ub2RpbmcuU2VnbWVudE5vZGUucHJvdG90eXBlLl9pc0ludGVyaW9yPW51bGw7anN0cy5ub2RpbmcuU2VnbWVudE5vZGUucHJvdG90eXBlLmdldENvb3JkaW5hdGU9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5jb29yZDt9O2pzdHMubm9kaW5nLlNlZ21lbnROb2RlLnByb3RvdHlwZS5pc0ludGVyaW9yPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2lzSW50ZXJpb3I7fTtqc3RzLm5vZGluZy5TZWdtZW50Tm9kZS5wcm90b3R5cGUuaXNFbmRQb2ludD1mdW5jdGlvbihtYXhTZWdtZW50SW5kZXgpe2lmKHRoaXMuc2VnbWVudEluZGV4PT09MCYmIXRoaXMuX2lzSW50ZXJpb3IpcmV0dXJuIHRydWU7aWYodGhpcy5zZWdtZW50SW5kZXg9PT10aGlzLm1heFNlZ21lbnRJbmRleClyZXR1cm4gdHJ1ZTtyZXR1cm4gZmFsc2U7fTtqc3RzLm5vZGluZy5TZWdtZW50Tm9kZS5wcm90b3R5cGUuY29tcGFyZVRvPWZ1bmN0aW9uKG9iail7dmFyIG90aGVyPW9iajtpZih0aGlzLnNlZ21lbnRJbmRleDxvdGhlci5zZWdtZW50SW5kZXgpcmV0dXJuLTE7aWYodGhpcy5zZWdtZW50SW5kZXg+b3RoZXIuc2VnbWVudEluZGV4KXJldHVybiAxO2lmKHRoaXMuY29vcmQuZXF1YWxzMkQob3RoZXIuY29vcmQpKXJldHVybiAwO3JldHVybiBqc3RzLm5vZGluZy5TZWdtZW50UG9pbnRDb21wYXJhdG9yLmNvbXBhcmUodGhpcy5zZWdtZW50T2N0YW50LHRoaXMuY29vcmQsb3RoZXIuY29vcmQpO307KGZ1bmN0aW9uKCl7anN0cy5pby5HZW9KU09OV3JpdGVyPWZ1bmN0aW9uKCl7dGhpcy5wYXJzZXI9bmV3IGpzdHMuaW8uR2VvSlNPTlBhcnNlcih0aGlzLmdlb21ldHJ5RmFjdG9yeSk7fTtqc3RzLmlvLkdlb0pTT05Xcml0ZXIucHJvdG90eXBlLndyaXRlPWZ1bmN0aW9uKGdlb21ldHJ5KXt2YXIgZ2VvSnNvbj10aGlzLnBhcnNlci53cml0ZShnZW9tZXRyeSk7cmV0dXJuIGdlb0pzb247fTt9KSgpO2pzdHMuaW8uT3BlbkxheWVyc1BhcnNlcj1mdW5jdGlvbihnZW9tZXRyeUZhY3Rvcnkpe3RoaXMuZ2VvbWV0cnlGYWN0b3J5PWdlb21ldHJ5RmFjdG9yeXx8bmV3IGpzdHMuZ2VvbS5HZW9tZXRyeUZhY3RvcnkoKTt9O2pzdHMuaW8uT3BlbkxheWVyc1BhcnNlci5wcm90b3R5cGUucmVhZD1mdW5jdGlvbihnZW9tZXRyeSl7aWYoZ2VvbWV0cnkuQ0xBU1NfTkFNRT09PSdPcGVuTGF5ZXJzLkdlb21ldHJ5LlBvaW50Jyl7cmV0dXJuIHRoaXMuY29udmVydEZyb21Qb2ludChnZW9tZXRyeSk7fWVsc2UgaWYoZ2VvbWV0cnkuQ0xBU1NfTkFNRT09PSdPcGVuTGF5ZXJzLkdlb21ldHJ5LkxpbmVTdHJpbmcnKXtyZXR1cm4gdGhpcy5jb252ZXJ0RnJvbUxpbmVTdHJpbmcoZ2VvbWV0cnkpO31lbHNlIGlmKGdlb21ldHJ5LkNMQVNTX05BTUU9PT0nT3BlbkxheWVycy5HZW9tZXRyeS5MaW5lYXJSaW5nJyl7cmV0dXJuIHRoaXMuY29udmVydEZyb21MaW5lYXJSaW5nKGdlb21ldHJ5KTt9ZWxzZSBpZihnZW9tZXRyeS5DTEFTU19OQU1FPT09J09wZW5MYXllcnMuR2VvbWV0cnkuUG9seWdvbicpe3JldHVybiB0aGlzLmNvbnZlcnRGcm9tUG9seWdvbihnZW9tZXRyeSk7fWVsc2UgaWYoZ2VvbWV0cnkuQ0xBU1NfTkFNRT09PSdPcGVuTGF5ZXJzLkdlb21ldHJ5Lk11bHRpUG9pbnQnKXtyZXR1cm4gdGhpcy5jb252ZXJ0RnJvbU11bHRpUG9pbnQoZ2VvbWV0cnkpO31lbHNlIGlmKGdlb21ldHJ5LkNMQVNTX05BTUU9PT0nT3BlbkxheWVycy5HZW9tZXRyeS5NdWx0aUxpbmVTdHJpbmcnKXtyZXR1cm4gdGhpcy5jb252ZXJ0RnJvbU11bHRpTGluZVN0cmluZyhnZW9tZXRyeSk7fWVsc2UgaWYoZ2VvbWV0cnkuQ0xBU1NfTkFNRT09PSdPcGVuTGF5ZXJzLkdlb21ldHJ5Lk11bHRpUG9seWdvbicpe3JldHVybiB0aGlzLmNvbnZlcnRGcm9tTXVsdGlQb2x5Z29uKGdlb21ldHJ5KTt9ZWxzZSBpZihnZW9tZXRyeS5DTEFTU19OQU1FPT09J09wZW5MYXllcnMuR2VvbWV0cnkuQ29sbGVjdGlvbicpe3JldHVybiB0aGlzLmNvbnZlcnRGcm9tQ29sbGVjdGlvbihnZW9tZXRyeSk7fX07anN0cy5pby5PcGVuTGF5ZXJzUGFyc2VyLnByb3RvdHlwZS5jb252ZXJ0RnJvbVBvaW50PWZ1bmN0aW9uKHBvaW50KXtyZXR1cm4gdGhpcy5nZW9tZXRyeUZhY3RvcnkuY3JlYXRlUG9pbnQobmV3IGpzdHMuZ2VvbS5Db29yZGluYXRlKHBvaW50LngscG9pbnQueSkpO307anN0cy5pby5PcGVuTGF5ZXJzUGFyc2VyLnByb3RvdHlwZS5jb252ZXJ0RnJvbUxpbmVTdHJpbmc9ZnVuY3Rpb24obGluZVN0cmluZyl7dmFyIGk7dmFyIGNvb3JkaW5hdGVzPVtdO2ZvcihpPTA7aTxsaW5lU3RyaW5nLmNvbXBvbmVudHMubGVuZ3RoO2krKyl7Y29vcmRpbmF0ZXMucHVzaChuZXcganN0cy5nZW9tLkNvb3JkaW5hdGUobGluZVN0cmluZy5jb21wb25lbnRzW2ldLngsbGluZVN0cmluZy5jb21wb25lbnRzW2ldLnkpKTt9XG5yZXR1cm4gdGhpcy5nZW9tZXRyeUZhY3RvcnkuY3JlYXRlTGluZVN0cmluZyhjb29yZGluYXRlcyk7fTtqc3RzLmlvLk9wZW5MYXllcnNQYXJzZXIucHJvdG90eXBlLmNvbnZlcnRGcm9tTGluZWFyUmluZz1mdW5jdGlvbihsaW5lYXJSaW5nKXt2YXIgaTt2YXIgY29vcmRpbmF0ZXM9W107Zm9yKGk9MDtpPGxpbmVhclJpbmcuY29tcG9uZW50cy5sZW5ndGg7aSsrKXtjb29yZGluYXRlcy5wdXNoKG5ldyBqc3RzLmdlb20uQ29vcmRpbmF0ZShsaW5lYXJSaW5nLmNvbXBvbmVudHNbaV0ueCxsaW5lYXJSaW5nLmNvbXBvbmVudHNbaV0ueSkpO31cbnJldHVybiB0aGlzLmdlb21ldHJ5RmFjdG9yeS5jcmVhdGVMaW5lYXJSaW5nKGNvb3JkaW5hdGVzKTt9O2pzdHMuaW8uT3BlbkxheWVyc1BhcnNlci5wcm90b3R5cGUuY29udmVydEZyb21Qb2x5Z29uPWZ1bmN0aW9uKHBvbHlnb24pe3ZhciBpO3ZhciBzaGVsbD1udWxsO3ZhciBob2xlcz1bXTtmb3IoaT0wO2k8cG9seWdvbi5jb21wb25lbnRzLmxlbmd0aDtpKyspe3ZhciBsaW5lYXJSaW5nPXRoaXMuY29udmVydEZyb21MaW5lYXJSaW5nKHBvbHlnb24uY29tcG9uZW50c1tpXSk7aWYoaT09PTApe3NoZWxsPWxpbmVhclJpbmc7fWVsc2V7aG9sZXMucHVzaChsaW5lYXJSaW5nKTt9fVxucmV0dXJuIHRoaXMuZ2VvbWV0cnlGYWN0b3J5LmNyZWF0ZVBvbHlnb24oc2hlbGwsaG9sZXMpO307anN0cy5pby5PcGVuTGF5ZXJzUGFyc2VyLnByb3RvdHlwZS5jb252ZXJ0RnJvbU11bHRpUG9pbnQ9ZnVuY3Rpb24obXVsdGlQb2ludCl7dmFyIGk7dmFyIHBvaW50cz1bXTtmb3IoaT0wO2k8bXVsdGlQb2ludC5jb21wb25lbnRzLmxlbmd0aDtpKyspe3BvaW50cy5wdXNoKHRoaXMuY29udmVydEZyb21Qb2ludChtdWx0aVBvaW50LmNvbXBvbmVudHNbaV0pKTt9XG5yZXR1cm4gdGhpcy5nZW9tZXRyeUZhY3RvcnkuY3JlYXRlTXVsdGlQb2ludChwb2ludHMpO307anN0cy5pby5PcGVuTGF5ZXJzUGFyc2VyLnByb3RvdHlwZS5jb252ZXJ0RnJvbU11bHRpTGluZVN0cmluZz1mdW5jdGlvbihtdWx0aUxpbmVTdHJpbmcpe3ZhciBpO3ZhciBsaW5lU3RyaW5ncz1bXTtmb3IoaT0wO2k8bXVsdGlMaW5lU3RyaW5nLmNvbXBvbmVudHMubGVuZ3RoO2krKyl7bGluZVN0cmluZ3MucHVzaCh0aGlzLmNvbnZlcnRGcm9tTGluZVN0cmluZyhtdWx0aUxpbmVTdHJpbmcuY29tcG9uZW50c1tpXSkpO31cbnJldHVybiB0aGlzLmdlb21ldHJ5RmFjdG9yeS5jcmVhdGVNdWx0aUxpbmVTdHJpbmcobGluZVN0cmluZ3MpO307anN0cy5pby5PcGVuTGF5ZXJzUGFyc2VyLnByb3RvdHlwZS5jb252ZXJ0RnJvbU11bHRpUG9seWdvbj1mdW5jdGlvbihtdWx0aVBvbHlnb24pe3ZhciBpO3ZhciBwb2x5Z29ucz1bXTtmb3IoaT0wO2k8bXVsdGlQb2x5Z29uLmNvbXBvbmVudHMubGVuZ3RoO2krKyl7cG9seWdvbnMucHVzaCh0aGlzLmNvbnZlcnRGcm9tUG9seWdvbihtdWx0aVBvbHlnb24uY29tcG9uZW50c1tpXSkpO31cbnJldHVybiB0aGlzLmdlb21ldHJ5RmFjdG9yeS5jcmVhdGVNdWx0aVBvbHlnb24ocG9seWdvbnMpO307anN0cy5pby5PcGVuTGF5ZXJzUGFyc2VyLnByb3RvdHlwZS5jb252ZXJ0RnJvbUNvbGxlY3Rpb249ZnVuY3Rpb24oY29sbGVjdGlvbil7dmFyIGk7dmFyIGdlb21ldHJpZXM9W107Zm9yKGk9MDtpPGNvbGxlY3Rpb24uY29tcG9uZW50cy5sZW5ndGg7aSsrKXtnZW9tZXRyaWVzLnB1c2godGhpcy5yZWFkKGNvbGxlY3Rpb24uY29tcG9uZW50c1tpXSkpO31cbnJldHVybiB0aGlzLmdlb21ldHJ5RmFjdG9yeS5jcmVhdGVHZW9tZXRyeUNvbGxlY3Rpb24oZ2VvbWV0cmllcyk7fTtqc3RzLmlvLk9wZW5MYXllcnNQYXJzZXIucHJvdG90eXBlLndyaXRlPWZ1bmN0aW9uKGdlb21ldHJ5KXtpZihnZW9tZXRyeS5DTEFTU19OQU1FPT09J2pzdHMuZ2VvbS5Qb2ludCcpe3JldHVybiB0aGlzLmNvbnZlcnRUb1BvaW50KGdlb21ldHJ5LmNvb3JkaW5hdGUpO31lbHNlIGlmKGdlb21ldHJ5LkNMQVNTX05BTUU9PT0nanN0cy5nZW9tLkxpbmVTdHJpbmcnKXtyZXR1cm4gdGhpcy5jb252ZXJ0VG9MaW5lU3RyaW5nKGdlb21ldHJ5KTt9ZWxzZSBpZihnZW9tZXRyeS5DTEFTU19OQU1FPT09J2pzdHMuZ2VvbS5MaW5lYXJSaW5nJyl7cmV0dXJuIHRoaXMuY29udmVydFRvTGluZWFyUmluZyhnZW9tZXRyeSk7fWVsc2UgaWYoZ2VvbWV0cnkuQ0xBU1NfTkFNRT09PSdqc3RzLmdlb20uUG9seWdvbicpe3JldHVybiB0aGlzLmNvbnZlcnRUb1BvbHlnb24oZ2VvbWV0cnkpO31lbHNlIGlmKGdlb21ldHJ5LkNMQVNTX05BTUU9PT0nanN0cy5nZW9tLk11bHRpUG9pbnQnKXtyZXR1cm4gdGhpcy5jb252ZXJ0VG9NdWx0aVBvaW50KGdlb21ldHJ5KTt9ZWxzZSBpZihnZW9tZXRyeS5DTEFTU19OQU1FPT09J2pzdHMuZ2VvbS5NdWx0aUxpbmVTdHJpbmcnKXtyZXR1cm4gdGhpcy5jb252ZXJ0VG9NdWx0aUxpbmVTdHJpbmcoZ2VvbWV0cnkpO31lbHNlIGlmKGdlb21ldHJ5LkNMQVNTX05BTUU9PT0nanN0cy5nZW9tLk11bHRpUG9seWdvbicpe3JldHVybiB0aGlzLmNvbnZlcnRUb011bHRpUG9seWdvbihnZW9tZXRyeSk7fWVsc2UgaWYoZ2VvbWV0cnkuQ0xBU1NfTkFNRT09PSdqc3RzLmdlb20uR2VvbWV0cnlDb2xsZWN0aW9uJyl7cmV0dXJuIHRoaXMuY29udmVydFRvQ29sbGVjdGlvbihnZW9tZXRyeSk7fX07anN0cy5pby5PcGVuTGF5ZXJzUGFyc2VyLnByb3RvdHlwZS5jb252ZXJ0VG9Qb2ludD1mdW5jdGlvbihjb29yZGluYXRlKXtyZXR1cm4gbmV3IE9wZW5MYXllcnMuR2VvbWV0cnkuUG9pbnQoY29vcmRpbmF0ZS54LGNvb3JkaW5hdGUueSk7fTtqc3RzLmlvLk9wZW5MYXllcnNQYXJzZXIucHJvdG90eXBlLmNvbnZlcnRUb0xpbmVTdHJpbmc9ZnVuY3Rpb24obGluZVN0cmluZyl7dmFyIGk7dmFyIHBvaW50cz1bXTtmb3IoaT0wO2k8bGluZVN0cmluZy5wb2ludHMubGVuZ3RoO2krKyl7dmFyIGNvb3JkaW5hdGU9bGluZVN0cmluZy5wb2ludHNbaV07cG9pbnRzLnB1c2godGhpcy5jb252ZXJ0VG9Qb2ludChjb29yZGluYXRlKSk7fVxucmV0dXJuIG5ldyBPcGVuTGF5ZXJzLkdlb21ldHJ5LkxpbmVTdHJpbmcocG9pbnRzKTt9O2pzdHMuaW8uT3BlbkxheWVyc1BhcnNlci5wcm90b3R5cGUuY29udmVydFRvTGluZWFyUmluZz1mdW5jdGlvbihsaW5lYXJSaW5nKXt2YXIgaTt2YXIgcG9pbnRzPVtdO2ZvcihpPTA7aTxsaW5lYXJSaW5nLnBvaW50cy5sZW5ndGg7aSsrKXt2YXIgY29vcmRpbmF0ZT1saW5lYXJSaW5nLnBvaW50c1tpXTtwb2ludHMucHVzaCh0aGlzLmNvbnZlcnRUb1BvaW50KGNvb3JkaW5hdGUpKTt9XG5yZXR1cm4gbmV3IE9wZW5MYXllcnMuR2VvbWV0cnkuTGluZWFyUmluZyhwb2ludHMpO307anN0cy5pby5PcGVuTGF5ZXJzUGFyc2VyLnByb3RvdHlwZS5jb252ZXJ0VG9Qb2x5Z29uPWZ1bmN0aW9uKHBvbHlnb24pe3ZhciBpO3ZhciByaW5ncz1bXTtyaW5ncy5wdXNoKHRoaXMuY29udmVydFRvTGluZWFyUmluZyhwb2x5Z29uLnNoZWxsKSk7Zm9yKGk9MDtpPHBvbHlnb24uaG9sZXMubGVuZ3RoO2krKyl7dmFyIHJpbmc9cG9seWdvbi5ob2xlc1tpXTtyaW5ncy5wdXNoKHRoaXMuY29udmVydFRvTGluZWFyUmluZyhyaW5nKSk7fVxucmV0dXJuIG5ldyBPcGVuTGF5ZXJzLkdlb21ldHJ5LlBvbHlnb24ocmluZ3MpO307anN0cy5pby5PcGVuTGF5ZXJzUGFyc2VyLnByb3RvdHlwZS5jb252ZXJ0VG9NdWx0aVBvaW50PWZ1bmN0aW9uKG11bHRpUG9pbnQpe3ZhciBpO3ZhciBwb2ludHM9W107Zm9yKGk9MDtpPG11bHRpUG9pbnQuZ2VvbWV0cmllcy5sZW5ndGg7aSsrKXt2YXIgY29vcmRpbmF0ZT1tdWx0aVBvaW50Lmdlb21ldHJpZXNbaV0uY29vcmRpbmF0ZTtwb2ludHMucHVzaChuZXcgT3BlbkxheWVycy5HZW9tZXRyeS5Qb2ludChjb29yZGluYXRlLngsY29vcmRpbmF0ZS55KSk7fVxucmV0dXJuIG5ldyBPcGVuTGF5ZXJzLkdlb21ldHJ5Lk11bHRpUG9pbnQocG9pbnRzKTt9O2pzdHMuaW8uT3BlbkxheWVyc1BhcnNlci5wcm90b3R5cGUuY29udmVydFRvTXVsdGlMaW5lU3RyaW5nPWZ1bmN0aW9uKG11bHRpTGluZVN0cmluZyl7dmFyIGk7dmFyIGxpbmVTdHJpbmdzPVtdO2ZvcihpPTA7aTxtdWx0aUxpbmVTdHJpbmcuZ2VvbWV0cmllcy5sZW5ndGg7aSsrKXtsaW5lU3RyaW5ncy5wdXNoKHRoaXMuY29udmVydFRvTGluZVN0cmluZyhtdWx0aUxpbmVTdHJpbmcuZ2VvbWV0cmllc1tpXSkpO31cbnJldHVybiBuZXcgT3BlbkxheWVycy5HZW9tZXRyeS5NdWx0aUxpbmVTdHJpbmcobGluZVN0cmluZ3MpO307anN0cy5pby5PcGVuTGF5ZXJzUGFyc2VyLnByb3RvdHlwZS5jb252ZXJ0VG9NdWx0aVBvbHlnb249ZnVuY3Rpb24obXVsdGlQb2x5Z29uKXt2YXIgaTt2YXIgcG9seWdvbnM9W107Zm9yKGk9MDtpPG11bHRpUG9seWdvbi5nZW9tZXRyaWVzLmxlbmd0aDtpKyspe3BvbHlnb25zLnB1c2godGhpcy5jb252ZXJ0VG9Qb2x5Z29uKG11bHRpUG9seWdvbi5nZW9tZXRyaWVzW2ldKSk7fVxucmV0dXJuIG5ldyBPcGVuTGF5ZXJzLkdlb21ldHJ5Lk11bHRpUG9seWdvbihwb2x5Z29ucyk7fTtqc3RzLmlvLk9wZW5MYXllcnNQYXJzZXIucHJvdG90eXBlLmNvbnZlcnRUb0NvbGxlY3Rpb249ZnVuY3Rpb24oZ2VvbWV0cnlDb2xsZWN0aW9uKXt2YXIgaTt2YXIgZ2VvbWV0cmllcz1bXTtmb3IoaT0wO2k8Z2VvbWV0cnlDb2xsZWN0aW9uLmdlb21ldHJpZXMubGVuZ3RoO2krKyl7dmFyIGdlb21ldHJ5PWdlb21ldHJ5Q29sbGVjdGlvbi5nZW9tZXRyaWVzW2ldO3ZhciBnZW9tZXRyeU9wZW5MYXllcnM9dGhpcy53cml0ZShnZW9tZXRyeSk7Z2VvbWV0cmllcy5wdXNoKGdlb21ldHJ5T3BlbkxheWVycyk7fVxucmV0dXJuIG5ldyBPcGVuTGF5ZXJzLkdlb21ldHJ5LkNvbGxlY3Rpb24oZ2VvbWV0cmllcyk7fTtqc3RzLmluZGV4LnF1YWR0cmVlLlF1YWR0cmVlPWZ1bmN0aW9uKCl7dGhpcy5yb290PW5ldyBqc3RzLmluZGV4LnF1YWR0cmVlLlJvb3QoKTt0aGlzLm1pbkV4dGVudD0xLjA7fTtqc3RzLmluZGV4LnF1YWR0cmVlLlF1YWR0cmVlLmVuc3VyZUV4dGVudD1mdW5jdGlvbihpdGVtRW52LG1pbkV4dGVudCl7dmFyIG1pbngsbWF4eCxtaW55LG1heHk7bWlueD1pdGVtRW52LmdldE1pblgoKTttYXh4PWl0ZW1FbnYuZ2V0TWF4WCgpO21pbnk9aXRlbUVudi5nZXRNaW5ZKCk7bWF4eT1pdGVtRW52LmdldE1heFkoKTtpZihtaW54IT09bWF4eCYmbWlueSE9PW1heHkpe3JldHVybiBpdGVtRW52O31cbmlmKG1pbng9PT1tYXh4KXttaW54PW1pbngtKG1pbkV4dGVudC8yLjApO21heHg9bWlueCsobWluRXh0ZW50LzIuMCk7fVxuaWYobWlueT09PW1heHkpe21pbnk9bWlueS0obWluRXh0ZW50LzIuMCk7bWF4eT1taW55KyhtaW5FeHRlbnQvMi4wKTt9XG5yZXR1cm4gbmV3IGpzdHMuZ2VvbS5FbnZlbG9wZShtaW54LG1heHgsbWlueSxtYXh5KTt9O2pzdHMuaW5kZXgucXVhZHRyZWUuUXVhZHRyZWUucHJvdG90eXBlLmRlcHRoPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMucm9vdC5kZXB0aCgpO307anN0cy5pbmRleC5xdWFkdHJlZS5RdWFkdHJlZS5wcm90b3R5cGUuc2l6ZT1mdW5jdGlvbigpe3JldHVybiB0aGlzLnJvb3Quc2l6ZSgpO307anN0cy5pbmRleC5xdWFkdHJlZS5RdWFkdHJlZS5wcm90b3R5cGUuaW5zZXJ0PWZ1bmN0aW9uKGl0ZW1FbnYsaXRlbSl7dGhpcy5jb2xsZWN0U3RhdHMoaXRlbUVudik7dmFyIGluc2VydEVudj1qc3RzLmluZGV4LnF1YWR0cmVlLlF1YWR0cmVlLmVuc3VyZUV4dGVudChpdGVtRW52LHRoaXMubWluRXh0ZW50KTt0aGlzLnJvb3QuaW5zZXJ0KGluc2VydEVudixpdGVtKTt9O2pzdHMuaW5kZXgucXVhZHRyZWUuUXVhZHRyZWUucHJvdG90eXBlLnJlbW92ZT1mdW5jdGlvbihpdGVtRW52LGl0ZW0pe3ZhciBwb3NFbnY9anN0cy5pbmRleC5xdWFkdHJlZS5RdWFkdHJlZS5lbnN1cmVFeHRlbnQoaXRlbUVudix0aGlzLm1pbkV4dGVudCk7cmV0dXJuIHRoaXMucm9vdC5yZW1vdmUocG9zRW52LGl0ZW0pO307anN0cy5pbmRleC5xdWFkdHJlZS5RdWFkdHJlZS5wcm90b3R5cGUucXVlcnk9ZnVuY3Rpb24oKXtpZihhcmd1bWVudHMubGVuZ3RoPT09MSl7cmV0dXJuIGpzdHMuaW5kZXgucXVhZHRyZWUuUXVhZHRyZWUucHJvdG90eXBlLnF1ZXJ5QnlFbnZlbG9wZS5hcHBseSh0aGlzLGFyZ3VtZW50cyk7fWVsc2V7anN0cy5pbmRleC5xdWFkdHJlZS5RdWFkdHJlZS5wcm90b3R5cGUucXVlcnlXaXRoVmlzaXRvci5hcHBseSh0aGlzLGFyZ3VtZW50cyk7fX07anN0cy5pbmRleC5xdWFkdHJlZS5RdWFkdHJlZS5wcm90b3R5cGUucXVlcnlCeUVudmVsb3BlPWZ1bmN0aW9uKHNlYXJjaEVudil7dmFyIHZpc2l0b3I9bmV3IGpzdHMuaW5kZXguQXJyYXlMaXN0VmlzaXRvcigpO3RoaXMucXVlcnkoc2VhcmNoRW52LHZpc2l0b3IpO3JldHVybiB2aXNpdG9yLmdldEl0ZW1zKCk7fTtqc3RzLmluZGV4LnF1YWR0cmVlLlF1YWR0cmVlLnByb3RvdHlwZS5xdWVyeVdpdGhWaXNpdG9yPWZ1bmN0aW9uKHNlYXJjaEVudix2aXNpdG9yKXt0aGlzLnJvb3QudmlzaXQoc2VhcmNoRW52LHZpc2l0b3IpO307anN0cy5pbmRleC5xdWFkdHJlZS5RdWFkdHJlZS5wcm90b3R5cGUucXVlcnlBbGw9ZnVuY3Rpb24oKXt2YXIgZm91bmRJdGVtcz1bXTtmb3VuZEl0ZW1zPXRoaXMucm9vdC5hZGRBbGxJdGVtcyhmb3VuZEl0ZW1zKTtyZXR1cm4gZm91bmRJdGVtczt9O2pzdHMuaW5kZXgucXVhZHRyZWUuUXVhZHRyZWUucHJvdG90eXBlLmNvbGxlY3RTdGF0cz1mdW5jdGlvbihpdGVtRW52KXt2YXIgZGVsWD1pdGVtRW52LmdldFdpZHRoKCk7aWYoZGVsWDx0aGlzLm1pbkV4dGVudCYmZGVsWD4wLjApe3RoaXMubWluRXh0ZW50PWRlbFg7fVxudmFyIGRlbFk9aXRlbUVudi5nZXRIZWlnaHQoKTtpZihkZWxZPHRoaXMubWluRXh0ZW50JiZkZWxZPjAuMCl7dGhpcy5taW5FeHRlbnQ9ZGVsWTt9fTtqc3RzLm9wZXJhdGlvbi5yZWxhdGUuUmVsYXRlTm9kZUZhY3Rvcnk9ZnVuY3Rpb24oKXt9O2pzdHMub3BlcmF0aW9uLnJlbGF0ZS5SZWxhdGVOb2RlRmFjdG9yeS5wcm90b3R5cGU9bmV3IGpzdHMuZ2VvbWdyYXBoLk5vZGVGYWN0b3J5KCk7anN0cy5vcGVyYXRpb24ucmVsYXRlLlJlbGF0ZU5vZGVGYWN0b3J5LnByb3RvdHlwZS5jcmVhdGVOb2RlPWZ1bmN0aW9uKGNvb3JkKXtyZXR1cm4gbmV3IGpzdHMub3BlcmF0aW9uLnJlbGF0ZS5SZWxhdGVOb2RlKGNvb3JkLG5ldyBqc3RzLm9wZXJhdGlvbi5yZWxhdGUuRWRnZUVuZEJ1bmRsZVN0YXIoKSk7fTtqc3RzLmluZGV4LnF1YWR0cmVlLktleT1mdW5jdGlvbihpdGVtRW52KXt0aGlzLnB0PW5ldyBqc3RzLmdlb20uQ29vcmRpbmF0ZSgpO3RoaXMubGV2ZWw9MDt0aGlzLmVudj1udWxsO3RoaXMuY29tcHV0ZUtleShpdGVtRW52KTt9O2pzdHMuaW5kZXgucXVhZHRyZWUuS2V5LmNvbXB1dGVRdWFkTGV2ZWw9ZnVuY3Rpb24oZW52KXt2YXIgZHgsZHksZE1heCxsZXZlbDtkeD1lbnYuZ2V0V2lkdGgoKTtkeT1lbnYuZ2V0SGVpZ2h0KCk7ZE1heD1keD5keT9keDpkeTtsZXZlbD1qc3RzLmluZGV4LkRvdWJsZUJpdHMuZXhwb25lbnQoZE1heCkrMTtyZXR1cm4gbGV2ZWw7fTtqc3RzLmluZGV4LnF1YWR0cmVlLktleS5wcm90b3R5cGUuZ2V0UG9pbnQ9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5wdDt9O2pzdHMuaW5kZXgucXVhZHRyZWUuS2V5LnByb3RvdHlwZS5nZXRMZXZlbD1mdW5jdGlvbigpe3JldHVybiB0aGlzLmxldmVsO307anN0cy5pbmRleC5xdWFkdHJlZS5LZXkucHJvdG90eXBlLmdldEVudmVsb3BlPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZW52O307anN0cy5pbmRleC5xdWFkdHJlZS5LZXkucHJvdG90eXBlLmdldENlbnRyZT1mdW5jdGlvbigpe3ZhciB4LHk7eD0odGhpcy5lbnYuZ2V0TWluWCgpK3RoaXMuZW52LmdldE1heFgoKSkvMjt5PSh0aGlzLmVudi5nZXRNaW5ZKCkrdGhpcy5lbnYuZ2V0TWF4WSgpKS8yO3JldHVybiBuZXcganN0cy5nZW9tLkNvb3JkaW5hdGUoeCx5KTt9O2pzdHMuaW5kZXgucXVhZHRyZWUuS2V5LnByb3RvdHlwZS5jb21wdXRlS2V5PWZ1bmN0aW9uKCl7aWYoYXJndW1lbnRzWzBdaW5zdGFuY2VvZiBqc3RzLmdlb20uRW52ZWxvcGUpe3RoaXMuY29tcHV0ZUtleUZyb21FbnZlbG9wZShhcmd1bWVudHNbMF0pO31lbHNle3RoaXMuY29tcHV0ZUtleUZyb21MZXZlbChhcmd1bWVudHNbMF0sYXJndW1lbnRzWzFdKTt9fTtqc3RzLmluZGV4LnF1YWR0cmVlLktleS5wcm90b3R5cGUuY29tcHV0ZUtleUZyb21FbnZlbG9wZT1mdW5jdGlvbihlbnYpe3RoaXMubGV2ZWw9anN0cy5pbmRleC5xdWFkdHJlZS5LZXkuY29tcHV0ZVF1YWRMZXZlbChlbnYpO3RoaXMuZW52PW5ldyBqc3RzLmdlb20uRW52ZWxvcGUoKTt0aGlzLmNvbXB1dGVLZXkodGhpcy5sZXZlbCxlbnYpO3doaWxlKCF0aGlzLmVudi5jb250YWlucyhlbnYpKXt0aGlzLmxldmVsKz0xO3RoaXMuY29tcHV0ZUtleSh0aGlzLmxldmVsLGVudik7fX07anN0cy5pbmRleC5xdWFkdHJlZS5LZXkucHJvdG90eXBlLmNvbXB1dGVLZXlGcm9tTGV2ZWw9ZnVuY3Rpb24obGV2ZWwsZW52KXt2YXIgcXVhZFNpemU9anN0cy5pbmRleC5Eb3VibGVCaXRzLnBvd2VyT2YyKGxldmVsKTt0aGlzLnB0Lng9TWF0aC5mbG9vcihlbnYuZ2V0TWluWCgpL3F1YWRTaXplKSpxdWFkU2l6ZTt0aGlzLnB0Lnk9TWF0aC5mbG9vcihlbnYuZ2V0TWluWSgpL3F1YWRTaXplKSpxdWFkU2l6ZTt0aGlzLmVudi5pbml0KHRoaXMucHQueCx0aGlzLnB0LngrcXVhZFNpemUsdGhpcy5wdC55LHRoaXMucHQueStcbnF1YWRTaXplKTt9O2pzdHMuZ2VvbS5Db29yZGluYXRlQXJyYXlzPWZ1bmN0aW9uKCl7dGhyb3cgbmV3IGpzdHMuZXJyb3IuQWJzdHJhY3RNZXRob2RJbnZvY2F0aW9uRXJyb3IoKTt9O2pzdHMuZ2VvbS5Db29yZGluYXRlQXJyYXlzLmNvcHlEZWVwPWZ1bmN0aW9uKCl7aWYoYXJndW1lbnRzLmxlbmd0aD09PTEpe3JldHVybiBqc3RzLmdlb20uQ29vcmRpbmF0ZUFycmF5cy5jb3B5RGVlcDEoYXJndW1lbnRzWzBdKTt9ZWxzZSBpZihhcmd1bWVudHMubGVuZ3RoPT09NSl7anN0cy5nZW9tLkNvb3JkaW5hdGVBcnJheXMuY29weURlZXAyKGFyZ3VtZW50c1swXSxhcmd1bWVudHNbMV0sYXJndW1lbnRzWzJdLGFyZ3VtZW50c1szXSxhcmd1bWVudHNbNF0pO319O2pzdHMuZ2VvbS5Db29yZGluYXRlQXJyYXlzLmNvcHlEZWVwMT1mdW5jdGlvbihjb29yZGluYXRlcyl7dmFyIGNvcHk9W107Zm9yKHZhciBpPTA7aTxjb29yZGluYXRlcy5sZW5ndGg7aSsrKXtjb3B5W2ldPW5ldyBqc3RzLmdlb20uQ29vcmRpbmF0ZShjb29yZGluYXRlc1tpXSk7fVxucmV0dXJuIGNvcHk7fTtqc3RzLmdlb20uQ29vcmRpbmF0ZUFycmF5cy5jb3B5RGVlcDI9ZnVuY3Rpb24oc3JjLHNyY1N0YXJ0LGRlc3QsZGVzdFN0YXJ0LGxlbmd0aCl7Zm9yKHZhciBpPTA7aTxsZW5ndGg7aSsrKXtkZXN0W2Rlc3RTdGFydCtpXT1uZXcganN0cy5nZW9tLkNvb3JkaW5hdGUoc3JjW3NyY1N0YXJ0K2ldKTt9fTtqc3RzLmdlb20uQ29vcmRpbmF0ZUFycmF5cy5yZW1vdmVSZXBlYXRlZFBvaW50cz1mdW5jdGlvbihjb29yZCl7dmFyIGNvb3JkTGlzdDtpZighdGhpcy5oYXNSZXBlYXRlZFBvaW50cyhjb29yZCkpe3JldHVybiBjb29yZDt9XG5jb29yZExpc3Q9bmV3IGpzdHMuZ2VvbS5Db29yZGluYXRlTGlzdChjb29yZCxmYWxzZSk7cmV0dXJuIGNvb3JkTGlzdC50b0Nvb3JkaW5hdGVBcnJheSgpO307anN0cy5nZW9tLkNvb3JkaW5hdGVBcnJheXMuaGFzUmVwZWF0ZWRQb2ludHM9ZnVuY3Rpb24oY29vcmQpe3ZhciBpO2ZvcihpPTE7aTxjb29yZC5sZW5ndGg7aSsrKXtpZihjb29yZFtpLTFdLmVxdWFscyhjb29yZFtpXSkpe3JldHVybiB0cnVlO319XG5yZXR1cm4gZmFsc2U7fTtqc3RzLmdlb20uQ29vcmRpbmF0ZUFycmF5cy5wdE5vdEluTGlzdD1mdW5jdGlvbih0ZXN0UHRzLHB0cyl7Zm9yKHZhciBpPTA7aTx0ZXN0UHRzLmxlbmd0aDtpKyspe3ZhciB0ZXN0UHQ9dGVzdFB0c1tpXTtpZihqc3RzLmdlb20uQ29vcmRpbmF0ZUFycmF5cy5pbmRleE9mKHRlc3RQdCxwdHMpPDApXG5yZXR1cm4gdGVzdFB0O31cbnJldHVybiBudWxsO307anN0cy5nZW9tLkNvb3JkaW5hdGVBcnJheXMuaW5jcmVhc2luZ0RpcmVjdGlvbj1mdW5jdGlvbihwdHMpe2Zvcih2YXIgaT0wO2k8cGFyc2VJbnQocHRzLmxlbmd0aC8yKTtpKyspe3ZhciBqPXB0cy5sZW5ndGgtMS1pO3ZhciBjb21wPXB0c1tpXS5jb21wYXJlVG8ocHRzW2pdKTtpZihjb21wIT0wKVxucmV0dXJuIGNvbXA7fVxucmV0dXJuIDE7fTtqc3RzLmdlb20uQ29vcmRpbmF0ZUFycmF5cy5taW5Db29yZGluYXRlPWZ1bmN0aW9uKGNvb3JkaW5hdGVzKXt2YXIgbWluQ29vcmQ9bnVsbDtmb3IodmFyIGk9MDtpPGNvb3JkaW5hdGVzLmxlbmd0aDtpKyspe2lmKG1pbkNvb3JkPT09bnVsbHx8bWluQ29vcmQuY29tcGFyZVRvKGNvb3JkaW5hdGVzW2ldKT4wKXttaW5Db29yZD1jb29yZGluYXRlc1tpXTt9fVxucmV0dXJuIG1pbkNvb3JkO307anN0cy5nZW9tLkNvb3JkaW5hdGVBcnJheXMuc2Nyb2xsPWZ1bmN0aW9uKGNvb3JkaW5hdGVzLGZpcnN0Q29vcmRpbmF0ZSl7dmFyIGk9anN0cy5nZW9tLkNvb3JkaW5hdGVBcnJheXMuaW5kZXhPZihmaXJzdENvb3JkaW5hdGUsY29vcmRpbmF0ZXMpO2lmKGk8MClcbnJldHVybjt2YXIgbmV3Q29vcmRpbmF0ZXM9Y29vcmRpbmF0ZXMuc2xpY2UoaSkuY29uY2F0KGNvb3JkaW5hdGVzLnNsaWNlKDAsaSkpO2ZvcihpPTA7aTxuZXdDb29yZGluYXRlcy5sZW5ndGg7aSsrKXtjb29yZGluYXRlc1tpXT1uZXdDb29yZGluYXRlc1tpXTt9fTtqc3RzLmdlb20uQ29vcmRpbmF0ZUFycmF5cy5pbmRleE9mPWZ1bmN0aW9uKGNvb3JkaW5hdGUsY29vcmRpbmF0ZXMpe2Zvcih2YXIgaT0wO2k8Y29vcmRpbmF0ZXMubGVuZ3RoO2krKyl7aWYoY29vcmRpbmF0ZS5lcXVhbHMoY29vcmRpbmF0ZXNbaV0pKXtyZXR1cm4gaTt9fVxucmV0dXJuLTE7fTtqc3RzLm9wZXJhdGlvbi5vdmVybGF5Lk1pbmltYWxFZGdlUmluZz1mdW5jdGlvbihzdGFydCxnZW9tZXRyeUZhY3Rvcnkpe2pzdHMuZ2VvbWdyYXBoLkVkZ2VSaW5nLmNhbGwodGhpcyxzdGFydCxnZW9tZXRyeUZhY3RvcnkpO307anN0cy5vcGVyYXRpb24ub3ZlcmxheS5NaW5pbWFsRWRnZVJpbmcucHJvdG90eXBlPW5ldyBqc3RzLmdlb21ncmFwaC5FZGdlUmluZygpO2pzdHMub3BlcmF0aW9uLm92ZXJsYXkuTWluaW1hbEVkZ2VSaW5nLmNvbnN0cnVjdG9yPWpzdHMub3BlcmF0aW9uLm92ZXJsYXkuTWluaW1hbEVkZ2VSaW5nO2pzdHMub3BlcmF0aW9uLm92ZXJsYXkuTWluaW1hbEVkZ2VSaW5nLnByb3RvdHlwZS5nZXROZXh0PWZ1bmN0aW9uKGRlKXtyZXR1cm4gZGUuZ2V0TmV4dE1pbigpO307anN0cy5vcGVyYXRpb24ub3ZlcmxheS5NaW5pbWFsRWRnZVJpbmcucHJvdG90eXBlLnNldEVkZ2VSaW5nPWZ1bmN0aW9uKGRlLGVyKXtkZS5zZXRNaW5FZGdlUmluZyhlcik7fTtqc3RzLnRyaWFuZ3VsYXRlLkRlbGF1bmF5VHJpYW5ndWxhdGlvbkJ1aWxkZXI9ZnVuY3Rpb24oKXt0aGlzLnNpdGVDb29yZHM9bnVsbDt0aGlzLnRvbGVyYW5jZT0wLjA7dGhpcy5zdWJkaXY9bnVsbDt9O2pzdHMudHJpYW5ndWxhdGUuRGVsYXVuYXlUcmlhbmd1bGF0aW9uQnVpbGRlci5leHRyYWN0VW5pcXVlQ29vcmRpbmF0ZXM9ZnVuY3Rpb24oZ2VvbSl7aWYoZ2VvbT09PXVuZGVmaW5lZHx8Z2VvbT09PW51bGwpe3JldHVybiBuZXcganN0cy5nZW9tLkNvb3JkaW5hdGVMaXN0KFtdLGZhbHNlKS50b0FycmF5KCk7fVxudmFyIGNvb3Jkcz1nZW9tLmdldENvb3JkaW5hdGVzKCk7cmV0dXJuIGpzdHMudHJpYW5ndWxhdGUuRGVsYXVuYXlUcmlhbmd1bGF0aW9uQnVpbGRlci51bmlxdWUoY29vcmRzKTt9O2pzdHMudHJpYW5ndWxhdGUuRGVsYXVuYXlUcmlhbmd1bGF0aW9uQnVpbGRlci51bmlxdWU9ZnVuY3Rpb24oY29vcmRzKXtjb29yZHMuc29ydChmdW5jdGlvbihhLGIpe3JldHVybiBhLmNvbXBhcmVUbyhiKTt9KTt2YXIgY29vcmRMaXN0PW5ldyBqc3RzLmdlb20uQ29vcmRpbmF0ZUxpc3QoY29vcmRzLGZhbHNlKTtyZXR1cm4gY29vcmRMaXN0LnRvQXJyYXkoKTt9O2pzdHMudHJpYW5ndWxhdGUuRGVsYXVuYXlUcmlhbmd1bGF0aW9uQnVpbGRlci50b1ZlcnRpY2VzPWZ1bmN0aW9uKGNvb3Jkcyl7dmFyIHZlcnRzPW5ldyBBcnJheShjb29yZHMubGVuZ3RoKSxpPTAsaWw9Y29vcmRzLmxlbmd0aCxjb29yZDtmb3IoaTtpPGlsO2krKyl7Y29vcmQ9Y29vcmRzW2ldO3ZlcnRzW2ldPW5ldyBqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlZlcnRleChjb29yZCk7fVxucmV0dXJuIHZlcnRzO307anN0cy50cmlhbmd1bGF0ZS5EZWxhdW5heVRyaWFuZ3VsYXRpb25CdWlsZGVyLmVudmVsb3BlPWZ1bmN0aW9uKGNvb3Jkcyl7dmFyIGVudj1uZXcganN0cy5nZW9tLkVudmVsb3BlKCksaT0wLGlsPWNvb3Jkcy5sZW5ndGg7Zm9yKGk7aTxpbDtpKyspe2Vudi5leHBhbmRUb0luY2x1ZGUoY29vcmRzW2ldKTt9XG5yZXR1cm4gZW52O307anN0cy50cmlhbmd1bGF0ZS5EZWxhdW5heVRyaWFuZ3VsYXRpb25CdWlsZGVyLnByb3RvdHlwZS5zZXRTaXRlcz1mdW5jdGlvbigpe3ZhciBhcmc9YXJndW1lbnRzWzBdO2lmKGFyZyBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5HZW9tZXRyeXx8YXJnIGluc3RhbmNlb2YganN0cy5nZW9tLkNvb3JkaW5hdGV8fGFyZyBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5Qb2ludHx8YXJnIGluc3RhbmNlb2YganN0cy5nZW9tLk11bHRpUG9pbnR8fGFyZyBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5MaW5lU3RyaW5nfHxhcmcgaW5zdGFuY2VvZiBqc3RzLmdlb20uTXVsdGlMaW5lU3RyaW5nfHxhcmcgaW5zdGFuY2VvZiBqc3RzLmdlb20uTGluZWFyUmluZ3x8YXJnIGluc3RhbmNlb2YganN0cy5nZW9tLlBvbHlnb258fGFyZyBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5NdWx0aVBvbHlnb24pe3RoaXMuc2V0U2l0ZXNGcm9tR2VvbWV0cnkoYXJnKTt9ZWxzZXt0aGlzLnNldFNpdGVzRnJvbUNvbGxlY3Rpb24oYXJnKTt9fTtqc3RzLnRyaWFuZ3VsYXRlLkRlbGF1bmF5VHJpYW5ndWxhdGlvbkJ1aWxkZXIucHJvdG90eXBlLnNldFNpdGVzRnJvbUdlb21ldHJ5PWZ1bmN0aW9uKGdlb20pe3RoaXMuc2l0ZUNvb3Jkcz1qc3RzLnRyaWFuZ3VsYXRlLkRlbGF1bmF5VHJpYW5ndWxhdGlvbkJ1aWxkZXIuZXh0cmFjdFVuaXF1ZUNvb3JkaW5hdGVzKGdlb20pO307anN0cy50cmlhbmd1bGF0ZS5EZWxhdW5heVRyaWFuZ3VsYXRpb25CdWlsZGVyLnByb3RvdHlwZS5zZXRTaXRlc0Zyb21Db2xsZWN0aW9uPWZ1bmN0aW9uKGNvb3Jkcyl7dGhpcy5zaXRlQ29vcmRzPWpzdHMudHJpYW5ndWxhdGUuRGVsYXVuYXlUcmlhbmd1bGF0aW9uQnVpbGRlci51bmlxdWUoY29vcmRzKTt9O2pzdHMudHJpYW5ndWxhdGUuRGVsYXVuYXlUcmlhbmd1bGF0aW9uQnVpbGRlci5wcm90b3R5cGUuc2V0VG9sZXJhbmNlPWZ1bmN0aW9uKHRvbGVyYW5jZSl7dGhpcy50b2xlcmFuY2U9dG9sZXJhbmNlO307anN0cy50cmlhbmd1bGF0ZS5EZWxhdW5heVRyaWFuZ3VsYXRpb25CdWlsZGVyLnByb3RvdHlwZS5jcmVhdGU9ZnVuY3Rpb24oKXtpZih0aGlzLnN1YmRpdj09PW51bGwpe3ZhciBzaXRlRW52LHZlcnRpY2VzLHRyaWFuZ3VsYXRvcjtzaXRlRW52PWpzdHMudHJpYW5ndWxhdGUuRGVsYXVuYXlUcmlhbmd1bGF0aW9uQnVpbGRlci5lbnZlbG9wZSh0aGlzLnNpdGVDb29yZHMpO3ZlcnRpY2VzPWpzdHMudHJpYW5ndWxhdGUuRGVsYXVuYXlUcmlhbmd1bGF0aW9uQnVpbGRlci50b1ZlcnRpY2VzKHRoaXMuc2l0ZUNvb3Jkcyk7dGhpcy5zdWJkaXY9bmV3IGpzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuUXVhZEVkZ2VTdWJkaXZpc2lvbihzaXRlRW52LHRoaXMudG9sZXJhbmNlKTt0cmlhbmd1bGF0b3I9bmV3IGpzdHMudHJpYW5ndWxhdGUuSW5jcmVtZW50YWxEZWxhdW5heVRyaWFuZ3VsYXRvcih0aGlzLnN1YmRpdik7dHJpYW5ndWxhdG9yLmluc2VydFNpdGVzKHZlcnRpY2VzKTt9fTtqc3RzLnRyaWFuZ3VsYXRlLkRlbGF1bmF5VHJpYW5ndWxhdGlvbkJ1aWxkZXIucHJvdG90eXBlLmdldFN1YmRpdmlzaW9uPWZ1bmN0aW9uKCl7dGhpcy5jcmVhdGUoKTtyZXR1cm4gdGhpcy5zdWJkaXY7fTtqc3RzLnRyaWFuZ3VsYXRlLkRlbGF1bmF5VHJpYW5ndWxhdGlvbkJ1aWxkZXIucHJvdG90eXBlLmdldEVkZ2VzPWZ1bmN0aW9uKGdlb21GYWN0KXt0aGlzLmNyZWF0ZSgpO3JldHVybiB0aGlzLnN1YmRpdi5nZXRFZGdlcyhnZW9tRmFjdCk7fTtqc3RzLnRyaWFuZ3VsYXRlLkRlbGF1bmF5VHJpYW5ndWxhdGlvbkJ1aWxkZXIucHJvdG90eXBlLmdldFRyaWFuZ2xlcz1mdW5jdGlvbihnZW9tRmFjdCl7dGhpcy5jcmVhdGUoKTtyZXR1cm4gdGhpcy5zdWJkaXYuZ2V0VHJpYW5nbGVzKGdlb21GYWN0KTt9O2pzdHMuYWxnb3JpdGhtLlJheUNyb3NzaW5nQ291bnRlcj1mdW5jdGlvbihwKXt0aGlzLnA9cDt9O2pzdHMuYWxnb3JpdGhtLlJheUNyb3NzaW5nQ291bnRlci5sb2NhdGVQb2ludEluUmluZz1mdW5jdGlvbihwLHJpbmcpe3ZhciBjb3VudGVyPW5ldyBqc3RzLmFsZ29yaXRobS5SYXlDcm9zc2luZ0NvdW50ZXIocCk7Zm9yKHZhciBpPTE7aTxyaW5nLmxlbmd0aDtpKyspe3ZhciBwMT1yaW5nW2ldO3ZhciBwMj1yaW5nW2ktMV07Y291bnRlci5jb3VudFNlZ21lbnQocDEscDIpO2lmKGNvdW50ZXIuaXNPblNlZ21lbnQoKSlcbnJldHVybiBjb3VudGVyLmdldExvY2F0aW9uKCk7fVxucmV0dXJuIGNvdW50ZXIuZ2V0TG9jYXRpb24oKTt9O2pzdHMuYWxnb3JpdGhtLlJheUNyb3NzaW5nQ291bnRlci5wcm90b3R5cGUucD1udWxsO2pzdHMuYWxnb3JpdGhtLlJheUNyb3NzaW5nQ291bnRlci5wcm90b3R5cGUuY3Jvc3NpbmdDb3VudD0wO2pzdHMuYWxnb3JpdGhtLlJheUNyb3NzaW5nQ291bnRlci5wcm90b3R5cGUuaXNQb2ludE9uU2VnbWVudD1mYWxzZTtqc3RzLmFsZ29yaXRobS5SYXlDcm9zc2luZ0NvdW50ZXIucHJvdG90eXBlLmNvdW50U2VnbWVudD1mdW5jdGlvbihwMSxwMil7aWYocDEueDx0aGlzLnAueCYmcDIueDx0aGlzLnAueClcbnJldHVybjtpZih0aGlzLnAueD09cDIueCYmdGhpcy5wLnk9PT1wMi55KXt0aGlzLmlzUG9pbnRPblNlZ21lbnQ9dHJ1ZTtyZXR1cm47fVxuaWYocDEueT09PXRoaXMucC55JiZwMi55PT09dGhpcy5wLnkpe3ZhciBtaW54PXAxLng7dmFyIG1heHg9cDIueDtpZihtaW54Pm1heHgpe21pbng9cDIueDttYXh4PXAxLng7fVxuaWYodGhpcy5wLng+PW1pbngmJnRoaXMucC54PD1tYXh4KXt0aGlzLmlzUG9pbnRPblNlZ21lbnQ9dHJ1ZTt9XG5yZXR1cm47fVxuaWYoKChwMS55PnRoaXMucC55KSYmKHAyLnk8PXRoaXMucC55KSl8fCgocDIueT50aGlzLnAueSkmJihwMS55PD10aGlzLnAueSkpKXt2YXIgeDE9cDEueC10aGlzLnAueDt2YXIgeTE9cDEueS10aGlzLnAueTt2YXIgeDI9cDIueC10aGlzLnAueDt2YXIgeTI9cDIueS10aGlzLnAueTt2YXIgeEludFNpZ249anN0cy5hbGdvcml0aG0uUm9idXN0RGV0ZXJtaW5hbnQuc2lnbk9mRGV0MngyKHgxLHkxLHgyLHkyKTtpZih4SW50U2lnbj09PTAuMCl7dGhpcy5pc1BvaW50T25TZWdtZW50PXRydWU7cmV0dXJuO31cbmlmKHkyPHkxKVxueEludFNpZ249LXhJbnRTaWduO2lmKHhJbnRTaWduPjAuMCl7dGhpcy5jcm9zc2luZ0NvdW50Kys7fX19O2pzdHMuYWxnb3JpdGhtLlJheUNyb3NzaW5nQ291bnRlci5wcm90b3R5cGUuaXNPblNlZ21lbnQ9ZnVuY3Rpb24oKXtyZXR1cm4ganN0cy5nZW9tLmlzUG9pbnRPblNlZ21lbnQ7fTtqc3RzLmFsZ29yaXRobS5SYXlDcm9zc2luZ0NvdW50ZXIucHJvdG90eXBlLmdldExvY2F0aW9uPWZ1bmN0aW9uKCl7aWYodGhpcy5pc1BvaW50T25TZWdtZW50KVxucmV0dXJuIGpzdHMuZ2VvbS5Mb2NhdGlvbi5CT1VOREFSWTtpZigodGhpcy5jcm9zc2luZ0NvdW50JTIpPT09MSl7cmV0dXJuIGpzdHMuZ2VvbS5Mb2NhdGlvbi5JTlRFUklPUjt9XG5yZXR1cm4ganN0cy5nZW9tLkxvY2F0aW9uLkVYVEVSSU9SO307anN0cy5hbGdvcml0aG0uUmF5Q3Jvc3NpbmdDb3VudGVyLnByb3RvdHlwZS5pc1BvaW50SW5Qb2x5Z29uPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZ2V0TG9jYXRpb24oKSE9PWpzdHMuZ2VvbS5Mb2NhdGlvbi5FWFRFUklPUjt9O2pzdHMub3BlcmF0aW9uLkJvdW5kYXJ5T3A9ZnVuY3Rpb24oZ2VvbSxiblJ1bGUpe3RoaXMuZ2VvbT1nZW9tO3RoaXMuZ2VvbUZhY3Q9Z2VvbS5nZXRGYWN0b3J5KCk7dGhpcy5iblJ1bGU9Ym5SdWxlfHxqc3RzLmFsZ29yaXRobS5Cb3VuZGFyeU5vZGVSdWxlLk1PRDJfQk9VTkRBUllfUlVMRTt9O2pzdHMub3BlcmF0aW9uLkJvdW5kYXJ5T3AucHJvdG90eXBlLmdlb209bnVsbDtqc3RzLm9wZXJhdGlvbi5Cb3VuZGFyeU9wLnByb3RvdHlwZS5nZW9tRmFjdD1udWxsO2pzdHMub3BlcmF0aW9uLkJvdW5kYXJ5T3AucHJvdG90eXBlLmJuUnVsZT1udWxsO2pzdHMub3BlcmF0aW9uLkJvdW5kYXJ5T3AucHJvdG90eXBlLmdldEJvdW5kYXJ5PWZ1bmN0aW9uKCl7aWYodGhpcy5nZW9tIGluc3RhbmNlb2YganN0cy5nZW9tLkxpbmVTdHJpbmcpcmV0dXJuIHRoaXMuYm91bmRhcnlMaW5lU3RyaW5nKHRoaXMuZ2VvbSk7aWYodGhpcy5nZW9tIGluc3RhbmNlb2YganN0cy5nZW9tLk11bHRpTGluZVN0cmluZylyZXR1cm4gdGhpcy5ib3VuZGFyeU11bHRpTGluZVN0cmluZyh0aGlzLmdlb20pO3JldHVybiB0aGlzLmdlb20uZ2V0Qm91bmRhcnkoKTt9O2pzdHMub3BlcmF0aW9uLkJvdW5kYXJ5T3AucHJvdG90eXBlLmdldEVtcHR5TXVsdGlQb2ludD1mdW5jdGlvbigpe3JldHVybiB0aGlzLmdlb21GYWN0LmNyZWF0ZU11bHRpUG9pbnQobnVsbCk7fTtqc3RzLm9wZXJhdGlvbi5Cb3VuZGFyeU9wLnByb3RvdHlwZS5ib3VuZGFyeU11bHRpTGluZVN0cmluZz1mdW5jdGlvbihtTGluZSl7aWYodGhpcy5nZW9tLmlzRW1wdHkoKSl7cmV0dXJuIHRoaXMuZ2V0RW1wdHlNdWx0aVBvaW50KCk7fVxudmFyIGJkeVB0cz10aGlzLmNvbXB1dGVCb3VuZGFyeUNvb3JkaW5hdGVzKG1MaW5lKTtpZihiZHlQdHMubGVuZ3RoPT0xKXtyZXR1cm4gdGhpcy5nZW9tRmFjdC5jcmVhdGVQb2ludChiZHlQdHNbMF0pO31cbnJldHVybiB0aGlzLmdlb21GYWN0LmNyZWF0ZU11bHRpUG9pbnQoYmR5UHRzKTt9O2pzdHMub3BlcmF0aW9uLkJvdW5kYXJ5T3AucHJvdG90eXBlLmVuZHBvaW50cz1udWxsO2pzdHMub3BlcmF0aW9uLkJvdW5kYXJ5T3AucHJvdG90eXBlLmNvbXB1dGVCb3VuZGFyeUNvb3JkaW5hdGVzPWZ1bmN0aW9uKG1MaW5lKXt2YXIgaSxsaW5lLGVuZHBvaW50LGJkeVB0cz1bXTt0aGlzLmVuZHBvaW50cz1bXTtmb3IoaT0wO2k8bUxpbmUuZ2V0TnVtR2VvbWV0cmllcygpO2krKyl7bGluZT1tTGluZS5nZXRHZW9tZXRyeU4oaSk7aWYobGluZS5nZXROdW1Qb2ludHMoKT09MClcbmNvbnRpbnVlO3RoaXMuYWRkRW5kcG9pbnQobGluZS5nZXRDb29yZGluYXRlTigwKSk7dGhpcy5hZGRFbmRwb2ludChsaW5lLmdldENvb3JkaW5hdGVOKGxpbmUuZ2V0TnVtUG9pbnRzKCktMSkpO31cbmZvcihpPTA7aTx0aGlzLmVuZHBvaW50cy5sZW5ndGg7aSsrKXtlbmRwb2ludD10aGlzLmVuZHBvaW50c1tpXTtpZih0aGlzLmJuUnVsZS5pc0luQm91bmRhcnkoZW5kcG9pbnQuY291bnQpKXtiZHlQdHMucHVzaChlbmRwb2ludC5jb29yZGluYXRlKTt9fVxucmV0dXJuIGJkeVB0czt9O2pzdHMub3BlcmF0aW9uLkJvdW5kYXJ5T3AucHJvdG90eXBlLmFkZEVuZHBvaW50PWZ1bmN0aW9uKHB0KXt2YXIgaSxlbmRwb2ludCxmb3VuZD1mYWxzZTtmb3IoaT0wO2k8dGhpcy5lbmRwb2ludHMubGVuZ3RoO2krKyl7ZW5kcG9pbnQ9dGhpcy5lbmRwb2ludHNbaV07aWYoZW5kcG9pbnQuY29vcmRpbmF0ZS5lcXVhbHMocHQpKXtmb3VuZD10cnVlO2JyZWFrO319XG5pZighZm91bmQpe2VuZHBvaW50PXt9O2VuZHBvaW50LmNvb3JkaW5hdGU9cHQ7ZW5kcG9pbnQuY291bnQ9MDt0aGlzLmVuZHBvaW50cy5wdXNoKGVuZHBvaW50KTt9XG5lbmRwb2ludC5jb3VudCsrO307anN0cy5vcGVyYXRpb24uQm91bmRhcnlPcC5wcm90b3R5cGUuYm91bmRhcnlMaW5lU3RyaW5nPWZ1bmN0aW9uKGxpbmUpe2lmKHRoaXMuZ2VvbS5pc0VtcHR5KCkpe3JldHVybiB0aGlzLmdldEVtcHR5TXVsdGlQb2ludCgpO31cbmlmKGxpbmUuaXNDbG9zZWQoKSl7dmFyIGNsb3NlZEVuZHBvaW50T25Cb3VuZGFyeT10aGlzLmJuUnVsZS5pc0luQm91bmRhcnkoMik7aWYoY2xvc2VkRW5kcG9pbnRPbkJvdW5kYXJ5KXtyZXR1cm4gbGluZS5nZXRTdGFydFBvaW50KCk7fVxuZWxzZXtyZXR1cm4gdGhpcy5nZW9tRmFjdC5jcmVhdGVNdWx0aVBvaW50KG51bGwpO319XG5yZXR1cm4gdGhpcy5nZW9tRmFjdC5jcmVhdGVNdWx0aVBvaW50KFtsaW5lLmdldFN0YXJ0UG9pbnQoKSxsaW5lLmdldEVuZFBvaW50KCldKTt9O2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5PZmZzZXRDdXJ2ZVNldEJ1aWxkZXI9ZnVuY3Rpb24oaW5wdXRHZW9tLGRpc3RhbmNlLGN1cnZlQnVpbGRlcil7dGhpcy5pbnB1dEdlb209aW5wdXRHZW9tO3RoaXMuZGlzdGFuY2U9ZGlzdGFuY2U7dGhpcy5jdXJ2ZUJ1aWxkZXI9Y3VydmVCdWlsZGVyO3RoaXMuY3VydmVMaXN0PW5ldyBqYXZhc2NyaXB0LnV0aWwuQXJyYXlMaXN0KCk7fTtqc3RzLm9wZXJhdGlvbi5idWZmZXIuT2Zmc2V0Q3VydmVTZXRCdWlsZGVyLnByb3RvdHlwZS5pbnB1dEdlb209bnVsbDtqc3RzLm9wZXJhdGlvbi5idWZmZXIuT2Zmc2V0Q3VydmVTZXRCdWlsZGVyLnByb3RvdHlwZS5kaXN0YW5jZT1udWxsO2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5PZmZzZXRDdXJ2ZVNldEJ1aWxkZXIucHJvdG90eXBlLmN1cnZlQnVpbGRlcj1udWxsO2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5PZmZzZXRDdXJ2ZVNldEJ1aWxkZXIucHJvdG90eXBlLmN1cnZlTGlzdD1udWxsO2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5PZmZzZXRDdXJ2ZVNldEJ1aWxkZXIucHJvdG90eXBlLmdldEN1cnZlcz1mdW5jdGlvbigpe3RoaXMuYWRkKHRoaXMuaW5wdXRHZW9tKTtyZXR1cm4gdGhpcy5jdXJ2ZUxpc3Q7fTtqc3RzLm9wZXJhdGlvbi5idWZmZXIuT2Zmc2V0Q3VydmVTZXRCdWlsZGVyLnByb3RvdHlwZS5hZGRDdXJ2ZT1mdW5jdGlvbihjb29yZCxsZWZ0TG9jLHJpZ2h0TG9jKXtpZihjb29yZD09bnVsbHx8Y29vcmQubGVuZ3RoPDIpXG5yZXR1cm47dmFyIGU9bmV3IGpzdHMubm9kaW5nLk5vZGVkU2VnbWVudFN0cmluZyhjb29yZCxuZXcganN0cy5nZW9tZ3JhcGguTGFiZWwoMCxqc3RzLmdlb20uTG9jYXRpb24uQk9VTkRBUlksbGVmdExvYyxyaWdodExvYykpO3RoaXMuY3VydmVMaXN0LmFkZChlKTt9O2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5PZmZzZXRDdXJ2ZVNldEJ1aWxkZXIucHJvdG90eXBlLmFkZD1mdW5jdGlvbihnKXtpZihnLmlzRW1wdHkoKSlcbnJldHVybjtpZihnIGluc3RhbmNlb2YganN0cy5nZW9tLlBvbHlnb24pXG50aGlzLmFkZFBvbHlnb24oZyk7ZWxzZSBpZihnIGluc3RhbmNlb2YganN0cy5nZW9tLkxpbmVTdHJpbmcpXG50aGlzLmFkZExpbmVTdHJpbmcoZyk7ZWxzZSBpZihnIGluc3RhbmNlb2YganN0cy5nZW9tLlBvaW50KVxudGhpcy5hZGRQb2ludChnKTtlbHNlIGlmKGcgaW5zdGFuY2VvZiBqc3RzLmdlb20uTXVsdGlQb2ludClcbnRoaXMuYWRkQ29sbGVjdGlvbihnKTtlbHNlIGlmKGcgaW5zdGFuY2VvZiBqc3RzLmdlb20uTXVsdGlMaW5lU3RyaW5nKVxudGhpcy5hZGRDb2xsZWN0aW9uKGcpO2Vsc2UgaWYoZyBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5NdWx0aVBvbHlnb24pXG50aGlzLmFkZENvbGxlY3Rpb24oZyk7ZWxzZSBpZihnIGluc3RhbmNlb2YganN0cy5nZW9tLkdlb21ldHJ5Q29sbGVjdGlvbilcbnRoaXMuYWRkQ29sbGVjdGlvbihnKTtlbHNlXG50aHJvdyBuZXcganN0cy5lcnJvci5JbGxlZ2FsQXJndW1lbnRFcnJvcigpO307anN0cy5vcGVyYXRpb24uYnVmZmVyLk9mZnNldEN1cnZlU2V0QnVpbGRlci5wcm90b3R5cGUuYWRkQ29sbGVjdGlvbj1mdW5jdGlvbihnYyl7Zm9yKHZhciBpPTA7aTxnYy5nZXROdW1HZW9tZXRyaWVzKCk7aSsrKXt2YXIgZz1nYy5nZXRHZW9tZXRyeU4oaSk7dGhpcy5hZGQoZyk7fX07anN0cy5vcGVyYXRpb24uYnVmZmVyLk9mZnNldEN1cnZlU2V0QnVpbGRlci5wcm90b3R5cGUuYWRkUG9pbnQ9ZnVuY3Rpb24ocCl7aWYodGhpcy5kaXN0YW5jZTw9MC4wKVxucmV0dXJuO3ZhciBjb29yZD1wLmdldENvb3JkaW5hdGVzKCk7dmFyIGN1cnZlPXRoaXMuY3VydmVCdWlsZGVyLmdldExpbmVDdXJ2ZShjb29yZCx0aGlzLmRpc3RhbmNlKTt0aGlzLmFkZEN1cnZlKGN1cnZlLGpzdHMuZ2VvbS5Mb2NhdGlvbi5FWFRFUklPUixqc3RzLmdlb20uTG9jYXRpb24uSU5URVJJT1IpO307anN0cy5vcGVyYXRpb24uYnVmZmVyLk9mZnNldEN1cnZlU2V0QnVpbGRlci5wcm90b3R5cGUuYWRkTGluZVN0cmluZz1mdW5jdGlvbihsaW5lKXtpZih0aGlzLmRpc3RhbmNlPD0wLjAmJiF0aGlzLmN1cnZlQnVpbGRlci5nZXRCdWZmZXJQYXJhbWV0ZXJzKCkuaXNTaW5nbGVTaWRlZCgpKVxucmV0dXJuO3ZhciBjb29yZD1qc3RzLmdlb20uQ29vcmRpbmF0ZUFycmF5cy5yZW1vdmVSZXBlYXRlZFBvaW50cyhsaW5lLmdldENvb3JkaW5hdGVzKCkpO3ZhciBjdXJ2ZT10aGlzLmN1cnZlQnVpbGRlci5nZXRMaW5lQ3VydmUoY29vcmQsdGhpcy5kaXN0YW5jZSk7dGhpcy5hZGRDdXJ2ZShjdXJ2ZSxqc3RzLmdlb20uTG9jYXRpb24uRVhURVJJT1IsanN0cy5nZW9tLkxvY2F0aW9uLklOVEVSSU9SKTt9O2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5PZmZzZXRDdXJ2ZVNldEJ1aWxkZXIucHJvdG90eXBlLmFkZFBvbHlnb249ZnVuY3Rpb24ocCl7dmFyIG9mZnNldERpc3RhbmNlPXRoaXMuZGlzdGFuY2U7dmFyIG9mZnNldFNpZGU9anN0cy5nZW9tZ3JhcGguUG9zaXRpb24uTEVGVDtpZih0aGlzLmRpc3RhbmNlPDAuMCl7b2Zmc2V0RGlzdGFuY2U9LXRoaXMuZGlzdGFuY2U7b2Zmc2V0U2lkZT1qc3RzLmdlb21ncmFwaC5Qb3NpdGlvbi5SSUdIVDt9XG52YXIgc2hlbGw9cC5nZXRFeHRlcmlvclJpbmcoKTt2YXIgc2hlbGxDb29yZD1qc3RzLmdlb20uQ29vcmRpbmF0ZUFycmF5cy5yZW1vdmVSZXBlYXRlZFBvaW50cyhzaGVsbC5nZXRDb29yZGluYXRlcygpKTtpZih0aGlzLmRpc3RhbmNlPDAuMCYmdGhpcy5pc0Vyb2RlZENvbXBsZXRlbHkoc2hlbGwsdGhpcy5kaXN0YW5jZSkpXG5yZXR1cm47aWYodGhpcy5kaXN0YW5jZTw9MC4wJiZzaGVsbENvb3JkLmxlbmd0aDwzKVxucmV0dXJuO3RoaXMuYWRkUG9seWdvblJpbmcoc2hlbGxDb29yZCxvZmZzZXREaXN0YW5jZSxvZmZzZXRTaWRlLGpzdHMuZ2VvbS5Mb2NhdGlvbi5FWFRFUklPUixqc3RzLmdlb20uTG9jYXRpb24uSU5URVJJT1IpO2Zvcih2YXIgaT0wO2k8cC5nZXROdW1JbnRlcmlvclJpbmcoKTtpKyspe3ZhciBob2xlPXAuZ2V0SW50ZXJpb3JSaW5nTihpKTt2YXIgaG9sZUNvb3JkPWpzdHMuZ2VvbS5Db29yZGluYXRlQXJyYXlzLnJlbW92ZVJlcGVhdGVkUG9pbnRzKGhvbGUuZ2V0Q29vcmRpbmF0ZXMoKSk7aWYodGhpcy5kaXN0YW5jZT4wLjAmJnRoaXMuaXNFcm9kZWRDb21wbGV0ZWx5KGhvbGUsLXRoaXMuZGlzdGFuY2UpKVxuY29udGludWU7dGhpcy5hZGRQb2x5Z29uUmluZyhob2xlQ29vcmQsb2Zmc2V0RGlzdGFuY2UsanN0cy5nZW9tZ3JhcGguUG9zaXRpb24ub3Bwb3NpdGUob2Zmc2V0U2lkZSksanN0cy5nZW9tLkxvY2F0aW9uLklOVEVSSU9SLGpzdHMuZ2VvbS5Mb2NhdGlvbi5FWFRFUklPUik7fX07anN0cy5vcGVyYXRpb24uYnVmZmVyLk9mZnNldEN1cnZlU2V0QnVpbGRlci5wcm90b3R5cGUuYWRkUG9seWdvblJpbmc9ZnVuY3Rpb24oY29vcmQsb2Zmc2V0RGlzdGFuY2Usc2lkZSxjd0xlZnRMb2MsY3dSaWdodExvYyl7aWYob2Zmc2V0RGlzdGFuY2U9PTAuMCYmY29vcmQubGVuZ3RoPGpzdHMuZ2VvbS5MaW5lYXJSaW5nLk1JTklNVU1fVkFMSURfU0laRSlcbnJldHVybjt2YXIgbGVmdExvYz1jd0xlZnRMb2M7dmFyIHJpZ2h0TG9jPWN3UmlnaHRMb2M7aWYoY29vcmQubGVuZ3RoPj1qc3RzLmdlb20uTGluZWFyUmluZy5NSU5JTVVNX1ZBTElEX1NJWkUmJmpzdHMuYWxnb3JpdGhtLkNHQWxnb3JpdGhtcy5pc0NDVyhjb29yZCkpe2xlZnRMb2M9Y3dSaWdodExvYztyaWdodExvYz1jd0xlZnRMb2M7c2lkZT1qc3RzLmdlb21ncmFwaC5Qb3NpdGlvbi5vcHBvc2l0ZShzaWRlKTt9XG52YXIgY3VydmU9dGhpcy5jdXJ2ZUJ1aWxkZXIuZ2V0UmluZ0N1cnZlKGNvb3JkLHNpZGUsb2Zmc2V0RGlzdGFuY2UpO3RoaXMuYWRkQ3VydmUoY3VydmUsbGVmdExvYyxyaWdodExvYyk7fTtqc3RzLm9wZXJhdGlvbi5idWZmZXIuT2Zmc2V0Q3VydmVTZXRCdWlsZGVyLnByb3RvdHlwZS5pc0Vyb2RlZENvbXBsZXRlbHk9ZnVuY3Rpb24ocmluZyxidWZmZXJEaXN0YW5jZSl7dmFyIHJpbmdDb29yZD1yaW5nLmdldENvb3JkaW5hdGVzKCk7dmFyIG1pbkRpYW09MC4wO2lmKHJpbmdDb29yZC5sZW5ndGg8NClcbnJldHVybiBidWZmZXJEaXN0YW5jZTwwO2lmKHJpbmdDb29yZC5sZW5ndGg9PTQpXG5yZXR1cm4gdGhpcy5pc1RyaWFuZ2xlRXJvZGVkQ29tcGxldGVseShyaW5nQ29vcmQsYnVmZmVyRGlzdGFuY2UpO3ZhciBlbnY9cmluZy5nZXRFbnZlbG9wZUludGVybmFsKCk7dmFyIGVudk1pbkRpbWVuc2lvbj1NYXRoLm1pbihlbnYuZ2V0SGVpZ2h0KCksZW52LmdldFdpZHRoKCkpO2lmKGJ1ZmZlckRpc3RhbmNlPDAuMCYmMipNYXRoLmFicyhidWZmZXJEaXN0YW5jZSk+ZW52TWluRGltZW5zaW9uKVxucmV0dXJuIHRydWU7cmV0dXJuIGZhbHNlO307anN0cy5vcGVyYXRpb24uYnVmZmVyLk9mZnNldEN1cnZlU2V0QnVpbGRlci5wcm90b3R5cGUuaXNUcmlhbmdsZUVyb2RlZENvbXBsZXRlbHk9ZnVuY3Rpb24odHJpYW5nbGVDb29yZCxidWZmZXJEaXN0YW5jZSl7dmFyIHRyaT1uZXcganN0cy5nZW9tLlRyaWFuZ2xlKHRyaWFuZ2xlQ29vcmRbMF0sdHJpYW5nbGVDb29yZFsxXSx0cmlhbmdsZUNvb3JkWzJdKTt2YXIgaW5DZW50cmU9dHJpLmluQ2VudHJlKCk7dmFyIGRpc3RUb0NlbnRyZT1qc3RzLmFsZ29yaXRobS5DR0FsZ29yaXRobXMuZGlzdGFuY2VQb2ludExpbmUoaW5DZW50cmUsdHJpLnAwLHRyaS5wMSk7cmV0dXJuIGRpc3RUb0NlbnRyZTxNYXRoLmFicyhidWZmZXJEaXN0YW5jZSk7fTtqc3RzLm9wZXJhdGlvbi5idWZmZXIuQnVmZmVyU3ViZ3JhcGg9ZnVuY3Rpb24oKXt0aGlzLmRpckVkZ2VMaXN0PW5ldyBqYXZhc2NyaXB0LnV0aWwuQXJyYXlMaXN0KCk7dGhpcy5ub2Rlcz1uZXcgamF2YXNjcmlwdC51dGlsLkFycmF5TGlzdCgpO3RoaXMuZmluZGVyPW5ldyBqc3RzLm9wZXJhdGlvbi5idWZmZXIuUmlnaHRtb3N0RWRnZUZpbmRlcigpO307anN0cy5vcGVyYXRpb24uYnVmZmVyLkJ1ZmZlclN1YmdyYXBoLnByb3RvdHlwZS5maW5kZXI9bnVsbDtqc3RzLm9wZXJhdGlvbi5idWZmZXIuQnVmZmVyU3ViZ3JhcGgucHJvdG90eXBlLmRpckVkZ2VMaXN0PW51bGw7anN0cy5vcGVyYXRpb24uYnVmZmVyLkJ1ZmZlclN1YmdyYXBoLnByb3RvdHlwZS5ub2Rlcz1udWxsO2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5CdWZmZXJTdWJncmFwaC5wcm90b3R5cGUucmlnaHRNb3N0Q29vcmQ9bnVsbDtqc3RzLm9wZXJhdGlvbi5idWZmZXIuQnVmZmVyU3ViZ3JhcGgucHJvdG90eXBlLmVudj1udWxsO2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5CdWZmZXJTdWJncmFwaC5wcm90b3R5cGUuZ2V0RGlyZWN0ZWRFZGdlcz1mdW5jdGlvbigpe3JldHVybiB0aGlzLmRpckVkZ2VMaXN0O307anN0cy5vcGVyYXRpb24uYnVmZmVyLkJ1ZmZlclN1YmdyYXBoLnByb3RvdHlwZS5nZXROb2Rlcz1mdW5jdGlvbigpe3JldHVybiB0aGlzLm5vZGVzO307anN0cy5vcGVyYXRpb24uYnVmZmVyLkJ1ZmZlclN1YmdyYXBoLnByb3RvdHlwZS5nZXRFbnZlbG9wZT1mdW5jdGlvbigpe2lmKHRoaXMuZW52PT09bnVsbCl7dmFyIGVkZ2VFbnY9bmV3IGpzdHMuZ2VvbS5FbnZlbG9wZSgpO2Zvcih2YXIgaXQ9dGhpcy5kaXJFZGdlTGlzdC5pdGVyYXRvcigpO2l0Lmhhc05leHQoKTspe3ZhciBkaXJFZGdlPWl0Lm5leHQoKTt2YXIgcHRzPWRpckVkZ2UuZ2V0RWRnZSgpLmdldENvb3JkaW5hdGVzKCk7Zm9yKHZhciBqPTA7ajxwdHMubGVuZ3RoLTE7aisrKXtlZGdlRW52LmV4cGFuZFRvSW5jbHVkZShwdHNbal0pO319XG50aGlzLmVudj1lZGdlRW52O31cbnJldHVybiB0aGlzLmVudjt9O2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5CdWZmZXJTdWJncmFwaC5wcm90b3R5cGUuZ2V0UmlnaHRtb3N0Q29vcmRpbmF0ZT1mdW5jdGlvbigpe3JldHVybiB0aGlzLnJpZ2h0TW9zdENvb3JkO307anN0cy5vcGVyYXRpb24uYnVmZmVyLkJ1ZmZlclN1YmdyYXBoLnByb3RvdHlwZS5jcmVhdGU9ZnVuY3Rpb24obm9kZSl7dGhpcy5hZGRSZWFjaGFibGUobm9kZSk7dGhpcy5maW5kZXIuZmluZEVkZ2UodGhpcy5kaXJFZGdlTGlzdCk7dGhpcy5yaWdodE1vc3RDb29yZD10aGlzLmZpbmRlci5nZXRDb29yZGluYXRlKCk7fTtqc3RzLm9wZXJhdGlvbi5idWZmZXIuQnVmZmVyU3ViZ3JhcGgucHJvdG90eXBlLmFkZFJlYWNoYWJsZT1mdW5jdGlvbihzdGFydE5vZGUpe3ZhciBub2RlU3RhY2s9W107bm9kZVN0YWNrLnB1c2goc3RhcnROb2RlKTt3aGlsZShub2RlU3RhY2subGVuZ3RoIT09MCl7dmFyIG5vZGU9bm9kZVN0YWNrLnBvcCgpO3RoaXMuYWRkKG5vZGUsbm9kZVN0YWNrKTt9fTtqc3RzLm9wZXJhdGlvbi5idWZmZXIuQnVmZmVyU3ViZ3JhcGgucHJvdG90eXBlLmFkZD1mdW5jdGlvbihub2RlLG5vZGVTdGFjayl7bm9kZS5zZXRWaXNpdGVkKHRydWUpO3RoaXMubm9kZXMuYWRkKG5vZGUpO2Zvcih2YXIgaT1ub2RlLmdldEVkZ2VzKCkuaXRlcmF0b3IoKTtpLmhhc05leHQoKTspe3ZhciBkZT1pLm5leHQoKTt0aGlzLmRpckVkZ2VMaXN0LmFkZChkZSk7dmFyIHN5bT1kZS5nZXRTeW0oKTt2YXIgc3ltTm9kZT1zeW0uZ2V0Tm9kZSgpO2lmKCFzeW1Ob2RlLmlzVmlzaXRlZCgpKVxubm9kZVN0YWNrLnB1c2goc3ltTm9kZSk7fX07anN0cy5vcGVyYXRpb24uYnVmZmVyLkJ1ZmZlclN1YmdyYXBoLnByb3RvdHlwZS5jbGVhclZpc2l0ZWRFZGdlcz1mdW5jdGlvbigpe2Zvcih2YXIgaXQ9dGhpcy5kaXJFZGdlTGlzdC5pdGVyYXRvcigpO2l0Lmhhc05leHQoKTspe3ZhciBkZT1pdC5uZXh0KCk7ZGUuc2V0VmlzaXRlZChmYWxzZSk7fX07anN0cy5vcGVyYXRpb24uYnVmZmVyLkJ1ZmZlclN1YmdyYXBoLnByb3RvdHlwZS5jb21wdXRlRGVwdGg9ZnVuY3Rpb24ob3V0c2lkZURlcHRoKXt0aGlzLmNsZWFyVmlzaXRlZEVkZ2VzKCk7dmFyIGRlPXRoaXMuZmluZGVyLmdldEVkZ2UoKTt2YXIgbj1kZS5nZXROb2RlKCk7dmFyIGxhYmVsPWRlLmdldExhYmVsKCk7ZGUuc2V0RWRnZURlcHRocyhqc3RzLmdlb21ncmFwaC5Qb3NpdGlvbi5SSUdIVCxvdXRzaWRlRGVwdGgpO3RoaXMuY29weVN5bURlcHRocyhkZSk7dGhpcy5jb21wdXRlRGVwdGhzKGRlKTt9O2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5CdWZmZXJTdWJncmFwaC5wcm90b3R5cGUuY29tcHV0ZURlcHRocz1mdW5jdGlvbihzdGFydEVkZ2Upe3ZhciBub2Rlc1Zpc2l0ZWQ9W107dmFyIG5vZGVRdWV1ZT1bXTt2YXIgc3RhcnROb2RlPXN0YXJ0RWRnZS5nZXROb2RlKCk7bm9kZVF1ZXVlLnB1c2goc3RhcnROb2RlKTtub2Rlc1Zpc2l0ZWQucHVzaChzdGFydE5vZGUpO3N0YXJ0RWRnZS5zZXRWaXNpdGVkKHRydWUpO3doaWxlKG5vZGVRdWV1ZS5sZW5ndGghPT0wKXt2YXIgbj1ub2RlUXVldWUuc2hpZnQoKTtub2Rlc1Zpc2l0ZWQucHVzaChuKTt0aGlzLmNvbXB1dGVOb2RlRGVwdGgobik7Zm9yKHZhciBpPW4uZ2V0RWRnZXMoKS5pdGVyYXRvcigpO2kuaGFzTmV4dCgpOyl7dmFyIGRlPWkubmV4dCgpO3ZhciBzeW09ZGUuZ2V0U3ltKCk7aWYoc3ltLmlzVmlzaXRlZCgpKVxuY29udGludWU7dmFyIGFkak5vZGU9c3ltLmdldE5vZGUoKTtpZihub2Rlc1Zpc2l0ZWQuaW5kZXhPZihhZGpOb2RlKT09PS0xKXtub2RlUXVldWUucHVzaChhZGpOb2RlKTtub2Rlc1Zpc2l0ZWQucHVzaChhZGpOb2RlKTt9fX19O2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5CdWZmZXJTdWJncmFwaC5wcm90b3R5cGUuY29tcHV0ZU5vZGVEZXB0aD1mdW5jdGlvbihuKXt2YXIgc3RhcnRFZGdlPW51bGw7Zm9yKHZhciBpPW4uZ2V0RWRnZXMoKS5pdGVyYXRvcigpO2kuaGFzTmV4dCgpOyl7dmFyIGRlPWkubmV4dCgpO2lmKGRlLmlzVmlzaXRlZCgpfHxkZS5nZXRTeW0oKS5pc1Zpc2l0ZWQoKSl7c3RhcnRFZGdlPWRlO2JyZWFrO319XG5pZihzdGFydEVkZ2U9PW51bGwpXG50aHJvdyBuZXcganN0cy5lcnJvci5Ub3BvbG9neUVycm9yKCd1bmFibGUgdG8gZmluZCBlZGdlIHRvIGNvbXB1dGUgZGVwdGhzIGF0ICcrbi5nZXRDb29yZGluYXRlKCkpO24uZ2V0RWRnZXMoKS5jb21wdXRlRGVwdGhzKHN0YXJ0RWRnZSk7Zm9yKHZhciBpPW4uZ2V0RWRnZXMoKS5pdGVyYXRvcigpO2kuaGFzTmV4dCgpOyl7dmFyIGRlPWkubmV4dCgpO2RlLnNldFZpc2l0ZWQodHJ1ZSk7dGhpcy5jb3B5U3ltRGVwdGhzKGRlKTt9fTtqc3RzLm9wZXJhdGlvbi5idWZmZXIuQnVmZmVyU3ViZ3JhcGgucHJvdG90eXBlLmNvcHlTeW1EZXB0aHM9ZnVuY3Rpb24oZGUpe3ZhciBzeW09ZGUuZ2V0U3ltKCk7c3ltLnNldERlcHRoKGpzdHMuZ2VvbWdyYXBoLlBvc2l0aW9uLkxFRlQsZGUuZ2V0RGVwdGgoanN0cy5nZW9tZ3JhcGguUG9zaXRpb24uUklHSFQpKTtzeW0uc2V0RGVwdGgoanN0cy5nZW9tZ3JhcGguUG9zaXRpb24uUklHSFQsZGUuZ2V0RGVwdGgoanN0cy5nZW9tZ3JhcGguUG9zaXRpb24uTEVGVCkpO307anN0cy5vcGVyYXRpb24uYnVmZmVyLkJ1ZmZlclN1YmdyYXBoLnByb3RvdHlwZS5maW5kUmVzdWx0RWRnZXM9ZnVuY3Rpb24oKXtmb3IodmFyIGl0PXRoaXMuZGlyRWRnZUxpc3QuaXRlcmF0b3IoKTtpdC5oYXNOZXh0KCk7KXt2YXIgZGU9aXQubmV4dCgpO2lmKGRlLmdldERlcHRoKGpzdHMuZ2VvbWdyYXBoLlBvc2l0aW9uLlJJR0hUKT49MSYmZGUuZ2V0RGVwdGgoanN0cy5nZW9tZ3JhcGguUG9zaXRpb24uTEVGVCk8PTAmJiFkZS5pc0ludGVyaW9yQXJlYUVkZ2UoKSl7ZGUuc2V0SW5SZXN1bHQodHJ1ZSk7fX19O2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5CdWZmZXJTdWJncmFwaC5wcm90b3R5cGUuY29tcGFyZVRvPWZ1bmN0aW9uKG8pe3ZhciBncmFwaD1vO2lmKHRoaXMucmlnaHRNb3N0Q29vcmQueDxncmFwaC5yaWdodE1vc3RDb29yZC54KXtyZXR1cm4tMTt9XG5pZih0aGlzLnJpZ2h0TW9zdENvb3JkLng+Z3JhcGgucmlnaHRNb3N0Q29vcmQueCl7cmV0dXJuIDE7fVxucmV0dXJuIDA7fTtqc3RzLnNpbXBsaWZ5LkRQVHJhbnNmb3JtZXI9ZnVuY3Rpb24oZGlzdGFuY2VUb2xlcmFuY2UsaXNFbnN1cmVWYWxpZFRvcG9sb2d5KXt0aGlzLmRpc3RhbmNlVG9sZXJhbmNlPWRpc3RhbmNlVG9sZXJhbmNlO3RoaXMuaXNFbnN1cmVWYWxpZFRvcG9sb2d5PWlzRW5zdXJlVmFsaWRUb3BvbG9neTt9O2pzdHMuc2ltcGxpZnkuRFBUcmFuc2Zvcm1lci5wcm90b3R5cGU9bmV3IGpzdHMuZ2VvbS51dGlsLkdlb21ldHJ5VHJhbnNmb3JtZXIoKTtqc3RzLnNpbXBsaWZ5LkRQVHJhbnNmb3JtZXIucHJvdG90eXBlLmRpc3RhbmNlVG9sZXJhbmNlPW51bGw7anN0cy5zaW1wbGlmeS5EUFRyYW5zZm9ybWVyLnByb3RvdHlwZS5pc0Vuc3VyZVZhbGlkVG9wb2xvZ3k9bnVsbDtqc3RzLnNpbXBsaWZ5LkRQVHJhbnNmb3JtZXIucHJvdG90eXBlLnRyYW5zZm9ybUNvb3JkaW5hdGVzPWZ1bmN0aW9uKGNvb3JkcyxwYXJlbnQpe3ZhciBpbnB1dFB0cz1jb29yZHM7dmFyIG5ld1B0cz1udWxsO2lmKGlucHV0UHRzLmxlbmd0aD09MCl7bmV3UHRzPVtdO31lbHNle25ld1B0cz1qc3RzLnNpbXBsaWZ5LkRvdWdsYXNQZXVja2VyTGluZVNpbXBsaWZpZXIuc2ltcGxpZnkoaW5wdXRQdHMsdGhpcy5kaXN0YW5jZVRvbGVyYW5jZSk7fVxucmV0dXJuIG5ld1B0czt9O2pzdHMuc2ltcGxpZnkuRFBUcmFuc2Zvcm1lci5wcm90b3R5cGUudHJhbnNmb3JtUG9seWdvbj1mdW5jdGlvbihnZW9tLHBhcmVudCl7aWYoZ2VvbS5pc0VtcHR5KCkpe3JldHVybiBudWxsO31cbnZhciByYXdHZW9tPWpzdHMuZ2VvbS51dGlsLkdlb21ldHJ5VHJhbnNmb3JtZXIucHJvdG90eXBlLnRyYW5zZm9ybVBvbHlnb24uYXBwbHkodGhpcyxhcmd1bWVudHMpO2lmKHBhcmVudCBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5NdWx0aVBvbHlnb24pe3JldHVybiByYXdHZW9tO31cbnJldHVybiB0aGlzLmNyZWF0ZVZhbGlkQXJlYShyYXdHZW9tKTt9O2pzdHMuc2ltcGxpZnkuRFBUcmFuc2Zvcm1lci5wcm90b3R5cGUudHJhbnNmb3JtTGluZWFyUmluZz1mdW5jdGlvbihnZW9tLHBhcmVudCl7dmFyIHJlbW92ZURlZ2VuZXJhdGVSaW5ncz1wYXJlbnQgaW5zdGFuY2VvZiBqc3RzLmdlb20uUG9seWdvbjt2YXIgc2ltcFJlc3VsdD1qc3RzLmdlb20udXRpbC5HZW9tZXRyeVRyYW5zZm9ybWVyLnByb3RvdHlwZS50cmFuc2Zvcm1MaW5lYXJSaW5nLmFwcGx5KHRoaXMsYXJndW1lbnRzKTtpZihyZW1vdmVEZWdlbmVyYXRlUmluZ3MmJiEoc2ltcFJlc3VsdCBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5MaW5lYXJSaW5nKSl7cmV0dXJuIG51bGw7fVxucmV0dXJuIHNpbXBSZXN1bHQ7fTtqc3RzLnNpbXBsaWZ5LkRQVHJhbnNmb3JtZXIucHJvdG90eXBlLnRyYW5zZm9ybU11bHRpUG9seWdvbj1mdW5jdGlvbihnZW9tLHBhcmVudCl7dmFyIHJhd0dlb209anN0cy5nZW9tLnV0aWwuR2VvbWV0cnlUcmFuc2Zvcm1lci5wcm90b3R5cGUudHJhbnNmb3JtTXVsdGlQb2x5Z29uLmFwcGx5KHRoaXMsYXJndW1lbnRzKTtyZXR1cm4gdGhpcy5jcmVhdGVWYWxpZEFyZWEocmF3R2VvbSk7fTtqc3RzLnNpbXBsaWZ5LkRQVHJhbnNmb3JtZXIucHJvdG90eXBlLmNyZWF0ZVZhbGlkQXJlYT1mdW5jdGlvbihyYXdBcmVhR2VvbSl7aWYodGhpcy5pc0Vuc3VyZVZhbGlkVG9wb2xvZ3kpe3JldHVybiByYXdBcmVhR2VvbS5idWZmZXIoMC4wKTt9XG5yZXR1cm4gcmF3QXJlYUdlb207fTtqc3RzLmdlb20udXRpbC5HZW9tZXRyeUV4dHJhY3Rlcj1mdW5jdGlvbihjbHosY29tcHMpe3RoaXMuY2x6PWNsejt0aGlzLmNvbXBzPWNvbXBzO307anN0cy5nZW9tLnV0aWwuR2VvbWV0cnlFeHRyYWN0ZXIucHJvdG90eXBlPW5ldyBqc3RzLmdlb20uR2VvbWV0cnlGaWx0ZXIoKTtqc3RzLmdlb20udXRpbC5HZW9tZXRyeUV4dHJhY3Rlci5wcm90b3R5cGUuY2x6PW51bGw7anN0cy5nZW9tLnV0aWwuR2VvbWV0cnlFeHRyYWN0ZXIucHJvdG90eXBlLmNvbXBzPW51bGw7anN0cy5nZW9tLnV0aWwuR2VvbWV0cnlFeHRyYWN0ZXIuZXh0cmFjdD1mdW5jdGlvbihnZW9tLGNseixsaXN0KXtsaXN0PWxpc3R8fG5ldyBqYXZhc2NyaXB0LnV0aWwuQXJyYXlMaXN0KCk7aWYoZ2VvbSBpbnN0YW5jZW9mIGNseil7bGlzdC5hZGQoZ2VvbSk7fVxuZWxzZSBpZihnZW9tIGluc3RhbmNlb2YganN0cy5nZW9tLkdlb21ldHJ5Q29sbGVjdGlvbnx8Z2VvbSBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5NdWx0aVBvaW50fHxnZW9tIGluc3RhbmNlb2YganN0cy5nZW9tLk11bHRpTGluZVN0cmluZ3x8Z2VvbSBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5NdWx0aVBvbHlnb24pe2dlb20uYXBwbHkobmV3IGpzdHMuZ2VvbS51dGlsLkdlb21ldHJ5RXh0cmFjdGVyKGNseixsaXN0KSk7fVxucmV0dXJuIGxpc3Q7fTtqc3RzLmdlb20udXRpbC5HZW9tZXRyeUV4dHJhY3Rlci5wcm90b3R5cGUuZmlsdGVyPWZ1bmN0aW9uKGdlb20pe2lmKHRoaXMuY2x6PT09bnVsbHx8Z2VvbSBpbnN0YW5jZW9mIHRoaXMuY2x6KXt0aGlzLmNvbXBzLmFkZChnZW9tKTt9fTsoZnVuY3Rpb24oKXt2YXIgT3ZlcmxheU9wPWpzdHMub3BlcmF0aW9uLm92ZXJsYXkuT3ZlcmxheU9wO3ZhciBTbmFwT3ZlcmxheU9wPWpzdHMub3BlcmF0aW9uLm92ZXJsYXkuc25hcC5TbmFwT3ZlcmxheU9wO3ZhciBTbmFwSWZOZWVkZWRPdmVybGF5T3A9ZnVuY3Rpb24oZzEsZzIpe3RoaXMuZ2VvbT1bXTt0aGlzLmdlb21bMF09ZzE7dGhpcy5nZW9tWzFdPWcyO307U25hcElmTmVlZGVkT3ZlcmxheU9wLm92ZXJsYXlPcD1mdW5jdGlvbihnMCxnMSxvcENvZGUpe3ZhciBvcD1uZXcgU25hcElmTmVlZGVkT3ZlcmxheU9wKGcwLGcxKTtyZXR1cm4gb3AuZ2V0UmVzdWx0R2VvbWV0cnkob3BDb2RlKTt9O1NuYXBJZk5lZWRlZE92ZXJsYXlPcC5pbnRlcnNlY3Rpb249ZnVuY3Rpb24oZzAsZzEpe3JldHVybiBvdmVybGF5T3AoZzAsZzEsT3ZlcmxheU9wLklOVEVSU0VDVElPTik7fTtTbmFwSWZOZWVkZWRPdmVybGF5T3AudW5pb249ZnVuY3Rpb24oZzAsZzEpe3JldHVybiBvdmVybGF5T3AoZzAsZzEsT3ZlcmxheU9wLlVOSU9OKTt9O1NuYXBJZk5lZWRlZE92ZXJsYXlPcC5kaWZmZXJlbmNlPWZ1bmN0aW9uKGcwLGcxKXtyZXR1cm4gb3ZlcmxheU9wKGcwLGcxLE92ZXJsYXlPcC5ESUZGRVJFTkNFKTt9O1NuYXBJZk5lZWRlZE92ZXJsYXlPcC5zeW1EaWZmZXJlbmNlPWZ1bmN0aW9uKGcwLGcxKXtyZXR1cm4gb3ZlcmxheU9wKGcwLGcxLE92ZXJsYXlPcC5TWU1ESUZGRVJFTkNFKTt9O1NuYXBJZk5lZWRlZE92ZXJsYXlPcC5wcm90b3R5cGUuZ2VvbT1udWxsO1NuYXBJZk5lZWRlZE92ZXJsYXlPcC5wcm90b3R5cGUuZ2V0UmVzdWx0R2VvbWV0cnk9ZnVuY3Rpb24ob3BDb2RlKXt2YXIgcmVzdWx0PW51bGw7dmFyIGlzU3VjY2Vzcz1mYWxzZTt2YXIgc2F2ZWRFeGNlcHRpb249bnVsbDt0cnl7cmVzdWx0PU92ZXJsYXlPcC5vdmVybGF5T3AodGhpcy5nZW9tWzBdLHRoaXMuZ2VvbVsxXSxvcENvZGUpO3ZhciBpc1ZhbGlkPXRydWU7aWYoaXNWYWxpZClcbmlzU3VjY2Vzcz10cnVlO31jYXRjaChleCl7c2F2ZWRFeGNlcHRpb249ZXg7fVxuaWYoIWlzU3VjY2Vzcyl7dHJ5e3Jlc3VsdD1TbmFwT3ZlcmxheU9wLm92ZXJsYXlPcCh0aGlzLmdlb21bMF0sdGhpcy5nZW9tWzFdLG9wQ29kZSk7fWNhdGNoKGV4KXt0aHJvdyBzYXZlZEV4Y2VwdGlvbjt9fVxucmV0dXJuIHJlc3VsdDt9O2pzdHMub3BlcmF0aW9uLm92ZXJsYXkuc25hcC5TbmFwSWZOZWVkZWRPdmVybGF5T3A9U25hcElmTmVlZGVkT3ZlcmxheU9wO30pKCk7KGZ1bmN0aW9uKCl7dmFyIEdlb21ldHJ5RXh0cmFjdGVyPWpzdHMuZ2VvbS51dGlsLkdlb21ldHJ5RXh0cmFjdGVyO3ZhciBDYXNjYWRlZFBvbHlnb25Vbmlvbj1qc3RzLm9wZXJhdGlvbi51bmlvbi5DYXNjYWRlZFBvbHlnb25Vbmlvbjt2YXIgUG9pbnRHZW9tZXRyeVVuaW9uPWpzdHMub3BlcmF0aW9uLnVuaW9uLlBvaW50R2VvbWV0cnlVbmlvbjt2YXIgT3ZlcmxheU9wPWpzdHMub3BlcmF0aW9uLm92ZXJsYXkuT3ZlcmxheU9wO3ZhciBTbmFwSWZOZWVkZWRPdmVybGF5T3A9anN0cy5vcGVyYXRpb24ub3ZlcmxheS5zbmFwLlNuYXBJZk5lZWRlZE92ZXJsYXlPcDt2YXIgQXJyYXlMaXN0PWphdmFzY3JpcHQudXRpbC5BcnJheUxpc3Q7anN0cy5vcGVyYXRpb24udW5pb24uVW5hcnlVbmlvbk9wPWZ1bmN0aW9uKGdlb21zLGdlb21GYWN0KXt0aGlzLnBvbHlnb25zPW5ldyBBcnJheUxpc3QoKTt0aGlzLmxpbmVzPW5ldyBBcnJheUxpc3QoKTt0aGlzLnBvaW50cz1uZXcgQXJyYXlMaXN0KCk7aWYoZ2VvbUZhY3Qpe3RoaXMuZ2VvbUZhY3Q9Z2VvbUZhY3Q7fVxudGhpcy5leHRyYWN0KGdlb21zKTt9O2pzdHMub3BlcmF0aW9uLnVuaW9uLlVuYXJ5VW5pb25PcC51bmlvbj1mdW5jdGlvbihnZW9tcyxnZW9tRmFjdCl7dmFyIG9wPW5ldyBqc3RzLm9wZXJhdGlvbi51bmlvbi5VbmFyeVVuaW9uT3AoZ2VvbXMsZ2VvbUZhY3QpO3JldHVybiBvcC51bmlvbigpO307anN0cy5vcGVyYXRpb24udW5pb24uVW5hcnlVbmlvbk9wLnByb3RvdHlwZS5wb2x5Z29ucz1udWxsO2pzdHMub3BlcmF0aW9uLnVuaW9uLlVuYXJ5VW5pb25PcC5wcm90b3R5cGUubGluZXM9bnVsbDtqc3RzLm9wZXJhdGlvbi51bmlvbi5VbmFyeVVuaW9uT3AucHJvdG90eXBlLnBvaW50cz1udWxsO2pzdHMub3BlcmF0aW9uLnVuaW9uLlVuYXJ5VW5pb25PcC5wcm90b3R5cGUuZ2VvbUZhY3Q9bnVsbDtqc3RzLm9wZXJhdGlvbi51bmlvbi5VbmFyeVVuaW9uT3AucHJvdG90eXBlLmV4dHJhY3Q9ZnVuY3Rpb24oZ2VvbXMpe2lmKGdlb21zIGluc3RhbmNlb2YgQXJyYXlMaXN0KXtmb3IodmFyIGk9Z2VvbXMuaXRlcmF0b3IoKTtpLmhhc05leHQoKTspe3ZhciBnZW9tPWkubmV4dCgpO3RoaXMuZXh0cmFjdChnZW9tKTt9fWVsc2V7aWYodGhpcy5nZW9tRmFjdD09PW51bGwpe3RoaXMuZ2VvbUZhY3Q9Z2VvbXMuZ2V0RmFjdG9yeSgpO31cbkdlb21ldHJ5RXh0cmFjdGVyLmV4dHJhY3QoZ2VvbXMsanN0cy5nZW9tLlBvbHlnb24sdGhpcy5wb2x5Z29ucyk7R2VvbWV0cnlFeHRyYWN0ZXIuZXh0cmFjdChnZW9tcyxqc3RzLmdlb20uTGluZVN0cmluZyx0aGlzLmxpbmVzKTtHZW9tZXRyeUV4dHJhY3Rlci5leHRyYWN0KGdlb21zLGpzdHMuZ2VvbS5Qb2ludCx0aGlzLnBvaW50cyk7fX07anN0cy5vcGVyYXRpb24udW5pb24uVW5hcnlVbmlvbk9wLnByb3RvdHlwZS51bmlvbj1mdW5jdGlvbigpe2lmKHRoaXMuZ2VvbUZhY3Q9PT1udWxsKXtyZXR1cm4gbnVsbDt9XG52YXIgdW5pb25Qb2ludHM9bnVsbDtpZih0aGlzLnBvaW50cy5zaXplKCk+MCl7dmFyIHB0R2VvbT10aGlzLmdlb21GYWN0LmJ1aWxkR2VvbWV0cnkodGhpcy5wb2ludHMpO3VuaW9uUG9pbnRzPXRoaXMudW5pb25Ob09wdChwdEdlb20pO31cbnZhciB1bmlvbkxpbmVzPW51bGw7aWYodGhpcy5saW5lcy5zaXplKCk+MCl7dmFyIGxpbmVHZW9tPXRoaXMuZ2VvbUZhY3QuYnVpbGRHZW9tZXRyeSh0aGlzLmxpbmVzKTt1bmlvbkxpbmVzPXRoaXMudW5pb25Ob09wdChsaW5lR2VvbSk7fVxudmFyIHVuaW9uUG9seWdvbnM9bnVsbDtpZih0aGlzLnBvbHlnb25zLnNpemUoKT4wKXt1bmlvblBvbHlnb25zPUNhc2NhZGVkUG9seWdvblVuaW9uLnVuaW9uKHRoaXMucG9seWdvbnMpO31cbnZhciB1bmlvbkxBPXRoaXMudW5pb25XaXRoTnVsbCh1bmlvbkxpbmVzLHVuaW9uUG9seWdvbnMpO3ZhciB1bmlvbj1udWxsO2lmKHVuaW9uUG9pbnRzPT09bnVsbCl7dW5pb249dW5pb25MQTt9ZWxzZSBpZih1bmlvbkxBPT09bnVsbCl7dW5pb249dW5pb25Qb2ludHM7fWVsc2V7dW5pb249UG9pbnRHZW9tZXRyeVVuaW9uKHVuaW9uUG9pbnRzLHVuaW9uTEEpO31cbmlmKHVuaW9uPT09bnVsbCl7cmV0dXJuIHRoaXMuZ2VvbUZhY3QuY3JlYXRlR2VvbWV0cnlDb2xsZWN0aW9uKG51bGwpO31cbnJldHVybiB1bmlvbjt9O2pzdHMub3BlcmF0aW9uLnVuaW9uLlVuYXJ5VW5pb25PcC5wcm90b3R5cGUudW5pb25XaXRoTnVsbD1mdW5jdGlvbihnMCxnMSl7aWYoZzA9PT1udWxsJiZnMT09PW51bGwpe3JldHVybiBudWxsO31cbmlmKGcxPT09bnVsbCl7cmV0dXJuIGcwO31cbmlmKGcwPT09bnVsbCl7cmV0dXJuIGcxO31cbnJldHVybiBnMC51bmlvbihnMSk7fTtqc3RzLm9wZXJhdGlvbi51bmlvbi5VbmFyeVVuaW9uT3AucHJvdG90eXBlLnVuaW9uTm9PcHQ9ZnVuY3Rpb24oZzApe3ZhciBlbXB0eT10aGlzLmdlb21GYWN0LmNyZWF0ZVBvaW50KG51bGwpO3JldHVybiBTbmFwSWZOZWVkZWRPdmVybGF5T3Aub3ZlcmxheU9wKGcwLGVtcHR5LE92ZXJsYXlPcC5VTklPTik7fTt9KCkpO2pzdHMuaW5kZXgua2R0cmVlLktkTm9kZT1mdW5jdGlvbigpe3RoaXMubGVmdD1udWxsO3RoaXMucmlnaHQ9bnVsbDt0aGlzLmNvdW50PTE7aWYoYXJndW1lbnRzLmxlbmd0aD09PTIpe3RoaXMuaW5pdGlhbGl6ZUZyb21Db29yZGluYXRlLmFwcGx5KHRoaXMsYXJndW1lbnRzWzBdLGFyZ3VtZW50c1sxXSk7fWVsc2UgaWYoYXJndW1lbnRzLmxlbmd0aD09PTMpe3RoaXMuaW5pdGlhbGl6ZUZyb21YWS5hcHBseSh0aGlzLGFyZ3VtZW50c1swXSxhcmd1bWVudHNbMV0sYXJndW1lbnRzWzJdKTt9fTtqc3RzLmluZGV4LmtkdHJlZS5LZE5vZGUucHJvdG90eXBlLmluaXRpYWxpemVGcm9tWFk9ZnVuY3Rpb24oeCx5LGRhdGEpe3RoaXMucD1uZXcganN0cy5nZW9tLkNvb3JkaW5hdGUoeCx5KTt0aGlzLmRhdGE9ZGF0YTt9O2pzdHMuaW5kZXgua2R0cmVlLktkTm9kZS5wcm90b3R5cGUuaW5pdGlhbGl6ZUZyb21Db29yZGluYXRlPWZ1bmN0aW9uKHAsZGF0YSl7dGhpcy5wPXA7dGhpcy5kYXRhPWRhdGE7fTtqc3RzLmluZGV4LmtkdHJlZS5LZE5vZGUucHJvdG90eXBlLmdldFg9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5wLng7fTtqc3RzLmluZGV4LmtkdHJlZS5LZE5vZGUucHJvdG90eXBlLmdldFk9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5wLnk7fTtqc3RzLmluZGV4LmtkdHJlZS5LZE5vZGUucHJvdG90eXBlLmdldENvb3JkaW5hdGU9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5wO307anN0cy5pbmRleC5rZHRyZWUuS2ROb2RlLnByb3RvdHlwZS5nZXREYXRhPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZGF0YTt9O2pzdHMuaW5kZXgua2R0cmVlLktkTm9kZS5wcm90b3R5cGUuZ2V0TGVmdD1mdW5jdGlvbigpe3JldHVybiB0aGlzLmxlZnQ7fTtqc3RzLmluZGV4LmtkdHJlZS5LZE5vZGUucHJvdG90eXBlLmdldFJpZ2h0PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMucmlnaHQ7fTtqc3RzLmluZGV4LmtkdHJlZS5LZE5vZGUucHJvdG90eXBlLmluY3JlbWVudD1mdW5jdGlvbigpe3RoaXMuY291bnQrPTE7fTtqc3RzLmluZGV4LmtkdHJlZS5LZE5vZGUucHJvdG90eXBlLmdldENvdW50PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuY291bnQ7fTtqc3RzLmluZGV4LmtkdHJlZS5LZE5vZGUucHJvdG90eXBlLmlzUmVwZWF0ZWQ9ZnVuY3Rpb24oKXtyZXR1cm4gY291bnQ+MTt9O2pzdHMuaW5kZXgua2R0cmVlLktkTm9kZS5wcm90b3R5cGUuc2V0TGVmdD1mdW5jdGlvbihsZWZ0KXt0aGlzLmxlZnQ9bGVmdDt9O2pzdHMuaW5kZXgua2R0cmVlLktkTm9kZS5wcm90b3R5cGUuc2V0UmlnaHQ9ZnVuY3Rpb24ocmlnaHQpe3RoaXMucmlnaHQ9cmlnaHQ7fTtqc3RzLmFsZ29yaXRobS5JbnRlcmlvclBvaW50UG9pbnQ9ZnVuY3Rpb24oZ2VvbWV0cnkpe3RoaXMubWluRGlzdGFuY2U9TnVtYmVyLk1BWF9WQUxVRTt0aGlzLmludGVyaW9yUG9pbnQ9bnVsbDt0aGlzLmNlbnRyb2lkPWdlb21ldHJ5LmdldENlbnRyb2lkKCkuZ2V0Q29vcmRpbmF0ZSgpO3RoaXMuYWRkKGdlb21ldHJ5KTt9O2pzdHMuYWxnb3JpdGhtLkludGVyaW9yUG9pbnRQb2ludC5wcm90b3R5cGUuYWRkPWZ1bmN0aW9uKGdlb21ldHJ5KXtpZihnZW9tZXRyeSBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5Qb2ludCl7dGhpcy5hZGRQb2ludChnZW9tZXRyeS5nZXRDb29yZGluYXRlKCkpO31lbHNlIGlmKGdlb21ldHJ5IGluc3RhbmNlb2YganN0cy5nZW9tLkdlb21ldHJ5Q29sbGVjdGlvbil7Zm9yKHZhciBpPTA7aTxnZW9tZXRyeS5nZXROdW1HZW9tZXRyaWVzKCk7aSsrKXt0aGlzLmFkZChnZW9tZXRyeS5nZXRHZW9tZXRyeU4oaSkpO319fTtqc3RzLmFsZ29yaXRobS5JbnRlcmlvclBvaW50UG9pbnQucHJvdG90eXBlLmFkZFBvaW50PWZ1bmN0aW9uKHBvaW50KXt2YXIgZGlzdD1wb2ludC5kaXN0YW5jZSh0aGlzLmNlbnRyb2lkKTtpZihkaXN0PHRoaXMubWluRGlzdGFuY2Upe3RoaXMuaW50ZXJpb3JQb2ludD1uZXcganN0cy5nZW9tLkNvb3JkaW5hdGUocG9pbnQpO3RoaXMubWluRGlzdGFuY2U9ZGlzdDt9fTtqc3RzLmFsZ29yaXRobS5JbnRlcmlvclBvaW50UG9pbnQucHJvdG90eXBlLmdldEludGVyaW9yUG9pbnQ9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5pbnRlcmlvclBvaW50O307KGZ1bmN0aW9uKCl7anN0cy5nZW9tLk11bHRpTGluZVN0cmluZz1mdW5jdGlvbihnZW9tZXRyaWVzLGZhY3Rvcnkpe3RoaXMuZ2VvbWV0cmllcz1nZW9tZXRyaWVzfHxbXTt0aGlzLmZhY3Rvcnk9ZmFjdG9yeTt9O2pzdHMuZ2VvbS5NdWx0aUxpbmVTdHJpbmcucHJvdG90eXBlPW5ldyBqc3RzLmdlb20uR2VvbWV0cnlDb2xsZWN0aW9uKCk7anN0cy5nZW9tLk11bHRpTGluZVN0cmluZy5jb25zdHJ1Y3Rvcj1qc3RzLmdlb20uTXVsdGlMaW5lU3RyaW5nO2pzdHMuZ2VvbS5NdWx0aUxpbmVTdHJpbmcucHJvdG90eXBlLmdldEJvdW5kYXJ5PWZ1bmN0aW9uKCl7cmV0dXJuKG5ldyBqc3RzLm9wZXJhdGlvbi5Cb3VuZGFyeU9wKHRoaXMpKS5nZXRCb3VuZGFyeSgpO307anN0cy5nZW9tLk11bHRpTGluZVN0cmluZy5wcm90b3R5cGUuZXF1YWxzRXhhY3Q9ZnVuY3Rpb24ob3RoZXIsdG9sZXJhbmNlKXtpZighdGhpcy5pc0VxdWl2YWxlbnRDbGFzcyhvdGhlcikpe3JldHVybiBmYWxzZTt9XG5yZXR1cm4ganN0cy5nZW9tLkdlb21ldHJ5Q29sbGVjdGlvbi5wcm90b3R5cGUuZXF1YWxzRXhhY3QuY2FsbCh0aGlzLG90aGVyLHRvbGVyYW5jZSk7fTtqc3RzLmdlb20uTXVsdGlMaW5lU3RyaW5nLnByb3RvdHlwZS5DTEFTU19OQU1FPSdqc3RzLmdlb20uTXVsdGlMaW5lU3RyaW5nJzt9KSgpOyhmdW5jdGlvbigpe3ZhciBJbnRlcnZhbD1qc3RzLmluZGV4LmJpbnRyZWUuSW50ZXJ2YWw7dmFyIFJvb3Q9anN0cy5pbmRleC5iaW50cmVlLlJvb3Q7dmFyIEJpbnRyZWU9ZnVuY3Rpb24oKXt0aGlzLnJvb3Q9bmV3IFJvb3QoKTt0aGlzLm1pbkV4dGVudD0xLjA7fTtCaW50cmVlLmVuc3VyZUV4dGVudD1mdW5jdGlvbihpdGVtSW50ZXJ2YWwsbWluRXh0ZW50KXt2YXIgbWluLG1heDttaW49aXRlbUludGVydmFsLmdldE1pbigpO21heD1pdGVtSW50ZXJ2YWwuZ2V0TWF4KCk7aWYobWluIT09bWF4KXtyZXR1cm4gaXRlbUludGVydmFsO31cbmlmKG1pbj09PW1heCl7bWluPW1pbi0obWluRXh0ZW50LzIuMCk7bWF4PW1pbisobWluRXh0ZW50LzIuMCk7fVxucmV0dXJuIG5ldyBJbnRlcnZhbChtaW4sbWF4KTt9O0JpbnRyZWUucHJvdG90eXBlLmRlcHRoPWZ1bmN0aW9uKCl7aWYodGhpcy5yb290IT09bnVsbCl7cmV0dXJuIHRoaXMucm9vdC5kZXB0aCgpO31cbnJldHVybiAwO307QmludHJlZS5wcm90b3R5cGUuc2l6ZT1mdW5jdGlvbigpe2lmKHRoaXMucm9vdCE9PW51bGwpe3JldHVybiB0aGlzLnJvb3Quc2l6ZSgpO31cbnJldHVybiAwO307QmludHJlZS5wcm90b3R5cGUubm9kZVNpemU9ZnVuY3Rpb24oKXtpZih0aGlzLnJvb3QhPT1udWxsKXtyZXR1cm4gdGhpcy5yb290Lm5vZGVTaXplKCk7fVxucmV0dXJuIDA7fTtCaW50cmVlLnByb3RvdHlwZS5pbnNlcnQ9ZnVuY3Rpb24oaXRlbUludGVydmFsLGl0ZW0pe3RoaXMuY29sbGVjdFN0YXRzKGl0ZW1JbnRlcnZhbCk7dmFyIGluc2VydEludGVydmFsPUJpbnRyZWUuZW5zdXJlRXh0ZW50KGl0ZW1JbnRlcnZhbCx0aGlzLm1pbkV4dGVudCk7dGhpcy5yb290Lmluc2VydChpbnNlcnRJbnRlcnZhbCxpdGVtKTt9O0JpbnRyZWUucHJvdG90eXBlLnJlbW92ZT1mdW5jdGlvbihpdGVtSW50ZXJ2YWwsaXRlbSl7dmFyIGluc2VydEludGVydmFsPUJpbnRyZWUuZW5zdXJlRXh0ZW50KGl0ZW1JbnRlcnZhbCx0aGlzLm1pbkV4dGVudCk7cmV0dXJuIHRoaXMucm9vdC5yZW1vdmUoaW5zZXJ0SW50ZXJ2YWwsaXRlbSk7fTtCaW50cmVlLnByb3RvdHlwZS5pdGVyYXRvcj1mdW5jdGlvbigpe3ZhciBmb3VuZEl0ZW1zPW5ldyBqYXZhc2NyaXB0LnV0aWwuQXJyYXlMaXN0KCk7dGhpcy5yb290LmFkZEFsbEl0ZW1zKGZvdW5kSXRlbXMpO3JldHVybiBmb3VuZEl0ZW1zLml0ZXJhdG9yKCk7fTtCaW50cmVlLnByb3RvdHlwZS5xdWVyeT1mdW5jdGlvbigpe2lmKGFyZ3VtZW50cy5sZW5ndGg9PT0yKXt0aGlzLnF1ZXJ5QW5kQWRkKGFyZ3VtZW50c1swXSxhcmd1bWVudHNbMV0pO31lbHNle3ZhciB4PWFyZ3VtZW50c1swXTtpZigheCBpbnN0YW5jZW9mIEludGVydmFsKXt4PW5ldyBJbnRlcnZhbCh4LHgpO31cbnJldHVybiB0aGlzLnF1ZXJ5SW50ZXJ2YWwoeCk7fX07QmludHJlZS5wcm90b3R5cGUucXVlcnlJbnRlcnZhbD1mdW5jdGlvbihpbnRlcnZhbCl7dmFyIGZvdW5kSXRlbXM9bmV3IGphdmFzY3JpcHQudXRpbC5BcnJheUxpc3QoKTt0aGlzLnF1ZXJ5KGludGVydmFsLGZvdW5kSXRlbXMpO3JldHVybiBmb3VuZEl0ZW1zO307QmludHJlZS5wcm90b3R5cGUucXVlcnlBbmRBZGQ9ZnVuY3Rpb24oaW50ZXJ2YWwsZm91bmRJdGVtcyl7dGhpcy5yb290LmFkZEFsbEl0ZW1zRnJvbU92ZXJsYXBwaW5nKGludGVydmFsLGZvdW5kSXRlbXMpO307QmludHJlZS5wcm90b3R5cGUuY29sbGVjdFN0YXRzPWZ1bmN0aW9uKGludGVydmFsKXt2YXIgZGVsPWludGVydmFsLmdldFdpZHRoKCk7aWYoZGVsPHRoaXMubWluRXh0ZW50JiZkZWw+MC4wKXt0aGlzLm1pbkV4dGVudD1kZWw7fX07anN0cy5pbmRleC5iaW50cmVlLkJpbnRyZWU9QmludHJlZTt9KSgpO2pzdHMuYWxnb3JpdGhtLkludGVyaW9yUG9pbnRBcmVhPWZ1bmN0aW9uKGdlb21ldHJ5KXt0aGlzLmZhY3Rvcnk7dGhpcy5pbnRlcmlvclBvaW50PW51bGw7dGhpcy5tYXhXaWR0aD0wO3RoaXMuZmFjdG9yeT1nZW9tZXRyeS5nZXRGYWN0b3J5KCk7dGhpcy5hZGQoZ2VvbWV0cnkpO307anN0cy5hbGdvcml0aG0uSW50ZXJpb3JQb2ludEFyZWEuYXZnPWZ1bmN0aW9uKGEsYil7cmV0dXJuKGErYikvMjt9O2pzdHMuYWxnb3JpdGhtLkludGVyaW9yUG9pbnRBcmVhLnByb3RvdHlwZS5nZXRJbnRlcmlvclBvaW50PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuaW50ZXJpb3JQb2ludDt9O2pzdHMuYWxnb3JpdGhtLkludGVyaW9yUG9pbnRBcmVhLnByb3RvdHlwZS5hZGQ9ZnVuY3Rpb24oZ2VvbWV0cnkpe2lmKGdlb21ldHJ5IGluc3RhbmNlb2YganN0cy5nZW9tLlBvbHlnb24pe3RoaXMuYWRkUG9seWdvbihnZW9tZXRyeSk7fWVsc2UgaWYoZ2VvbWV0cnkgaW5zdGFuY2VvZiBqc3RzLmdlb20uR2VvbWV0cnlDb2xsZWN0aW9uKXtmb3IodmFyIGk9MDtpPGdlb21ldHJ5LmdldE51bUdlb21ldHJpZXMoKTtpKyspe3RoaXMuYWRkKGdlb21ldHJ5LmdldEdlb21ldHJ5TihpKSk7fX19O2pzdHMuYWxnb3JpdGhtLkludGVyaW9yUG9pbnRBcmVhLnByb3RvdHlwZS5hZGRQb2x5Z29uPWZ1bmN0aW9uKGdlb21ldHJ5KXtpZihnZW9tZXRyeS5pc0VtcHR5KCkpe3JldHVybjt9XG52YXIgaW50UHQ7dmFyIHdpZHRoPTA7dmFyIGJpc2VjdG9yPXRoaXMuaG9yaXpvbnRhbEJpc2VjdG9yKGdlb21ldHJ5KTtpZihiaXNlY3Rvci5nZXRMZW5ndGgoKT09MC4wKXt3aWR0aD0wO2ludFB0PWJpc2VjdG9yLmdldENvb3JkaW5hdGUoKTt9ZWxzZXt2YXIgaW50ZXJzZWN0aW9ucz1iaXNlY3Rvci5pbnRlcnNlY3Rpb24oZ2VvbWV0cnkpO3ZhciB3aWRlc3RJbnRlcnNlY3Rpb249dGhpcy53aWRlc3RHZW9tZXRyeShpbnRlcnNlY3Rpb25zKTt3aWR0aD13aWRlc3RJbnRlcnNlY3Rpb24uZ2V0RW52ZWxvcGVJbnRlcm5hbCgpLmdldFdpZHRoKCk7aW50UHQ9dGhpcy5jZW50cmUod2lkZXN0SW50ZXJzZWN0aW9uLmdldEVudmVsb3BlSW50ZXJuYWwoKSk7fVxuaWYodGhpcy5pbnRlcmlvclBvaW50PT1udWxsfHx3aWR0aD50aGlzLm1heFdpZHRoKXt0aGlzLmludGVyaW9yUG9pbnQ9aW50UHQ7dGhpcy5tYXhXaWR0aD13aWR0aDt9fTtqc3RzLmFsZ29yaXRobS5JbnRlcmlvclBvaW50QXJlYS5wcm90b3R5cGUud2lkZXN0R2VvbWV0cnk9ZnVuY3Rpb24ob2JqKXtpZihvYmogaW5zdGFuY2VvZiBqc3RzLmdlb20uR2VvbWV0cnlDb2xsZWN0aW9uKXt2YXIgZ2M9b2JqO2lmKGdjLmlzRW1wdHkoKSl7cmV0dXJuIGdjO31cbnZhciB3aWRlc3RHZW9tZXRyeT1nYy5nZXRHZW9tZXRyeU4oMCk7Zm9yKHZhciBpPTE7aTxnYy5nZXROdW1HZW9tZXRyaWVzKCk7aSsrKXtpZihnYy5nZXRHZW9tZXRyeU4oaSkuZ2V0RW52ZWxvcGVJbnRlcm5hbCgpLmdldFdpZHRoKCk+d2lkZXN0R2VvbWV0cnkuZ2V0RW52ZWxvcGVJbnRlcm5hbCgpLmdldFdpZHRoKCkpe3dpZGVzdEdlb21ldHJ5PWdjLmdldEdlb21ldHJ5TihpKTt9fVxucmV0dXJuIHdpZGVzdEdlb21ldHJ5O31lbHNlIGlmKG9iaiBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5HZW9tZXRyeSl7cmV0dXJuIG9iajt9fTtqc3RzLmFsZ29yaXRobS5JbnRlcmlvclBvaW50QXJlYS5wcm90b3R5cGUuaG9yaXpvbnRhbEJpc2VjdG9yPWZ1bmN0aW9uKGdlb21ldHJ5KXt2YXIgZW52ZWxvcGU9Z2VvbWV0cnkuZ2V0RW52ZWxvcGVJbnRlcm5hbCgpO3ZhciBiaXNlY3RZPWpzdHMuYWxnb3JpdGhtLlNhZmVCaXNlY3RvckZpbmRlci5nZXRCaXNlY3RvclkoZ2VvbWV0cnkpO3JldHVybiB0aGlzLmZhY3RvcnkuY3JlYXRlTGluZVN0cmluZyhbbmV3IGpzdHMuZ2VvbS5Db29yZGluYXRlKGVudmVsb3BlLmdldE1pblgoKSxiaXNlY3RZKSxuZXcganN0cy5nZW9tLkNvb3JkaW5hdGUoZW52ZWxvcGUuZ2V0TWF4WCgpLGJpc2VjdFkpXSk7fTtqc3RzLmFsZ29yaXRobS5JbnRlcmlvclBvaW50QXJlYS5wcm90b3R5cGUuY2VudHJlPWZ1bmN0aW9uKGVudmVsb3BlKXtyZXR1cm4gbmV3IGpzdHMuZ2VvbS5Db29yZGluYXRlKGpzdHMuYWxnb3JpdGhtLkludGVyaW9yUG9pbnRBcmVhLmF2ZyhlbnZlbG9wZS5nZXRNaW5YKCksZW52ZWxvcGUuZ2V0TWF4WCgpKSxqc3RzLmFsZ29yaXRobS5JbnRlcmlvclBvaW50QXJlYS5hdmcoZW52ZWxvcGUuZ2V0TWluWSgpLGVudmVsb3BlLmdldE1heFkoKSkpO307anN0cy5hbGdvcml0aG0uU2FmZUJpc2VjdG9yRmluZGVyPWZ1bmN0aW9uKHBvbHkpe3RoaXMucG9seTt0aGlzLmNlbnRyZVk7dGhpcy5oaVk9TnVtYmVyLk1BWF9WQUxVRTt0aGlzLmxvWT0tTnVtYmVyLk1BWF9WQUxVRTt0aGlzLnBvbHk9cG9seTt0aGlzLmhpWT1wb2x5LmdldEVudmVsb3BlSW50ZXJuYWwoKS5nZXRNYXhZKCk7dGhpcy5sb1k9cG9seS5nZXRFbnZlbG9wZUludGVybmFsKCkuZ2V0TWluWSgpO3RoaXMuY2VudHJlWT1qc3RzLmFsZ29yaXRobS5JbnRlcmlvclBvaW50QXJlYS5hdmcodGhpcy5sb1ksdGhpcy5oaVkpO307anN0cy5hbGdvcml0aG0uU2FmZUJpc2VjdG9yRmluZGVyLmdldEJpc2VjdG9yWT1mdW5jdGlvbihwb2x5KXt2YXIgZmluZGVyPW5ldyBqc3RzLmFsZ29yaXRobS5TYWZlQmlzZWN0b3JGaW5kZXIocG9seSk7cmV0dXJuIGZpbmRlci5nZXRCaXNlY3RvclkoKTt9O2pzdHMuYWxnb3JpdGhtLlNhZmVCaXNlY3RvckZpbmRlci5wcm90b3R5cGUuZ2V0QmlzZWN0b3JZPWZ1bmN0aW9uKCl7dGhpcy5wcm9jZXNzKHRoaXMucG9seS5nZXRFeHRlcmlvclJpbmcoKSk7Zm9yKHZhciBpPTA7aTx0aGlzLnBvbHkuZ2V0TnVtSW50ZXJpb3JSaW5nKCk7aSsrKXt0aGlzLnByb2Nlc3ModGhpcy5wb2x5LmdldEludGVyaW9yUmluZ04oaSkpO31cbnZhciBiaXNlY3RZPWpzdHMuYWxnb3JpdGhtLkludGVyaW9yUG9pbnRBcmVhLmF2Zyh0aGlzLmhpWSx0aGlzLmxvWSk7cmV0dXJuIGJpc2VjdFk7fTtqc3RzLmFsZ29yaXRobS5TYWZlQmlzZWN0b3JGaW5kZXIucHJvdG90eXBlLnByb2Nlc3M9ZnVuY3Rpb24obGluZSl7dmFyIHNlcT1saW5lLmdldENvb3JkaW5hdGVTZXF1ZW5jZSgpO2Zvcih2YXIgaT0wO2k8c2VxLmxlbmd0aDtpKyspe3ZhciB5PXNlcVtpXS55O3RoaXMudXBkYXRlSW50ZXJ2YWwoeSk7fX07anN0cy5hbGdvcml0aG0uU2FmZUJpc2VjdG9yRmluZGVyLnByb3RvdHlwZS51cGRhdGVJbnRlcnZhbD1mdW5jdGlvbih5KXtpZih5PD10aGlzLmNlbnRyZVkpe2lmKHk+dGhpcy5sb1kpe3RoaXMubG9ZPXk7fX1lbHNlIGlmKHk+dGhpcy5jZW50cmVZKXtpZih5PHRoaXMuaGlZKXt0aGlzLmhpWT15O319fTtqc3RzLm9wZXJhdGlvbi5idWZmZXIuQnVmZmVyUGFyYW1ldGVycz1mdW5jdGlvbihxdWFkcmFudFNlZ21lbnRzLGVuZENhcFN0eWxlLGpvaW5TdHlsZSxtaXRyZUxpbWl0KXtpZihxdWFkcmFudFNlZ21lbnRzKVxudGhpcy5zZXRRdWFkcmFudFNlZ21lbnRzKHF1YWRyYW50U2VnbWVudHMpO2lmKGVuZENhcFN0eWxlKVxudGhpcy5zZXRFbmRDYXBTdHlsZShlbmRDYXBTdHlsZSk7aWYoam9pblN0eWxlKVxudGhpcy5zZXRKb2luU3R5bGUoam9pblN0eWxlKTtpZihtaXRyZUxpbWl0KVxudGhpcy5zZXRNaXRyZUxpbWl0KG1pdHJlTGltaXQpO307anN0cy5vcGVyYXRpb24uYnVmZmVyLkJ1ZmZlclBhcmFtZXRlcnMuQ0FQX1JPVU5EPTE7anN0cy5vcGVyYXRpb24uYnVmZmVyLkJ1ZmZlclBhcmFtZXRlcnMuQ0FQX0ZMQVQ9Mjtqc3RzLm9wZXJhdGlvbi5idWZmZXIuQnVmZmVyUGFyYW1ldGVycy5DQVBfU1FVQVJFPTM7anN0cy5vcGVyYXRpb24uYnVmZmVyLkJ1ZmZlclBhcmFtZXRlcnMuSk9JTl9ST1VORD0xO2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5CdWZmZXJQYXJhbWV0ZXJzLkpPSU5fTUlUUkU9Mjtqc3RzLm9wZXJhdGlvbi5idWZmZXIuQnVmZmVyUGFyYW1ldGVycy5KT0lOX0JFVkVMPTM7anN0cy5vcGVyYXRpb24uYnVmZmVyLkJ1ZmZlclBhcmFtZXRlcnMuREVGQVVMVF9RVUFEUkFOVF9TRUdNRU5UUz04O2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5CdWZmZXJQYXJhbWV0ZXJzLkRFRkFVTFRfTUlUUkVfTElNSVQ9NS4wO2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5CdWZmZXJQYXJhbWV0ZXJzLnByb3RvdHlwZS5xdWFkcmFudFNlZ21lbnRzPWpzdHMub3BlcmF0aW9uLmJ1ZmZlci5CdWZmZXJQYXJhbWV0ZXJzLkRFRkFVTFRfUVVBRFJBTlRfU0VHTUVOVFM7anN0cy5vcGVyYXRpb24uYnVmZmVyLkJ1ZmZlclBhcmFtZXRlcnMucHJvdG90eXBlLmVuZENhcFN0eWxlPWpzdHMub3BlcmF0aW9uLmJ1ZmZlci5CdWZmZXJQYXJhbWV0ZXJzLkNBUF9ST1VORDtqc3RzLm9wZXJhdGlvbi5idWZmZXIuQnVmZmVyUGFyYW1ldGVycy5wcm90b3R5cGUuam9pblN0eWxlPWpzdHMub3BlcmF0aW9uLmJ1ZmZlci5CdWZmZXJQYXJhbWV0ZXJzLkpPSU5fUk9VTkQ7anN0cy5vcGVyYXRpb24uYnVmZmVyLkJ1ZmZlclBhcmFtZXRlcnMucHJvdG90eXBlLm1pdHJlTGltaXQ9anN0cy5vcGVyYXRpb24uYnVmZmVyLkJ1ZmZlclBhcmFtZXRlcnMuREVGQVVMVF9NSVRSRV9MSU1JVDtqc3RzLm9wZXJhdGlvbi5idWZmZXIuQnVmZmVyUGFyYW1ldGVycy5wcm90b3R5cGUuX2lzU2luZ2xlU2lkZWQ9ZmFsc2U7anN0cy5vcGVyYXRpb24uYnVmZmVyLkJ1ZmZlclBhcmFtZXRlcnMucHJvdG90eXBlLmdldFF1YWRyYW50U2VnbWVudHM9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5xdWFkcmFudFNlZ21lbnRzO307anN0cy5vcGVyYXRpb24uYnVmZmVyLkJ1ZmZlclBhcmFtZXRlcnMucHJvdG90eXBlLnNldFF1YWRyYW50U2VnbWVudHM9ZnVuY3Rpb24ocXVhZHJhbnRTZWdtZW50cyl7dGhpcy5xdWFkcmFudFNlZ21lbnRzPXF1YWRyYW50U2VnbWVudHM7fTtqc3RzLm9wZXJhdGlvbi5idWZmZXIuQnVmZmVyUGFyYW1ldGVycy5wcm90b3R5cGUuc2V0UXVhZHJhbnRTZWdtZW50cz1mdW5jdGlvbihxdWFkU2Vncyl7dGhpcy5xdWFkcmFudFNlZ21lbnRzPXF1YWRTZWdzO2lmKHRoaXMucXVhZHJhbnRTZWdtZW50cz09PTApXG50aGlzLmpvaW5TdHlsZT1qc3RzLm9wZXJhdGlvbi5idWZmZXIuQnVmZmVyUGFyYW1ldGVycy5KT0lOX0JFVkVMO2lmKHRoaXMucXVhZHJhbnRTZWdtZW50czwwKXt0aGlzLmpvaW5TdHlsZT1qc3RzLm9wZXJhdGlvbi5idWZmZXIuQnVmZmVyUGFyYW1ldGVycy5KT0lOX01JVFJFO3RoaXMubWl0cmVMaW1pdD1NYXRoLmFicyh0aGlzLnF1YWRyYW50U2VnbWVudHMpO31cbmlmKHF1YWRTZWdzPD0wKXt0aGlzLnF1YWRyYW50U2VnbWVudHM9MTt9XG5pZih0aGlzLmpvaW5TdHlsZSE9PWpzdHMub3BlcmF0aW9uLmJ1ZmZlci5CdWZmZXJQYXJhbWV0ZXJzLkpPSU5fUk9VTkQpe3RoaXMucXVhZHJhbnRTZWdtZW50cz1qc3RzLm9wZXJhdGlvbi5idWZmZXIuQnVmZmVyUGFyYW1ldGVycy5ERUZBVUxUX1FVQURSQU5UX1NFR01FTlRTO319O2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5CdWZmZXJQYXJhbWV0ZXJzLmJ1ZmZlckRpc3RhbmNlRXJyb3I9ZnVuY3Rpb24ocXVhZFNlZ3Mpe3ZhciBhbHBoYT1NYXRoLlBJLzIuMC9xdWFkU2VncztyZXR1cm4gMS1NYXRoLmNvcyhhbHBoYS8yLjApO307anN0cy5vcGVyYXRpb24uYnVmZmVyLkJ1ZmZlclBhcmFtZXRlcnMucHJvdG90eXBlLmdldEVuZENhcFN0eWxlPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZW5kQ2FwU3R5bGU7fTtqc3RzLm9wZXJhdGlvbi5idWZmZXIuQnVmZmVyUGFyYW1ldGVycy5wcm90b3R5cGUuc2V0RW5kQ2FwU3R5bGU9ZnVuY3Rpb24oZW5kQ2FwU3R5bGUpe3RoaXMuZW5kQ2FwU3R5bGU9ZW5kQ2FwU3R5bGU7fTtqc3RzLm9wZXJhdGlvbi5idWZmZXIuQnVmZmVyUGFyYW1ldGVycy5wcm90b3R5cGUuZ2V0Sm9pblN0eWxlPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuam9pblN0eWxlO307anN0cy5vcGVyYXRpb24uYnVmZmVyLkJ1ZmZlclBhcmFtZXRlcnMucHJvdG90eXBlLnNldEpvaW5TdHlsZT1mdW5jdGlvbihqb2luU3R5bGUpe3RoaXMuam9pblN0eWxlPWpvaW5TdHlsZTt9O2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5CdWZmZXJQYXJhbWV0ZXJzLnByb3RvdHlwZS5nZXRNaXRyZUxpbWl0PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMubWl0cmVMaW1pdDt9O2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5CdWZmZXJQYXJhbWV0ZXJzLnByb3RvdHlwZS5zZXRNaXRyZUxpbWl0PWZ1bmN0aW9uKG1pdHJlTGltaXQpe3RoaXMubWl0cmVMaW1pdD1taXRyZUxpbWl0O307anN0cy5vcGVyYXRpb24uYnVmZmVyLkJ1ZmZlclBhcmFtZXRlcnMucHJvdG90eXBlLnNldFNpbmdsZVNpZGVkPWZ1bmN0aW9uKGlzU2luZ2xlU2lkZWQpe3RoaXMuX2lzU2luZ2xlU2lkZWQ9aXNTaW5nbGVTaWRlZDt9O2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5CdWZmZXJQYXJhbWV0ZXJzLnByb3RvdHlwZS5pc1NpbmdsZVNpZGVkPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2lzU2luZ2xlU2lkZWQ7fTsoZnVuY3Rpb24oKXtqc3RzLmdlb20udXRpbC5TaG9ydENpcmN1aXRlZEdlb21ldHJ5VmlzaXRvcj1mdW5jdGlvbigpe307anN0cy5nZW9tLnV0aWwuU2hvcnRDaXJjdWl0ZWRHZW9tZXRyeVZpc2l0b3IucHJvdG90eXBlLmlzRG9uZT1mYWxzZTtqc3RzLmdlb20udXRpbC5TaG9ydENpcmN1aXRlZEdlb21ldHJ5VmlzaXRvci5wcm90b3R5cGUuYXBwbHlUbz1mdW5jdGlvbihnZW9tKXtmb3IodmFyIGk9MDtpPGdlb20uZ2V0TnVtR2VvbWV0cmllcygpJiYhdGhpcy5pc0RvbmU7aSsrKXt2YXIgZWxlbWVudD1nZW9tLmdldEdlb21ldHJ5TihpKTtpZighKGVsZW1lbnQgaW5zdGFuY2VvZiBqc3RzLmdlb20uR2VvbWV0cnlDb2xsZWN0aW9uKSl7dGhpcy52aXNpdChlbGVtZW50KTtpZih0aGlzLmlzRG9uZSgpKXt0aGlzLmlzRG9uZT10cnVlO3JldHVybjt9fVxuZWxzZVxudGhpcy5hcHBseVRvKGVsZW1lbnQpO319XG5qc3RzLmdlb20udXRpbC5TaG9ydENpcmN1aXRlZEdlb21ldHJ5VmlzaXRvci5wcm90b3R5cGUudmlzaXQ9ZnVuY3Rpb24oZWxlbWVudCl7fTtqc3RzLmdlb20udXRpbC5TaG9ydENpcmN1aXRlZEdlb21ldHJ5VmlzaXRvci5wcm90b3R5cGUuaXNEb25lPWZ1bmN0aW9uKCl7fTt9KSgpOyhmdW5jdGlvbigpe3ZhciBFbnZlbG9wZUludGVyc2VjdHNWaXNpdG9yPWZ1bmN0aW9uKHJlY3RFbnYpe3RoaXMucmVjdEVudj1yZWN0RW52O307RW52ZWxvcGVJbnRlcnNlY3RzVmlzaXRvci5wcm90b3R5cGU9bmV3IGpzdHMuZ2VvbS51dGlsLlNob3J0Q2lyY3VpdGVkR2VvbWV0cnlWaXNpdG9yKCk7RW52ZWxvcGVJbnRlcnNlY3RzVmlzaXRvci5jb25zdHJ1Y3Rvcj1FbnZlbG9wZUludGVyc2VjdHNWaXNpdG9yO0VudmVsb3BlSW50ZXJzZWN0c1Zpc2l0b3IucHJvdG90eXBlLnJlY3RFbnY9bnVsbDtFbnZlbG9wZUludGVyc2VjdHNWaXNpdG9yLnByb3RvdHlwZS5pbnRlcnNlY3RzPWZhbHNlO0VudmVsb3BlSW50ZXJzZWN0c1Zpc2l0b3IucHJvdG90eXBlLmludGVyc2VjdHM9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5pbnRlcnNlY3RzO31cbkVudmVsb3BlSW50ZXJzZWN0c1Zpc2l0b3IucHJvdG90eXBlLnZpc2l0PWZ1bmN0aW9uKGVsZW1lbnQpe3ZhciBlbGVtZW50RW52PWVsZW1lbnQuZ2V0RW52ZWxvcGVJbnRlcm5hbCgpO2lmKCF0aGlzLnJlY3RFbnYuaW50ZXJzZWN0cyhlbGVtZW50RW52KSl7cmV0dXJuO31cbmlmKHRoaXMucmVjdEVudi5jb250YWlucyhlbGVtZW50RW52KSl7dGhpcy5pbnRlcnNlY3RzPXRydWU7cmV0dXJuO31cbmlmKGVsZW1lbnRFbnYuZ2V0TWluWCgpPj1yZWN0RW52LmdldE1pblgoKSYmZWxlbWVudEVudi5nZXRNYXhYKCk8PXJlY3RFbnYuZ2V0TWF4WCgpKXt0aGlzLmludGVyc2VjdHM9dHJ1ZTtyZXR1cm47fVxuaWYoZWxlbWVudEVudi5nZXRNaW5ZKCk+PXJlY3RFbnYuZ2V0TWluWSgpJiZlbGVtZW50RW52LmdldE1heFkoKTw9cmVjdEVudi5nZXRNYXhZKCkpe3RoaXMuaW50ZXJzZWN0cz10cnVlO3JldHVybjt9fVxuRW52ZWxvcGVJbnRlcnNlY3RzVmlzaXRvci5wcm90b3R5cGUuaXNEb25lPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuaW50ZXJzZWN0cz09dHJ1ZTt9XG52YXIgR2VvbWV0cnlDb250YWluc1BvaW50VmlzaXRvcj1mdW5jdGlvbihyZWN0YW5nbGUpe3RoaXMucmVjdFNlcT1yZWN0YW5nbGUuZ2V0RXh0ZXJpb3JSaW5nKCkuZ2V0Q29vcmRpbmF0ZVNlcXVlbmNlKCk7dGhpcy5yZWN0RW52PXJlY3RhbmdsZS5nZXRFbnZlbG9wZUludGVybmFsKCk7fTtHZW9tZXRyeUNvbnRhaW5zUG9pbnRWaXNpdG9yLnByb3RvdHlwZT1uZXcganN0cy5nZW9tLnV0aWwuU2hvcnRDaXJjdWl0ZWRHZW9tZXRyeVZpc2l0b3IoKTtHZW9tZXRyeUNvbnRhaW5zUG9pbnRWaXNpdG9yLmNvbnN0cnVjdG9yPUdlb21ldHJ5Q29udGFpbnNQb2ludFZpc2l0b3I7R2VvbWV0cnlDb250YWluc1BvaW50VmlzaXRvci5wcm90b3R5cGUucmVjdFNlcT1udWxsO0dlb21ldHJ5Q29udGFpbnNQb2ludFZpc2l0b3IucHJvdG90eXBlLnJlY3RFbnY9bnVsbDtHZW9tZXRyeUNvbnRhaW5zUG9pbnRWaXNpdG9yLnByb3RvdHlwZS5jb250YWluc1BvaW50PWZhbHNlO0dlb21ldHJ5Q29udGFpbnNQb2ludFZpc2l0b3IucHJvdG90eXBlLmNvbnRhaW5zUG9pbnQ9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5jb250YWluc1BvaW50O31cbkdlb21ldHJ5Q29udGFpbnNQb2ludFZpc2l0b3IucHJvdG90eXBlLnZpc2l0PWZ1bmN0aW9uKGdlb20pe2lmKCEoZ2VvbSBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5Qb2x5Z29uKSlcbnJldHVybjt2YXIgZWxlbWVudEVudj1nZW9tLmdldEVudmVsb3BlSW50ZXJuYWwoKTtpZighdGhpcy5yZWN0RW52LmludGVyc2VjdHMoZWxlbWVudEVudikpXG5yZXR1cm47dmFyIHJlY3RQdD1uZXcganN0cy5nZW9tLkNvb3JkaW5hdGUoKTtmb3IodmFyIGk9MDtpPDQ7aSsrKXt0aGlzLnJlY3RTZXEuZ2V0Q29vcmRpbmF0ZShpLHJlY3RQdCk7aWYoIWVsZW1lbnRFbnYuY29udGFpbnMocmVjdFB0KSlcbmNvbnRpbnVlO2lmKFNpbXBsZVBvaW50SW5BcmVhTG9jYXRvci5jb250YWluc1BvaW50SW5Qb2x5Z29uKHJlY3RQdCxnZW9tKSl7dGhpcy5jb250YWluc1BvaW50PXRydWU7cmV0dXJuO319fVxuR2VvbWV0cnlDb250YWluc1BvaW50VmlzaXRvci5wcm90b3R5cGUuaXNEb25lPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuY29udGFpbnNQb2ludD09dHJ1ZTt9XG52YXIgUmVjdGFuZ2xlSW50ZXJzZWN0c1NlZ21lbnRWaXNpdG9yPWZ1bmN0aW9uKHJlY3RhbmdsZSl7dGhpcy5yZWN0RW52PXJlY3RhbmdsZS5nZXRFbnZlbG9wZUludGVybmFsKCk7dGhpcy5yZWN0SW50ZXJzZWN0b3I9bmV3IFJlY3RhbmdsZUxpbmVJbnRlcnNlY3RvcihyZWN0RW52KTt9O1JlY3RhbmdsZUludGVyc2VjdHNTZWdtZW50VmlzaXRvci5wcm90b3R5cGU9bmV3IGpzdHMuZ2VvbS51dGlsLlNob3J0Q2lyY3VpdGVkR2VvbWV0cnlWaXNpdG9yKCk7UmVjdGFuZ2xlSW50ZXJzZWN0c1NlZ21lbnRWaXNpdG9yLmNvbnN0cnVjdG9yPVJlY3RhbmdsZUludGVyc2VjdHNTZWdtZW50VmlzaXRvcjtSZWN0YW5nbGVJbnRlcnNlY3RzU2VnbWVudFZpc2l0b3IucHJvdG90eXBlLnJlY3RFbnY9bnVsbDtSZWN0YW5nbGVJbnRlcnNlY3RzU2VnbWVudFZpc2l0b3IucHJvdG90eXBlLnJlY3RJbnRlcnNlY3Rvcj1udWxsO1JlY3RhbmdsZUludGVyc2VjdHNTZWdtZW50VmlzaXRvci5wcm90b3R5cGUuaGFzSW50ZXJzZWN0aW9uPWZhbHNlO1JlY3RhbmdsZUludGVyc2VjdHNTZWdtZW50VmlzaXRvci5wcm90b3R5cGUucDA9bnVsbDtSZWN0YW5nbGVJbnRlcnNlY3RzU2VnbWVudFZpc2l0b3IucHJvdG90eXBlLnAxPW51bGw7UmVjdGFuZ2xlSW50ZXJzZWN0c1NlZ21lbnRWaXNpdG9yLnByb3RvdHlwZS5pbnRlcnNlY3RzPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuaGFzSW50ZXJzZWN0aW9uO31cblJlY3RhbmdsZUludGVyc2VjdHNTZWdtZW50VmlzaXRvci5wcm90b3R5cGUudmlzaXQ9ZnVuY3Rpb24oZ2VvbSl7dmFyIGVsZW1lbnRFbnY9Z2VvbS5nZXRFbnZlbG9wZUludGVybmFsKCk7aWYoIXRoaXMucmVjdEVudi5pbnRlcnNlY3RzKGVsZW1lbnRFbnYpKVxucmV0dXJuO3ZhciBsaW5lcz1MaW5lYXJDb21wb25lbnRFeHRyYWN0ZXIuZ2V0TGluZXMoZ2VvbSk7dGhpcy5jaGVja0ludGVyc2VjdGlvbldpdGhMaW5lU3RyaW5ncyhsaW5lcyk7fVxuUmVjdGFuZ2xlSW50ZXJzZWN0c1NlZ21lbnRWaXNpdG9yLnByb3RvdHlwZS5jaGVja0ludGVyc2VjdGlvbldpdGhMaW5lU3RyaW5ncz1mdW5jdGlvbihsaW5lcyl7Zm9yKHZhciBpPWxpbmVzLml0ZXJhdG9yKCk7aS5oYXNOZXh0KCk7KXt2YXIgdGVzdExpbmU9aS5uZXh0KCk7dGhpcy5jaGVja0ludGVyc2VjdGlvbldpdGhTZWdtZW50cyh0ZXN0TGluZSk7aWYodGhpcy5oYXNJbnRlcnNlY3Rpb24pXG5yZXR1cm47fX1cblJlY3RhbmdsZUludGVyc2VjdHNTZWdtZW50VmlzaXRvci5wcm90b3R5cGUuY2hlY2tJbnRlcnNlY3Rpb25XaXRoU2VnbWVudHM9ZnVuY3Rpb24odGVzdExpbmUpe3ZhciBzZXExPXRlc3RMaW5lLmdldENvb3JkaW5hdGVTZXF1ZW5jZSgpO2Zvcih2YXIgaj0xO2o8c2VxMS5sZW5ndGg7aisrKXt0aGlzLnAwPXNlcTFbai0xXTt0aGlzLnAxPXNlcTFbal07aWYocmVjdEludGVyc2VjdG9yLmludGVyc2VjdHMocDAscDEpKXt0aGlzLmhhc0ludGVyc2VjdGlvbj10cnVlO3JldHVybjt9fX1cblJlY3RhbmdsZUludGVyc2VjdHNTZWdtZW50VmlzaXRvci5wcm90b3R5cGUuaXNEb25lPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuaGFzSW50ZXJzZWN0aW9uPT10cnVlO31cbmpzdHMub3BlcmF0aW9uLnByZWRpY2F0ZS5SZWN0YW5nbGVJbnRlcnNlY3RzPWZ1bmN0aW9uKHJlY3RhbmdsZSl7dGhpcy5yZWN0YW5nbGU9cmVjdGFuZ2xlO3RoaXMucmVjdEVudj1yZWN0YW5nbGUuZ2V0RW52ZWxvcGVJbnRlcm5hbCgpO31cbmpzdHMub3BlcmF0aW9uLnByZWRpY2F0ZS5SZWN0YW5nbGVJbnRlcnNlY3RzLmludGVyc2VjdHM9ZnVuY3Rpb24ocmVjdGFuZ2xlLGIpe3ZhciBycD1uZXcganN0cy5vcGVyYXRpb24ucHJlZGljYXRlLlJlY3RhbmdsZUludGVyc2VjdHMocmVjdGFuZ2xlKTtyZXR1cm4gcnAuaW50ZXJzZWN0cyhiKTt9XG5qc3RzLm9wZXJhdGlvbi5wcmVkaWNhdGUuUmVjdGFuZ2xlSW50ZXJzZWN0cy5wcm90b3R5cGUucmVjdGFuZ2xlPW51bGw7anN0cy5vcGVyYXRpb24ucHJlZGljYXRlLlJlY3RhbmdsZUludGVyc2VjdHMucHJvdG90eXBlLnJlY3RFbnY9bnVsbDtqc3RzLm9wZXJhdGlvbi5wcmVkaWNhdGUuUmVjdGFuZ2xlSW50ZXJzZWN0cy5wcm90b3R5cGUuaW50ZXJzZWN0cz1mdW5jdGlvbihnZW9tKXtpZighdGhpcy5yZWN0RW52LmludGVyc2VjdHMoZ2VvbS5nZXRFbnZlbG9wZUludGVybmFsKCkpKVxucmV0dXJuIGZhbHNlO3ZhciB2aXNpdG9yPW5ldyBFbnZlbG9wZUludGVyc2VjdHNWaXNpdG9yKHRoaXMucmVjdEVudik7dmlzaXRvci5hcHBseVRvKGdlb20pO2lmKHZpc2l0b3IuaW50ZXJzZWN0cygpKVxucmV0dXJuIHRydWU7dmFyIGVjcFZpc2l0b3I9bmV3IEdlb21ldHJ5Q29udGFpbnNQb2ludFZpc2l0b3IocmVjdGFuZ2xlKTtlY3BWaXNpdG9yLmFwcGx5VG8oZ2VvbSk7aWYoZWNwVmlzaXRvci5jb250YWluc1BvaW50KCkpXG5yZXR1cm4gdHJ1ZTt2YXIgcmlWaXNpdG9yPW5ldyBSZWN0YW5nbGVJbnRlcnNlY3RzU2VnbWVudFZpc2l0b3IocmVjdGFuZ2xlKTtyaVZpc2l0b3IuYXBwbHlUbyhnZW9tKTtpZihyaVZpc2l0b3IuaW50ZXJzZWN0cygpKVxucmV0dXJuIHRydWU7cmV0dXJuIGZhbHNlO319KSgpO2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5CdWZmZXJCdWlsZGVyPWZ1bmN0aW9uKGJ1ZlBhcmFtcyl7dGhpcy5idWZQYXJhbXM9YnVmUGFyYW1zO3RoaXMuZWRnZUxpc3Q9bmV3IGpzdHMuZ2VvbWdyYXBoLkVkZ2VMaXN0KCk7fTtqc3RzLm9wZXJhdGlvbi5idWZmZXIuQnVmZmVyQnVpbGRlci5kZXB0aERlbHRhPWZ1bmN0aW9uKGxhYmVsKXt2YXIgbExvYz1sYWJlbC5nZXRMb2NhdGlvbigwLGpzdHMuZ2VvbWdyYXBoLlBvc2l0aW9uLkxFRlQpO3ZhciByTG9jPWxhYmVsLmdldExvY2F0aW9uKDAsanN0cy5nZW9tZ3JhcGguUG9zaXRpb24uUklHSFQpO2lmKGxMb2M9PT1qc3RzLmdlb20uTG9jYXRpb24uSU5URVJJT1ImJnJMb2M9PT1qc3RzLmdlb20uTG9jYXRpb24uRVhURVJJT1IpXG5yZXR1cm4gMTtlbHNlIGlmKGxMb2M9PT1qc3RzLmdlb20uTG9jYXRpb24uRVhURVJJT1ImJnJMb2M9PT1qc3RzLmdlb20uTG9jYXRpb24uSU5URVJJT1IpXG5yZXR1cm4tMTtyZXR1cm4gMDt9O2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5CdWZmZXJCdWlsZGVyLnByb3RvdHlwZS5idWZQYXJhbXM9bnVsbDtqc3RzLm9wZXJhdGlvbi5idWZmZXIuQnVmZmVyQnVpbGRlci5wcm90b3R5cGUud29ya2luZ1ByZWNpc2lvbk1vZGVsPW51bGw7anN0cy5vcGVyYXRpb24uYnVmZmVyLkJ1ZmZlckJ1aWxkZXIucHJvdG90eXBlLndvcmtpbmdOb2Rlcj1udWxsO2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5CdWZmZXJCdWlsZGVyLnByb3RvdHlwZS5nZW9tRmFjdD1udWxsO2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5CdWZmZXJCdWlsZGVyLnByb3RvdHlwZS5ncmFwaD1udWxsO2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5CdWZmZXJCdWlsZGVyLnByb3RvdHlwZS5lZGdlTGlzdD1udWxsO2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5CdWZmZXJCdWlsZGVyLnByb3RvdHlwZS5zZXRXb3JraW5nUHJlY2lzaW9uTW9kZWw9ZnVuY3Rpb24ocG0pe3RoaXMud29ya2luZ1ByZWNpc2lvbk1vZGVsPXBtO307anN0cy5vcGVyYXRpb24uYnVmZmVyLkJ1ZmZlckJ1aWxkZXIucHJvdG90eXBlLnNldE5vZGVyPWZ1bmN0aW9uKG5vZGVyKXt0aGlzLndvcmtpbmdOb2Rlcj1ub2Rlcjt9O2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5CdWZmZXJCdWlsZGVyLnByb3RvdHlwZS5idWZmZXI9ZnVuY3Rpb24oZyxkaXN0YW5jZSl7dmFyIHByZWNpc2lvbk1vZGVsPXRoaXMud29ya2luZ1ByZWNpc2lvbk1vZGVsO2lmKHByZWNpc2lvbk1vZGVsPT09bnVsbClcbnByZWNpc2lvbk1vZGVsPWcuZ2V0UHJlY2lzaW9uTW9kZWwoKTt0aGlzLmdlb21GYWN0PWcuZ2V0RmFjdG9yeSgpO3ZhciBjdXJ2ZUJ1aWxkZXI9bmV3IGpzdHMub3BlcmF0aW9uLmJ1ZmZlci5PZmZzZXRDdXJ2ZUJ1aWxkZXIocHJlY2lzaW9uTW9kZWwsdGhpcy5idWZQYXJhbXMpO3ZhciBjdXJ2ZVNldEJ1aWxkZXI9bmV3IGpzdHMub3BlcmF0aW9uLmJ1ZmZlci5PZmZzZXRDdXJ2ZVNldEJ1aWxkZXIoZyxkaXN0YW5jZSxjdXJ2ZUJ1aWxkZXIpO3ZhciBidWZmZXJTZWdTdHJMaXN0PWN1cnZlU2V0QnVpbGRlci5nZXRDdXJ2ZXMoKTtpZihidWZmZXJTZWdTdHJMaXN0LnNpemUoKTw9MCl7cmV0dXJuIHRoaXMuY3JlYXRlRW1wdHlSZXN1bHRHZW9tZXRyeSgpO31cbnRoaXMuY29tcHV0ZU5vZGVkRWRnZXMoYnVmZmVyU2VnU3RyTGlzdCxwcmVjaXNpb25Nb2RlbCk7dGhpcy5ncmFwaD1uZXcganN0cy5nZW9tZ3JhcGguUGxhbmFyR3JhcGgobmV3IGpzdHMub3BlcmF0aW9uLm92ZXJsYXkuT3ZlcmxheU5vZGVGYWN0b3J5KCkpO3RoaXMuZ3JhcGguYWRkRWRnZXModGhpcy5lZGdlTGlzdC5nZXRFZGdlcygpKTt2YXIgc3ViZ3JhcGhMaXN0PXRoaXMuY3JlYXRlU3ViZ3JhcGhzKHRoaXMuZ3JhcGgpO3ZhciBwb2x5QnVpbGRlcj1uZXcganN0cy5vcGVyYXRpb24ub3ZlcmxheS5Qb2x5Z29uQnVpbGRlcih0aGlzLmdlb21GYWN0KTt0aGlzLmJ1aWxkU3ViZ3JhcGhzKHN1YmdyYXBoTGlzdCxwb2x5QnVpbGRlcik7dmFyIHJlc3VsdFBvbHlMaXN0PXBvbHlCdWlsZGVyLmdldFBvbHlnb25zKCk7aWYocmVzdWx0UG9seUxpc3Quc2l6ZSgpPD0wKXtyZXR1cm4gdGhpcy5jcmVhdGVFbXB0eVJlc3VsdEdlb21ldHJ5KCk7fVxudmFyIHJlc3VsdEdlb209dGhpcy5nZW9tRmFjdC5idWlsZEdlb21ldHJ5KHJlc3VsdFBvbHlMaXN0KTtyZXR1cm4gcmVzdWx0R2VvbTt9O2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5CdWZmZXJCdWlsZGVyLnByb3RvdHlwZS5nZXROb2Rlcj1mdW5jdGlvbihwcmVjaXNpb25Nb2RlbCl7aWYodGhpcy53b3JraW5nTm9kZXIhPT1udWxsKVxucmV0dXJuIHRoaXMud29ya2luZ05vZGVyO3ZhciBub2Rlcj1uZXcganN0cy5ub2RpbmcuTUNJbmRleE5vZGVyKCk7dmFyIGxpPW5ldyBqc3RzLmFsZ29yaXRobS5Sb2J1c3RMaW5lSW50ZXJzZWN0b3IoKTtsaS5zZXRQcmVjaXNpb25Nb2RlbChwcmVjaXNpb25Nb2RlbCk7bm9kZXIuc2V0U2VnbWVudEludGVyc2VjdG9yKG5ldyBqc3RzLm5vZGluZy5JbnRlcnNlY3Rpb25BZGRlcihsaSkpO3JldHVybiBub2Rlcjt9O2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5CdWZmZXJCdWlsZGVyLnByb3RvdHlwZS5jb21wdXRlTm9kZWRFZGdlcz1mdW5jdGlvbihidWZmZXJTZWdTdHJMaXN0LHByZWNpc2lvbk1vZGVsKXt2YXIgbm9kZXI9dGhpcy5nZXROb2RlcihwcmVjaXNpb25Nb2RlbCk7bm9kZXIuY29tcHV0ZU5vZGVzKGJ1ZmZlclNlZ1N0ckxpc3QpO3ZhciBub2RlZFNlZ1N0cmluZ3M9bm9kZXIuZ2V0Tm9kZWRTdWJzdHJpbmdzKCk7Zm9yKHZhciBpPW5vZGVkU2VnU3RyaW5ncy5pdGVyYXRvcigpO2kuaGFzTmV4dCgpOyl7dmFyIHNlZ1N0cj1pLm5leHQoKTt2YXIgb2xkTGFiZWw9c2VnU3RyLmdldERhdGEoKTt2YXIgZWRnZT1uZXcganN0cy5nZW9tZ3JhcGguRWRnZShzZWdTdHIuZ2V0Q29vcmRpbmF0ZXMoKSxuZXcganN0cy5nZW9tZ3JhcGguTGFiZWwob2xkTGFiZWwpKTt0aGlzLmluc2VydFVuaXF1ZUVkZ2UoZWRnZSk7fX07anN0cy5vcGVyYXRpb24uYnVmZmVyLkJ1ZmZlckJ1aWxkZXIucHJvdG90eXBlLmluc2VydFVuaXF1ZUVkZ2U9ZnVuY3Rpb24oZSl7dmFyIGV4aXN0aW5nRWRnZT10aGlzLmVkZ2VMaXN0LmZpbmRFcXVhbEVkZ2UoZSk7aWYoZXhpc3RpbmdFZGdlIT1udWxsKXt2YXIgZXhpc3RpbmdMYWJlbD1leGlzdGluZ0VkZ2UuZ2V0TGFiZWwoKTt2YXIgbGFiZWxUb01lcmdlPWUuZ2V0TGFiZWwoKTtpZighZXhpc3RpbmdFZGdlLmlzUG9pbnR3aXNlRXF1YWwoZSkpe2xhYmVsVG9NZXJnZT1uZXcganN0cy5nZW9tZ3JhcGguTGFiZWwoZS5nZXRMYWJlbCgpKTtsYWJlbFRvTWVyZ2UuZmxpcCgpO31cbmV4aXN0aW5nTGFiZWwubWVyZ2UobGFiZWxUb01lcmdlKTt2YXIgbWVyZ2VEZWx0YT1qc3RzLm9wZXJhdGlvbi5idWZmZXIuQnVmZmVyQnVpbGRlci5kZXB0aERlbHRhKGxhYmVsVG9NZXJnZSk7dmFyIGV4aXN0aW5nRGVsdGE9ZXhpc3RpbmdFZGdlLmdldERlcHRoRGVsdGEoKTt2YXIgbmV3RGVsdGE9ZXhpc3RpbmdEZWx0YSttZXJnZURlbHRhO2V4aXN0aW5nRWRnZS5zZXREZXB0aERlbHRhKG5ld0RlbHRhKTt9ZWxzZXt0aGlzLmVkZ2VMaXN0LmFkZChlKTtlLnNldERlcHRoRGVsdGEoanN0cy5vcGVyYXRpb24uYnVmZmVyLkJ1ZmZlckJ1aWxkZXIuZGVwdGhEZWx0YShlLmdldExhYmVsKCkpKTt9fTtqc3RzLm9wZXJhdGlvbi5idWZmZXIuQnVmZmVyQnVpbGRlci5wcm90b3R5cGUuY3JlYXRlU3ViZ3JhcGhzPWZ1bmN0aW9uKGdyYXBoKXt2YXIgc3ViZ3JhcGhMaXN0PVtdO2Zvcih2YXIgaT1ncmFwaC5nZXROb2RlcygpLml0ZXJhdG9yKCk7aS5oYXNOZXh0KCk7KXt2YXIgbm9kZT1pLm5leHQoKTtpZighbm9kZS5pc1Zpc2l0ZWQoKSl7dmFyIHN1YmdyYXBoPW5ldyBqc3RzLm9wZXJhdGlvbi5idWZmZXIuQnVmZmVyU3ViZ3JhcGgoKTtzdWJncmFwaC5jcmVhdGUobm9kZSk7c3ViZ3JhcGhMaXN0LnB1c2goc3ViZ3JhcGgpO319XG52YXIgY29tcGFyZT1mdW5jdGlvbihhLGIpe3JldHVybiBhLmNvbXBhcmVUbyhiKTt9O3N1YmdyYXBoTGlzdC5zb3J0KGNvbXBhcmUpO3N1YmdyYXBoTGlzdC5yZXZlcnNlKCk7cmV0dXJuIHN1YmdyYXBoTGlzdDt9O2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5CdWZmZXJCdWlsZGVyLnByb3RvdHlwZS5idWlsZFN1YmdyYXBocz1mdW5jdGlvbihzdWJncmFwaExpc3QscG9seUJ1aWxkZXIpe3ZhciBwcm9jZXNzZWRHcmFwaHM9W107Zm9yKHZhciBpPTA7aTxzdWJncmFwaExpc3QubGVuZ3RoO2krKyl7dmFyIHN1YmdyYXBoPXN1YmdyYXBoTGlzdFtpXTt2YXIgcD1zdWJncmFwaC5nZXRSaWdodG1vc3RDb29yZGluYXRlKCk7dmFyIGxvY2F0ZXI9bmV3IGpzdHMub3BlcmF0aW9uLmJ1ZmZlci5TdWJncmFwaERlcHRoTG9jYXRlcihwcm9jZXNzZWRHcmFwaHMpO3ZhciBvdXRzaWRlRGVwdGg9bG9jYXRlci5nZXREZXB0aChwKTtzdWJncmFwaC5jb21wdXRlRGVwdGgob3V0c2lkZURlcHRoKTtzdWJncmFwaC5maW5kUmVzdWx0RWRnZXMoKTtwcm9jZXNzZWRHcmFwaHMucHVzaChzdWJncmFwaCk7cG9seUJ1aWxkZXIuYWRkKHN1YmdyYXBoLmdldERpcmVjdGVkRWRnZXMoKSxzdWJncmFwaC5nZXROb2RlcygpKTt9fTtqc3RzLm9wZXJhdGlvbi5idWZmZXIuQnVmZmVyQnVpbGRlci5jb252ZXJ0U2VnU3RyaW5ncz1mdW5jdGlvbihpdCl7dmFyIGZhY3Q9bmV3IGpzdHMuZ2VvbS5HZW9tZXRyeUZhY3RvcnkoKTt2YXIgbGluZXM9bmV3IGphdmFzY3JpcHQudXRpbC5BcnJheUxpc3QoKTt3aGlsZShpdC5oYXNOZXh0KCkpe3ZhciBzcz1pdC5uZXh0KCk7dmFyIGxpbmU9ZmFjdC5jcmVhdGVMaW5lU3RyaW5nKHNzLmdldENvb3JkaW5hdGVzKCkpO2xpbmVzLmFkZChsaW5lKTt9XG5yZXR1cm4gZmFjdC5idWlsZEdlb21ldHJ5KGxpbmVzKTt9O2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5CdWZmZXJCdWlsZGVyLnByb3RvdHlwZS5jcmVhdGVFbXB0eVJlc3VsdEdlb21ldHJ5PWZ1bmN0aW9uKCl7dmFyIGVtcHR5R2VvbT10aGlzLmdlb21GYWN0LmNyZWF0ZVBvbHlnb24obnVsbCxudWxsKTtyZXR1cm4gZW1wdHlHZW9tO307anN0cy5ub2RpbmcuU2VnbWVudFBvaW50Q29tcGFyYXRvcj1mdW5jdGlvbigpe307anN0cy5ub2RpbmcuU2VnbWVudFBvaW50Q29tcGFyYXRvci5jb21wYXJlPWZ1bmN0aW9uKG9jdGFudCxwMCxwMSl7aWYocDAuZXF1YWxzMkQocDEpKVxucmV0dXJuIDA7dmFyIHhTaWduPWpzdHMubm9kaW5nLlNlZ21lbnRQb2ludENvbXBhcmF0b3IucmVsYXRpdmVTaWduKHAwLngscDEueCk7dmFyIHlTaWduPWpzdHMubm9kaW5nLlNlZ21lbnRQb2ludENvbXBhcmF0b3IucmVsYXRpdmVTaWduKHAwLnkscDEueSk7c3dpdGNoKG9jdGFudCl7Y2FzZSAwOnJldHVybiBqc3RzLm5vZGluZy5TZWdtZW50UG9pbnRDb21wYXJhdG9yLmNvbXBhcmVWYWx1ZSh4U2lnbix5U2lnbik7Y2FzZSAxOnJldHVybiBqc3RzLm5vZGluZy5TZWdtZW50UG9pbnRDb21wYXJhdG9yLmNvbXBhcmVWYWx1ZSh5U2lnbix4U2lnbik7Y2FzZSAyOnJldHVybiBqc3RzLm5vZGluZy5TZWdtZW50UG9pbnRDb21wYXJhdG9yLmNvbXBhcmVWYWx1ZSh5U2lnbiwteFNpZ24pO2Nhc2UgMzpyZXR1cm4ganN0cy5ub2RpbmcuU2VnbWVudFBvaW50Q29tcGFyYXRvci5jb21wYXJlVmFsdWUoLXhTaWduLHlTaWduKTtjYXNlIDQ6cmV0dXJuIGpzdHMubm9kaW5nLlNlZ21lbnRQb2ludENvbXBhcmF0b3IuY29tcGFyZVZhbHVlKC14U2lnbiwteVNpZ24pO2Nhc2UgNTpyZXR1cm4ganN0cy5ub2RpbmcuU2VnbWVudFBvaW50Q29tcGFyYXRvci5jb21wYXJlVmFsdWUoLXlTaWduLC14U2lnbik7Y2FzZSA2OnJldHVybiBqc3RzLm5vZGluZy5TZWdtZW50UG9pbnRDb21wYXJhdG9yLmNvbXBhcmVWYWx1ZSgteVNpZ24seFNpZ24pO2Nhc2UgNzpyZXR1cm4ganN0cy5ub2RpbmcuU2VnbWVudFBvaW50Q29tcGFyYXRvci5jb21wYXJlVmFsdWUoeFNpZ24sLXlTaWduKTt9XG5yZXR1cm4gMDt9O2pzdHMubm9kaW5nLlNlZ21lbnRQb2ludENvbXBhcmF0b3IucmVsYXRpdmVTaWduPWZ1bmN0aW9uKHgwLHgxKXtpZih4MDx4MSlcbnJldHVybi0xO2lmKHgwPngxKVxucmV0dXJuIDE7cmV0dXJuIDA7fTtqc3RzLm5vZGluZy5TZWdtZW50UG9pbnRDb21wYXJhdG9yLmNvbXBhcmVWYWx1ZT1mdW5jdGlvbihjb21wYXJlU2lnbjAsY29tcGFyZVNpZ24xKXtpZihjb21wYXJlU2lnbjA8MClcbnJldHVybi0xO2lmKGNvbXBhcmVTaWduMD4wKVxucmV0dXJuIDE7aWYoY29tcGFyZVNpZ24xPDApXG5yZXR1cm4tMTtpZihjb21wYXJlU2lnbjE+MClcbnJldHVybiAxO3JldHVybiAwO307anN0cy5vcGVyYXRpb24ucmVsYXRlLlJlbGF0ZU9wPWZ1bmN0aW9uKCl7anN0cy5vcGVyYXRpb24uR2VvbWV0cnlHcmFwaE9wZXJhdGlvbi5hcHBseSh0aGlzLGFyZ3VtZW50cyk7dGhpcy5fcmVsYXRlPW5ldyBqc3RzLm9wZXJhdGlvbi5yZWxhdGUuUmVsYXRlQ29tcHV0ZXIodGhpcy5hcmcpO307anN0cy5vcGVyYXRpb24ucmVsYXRlLlJlbGF0ZU9wLnByb3RvdHlwZT1uZXcganN0cy5vcGVyYXRpb24uR2VvbWV0cnlHcmFwaE9wZXJhdGlvbigpO2pzdHMub3BlcmF0aW9uLnJlbGF0ZS5SZWxhdGVPcC5yZWxhdGU9ZnVuY3Rpb24oYSxiLGJvdW5kYXJ5Tm9kZVJ1bGUpe3ZhciByZWxPcD1uZXcganN0cy5vcGVyYXRpb24ucmVsYXRlLlJlbGF0ZU9wKGEsYixib3VuZGFyeU5vZGVSdWxlKTt2YXIgaW09cmVsT3AuZ2V0SW50ZXJzZWN0aW9uTWF0cml4KCk7cmV0dXJuIGltO307anN0cy5vcGVyYXRpb24ucmVsYXRlLlJlbGF0ZU9wLnByb3RvdHlwZS5fcmVsYXRlPW51bGw7anN0cy5vcGVyYXRpb24ucmVsYXRlLlJlbGF0ZU9wLnByb3RvdHlwZS5nZXRJbnRlcnNlY3Rpb25NYXRyaXg9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fcmVsYXRlLmNvbXB1dGVJTSgpO307anN0cy5pbmRleC5jaGFpbi5Nb25vdG9uZUNoYWluPWZ1bmN0aW9uKHB0cyxzdGFydCxlbmQsY29udGV4dCl7dGhpcy5wdHM9cHRzO3RoaXMuc3RhcnQ9c3RhcnQ7dGhpcy5lbmQ9ZW5kO3RoaXMuY29udGV4dD1jb250ZXh0O307anN0cy5pbmRleC5jaGFpbi5Nb25vdG9uZUNoYWluLnByb3RvdHlwZS5wdHM9bnVsbDtqc3RzLmluZGV4LmNoYWluLk1vbm90b25lQ2hhaW4ucHJvdG90eXBlLnN0YXJ0PW51bGw7anN0cy5pbmRleC5jaGFpbi5Nb25vdG9uZUNoYWluLnByb3RvdHlwZS5lbmQ9bnVsbDtqc3RzLmluZGV4LmNoYWluLk1vbm90b25lQ2hhaW4ucHJvdG90eXBlLmVudj1udWxsO2pzdHMuaW5kZXguY2hhaW4uTW9ub3RvbmVDaGFpbi5wcm90b3R5cGUuY29udGV4dD1udWxsO2pzdHMuaW5kZXguY2hhaW4uTW9ub3RvbmVDaGFpbi5wcm90b3R5cGUuaWQ9bnVsbDtqc3RzLmluZGV4LmNoYWluLk1vbm90b25lQ2hhaW4ucHJvdG90eXBlLnNldElkPWZ1bmN0aW9uKGlkKXt0aGlzLmlkPWlkO307anN0cy5pbmRleC5jaGFpbi5Nb25vdG9uZUNoYWluLnByb3RvdHlwZS5nZXRJZD1mdW5jdGlvbigpe3JldHVybiB0aGlzLmlkO307anN0cy5pbmRleC5jaGFpbi5Nb25vdG9uZUNoYWluLnByb3RvdHlwZS5nZXRDb250ZXh0PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuY29udGV4dDt9O2pzdHMuaW5kZXguY2hhaW4uTW9ub3RvbmVDaGFpbi5wcm90b3R5cGUuZ2V0RW52ZWxvcGU9ZnVuY3Rpb24oKXtpZih0aGlzLmVudj09bnVsbCl7dmFyIHAwPXRoaXMucHRzW3RoaXMuc3RhcnRdO3ZhciBwMT10aGlzLnB0c1t0aGlzLmVuZF07dGhpcy5lbnY9bmV3IGpzdHMuZ2VvbS5FbnZlbG9wZShwMCxwMSk7fVxucmV0dXJuIHRoaXMuZW52O307anN0cy5pbmRleC5jaGFpbi5Nb25vdG9uZUNoYWluLnByb3RvdHlwZS5nZXRTdGFydEluZGV4PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuc3RhcnQ7fTtqc3RzLmluZGV4LmNoYWluLk1vbm90b25lQ2hhaW4ucHJvdG90eXBlLmdldEVuZEluZGV4PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZW5kO307anN0cy5pbmRleC5jaGFpbi5Nb25vdG9uZUNoYWluLnByb3RvdHlwZS5nZXRMaW5lU2VnbWVudD1mdW5jdGlvbihpbmRleCxscyl7bHMucDA9dGhpcy5wdHNbaW5kZXhdO2xzLnAxPXRoaXMucHRzW2luZGV4KzFdO307anN0cy5pbmRleC5jaGFpbi5Nb25vdG9uZUNoYWluLnByb3RvdHlwZS5nZXRDb29yZGluYXRlcz1mdW5jdGlvbigpe3ZhciBjb29yZD1bXTt2YXIgaW5kZXg9MDtmb3IodmFyIGk9dGhpcy5zdGFydDtpPD10aGlzLmVuZDtpKyspe2Nvb3JkW2luZGV4KytdPXRoaXMucHRzW2ldO31cbnJldHVybiBjb29yZDt9O2pzdHMuaW5kZXguY2hhaW4uTW9ub3RvbmVDaGFpbi5wcm90b3R5cGUuc2VsZWN0PWZ1bmN0aW9uKHNlYXJjaEVudixtY3Mpe3RoaXMuY29tcHV0ZVNlbGVjdDIoc2VhcmNoRW52LHRoaXMuc3RhcnQsdGhpcy5lbmQsbWNzKTt9O2pzdHMuaW5kZXguY2hhaW4uTW9ub3RvbmVDaGFpbi5wcm90b3R5cGUuY29tcHV0ZVNlbGVjdDI9ZnVuY3Rpb24oc2VhcmNoRW52LHN0YXJ0MCxlbmQwLG1jcyl7dmFyIHAwPXRoaXMucHRzW3N0YXJ0MF07dmFyIHAxPXRoaXMucHRzW2VuZDBdO21jcy50ZW1wRW52MS5pbml0KHAwLHAxKTtpZihlbmQwLXN0YXJ0MD09PTEpe21jcy5zZWxlY3QodGhpcyxzdGFydDApO3JldHVybjt9XG5pZighc2VhcmNoRW52LmludGVyc2VjdHMobWNzLnRlbXBFbnYxKSlcbnJldHVybjt2YXIgbWlkPXBhcnNlSW50KChzdGFydDArZW5kMCkvMik7aWYoc3RhcnQwPG1pZCl7dGhpcy5jb21wdXRlU2VsZWN0MihzZWFyY2hFbnYsc3RhcnQwLG1pZCxtY3MpO31cbmlmKG1pZDxlbmQwKXt0aGlzLmNvbXB1dGVTZWxlY3QyKHNlYXJjaEVudixtaWQsZW5kMCxtY3MpO319O2pzdHMuaW5kZXguY2hhaW4uTW9ub3RvbmVDaGFpbi5wcm90b3R5cGUuY29tcHV0ZU92ZXJsYXBzPWZ1bmN0aW9uKG1jLG1jbyl7aWYoYXJndW1lbnRzLmxlbmd0aD09PTYpe3JldHVybiB0aGlzLmNvbXB1dGVPdmVybGFwczIuYXBwbHkodGhpcyxhcmd1bWVudHMpO31cbnRoaXMuY29tcHV0ZU92ZXJsYXBzMih0aGlzLnN0YXJ0LHRoaXMuZW5kLG1jLG1jLnN0YXJ0LG1jLmVuZCxtY28pO307anN0cy5pbmRleC5jaGFpbi5Nb25vdG9uZUNoYWluLnByb3RvdHlwZS5jb21wdXRlT3ZlcmxhcHMyPWZ1bmN0aW9uKHN0YXJ0MCxlbmQwLG1jLHN0YXJ0MSxlbmQxLG1jbyl7dmFyIHAwMD10aGlzLnB0c1tzdGFydDBdO3ZhciBwMDE9dGhpcy5wdHNbZW5kMF07dmFyIHAxMD1tYy5wdHNbc3RhcnQxXTt2YXIgcDExPW1jLnB0c1tlbmQxXTtpZihlbmQwLXN0YXJ0MD09PTEmJmVuZDEtc3RhcnQxPT09MSl7bWNvLm92ZXJsYXAodGhpcyxzdGFydDAsbWMsc3RhcnQxKTtyZXR1cm47fVxubWNvLnRlbXBFbnYxLmluaXQocDAwLHAwMSk7bWNvLnRlbXBFbnYyLmluaXQocDEwLHAxMSk7aWYoIW1jby50ZW1wRW52MS5pbnRlcnNlY3RzKG1jby50ZW1wRW52MikpXG5yZXR1cm47dmFyIG1pZDA9cGFyc2VJbnQoKHN0YXJ0MCtlbmQwKS8yKTt2YXIgbWlkMT1wYXJzZUludCgoc3RhcnQxK2VuZDEpLzIpO2lmKHN0YXJ0MDxtaWQwKXtpZihzdGFydDE8bWlkMSlcbnRoaXMuY29tcHV0ZU92ZXJsYXBzMihzdGFydDAsbWlkMCxtYyxzdGFydDEsbWlkMSxtY28pO2lmKG1pZDE8ZW5kMSlcbnRoaXMuY29tcHV0ZU92ZXJsYXBzMihzdGFydDAsbWlkMCxtYyxtaWQxLGVuZDEsbWNvKTt9XG5pZihtaWQwPGVuZDApe2lmKHN0YXJ0MTxtaWQxKVxudGhpcy5jb21wdXRlT3ZlcmxhcHMyKG1pZDAsZW5kMCxtYyxzdGFydDEsbWlkMSxtY28pO2lmKG1pZDE8ZW5kMSlcbnRoaXMuY29tcHV0ZU92ZXJsYXBzMihtaWQwLGVuZDAsbWMsbWlkMSxlbmQxLG1jbyk7fX07KGZ1bmN0aW9uKCl7dmFyIExvY2F0aW9uPWpzdHMuZ2VvbS5Mb2NhdGlvbjt2YXIgRGltZW5zaW9uPWpzdHMuZ2VvbS5EaW1lbnNpb247anN0cy5nZW9tLkludGVyc2VjdGlvbk1hdHJpeD1mdW5jdGlvbihlbGVtZW50cyl7dmFyIG90aGVyPWVsZW1lbnRzO2lmKGVsZW1lbnRzPT09dW5kZWZpbmVkfHxlbGVtZW50cz09PW51bGwpe3RoaXMubWF0cml4PVtbXSxbXSxbXV07dGhpcy5zZXRBbGwoRGltZW5zaW9uLkZBTFNFKTt9ZWxzZSBpZih0eXBlb2YgZWxlbWVudHM9PT0nc3RyaW5nJyl7dGhpcy5zZXQoZWxlbWVudHMpO31lbHNlIGlmKG90aGVyIGluc3RhbmNlb2YganN0cy5nZW9tLkludGVyc2VjdGlvbk1hdHJpeCl7dGhpcy5tYXRyaXhbTG9jYXRpb24uSU5URVJJT1JdW0xvY2F0aW9uLklOVEVSSU9SXT1vdGhlci5tYXRyaXhbTG9jYXRpb24uSU5URVJJT1JdW0xvY2F0aW9uLklOVEVSSU9SXTt0aGlzLm1hdHJpeFtMb2NhdGlvbi5JTlRFUklPUl1bTG9jYXRpb24uQk9VTkRBUlldPW90aGVyLm1hdHJpeFtMb2NhdGlvbi5JTlRFUklPUl1bTG9jYXRpb24uQk9VTkRBUlldO3RoaXMubWF0cml4W0xvY2F0aW9uLklOVEVSSU9SXVtMb2NhdGlvbi5FWFRFUklPUl09b3RoZXIubWF0cml4W0xvY2F0aW9uLklOVEVSSU9SXVtMb2NhdGlvbi5FWFRFUklPUl07dGhpcy5tYXRyaXhbTG9jYXRpb24uQk9VTkRBUlldW0xvY2F0aW9uLklOVEVSSU9SXT1vdGhlci5tYXRyaXhbTG9jYXRpb24uQk9VTkRBUlldW0xvY2F0aW9uLklOVEVSSU9SXTt0aGlzLm1hdHJpeFtMb2NhdGlvbi5CT1VOREFSWV1bTG9jYXRpb24uQk9VTkRBUlldPW90aGVyLm1hdHJpeFtMb2NhdGlvbi5CT1VOREFSWV1bTG9jYXRpb24uQk9VTkRBUlldO3RoaXMubWF0cml4W0xvY2F0aW9uLkJPVU5EQVJZXVtMb2NhdGlvbi5FWFRFUklPUl09b3RoZXIubWF0cml4W0xvY2F0aW9uLkJPVU5EQVJZXVtMb2NhdGlvbi5FWFRFUklPUl07dGhpcy5tYXRyaXhbTG9jYXRpb24uRVhURVJJT1JdW0xvY2F0aW9uLklOVEVSSU9SXT1vdGhlci5tYXRyaXhbTG9jYXRpb24uRVhURVJJT1JdW0xvY2F0aW9uLklOVEVSSU9SXTt0aGlzLm1hdHJpeFtMb2NhdGlvbi5FWFRFUklPUl1bTG9jYXRpb24uQk9VTkRBUlldPW90aGVyLm1hdHJpeFtMb2NhdGlvbi5FWFRFUklPUl1bTG9jYXRpb24uQk9VTkRBUlldO3RoaXMubWF0cml4W0xvY2F0aW9uLkVYVEVSSU9SXVtMb2NhdGlvbi5FWFRFUklPUl09b3RoZXIubWF0cml4W0xvY2F0aW9uLkVYVEVSSU9SXVtMb2NhdGlvbi5FWFRFUklPUl07fX07anN0cy5nZW9tLkludGVyc2VjdGlvbk1hdHJpeC5wcm90b3R5cGUubWF0cml4PW51bGw7anN0cy5nZW9tLkludGVyc2VjdGlvbk1hdHJpeC5wcm90b3R5cGUuYWRkPWZ1bmN0aW9uKGltKXt2YXIgaSxqO2ZvcihpPTA7aTwzO2krKyl7Zm9yKGo9MDtqPDM7aisrKXt0aGlzLnNldEF0TGVhc3QoaSxqLGltLmdldChpLGopKTt9fX07anN0cy5nZW9tLkludGVyc2VjdGlvbk1hdHJpeC5tYXRjaGVzPWZ1bmN0aW9uKGFjdHVhbERpbWVuc2lvblZhbHVlLHJlcXVpcmVkRGltZW5zaW9uU3ltYm9sKXtpZih0eXBlb2YgYWN0dWFsRGltZW5zaW9uVmFsdWU9PT0nc3RyaW5nJyl7cmV0dXJuIGpzdHMuZ2VvbS5JbnRlcnNlY3Rpb25NYXRyaXgubWF0Y2hlczIuY2FsbCh0aGlzLGFyZ3VtZW50cyk7fVxuaWYocmVxdWlyZWREaW1lbnNpb25TeW1ib2w9PT0nKicpe3JldHVybiB0cnVlO31cbmlmKHJlcXVpcmVkRGltZW5zaW9uU3ltYm9sPT09J1QnJiYoYWN0dWFsRGltZW5zaW9uVmFsdWU+PTB8fGFjdHVhbERpbWVuc2lvblZhbHVlPT09RGltZW5zaW9uLlRSVUUpKXtyZXR1cm4gdHJ1ZTt9XG5pZihyZXF1aXJlZERpbWVuc2lvblN5bWJvbD09PSdGJyYmYWN0dWFsRGltZW5zaW9uVmFsdWU9PT1EaW1lbnNpb24uRkFMU0Upe3JldHVybiB0cnVlO31cbmlmKHJlcXVpcmVkRGltZW5zaW9uU3ltYm9sPT09JzAnJiZhY3R1YWxEaW1lbnNpb25WYWx1ZT09PURpbWVuc2lvbi5QKXtyZXR1cm4gdHJ1ZTt9XG5pZihyZXF1aXJlZERpbWVuc2lvblN5bWJvbD09PScxJyYmYWN0dWFsRGltZW5zaW9uVmFsdWU9PT1EaW1lbnNpb24uTCl7cmV0dXJuIHRydWU7fVxuaWYocmVxdWlyZWREaW1lbnNpb25TeW1ib2w9PT0nMicmJmFjdHVhbERpbWVuc2lvblZhbHVlPT09RGltZW5zaW9uLkEpe3JldHVybiB0cnVlO31cbnJldHVybiBmYWxzZTt9O2pzdHMuZ2VvbS5JbnRlcnNlY3Rpb25NYXRyaXgubWF0Y2hlczI9ZnVuY3Rpb24oYWN0dWFsRGltZW5zaW9uU3ltYm9scyxyZXF1aXJlZERpbWVuc2lvblN5bWJvbHMpe3ZhciBtPW5ldyBqc3RzLmdlb20uSW50ZXJzZWN0aW9uTWF0cml4KGFjdHVhbERpbWVuc2lvblN5bWJvbHMpO3JldHVybiBtLm1hdGNoZXMocmVxdWlyZWREaW1lbnNpb25TeW1ib2xzKTt9O2pzdHMuZ2VvbS5JbnRlcnNlY3Rpb25NYXRyaXgucHJvdG90eXBlLnNldD1mdW5jdGlvbihyb3csY29sdW1uLGRpbWVuc2lvblZhbHVlKXtpZih0eXBlb2Ygcm93PT09J3N0cmluZycpe3RoaXMuc2V0Mihyb3cpO3JldHVybjt9XG50aGlzLm1hdHJpeFtyb3ddW2NvbHVtbl09ZGltZW5zaW9uVmFsdWU7fTtqc3RzLmdlb20uSW50ZXJzZWN0aW9uTWF0cml4LnByb3RvdHlwZS5zZXQyPWZ1bmN0aW9uKGRpbWVuc2lvblN5bWJvbHMpe2Zvcih2YXIgaT0wO2k8ZGltZW5zaW9uU3ltYm9scy5sZW5ndGgoKTtpKyspe3ZhciByb3c9aS8zO3ZhciBjb2w9aSUzO3RoaXMubWF0cml4W3Jvd11bY29sXT1EaW1lbnNpb24udG9EaW1lbnNpb25WYWx1ZShkaW1lbnNpb25TeW1ib2xzLmNoYXJBdChpKSk7fX07anN0cy5nZW9tLkludGVyc2VjdGlvbk1hdHJpeC5wcm90b3R5cGUuc2V0QXRMZWFzdD1mdW5jdGlvbihyb3csY29sdW1uLG1pbmltdW1EaW1lbnNpb25WYWx1ZSl7aWYoYXJndW1lbnRzLmxlbmd0aD09PTEpe3RoaXMuc2V0QXRMZWFzdDIoYXJndW1lbnRzWzBdKTtyZXR1cm47fVxuaWYodGhpcy5tYXRyaXhbcm93XVtjb2x1bW5dPG1pbmltdW1EaW1lbnNpb25WYWx1ZSl7dGhpcy5tYXRyaXhbcm93XVtjb2x1bW5dPW1pbmltdW1EaW1lbnNpb25WYWx1ZTt9fTtqc3RzLmdlb20uSW50ZXJzZWN0aW9uTWF0cml4LnByb3RvdHlwZS5zZXRBdExlYXN0SWZWYWxpZD1mdW5jdGlvbihyb3csY29sdW1uLG1pbmltdW1EaW1lbnNpb25WYWx1ZSl7aWYocm93Pj0wJiZjb2x1bW4+PTApe3RoaXMuc2V0QXRMZWFzdChyb3csY29sdW1uLG1pbmltdW1EaW1lbnNpb25WYWx1ZSk7fX07anN0cy5nZW9tLkludGVyc2VjdGlvbk1hdHJpeC5wcm90b3R5cGUuc2V0QXRMZWFzdDI9ZnVuY3Rpb24obWluaW11bURpbWVuc2lvblN5bWJvbHMpe3ZhciBpO2ZvcihpPTA7aTxtaW5pbXVtRGltZW5zaW9uU3ltYm9scy5sZW5ndGg7aSsrKXt2YXIgcm93PXBhcnNlSW50KGkvMyk7dmFyIGNvbD1wYXJzZUludChpJTMpO3RoaXMuc2V0QXRMZWFzdChyb3csY29sLGpzdHMuZ2VvbS5EaW1lbnNpb24udG9EaW1lbnNpb25WYWx1ZShtaW5pbXVtRGltZW5zaW9uU3ltYm9scy5jaGFyQXQoaSkpKTt9fTtqc3RzLmdlb20uSW50ZXJzZWN0aW9uTWF0cml4LnByb3RvdHlwZS5zZXRBbGw9ZnVuY3Rpb24oZGltZW5zaW9uVmFsdWUpe3ZhciBhaSxiaTtmb3IoYWk9MDthaTwzO2FpKyspe2ZvcihiaT0wO2JpPDM7YmkrKyl7dGhpcy5tYXRyaXhbYWldW2JpXT1kaW1lbnNpb25WYWx1ZTt9fX07anN0cy5nZW9tLkludGVyc2VjdGlvbk1hdHJpeC5wcm90b3R5cGUuZ2V0PWZ1bmN0aW9uKHJvdyxjb2x1bW4pe3JldHVybiB0aGlzLm1hdHJpeFtyb3ddW2NvbHVtbl07fTtqc3RzLmdlb20uSW50ZXJzZWN0aW9uTWF0cml4LnByb3RvdHlwZS5pc0Rpc2pvaW50PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMubWF0cml4W0xvY2F0aW9uLklOVEVSSU9SXVtMb2NhdGlvbi5JTlRFUklPUl09PT1EaW1lbnNpb24uRkFMU0UmJnRoaXMubWF0cml4W0xvY2F0aW9uLklOVEVSSU9SXVtMb2NhdGlvbi5CT1VOREFSWV09PT1EaW1lbnNpb24uRkFMU0UmJnRoaXMubWF0cml4W0xvY2F0aW9uLkJPVU5EQVJZXVtMb2NhdGlvbi5JTlRFUklPUl09PT1EaW1lbnNpb24uRkFMU0UmJnRoaXMubWF0cml4W0xvY2F0aW9uLkJPVU5EQVJZXVtMb2NhdGlvbi5CT1VOREFSWV09PT1EaW1lbnNpb24uRkFMU0U7fTtqc3RzLmdlb20uSW50ZXJzZWN0aW9uTWF0cml4LnByb3RvdHlwZS5pc0ludGVyc2VjdHM9ZnVuY3Rpb24oKXtyZXR1cm4hdGhpcy5pc0Rpc2pvaW50KCk7fTtqc3RzLmdlb20uSW50ZXJzZWN0aW9uTWF0cml4LnByb3RvdHlwZS5pc1RvdWNoZXM9ZnVuY3Rpb24oZGltZW5zaW9uT2ZHZW9tZXRyeUEsZGltZW5zaW9uT2ZHZW9tZXRyeUIpe2lmKGRpbWVuc2lvbk9mR2VvbWV0cnlBPmRpbWVuc2lvbk9mR2VvbWV0cnlCKXtyZXR1cm4gdGhpcy5pc1RvdWNoZXMoZGltZW5zaW9uT2ZHZW9tZXRyeUIsZGltZW5zaW9uT2ZHZW9tZXRyeUEpO31cbmlmKChkaW1lbnNpb25PZkdlb21ldHJ5QT09RGltZW5zaW9uLkEmJmRpbWVuc2lvbk9mR2VvbWV0cnlCPT1EaW1lbnNpb24uQSl8fChkaW1lbnNpb25PZkdlb21ldHJ5QT09RGltZW5zaW9uLkwmJmRpbWVuc2lvbk9mR2VvbWV0cnlCPT1EaW1lbnNpb24uTCl8fChkaW1lbnNpb25PZkdlb21ldHJ5QT09RGltZW5zaW9uLkwmJmRpbWVuc2lvbk9mR2VvbWV0cnlCPT1EaW1lbnNpb24uQSl8fChkaW1lbnNpb25PZkdlb21ldHJ5QT09RGltZW5zaW9uLlAmJmRpbWVuc2lvbk9mR2VvbWV0cnlCPT1EaW1lbnNpb24uQSl8fChkaW1lbnNpb25PZkdlb21ldHJ5QT09RGltZW5zaW9uLlAmJmRpbWVuc2lvbk9mR2VvbWV0cnlCPT1EaW1lbnNpb24uTCkpe3JldHVybiB0aGlzLm1hdHJpeFtMb2NhdGlvbi5JTlRFUklPUl1bTG9jYXRpb24uSU5URVJJT1JdPT09RGltZW5zaW9uLkZBTFNFJiYoanN0cy5nZW9tLkludGVyc2VjdGlvbk1hdHJpeC5tYXRjaGVzKHRoaXMubWF0cml4W0xvY2F0aW9uLklOVEVSSU9SXVtMb2NhdGlvbi5CT1VOREFSWV0sJ1QnKXx8anN0cy5nZW9tLkludGVyc2VjdGlvbk1hdHJpeC5tYXRjaGVzKHRoaXMubWF0cml4W0xvY2F0aW9uLkJPVU5EQVJZXVtMb2NhdGlvbi5JTlRFUklPUl0sJ1QnKXx8anN0cy5nZW9tLkludGVyc2VjdGlvbk1hdHJpeC5tYXRjaGVzKHRoaXMubWF0cml4W0xvY2F0aW9uLkJPVU5EQVJZXVtMb2NhdGlvbi5CT1VOREFSWV0sJ1QnKSk7fVxucmV0dXJuIGZhbHNlO307anN0cy5nZW9tLkludGVyc2VjdGlvbk1hdHJpeC5wcm90b3R5cGUuaXNDcm9zc2VzPWZ1bmN0aW9uKGRpbWVuc2lvbk9mR2VvbWV0cnlBLGRpbWVuc2lvbk9mR2VvbWV0cnlCKXtpZigoZGltZW5zaW9uT2ZHZW9tZXRyeUE9PURpbWVuc2lvbi5QJiZkaW1lbnNpb25PZkdlb21ldHJ5Qj09RGltZW5zaW9uLkwpfHwoZGltZW5zaW9uT2ZHZW9tZXRyeUE9PURpbWVuc2lvbi5QJiZkaW1lbnNpb25PZkdlb21ldHJ5Qj09RGltZW5zaW9uLkEpfHwoZGltZW5zaW9uT2ZHZW9tZXRyeUE9PURpbWVuc2lvbi5MJiZkaW1lbnNpb25PZkdlb21ldHJ5Qj09RGltZW5zaW9uLkEpKXtyZXR1cm4ganN0cy5nZW9tLkludGVyc2VjdGlvbk1hdHJpeC5tYXRjaGVzKHRoaXMubWF0cml4W0xvY2F0aW9uLklOVEVSSU9SXVtMb2NhdGlvbi5JTlRFUklPUl0sJ1QnKSYmanN0cy5nZW9tLkludGVyc2VjdGlvbk1hdHJpeC5tYXRjaGVzKHRoaXMubWF0cml4W0xvY2F0aW9uLklOVEVSSU9SXVtMb2NhdGlvbi5FWFRFUklPUl0sJ1QnKTt9XG5pZigoZGltZW5zaW9uT2ZHZW9tZXRyeUE9PURpbWVuc2lvbi5MJiZkaW1lbnNpb25PZkdlb21ldHJ5Qj09RGltZW5zaW9uLlApfHwoZGltZW5zaW9uT2ZHZW9tZXRyeUE9PURpbWVuc2lvbi5BJiZkaW1lbnNpb25PZkdlb21ldHJ5Qj09RGltZW5zaW9uLlApfHwoZGltZW5zaW9uT2ZHZW9tZXRyeUE9PURpbWVuc2lvbi5BJiZkaW1lbnNpb25PZkdlb21ldHJ5Qj09RGltZW5zaW9uLkwpKXtyZXR1cm4ganN0cy5nZW9tLkludGVyc2VjdGlvbk1hdHJpeC5tYXRjaGVzKG1hdHJpeFtMb2NhdGlvbi5JTlRFUklPUl1bTG9jYXRpb24uSU5URVJJT1JdLCdUJykmJmpzdHMuZ2VvbS5JbnRlcnNlY3Rpb25NYXRyaXgubWF0Y2hlcyh0aGlzLm1hdHJpeFtMb2NhdGlvbi5FWFRFUklPUl1bTG9jYXRpb24uSU5URVJJT1JdLCdUJyk7fVxuaWYoZGltZW5zaW9uT2ZHZW9tZXRyeUE9PT1EaW1lbnNpb24uTCYmZGltZW5zaW9uT2ZHZW9tZXRyeUI9PT1EaW1lbnNpb24uTCl7cmV0dXJuIHRoaXMubWF0cml4W0xvY2F0aW9uLklOVEVSSU9SXVtMb2NhdGlvbi5JTlRFUklPUl09PT0wO31cbnJldHVybiBmYWxzZTt9O2pzdHMuZ2VvbS5JbnRlcnNlY3Rpb25NYXRyaXgucHJvdG90eXBlLmlzV2l0aGluPWZ1bmN0aW9uKCl7cmV0dXJuIGpzdHMuZ2VvbS5JbnRlcnNlY3Rpb25NYXRyaXgubWF0Y2hlcyh0aGlzLm1hdHJpeFtMb2NhdGlvbi5JTlRFUklPUl1bTG9jYXRpb24uSU5URVJJT1JdLCdUJykmJnRoaXMubWF0cml4W0xvY2F0aW9uLklOVEVSSU9SXVtMb2NhdGlvbi5FWFRFUklPUl09PURpbWVuc2lvbi5GQUxTRSYmdGhpcy5tYXRyaXhbTG9jYXRpb24uQk9VTkRBUlldW0xvY2F0aW9uLkVYVEVSSU9SXT09RGltZW5zaW9uLkZBTFNFO307anN0cy5nZW9tLkludGVyc2VjdGlvbk1hdHJpeC5wcm90b3R5cGUuaXNDb250YWlucz1mdW5jdGlvbigpe3JldHVybiBqc3RzLmdlb20uSW50ZXJzZWN0aW9uTWF0cml4Lm1hdGNoZXModGhpcy5tYXRyaXhbTG9jYXRpb24uSU5URVJJT1JdW0xvY2F0aW9uLklOVEVSSU9SXSwnVCcpJiZ0aGlzLm1hdHJpeFtMb2NhdGlvbi5FWFRFUklPUl1bTG9jYXRpb24uSU5URVJJT1JdPT1EaW1lbnNpb24uRkFMU0UmJnRoaXMubWF0cml4W0xvY2F0aW9uLkVYVEVSSU9SXVtMb2NhdGlvbi5CT1VOREFSWV09PURpbWVuc2lvbi5GQUxTRTt9O2pzdHMuZ2VvbS5JbnRlcnNlY3Rpb25NYXRyaXgucHJvdG90eXBlLmlzQ292ZXJzPWZ1bmN0aW9uKCl7dmFyIGhhc1BvaW50SW5Db21tb249anN0cy5nZW9tLkludGVyc2VjdGlvbk1hdHJpeC5tYXRjaGVzKHRoaXMubWF0cml4W0xvY2F0aW9uLklOVEVSSU9SXVtMb2NhdGlvbi5JTlRFUklPUl0sJ1QnKXx8anN0cy5nZW9tLkludGVyc2VjdGlvbk1hdHJpeC5tYXRjaGVzKHRoaXMubWF0cml4W0xvY2F0aW9uLklOVEVSSU9SXVtMb2NhdGlvbi5CT1VOREFSWV0sJ1QnKXx8anN0cy5nZW9tLkludGVyc2VjdGlvbk1hdHJpeC5tYXRjaGVzKHRoaXMubWF0cml4W0xvY2F0aW9uLkJPVU5EQVJZXVtMb2NhdGlvbi5JTlRFUklPUl0sJ1QnKXx8anN0cy5nZW9tLkludGVyc2VjdGlvbk1hdHJpeC5tYXRjaGVzKHRoaXMubWF0cml4W0xvY2F0aW9uLkJPVU5EQVJZXVtMb2NhdGlvbi5CT1VOREFSWV0sJ1QnKTtyZXR1cm4gaGFzUG9pbnRJbkNvbW1vbiYmdGhpcy5tYXRyaXhbTG9jYXRpb24uRVhURVJJT1JdW0xvY2F0aW9uLklOVEVSSU9SXT09RGltZW5zaW9uLkZBTFNFJiZ0aGlzLm1hdHJpeFtMb2NhdGlvbi5FWFRFUklPUl1bTG9jYXRpb24uQk9VTkRBUlldPT1EaW1lbnNpb24uRkFMU0U7fTtqc3RzLmdlb20uSW50ZXJzZWN0aW9uTWF0cml4LnByb3RvdHlwZS5pc0NvdmVyZWRCeT1mdW5jdGlvbigpe3ZhciBoYXNQb2ludEluQ29tbW9uPWpzdHMuZ2VvbS5JbnRlcnNlY3Rpb25NYXRyaXgubWF0Y2hlcyh0aGlzLm1hdHJpeFtMb2NhdGlvbi5JTlRFUklPUl1bTG9jYXRpb24uSU5URVJJT1JdLCdUJyl8fGpzdHMuZ2VvbS5JbnRlcnNlY3Rpb25NYXRyaXgubWF0Y2hlcyh0aGlzLm1hdHJpeFtMb2NhdGlvbi5JTlRFUklPUl1bTG9jYXRpb24uQk9VTkRBUlldLCdUJyl8fGpzdHMuZ2VvbS5JbnRlcnNlY3Rpb25NYXRyaXgubWF0Y2hlcyh0aGlzLm1hdHJpeFtMb2NhdGlvbi5CT1VOREFSWV1bTG9jYXRpb24uSU5URVJJT1JdLCdUJyl8fGpzdHMuZ2VvbS5JbnRlcnNlY3Rpb25NYXRyaXgubWF0Y2hlcyh0aGlzLm1hdHJpeFtMb2NhdGlvbi5CT1VOREFSWV1bTG9jYXRpb24uQk9VTkRBUlldLCdUJyk7cmV0dXJuIGhhc1BvaW50SW5Db21tb24mJnRoaXMubWF0cml4W0xvY2F0aW9uLklOVEVSSU9SXVtMb2NhdGlvbi5FWFRFUklPUl09PT1EaW1lbnNpb24uRkFMU0UmJnRoaXMubWF0cml4W0xvY2F0aW9uLkJPVU5EQVJZXVtMb2NhdGlvbi5FWFRFUklPUl09PT1EaW1lbnNpb24uRkFMU0U7fTtqc3RzLmdlb20uSW50ZXJzZWN0aW9uTWF0cml4LnByb3RvdHlwZS5pc0VxdWFscz1mdW5jdGlvbihkaW1lbnNpb25PZkdlb21ldHJ5QSxkaW1lbnNpb25PZkdlb21ldHJ5Qil7aWYoZGltZW5zaW9uT2ZHZW9tZXRyeUEhPT1kaW1lbnNpb25PZkdlb21ldHJ5Qil7cmV0dXJuIGZhbHNlO31cbnJldHVybiBqc3RzLmdlb20uSW50ZXJzZWN0aW9uTWF0cml4Lm1hdGNoZXModGhpcy5tYXRyaXhbTG9jYXRpb24uSU5URVJJT1JdW0xvY2F0aW9uLklOVEVSSU9SXSwnVCcpJiZ0aGlzLm1hdHJpeFtMb2NhdGlvbi5FWFRFUklPUl1bTG9jYXRpb24uSU5URVJJT1JdPT09RGltZW5zaW9uLkZBTFNFJiZ0aGlzLm1hdHJpeFtMb2NhdGlvbi5JTlRFUklPUl1bTG9jYXRpb24uRVhURVJJT1JdPT09RGltZW5zaW9uLkZBTFNFJiZ0aGlzLm1hdHJpeFtMb2NhdGlvbi5FWFRFUklPUl1bTG9jYXRpb24uQk9VTkRBUlldPT09RGltZW5zaW9uLkZBTFNFJiZ0aGlzLm1hdHJpeFtMb2NhdGlvbi5CT1VOREFSWV1bTG9jYXRpb24uRVhURVJJT1JdPT09RGltZW5zaW9uLkZBTFNFO307anN0cy5nZW9tLkludGVyc2VjdGlvbk1hdHJpeC5wcm90b3R5cGUuaXNPdmVybGFwcz1mdW5jdGlvbihkaW1lbnNpb25PZkdlb21ldHJ5QSxkaW1lbnNpb25PZkdlb21ldHJ5Qil7aWYoKGRpbWVuc2lvbk9mR2VvbWV0cnlBPT1EaW1lbnNpb24uUCYmZGltZW5zaW9uT2ZHZW9tZXRyeUI9PT1EaW1lbnNpb24uUCl8fChkaW1lbnNpb25PZkdlb21ldHJ5QT09RGltZW5zaW9uLkEmJmRpbWVuc2lvbk9mR2VvbWV0cnlCPT09RGltZW5zaW9uLkEpKXtyZXR1cm4ganN0cy5nZW9tLkludGVyc2VjdGlvbk1hdHJpeC5tYXRjaGVzKHRoaXMubWF0cml4W0xvY2F0aW9uLklOVEVSSU9SXVtMb2NhdGlvbi5JTlRFUklPUl0sJ1QnKSYmanN0cy5nZW9tLkludGVyc2VjdGlvbk1hdHJpeC5tYXRjaGVzKHRoaXMubWF0cml4W0xvY2F0aW9uLklOVEVSSU9SXVtMb2NhdGlvbi5FWFRFUklPUl0sJ1QnKSYmanN0cy5nZW9tLkludGVyc2VjdGlvbk1hdHJpeC5tYXRjaGVzKHRoaXMubWF0cml4W0xvY2F0aW9uLkVYVEVSSU9SXVtMb2NhdGlvbi5JTlRFUklPUl0sJ1QnKTt9XG5pZihkaW1lbnNpb25PZkdlb21ldHJ5QT09PURpbWVuc2lvbi5MJiZkaW1lbnNpb25PZkdlb21ldHJ5Qj09PURpbWVuc2lvbi5MKXtyZXR1cm4gdGhpcy5tYXRyaXhbTG9jYXRpb24uSU5URVJJT1JdW0xvY2F0aW9uLklOVEVSSU9SXT09MSYmanN0cy5nZW9tLkludGVyc2VjdGlvbk1hdHJpeC5tYXRjaGVzKHRoaXMubWF0cml4W0xvY2F0aW9uLklOVEVSSU9SXVtMb2NhdGlvbi5FWFRFUklPUl0sJ1QnKSYmanN0cy5nZW9tLkludGVyc2VjdGlvbk1hdHJpeC5tYXRjaGVzKHRoaXMubWF0cml4W0xvY2F0aW9uLkVYVEVSSU9SXVtMb2NhdGlvbi5JTlRFUklPUl0sJ1QnKTt9XG5yZXR1cm4gZmFsc2U7fTtqc3RzLmdlb20uSW50ZXJzZWN0aW9uTWF0cml4LnByb3RvdHlwZS5tYXRjaGVzPWZ1bmN0aW9uKHJlcXVpcmVkRGltZW5zaW9uU3ltYm9scyl7aWYocmVxdWlyZWREaW1lbnNpb25TeW1ib2xzLmxlbmd0aCE9OSl7dGhyb3cgbmV3IGpzdHMuZXJyb3IuSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uKCdTaG91bGQgYmUgbGVuZ3RoIDk6ICcrXG5yZXF1aXJlZERpbWVuc2lvblN5bWJvbHMpO31cbmZvcih2YXIgYWk9MDthaTwzO2FpKyspe2Zvcih2YXIgYmk9MDtiaTwzO2JpKyspe2lmKCFqc3RzLmdlb20uSW50ZXJzZWN0aW9uTWF0cml4Lm1hdGNoZXModGhpcy5tYXRyaXhbYWldW2JpXSxyZXF1aXJlZERpbWVuc2lvblN5bWJvbHMuY2hhckF0KDMqYWkrYmkpKSl7cmV0dXJuIGZhbHNlO319fVxucmV0dXJuIHRydWU7fTtqc3RzLmdlb20uSW50ZXJzZWN0aW9uTWF0cml4LnByb3RvdHlwZS50cmFuc3Bvc2U9ZnVuY3Rpb24oKXt2YXIgdGVtcD1tYXRyaXhbMV1bMF07dGhpcy5tYXRyaXhbMV1bMF09dGhpcy5tYXRyaXhbMF1bMV07dGhpcy5tYXRyaXhbMF1bMV09dGVtcDt0ZW1wPXRoaXMubWF0cml4WzJdWzBdO3RoaXMubWF0cml4WzJdWzBdPXRoaXMubWF0cml4WzBdWzJdO3RoaXMubWF0cml4WzBdWzJdPXRlbXA7dGVtcD10aGlzLm1hdHJpeFsyXVsxXTt0aGlzLm1hdHJpeFsyXVsxXT10aGlzLm1hdHJpeFsxXVsyXTt0aGlzLm1hdHJpeFsxXVsyXT10ZW1wO3JldHVybiB0aGlzO307anN0cy5nZW9tLkludGVyc2VjdGlvbk1hdHJpeC5wcm90b3R5cGUudG9TdHJpbmc9ZnVuY3Rpb24oKXt2YXIgYWksYmksYnVmPScnO2ZvcihhaT0wO2FpPDM7YWkrKyl7Zm9yKGJpPTA7Ymk8MztiaSsrKXtidWYrPURpbWVuc2lvbi50b0RpbWVuc2lvblN5bWJvbCh0aGlzLm1hdHJpeFthaV1bYmldKTt9fVxucmV0dXJuIGJ1Zjt9O30pKCk7anN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5MYXN0Rm91bmRRdWFkRWRnZUxvY2F0b3I9ZnVuY3Rpb24oc3ViZGl2KXt0aGlzLnN1YmRpdj1zdWJkaXY7dGhpcy5sYXN0RWRnZT1udWxsO3RoaXMuaW5pdCgpO307anN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5MYXN0Rm91bmRRdWFkRWRnZUxvY2F0b3IucHJvdG90eXBlLmluaXQ9ZnVuY3Rpb24oKXt0aGlzLmxhc3RFZGdlPXRoaXMuZmluZEVkZ2UoKTt9O2pzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuTGFzdEZvdW5kUXVhZEVkZ2VMb2NhdG9yLnByb3RvdHlwZS5maW5kRWRnZT1mdW5jdGlvbigpe3ZhciBlZGdlcz10aGlzLnN1YmRpdi5nZXRFZGdlcygpO3JldHVybiBlZGdlc1swXTt9O2pzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuTGFzdEZvdW5kUXVhZEVkZ2VMb2NhdG9yLnByb3RvdHlwZS5sb2NhdGU9ZnVuY3Rpb24odil7aWYoIXRoaXMubGFzdEVkZ2UuaXNMaXZlKCkpe3RoaXMuaW5pdCgpO31cbnZhciBlPXRoaXMuc3ViZGl2LmxvY2F0ZUZyb21FZGdlKHYsdGhpcy5sYXN0RWRnZSk7dGhpcy5sYXN0RWRnZT1lO3JldHVybiBlO307anN0cy5ub2RpbmcuU2VnbWVudE5vZGVMaXN0PWZ1bmN0aW9uKGVkZ2Upe3RoaXMubm9kZU1hcD1uZXcgamF2YXNjcmlwdC51dGlsLlRyZWVNYXAoKTt0aGlzLmVkZ2U9ZWRnZTt9O2pzdHMubm9kaW5nLlNlZ21lbnROb2RlTGlzdC5wcm90b3R5cGUubm9kZU1hcD1udWxsO2pzdHMubm9kaW5nLlNlZ21lbnROb2RlTGlzdC5wcm90b3R5cGUuaXRlcmF0b3I9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5ub2RlTWFwLnZhbHVlcygpLml0ZXJhdG9yKCk7fTtqc3RzLm5vZGluZy5TZWdtZW50Tm9kZUxpc3QucHJvdG90eXBlLmVkZ2U9bnVsbDtqc3RzLm5vZGluZy5TZWdtZW50Tm9kZUxpc3QucHJvdG90eXBlLmdldEVkZ2U9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5lZGdlO307anN0cy5ub2RpbmcuU2VnbWVudE5vZGVMaXN0LnByb3RvdHlwZS5hZGQ9ZnVuY3Rpb24oaW50UHQsc2VnbWVudEluZGV4KXt2YXIgZWlOZXc9bmV3IGpzdHMubm9kaW5nLlNlZ21lbnROb2RlKHRoaXMuZWRnZSxpbnRQdCxzZWdtZW50SW5kZXgsdGhpcy5lZGdlLmdldFNlZ21lbnRPY3RhbnQoc2VnbWVudEluZGV4KSk7dmFyIGVpPXRoaXMubm9kZU1hcC5nZXQoZWlOZXcpO2lmKGVpIT09bnVsbCl7anN0cy51dGlsLkFzc2VydC5pc1RydWUoZWkuY29vcmQuZXF1YWxzMkQoaW50UHQpLCdGb3VuZCBlcXVhbCBub2RlcyB3aXRoIGRpZmZlcmVudCBjb29yZGluYXRlcycpO3JldHVybiBlaTt9XG50aGlzLm5vZGVNYXAucHV0KGVpTmV3LGVpTmV3KTtyZXR1cm4gZWlOZXc7fTtqc3RzLm5vZGluZy5TZWdtZW50Tm9kZUxpc3QucHJvdG90eXBlLmFkZEVuZHBvaW50cz1mdW5jdGlvbigpe3ZhciBtYXhTZWdJbmRleD10aGlzLmVkZ2Uuc2l6ZSgpLTE7dGhpcy5hZGQodGhpcy5lZGdlLmdldENvb3JkaW5hdGUoMCksMCk7dGhpcy5hZGQodGhpcy5lZGdlLmdldENvb3JkaW5hdGUobWF4U2VnSW5kZXgpLG1heFNlZ0luZGV4KTt9O2pzdHMubm9kaW5nLlNlZ21lbnROb2RlTGlzdC5wcm90b3R5cGUuYWRkQ29sbGFwc2VkTm9kZXM9ZnVuY3Rpb24oKXt2YXIgY29sbGFwc2VkVmVydGV4SW5kZXhlcz1bXTt0aGlzLmZpbmRDb2xsYXBzZXNGcm9tSW5zZXJ0ZWROb2Rlcyhjb2xsYXBzZWRWZXJ0ZXhJbmRleGVzKTt0aGlzLmZpbmRDb2xsYXBzZXNGcm9tRXhpc3RpbmdWZXJ0aWNlcyhjb2xsYXBzZWRWZXJ0ZXhJbmRleGVzKTtmb3IodmFyIGk9MDtpPGNvbGxhcHNlZFZlcnRleEluZGV4ZXMubGVuZ3RoO2krKyl7dmFyIHZlcnRleEluZGV4PWNvbGxhcHNlZFZlcnRleEluZGV4ZXNbaV07dGhpcy5hZGQodGhpcy5lZGdlLmdldENvb3JkaW5hdGUodmVydGV4SW5kZXgpLHZlcnRleEluZGV4KTt9fTtqc3RzLm5vZGluZy5TZWdtZW50Tm9kZUxpc3QucHJvdG90eXBlLmZpbmRDb2xsYXBzZXNGcm9tRXhpc3RpbmdWZXJ0aWNlcz1mdW5jdGlvbihjb2xsYXBzZWRWZXJ0ZXhJbmRleGVzKXtmb3IodmFyIGk9MDtpPHRoaXMuZWRnZS5zaXplKCktMjtpKyspe3ZhciBwMD10aGlzLmVkZ2UuZ2V0Q29vcmRpbmF0ZShpKTt2YXIgcDE9dGhpcy5lZGdlLmdldENvb3JkaW5hdGUoaSsxKTt2YXIgcDI9dGhpcy5lZGdlLmdldENvb3JkaW5hdGUoaSsyKTtpZihwMC5lcXVhbHMyRChwMikpe2NvbGxhcHNlZFZlcnRleEluZGV4ZXMucHVzaChpKzEpO319fTtqc3RzLm5vZGluZy5TZWdtZW50Tm9kZUxpc3QucHJvdG90eXBlLmZpbmRDb2xsYXBzZXNGcm9tSW5zZXJ0ZWROb2Rlcz1mdW5jdGlvbihjb2xsYXBzZWRWZXJ0ZXhJbmRleGVzKXt2YXIgY29sbGFwc2VkVmVydGV4SW5kZXg9W251bGxdO3ZhciBpdD10aGlzLml0ZXJhdG9yKCk7dmFyIGVpUHJldj1pdC5uZXh0KCk7d2hpbGUoaXQuaGFzTmV4dCgpKXt2YXIgZWk9aXQubmV4dCgpO3ZhciBpc0NvbGxhcHNlZD10aGlzLmZpbmRDb2xsYXBzZUluZGV4KGVpUHJldixlaSxjb2xsYXBzZWRWZXJ0ZXhJbmRleCk7aWYoaXNDb2xsYXBzZWQpXG5jb2xsYXBzZWRWZXJ0ZXhJbmRleGVzLnB1c2goY29sbGFwc2VkVmVydGV4SW5kZXhbMF0pO2VpUHJldj1laTt9fTtqc3RzLm5vZGluZy5TZWdtZW50Tm9kZUxpc3QucHJvdG90eXBlLmZpbmRDb2xsYXBzZUluZGV4PWZ1bmN0aW9uKGVpMCxlaTEsY29sbGFwc2VkVmVydGV4SW5kZXgpe2lmKCFlaTAuY29vcmQuZXF1YWxzMkQoZWkxLmNvb3JkKSlcbnJldHVybiBmYWxzZTt2YXIgbnVtVmVydGljZXNCZXR3ZWVuPWVpMS5zZWdtZW50SW5kZXgtZWkwLnNlZ21lbnRJbmRleDtpZighZWkxLmlzSW50ZXJpb3IoKSl7bnVtVmVydGljZXNCZXR3ZWVuLS07fVxuaWYobnVtVmVydGljZXNCZXR3ZWVuPT09MSl7Y29sbGFwc2VkVmVydGV4SW5kZXhbMF09ZWkwLnNlZ21lbnRJbmRleCsxO3JldHVybiB0cnVlO31cbnJldHVybiBmYWxzZTt9O2pzdHMubm9kaW5nLlNlZ21lbnROb2RlTGlzdC5wcm90b3R5cGUuYWRkU3BsaXRFZGdlcz1mdW5jdGlvbihlZGdlTGlzdCl7dGhpcy5hZGRFbmRwb2ludHMoKTt0aGlzLmFkZENvbGxhcHNlZE5vZGVzKCk7dmFyIGl0PXRoaXMuaXRlcmF0b3IoKTt2YXIgZWlQcmV2PWl0Lm5leHQoKTt3aGlsZShpdC5oYXNOZXh0KCkpe3ZhciBlaT1pdC5uZXh0KCk7dmFyIG5ld0VkZ2U9dGhpcy5jcmVhdGVTcGxpdEVkZ2UoZWlQcmV2LGVpKTtlZGdlTGlzdC5hZGQobmV3RWRnZSk7ZWlQcmV2PWVpO319O2pzdHMubm9kaW5nLlNlZ21lbnROb2RlTGlzdC5wcm90b3R5cGUuY2hlY2tTcGxpdEVkZ2VzQ29ycmVjdG5lc3M9ZnVuY3Rpb24oc3BsaXRFZGdlcyl7dmFyIGVkZ2VQdHM9ZWRnZS5nZXRDb29yZGluYXRlcygpO3ZhciBzcGxpdDA9c3BsaXRFZGdlc1swXTt2YXIgcHQwPXNwbGl0MC5nZXRDb29yZGluYXRlKDApO2lmKCFwdDAuZXF1YWxzMkQoZWRnZVB0c1swXSkpXG50aHJvdyBuZXcgRXJyb3IoJ2JhZCBzcGxpdCBlZGdlIHN0YXJ0IHBvaW50IGF0ICcrcHQwKTt2YXIgc3BsaXRuPXNwbGl0RWRnZXNbc3BsaXRFZGdlcy5sZW5ndGgtMV07dmFyIHNwbGl0blB0cz1zcGxpdG4uZ2V0Q29vcmRpbmF0ZXMoKTt2YXIgcHRuPXNwbGl0blB0c1tzcGxpdG5QdHMubGVuZ3RoLTFdO2lmKCFwdG4uZXF1YWxzMkQoZWRnZVB0c1tlZGdlUHRzLmxlbmd0aC0xXSkpXG50aHJvdyBuZXcgRXJyb3IoJ2JhZCBzcGxpdCBlZGdlIGVuZCBwb2ludCBhdCAnK3B0bik7fTtqc3RzLm5vZGluZy5TZWdtZW50Tm9kZUxpc3QucHJvdG90eXBlLmNyZWF0ZVNwbGl0RWRnZT1mdW5jdGlvbihlaTAsZWkxKXt2YXIgbnB0cz1laTEuc2VnbWVudEluZGV4LWVpMC5zZWdtZW50SW5kZXgrMjt2YXIgbGFzdFNlZ1N0YXJ0UHQ9dGhpcy5lZGdlLmdldENvb3JkaW5hdGUoZWkxLnNlZ21lbnRJbmRleCk7dmFyIHVzZUludFB0MT1laTEuaXNJbnRlcmlvcigpfHwhZWkxLmNvb3JkLmVxdWFsczJEKGxhc3RTZWdTdGFydFB0KTtpZighdXNlSW50UHQxKXtucHRzLS07fVxudmFyIHB0cz1bXTt2YXIgaXB0PTA7cHRzW2lwdCsrXT1uZXcganN0cy5nZW9tLkNvb3JkaW5hdGUoZWkwLmNvb3JkKTtmb3IodmFyIGk9ZWkwLnNlZ21lbnRJbmRleCsxO2k8PWVpMS5zZWdtZW50SW5kZXg7aSsrKXtwdHNbaXB0KytdPXRoaXMuZWRnZS5nZXRDb29yZGluYXRlKGkpO31cbmlmKHVzZUludFB0MSlcbnB0c1tpcHRdPWVpMS5jb29yZDtyZXR1cm4gbmV3IGpzdHMubm9kaW5nLk5vZGVkU2VnbWVudFN0cmluZyhwdHMsdGhpcy5lZGdlLmdldERhdGEoKSk7fTtqc3RzLmlvLldLVFdyaXRlcj1mdW5jdGlvbigpe3RoaXMucGFyc2VyPW5ldyBqc3RzLmlvLldLVFBhcnNlcih0aGlzLmdlb21ldHJ5RmFjdG9yeSk7fTtqc3RzLmlvLldLVFdyaXRlci5wcm90b3R5cGUud3JpdGU9ZnVuY3Rpb24oZ2VvbWV0cnkpe3ZhciB3a3Q9dGhpcy5wYXJzZXIud3JpdGUoZ2VvbWV0cnkpO3JldHVybiB3a3Q7fTtqc3RzLmlvLldLVFdyaXRlci50b0xpbmVTdHJpbmc9ZnVuY3Rpb24ocDAscDEpe2lmKGFyZ3VtZW50cy5sZW5ndGghPT0yKXt0aHJvdyBuZXcganN0cy5lcnJvci5Ob3RJbXBsZW1lbnRlZEVycm9yKCk7fVxucmV0dXJuJ0xJTkVTVFJJTkcgKCAnK3AwLngrJyAnK3AwLnkrJywgJytwMS54KycgJytwMS55KycgKSc7fTtqc3RzLmlvLldLVFJlYWRlcj1mdW5jdGlvbihnZW9tZXRyeUZhY3Rvcnkpe3RoaXMuZ2VvbWV0cnlGYWN0b3J5PWdlb21ldHJ5RmFjdG9yeXx8bmV3IGpzdHMuZ2VvbS5HZW9tZXRyeUZhY3RvcnkoKTt0aGlzLnByZWNpc2lvbk1vZGVsPXRoaXMuZ2VvbWV0cnlGYWN0b3J5LmdldFByZWNpc2lvbk1vZGVsKCk7dGhpcy5wYXJzZXI9bmV3IGpzdHMuaW8uV0tUUGFyc2VyKHRoaXMuZ2VvbWV0cnlGYWN0b3J5KTt9O2pzdHMuaW8uV0tUUmVhZGVyLnByb3RvdHlwZS5yZWFkPWZ1bmN0aW9uKHdrdCl7dmFyIGdlb21ldHJ5PXRoaXMucGFyc2VyLnJlYWQod2t0KTtpZih0aGlzLnByZWNpc2lvbk1vZGVsLmdldFR5cGUoKT09PWpzdHMuZ2VvbS5QcmVjaXNpb25Nb2RlbC5GSVhFRCl7dGhpcy5yZWR1Y2VQcmVjaXNpb24oZ2VvbWV0cnkpO31cbnJldHVybiBnZW9tZXRyeTt9O2pzdHMuaW8uV0tUUmVhZGVyLnByb3RvdHlwZS5yZWR1Y2VQcmVjaXNpb249ZnVuY3Rpb24oZ2VvbWV0cnkpe3ZhciBpLGxlbjtpZihnZW9tZXRyeS5jb29yZGluYXRlKXt0aGlzLnByZWNpc2lvbk1vZGVsLm1ha2VQcmVjaXNlKGdlb21ldHJ5LmNvb3JkaW5hdGUpO31lbHNlIGlmKGdlb21ldHJ5LnBvaW50cyl7Zm9yKGk9MCxsZW49Z2VvbWV0cnkucG9pbnRzLmxlbmd0aDtpPGxlbjtpKyspe3RoaXMucHJlY2lzaW9uTW9kZWwubWFrZVByZWNpc2UoZ2VvbWV0cnkucG9pbnRzW2ldKTt9fWVsc2UgaWYoZ2VvbWV0cnkuZ2VvbWV0cmllcyl7Zm9yKGk9MCxsZW49Z2VvbWV0cnkuZ2VvbWV0cmllcy5sZW5ndGg7aTxsZW47aSsrKXt0aGlzLnJlZHVjZVByZWNpc2lvbihnZW9tZXRyeS5nZW9tZXRyaWVzW2ldKTt9fX07anN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5RdWFkRWRnZVN1YmRpdmlzaW9uPWZ1bmN0aW9uKGVudix0b2xlcmFuY2Upe3RoaXMudG9sZXJhbmNlPXRvbGVyYW5jZTt0aGlzLmVkZ2VDb2luY2lkZW5jZVRvbGVyYW5jZT10b2xlcmFuY2UvanN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5RdWFkRWRnZVN1YmRpdmlzaW9uLkVER0VfQ09JTkNJREVOQ0VfVE9MX0ZBQ1RPUjt0aGlzLnZpc2l0ZWRLZXk9MDt0aGlzLnF1YWRFZGdlcz1bXTt0aGlzLnN0YXJ0aW5nRWRnZTt0aGlzLnRvbGVyYW5jZTt0aGlzLmVkZ2VDb2luY2lkZW5jZVRvbGVyYW5jZTt0aGlzLmZyYW1lRW52O3RoaXMubG9jYXRvcj1udWxsO3RoaXMuc2VnPW5ldyBqc3RzLmdlb20uTGluZVNlZ21lbnQoKTt0aGlzLnRyaUVkZ2VzPW5ldyBBcnJheSgzKTt0aGlzLmZyYW1lVmVydGV4PW5ldyBBcnJheSgzKTt0aGlzLmNyZWF0ZUZyYW1lKGVudik7dGhpcy5zdGFydGluZ0VkZ2U9dGhpcy5pbml0U3ViZGl2KCk7dGhpcy5sb2NhdG9yPW5ldyBqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLkxhc3RGb3VuZFF1YWRFZGdlTG9jYXRvcih0aGlzKTt9O2pzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuUXVhZEVkZ2VTdWJkaXZpc2lvbi5FREdFX0NPSU5DSURFTkNFX1RPTF9GQUNUT1I9MTAwMDtqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlF1YWRFZGdlU3ViZGl2aXNpb24uZ2V0VHJpYW5nbGVFZGdlcz1mdW5jdGlvbihzdGFydFFFLHRyaUVkZ2Upe3RyaUVkZ2VbMF09c3RhcnRRRTt0cmlFZGdlWzFdPXRyaUVkZ2VbMF0ubE5leHQoKTt0cmlFZGdlWzJdPXRyaUVkZ2VbMV0ubE5leHQoKTtpZih0cmlFZGdlWzJdLmxOZXh0KCkhPXRyaUVkZ2VbMF0pe3Rocm93IG5ldyBqc3RzLklsbGVnYWxBcmd1bWVudEVycm9yKCdFZGdlcyBkbyBub3QgZm9ybSBhIHRyaWFuZ2xlJyk7fX07anN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5RdWFkRWRnZVN1YmRpdmlzaW9uLnByb3RvdHlwZS5jcmVhdGVGcmFtZT1mdW5jdGlvbihlbnYpe3ZhciBkZWx0YVgsZGVsdGFZLG9mZnNldDtkZWx0YVg9ZW52LmdldFdpZHRoKCk7ZGVsdGFZPWVudi5nZXRIZWlnaHQoKTtvZmZzZXQ9MC4wO2lmKGRlbHRhWD5kZWx0YVkpe29mZnNldD1kZWx0YVgqMTAuMDt9ZWxzZXtvZmZzZXQ9ZGVsdGFZKjEwLjA7fVxudGhpcy5mcmFtZVZlcnRleFswXT1uZXcganN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5WZXJ0ZXgoKGVudi5nZXRNYXhYKCkrZW52LmdldE1pblgoKSkvMi4wLGVudi5nZXRNYXhZKClcbitvZmZzZXQpO3RoaXMuZnJhbWVWZXJ0ZXhbMV09bmV3IGpzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuVmVydGV4KGVudi5nZXRNaW5YKCktb2Zmc2V0LGVudi5nZXRNaW5ZKCktb2Zmc2V0KTt0aGlzLmZyYW1lVmVydGV4WzJdPW5ldyBqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlZlcnRleChlbnYuZ2V0TWF4WCgpK29mZnNldCxlbnYuZ2V0TWluWSgpLW9mZnNldCk7dGhpcy5mcmFtZUVudj1uZXcganN0cy5nZW9tLkVudmVsb3BlKHRoaXMuZnJhbWVWZXJ0ZXhbMF0uZ2V0Q29vcmRpbmF0ZSgpLHRoaXMuZnJhbWVWZXJ0ZXhbMV0uZ2V0Q29vcmRpbmF0ZSgpKTt0aGlzLmZyYW1lRW52LmV4cGFuZFRvSW5jbHVkZSh0aGlzLmZyYW1lVmVydGV4WzJdLmdldENvb3JkaW5hdGUoKSk7fTtqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlF1YWRFZGdlU3ViZGl2aXNpb24ucHJvdG90eXBlLmluaXRTdWJkaXY9ZnVuY3Rpb24oKXt2YXIgZWEsZWIsZWM7ZWE9dGhpcy5tYWtlRWRnZSh0aGlzLmZyYW1lVmVydGV4WzBdLHRoaXMuZnJhbWVWZXJ0ZXhbMV0pO2ViPXRoaXMubWFrZUVkZ2UodGhpcy5mcmFtZVZlcnRleFsxXSx0aGlzLmZyYW1lVmVydGV4WzJdKTtqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlF1YWRFZGdlLnNwbGljZShlYS5zeW0oKSxlYik7ZWM9dGhpcy5tYWtlRWRnZSh0aGlzLmZyYW1lVmVydGV4WzJdLHRoaXMuZnJhbWVWZXJ0ZXhbMF0pO2pzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuUXVhZEVkZ2Uuc3BsaWNlKGViLnN5bSgpLGVjKTtqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlF1YWRFZGdlLnNwbGljZShlYy5zeW0oKSxlYSk7cmV0dXJuIGVhO307anN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5RdWFkRWRnZVN1YmRpdmlzaW9uLnByb3RvdHlwZS5nZXRUb2xlcmFuY2U9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy50b2xlcmFuY2U7fTtqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlF1YWRFZGdlU3ViZGl2aXNpb24ucHJvdG90eXBlLmdldEVudmVsb3BlPWZ1bmN0aW9uKCl7cmV0dXJuIG5ldyBqc3RzLmdlb20uRW52ZWxvcGUodGhpcy5mcmFtZUVudik7fTtqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlF1YWRFZGdlU3ViZGl2aXNpb24ucHJvdG90eXBlLmdldEVkZ2VzPWZ1bmN0aW9uKCl7aWYoYXJndW1lbnRzLmxlbmd0aD4wKXtyZXR1cm4gdGhpcy5nZXRFZGdlc0J5RmFjdG9yeShhcmd1bWVudHNbMF0pO31lbHNle3JldHVybiB0aGlzLnF1YWRFZGdlczt9fTtqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlF1YWRFZGdlU3ViZGl2aXNpb24ucHJvdG90eXBlLnNldExvY2F0b3I9ZnVuY3Rpb24obG9jYXRvcil7dGhpcy5sb2NhdG9yPWxvY2F0b3I7fTtqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlF1YWRFZGdlU3ViZGl2aXNpb24ucHJvdG90eXBlLm1ha2VFZGdlPWZ1bmN0aW9uKG8sZCl7dmFyIHE9anN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5RdWFkRWRnZS5tYWtlRWRnZShvLGQpO3RoaXMucXVhZEVkZ2VzLnB1c2gocSk7cmV0dXJuIHE7fTtqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlF1YWRFZGdlU3ViZGl2aXNpb24ucHJvdG90eXBlLmNvbm5lY3Q9ZnVuY3Rpb24oYSxiKXt2YXIgcT1qc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlF1YWRFZGdlLmNvbm5lY3QoYSxiKTt0aGlzLnF1YWRFZGdlcy5wdXNoKHEpO3JldHVybiBxO307anN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5RdWFkRWRnZVN1YmRpdmlzaW9uLnByb3RvdHlwZS5kZWxldGVfanN0cz1mdW5jdGlvbihlKXtqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlF1YWRFZGdlLnNwbGljZShlLGUub1ByZXYoKSk7anN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5RdWFkRWRnZS5zcGxpY2UoZS5zeW0oKSxlLnN5bSgpLm9QcmV2KCkpO3ZhciBlU3ltLGVSb3QsZVJvdFN5bTtlLmVTeW09ZS5zeW0oKTtlUm90PWUucm90O2VSb3RTeW09ZS5yb3Quc3ltKCk7dmFyIGlkeD10aGlzLnF1YWRFZGdlcy5pbmRleE9mKGUpO2lmKGlkeCE9PS0xKXt0aGlzLnF1YWRFZGdlcy5zcGxpY2UoaWR4LDEpO31cbmlkeD10aGlzLnF1YWRFZGdlcy5pbmRleE9mKGVTeW0pO2lmKGlkeCE9PS0xKXt0aGlzLnF1YWRFZGdlcy5zcGxpY2UoaWR4LDEpO31cbmlkeD10aGlzLnF1YWRFZGdlcy5pbmRleE9mKGVSb3QpO2lmKGlkeCE9PS0xKXt0aGlzLnF1YWRFZGdlcy5zcGxpY2UoaWR4LDEpO31cbmlkeD10aGlzLnF1YWRFZGdlcy5pbmRleE9mKGVSb3RTeW0pO2lmKGlkeCE9PS0xKXt0aGlzLnF1YWRFZGdlcy5zcGxpY2UoaWR4LDEpO31cbmUuZGVsZXRlX2pzdHMoKTtlU3ltLmRlbGV0ZV9qc3RzKCk7ZVJvdC5kZWxldGVfanN0cygpO2VSb3RTeW0uZGVsZXRlX2pzdHMoKTt9O2pzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuUXVhZEVkZ2VTdWJkaXZpc2lvbi5wcm90b3R5cGUubG9jYXRlRnJvbUVkZ2U9ZnVuY3Rpb24odixzdGFydEVkZ2Upe3ZhciBpdGVyPTAsbWF4SXRlcj10aGlzLnF1YWRFZGdlcy5sZW5ndGgsZTtlPXN0YXJ0RWRnZTt3aGlsZSh0cnVlKXtpdGVyKys7aWYoaXRlcj5tYXhJdGVyKXt0aHJvdyBuZXcganN0cy5lcnJvci5Mb2NhdGVGYWlsdXJlRXJyb3IoZS50b0xpbmVTZWdtZW50KCkpO31cbmlmKCh2LmVxdWFscyhlLm9yaWcoKSkpfHwodi5lcXVhbHMoZS5kZXN0KCkpKSl7YnJlYWs7fWVsc2UgaWYodi5yaWdodE9mKGUpKXtlPWUuc3ltKCk7fWVsc2UgaWYoIXYucmlnaHRPZihlLm9OZXh0KCkpKXtlPWUub05leHQoKTt9ZWxzZSBpZighdi5yaWdodE9mKGUuZFByZXYoKSkpe2U9ZS5kUHJldigpO31lbHNle2JyZWFrO319XG5yZXR1cm4gZTt9O2pzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuUXVhZEVkZ2VTdWJkaXZpc2lvbi5wcm90b3R5cGUubG9jYXRlPWZ1bmN0aW9uKCl7aWYoYXJndW1lbnRzLmxlbmd0aD09PTEpe2lmKGFyZ3VtZW50c1swXWluc3RhbmNlb2YganN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5WZXJ0ZXgpe3JldHVybiB0aGlzLmxvY2F0ZUJ5VmVydGV4KGFyZ3VtZW50c1swXSk7fWVsc2V7cmV0dXJuIHRoaXMubG9jYXRlQnlDb29yZGluYXRlKGFyZ3VtZW50c1swXSk7fX1lbHNle3JldHVybiB0aGlzLmxvY2F0ZUJ5Q29vcmRpbmF0ZXMoYXJndW1lbnRzWzBdLGFyZ3VtZW50c1sxXSk7fX07anN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5RdWFkRWRnZVN1YmRpdmlzaW9uLnByb3RvdHlwZS5sb2NhdGVCeVZlcnRleD1mdW5jdGlvbih2KXtyZXR1cm4gdGhpcy5sb2NhdG9yLmxvY2F0ZSh2KTt9O2pzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuUXVhZEVkZ2VTdWJkaXZpc2lvbi5wcm90b3R5cGUubG9jYXRlQnlDb29yZGluYXRlPWZ1bmN0aW9uKHApe3JldHVybiB0aGlzLmxvY2F0b3IubG9jYXRlKG5ldyBqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlZlcnRleChwKSk7fTtqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlF1YWRFZGdlU3ViZGl2aXNpb24ucHJvdG90eXBlLmxvY2F0ZUJ5Q29vcmRpbmF0ZXM9ZnVuY3Rpb24ocDAscDEpe3ZhciBlLGJhc2UsbG9jRWRnZTt2YXIgZT10aGlzLmxvY2F0b3IubG9jYXRlKG5ldyBqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlZlcnRleChwMCkpO2lmKGU9PT1udWxsKXtyZXR1cm4gbnVsbDt9XG5iYXNlPWU7aWYoZS5kZXN0KCkuZ2V0Q29vcmRpbmF0ZSgpLmVxdWFsczJEKHAwKSl7YmFzZT1lLnN5bSgpO31cbmxvY0VkZ2U9YmFzZTtkb3tpZihsb2NFZGdlLmRlc3QoKS5nZXRDb29yZGluYXRlKCkuZXF1YWxzMkQocDEpKXtyZXR1cm4gbG9jRWRnZTt9XG5sb2NFZGdlPWxvY0VkZ2Uub05leHQoKTt9d2hpbGUobG9jRWRnZSE9YmFzZSk7cmV0dXJuIG51bGw7fTtqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlF1YWRFZGdlU3ViZGl2aXNpb24ucHJvdG90eXBlLmluc2VydFNpdGU9ZnVuY3Rpb24odil7dmFyIGUsYmFzZSxzdGFydEVkZ2U7ZT10aGlzLmxvY2F0ZSh2KTtpZigodi5lcXVhbHMoZS5vcmlnKCksdGhpcy50b2xlcmFuY2UpKXx8KHYuZXF1YWxzKGUuZGVzdCgpLHRoaXMudG9sZXJhbmNlKSkpe3JldHVybiBlO31cbmJhc2U9dGhpcy5tYWtlRWRnZShlLm9yaWcoKSx2KTtqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlF1YWRFZGdlLnNwbGljZShiYXNlLGUpO3N0YXJ0RWRnZT1iYXNlO2Rve2Jhc2U9dGhpcy5jb25uZWN0KGUsYmFzZS5zeW0oKSk7ZT1iYXNlLm9QcmV2KCk7fXdoaWxlKGUubE5leHQoKSE9c3RhcnRFZGdlKTtyZXR1cm4gc3RhcnRFZGdlO307anN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5RdWFkRWRnZVN1YmRpdmlzaW9uLnByb3RvdHlwZS5pc0ZyYW1lRWRnZT1mdW5jdGlvbihlKXtpZih0aGlzLmlzRnJhbWVWZXJ0ZXgoZS5vcmlnKCkpfHx0aGlzLmlzRnJhbWVWZXJ0ZXgoZS5kZXN0KCkpKXtyZXR1cm4gdHJ1ZTt9XG5yZXR1cm4gZmFsc2U7fTtqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlF1YWRFZGdlU3ViZGl2aXNpb24ucHJvdG90eXBlLmlzRnJhbWVCb3JkZXJFZGdlPWZ1bmN0aW9uKGUpe3ZhciBsZWZ0VHJpLHJpZ2h0VHJpLHZMZWZ0VHJpT3RoZXIsdlJpZ2h0VHJpT3RoZXI7bGVmdFRyaT1uZXcgQXJyYXkoMyk7dGhpcy5nZXRUcmlhbmdsZUVkZ2VzKGUsbGVmdFRyaSk7cmlnaHRUcmk9bmV3IEFycmF5KDMpO3RoaXMuZ2V0VHJpYW5nbGVFZGdlcyhlLnN5bSgpLHJpZ2h0VHJpKTt2TGVmdFRyaU90aGVyPWUubE5leHQoKS5kZXN0KCk7aWYodGhpcy5pc0ZyYW1lVmVydGV4KHZMZWZ0VHJpT3RoZXIpKXtyZXR1cm4gdHJ1ZTt9XG52UmlnaHRUcmlPdGhlcj1lLnN5bSgpLmxOZXh0KCkuZGVzdCgpO2lmKHRoaXMuaXNGcmFtZVZlcnRleCh2UmlnaHRUcmlPdGhlcikpe3JldHVybiB0cnVlO31cbnJldHVybiBmYWxzZTt9O2pzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuUXVhZEVkZ2VTdWJkaXZpc2lvbi5wcm90b3R5cGUuaXNGcmFtZVZlcnRleD1mdW5jdGlvbih2KXtpZih2LmVxdWFscyh0aGlzLmZyYW1lVmVydGV4WzBdKSl7cmV0dXJuIHRydWU7fVxuaWYodi5lcXVhbHModGhpcy5mcmFtZVZlcnRleFsxXSkpe3JldHVybiB0cnVlO31cbmlmKHYuZXF1YWxzKHRoaXMuZnJhbWVWZXJ0ZXhbMl0pKXtyZXR1cm4gdHJ1ZTt9XG5yZXR1cm4gZmFsc2U7fTtqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlF1YWRFZGdlU3ViZGl2aXNpb24ucHJvdG90eXBlLmlzT25FZGdlPWZ1bmN0aW9uKGUscCl7dGhpcy5zZWcuc2V0Q29vcmRpbmF0ZXMoZS5vcmlnKCkuZ2V0Q29vcmRpbmF0ZSgpLGUuZGVzdCgpLmdldENvb3JkaW5hdGUoKSk7dmFyIGRpc3Q9dGhpcy5zZWcuZGlzdGFuY2UocCk7cmV0dXJuIGRpc3Q8dGhpcy5lZGdlQ29pbmNpZGVuY2VUb2xlcmFuY2U7fTtqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlF1YWRFZGdlU3ViZGl2aXNpb24ucHJvdG90eXBlLmlzVmVydGV4T2ZFZGdlPWZ1bmN0aW9uKGUsdil7aWYoKHYuZXF1YWxzKGUub3JpZygpLHRoaXMudG9sZXJhbmNlKSl8fCh2LmVxdWFscyhlLmRlc3QoKSx0aGlzLnRvbGVyYW5jZSkpKXtyZXR1cm4gdHJ1ZTt9XG5yZXR1cm4gZmFsc2U7fTtqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlF1YWRFZGdlU3ViZGl2aXNpb24ucHJvdG90eXBlLmdldFZlcnRpY2VzPWZ1bmN0aW9uKGluY2x1ZGVGcmFtZSlcbnt2YXIgdmVydGljZXM9W10saSxpbCxxZSx2LHZkO2k9MCxpbD10aGlzLnF1YWRFZGdlcy5sZW5ndGg7Zm9yKGk7aTxpbDtpKyspe3FlPXRoaXMucXVhZEVkZ2VzW2ldO3Y9cWUub3JpZygpO2lmKGluY2x1ZGVGcmFtZXx8IXRoaXMuaXNGcmFtZVZlcnRleCh2KSl7dmVydGljZXMucHVzaCh2KTt9XG52ZD1xZS5kZXN0KCk7aWYoaW5jbHVkZUZyYW1lfHwhdGhpcy5pc0ZyYW1lVmVydGV4KHZkKSl7dmVydGljZXMucHVzaCh2ZCk7fX1cbnJldHVybiB2ZXJ0aWNlczt9O2pzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuUXVhZEVkZ2VTdWJkaXZpc2lvbi5wcm90b3R5cGUuZ2V0VmVydGV4VW5pcXVlRWRnZXM9ZnVuY3Rpb24oaW5jbHVkZUZyYW1lKVxue3ZhciBlZGdlcyx2aXNpdGVkVmVydGljZXMsaSxpbCxxZSx2LHFkLHZkO2VkZ2VzPVtdO3Zpc2l0ZWRWZXJ0aWNlcz1bXTtpPTAsaWw9dGhpcy5xdWFkRWRnZXMubGVuZ3RoO2ZvcihpO2k8aWw7aSsrKXtxZT10aGlzLnF1YWRFZGdlc1tpXTt2PXFlLm9yaWcoKTtpZih2aXNpdGVkVmVydGljZXMuaW5kZXhPZih2KT09PS0xKXt2aXNpdGVkVmVydGljZXMucHVzaCh2KTtpZihpbmNsdWRlRnJhbWV8fCF0aGlzLmlzRnJhbWVWZXJ0ZXgodikpe2VkZ2VzLnB1c2gocWUpO319XG5xZD1xZS5zeW0oKTt2ZD1xZC5vcmlnKCk7aWYodmlzaXRlZFZlcnRpY2VzLmluZGV4T2YodmQpPT09LTEpe3Zpc2l0ZWRWZXJ0aWNlcy5wdXNoKHZkKTtpZihpbmNsdWRlRnJhbWV8fCF0aGlzLmlzRnJhbWVWZXJ0ZXgodmQpKXtlZGdlcy5wdXNoKHFkKTt9fX1cbnJldHVybiBlZGdlczt9O2pzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuUXVhZEVkZ2VTdWJkaXZpc2lvbi5wcm90b3R5cGUuZ2V0UHJpbWFyeUVkZ2VzPWZ1bmN0aW9uKGluY2x1ZGVGcmFtZSl7dGhpcy52aXNpdGVkS2V5Kys7dmFyIGVkZ2VzLGVkZ2VTdGFjayx2aXNpdGVkRWRnZXMsZWRnZSxwcmlRRTtlZGdlcz1bXTtlZGdlU3RhY2s9W107ZWRnZVN0YWNrLnB1c2godGhpcy5zdGFydGluZ0VkZ2UpO3Zpc2l0ZWRFZGdlcz1bXTt3aGlsZShlZGdlU3RhY2subGVuZ3RoPjApe2VkZ2U9ZWRnZVN0YWNrLnBvcCgpO2lmKHZpc2l0ZWRFZGdlcy5pbmRleE9mKGVkZ2UpPT09LTEpe3ByaVFFPWVkZ2UuZ2V0UHJpbWFyeSgpO2lmKGluY2x1ZGVGcmFtZXx8IXRoaXMuaXNGcmFtZUVkZ2UocHJpUUUpKXtlZGdlcy5wdXNoKHByaVFFKTt9XG5lZGdlU3RhY2sucHVzaChlZGdlLm9OZXh0KCkpO2VkZ2VTdGFjay5wdXNoKGVkZ2Uuc3ltKCkub05leHQoKSk7dmlzaXRlZEVkZ2VzLnB1c2goZWRnZSk7dmlzaXRlZEVkZ2VzLnB1c2goZWRnZS5zeW0oKSk7fX1cbnJldHVybiBlZGdlczt9O2pzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuUXVhZEVkZ2VTdWJkaXZpc2lvbi5wcm90b3R5cGUudmlzaXRUcmlhbmdsZXM9ZnVuY3Rpb24odHJpVmlzaXRvcixpbmNsdWRlRnJhbWUpe3RoaXMudmlzaXRlZEtleSsrO3ZhciBlZGdlU3RhY2ssdmlzaXRlZEVkZ2VzLGVkZ2UsdHJpRWRnZXM7ZWRnZVN0YWNrPVtdO2VkZ2VTdGFjay5wdXNoKHRoaXMuc3RhcnRpbmdFZGdlKTt2aXNpdGVkRWRnZXM9W107d2hpbGUoZWRnZVN0YWNrLmxlbmd0aD4wKXtlZGdlPWVkZ2VTdGFjay5wb3AoKTtpZih2aXNpdGVkRWRnZXMuaW5kZXhPZihlZGdlKT09PS0xKXt0cmlFZGdlcz10aGlzLmZldGNoVHJpYW5nbGVUb1Zpc2l0KGVkZ2UsZWRnZVN0YWNrLGluY2x1ZGVGcmFtZSx2aXNpdGVkRWRnZXMpO2lmKHRyaUVkZ2VzIT09bnVsbClcbnRyaVZpc2l0b3IudmlzaXQodHJpRWRnZXMpO319fTtqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlF1YWRFZGdlU3ViZGl2aXNpb24ucHJvdG90eXBlLmZldGNoVHJpYW5nbGVUb1Zpc2l0PWZ1bmN0aW9uKGVkZ2UsZWRnZVN0YWNrLGluY2x1ZGVGcmFtZSx2aXNpdGVkRWRnZXMpe3ZhciBjdXJyLGVkZ2VDb3VudCxpc0ZyYW1lLHN5bTtjdXJyPWVkZ2U7ZWRnZUNvdW50PTA7aXNGcmFtZT1mYWxzZTtkb3t0aGlzLnRyaUVkZ2VzW2VkZ2VDb3VudF09Y3VycjtpZih0aGlzLmlzRnJhbWVFZGdlKGN1cnIpKXtpc0ZyYW1lPXRydWU7fVxuc3ltPWN1cnIuc3ltKCk7aWYodmlzaXRlZEVkZ2VzLmluZGV4T2Yoc3ltKT09PS0xKXtlZGdlU3RhY2sucHVzaChzeW0pO31cbnZpc2l0ZWRFZGdlcy5wdXNoKGN1cnIpO2VkZ2VDb3VudCsrO2N1cnI9Y3Vyci5sTmV4dCgpO313aGlsZShjdXJyIT09ZWRnZSk7aWYoaXNGcmFtZSYmIWluY2x1ZGVGcmFtZSl7cmV0dXJuIG51bGw7fVxucmV0dXJuIHRoaXMudHJpRWRnZXM7fTtqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlF1YWRFZGdlU3ViZGl2aXNpb24ucHJvdG90eXBlLmdldFRyaWFuZ2xlRWRnZXM9ZnVuY3Rpb24oaW5jbHVkZUZyYW1lKXt2YXIgdmlzaXRvcj1uZXcganN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5UcmlhbmdsZUVkZ2VzTGlzdFZpc2l0b3IoKTt0aGlzLnZpc2l0VHJpYW5nbGVzKHZpc2l0b3IsaW5jbHVkZUZyYW1lKTtyZXR1cm4gdmlzaXRvci5nZXRUcmlhbmdsZUVkZ2VzKCk7fTtqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlF1YWRFZGdlU3ViZGl2aXNpb24ucHJvdG90eXBlLmdldFRyaWFuZ2xlVmVydGljZXM9ZnVuY3Rpb24oaW5jbHVkZUZyYW1lKXt2YXIgdmlzaXRvcj1uZXcgVHJpYW5nbGVWZXJ0ZXhMaXN0VmlzaXRvcigpO3RoaXMudmlzaXRUcmlhbmdsZXModmlzaXRvcixpbmNsdWRlRnJhbWUpO3JldHVybiB2aXNpdG9yLmdldFRyaWFuZ2xlVmVydGljZXMoKTt9O2pzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuUXVhZEVkZ2VTdWJkaXZpc2lvbi5wcm90b3R5cGUuZ2V0VHJpYW5nbGVDb29yZGluYXRlcz1mdW5jdGlvbihpbmNsdWRlRnJhbWUpe3ZhciB2aXNpdG9yPW5ldyBqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlRyaWFuZ2xlQ29vcmRpbmF0ZXNWaXNpdG9yKCk7dGhpcy52aXNpdFRyaWFuZ2xlcyh2aXNpdG9yLGluY2x1ZGVGcmFtZSk7cmV0dXJuIHZpc2l0b3IuZ2V0VHJpYW5nbGVzKCk7fTtqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlF1YWRFZGdlU3ViZGl2aXNpb24ucHJvdG90eXBlLmdldEVkZ2VzQnlGYWN0b3J5PWZ1bmN0aW9uKGdlb21GYWN0KXt2YXIgcXVhZEVkZ2VzLGVkZ2VzLGksaWwscWUsY29vcmRzO3F1YWRFZGdlcz10aGlzLmdldFByaW1hcnlFZGdlcyhmYWxzZSk7ZWRnZXM9W107aT0wO2lsPXF1YWRFZGdlcy5sZW5ndGg7Zm9yKGk7aTxpbDtpKyspe3FlPXF1YWRFZGdlc1tpXTtjb29yZHM9W107Y29vcmRzWzBdPShxZS5vcmlnKCkuZ2V0Q29vcmRpbmF0ZSgpKTtjb29yZHNbMV09KHFlLmRlc3QoKS5nZXRDb29yZGluYXRlKCkpO2VkZ2VzW2ldPWdlb21GYWN0LmNyZWF0ZUxpbmVTdHJpbmcoY29vcmRzKTt9XG5yZXR1cm4gZ2VvbUZhY3QuY3JlYXRlTXVsdGlMaW5lU3RyaW5nKGVkZ2VzKTt9O2pzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuUXVhZEVkZ2VTdWJkaXZpc2lvbi5wcm90b3R5cGUuZ2V0VHJpYW5nbGVzPWZ1bmN0aW9uKGdlb21GYWN0KXt2YXIgdHJpUHRzTGlzdCx0cmlzLHRyaVB0LGksaWw7dHJpUHRzTGlzdD10aGlzLmdldFRyaWFuZ2xlQ29vcmRpbmF0ZXMoZmFsc2UpO3RyaXM9bmV3IEFycmF5KHRyaVB0c0xpc3QubGVuZ3RoKTtpPTAsaWw9dHJpUHRzTGlzdC5sZW5ndGg7Zm9yKGk7aTxpbDtpKyspe3RyaVB0PXRyaVB0c0xpc3RbaV07dHJpc1tpXT1nZW9tRmFjdC5jcmVhdGVQb2x5Z29uKGdlb21GYWN0LmNyZWF0ZUxpbmVhclJpbmcodHJpUHQsbnVsbCkpO31cbnJldHVybiBnZW9tRmFjdC5jcmVhdGVHZW9tZXRyeUNvbGxlY3Rpb24odHJpcyk7fTtqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlF1YWRFZGdlU3ViZGl2aXNpb24ucHJvdG90eXBlLmdldFZvcm9ub2lEaWFncmFtPWZ1bmN0aW9uKGdlb21GYWN0KVxue3ZhciB2b3JDZWxscz10aGlzLmdldFZvcm9ub2lDZWxsUG9seWdvbnMoZ2VvbUZhY3QpO3JldHVybiBnZW9tRmFjdC5jcmVhdGVHZW9tZXRyeUNvbGxlY3Rpb24odm9yQ2VsbHMpO307anN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5RdWFkRWRnZVN1YmRpdmlzaW9uLnByb3RvdHlwZS5nZXRWb3Jvbm9pQ2VsbFBvbHlnb25zPWZ1bmN0aW9uKGdlb21GYWN0KVxue3RoaXMudmlzaXRUcmlhbmdsZXMobmV3IGpzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuVHJpYW5nbGVDaXJjdW1jZW50cmVWaXNpdG9yKCksdHJ1ZSk7dmFyIGNlbGxzLGVkZ2VzLGksaWwscWU7Y2VsbHM9W107ZWRnZXM9dGhpcy5nZXRWZXJ0ZXhVbmlxdWVFZGdlcyhmYWxzZSk7aT0wLGlsPWVkZ2VzLmxlbmd0aDtmb3IoaTtpPGlsO2krKyl7cWU9ZWRnZXNbaV07Y2VsbHMucHVzaCh0aGlzLmdldFZvcm9ub2lDZWxsUG9seWdvbihxZSxnZW9tRmFjdCkpO31cbnJldHVybiBjZWxsczt9O2pzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuUXVhZEVkZ2VTdWJkaXZpc2lvbi5wcm90b3R5cGUuZ2V0Vm9yb25vaUNlbGxQb2x5Z29uPWZ1bmN0aW9uKHFlLGdlb21GYWN0KVxue3ZhciBjZWxsUHRzLHN0YXJ0UWUsY2MsY29vcmRMaXN0LGNlbGxQb2x5LHY7Y2VsbFB0cz1bXTtzdGFydFFFPXFlO2Rve2NjPXFlLnJvdC5vcmlnKCkuZ2V0Q29vcmRpbmF0ZSgpO2NlbGxQdHMucHVzaChjYyk7cWU9cWUub1ByZXYoKTt9d2hpbGUocWUhPT1zdGFydFFFKTtjb29yZExpc3Q9bmV3IGpzdHMuZ2VvbS5Db29yZGluYXRlTGlzdChbXSxmYWxzZSk7Y29vcmRMaXN0LmFkZChjZWxsUHRzLGZhbHNlKTtjb29yZExpc3QuY2xvc2VSaW5nKCk7aWYoY29vcmRMaXN0LnNpemUoKTw0KXtjb29yZExpc3QuYWRkKGNvb3JkTGlzdC5nZXQoY29vcmRMaXN0LnNpemUoKS0xKSx0cnVlKTt9XG5jZWxsUG9seT1nZW9tRmFjdC5jcmVhdGVQb2x5Z29uKGdlb21GYWN0LmNyZWF0ZUxpbmVhclJpbmcoY29vcmRMaXN0LnRvQXJyYXkoKSksbnVsbCk7dj1zdGFydFFFLm9yaWcoKTtyZXR1cm4gY2VsbFBvbHk7fTtqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlRyaWFuZ2xlQ2lyY3VtY2VudHJlVmlzaXRvcj1mdW5jdGlvbigpe307anN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5UcmlhbmdsZUNpcmN1bWNlbnRyZVZpc2l0b3IucHJvdG90eXBlLnZpc2l0PWZ1bmN0aW9uKHRyaUVkZ2VzKXt2YXIgYSxiLGMsY2MsY2NWZXJ0ZXgsaTthPXRyaUVkZ2VzWzBdLm9yaWcoKS5nZXRDb29yZGluYXRlKCk7Yj10cmlFZGdlc1sxXS5vcmlnKCkuZ2V0Q29vcmRpbmF0ZSgpO2M9dHJpRWRnZXNbMl0ub3JpZygpLmdldENvb3JkaW5hdGUoKTtjYz1qc3RzLmdlb20uVHJpYW5nbGUuY2lyY3VtY2VudHJlKGEsYixjKTtjY1ZlcnRleD1uZXcganN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5WZXJ0ZXgoY2MpO2k9MDtmb3IoaTtpPDM7aSsrKXt0cmlFZGdlc1tpXS5yb3Quc2V0T3JpZyhjY1ZlcnRleCk7fX07anN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5UcmlhbmdsZUVkZ2VzTGlzdFZpc2l0b3I9ZnVuY3Rpb24oKXt0aGlzLnRyaUxpc3Q9W107fTtqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlRyaWFuZ2xlRWRnZXNMaXN0VmlzaXRvci5wcm90b3R5cGUudmlzaXQ9ZnVuY3Rpb24odHJpRWRnZXMpe3ZhciBjbG9uZT10cmlFZGdlcy5jb25jYXQoKTt0aGlzLnRyaUxpc3QucHVzaChjbG9uZSk7fTtqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlRyaWFuZ2xlRWRnZXNMaXN0VmlzaXRvci5wcm90b3R5cGUuZ2V0VHJpYW5nbGVFZGdlcz1mdW5jdGlvbigpe3JldHVybiB0aGlzLnRyaUxpc3Q7fTtqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlRyaWFuZ2xlVmVydGV4TGlzdFZpc2l0b3I9ZnVuY3Rpb24oKXt0aGlzLnRyaUxpc3Q9W107fTtqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlRyaWFuZ2xlVmVydGV4TGlzdFZpc2l0b3IucHJvdG90eXBlLnZpc2l0PWZ1bmN0aW9uKHRyaUVkZ2VzKXt2YXIgdmVydGljZXM9W107dmVydGljZXMucHVzaCh0cmllRWRnZXNbMF0ub3JpZygpKTt2ZXJ0aWNlcy5wdXNoKHRyaWVFZGdlc1sxXS5vcmlnKCkpO3ZlcnRpY2VzLnB1c2godHJpZUVkZ2VzWzJdLm9yaWcoKSk7dGhpcy50cmlMaXN0LnB1c2godmVydGljZXMpO307anN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5UcmlhbmdsZVZlcnRleExpc3RWaXNpdG9yLnByb3RvdHlwZS5nZXRUcmlhbmdsZVZlcnRpY2VzPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMudHJpTGlzdDt9O2pzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuVHJpYW5nbGVDb29yZGluYXRlc1Zpc2l0b3I9ZnVuY3Rpb24oKXt0aGlzLmNvb3JkTGlzdD1uZXcganN0cy5nZW9tLkNvb3JkaW5hdGVMaXN0KFtdLGZhbHNlKTt0aGlzLnRyaUNvb3Jkcz1bXTt9O2pzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuVHJpYW5nbGVDb29yZGluYXRlc1Zpc2l0b3IucHJvdG90eXBlLnZpc2l0PWZ1bmN0aW9uKHRyaUVkZ2VzKXt0aGlzLmNvb3JkTGlzdD1uZXcganN0cy5nZW9tLkNvb3JkaW5hdGVMaXN0KFtdLGZhbHNlKTt2YXIgaT0wLHYscHRzO2ZvcihpO2k8MztpKyspe3Y9dHJpRWRnZXNbaV0ub3JpZygpO3RoaXMuY29vcmRMaXN0LmFkZCh2LmdldENvb3JkaW5hdGUoKSk7fVxuaWYodGhpcy5jb29yZExpc3Quc2l6ZSgpPjApe3RoaXMuY29vcmRMaXN0LmNsb3NlUmluZygpO3B0cz10aGlzLmNvb3JkTGlzdC50b0FycmF5KCk7aWYocHRzLmxlbmd0aCE9PTQpe3JldHVybjt9XG50aGlzLnRyaUNvb3Jkcy5wdXNoKHB0cyk7fX07anN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5UcmlhbmdsZUNvb3JkaW5hdGVzVmlzaXRvci5wcm90b3R5cGUuZ2V0VHJpYW5nbGVzPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMudHJpQ29vcmRzO307anN0cy5vcGVyYXRpb24ucmVsYXRlLkVkZ2VFbmRCdW5kbGU9ZnVuY3Rpb24oKXt0aGlzLmVkZ2VFbmRzPVtdO3ZhciBlPWFyZ3VtZW50c1swXWluc3RhbmNlb2YganN0cy5nZW9tZ3JhcGguRWRnZUVuZD9hcmd1bWVudHNbMF06YXJndW1lbnRzWzFdO3ZhciBlZGdlPWUuZ2V0RWRnZSgpO3ZhciBjb29yZD1lLmdldENvb3JkaW5hdGUoKTt2YXIgZGlyQ29vcmQ9ZS5nZXREaXJlY3RlZENvb3JkaW5hdGUoKTt2YXIgbGFiZWw9bmV3IGpzdHMuZ2VvbWdyYXBoLkxhYmVsKGUuZ2V0TGFiZWwoKSk7anN0cy5nZW9tZ3JhcGguRWRnZUVuZC5jYWxsKHRoaXMsZWRnZSxjb29yZCxkaXJDb29yZCxsYWJlbCk7dGhpcy5pbnNlcnQoZSk7fTtqc3RzLm9wZXJhdGlvbi5yZWxhdGUuRWRnZUVuZEJ1bmRsZS5wcm90b3R5cGU9bmV3IGpzdHMuZ2VvbWdyYXBoLkVkZ2VFbmQoKTtqc3RzLm9wZXJhdGlvbi5yZWxhdGUuRWRnZUVuZEJ1bmRsZS5wcm90b3R5cGUuZWRnZUVuZHM9bnVsbDtqc3RzLm9wZXJhdGlvbi5yZWxhdGUuRWRnZUVuZEJ1bmRsZS5wcm90b3R5cGUuZ2V0TGFiZWw9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5sYWJlbDt9O2pzdHMub3BlcmF0aW9uLnJlbGF0ZS5FZGdlRW5kQnVuZGxlLnByb3RvdHlwZS5nZXRFZGdlRW5kcz1mdW5jdGlvbigpe3JldHVybiB0aGlzLmVkZ2VFbmRzO307anN0cy5vcGVyYXRpb24ucmVsYXRlLkVkZ2VFbmRCdW5kbGUucHJvdG90eXBlLmluc2VydD1mdW5jdGlvbihlKXt0aGlzLmVkZ2VFbmRzLnB1c2goZSk7fTtqc3RzLm9wZXJhdGlvbi5yZWxhdGUuRWRnZUVuZEJ1bmRsZS5wcm90b3R5cGUuY29tcHV0ZUxhYmVsPWZ1bmN0aW9uKGJvdW5kYXJ5Tm9kZVJ1bGUpe3ZhciBpc0FyZWE9ZmFsc2U7Zm9yKHZhciBpPTA7aTx0aGlzLmVkZ2VFbmRzLmxlbmd0aDtpKyspe3ZhciBlPXRoaXMuZWRnZUVuZHNbaV07aWYoZS5nZXRMYWJlbCgpLmlzQXJlYSgpKVxuaXNBcmVhPXRydWU7fVxuaWYoaXNBcmVhKVxudGhpcy5sYWJlbD1uZXcganN0cy5nZW9tZ3JhcGguTGFiZWwoanN0cy5nZW9tLkxvY2F0aW9uLk5PTkUsanN0cy5nZW9tLkxvY2F0aW9uLk5PTkUsanN0cy5nZW9tLkxvY2F0aW9uLk5PTkUpO2Vsc2VcbnRoaXMubGFiZWw9bmV3IGpzdHMuZ2VvbWdyYXBoLkxhYmVsKGpzdHMuZ2VvbS5Mb2NhdGlvbi5OT05FKTtmb3IodmFyIGk9MDtpPDI7aSsrKXt0aGlzLmNvbXB1dGVMYWJlbE9uKGksYm91bmRhcnlOb2RlUnVsZSk7aWYoaXNBcmVhKVxudGhpcy5jb21wdXRlTGFiZWxTaWRlcyhpKTt9fTtqc3RzLm9wZXJhdGlvbi5yZWxhdGUuRWRnZUVuZEJ1bmRsZS5wcm90b3R5cGUuY29tcHV0ZUxhYmVsT249ZnVuY3Rpb24oZ2VvbUluZGV4LGJvdW5kYXJ5Tm9kZVJ1bGUpe3ZhciBib3VuZGFyeUNvdW50PTA7dmFyIGZvdW5kSW50ZXJpb3I9ZmFsc2U7Zm9yKHZhciBpPTA7aTx0aGlzLmVkZ2VFbmRzLmxlbmd0aDtpKyspe3ZhciBlPXRoaXMuZWRnZUVuZHNbaV07dmFyIGxvYz1lLmdldExhYmVsKCkuZ2V0TG9jYXRpb24oZ2VvbUluZGV4KTtpZihsb2M9PWpzdHMuZ2VvbS5Mb2NhdGlvbi5CT1VOREFSWSlcbmJvdW5kYXJ5Q291bnQrKztpZihsb2M9PWpzdHMuZ2VvbS5Mb2NhdGlvbi5JTlRFUklPUilcbmZvdW5kSW50ZXJpb3I9dHJ1ZTt9XG52YXIgbG9jPWpzdHMuZ2VvbS5Mb2NhdGlvbi5OT05FO2lmKGZvdW5kSW50ZXJpb3IpXG5sb2M9anN0cy5nZW9tLkxvY2F0aW9uLklOVEVSSU9SO2lmKGJvdW5kYXJ5Q291bnQ+MCl7bG9jPWpzdHMuZ2VvbWdyYXBoLkdlb21ldHJ5R3JhcGguZGV0ZXJtaW5lQm91bmRhcnkoYm91bmRhcnlOb2RlUnVsZSxib3VuZGFyeUNvdW50KTt9XG50aGlzLmxhYmVsLnNldExvY2F0aW9uKGdlb21JbmRleCxsb2MpO307anN0cy5vcGVyYXRpb24ucmVsYXRlLkVkZ2VFbmRCdW5kbGUucHJvdG90eXBlLmNvbXB1dGVMYWJlbFNpZGVzPWZ1bmN0aW9uKGdlb21JbmRleCl7dGhpcy5jb21wdXRlTGFiZWxTaWRlKGdlb21JbmRleCxqc3RzLmdlb21ncmFwaC5Qb3NpdGlvbi5MRUZUKTt0aGlzLmNvbXB1dGVMYWJlbFNpZGUoZ2VvbUluZGV4LGpzdHMuZ2VvbWdyYXBoLlBvc2l0aW9uLlJJR0hUKTt9O2pzdHMub3BlcmF0aW9uLnJlbGF0ZS5FZGdlRW5kQnVuZGxlLnByb3RvdHlwZS5jb21wdXRlTGFiZWxTaWRlPWZ1bmN0aW9uKGdlb21JbmRleCxzaWRlKXtmb3IodmFyIGk9MDtpPHRoaXMuZWRnZUVuZHMubGVuZ3RoO2krKyl7dmFyIGU9dGhpcy5lZGdlRW5kc1tpXTtpZihlLmdldExhYmVsKCkuaXNBcmVhKCkpe3ZhciBsb2M9ZS5nZXRMYWJlbCgpLmdldExvY2F0aW9uKGdlb21JbmRleCxzaWRlKTtpZihsb2M9PT1qc3RzLmdlb20uTG9jYXRpb24uSU5URVJJT1Ipe3RoaXMubGFiZWwuc2V0TG9jYXRpb24oZ2VvbUluZGV4LHNpZGUsanN0cy5nZW9tLkxvY2F0aW9uLklOVEVSSU9SKTtyZXR1cm47fWVsc2UgaWYobG9jPT09anN0cy5nZW9tLkxvY2F0aW9uLkVYVEVSSU9SKVxudGhpcy5sYWJlbC5zZXRMb2NhdGlvbihnZW9tSW5kZXgsc2lkZSxqc3RzLmdlb20uTG9jYXRpb24uRVhURVJJT1IpO319fTtqc3RzLm9wZXJhdGlvbi5yZWxhdGUuRWRnZUVuZEJ1bmRsZS5wcm90b3R5cGUudXBkYXRlSU09ZnVuY3Rpb24oaW0pe2pzdHMuZ2VvbWdyYXBoLkVkZ2UudXBkYXRlSU0odGhpcy5sYWJlbCxpbSk7fTtqc3RzLmluZGV4LmtkdHJlZS5LZFRyZWU9ZnVuY3Rpb24odG9sZXJhbmNlKXt2YXIgdG9sPTAuMDtpZih0b2xlcmFuY2UhPT11bmRlZmluZWQpe3RvbD10b2xlcmFuY2U7fVxudGhpcy5yb290PW51bGw7dGhpcy5sYXN0PW51bGw7dGhpcy5udW1iZXJPZk5vZGVzPTA7dGhpcy50b2xlcmFuY2U9dG9sO307anN0cy5pbmRleC5rZHRyZWUuS2RUcmVlLnByb3RvdHlwZS5pbnNlcnQ9ZnVuY3Rpb24oKXtpZihhcmd1bWVudHMubGVuZ3RoPT09MSl7cmV0dXJuIHRoaXMuaW5zZXJ0Q29vcmRpbmF0ZS5hcHBseSh0aGlzLGFyZ3VtZW50c1swXSk7fWVsc2V7cmV0dXJuIHRoaXMuaW5zZXJ0V2l0aERhdGEuYXBwbHkodGhpcyxhcmd1bWVudHNbMF0sYXJndW1lbnRzWzFdKTt9fTtqc3RzLmluZGV4LmtkdHJlZS5LZFRyZWUucHJvdG90eXBlLmluc2VydENvb3JkaW5hdGU9ZnVuY3Rpb24ocCl7cmV0dXJuIHRoaXMuaW5zZXJ0V2l0aERhdGEocCxudWxsKTt9O2pzdHMuaW5kZXgua2R0cmVlLktkVHJlZS5wcm90b3R5cGUuaW5zZXJ0V2l0aERhdGE9ZnVuY3Rpb24ocCxkYXRhKXtpZih0aGlzLnJvb3Q9PT1udWxsKXt0aGlzLnJvb3Q9bmV3IGpzdHMuaW5kZXgua2R0cmVlLktkTm9kZShwLGRhdGEpO3JldHVybiB0aGlzLnJvb3Q7fVxudmFyIGN1cnJlbnROb2RlPXRoaXMucm9vdCxsZWFmTm9kZT10aGlzLnJvb3QsaXNPZGRMZXZlbD10cnVlLGlzTGVzc1RoYW49dHJ1ZTt3aGlsZShjdXJyZW50Tm9kZSE9PWxhc3Qpe2lmKGlzT2RkTGV2ZWwpe2lzTGVzc1RoYW49cC54PGN1cnJlbnROb2RlLmdldFgoKTt9ZWxzZXtpc0xlc3NUaGFuPXAueTxjdXJyZW50Tm9kZS5nZXRZKCk7fVxubGVhZk5vZGU9Y3VycmVudE5vZGU7aWYoaXNMZXNzVGhhbil7Y3VycmVudE5vZGU9Y3VycmVudE5vZGUuZ2V0TGVmdCgpO31lbHNle2N1cnJlbnROb2RlPWN1cnJlbnROb2RlLmdldFJpZ2h0KCk7fVxuaWYoY3VycmVudE5vZGUhPT1udWxsKXt2YXIgaXNJblRvbGVyYW5jZT1wLmRpc3RhbmNlKGN1cnJlbnROb2RlLmdldENvb3JkaW5hdGUoKSk8PXRoaXMudG9sZXJhbmNlO2lmKGlzSW5Ub2xlcmFuY2Upe2N1cnJlbnROb2RlLmluY3JlbWVudCgpO3JldHVybiBjdXJyZW50Tm9kZTt9fVxuaXNPZGRMZXZlbD0haXNPZGRMZXZlbDt9XG50aGlzLm51bWJlck9mTm9kZXM9bnVtYmVyT2ZOb2RlcysxO3ZhciBub2RlPW5ldyBqc3RzLmluZGV4LmtkdHJlZS5LZE5vZGUocCxkYXRhKTtub2RlLnNldExlZnQodGhpcy5sYXN0KTtub2RlLnNldFJpZ2h0KHRoaXMubGFzdCk7aWYoaXNMZXNzVGhhbil7bGVhZk5vZGUuc2V0TGVmdChub2RlKTt9ZWxzZXtsZWFmTm9kZS5zZXRSaWdodChub2RlKTt9XG5yZXR1cm4gbm9kZTt9O2pzdHMuaW5kZXgua2R0cmVlLktkVHJlZS5wcm90b3R5cGUucXVlcnlOb2RlPWZ1bmN0aW9uKGN1cnJlbnROb2RlLGJvdHRvbU5vZGUscXVlcnlFbnYsb2RkLHJlc3VsdCl7aWYoY3VycmVudE5vZGU9PT1ib3R0b21Ob2RlKXtyZXR1cm47fVxudmFyIG1pbixtYXgsZGlzY3JpbWluYW50O2lmKG9kZCl7bWluPXF1ZXJ5RW52LmdldE1pblgoKTttYXg9cXVlcnlFbnYuZ2V0TWF4WCgpO2Rpc2NyaW1pbmFudD1jdXJyZW50Tm9kZS5nZXRYKCk7fWVsc2V7bWluPXF1ZXJ5RW52LmdldE1pblkoKTttYXg9cXVlcnlFbnYuZ2V0TWF4WSgpO2Rpc2NyaW1pbmFudD1jdXJyZW50Tm9kZS5nZXRZKCk7fVxudmFyIHNlYXJjaExlZnQ9bWluPGRpc2NyaW1pbmFudDt2YXIgc2VhcmNoUmlnaHQ9ZGlzY3JpbWluYW50PD1tYXg7aWYoc2VhcmNoTGVmdCl7dGhpcy5xdWVyeU5vZGUoY3VycmVudE5vZGUuZ2V0TGVmdCgpLGJvdHRvbU5vZGUscXVlcnlFbnYsIW9kZCxyZXN1bHQpO31cbmlmKHF1ZXJ5RW52LmNvbnRhaW5zKGN1cnJlbnROb2RlLmdldENvb3JkaW5hdGUoKSkpe3Jlc3VsdC5hZGQoY3VycmVudE5vZGUpO31cbmlmKHNlYXJjaFJpZ2h0KXt0aGlzLnF1ZXJ5Tm9kZShjdXJyZW50Tm9kZS5nZXRSaWdodCgpLGJvdHRvbU5vZGUscXVlcnlFbnYsIW9kZCxyZXN1bHQpO319O2pzdHMuaW5kZXgua2R0cmVlLktkVHJlZS5wcm90b3R5cGUucXVlcnk9ZnVuY3Rpb24oKXtpZihhcmd1bWVudHMubGVuZ3RoPT09MSl7cmV0dXJuIHRoaXMucXVlcnlCeUVudmVsb3BlLmFwcGx5KHRoaXMsYXJndW1lbnRzWzBdKTt9ZWxzZXtyZXR1cm4gdGhpcy5xdWVyeVdpdGhBcnJheS5hcHBseSh0aGlzLGFyZ3VtZW50c1swXSxhcmd1bWVudHNbMV0pO319O2pzdHMuaW5kZXgua2R0cmVlLktkVHJlZS5wcm90b3R5cGUucXVlcnlCeUVudmVsb3BlPWZ1bmN0aW9uKHF1ZXJ5RW52KXt2YXIgcmVzdWx0PVtdO3RoaXMucXVlcnlOb2RlKHRoaXMucm9vdCx0aGlzLmxhc3QscXVlcnlFbnYsdHJ1ZSxyZXN1bHQpO3JldHVybiByZXN1bHQ7fTtqc3RzLmluZGV4LmtkdHJlZS5LZFRyZWUucHJvdG90eXBlLnF1ZXJ5V2l0aEFycmF5PWZ1bmN0aW9uKHF1ZXJ5RW52LHJlc3VsdCl7dGhpcy5xdWVyeU5vZGUodGhpcy5yb290LHRoaXMubGFzdCxxdWVyeUVudix0cnVlLHJlc3VsdCk7fTtqc3RzLmdlb20uVHJpYW5nbGU9ZnVuY3Rpb24ocDAscDEscDIpe3RoaXMucDA9cDA7dGhpcy5wMT1wMTt0aGlzLnAyPXAyO307anN0cy5nZW9tLlRyaWFuZ2xlLmlzQWN1dGU9ZnVuY3Rpb24oYSxiLGMpe2lmKCFqc3RzLmFsZ29yaXRobS5BbmdsZS5pc0FjdXRlKGEsYixjKSl7cmV0dXJuIGZhbHNlO31cbmlmKCFqc3RzLmFsZ29yaXRobS5BbmdsZS5pc0FjdXRlKGIsYyxhKSl7cmV0dXJuIGZhbHNlO31cbmlmKCFqc3RzLmFsZ29yaXRobS5BbmdsZS5pc0FjdXRlKGMsYSxiKSl7cmV0dXJuIGZhbHNlO31cbnJldHVybiB0cnVlO307anN0cy5nZW9tLlRyaWFuZ2xlLnBlcnBlbmRpY3VsYXJCaXNlY3Rvcj1mdW5jdGlvbihhLGIpe3ZhciBkeCxkeSxsMSxsMjtkeD1iLngtYS54O2R5PWIueS1hLnk7bDE9bmV3IGpzdHMuYWxnb3JpdGhtLkhDb29yZGluYXRlKGEueCtkeC8yLjAsYS55K2R5LzIuMCwxLjApO2wyPW5ldyBqc3RzLmFsZ29yaXRobS5IQ29vcmRpbmF0ZShhLngtZHkrZHgvMi4wLGEueStkeCtkeS8yLjAsMS4wKTtyZXR1cm4gbmV3IGpzdHMuYWxnb3JpdGhtLkhDb29yZGluYXRlKGwxLGwyKTt9O2pzdHMuZ2VvbS5UcmlhbmdsZS5jaXJjdW1jZW50cmU9ZnVuY3Rpb24oYSxiLGMpe3ZhciBjeCxjeSxheCxheSxieCxieSxkZW5vbSxudW14LG51bXksY2N4LGNjeTtjeD1jLng7Y3k9Yy55O2F4PWEueC1jeDtheT1hLnktY3k7Yng9Yi54LWN4O2J5PWIueS1jeTtkZW5vbT0yKmpzdHMuZ2VvbS5UcmlhbmdsZS5kZXQoYXgsYXksYngsYnkpO251bXg9anN0cy5nZW9tLlRyaWFuZ2xlLmRldChheSxheCpheCtheSpheSxieSxieCpieCtieSpieSk7bnVteT1qc3RzLmdlb20uVHJpYW5nbGUuZGV0KGF4LGF4KmF4K2F5KmF5LGJ4LGJ4KmJ4K2J5KmJ5KTtjY3g9Y3gtbnVteC9kZW5vbTtjY3k9Y3krbnVteS9kZW5vbTtyZXR1cm4gbmV3IGpzdHMuZ2VvbS5Db29yZGluYXRlKGNjeCxjY3kpO307anN0cy5nZW9tLlRyaWFuZ2xlLmRldD1mdW5jdGlvbihtMDAsbTAxLG0xMCxtMTEpe3JldHVybiBtMDAqbTExLW0wMSptMTA7fTtqc3RzLmdlb20uVHJpYW5nbGUuaW5DZW50cmU9ZnVuY3Rpb24oYSxiLGMpe3ZhciBsZW4wLGxlbjEsbGVuMixjaXJjdW0saW5DZW50cmVYLGluQ2VudHJlWTtsZW4wPWIuZGlzdGFuY2UoYyk7bGVuMT1hLmRpc3RhbmNlKGMpO2xlbjI9YS5kaXN0YW5jZShiKTtjaXJjdW09bGVuMCtsZW4xK2xlbjI7aW5DZW50cmVYPShsZW4wKmEueCtsZW4xKmIueCtsZW4yKmMueCkvY2lyY3VtO2luQ2VudHJlWT0obGVuMCphLnkrbGVuMSpiLnkrbGVuMipjLnkpL2NpcmN1bTtyZXR1cm4gbmV3IGpzdHMuZ2VvbS5Db29yZGluYXRlKGluQ2VudHJlWCxpbkNlbnRyZVkpO307anN0cy5nZW9tLlRyaWFuZ2xlLmNlbnRyb2lkPWZ1bmN0aW9uKGEsYixjKXt2YXIgeCx5O3g9KGEueCtiLngrYy54KS8zO3k9KGEueStiLnkrYy55KS8zO3JldHVybiBuZXcganN0cy5nZW9tLkNvb3JkaW5hdGUoeCx5KTt9O2pzdHMuZ2VvbS5UcmlhbmdsZS5sb25nZXN0U2lkZUxlbmd0aD1mdW5jdGlvbihhLGIsYyl7dmFyIGxlbkFCLGxlbkJDLGxlbkNBLG1heExlbjtsZW5BQj1hLmRpc3RhbmNlKGIpO2xlbkJDPWIuZGlzdGFuY2UoYyk7bGVuQ0E9Yy5kaXN0YW5jZShhKTttYXhMZW49bGVuQUI7aWYobGVuQkM+bWF4TGVuKXttYXhMZW49bGVuQkM7fVxuaWYobGVuQ0E+bWF4TGVuKXttYXhMZW49bGVuQ0E7fVxucmV0dXJuIG1heExlbjt9O2pzdHMuZ2VvbS5UcmlhbmdsZS5hbmdsZUJpc2VjdG9yPWZ1bmN0aW9uKGEsYixjKXt2YXIgbGVuMCxsZW4yLGZyYWMsZHgsZHksc3BsaXRQdDtsZW4wPWIuZGlzdGFuY2UoYSk7bGVuMj1iLmRpc3RhbmNlKGMpO2ZyYWM9bGVuMC8obGVuMCtsZW4yKTtkeD1jLngtYS54O2R5PWMueS1hLnk7c3BsaXRQdD1uZXcganN0cy5nZW9tLkNvb3JkaW5hdGUoYS54K2ZyYWMqZHgsYS55K2ZyYWMqZHkpO3JldHVybiBzcGxpdFB0O307anN0cy5nZW9tLlRyaWFuZ2xlLmFyZWE9ZnVuY3Rpb24oYSxiLGMpe3JldHVybiBNYXRoLmFicygoKGMueC1hLngpKihiLnktYS55KS0oYi54LWEueCkqKGMueS1hLnkpKS8yLjApO307anN0cy5nZW9tLlRyaWFuZ2xlLnNpZ25lZEFyZWE9ZnVuY3Rpb24oYSxiLGMpe3JldHVybigoYy54LWEueCkqKGIueS1hLnkpLShiLngtYS54KSooYy55LWEueSkpLzIuMDt9O2pzdHMuZ2VvbS5UcmlhbmdsZS5wcm90b3R5cGUuaW5DZW50cmU9ZnVuY3Rpb24oKXtyZXR1cm4ganN0cy5nZW9tLlRyaWFuZ2xlLmluQ2VudHJlKHRoaXMucDAsdGhpcy5wMSx0aGlzLnAyKTt9O2pzdHMubm9kaW5nLk9yaWVudGVkQ29vcmRpbmF0ZUFycmF5PWZ1bmN0aW9uKHB0cyl7dGhpcy5wdHM9cHRzO3RoaXMuX29yaWVudGF0aW9uPWpzdHMubm9kaW5nLk9yaWVudGVkQ29vcmRpbmF0ZUFycmF5Lm9yaWVudGF0aW9uKHB0cyk7fTtqc3RzLm5vZGluZy5PcmllbnRlZENvb3JkaW5hdGVBcnJheS5wcm90b3R5cGUucHRzPW51bGw7anN0cy5ub2RpbmcuT3JpZW50ZWRDb29yZGluYXRlQXJyYXkucHJvdG90eXBlLl9vcmllbnRhdGlvbj11bmRlZmluZWQ7anN0cy5ub2RpbmcuT3JpZW50ZWRDb29yZGluYXRlQXJyYXkub3JpZW50YXRpb249ZnVuY3Rpb24ocHRzKXtyZXR1cm4ganN0cy5nZW9tLkNvb3JkaW5hdGVBcnJheXMuaW5jcmVhc2luZ0RpcmVjdGlvbihwdHMpPT09MTt9O2pzdHMubm9kaW5nLk9yaWVudGVkQ29vcmRpbmF0ZUFycmF5LnByb3RvdHlwZS5jb21wYXJlVG89ZnVuY3Rpb24obzEpe3ZhciBvY2E9bzE7dmFyIGNvbXA9anN0cy5ub2RpbmcuT3JpZW50ZWRDb29yZGluYXRlQXJyYXkuY29tcGFyZU9yaWVudGVkKHRoaXMucHRzLHRoaXMuX29yaWVudGF0aW9uLG9jYS5wdHMsb2NhLl9vcmllbnRhdGlvbik7cmV0dXJuIGNvbXA7fTtqc3RzLm5vZGluZy5PcmllbnRlZENvb3JkaW5hdGVBcnJheS5jb21wYXJlT3JpZW50ZWQ9ZnVuY3Rpb24ocHRzMSxvcmllbnRhdGlvbjEscHRzMixvcmllbnRhdGlvbjIpe3ZhciBkaXIxPW9yaWVudGF0aW9uMT8xOi0xO3ZhciBkaXIyPW9yaWVudGF0aW9uMj8xOi0xO3ZhciBsaW1pdDE9b3JpZW50YXRpb24xP3B0czEubGVuZ3RoOi0xO3ZhciBsaW1pdDI9b3JpZW50YXRpb24yP3B0czIubGVuZ3RoOi0xO3ZhciBpMT1vcmllbnRhdGlvbjE/MDpwdHMxLmxlbmd0aC0xO3ZhciBpMj1vcmllbnRhdGlvbjI/MDpwdHMyLmxlbmd0aC0xO3ZhciBjb21wPTA7d2hpbGUodHJ1ZSl7dmFyIGNvbXBQdD1wdHMxW2kxXS5jb21wYXJlVG8ocHRzMltpMl0pO2lmKGNvbXBQdCE9PTApXG5yZXR1cm4gY29tcFB0O2kxKz1kaXIxO2kyKz1kaXIyO3ZhciBkb25lMT1pMT09PWxpbWl0MTt2YXIgZG9uZTI9aTI9PT1saW1pdDI7aWYoZG9uZTEmJiFkb25lMilcbnJldHVybi0xO2lmKCFkb25lMSYmZG9uZTIpXG5yZXR1cm4gMTtpZihkb25lMSYmZG9uZTIpXG5yZXR1cm4gMDt9fTtqc3RzLmFsZ29yaXRobS5DZW50cmFsRW5kcG9pbnRJbnRlcnNlY3Rvcj1mdW5jdGlvbihwMDAscDAxLHAxMCxwMTEpe3RoaXMucHRzPVtwMDAscDAxLHAxMCxwMTFdO3RoaXMuY29tcHV0ZSgpO307anN0cy5hbGdvcml0aG0uQ2VudHJhbEVuZHBvaW50SW50ZXJzZWN0b3IuZ2V0SW50ZXJzZWN0aW9uPWZ1bmN0aW9uKHAwMCxwMDEscDEwLHAxMSl7dmFyIGludG9yPW5ldyBqc3RzLmFsZ29yaXRobS5DZW50cmFsRW5kcG9pbnRJbnRlcnNlY3RvcihwMDAscDAxLHAxMCxwMTEpO3JldHVybiBpbnRvci5nZXRJbnRlcnNlY3Rpb24oKTt9O2pzdHMuYWxnb3JpdGhtLkNlbnRyYWxFbmRwb2ludEludGVyc2VjdG9yLnByb3RvdHlwZS5wdHM9bnVsbDtqc3RzLmFsZ29yaXRobS5DZW50cmFsRW5kcG9pbnRJbnRlcnNlY3Rvci5wcm90b3R5cGUuaW50UHQ9bnVsbDtqc3RzLmFsZ29yaXRobS5DZW50cmFsRW5kcG9pbnRJbnRlcnNlY3Rvci5wcm90b3R5cGUuY29tcHV0ZT1mdW5jdGlvbigpe3ZhciBjZW50cm9pZD1qc3RzLmFsZ29yaXRobS5DZW50cmFsRW5kcG9pbnRJbnRlcnNlY3Rvci5hdmVyYWdlKHRoaXMucHRzKTt0aGlzLmludFB0PXRoaXMuZmluZE5lYXJlc3RQb2ludChjZW50cm9pZCx0aGlzLnB0cyk7fTtqc3RzLmFsZ29yaXRobS5DZW50cmFsRW5kcG9pbnRJbnRlcnNlY3Rvci5wcm90b3R5cGUuZ2V0SW50ZXJzZWN0aW9uPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuaW50UHQ7fTtqc3RzLmFsZ29yaXRobS5DZW50cmFsRW5kcG9pbnRJbnRlcnNlY3Rvci5hdmVyYWdlPWZ1bmN0aW9uKHB0cyl7dmFyIGF2Zz1uZXcganN0cy5nZW9tLkNvb3JkaW5hdGUoKTt2YXIgaSxuPXB0cy5sZW5ndGg7Zm9yKGk9MDtpPG47aSsrKXthdmcueCs9cHRzW2ldLng7YXZnLnkrPXB0c1tpXS55O31cbmlmKG4+MCl7YXZnLngvPW47YXZnLnkvPW47fVxucmV0dXJuIGF2Zzt9O2pzdHMuYWxnb3JpdGhtLkNlbnRyYWxFbmRwb2ludEludGVyc2VjdG9yLnByb3RvdHlwZS5maW5kTmVhcmVzdFBvaW50PWZ1bmN0aW9uKHAscHRzKXt2YXIgbWluRGlzdD1OdW1iZXIuTUFYX1ZBTFVFO3ZhciBpLHJlc3VsdD1udWxsLGRpc3Q7Zm9yKGk9MDtpPHB0cy5sZW5ndGg7aSsrKXtkaXN0PXAuZGlzdGFuY2UocHRzW2ldKTtpZihkaXN0PG1pbkRpc3Qpe21pbkRpc3Q9ZGlzdDtyZXN1bHQ9cHRzW2ldO319XG5yZXR1cm4gcmVzdWx0O307anN0cy5vcGVyYXRpb24uYnVmZmVyLkJ1ZmZlck9wPWZ1bmN0aW9uKGcsYnVmUGFyYW1zKXt0aGlzLmFyZ0dlb209Zzt0aGlzLmJ1ZlBhcmFtcz1idWZQYXJhbXM/YnVmUGFyYW1zOm5ldyBqc3RzLm9wZXJhdGlvbi5idWZmZXIuQnVmZmVyUGFyYW1ldGVycygpO307anN0cy5vcGVyYXRpb24uYnVmZmVyLkJ1ZmZlck9wLk1BWF9QUkVDSVNJT05fRElHSVRTPTEyO2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5CdWZmZXJPcC5wcmVjaXNpb25TY2FsZUZhY3Rvcj1mdW5jdGlvbihnLGRpc3RhbmNlLG1heFByZWNpc2lvbkRpZ2l0cyl7dmFyIGVudj1nLmdldEVudmVsb3BlSW50ZXJuYWwoKTt2YXIgZW52U2l6ZT1NYXRoLm1heChlbnYuZ2V0SGVpZ2h0KCksZW52LmdldFdpZHRoKCkpO3ZhciBleHBhbmRCeURpc3RhbmNlPWRpc3RhbmNlPjAuMD9kaXN0YW5jZTowLjA7dmFyIGJ1ZkVudlNpemU9ZW52U2l6ZSsyKmV4cGFuZEJ5RGlzdGFuY2U7dmFyIGJ1ZkVudkxvZzEwPShNYXRoLmxvZyhidWZFbnZTaXplKS9NYXRoLmxvZygxMCkrMS4wKTt2YXIgbWluVW5pdExvZzEwPWJ1ZkVudkxvZzEwLW1heFByZWNpc2lvbkRpZ2l0czt2YXIgc2NhbGVGYWN0b3I9TWF0aC5wb3coMTAuMCwtbWluVW5pdExvZzEwKTtyZXR1cm4gc2NhbGVGYWN0b3I7fTtqc3RzLm9wZXJhdGlvbi5idWZmZXIuQnVmZmVyT3AuYnVmZmVyT3A9ZnVuY3Rpb24oZyxkaXN0YW5jZSl7aWYoYXJndW1lbnRzLmxlbmd0aD4yKXtyZXR1cm4ganN0cy5vcGVyYXRpb24uYnVmZmVyLkJ1ZmZlck9wLmJ1ZmZlck9wMi5hcHBseSh0aGlzLGFyZ3VtZW50cyk7fVxudmFyIGdCdWY9bmV3IGpzdHMub3BlcmF0aW9uLmJ1ZmZlci5CdWZmZXJPcChnKTt2YXIgZ2VvbUJ1Zj1nQnVmLmdldFJlc3VsdEdlb21ldHJ5KGRpc3RhbmNlKTtyZXR1cm4gZ2VvbUJ1Zjt9O2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5CdWZmZXJPcC5idWZmZXJPcDI9ZnVuY3Rpb24oZyxkaXN0YW5jZSxwYXJhbXMpe2lmKGFyZ3VtZW50cy5sZW5ndGg+Myl7cmV0dXJuIGpzdHMub3BlcmF0aW9uLmJ1ZmZlci5CdWZmZXJPcC5idWZmZXJPcDMuYXBwbHkodGhpcyxhcmd1bWVudHMpO31cbnZhciBidWZPcD1uZXcganN0cy5vcGVyYXRpb24uYnVmZmVyLkJ1ZmZlck9wKGcscGFyYW1zKTt2YXIgZ2VvbUJ1Zj1idWZPcC5nZXRSZXN1bHRHZW9tZXRyeShkaXN0YW5jZSk7cmV0dXJuIGdlb21CdWY7fTtqc3RzLm9wZXJhdGlvbi5idWZmZXIuQnVmZmVyT3AuYnVmZmVyT3AzPWZ1bmN0aW9uKGcsZGlzdGFuY2UscXVhZHJhbnRTZWdtZW50cyl7aWYoYXJndW1lbnRzLmxlbmd0aD40KXtyZXR1cm4ganN0cy5vcGVyYXRpb24uYnVmZmVyLkJ1ZmZlck9wLmJ1ZmZlck9wNC5hcHBseSh0aGlzLGFyZ3VtZW50cyk7fVxudmFyIGJ1Zk9wPW5ldyBqc3RzLm9wZXJhdGlvbi5idWZmZXIuQnVmZmVyT3AoZyk7YnVmT3Auc2V0UXVhZHJhbnRTZWdtZW50cyhxdWFkcmFudFNlZ21lbnRzKTt2YXIgZ2VvbUJ1Zj1idWZPcC5nZXRSZXN1bHRHZW9tZXRyeShkaXN0YW5jZSk7cmV0dXJuIGdlb21CdWY7fTtqc3RzLm9wZXJhdGlvbi5idWZmZXIuQnVmZmVyT3AuYnVmZmVyT3A0PWZ1bmN0aW9uKGcsZGlzdGFuY2UscXVhZHJhbnRTZWdtZW50cyxlbmRDYXBTdHlsZSl7dmFyIGJ1Zk9wPW5ldyBqc3RzLm9wZXJhdGlvbi5idWZmZXIuQnVmZmVyT3AoZyk7YnVmT3Auc2V0UXVhZHJhbnRTZWdtZW50cyhxdWFkcmFudFNlZ21lbnRzKTtidWZPcC5zZXRFbmRDYXBTdHlsZShlbmRDYXBTdHlsZSk7dmFyIGdlb21CdWY9YnVmT3AuZ2V0UmVzdWx0R2VvbWV0cnkoZGlzdGFuY2UpO3JldHVybiBnZW9tQnVmO307anN0cy5vcGVyYXRpb24uYnVmZmVyLkJ1ZmZlck9wLnByb3RvdHlwZS5hcmdHZW9tPW51bGw7anN0cy5vcGVyYXRpb24uYnVmZmVyLkJ1ZmZlck9wLnByb3RvdHlwZS5kaXN0YW5jZT1udWxsO2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5CdWZmZXJPcC5wcm90b3R5cGUuYnVmUGFyYW1zPW51bGw7anN0cy5vcGVyYXRpb24uYnVmZmVyLkJ1ZmZlck9wLnByb3RvdHlwZS5yZXN1bHRHZW9tZXRyeT1udWxsO2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5CdWZmZXJPcC5wcm90b3R5cGUuc2V0RW5kQ2FwU3R5bGU9ZnVuY3Rpb24oZW5kQ2FwU3R5bGUpe3RoaXMuYnVmUGFyYW1zLnNldEVuZENhcFN0eWxlKGVuZENhcFN0eWxlKTt9O2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5CdWZmZXJPcC5wcm90b3R5cGUuc2V0UXVhZHJhbnRTZWdtZW50cz1mdW5jdGlvbihxdWFkcmFudFNlZ21lbnRzKXt0aGlzLmJ1ZlBhcmFtcy5zZXRRdWFkcmFudFNlZ21lbnRzKHF1YWRyYW50U2VnbWVudHMpO307anN0cy5vcGVyYXRpb24uYnVmZmVyLkJ1ZmZlck9wLnByb3RvdHlwZS5nZXRSZXN1bHRHZW9tZXRyeT1mdW5jdGlvbihkaXN0KXt0aGlzLmRpc3RhbmNlPWRpc3Q7dGhpcy5jb21wdXRlR2VvbWV0cnkoKTtyZXR1cm4gdGhpcy5yZXN1bHRHZW9tZXRyeTt9O2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5CdWZmZXJPcC5wcm90b3R5cGUuY29tcHV0ZUdlb21ldHJ5PWZ1bmN0aW9uKCl7dGhpcy5idWZmZXJPcmlnaW5hbFByZWNpc2lvbigpO2lmKHRoaXMucmVzdWx0R2VvbWV0cnkhPT1udWxsKXtyZXR1cm47fVxudmFyIGFyZ1BNPXRoaXMuYXJnR2VvbS5nZXRQcmVjaXNpb25Nb2RlbCgpO2lmKGFyZ1BNLmdldFR5cGUoKT09PWpzdHMuZ2VvbS5QcmVjaXNpb25Nb2RlbC5GSVhFRCl7dGhpcy5idWZmZXJGaXhlZFByZWNpc2lvbihhcmdQTSk7fWVsc2V7dGhpcy5idWZmZXJSZWR1Y2VkUHJlY2lzaW9uKCk7fX07anN0cy5vcGVyYXRpb24uYnVmZmVyLkJ1ZmZlck9wLnByb3RvdHlwZS5idWZmZXJSZWR1Y2VkUHJlY2lzaW9uPWZ1bmN0aW9uKCl7dmFyIHByZWNEaWdpdHM7dmFyIHNhdmVFeGNlcHRpb249bnVsbDtmb3IocHJlY0RpZ2l0cz1qc3RzLm9wZXJhdGlvbi5idWZmZXIuQnVmZmVyT3AuTUFYX1BSRUNJU0lPTl9ESUdJVFM7cHJlY0RpZ2l0cz49MDtwcmVjRGlnaXRzLS0pe3RyeXt0aGlzLmJ1ZmZlclJlZHVjZWRQcmVjaXNpb24yKHByZWNEaWdpdHMpO31jYXRjaChleCl7c2F2ZUV4Y2VwdGlvbj1leDt9XG5pZih0aGlzLnJlc3VsdEdlb21ldHJ5IT09bnVsbCl7cmV0dXJuO319XG50aHJvdyBzYXZlRXhjZXB0aW9uO307anN0cy5vcGVyYXRpb24uYnVmZmVyLkJ1ZmZlck9wLnByb3RvdHlwZS5idWZmZXJPcmlnaW5hbFByZWNpc2lvbj1mdW5jdGlvbigpe3RyeXt2YXIgYnVmQnVpbGRlcj1uZXcganN0cy5vcGVyYXRpb24uYnVmZmVyLkJ1ZmZlckJ1aWxkZXIodGhpcy5idWZQYXJhbXMpO3RoaXMucmVzdWx0R2VvbWV0cnk9YnVmQnVpbGRlci5idWZmZXIodGhpcy5hcmdHZW9tLHRoaXMuZGlzdGFuY2UpO31jYXRjaChlKXt9fTtqc3RzLm9wZXJhdGlvbi5idWZmZXIuQnVmZmVyT3AucHJvdG90eXBlLmJ1ZmZlclJlZHVjZWRQcmVjaXNpb24yPWZ1bmN0aW9uKHByZWNpc2lvbkRpZ2l0cyl7dmFyIHNpemVCYXNlZFNjYWxlRmFjdG9yPWpzdHMub3BlcmF0aW9uLmJ1ZmZlci5CdWZmZXJPcC5wcmVjaXNpb25TY2FsZUZhY3Rvcih0aGlzLmFyZ0dlb20sdGhpcy5kaXN0YW5jZSxwcmVjaXNpb25EaWdpdHMpO3ZhciBmaXhlZFBNPW5ldyBqc3RzLmdlb20uUHJlY2lzaW9uTW9kZWwoc2l6ZUJhc2VkU2NhbGVGYWN0b3IpO3RoaXMuYnVmZmVyRml4ZWRQcmVjaXNpb24oZml4ZWRQTSk7fTtqc3RzLm9wZXJhdGlvbi5idWZmZXIuQnVmZmVyT3AucHJvdG90eXBlLmJ1ZmZlckZpeGVkUHJlY2lzaW9uPWZ1bmN0aW9uKGZpeGVkUE0pe3ZhciBub2Rlcj1uZXcganN0cy5ub2RpbmcuU2NhbGVkTm9kZXIobmV3IGpzdHMubm9kaW5nLnNuYXByb3VuZC5NQ0luZGV4U25hcFJvdW5kZXIobmV3IGpzdHMuZ2VvbS5QcmVjaXNpb25Nb2RlbCgxLjApKSxmaXhlZFBNLmdldFNjYWxlKCkpO3ZhciBidWZCdWlsZGVyPW5ldyBqc3RzLm9wZXJhdGlvbi5idWZmZXIuQnVmZmVyQnVpbGRlcih0aGlzLmJ1ZlBhcmFtcyk7YnVmQnVpbGRlci5zZXRXb3JraW5nUHJlY2lzaW9uTW9kZWwoZml4ZWRQTSk7YnVmQnVpbGRlci5zZXROb2Rlcihub2Rlcik7dGhpcy5yZXN1bHRHZW9tZXRyeT1idWZCdWlsZGVyLmJ1ZmZlcih0aGlzLmFyZ0dlb20sdGhpcy5kaXN0YW5jZSk7fTsoZnVuY3Rpb24oKXt2YXIgTG9jYXRpb249anN0cy5nZW9tLkxvY2F0aW9uO3ZhciBQb3NpdGlvbj1qc3RzLmdlb21ncmFwaC5Qb3NpdGlvbjt2YXIgQXNzZXJ0PWpzdHMudXRpbC5Bc3NlcnQ7anN0cy5nZW9tZ3JhcGguR2VvbWV0cnlHcmFwaD1mdW5jdGlvbihhcmdJbmRleCxwYXJlbnRHZW9tLGJvdW5kYXJ5Tm9kZVJ1bGUpe2pzdHMuZ2VvbWdyYXBoLlBsYW5hckdyYXBoLmNhbGwodGhpcyk7dGhpcy5saW5lRWRnZU1hcD1uZXcgamF2YXNjcmlwdC51dGlsLkhhc2hNYXAoKTt0aGlzLnB0TG9jYXRvcj1uZXcganN0cy5hbGdvcml0aG0uUG9pbnRMb2NhdG9yKCk7dGhpcy5hcmdJbmRleD1hcmdJbmRleDt0aGlzLnBhcmVudEdlb209cGFyZW50R2VvbTt0aGlzLmJvdW5kYXJ5Tm9kZVJ1bGU9Ym91bmRhcnlOb2RlUnVsZXx8anN0cy5hbGdvcml0aG0uQm91bmRhcnlOb2RlUnVsZS5PR0NfU0ZTX0JPVU5EQVJZX1JVTEU7aWYocGFyZW50R2VvbSE9PW51bGwpe3RoaXMuYWRkKHBhcmVudEdlb20pO319O2pzdHMuZ2VvbWdyYXBoLkdlb21ldHJ5R3JhcGgucHJvdG90eXBlPW5ldyBqc3RzLmdlb21ncmFwaC5QbGFuYXJHcmFwaCgpO2pzdHMuZ2VvbWdyYXBoLkdlb21ldHJ5R3JhcGguY29uc3RydWN0b3I9anN0cy5nZW9tZ3JhcGguR2VvbWV0cnlHcmFwaDtqc3RzLmdlb21ncmFwaC5HZW9tZXRyeUdyYXBoLnByb3RvdHlwZS5jcmVhdGVFZGdlU2V0SW50ZXJzZWN0b3I9ZnVuY3Rpb24oKXtyZXR1cm4gbmV3IGpzdHMuZ2VvbWdyYXBoLmluZGV4LlNpbXBsZU1DU3dlZXBMaW5lSW50ZXJzZWN0b3IoKTt9O2pzdHMuZ2VvbWdyYXBoLkdlb21ldHJ5R3JhcGguZGV0ZXJtaW5lQm91bmRhcnk9ZnVuY3Rpb24oYm91bmRhcnlOb2RlUnVsZSxib3VuZGFyeUNvdW50KXtyZXR1cm4gYm91bmRhcnlOb2RlUnVsZS5pc0luQm91bmRhcnkoYm91bmRhcnlDb3VudCk/TG9jYXRpb24uQk9VTkRBUlk6TG9jYXRpb24uSU5URVJJT1I7fTtqc3RzLmdlb21ncmFwaC5HZW9tZXRyeUdyYXBoLnByb3RvdHlwZS5wYXJlbnRHZW9tPW51bGw7anN0cy5nZW9tZ3JhcGguR2VvbWV0cnlHcmFwaC5wcm90b3R5cGUubGluZUVkZ2VNYXA9bnVsbDtqc3RzLmdlb21ncmFwaC5HZW9tZXRyeUdyYXBoLnByb3RvdHlwZS5ib3VuZGFyeU5vZGVSdWxlPW51bGw7anN0cy5nZW9tZ3JhcGguR2VvbWV0cnlHcmFwaC5wcm90b3R5cGUudXNlQm91bmRhcnlEZXRlcm1pbmF0aW9uUnVsZT10cnVlO2pzdHMuZ2VvbWdyYXBoLkdlb21ldHJ5R3JhcGgucHJvdG90eXBlLmFyZ0luZGV4PW51bGw7anN0cy5nZW9tZ3JhcGguR2VvbWV0cnlHcmFwaC5wcm90b3R5cGUuYm91bmRhcnlOb2Rlcz1udWxsO2pzdHMuZ2VvbWdyYXBoLkdlb21ldHJ5R3JhcGgucHJvdG90eXBlLmhhc1Rvb0Zld1BvaW50cz1mYWxzZTtqc3RzLmdlb21ncmFwaC5HZW9tZXRyeUdyYXBoLnByb3RvdHlwZS5pbnZhbGlkUG9pbnQ9bnVsbDtqc3RzLmdlb21ncmFwaC5HZW9tZXRyeUdyYXBoLnByb3RvdHlwZS5hcmVhUHRMb2NhdG9yPW51bGw7anN0cy5nZW9tZ3JhcGguR2VvbWV0cnlHcmFwaC5wcm90b3R5cGUucHRMb2NhdG9yPW51bGw7anN0cy5nZW9tZ3JhcGguR2VvbWV0cnlHcmFwaC5wcm90b3R5cGUuZ2V0R2VvbWV0cnk9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5wYXJlbnRHZW9tO307anN0cy5nZW9tZ3JhcGguR2VvbWV0cnlHcmFwaC5wcm90b3R5cGUuZ2V0Qm91bmRhcnlOb2Rlcz1mdW5jdGlvbigpe2lmKHRoaXMuYm91bmRhcnlOb2Rlcz09PW51bGwpXG50aGlzLmJvdW5kYXJ5Tm9kZXM9dGhpcy5ub2Rlcy5nZXRCb3VuZGFyeU5vZGVzKHRoaXMuYXJnSW5kZXgpO3JldHVybiB0aGlzLmJvdW5kYXJ5Tm9kZXM7fTtqc3RzLmdlb21ncmFwaC5HZW9tZXRyeUdyYXBoLnByb3RvdHlwZS5nZXRCb3VuZGFyeU5vZGVSdWxlPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuYm91bmRhcnlOb2RlUnVsZTt9O2pzdHMuZ2VvbWdyYXBoLkdlb21ldHJ5R3JhcGgucHJvdG90eXBlLmZpbmRFZGdlPWZ1bmN0aW9uKGxpbmUpe3JldHVybiB0aGlzLmxpbmVFZGdlTWFwLmdldChsaW5lKTt9O2pzdHMuZ2VvbWdyYXBoLkdlb21ldHJ5R3JhcGgucHJvdG90eXBlLmNvbXB1dGVTcGxpdEVkZ2VzPWZ1bmN0aW9uKGVkZ2VsaXN0KXtmb3IodmFyIGk9dGhpcy5lZGdlcy5pdGVyYXRvcigpO2kuaGFzTmV4dCgpOyl7dmFyIGU9aS5uZXh0KCk7ZS5laUxpc3QuYWRkU3BsaXRFZGdlcyhlZGdlbGlzdCk7fX1cbmpzdHMuZ2VvbWdyYXBoLkdlb21ldHJ5R3JhcGgucHJvdG90eXBlLmFkZD1mdW5jdGlvbihnKXtpZihnLmlzRW1wdHkoKSl7cmV0dXJuO31cbmlmKGcgaW5zdGFuY2VvZiBqc3RzLmdlb20uTXVsdGlQb2x5Z29uKVxudGhpcy51c2VCb3VuZGFyeURldGVybWluYXRpb25SdWxlPWZhbHNlO2lmKGcgaW5zdGFuY2VvZiBqc3RzLmdlb20uUG9seWdvbilcbnRoaXMuYWRkUG9seWdvbihnKTtlbHNlIGlmKGcgaW5zdGFuY2VvZiBqc3RzLmdlb20uTGluZVN0cmluZylcbnRoaXMuYWRkTGluZVN0cmluZyhnKTtlbHNlIGlmKGcgaW5zdGFuY2VvZiBqc3RzLmdlb20uUG9pbnQpXG50aGlzLmFkZFBvaW50KGcpO2Vsc2UgaWYoZyBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5NdWx0aVBvaW50KVxudGhpcy5hZGRDb2xsZWN0aW9uKGcpO2Vsc2UgaWYoZyBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5NdWx0aUxpbmVTdHJpbmcpXG50aGlzLmFkZENvbGxlY3Rpb24oZyk7ZWxzZSBpZihnIGluc3RhbmNlb2YganN0cy5nZW9tLk11bHRpUG9seWdvbilcbnRoaXMuYWRkQ29sbGVjdGlvbihnKTtlbHNlIGlmKGcgaW5zdGFuY2VvZiBqc3RzLmdlb20uR2VvbWV0cnlDb2xsZWN0aW9uKVxudGhpcy5hZGRDb2xsZWN0aW9uKGcpO2Vsc2VcbnRocm93IG5ldyBqc3RzLmVycm9yLklsbGVnYWxBcmd1bWVudEVycm9yKCdHZW9tZXRyeSB0eXBlIG5vdCBzdXBwb3J0ZWQuJyk7fTtqc3RzLmdlb21ncmFwaC5HZW9tZXRyeUdyYXBoLnByb3RvdHlwZS5hZGRDb2xsZWN0aW9uPWZ1bmN0aW9uKGdjKXtmb3IodmFyIGk9MDtpPGdjLmdldE51bUdlb21ldHJpZXMoKTtpKyspe3ZhciBnPWdjLmdldEdlb21ldHJ5TihpKTt0aGlzLmFkZChnKTt9fTtqc3RzLmdlb21ncmFwaC5HZW9tZXRyeUdyYXBoLnByb3RvdHlwZS5hZGRFZGdlPWZ1bmN0aW9uKGUpe3RoaXMuaW5zZXJ0RWRnZShlKTt2YXIgY29vcmQ9ZS5nZXRDb29yZGluYXRlcygpO3RoaXMuaW5zZXJ0UG9pbnQodGhpcy5hcmdJbmRleCxjb29yZFswXSxMb2NhdGlvbi5CT1VOREFSWSk7dGhpcy5pbnNlcnRQb2ludCh0aGlzLmFyZ0luZGV4LGNvb3JkW2Nvb3JkLmxlbmd0aC0xXSxMb2NhdGlvbi5CT1VOREFSWSk7fTtqc3RzLmdlb21ncmFwaC5HZW9tZXRyeUdyYXBoLnByb3RvdHlwZS5hZGRQb2ludD1mdW5jdGlvbihwKXt2YXIgY29vcmQ9cC5nZXRDb29yZGluYXRlKCk7dGhpcy5pbnNlcnRQb2ludCh0aGlzLmFyZ0luZGV4LGNvb3JkLExvY2F0aW9uLklOVEVSSU9SKTt9O2pzdHMuZ2VvbWdyYXBoLkdlb21ldHJ5R3JhcGgucHJvdG90eXBlLmFkZExpbmVTdHJpbmc9ZnVuY3Rpb24obGluZSl7dmFyIGNvb3JkPWpzdHMuZ2VvbS5Db29yZGluYXRlQXJyYXlzLnJlbW92ZVJlcGVhdGVkUG9pbnRzKGxpbmUuZ2V0Q29vcmRpbmF0ZXMoKSk7aWYoY29vcmQubGVuZ3RoPDIpe3RoaXMuaGFzVG9vRmV3UG9pbnRzPXRydWU7dGhpcy5pbnZhbGlkUG9pbnQ9Y29vcmRzWzBdO3JldHVybjt9XG52YXIgZT1uZXcganN0cy5nZW9tZ3JhcGguRWRnZShjb29yZCxuZXcganN0cy5nZW9tZ3JhcGguTGFiZWwodGhpcy5hcmdJbmRleCxMb2NhdGlvbi5JTlRFUklPUikpO3RoaXMubGluZUVkZ2VNYXAucHV0KGxpbmUsZSk7dGhpcy5pbnNlcnRFZGdlKGUpO0Fzc2VydC5pc1RydWUoY29vcmQubGVuZ3RoPj0yLCdmb3VuZCBMaW5lU3RyaW5nIHdpdGggc2luZ2xlIHBvaW50Jyk7dGhpcy5pbnNlcnRCb3VuZGFyeVBvaW50KHRoaXMuYXJnSW5kZXgsY29vcmRbMF0pO3RoaXMuaW5zZXJ0Qm91bmRhcnlQb2ludCh0aGlzLmFyZ0luZGV4LGNvb3JkW2Nvb3JkLmxlbmd0aC0xXSk7fTtqc3RzLmdlb21ncmFwaC5HZW9tZXRyeUdyYXBoLnByb3RvdHlwZS5hZGRQb2x5Z29uUmluZz1mdW5jdGlvbihscixjd0xlZnQsY3dSaWdodCl7aWYobHIuaXNFbXB0eSgpKVxucmV0dXJuO3ZhciBjb29yZD1qc3RzLmdlb20uQ29vcmRpbmF0ZUFycmF5cy5yZW1vdmVSZXBlYXRlZFBvaW50cyhsci5nZXRDb29yZGluYXRlcygpKTtpZihjb29yZC5sZW5ndGg8NCl7dGhpcy5oYXNUb29GZXdQb2ludHM9dHJ1ZTt0aGlzLmludmFsaWRQb2ludD1jb29yZFswXTtyZXR1cm47fVxudmFyIGxlZnQ9Y3dMZWZ0O3ZhciByaWdodD1jd1JpZ2h0O2lmKGpzdHMuYWxnb3JpdGhtLkNHQWxnb3JpdGhtcy5pc0NDVyhjb29yZCkpe2xlZnQ9Y3dSaWdodDtyaWdodD1jd0xlZnQ7fVxudmFyIGU9bmV3IGpzdHMuZ2VvbWdyYXBoLkVkZ2UoY29vcmQsbmV3IGpzdHMuZ2VvbWdyYXBoLkxhYmVsKHRoaXMuYXJnSW5kZXgsTG9jYXRpb24uQk9VTkRBUlksbGVmdCxyaWdodCkpO3RoaXMubGluZUVkZ2VNYXAucHV0KGxyLGUpO3RoaXMuaW5zZXJ0RWRnZShlKTt0aGlzLmluc2VydFBvaW50KHRoaXMuYXJnSW5kZXgsY29vcmRbMF0sTG9jYXRpb24uQk9VTkRBUlkpO307anN0cy5nZW9tZ3JhcGguR2VvbWV0cnlHcmFwaC5wcm90b3R5cGUuYWRkUG9seWdvbj1mdW5jdGlvbihwKXt0aGlzLmFkZFBvbHlnb25SaW5nKHAuZ2V0RXh0ZXJpb3JSaW5nKCksTG9jYXRpb24uRVhURVJJT1IsTG9jYXRpb24uSU5URVJJT1IpO2Zvcih2YXIgaT0wO2k8cC5nZXROdW1JbnRlcmlvclJpbmcoKTtpKyspe3ZhciBob2xlPXAuZ2V0SW50ZXJpb3JSaW5nTihpKTt0aGlzLmFkZFBvbHlnb25SaW5nKGhvbGUsTG9jYXRpb24uSU5URVJJT1IsTG9jYXRpb24uRVhURVJJT1IpO319O2pzdHMuZ2VvbWdyYXBoLkdlb21ldHJ5R3JhcGgucHJvdG90eXBlLmNvbXB1dGVFZGdlSW50ZXJzZWN0aW9ucz1mdW5jdGlvbihnLGxpLGluY2x1ZGVQcm9wZXIpe3ZhciBzaT1uZXcganN0cy5nZW9tZ3JhcGguaW5kZXguU2VnbWVudEludGVyc2VjdG9yKGxpLGluY2x1ZGVQcm9wZXIsdHJ1ZSk7c2kuc2V0Qm91bmRhcnlOb2Rlcyh0aGlzLmdldEJvdW5kYXJ5Tm9kZXMoKSxnLmdldEJvdW5kYXJ5Tm9kZXMoKSk7dmFyIGVzaT10aGlzLmNyZWF0ZUVkZ2VTZXRJbnRlcnNlY3RvcigpO2VzaS5jb21wdXRlSW50ZXJzZWN0aW9ucyh0aGlzLmVkZ2VzLGcuZWRnZXMsc2kpO3JldHVybiBzaTt9O2pzdHMuZ2VvbWdyYXBoLkdlb21ldHJ5R3JhcGgucHJvdG90eXBlLmNvbXB1dGVTZWxmTm9kZXM9ZnVuY3Rpb24obGksY29tcHV0ZVJpbmdTZWxmTm9kZXMpe3ZhciBzaT1uZXcganN0cy5nZW9tZ3JhcGguaW5kZXguU2VnbWVudEludGVyc2VjdG9yKGxpLHRydWUsZmFsc2UpO3ZhciBlc2k9dGhpcy5jcmVhdGVFZGdlU2V0SW50ZXJzZWN0b3IoKTtpZighY29tcHV0ZVJpbmdTZWxmTm9kZXMmJih0aGlzLnBhcmVudEdlb20gaW5zdGFuY2VvZiBqc3RzLmdlb20uTGluZWFyUmluZ3x8dGhpcy5wYXJlbnRHZW9tIGluc3RhbmNlb2YganN0cy5nZW9tLlBvbHlnb258fHRoaXMucGFyZW50R2VvbSBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5NdWx0aVBvbHlnb24pKXtlc2kuY29tcHV0ZUludGVyc2VjdGlvbnModGhpcy5lZGdlcyxzaSxmYWxzZSk7fWVsc2V7ZXNpLmNvbXB1dGVJbnRlcnNlY3Rpb25zKHRoaXMuZWRnZXMsc2ksdHJ1ZSk7fVxudGhpcy5hZGRTZWxmSW50ZXJzZWN0aW9uTm9kZXModGhpcy5hcmdJbmRleCk7cmV0dXJuIHNpO307anN0cy5nZW9tZ3JhcGguR2VvbWV0cnlHcmFwaC5wcm90b3R5cGUuaW5zZXJ0UG9pbnQ9ZnVuY3Rpb24oYXJnSW5kZXgsY29vcmQsb25Mb2NhdGlvbil7dmFyIG49dGhpcy5ub2Rlcy5hZGROb2RlKGNvb3JkKTt2YXIgbGJsPW4uZ2V0TGFiZWwoKTtpZihsYmw9PW51bGwpe24ubGFiZWw9bmV3IGpzdHMuZ2VvbWdyYXBoLkxhYmVsKGFyZ0luZGV4LG9uTG9jYXRpb24pO31lbHNlXG5sYmwuc2V0TG9jYXRpb24oYXJnSW5kZXgsb25Mb2NhdGlvbik7fTtqc3RzLmdlb21ncmFwaC5HZW9tZXRyeUdyYXBoLnByb3RvdHlwZS5pbnNlcnRCb3VuZGFyeVBvaW50PWZ1bmN0aW9uKGFyZ0luZGV4LGNvb3JkKXt2YXIgbj10aGlzLm5vZGVzLmFkZE5vZGUoY29vcmQpO3ZhciBsYmw9bi5nZXRMYWJlbCgpO3ZhciBib3VuZGFyeUNvdW50PTE7dmFyIGxvYz1Mb2NhdGlvbi5OT05FO2lmKGxibCE9PW51bGwpXG5sb2M9bGJsLmdldExvY2F0aW9uKGFyZ0luZGV4LFBvc2l0aW9uLk9OKTtpZihsb2M9PT1Mb2NhdGlvbi5CT1VOREFSWSlcbmJvdW5kYXJ5Q291bnQrKzt2YXIgbmV3TG9jPWpzdHMuZ2VvbWdyYXBoLkdlb21ldHJ5R3JhcGguZGV0ZXJtaW5lQm91bmRhcnkodGhpcy5ib3VuZGFyeU5vZGVSdWxlLGJvdW5kYXJ5Q291bnQpO2xibC5zZXRMb2NhdGlvbihhcmdJbmRleCxuZXdMb2MpO307anN0cy5nZW9tZ3JhcGguR2VvbWV0cnlHcmFwaC5wcm90b3R5cGUuYWRkU2VsZkludGVyc2VjdGlvbk5vZGVzPWZ1bmN0aW9uKGFyZ0luZGV4KXtmb3IodmFyIGk9dGhpcy5lZGdlcy5pdGVyYXRvcigpO2kuaGFzTmV4dCgpOyl7dmFyIGU9aS5uZXh0KCk7dmFyIGVMb2M9ZS5nZXRMYWJlbCgpLmdldExvY2F0aW9uKGFyZ0luZGV4KTtmb3IodmFyIGVpSXQ9ZS5laUxpc3QuaXRlcmF0b3IoKTtlaUl0Lmhhc05leHQoKTspe3ZhciBlaT1laUl0Lm5leHQoKTt0aGlzLmFkZFNlbGZJbnRlcnNlY3Rpb25Ob2RlKGFyZ0luZGV4LGVpLmNvb3JkLGVMb2MpO319fTtqc3RzLmdlb21ncmFwaC5HZW9tZXRyeUdyYXBoLnByb3RvdHlwZS5hZGRTZWxmSW50ZXJzZWN0aW9uTm9kZT1mdW5jdGlvbihhcmdJbmRleCxjb29yZCxsb2Mpe2lmKHRoaXMuaXNCb3VuZGFyeU5vZGUoYXJnSW5kZXgsY29vcmQpKVxucmV0dXJuO2lmKGxvYz09PUxvY2F0aW9uLkJPVU5EQVJZJiZ0aGlzLnVzZUJvdW5kYXJ5RGV0ZXJtaW5hdGlvblJ1bGUpXG50aGlzLmluc2VydEJvdW5kYXJ5UG9pbnQoYXJnSW5kZXgsY29vcmQpO2Vsc2VcbnRoaXMuaW5zZXJ0UG9pbnQoYXJnSW5kZXgsY29vcmQsbG9jKTt9O2pzdHMuZ2VvbWdyYXBoLkdlb21ldHJ5R3JhcGgucHJvdG90eXBlLmdldEludmFsaWRQb2ludD1mdW5jdGlvbigpe3JldHVybiB0aGlzLmludmFsaWRQb2ludDt9O30pKCk7anN0cy5vcGVyYXRpb24uYnVmZmVyLk9mZnNldFNlZ21lbnRTdHJpbmc9ZnVuY3Rpb24oKXt0aGlzLnB0TGlzdD1bXTt9O2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5PZmZzZXRTZWdtZW50U3RyaW5nLnByb3RvdHlwZS5wdExpc3Q9bnVsbDtqc3RzLm9wZXJhdGlvbi5idWZmZXIuT2Zmc2V0U2VnbWVudFN0cmluZy5wcm90b3R5cGUucHJlY2lzaW9uTW9kZWw9bnVsbDtqc3RzLm9wZXJhdGlvbi5idWZmZXIuT2Zmc2V0U2VnbWVudFN0cmluZy5wcm90b3R5cGUubWluaW1pbVZlcnRleERpc3RhbmNlPTAuMDtqc3RzLm9wZXJhdGlvbi5idWZmZXIuT2Zmc2V0U2VnbWVudFN0cmluZy5wcm90b3R5cGUuc2V0UHJlY2lzaW9uTW9kZWw9ZnVuY3Rpb24ocHJlY2lzaW9uTW9kZWwpe3RoaXMucHJlY2lzaW9uTW9kZWw9cHJlY2lzaW9uTW9kZWw7fTtqc3RzLm9wZXJhdGlvbi5idWZmZXIuT2Zmc2V0U2VnbWVudFN0cmluZy5wcm90b3R5cGUuc2V0TWluaW11bVZlcnRleERpc3RhbmNlPWZ1bmN0aW9uKG1pbmltaW1WZXJ0ZXhEaXN0YW5jZSl7dGhpcy5taW5pbWltVmVydGV4RGlzdGFuY2U9bWluaW1pbVZlcnRleERpc3RhbmNlO307anN0cy5vcGVyYXRpb24uYnVmZmVyLk9mZnNldFNlZ21lbnRTdHJpbmcucHJvdG90eXBlLmFkZFB0PWZ1bmN0aW9uKHB0KXt2YXIgYnVmUHQ9bmV3IGpzdHMuZ2VvbS5Db29yZGluYXRlKHB0KTt0aGlzLnByZWNpc2lvbk1vZGVsLm1ha2VQcmVjaXNlKGJ1ZlB0KTtpZih0aGlzLmlzUmVkdW5kYW50KGJ1ZlB0KSlcbnJldHVybjt0aGlzLnB0TGlzdC5wdXNoKGJ1ZlB0KTt9O2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5PZmZzZXRTZWdtZW50U3RyaW5nLnByb3RvdHlwZS5hZGRQdHM9ZnVuY3Rpb24ocHQsaXNGb3J3YXJkKXtpZihpc0ZvcndhcmQpe2Zvcih2YXIgaT0wO2k8cHQubGVuZ3RoO2krKyl7dGhpcy5hZGRQdChwdFtpXSk7fX1lbHNle2Zvcih2YXIgaT1wdC5sZW5ndGgtMTtpPj0wO2ktLSl7dGhpcy5hZGRQdChwdFtpXSk7fX19O2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5PZmZzZXRTZWdtZW50U3RyaW5nLnByb3RvdHlwZS5pc1JlZHVuZGFudD1mdW5jdGlvbihwdCl7aWYodGhpcy5wdExpc3QubGVuZ3RoPDEpXG5yZXR1cm4gZmFsc2U7dmFyIGxhc3RQdD10aGlzLnB0TGlzdFt0aGlzLnB0TGlzdC5sZW5ndGgtMV07dmFyIHB0RGlzdD1wdC5kaXN0YW5jZShsYXN0UHQpO2lmKHB0RGlzdDx0aGlzLm1pbmltaW1WZXJ0ZXhEaXN0YW5jZSlcbnJldHVybiB0cnVlO3JldHVybiBmYWxzZTt9O2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5PZmZzZXRTZWdtZW50U3RyaW5nLnByb3RvdHlwZS5jbG9zZVJpbmc9ZnVuY3Rpb24oKXtpZih0aGlzLnB0TGlzdC5sZW5ndGg8MSlcbnJldHVybjt2YXIgc3RhcnRQdD1uZXcganN0cy5nZW9tLkNvb3JkaW5hdGUodGhpcy5wdExpc3RbMF0pO3ZhciBsYXN0UHQ9dGhpcy5wdExpc3RbdGhpcy5wdExpc3QubGVuZ3RoLTFdO3ZhciBsYXN0MlB0PW51bGw7aWYodGhpcy5wdExpc3QubGVuZ3RoPj0yKVxubGFzdDJQdD10aGlzLnB0TGlzdFt0aGlzLnB0TGlzdC5sZW5ndGgtMl07aWYoc3RhcnRQdC5lcXVhbHMobGFzdFB0KSlcbnJldHVybjt0aGlzLnB0TGlzdC5wdXNoKHN0YXJ0UHQpO307anN0cy5vcGVyYXRpb24uYnVmZmVyLk9mZnNldFNlZ21lbnRTdHJpbmcucHJvdG90eXBlLnJldmVyc2U9ZnVuY3Rpb24oKXt9O2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5PZmZzZXRTZWdtZW50U3RyaW5nLnByb3RvdHlwZS5nZXRDb29yZGluYXRlcz1mdW5jdGlvbigpe3JldHVybiB0aGlzLnB0TGlzdDt9O2pzdHMuYWxnb3JpdGhtLmRpc3RhbmNlLlBvaW50UGFpckRpc3RhbmNlPWZ1bmN0aW9uKCl7dGhpcy5wdD1bbmV3IGpzdHMuZ2VvbS5Db29yZGluYXRlKCksbmV3IGpzdHMuZ2VvbS5Db29yZGluYXRlKCldO307anN0cy5hbGdvcml0aG0uZGlzdGFuY2UuUG9pbnRQYWlyRGlzdGFuY2UucHJvdG90eXBlLnB0PW51bGw7anN0cy5hbGdvcml0aG0uZGlzdGFuY2UuUG9pbnRQYWlyRGlzdGFuY2UucHJvdG90eXBlLmRpc3RhbmNlPU5hTjtqc3RzLmFsZ29yaXRobS5kaXN0YW5jZS5Qb2ludFBhaXJEaXN0YW5jZS5wcm90b3R5cGUuaXNOdWxsPXRydWU7anN0cy5hbGdvcml0aG0uZGlzdGFuY2UuUG9pbnRQYWlyRGlzdGFuY2UucHJvdG90eXBlLmluaXRpYWxpemU9ZnVuY3Rpb24ocDAscDEsZGlzdGFuY2Upe2lmKHAwPT09dW5kZWZpbmVkKXt0aGlzLmlzTnVsbD10cnVlO3JldHVybjt9XG50aGlzLnB0WzBdLnNldENvb3JkaW5hdGUocDApO3RoaXMucHRbMV0uc2V0Q29vcmRpbmF0ZShwMSk7dGhpcy5kaXN0YW5jZT1kaXN0YW5jZSE9PXVuZGVmaW5lZD9kaXN0YW5jZTpwMC5kaXN0YW5jZShwMSk7dGhpcy5pc051bGw9ZmFsc2U7fTtqc3RzLmFsZ29yaXRobS5kaXN0YW5jZS5Qb2ludFBhaXJEaXN0YW5jZS5wcm90b3R5cGUuZ2V0RGlzdGFuY2U9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5kaXN0YW5jZTt9O2pzdHMuYWxnb3JpdGhtLmRpc3RhbmNlLlBvaW50UGFpckRpc3RhbmNlLnByb3RvdHlwZS5nZXRDb29yZGluYXRlcz1mdW5jdGlvbigpe3JldHVybiB0aGlzLnB0O307anN0cy5hbGdvcml0aG0uZGlzdGFuY2UuUG9pbnRQYWlyRGlzdGFuY2UucHJvdG90eXBlLmdldENvb3JkaW5hdGU9ZnVuY3Rpb24oaSl7cmV0dXJuIHRoaXMucHRbaV07fTtqc3RzLmFsZ29yaXRobS5kaXN0YW5jZS5Qb2ludFBhaXJEaXN0YW5jZS5wcm90b3R5cGUuc2V0TWF4aW11bT1mdW5jdGlvbihwdERpc3Qpe2lmKGFyZ3VtZW50cy5sZW5ndGg9PT0yKXt0aGlzLnNldE1heGltdW0yLmFwcGx5KHRoaXMsYXJndW1lbnRzKTtyZXR1cm47fVxudGhpcy5zZXRNYXhpbXVtKHB0RGlzdC5wdFswXSxwdERpc3QucHRbMV0pO307anN0cy5hbGdvcml0aG0uZGlzdGFuY2UuUG9pbnRQYWlyRGlzdGFuY2UucHJvdG90eXBlLnNldE1heGltdW0yPWZ1bmN0aW9uKHAwLHAxKXtpZih0aGlzLmlzTnVsbCl7dGhpcy5pbml0aWFsaXplKHAwLHAxKTtyZXR1cm47fVxudmFyIGRpc3Q9cDAuZGlzdGFuY2UocDEpO2lmKGRpc3Q+dGhpcy5kaXN0YW5jZSlcbnRoaXMuaW5pdGlhbGl6ZShwMCxwMSxkaXN0KTt9O2pzdHMuYWxnb3JpdGhtLmRpc3RhbmNlLlBvaW50UGFpckRpc3RhbmNlLnByb3RvdHlwZS5zZXRNaW5pbXVtPWZ1bmN0aW9uKHB0RGlzdCl7aWYoYXJndW1lbnRzLmxlbmd0aD09PTIpe3RoaXMuc2V0TWluaW11bTIuYXBwbHkodGhpcyxhcmd1bWVudHMpO3JldHVybjt9XG50aGlzLnNldE1pbmltdW0ocHREaXN0LnB0WzBdLHB0RGlzdC5wdFsxXSk7fTtqc3RzLmFsZ29yaXRobS5kaXN0YW5jZS5Qb2ludFBhaXJEaXN0YW5jZS5wcm90b3R5cGUuc2V0TWluaW11bTI9ZnVuY3Rpb24ocDAscDEpe2lmKHRoaXMuaXNOdWxsKXt0aGlzLmluaXRpYWxpemUocDAscDEpO3JldHVybjt9XG52YXIgZGlzdD1wMC5kaXN0YW5jZShwMSk7aWYoZGlzdDx0aGlzLmRpc3RhbmNlKVxudGhpcy5pbml0aWFsaXplKHAwLHAxLGRpc3QpO307KGZ1bmN0aW9uKCl7dmFyIFBvaW50UGFpckRpc3RhbmNlPWpzdHMuYWxnb3JpdGhtLmRpc3RhbmNlLlBvaW50UGFpckRpc3RhbmNlO3ZhciBEaXN0YW5jZVRvUG9pbnQ9anN0cy5hbGdvcml0aG0uZGlzdGFuY2UuRGlzdGFuY2VUb1BvaW50O3ZhciBNYXhQb2ludERpc3RhbmNlRmlsdGVyPWZ1bmN0aW9uKGdlb20pe3RoaXMubWF4UHREaXN0PW5ldyBQb2ludFBhaXJEaXN0YW5jZSgpO3RoaXMubWluUHREaXN0PW5ldyBQb2ludFBhaXJEaXN0YW5jZSgpO3RoaXMuZXVjbGlkZWFuRGlzdD1uZXcgRGlzdGFuY2VUb1BvaW50KCk7dGhpcy5nZW9tPWdlb207fTtNYXhQb2ludERpc3RhbmNlRmlsdGVyLnByb3RvdHlwZT1uZXcganN0cy5nZW9tLkNvb3JkaW5hdGVGaWx0ZXIoKTtNYXhQb2ludERpc3RhbmNlRmlsdGVyLnByb3RvdHlwZS5tYXhQdERpc3Q9bmV3IFBvaW50UGFpckRpc3RhbmNlKCk7TWF4UG9pbnREaXN0YW5jZUZpbHRlci5wcm90b3R5cGUubWluUHREaXN0PW5ldyBQb2ludFBhaXJEaXN0YW5jZSgpO01heFBvaW50RGlzdGFuY2VGaWx0ZXIucHJvdG90eXBlLmV1Y2xpZGVhbkRpc3Q9bmV3IERpc3RhbmNlVG9Qb2ludCgpO01heFBvaW50RGlzdGFuY2VGaWx0ZXIucHJvdG90eXBlLmdlb207TWF4UG9pbnREaXN0YW5jZUZpbHRlci5wcm90b3R5cGUuZmlsdGVyPWZ1bmN0aW9uKHB0KXt0aGlzLm1pblB0RGlzdC5pbml0aWFsaXplKCk7RGlzdGFuY2VUb1BvaW50LmNvbXB1dGVEaXN0YW5jZSh0aGlzLmdlb20scHQsdGhpcy5taW5QdERpc3QpO3RoaXMubWF4UHREaXN0LnNldE1heGltdW0odGhpcy5taW5QdERpc3QpO307TWF4UG9pbnREaXN0YW5jZUZpbHRlci5wcm90b3R5cGUuZ2V0TWF4UG9pbnREaXN0YW5jZT1mdW5jdGlvbigpe3JldHVybiB0aGlzLm1heFB0RGlzdDt9O3ZhciBNYXhEZW5zaWZpZWRCeUZyYWN0aW9uRGlzdGFuY2VGaWx0ZXI9ZnVuY3Rpb24oZ2VvbSxmcmFjdGlvbil7dGhpcy5tYXhQdERpc3Q9bmV3IFBvaW50UGFpckRpc3RhbmNlKCk7dGhpcy5taW5QdERpc3Q9bmV3IFBvaW50UGFpckRpc3RhbmNlKCk7dGhpcy5nZW9tPWdlb207dGhpcy5udW1TdWJTZWdzPU1hdGgucm91bmQoMS4wL2ZyYWN0aW9uKTt9O01heERlbnNpZmllZEJ5RnJhY3Rpb25EaXN0YW5jZUZpbHRlci5wcm90b3R5cGU9bmV3IGpzdHMuZ2VvbS5Db29yZGluYXRlU2VxdWVuY2VGaWx0ZXIoKTtNYXhEZW5zaWZpZWRCeUZyYWN0aW9uRGlzdGFuY2VGaWx0ZXIucHJvdG90eXBlLm1heFB0RGlzdD1uZXcgUG9pbnRQYWlyRGlzdGFuY2UoKTtNYXhEZW5zaWZpZWRCeUZyYWN0aW9uRGlzdGFuY2VGaWx0ZXIucHJvdG90eXBlLm1pblB0RGlzdD1uZXcgUG9pbnRQYWlyRGlzdGFuY2UoKTtNYXhEZW5zaWZpZWRCeUZyYWN0aW9uRGlzdGFuY2VGaWx0ZXIucHJvdG90eXBlLmdlb207TWF4RGVuc2lmaWVkQnlGcmFjdGlvbkRpc3RhbmNlRmlsdGVyLnByb3RvdHlwZS5udW1TdWJTZWdzPTA7TWF4RGVuc2lmaWVkQnlGcmFjdGlvbkRpc3RhbmNlRmlsdGVyLnByb3RvdHlwZS5maWx0ZXI9ZnVuY3Rpb24oc2VxLGluZGV4KXtpZihpbmRleD09MClcbnJldHVybjt2YXIgcDA9c2VxW2luZGV4LTFdO3ZhciBwMT1zZXFbaW5kZXhdO3ZhciBkZWx4PShwMS54LXAwLngpL3RoaXMubnVtU3ViU2Vnczt2YXIgZGVseT0ocDEueS1wMC55KS90aGlzLm51bVN1YlNlZ3M7Zm9yKHZhciBpPTA7aTx0aGlzLm51bVN1YlNlZ3M7aSsrKXt2YXIgeD1wMC54K2kqZGVseDt2YXIgeT1wMC55K2kqZGVseTt2YXIgcHQ9bmV3IGpzdHMuZ2VvbS5Db29yZGluYXRlKHgseSk7dGhpcy5taW5QdERpc3QuaW5pdGlhbGl6ZSgpO0Rpc3RhbmNlVG9Qb2ludC5jb21wdXRlRGlzdGFuY2UodGhpcy5nZW9tLHB0LHRoaXMubWluUHREaXN0KTt0aGlzLm1heFB0RGlzdC5zZXRNYXhpbXVtKHRoaXMubWluUHREaXN0KTt9fTtNYXhEZW5zaWZpZWRCeUZyYWN0aW9uRGlzdGFuY2VGaWx0ZXIucHJvdG90eXBlLmlzR2VvbWV0cnlDaGFuZ2VkPWZ1bmN0aW9uKCl7cmV0dXJuIGZhbHNlO307TWF4RGVuc2lmaWVkQnlGcmFjdGlvbkRpc3RhbmNlRmlsdGVyLnByb3RvdHlwZS5pc0RvbmU9ZnVuY3Rpb24oKXtyZXR1cm4gZmFsc2U7fTtNYXhEZW5zaWZpZWRCeUZyYWN0aW9uRGlzdGFuY2VGaWx0ZXIucHJvdG90eXBlLmdldE1heFBvaW50RGlzdGFuY2U9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5tYXhQdERpc3Q7fTtqc3RzLmFsZ29yaXRobS5kaXN0YW5jZS5EaXNjcmV0ZUhhdXNkb3JmZkRpc3RhbmNlPWZ1bmN0aW9uKGcwLGcxKXt0aGlzLmcwPWcwO3RoaXMuZzE9ZzE7dGhpcy5wdERpc3Q9bmV3IGpzdHMuYWxnb3JpdGhtLmRpc3RhbmNlLlBvaW50UGFpckRpc3RhbmNlKCk7fTtqc3RzLmFsZ29yaXRobS5kaXN0YW5jZS5EaXNjcmV0ZUhhdXNkb3JmZkRpc3RhbmNlLnByb3RvdHlwZS5nMD1udWxsO2pzdHMuYWxnb3JpdGhtLmRpc3RhbmNlLkRpc2NyZXRlSGF1c2RvcmZmRGlzdGFuY2UucHJvdG90eXBlLmcxPW51bGw7anN0cy5hbGdvcml0aG0uZGlzdGFuY2UuRGlzY3JldGVIYXVzZG9yZmZEaXN0YW5jZS5wcm90b3R5cGUucHREaXN0PW51bGw7anN0cy5hbGdvcml0aG0uZGlzdGFuY2UuRGlzY3JldGVIYXVzZG9yZmZEaXN0YW5jZS5wcm90b3R5cGUuZGVuc2lmeUZyYWM9MC4wO2pzdHMuYWxnb3JpdGhtLmRpc3RhbmNlLkRpc2NyZXRlSGF1c2RvcmZmRGlzdGFuY2UuZGlzdGFuY2U9ZnVuY3Rpb24oZzAsZzEsZGVuc2lmeUZyYWMpe3ZhciBkaXN0PW5ldyBqc3RzLmFsZ29yaXRobS5kaXN0YW5jZS5EaXNjcmV0ZUhhdXNkb3JmZkRpc3RhbmNlKGcwLGcxKTtpZihkZW5zaWZ5RnJhYyE9PXVuZGVmaW5lZClcbmRpc3Quc2V0RGVuc2lmeUZyYWN0aW9uKGRlbnNpZnlGcmFjKTtyZXR1cm4gZGlzdC5kaXN0YW5jZSgpO307anN0cy5hbGdvcml0aG0uZGlzdGFuY2UuRGlzY3JldGVIYXVzZG9yZmZEaXN0YW5jZS5wcm90b3R5cGUuc2V0RGVuc2lmeUZyYWN0aW9uPWZ1bmN0aW9uKGRlbnNpZnlGcmFjKXtpZihkZW5zaWZ5RnJhYz4xLjB8fGRlbnNpZnlGcmFjPD0wLjApXG50aHJvdyBuZXcganN0cy5lcnJvci5JbGxlZ2FsQXJndW1lbnRFcnJvcignRnJhY3Rpb24gaXMgbm90IGluIHJhbmdlICgwLjAgLSAxLjBdJyk7dGhpcy5kZW5zaWZ5RnJhYz1kZW5zaWZ5RnJhYzt9O2pzdHMuYWxnb3JpdGhtLmRpc3RhbmNlLkRpc2NyZXRlSGF1c2RvcmZmRGlzdGFuY2UucHJvdG90eXBlLmRpc3RhbmNlPWZ1bmN0aW9uKCl7dGhpcy5jb21wdXRlKHRoaXMuZzAsdGhpcy5nMSk7cmV0dXJuIHB0RGlzdC5nZXREaXN0YW5jZSgpO307anN0cy5hbGdvcml0aG0uZGlzdGFuY2UuRGlzY3JldGVIYXVzZG9yZmZEaXN0YW5jZS5wcm90b3R5cGUub3JpZW50ZWREaXN0YW5jZT1mdW5jdGlvbigpe3RoaXMuY29tcHV0ZU9yaWVudGVkRGlzdGFuY2UodGhpcy5nMCx0aGlzLmcxLHRoaXMucHREaXN0KTtyZXR1cm4gdGhpcy5wdERpc3QuZ2V0RGlzdGFuY2UoKTt9O2pzdHMuYWxnb3JpdGhtLmRpc3RhbmNlLkRpc2NyZXRlSGF1c2RvcmZmRGlzdGFuY2UucHJvdG90eXBlLmdldENvb3JkaW5hdGVzPWZ1bmN0aW9uKCl7cmV0dXJuIHB0RGlzdC5nZXRDb29yZGluYXRlcygpO307anN0cy5hbGdvcml0aG0uZGlzdGFuY2UuRGlzY3JldGVIYXVzZG9yZmZEaXN0YW5jZS5wcm90b3R5cGUuY29tcHV0ZT1mdW5jdGlvbihnMCxnMSl7dGhpcy5jb21wdXRlT3JpZW50ZWREaXN0YW5jZShnMCxnMSx0aGlzLnB0RGlzdCk7dGhpcy5jb21wdXRlT3JpZW50ZWREaXN0YW5jZShnMSxnMCx0aGlzLnB0RGlzdCk7fTtqc3RzLmFsZ29yaXRobS5kaXN0YW5jZS5EaXNjcmV0ZUhhdXNkb3JmZkRpc3RhbmNlLnByb3RvdHlwZS5jb21wdXRlT3JpZW50ZWREaXN0YW5jZT1mdW5jdGlvbihkaXNjcmV0ZUdlb20sZ2VvbSxwdERpc3Qpe3ZhciBkaXN0RmlsdGVyPW5ldyBNYXhQb2ludERpc3RhbmNlRmlsdGVyKGdlb20pO2Rpc2NyZXRlR2VvbS5hcHBseShkaXN0RmlsdGVyKTtwdERpc3Quc2V0TWF4aW11bShkaXN0RmlsdGVyLmdldE1heFBvaW50RGlzdGFuY2UoKSk7aWYodGhpcy5kZW5zaWZ5RnJhYz4wKXt2YXIgZnJhY0ZpbHRlcj1uZXcgTWF4RGVuc2lmaWVkQnlGcmFjdGlvbkRpc3RhbmNlRmlsdGVyKGdlb20sdGhpcy5kZW5zaWZ5RnJhYyk7ZGlzY3JldGVHZW9tLmFwcGx5KGZyYWNGaWx0ZXIpO3B0RGlzdC5zZXRNYXhpbXVtKGZyYWNGaWx0ZXIuZ2V0TWF4UG9pbnREaXN0YW5jZSgpKTt9fTt9KSgpO2pzdHMuYWxnb3JpdGhtLk1pbmltdW1Cb3VuZGluZ0NpcmNsZT1mdW5jdGlvbihnZW9tKXt0aGlzLmlucHV0PW51bGw7dGhpcy5leHRyZW1hbFB0cz1udWxsO3RoaXMuY2VudHJlPW51bGw7dGhpcy5yYWRpdXM9MDt0aGlzLmlucHV0PWdlb207fTtqc3RzLmFsZ29yaXRobS5NaW5pbXVtQm91bmRpbmdDaXJjbGUucHJvdG90eXBlLmdldENpcmNsZT1mdW5jdGlvbigpe3RoaXMuY29tcHV0ZSgpO2lmKHRoaXMuY2VudHJlPT09bnVsbCl7cmV0dXJuIHRoaXMuaW5wdXQuZ2V0RmFjdG9yeSgpLmNyZWF0ZVBvbHlnb24obnVsbCxudWxsKTt9XG52YXIgY2VudHJlUG9pbnQ9dGhpcy5pbnB1dC5nZXRGYWN0b3J5KCkuY3JlYXRlUG9pbnQodGhpcy5jZW50cmUpO2lmKHRoaXMucmFkaXVzPT09MCl7cmV0dXJuIGNlbnRyZVBvaW50O31cbnJldHVybiBjZW50cmVQb2ludC5idWZmZXIodGhpcy5yYWRpdXMpO307anN0cy5hbGdvcml0aG0uTWluaW11bUJvdW5kaW5nQ2lyY2xlLnByb3RvdHlwZS5nZXRFeHRyZW1hbFBvaW50cz1mdW5jdGlvbigpe3RoaXMuY29tcHV0ZSgpO3JldHVybiB0aGlzLmV4dHJlbWFsUHRzO307anN0cy5hbGdvcml0aG0uTWluaW11bUJvdW5kaW5nQ2lyY2xlLnByb3RvdHlwZS5nZXRDZW50cmU9ZnVuY3Rpb24oKXt0aGlzLmNvbXB1dGUoKTtyZXR1cm4gdGhpcy5jZW50cmU7fTtqc3RzLmFsZ29yaXRobS5NaW5pbXVtQm91bmRpbmdDaXJjbGUucHJvdG90eXBlLmdldFJhZGl1cz1mdW5jdGlvbigpe3RoaXMuY29tcHV0ZSgpO3JldHVybiB0aGlzLnJhZGl1czt9O2pzdHMuYWxnb3JpdGhtLk1pbmltdW1Cb3VuZGluZ0NpcmNsZS5wcm90b3R5cGUuY29tcHV0ZUNlbnRyZT1mdW5jdGlvbigpe3N3aXRjaCh0aGlzLmV4dHJlbWFsUHRzLmxlbmd0aCl7Y2FzZSAwOnRoaXMuY2VudHJlPW51bGw7YnJlYWs7Y2FzZSAxOnRoaXMuY2VudHJlPXRoaXMuZXh0cmVtYWxQdHNbMF07YnJlYWs7Y2FzZSAyOnRoaXMuY2VudHJlPW5ldyBqc3RzLmdlb20uQ29vcmRpbmF0ZSgodGhpcy5leHRyZW1hbFB0c1swXS54K3RoaXMuZXh0cmVtYWxQdHNbMV0ueCkvMiwodGhpcy5leHRyZW1hbFB0c1swXS55K3RoaXMuZXh0cmVtYWxQdHNbMV0ueSkvMik7YnJlYWs7Y2FzZSAzOnRoaXMuY2VudHJlPWpzdHMuZ2VvbS5UcmlhbmdsZS5jaXJjdW1jZW50cmUodGhpcy5leHRyZW1hbFB0c1swXSx0aGlzLmV4dHJlbWFsUHRzWzFdLHRoaXMuZXh0cmVtYWxQdHNbMl0pO2JyZWFrO319O2pzdHMuYWxnb3JpdGhtLk1pbmltdW1Cb3VuZGluZ0NpcmNsZS5wcm90b3R5cGUuY29tcHV0ZT1mdW5jdGlvbigpe2lmKHRoaXMuZXh0cmVtYWxQdHMhPT1udWxsKXtyZXR1cm47fVxudGhpcy5jb21wdXRlQ2lyY2xlUG9pbnRzKCk7dGhpcy5jb21wdXRlQ2VudHJlKCk7aWYodGhpcy5jZW50cmUhPT1udWxsKXt0aGlzLnJhZGl1cz10aGlzLmNlbnRyZS5kaXN0YW5jZSh0aGlzLmV4dHJlbWFsUHRzWzBdKTt9fTtqc3RzLmFsZ29yaXRobS5NaW5pbXVtQm91bmRpbmdDaXJjbGUucHJvdG90eXBlLmNvbXB1dGVDaXJjbGVQb2ludHM9ZnVuY3Rpb24oKXtpZih0aGlzLmlucHV0LmlzRW1wdHkoKSl7dGhpcy5leHRyZW1hbFB0cz1bXTtyZXR1cm47fVxudmFyIHB0cztpZih0aGlzLmlucHV0LmdldE51bVBvaW50cygpPT09MSl7cHRzPXRoaXMuaW5wdXQuZ2V0Q29vcmRpbmF0ZXMoKTt0aGlzLmV4dHJlbWFsUHRzPVtuZXcganN0cy5nZW9tLkNvb3JkaW5hdGUocHRzWzBdKV07cmV0dXJuO31cbnZhciBjb252ZXhIdWxsPXRoaXMuaW5wdXQuY29udmV4SHVsbCgpO3ZhciBodWxsUHRzPWNvbnZleEh1bGwuZ2V0Q29vcmRpbmF0ZXMoKTtwdHM9aHVsbFB0cztpZihodWxsUHRzWzBdLmVxdWFsczJEKGh1bGxQdHNbaHVsbFB0cy5sZW5ndGgtMV0pKXtwdHM9W107anN0cy5nZW9tLkNvb3JkaW5hdGVBcnJheXMuY29weURlZXAoaHVsbFB0cywwLHB0cywwLGh1bGxQdHMubGVuZ3RoLTEpO31cbmlmKHB0cy5sZW5ndGg8PTIpe3RoaXMuZXh0cmVtYWxQdHM9anN0cy5nZW9tLkNvb3JkaW5hdGVBcnJheXMuY29weURlZXAocHRzKTtyZXR1cm47fVxudmFyIFA9anN0cy5hbGdvcml0aG0uTWluaW11bUJvdW5kaW5nQ2lyY2xlLmxvd2VzdFBvaW50KHB0cyk7dmFyIFE9anN0cy5hbGdvcml0aG0uTWluaW11bUJvdW5kaW5nQ2lyY2xlLnBvaW50V2l0TWluQW5nbGVXaXRoWChwdHMsUCk7Zm9yKHZhciBpPTA7aTxwdHMubGVuZ3RoO2krKyl7dmFyIFI9anN0cy5hbGdvcml0aG0uTWluaW11bUJvdW5kaW5nQ2lyY2xlLnBvaW50V2l0aE1pbkFuZ2xlV2l0aFNlZ21lbnQocHRzLFAsUSk7aWYoanN0cy5hbGdvcml0aG0uQW5nbGUuaXNPYnR1c2UoUCxSLFEpKXt0aGlzLmV4dHJlbWFsUHRzPVtuZXcganN0cy5nZW9tLkNvb3JkaW5hdGUoUCksbmV3IGpzdHMuZ2VvbS5Db29yZGluYXRlKFEpXTtyZXR1cm47fVxuaWYoanN0cy5hbGdvcml0aG0uQW5nbGUuaXNPYnR1c2UoUixQLFEpKXtQPVI7Y29udGludWU7fVxuaWYoanN0cy5hbGdvcml0aG0uQW5nbGUuaXNPYnR1c2UoUixRLFApKXtRPVI7Y29udGludWU7fVxudGhpcy5leHRyZW1hbFB0cz1bbmV3IGpzdHMuZ2VvbS5Db29yZGluYXRlKFApLG5ldyBqc3RzLmdlb20uQ29vcmRpbmF0ZShRKSxuZXcganN0cy5nZW9tLkNvb3JkaW5hdGUoUildO3JldHVybjt9XG50aHJvdyBuZXcgRXJyb3IoXCJMb2dpYyBmYWlsdXJlIGluIE1pbmltdW0gQm91bmRpbmcgQ2lyY2xlIGFsZ29yaXRobSFcIik7fTtqc3RzLmFsZ29yaXRobS5NaW5pbXVtQm91bmRpbmdDaXJjbGUubG93ZXN0UG9pbnQ9ZnVuY3Rpb24ocHRzKXt2YXIgbWluPXB0c1swXTtmb3IodmFyIGk9MTtpPHB0cy5sZW5ndGg7aSsrKXtpZihwdHNbaV0ueTxtaW4ueSl7bWluPXB0c1tpXTt9fVxucmV0dXJuIG1pbjt9O2pzdHMuYWxnb3JpdGhtLk1pbmltdW1Cb3VuZGluZ0NpcmNsZS5wb2ludFdpdE1pbkFuZ2xlV2l0aFg9ZnVuY3Rpb24ocHRzLFApe3ZhciBtaW5TaW49TnVtYmVyLk1BWF9WQUxVRTt2YXIgbWluQW5nUHQ9bnVsbDtmb3IodmFyIGk9MDtpPHB0cy5sZW5ndGg7aSsrKXt2YXIgcD1wdHNbaV07aWYocD09PVApY29udGludWU7dmFyIGR4PXAueC1QLng7dmFyIGR5PXAueS1QLnk7aWYoZHk8MClkeT0tZHk7dmFyIGxlbj1NYXRoLnNxcnQoZHgqZHgrZHkqZHkpO3ZhciBzaW49ZHkvbGVuO2lmKHNpbjxtaW5TaW4pe21pblNpbj1zaW47bWluQW5nUHQ9cDt9fVxucmV0dXJuIG1pbkFuZ1B0O307anN0cy5hbGdvcml0aG0uTWluaW11bUJvdW5kaW5nQ2lyY2xlLnBvaW50V2l0aE1pbkFuZ2xlV2l0aFNlZ21lbnQ9ZnVuY3Rpb24ocHRzLFAsUSl7dmFyIG1pbkFuZz1OdW1iZXIuTUFYX1ZBTFVFO3ZhciBtaW5BbmdQdD1udWxsO2Zvcih2YXIgaT0wO2k8cHRzLmxlbmd0aDtpKyspe3ZhciBwPXB0c1tpXTtpZihwPT09UCljb250aW51ZTtpZihwPT09USljb250aW51ZTt2YXIgYW5nPWpzdHMuYWxnb3JpdGhtLkFuZ2xlLmFuZ2xlQmV0d2VlbihQLHAsUSk7aWYoYW5nPG1pbkFuZyl7bWluQW5nPWFuZzttaW5BbmdQdD1wO319XG5yZXR1cm4gbWluQW5nUHQ7fTtqc3RzLm5vZGluZy5TY2FsZWROb2Rlcj1mdW5jdGlvbihub2RlcixzY2FsZUZhY3RvcixvZmZzZXRYLG9mZnNldFkpe3RoaXMub2Zmc2V0WD1vZmZzZXRYP29mZnNldFg6MDt0aGlzLm9mZnNldFk9b2Zmc2V0WT9vZmZzZXRZOjA7dGhpcy5ub2Rlcj1ub2Rlcjt0aGlzLnNjYWxlRmFjdG9yPXNjYWxlRmFjdG9yO3RoaXMuaXNTY2FsZWQ9IXRoaXMuaXNJbnRlZ2VyUHJlY2lzaW9uKCk7fTtqc3RzLm5vZGluZy5TY2FsZWROb2Rlci5wcm90b3R5cGU9bmV3IGpzdHMubm9kaW5nLk5vZGVyKCk7anN0cy5ub2RpbmcuU2NhbGVkTm9kZXIuY29uc3RydWN0b3I9anN0cy5ub2RpbmcuU2NhbGVkTm9kZXI7anN0cy5ub2RpbmcuU2NhbGVkTm9kZXIucHJvdG90eXBlLm5vZGVyPW51bGw7anN0cy5ub2RpbmcuU2NhbGVkTm9kZXIucHJvdG90eXBlLnNjYWxlRmFjdG9yPXVuZGVmaW5lZDtqc3RzLm5vZGluZy5TY2FsZWROb2Rlci5wcm90b3R5cGUub2Zmc2V0WD11bmRlZmluZWQ7anN0cy5ub2RpbmcuU2NhbGVkTm9kZXIucHJvdG90eXBlLm9mZnNldFk9dW5kZWZpbmVkO2pzdHMubm9kaW5nLlNjYWxlZE5vZGVyLnByb3RvdHlwZS5pc1NjYWxlZD1mYWxzZTtqc3RzLm5vZGluZy5TY2FsZWROb2Rlci5wcm90b3R5cGUuaXNJbnRlZ2VyUHJlY2lzaW9uPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuc2NhbGVGYWN0b3I9PT0xLjA7fTtqc3RzLm5vZGluZy5TY2FsZWROb2Rlci5wcm90b3R5cGUuZ2V0Tm9kZWRTdWJzdHJpbmdzPWZ1bmN0aW9uKCl7dmFyIHNwbGl0U1M9dGhpcy5ub2Rlci5nZXROb2RlZFN1YnN0cmluZ3MoKTtpZih0aGlzLmlzU2NhbGVkKVxudGhpcy5yZXNjYWxlKHNwbGl0U1MpO3JldHVybiBzcGxpdFNTO307anN0cy5ub2RpbmcuU2NhbGVkTm9kZXIucHJvdG90eXBlLmNvbXB1dGVOb2Rlcz1mdW5jdGlvbihpbnB1dFNlZ1N0cmluZ3Mpe3ZhciBpbnRTZWdTdHJpbmdzPWlucHV0U2VnU3RyaW5ncztpZih0aGlzLmlzU2NhbGVkKVxuaW50U2VnU3RyaW5ncz10aGlzLnNjYWxlKGlucHV0U2VnU3RyaW5ncyk7dGhpcy5ub2Rlci5jb21wdXRlTm9kZXMoaW50U2VnU3RyaW5ncyk7fTtqc3RzLm5vZGluZy5TY2FsZWROb2Rlci5wcm90b3R5cGUuc2NhbGU9ZnVuY3Rpb24oc2VnU3RyaW5ncyl7aWYoc2VnU3RyaW5ncyBpbnN0YW5jZW9mIEFycmF5KXtyZXR1cm4gdGhpcy5zY2FsZTIoc2VnU3RyaW5ncyk7fVxudmFyIHRyYW5zZm9ybWVkPW5ldyBqYXZhc2NyaXB0LnV0aWwuQXJyYXlMaXN0KCk7Zm9yKHZhciBpPXNlZ1N0cmluZ3MuaXRlcmF0b3IoKTtpLmhhc05leHQoKTspe3ZhciBzcz1pLm5leHQoKTt0cmFuc2Zvcm1lZC5hZGQobmV3IGpzdHMubm9kaW5nLk5vZGVkU2VnbWVudFN0cmluZyh0aGlzLnNjYWxlKHNzLmdldENvb3JkaW5hdGVzKCkpLHNzLmdldERhdGEoKSkpO31cbnJldHVybiB0cmFuc2Zvcm1lZDt9O2pzdHMubm9kaW5nLlNjYWxlZE5vZGVyLnByb3RvdHlwZS5zY2FsZTI9ZnVuY3Rpb24ocHRzKXt2YXIgcm91bmRQdHM9W107Zm9yKHZhciBpPTA7aTxwdHMubGVuZ3RoO2krKyl7cm91bmRQdHNbaV09bmV3IGpzdHMuZ2VvbS5Db29yZGluYXRlKE1hdGgucm91bmQoKHB0c1tpXS54LXRoaXMub2Zmc2V0WCkqdGhpcy5zY2FsZUZhY3RvciksTWF0aC5yb3VuZCgocHRzW2ldLnktdGhpcy5vZmZzZXRZKSp0aGlzLnNjYWxlRmFjdG9yKSk7fVxudmFyIHJvdW5kUHRzTm9EdXA9anN0cy5nZW9tLkNvb3JkaW5hdGVBcnJheXMucmVtb3ZlUmVwZWF0ZWRQb2ludHMocm91bmRQdHMpO3JldHVybiByb3VuZFB0c05vRHVwO307anN0cy5ub2RpbmcuU2NhbGVkTm9kZXIucHJvdG90eXBlLnJlc2NhbGU9ZnVuY3Rpb24oc2VnU3RyaW5ncyl7aWYoc2VnU3RyaW5ncyBpbnN0YW5jZW9mIEFycmF5KXt0aGlzLnJlc2NhbGUyKHNlZ1N0cmluZ3MpO3JldHVybjt9XG5mb3IodmFyIGk9c2VnU3RyaW5ncy5pdGVyYXRvcigpO2kuaGFzTmV4dCgpOyl7dmFyIHNzPWkubmV4dCgpO3RoaXMucmVzY2FsZShzcy5nZXRDb29yZGluYXRlcygpKTt9fTtqc3RzLm5vZGluZy5TY2FsZWROb2Rlci5wcm90b3R5cGUucmVzY2FsZTI9ZnVuY3Rpb24ocHRzKXtmb3IodmFyIGk9MDtpPHB0cy5sZW5ndGg7aSsrKXtwdHNbaV0ueD1wdHNbaV0ueC90aGlzLnNjYWxlRmFjdG9yK3RoaXMub2Zmc2V0WDtwdHNbaV0ueT1wdHNbaV0ueS90aGlzLnNjYWxlRmFjdG9yK3RoaXMub2Zmc2V0WTt9fTsoZnVuY3Rpb24oKXt2YXIgQXJyYXlMaXN0PWphdmFzY3JpcHQudXRpbC5BcnJheUxpc3Q7anN0cy5nZW9tZ3JhcGguaW5kZXguU2VnbWVudEludGVyc2VjdG9yPWZ1bmN0aW9uKGxpLGluY2x1ZGVQcm9wZXIscmVjb3JkSXNvbGF0ZWQpe3RoaXMubGk9bGk7dGhpcy5pbmNsdWRlUHJvcGVyPWluY2x1ZGVQcm9wZXI7dGhpcy5yZWNvcmRJc29sYXRlZD1yZWNvcmRJc29sYXRlZDt9O2pzdHMuZ2VvbWdyYXBoLmluZGV4LlNlZ21lbnRJbnRlcnNlY3Rvci5pc0FkamFjZW50U2VnbWVudHM9ZnVuY3Rpb24oaTEsaTIpe3JldHVybiBNYXRoLmFicyhpMS1pMik9PT0xO307anN0cy5nZW9tZ3JhcGguaW5kZXguU2VnbWVudEludGVyc2VjdG9yLnByb3RvdHlwZS5faGFzSW50ZXJzZWN0aW9uPWZhbHNlO2pzdHMuZ2VvbWdyYXBoLmluZGV4LlNlZ21lbnRJbnRlcnNlY3Rvci5wcm90b3R5cGUuaGFzUHJvcGVyPWZhbHNlO2pzdHMuZ2VvbWdyYXBoLmluZGV4LlNlZ21lbnRJbnRlcnNlY3Rvci5wcm90b3R5cGUuaGFzUHJvcGVySW50ZXJpb3I9ZmFsc2U7anN0cy5nZW9tZ3JhcGguaW5kZXguU2VnbWVudEludGVyc2VjdG9yLnByb3RvdHlwZS5wcm9wZXJJbnRlcnNlY3Rpb25Qb2ludD1udWxsO2pzdHMuZ2VvbWdyYXBoLmluZGV4LlNlZ21lbnRJbnRlcnNlY3Rvci5wcm90b3R5cGUubGk9bnVsbDtqc3RzLmdlb21ncmFwaC5pbmRleC5TZWdtZW50SW50ZXJzZWN0b3IucHJvdG90eXBlLmluY2x1ZGVQcm9wZXI9bnVsbDtqc3RzLmdlb21ncmFwaC5pbmRleC5TZWdtZW50SW50ZXJzZWN0b3IucHJvdG90eXBlLnJlY29yZElzb2xhdGVkPW51bGw7anN0cy5nZW9tZ3JhcGguaW5kZXguU2VnbWVudEludGVyc2VjdG9yLnByb3RvdHlwZS5pc1NlbGZJbnRlcnNlY3Rpb249bnVsbDtqc3RzLmdlb21ncmFwaC5pbmRleC5TZWdtZW50SW50ZXJzZWN0b3IucHJvdG90eXBlLm51bUludGVyc2VjdGlvbnM9MDtqc3RzLmdlb21ncmFwaC5pbmRleC5TZWdtZW50SW50ZXJzZWN0b3IucHJvdG90eXBlLm51bVRlc3RzPTA7anN0cy5nZW9tZ3JhcGguaW5kZXguU2VnbWVudEludGVyc2VjdG9yLnByb3RvdHlwZS5iZHlOb2Rlcz1udWxsO2pzdHMuZ2VvbWdyYXBoLmluZGV4LlNlZ21lbnRJbnRlcnNlY3Rvci5wcm90b3R5cGUuc2V0Qm91bmRhcnlOb2Rlcz1mdW5jdGlvbihiZHlOb2RlczAsYmR5Tm9kZXMxKXt0aGlzLmJkeU5vZGVzPVtdO3RoaXMuYmR5Tm9kZXNbMF09YmR5Tm9kZXMwO3RoaXMuYmR5Tm9kZXNbMV09YmR5Tm9kZXMxO307anN0cy5nZW9tZ3JhcGguaW5kZXguU2VnbWVudEludGVyc2VjdG9yLnByb3RvdHlwZS5nZXRQcm9wZXJJbnRlcnNlY3Rpb25Qb2ludD1mdW5jdGlvbigpe3JldHVybiB0aGlzLnByb3BlckludGVyc2VjdGlvblBvaW50O307anN0cy5nZW9tZ3JhcGguaW5kZXguU2VnbWVudEludGVyc2VjdG9yLnByb3RvdHlwZS5oYXNJbnRlcnNlY3Rpb249ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5faGFzSW50ZXJzZWN0aW9uO307anN0cy5nZW9tZ3JhcGguaW5kZXguU2VnbWVudEludGVyc2VjdG9yLnByb3RvdHlwZS5oYXNQcm9wZXJJbnRlcnNlY3Rpb249ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5oYXNQcm9wZXI7fTtqc3RzLmdlb21ncmFwaC5pbmRleC5TZWdtZW50SW50ZXJzZWN0b3IucHJvdG90eXBlLmhhc1Byb3BlckludGVyaW9ySW50ZXJzZWN0aW9uPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuaGFzUHJvcGVySW50ZXJpb3I7fTtqc3RzLmdlb21ncmFwaC5pbmRleC5TZWdtZW50SW50ZXJzZWN0b3IucHJvdG90eXBlLmlzVHJpdmlhbEludGVyc2VjdGlvbj1mdW5jdGlvbihlMCxzZWdJbmRleDAsZTEsc2VnSW5kZXgxKXtpZihlMD09PWUxKXtpZih0aGlzLmxpLmdldEludGVyc2VjdGlvbk51bSgpPT09MSl7aWYoanN0cy5nZW9tZ3JhcGguaW5kZXguU2VnbWVudEludGVyc2VjdG9yLmlzQWRqYWNlbnRTZWdtZW50cyhzZWdJbmRleDAsc2VnSW5kZXgxKSlcbnJldHVybiB0cnVlO2lmKGUwLmlzQ2xvc2VkKCkpe3ZhciBtYXhTZWdJbmRleD1lMC5nZXROdW1Qb2ludHMoKS0xO2lmKChzZWdJbmRleDA9PT0wJiZzZWdJbmRleDE9PT1tYXhTZWdJbmRleCl8fChzZWdJbmRleDE9PT0wJiZzZWdJbmRleDA9PT1tYXhTZWdJbmRleCkpe3JldHVybiB0cnVlO319fX1cbnJldHVybiBmYWxzZTt9O2pzdHMuZ2VvbWdyYXBoLmluZGV4LlNlZ21lbnRJbnRlcnNlY3Rvci5wcm90b3R5cGUuYWRkSW50ZXJzZWN0aW9ucz1mdW5jdGlvbihlMCxzZWdJbmRleDAsZTEsc2VnSW5kZXgxKXtpZihlMD09PWUxJiZzZWdJbmRleDA9PT1zZWdJbmRleDEpXG5yZXR1cm47dGhpcy5udW1UZXN0cysrO3ZhciBwMDA9ZTAuZ2V0Q29vcmRpbmF0ZXMoKVtzZWdJbmRleDBdO3ZhciBwMDE9ZTAuZ2V0Q29vcmRpbmF0ZXMoKVtzZWdJbmRleDArMV07dmFyIHAxMD1lMS5nZXRDb29yZGluYXRlcygpW3NlZ0luZGV4MV07dmFyIHAxMT1lMS5nZXRDb29yZGluYXRlcygpW3NlZ0luZGV4MSsxXTt0aGlzLmxpLmNvbXB1dGVJbnRlcnNlY3Rpb24ocDAwLHAwMSxwMTAscDExKTtpZih0aGlzLmxpLmhhc0ludGVyc2VjdGlvbigpKXtpZih0aGlzLnJlY29yZElzb2xhdGVkKXtlMC5zZXRJc29sYXRlZChmYWxzZSk7ZTEuc2V0SXNvbGF0ZWQoZmFsc2UpO31cbnRoaXMubnVtSW50ZXJzZWN0aW9ucysrO2lmKCF0aGlzLmlzVHJpdmlhbEludGVyc2VjdGlvbihlMCxzZWdJbmRleDAsZTEsc2VnSW5kZXgxKSl7dGhpcy5faGFzSW50ZXJzZWN0aW9uPXRydWU7aWYodGhpcy5pbmNsdWRlUHJvcGVyfHwhdGhpcy5saS5pc1Byb3BlcigpKXtlMC5hZGRJbnRlcnNlY3Rpb25zKHRoaXMubGksc2VnSW5kZXgwLDApO2UxLmFkZEludGVyc2VjdGlvbnModGhpcy5saSxzZWdJbmRleDEsMSk7fVxuaWYodGhpcy5saS5pc1Byb3BlcigpKXt0aGlzLnByb3BlckludGVyc2VjdGlvblBvaW50PXRoaXMubGkuZ2V0SW50ZXJzZWN0aW9uKDApLmNsb25lKCk7dGhpcy5oYXNQcm9wZXI9dHJ1ZTtpZighdGhpcy5pc0JvdW5kYXJ5UG9pbnQodGhpcy5saSx0aGlzLmJkeU5vZGVzKSlcbnRoaXMuaGFzUHJvcGVySW50ZXJpb3I9dHJ1ZTt9fX19O2pzdHMuZ2VvbWdyYXBoLmluZGV4LlNlZ21lbnRJbnRlcnNlY3Rvci5wcm90b3R5cGUuaXNCb3VuZGFyeVBvaW50PWZ1bmN0aW9uKGxpLGJkeU5vZGVzKXtpZihiZHlOb2Rlcz09PW51bGwpXG5yZXR1cm4gZmFsc2U7aWYoYmR5Tm9kZXMgaW5zdGFuY2VvZiBBcnJheSl7aWYodGhpcy5pc0JvdW5kYXJ5UG9pbnQobGksYmR5Tm9kZXNbMF0pKVxucmV0dXJuIHRydWU7aWYodGhpcy5pc0JvdW5kYXJ5UG9pbnQobGksYmR5Tm9kZXNbMV0pKVxucmV0dXJuIHRydWU7cmV0dXJuIGZhbHNlO31lbHNle2Zvcih2YXIgaT1iZHlOb2Rlcy5pdGVyYXRvcigpO2kuaGFzTmV4dCgpOyl7dmFyIG5vZGU9aS5uZXh0KCk7dmFyIHB0PW5vZGUuZ2V0Q29vcmRpbmF0ZSgpO2lmKGxpLmlzSW50ZXJzZWN0aW9uKHB0KSlcbnJldHVybiB0cnVlO31cbnJldHVybiBmYWxzZTt9fTt9KSgpOyIsIi8qXG4gIGphdmFzY3JpcHQudXRpbCBpcyBhIHBvcnQgb2Ygc2VsZWN0ZWQgcGFydHMgb2YgamF2YS51dGlsIHRvIEphdmFTY3JpcHQgd2hpY2hcbiAgbWFpbiBwdXJwb3NlIGlzIHRvIGVhc2UgcG9ydGluZyBKYXZhIGNvZGUgdG8gSmF2YVNjcmlwdC5cbiAgXG4gIFRoZSBNSVQgTGljZW5zZSAoTUlUKVxuXG4gIENvcHlyaWdodCAoQykgMjAxMS0yMDE0IGJ5IFRoZSBBdXRob3JzXG5cbiAgUGVybWlzc2lvbiBpcyBoZXJlYnkgZ3JhbnRlZCwgZnJlZSBvZiBjaGFyZ2UsIHRvIGFueSBwZXJzb24gb2J0YWluaW5nIGEgY29weVxuICBvZiB0aGlzIHNvZnR3YXJlIGFuZCBhc3NvY2lhdGVkIGRvY3VtZW50YXRpb24gZmlsZXMgKHRoZSBcIlNvZnR3YXJlXCIpLCB0byBkZWFsXG4gIGluIHRoZSBTb2Z0d2FyZSB3aXRob3V0IHJlc3RyaWN0aW9uLCBpbmNsdWRpbmcgd2l0aG91dCBsaW1pdGF0aW9uIHRoZSByaWdodHNcbiAgdG8gdXNlLCBjb3B5LCBtb2RpZnksIG1lcmdlLCBwdWJsaXNoLCBkaXN0cmlidXRlLCBzdWJsaWNlbnNlLCBhbmQvb3Igc2VsbFxuICBjb3BpZXMgb2YgdGhlIFNvZnR3YXJlLCBhbmQgdG8gcGVybWl0IHBlcnNvbnMgdG8gd2hvbSB0aGUgU29mdHdhcmUgaXNcbiAgZnVybmlzaGVkIHRvIGRvIHNvLCBzdWJqZWN0IHRvIHRoZSBmb2xsb3dpbmcgY29uZGl0aW9uczpcblxuICBUaGUgYWJvdmUgY29weXJpZ2h0IG5vdGljZSBhbmQgdGhpcyBwZXJtaXNzaW9uIG5vdGljZSBzaGFsbCBiZSBpbmNsdWRlZCBpblxuICBhbGwgY29waWVzIG9yIHN1YnN0YW50aWFsIHBvcnRpb25zIG9mIHRoZSBTb2Z0d2FyZS5cblxuICBUSEUgU09GVFdBUkUgSVMgUFJPVklERUQgXCJBUyBJU1wiLCBXSVRIT1VUIFdBUlJBTlRZIE9GIEFOWSBLSU5ELCBFWFBSRVNTIE9SXG4gIElNUExJRUQsIElOQ0xVRElORyBCVVQgTk9UIExJTUlURUQgVE8gVEhFIFdBUlJBTlRJRVMgT0YgTUVSQ0hBTlRBQklMSVRZLFxuICBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSBBTkQgTk9OSU5GUklOR0VNRU5ULiBJTiBOTyBFVkVOVCBTSEFMTCBUSEVcbiAgQVVUSE9SUyBPUiBDT1BZUklHSFQgSE9MREVSUyBCRSBMSUFCTEUgRk9SIEFOWSBDTEFJTSwgREFNQUdFUyBPUiBPVEhFUlxuICBMSUFCSUxJVFksIFdIRVRIRVIgSU4gQU4gQUNUSU9OIE9GIENPTlRSQUNULCBUT1JUIE9SIE9USEVSV0lTRSwgQVJJU0lORyBGUk9NLFxuICBPVVQgT0YgT1IgSU4gQ09OTkVDVElPTiBXSVRIIFRIRSBTT0ZUV0FSRSBPUiBUSEUgVVNFIE9SIE9USEVSIERFQUxJTkdTIElOXG4gIFRIRSBTT0ZUV0FSRS5cbiovXG47KGZ1bmN0aW9uKCl7dmFyIGU9dGhpcztmdW5jdGlvbiBmKGEsYil7dmFyIGM9YS5zcGxpdChcIi5cIiksZD1lO2NbMF1pbiBkfHwhZC5leGVjU2NyaXB0fHxkLmV4ZWNTY3JpcHQoXCJ2YXIgXCIrY1swXSk7Zm9yKHZhciB0O2MubGVuZ3RoJiYodD1jLnNoaWZ0KCkpOyljLmxlbmd0aHx8dm9pZCAwPT09Yj9kPWRbdF0/ZFt0XTpkW3RdPXt9OmRbdF09Yn1mdW5jdGlvbiBnKGEsYil7ZnVuY3Rpb24gYygpe31jLnByb3RvdHlwZT1iLnByb3RvdHlwZTthLnE9Yi5wcm90b3R5cGU7YS5wcm90b3R5cGU9bmV3IGM7YS5wcm90b3R5cGUuY29uc3RydWN0b3I9YTthLnA9ZnVuY3Rpb24oYSxjLE8pe3ZhciBNPUFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cywyKTtyZXR1cm4gYi5wcm90b3R5cGVbY10uYXBwbHkoYSxNKX19O2Z1bmN0aW9uIGgoYSl7dGhpcy5tZXNzYWdlPWF8fFwiXCJ9ZyhoLEVycm9yKTtmKFwiamF2YXNjcmlwdC51dGlsLkVtcHR5U3RhY2tFeGNlcHRpb25cIixoKTtoLnByb3RvdHlwZS5uYW1lPVwiRW1wdHlTdGFja0V4Y2VwdGlvblwiO2Z1bmN0aW9uIGsoYSl7dGhpcy5tZXNzYWdlPWF8fFwiXCJ9ZyhrLEVycm9yKTtmKFwiamF2YXNjcmlwdC51dGlsLkluZGV4T3V0T2ZCb3VuZHNFeGNlcHRpb25cIixrKTtrLnByb3RvdHlwZS5uYW1lPVwiSW5kZXhPdXRPZkJvdW5kc0V4Y2VwdGlvblwiO2Z1bmN0aW9uIGwoKXt9ZihcImphdmFzY3JpcHQudXRpbC5JdGVyYXRvclwiLGwpO2wucHJvdG90eXBlLmhhc05leHQ9bC5wcm90b3R5cGUuYztsLnByb3RvdHlwZS5uZXh0PWwucHJvdG90eXBlLm5leHQ7bC5wcm90b3R5cGUucmVtb3ZlPWwucHJvdG90eXBlLnJlbW92ZTtmdW5jdGlvbiBtKCl7fWYoXCJqYXZhc2NyaXB0LnV0aWwuQ29sbGVjdGlvblwiLG0pO2Z1bmN0aW9uIG4oKXt9ZyhuLG0pO2YoXCJqYXZhc2NyaXB0LnV0aWwuTGlzdFwiLG4pO2Z1bmN0aW9uIHAoKXt9ZihcImphdmFzY3JpcHQudXRpbC5NYXBcIixwKTtmdW5jdGlvbiBxKGEpe3RoaXMubWVzc2FnZT1hfHxcIlwifWcocSxFcnJvcik7ZihcImphdmFzY3JpcHQudXRpbC5Ob1N1Y2hFbGVtZW50RXhjZXB0aW9uXCIscSk7cS5wcm90b3R5cGUubmFtZT1cIk5vU3VjaEVsZW1lbnRFeGNlcHRpb25cIjtmdW5jdGlvbiByKGEpe3RoaXMubWVzc2FnZT1hfHxcIlwifWcocixFcnJvcik7ci5wcm90b3R5cGUubmFtZT1cIk9wZXJhdGlvbk5vdFN1cHBvcnRlZFwiO2Z1bmN0aW9uIHMoYSl7dGhpcy5hPVtdO2EgaW5zdGFuY2VvZiBtJiZ0aGlzLmUoYSl9ZyhzLG4pO2YoXCJqYXZhc2NyaXB0LnV0aWwuQXJyYXlMaXN0XCIscyk7cy5wcm90b3R5cGUuYT1udWxsO3MucHJvdG90eXBlLmFkZD1mdW5jdGlvbihhKXt0aGlzLmEucHVzaChhKTtyZXR1cm4hMH07cy5wcm90b3R5cGUuYWRkPXMucHJvdG90eXBlLmFkZDtzLnByb3RvdHlwZS5lPWZ1bmN0aW9uKGEpe2ZvcihhPWEuZigpO2EuYygpOyl0aGlzLmFkZChhLm5leHQoKSk7cmV0dXJuITB9O3MucHJvdG90eXBlLmFkZEFsbD1zLnByb3RvdHlwZS5lO3MucHJvdG90eXBlLnNldD1mdW5jdGlvbihhLGIpe3ZhciBjPXRoaXMuYVthXTt0aGlzLmFbYV09YjtyZXR1cm4gY307cy5wcm90b3R5cGUuc2V0PXMucHJvdG90eXBlLnNldDtzLnByb3RvdHlwZS5mPWZ1bmN0aW9uKCl7cmV0dXJuIG5ldyB1KHRoaXMpfTtzLnByb3RvdHlwZS5pdGVyYXRvcj1zLnByb3RvdHlwZS5mO1xucy5wcm90b3R5cGUuZ2V0PWZ1bmN0aW9uKGEpe2lmKDA+YXx8YT49dGhpcy5zaXplKCkpdGhyb3cgbmV3IGs7cmV0dXJuIHRoaXMuYVthXX07cy5wcm90b3R5cGUuZ2V0PXMucHJvdG90eXBlLmdldDtzLnByb3RvdHlwZS5nPWZ1bmN0aW9uKCl7cmV0dXJuIDA9PT10aGlzLmEubGVuZ3RofTtzLnByb3RvdHlwZS5pc0VtcHR5PXMucHJvdG90eXBlLmc7cy5wcm90b3R5cGUuc2l6ZT1mdW5jdGlvbigpe3JldHVybiB0aGlzLmEubGVuZ3RofTtzLnByb3RvdHlwZS5zaXplPXMucHJvdG90eXBlLnNpemU7cy5wcm90b3R5cGUuaD1mdW5jdGlvbigpe2Zvcih2YXIgYT1bXSxiPTAsYz10aGlzLmEubGVuZ3RoO2I8YztiKyspYS5wdXNoKHRoaXMuYVtiXSk7cmV0dXJuIGF9O3MucHJvdG90eXBlLnRvQXJyYXk9cy5wcm90b3R5cGUuaDtcbnMucHJvdG90eXBlLnJlbW92ZT1mdW5jdGlvbihhKXtmb3IodmFyIGI9ITEsYz0wLGQ9dGhpcy5hLmxlbmd0aDtjPGQ7YysrKWlmKHRoaXMuYVtjXT09PWEpe3RoaXMuYS5zcGxpY2UoYywxKTtiPSEwO2JyZWFrfXJldHVybiBifTtzLnByb3RvdHlwZS5yZW1vdmU9cy5wcm90b3R5cGUucmVtb3ZlO2Z1bmN0aW9uIHUoYSl7dGhpcy5qPWF9ZihcIiRqc2NvbXAuc2NvcGUuSXRlcmF0b3JfXCIsdSk7dS5wcm90b3R5cGUuaj1udWxsO3UucHJvdG90eXBlLmI9MDt1LnByb3RvdHlwZS5uZXh0PWZ1bmN0aW9uKCl7aWYodGhpcy5iPT09dGhpcy5qLnNpemUoKSl0aHJvdyBuZXcgcTtyZXR1cm4gdGhpcy5qLmdldCh0aGlzLmIrKyl9O3UucHJvdG90eXBlLm5leHQ9dS5wcm90b3R5cGUubmV4dDt1LnByb3RvdHlwZS5jPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuYjx0aGlzLmouc2l6ZSgpPyEwOiExfTt1LnByb3RvdHlwZS5oYXNOZXh0PXUucHJvdG90eXBlLmM7XG51LnByb3RvdHlwZS5yZW1vdmU9ZnVuY3Rpb24oKXt0aHJvdyBuZXcgcjt9O3UucHJvdG90eXBlLnJlbW92ZT11LnByb3RvdHlwZS5yZW1vdmU7ZnVuY3Rpb24gdigpe31mKFwiamF2YXNjcmlwdC51dGlsLkFycmF5c1wiLHYpO1xudi5zb3J0PWZ1bmN0aW9uKCl7dmFyIGE9YXJndW1lbnRzWzBdLGIsYyxkO2lmKDE9PT1hcmd1bWVudHMubGVuZ3RoKWEuc29ydCgpO2Vsc2UgaWYoMj09PWFyZ3VtZW50cy5sZW5ndGgpYz1hcmd1bWVudHNbMV0sZD1mdW5jdGlvbihhLGIpe3JldHVybiBjLmNvbXBhcmUoYSxiKX0sYS5zb3J0KGQpO2Vsc2UgaWYoMz09PWFyZ3VtZW50cy5sZW5ndGgpZm9yKGI9YS5zbGljZShhcmd1bWVudHNbMV0sYXJndW1lbnRzWzJdKSxiLnNvcnQoKSxkPWEuc2xpY2UoMCxhcmd1bWVudHNbMV0pLmNvbmNhdChiLGEuc2xpY2UoYXJndW1lbnRzWzJdLGEubGVuZ3RoKSksYS5zcGxpY2UoMCxhLmxlbmd0aCksYj0wO2I8ZC5sZW5ndGg7YisrKWEucHVzaChkW2JdKTtlbHNlIGlmKDQ9PT1hcmd1bWVudHMubGVuZ3RoKWZvcihiPWEuc2xpY2UoYXJndW1lbnRzWzFdLGFyZ3VtZW50c1syXSksYz1hcmd1bWVudHNbM10sZD1mdW5jdGlvbihhLGIpe3JldHVybiBjLmNvbXBhcmUoYSxiKX0sYi5zb3J0KGQpLFxuZD1hLnNsaWNlKDAsYXJndW1lbnRzWzFdKS5jb25jYXQoYixhLnNsaWNlKGFyZ3VtZW50c1syXSxhLmxlbmd0aCkpLGEuc3BsaWNlKDAsYS5sZW5ndGgpLGI9MDtiPGQubGVuZ3RoO2IrKylhLnB1c2goZFtiXSl9O3YuYXNMaXN0PWZ1bmN0aW9uKGEpe2Zvcih2YXIgYj1uZXcgcyxjPTAsZD1hLmxlbmd0aDtjPGQ7YysrKWIuYWRkKGFbY10pO3JldHVybiBifTtmdW5jdGlvbiB3KCl7dGhpcy5pPXt9fWcodyxwKTtmKFwiamF2YXNjcmlwdC51dGlsLkhhc2hNYXBcIix3KTt3LnByb3RvdHlwZS5pPW51bGw7dy5wcm90b3R5cGUuZ2V0PWZ1bmN0aW9uKGEpe3JldHVybiB0aGlzLmlbYV18fG51bGx9O3cucHJvdG90eXBlLmdldD13LnByb3RvdHlwZS5nZXQ7dy5wcm90b3R5cGUucHV0PWZ1bmN0aW9uKGEsYil7cmV0dXJuIHRoaXMuaVthXT1ifTt3LnByb3RvdHlwZS5wdXQ9dy5wcm90b3R5cGUucHV0O3cucHJvdG90eXBlLm09ZnVuY3Rpb24oKXt2YXIgYT1uZXcgcyxiO2ZvcihiIGluIHRoaXMuaSl0aGlzLmkuaGFzT3duUHJvcGVydHkoYikmJmEuYWRkKHRoaXMuaVtiXSk7cmV0dXJuIGF9O3cucHJvdG90eXBlLnZhbHVlcz13LnByb3RvdHlwZS5tO3cucHJvdG90eXBlLnNpemU9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5tKCkuc2l6ZSgpfTt3LnByb3RvdHlwZS5zaXplPXcucHJvdG90eXBlLnNpemU7ZnVuY3Rpb24geCgpe31nKHgsbSk7ZihcImphdmFzY3JpcHQudXRpbC5TZXRcIix4KTtmdW5jdGlvbiB5KGEpe3RoaXMuYT1bXTthIGluc3RhbmNlb2YgbSYmdGhpcy5lKGEpfWcoeSx4KTtmKFwiamF2YXNjcmlwdC51dGlsLkhhc2hTZXRcIix5KTt5LnByb3RvdHlwZS5hPW51bGw7eS5wcm90b3R5cGUuY29udGFpbnM9ZnVuY3Rpb24oYSl7Zm9yKHZhciBiPTAsYz10aGlzLmEubGVuZ3RoO2I8YztiKyspaWYodGhpcy5hW2JdPT09YSlyZXR1cm4hMDtyZXR1cm4hMX07eS5wcm90b3R5cGUuY29udGFpbnM9eS5wcm90b3R5cGUuY29udGFpbnM7eS5wcm90b3R5cGUuYWRkPWZ1bmN0aW9uKGEpe2lmKHRoaXMuY29udGFpbnMoYSkpcmV0dXJuITE7dGhpcy5hLnB1c2goYSk7cmV0dXJuITB9O3kucHJvdG90eXBlLmFkZD15LnByb3RvdHlwZS5hZGQ7eS5wcm90b3R5cGUuZT1mdW5jdGlvbihhKXtmb3IoYT1hLmYoKTthLmMoKTspdGhpcy5hZGQoYS5uZXh0KCkpO3JldHVybiEwfTt5LnByb3RvdHlwZS5hZGRBbGw9eS5wcm90b3R5cGUuZTtcbnkucHJvdG90eXBlLnJlbW92ZT1mdW5jdGlvbigpe3Rocm93IG5ldyByO307eS5wcm90b3R5cGUucmVtb3ZlPXkucHJvdG90eXBlLnJlbW92ZTt5LnByb3RvdHlwZS5zaXplPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuYS5sZW5ndGh9O3kucHJvdG90eXBlLmc9ZnVuY3Rpb24oKXtyZXR1cm4gMD09PXRoaXMuYS5sZW5ndGh9O3kucHJvdG90eXBlLmlzRW1wdHk9eS5wcm90b3R5cGUuZzt5LnByb3RvdHlwZS5oPWZ1bmN0aW9uKCl7Zm9yKHZhciBhPVtdLGI9MCxjPXRoaXMuYS5sZW5ndGg7YjxjO2IrKylhLnB1c2godGhpcy5hW2JdKTtyZXR1cm4gYX07eS5wcm90b3R5cGUudG9BcnJheT15LnByb3RvdHlwZS5oO3kucHJvdG90eXBlLmY9ZnVuY3Rpb24oKXtyZXR1cm4gbmV3IHoodGhpcyl9O3kucHJvdG90eXBlLml0ZXJhdG9yPXkucHJvdG90eXBlLmY7ZnVuY3Rpb24geihhKXt0aGlzLms9YX1mKFwiJGpzY29tcC5zY29wZS5JdGVyYXRvcl8kMVwiLHopO3oucHJvdG90eXBlLms9bnVsbDtcbnoucHJvdG90eXBlLmI9MDt6LnByb3RvdHlwZS5uZXh0PWZ1bmN0aW9uKCl7aWYodGhpcy5iPT09dGhpcy5rLnNpemUoKSl0aHJvdyBuZXcgcTtyZXR1cm4gdGhpcy5rLmFbdGhpcy5iKytdfTt6LnByb3RvdHlwZS5uZXh0PXoucHJvdG90eXBlLm5leHQ7ei5wcm90b3R5cGUuYz1mdW5jdGlvbigpe3JldHVybiB0aGlzLmI8dGhpcy5rLnNpemUoKT8hMDohMX07ei5wcm90b3R5cGUuaGFzTmV4dD16LnByb3RvdHlwZS5jO3oucHJvdG90eXBlLnJlbW92ZT1mdW5jdGlvbigpe3Rocm93IG5ldyByO307ei5wcm90b3R5cGUucmVtb3ZlPXoucHJvdG90eXBlLnJlbW92ZTtmdW5jdGlvbiBBKCl7fWcoQSxwKTtmKFwiamF2YXNjcmlwdC51dGlsLlNvcnRlZE1hcFwiLEEpO2Z1bmN0aW9uIEIoKXt9ZyhCLHgpO2YoXCJqYXZhc2NyaXB0LnV0aWwuU29ydGVkU2V0XCIsQik7ZnVuY3Rpb24gQygpe3RoaXMuYT1bXX1nKEMsbik7ZihcImphdmFzY3JpcHQudXRpbC5TdGFja1wiLEMpO0MucHJvdG90eXBlLmE9bnVsbDtDLnByb3RvdHlwZS5wdXNoPWZ1bmN0aW9uKGEpe3RoaXMuYS5wdXNoKGEpO3JldHVybiBhfTtDLnByb3RvdHlwZS5wdXNoPUMucHJvdG90eXBlLnB1c2g7Qy5wcm90b3R5cGUucG9wPWZ1bmN0aW9uKCl7aWYoMD09PXRoaXMuYS5sZW5ndGgpdGhyb3cgbmV3IGg7cmV0dXJuIHRoaXMuYS5wb3AoKX07Qy5wcm90b3R5cGUucG9wPUMucHJvdG90eXBlLnBvcDtDLnByb3RvdHlwZS5vPWZ1bmN0aW9uKCl7aWYoMD09PXRoaXMuYS5sZW5ndGgpdGhyb3cgbmV3IGg7cmV0dXJuIHRoaXMuYVt0aGlzLmEubGVuZ3RoLTFdfTtDLnByb3RvdHlwZS5wZWVrPUMucHJvdG90eXBlLm87Qy5wcm90b3R5cGUuZW1wdHk9ZnVuY3Rpb24oKXtyZXR1cm4gMD09PXRoaXMuYS5sZW5ndGg/ITA6ITF9O0MucHJvdG90eXBlLmVtcHR5PUMucHJvdG90eXBlLmVtcHR5O1xuQy5wcm90b3R5cGUuZz1mdW5jdGlvbigpe3JldHVybiB0aGlzLmVtcHR5KCl9O0MucHJvdG90eXBlLmlzRW1wdHk9Qy5wcm90b3R5cGUuZztDLnByb3RvdHlwZS5zZWFyY2g9ZnVuY3Rpb24oYSl7cmV0dXJuIHRoaXMuYS5pbmRleE9mKGEpfTtDLnByb3RvdHlwZS5zZWFyY2g9Qy5wcm90b3R5cGUuc2VhcmNoO0MucHJvdG90eXBlLnNpemU9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5hLmxlbmd0aH07Qy5wcm90b3R5cGUuc2l6ZT1DLnByb3RvdHlwZS5zaXplO0MucHJvdG90eXBlLmg9ZnVuY3Rpb24oKXtmb3IodmFyIGE9W10sYj0wLGM9dGhpcy5hLmxlbmd0aDtiPGM7YisrKWEucHVzaCh0aGlzLmFbYl0pO3JldHVybiBhfTtDLnByb3RvdHlwZS50b0FycmF5PUMucHJvdG90eXBlLmg7ZnVuY3Rpb24gRChhKXtyZXR1cm4gbnVsbD09YT9udWxsOmEucGFyZW50fWZ1bmN0aW9uIEUoYSxiKXtudWxsIT09YSYmKGEuY29sb3I9Yil9ZnVuY3Rpb24gRihhKXtyZXR1cm4gbnVsbD09YT9udWxsOmEubGVmdH1mdW5jdGlvbiBHKGEpe3JldHVybiBudWxsPT1hP251bGw6YS5yaWdodH1mdW5jdGlvbiBIKCl7dGhpcy5kPW51bGw7dGhpcy5uPTB9ZyhILEEpO2YoXCJqYXZhc2NyaXB0LnV0aWwuVHJlZU1hcFwiLEgpO0gucHJvdG90eXBlLmdldD1mdW5jdGlvbihhKXtmb3IodmFyIGI9dGhpcy5kO251bGwhPT1iOyl7dmFyIGM9YS5jb21wYXJlVG8oYi5rZXkpO2lmKDA+YyliPWIubGVmdDtlbHNlIGlmKDA8YyliPWIucmlnaHQ7ZWxzZSByZXR1cm4gYi52YWx1ZX1yZXR1cm4gbnVsbH07SC5wcm90b3R5cGUuZ2V0PUgucHJvdG90eXBlLmdldDtcbkgucHJvdG90eXBlLnB1dD1mdW5jdGlvbihhLGIpe2lmKG51bGw9PT10aGlzLmQpcmV0dXJuIHRoaXMuZD17a2V5OmEsdmFsdWU6YixsZWZ0Om51bGwscmlnaHQ6bnVsbCxwYXJlbnQ6bnVsbCxjb2xvcjowfSx0aGlzLm49MSxudWxsO3ZhciBjPXRoaXMuZCxkLHQ7ZG8gaWYoZD1jLHQ9YS5jb21wYXJlVG8oYy5rZXkpLDA+dCljPWMubGVmdDtlbHNlIGlmKDA8dCljPWMucmlnaHQ7ZWxzZSByZXR1cm4gZD1jLnZhbHVlLGMudmFsdWU9YixkO3doaWxlKG51bGwhPT1jKTtjPXtrZXk6YSxsZWZ0Om51bGwscmlnaHQ6bnVsbCx2YWx1ZTpiLHBhcmVudDpkLGNvbG9yOjB9OzA+dD9kLmxlZnQ9YzpkLnJpZ2h0PWM7Zm9yKGMuY29sb3I9MTtudWxsIT1jJiZjIT10aGlzLmQmJjE9PWMucGFyZW50LmNvbG9yOylEKGMpPT1GKEQoRChjKSkpPyhkPUcoRChEKGMpKSksMT09KG51bGw9PWQ/MDpkLmNvbG9yKT8oRShEKGMpLDApLEUoZCwwKSxFKEQoRChjKSksMSksYz1EKEQoYykpKTooYz09RyhEKGMpKSYmXG4oYz1EKGMpLEkodGhpcyxjKSksRShEKGMpLDApLEUoRChEKGMpKSwxKSxKKHRoaXMsRChEKGMpKSkpKTooZD1GKEQoRChjKSkpLDE9PShudWxsPT1kPzA6ZC5jb2xvcik/KEUoRChjKSwwKSxFKGQsMCksRShEKEQoYykpLDEpLGM9RChEKGMpKSk6KGM9PUYoRChjKSkmJihjPUQoYyksSih0aGlzLGMpKSxFKEQoYyksMCksRShEKEQoYykpLDEpLEkodGhpcyxEKEQoYykpKSkpO3RoaXMuZC5jb2xvcj0wO3RoaXMubisrO3JldHVybiBudWxsfTtILnByb3RvdHlwZS5wdXQ9SC5wcm90b3R5cGUucHV0O0gucHJvdG90eXBlLm09ZnVuY3Rpb24oKXt2YXIgYT1uZXcgcyxiO2I9dGhpcy5kO2lmKG51bGwhPWIpZm9yKDtudWxsIT1iLmxlZnQ7KWI9Yi5sZWZ0O2lmKG51bGwhPT1iKWZvcihhLmFkZChiLnZhbHVlKTtudWxsIT09KGI9SyhiKSk7KWEuYWRkKGIudmFsdWUpO3JldHVybiBhfTtILnByb3RvdHlwZS52YWx1ZXM9SC5wcm90b3R5cGUubTtcbmZ1bmN0aW9uIEkoYSxiKXtpZihudWxsIT1iKXt2YXIgYz1iLnJpZ2h0O2IucmlnaHQ9Yy5sZWZ0O251bGwhPWMubGVmdCYmKGMubGVmdC5wYXJlbnQ9Yik7Yy5wYXJlbnQ9Yi5wYXJlbnQ7bnVsbD09Yi5wYXJlbnQ/YS5kPWM6Yi5wYXJlbnQubGVmdD09Yj9iLnBhcmVudC5sZWZ0PWM6Yi5wYXJlbnQucmlnaHQ9YztjLmxlZnQ9YjtiLnBhcmVudD1jfX1mdW5jdGlvbiBKKGEsYil7aWYobnVsbCE9Yil7dmFyIGM9Yi5sZWZ0O2IubGVmdD1jLnJpZ2h0O251bGwhPWMucmlnaHQmJihjLnJpZ2h0LnBhcmVudD1iKTtjLnBhcmVudD1iLnBhcmVudDtudWxsPT1iLnBhcmVudD9hLmQ9YzpiLnBhcmVudC5yaWdodD09Yj9iLnBhcmVudC5yaWdodD1jOmIucGFyZW50LmxlZnQ9YztjLnJpZ2h0PWI7Yi5wYXJlbnQ9Y319XG5mdW5jdGlvbiBLKGEpe2lmKG51bGw9PT1hKXJldHVybiBudWxsO2lmKG51bGwhPT1hLnJpZ2h0KWZvcih2YXIgYj1hLnJpZ2h0O251bGwhPT1iLmxlZnQ7KWI9Yi5sZWZ0O2Vsc2UgZm9yKGI9YS5wYXJlbnQ7bnVsbCE9PWImJmE9PT1iLnJpZ2h0OylhPWIsYj1iLnBhcmVudDtyZXR1cm4gYn1ILnByb3RvdHlwZS5zaXplPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMubn07SC5wcm90b3R5cGUuc2l6ZT1ILnByb3RvdHlwZS5zaXplO2Z1bmN0aW9uIEwoYSl7dGhpcy5hPVtdO2EgaW5zdGFuY2VvZiBtJiZ0aGlzLmUoYSl9ZyhMLEIpO2YoXCJqYXZhc2NyaXB0LnV0aWwuVHJlZVNldFwiLEwpO0wucHJvdG90eXBlLmE9bnVsbDtMLnByb3RvdHlwZS5jb250YWlucz1mdW5jdGlvbihhKXtmb3IodmFyIGI9MCxjPXRoaXMuYS5sZW5ndGg7YjxjO2IrKylpZigwPT09dGhpcy5hW2JdLmNvbXBhcmVUbyhhKSlyZXR1cm4hMDtyZXR1cm4hMX07TC5wcm90b3R5cGUuY29udGFpbnM9TC5wcm90b3R5cGUuY29udGFpbnM7TC5wcm90b3R5cGUuYWRkPWZ1bmN0aW9uKGEpe2lmKHRoaXMuY29udGFpbnMoYSkpcmV0dXJuITE7Zm9yKHZhciBiPTAsYz10aGlzLmEubGVuZ3RoO2I8YztiKyspaWYoMT09PXRoaXMuYVtiXS5jb21wYXJlVG8oYSkpcmV0dXJuIHRoaXMuYS5zcGxpY2UoYiwwLGEpLCEwO3RoaXMuYS5wdXNoKGEpO3JldHVybiEwfTtMLnByb3RvdHlwZS5hZGQ9TC5wcm90b3R5cGUuYWRkO1xuTC5wcm90b3R5cGUuZT1mdW5jdGlvbihhKXtmb3IoYT1hLmYoKTthLmMoKTspdGhpcy5hZGQoYS5uZXh0KCkpO3JldHVybiEwfTtMLnByb3RvdHlwZS5hZGRBbGw9TC5wcm90b3R5cGUuZTtMLnByb3RvdHlwZS5yZW1vdmU9ZnVuY3Rpb24oKXt0aHJvdyBuZXcgcjt9O0wucHJvdG90eXBlLnJlbW92ZT1MLnByb3RvdHlwZS5yZW1vdmU7TC5wcm90b3R5cGUuc2l6ZT1mdW5jdGlvbigpe3JldHVybiB0aGlzLmEubGVuZ3RofTtMLnByb3RvdHlwZS5zaXplPUwucHJvdG90eXBlLnNpemU7TC5wcm90b3R5cGUuZz1mdW5jdGlvbigpe3JldHVybiAwPT09dGhpcy5hLmxlbmd0aH07TC5wcm90b3R5cGUuaXNFbXB0eT1MLnByb3RvdHlwZS5nO0wucHJvdG90eXBlLmg9ZnVuY3Rpb24oKXtmb3IodmFyIGE9W10sYj0wLGM9dGhpcy5hLmxlbmd0aDtiPGM7YisrKWEucHVzaCh0aGlzLmFbYl0pO3JldHVybiBhfTtMLnByb3RvdHlwZS50b0FycmF5PUwucHJvdG90eXBlLmg7TC5wcm90b3R5cGUuZj1mdW5jdGlvbigpe3JldHVybiBuZXcgTih0aGlzKX07XG5MLnByb3RvdHlwZS5pdGVyYXRvcj1MLnByb3RvdHlwZS5mO2Z1bmN0aW9uIE4oYSl7dGhpcy5sPWF9ZihcIiRqc2NvbXAuc2NvcGUuSXRlcmF0b3JfJDJcIixOKTtOLnByb3RvdHlwZS5sPW51bGw7Ti5wcm90b3R5cGUuYj0wO04ucHJvdG90eXBlLm5leHQ9ZnVuY3Rpb24oKXtpZih0aGlzLmI9PT10aGlzLmwuc2l6ZSgpKXRocm93IG5ldyBxO3JldHVybiB0aGlzLmwuYVt0aGlzLmIrK119O04ucHJvdG90eXBlLm5leHQ9Ti5wcm90b3R5cGUubmV4dDtOLnByb3RvdHlwZS5jPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuYjx0aGlzLmwuc2l6ZSgpPyEwOiExfTtOLnByb3RvdHlwZS5oYXNOZXh0PU4ucHJvdG90eXBlLmM7Ti5wcm90b3R5cGUucmVtb3ZlPWZ1bmN0aW9uKCl7dGhyb3cgbmV3IHI7fTtOLnByb3RvdHlwZS5yZW1vdmU9Ti5wcm90b3R5cGUucmVtb3ZlO1widW5kZWZpbmVkXCIhPT10eXBlb2YgZ2xvYmFsJiYoZ2xvYmFsLmphdmFzY3JpcHQ9e30sZ2xvYmFsLmphdmFzY3JpcHQudXRpbD17fSxnbG9iYWwuamF2YXNjcmlwdC51dGlsLkFycmF5TGlzdD1zLGdsb2JhbC5qYXZhc2NyaXB0LnV0aWwuQXJyYXlzPXYsZ2xvYmFsLmphdmFzY3JpcHQudXRpbC5Db2xsZWN0aW9uPW0sZ2xvYmFsLmphdmFzY3JpcHQudXRpbC5FbXB0eVN0YWNrRXhjZXB0aW9uPWgsZ2xvYmFsLmphdmFzY3JpcHQudXRpbC5IYXNoTWFwPXcsZ2xvYmFsLmphdmFzY3JpcHQudXRpbC5IYXNoU2V0PXksZ2xvYmFsLmphdmFzY3JpcHQudXRpbC5JbmRleE91dE9mQm91bmRzRXhjZXB0aW9uPWssZ2xvYmFsLmphdmFzY3JpcHQudXRpbC5JdGVyYXRvcj1sLGdsb2JhbC5qYXZhc2NyaXB0LnV0aWwuTGlzdD1uLGdsb2JhbC5qYXZhc2NyaXB0LnV0aWwuTWFwPXAsZ2xvYmFsLmphdmFzY3JpcHQudXRpbC5Ob1N1Y2hFbGVtZW50RXhjZXB0aW9uPXEsZ2xvYmFsLmphdmFzY3JpcHQudXRpbC5PcGVyYXRpb25Ob3RTdXBwb3J0ZWQ9XG5yLGdsb2JhbC5qYXZhc2NyaXB0LnV0aWwuU2V0PXgsZ2xvYmFsLmphdmFzY3JpcHQudXRpbC5Tb3J0ZWRNYXA9QSxnbG9iYWwuamF2YXNjcmlwdC51dGlsLlNvcnRlZFNldD1CLGdsb2JhbC5qYXZhc2NyaXB0LnV0aWwuU3RhY2s9QyxnbG9iYWwuamF2YXNjcmlwdC51dGlsLlRyZWVNYXA9SCxnbG9iYWwuamF2YXNjcmlwdC51dGlsLlRyZWVTZXQ9TCk7fSkuY2FsbCh0aGlzKTtcbiIsInJlcXVpcmUoJy4vZGlzdC9qYXZhc2NyaXB0LnV0aWwtbm9kZS5taW4uanMnKTtcbiIsIi8qKlxuICogVGFrZXMgb25lIG9yIG1vcmUge0BsaW5rIEZlYXR1cmV8RmVhdHVyZXN9IGFuZCBjcmVhdGVzIGEge0BsaW5rIEZlYXR1cmVDb2xsZWN0aW9ufVxuICpcbiAqIEBtb2R1bGUgdHVyZi9mZWF0dXJlY29sbGVjdGlvblxuICogQGNhdGVnb3J5IGhlbHBlclxuICogQHBhcmFtIHtGZWF0dXJlfSBmZWF0dXJlcyBpbnB1dCBGZWF0dXJlc1xuICogQHJldHVybnMge0ZlYXR1cmVDb2xsZWN0aW9ufSBhIEZlYXR1cmVDb2xsZWN0aW9uIG9mIGlucHV0IGZlYXR1cmVzXG4gKiBAZXhhbXBsZVxuICogdmFyIGZlYXR1cmVzID0gW1xuICogIHR1cmYucG9pbnQoWy03NS4zNDMsIDM5Ljk4NF0sIHtuYW1lOiAnTG9jYXRpb24gQSd9KSxcbiAqICB0dXJmLnBvaW50KFstNzUuODMzLCAzOS4yODRdLCB7bmFtZTogJ0xvY2F0aW9uIEInfSksXG4gKiAgdHVyZi5wb2ludChbLTc1LjUzNCwgMzkuMTIzXSwge25hbWU6ICdMb2NhdGlvbiBDJ30pXG4gKiBdO1xuICpcbiAqIHZhciBmYyA9IHR1cmYuZmVhdHVyZWNvbGxlY3Rpb24oZmVhdHVyZXMpO1xuICpcbiAqIC8vPWZjXG4gKi9cbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oZmVhdHVyZXMpe1xuICByZXR1cm4ge1xuICAgIHR5cGU6IFwiRmVhdHVyZUNvbGxlY3Rpb25cIixcbiAgICBmZWF0dXJlczogZmVhdHVyZXNcbiAgfTtcbn07XG4iLCJ2YXIgaW5zaWRlID0gcmVxdWlyZSgndHVyZi1pbnNpZGUnKTtcbnZhciBmZWF0dXJlQ29sbGVjdGlvbiA9IHJlcXVpcmUoJ3R1cmYtZmVhdHVyZWNvbGxlY3Rpb24nKTtcblxuLyoqXG4gKiBUYWtlcyBhIHtAbGluayBGZWF0dXJlQ29sbGVjdGlvbn0gb2Yge0BsaW5rIFBvaW50fSBmZWF0dXJlcyBhbmQgYSBGZWF0dXJlQ29sbGVjdGlvbiBvZiB7QGxpbmsgUG9seWdvbn0gZmVhdHVyZXMgYW5kIHJldHVybnMgYSBGZWF0dXJlQ29sbGVjdGlvbiBvZiBQb2ludCBmZWF0dXJlcyByZXByZXNlbnRpbmcgYWxsIHBvaW50cyB0aGF0IGZhbGwgd2l0aGluIGEgY29sbGVjdGlvbiBvZiBwb2x5Z29ucy5cbiAqXG4gKiBAbW9kdWxlIHR1cmYvd2l0aGluXG4gKiBAY2F0ZWdvcnkgam9pbnNcbiAqIEBwYXJhbSB7RmVhdHVyZUNvbGxlY3Rpb259IHBvaW50cyBhIEZlYXR1cmVDb2xsZWN0aW9uIG9mIHtAbGluayBQb2ludH0gZmVhdHVyZXNcbiAqIEBwYXJhbSB7RmVhdHVyZUNvbGxlY3Rpb259IHBvbHlnb25zIGEgRmVhdHVyZUNvbGxlY3Rpb24gb2Yge0BsaW5rIFBvbHlnb259IGZlYXR1cmVzXG4gKiBAcmV0dXJuIHtGZWF0dXJlQ29sbGVjdGlvbn0gYSBjb2xsZWN0aW9uIG9mIGFsbCBwb2ludHMgdGhhdCBsYW5kXG4gKiB3aXRoaW4gYXQgbGVhc3Qgb25lIHBvbHlnb25cbiAqIEBleGFtcGxlXG4gKiB2YXIgc2VhcmNoV2l0aGluID0ge1xuICogICBcInR5cGVcIjogXCJGZWF0dXJlQ29sbGVjdGlvblwiLFxuICogICBcImZlYXR1cmVzXCI6IFtcbiAqICAgICB7XG4gKiAgICAgICBcInR5cGVcIjogXCJGZWF0dXJlXCIsXG4gKiAgICAgICBcInByb3BlcnRpZXNcIjoge30sXG4gKiAgICAgICBcImdlb21ldHJ5XCI6IHtcbiAqICAgICAgICAgXCJ0eXBlXCI6IFwiUG9seWdvblwiLFxuICogICAgICAgICBcImNvb3JkaW5hdGVzXCI6IFtbXG4gKiAgICAgICAgICAgWy00Ni42NTMsLTIzLjU0M10sXG4gKiAgICAgICAgICAgWy00Ni42MzQsLTIzLjUzNDZdLFxuICogICAgICAgICAgIFstNDYuNjEzLC0yMy41NDNdLFxuICogICAgICAgICAgIFstNDYuNjE0LC0yMy41NTldLFxuICogICAgICAgICAgIFstNDYuNjMxLC0yMy41NjddLFxuICogICAgICAgICAgIFstNDYuNjUzLC0yMy41NjBdLFxuICogICAgICAgICAgIFstNDYuNjUzLC0yMy41NDNdXG4gKiAgICAgICAgIF1dXG4gKiAgICAgICB9XG4gKiAgICAgfVxuICogICBdXG4gKiB9O1xuICogdmFyIHBvaW50cyA9IHtcbiAqICAgXCJ0eXBlXCI6IFwiRmVhdHVyZUNvbGxlY3Rpb25cIixcbiAqICAgXCJmZWF0dXJlc1wiOiBbXG4gKiAgICAge1xuICogICAgICAgXCJ0eXBlXCI6IFwiRmVhdHVyZVwiLFxuICogICAgICAgXCJwcm9wZXJ0aWVzXCI6IHt9LFxuICogICAgICAgXCJnZW9tZXRyeVwiOiB7XG4gKiAgICAgICAgIFwidHlwZVwiOiBcIlBvaW50XCIsXG4gKiAgICAgICAgIFwiY29vcmRpbmF0ZXNcIjogWy00Ni42MzE4LCAtMjMuNTUyM11cbiAqICAgICAgIH1cbiAqICAgICB9LCB7XG4gKiAgICAgICBcInR5cGVcIjogXCJGZWF0dXJlXCIsXG4gKiAgICAgICBcInByb3BlcnRpZXNcIjoge30sXG4gKiAgICAgICBcImdlb21ldHJ5XCI6IHtcbiAqICAgICAgICAgXCJ0eXBlXCI6IFwiUG9pbnRcIixcbiAqICAgICAgICAgXCJjb29yZGluYXRlc1wiOiBbLTQ2LjYyNDYsIC0yMy41MzI1XVxuICogICAgICAgfVxuICogICAgIH0sIHtcbiAqICAgICAgIFwidHlwZVwiOiBcIkZlYXR1cmVcIixcbiAqICAgICAgIFwicHJvcGVydGllc1wiOiB7fSxcbiAqICAgICAgIFwiZ2VvbWV0cnlcIjoge1xuICogICAgICAgICBcInR5cGVcIjogXCJQb2ludFwiLFxuICogICAgICAgICBcImNvb3JkaW5hdGVzXCI6IFstNDYuNjA2MiwgLTIzLjU1MTNdXG4gKiAgICAgICB9XG4gKiAgICAgfSwge1xuICogICAgICAgXCJ0eXBlXCI6IFwiRmVhdHVyZVwiLFxuICogICAgICAgXCJwcm9wZXJ0aWVzXCI6IHt9LFxuICogICAgICAgXCJnZW9tZXRyeVwiOiB7XG4gKiAgICAgICAgIFwidHlwZVwiOiBcIlBvaW50XCIsXG4gKiAgICAgICAgIFwiY29vcmRpbmF0ZXNcIjogWy00Ni42NjMsIC0yMy41NTRdXG4gKiAgICAgICB9XG4gKiAgICAgfSwge1xuICogICAgICAgXCJ0eXBlXCI6IFwiRmVhdHVyZVwiLFxuICogICAgICAgXCJwcm9wZXJ0aWVzXCI6IHt9LFxuICogICAgICAgXCJnZW9tZXRyeVwiOiB7XG4gKiAgICAgICAgIFwidHlwZVwiOiBcIlBvaW50XCIsXG4gKiAgICAgICAgIFwiY29vcmRpbmF0ZXNcIjogWy00Ni42NDMsIC0yMy41NTddXG4gKiAgICAgICB9XG4gKiAgICAgfVxuICogICBdXG4gKiB9O1xuICpcbiAqIHZhciBwdHNXaXRoaW4gPSB0dXJmLndpdGhpbihwb2ludHMsIHNlYXJjaFdpdGhpbik7XG4gKlxuICogLy89cG9pbnRzXG4gKlxuICogLy89c2VhcmNoV2l0aGluXG4gKlxuICogLy89cHRzV2l0aGluXG4gKi9cbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24ocHRGQywgcG9seUZDKXtcbiAgdmFyIHBvaW50c1dpdGhpbiA9IGZlYXR1cmVDb2xsZWN0aW9uKFtdKTtcbiAgZm9yICh2YXIgaSA9IDA7IGkgPCBwb2x5RkMuZmVhdHVyZXMubGVuZ3RoOyBpKyspIHtcbiAgICBmb3IgKHZhciBqID0gMDsgaiA8IHB0RkMuZmVhdHVyZXMubGVuZ3RoOyBqKyspIHtcbiAgICAgIHZhciBpc0luc2lkZSA9IGluc2lkZShwdEZDLmZlYXR1cmVzW2pdLCBwb2x5RkMuZmVhdHVyZXNbaV0pO1xuICAgICAgaWYoaXNJbnNpZGUpe1xuICAgICAgICBwb2ludHNXaXRoaW4uZmVhdHVyZXMucHVzaChwdEZDLmZlYXR1cmVzW2pdKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cbiAgcmV0dXJuIHBvaW50c1dpdGhpbjtcbn07XG4iLCIvLyBodHRwOi8vZW4ud2lraXBlZGlhLm9yZy93aWtpL0V2ZW4lRTIlODAlOTNvZGRfcnVsZVxuLy8gbW9kaWZpZWQgZnJvbTogaHR0cHM6Ly9naXRodWIuY29tL3N1YnN0YWNrL3BvaW50LWluLXBvbHlnb24vYmxvYi9tYXN0ZXIvaW5kZXguanNcbi8vIHdoaWNoIHdhcyBtb2RpZmllZCBmcm9tIGh0dHA6Ly93d3cuZWNzZS5ycGkuZWR1L0hvbWVwYWdlcy93cmYvUmVzZWFyY2gvU2hvcnRfTm90ZXMvcG5wb2x5Lmh0bWxcblxuLyoqXG4gKiBUYWtlcyBhIHtAbGluayBQb2ludH0gZmVhdHVyZSBhbmQgYSB7QGxpbmsgUG9seWdvbn0gZmVhdHVyZSBhbmQgZGV0ZXJtaW5lcyBpZiB0aGUgUG9pbnQgcmVzaWRlcyBpbnNpZGUgdGhlIFBvbHlnb24uIFRoZSBQb2x5Z29uIGNhblxuICogYmUgY29udmV4IG9yIGNvbmNhdmUuIFRoZSBmdW5jdGlvbiBhY2NlcHRzIGFueSB2YWxpZCBQb2x5Z29uIG9yIHtAbGluayBNdWx0aVBvbHlnb259XG4gKiBhbmQgYWNjb3VudHMgZm9yIGhvbGVzLlxuICpcbiAqIEBtb2R1bGUgdHVyZi9pbnNpZGVcbiAqIEBjYXRlZ29yeSBqb2luc1xuICogQHBhcmFtIHtQb2ludH0gcG9pbnQgYSBQb2ludCBmZWF0dXJlXG4gKiBAcGFyYW0ge1BvbHlnb259IHBvbHlnb24gYSBQb2x5Z29uIGZlYXR1cmVcbiAqIEByZXR1cm4ge0Jvb2xlYW59IGB0cnVlYCBpZiB0aGUgUG9pbnQgaXMgaW5zaWRlIHRoZSBQb2x5Z29uOyBgZmFsc2VgIGlmIHRoZSBQb2ludCBpcyBub3QgaW5zaWRlIHRoZSBQb2x5Z29uXG4gKiBAZXhhbXBsZVxuICogdmFyIHB0MSA9IHtcbiAqICAgXCJ0eXBlXCI6IFwiRmVhdHVyZVwiLFxuICogICBcInByb3BlcnRpZXNcIjoge1xuICogICAgIFwibWFya2VyLWNvbG9yXCI6IFwiI2YwMFwiXG4gKiAgIH0sXG4gKiAgIFwiZ2VvbWV0cnlcIjoge1xuICogICAgIFwidHlwZVwiOiBcIlBvaW50XCIsXG4gKiAgICAgXCJjb29yZGluYXRlc1wiOiBbLTExMS40NjcyODUsIDQwLjc1NzY2XVxuICogICB9XG4gKiB9O1xuICogdmFyIHB0MiA9IHtcbiAqICAgXCJ0eXBlXCI6IFwiRmVhdHVyZVwiLFxuICogICBcInByb3BlcnRpZXNcIjoge1xuICogICAgIFwibWFya2VyLWNvbG9yXCI6IFwiIzBmMFwiXG4gKiAgIH0sXG4gKiAgIFwiZ2VvbWV0cnlcIjoge1xuICogICAgIFwidHlwZVwiOiBcIlBvaW50XCIsXG4gKiAgICAgXCJjb29yZGluYXRlc1wiOiBbLTExMS44NzM3NzksIDQwLjY0NzMwM11cbiAqICAgfVxuICogfTtcbiAqIHZhciBwb2x5ID0ge1xuICogICBcInR5cGVcIjogXCJGZWF0dXJlXCIsXG4gKiAgIFwicHJvcGVydGllc1wiOiB7fSxcbiAqICAgXCJnZW9tZXRyeVwiOiB7XG4gKiAgICAgXCJ0eXBlXCI6IFwiUG9seWdvblwiLFxuICogICAgIFwiY29vcmRpbmF0ZXNcIjogW1tcbiAqICAgICAgIFstMTEyLjA3NDI3OSwgNDAuNTIyMTVdLFxuICogICAgICAgWy0xMTIuMDc0Mjc5LCA0MC44NTMyOTNdLFxuICogICAgICAgWy0xMTEuNjEwMTA3LCA0MC44NTMyOTNdLFxuICogICAgICAgWy0xMTEuNjEwMTA3LCA0MC41MjIxNV0sXG4gKiAgICAgICBbLTExMi4wNzQyNzksIDQwLjUyMjE1XVxuICogICAgIF1dXG4gKiAgIH1cbiAqIH07XG4gKlxuICogdmFyIGZlYXR1cmVzID0ge1xuICogICBcInR5cGVcIjogXCJGZWF0dXJlQ29sbGVjdGlvblwiLFxuICogICBcImZlYXR1cmVzXCI6IFtwdDEsIHB0MiwgcG9seV1cbiAqIH07XG4gKlxuICogLy89ZmVhdHVyZXNcbiAqXG4gKiB2YXIgaXNJbnNpZGUxID0gdHVyZi5pbnNpZGUocHQxLCBwb2x5KTtcbiAqIC8vPWlzSW5zaWRlMVxuICpcbiAqIHZhciBpc0luc2lkZTIgPSB0dXJmLmluc2lkZShwdDIsIHBvbHkpO1xuICogLy89aXNJbnNpZGUyXG4gKi9cbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24ocG9pbnQsIHBvbHlnb24pIHtcbiAgdmFyIHBvbHlzID0gcG9seWdvbi5nZW9tZXRyeS5jb29yZGluYXRlcztcbiAgdmFyIHB0ID0gW3BvaW50Lmdlb21ldHJ5LmNvb3JkaW5hdGVzWzBdLCBwb2ludC5nZW9tZXRyeS5jb29yZGluYXRlc1sxXV07XG4gIC8vIG5vcm1hbGl6ZSB0byBtdWx0aXBvbHlnb25cbiAgaWYocG9seWdvbi5nZW9tZXRyeS50eXBlID09PSAnUG9seWdvbicpIHBvbHlzID0gW3BvbHlzXTtcblxuICB2YXIgaW5zaWRlUG9seSA9IGZhbHNlO1xuICB2YXIgaSA9IDA7XG4gIHdoaWxlIChpIDwgcG9seXMubGVuZ3RoICYmICFpbnNpZGVQb2x5KSB7XG4gICAgLy8gY2hlY2sgaWYgaXQgaXMgaW4gdGhlIG91dGVyIHJpbmcgZmlyc3RcbiAgICBpZihpblJpbmcocHQsIHBvbHlzW2ldWzBdKSkge1xuICAgICAgdmFyIGluSG9sZSA9IGZhbHNlO1xuICAgICAgdmFyIGsgPSAxO1xuICAgICAgLy8gY2hlY2sgZm9yIHRoZSBwb2ludCBpbiBhbnkgb2YgdGhlIGhvbGVzXG4gICAgICB3aGlsZShrIDwgcG9seXNbaV0ubGVuZ3RoICYmICFpbkhvbGUpIHtcbiAgICAgICAgaWYoaW5SaW5nKHB0LCBwb2x5c1tpXVtrXSkpIHtcbiAgICAgICAgICBpbkhvbGUgPSB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIGsrKztcbiAgICAgIH1cbiAgICAgIGlmKCFpbkhvbGUpIGluc2lkZVBvbHkgPSB0cnVlO1xuICAgIH1cbiAgICBpKys7XG4gIH1cbiAgcmV0dXJuIGluc2lkZVBvbHk7XG59XG5cbi8vIHB0IGlzIFt4LHldIGFuZCByaW5nIGlzIFtbeCx5XSwgW3gseV0sLi5dXG5mdW5jdGlvbiBpblJpbmcgKHB0LCByaW5nKSB7XG4gIHZhciBpc0luc2lkZSA9IGZhbHNlO1xuICBmb3IgKHZhciBpID0gMCwgaiA9IHJpbmcubGVuZ3RoIC0gMTsgaSA8IHJpbmcubGVuZ3RoOyBqID0gaSsrKSB7XG4gICAgdmFyIHhpID0gcmluZ1tpXVswXSwgeWkgPSByaW5nW2ldWzFdO1xuICAgIHZhciB4aiA9IHJpbmdbal1bMF0sIHlqID0gcmluZ1tqXVsxXTtcbiAgICBcbiAgICB2YXIgaW50ZXJzZWN0ID0gKCh5aSA+IHB0WzFdKSAhPSAoeWogPiBwdFsxXSkpXG4gICAgICAgICYmIChwdFswXSA8ICh4aiAtIHhpKSAqIChwdFsxXSAtIHlpKSAvICh5aiAtIHlpKSArIHhpKTtcbiAgICBpZiAoaW50ZXJzZWN0KSBpc0luc2lkZSA9ICFpc0luc2lkZTtcbiAgfVxuICByZXR1cm4gaXNJbnNpZGU7XG59XG5cbiIsInZhciBidWZmZXIgPSByZXF1aXJlKCd0dXJmLWJ1ZmZlcicpO1xudmFyIHdpdGhpbiA9IHJlcXVpcmUoJ3R1cmYtd2l0aGluJyk7XG52YXIgZmMgPSByZXF1aXJlKCd0dXJmLWZlYXR1cmVjb2xsZWN0aW9uJyk7XG5cbnZhciAkID0gcmVxdWlyZSgnanF1ZXJ5Jyk7XG4vL3ZhciB0dXJmID0gcmVxdWlyZSgndHVyZicpO1xuXG52YXIgYmFzZVVSSSA9IHdpbmRvdy5sb2NhdGlvbi5ocmVmO1xuXG5MLm1hcGJveC5hY2Nlc3NUb2tlbiA9ICdway5leUoxSWpvaWMzSjBhSFZ5YldGdUlpd2lZU0k2SWtWR1h5MU5NSGNpZlEuRW91SU5ERVpHempHczB4MFZNaEh4Zyc7XG5cbnZhciBtYXAgPSBMLm1hcGJveC5tYXAoJ21hcCcsJ3NydGh1cm1hbi5uOWw3MWk4NicpXG4gICAgLnNldFZpZXcoWzM4LjkwMTA3OCwgLTc3LjAyNDM2MV0sIDE0KTtcbiAgICBcbnZhciB3bWF0YVJvdXRlcyA9IEwubWFwYm94LmZlYXR1cmVMYXllcigpXG4gICAgLmxvYWRVUkwoJ2h0dHBzOi8vdHJhbnNpdG5lYXJtZS1zcnRodXJtYW4uYzkuaW8vd21hdGFSb3V0ZXMnKVxuICAgIC5hZGRUbyhtYXApO1xuICAgIFxudmFyIG1hcmtlciA9IEwubWFya2VyKG5ldyBMLkxhdExuZygzOC45MDEwNzgsIC03Ny4wMjQzNjEpLCB7XG4gICAgaWNvbjogTC5tYXBib3gubWFya2VyLmljb24oe1xuICAgICAgICBcIm1hcmtlci1jb2xvclwiOiBcIiNGRjAwRkZcIixcbiAgICAgICAgXCJ0aXRsZVwiOiBcIllvdSBuZWVkIGNvZmZlZVwiLFxuICAgICAgICBcIm1hcmtlci1zeW1ib2xcIjogXCJwaXRjaFwiLFxuICAgICAgICBcIm1hcmtlci1zaXplXCI6IFwibGFyZ2VcIlxuICAgIH0pLFxuICAgIGRyYWdnYWJsZTogdHJ1ZSxcbiAgICB6SW5kZXhPZmZzZXQ6OTk5XG59KS5hZGRUbyhtYXApO1xuXG52YXIgYnVmZmVyTGF5ZXIgPSBMLm1hcGJveC5mZWF0dXJlTGF5ZXIoKS5hZGRUbyhtYXApO1xuXG52YXIgYnVmZmVyQ250ciA9IG1hcmtlci5nZXRMYXRMbmcoKTtcbnZhciBwdCA9IHtcbiAgXCJ0eXBlXCI6IFwiRmVhdHVyZVwiLFxuICBcInByb3BlcnRpZXNcIjoge30sXG4gIFwiZ2VvbWV0cnlcIjoge1xuICAgIFwidHlwZVwiOiBcIlBvaW50XCIsXG4gICAgXCJjb29yZGluYXRlc1wiOiBbYnVmZmVyQ250ci5sbmcsIGJ1ZmZlckNudHIubGF0XVxuICB9XG59O1xuXG52YXIgdHJhbnNpdEJ1ZmZlciA9IGJ1ZmZlcihwdCwgMC41LCAnbWlsZXMnKTtcblxudHJhbnNpdEJ1ZmZlci5wcm9wZXJ0aWVzID0ge1xuICAgICAgICAgICAgICAgIFwiZmlsbFwiOiBcIiMwMDcwNEFcIixcbiAgICAgICAgICAgICAgICBcImZpbGwtb3BhY2l0eVwiOjAuMDUsXG4gICAgICAgICAgICAgICAgXCJzdHJva2VcIjogXCIjMDA3MDRBXCIsXG4gICAgICAgICAgICAgICAgXCJzdHJva2Utd2lkdGhcIjogMixcbiAgICAgICAgICAgICAgICBcInN0cm9rZS1vcGFjaXR5XCI6IDAuNVxuICAgICAgICAgICAgfTtcblxuYnVmZmVyTGF5ZXIuc2V0R2VvSlNPTih0cmFuc2l0QnVmZmVyKTtcblxuLy9sb2FkIHN0b3BzIGFuZCBmaWx0ZXIgYmFzZWQgb24gYnVmZmVyXG52YXIgZmlsdGVyZWRTdG9wcyA9IEwubWFwYm94LmZlYXR1cmVMYXllcigpLmFkZFRvKG1hcCk7XG5cbiQuZ2V0KCdodHRwczovL3RyYW5zaXRuZWFybWUtc3J0aHVybWFuLmM5LmlvL3dtYXRhU3RvcHMnLCBmdW5jdGlvbihkYXRhKSB7XG4gICAgdmFyIHN0b3BzID0gd2l0aGluKGRhdGEsIGZjKFt0cmFuc2l0QnVmZmVyXSkpO1xuICAgIGZpbHRlcmVkU3RvcHMuc2V0R2VvSlNPTihzdG9wcyk7XG59KTsiXX0=
