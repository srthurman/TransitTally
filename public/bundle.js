(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
/*!
 * jQuery JavaScript Library v2.1.4
 * http://jquery.com/
 *
 * Includes Sizzle.js
 * http://sizzlejs.com/
 *
 * Copyright 2005, 2014 jQuery Foundation, Inc. and other contributors
 * Released under the MIT license
 * http://jquery.org/license
 *
 * Date: 2015-04-28T16:01Z
 */

(function( global, factory ) {

	if ( typeof module === "object" && typeof module.exports === "object" ) {
		// For CommonJS and CommonJS-like environments where a proper `window`
		// is present, execute the factory and get jQuery.
		// For environments that do not have a `window` with a `document`
		// (such as Node.js), expose a factory as module.exports.
		// This accentuates the need for the creation of a real `window`.
		// e.g. var jQuery = require("jquery")(window);
		// See ticket #14549 for more info.
		module.exports = global.document ?
			factory( global, true ) :
			function( w ) {
				if ( !w.document ) {
					throw new Error( "jQuery requires a window with a document" );
				}
				return factory( w );
			};
	} else {
		factory( global );
	}

// Pass this if window is not defined yet
}(typeof window !== "undefined" ? window : this, function( window, noGlobal ) {

// Support: Firefox 18+
// Can't be in strict mode, several libs including ASP.NET trace
// the stack via arguments.caller.callee and Firefox dies if
// you try to trace through "use strict" call chains. (#13335)
//

var arr = [];

var slice = arr.slice;

var concat = arr.concat;

var push = arr.push;

var indexOf = arr.indexOf;

var class2type = {};

var toString = class2type.toString;

var hasOwn = class2type.hasOwnProperty;

var support = {};



var
	// Use the correct document accordingly with window argument (sandbox)
	document = window.document,

	version = "2.1.4",

	// Define a local copy of jQuery
	jQuery = function( selector, context ) {
		// The jQuery object is actually just the init constructor 'enhanced'
		// Need init if jQuery is called (just allow error to be thrown if not included)
		return new jQuery.fn.init( selector, context );
	},

	// Support: Android<4.1
	// Make sure we trim BOM and NBSP
	rtrim = /^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,

	// Matches dashed string for camelizing
	rmsPrefix = /^-ms-/,
	rdashAlpha = /-([\da-z])/gi,

	// Used by jQuery.camelCase as callback to replace()
	fcamelCase = function( all, letter ) {
		return letter.toUpperCase();
	};

jQuery.fn = jQuery.prototype = {
	// The current version of jQuery being used
	jquery: version,

	constructor: jQuery,

	// Start with an empty selector
	selector: "",

	// The default length of a jQuery object is 0
	length: 0,

	toArray: function() {
		return slice.call( this );
	},

	// Get the Nth element in the matched element set OR
	// Get the whole matched element set as a clean array
	get: function( num ) {
		return num != null ?

			// Return just the one element from the set
			( num < 0 ? this[ num + this.length ] : this[ num ] ) :

			// Return all the elements in a clean array
			slice.call( this );
	},

	// Take an array of elements and push it onto the stack
	// (returning the new matched element set)
	pushStack: function( elems ) {

		// Build a new jQuery matched element set
		var ret = jQuery.merge( this.constructor(), elems );

		// Add the old object onto the stack (as a reference)
		ret.prevObject = this;
		ret.context = this.context;

		// Return the newly-formed element set
		return ret;
	},

	// Execute a callback for every element in the matched set.
	// (You can seed the arguments with an array of args, but this is
	// only used internally.)
	each: function( callback, args ) {
		return jQuery.each( this, callback, args );
	},

	map: function( callback ) {
		return this.pushStack( jQuery.map(this, function( elem, i ) {
			return callback.call( elem, i, elem );
		}));
	},

	slice: function() {
		return this.pushStack( slice.apply( this, arguments ) );
	},

	first: function() {
		return this.eq( 0 );
	},

	last: function() {
		return this.eq( -1 );
	},

	eq: function( i ) {
		var len = this.length,
			j = +i + ( i < 0 ? len : 0 );
		return this.pushStack( j >= 0 && j < len ? [ this[j] ] : [] );
	},

	end: function() {
		return this.prevObject || this.constructor(null);
	},

	// For internal use only.
	// Behaves like an Array's method, not like a jQuery method.
	push: push,
	sort: arr.sort,
	splice: arr.splice
};

jQuery.extend = jQuery.fn.extend = function() {
	var options, name, src, copy, copyIsArray, clone,
		target = arguments[0] || {},
		i = 1,
		length = arguments.length,
		deep = false;

	// Handle a deep copy situation
	if ( typeof target === "boolean" ) {
		deep = target;

		// Skip the boolean and the target
		target = arguments[ i ] || {};
		i++;
	}

	// Handle case when target is a string or something (possible in deep copy)
	if ( typeof target !== "object" && !jQuery.isFunction(target) ) {
		target = {};
	}

	// Extend jQuery itself if only one argument is passed
	if ( i === length ) {
		target = this;
		i--;
	}

	for ( ; i < length; i++ ) {
		// Only deal with non-null/undefined values
		if ( (options = arguments[ i ]) != null ) {
			// Extend the base object
			for ( name in options ) {
				src = target[ name ];
				copy = options[ name ];

				// Prevent never-ending loop
				if ( target === copy ) {
					continue;
				}

				// Recurse if we're merging plain objects or arrays
				if ( deep && copy && ( jQuery.isPlainObject(copy) || (copyIsArray = jQuery.isArray(copy)) ) ) {
					if ( copyIsArray ) {
						copyIsArray = false;
						clone = src && jQuery.isArray(src) ? src : [];

					} else {
						clone = src && jQuery.isPlainObject(src) ? src : {};
					}

					// Never move original objects, clone them
					target[ name ] = jQuery.extend( deep, clone, copy );

				// Don't bring in undefined values
				} else if ( copy !== undefined ) {
					target[ name ] = copy;
				}
			}
		}
	}

	// Return the modified object
	return target;
};

jQuery.extend({
	// Unique for each copy of jQuery on the page
	expando: "jQuery" + ( version + Math.random() ).replace( /\D/g, "" ),

	// Assume jQuery is ready without the ready module
	isReady: true,

	error: function( msg ) {
		throw new Error( msg );
	},

	noop: function() {},

	isFunction: function( obj ) {
		return jQuery.type(obj) === "function";
	},

	isArray: Array.isArray,

	isWindow: function( obj ) {
		return obj != null && obj === obj.window;
	},

	isNumeric: function( obj ) {
		// parseFloat NaNs numeric-cast false positives (null|true|false|"")
		// ...but misinterprets leading-number strings, particularly hex literals ("0x...")
		// subtraction forces infinities to NaN
		// adding 1 corrects loss of precision from parseFloat (#15100)
		return !jQuery.isArray( obj ) && (obj - parseFloat( obj ) + 1) >= 0;
	},

	isPlainObject: function( obj ) {
		// Not plain objects:
		// - Any object or value whose internal [[Class]] property is not "[object Object]"
		// - DOM nodes
		// - window
		if ( jQuery.type( obj ) !== "object" || obj.nodeType || jQuery.isWindow( obj ) ) {
			return false;
		}

		if ( obj.constructor &&
				!hasOwn.call( obj.constructor.prototype, "isPrototypeOf" ) ) {
			return false;
		}

		// If the function hasn't returned already, we're confident that
		// |obj| is a plain object, created by {} or constructed with new Object
		return true;
	},

	isEmptyObject: function( obj ) {
		var name;
		for ( name in obj ) {
			return false;
		}
		return true;
	},

	type: function( obj ) {
		if ( obj == null ) {
			return obj + "";
		}
		// Support: Android<4.0, iOS<6 (functionish RegExp)
		return typeof obj === "object" || typeof obj === "function" ?
			class2type[ toString.call(obj) ] || "object" :
			typeof obj;
	},

	// Evaluates a script in a global context
	globalEval: function( code ) {
		var script,
			indirect = eval;

		code = jQuery.trim( code );

		if ( code ) {
			// If the code includes a valid, prologue position
			// strict mode pragma, execute code by injecting a
			// script tag into the document.
			if ( code.indexOf("use strict") === 1 ) {
				script = document.createElement("script");
				script.text = code;
				document.head.appendChild( script ).parentNode.removeChild( script );
			} else {
			// Otherwise, avoid the DOM node creation, insertion
			// and removal by using an indirect global eval
				indirect( code );
			}
		}
	},

	// Convert dashed to camelCase; used by the css and data modules
	// Support: IE9-11+
	// Microsoft forgot to hump their vendor prefix (#9572)
	camelCase: function( string ) {
		return string.replace( rmsPrefix, "ms-" ).replace( rdashAlpha, fcamelCase );
	},

	nodeName: function( elem, name ) {
		return elem.nodeName && elem.nodeName.toLowerCase() === name.toLowerCase();
	},

	// args is for internal usage only
	each: function( obj, callback, args ) {
		var value,
			i = 0,
			length = obj.length,
			isArray = isArraylike( obj );

		if ( args ) {
			if ( isArray ) {
				for ( ; i < length; i++ ) {
					value = callback.apply( obj[ i ], args );

					if ( value === false ) {
						break;
					}
				}
			} else {
				for ( i in obj ) {
					value = callback.apply( obj[ i ], args );

					if ( value === false ) {
						break;
					}
				}
			}

		// A special, fast, case for the most common use of each
		} else {
			if ( isArray ) {
				for ( ; i < length; i++ ) {
					value = callback.call( obj[ i ], i, obj[ i ] );

					if ( value === false ) {
						break;
					}
				}
			} else {
				for ( i in obj ) {
					value = callback.call( obj[ i ], i, obj[ i ] );

					if ( value === false ) {
						break;
					}
				}
			}
		}

		return obj;
	},

	// Support: Android<4.1
	trim: function( text ) {
		return text == null ?
			"" :
			( text + "" ).replace( rtrim, "" );
	},

	// results is for internal usage only
	makeArray: function( arr, results ) {
		var ret = results || [];

		if ( arr != null ) {
			if ( isArraylike( Object(arr) ) ) {
				jQuery.merge( ret,
					typeof arr === "string" ?
					[ arr ] : arr
				);
			} else {
				push.call( ret, arr );
			}
		}

		return ret;
	},

	inArray: function( elem, arr, i ) {
		return arr == null ? -1 : indexOf.call( arr, elem, i );
	},

	merge: function( first, second ) {
		var len = +second.length,
			j = 0,
			i = first.length;

		for ( ; j < len; j++ ) {
			first[ i++ ] = second[ j ];
		}

		first.length = i;

		return first;
	},

	grep: function( elems, callback, invert ) {
		var callbackInverse,
			matches = [],
			i = 0,
			length = elems.length,
			callbackExpect = !invert;

		// Go through the array, only saving the items
		// that pass the validator function
		for ( ; i < length; i++ ) {
			callbackInverse = !callback( elems[ i ], i );
			if ( callbackInverse !== callbackExpect ) {
				matches.push( elems[ i ] );
			}
		}

		return matches;
	},

	// arg is for internal usage only
	map: function( elems, callback, arg ) {
		var value,
			i = 0,
			length = elems.length,
			isArray = isArraylike( elems ),
			ret = [];

		// Go through the array, translating each of the items to their new values
		if ( isArray ) {
			for ( ; i < length; i++ ) {
				value = callback( elems[ i ], i, arg );

				if ( value != null ) {
					ret.push( value );
				}
			}

		// Go through every key on the object,
		} else {
			for ( i in elems ) {
				value = callback( elems[ i ], i, arg );

				if ( value != null ) {
					ret.push( value );
				}
			}
		}

		// Flatten any nested arrays
		return concat.apply( [], ret );
	},

	// A global GUID counter for objects
	guid: 1,

	// Bind a function to a context, optionally partially applying any
	// arguments.
	proxy: function( fn, context ) {
		var tmp, args, proxy;

		if ( typeof context === "string" ) {
			tmp = fn[ context ];
			context = fn;
			fn = tmp;
		}

		// Quick check to determine if target is callable, in the spec
		// this throws a TypeError, but we will just return undefined.
		if ( !jQuery.isFunction( fn ) ) {
			return undefined;
		}

		// Simulated bind
		args = slice.call( arguments, 2 );
		proxy = function() {
			return fn.apply( context || this, args.concat( slice.call( arguments ) ) );
		};

		// Set the guid of unique handler to the same of original handler, so it can be removed
		proxy.guid = fn.guid = fn.guid || jQuery.guid++;

		return proxy;
	},

	now: Date.now,

	// jQuery.support is not used in Core but other projects attach their
	// properties to it so it needs to exist.
	support: support
});

// Populate the class2type map
jQuery.each("Boolean Number String Function Array Date RegExp Object Error".split(" "), function(i, name) {
	class2type[ "[object " + name + "]" ] = name.toLowerCase();
});

function isArraylike( obj ) {

	// Support: iOS 8.2 (not reproducible in simulator)
	// `in` check used to prevent JIT error (gh-2145)
	// hasOwn isn't used here due to false negatives
	// regarding Nodelist length in IE
	var length = "length" in obj && obj.length,
		type = jQuery.type( obj );

	if ( type === "function" || jQuery.isWindow( obj ) ) {
		return false;
	}

	if ( obj.nodeType === 1 && length ) {
		return true;
	}

	return type === "array" || length === 0 ||
		typeof length === "number" && length > 0 && ( length - 1 ) in obj;
}
var Sizzle =
/*!
 * Sizzle CSS Selector Engine v2.2.0-pre
 * http://sizzlejs.com/
 *
 * Copyright 2008, 2014 jQuery Foundation, Inc. and other contributors
 * Released under the MIT license
 * http://jquery.org/license
 *
 * Date: 2014-12-16
 */
(function( window ) {

var i,
	support,
	Expr,
	getText,
	isXML,
	tokenize,
	compile,
	select,
	outermostContext,
	sortInput,
	hasDuplicate,

	// Local document vars
	setDocument,
	document,
	docElem,
	documentIsHTML,
	rbuggyQSA,
	rbuggyMatches,
	matches,
	contains,

	// Instance-specific data
	expando = "sizzle" + 1 * new Date(),
	preferredDoc = window.document,
	dirruns = 0,
	done = 0,
	classCache = createCache(),
	tokenCache = createCache(),
	compilerCache = createCache(),
	sortOrder = function( a, b ) {
		if ( a === b ) {
			hasDuplicate = true;
		}
		return 0;
	},

	// General-purpose constants
	MAX_NEGATIVE = 1 << 31,

	// Instance methods
	hasOwn = ({}).hasOwnProperty,
	arr = [],
	pop = arr.pop,
	push_native = arr.push,
	push = arr.push,
	slice = arr.slice,
	// Use a stripped-down indexOf as it's faster than native
	// http://jsperf.com/thor-indexof-vs-for/5
	indexOf = function( list, elem ) {
		var i = 0,
			len = list.length;
		for ( ; i < len; i++ ) {
			if ( list[i] === elem ) {
				return i;
			}
		}
		return -1;
	},

	booleans = "checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",

	// Regular expressions

	// Whitespace characters http://www.w3.org/TR/css3-selectors/#whitespace
	whitespace = "[\\x20\\t\\r\\n\\f]",
	// http://www.w3.org/TR/css3-syntax/#characters
	characterEncoding = "(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",

	// Loosely modeled on CSS identifier characters
	// An unquoted value should be a CSS identifier http://www.w3.org/TR/css3-selectors/#attribute-selectors
	// Proper syntax: http://www.w3.org/TR/CSS21/syndata.html#value-def-identifier
	identifier = characterEncoding.replace( "w", "w#" ),

	// Attribute selectors: http://www.w3.org/TR/selectors/#attribute-selectors
	attributes = "\\[" + whitespace + "*(" + characterEncoding + ")(?:" + whitespace +
		// Operator (capture 2)
		"*([*^$|!~]?=)" + whitespace +
		// "Attribute values must be CSS identifiers [capture 5] or strings [capture 3 or capture 4]"
		"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|(" + identifier + "))|)" + whitespace +
		"*\\]",

	pseudos = ":(" + characterEncoding + ")(?:\\((" +
		// To reduce the number of selectors needing tokenize in the preFilter, prefer arguments:
		// 1. quoted (capture 3; capture 4 or capture 5)
		"('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|" +
		// 2. simple (capture 6)
		"((?:\\\\.|[^\\\\()[\\]]|" + attributes + ")*)|" +
		// 3. anything else (capture 2)
		".*" +
		")\\)|)",

	// Leading and non-escaped trailing whitespace, capturing some non-whitespace characters preceding the latter
	rwhitespace = new RegExp( whitespace + "+", "g" ),
	rtrim = new RegExp( "^" + whitespace + "+|((?:^|[^\\\\])(?:\\\\.)*)" + whitespace + "+$", "g" ),

	rcomma = new RegExp( "^" + whitespace + "*," + whitespace + "*" ),
	rcombinators = new RegExp( "^" + whitespace + "*([>+~]|" + whitespace + ")" + whitespace + "*" ),

	rattributeQuotes = new RegExp( "=" + whitespace + "*([^\\]'\"]*?)" + whitespace + "*\\]", "g" ),

	rpseudo = new RegExp( pseudos ),
	ridentifier = new RegExp( "^" + identifier + "$" ),

	matchExpr = {
		"ID": new RegExp( "^#(" + characterEncoding + ")" ),
		"CLASS": new RegExp( "^\\.(" + characterEncoding + ")" ),
		"TAG": new RegExp( "^(" + characterEncoding.replace( "w", "w*" ) + ")" ),
		"ATTR": new RegExp( "^" + attributes ),
		"PSEUDO": new RegExp( "^" + pseudos ),
		"CHILD": new RegExp( "^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\(" + whitespace +
			"*(even|odd|(([+-]|)(\\d*)n|)" + whitespace + "*(?:([+-]|)" + whitespace +
			"*(\\d+)|))" + whitespace + "*\\)|)", "i" ),
		"bool": new RegExp( "^(?:" + booleans + ")$", "i" ),
		// For use in libraries implementing .is()
		// We use this for POS matching in `select`
		"needsContext": new RegExp( "^" + whitespace + "*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\(" +
			whitespace + "*((?:-\\d)?\\d*)" + whitespace + "*\\)|)(?=[^-]|$)", "i" )
	},

	rinputs = /^(?:input|select|textarea|button)$/i,
	rheader = /^h\d$/i,

	rnative = /^[^{]+\{\s*\[native \w/,

	// Easily-parseable/retrievable ID or TAG or CLASS selectors
	rquickExpr = /^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,

	rsibling = /[+~]/,
	rescape = /'|\\/g,

	// CSS escapes http://www.w3.org/TR/CSS21/syndata.html#escaped-characters
	runescape = new RegExp( "\\\\([\\da-f]{1,6}" + whitespace + "?|(" + whitespace + ")|.)", "ig" ),
	funescape = function( _, escaped, escapedWhitespace ) {
		var high = "0x" + escaped - 0x10000;
		// NaN means non-codepoint
		// Support: Firefox<24
		// Workaround erroneous numeric interpretation of +"0x"
		return high !== high || escapedWhitespace ?
			escaped :
			high < 0 ?
				// BMP codepoint
				String.fromCharCode( high + 0x10000 ) :
				// Supplemental Plane codepoint (surrogate pair)
				String.fromCharCode( high >> 10 | 0xD800, high & 0x3FF | 0xDC00 );
	},

	// Used for iframes
	// See setDocument()
	// Removing the function wrapper causes a "Permission Denied"
	// error in IE
	unloadHandler = function() {
		setDocument();
	};

// Optimize for push.apply( _, NodeList )
try {
	push.apply(
		(arr = slice.call( preferredDoc.childNodes )),
		preferredDoc.childNodes
	);
	// Support: Android<4.0
	// Detect silently failing push.apply
	arr[ preferredDoc.childNodes.length ].nodeType;
} catch ( e ) {
	push = { apply: arr.length ?

		// Leverage slice if possible
		function( target, els ) {
			push_native.apply( target, slice.call(els) );
		} :

		// Support: IE<9
		// Otherwise append directly
		function( target, els ) {
			var j = target.length,
				i = 0;
			// Can't trust NodeList.length
			while ( (target[j++] = els[i++]) ) {}
			target.length = j - 1;
		}
	};
}

function Sizzle( selector, context, results, seed ) {
	var match, elem, m, nodeType,
		// QSA vars
		i, groups, old, nid, newContext, newSelector;

	if ( ( context ? context.ownerDocument || context : preferredDoc ) !== document ) {
		setDocument( context );
	}

	context = context || document;
	results = results || [];
	nodeType = context.nodeType;

	if ( typeof selector !== "string" || !selector ||
		nodeType !== 1 && nodeType !== 9 && nodeType !== 11 ) {

		return results;
	}

	if ( !seed && documentIsHTML ) {

		// Try to shortcut find operations when possible (e.g., not under DocumentFragment)
		if ( nodeType !== 11 && (match = rquickExpr.exec( selector )) ) {
			// Speed-up: Sizzle("#ID")
			if ( (m = match[1]) ) {
				if ( nodeType === 9 ) {
					elem = context.getElementById( m );
					// Check parentNode to catch when Blackberry 4.6 returns
					// nodes that are no longer in the document (jQuery #6963)
					if ( elem && elem.parentNode ) {
						// Handle the case where IE, Opera, and Webkit return items
						// by name instead of ID
						if ( elem.id === m ) {
							results.push( elem );
							return results;
						}
					} else {
						return results;
					}
				} else {
					// Context is not a document
					if ( context.ownerDocument && (elem = context.ownerDocument.getElementById( m )) &&
						contains( context, elem ) && elem.id === m ) {
						results.push( elem );
						return results;
					}
				}

			// Speed-up: Sizzle("TAG")
			} else if ( match[2] ) {
				push.apply( results, context.getElementsByTagName( selector ) );
				return results;

			// Speed-up: Sizzle(".CLASS")
			} else if ( (m = match[3]) && support.getElementsByClassName ) {
				push.apply( results, context.getElementsByClassName( m ) );
				return results;
			}
		}

		// QSA path
		if ( support.qsa && (!rbuggyQSA || !rbuggyQSA.test( selector )) ) {
			nid = old = expando;
			newContext = context;
			newSelector = nodeType !== 1 && selector;

			// qSA works strangely on Element-rooted queries
			// We can work around this by specifying an extra ID on the root
			// and working up from there (Thanks to Andrew Dupont for the technique)
			// IE 8 doesn't work on object elements
			if ( nodeType === 1 && context.nodeName.toLowerCase() !== "object" ) {
				groups = tokenize( selector );

				if ( (old = context.getAttribute("id")) ) {
					nid = old.replace( rescape, "\\$&" );
				} else {
					context.setAttribute( "id", nid );
				}
				nid = "[id='" + nid + "'] ";

				i = groups.length;
				while ( i-- ) {
					groups[i] = nid + toSelector( groups[i] );
				}
				newContext = rsibling.test( selector ) && testContext( context.parentNode ) || context;
				newSelector = groups.join(",");
			}

			if ( newSelector ) {
				try {
					push.apply( results,
						newContext.querySelectorAll( newSelector )
					);
					return results;
				} catch(qsaError) {
				} finally {
					if ( !old ) {
						context.removeAttribute("id");
					}
				}
			}
		}
	}

	// All others
	return select( selector.replace( rtrim, "$1" ), context, results, seed );
}

/**
 * Create key-value caches of limited size
 * @returns {Function(string, Object)} Returns the Object data after storing it on itself with
 *	property name the (space-suffixed) string and (if the cache is larger than Expr.cacheLength)
 *	deleting the oldest entry
 */
function createCache() {
	var keys = [];

	function cache( key, value ) {
		// Use (key + " ") to avoid collision with native prototype properties (see Issue #157)
		if ( keys.push( key + " " ) > Expr.cacheLength ) {
			// Only keep the most recent entries
			delete cache[ keys.shift() ];
		}
		return (cache[ key + " " ] = value);
	}
	return cache;
}

/**
 * Mark a function for special use by Sizzle
 * @param {Function} fn The function to mark
 */
function markFunction( fn ) {
	fn[ expando ] = true;
	return fn;
}

/**
 * Support testing using an element
 * @param {Function} fn Passed the created div and expects a boolean result
 */
function assert( fn ) {
	var div = document.createElement("div");

	try {
		return !!fn( div );
	} catch (e) {
		return false;
	} finally {
		// Remove from its parent by default
		if ( div.parentNode ) {
			div.parentNode.removeChild( div );
		}
		// release memory in IE
		div = null;
	}
}

/**
 * Adds the same handler for all of the specified attrs
 * @param {String} attrs Pipe-separated list of attributes
 * @param {Function} handler The method that will be applied
 */
function addHandle( attrs, handler ) {
	var arr = attrs.split("|"),
		i = attrs.length;

	while ( i-- ) {
		Expr.attrHandle[ arr[i] ] = handler;
	}
}

/**
 * Checks document order of two siblings
 * @param {Element} a
 * @param {Element} b
 * @returns {Number} Returns less than 0 if a precedes b, greater than 0 if a follows b
 */
function siblingCheck( a, b ) {
	var cur = b && a,
		diff = cur && a.nodeType === 1 && b.nodeType === 1 &&
			( ~b.sourceIndex || MAX_NEGATIVE ) -
			( ~a.sourceIndex || MAX_NEGATIVE );

	// Use IE sourceIndex if available on both nodes
	if ( diff ) {
		return diff;
	}

	// Check if b follows a
	if ( cur ) {
		while ( (cur = cur.nextSibling) ) {
			if ( cur === b ) {
				return -1;
			}
		}
	}

	return a ? 1 : -1;
}

/**
 * Returns a function to use in pseudos for input types
 * @param {String} type
 */
function createInputPseudo( type ) {
	return function( elem ) {
		var name = elem.nodeName.toLowerCase();
		return name === "input" && elem.type === type;
	};
}

/**
 * Returns a function to use in pseudos for buttons
 * @param {String} type
 */
function createButtonPseudo( type ) {
	return function( elem ) {
		var name = elem.nodeName.toLowerCase();
		return (name === "input" || name === "button") && elem.type === type;
	};
}

/**
 * Returns a function to use in pseudos for positionals
 * @param {Function} fn
 */
function createPositionalPseudo( fn ) {
	return markFunction(function( argument ) {
		argument = +argument;
		return markFunction(function( seed, matches ) {
			var j,
				matchIndexes = fn( [], seed.length, argument ),
				i = matchIndexes.length;

			// Match elements found at the specified indexes
			while ( i-- ) {
				if ( seed[ (j = matchIndexes[i]) ] ) {
					seed[j] = !(matches[j] = seed[j]);
				}
			}
		});
	});
}

/**
 * Checks a node for validity as a Sizzle context
 * @param {Element|Object=} context
 * @returns {Element|Object|Boolean} The input node if acceptable, otherwise a falsy value
 */
function testContext( context ) {
	return context && typeof context.getElementsByTagName !== "undefined" && context;
}

// Expose support vars for convenience
support = Sizzle.support = {};

/**
 * Detects XML nodes
 * @param {Element|Object} elem An element or a document
 * @returns {Boolean} True iff elem is a non-HTML XML node
 */
isXML = Sizzle.isXML = function( elem ) {
	// documentElement is verified for cases where it doesn't yet exist
	// (such as loading iframes in IE - #4833)
	var documentElement = elem && (elem.ownerDocument || elem).documentElement;
	return documentElement ? documentElement.nodeName !== "HTML" : false;
};

/**
 * Sets document-related variables once based on the current document
 * @param {Element|Object} [doc] An element or document object to use to set the document
 * @returns {Object} Returns the current document
 */
setDocument = Sizzle.setDocument = function( node ) {
	var hasCompare, parent,
		doc = node ? node.ownerDocument || node : preferredDoc;

	// If no document and documentElement is available, return
	if ( doc === document || doc.nodeType !== 9 || !doc.documentElement ) {
		return document;
	}

	// Set our document
	document = doc;
	docElem = doc.documentElement;
	parent = doc.defaultView;

	// Support: IE>8
	// If iframe document is assigned to "document" variable and if iframe has been reloaded,
	// IE will throw "permission denied" error when accessing "document" variable, see jQuery #13936
	// IE6-8 do not support the defaultView property so parent will be undefined
	if ( parent && parent !== parent.top ) {
		// IE11 does not have attachEvent, so all must suffer
		if ( parent.addEventListener ) {
			parent.addEventListener( "unload", unloadHandler, false );
		} else if ( parent.attachEvent ) {
			parent.attachEvent( "onunload", unloadHandler );
		}
	}

	/* Support tests
	---------------------------------------------------------------------- */
	documentIsHTML = !isXML( doc );

	/* Attributes
	---------------------------------------------------------------------- */

	// Support: IE<8
	// Verify that getAttribute really returns attributes and not properties
	// (excepting IE8 booleans)
	support.attributes = assert(function( div ) {
		div.className = "i";
		return !div.getAttribute("className");
	});

	/* getElement(s)By*
	---------------------------------------------------------------------- */

	// Check if getElementsByTagName("*") returns only elements
	support.getElementsByTagName = assert(function( div ) {
		div.appendChild( doc.createComment("") );
		return !div.getElementsByTagName("*").length;
	});

	// Support: IE<9
	support.getElementsByClassName = rnative.test( doc.getElementsByClassName );

	// Support: IE<10
	// Check if getElementById returns elements by name
	// The broken getElementById methods don't pick up programatically-set names,
	// so use a roundabout getElementsByName test
	support.getById = assert(function( div ) {
		docElem.appendChild( div ).id = expando;
		return !doc.getElementsByName || !doc.getElementsByName( expando ).length;
	});

	// ID find and filter
	if ( support.getById ) {
		Expr.find["ID"] = function( id, context ) {
			if ( typeof context.getElementById !== "undefined" && documentIsHTML ) {
				var m = context.getElementById( id );
				// Check parentNode to catch when Blackberry 4.6 returns
				// nodes that are no longer in the document #6963
				return m && m.parentNode ? [ m ] : [];
			}
		};
		Expr.filter["ID"] = function( id ) {
			var attrId = id.replace( runescape, funescape );
			return function( elem ) {
				return elem.getAttribute("id") === attrId;
			};
		};
	} else {
		// Support: IE6/7
		// getElementById is not reliable as a find shortcut
		delete Expr.find["ID"];

		Expr.filter["ID"] =  function( id ) {
			var attrId = id.replace( runescape, funescape );
			return function( elem ) {
				var node = typeof elem.getAttributeNode !== "undefined" && elem.getAttributeNode("id");
				return node && node.value === attrId;
			};
		};
	}

	// Tag
	Expr.find["TAG"] = support.getElementsByTagName ?
		function( tag, context ) {
			if ( typeof context.getElementsByTagName !== "undefined" ) {
				return context.getElementsByTagName( tag );

			// DocumentFragment nodes don't have gEBTN
			} else if ( support.qsa ) {
				return context.querySelectorAll( tag );
			}
		} :

		function( tag, context ) {
			var elem,
				tmp = [],
				i = 0,
				// By happy coincidence, a (broken) gEBTN appears on DocumentFragment nodes too
				results = context.getElementsByTagName( tag );

			// Filter out possible comments
			if ( tag === "*" ) {
				while ( (elem = results[i++]) ) {
					if ( elem.nodeType === 1 ) {
						tmp.push( elem );
					}
				}

				return tmp;
			}
			return results;
		};

	// Class
	Expr.find["CLASS"] = support.getElementsByClassName && function( className, context ) {
		if ( documentIsHTML ) {
			return context.getElementsByClassName( className );
		}
	};

	/* QSA/matchesSelector
	---------------------------------------------------------------------- */

	// QSA and matchesSelector support

	// matchesSelector(:active) reports false when true (IE9/Opera 11.5)
	rbuggyMatches = [];

	// qSa(:focus) reports false when true (Chrome 21)
	// We allow this because of a bug in IE8/9 that throws an error
	// whenever `document.activeElement` is accessed on an iframe
	// So, we allow :focus to pass through QSA all the time to avoid the IE error
	// See http://bugs.jquery.com/ticket/13378
	rbuggyQSA = [];

	if ( (support.qsa = rnative.test( doc.querySelectorAll )) ) {
		// Build QSA regex
		// Regex strategy adopted from Diego Perini
		assert(function( div ) {
			// Select is set to empty string on purpose
			// This is to test IE's treatment of not explicitly
			// setting a boolean content attribute,
			// since its presence should be enough
			// http://bugs.jquery.com/ticket/12359
			docElem.appendChild( div ).innerHTML = "<a id='" + expando + "'></a>" +
				"<select id='" + expando + "-\f]' msallowcapture=''>" +
				"<option selected=''></option></select>";

			// Support: IE8, Opera 11-12.16
			// Nothing should be selected when empty strings follow ^= or $= or *=
			// The test attribute must be unknown in Opera but "safe" for WinRT
			// http://msdn.microsoft.com/en-us/library/ie/hh465388.aspx#attribute_section
			if ( div.querySelectorAll("[msallowcapture^='']").length ) {
				rbuggyQSA.push( "[*^$]=" + whitespace + "*(?:''|\"\")" );
			}

			// Support: IE8
			// Boolean attributes and "value" are not treated correctly
			if ( !div.querySelectorAll("[selected]").length ) {
				rbuggyQSA.push( "\\[" + whitespace + "*(?:value|" + booleans + ")" );
			}

			// Support: Chrome<29, Android<4.2+, Safari<7.0+, iOS<7.0+, PhantomJS<1.9.7+
			if ( !div.querySelectorAll( "[id~=" + expando + "-]" ).length ) {
				rbuggyQSA.push("~=");
			}

			// Webkit/Opera - :checked should return selected option elements
			// http://www.w3.org/TR/2011/REC-css3-selectors-20110929/#checked
			// IE8 throws error here and will not see later tests
			if ( !div.querySelectorAll(":checked").length ) {
				rbuggyQSA.push(":checked");
			}

			// Support: Safari 8+, iOS 8+
			// https://bugs.webkit.org/show_bug.cgi?id=136851
			// In-page `selector#id sibing-combinator selector` fails
			if ( !div.querySelectorAll( "a#" + expando + "+*" ).length ) {
				rbuggyQSA.push(".#.+[+~]");
			}
		});

		assert(function( div ) {
			// Support: Windows 8 Native Apps
			// The type and name attributes are restricted during .innerHTML assignment
			var input = doc.createElement("input");
			input.setAttribute( "type", "hidden" );
			div.appendChild( input ).setAttribute( "name", "D" );

			// Support: IE8
			// Enforce case-sensitivity of name attribute
			if ( div.querySelectorAll("[name=d]").length ) {
				rbuggyQSA.push( "name" + whitespace + "*[*^$|!~]?=" );
			}

			// FF 3.5 - :enabled/:disabled and hidden elements (hidden elements are still enabled)
			// IE8 throws error here and will not see later tests
			if ( !div.querySelectorAll(":enabled").length ) {
				rbuggyQSA.push( ":enabled", ":disabled" );
			}

			// Opera 10-11 does not throw on post-comma invalid pseudos
			div.querySelectorAll("*,:x");
			rbuggyQSA.push(",.*:");
		});
	}

	if ( (support.matchesSelector = rnative.test( (matches = docElem.matches ||
		docElem.webkitMatchesSelector ||
		docElem.mozMatchesSelector ||
		docElem.oMatchesSelector ||
		docElem.msMatchesSelector) )) ) {

		assert(function( div ) {
			// Check to see if it's possible to do matchesSelector
			// on a disconnected node (IE 9)
			support.disconnectedMatch = matches.call( div, "div" );

			// This should fail with an exception
			// Gecko does not error, returns false instead
			matches.call( div, "[s!='']:x" );
			rbuggyMatches.push( "!=", pseudos );
		});
	}

	rbuggyQSA = rbuggyQSA.length && new RegExp( rbuggyQSA.join("|") );
	rbuggyMatches = rbuggyMatches.length && new RegExp( rbuggyMatches.join("|") );

	/* Contains
	---------------------------------------------------------------------- */
	hasCompare = rnative.test( docElem.compareDocumentPosition );

	// Element contains another
	// Purposefully does not implement inclusive descendent
	// As in, an element does not contain itself
	contains = hasCompare || rnative.test( docElem.contains ) ?
		function( a, b ) {
			var adown = a.nodeType === 9 ? a.documentElement : a,
				bup = b && b.parentNode;
			return a === bup || !!( bup && bup.nodeType === 1 && (
				adown.contains ?
					adown.contains( bup ) :
					a.compareDocumentPosition && a.compareDocumentPosition( bup ) & 16
			));
		} :
		function( a, b ) {
			if ( b ) {
				while ( (b = b.parentNode) ) {
					if ( b === a ) {
						return true;
					}
				}
			}
			return false;
		};

	/* Sorting
	---------------------------------------------------------------------- */

	// Document order sorting
	sortOrder = hasCompare ?
	function( a, b ) {

		// Flag for duplicate removal
		if ( a === b ) {
			hasDuplicate = true;
			return 0;
		}

		// Sort on method existence if only one input has compareDocumentPosition
		var compare = !a.compareDocumentPosition - !b.compareDocumentPosition;
		if ( compare ) {
			return compare;
		}

		// Calculate position if both inputs belong to the same document
		compare = ( a.ownerDocument || a ) === ( b.ownerDocument || b ) ?
			a.compareDocumentPosition( b ) :

			// Otherwise we know they are disconnected
			1;

		// Disconnected nodes
		if ( compare & 1 ||
			(!support.sortDetached && b.compareDocumentPosition( a ) === compare) ) {

			// Choose the first element that is related to our preferred document
			if ( a === doc || a.ownerDocument === preferredDoc && contains(preferredDoc, a) ) {
				return -1;
			}
			if ( b === doc || b.ownerDocument === preferredDoc && contains(preferredDoc, b) ) {
				return 1;
			}

			// Maintain original order
			return sortInput ?
				( indexOf( sortInput, a ) - indexOf( sortInput, b ) ) :
				0;
		}

		return compare & 4 ? -1 : 1;
	} :
	function( a, b ) {
		// Exit early if the nodes are identical
		if ( a === b ) {
			hasDuplicate = true;
			return 0;
		}

		var cur,
			i = 0,
			aup = a.parentNode,
			bup = b.parentNode,
			ap = [ a ],
			bp = [ b ];

		// Parentless nodes are either documents or disconnected
		if ( !aup || !bup ) {
			return a === doc ? -1 :
				b === doc ? 1 :
				aup ? -1 :
				bup ? 1 :
				sortInput ?
				( indexOf( sortInput, a ) - indexOf( sortInput, b ) ) :
				0;

		// If the nodes are siblings, we can do a quick check
		} else if ( aup === bup ) {
			return siblingCheck( a, b );
		}

		// Otherwise we need full lists of their ancestors for comparison
		cur = a;
		while ( (cur = cur.parentNode) ) {
			ap.unshift( cur );
		}
		cur = b;
		while ( (cur = cur.parentNode) ) {
			bp.unshift( cur );
		}

		// Walk down the tree looking for a discrepancy
		while ( ap[i] === bp[i] ) {
			i++;
		}

		return i ?
			// Do a sibling check if the nodes have a common ancestor
			siblingCheck( ap[i], bp[i] ) :

			// Otherwise nodes in our document sort first
			ap[i] === preferredDoc ? -1 :
			bp[i] === preferredDoc ? 1 :
			0;
	};

	return doc;
};

Sizzle.matches = function( expr, elements ) {
	return Sizzle( expr, null, null, elements );
};

Sizzle.matchesSelector = function( elem, expr ) {
	// Set document vars if needed
	if ( ( elem.ownerDocument || elem ) !== document ) {
		setDocument( elem );
	}

	// Make sure that attribute selectors are quoted
	expr = expr.replace( rattributeQuotes, "='$1']" );

	if ( support.matchesSelector && documentIsHTML &&
		( !rbuggyMatches || !rbuggyMatches.test( expr ) ) &&
		( !rbuggyQSA     || !rbuggyQSA.test( expr ) ) ) {

		try {
			var ret = matches.call( elem, expr );

			// IE 9's matchesSelector returns false on disconnected nodes
			if ( ret || support.disconnectedMatch ||
					// As well, disconnected nodes are said to be in a document
					// fragment in IE 9
					elem.document && elem.document.nodeType !== 11 ) {
				return ret;
			}
		} catch (e) {}
	}

	return Sizzle( expr, document, null, [ elem ] ).length > 0;
};

Sizzle.contains = function( context, elem ) {
	// Set document vars if needed
	if ( ( context.ownerDocument || context ) !== document ) {
		setDocument( context );
	}
	return contains( context, elem );
};

Sizzle.attr = function( elem, name ) {
	// Set document vars if needed
	if ( ( elem.ownerDocument || elem ) !== document ) {
		setDocument( elem );
	}

	var fn = Expr.attrHandle[ name.toLowerCase() ],
		// Don't get fooled by Object.prototype properties (jQuery #13807)
		val = fn && hasOwn.call( Expr.attrHandle, name.toLowerCase() ) ?
			fn( elem, name, !documentIsHTML ) :
			undefined;

	return val !== undefined ?
		val :
		support.attributes || !documentIsHTML ?
			elem.getAttribute( name ) :
			(val = elem.getAttributeNode(name)) && val.specified ?
				val.value :
				null;
};

Sizzle.error = function( msg ) {
	throw new Error( "Syntax error, unrecognized expression: " + msg );
};

/**
 * Document sorting and removing duplicates
 * @param {ArrayLike} results
 */
Sizzle.uniqueSort = function( results ) {
	var elem,
		duplicates = [],
		j = 0,
		i = 0;

	// Unless we *know* we can detect duplicates, assume their presence
	hasDuplicate = !support.detectDuplicates;
	sortInput = !support.sortStable && results.slice( 0 );
	results.sort( sortOrder );

	if ( hasDuplicate ) {
		while ( (elem = results[i++]) ) {
			if ( elem === results[ i ] ) {
				j = duplicates.push( i );
			}
		}
		while ( j-- ) {
			results.splice( duplicates[ j ], 1 );
		}
	}

	// Clear input after sorting to release objects
	// See https://github.com/jquery/sizzle/pull/225
	sortInput = null;

	return results;
};

/**
 * Utility function for retrieving the text value of an array of DOM nodes
 * @param {Array|Element} elem
 */
getText = Sizzle.getText = function( elem ) {
	var node,
		ret = "",
		i = 0,
		nodeType = elem.nodeType;

	if ( !nodeType ) {
		// If no nodeType, this is expected to be an array
		while ( (node = elem[i++]) ) {
			// Do not traverse comment nodes
			ret += getText( node );
		}
	} else if ( nodeType === 1 || nodeType === 9 || nodeType === 11 ) {
		// Use textContent for elements
		// innerText usage removed for consistency of new lines (jQuery #11153)
		if ( typeof elem.textContent === "string" ) {
			return elem.textContent;
		} else {
			// Traverse its children
			for ( elem = elem.firstChild; elem; elem = elem.nextSibling ) {
				ret += getText( elem );
			}
		}
	} else if ( nodeType === 3 || nodeType === 4 ) {
		return elem.nodeValue;
	}
	// Do not include comment or processing instruction nodes

	return ret;
};

Expr = Sizzle.selectors = {

	// Can be adjusted by the user
	cacheLength: 50,

	createPseudo: markFunction,

	match: matchExpr,

	attrHandle: {},

	find: {},

	relative: {
		">": { dir: "parentNode", first: true },
		" ": { dir: "parentNode" },
		"+": { dir: "previousSibling", first: true },
		"~": { dir: "previousSibling" }
	},

	preFilter: {
		"ATTR": function( match ) {
			match[1] = match[1].replace( runescape, funescape );

			// Move the given value to match[3] whether quoted or unquoted
			match[3] = ( match[3] || match[4] || match[5] || "" ).replace( runescape, funescape );

			if ( match[2] === "~=" ) {
				match[3] = " " + match[3] + " ";
			}

			return match.slice( 0, 4 );
		},

		"CHILD": function( match ) {
			/* matches from matchExpr["CHILD"]
				1 type (only|nth|...)
				2 what (child|of-type)
				3 argument (even|odd|\d*|\d*n([+-]\d+)?|...)
				4 xn-component of xn+y argument ([+-]?\d*n|)
				5 sign of xn-component
				6 x of xn-component
				7 sign of y-component
				8 y of y-component
			*/
			match[1] = match[1].toLowerCase();

			if ( match[1].slice( 0, 3 ) === "nth" ) {
				// nth-* requires argument
				if ( !match[3] ) {
					Sizzle.error( match[0] );
				}

				// numeric x and y parameters for Expr.filter.CHILD
				// remember that false/true cast respectively to 0/1
				match[4] = +( match[4] ? match[5] + (match[6] || 1) : 2 * ( match[3] === "even" || match[3] === "odd" ) );
				match[5] = +( ( match[7] + match[8] ) || match[3] === "odd" );

			// other types prohibit arguments
			} else if ( match[3] ) {
				Sizzle.error( match[0] );
			}

			return match;
		},

		"PSEUDO": function( match ) {
			var excess,
				unquoted = !match[6] && match[2];

			if ( matchExpr["CHILD"].test( match[0] ) ) {
				return null;
			}

			// Accept quoted arguments as-is
			if ( match[3] ) {
				match[2] = match[4] || match[5] || "";

			// Strip excess characters from unquoted arguments
			} else if ( unquoted && rpseudo.test( unquoted ) &&
				// Get excess from tokenize (recursively)
				(excess = tokenize( unquoted, true )) &&
				// advance to the next closing parenthesis
				(excess = unquoted.indexOf( ")", unquoted.length - excess ) - unquoted.length) ) {

				// excess is a negative index
				match[0] = match[0].slice( 0, excess );
				match[2] = unquoted.slice( 0, excess );
			}

			// Return only captures needed by the pseudo filter method (type and argument)
			return match.slice( 0, 3 );
		}
	},

	filter: {

		"TAG": function( nodeNameSelector ) {
			var nodeName = nodeNameSelector.replace( runescape, funescape ).toLowerCase();
			return nodeNameSelector === "*" ?
				function() { return true; } :
				function( elem ) {
					return elem.nodeName && elem.nodeName.toLowerCase() === nodeName;
				};
		},

		"CLASS": function( className ) {
			var pattern = classCache[ className + " " ];

			return pattern ||
				(pattern = new RegExp( "(^|" + whitespace + ")" + className + "(" + whitespace + "|$)" )) &&
				classCache( className, function( elem ) {
					return pattern.test( typeof elem.className === "string" && elem.className || typeof elem.getAttribute !== "undefined" && elem.getAttribute("class") || "" );
				});
		},

		"ATTR": function( name, operator, check ) {
			return function( elem ) {
				var result = Sizzle.attr( elem, name );

				if ( result == null ) {
					return operator === "!=";
				}
				if ( !operator ) {
					return true;
				}

				result += "";

				return operator === "=" ? result === check :
					operator === "!=" ? result !== check :
					operator === "^=" ? check && result.indexOf( check ) === 0 :
					operator === "*=" ? check && result.indexOf( check ) > -1 :
					operator === "$=" ? check && result.slice( -check.length ) === check :
					operator === "~=" ? ( " " + result.replace( rwhitespace, " " ) + " " ).indexOf( check ) > -1 :
					operator === "|=" ? result === check || result.slice( 0, check.length + 1 ) === check + "-" :
					false;
			};
		},

		"CHILD": function( type, what, argument, first, last ) {
			var simple = type.slice( 0, 3 ) !== "nth",
				forward = type.slice( -4 ) !== "last",
				ofType = what === "of-type";

			return first === 1 && last === 0 ?

				// Shortcut for :nth-*(n)
				function( elem ) {
					return !!elem.parentNode;
				} :

				function( elem, context, xml ) {
					var cache, outerCache, node, diff, nodeIndex, start,
						dir = simple !== forward ? "nextSibling" : "previousSibling",
						parent = elem.parentNode,
						name = ofType && elem.nodeName.toLowerCase(),
						useCache = !xml && !ofType;

					if ( parent ) {

						// :(first|last|only)-(child|of-type)
						if ( simple ) {
							while ( dir ) {
								node = elem;
								while ( (node = node[ dir ]) ) {
									if ( ofType ? node.nodeName.toLowerCase() === name : node.nodeType === 1 ) {
										return false;
									}
								}
								// Reverse direction for :only-* (if we haven't yet done so)
								start = dir = type === "only" && !start && "nextSibling";
							}
							return true;
						}

						start = [ forward ? parent.firstChild : parent.lastChild ];

						// non-xml :nth-child(...) stores cache data on `parent`
						if ( forward && useCache ) {
							// Seek `elem` from a previously-cached index
							outerCache = parent[ expando ] || (parent[ expando ] = {});
							cache = outerCache[ type ] || [];
							nodeIndex = cache[0] === dirruns && cache[1];
							diff = cache[0] === dirruns && cache[2];
							node = nodeIndex && parent.childNodes[ nodeIndex ];

							while ( (node = ++nodeIndex && node && node[ dir ] ||

								// Fallback to seeking `elem` from the start
								(diff = nodeIndex = 0) || start.pop()) ) {

								// When found, cache indexes on `parent` and break
								if ( node.nodeType === 1 && ++diff && node === elem ) {
									outerCache[ type ] = [ dirruns, nodeIndex, diff ];
									break;
								}
							}

						// Use previously-cached element index if available
						} else if ( useCache && (cache = (elem[ expando ] || (elem[ expando ] = {}))[ type ]) && cache[0] === dirruns ) {
							diff = cache[1];

						// xml :nth-child(...) or :nth-last-child(...) or :nth(-last)?-of-type(...)
						} else {
							// Use the same loop as above to seek `elem` from the start
							while ( (node = ++nodeIndex && node && node[ dir ] ||
								(diff = nodeIndex = 0) || start.pop()) ) {

								if ( ( ofType ? node.nodeName.toLowerCase() === name : node.nodeType === 1 ) && ++diff ) {
									// Cache the index of each encountered element
									if ( useCache ) {
										(node[ expando ] || (node[ expando ] = {}))[ type ] = [ dirruns, diff ];
									}

									if ( node === elem ) {
										break;
									}
								}
							}
						}

						// Incorporate the offset, then check against cycle size
						diff -= last;
						return diff === first || ( diff % first === 0 && diff / first >= 0 );
					}
				};
		},

		"PSEUDO": function( pseudo, argument ) {
			// pseudo-class names are case-insensitive
			// http://www.w3.org/TR/selectors/#pseudo-classes
			// Prioritize by case sensitivity in case custom pseudos are added with uppercase letters
			// Remember that setFilters inherits from pseudos
			var args,
				fn = Expr.pseudos[ pseudo ] || Expr.setFilters[ pseudo.toLowerCase() ] ||
					Sizzle.error( "unsupported pseudo: " + pseudo );

			// The user may use createPseudo to indicate that
			// arguments are needed to create the filter function
			// just as Sizzle does
			if ( fn[ expando ] ) {
				return fn( argument );
			}

			// But maintain support for old signatures
			if ( fn.length > 1 ) {
				args = [ pseudo, pseudo, "", argument ];
				return Expr.setFilters.hasOwnProperty( pseudo.toLowerCase() ) ?
					markFunction(function( seed, matches ) {
						var idx,
							matched = fn( seed, argument ),
							i = matched.length;
						while ( i-- ) {
							idx = indexOf( seed, matched[i] );
							seed[ idx ] = !( matches[ idx ] = matched[i] );
						}
					}) :
					function( elem ) {
						return fn( elem, 0, args );
					};
			}

			return fn;
		}
	},

	pseudos: {
		// Potentially complex pseudos
		"not": markFunction(function( selector ) {
			// Trim the selector passed to compile
			// to avoid treating leading and trailing
			// spaces as combinators
			var input = [],
				results = [],
				matcher = compile( selector.replace( rtrim, "$1" ) );

			return matcher[ expando ] ?
				markFunction(function( seed, matches, context, xml ) {
					var elem,
						unmatched = matcher( seed, null, xml, [] ),
						i = seed.length;

					// Match elements unmatched by `matcher`
					while ( i-- ) {
						if ( (elem = unmatched[i]) ) {
							seed[i] = !(matches[i] = elem);
						}
					}
				}) :
				function( elem, context, xml ) {
					input[0] = elem;
					matcher( input, null, xml, results );
					// Don't keep the element (issue #299)
					input[0] = null;
					return !results.pop();
				};
		}),

		"has": markFunction(function( selector ) {
			return function( elem ) {
				return Sizzle( selector, elem ).length > 0;
			};
		}),

		"contains": markFunction(function( text ) {
			text = text.replace( runescape, funescape );
			return function( elem ) {
				return ( elem.textContent || elem.innerText || getText( elem ) ).indexOf( text ) > -1;
			};
		}),

		// "Whether an element is represented by a :lang() selector
		// is based solely on the element's language value
		// being equal to the identifier C,
		// or beginning with the identifier C immediately followed by "-".
		// The matching of C against the element's language value is performed case-insensitively.
		// The identifier C does not have to be a valid language name."
		// http://www.w3.org/TR/selectors/#lang-pseudo
		"lang": markFunction( function( lang ) {
			// lang value must be a valid identifier
			if ( !ridentifier.test(lang || "") ) {
				Sizzle.error( "unsupported lang: " + lang );
			}
			lang = lang.replace( runescape, funescape ).toLowerCase();
			return function( elem ) {
				var elemLang;
				do {
					if ( (elemLang = documentIsHTML ?
						elem.lang :
						elem.getAttribute("xml:lang") || elem.getAttribute("lang")) ) {

						elemLang = elemLang.toLowerCase();
						return elemLang === lang || elemLang.indexOf( lang + "-" ) === 0;
					}
				} while ( (elem = elem.parentNode) && elem.nodeType === 1 );
				return false;
			};
		}),

		// Miscellaneous
		"target": function( elem ) {
			var hash = window.location && window.location.hash;
			return hash && hash.slice( 1 ) === elem.id;
		},

		"root": function( elem ) {
			return elem === docElem;
		},

		"focus": function( elem ) {
			return elem === document.activeElement && (!document.hasFocus || document.hasFocus()) && !!(elem.type || elem.href || ~elem.tabIndex);
		},

		// Boolean properties
		"enabled": function( elem ) {
			return elem.disabled === false;
		},

		"disabled": function( elem ) {
			return elem.disabled === true;
		},

		"checked": function( elem ) {
			// In CSS3, :checked should return both checked and selected elements
			// http://www.w3.org/TR/2011/REC-css3-selectors-20110929/#checked
			var nodeName = elem.nodeName.toLowerCase();
			return (nodeName === "input" && !!elem.checked) || (nodeName === "option" && !!elem.selected);
		},

		"selected": function( elem ) {
			// Accessing this property makes selected-by-default
			// options in Safari work properly
			if ( elem.parentNode ) {
				elem.parentNode.selectedIndex;
			}

			return elem.selected === true;
		},

		// Contents
		"empty": function( elem ) {
			// http://www.w3.org/TR/selectors/#empty-pseudo
			// :empty is negated by element (1) or content nodes (text: 3; cdata: 4; entity ref: 5),
			//   but not by others (comment: 8; processing instruction: 7; etc.)
			// nodeType < 6 works because attributes (2) do not appear as children
			for ( elem = elem.firstChild; elem; elem = elem.nextSibling ) {
				if ( elem.nodeType < 6 ) {
					return false;
				}
			}
			return true;
		},

		"parent": function( elem ) {
			return !Expr.pseudos["empty"]( elem );
		},

		// Element/input types
		"header": function( elem ) {
			return rheader.test( elem.nodeName );
		},

		"input": function( elem ) {
			return rinputs.test( elem.nodeName );
		},

		"button": function( elem ) {
			var name = elem.nodeName.toLowerCase();
			return name === "input" && elem.type === "button" || name === "button";
		},

		"text": function( elem ) {
			var attr;
			return elem.nodeName.toLowerCase() === "input" &&
				elem.type === "text" &&

				// Support: IE<8
				// New HTML5 attribute values (e.g., "search") appear with elem.type === "text"
				( (attr = elem.getAttribute("type")) == null || attr.toLowerCase() === "text" );
		},

		// Position-in-collection
		"first": createPositionalPseudo(function() {
			return [ 0 ];
		}),

		"last": createPositionalPseudo(function( matchIndexes, length ) {
			return [ length - 1 ];
		}),

		"eq": createPositionalPseudo(function( matchIndexes, length, argument ) {
			return [ argument < 0 ? argument + length : argument ];
		}),

		"even": createPositionalPseudo(function( matchIndexes, length ) {
			var i = 0;
			for ( ; i < length; i += 2 ) {
				matchIndexes.push( i );
			}
			return matchIndexes;
		}),

		"odd": createPositionalPseudo(function( matchIndexes, length ) {
			var i = 1;
			for ( ; i < length; i += 2 ) {
				matchIndexes.push( i );
			}
			return matchIndexes;
		}),

		"lt": createPositionalPseudo(function( matchIndexes, length, argument ) {
			var i = argument < 0 ? argument + length : argument;
			for ( ; --i >= 0; ) {
				matchIndexes.push( i );
			}
			return matchIndexes;
		}),

		"gt": createPositionalPseudo(function( matchIndexes, length, argument ) {
			var i = argument < 0 ? argument + length : argument;
			for ( ; ++i < length; ) {
				matchIndexes.push( i );
			}
			return matchIndexes;
		})
	}
};

Expr.pseudos["nth"] = Expr.pseudos["eq"];

// Add button/input type pseudos
for ( i in { radio: true, checkbox: true, file: true, password: true, image: true } ) {
	Expr.pseudos[ i ] = createInputPseudo( i );
}
for ( i in { submit: true, reset: true } ) {
	Expr.pseudos[ i ] = createButtonPseudo( i );
}

// Easy API for creating new setFilters
function setFilters() {}
setFilters.prototype = Expr.filters = Expr.pseudos;
Expr.setFilters = new setFilters();

tokenize = Sizzle.tokenize = function( selector, parseOnly ) {
	var matched, match, tokens, type,
		soFar, groups, preFilters,
		cached = tokenCache[ selector + " " ];

	if ( cached ) {
		return parseOnly ? 0 : cached.slice( 0 );
	}

	soFar = selector;
	groups = [];
	preFilters = Expr.preFilter;

	while ( soFar ) {

		// Comma and first run
		if ( !matched || (match = rcomma.exec( soFar )) ) {
			if ( match ) {
				// Don't consume trailing commas as valid
				soFar = soFar.slice( match[0].length ) || soFar;
			}
			groups.push( (tokens = []) );
		}

		matched = false;

		// Combinators
		if ( (match = rcombinators.exec( soFar )) ) {
			matched = match.shift();
			tokens.push({
				value: matched,
				// Cast descendant combinators to space
				type: match[0].replace( rtrim, " " )
			});
			soFar = soFar.slice( matched.length );
		}

		// Filters
		for ( type in Expr.filter ) {
			if ( (match = matchExpr[ type ].exec( soFar )) && (!preFilters[ type ] ||
				(match = preFilters[ type ]( match ))) ) {
				matched = match.shift();
				tokens.push({
					value: matched,
					type: type,
					matches: match
				});
				soFar = soFar.slice( matched.length );
			}
		}

		if ( !matched ) {
			break;
		}
	}

	// Return the length of the invalid excess
	// if we're just parsing
	// Otherwise, throw an error or return tokens
	return parseOnly ?
		soFar.length :
		soFar ?
			Sizzle.error( selector ) :
			// Cache the tokens
			tokenCache( selector, groups ).slice( 0 );
};

function toSelector( tokens ) {
	var i = 0,
		len = tokens.length,
		selector = "";
	for ( ; i < len; i++ ) {
		selector += tokens[i].value;
	}
	return selector;
}

function addCombinator( matcher, combinator, base ) {
	var dir = combinator.dir,
		checkNonElements = base && dir === "parentNode",
		doneName = done++;

	return combinator.first ?
		// Check against closest ancestor/preceding element
		function( elem, context, xml ) {
			while ( (elem = elem[ dir ]) ) {
				if ( elem.nodeType === 1 || checkNonElements ) {
					return matcher( elem, context, xml );
				}
			}
		} :

		// Check against all ancestor/preceding elements
		function( elem, context, xml ) {
			var oldCache, outerCache,
				newCache = [ dirruns, doneName ];

			// We can't set arbitrary data on XML nodes, so they don't benefit from dir caching
			if ( xml ) {
				while ( (elem = elem[ dir ]) ) {
					if ( elem.nodeType === 1 || checkNonElements ) {
						if ( matcher( elem, context, xml ) ) {
							return true;
						}
					}
				}
			} else {
				while ( (elem = elem[ dir ]) ) {
					if ( elem.nodeType === 1 || checkNonElements ) {
						outerCache = elem[ expando ] || (elem[ expando ] = {});
						if ( (oldCache = outerCache[ dir ]) &&
							oldCache[ 0 ] === dirruns && oldCache[ 1 ] === doneName ) {

							// Assign to newCache so results back-propagate to previous elements
							return (newCache[ 2 ] = oldCache[ 2 ]);
						} else {
							// Reuse newcache so results back-propagate to previous elements
							outerCache[ dir ] = newCache;

							// A match means we're done; a fail means we have to keep checking
							if ( (newCache[ 2 ] = matcher( elem, context, xml )) ) {
								return true;
							}
						}
					}
				}
			}
		};
}

function elementMatcher( matchers ) {
	return matchers.length > 1 ?
		function( elem, context, xml ) {
			var i = matchers.length;
			while ( i-- ) {
				if ( !matchers[i]( elem, context, xml ) ) {
					return false;
				}
			}
			return true;
		} :
		matchers[0];
}

function multipleContexts( selector, contexts, results ) {
	var i = 0,
		len = contexts.length;
	for ( ; i < len; i++ ) {
		Sizzle( selector, contexts[i], results );
	}
	return results;
}

function condense( unmatched, map, filter, context, xml ) {
	var elem,
		newUnmatched = [],
		i = 0,
		len = unmatched.length,
		mapped = map != null;

	for ( ; i < len; i++ ) {
		if ( (elem = unmatched[i]) ) {
			if ( !filter || filter( elem, context, xml ) ) {
				newUnmatched.push( elem );
				if ( mapped ) {
					map.push( i );
				}
			}
		}
	}

	return newUnmatched;
}

function setMatcher( preFilter, selector, matcher, postFilter, postFinder, postSelector ) {
	if ( postFilter && !postFilter[ expando ] ) {
		postFilter = setMatcher( postFilter );
	}
	if ( postFinder && !postFinder[ expando ] ) {
		postFinder = setMatcher( postFinder, postSelector );
	}
	return markFunction(function( seed, results, context, xml ) {
		var temp, i, elem,
			preMap = [],
			postMap = [],
			preexisting = results.length,

			// Get initial elements from seed or context
			elems = seed || multipleContexts( selector || "*", context.nodeType ? [ context ] : context, [] ),

			// Prefilter to get matcher input, preserving a map for seed-results synchronization
			matcherIn = preFilter && ( seed || !selector ) ?
				condense( elems, preMap, preFilter, context, xml ) :
				elems,

			matcherOut = matcher ?
				// If we have a postFinder, or filtered seed, or non-seed postFilter or preexisting results,
				postFinder || ( seed ? preFilter : preexisting || postFilter ) ?

					// ...intermediate processing is necessary
					[] :

					// ...otherwise use results directly
					results :
				matcherIn;

		// Find primary matches
		if ( matcher ) {
			matcher( matcherIn, matcherOut, context, xml );
		}

		// Apply postFilter
		if ( postFilter ) {
			temp = condense( matcherOut, postMap );
			postFilter( temp, [], context, xml );

			// Un-match failing elements by moving them back to matcherIn
			i = temp.length;
			while ( i-- ) {
				if ( (elem = temp[i]) ) {
					matcherOut[ postMap[i] ] = !(matcherIn[ postMap[i] ] = elem);
				}
			}
		}

		if ( seed ) {
			if ( postFinder || preFilter ) {
				if ( postFinder ) {
					// Get the final matcherOut by condensing this intermediate into postFinder contexts
					temp = [];
					i = matcherOut.length;
					while ( i-- ) {
						if ( (elem = matcherOut[i]) ) {
							// Restore matcherIn since elem is not yet a final match
							temp.push( (matcherIn[i] = elem) );
						}
					}
					postFinder( null, (matcherOut = []), temp, xml );
				}

				// Move matched elements from seed to results to keep them synchronized
				i = matcherOut.length;
				while ( i-- ) {
					if ( (elem = matcherOut[i]) &&
						(temp = postFinder ? indexOf( seed, elem ) : preMap[i]) > -1 ) {

						seed[temp] = !(results[temp] = elem);
					}
				}
			}

		// Add elements to results, through postFinder if defined
		} else {
			matcherOut = condense(
				matcherOut === results ?
					matcherOut.splice( preexisting, matcherOut.length ) :
					matcherOut
			);
			if ( postFinder ) {
				postFinder( null, results, matcherOut, xml );
			} else {
				push.apply( results, matcherOut );
			}
		}
	});
}

function matcherFromTokens( tokens ) {
	var checkContext, matcher, j,
		len = tokens.length,
		leadingRelative = Expr.relative[ tokens[0].type ],
		implicitRelative = leadingRelative || Expr.relative[" "],
		i = leadingRelative ? 1 : 0,

		// The foundational matcher ensures that elements are reachable from top-level context(s)
		matchContext = addCombinator( function( elem ) {
			return elem === checkContext;
		}, implicitRelative, true ),
		matchAnyContext = addCombinator( function( elem ) {
			return indexOf( checkContext, elem ) > -1;
		}, implicitRelative, true ),
		matchers = [ function( elem, context, xml ) {
			var ret = ( !leadingRelative && ( xml || context !== outermostContext ) ) || (
				(checkContext = context).nodeType ?
					matchContext( elem, context, xml ) :
					matchAnyContext( elem, context, xml ) );
			// Avoid hanging onto element (issue #299)
			checkContext = null;
			return ret;
		} ];

	for ( ; i < len; i++ ) {
		if ( (matcher = Expr.relative[ tokens[i].type ]) ) {
			matchers = [ addCombinator(elementMatcher( matchers ), matcher) ];
		} else {
			matcher = Expr.filter[ tokens[i].type ].apply( null, tokens[i].matches );

			// Return special upon seeing a positional matcher
			if ( matcher[ expando ] ) {
				// Find the next relative operator (if any) for proper handling
				j = ++i;
				for ( ; j < len; j++ ) {
					if ( Expr.relative[ tokens[j].type ] ) {
						break;
					}
				}
				return setMatcher(
					i > 1 && elementMatcher( matchers ),
					i > 1 && toSelector(
						// If the preceding token was a descendant combinator, insert an implicit any-element `*`
						tokens.slice( 0, i - 1 ).concat({ value: tokens[ i - 2 ].type === " " ? "*" : "" })
					).replace( rtrim, "$1" ),
					matcher,
					i < j && matcherFromTokens( tokens.slice( i, j ) ),
					j < len && matcherFromTokens( (tokens = tokens.slice( j )) ),
					j < len && toSelector( tokens )
				);
			}
			matchers.push( matcher );
		}
	}

	return elementMatcher( matchers );
}

function matcherFromGroupMatchers( elementMatchers, setMatchers ) {
	var bySet = setMatchers.length > 0,
		byElement = elementMatchers.length > 0,
		superMatcher = function( seed, context, xml, results, outermost ) {
			var elem, j, matcher,
				matchedCount = 0,
				i = "0",
				unmatched = seed && [],
				setMatched = [],
				contextBackup = outermostContext,
				// We must always have either seed elements or outermost context
				elems = seed || byElement && Expr.find["TAG"]( "*", outermost ),
				// Use integer dirruns iff this is the outermost matcher
				dirrunsUnique = (dirruns += contextBackup == null ? 1 : Math.random() || 0.1),
				len = elems.length;

			if ( outermost ) {
				outermostContext = context !== document && context;
			}

			// Add elements passing elementMatchers directly to results
			// Keep `i` a string if there are no elements so `matchedCount` will be "00" below
			// Support: IE<9, Safari
			// Tolerate NodeList properties (IE: "length"; Safari: <number>) matching elements by id
			for ( ; i !== len && (elem = elems[i]) != null; i++ ) {
				if ( byElement && elem ) {
					j = 0;
					while ( (matcher = elementMatchers[j++]) ) {
						if ( matcher( elem, context, xml ) ) {
							results.push( elem );
							break;
						}
					}
					if ( outermost ) {
						dirruns = dirrunsUnique;
					}
				}

				// Track unmatched elements for set filters
				if ( bySet ) {
					// They will have gone through all possible matchers
					if ( (elem = !matcher && elem) ) {
						matchedCount--;
					}

					// Lengthen the array for every element, matched or not
					if ( seed ) {
						unmatched.push( elem );
					}
				}
			}

			// Apply set filters to unmatched elements
			matchedCount += i;
			if ( bySet && i !== matchedCount ) {
				j = 0;
				while ( (matcher = setMatchers[j++]) ) {
					matcher( unmatched, setMatched, context, xml );
				}

				if ( seed ) {
					// Reintegrate element matches to eliminate the need for sorting
					if ( matchedCount > 0 ) {
						while ( i-- ) {
							if ( !(unmatched[i] || setMatched[i]) ) {
								setMatched[i] = pop.call( results );
							}
						}
					}

					// Discard index placeholder values to get only actual matches
					setMatched = condense( setMatched );
				}

				// Add matches to results
				push.apply( results, setMatched );

				// Seedless set matches succeeding multiple successful matchers stipulate sorting
				if ( outermost && !seed && setMatched.length > 0 &&
					( matchedCount + setMatchers.length ) > 1 ) {

					Sizzle.uniqueSort( results );
				}
			}

			// Override manipulation of globals by nested matchers
			if ( outermost ) {
				dirruns = dirrunsUnique;
				outermostContext = contextBackup;
			}

			return unmatched;
		};

	return bySet ?
		markFunction( superMatcher ) :
		superMatcher;
}

compile = Sizzle.compile = function( selector, match /* Internal Use Only */ ) {
	var i,
		setMatchers = [],
		elementMatchers = [],
		cached = compilerCache[ selector + " " ];

	if ( !cached ) {
		// Generate a function of recursive functions that can be used to check each element
		if ( !match ) {
			match = tokenize( selector );
		}
		i = match.length;
		while ( i-- ) {
			cached = matcherFromTokens( match[i] );
			if ( cached[ expando ] ) {
				setMatchers.push( cached );
			} else {
				elementMatchers.push( cached );
			}
		}

		// Cache the compiled function
		cached = compilerCache( selector, matcherFromGroupMatchers( elementMatchers, setMatchers ) );

		// Save selector and tokenization
		cached.selector = selector;
	}
	return cached;
};

/**
 * A low-level selection function that works with Sizzle's compiled
 *  selector functions
 * @param {String|Function} selector A selector or a pre-compiled
 *  selector function built with Sizzle.compile
 * @param {Element} context
 * @param {Array} [results]
 * @param {Array} [seed] A set of elements to match against
 */
select = Sizzle.select = function( selector, context, results, seed ) {
	var i, tokens, token, type, find,
		compiled = typeof selector === "function" && selector,
		match = !seed && tokenize( (selector = compiled.selector || selector) );

	results = results || [];

	// Try to minimize operations if there is no seed and only one group
	if ( match.length === 1 ) {

		// Take a shortcut and set the context if the root selector is an ID
		tokens = match[0] = match[0].slice( 0 );
		if ( tokens.length > 2 && (token = tokens[0]).type === "ID" &&
				support.getById && context.nodeType === 9 && documentIsHTML &&
				Expr.relative[ tokens[1].type ] ) {

			context = ( Expr.find["ID"]( token.matches[0].replace(runescape, funescape), context ) || [] )[0];
			if ( !context ) {
				return results;

			// Precompiled matchers will still verify ancestry, so step up a level
			} else if ( compiled ) {
				context = context.parentNode;
			}

			selector = selector.slice( tokens.shift().value.length );
		}

		// Fetch a seed set for right-to-left matching
		i = matchExpr["needsContext"].test( selector ) ? 0 : tokens.length;
		while ( i-- ) {
			token = tokens[i];

			// Abort if we hit a combinator
			if ( Expr.relative[ (type = token.type) ] ) {
				break;
			}
			if ( (find = Expr.find[ type ]) ) {
				// Search, expanding context for leading sibling combinators
				if ( (seed = find(
					token.matches[0].replace( runescape, funescape ),
					rsibling.test( tokens[0].type ) && testContext( context.parentNode ) || context
				)) ) {

					// If seed is empty or no tokens remain, we can return early
					tokens.splice( i, 1 );
					selector = seed.length && toSelector( tokens );
					if ( !selector ) {
						push.apply( results, seed );
						return results;
					}

					break;
				}
			}
		}
	}

	// Compile and execute a filtering function if one is not provided
	// Provide `match` to avoid retokenization if we modified the selector above
	( compiled || compile( selector, match ) )(
		seed,
		context,
		!documentIsHTML,
		results,
		rsibling.test( selector ) && testContext( context.parentNode ) || context
	);
	return results;
};

// One-time assignments

// Sort stability
support.sortStable = expando.split("").sort( sortOrder ).join("") === expando;

// Support: Chrome 14-35+
// Always assume duplicates if they aren't passed to the comparison function
support.detectDuplicates = !!hasDuplicate;

// Initialize against the default document
setDocument();

// Support: Webkit<537.32 - Safari 6.0.3/Chrome 25 (fixed in Chrome 27)
// Detached nodes confoundingly follow *each other*
support.sortDetached = assert(function( div1 ) {
	// Should return 1, but returns 4 (following)
	return div1.compareDocumentPosition( document.createElement("div") ) & 1;
});

// Support: IE<8
// Prevent attribute/property "interpolation"
// http://msdn.microsoft.com/en-us/library/ms536429%28VS.85%29.aspx
if ( !assert(function( div ) {
	div.innerHTML = "<a href='#'></a>";
	return div.firstChild.getAttribute("href") === "#" ;
}) ) {
	addHandle( "type|href|height|width", function( elem, name, isXML ) {
		if ( !isXML ) {
			return elem.getAttribute( name, name.toLowerCase() === "type" ? 1 : 2 );
		}
	});
}

// Support: IE<9
// Use defaultValue in place of getAttribute("value")
if ( !support.attributes || !assert(function( div ) {
	div.innerHTML = "<input/>";
	div.firstChild.setAttribute( "value", "" );
	return div.firstChild.getAttribute( "value" ) === "";
}) ) {
	addHandle( "value", function( elem, name, isXML ) {
		if ( !isXML && elem.nodeName.toLowerCase() === "input" ) {
			return elem.defaultValue;
		}
	});
}

// Support: IE<9
// Use getAttributeNode to fetch booleans when getAttribute lies
if ( !assert(function( div ) {
	return div.getAttribute("disabled") == null;
}) ) {
	addHandle( booleans, function( elem, name, isXML ) {
		var val;
		if ( !isXML ) {
			return elem[ name ] === true ? name.toLowerCase() :
					(val = elem.getAttributeNode( name )) && val.specified ?
					val.value :
				null;
		}
	});
}

return Sizzle;

})( window );



jQuery.find = Sizzle;
jQuery.expr = Sizzle.selectors;
jQuery.expr[":"] = jQuery.expr.pseudos;
jQuery.unique = Sizzle.uniqueSort;
jQuery.text = Sizzle.getText;
jQuery.isXMLDoc = Sizzle.isXML;
jQuery.contains = Sizzle.contains;



var rneedsContext = jQuery.expr.match.needsContext;

var rsingleTag = (/^<(\w+)\s*\/?>(?:<\/\1>|)$/);



var risSimple = /^.[^:#\[\.,]*$/;

// Implement the identical functionality for filter and not
function winnow( elements, qualifier, not ) {
	if ( jQuery.isFunction( qualifier ) ) {
		return jQuery.grep( elements, function( elem, i ) {
			/* jshint -W018 */
			return !!qualifier.call( elem, i, elem ) !== not;
		});

	}

	if ( qualifier.nodeType ) {
		return jQuery.grep( elements, function( elem ) {
			return ( elem === qualifier ) !== not;
		});

	}

	if ( typeof qualifier === "string" ) {
		if ( risSimple.test( qualifier ) ) {
			return jQuery.filter( qualifier, elements, not );
		}

		qualifier = jQuery.filter( qualifier, elements );
	}

	return jQuery.grep( elements, function( elem ) {
		return ( indexOf.call( qualifier, elem ) >= 0 ) !== not;
	});
}

jQuery.filter = function( expr, elems, not ) {
	var elem = elems[ 0 ];

	if ( not ) {
		expr = ":not(" + expr + ")";
	}

	return elems.length === 1 && elem.nodeType === 1 ?
		jQuery.find.matchesSelector( elem, expr ) ? [ elem ] : [] :
		jQuery.find.matches( expr, jQuery.grep( elems, function( elem ) {
			return elem.nodeType === 1;
		}));
};

jQuery.fn.extend({
	find: function( selector ) {
		var i,
			len = this.length,
			ret = [],
			self = this;

		if ( typeof selector !== "string" ) {
			return this.pushStack( jQuery( selector ).filter(function() {
				for ( i = 0; i < len; i++ ) {
					if ( jQuery.contains( self[ i ], this ) ) {
						return true;
					}
				}
			}) );
		}

		for ( i = 0; i < len; i++ ) {
			jQuery.find( selector, self[ i ], ret );
		}

		// Needed because $( selector, context ) becomes $( context ).find( selector )
		ret = this.pushStack( len > 1 ? jQuery.unique( ret ) : ret );
		ret.selector = this.selector ? this.selector + " " + selector : selector;
		return ret;
	},
	filter: function( selector ) {
		return this.pushStack( winnow(this, selector || [], false) );
	},
	not: function( selector ) {
		return this.pushStack( winnow(this, selector || [], true) );
	},
	is: function( selector ) {
		return !!winnow(
			this,

			// If this is a positional/relative selector, check membership in the returned set
			// so $("p:first").is("p:last") won't return true for a doc with two "p".
			typeof selector === "string" && rneedsContext.test( selector ) ?
				jQuery( selector ) :
				selector || [],
			false
		).length;
	}
});


// Initialize a jQuery object


// A central reference to the root jQuery(document)
var rootjQuery,

	// A simple way to check for HTML strings
	// Prioritize #id over <tag> to avoid XSS via location.hash (#9521)
	// Strict HTML recognition (#11290: must start with <)
	rquickExpr = /^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/,

	init = jQuery.fn.init = function( selector, context ) {
		var match, elem;

		// HANDLE: $(""), $(null), $(undefined), $(false)
		if ( !selector ) {
			return this;
		}

		// Handle HTML strings
		if ( typeof selector === "string" ) {
			if ( selector[0] === "<" && selector[ selector.length - 1 ] === ">" && selector.length >= 3 ) {
				// Assume that strings that start and end with <> are HTML and skip the regex check
				match = [ null, selector, null ];

			} else {
				match = rquickExpr.exec( selector );
			}

			// Match html or make sure no context is specified for #id
			if ( match && (match[1] || !context) ) {

				// HANDLE: $(html) -> $(array)
				if ( match[1] ) {
					context = context instanceof jQuery ? context[0] : context;

					// Option to run scripts is true for back-compat
					// Intentionally let the error be thrown if parseHTML is not present
					jQuery.merge( this, jQuery.parseHTML(
						match[1],
						context && context.nodeType ? context.ownerDocument || context : document,
						true
					) );

					// HANDLE: $(html, props)
					if ( rsingleTag.test( match[1] ) && jQuery.isPlainObject( context ) ) {
						for ( match in context ) {
							// Properties of context are called as methods if possible
							if ( jQuery.isFunction( this[ match ] ) ) {
								this[ match ]( context[ match ] );

							// ...and otherwise set as attributes
							} else {
								this.attr( match, context[ match ] );
							}
						}
					}

					return this;

				// HANDLE: $(#id)
				} else {
					elem = document.getElementById( match[2] );

					// Support: Blackberry 4.6
					// gEBID returns nodes no longer in the document (#6963)
					if ( elem && elem.parentNode ) {
						// Inject the element directly into the jQuery object
						this.length = 1;
						this[0] = elem;
					}

					this.context = document;
					this.selector = selector;
					return this;
				}

			// HANDLE: $(expr, $(...))
			} else if ( !context || context.jquery ) {
				return ( context || rootjQuery ).find( selector );

			// HANDLE: $(expr, context)
			// (which is just equivalent to: $(context).find(expr)
			} else {
				return this.constructor( context ).find( selector );
			}

		// HANDLE: $(DOMElement)
		} else if ( selector.nodeType ) {
			this.context = this[0] = selector;
			this.length = 1;
			return this;

		// HANDLE: $(function)
		// Shortcut for document ready
		} else if ( jQuery.isFunction( selector ) ) {
			return typeof rootjQuery.ready !== "undefined" ?
				rootjQuery.ready( selector ) :
				// Execute immediately if ready is not present
				selector( jQuery );
		}

		if ( selector.selector !== undefined ) {
			this.selector = selector.selector;
			this.context = selector.context;
		}

		return jQuery.makeArray( selector, this );
	};

// Give the init function the jQuery prototype for later instantiation
init.prototype = jQuery.fn;

// Initialize central reference
rootjQuery = jQuery( document );


var rparentsprev = /^(?:parents|prev(?:Until|All))/,
	// Methods guaranteed to produce a unique set when starting from a unique set
	guaranteedUnique = {
		children: true,
		contents: true,
		next: true,
		prev: true
	};

jQuery.extend({
	dir: function( elem, dir, until ) {
		var matched = [],
			truncate = until !== undefined;

		while ( (elem = elem[ dir ]) && elem.nodeType !== 9 ) {
			if ( elem.nodeType === 1 ) {
				if ( truncate && jQuery( elem ).is( until ) ) {
					break;
				}
				matched.push( elem );
			}
		}
		return matched;
	},

	sibling: function( n, elem ) {
		var matched = [];

		for ( ; n; n = n.nextSibling ) {
			if ( n.nodeType === 1 && n !== elem ) {
				matched.push( n );
			}
		}

		return matched;
	}
});

jQuery.fn.extend({
	has: function( target ) {
		var targets = jQuery( target, this ),
			l = targets.length;

		return this.filter(function() {
			var i = 0;
			for ( ; i < l; i++ ) {
				if ( jQuery.contains( this, targets[i] ) ) {
					return true;
				}
			}
		});
	},

	closest: function( selectors, context ) {
		var cur,
			i = 0,
			l = this.length,
			matched = [],
			pos = rneedsContext.test( selectors ) || typeof selectors !== "string" ?
				jQuery( selectors, context || this.context ) :
				0;

		for ( ; i < l; i++ ) {
			for ( cur = this[i]; cur && cur !== context; cur = cur.parentNode ) {
				// Always skip document fragments
				if ( cur.nodeType < 11 && (pos ?
					pos.index(cur) > -1 :

					// Don't pass non-elements to Sizzle
					cur.nodeType === 1 &&
						jQuery.find.matchesSelector(cur, selectors)) ) {

					matched.push( cur );
					break;
				}
			}
		}

		return this.pushStack( matched.length > 1 ? jQuery.unique( matched ) : matched );
	},

	// Determine the position of an element within the set
	index: function( elem ) {

		// No argument, return index in parent
		if ( !elem ) {
			return ( this[ 0 ] && this[ 0 ].parentNode ) ? this.first().prevAll().length : -1;
		}

		// Index in selector
		if ( typeof elem === "string" ) {
			return indexOf.call( jQuery( elem ), this[ 0 ] );
		}

		// Locate the position of the desired element
		return indexOf.call( this,

			// If it receives a jQuery object, the first element is used
			elem.jquery ? elem[ 0 ] : elem
		);
	},

	add: function( selector, context ) {
		return this.pushStack(
			jQuery.unique(
				jQuery.merge( this.get(), jQuery( selector, context ) )
			)
		);
	},

	addBack: function( selector ) {
		return this.add( selector == null ?
			this.prevObject : this.prevObject.filter(selector)
		);
	}
});

function sibling( cur, dir ) {
	while ( (cur = cur[dir]) && cur.nodeType !== 1 ) {}
	return cur;
}

jQuery.each({
	parent: function( elem ) {
		var parent = elem.parentNode;
		return parent && parent.nodeType !== 11 ? parent : null;
	},
	parents: function( elem ) {
		return jQuery.dir( elem, "parentNode" );
	},
	parentsUntil: function( elem, i, until ) {
		return jQuery.dir( elem, "parentNode", until );
	},
	next: function( elem ) {
		return sibling( elem, "nextSibling" );
	},
	prev: function( elem ) {
		return sibling( elem, "previousSibling" );
	},
	nextAll: function( elem ) {
		return jQuery.dir( elem, "nextSibling" );
	},
	prevAll: function( elem ) {
		return jQuery.dir( elem, "previousSibling" );
	},
	nextUntil: function( elem, i, until ) {
		return jQuery.dir( elem, "nextSibling", until );
	},
	prevUntil: function( elem, i, until ) {
		return jQuery.dir( elem, "previousSibling", until );
	},
	siblings: function( elem ) {
		return jQuery.sibling( ( elem.parentNode || {} ).firstChild, elem );
	},
	children: function( elem ) {
		return jQuery.sibling( elem.firstChild );
	},
	contents: function( elem ) {
		return elem.contentDocument || jQuery.merge( [], elem.childNodes );
	}
}, function( name, fn ) {
	jQuery.fn[ name ] = function( until, selector ) {
		var matched = jQuery.map( this, fn, until );

		if ( name.slice( -5 ) !== "Until" ) {
			selector = until;
		}

		if ( selector && typeof selector === "string" ) {
			matched = jQuery.filter( selector, matched );
		}

		if ( this.length > 1 ) {
			// Remove duplicates
			if ( !guaranteedUnique[ name ] ) {
				jQuery.unique( matched );
			}

			// Reverse order for parents* and prev-derivatives
			if ( rparentsprev.test( name ) ) {
				matched.reverse();
			}
		}

		return this.pushStack( matched );
	};
});
var rnotwhite = (/\S+/g);



// String to Object options format cache
var optionsCache = {};

// Convert String-formatted options into Object-formatted ones and store in cache
function createOptions( options ) {
	var object = optionsCache[ options ] = {};
	jQuery.each( options.match( rnotwhite ) || [], function( _, flag ) {
		object[ flag ] = true;
	});
	return object;
}

/*
 * Create a callback list using the following parameters:
 *
 *	options: an optional list of space-separated options that will change how
 *			the callback list behaves or a more traditional option object
 *
 * By default a callback list will act like an event callback list and can be
 * "fired" multiple times.
 *
 * Possible options:
 *
 *	once:			will ensure the callback list can only be fired once (like a Deferred)
 *
 *	memory:			will keep track of previous values and will call any callback added
 *					after the list has been fired right away with the latest "memorized"
 *					values (like a Deferred)
 *
 *	unique:			will ensure a callback can only be added once (no duplicate in the list)
 *
 *	stopOnFalse:	interrupt callings when a callback returns false
 *
 */
jQuery.Callbacks = function( options ) {

	// Convert options from String-formatted to Object-formatted if needed
	// (we check in cache first)
	options = typeof options === "string" ?
		( optionsCache[ options ] || createOptions( options ) ) :
		jQuery.extend( {}, options );

	var // Last fire value (for non-forgettable lists)
		memory,
		// Flag to know if list was already fired
		fired,
		// Flag to know if list is currently firing
		firing,
		// First callback to fire (used internally by add and fireWith)
		firingStart,
		// End of the loop when firing
		firingLength,
		// Index of currently firing callback (modified by remove if needed)
		firingIndex,
		// Actual callback list
		list = [],
		// Stack of fire calls for repeatable lists
		stack = !options.once && [],
		// Fire callbacks
		fire = function( data ) {
			memory = options.memory && data;
			fired = true;
			firingIndex = firingStart || 0;
			firingStart = 0;
			firingLength = list.length;
			firing = true;
			for ( ; list && firingIndex < firingLength; firingIndex++ ) {
				if ( list[ firingIndex ].apply( data[ 0 ], data[ 1 ] ) === false && options.stopOnFalse ) {
					memory = false; // To prevent further calls using add
					break;
				}
			}
			firing = false;
			if ( list ) {
				if ( stack ) {
					if ( stack.length ) {
						fire( stack.shift() );
					}
				} else if ( memory ) {
					list = [];
				} else {
					self.disable();
				}
			}
		},
		// Actual Callbacks object
		self = {
			// Add a callback or a collection of callbacks to the list
			add: function() {
				if ( list ) {
					// First, we save the current length
					var start = list.length;
					(function add( args ) {
						jQuery.each( args, function( _, arg ) {
							var type = jQuery.type( arg );
							if ( type === "function" ) {
								if ( !options.unique || !self.has( arg ) ) {
									list.push( arg );
								}
							} else if ( arg && arg.length && type !== "string" ) {
								// Inspect recursively
								add( arg );
							}
						});
					})( arguments );
					// Do we need to add the callbacks to the
					// current firing batch?
					if ( firing ) {
						firingLength = list.length;
					// With memory, if we're not firing then
					// we should call right away
					} else if ( memory ) {
						firingStart = start;
						fire( memory );
					}
				}
				return this;
			},
			// Remove a callback from the list
			remove: function() {
				if ( list ) {
					jQuery.each( arguments, function( _, arg ) {
						var index;
						while ( ( index = jQuery.inArray( arg, list, index ) ) > -1 ) {
							list.splice( index, 1 );
							// Handle firing indexes
							if ( firing ) {
								if ( index <= firingLength ) {
									firingLength--;
								}
								if ( index <= firingIndex ) {
									firingIndex--;
								}
							}
						}
					});
				}
				return this;
			},
			// Check if a given callback is in the list.
			// If no argument is given, return whether or not list has callbacks attached.
			has: function( fn ) {
				return fn ? jQuery.inArray( fn, list ) > -1 : !!( list && list.length );
			},
			// Remove all callbacks from the list
			empty: function() {
				list = [];
				firingLength = 0;
				return this;
			},
			// Have the list do nothing anymore
			disable: function() {
				list = stack = memory = undefined;
				return this;
			},
			// Is it disabled?
			disabled: function() {
				return !list;
			},
			// Lock the list in its current state
			lock: function() {
				stack = undefined;
				if ( !memory ) {
					self.disable();
				}
				return this;
			},
			// Is it locked?
			locked: function() {
				return !stack;
			},
			// Call all callbacks with the given context and arguments
			fireWith: function( context, args ) {
				if ( list && ( !fired || stack ) ) {
					args = args || [];
					args = [ context, args.slice ? args.slice() : args ];
					if ( firing ) {
						stack.push( args );
					} else {
						fire( args );
					}
				}
				return this;
			},
			// Call all the callbacks with the given arguments
			fire: function() {
				self.fireWith( this, arguments );
				return this;
			},
			// To know if the callbacks have already been called at least once
			fired: function() {
				return !!fired;
			}
		};

	return self;
};


jQuery.extend({

	Deferred: function( func ) {
		var tuples = [
				// action, add listener, listener list, final state
				[ "resolve", "done", jQuery.Callbacks("once memory"), "resolved" ],
				[ "reject", "fail", jQuery.Callbacks("once memory"), "rejected" ],
				[ "notify", "progress", jQuery.Callbacks("memory") ]
			],
			state = "pending",
			promise = {
				state: function() {
					return state;
				},
				always: function() {
					deferred.done( arguments ).fail( arguments );
					return this;
				},
				then: function( /* fnDone, fnFail, fnProgress */ ) {
					var fns = arguments;
					return jQuery.Deferred(function( newDefer ) {
						jQuery.each( tuples, function( i, tuple ) {
							var fn = jQuery.isFunction( fns[ i ] ) && fns[ i ];
							// deferred[ done | fail | progress ] for forwarding actions to newDefer
							deferred[ tuple[1] ](function() {
								var returned = fn && fn.apply( this, arguments );
								if ( returned && jQuery.isFunction( returned.promise ) ) {
									returned.promise()
										.done( newDefer.resolve )
										.fail( newDefer.reject )
										.progress( newDefer.notify );
								} else {
									newDefer[ tuple[ 0 ] + "With" ]( this === promise ? newDefer.promise() : this, fn ? [ returned ] : arguments );
								}
							});
						});
						fns = null;
					}).promise();
				},
				// Get a promise for this deferred
				// If obj is provided, the promise aspect is added to the object
				promise: function( obj ) {
					return obj != null ? jQuery.extend( obj, promise ) : promise;
				}
			},
			deferred = {};

		// Keep pipe for back-compat
		promise.pipe = promise.then;

		// Add list-specific methods
		jQuery.each( tuples, function( i, tuple ) {
			var list = tuple[ 2 ],
				stateString = tuple[ 3 ];

			// promise[ done | fail | progress ] = list.add
			promise[ tuple[1] ] = list.add;

			// Handle state
			if ( stateString ) {
				list.add(function() {
					// state = [ resolved | rejected ]
					state = stateString;

				// [ reject_list | resolve_list ].disable; progress_list.lock
				}, tuples[ i ^ 1 ][ 2 ].disable, tuples[ 2 ][ 2 ].lock );
			}

			// deferred[ resolve | reject | notify ]
			deferred[ tuple[0] ] = function() {
				deferred[ tuple[0] + "With" ]( this === deferred ? promise : this, arguments );
				return this;
			};
			deferred[ tuple[0] + "With" ] = list.fireWith;
		});

		// Make the deferred a promise
		promise.promise( deferred );

		// Call given func if any
		if ( func ) {
			func.call( deferred, deferred );
		}

		// All done!
		return deferred;
	},

	// Deferred helper
	when: function( subordinate /* , ..., subordinateN */ ) {
		var i = 0,
			resolveValues = slice.call( arguments ),
			length = resolveValues.length,

			// the count of uncompleted subordinates
			remaining = length !== 1 || ( subordinate && jQuery.isFunction( subordinate.promise ) ) ? length : 0,

			// the master Deferred. If resolveValues consist of only a single Deferred, just use that.
			deferred = remaining === 1 ? subordinate : jQuery.Deferred(),

			// Update function for both resolve and progress values
			updateFunc = function( i, contexts, values ) {
				return function( value ) {
					contexts[ i ] = this;
					values[ i ] = arguments.length > 1 ? slice.call( arguments ) : value;
					if ( values === progressValues ) {
						deferred.notifyWith( contexts, values );
					} else if ( !( --remaining ) ) {
						deferred.resolveWith( contexts, values );
					}
				};
			},

			progressValues, progressContexts, resolveContexts;

		// Add listeners to Deferred subordinates; treat others as resolved
		if ( length > 1 ) {
			progressValues = new Array( length );
			progressContexts = new Array( length );
			resolveContexts = new Array( length );
			for ( ; i < length; i++ ) {
				if ( resolveValues[ i ] && jQuery.isFunction( resolveValues[ i ].promise ) ) {
					resolveValues[ i ].promise()
						.done( updateFunc( i, resolveContexts, resolveValues ) )
						.fail( deferred.reject )
						.progress( updateFunc( i, progressContexts, progressValues ) );
				} else {
					--remaining;
				}
			}
		}

		// If we're not waiting on anything, resolve the master
		if ( !remaining ) {
			deferred.resolveWith( resolveContexts, resolveValues );
		}

		return deferred.promise();
	}
});


// The deferred used on DOM ready
var readyList;

jQuery.fn.ready = function( fn ) {
	// Add the callback
	jQuery.ready.promise().done( fn );

	return this;
};

jQuery.extend({
	// Is the DOM ready to be used? Set to true once it occurs.
	isReady: false,

	// A counter to track how many items to wait for before
	// the ready event fires. See #6781
	readyWait: 1,

	// Hold (or release) the ready event
	holdReady: function( hold ) {
		if ( hold ) {
			jQuery.readyWait++;
		} else {
			jQuery.ready( true );
		}
	},

	// Handle when the DOM is ready
	ready: function( wait ) {

		// Abort if there are pending holds or we're already ready
		if ( wait === true ? --jQuery.readyWait : jQuery.isReady ) {
			return;
		}

		// Remember that the DOM is ready
		jQuery.isReady = true;

		// If a normal DOM Ready event fired, decrement, and wait if need be
		if ( wait !== true && --jQuery.readyWait > 0 ) {
			return;
		}

		// If there are functions bound, to execute
		readyList.resolveWith( document, [ jQuery ] );

		// Trigger any bound ready events
		if ( jQuery.fn.triggerHandler ) {
			jQuery( document ).triggerHandler( "ready" );
			jQuery( document ).off( "ready" );
		}
	}
});

/**
 * The ready event handler and self cleanup method
 */
function completed() {
	document.removeEventListener( "DOMContentLoaded", completed, false );
	window.removeEventListener( "load", completed, false );
	jQuery.ready();
}

jQuery.ready.promise = function( obj ) {
	if ( !readyList ) {

		readyList = jQuery.Deferred();

		// Catch cases where $(document).ready() is called after the browser event has already occurred.
		// We once tried to use readyState "interactive" here, but it caused issues like the one
		// discovered by ChrisS here: http://bugs.jquery.com/ticket/12282#comment:15
		if ( document.readyState === "complete" ) {
			// Handle it asynchronously to allow scripts the opportunity to delay ready
			setTimeout( jQuery.ready );

		} else {

			// Use the handy event callback
			document.addEventListener( "DOMContentLoaded", completed, false );

			// A fallback to window.onload, that will always work
			window.addEventListener( "load", completed, false );
		}
	}
	return readyList.promise( obj );
};

// Kick off the DOM ready check even if the user does not
jQuery.ready.promise();




// Multifunctional method to get and set values of a collection
// The value/s can optionally be executed if it's a function
var access = jQuery.access = function( elems, fn, key, value, chainable, emptyGet, raw ) {
	var i = 0,
		len = elems.length,
		bulk = key == null;

	// Sets many values
	if ( jQuery.type( key ) === "object" ) {
		chainable = true;
		for ( i in key ) {
			jQuery.access( elems, fn, i, key[i], true, emptyGet, raw );
		}

	// Sets one value
	} else if ( value !== undefined ) {
		chainable = true;

		if ( !jQuery.isFunction( value ) ) {
			raw = true;
		}

		if ( bulk ) {
			// Bulk operations run against the entire set
			if ( raw ) {
				fn.call( elems, value );
				fn = null;

			// ...except when executing function values
			} else {
				bulk = fn;
				fn = function( elem, key, value ) {
					return bulk.call( jQuery( elem ), value );
				};
			}
		}

		if ( fn ) {
			for ( ; i < len; i++ ) {
				fn( elems[i], key, raw ? value : value.call( elems[i], i, fn( elems[i], key ) ) );
			}
		}
	}

	return chainable ?
		elems :

		// Gets
		bulk ?
			fn.call( elems ) :
			len ? fn( elems[0], key ) : emptyGet;
};


/**
 * Determines whether an object can have data
 */
jQuery.acceptData = function( owner ) {
	// Accepts only:
	//  - Node
	//    - Node.ELEMENT_NODE
	//    - Node.DOCUMENT_NODE
	//  - Object
	//    - Any
	/* jshint -W018 */
	return owner.nodeType === 1 || owner.nodeType === 9 || !( +owner.nodeType );
};


function Data() {
	// Support: Android<4,
	// Old WebKit does not have Object.preventExtensions/freeze method,
	// return new empty object instead with no [[set]] accessor
	Object.defineProperty( this.cache = {}, 0, {
		get: function() {
			return {};
		}
	});

	this.expando = jQuery.expando + Data.uid++;
}

Data.uid = 1;
Data.accepts = jQuery.acceptData;

Data.prototype = {
	key: function( owner ) {
		// We can accept data for non-element nodes in modern browsers,
		// but we should not, see #8335.
		// Always return the key for a frozen object.
		if ( !Data.accepts( owner ) ) {
			return 0;
		}

		var descriptor = {},
			// Check if the owner object already has a cache key
			unlock = owner[ this.expando ];

		// If not, create one
		if ( !unlock ) {
			unlock = Data.uid++;

			// Secure it in a non-enumerable, non-writable property
			try {
				descriptor[ this.expando ] = { value: unlock };
				Object.defineProperties( owner, descriptor );

			// Support: Android<4
			// Fallback to a less secure definition
			} catch ( e ) {
				descriptor[ this.expando ] = unlock;
				jQuery.extend( owner, descriptor );
			}
		}

		// Ensure the cache object
		if ( !this.cache[ unlock ] ) {
			this.cache[ unlock ] = {};
		}

		return unlock;
	},
	set: function( owner, data, value ) {
		var prop,
			// There may be an unlock assigned to this node,
			// if there is no entry for this "owner", create one inline
			// and set the unlock as though an owner entry had always existed
			unlock = this.key( owner ),
			cache = this.cache[ unlock ];

		// Handle: [ owner, key, value ] args
		if ( typeof data === "string" ) {
			cache[ data ] = value;

		// Handle: [ owner, { properties } ] args
		} else {
			// Fresh assignments by object are shallow copied
			if ( jQuery.isEmptyObject( cache ) ) {
				jQuery.extend( this.cache[ unlock ], data );
			// Otherwise, copy the properties one-by-one to the cache object
			} else {
				for ( prop in data ) {
					cache[ prop ] = data[ prop ];
				}
			}
		}
		return cache;
	},
	get: function( owner, key ) {
		// Either a valid cache is found, or will be created.
		// New caches will be created and the unlock returned,
		// allowing direct access to the newly created
		// empty data object. A valid owner object must be provided.
		var cache = this.cache[ this.key( owner ) ];

		return key === undefined ?
			cache : cache[ key ];
	},
	access: function( owner, key, value ) {
		var stored;
		// In cases where either:
		//
		//   1. No key was specified
		//   2. A string key was specified, but no value provided
		//
		// Take the "read" path and allow the get method to determine
		// which value to return, respectively either:
		//
		//   1. The entire cache object
		//   2. The data stored at the key
		//
		if ( key === undefined ||
				((key && typeof key === "string") && value === undefined) ) {

			stored = this.get( owner, key );

			return stored !== undefined ?
				stored : this.get( owner, jQuery.camelCase(key) );
		}

		// [*]When the key is not a string, or both a key and value
		// are specified, set or extend (existing objects) with either:
		//
		//   1. An object of properties
		//   2. A key and value
		//
		this.set( owner, key, value );

		// Since the "set" path can have two possible entry points
		// return the expected data based on which path was taken[*]
		return value !== undefined ? value : key;
	},
	remove: function( owner, key ) {
		var i, name, camel,
			unlock = this.key( owner ),
			cache = this.cache[ unlock ];

		if ( key === undefined ) {
			this.cache[ unlock ] = {};

		} else {
			// Support array or space separated string of keys
			if ( jQuery.isArray( key ) ) {
				// If "name" is an array of keys...
				// When data is initially created, via ("key", "val") signature,
				// keys will be converted to camelCase.
				// Since there is no way to tell _how_ a key was added, remove
				// both plain key and camelCase key. #12786
				// This will only penalize the array argument path.
				name = key.concat( key.map( jQuery.camelCase ) );
			} else {
				camel = jQuery.camelCase( key );
				// Try the string as a key before any manipulation
				if ( key in cache ) {
					name = [ key, camel ];
				} else {
					// If a key with the spaces exists, use it.
					// Otherwise, create an array by matching non-whitespace
					name = camel;
					name = name in cache ?
						[ name ] : ( name.match( rnotwhite ) || [] );
				}
			}

			i = name.length;
			while ( i-- ) {
				delete cache[ name[ i ] ];
			}
		}
	},
	hasData: function( owner ) {
		return !jQuery.isEmptyObject(
			this.cache[ owner[ this.expando ] ] || {}
		);
	},
	discard: function( owner ) {
		if ( owner[ this.expando ] ) {
			delete this.cache[ owner[ this.expando ] ];
		}
	}
};
var data_priv = new Data();

var data_user = new Data();



//	Implementation Summary
//
//	1. Enforce API surface and semantic compatibility with 1.9.x branch
//	2. Improve the module's maintainability by reducing the storage
//		paths to a single mechanism.
//	3. Use the same single mechanism to support "private" and "user" data.
//	4. _Never_ expose "private" data to user code (TODO: Drop _data, _removeData)
//	5. Avoid exposing implementation details on user objects (eg. expando properties)
//	6. Provide a clear path for implementation upgrade to WeakMap in 2014

var rbrace = /^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,
	rmultiDash = /([A-Z])/g;

function dataAttr( elem, key, data ) {
	var name;

	// If nothing was found internally, try to fetch any
	// data from the HTML5 data-* attribute
	if ( data === undefined && elem.nodeType === 1 ) {
		name = "data-" + key.replace( rmultiDash, "-$1" ).toLowerCase();
		data = elem.getAttribute( name );

		if ( typeof data === "string" ) {
			try {
				data = data === "true" ? true :
					data === "false" ? false :
					data === "null" ? null :
					// Only convert to a number if it doesn't change the string
					+data + "" === data ? +data :
					rbrace.test( data ) ? jQuery.parseJSON( data ) :
					data;
			} catch( e ) {}

			// Make sure we set the data so it isn't changed later
			data_user.set( elem, key, data );
		} else {
			data = undefined;
		}
	}
	return data;
}

jQuery.extend({
	hasData: function( elem ) {
		return data_user.hasData( elem ) || data_priv.hasData( elem );
	},

	data: function( elem, name, data ) {
		return data_user.access( elem, name, data );
	},

	removeData: function( elem, name ) {
		data_user.remove( elem, name );
	},

	// TODO: Now that all calls to _data and _removeData have been replaced
	// with direct calls to data_priv methods, these can be deprecated.
	_data: function( elem, name, data ) {
		return data_priv.access( elem, name, data );
	},

	_removeData: function( elem, name ) {
		data_priv.remove( elem, name );
	}
});

jQuery.fn.extend({
	data: function( key, value ) {
		var i, name, data,
			elem = this[ 0 ],
			attrs = elem && elem.attributes;

		// Gets all values
		if ( key === undefined ) {
			if ( this.length ) {
				data = data_user.get( elem );

				if ( elem.nodeType === 1 && !data_priv.get( elem, "hasDataAttrs" ) ) {
					i = attrs.length;
					while ( i-- ) {

						// Support: IE11+
						// The attrs elements can be null (#14894)
						if ( attrs[ i ] ) {
							name = attrs[ i ].name;
							if ( name.indexOf( "data-" ) === 0 ) {
								name = jQuery.camelCase( name.slice(5) );
								dataAttr( elem, name, data[ name ] );
							}
						}
					}
					data_priv.set( elem, "hasDataAttrs", true );
				}
			}

			return data;
		}

		// Sets multiple values
		if ( typeof key === "object" ) {
			return this.each(function() {
				data_user.set( this, key );
			});
		}

		return access( this, function( value ) {
			var data,
				camelKey = jQuery.camelCase( key );

			// The calling jQuery object (element matches) is not empty
			// (and therefore has an element appears at this[ 0 ]) and the
			// `value` parameter was not undefined. An empty jQuery object
			// will result in `undefined` for elem = this[ 0 ] which will
			// throw an exception if an attempt to read a data cache is made.
			if ( elem && value === undefined ) {
				// Attempt to get data from the cache
				// with the key as-is
				data = data_user.get( elem, key );
				if ( data !== undefined ) {
					return data;
				}

				// Attempt to get data from the cache
				// with the key camelized
				data = data_user.get( elem, camelKey );
				if ( data !== undefined ) {
					return data;
				}

				// Attempt to "discover" the data in
				// HTML5 custom data-* attrs
				data = dataAttr( elem, camelKey, undefined );
				if ( data !== undefined ) {
					return data;
				}

				// We tried really hard, but the data doesn't exist.
				return;
			}

			// Set the data...
			this.each(function() {
				// First, attempt to store a copy or reference of any
				// data that might've been store with a camelCased key.
				var data = data_user.get( this, camelKey );

				// For HTML5 data-* attribute interop, we have to
				// store property names with dashes in a camelCase form.
				// This might not apply to all properties...*
				data_user.set( this, camelKey, value );

				// *... In the case of properties that might _actually_
				// have dashes, we need to also store a copy of that
				// unchanged property.
				if ( key.indexOf("-") !== -1 && data !== undefined ) {
					data_user.set( this, key, value );
				}
			});
		}, null, value, arguments.length > 1, null, true );
	},

	removeData: function( key ) {
		return this.each(function() {
			data_user.remove( this, key );
		});
	}
});


jQuery.extend({
	queue: function( elem, type, data ) {
		var queue;

		if ( elem ) {
			type = ( type || "fx" ) + "queue";
			queue = data_priv.get( elem, type );

			// Speed up dequeue by getting out quickly if this is just a lookup
			if ( data ) {
				if ( !queue || jQuery.isArray( data ) ) {
					queue = data_priv.access( elem, type, jQuery.makeArray(data) );
				} else {
					queue.push( data );
				}
			}
			return queue || [];
		}
	},

	dequeue: function( elem, type ) {
		type = type || "fx";

		var queue = jQuery.queue( elem, type ),
			startLength = queue.length,
			fn = queue.shift(),
			hooks = jQuery._queueHooks( elem, type ),
			next = function() {
				jQuery.dequeue( elem, type );
			};

		// If the fx queue is dequeued, always remove the progress sentinel
		if ( fn === "inprogress" ) {
			fn = queue.shift();
			startLength--;
		}

		if ( fn ) {

			// Add a progress sentinel to prevent the fx queue from being
			// automatically dequeued
			if ( type === "fx" ) {
				queue.unshift( "inprogress" );
			}

			// Clear up the last queue stop function
			delete hooks.stop;
			fn.call( elem, next, hooks );
		}

		if ( !startLength && hooks ) {
			hooks.empty.fire();
		}
	},

	// Not public - generate a queueHooks object, or return the current one
	_queueHooks: function( elem, type ) {
		var key = type + "queueHooks";
		return data_priv.get( elem, key ) || data_priv.access( elem, key, {
			empty: jQuery.Callbacks("once memory").add(function() {
				data_priv.remove( elem, [ type + "queue", key ] );
			})
		});
	}
});

jQuery.fn.extend({
	queue: function( type, data ) {
		var setter = 2;

		if ( typeof type !== "string" ) {
			data = type;
			type = "fx";
			setter--;
		}

		if ( arguments.length < setter ) {
			return jQuery.queue( this[0], type );
		}

		return data === undefined ?
			this :
			this.each(function() {
				var queue = jQuery.queue( this, type, data );

				// Ensure a hooks for this queue
				jQuery._queueHooks( this, type );

				if ( type === "fx" && queue[0] !== "inprogress" ) {
					jQuery.dequeue( this, type );
				}
			});
	},
	dequeue: function( type ) {
		return this.each(function() {
			jQuery.dequeue( this, type );
		});
	},
	clearQueue: function( type ) {
		return this.queue( type || "fx", [] );
	},
	// Get a promise resolved when queues of a certain type
	// are emptied (fx is the type by default)
	promise: function( type, obj ) {
		var tmp,
			count = 1,
			defer = jQuery.Deferred(),
			elements = this,
			i = this.length,
			resolve = function() {
				if ( !( --count ) ) {
					defer.resolveWith( elements, [ elements ] );
				}
			};

		if ( typeof type !== "string" ) {
			obj = type;
			type = undefined;
		}
		type = type || "fx";

		while ( i-- ) {
			tmp = data_priv.get( elements[ i ], type + "queueHooks" );
			if ( tmp && tmp.empty ) {
				count++;
				tmp.empty.add( resolve );
			}
		}
		resolve();
		return defer.promise( obj );
	}
});
var pnum = (/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/).source;

var cssExpand = [ "Top", "Right", "Bottom", "Left" ];

var isHidden = function( elem, el ) {
		// isHidden might be called from jQuery#filter function;
		// in that case, element will be second argument
		elem = el || elem;
		return jQuery.css( elem, "display" ) === "none" || !jQuery.contains( elem.ownerDocument, elem );
	};

var rcheckableType = (/^(?:checkbox|radio)$/i);



(function() {
	var fragment = document.createDocumentFragment(),
		div = fragment.appendChild( document.createElement( "div" ) ),
		input = document.createElement( "input" );

	// Support: Safari<=5.1
	// Check state lost if the name is set (#11217)
	// Support: Windows Web Apps (WWA)
	// `name` and `type` must use .setAttribute for WWA (#14901)
	input.setAttribute( "type", "radio" );
	input.setAttribute( "checked", "checked" );
	input.setAttribute( "name", "t" );

	div.appendChild( input );

	// Support: Safari<=5.1, Android<4.2
	// Older WebKit doesn't clone checked state correctly in fragments
	support.checkClone = div.cloneNode( true ).cloneNode( true ).lastChild.checked;

	// Support: IE<=11+
	// Make sure textarea (and checkbox) defaultValue is properly cloned
	div.innerHTML = "<textarea>x</textarea>";
	support.noCloneChecked = !!div.cloneNode( true ).lastChild.defaultValue;
})();
var strundefined = typeof undefined;



support.focusinBubbles = "onfocusin" in window;


var
	rkeyEvent = /^key/,
	rmouseEvent = /^(?:mouse|pointer|contextmenu)|click/,
	rfocusMorph = /^(?:focusinfocus|focusoutblur)$/,
	rtypenamespace = /^([^.]*)(?:\.(.+)|)$/;

function returnTrue() {
	return true;
}

function returnFalse() {
	return false;
}

function safeActiveElement() {
	try {
		return document.activeElement;
	} catch ( err ) { }
}

/*
 * Helper functions for managing events -- not part of the public interface.
 * Props to Dean Edwards' addEvent library for many of the ideas.
 */
jQuery.event = {

	global: {},

	add: function( elem, types, handler, data, selector ) {

		var handleObjIn, eventHandle, tmp,
			events, t, handleObj,
			special, handlers, type, namespaces, origType,
			elemData = data_priv.get( elem );

		// Don't attach events to noData or text/comment nodes (but allow plain objects)
		if ( !elemData ) {
			return;
		}

		// Caller can pass in an object of custom data in lieu of the handler
		if ( handler.handler ) {
			handleObjIn = handler;
			handler = handleObjIn.handler;
			selector = handleObjIn.selector;
		}

		// Make sure that the handler has a unique ID, used to find/remove it later
		if ( !handler.guid ) {
			handler.guid = jQuery.guid++;
		}

		// Init the element's event structure and main handler, if this is the first
		if ( !(events = elemData.events) ) {
			events = elemData.events = {};
		}
		if ( !(eventHandle = elemData.handle) ) {
			eventHandle = elemData.handle = function( e ) {
				// Discard the second event of a jQuery.event.trigger() and
				// when an event is called after a page has unloaded
				return typeof jQuery !== strundefined && jQuery.event.triggered !== e.type ?
					jQuery.event.dispatch.apply( elem, arguments ) : undefined;
			};
		}

		// Handle multiple events separated by a space
		types = ( types || "" ).match( rnotwhite ) || [ "" ];
		t = types.length;
		while ( t-- ) {
			tmp = rtypenamespace.exec( types[t] ) || [];
			type = origType = tmp[1];
			namespaces = ( tmp[2] || "" ).split( "." ).sort();

			// There *must* be a type, no attaching namespace-only handlers
			if ( !type ) {
				continue;
			}

			// If event changes its type, use the special event handlers for the changed type
			special = jQuery.event.special[ type ] || {};

			// If selector defined, determine special event api type, otherwise given type
			type = ( selector ? special.delegateType : special.bindType ) || type;

			// Update special based on newly reset type
			special = jQuery.event.special[ type ] || {};

			// handleObj is passed to all event handlers
			handleObj = jQuery.extend({
				type: type,
				origType: origType,
				data: data,
				handler: handler,
				guid: handler.guid,
				selector: selector,
				needsContext: selector && jQuery.expr.match.needsContext.test( selector ),
				namespace: namespaces.join(".")
			}, handleObjIn );

			// Init the event handler queue if we're the first
			if ( !(handlers = events[ type ]) ) {
				handlers = events[ type ] = [];
				handlers.delegateCount = 0;

				// Only use addEventListener if the special events handler returns false
				if ( !special.setup || special.setup.call( elem, data, namespaces, eventHandle ) === false ) {
					if ( elem.addEventListener ) {
						elem.addEventListener( type, eventHandle, false );
					}
				}
			}

			if ( special.add ) {
				special.add.call( elem, handleObj );

				if ( !handleObj.handler.guid ) {
					handleObj.handler.guid = handler.guid;
				}
			}

			// Add to the element's handler list, delegates in front
			if ( selector ) {
				handlers.splice( handlers.delegateCount++, 0, handleObj );
			} else {
				handlers.push( handleObj );
			}

			// Keep track of which events have ever been used, for event optimization
			jQuery.event.global[ type ] = true;
		}

	},

	// Detach an event or set of events from an element
	remove: function( elem, types, handler, selector, mappedTypes ) {

		var j, origCount, tmp,
			events, t, handleObj,
			special, handlers, type, namespaces, origType,
			elemData = data_priv.hasData( elem ) && data_priv.get( elem );

		if ( !elemData || !(events = elemData.events) ) {
			return;
		}

		// Once for each type.namespace in types; type may be omitted
		types = ( types || "" ).match( rnotwhite ) || [ "" ];
		t = types.length;
		while ( t-- ) {
			tmp = rtypenamespace.exec( types[t] ) || [];
			type = origType = tmp[1];
			namespaces = ( tmp[2] || "" ).split( "." ).sort();

			// Unbind all events (on this namespace, if provided) for the element
			if ( !type ) {
				for ( type in events ) {
					jQuery.event.remove( elem, type + types[ t ], handler, selector, true );
				}
				continue;
			}

			special = jQuery.event.special[ type ] || {};
			type = ( selector ? special.delegateType : special.bindType ) || type;
			handlers = events[ type ] || [];
			tmp = tmp[2] && new RegExp( "(^|\\.)" + namespaces.join("\\.(?:.*\\.|)") + "(\\.|$)" );

			// Remove matching events
			origCount = j = handlers.length;
			while ( j-- ) {
				handleObj = handlers[ j ];

				if ( ( mappedTypes || origType === handleObj.origType ) &&
					( !handler || handler.guid === handleObj.guid ) &&
					( !tmp || tmp.test( handleObj.namespace ) ) &&
					( !selector || selector === handleObj.selector || selector === "**" && handleObj.selector ) ) {
					handlers.splice( j, 1 );

					if ( handleObj.selector ) {
						handlers.delegateCount--;
					}
					if ( special.remove ) {
						special.remove.call( elem, handleObj );
					}
				}
			}

			// Remove generic event handler if we removed something and no more handlers exist
			// (avoids potential for endless recursion during removal of special event handlers)
			if ( origCount && !handlers.length ) {
				if ( !special.teardown || special.teardown.call( elem, namespaces, elemData.handle ) === false ) {
					jQuery.removeEvent( elem, type, elemData.handle );
				}

				delete events[ type ];
			}
		}

		// Remove the expando if it's no longer used
		if ( jQuery.isEmptyObject( events ) ) {
			delete elemData.handle;
			data_priv.remove( elem, "events" );
		}
	},

	trigger: function( event, data, elem, onlyHandlers ) {

		var i, cur, tmp, bubbleType, ontype, handle, special,
			eventPath = [ elem || document ],
			type = hasOwn.call( event, "type" ) ? event.type : event,
			namespaces = hasOwn.call( event, "namespace" ) ? event.namespace.split(".") : [];

		cur = tmp = elem = elem || document;

		// Don't do events on text and comment nodes
		if ( elem.nodeType === 3 || elem.nodeType === 8 ) {
			return;
		}

		// focus/blur morphs to focusin/out; ensure we're not firing them right now
		if ( rfocusMorph.test( type + jQuery.event.triggered ) ) {
			return;
		}

		if ( type.indexOf(".") >= 0 ) {
			// Namespaced trigger; create a regexp to match event type in handle()
			namespaces = type.split(".");
			type = namespaces.shift();
			namespaces.sort();
		}
		ontype = type.indexOf(":") < 0 && "on" + type;

		// Caller can pass in a jQuery.Event object, Object, or just an event type string
		event = event[ jQuery.expando ] ?
			event :
			new jQuery.Event( type, typeof event === "object" && event );

		// Trigger bitmask: & 1 for native handlers; & 2 for jQuery (always true)
		event.isTrigger = onlyHandlers ? 2 : 3;
		event.namespace = namespaces.join(".");
		event.namespace_re = event.namespace ?
			new RegExp( "(^|\\.)" + namespaces.join("\\.(?:.*\\.|)") + "(\\.|$)" ) :
			null;

		// Clean up the event in case it is being reused
		event.result = undefined;
		if ( !event.target ) {
			event.target = elem;
		}

		// Clone any incoming data and prepend the event, creating the handler arg list
		data = data == null ?
			[ event ] :
			jQuery.makeArray( data, [ event ] );

		// Allow special events to draw outside the lines
		special = jQuery.event.special[ type ] || {};
		if ( !onlyHandlers && special.trigger && special.trigger.apply( elem, data ) === false ) {
			return;
		}

		// Determine event propagation path in advance, per W3C events spec (#9951)
		// Bubble up to document, then to window; watch for a global ownerDocument var (#9724)
		if ( !onlyHandlers && !special.noBubble && !jQuery.isWindow( elem ) ) {

			bubbleType = special.delegateType || type;
			if ( !rfocusMorph.test( bubbleType + type ) ) {
				cur = cur.parentNode;
			}
			for ( ; cur; cur = cur.parentNode ) {
				eventPath.push( cur );
				tmp = cur;
			}

			// Only add window if we got to document (e.g., not plain obj or detached DOM)
			if ( tmp === (elem.ownerDocument || document) ) {
				eventPath.push( tmp.defaultView || tmp.parentWindow || window );
			}
		}

		// Fire handlers on the event path
		i = 0;
		while ( (cur = eventPath[i++]) && !event.isPropagationStopped() ) {

			event.type = i > 1 ?
				bubbleType :
				special.bindType || type;

			// jQuery handler
			handle = ( data_priv.get( cur, "events" ) || {} )[ event.type ] && data_priv.get( cur, "handle" );
			if ( handle ) {
				handle.apply( cur, data );
			}

			// Native handler
			handle = ontype && cur[ ontype ];
			if ( handle && handle.apply && jQuery.acceptData( cur ) ) {
				event.result = handle.apply( cur, data );
				if ( event.result === false ) {
					event.preventDefault();
				}
			}
		}
		event.type = type;

		// If nobody prevented the default action, do it now
		if ( !onlyHandlers && !event.isDefaultPrevented() ) {

			if ( (!special._default || special._default.apply( eventPath.pop(), data ) === false) &&
				jQuery.acceptData( elem ) ) {

				// Call a native DOM method on the target with the same name name as the event.
				// Don't do default actions on window, that's where global variables be (#6170)
				if ( ontype && jQuery.isFunction( elem[ type ] ) && !jQuery.isWindow( elem ) ) {

					// Don't re-trigger an onFOO event when we call its FOO() method
					tmp = elem[ ontype ];

					if ( tmp ) {
						elem[ ontype ] = null;
					}

					// Prevent re-triggering of the same event, since we already bubbled it above
					jQuery.event.triggered = type;
					elem[ type ]();
					jQuery.event.triggered = undefined;

					if ( tmp ) {
						elem[ ontype ] = tmp;
					}
				}
			}
		}

		return event.result;
	},

	dispatch: function( event ) {

		// Make a writable jQuery.Event from the native event object
		event = jQuery.event.fix( event );

		var i, j, ret, matched, handleObj,
			handlerQueue = [],
			args = slice.call( arguments ),
			handlers = ( data_priv.get( this, "events" ) || {} )[ event.type ] || [],
			special = jQuery.event.special[ event.type ] || {};

		// Use the fix-ed jQuery.Event rather than the (read-only) native event
		args[0] = event;
		event.delegateTarget = this;

		// Call the preDispatch hook for the mapped type, and let it bail if desired
		if ( special.preDispatch && special.preDispatch.call( this, event ) === false ) {
			return;
		}

		// Determine handlers
		handlerQueue = jQuery.event.handlers.call( this, event, handlers );

		// Run delegates first; they may want to stop propagation beneath us
		i = 0;
		while ( (matched = handlerQueue[ i++ ]) && !event.isPropagationStopped() ) {
			event.currentTarget = matched.elem;

			j = 0;
			while ( (handleObj = matched.handlers[ j++ ]) && !event.isImmediatePropagationStopped() ) {

				// Triggered event must either 1) have no namespace, or 2) have namespace(s)
				// a subset or equal to those in the bound event (both can have no namespace).
				if ( !event.namespace_re || event.namespace_re.test( handleObj.namespace ) ) {

					event.handleObj = handleObj;
					event.data = handleObj.data;

					ret = ( (jQuery.event.special[ handleObj.origType ] || {}).handle || handleObj.handler )
							.apply( matched.elem, args );

					if ( ret !== undefined ) {
						if ( (event.result = ret) === false ) {
							event.preventDefault();
							event.stopPropagation();
						}
					}
				}
			}
		}

		// Call the postDispatch hook for the mapped type
		if ( special.postDispatch ) {
			special.postDispatch.call( this, event );
		}

		return event.result;
	},

	handlers: function( event, handlers ) {
		var i, matches, sel, handleObj,
			handlerQueue = [],
			delegateCount = handlers.delegateCount,
			cur = event.target;

		// Find delegate handlers
		// Black-hole SVG <use> instance trees (#13180)
		// Avoid non-left-click bubbling in Firefox (#3861)
		if ( delegateCount && cur.nodeType && (!event.button || event.type !== "click") ) {

			for ( ; cur !== this; cur = cur.parentNode || this ) {

				// Don't process clicks on disabled elements (#6911, #8165, #11382, #11764)
				if ( cur.disabled !== true || event.type !== "click" ) {
					matches = [];
					for ( i = 0; i < delegateCount; i++ ) {
						handleObj = handlers[ i ];

						// Don't conflict with Object.prototype properties (#13203)
						sel = handleObj.selector + " ";

						if ( matches[ sel ] === undefined ) {
							matches[ sel ] = handleObj.needsContext ?
								jQuery( sel, this ).index( cur ) >= 0 :
								jQuery.find( sel, this, null, [ cur ] ).length;
						}
						if ( matches[ sel ] ) {
							matches.push( handleObj );
						}
					}
					if ( matches.length ) {
						handlerQueue.push({ elem: cur, handlers: matches });
					}
				}
			}
		}

		// Add the remaining (directly-bound) handlers
		if ( delegateCount < handlers.length ) {
			handlerQueue.push({ elem: this, handlers: handlers.slice( delegateCount ) });
		}

		return handlerQueue;
	},

	// Includes some event props shared by KeyEvent and MouseEvent
	props: "altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),

	fixHooks: {},

	keyHooks: {
		props: "char charCode key keyCode".split(" "),
		filter: function( event, original ) {

			// Add which for key events
			if ( event.which == null ) {
				event.which = original.charCode != null ? original.charCode : original.keyCode;
			}

			return event;
		}
	},

	mouseHooks: {
		props: "button buttons clientX clientY offsetX offsetY pageX pageY screenX screenY toElement".split(" "),
		filter: function( event, original ) {
			var eventDoc, doc, body,
				button = original.button;

			// Calculate pageX/Y if missing and clientX/Y available
			if ( event.pageX == null && original.clientX != null ) {
				eventDoc = event.target.ownerDocument || document;
				doc = eventDoc.documentElement;
				body = eventDoc.body;

				event.pageX = original.clientX + ( doc && doc.scrollLeft || body && body.scrollLeft || 0 ) - ( doc && doc.clientLeft || body && body.clientLeft || 0 );
				event.pageY = original.clientY + ( doc && doc.scrollTop  || body && body.scrollTop  || 0 ) - ( doc && doc.clientTop  || body && body.clientTop  || 0 );
			}

			// Add which for click: 1 === left; 2 === middle; 3 === right
			// Note: button is not normalized, so don't use it
			if ( !event.which && button !== undefined ) {
				event.which = ( button & 1 ? 1 : ( button & 2 ? 3 : ( button & 4 ? 2 : 0 ) ) );
			}

			return event;
		}
	},

	fix: function( event ) {
		if ( event[ jQuery.expando ] ) {
			return event;
		}

		// Create a writable copy of the event object and normalize some properties
		var i, prop, copy,
			type = event.type,
			originalEvent = event,
			fixHook = this.fixHooks[ type ];

		if ( !fixHook ) {
			this.fixHooks[ type ] = fixHook =
				rmouseEvent.test( type ) ? this.mouseHooks :
				rkeyEvent.test( type ) ? this.keyHooks :
				{};
		}
		copy = fixHook.props ? this.props.concat( fixHook.props ) : this.props;

		event = new jQuery.Event( originalEvent );

		i = copy.length;
		while ( i-- ) {
			prop = copy[ i ];
			event[ prop ] = originalEvent[ prop ];
		}

		// Support: Cordova 2.5 (WebKit) (#13255)
		// All events should have a target; Cordova deviceready doesn't
		if ( !event.target ) {
			event.target = document;
		}

		// Support: Safari 6.0+, Chrome<28
		// Target should not be a text node (#504, #13143)
		if ( event.target.nodeType === 3 ) {
			event.target = event.target.parentNode;
		}

		return fixHook.filter ? fixHook.filter( event, originalEvent ) : event;
	},

	special: {
		load: {
			// Prevent triggered image.load events from bubbling to window.load
			noBubble: true
		},
		focus: {
			// Fire native event if possible so blur/focus sequence is correct
			trigger: function() {
				if ( this !== safeActiveElement() && this.focus ) {
					this.focus();
					return false;
				}
			},
			delegateType: "focusin"
		},
		blur: {
			trigger: function() {
				if ( this === safeActiveElement() && this.blur ) {
					this.blur();
					return false;
				}
			},
			delegateType: "focusout"
		},
		click: {
			// For checkbox, fire native event so checked state will be right
			trigger: function() {
				if ( this.type === "checkbox" && this.click && jQuery.nodeName( this, "input" ) ) {
					this.click();
					return false;
				}
			},

			// For cross-browser consistency, don't fire native .click() on links
			_default: function( event ) {
				return jQuery.nodeName( event.target, "a" );
			}
		},

		beforeunload: {
			postDispatch: function( event ) {

				// Support: Firefox 20+
				// Firefox doesn't alert if the returnValue field is not set.
				if ( event.result !== undefined && event.originalEvent ) {
					event.originalEvent.returnValue = event.result;
				}
			}
		}
	},

	simulate: function( type, elem, event, bubble ) {
		// Piggyback on a donor event to simulate a different one.
		// Fake originalEvent to avoid donor's stopPropagation, but if the
		// simulated event prevents default then we do the same on the donor.
		var e = jQuery.extend(
			new jQuery.Event(),
			event,
			{
				type: type,
				isSimulated: true,
				originalEvent: {}
			}
		);
		if ( bubble ) {
			jQuery.event.trigger( e, null, elem );
		} else {
			jQuery.event.dispatch.call( elem, e );
		}
		if ( e.isDefaultPrevented() ) {
			event.preventDefault();
		}
	}
};

jQuery.removeEvent = function( elem, type, handle ) {
	if ( elem.removeEventListener ) {
		elem.removeEventListener( type, handle, false );
	}
};

jQuery.Event = function( src, props ) {
	// Allow instantiation without the 'new' keyword
	if ( !(this instanceof jQuery.Event) ) {
		return new jQuery.Event( src, props );
	}

	// Event object
	if ( src && src.type ) {
		this.originalEvent = src;
		this.type = src.type;

		// Events bubbling up the document may have been marked as prevented
		// by a handler lower down the tree; reflect the correct value.
		this.isDefaultPrevented = src.defaultPrevented ||
				src.defaultPrevented === undefined &&
				// Support: Android<4.0
				src.returnValue === false ?
			returnTrue :
			returnFalse;

	// Event type
	} else {
		this.type = src;
	}

	// Put explicitly provided properties onto the event object
	if ( props ) {
		jQuery.extend( this, props );
	}

	// Create a timestamp if incoming event doesn't have one
	this.timeStamp = src && src.timeStamp || jQuery.now();

	// Mark it as fixed
	this[ jQuery.expando ] = true;
};

// jQuery.Event is based on DOM3 Events as specified by the ECMAScript Language Binding
// http://www.w3.org/TR/2003/WD-DOM-Level-3-Events-20030331/ecma-script-binding.html
jQuery.Event.prototype = {
	isDefaultPrevented: returnFalse,
	isPropagationStopped: returnFalse,
	isImmediatePropagationStopped: returnFalse,

	preventDefault: function() {
		var e = this.originalEvent;

		this.isDefaultPrevented = returnTrue;

		if ( e && e.preventDefault ) {
			e.preventDefault();
		}
	},
	stopPropagation: function() {
		var e = this.originalEvent;

		this.isPropagationStopped = returnTrue;

		if ( e && e.stopPropagation ) {
			e.stopPropagation();
		}
	},
	stopImmediatePropagation: function() {
		var e = this.originalEvent;

		this.isImmediatePropagationStopped = returnTrue;

		if ( e && e.stopImmediatePropagation ) {
			e.stopImmediatePropagation();
		}

		this.stopPropagation();
	}
};

// Create mouseenter/leave events using mouseover/out and event-time checks
// Support: Chrome 15+
jQuery.each({
	mouseenter: "mouseover",
	mouseleave: "mouseout",
	pointerenter: "pointerover",
	pointerleave: "pointerout"
}, function( orig, fix ) {
	jQuery.event.special[ orig ] = {
		delegateType: fix,
		bindType: fix,

		handle: function( event ) {
			var ret,
				target = this,
				related = event.relatedTarget,
				handleObj = event.handleObj;

			// For mousenter/leave call the handler if related is outside the target.
			// NB: No relatedTarget if the mouse left/entered the browser window
			if ( !related || (related !== target && !jQuery.contains( target, related )) ) {
				event.type = handleObj.origType;
				ret = handleObj.handler.apply( this, arguments );
				event.type = fix;
			}
			return ret;
		}
	};
});

// Support: Firefox, Chrome, Safari
// Create "bubbling" focus and blur events
if ( !support.focusinBubbles ) {
	jQuery.each({ focus: "focusin", blur: "focusout" }, function( orig, fix ) {

		// Attach a single capturing handler on the document while someone wants focusin/focusout
		var handler = function( event ) {
				jQuery.event.simulate( fix, event.target, jQuery.event.fix( event ), true );
			};

		jQuery.event.special[ fix ] = {
			setup: function() {
				var doc = this.ownerDocument || this,
					attaches = data_priv.access( doc, fix );

				if ( !attaches ) {
					doc.addEventListener( orig, handler, true );
				}
				data_priv.access( doc, fix, ( attaches || 0 ) + 1 );
			},
			teardown: function() {
				var doc = this.ownerDocument || this,
					attaches = data_priv.access( doc, fix ) - 1;

				if ( !attaches ) {
					doc.removeEventListener( orig, handler, true );
					data_priv.remove( doc, fix );

				} else {
					data_priv.access( doc, fix, attaches );
				}
			}
		};
	});
}

jQuery.fn.extend({

	on: function( types, selector, data, fn, /*INTERNAL*/ one ) {
		var origFn, type;

		// Types can be a map of types/handlers
		if ( typeof types === "object" ) {
			// ( types-Object, selector, data )
			if ( typeof selector !== "string" ) {
				// ( types-Object, data )
				data = data || selector;
				selector = undefined;
			}
			for ( type in types ) {
				this.on( type, selector, data, types[ type ], one );
			}
			return this;
		}

		if ( data == null && fn == null ) {
			// ( types, fn )
			fn = selector;
			data = selector = undefined;
		} else if ( fn == null ) {
			if ( typeof selector === "string" ) {
				// ( types, selector, fn )
				fn = data;
				data = undefined;
			} else {
				// ( types, data, fn )
				fn = data;
				data = selector;
				selector = undefined;
			}
		}
		if ( fn === false ) {
			fn = returnFalse;
		} else if ( !fn ) {
			return this;
		}

		if ( one === 1 ) {
			origFn = fn;
			fn = function( event ) {
				// Can use an empty set, since event contains the info
				jQuery().off( event );
				return origFn.apply( this, arguments );
			};
			// Use same guid so caller can remove using origFn
			fn.guid = origFn.guid || ( origFn.guid = jQuery.guid++ );
		}
		return this.each( function() {
			jQuery.event.add( this, types, fn, data, selector );
		});
	},
	one: function( types, selector, data, fn ) {
		return this.on( types, selector, data, fn, 1 );
	},
	off: function( types, selector, fn ) {
		var handleObj, type;
		if ( types && types.preventDefault && types.handleObj ) {
			// ( event )  dispatched jQuery.Event
			handleObj = types.handleObj;
			jQuery( types.delegateTarget ).off(
				handleObj.namespace ? handleObj.origType + "." + handleObj.namespace : handleObj.origType,
				handleObj.selector,
				handleObj.handler
			);
			return this;
		}
		if ( typeof types === "object" ) {
			// ( types-object [, selector] )
			for ( type in types ) {
				this.off( type, selector, types[ type ] );
			}
			return this;
		}
		if ( selector === false || typeof selector === "function" ) {
			// ( types [, fn] )
			fn = selector;
			selector = undefined;
		}
		if ( fn === false ) {
			fn = returnFalse;
		}
		return this.each(function() {
			jQuery.event.remove( this, types, fn, selector );
		});
	},

	trigger: function( type, data ) {
		return this.each(function() {
			jQuery.event.trigger( type, data, this );
		});
	},
	triggerHandler: function( type, data ) {
		var elem = this[0];
		if ( elem ) {
			return jQuery.event.trigger( type, data, elem, true );
		}
	}
});


var
	rxhtmlTag = /<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,
	rtagName = /<([\w:]+)/,
	rhtml = /<|&#?\w+;/,
	rnoInnerhtml = /<(?:script|style|link)/i,
	// checked="checked" or checked
	rchecked = /checked\s*(?:[^=]|=\s*.checked.)/i,
	rscriptType = /^$|\/(?:java|ecma)script/i,
	rscriptTypeMasked = /^true\/(.*)/,
	rcleanScript = /^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,

	// We have to close these tags to support XHTML (#13200)
	wrapMap = {

		// Support: IE9
		option: [ 1, "<select multiple='multiple'>", "</select>" ],

		thead: [ 1, "<table>", "</table>" ],
		col: [ 2, "<table><colgroup>", "</colgroup></table>" ],
		tr: [ 2, "<table><tbody>", "</tbody></table>" ],
		td: [ 3, "<table><tbody><tr>", "</tr></tbody></table>" ],

		_default: [ 0, "", "" ]
	};

// Support: IE9
wrapMap.optgroup = wrapMap.option;

wrapMap.tbody = wrapMap.tfoot = wrapMap.colgroup = wrapMap.caption = wrapMap.thead;
wrapMap.th = wrapMap.td;

// Support: 1.x compatibility
// Manipulating tables requires a tbody
function manipulationTarget( elem, content ) {
	return jQuery.nodeName( elem, "table" ) &&
		jQuery.nodeName( content.nodeType !== 11 ? content : content.firstChild, "tr" ) ?

		elem.getElementsByTagName("tbody")[0] ||
			elem.appendChild( elem.ownerDocument.createElement("tbody") ) :
		elem;
}

// Replace/restore the type attribute of script elements for safe DOM manipulation
function disableScript( elem ) {
	elem.type = (elem.getAttribute("type") !== null) + "/" + elem.type;
	return elem;
}
function restoreScript( elem ) {
	var match = rscriptTypeMasked.exec( elem.type );

	if ( match ) {
		elem.type = match[ 1 ];
	} else {
		elem.removeAttribute("type");
	}

	return elem;
}

// Mark scripts as having already been evaluated
function setGlobalEval( elems, refElements ) {
	var i = 0,
		l = elems.length;

	for ( ; i < l; i++ ) {
		data_priv.set(
			elems[ i ], "globalEval", !refElements || data_priv.get( refElements[ i ], "globalEval" )
		);
	}
}

function cloneCopyEvent( src, dest ) {
	var i, l, type, pdataOld, pdataCur, udataOld, udataCur, events;

	if ( dest.nodeType !== 1 ) {
		return;
	}

	// 1. Copy private data: events, handlers, etc.
	if ( data_priv.hasData( src ) ) {
		pdataOld = data_priv.access( src );
		pdataCur = data_priv.set( dest, pdataOld );
		events = pdataOld.events;

		if ( events ) {
			delete pdataCur.handle;
			pdataCur.events = {};

			for ( type in events ) {
				for ( i = 0, l = events[ type ].length; i < l; i++ ) {
					jQuery.event.add( dest, type, events[ type ][ i ] );
				}
			}
		}
	}

	// 2. Copy user data
	if ( data_user.hasData( src ) ) {
		udataOld = data_user.access( src );
		udataCur = jQuery.extend( {}, udataOld );

		data_user.set( dest, udataCur );
	}
}

function getAll( context, tag ) {
	var ret = context.getElementsByTagName ? context.getElementsByTagName( tag || "*" ) :
			context.querySelectorAll ? context.querySelectorAll( tag || "*" ) :
			[];

	return tag === undefined || tag && jQuery.nodeName( context, tag ) ?
		jQuery.merge( [ context ], ret ) :
		ret;
}

// Fix IE bugs, see support tests
function fixInput( src, dest ) {
	var nodeName = dest.nodeName.toLowerCase();

	// Fails to persist the checked state of a cloned checkbox or radio button.
	if ( nodeName === "input" && rcheckableType.test( src.type ) ) {
		dest.checked = src.checked;

	// Fails to return the selected option to the default selected state when cloning options
	} else if ( nodeName === "input" || nodeName === "textarea" ) {
		dest.defaultValue = src.defaultValue;
	}
}

jQuery.extend({
	clone: function( elem, dataAndEvents, deepDataAndEvents ) {
		var i, l, srcElements, destElements,
			clone = elem.cloneNode( true ),
			inPage = jQuery.contains( elem.ownerDocument, elem );

		// Fix IE cloning issues
		if ( !support.noCloneChecked && ( elem.nodeType === 1 || elem.nodeType === 11 ) &&
				!jQuery.isXMLDoc( elem ) ) {

			// We eschew Sizzle here for performance reasons: http://jsperf.com/getall-vs-sizzle/2
			destElements = getAll( clone );
			srcElements = getAll( elem );

			for ( i = 0, l = srcElements.length; i < l; i++ ) {
				fixInput( srcElements[ i ], destElements[ i ] );
			}
		}

		// Copy the events from the original to the clone
		if ( dataAndEvents ) {
			if ( deepDataAndEvents ) {
				srcElements = srcElements || getAll( elem );
				destElements = destElements || getAll( clone );

				for ( i = 0, l = srcElements.length; i < l; i++ ) {
					cloneCopyEvent( srcElements[ i ], destElements[ i ] );
				}
			} else {
				cloneCopyEvent( elem, clone );
			}
		}

		// Preserve script evaluation history
		destElements = getAll( clone, "script" );
		if ( destElements.length > 0 ) {
			setGlobalEval( destElements, !inPage && getAll( elem, "script" ) );
		}

		// Return the cloned set
		return clone;
	},

	buildFragment: function( elems, context, scripts, selection ) {
		var elem, tmp, tag, wrap, contains, j,
			fragment = context.createDocumentFragment(),
			nodes = [],
			i = 0,
			l = elems.length;

		for ( ; i < l; i++ ) {
			elem = elems[ i ];

			if ( elem || elem === 0 ) {

				// Add nodes directly
				if ( jQuery.type( elem ) === "object" ) {
					// Support: QtWebKit, PhantomJS
					// push.apply(_, arraylike) throws on ancient WebKit
					jQuery.merge( nodes, elem.nodeType ? [ elem ] : elem );

				// Convert non-html into a text node
				} else if ( !rhtml.test( elem ) ) {
					nodes.push( context.createTextNode( elem ) );

				// Convert html into DOM nodes
				} else {
					tmp = tmp || fragment.appendChild( context.createElement("div") );

					// Deserialize a standard representation
					tag = ( rtagName.exec( elem ) || [ "", "" ] )[ 1 ].toLowerCase();
					wrap = wrapMap[ tag ] || wrapMap._default;
					tmp.innerHTML = wrap[ 1 ] + elem.replace( rxhtmlTag, "<$1></$2>" ) + wrap[ 2 ];

					// Descend through wrappers to the right content
					j = wrap[ 0 ];
					while ( j-- ) {
						tmp = tmp.lastChild;
					}

					// Support: QtWebKit, PhantomJS
					// push.apply(_, arraylike) throws on ancient WebKit
					jQuery.merge( nodes, tmp.childNodes );

					// Remember the top-level container
					tmp = fragment.firstChild;

					// Ensure the created nodes are orphaned (#12392)
					tmp.textContent = "";
				}
			}
		}

		// Remove wrapper from fragment
		fragment.textContent = "";

		i = 0;
		while ( (elem = nodes[ i++ ]) ) {

			// #4087 - If origin and destination elements are the same, and this is
			// that element, do not do anything
			if ( selection && jQuery.inArray( elem, selection ) !== -1 ) {
				continue;
			}

			contains = jQuery.contains( elem.ownerDocument, elem );

			// Append to fragment
			tmp = getAll( fragment.appendChild( elem ), "script" );

			// Preserve script evaluation history
			if ( contains ) {
				setGlobalEval( tmp );
			}

			// Capture executables
			if ( scripts ) {
				j = 0;
				while ( (elem = tmp[ j++ ]) ) {
					if ( rscriptType.test( elem.type || "" ) ) {
						scripts.push( elem );
					}
				}
			}
		}

		return fragment;
	},

	cleanData: function( elems ) {
		var data, elem, type, key,
			special = jQuery.event.special,
			i = 0;

		for ( ; (elem = elems[ i ]) !== undefined; i++ ) {
			if ( jQuery.acceptData( elem ) ) {
				key = elem[ data_priv.expando ];

				if ( key && (data = data_priv.cache[ key ]) ) {
					if ( data.events ) {
						for ( type in data.events ) {
							if ( special[ type ] ) {
								jQuery.event.remove( elem, type );

							// This is a shortcut to avoid jQuery.event.remove's overhead
							} else {
								jQuery.removeEvent( elem, type, data.handle );
							}
						}
					}
					if ( data_priv.cache[ key ] ) {
						// Discard any remaining `private` data
						delete data_priv.cache[ key ];
					}
				}
			}
			// Discard any remaining `user` data
			delete data_user.cache[ elem[ data_user.expando ] ];
		}
	}
});

jQuery.fn.extend({
	text: function( value ) {
		return access( this, function( value ) {
			return value === undefined ?
				jQuery.text( this ) :
				this.empty().each(function() {
					if ( this.nodeType === 1 || this.nodeType === 11 || this.nodeType === 9 ) {
						this.textContent = value;
					}
				});
		}, null, value, arguments.length );
	},

	append: function() {
		return this.domManip( arguments, function( elem ) {
			if ( this.nodeType === 1 || this.nodeType === 11 || this.nodeType === 9 ) {
				var target = manipulationTarget( this, elem );
				target.appendChild( elem );
			}
		});
	},

	prepend: function() {
		return this.domManip( arguments, function( elem ) {
			if ( this.nodeType === 1 || this.nodeType === 11 || this.nodeType === 9 ) {
				var target = manipulationTarget( this, elem );
				target.insertBefore( elem, target.firstChild );
			}
		});
	},

	before: function() {
		return this.domManip( arguments, function( elem ) {
			if ( this.parentNode ) {
				this.parentNode.insertBefore( elem, this );
			}
		});
	},

	after: function() {
		return this.domManip( arguments, function( elem ) {
			if ( this.parentNode ) {
				this.parentNode.insertBefore( elem, this.nextSibling );
			}
		});
	},

	remove: function( selector, keepData /* Internal Use Only */ ) {
		var elem,
			elems = selector ? jQuery.filter( selector, this ) : this,
			i = 0;

		for ( ; (elem = elems[i]) != null; i++ ) {
			if ( !keepData && elem.nodeType === 1 ) {
				jQuery.cleanData( getAll( elem ) );
			}

			if ( elem.parentNode ) {
				if ( keepData && jQuery.contains( elem.ownerDocument, elem ) ) {
					setGlobalEval( getAll( elem, "script" ) );
				}
				elem.parentNode.removeChild( elem );
			}
		}

		return this;
	},

	empty: function() {
		var elem,
			i = 0;

		for ( ; (elem = this[i]) != null; i++ ) {
			if ( elem.nodeType === 1 ) {

				// Prevent memory leaks
				jQuery.cleanData( getAll( elem, false ) );

				// Remove any remaining nodes
				elem.textContent = "";
			}
		}

		return this;
	},

	clone: function( dataAndEvents, deepDataAndEvents ) {
		dataAndEvents = dataAndEvents == null ? false : dataAndEvents;
		deepDataAndEvents = deepDataAndEvents == null ? dataAndEvents : deepDataAndEvents;

		return this.map(function() {
			return jQuery.clone( this, dataAndEvents, deepDataAndEvents );
		});
	},

	html: function( value ) {
		return access( this, function( value ) {
			var elem = this[ 0 ] || {},
				i = 0,
				l = this.length;

			if ( value === undefined && elem.nodeType === 1 ) {
				return elem.innerHTML;
			}

			// See if we can take a shortcut and just use innerHTML
			if ( typeof value === "string" && !rnoInnerhtml.test( value ) &&
				!wrapMap[ ( rtagName.exec( value ) || [ "", "" ] )[ 1 ].toLowerCase() ] ) {

				value = value.replace( rxhtmlTag, "<$1></$2>" );

				try {
					for ( ; i < l; i++ ) {
						elem = this[ i ] || {};

						// Remove element nodes and prevent memory leaks
						if ( elem.nodeType === 1 ) {
							jQuery.cleanData( getAll( elem, false ) );
							elem.innerHTML = value;
						}
					}

					elem = 0;

				// If using innerHTML throws an exception, use the fallback method
				} catch( e ) {}
			}

			if ( elem ) {
				this.empty().append( value );
			}
		}, null, value, arguments.length );
	},

	replaceWith: function() {
		var arg = arguments[ 0 ];

		// Make the changes, replacing each context element with the new content
		this.domManip( arguments, function( elem ) {
			arg = this.parentNode;

			jQuery.cleanData( getAll( this ) );

			if ( arg ) {
				arg.replaceChild( elem, this );
			}
		});

		// Force removal if there was no new content (e.g., from empty arguments)
		return arg && (arg.length || arg.nodeType) ? this : this.remove();
	},

	detach: function( selector ) {
		return this.remove( selector, true );
	},

	domManip: function( args, callback ) {

		// Flatten any nested arrays
		args = concat.apply( [], args );

		var fragment, first, scripts, hasScripts, node, doc,
			i = 0,
			l = this.length,
			set = this,
			iNoClone = l - 1,
			value = args[ 0 ],
			isFunction = jQuery.isFunction( value );

		// We can't cloneNode fragments that contain checked, in WebKit
		if ( isFunction ||
				( l > 1 && typeof value === "string" &&
					!support.checkClone && rchecked.test( value ) ) ) {
			return this.each(function( index ) {
				var self = set.eq( index );
				if ( isFunction ) {
					args[ 0 ] = value.call( this, index, self.html() );
				}
				self.domManip( args, callback );
			});
		}

		if ( l ) {
			fragment = jQuery.buildFragment( args, this[ 0 ].ownerDocument, false, this );
			first = fragment.firstChild;

			if ( fragment.childNodes.length === 1 ) {
				fragment = first;
			}

			if ( first ) {
				scripts = jQuery.map( getAll( fragment, "script" ), disableScript );
				hasScripts = scripts.length;

				// Use the original fragment for the last item instead of the first because it can end up
				// being emptied incorrectly in certain situations (#8070).
				for ( ; i < l; i++ ) {
					node = fragment;

					if ( i !== iNoClone ) {
						node = jQuery.clone( node, true, true );

						// Keep references to cloned scripts for later restoration
						if ( hasScripts ) {
							// Support: QtWebKit
							// jQuery.merge because push.apply(_, arraylike) throws
							jQuery.merge( scripts, getAll( node, "script" ) );
						}
					}

					callback.call( this[ i ], node, i );
				}

				if ( hasScripts ) {
					doc = scripts[ scripts.length - 1 ].ownerDocument;

					// Reenable scripts
					jQuery.map( scripts, restoreScript );

					// Evaluate executable scripts on first document insertion
					for ( i = 0; i < hasScripts; i++ ) {
						node = scripts[ i ];
						if ( rscriptType.test( node.type || "" ) &&
							!data_priv.access( node, "globalEval" ) && jQuery.contains( doc, node ) ) {

							if ( node.src ) {
								// Optional AJAX dependency, but won't run scripts if not present
								if ( jQuery._evalUrl ) {
									jQuery._evalUrl( node.src );
								}
							} else {
								jQuery.globalEval( node.textContent.replace( rcleanScript, "" ) );
							}
						}
					}
				}
			}
		}

		return this;
	}
});

jQuery.each({
	appendTo: "append",
	prependTo: "prepend",
	insertBefore: "before",
	insertAfter: "after",
	replaceAll: "replaceWith"
}, function( name, original ) {
	jQuery.fn[ name ] = function( selector ) {
		var elems,
			ret = [],
			insert = jQuery( selector ),
			last = insert.length - 1,
			i = 0;

		for ( ; i <= last; i++ ) {
			elems = i === last ? this : this.clone( true );
			jQuery( insert[ i ] )[ original ]( elems );

			// Support: QtWebKit
			// .get() because push.apply(_, arraylike) throws
			push.apply( ret, elems.get() );
		}

		return this.pushStack( ret );
	};
});


var iframe,
	elemdisplay = {};

/**
 * Retrieve the actual display of a element
 * @param {String} name nodeName of the element
 * @param {Object} doc Document object
 */
// Called only from within defaultDisplay
function actualDisplay( name, doc ) {
	var style,
		elem = jQuery( doc.createElement( name ) ).appendTo( doc.body ),

		// getDefaultComputedStyle might be reliably used only on attached element
		display = window.getDefaultComputedStyle && ( style = window.getDefaultComputedStyle( elem[ 0 ] ) ) ?

			// Use of this method is a temporary fix (more like optimization) until something better comes along,
			// since it was removed from specification and supported only in FF
			style.display : jQuery.css( elem[ 0 ], "display" );

	// We don't have any data stored on the element,
	// so use "detach" method as fast way to get rid of the element
	elem.detach();

	return display;
}

/**
 * Try to determine the default display value of an element
 * @param {String} nodeName
 */
function defaultDisplay( nodeName ) {
	var doc = document,
		display = elemdisplay[ nodeName ];

	if ( !display ) {
		display = actualDisplay( nodeName, doc );

		// If the simple way fails, read from inside an iframe
		if ( display === "none" || !display ) {

			// Use the already-created iframe if possible
			iframe = (iframe || jQuery( "<iframe frameborder='0' width='0' height='0'/>" )).appendTo( doc.documentElement );

			// Always write a new HTML skeleton so Webkit and Firefox don't choke on reuse
			doc = iframe[ 0 ].contentDocument;

			// Support: IE
			doc.write();
			doc.close();

			display = actualDisplay( nodeName, doc );
			iframe.detach();
		}

		// Store the correct default display
		elemdisplay[ nodeName ] = display;
	}

	return display;
}
var rmargin = (/^margin/);

var rnumnonpx = new RegExp( "^(" + pnum + ")(?!px)[a-z%]+$", "i" );

var getStyles = function( elem ) {
		// Support: IE<=11+, Firefox<=30+ (#15098, #14150)
		// IE throws on elements created in popups
		// FF meanwhile throws on frame elements through "defaultView.getComputedStyle"
		if ( elem.ownerDocument.defaultView.opener ) {
			return elem.ownerDocument.defaultView.getComputedStyle( elem, null );
		}

		return window.getComputedStyle( elem, null );
	};



function curCSS( elem, name, computed ) {
	var width, minWidth, maxWidth, ret,
		style = elem.style;

	computed = computed || getStyles( elem );

	// Support: IE9
	// getPropertyValue is only needed for .css('filter') (#12537)
	if ( computed ) {
		ret = computed.getPropertyValue( name ) || computed[ name ];
	}

	if ( computed ) {

		if ( ret === "" && !jQuery.contains( elem.ownerDocument, elem ) ) {
			ret = jQuery.style( elem, name );
		}

		// Support: iOS < 6
		// A tribute to the "awesome hack by Dean Edwards"
		// iOS < 6 (at least) returns percentage for a larger set of values, but width seems to be reliably pixels
		// this is against the CSSOM draft spec: http://dev.w3.org/csswg/cssom/#resolved-values
		if ( rnumnonpx.test( ret ) && rmargin.test( name ) ) {

			// Remember the original values
			width = style.width;
			minWidth = style.minWidth;
			maxWidth = style.maxWidth;

			// Put in the new values to get a computed value out
			style.minWidth = style.maxWidth = style.width = ret;
			ret = computed.width;

			// Revert the changed values
			style.width = width;
			style.minWidth = minWidth;
			style.maxWidth = maxWidth;
		}
	}

	return ret !== undefined ?
		// Support: IE
		// IE returns zIndex value as an integer.
		ret + "" :
		ret;
}


function addGetHookIf( conditionFn, hookFn ) {
	// Define the hook, we'll check on the first run if it's really needed.
	return {
		get: function() {
			if ( conditionFn() ) {
				// Hook not needed (or it's not possible to use it due
				// to missing dependency), remove it.
				delete this.get;
				return;
			}

			// Hook needed; redefine it so that the support test is not executed again.
			return (this.get = hookFn).apply( this, arguments );
		}
	};
}


(function() {
	var pixelPositionVal, boxSizingReliableVal,
		docElem = document.documentElement,
		container = document.createElement( "div" ),
		div = document.createElement( "div" );

	if ( !div.style ) {
		return;
	}

	// Support: IE9-11+
	// Style of cloned element affects source element cloned (#8908)
	div.style.backgroundClip = "content-box";
	div.cloneNode( true ).style.backgroundClip = "";
	support.clearCloneStyle = div.style.backgroundClip === "content-box";

	container.style.cssText = "border:0;width:0;height:0;top:0;left:-9999px;margin-top:1px;" +
		"position:absolute";
	container.appendChild( div );

	// Executing both pixelPosition & boxSizingReliable tests require only one layout
	// so they're executed at the same time to save the second computation.
	function computePixelPositionAndBoxSizingReliable() {
		div.style.cssText =
			// Support: Firefox<29, Android 2.3
			// Vendor-prefix box-sizing
			"-webkit-box-sizing:border-box;-moz-box-sizing:border-box;" +
			"box-sizing:border-box;display:block;margin-top:1%;top:1%;" +
			"border:1px;padding:1px;width:4px;position:absolute";
		div.innerHTML = "";
		docElem.appendChild( container );

		var divStyle = window.getComputedStyle( div, null );
		pixelPositionVal = divStyle.top !== "1%";
		boxSizingReliableVal = divStyle.width === "4px";

		docElem.removeChild( container );
	}

	// Support: node.js jsdom
	// Don't assume that getComputedStyle is a property of the global object
	if ( window.getComputedStyle ) {
		jQuery.extend( support, {
			pixelPosition: function() {

				// This test is executed only once but we still do memoizing
				// since we can use the boxSizingReliable pre-computing.
				// No need to check if the test was already performed, though.
				computePixelPositionAndBoxSizingReliable();
				return pixelPositionVal;
			},
			boxSizingReliable: function() {
				if ( boxSizingReliableVal == null ) {
					computePixelPositionAndBoxSizingReliable();
				}
				return boxSizingReliableVal;
			},
			reliableMarginRight: function() {

				// Support: Android 2.3
				// Check if div with explicit width and no margin-right incorrectly
				// gets computed margin-right based on width of container. (#3333)
				// WebKit Bug 13343 - getComputedStyle returns wrong value for margin-right
				// This support function is only executed once so no memoizing is needed.
				var ret,
					marginDiv = div.appendChild( document.createElement( "div" ) );

				// Reset CSS: box-sizing; display; margin; border; padding
				marginDiv.style.cssText = div.style.cssText =
					// Support: Firefox<29, Android 2.3
					// Vendor-prefix box-sizing
					"-webkit-box-sizing:content-box;-moz-box-sizing:content-box;" +
					"box-sizing:content-box;display:block;margin:0;border:0;padding:0";
				marginDiv.style.marginRight = marginDiv.style.width = "0";
				div.style.width = "1px";
				docElem.appendChild( container );

				ret = !parseFloat( window.getComputedStyle( marginDiv, null ).marginRight );

				docElem.removeChild( container );
				div.removeChild( marginDiv );

				return ret;
			}
		});
	}
})();


// A method for quickly swapping in/out CSS properties to get correct calculations.
jQuery.swap = function( elem, options, callback, args ) {
	var ret, name,
		old = {};

	// Remember the old values, and insert the new ones
	for ( name in options ) {
		old[ name ] = elem.style[ name ];
		elem.style[ name ] = options[ name ];
	}

	ret = callback.apply( elem, args || [] );

	// Revert the old values
	for ( name in options ) {
		elem.style[ name ] = old[ name ];
	}

	return ret;
};


var
	// Swappable if display is none or starts with table except "table", "table-cell", or "table-caption"
	// See here for display values: https://developer.mozilla.org/en-US/docs/CSS/display
	rdisplayswap = /^(none|table(?!-c[ea]).+)/,
	rnumsplit = new RegExp( "^(" + pnum + ")(.*)$", "i" ),
	rrelNum = new RegExp( "^([+-])=(" + pnum + ")", "i" ),

	cssShow = { position: "absolute", visibility: "hidden", display: "block" },
	cssNormalTransform = {
		letterSpacing: "0",
		fontWeight: "400"
	},

	cssPrefixes = [ "Webkit", "O", "Moz", "ms" ];

// Return a css property mapped to a potentially vendor prefixed property
function vendorPropName( style, name ) {

	// Shortcut for names that are not vendor prefixed
	if ( name in style ) {
		return name;
	}

	// Check for vendor prefixed names
	var capName = name[0].toUpperCase() + name.slice(1),
		origName = name,
		i = cssPrefixes.length;

	while ( i-- ) {
		name = cssPrefixes[ i ] + capName;
		if ( name in style ) {
			return name;
		}
	}

	return origName;
}

function setPositiveNumber( elem, value, subtract ) {
	var matches = rnumsplit.exec( value );
	return matches ?
		// Guard against undefined "subtract", e.g., when used as in cssHooks
		Math.max( 0, matches[ 1 ] - ( subtract || 0 ) ) + ( matches[ 2 ] || "px" ) :
		value;
}

function augmentWidthOrHeight( elem, name, extra, isBorderBox, styles ) {
	var i = extra === ( isBorderBox ? "border" : "content" ) ?
		// If we already have the right measurement, avoid augmentation
		4 :
		// Otherwise initialize for horizontal or vertical properties
		name === "width" ? 1 : 0,

		val = 0;

	for ( ; i < 4; i += 2 ) {
		// Both box models exclude margin, so add it if we want it
		if ( extra === "margin" ) {
			val += jQuery.css( elem, extra + cssExpand[ i ], true, styles );
		}

		if ( isBorderBox ) {
			// border-box includes padding, so remove it if we want content
			if ( extra === "content" ) {
				val -= jQuery.css( elem, "padding" + cssExpand[ i ], true, styles );
			}

			// At this point, extra isn't border nor margin, so remove border
			if ( extra !== "margin" ) {
				val -= jQuery.css( elem, "border" + cssExpand[ i ] + "Width", true, styles );
			}
		} else {
			// At this point, extra isn't content, so add padding
			val += jQuery.css( elem, "padding" + cssExpand[ i ], true, styles );

			// At this point, extra isn't content nor padding, so add border
			if ( extra !== "padding" ) {
				val += jQuery.css( elem, "border" + cssExpand[ i ] + "Width", true, styles );
			}
		}
	}

	return val;
}

function getWidthOrHeight( elem, name, extra ) {

	// Start with offset property, which is equivalent to the border-box value
	var valueIsBorderBox = true,
		val = name === "width" ? elem.offsetWidth : elem.offsetHeight,
		styles = getStyles( elem ),
		isBorderBox = jQuery.css( elem, "boxSizing", false, styles ) === "border-box";

	// Some non-html elements return undefined for offsetWidth, so check for null/undefined
	// svg - https://bugzilla.mozilla.org/show_bug.cgi?id=649285
	// MathML - https://bugzilla.mozilla.org/show_bug.cgi?id=491668
	if ( val <= 0 || val == null ) {
		// Fall back to computed then uncomputed css if necessary
		val = curCSS( elem, name, styles );
		if ( val < 0 || val == null ) {
			val = elem.style[ name ];
		}

		// Computed unit is not pixels. Stop here and return.
		if ( rnumnonpx.test(val) ) {
			return val;
		}

		// Check for style in case a browser which returns unreliable values
		// for getComputedStyle silently falls back to the reliable elem.style
		valueIsBorderBox = isBorderBox &&
			( support.boxSizingReliable() || val === elem.style[ name ] );

		// Normalize "", auto, and prepare for extra
		val = parseFloat( val ) || 0;
	}

	// Use the active box-sizing model to add/subtract irrelevant styles
	return ( val +
		augmentWidthOrHeight(
			elem,
			name,
			extra || ( isBorderBox ? "border" : "content" ),
			valueIsBorderBox,
			styles
		)
	) + "px";
}

function showHide( elements, show ) {
	var display, elem, hidden,
		values = [],
		index = 0,
		length = elements.length;

	for ( ; index < length; index++ ) {
		elem = elements[ index ];
		if ( !elem.style ) {
			continue;
		}

		values[ index ] = data_priv.get( elem, "olddisplay" );
		display = elem.style.display;
		if ( show ) {
			// Reset the inline display of this element to learn if it is
			// being hidden by cascaded rules or not
			if ( !values[ index ] && display === "none" ) {
				elem.style.display = "";
			}

			// Set elements which have been overridden with display: none
			// in a stylesheet to whatever the default browser style is
			// for such an element
			if ( elem.style.display === "" && isHidden( elem ) ) {
				values[ index ] = data_priv.access( elem, "olddisplay", defaultDisplay(elem.nodeName) );
			}
		} else {
			hidden = isHidden( elem );

			if ( display !== "none" || !hidden ) {
				data_priv.set( elem, "olddisplay", hidden ? display : jQuery.css( elem, "display" ) );
			}
		}
	}

	// Set the display of most of the elements in a second loop
	// to avoid the constant reflow
	for ( index = 0; index < length; index++ ) {
		elem = elements[ index ];
		if ( !elem.style ) {
			continue;
		}
		if ( !show || elem.style.display === "none" || elem.style.display === "" ) {
			elem.style.display = show ? values[ index ] || "" : "none";
		}
	}

	return elements;
}

jQuery.extend({

	// Add in style property hooks for overriding the default
	// behavior of getting and setting a style property
	cssHooks: {
		opacity: {
			get: function( elem, computed ) {
				if ( computed ) {

					// We should always get a number back from opacity
					var ret = curCSS( elem, "opacity" );
					return ret === "" ? "1" : ret;
				}
			}
		}
	},

	// Don't automatically add "px" to these possibly-unitless properties
	cssNumber: {
		"columnCount": true,
		"fillOpacity": true,
		"flexGrow": true,
		"flexShrink": true,
		"fontWeight": true,
		"lineHeight": true,
		"opacity": true,
		"order": true,
		"orphans": true,
		"widows": true,
		"zIndex": true,
		"zoom": true
	},

	// Add in properties whose names you wish to fix before
	// setting or getting the value
	cssProps: {
		"float": "cssFloat"
	},

	// Get and set the style property on a DOM Node
	style: function( elem, name, value, extra ) {

		// Don't set styles on text and comment nodes
		if ( !elem || elem.nodeType === 3 || elem.nodeType === 8 || !elem.style ) {
			return;
		}

		// Make sure that we're working with the right name
		var ret, type, hooks,
			origName = jQuery.camelCase( name ),
			style = elem.style;

		name = jQuery.cssProps[ origName ] || ( jQuery.cssProps[ origName ] = vendorPropName( style, origName ) );

		// Gets hook for the prefixed version, then unprefixed version
		hooks = jQuery.cssHooks[ name ] || jQuery.cssHooks[ origName ];

		// Check if we're setting a value
		if ( value !== undefined ) {
			type = typeof value;

			// Convert "+=" or "-=" to relative numbers (#7345)
			if ( type === "string" && (ret = rrelNum.exec( value )) ) {
				value = ( ret[1] + 1 ) * ret[2] + parseFloat( jQuery.css( elem, name ) );
				// Fixes bug #9237
				type = "number";
			}

			// Make sure that null and NaN values aren't set (#7116)
			if ( value == null || value !== value ) {
				return;
			}

			// If a number, add 'px' to the (except for certain CSS properties)
			if ( type === "number" && !jQuery.cssNumber[ origName ] ) {
				value += "px";
			}

			// Support: IE9-11+
			// background-* props affect original clone's values
			if ( !support.clearCloneStyle && value === "" && name.indexOf( "background" ) === 0 ) {
				style[ name ] = "inherit";
			}

			// If a hook was provided, use that value, otherwise just set the specified value
			if ( !hooks || !("set" in hooks) || (value = hooks.set( elem, value, extra )) !== undefined ) {
				style[ name ] = value;
			}

		} else {
			// If a hook was provided get the non-computed value from there
			if ( hooks && "get" in hooks && (ret = hooks.get( elem, false, extra )) !== undefined ) {
				return ret;
			}

			// Otherwise just get the value from the style object
			return style[ name ];
		}
	},

	css: function( elem, name, extra, styles ) {
		var val, num, hooks,
			origName = jQuery.camelCase( name );

		// Make sure that we're working with the right name
		name = jQuery.cssProps[ origName ] || ( jQuery.cssProps[ origName ] = vendorPropName( elem.style, origName ) );

		// Try prefixed name followed by the unprefixed name
		hooks = jQuery.cssHooks[ name ] || jQuery.cssHooks[ origName ];

		// If a hook was provided get the computed value from there
		if ( hooks && "get" in hooks ) {
			val = hooks.get( elem, true, extra );
		}

		// Otherwise, if a way to get the computed value exists, use that
		if ( val === undefined ) {
			val = curCSS( elem, name, styles );
		}

		// Convert "normal" to computed value
		if ( val === "normal" && name in cssNormalTransform ) {
			val = cssNormalTransform[ name ];
		}

		// Make numeric if forced or a qualifier was provided and val looks numeric
		if ( extra === "" || extra ) {
			num = parseFloat( val );
			return extra === true || jQuery.isNumeric( num ) ? num || 0 : val;
		}
		return val;
	}
});

jQuery.each([ "height", "width" ], function( i, name ) {
	jQuery.cssHooks[ name ] = {
		get: function( elem, computed, extra ) {
			if ( computed ) {

				// Certain elements can have dimension info if we invisibly show them
				// but it must have a current display style that would benefit
				return rdisplayswap.test( jQuery.css( elem, "display" ) ) && elem.offsetWidth === 0 ?
					jQuery.swap( elem, cssShow, function() {
						return getWidthOrHeight( elem, name, extra );
					}) :
					getWidthOrHeight( elem, name, extra );
			}
		},

		set: function( elem, value, extra ) {
			var styles = extra && getStyles( elem );
			return setPositiveNumber( elem, value, extra ?
				augmentWidthOrHeight(
					elem,
					name,
					extra,
					jQuery.css( elem, "boxSizing", false, styles ) === "border-box",
					styles
				) : 0
			);
		}
	};
});

// Support: Android 2.3
jQuery.cssHooks.marginRight = addGetHookIf( support.reliableMarginRight,
	function( elem, computed ) {
		if ( computed ) {
			return jQuery.swap( elem, { "display": "inline-block" },
				curCSS, [ elem, "marginRight" ] );
		}
	}
);

// These hooks are used by animate to expand properties
jQuery.each({
	margin: "",
	padding: "",
	border: "Width"
}, function( prefix, suffix ) {
	jQuery.cssHooks[ prefix + suffix ] = {
		expand: function( value ) {
			var i = 0,
				expanded = {},

				// Assumes a single number if not a string
				parts = typeof value === "string" ? value.split(" ") : [ value ];

			for ( ; i < 4; i++ ) {
				expanded[ prefix + cssExpand[ i ] + suffix ] =
					parts[ i ] || parts[ i - 2 ] || parts[ 0 ];
			}

			return expanded;
		}
	};

	if ( !rmargin.test( prefix ) ) {
		jQuery.cssHooks[ prefix + suffix ].set = setPositiveNumber;
	}
});

jQuery.fn.extend({
	css: function( name, value ) {
		return access( this, function( elem, name, value ) {
			var styles, len,
				map = {},
				i = 0;

			if ( jQuery.isArray( name ) ) {
				styles = getStyles( elem );
				len = name.length;

				for ( ; i < len; i++ ) {
					map[ name[ i ] ] = jQuery.css( elem, name[ i ], false, styles );
				}

				return map;
			}

			return value !== undefined ?
				jQuery.style( elem, name, value ) :
				jQuery.css( elem, name );
		}, name, value, arguments.length > 1 );
	},
	show: function() {
		return showHide( this, true );
	},
	hide: function() {
		return showHide( this );
	},
	toggle: function( state ) {
		if ( typeof state === "boolean" ) {
			return state ? this.show() : this.hide();
		}

		return this.each(function() {
			if ( isHidden( this ) ) {
				jQuery( this ).show();
			} else {
				jQuery( this ).hide();
			}
		});
	}
});


function Tween( elem, options, prop, end, easing ) {
	return new Tween.prototype.init( elem, options, prop, end, easing );
}
jQuery.Tween = Tween;

Tween.prototype = {
	constructor: Tween,
	init: function( elem, options, prop, end, easing, unit ) {
		this.elem = elem;
		this.prop = prop;
		this.easing = easing || "swing";
		this.options = options;
		this.start = this.now = this.cur();
		this.end = end;
		this.unit = unit || ( jQuery.cssNumber[ prop ] ? "" : "px" );
	},
	cur: function() {
		var hooks = Tween.propHooks[ this.prop ];

		return hooks && hooks.get ?
			hooks.get( this ) :
			Tween.propHooks._default.get( this );
	},
	run: function( percent ) {
		var eased,
			hooks = Tween.propHooks[ this.prop ];

		if ( this.options.duration ) {
			this.pos = eased = jQuery.easing[ this.easing ](
				percent, this.options.duration * percent, 0, 1, this.options.duration
			);
		} else {
			this.pos = eased = percent;
		}
		this.now = ( this.end - this.start ) * eased + this.start;

		if ( this.options.step ) {
			this.options.step.call( this.elem, this.now, this );
		}

		if ( hooks && hooks.set ) {
			hooks.set( this );
		} else {
			Tween.propHooks._default.set( this );
		}
		return this;
	}
};

Tween.prototype.init.prototype = Tween.prototype;

Tween.propHooks = {
	_default: {
		get: function( tween ) {
			var result;

			if ( tween.elem[ tween.prop ] != null &&
				(!tween.elem.style || tween.elem.style[ tween.prop ] == null) ) {
				return tween.elem[ tween.prop ];
			}

			// Passing an empty string as a 3rd parameter to .css will automatically
			// attempt a parseFloat and fallback to a string if the parse fails.
			// Simple values such as "10px" are parsed to Float;
			// complex values such as "rotate(1rad)" are returned as-is.
			result = jQuery.css( tween.elem, tween.prop, "" );
			// Empty strings, null, undefined and "auto" are converted to 0.
			return !result || result === "auto" ? 0 : result;
		},
		set: function( tween ) {
			// Use step hook for back compat.
			// Use cssHook if its there.
			// Use .style if available and use plain properties where available.
			if ( jQuery.fx.step[ tween.prop ] ) {
				jQuery.fx.step[ tween.prop ]( tween );
			} else if ( tween.elem.style && ( tween.elem.style[ jQuery.cssProps[ tween.prop ] ] != null || jQuery.cssHooks[ tween.prop ] ) ) {
				jQuery.style( tween.elem, tween.prop, tween.now + tween.unit );
			} else {
				tween.elem[ tween.prop ] = tween.now;
			}
		}
	}
};

// Support: IE9
// Panic based approach to setting things on disconnected nodes
Tween.propHooks.scrollTop = Tween.propHooks.scrollLeft = {
	set: function( tween ) {
		if ( tween.elem.nodeType && tween.elem.parentNode ) {
			tween.elem[ tween.prop ] = tween.now;
		}
	}
};

jQuery.easing = {
	linear: function( p ) {
		return p;
	},
	swing: function( p ) {
		return 0.5 - Math.cos( p * Math.PI ) / 2;
	}
};

jQuery.fx = Tween.prototype.init;

// Back Compat <1.8 extension point
jQuery.fx.step = {};




var
	fxNow, timerId,
	rfxtypes = /^(?:toggle|show|hide)$/,
	rfxnum = new RegExp( "^(?:([+-])=|)(" + pnum + ")([a-z%]*)$", "i" ),
	rrun = /queueHooks$/,
	animationPrefilters = [ defaultPrefilter ],
	tweeners = {
		"*": [ function( prop, value ) {
			var tween = this.createTween( prop, value ),
				target = tween.cur(),
				parts = rfxnum.exec( value ),
				unit = parts && parts[ 3 ] || ( jQuery.cssNumber[ prop ] ? "" : "px" ),

				// Starting value computation is required for potential unit mismatches
				start = ( jQuery.cssNumber[ prop ] || unit !== "px" && +target ) &&
					rfxnum.exec( jQuery.css( tween.elem, prop ) ),
				scale = 1,
				maxIterations = 20;

			if ( start && start[ 3 ] !== unit ) {
				// Trust units reported by jQuery.css
				unit = unit || start[ 3 ];

				// Make sure we update the tween properties later on
				parts = parts || [];

				// Iteratively approximate from a nonzero starting point
				start = +target || 1;

				do {
					// If previous iteration zeroed out, double until we get *something*.
					// Use string for doubling so we don't accidentally see scale as unchanged below
					scale = scale || ".5";

					// Adjust and apply
					start = start / scale;
					jQuery.style( tween.elem, prop, start + unit );

				// Update scale, tolerating zero or NaN from tween.cur(),
				// break the loop if scale is unchanged or perfect, or if we've just had enough
				} while ( scale !== (scale = tween.cur() / target) && scale !== 1 && --maxIterations );
			}

			// Update tween properties
			if ( parts ) {
				start = tween.start = +start || +target || 0;
				tween.unit = unit;
				// If a +=/-= token was provided, we're doing a relative animation
				tween.end = parts[ 1 ] ?
					start + ( parts[ 1 ] + 1 ) * parts[ 2 ] :
					+parts[ 2 ];
			}

			return tween;
		} ]
	};

// Animations created synchronously will run synchronously
function createFxNow() {
	setTimeout(function() {
		fxNow = undefined;
	});
	return ( fxNow = jQuery.now() );
}

// Generate parameters to create a standard animation
function genFx( type, includeWidth ) {
	var which,
		i = 0,
		attrs = { height: type };

	// If we include width, step value is 1 to do all cssExpand values,
	// otherwise step value is 2 to skip over Left and Right
	includeWidth = includeWidth ? 1 : 0;
	for ( ; i < 4 ; i += 2 - includeWidth ) {
		which = cssExpand[ i ];
		attrs[ "margin" + which ] = attrs[ "padding" + which ] = type;
	}

	if ( includeWidth ) {
		attrs.opacity = attrs.width = type;
	}

	return attrs;
}

function createTween( value, prop, animation ) {
	var tween,
		collection = ( tweeners[ prop ] || [] ).concat( tweeners[ "*" ] ),
		index = 0,
		length = collection.length;
	for ( ; index < length; index++ ) {
		if ( (tween = collection[ index ].call( animation, prop, value )) ) {

			// We're done with this property
			return tween;
		}
	}
}

function defaultPrefilter( elem, props, opts ) {
	/* jshint validthis: true */
	var prop, value, toggle, tween, hooks, oldfire, display, checkDisplay,
		anim = this,
		orig = {},
		style = elem.style,
		hidden = elem.nodeType && isHidden( elem ),
		dataShow = data_priv.get( elem, "fxshow" );

	// Handle queue: false promises
	if ( !opts.queue ) {
		hooks = jQuery._queueHooks( elem, "fx" );
		if ( hooks.unqueued == null ) {
			hooks.unqueued = 0;
			oldfire = hooks.empty.fire;
			hooks.empty.fire = function() {
				if ( !hooks.unqueued ) {
					oldfire();
				}
			};
		}
		hooks.unqueued++;

		anim.always(function() {
			// Ensure the complete handler is called before this completes
			anim.always(function() {
				hooks.unqueued--;
				if ( !jQuery.queue( elem, "fx" ).length ) {
					hooks.empty.fire();
				}
			});
		});
	}

	// Height/width overflow pass
	if ( elem.nodeType === 1 && ( "height" in props || "width" in props ) ) {
		// Make sure that nothing sneaks out
		// Record all 3 overflow attributes because IE9-10 do not
		// change the overflow attribute when overflowX and
		// overflowY are set to the same value
		opts.overflow = [ style.overflow, style.overflowX, style.overflowY ];

		// Set display property to inline-block for height/width
		// animations on inline elements that are having width/height animated
		display = jQuery.css( elem, "display" );

		// Test default display if display is currently "none"
		checkDisplay = display === "none" ?
			data_priv.get( elem, "olddisplay" ) || defaultDisplay( elem.nodeName ) : display;

		if ( checkDisplay === "inline" && jQuery.css( elem, "float" ) === "none" ) {
			style.display = "inline-block";
		}
	}

	if ( opts.overflow ) {
		style.overflow = "hidden";
		anim.always(function() {
			style.overflow = opts.overflow[ 0 ];
			style.overflowX = opts.overflow[ 1 ];
			style.overflowY = opts.overflow[ 2 ];
		});
	}

	// show/hide pass
	for ( prop in props ) {
		value = props[ prop ];
		if ( rfxtypes.exec( value ) ) {
			delete props[ prop ];
			toggle = toggle || value === "toggle";
			if ( value === ( hidden ? "hide" : "show" ) ) {

				// If there is dataShow left over from a stopped hide or show and we are going to proceed with show, we should pretend to be hidden
				if ( value === "show" && dataShow && dataShow[ prop ] !== undefined ) {
					hidden = true;
				} else {
					continue;
				}
			}
			orig[ prop ] = dataShow && dataShow[ prop ] || jQuery.style( elem, prop );

		// Any non-fx value stops us from restoring the original display value
		} else {
			display = undefined;
		}
	}

	if ( !jQuery.isEmptyObject( orig ) ) {
		if ( dataShow ) {
			if ( "hidden" in dataShow ) {
				hidden = dataShow.hidden;
			}
		} else {
			dataShow = data_priv.access( elem, "fxshow", {} );
		}

		// Store state if its toggle - enables .stop().toggle() to "reverse"
		if ( toggle ) {
			dataShow.hidden = !hidden;
		}
		if ( hidden ) {
			jQuery( elem ).show();
		} else {
			anim.done(function() {
				jQuery( elem ).hide();
			});
		}
		anim.done(function() {
			var prop;

			data_priv.remove( elem, "fxshow" );
			for ( prop in orig ) {
				jQuery.style( elem, prop, orig[ prop ] );
			}
		});
		for ( prop in orig ) {
			tween = createTween( hidden ? dataShow[ prop ] : 0, prop, anim );

			if ( !( prop in dataShow ) ) {
				dataShow[ prop ] = tween.start;
				if ( hidden ) {
					tween.end = tween.start;
					tween.start = prop === "width" || prop === "height" ? 1 : 0;
				}
			}
		}

	// If this is a noop like .hide().hide(), restore an overwritten display value
	} else if ( (display === "none" ? defaultDisplay( elem.nodeName ) : display) === "inline" ) {
		style.display = display;
	}
}

function propFilter( props, specialEasing ) {
	var index, name, easing, value, hooks;

	// camelCase, specialEasing and expand cssHook pass
	for ( index in props ) {
		name = jQuery.camelCase( index );
		easing = specialEasing[ name ];
		value = props[ index ];
		if ( jQuery.isArray( value ) ) {
			easing = value[ 1 ];
			value = props[ index ] = value[ 0 ];
		}

		if ( index !== name ) {
			props[ name ] = value;
			delete props[ index ];
		}

		hooks = jQuery.cssHooks[ name ];
		if ( hooks && "expand" in hooks ) {
			value = hooks.expand( value );
			delete props[ name ];

			// Not quite $.extend, this won't overwrite existing keys.
			// Reusing 'index' because we have the correct "name"
			for ( index in value ) {
				if ( !( index in props ) ) {
					props[ index ] = value[ index ];
					specialEasing[ index ] = easing;
				}
			}
		} else {
			specialEasing[ name ] = easing;
		}
	}
}

function Animation( elem, properties, options ) {
	var result,
		stopped,
		index = 0,
		length = animationPrefilters.length,
		deferred = jQuery.Deferred().always( function() {
			// Don't match elem in the :animated selector
			delete tick.elem;
		}),
		tick = function() {
			if ( stopped ) {
				return false;
			}
			var currentTime = fxNow || createFxNow(),
				remaining = Math.max( 0, animation.startTime + animation.duration - currentTime ),
				// Support: Android 2.3
				// Archaic crash bug won't allow us to use `1 - ( 0.5 || 0 )` (#12497)
				temp = remaining / animation.duration || 0,
				percent = 1 - temp,
				index = 0,
				length = animation.tweens.length;

			for ( ; index < length ; index++ ) {
				animation.tweens[ index ].run( percent );
			}

			deferred.notifyWith( elem, [ animation, percent, remaining ]);

			if ( percent < 1 && length ) {
				return remaining;
			} else {
				deferred.resolveWith( elem, [ animation ] );
				return false;
			}
		},
		animation = deferred.promise({
			elem: elem,
			props: jQuery.extend( {}, properties ),
			opts: jQuery.extend( true, { specialEasing: {} }, options ),
			originalProperties: properties,
			originalOptions: options,
			startTime: fxNow || createFxNow(),
			duration: options.duration,
			tweens: [],
			createTween: function( prop, end ) {
				var tween = jQuery.Tween( elem, animation.opts, prop, end,
						animation.opts.specialEasing[ prop ] || animation.opts.easing );
				animation.tweens.push( tween );
				return tween;
			},
			stop: function( gotoEnd ) {
				var index = 0,
					// If we are going to the end, we want to run all the tweens
					// otherwise we skip this part
					length = gotoEnd ? animation.tweens.length : 0;
				if ( stopped ) {
					return this;
				}
				stopped = true;
				for ( ; index < length ; index++ ) {
					animation.tweens[ index ].run( 1 );
				}

				// Resolve when we played the last frame; otherwise, reject
				if ( gotoEnd ) {
					deferred.resolveWith( elem, [ animation, gotoEnd ] );
				} else {
					deferred.rejectWith( elem, [ animation, gotoEnd ] );
				}
				return this;
			}
		}),
		props = animation.props;

	propFilter( props, animation.opts.specialEasing );

	for ( ; index < length ; index++ ) {
		result = animationPrefilters[ index ].call( animation, elem, props, animation.opts );
		if ( result ) {
			return result;
		}
	}

	jQuery.map( props, createTween, animation );

	if ( jQuery.isFunction( animation.opts.start ) ) {
		animation.opts.start.call( elem, animation );
	}

	jQuery.fx.timer(
		jQuery.extend( tick, {
			elem: elem,
			anim: animation,
			queue: animation.opts.queue
		})
	);

	// attach callbacks from options
	return animation.progress( animation.opts.progress )
		.done( animation.opts.done, animation.opts.complete )
		.fail( animation.opts.fail )
		.always( animation.opts.always );
}

jQuery.Animation = jQuery.extend( Animation, {

	tweener: function( props, callback ) {
		if ( jQuery.isFunction( props ) ) {
			callback = props;
			props = [ "*" ];
		} else {
			props = props.split(" ");
		}

		var prop,
			index = 0,
			length = props.length;

		for ( ; index < length ; index++ ) {
			prop = props[ index ];
			tweeners[ prop ] = tweeners[ prop ] || [];
			tweeners[ prop ].unshift( callback );
		}
	},

	prefilter: function( callback, prepend ) {
		if ( prepend ) {
			animationPrefilters.unshift( callback );
		} else {
			animationPrefilters.push( callback );
		}
	}
});

jQuery.speed = function( speed, easing, fn ) {
	var opt = speed && typeof speed === "object" ? jQuery.extend( {}, speed ) : {
		complete: fn || !fn && easing ||
			jQuery.isFunction( speed ) && speed,
		duration: speed,
		easing: fn && easing || easing && !jQuery.isFunction( easing ) && easing
	};

	opt.duration = jQuery.fx.off ? 0 : typeof opt.duration === "number" ? opt.duration :
		opt.duration in jQuery.fx.speeds ? jQuery.fx.speeds[ opt.duration ] : jQuery.fx.speeds._default;

	// Normalize opt.queue - true/undefined/null -> "fx"
	if ( opt.queue == null || opt.queue === true ) {
		opt.queue = "fx";
	}

	// Queueing
	opt.old = opt.complete;

	opt.complete = function() {
		if ( jQuery.isFunction( opt.old ) ) {
			opt.old.call( this );
		}

		if ( opt.queue ) {
			jQuery.dequeue( this, opt.queue );
		}
	};

	return opt;
};

jQuery.fn.extend({
	fadeTo: function( speed, to, easing, callback ) {

		// Show any hidden elements after setting opacity to 0
		return this.filter( isHidden ).css( "opacity", 0 ).show()

			// Animate to the value specified
			.end().animate({ opacity: to }, speed, easing, callback );
	},
	animate: function( prop, speed, easing, callback ) {
		var empty = jQuery.isEmptyObject( prop ),
			optall = jQuery.speed( speed, easing, callback ),
			doAnimation = function() {
				// Operate on a copy of prop so per-property easing won't be lost
				var anim = Animation( this, jQuery.extend( {}, prop ), optall );

				// Empty animations, or finishing resolves immediately
				if ( empty || data_priv.get( this, "finish" ) ) {
					anim.stop( true );
				}
			};
			doAnimation.finish = doAnimation;

		return empty || optall.queue === false ?
			this.each( doAnimation ) :
			this.queue( optall.queue, doAnimation );
	},
	stop: function( type, clearQueue, gotoEnd ) {
		var stopQueue = function( hooks ) {
			var stop = hooks.stop;
			delete hooks.stop;
			stop( gotoEnd );
		};

		if ( typeof type !== "string" ) {
			gotoEnd = clearQueue;
			clearQueue = type;
			type = undefined;
		}
		if ( clearQueue && type !== false ) {
			this.queue( type || "fx", [] );
		}

		return this.each(function() {
			var dequeue = true,
				index = type != null && type + "queueHooks",
				timers = jQuery.timers,
				data = data_priv.get( this );

			if ( index ) {
				if ( data[ index ] && data[ index ].stop ) {
					stopQueue( data[ index ] );
				}
			} else {
				for ( index in data ) {
					if ( data[ index ] && data[ index ].stop && rrun.test( index ) ) {
						stopQueue( data[ index ] );
					}
				}
			}

			for ( index = timers.length; index--; ) {
				if ( timers[ index ].elem === this && (type == null || timers[ index ].queue === type) ) {
					timers[ index ].anim.stop( gotoEnd );
					dequeue = false;
					timers.splice( index, 1 );
				}
			}

			// Start the next in the queue if the last step wasn't forced.
			// Timers currently will call their complete callbacks, which
			// will dequeue but only if they were gotoEnd.
			if ( dequeue || !gotoEnd ) {
				jQuery.dequeue( this, type );
			}
		});
	},
	finish: function( type ) {
		if ( type !== false ) {
			type = type || "fx";
		}
		return this.each(function() {
			var index,
				data = data_priv.get( this ),
				queue = data[ type + "queue" ],
				hooks = data[ type + "queueHooks" ],
				timers = jQuery.timers,
				length = queue ? queue.length : 0;

			// Enable finishing flag on private data
			data.finish = true;

			// Empty the queue first
			jQuery.queue( this, type, [] );

			if ( hooks && hooks.stop ) {
				hooks.stop.call( this, true );
			}

			// Look for any active animations, and finish them
			for ( index = timers.length; index--; ) {
				if ( timers[ index ].elem === this && timers[ index ].queue === type ) {
					timers[ index ].anim.stop( true );
					timers.splice( index, 1 );
				}
			}

			// Look for any animations in the old queue and finish them
			for ( index = 0; index < length; index++ ) {
				if ( queue[ index ] && queue[ index ].finish ) {
					queue[ index ].finish.call( this );
				}
			}

			// Turn off finishing flag
			delete data.finish;
		});
	}
});

jQuery.each([ "toggle", "show", "hide" ], function( i, name ) {
	var cssFn = jQuery.fn[ name ];
	jQuery.fn[ name ] = function( speed, easing, callback ) {
		return speed == null || typeof speed === "boolean" ?
			cssFn.apply( this, arguments ) :
			this.animate( genFx( name, true ), speed, easing, callback );
	};
});

// Generate shortcuts for custom animations
jQuery.each({
	slideDown: genFx("show"),
	slideUp: genFx("hide"),
	slideToggle: genFx("toggle"),
	fadeIn: { opacity: "show" },
	fadeOut: { opacity: "hide" },
	fadeToggle: { opacity: "toggle" }
}, function( name, props ) {
	jQuery.fn[ name ] = function( speed, easing, callback ) {
		return this.animate( props, speed, easing, callback );
	};
});

jQuery.timers = [];
jQuery.fx.tick = function() {
	var timer,
		i = 0,
		timers = jQuery.timers;

	fxNow = jQuery.now();

	for ( ; i < timers.length; i++ ) {
		timer = timers[ i ];
		// Checks the timer has not already been removed
		if ( !timer() && timers[ i ] === timer ) {
			timers.splice( i--, 1 );
		}
	}

	if ( !timers.length ) {
		jQuery.fx.stop();
	}
	fxNow = undefined;
};

jQuery.fx.timer = function( timer ) {
	jQuery.timers.push( timer );
	if ( timer() ) {
		jQuery.fx.start();
	} else {
		jQuery.timers.pop();
	}
};

jQuery.fx.interval = 13;

jQuery.fx.start = function() {
	if ( !timerId ) {
		timerId = setInterval( jQuery.fx.tick, jQuery.fx.interval );
	}
};

jQuery.fx.stop = function() {
	clearInterval( timerId );
	timerId = null;
};

jQuery.fx.speeds = {
	slow: 600,
	fast: 200,
	// Default speed
	_default: 400
};


// Based off of the plugin by Clint Helfers, with permission.
// http://blindsignals.com/index.php/2009/07/jquery-delay/
jQuery.fn.delay = function( time, type ) {
	time = jQuery.fx ? jQuery.fx.speeds[ time ] || time : time;
	type = type || "fx";

	return this.queue( type, function( next, hooks ) {
		var timeout = setTimeout( next, time );
		hooks.stop = function() {
			clearTimeout( timeout );
		};
	});
};


(function() {
	var input = document.createElement( "input" ),
		select = document.createElement( "select" ),
		opt = select.appendChild( document.createElement( "option" ) );

	input.type = "checkbox";

	// Support: iOS<=5.1, Android<=4.2+
	// Default value for a checkbox should be "on"
	support.checkOn = input.value !== "";

	// Support: IE<=11+
	// Must access selectedIndex to make default options select
	support.optSelected = opt.selected;

	// Support: Android<=2.3
	// Options inside disabled selects are incorrectly marked as disabled
	select.disabled = true;
	support.optDisabled = !opt.disabled;

	// Support: IE<=11+
	// An input loses its value after becoming a radio
	input = document.createElement( "input" );
	input.value = "t";
	input.type = "radio";
	support.radioValue = input.value === "t";
})();


var nodeHook, boolHook,
	attrHandle = jQuery.expr.attrHandle;

jQuery.fn.extend({
	attr: function( name, value ) {
		return access( this, jQuery.attr, name, value, arguments.length > 1 );
	},

	removeAttr: function( name ) {
		return this.each(function() {
			jQuery.removeAttr( this, name );
		});
	}
});

jQuery.extend({
	attr: function( elem, name, value ) {
		var hooks, ret,
			nType = elem.nodeType;

		// don't get/set attributes on text, comment and attribute nodes
		if ( !elem || nType === 3 || nType === 8 || nType === 2 ) {
			return;
		}

		// Fallback to prop when attributes are not supported
		if ( typeof elem.getAttribute === strundefined ) {
			return jQuery.prop( elem, name, value );
		}

		// All attributes are lowercase
		// Grab necessary hook if one is defined
		if ( nType !== 1 || !jQuery.isXMLDoc( elem ) ) {
			name = name.toLowerCase();
			hooks = jQuery.attrHooks[ name ] ||
				( jQuery.expr.match.bool.test( name ) ? boolHook : nodeHook );
		}

		if ( value !== undefined ) {

			if ( value === null ) {
				jQuery.removeAttr( elem, name );

			} else if ( hooks && "set" in hooks && (ret = hooks.set( elem, value, name )) !== undefined ) {
				return ret;

			} else {
				elem.setAttribute( name, value + "" );
				return value;
			}

		} else if ( hooks && "get" in hooks && (ret = hooks.get( elem, name )) !== null ) {
			return ret;

		} else {
			ret = jQuery.find.attr( elem, name );

			// Non-existent attributes return null, we normalize to undefined
			return ret == null ?
				undefined :
				ret;
		}
	},

	removeAttr: function( elem, value ) {
		var name, propName,
			i = 0,
			attrNames = value && value.match( rnotwhite );

		if ( attrNames && elem.nodeType === 1 ) {
			while ( (name = attrNames[i++]) ) {
				propName = jQuery.propFix[ name ] || name;

				// Boolean attributes get special treatment (#10870)
				if ( jQuery.expr.match.bool.test( name ) ) {
					// Set corresponding property to false
					elem[ propName ] = false;
				}

				elem.removeAttribute( name );
			}
		}
	},

	attrHooks: {
		type: {
			set: function( elem, value ) {
				if ( !support.radioValue && value === "radio" &&
					jQuery.nodeName( elem, "input" ) ) {
					var val = elem.value;
					elem.setAttribute( "type", value );
					if ( val ) {
						elem.value = val;
					}
					return value;
				}
			}
		}
	}
});

// Hooks for boolean attributes
boolHook = {
	set: function( elem, value, name ) {
		if ( value === false ) {
			// Remove boolean attributes when set to false
			jQuery.removeAttr( elem, name );
		} else {
			elem.setAttribute( name, name );
		}
		return name;
	}
};
jQuery.each( jQuery.expr.match.bool.source.match( /\w+/g ), function( i, name ) {
	var getter = attrHandle[ name ] || jQuery.find.attr;

	attrHandle[ name ] = function( elem, name, isXML ) {
		var ret, handle;
		if ( !isXML ) {
			// Avoid an infinite loop by temporarily removing this function from the getter
			handle = attrHandle[ name ];
			attrHandle[ name ] = ret;
			ret = getter( elem, name, isXML ) != null ?
				name.toLowerCase() :
				null;
			attrHandle[ name ] = handle;
		}
		return ret;
	};
});




var rfocusable = /^(?:input|select|textarea|button)$/i;

jQuery.fn.extend({
	prop: function( name, value ) {
		return access( this, jQuery.prop, name, value, arguments.length > 1 );
	},

	removeProp: function( name ) {
		return this.each(function() {
			delete this[ jQuery.propFix[ name ] || name ];
		});
	}
});

jQuery.extend({
	propFix: {
		"for": "htmlFor",
		"class": "className"
	},

	prop: function( elem, name, value ) {
		var ret, hooks, notxml,
			nType = elem.nodeType;

		// Don't get/set properties on text, comment and attribute nodes
		if ( !elem || nType === 3 || nType === 8 || nType === 2 ) {
			return;
		}

		notxml = nType !== 1 || !jQuery.isXMLDoc( elem );

		if ( notxml ) {
			// Fix name and attach hooks
			name = jQuery.propFix[ name ] || name;
			hooks = jQuery.propHooks[ name ];
		}

		if ( value !== undefined ) {
			return hooks && "set" in hooks && (ret = hooks.set( elem, value, name )) !== undefined ?
				ret :
				( elem[ name ] = value );

		} else {
			return hooks && "get" in hooks && (ret = hooks.get( elem, name )) !== null ?
				ret :
				elem[ name ];
		}
	},

	propHooks: {
		tabIndex: {
			get: function( elem ) {
				return elem.hasAttribute( "tabindex" ) || rfocusable.test( elem.nodeName ) || elem.href ?
					elem.tabIndex :
					-1;
			}
		}
	}
});

if ( !support.optSelected ) {
	jQuery.propHooks.selected = {
		get: function( elem ) {
			var parent = elem.parentNode;
			if ( parent && parent.parentNode ) {
				parent.parentNode.selectedIndex;
			}
			return null;
		}
	};
}

jQuery.each([
	"tabIndex",
	"readOnly",
	"maxLength",
	"cellSpacing",
	"cellPadding",
	"rowSpan",
	"colSpan",
	"useMap",
	"frameBorder",
	"contentEditable"
], function() {
	jQuery.propFix[ this.toLowerCase() ] = this;
});




var rclass = /[\t\r\n\f]/g;

jQuery.fn.extend({
	addClass: function( value ) {
		var classes, elem, cur, clazz, j, finalValue,
			proceed = typeof value === "string" && value,
			i = 0,
			len = this.length;

		if ( jQuery.isFunction( value ) ) {
			return this.each(function( j ) {
				jQuery( this ).addClass( value.call( this, j, this.className ) );
			});
		}

		if ( proceed ) {
			// The disjunction here is for better compressibility (see removeClass)
			classes = ( value || "" ).match( rnotwhite ) || [];

			for ( ; i < len; i++ ) {
				elem = this[ i ];
				cur = elem.nodeType === 1 && ( elem.className ?
					( " " + elem.className + " " ).replace( rclass, " " ) :
					" "
				);

				if ( cur ) {
					j = 0;
					while ( (clazz = classes[j++]) ) {
						if ( cur.indexOf( " " + clazz + " " ) < 0 ) {
							cur += clazz + " ";
						}
					}

					// only assign if different to avoid unneeded rendering.
					finalValue = jQuery.trim( cur );
					if ( elem.className !== finalValue ) {
						elem.className = finalValue;
					}
				}
			}
		}

		return this;
	},

	removeClass: function( value ) {
		var classes, elem, cur, clazz, j, finalValue,
			proceed = arguments.length === 0 || typeof value === "string" && value,
			i = 0,
			len = this.length;

		if ( jQuery.isFunction( value ) ) {
			return this.each(function( j ) {
				jQuery( this ).removeClass( value.call( this, j, this.className ) );
			});
		}
		if ( proceed ) {
			classes = ( value || "" ).match( rnotwhite ) || [];

			for ( ; i < len; i++ ) {
				elem = this[ i ];
				// This expression is here for better compressibility (see addClass)
				cur = elem.nodeType === 1 && ( elem.className ?
					( " " + elem.className + " " ).replace( rclass, " " ) :
					""
				);

				if ( cur ) {
					j = 0;
					while ( (clazz = classes[j++]) ) {
						// Remove *all* instances
						while ( cur.indexOf( " " + clazz + " " ) >= 0 ) {
							cur = cur.replace( " " + clazz + " ", " " );
						}
					}

					// Only assign if different to avoid unneeded rendering.
					finalValue = value ? jQuery.trim( cur ) : "";
					if ( elem.className !== finalValue ) {
						elem.className = finalValue;
					}
				}
			}
		}

		return this;
	},

	toggleClass: function( value, stateVal ) {
		var type = typeof value;

		if ( typeof stateVal === "boolean" && type === "string" ) {
			return stateVal ? this.addClass( value ) : this.removeClass( value );
		}

		if ( jQuery.isFunction( value ) ) {
			return this.each(function( i ) {
				jQuery( this ).toggleClass( value.call(this, i, this.className, stateVal), stateVal );
			});
		}

		return this.each(function() {
			if ( type === "string" ) {
				// Toggle individual class names
				var className,
					i = 0,
					self = jQuery( this ),
					classNames = value.match( rnotwhite ) || [];

				while ( (className = classNames[ i++ ]) ) {
					// Check each className given, space separated list
					if ( self.hasClass( className ) ) {
						self.removeClass( className );
					} else {
						self.addClass( className );
					}
				}

			// Toggle whole class name
			} else if ( type === strundefined || type === "boolean" ) {
				if ( this.className ) {
					// store className if set
					data_priv.set( this, "__className__", this.className );
				}

				// If the element has a class name or if we're passed `false`,
				// then remove the whole classname (if there was one, the above saved it).
				// Otherwise bring back whatever was previously saved (if anything),
				// falling back to the empty string if nothing was stored.
				this.className = this.className || value === false ? "" : data_priv.get( this, "__className__" ) || "";
			}
		});
	},

	hasClass: function( selector ) {
		var className = " " + selector + " ",
			i = 0,
			l = this.length;
		for ( ; i < l; i++ ) {
			if ( this[i].nodeType === 1 && (" " + this[i].className + " ").replace(rclass, " ").indexOf( className ) >= 0 ) {
				return true;
			}
		}

		return false;
	}
});




var rreturn = /\r/g;

jQuery.fn.extend({
	val: function( value ) {
		var hooks, ret, isFunction,
			elem = this[0];

		if ( !arguments.length ) {
			if ( elem ) {
				hooks = jQuery.valHooks[ elem.type ] || jQuery.valHooks[ elem.nodeName.toLowerCase() ];

				if ( hooks && "get" in hooks && (ret = hooks.get( elem, "value" )) !== undefined ) {
					return ret;
				}

				ret = elem.value;

				return typeof ret === "string" ?
					// Handle most common string cases
					ret.replace(rreturn, "") :
					// Handle cases where value is null/undef or number
					ret == null ? "" : ret;
			}

			return;
		}

		isFunction = jQuery.isFunction( value );

		return this.each(function( i ) {
			var val;

			if ( this.nodeType !== 1 ) {
				return;
			}

			if ( isFunction ) {
				val = value.call( this, i, jQuery( this ).val() );
			} else {
				val = value;
			}

			// Treat null/undefined as ""; convert numbers to string
			if ( val == null ) {
				val = "";

			} else if ( typeof val === "number" ) {
				val += "";

			} else if ( jQuery.isArray( val ) ) {
				val = jQuery.map( val, function( value ) {
					return value == null ? "" : value + "";
				});
			}

			hooks = jQuery.valHooks[ this.type ] || jQuery.valHooks[ this.nodeName.toLowerCase() ];

			// If set returns undefined, fall back to normal setting
			if ( !hooks || !("set" in hooks) || hooks.set( this, val, "value" ) === undefined ) {
				this.value = val;
			}
		});
	}
});

jQuery.extend({
	valHooks: {
		option: {
			get: function( elem ) {
				var val = jQuery.find.attr( elem, "value" );
				return val != null ?
					val :
					// Support: IE10-11+
					// option.text throws exceptions (#14686, #14858)
					jQuery.trim( jQuery.text( elem ) );
			}
		},
		select: {
			get: function( elem ) {
				var value, option,
					options = elem.options,
					index = elem.selectedIndex,
					one = elem.type === "select-one" || index < 0,
					values = one ? null : [],
					max = one ? index + 1 : options.length,
					i = index < 0 ?
						max :
						one ? index : 0;

				// Loop through all the selected options
				for ( ; i < max; i++ ) {
					option = options[ i ];

					// IE6-9 doesn't update selected after form reset (#2551)
					if ( ( option.selected || i === index ) &&
							// Don't return options that are disabled or in a disabled optgroup
							( support.optDisabled ? !option.disabled : option.getAttribute( "disabled" ) === null ) &&
							( !option.parentNode.disabled || !jQuery.nodeName( option.parentNode, "optgroup" ) ) ) {

						// Get the specific value for the option
						value = jQuery( option ).val();

						// We don't need an array for one selects
						if ( one ) {
							return value;
						}

						// Multi-Selects return an array
						values.push( value );
					}
				}

				return values;
			},

			set: function( elem, value ) {
				var optionSet, option,
					options = elem.options,
					values = jQuery.makeArray( value ),
					i = options.length;

				while ( i-- ) {
					option = options[ i ];
					if ( (option.selected = jQuery.inArray( option.value, values ) >= 0) ) {
						optionSet = true;
					}
				}

				// Force browsers to behave consistently when non-matching value is set
				if ( !optionSet ) {
					elem.selectedIndex = -1;
				}
				return values;
			}
		}
	}
});

// Radios and checkboxes getter/setter
jQuery.each([ "radio", "checkbox" ], function() {
	jQuery.valHooks[ this ] = {
		set: function( elem, value ) {
			if ( jQuery.isArray( value ) ) {
				return ( elem.checked = jQuery.inArray( jQuery(elem).val(), value ) >= 0 );
			}
		}
	};
	if ( !support.checkOn ) {
		jQuery.valHooks[ this ].get = function( elem ) {
			return elem.getAttribute("value") === null ? "on" : elem.value;
		};
	}
});




// Return jQuery for attributes-only inclusion


jQuery.each( ("blur focus focusin focusout load resize scroll unload click dblclick " +
	"mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave " +
	"change select submit keydown keypress keyup error contextmenu").split(" "), function( i, name ) {

	// Handle event binding
	jQuery.fn[ name ] = function( data, fn ) {
		return arguments.length > 0 ?
			this.on( name, null, data, fn ) :
			this.trigger( name );
	};
});

jQuery.fn.extend({
	hover: function( fnOver, fnOut ) {
		return this.mouseenter( fnOver ).mouseleave( fnOut || fnOver );
	},

	bind: function( types, data, fn ) {
		return this.on( types, null, data, fn );
	},
	unbind: function( types, fn ) {
		return this.off( types, null, fn );
	},

	delegate: function( selector, types, data, fn ) {
		return this.on( types, selector, data, fn );
	},
	undelegate: function( selector, types, fn ) {
		// ( namespace ) or ( selector, types [, fn] )
		return arguments.length === 1 ? this.off( selector, "**" ) : this.off( types, selector || "**", fn );
	}
});


var nonce = jQuery.now();

var rquery = (/\?/);



// Support: Android 2.3
// Workaround failure to string-cast null input
jQuery.parseJSON = function( data ) {
	return JSON.parse( data + "" );
};


// Cross-browser xml parsing
jQuery.parseXML = function( data ) {
	var xml, tmp;
	if ( !data || typeof data !== "string" ) {
		return null;
	}

	// Support: IE9
	try {
		tmp = new DOMParser();
		xml = tmp.parseFromString( data, "text/xml" );
	} catch ( e ) {
		xml = undefined;
	}

	if ( !xml || xml.getElementsByTagName( "parsererror" ).length ) {
		jQuery.error( "Invalid XML: " + data );
	}
	return xml;
};


var
	rhash = /#.*$/,
	rts = /([?&])_=[^&]*/,
	rheaders = /^(.*?):[ \t]*([^\r\n]*)$/mg,
	// #7653, #8125, #8152: local protocol detection
	rlocalProtocol = /^(?:about|app|app-storage|.+-extension|file|res|widget):$/,
	rnoContent = /^(?:GET|HEAD)$/,
	rprotocol = /^\/\//,
	rurl = /^([\w.+-]+:)(?:\/\/(?:[^\/?#]*@|)([^\/?#:]*)(?::(\d+)|)|)/,

	/* Prefilters
	 * 1) They are useful to introduce custom dataTypes (see ajax/jsonp.js for an example)
	 * 2) These are called:
	 *    - BEFORE asking for a transport
	 *    - AFTER param serialization (s.data is a string if s.processData is true)
	 * 3) key is the dataType
	 * 4) the catchall symbol "*" can be used
	 * 5) execution will start with transport dataType and THEN continue down to "*" if needed
	 */
	prefilters = {},

	/* Transports bindings
	 * 1) key is the dataType
	 * 2) the catchall symbol "*" can be used
	 * 3) selection will start with transport dataType and THEN go to "*" if needed
	 */
	transports = {},

	// Avoid comment-prolog char sequence (#10098); must appease lint and evade compression
	allTypes = "*/".concat( "*" ),

	// Document location
	ajaxLocation = window.location.href,

	// Segment location into parts
	ajaxLocParts = rurl.exec( ajaxLocation.toLowerCase() ) || [];

// Base "constructor" for jQuery.ajaxPrefilter and jQuery.ajaxTransport
function addToPrefiltersOrTransports( structure ) {

	// dataTypeExpression is optional and defaults to "*"
	return function( dataTypeExpression, func ) {

		if ( typeof dataTypeExpression !== "string" ) {
			func = dataTypeExpression;
			dataTypeExpression = "*";
		}

		var dataType,
			i = 0,
			dataTypes = dataTypeExpression.toLowerCase().match( rnotwhite ) || [];

		if ( jQuery.isFunction( func ) ) {
			// For each dataType in the dataTypeExpression
			while ( (dataType = dataTypes[i++]) ) {
				// Prepend if requested
				if ( dataType[0] === "+" ) {
					dataType = dataType.slice( 1 ) || "*";
					(structure[ dataType ] = structure[ dataType ] || []).unshift( func );

				// Otherwise append
				} else {
					(structure[ dataType ] = structure[ dataType ] || []).push( func );
				}
			}
		}
	};
}

// Base inspection function for prefilters and transports
function inspectPrefiltersOrTransports( structure, options, originalOptions, jqXHR ) {

	var inspected = {},
		seekingTransport = ( structure === transports );

	function inspect( dataType ) {
		var selected;
		inspected[ dataType ] = true;
		jQuery.each( structure[ dataType ] || [], function( _, prefilterOrFactory ) {
			var dataTypeOrTransport = prefilterOrFactory( options, originalOptions, jqXHR );
			if ( typeof dataTypeOrTransport === "string" && !seekingTransport && !inspected[ dataTypeOrTransport ] ) {
				options.dataTypes.unshift( dataTypeOrTransport );
				inspect( dataTypeOrTransport );
				return false;
			} else if ( seekingTransport ) {
				return !( selected = dataTypeOrTransport );
			}
		});
		return selected;
	}

	return inspect( options.dataTypes[ 0 ] ) || !inspected[ "*" ] && inspect( "*" );
}

// A special extend for ajax options
// that takes "flat" options (not to be deep extended)
// Fixes #9887
function ajaxExtend( target, src ) {
	var key, deep,
		flatOptions = jQuery.ajaxSettings.flatOptions || {};

	for ( key in src ) {
		if ( src[ key ] !== undefined ) {
			( flatOptions[ key ] ? target : ( deep || (deep = {}) ) )[ key ] = src[ key ];
		}
	}
	if ( deep ) {
		jQuery.extend( true, target, deep );
	}

	return target;
}

/* Handles responses to an ajax request:
 * - finds the right dataType (mediates between content-type and expected dataType)
 * - returns the corresponding response
 */
function ajaxHandleResponses( s, jqXHR, responses ) {

	var ct, type, finalDataType, firstDataType,
		contents = s.contents,
		dataTypes = s.dataTypes;

	// Remove auto dataType and get content-type in the process
	while ( dataTypes[ 0 ] === "*" ) {
		dataTypes.shift();
		if ( ct === undefined ) {
			ct = s.mimeType || jqXHR.getResponseHeader("Content-Type");
		}
	}

	// Check if we're dealing with a known content-type
	if ( ct ) {
		for ( type in contents ) {
			if ( contents[ type ] && contents[ type ].test( ct ) ) {
				dataTypes.unshift( type );
				break;
			}
		}
	}

	// Check to see if we have a response for the expected dataType
	if ( dataTypes[ 0 ] in responses ) {
		finalDataType = dataTypes[ 0 ];
	} else {
		// Try convertible dataTypes
		for ( type in responses ) {
			if ( !dataTypes[ 0 ] || s.converters[ type + " " + dataTypes[0] ] ) {
				finalDataType = type;
				break;
			}
			if ( !firstDataType ) {
				firstDataType = type;
			}
		}
		// Or just use first one
		finalDataType = finalDataType || firstDataType;
	}

	// If we found a dataType
	// We add the dataType to the list if needed
	// and return the corresponding response
	if ( finalDataType ) {
		if ( finalDataType !== dataTypes[ 0 ] ) {
			dataTypes.unshift( finalDataType );
		}
		return responses[ finalDataType ];
	}
}

/* Chain conversions given the request and the original response
 * Also sets the responseXXX fields on the jqXHR instance
 */
function ajaxConvert( s, response, jqXHR, isSuccess ) {
	var conv2, current, conv, tmp, prev,
		converters = {},
		// Work with a copy of dataTypes in case we need to modify it for conversion
		dataTypes = s.dataTypes.slice();

	// Create converters map with lowercased keys
	if ( dataTypes[ 1 ] ) {
		for ( conv in s.converters ) {
			converters[ conv.toLowerCase() ] = s.converters[ conv ];
		}
	}

	current = dataTypes.shift();

	// Convert to each sequential dataType
	while ( current ) {

		if ( s.responseFields[ current ] ) {
			jqXHR[ s.responseFields[ current ] ] = response;
		}

		// Apply the dataFilter if provided
		if ( !prev && isSuccess && s.dataFilter ) {
			response = s.dataFilter( response, s.dataType );
		}

		prev = current;
		current = dataTypes.shift();

		if ( current ) {

		// There's only work to do if current dataType is non-auto
			if ( current === "*" ) {

				current = prev;

			// Convert response if prev dataType is non-auto and differs from current
			} else if ( prev !== "*" && prev !== current ) {

				// Seek a direct converter
				conv = converters[ prev + " " + current ] || converters[ "* " + current ];

				// If none found, seek a pair
				if ( !conv ) {
					for ( conv2 in converters ) {

						// If conv2 outputs current
						tmp = conv2.split( " " );
						if ( tmp[ 1 ] === current ) {

							// If prev can be converted to accepted input
							conv = converters[ prev + " " + tmp[ 0 ] ] ||
								converters[ "* " + tmp[ 0 ] ];
							if ( conv ) {
								// Condense equivalence converters
								if ( conv === true ) {
									conv = converters[ conv2 ];

								// Otherwise, insert the intermediate dataType
								} else if ( converters[ conv2 ] !== true ) {
									current = tmp[ 0 ];
									dataTypes.unshift( tmp[ 1 ] );
								}
								break;
							}
						}
					}
				}

				// Apply converter (if not an equivalence)
				if ( conv !== true ) {

					// Unless errors are allowed to bubble, catch and return them
					if ( conv && s[ "throws" ] ) {
						response = conv( response );
					} else {
						try {
							response = conv( response );
						} catch ( e ) {
							return { state: "parsererror", error: conv ? e : "No conversion from " + prev + " to " + current };
						}
					}
				}
			}
		}
	}

	return { state: "success", data: response };
}

jQuery.extend({

	// Counter for holding the number of active queries
	active: 0,

	// Last-Modified header cache for next request
	lastModified: {},
	etag: {},

	ajaxSettings: {
		url: ajaxLocation,
		type: "GET",
		isLocal: rlocalProtocol.test( ajaxLocParts[ 1 ] ),
		global: true,
		processData: true,
		async: true,
		contentType: "application/x-www-form-urlencoded; charset=UTF-8",
		/*
		timeout: 0,
		data: null,
		dataType: null,
		username: null,
		password: null,
		cache: null,
		throws: false,
		traditional: false,
		headers: {},
		*/

		accepts: {
			"*": allTypes,
			text: "text/plain",
			html: "text/html",
			xml: "application/xml, text/xml",
			json: "application/json, text/javascript"
		},

		contents: {
			xml: /xml/,
			html: /html/,
			json: /json/
		},

		responseFields: {
			xml: "responseXML",
			text: "responseText",
			json: "responseJSON"
		},

		// Data converters
		// Keys separate source (or catchall "*") and destination types with a single space
		converters: {

			// Convert anything to text
			"* text": String,

			// Text to html (true = no transformation)
			"text html": true,

			// Evaluate text as a json expression
			"text json": jQuery.parseJSON,

			// Parse text as xml
			"text xml": jQuery.parseXML
		},

		// For options that shouldn't be deep extended:
		// you can add your own custom options here if
		// and when you create one that shouldn't be
		// deep extended (see ajaxExtend)
		flatOptions: {
			url: true,
			context: true
		}
	},

	// Creates a full fledged settings object into target
	// with both ajaxSettings and settings fields.
	// If target is omitted, writes into ajaxSettings.
	ajaxSetup: function( target, settings ) {
		return settings ?

			// Building a settings object
			ajaxExtend( ajaxExtend( target, jQuery.ajaxSettings ), settings ) :

			// Extending ajaxSettings
			ajaxExtend( jQuery.ajaxSettings, target );
	},

	ajaxPrefilter: addToPrefiltersOrTransports( prefilters ),
	ajaxTransport: addToPrefiltersOrTransports( transports ),

	// Main method
	ajax: function( url, options ) {

		// If url is an object, simulate pre-1.5 signature
		if ( typeof url === "object" ) {
			options = url;
			url = undefined;
		}

		// Force options to be an object
		options = options || {};

		var transport,
			// URL without anti-cache param
			cacheURL,
			// Response headers
			responseHeadersString,
			responseHeaders,
			// timeout handle
			timeoutTimer,
			// Cross-domain detection vars
			parts,
			// To know if global events are to be dispatched
			fireGlobals,
			// Loop variable
			i,
			// Create the final options object
			s = jQuery.ajaxSetup( {}, options ),
			// Callbacks context
			callbackContext = s.context || s,
			// Context for global events is callbackContext if it is a DOM node or jQuery collection
			globalEventContext = s.context && ( callbackContext.nodeType || callbackContext.jquery ) ?
				jQuery( callbackContext ) :
				jQuery.event,
			// Deferreds
			deferred = jQuery.Deferred(),
			completeDeferred = jQuery.Callbacks("once memory"),
			// Status-dependent callbacks
			statusCode = s.statusCode || {},
			// Headers (they are sent all at once)
			requestHeaders = {},
			requestHeadersNames = {},
			// The jqXHR state
			state = 0,
			// Default abort message
			strAbort = "canceled",
			// Fake xhr
			jqXHR = {
				readyState: 0,

				// Builds headers hashtable if needed
				getResponseHeader: function( key ) {
					var match;
					if ( state === 2 ) {
						if ( !responseHeaders ) {
							responseHeaders = {};
							while ( (match = rheaders.exec( responseHeadersString )) ) {
								responseHeaders[ match[1].toLowerCase() ] = match[ 2 ];
							}
						}
						match = responseHeaders[ key.toLowerCase() ];
					}
					return match == null ? null : match;
				},

				// Raw string
				getAllResponseHeaders: function() {
					return state === 2 ? responseHeadersString : null;
				},

				// Caches the header
				setRequestHeader: function( name, value ) {
					var lname = name.toLowerCase();
					if ( !state ) {
						name = requestHeadersNames[ lname ] = requestHeadersNames[ lname ] || name;
						requestHeaders[ name ] = value;
					}
					return this;
				},

				// Overrides response content-type header
				overrideMimeType: function( type ) {
					if ( !state ) {
						s.mimeType = type;
					}
					return this;
				},

				// Status-dependent callbacks
				statusCode: function( map ) {
					var code;
					if ( map ) {
						if ( state < 2 ) {
							for ( code in map ) {
								// Lazy-add the new callback in a way that preserves old ones
								statusCode[ code ] = [ statusCode[ code ], map[ code ] ];
							}
						} else {
							// Execute the appropriate callbacks
							jqXHR.always( map[ jqXHR.status ] );
						}
					}
					return this;
				},

				// Cancel the request
				abort: function( statusText ) {
					var finalText = statusText || strAbort;
					if ( transport ) {
						transport.abort( finalText );
					}
					done( 0, finalText );
					return this;
				}
			};

		// Attach deferreds
		deferred.promise( jqXHR ).complete = completeDeferred.add;
		jqXHR.success = jqXHR.done;
		jqXHR.error = jqXHR.fail;

		// Remove hash character (#7531: and string promotion)
		// Add protocol if not provided (prefilters might expect it)
		// Handle falsy url in the settings object (#10093: consistency with old signature)
		// We also use the url parameter if available
		s.url = ( ( url || s.url || ajaxLocation ) + "" ).replace( rhash, "" )
			.replace( rprotocol, ajaxLocParts[ 1 ] + "//" );

		// Alias method option to type as per ticket #12004
		s.type = options.method || options.type || s.method || s.type;

		// Extract dataTypes list
		s.dataTypes = jQuery.trim( s.dataType || "*" ).toLowerCase().match( rnotwhite ) || [ "" ];

		// A cross-domain request is in order when we have a protocol:host:port mismatch
		if ( s.crossDomain == null ) {
			parts = rurl.exec( s.url.toLowerCase() );
			s.crossDomain = !!( parts &&
				( parts[ 1 ] !== ajaxLocParts[ 1 ] || parts[ 2 ] !== ajaxLocParts[ 2 ] ||
					( parts[ 3 ] || ( parts[ 1 ] === "http:" ? "80" : "443" ) ) !==
						( ajaxLocParts[ 3 ] || ( ajaxLocParts[ 1 ] === "http:" ? "80" : "443" ) ) )
			);
		}

		// Convert data if not already a string
		if ( s.data && s.processData && typeof s.data !== "string" ) {
			s.data = jQuery.param( s.data, s.traditional );
		}

		// Apply prefilters
		inspectPrefiltersOrTransports( prefilters, s, options, jqXHR );

		// If request was aborted inside a prefilter, stop there
		if ( state === 2 ) {
			return jqXHR;
		}

		// We can fire global events as of now if asked to
		// Don't fire events if jQuery.event is undefined in an AMD-usage scenario (#15118)
		fireGlobals = jQuery.event && s.global;

		// Watch for a new set of requests
		if ( fireGlobals && jQuery.active++ === 0 ) {
			jQuery.event.trigger("ajaxStart");
		}

		// Uppercase the type
		s.type = s.type.toUpperCase();

		// Determine if request has content
		s.hasContent = !rnoContent.test( s.type );

		// Save the URL in case we're toying with the If-Modified-Since
		// and/or If-None-Match header later on
		cacheURL = s.url;

		// More options handling for requests with no content
		if ( !s.hasContent ) {

			// If data is available, append data to url
			if ( s.data ) {
				cacheURL = ( s.url += ( rquery.test( cacheURL ) ? "&" : "?" ) + s.data );
				// #9682: remove data so that it's not used in an eventual retry
				delete s.data;
			}

			// Add anti-cache in url if needed
			if ( s.cache === false ) {
				s.url = rts.test( cacheURL ) ?

					// If there is already a '_' parameter, set its value
					cacheURL.replace( rts, "$1_=" + nonce++ ) :

					// Otherwise add one to the end
					cacheURL + ( rquery.test( cacheURL ) ? "&" : "?" ) + "_=" + nonce++;
			}
		}

		// Set the If-Modified-Since and/or If-None-Match header, if in ifModified mode.
		if ( s.ifModified ) {
			if ( jQuery.lastModified[ cacheURL ] ) {
				jqXHR.setRequestHeader( "If-Modified-Since", jQuery.lastModified[ cacheURL ] );
			}
			if ( jQuery.etag[ cacheURL ] ) {
				jqXHR.setRequestHeader( "If-None-Match", jQuery.etag[ cacheURL ] );
			}
		}

		// Set the correct header, if data is being sent
		if ( s.data && s.hasContent && s.contentType !== false || options.contentType ) {
			jqXHR.setRequestHeader( "Content-Type", s.contentType );
		}

		// Set the Accepts header for the server, depending on the dataType
		jqXHR.setRequestHeader(
			"Accept",
			s.dataTypes[ 0 ] && s.accepts[ s.dataTypes[0] ] ?
				s.accepts[ s.dataTypes[0] ] + ( s.dataTypes[ 0 ] !== "*" ? ", " + allTypes + "; q=0.01" : "" ) :
				s.accepts[ "*" ]
		);

		// Check for headers option
		for ( i in s.headers ) {
			jqXHR.setRequestHeader( i, s.headers[ i ] );
		}

		// Allow custom headers/mimetypes and early abort
		if ( s.beforeSend && ( s.beforeSend.call( callbackContext, jqXHR, s ) === false || state === 2 ) ) {
			// Abort if not done already and return
			return jqXHR.abort();
		}

		// Aborting is no longer a cancellation
		strAbort = "abort";

		// Install callbacks on deferreds
		for ( i in { success: 1, error: 1, complete: 1 } ) {
			jqXHR[ i ]( s[ i ] );
		}

		// Get transport
		transport = inspectPrefiltersOrTransports( transports, s, options, jqXHR );

		// If no transport, we auto-abort
		if ( !transport ) {
			done( -1, "No Transport" );
		} else {
			jqXHR.readyState = 1;

			// Send global event
			if ( fireGlobals ) {
				globalEventContext.trigger( "ajaxSend", [ jqXHR, s ] );
			}
			// Timeout
			if ( s.async && s.timeout > 0 ) {
				timeoutTimer = setTimeout(function() {
					jqXHR.abort("timeout");
				}, s.timeout );
			}

			try {
				state = 1;
				transport.send( requestHeaders, done );
			} catch ( e ) {
				// Propagate exception as error if not done
				if ( state < 2 ) {
					done( -1, e );
				// Simply rethrow otherwise
				} else {
					throw e;
				}
			}
		}

		// Callback for when everything is done
		function done( status, nativeStatusText, responses, headers ) {
			var isSuccess, success, error, response, modified,
				statusText = nativeStatusText;

			// Called once
			if ( state === 2 ) {
				return;
			}

			// State is "done" now
			state = 2;

			// Clear timeout if it exists
			if ( timeoutTimer ) {
				clearTimeout( timeoutTimer );
			}

			// Dereference transport for early garbage collection
			// (no matter how long the jqXHR object will be used)
			transport = undefined;

			// Cache response headers
			responseHeadersString = headers || "";

			// Set readyState
			jqXHR.readyState = status > 0 ? 4 : 0;

			// Determine if successful
			isSuccess = status >= 200 && status < 300 || status === 304;

			// Get response data
			if ( responses ) {
				response = ajaxHandleResponses( s, jqXHR, responses );
			}

			// Convert no matter what (that way responseXXX fields are always set)
			response = ajaxConvert( s, response, jqXHR, isSuccess );

			// If successful, handle type chaining
			if ( isSuccess ) {

				// Set the If-Modified-Since and/or If-None-Match header, if in ifModified mode.
				if ( s.ifModified ) {
					modified = jqXHR.getResponseHeader("Last-Modified");
					if ( modified ) {
						jQuery.lastModified[ cacheURL ] = modified;
					}
					modified = jqXHR.getResponseHeader("etag");
					if ( modified ) {
						jQuery.etag[ cacheURL ] = modified;
					}
				}

				// if no content
				if ( status === 204 || s.type === "HEAD" ) {
					statusText = "nocontent";

				// if not modified
				} else if ( status === 304 ) {
					statusText = "notmodified";

				// If we have data, let's convert it
				} else {
					statusText = response.state;
					success = response.data;
					error = response.error;
					isSuccess = !error;
				}
			} else {
				// Extract error from statusText and normalize for non-aborts
				error = statusText;
				if ( status || !statusText ) {
					statusText = "error";
					if ( status < 0 ) {
						status = 0;
					}
				}
			}

			// Set data for the fake xhr object
			jqXHR.status = status;
			jqXHR.statusText = ( nativeStatusText || statusText ) + "";

			// Success/Error
			if ( isSuccess ) {
				deferred.resolveWith( callbackContext, [ success, statusText, jqXHR ] );
			} else {
				deferred.rejectWith( callbackContext, [ jqXHR, statusText, error ] );
			}

			// Status-dependent callbacks
			jqXHR.statusCode( statusCode );
			statusCode = undefined;

			if ( fireGlobals ) {
				globalEventContext.trigger( isSuccess ? "ajaxSuccess" : "ajaxError",
					[ jqXHR, s, isSuccess ? success : error ] );
			}

			// Complete
			completeDeferred.fireWith( callbackContext, [ jqXHR, statusText ] );

			if ( fireGlobals ) {
				globalEventContext.trigger( "ajaxComplete", [ jqXHR, s ] );
				// Handle the global AJAX counter
				if ( !( --jQuery.active ) ) {
					jQuery.event.trigger("ajaxStop");
				}
			}
		}

		return jqXHR;
	},

	getJSON: function( url, data, callback ) {
		return jQuery.get( url, data, callback, "json" );
	},

	getScript: function( url, callback ) {
		return jQuery.get( url, undefined, callback, "script" );
	}
});

jQuery.each( [ "get", "post" ], function( i, method ) {
	jQuery[ method ] = function( url, data, callback, type ) {
		// Shift arguments if data argument was omitted
		if ( jQuery.isFunction( data ) ) {
			type = type || callback;
			callback = data;
			data = undefined;
		}

		return jQuery.ajax({
			url: url,
			type: method,
			dataType: type,
			data: data,
			success: callback
		});
	};
});


jQuery._evalUrl = function( url ) {
	return jQuery.ajax({
		url: url,
		type: "GET",
		dataType: "script",
		async: false,
		global: false,
		"throws": true
	});
};


jQuery.fn.extend({
	wrapAll: function( html ) {
		var wrap;

		if ( jQuery.isFunction( html ) ) {
			return this.each(function( i ) {
				jQuery( this ).wrapAll( html.call(this, i) );
			});
		}

		if ( this[ 0 ] ) {

			// The elements to wrap the target around
			wrap = jQuery( html, this[ 0 ].ownerDocument ).eq( 0 ).clone( true );

			if ( this[ 0 ].parentNode ) {
				wrap.insertBefore( this[ 0 ] );
			}

			wrap.map(function() {
				var elem = this;

				while ( elem.firstElementChild ) {
					elem = elem.firstElementChild;
				}

				return elem;
			}).append( this );
		}

		return this;
	},

	wrapInner: function( html ) {
		if ( jQuery.isFunction( html ) ) {
			return this.each(function( i ) {
				jQuery( this ).wrapInner( html.call(this, i) );
			});
		}

		return this.each(function() {
			var self = jQuery( this ),
				contents = self.contents();

			if ( contents.length ) {
				contents.wrapAll( html );

			} else {
				self.append( html );
			}
		});
	},

	wrap: function( html ) {
		var isFunction = jQuery.isFunction( html );

		return this.each(function( i ) {
			jQuery( this ).wrapAll( isFunction ? html.call(this, i) : html );
		});
	},

	unwrap: function() {
		return this.parent().each(function() {
			if ( !jQuery.nodeName( this, "body" ) ) {
				jQuery( this ).replaceWith( this.childNodes );
			}
		}).end();
	}
});


jQuery.expr.filters.hidden = function( elem ) {
	// Support: Opera <= 12.12
	// Opera reports offsetWidths and offsetHeights less than zero on some elements
	return elem.offsetWidth <= 0 && elem.offsetHeight <= 0;
};
jQuery.expr.filters.visible = function( elem ) {
	return !jQuery.expr.filters.hidden( elem );
};




var r20 = /%20/g,
	rbracket = /\[\]$/,
	rCRLF = /\r?\n/g,
	rsubmitterTypes = /^(?:submit|button|image|reset|file)$/i,
	rsubmittable = /^(?:input|select|textarea|keygen)/i;

function buildParams( prefix, obj, traditional, add ) {
	var name;

	if ( jQuery.isArray( obj ) ) {
		// Serialize array item.
		jQuery.each( obj, function( i, v ) {
			if ( traditional || rbracket.test( prefix ) ) {
				// Treat each array item as a scalar.
				add( prefix, v );

			} else {
				// Item is non-scalar (array or object), encode its numeric index.
				buildParams( prefix + "[" + ( typeof v === "object" ? i : "" ) + "]", v, traditional, add );
			}
		});

	} else if ( !traditional && jQuery.type( obj ) === "object" ) {
		// Serialize object item.
		for ( name in obj ) {
			buildParams( prefix + "[" + name + "]", obj[ name ], traditional, add );
		}

	} else {
		// Serialize scalar item.
		add( prefix, obj );
	}
}

// Serialize an array of form elements or a set of
// key/values into a query string
jQuery.param = function( a, traditional ) {
	var prefix,
		s = [],
		add = function( key, value ) {
			// If value is a function, invoke it and return its value
			value = jQuery.isFunction( value ) ? value() : ( value == null ? "" : value );
			s[ s.length ] = encodeURIComponent( key ) + "=" + encodeURIComponent( value );
		};

	// Set traditional to true for jQuery <= 1.3.2 behavior.
	if ( traditional === undefined ) {
		traditional = jQuery.ajaxSettings && jQuery.ajaxSettings.traditional;
	}

	// If an array was passed in, assume that it is an array of form elements.
	if ( jQuery.isArray( a ) || ( a.jquery && !jQuery.isPlainObject( a ) ) ) {
		// Serialize the form elements
		jQuery.each( a, function() {
			add( this.name, this.value );
		});

	} else {
		// If traditional, encode the "old" way (the way 1.3.2 or older
		// did it), otherwise encode params recursively.
		for ( prefix in a ) {
			buildParams( prefix, a[ prefix ], traditional, add );
		}
	}

	// Return the resulting serialization
	return s.join( "&" ).replace( r20, "+" );
};

jQuery.fn.extend({
	serialize: function() {
		return jQuery.param( this.serializeArray() );
	},
	serializeArray: function() {
		return this.map(function() {
			// Can add propHook for "elements" to filter or add form elements
			var elements = jQuery.prop( this, "elements" );
			return elements ? jQuery.makeArray( elements ) : this;
		})
		.filter(function() {
			var type = this.type;

			// Use .is( ":disabled" ) so that fieldset[disabled] works
			return this.name && !jQuery( this ).is( ":disabled" ) &&
				rsubmittable.test( this.nodeName ) && !rsubmitterTypes.test( type ) &&
				( this.checked || !rcheckableType.test( type ) );
		})
		.map(function( i, elem ) {
			var val = jQuery( this ).val();

			return val == null ?
				null :
				jQuery.isArray( val ) ?
					jQuery.map( val, function( val ) {
						return { name: elem.name, value: val.replace( rCRLF, "\r\n" ) };
					}) :
					{ name: elem.name, value: val.replace( rCRLF, "\r\n" ) };
		}).get();
	}
});


jQuery.ajaxSettings.xhr = function() {
	try {
		return new XMLHttpRequest();
	} catch( e ) {}
};

var xhrId = 0,
	xhrCallbacks = {},
	xhrSuccessStatus = {
		// file protocol always yields status code 0, assume 200
		0: 200,
		// Support: IE9
		// #1450: sometimes IE returns 1223 when it should be 204
		1223: 204
	},
	xhrSupported = jQuery.ajaxSettings.xhr();

// Support: IE9
// Open requests must be manually aborted on unload (#5280)
// See https://support.microsoft.com/kb/2856746 for more info
if ( window.attachEvent ) {
	window.attachEvent( "onunload", function() {
		for ( var key in xhrCallbacks ) {
			xhrCallbacks[ key ]();
		}
	});
}

support.cors = !!xhrSupported && ( "withCredentials" in xhrSupported );
support.ajax = xhrSupported = !!xhrSupported;

jQuery.ajaxTransport(function( options ) {
	var callback;

	// Cross domain only allowed if supported through XMLHttpRequest
	if ( support.cors || xhrSupported && !options.crossDomain ) {
		return {
			send: function( headers, complete ) {
				var i,
					xhr = options.xhr(),
					id = ++xhrId;

				xhr.open( options.type, options.url, options.async, options.username, options.password );

				// Apply custom fields if provided
				if ( options.xhrFields ) {
					for ( i in options.xhrFields ) {
						xhr[ i ] = options.xhrFields[ i ];
					}
				}

				// Override mime type if needed
				if ( options.mimeType && xhr.overrideMimeType ) {
					xhr.overrideMimeType( options.mimeType );
				}

				// X-Requested-With header
				// For cross-domain requests, seeing as conditions for a preflight are
				// akin to a jigsaw puzzle, we simply never set it to be sure.
				// (it can always be set on a per-request basis or even using ajaxSetup)
				// For same-domain requests, won't change header if already provided.
				if ( !options.crossDomain && !headers["X-Requested-With"] ) {
					headers["X-Requested-With"] = "XMLHttpRequest";
				}

				// Set headers
				for ( i in headers ) {
					xhr.setRequestHeader( i, headers[ i ] );
				}

				// Callback
				callback = function( type ) {
					return function() {
						if ( callback ) {
							delete xhrCallbacks[ id ];
							callback = xhr.onload = xhr.onerror = null;

							if ( type === "abort" ) {
								xhr.abort();
							} else if ( type === "error" ) {
								complete(
									// file: protocol always yields status 0; see #8605, #14207
									xhr.status,
									xhr.statusText
								);
							} else {
								complete(
									xhrSuccessStatus[ xhr.status ] || xhr.status,
									xhr.statusText,
									// Support: IE9
									// Accessing binary-data responseText throws an exception
									// (#11426)
									typeof xhr.responseText === "string" ? {
										text: xhr.responseText
									} : undefined,
									xhr.getAllResponseHeaders()
								);
							}
						}
					};
				};

				// Listen to events
				xhr.onload = callback();
				xhr.onerror = callback("error");

				// Create the abort callback
				callback = xhrCallbacks[ id ] = callback("abort");

				try {
					// Do send the request (this may raise an exception)
					xhr.send( options.hasContent && options.data || null );
				} catch ( e ) {
					// #14683: Only rethrow if this hasn't been notified as an error yet
					if ( callback ) {
						throw e;
					}
				}
			},

			abort: function() {
				if ( callback ) {
					callback();
				}
			}
		};
	}
});




// Install script dataType
jQuery.ajaxSetup({
	accepts: {
		script: "text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"
	},
	contents: {
		script: /(?:java|ecma)script/
	},
	converters: {
		"text script": function( text ) {
			jQuery.globalEval( text );
			return text;
		}
	}
});

// Handle cache's special case and crossDomain
jQuery.ajaxPrefilter( "script", function( s ) {
	if ( s.cache === undefined ) {
		s.cache = false;
	}
	if ( s.crossDomain ) {
		s.type = "GET";
	}
});

// Bind script tag hack transport
jQuery.ajaxTransport( "script", function( s ) {
	// This transport only deals with cross domain requests
	if ( s.crossDomain ) {
		var script, callback;
		return {
			send: function( _, complete ) {
				script = jQuery("<script>").prop({
					async: true,
					charset: s.scriptCharset,
					src: s.url
				}).on(
					"load error",
					callback = function( evt ) {
						script.remove();
						callback = null;
						if ( evt ) {
							complete( evt.type === "error" ? 404 : 200, evt.type );
						}
					}
				);
				document.head.appendChild( script[ 0 ] );
			},
			abort: function() {
				if ( callback ) {
					callback();
				}
			}
		};
	}
});




var oldCallbacks = [],
	rjsonp = /(=)\?(?=&|$)|\?\?/;

// Default jsonp settings
jQuery.ajaxSetup({
	jsonp: "callback",
	jsonpCallback: function() {
		var callback = oldCallbacks.pop() || ( jQuery.expando + "_" + ( nonce++ ) );
		this[ callback ] = true;
		return callback;
	}
});

// Detect, normalize options and install callbacks for jsonp requests
jQuery.ajaxPrefilter( "json jsonp", function( s, originalSettings, jqXHR ) {

	var callbackName, overwritten, responseContainer,
		jsonProp = s.jsonp !== false && ( rjsonp.test( s.url ) ?
			"url" :
			typeof s.data === "string" && !( s.contentType || "" ).indexOf("application/x-www-form-urlencoded") && rjsonp.test( s.data ) && "data"
		);

	// Handle iff the expected data type is "jsonp" or we have a parameter to set
	if ( jsonProp || s.dataTypes[ 0 ] === "jsonp" ) {

		// Get callback name, remembering preexisting value associated with it
		callbackName = s.jsonpCallback = jQuery.isFunction( s.jsonpCallback ) ?
			s.jsonpCallback() :
			s.jsonpCallback;

		// Insert callback into url or form data
		if ( jsonProp ) {
			s[ jsonProp ] = s[ jsonProp ].replace( rjsonp, "$1" + callbackName );
		} else if ( s.jsonp !== false ) {
			s.url += ( rquery.test( s.url ) ? "&" : "?" ) + s.jsonp + "=" + callbackName;
		}

		// Use data converter to retrieve json after script execution
		s.converters["script json"] = function() {
			if ( !responseContainer ) {
				jQuery.error( callbackName + " was not called" );
			}
			return responseContainer[ 0 ];
		};

		// force json dataType
		s.dataTypes[ 0 ] = "json";

		// Install callback
		overwritten = window[ callbackName ];
		window[ callbackName ] = function() {
			responseContainer = arguments;
		};

		// Clean-up function (fires after converters)
		jqXHR.always(function() {
			// Restore preexisting value
			window[ callbackName ] = overwritten;

			// Save back as free
			if ( s[ callbackName ] ) {
				// make sure that re-using the options doesn't screw things around
				s.jsonpCallback = originalSettings.jsonpCallback;

				// save the callback name for future use
				oldCallbacks.push( callbackName );
			}

			// Call if it was a function and we have a response
			if ( responseContainer && jQuery.isFunction( overwritten ) ) {
				overwritten( responseContainer[ 0 ] );
			}

			responseContainer = overwritten = undefined;
		});

		// Delegate to script
		return "script";
	}
});




// data: string of html
// context (optional): If specified, the fragment will be created in this context, defaults to document
// keepScripts (optional): If true, will include scripts passed in the html string
jQuery.parseHTML = function( data, context, keepScripts ) {
	if ( !data || typeof data !== "string" ) {
		return null;
	}
	if ( typeof context === "boolean" ) {
		keepScripts = context;
		context = false;
	}
	context = context || document;

	var parsed = rsingleTag.exec( data ),
		scripts = !keepScripts && [];

	// Single tag
	if ( parsed ) {
		return [ context.createElement( parsed[1] ) ];
	}

	parsed = jQuery.buildFragment( [ data ], context, scripts );

	if ( scripts && scripts.length ) {
		jQuery( scripts ).remove();
	}

	return jQuery.merge( [], parsed.childNodes );
};


// Keep a copy of the old load method
var _load = jQuery.fn.load;

/**
 * Load a url into a page
 */
jQuery.fn.load = function( url, params, callback ) {
	if ( typeof url !== "string" && _load ) {
		return _load.apply( this, arguments );
	}

	var selector, type, response,
		self = this,
		off = url.indexOf(" ");

	if ( off >= 0 ) {
		selector = jQuery.trim( url.slice( off ) );
		url = url.slice( 0, off );
	}

	// If it's a function
	if ( jQuery.isFunction( params ) ) {

		// We assume that it's the callback
		callback = params;
		params = undefined;

	// Otherwise, build a param string
	} else if ( params && typeof params === "object" ) {
		type = "POST";
	}

	// If we have elements to modify, make the request
	if ( self.length > 0 ) {
		jQuery.ajax({
			url: url,

			// if "type" variable is undefined, then "GET" method will be used
			type: type,
			dataType: "html",
			data: params
		}).done(function( responseText ) {

			// Save response for use in complete callback
			response = arguments;

			self.html( selector ?

				// If a selector was specified, locate the right elements in a dummy div
				// Exclude scripts to avoid IE 'Permission Denied' errors
				jQuery("<div>").append( jQuery.parseHTML( responseText ) ).find( selector ) :

				// Otherwise use the full result
				responseText );

		}).complete( callback && function( jqXHR, status ) {
			self.each( callback, response || [ jqXHR.responseText, status, jqXHR ] );
		});
	}

	return this;
};




// Attach a bunch of functions for handling common AJAX events
jQuery.each( [ "ajaxStart", "ajaxStop", "ajaxComplete", "ajaxError", "ajaxSuccess", "ajaxSend" ], function( i, type ) {
	jQuery.fn[ type ] = function( fn ) {
		return this.on( type, fn );
	};
});




jQuery.expr.filters.animated = function( elem ) {
	return jQuery.grep(jQuery.timers, function( fn ) {
		return elem === fn.elem;
	}).length;
};




var docElem = window.document.documentElement;

/**
 * Gets a window from an element
 */
function getWindow( elem ) {
	return jQuery.isWindow( elem ) ? elem : elem.nodeType === 9 && elem.defaultView;
}

jQuery.offset = {
	setOffset: function( elem, options, i ) {
		var curPosition, curLeft, curCSSTop, curTop, curOffset, curCSSLeft, calculatePosition,
			position = jQuery.css( elem, "position" ),
			curElem = jQuery( elem ),
			props = {};

		// Set position first, in-case top/left are set even on static elem
		if ( position === "static" ) {
			elem.style.position = "relative";
		}

		curOffset = curElem.offset();
		curCSSTop = jQuery.css( elem, "top" );
		curCSSLeft = jQuery.css( elem, "left" );
		calculatePosition = ( position === "absolute" || position === "fixed" ) &&
			( curCSSTop + curCSSLeft ).indexOf("auto") > -1;

		// Need to be able to calculate position if either
		// top or left is auto and position is either absolute or fixed
		if ( calculatePosition ) {
			curPosition = curElem.position();
			curTop = curPosition.top;
			curLeft = curPosition.left;

		} else {
			curTop = parseFloat( curCSSTop ) || 0;
			curLeft = parseFloat( curCSSLeft ) || 0;
		}

		if ( jQuery.isFunction( options ) ) {
			options = options.call( elem, i, curOffset );
		}

		if ( options.top != null ) {
			props.top = ( options.top - curOffset.top ) + curTop;
		}
		if ( options.left != null ) {
			props.left = ( options.left - curOffset.left ) + curLeft;
		}

		if ( "using" in options ) {
			options.using.call( elem, props );

		} else {
			curElem.css( props );
		}
	}
};

jQuery.fn.extend({
	offset: function( options ) {
		if ( arguments.length ) {
			return options === undefined ?
				this :
				this.each(function( i ) {
					jQuery.offset.setOffset( this, options, i );
				});
		}

		var docElem, win,
			elem = this[ 0 ],
			box = { top: 0, left: 0 },
			doc = elem && elem.ownerDocument;

		if ( !doc ) {
			return;
		}

		docElem = doc.documentElement;

		// Make sure it's not a disconnected DOM node
		if ( !jQuery.contains( docElem, elem ) ) {
			return box;
		}

		// Support: BlackBerry 5, iOS 3 (original iPhone)
		// If we don't have gBCR, just use 0,0 rather than error
		if ( typeof elem.getBoundingClientRect !== strundefined ) {
			box = elem.getBoundingClientRect();
		}
		win = getWindow( doc );
		return {
			top: box.top + win.pageYOffset - docElem.clientTop,
			left: box.left + win.pageXOffset - docElem.clientLeft
		};
	},

	position: function() {
		if ( !this[ 0 ] ) {
			return;
		}

		var offsetParent, offset,
			elem = this[ 0 ],
			parentOffset = { top: 0, left: 0 };

		// Fixed elements are offset from window (parentOffset = {top:0, left: 0}, because it is its only offset parent
		if ( jQuery.css( elem, "position" ) === "fixed" ) {
			// Assume getBoundingClientRect is there when computed position is fixed
			offset = elem.getBoundingClientRect();

		} else {
			// Get *real* offsetParent
			offsetParent = this.offsetParent();

			// Get correct offsets
			offset = this.offset();
			if ( !jQuery.nodeName( offsetParent[ 0 ], "html" ) ) {
				parentOffset = offsetParent.offset();
			}

			// Add offsetParent borders
			parentOffset.top += jQuery.css( offsetParent[ 0 ], "borderTopWidth", true );
			parentOffset.left += jQuery.css( offsetParent[ 0 ], "borderLeftWidth", true );
		}

		// Subtract parent offsets and element margins
		return {
			top: offset.top - parentOffset.top - jQuery.css( elem, "marginTop", true ),
			left: offset.left - parentOffset.left - jQuery.css( elem, "marginLeft", true )
		};
	},

	offsetParent: function() {
		return this.map(function() {
			var offsetParent = this.offsetParent || docElem;

			while ( offsetParent && ( !jQuery.nodeName( offsetParent, "html" ) && jQuery.css( offsetParent, "position" ) === "static" ) ) {
				offsetParent = offsetParent.offsetParent;
			}

			return offsetParent || docElem;
		});
	}
});

// Create scrollLeft and scrollTop methods
jQuery.each( { scrollLeft: "pageXOffset", scrollTop: "pageYOffset" }, function( method, prop ) {
	var top = "pageYOffset" === prop;

	jQuery.fn[ method ] = function( val ) {
		return access( this, function( elem, method, val ) {
			var win = getWindow( elem );

			if ( val === undefined ) {
				return win ? win[ prop ] : elem[ method ];
			}

			if ( win ) {
				win.scrollTo(
					!top ? val : window.pageXOffset,
					top ? val : window.pageYOffset
				);

			} else {
				elem[ method ] = val;
			}
		}, method, val, arguments.length, null );
	};
});

// Support: Safari<7+, Chrome<37+
// Add the top/left cssHooks using jQuery.fn.position
// Webkit bug: https://bugs.webkit.org/show_bug.cgi?id=29084
// Blink bug: https://code.google.com/p/chromium/issues/detail?id=229280
// getComputedStyle returns percent when specified for top/left/bottom/right;
// rather than make the css module depend on the offset module, just check for it here
jQuery.each( [ "top", "left" ], function( i, prop ) {
	jQuery.cssHooks[ prop ] = addGetHookIf( support.pixelPosition,
		function( elem, computed ) {
			if ( computed ) {
				computed = curCSS( elem, prop );
				// If curCSS returns percentage, fallback to offset
				return rnumnonpx.test( computed ) ?
					jQuery( elem ).position()[ prop ] + "px" :
					computed;
			}
		}
	);
});


// Create innerHeight, innerWidth, height, width, outerHeight and outerWidth methods
jQuery.each( { Height: "height", Width: "width" }, function( name, type ) {
	jQuery.each( { padding: "inner" + name, content: type, "": "outer" + name }, function( defaultExtra, funcName ) {
		// Margin is only for outerHeight, outerWidth
		jQuery.fn[ funcName ] = function( margin, value ) {
			var chainable = arguments.length && ( defaultExtra || typeof margin !== "boolean" ),
				extra = defaultExtra || ( margin === true || value === true ? "margin" : "border" );

			return access( this, function( elem, type, value ) {
				var doc;

				if ( jQuery.isWindow( elem ) ) {
					// As of 5/8/2012 this will yield incorrect results for Mobile Safari, but there
					// isn't a whole lot we can do. See pull request at this URL for discussion:
					// https://github.com/jquery/jquery/pull/764
					return elem.document.documentElement[ "client" + name ];
				}

				// Get document width or height
				if ( elem.nodeType === 9 ) {
					doc = elem.documentElement;

					// Either scroll[Width/Height] or offset[Width/Height] or client[Width/Height],
					// whichever is greatest
					return Math.max(
						elem.body[ "scroll" + name ], doc[ "scroll" + name ],
						elem.body[ "offset" + name ], doc[ "offset" + name ],
						doc[ "client" + name ]
					);
				}

				return value === undefined ?
					// Get width or height on the element, requesting but not forcing parseFloat
					jQuery.css( elem, type, extra ) :

					// Set width or height on the element
					jQuery.style( elem, type, value, extra );
			}, type, chainable ? margin : undefined, chainable, null );
		};
	});
});


// The number of elements contained in the matched element set
jQuery.fn.size = function() {
	return this.length;
};

jQuery.fn.andSelf = jQuery.fn.addBack;




// Register as a named AMD module, since jQuery can be concatenated with other
// files that may use define, but not via a proper concatenation script that
// understands anonymous AMD modules. A named AMD is safest and most robust
// way to register. Lowercase jquery is used because AMD module names are
// derived from file names, and jQuery is normally delivered in a lowercase
// file name. Do this after creating the global so that if an AMD module wants
// to call noConflict to hide this version of jQuery, it will work.

// Note that for maximum portability, libraries that are not jQuery should
// declare themselves as anonymous modules, and avoid setting a global if an
// AMD loader is present. jQuery is a special case. For more information, see
// https://github.com/jrburke/requirejs/wiki/Updating-existing-libraries#wiki-anon

if ( typeof define === "function" && define.amd ) {
	define( "jquery", [], function() {
		return jQuery;
	});
}




var
	// Map over jQuery in case of overwrite
	_jQuery = window.jQuery,

	// Map over the $ in case of overwrite
	_$ = window.$;

jQuery.noConflict = function( deep ) {
	if ( window.$ === jQuery ) {
		window.$ = _$;
	}

	if ( deep && window.jQuery === jQuery ) {
		window.jQuery = _jQuery;
	}

	return jQuery;
};

// Expose jQuery and $ identifiers, even in AMD
// (#7102#comment:10, https://github.com/jquery/jquery/pull/557)
// and CommonJS for browser emulators (#13566)
if ( typeof noGlobal === strundefined ) {
	window.jQuery = window.$ = jQuery;
}




return jQuery;

}));

},{}],2:[function(require,module,exports){
// http://stackoverflow.com/questions/839899/how-do-i-calculate-a-point-on-a-circles-circumference
// radians = degrees * (pi/180)
// https://github.com/bjornharrtell/jsts/blob/master/examples/buffer.html

var featurecollection = require('turf-featurecollection');
var jsts = require('jsts');
var normalize = require('geojson-normalize');

/**
* Calculates a buffer for input features for a given radius. Units supported are miles, kilometers, and degrees.
*
* @module turf/buffer
* @category transformation
* @param {(Feature|FeatureCollection)} feature input to be buffered
* @param {Number} distance distance to draw the buffer
* @param {String} unit 'miles', 'feet', 'kilometers', 'meters', or 'degrees'
* @return {FeatureCollection<Polygon>|FeatureCollection<MultiPolygon>|Polygon|MultiPolygon} buffered features
*
* @example
* var pt = {
*   "type": "Feature",
*   "properties": {},
*   "geometry": {
*     "type": "Point",
*     "coordinates": [-90.548630, 14.616599]
*   }
* };
* var unit = 'miles';
*
* var buffered = turf.buffer(pt, 500, unit);
* var result = turf.featurecollection([buffered, pt]);
*
* //=result
*/

module.exports = function(feature, radius, units) {

  switch (units) {
    case 'miles':
      radius = radius / 69.047;
    break;
    case 'feet':
      radius = radius / 364568.0;
    break;
    case 'kilometers':
      radius = radius / 111.12;
    break;
    case 'meters':
      radius = radius / 111120.0;
    break;
    case 'degrees':
    break;
  }

  var fc = normalize(feature);
  var buffered = normalize(featurecollection(fc.features.map(function(f) {
    return bufferOp(f, radius);
  })));

  if(buffered.features.length > 1) return buffered;
  else if(buffered.features.length === 1) return buffered.features[0];
};

var bufferOp = function(feature, radius) {
  var reader = new jsts.io.GeoJSONReader();
  var geom = reader.read(JSON.stringify(feature.geometry));
  var buffered = geom.buffer(radius);
  var parser = new jsts.io.GeoJSONParser();
  buffered = parser.write(buffered);

  return {
    type: 'Feature',
    geometry: buffered,
    properties: {}
  };
};

},{"geojson-normalize":3,"jsts":4,"turf-featurecollection":8}],3:[function(require,module,exports){
module.exports = normalize;

var types = {
    Point: 'geometry',
    MultiPoint: 'geometry',
    LineString: 'geometry',
    MultiLineString: 'geometry',
    Polygon: 'geometry',
    MultiPolygon: 'geometry',
    GeometryCollection: 'geometry',
    Feature: 'feature',
    FeatureCollection: 'featurecollection'
};

/**
 * Normalize a GeoJSON feature into a FeatureCollection.
 *
 * @param {object} gj geojson data
 * @returns {object} normalized geojson data
 */
function normalize(gj) {
    if (!gj || !gj.type) return null;
    var type = types[gj.type];
    if (!type) return null;

    if (type === 'geometry') {
        return {
            type: 'FeatureCollection',
            features: [{
                type: 'Feature',
                properties: {},
                geometry: gj
            }]
        };
    } else if (type === 'feature') {
        return {
            type: 'FeatureCollection',
            features: [gj]
        };
    } else if (type === 'featurecollection') {
        return gj;
    }
}

},{}],4:[function(require,module,exports){
require('javascript.util');
var jsts = require('./lib/jsts');
module.exports = jsts

},{"./lib/jsts":5,"javascript.util":7}],5:[function(require,module,exports){
/* The JSTS Topology Suite is a collection of JavaScript classes that
implement the fundamental operations required to validate a given
geo-spatial data set to a known topological specification.

Copyright (C) 2011 The Authors

This library is free software; you can redistribute it and/or
modify it under the terms of the GNU Lesser General Public
License as published by the Free Software Foundation; either
version 2.1 of the License, or (at your option) any later version.

This library is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
Lesser General Public License for more details.

You should have received a copy of the GNU Lesser General Public
License along with this library; if not, write to the Free Software
Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA */
jsts={version:'0.15.0',algorithm:{distance:{},locate:{}},error:{},geom:{util:{}},geomgraph:{index:{}},index:{bintree:{},chain:{},kdtree:{},quadtree:{},strtree:{}},io:{},noding:{snapround:{}},operation:{buffer:{},distance:{},overlay:{snap:{}},polygonize:{},predicate:{},relate:{},union:{},valid:{}},planargraph:{},simplify:{},triangulate:{quadedge:{}},util:{}};if(typeof String.prototype.trim!=='function'){String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,'');};}
jsts.abstractFunc=function(){throw new jsts.error.AbstractMethodInvocationError();};jsts.error={};jsts.error.IllegalArgumentError=function(message){this.name='IllegalArgumentError';this.message=message;};jsts.error.IllegalArgumentError.prototype=new Error();jsts.error.TopologyError=function(message,pt){this.name='TopologyError';this.message=pt?message+' [ '+pt+' ]':message;};jsts.error.TopologyError.prototype=new Error();jsts.error.AbstractMethodInvocationError=function(){this.name='AbstractMethodInvocationError';this.message='Abstract method called, should be implemented in subclass.';};jsts.error.AbstractMethodInvocationError.prototype=new Error();jsts.error.NotImplementedError=function(){this.name='NotImplementedError';this.message='This method has not yet been implemented.';};jsts.error.NotImplementedError.prototype=new Error();jsts.error.NotRepresentableError=function(message){this.name='NotRepresentableError';this.message=message;};jsts.error.NotRepresentableError.prototype=new Error();jsts.error.LocateFailureError=function(message){this.name='LocateFailureError';this.message=message;};jsts.error.LocateFailureError.prototype=new Error();if(typeof module!=="undefined")module.exports=jsts;jsts.geom.GeometryFilter=function(){};jsts.geom.GeometryFilter.prototype.filter=function(geom){throw new jsts.error.AbstractMethodInvocationError();};jsts.geom.util.PolygonExtracter=function(comps){this.comps=comps;};jsts.geom.util.PolygonExtracter.prototype=new jsts.geom.GeometryFilter();jsts.geom.util.PolygonExtracter.prototype.comps=null;jsts.geom.util.PolygonExtracter.getPolygons=function(geom,list){if(list===undefined){list=[];}
if(geom instanceof jsts.geom.Polygon){list.push(geom);}else if(geom instanceof jsts.geom.GeometryCollection){geom.apply(new jsts.geom.util.PolygonExtracter(list));}
return list;};jsts.geom.util.PolygonExtracter.prototype.filter=function(geom){if(geom instanceof jsts.geom.Polygon)
this.comps.push(geom);};jsts.io.WKTParser=function(geometryFactory){this.geometryFactory=geometryFactory||new jsts.geom.GeometryFactory();this.regExes={'typeStr':/^\s*(\w+)\s*\(\s*(.*)\s*\)\s*$/,'emptyTypeStr':/^\s*(\w+)\s*EMPTY\s*$/,'spaces':/\s+/,'parenComma':/\)\s*,\s*\(/,'doubleParenComma':/\)\s*\)\s*,\s*\(\s*\(/,'trimParens':/^\s*\(?(.*?)\)?\s*$/};};jsts.io.WKTParser.prototype.read=function(wkt){var geometry,type,str;wkt=wkt.replace(/[\n\r]/g,' ');var matches=this.regExes.typeStr.exec(wkt);if(wkt.search('EMPTY')!==-1){matches=this.regExes.emptyTypeStr.exec(wkt);matches[2]=undefined;}
if(matches){type=matches[1].toLowerCase();str=matches[2];if(this.parse[type]){geometry=this.parse[type].apply(this,[str]);}}
if(geometry===undefined)
throw new Error('Could not parse WKT '+wkt);return geometry;};jsts.io.WKTParser.prototype.write=function(geometry){return this.extractGeometry(geometry);};jsts.io.WKTParser.prototype.extractGeometry=function(geometry){var type=geometry.CLASS_NAME.split('.')[2].toLowerCase();if(!this.extract[type]){return null;}
var wktType=type.toUpperCase();var data;if(geometry.isEmpty()){data=wktType+' EMPTY';}else{data=wktType+'('+this.extract[type].apply(this,[geometry])+')';}
return data;};jsts.io.WKTParser.prototype.extract={'coordinate':function(coordinate){return coordinate.x+' '+coordinate.y;},'point':function(point){return point.coordinate.x+' '+point.coordinate.y;},'multipoint':function(multipoint){var array=[];for(var i=0,len=multipoint.geometries.length;i<len;++i){array.push('('+
this.extract.point.apply(this,[multipoint.geometries[i]])+')');}
return array.join(',');},'linestring':function(linestring){var array=[];for(var i=0,len=linestring.points.length;i<len;++i){array.push(this.extract.coordinate.apply(this,[linestring.points[i]]));}
return array.join(',');},'multilinestring':function(multilinestring){var array=[];for(var i=0,len=multilinestring.geometries.length;i<len;++i){array.push('('+
this.extract.linestring.apply(this,[multilinestring.geometries[i]])+')');}
return array.join(',');},'polygon':function(polygon){var array=[];array.push('('+this.extract.linestring.apply(this,[polygon.shell])+')');for(var i=0,len=polygon.holes.length;i<len;++i){array.push('('+this.extract.linestring.apply(this,[polygon.holes[i]])+')');}
return array.join(',');},'multipolygon':function(multipolygon){var array=[];for(var i=0,len=multipolygon.geometries.length;i<len;++i){array.push('('+this.extract.polygon.apply(this,[multipolygon.geometries[i]])+')');}
return array.join(',');},'geometrycollection':function(collection){var array=[];for(var i=0,len=collection.geometries.length;i<len;++i){array.push(this.extractGeometry.apply(this,[collection.geometries[i]]));}
return array.join(',');}};jsts.io.WKTParser.prototype.parse={'point':function(str){if(str===undefined){return this.geometryFactory.createPoint(null);}
var coords=str.trim().split(this.regExes.spaces);return this.geometryFactory.createPoint(new jsts.geom.Coordinate(coords[0],coords[1]));},'multipoint':function(str){if(str===undefined){return this.geometryFactory.createMultiPoint(null);}
var point;var points=str.trim().split(',');var components=[];for(var i=0,len=points.length;i<len;++i){point=points[i].replace(this.regExes.trimParens,'$1');components.push(this.parse.point.apply(this,[point]));}
return this.geometryFactory.createMultiPoint(components);},'linestring':function(str){if(str===undefined){return this.geometryFactory.createLineString(null);}
var points=str.trim().split(',');var components=[];var coords;for(var i=0,len=points.length;i<len;++i){coords=points[i].trim().split(this.regExes.spaces);components.push(new jsts.geom.Coordinate(coords[0],coords[1]));}
return this.geometryFactory.createLineString(components);},'linearring':function(str){if(str===undefined){return this.geometryFactory.createLinearRing(null);}
var points=str.trim().split(',');var components=[];var coords;for(var i=0,len=points.length;i<len;++i){coords=points[i].trim().split(this.regExes.spaces);components.push(new jsts.geom.Coordinate(coords[0],coords[1]));}
return this.geometryFactory.createLinearRing(components);},'multilinestring':function(str){if(str===undefined){return this.geometryFactory.createMultiLineString(null);}
var line;var lines=str.trim().split(this.regExes.parenComma);var components=[];for(var i=0,len=lines.length;i<len;++i){line=lines[i].replace(this.regExes.trimParens,'$1');components.push(this.parse.linestring.apply(this,[line]));}
return this.geometryFactory.createMultiLineString(components);},'polygon':function(str){if(str===undefined){return this.geometryFactory.createPolygon(null);}
var ring,linestring,linearring;var rings=str.trim().split(this.regExes.parenComma);var shell;var holes=[];for(var i=0,len=rings.length;i<len;++i){ring=rings[i].replace(this.regExes.trimParens,'$1');linestring=this.parse.linestring.apply(this,[ring]);linearring=this.geometryFactory.createLinearRing(linestring.points);if(i===0){shell=linearring;}else{holes.push(linearring);}}
return this.geometryFactory.createPolygon(shell,holes);},'multipolygon':function(str){if(str===undefined){return this.geometryFactory.createMultiPolygon(null);}
var polygon;var polygons=str.trim().split(this.regExes.doubleParenComma);var components=[];for(var i=0,len=polygons.length;i<len;++i){polygon=polygons[i].replace(this.regExes.trimParens,'$1');components.push(this.parse.polygon.apply(this,[polygon]));}
return this.geometryFactory.createMultiPolygon(components);},'geometrycollection':function(str){if(str===undefined){return this.geometryFactory.createGeometryCollection(null);}
str=str.replace(/,\s*([A-Za-z])/g,'|$1');var wktArray=str.trim().split('|');var components=[];for(var i=0,len=wktArray.length;i<len;++i){components.push(jsts.io.WKTParser.prototype.read.apply(this,[wktArray[i]]));}
return this.geometryFactory.createGeometryCollection(components);}};jsts.index.ItemVisitor=function(){};jsts.index.ItemVisitor.prototype.visitItem=function(){throw new jsts.error.AbstractMethodInvocationError();};jsts.algorithm.CGAlgorithms=function(){};jsts.algorithm.CGAlgorithms.CLOCKWISE=-1;jsts.algorithm.CGAlgorithms.RIGHT=jsts.algorithm.CGAlgorithms.CLOCKWISE;jsts.algorithm.CGAlgorithms.COUNTERCLOCKWISE=1;jsts.algorithm.CGAlgorithms.LEFT=jsts.algorithm.CGAlgorithms.COUNTERCLOCKWISE;jsts.algorithm.CGAlgorithms.COLLINEAR=0;jsts.algorithm.CGAlgorithms.STRAIGHT=jsts.algorithm.CGAlgorithms.COLLINEAR;jsts.algorithm.CGAlgorithms.orientationIndex=function(p1,p2,q){var dx1,dy1,dx2,dy2;dx1=p2.x-p1.x;dy1=p2.y-p1.y;dx2=q.x-p2.x;dy2=q.y-p2.y;return jsts.algorithm.RobustDeterminant.signOfDet2x2(dx1,dy1,dx2,dy2);};jsts.algorithm.CGAlgorithms.isPointInRing=function(p,ring){return jsts.algorithm.CGAlgorithms.locatePointInRing(p,ring)!==jsts.geom.Location.EXTERIOR;};jsts.algorithm.CGAlgorithms.locatePointInRing=function(p,ring){return jsts.algorithm.RayCrossingCounter.locatePointInRing(p,ring);};jsts.algorithm.CGAlgorithms.isOnLine=function(p,pt){var lineIntersector,i,il,p0,p1;lineIntersector=new jsts.algorithm.RobustLineIntersector();for(i=1,il=pt.length;i<il;i++){p0=pt[i-1];p1=pt[i];lineIntersector.computeIntersection(p,p0,p1);if(lineIntersector.hasIntersection()){return true;}}
return false;};jsts.algorithm.CGAlgorithms.isCCW=function(ring){var nPts,hiPt,hiIndex,p,iPrev,iNext,prev,next,i,disc,isCCW;nPts=ring.length-1;if(nPts<3){throw new jsts.IllegalArgumentError('Ring has fewer than 3 points, so orientation cannot be determined');}
hiPt=ring[0];hiIndex=0;i=1;for(i;i<=nPts;i++){p=ring[i];if(p.y>hiPt.y){hiPt=p;hiIndex=i;}}
iPrev=hiIndex;do{iPrev=iPrev-1;if(iPrev<0){iPrev=nPts;}}while(ring[iPrev].equals2D(hiPt)&&iPrev!==hiIndex);iNext=hiIndex;do{iNext=(iNext+1)%nPts;}while(ring[iNext].equals2D(hiPt)&&iNext!==hiIndex);prev=ring[iPrev];next=ring[iNext];if(prev.equals2D(hiPt)||next.equals2D(hiPt)||prev.equals2D(next)){return false;}
disc=jsts.algorithm.CGAlgorithms.computeOrientation(prev,hiPt,next);isCCW=false;if(disc===0){isCCW=(prev.x>next.x);}else{isCCW=(disc>0);}
return isCCW;};jsts.algorithm.CGAlgorithms.computeOrientation=function(p1,p2,q){return jsts.algorithm.CGAlgorithms.orientationIndex(p1,p2,q);};jsts.algorithm.CGAlgorithms.distancePointLine=function(p,A,B){if(!(A instanceof jsts.geom.Coordinate)){jsts.algorithm.CGAlgorithms.distancePointLine2.apply(this,arguments);}
if(A.x===B.x&&A.y===B.y){return p.distance(A);}
var r,s;r=((p.x-A.x)*(B.x-A.x)+(p.y-A.y)*(B.y-A.y))/((B.x-A.x)*(B.x-A.x)+(B.y-A.y)*(B.y-A.y));if(r<=0.0){return p.distance(A);}
if(r>=1.0){return p.distance(B);}
s=((A.y-p.y)*(B.x-A.x)-(A.x-p.x)*(B.y-A.y))/((B.x-A.x)*(B.x-A.x)+(B.y-A.y)*(B.y-A.y));return Math.abs(s)*Math.sqrt(((B.x-A.x)*(B.x-A.x)+(B.y-A.y)*(B.y-A.y)));};jsts.algorithm.CGAlgorithms.distancePointLinePerpendicular=function(p,A,B){var s=((A.y-p.y)*(B.x-A.x)-(A.x-p.x)*(B.y-A.y))/((B.x-A.x)*(B.x-A.x)+(B.y-A.y)*(B.y-A.y));return Math.abs(s)*Math.sqrt(((B.x-A.x)*(B.x-A.x)+(B.y-A.y)*(B.y-A.y)));};jsts.algorithm.CGAlgorithms.distancePointLine2=function(p,line){var minDistance,i,il,dist;if(line.length===0){throw new jsts.error.IllegalArgumentError('Line array must contain at least one vertex');}
minDistance=p.distance(line[0]);for(i=0,il=line.length-1;i<il;i++){dist=jsts.algorithm.CGAlgorithms.distancePointLine(p,line[i],line[i+1]);if(dist<minDistance){minDistance=dist;}}
return minDistance;};jsts.algorithm.CGAlgorithms.distanceLineLine=function(A,B,C,D){if(A.equals(B)){return jsts.algorithm.CGAlgorithms.distancePointLine(A,C,D);}
if(C.equals(D)){return jsts.algorithm.CGAlgorithms.distancePointLine(D,A,B);}
var r_top,r_bot,s_top,s_bot,s,r;r_top=(A.y-C.y)*(D.x-C.x)-(A.x-C.x)*(D.y-C.y);r_bot=(B.x-A.x)*(D.y-C.y)-(B.y-A.y)*(D.x-C.x);s_top=(A.y-C.y)*(B.x-A.x)-(A.x-C.x)*(B.y-A.y);s_bot=(B.x-A.x)*(D.y-C.y)-(B.y-A.y)*(D.x-C.x);if((r_bot===0)||(s_bot===0)){return Math.min(jsts.algorithm.CGAlgorithms.distancePointLine(A,C,D),Math.min(jsts.algorithm.CGAlgorithms.distancePointLine(B,C,D),Math.min(jsts.algorithm.CGAlgorithms.distancePointLine(C,A,B),jsts.algorithm.CGAlgorithms.distancePointLine(D,A,B))));}
s=s_top/s_bot;r=r_top/r_bot;if((r<0)||(r>1)||(s<0)||(s>1)){return Math.min(jsts.algorithm.CGAlgorithms.distancePointLine(A,C,D),Math.min(jsts.algorithm.CGAlgorithms.distancePointLine(B,C,D),Math.min(jsts.algorithm.CGAlgorithms.distancePointLine(C,A,B),jsts.algorithm.CGAlgorithms.distancePointLine(D,A,B))));}
return 0.0;};jsts.algorithm.CGAlgorithms.signedArea=function(ring){if(ring.length<3){return 0.0;}
var sum,i,il,bx,by,cx,cy;sum=0.0;for(i=0,il=ring.length-1;i<il;i++){bx=ring[i].x;by=ring[i].y;cx=ring[i+1].x;cy=ring[i+1].y;sum+=(bx+cx)*(cy-by);}
return-sum/2.0;};jsts.algorithm.CGAlgorithms.signedArea=function(ring){var n,sum,p,bx,by,i,cx,cy;n=ring.length;if(n<3){return 0.0;}
sum=0.0;p=ring[0];bx=p.x;by=p.y;for(i=1;i<n;i++){p=ring[i];cx=p.x;cy=p.y;sum+=(bx+cx)*(cy-by);bx=cx;by=cy;}
return-sum/2.0;};jsts.algorithm.CGAlgorithms.computeLength=function(pts){var n=pts.length,len,x0,y0,x1,y1,dx,dy,p,i,il;if(n<=1){return 0.0;}
len=0.0;p=pts[0];x0=p.x;y0=p.y;i=1,il=n;for(i;i<n;i++){p=pts[i];x1=p.x;y1=p.y;dx=x1-x0;dy=y1-y0;len+=Math.sqrt(dx*dx+dy*dy);x0=x1;y0=y1;}
return len;};jsts.algorithm.CGAlgorithms.length=function(){};jsts.algorithm.Angle=function(){};jsts.algorithm.Angle.PI_TIMES_2=2.0*Math.PI;jsts.algorithm.Angle.PI_OVER_2=Math.PI/2.0;jsts.algorithm.Angle.PI_OVER_4=Math.PI/4.0;jsts.algorithm.Angle.COUNTERCLOCKWISE=jsts.algorithm.CGAlgorithms.COUNTERCLOCKWISE;jsts.algorithm.Angle.CLOCKWISE=jsts.algorithm.CGAlgorithms.CLOCKWISE;jsts.algorithm.Angle.NONE=jsts.algorithm.CGAlgorithms.COLLINEAR;jsts.algorithm.Angle.toDegrees=function(radians){return(radians*180)/Math.PI;};jsts.algorithm.Angle.toRadians=function(angleDegrees){return(angleDegrees*Math.PI)/180.0;};jsts.algorithm.Angle.angle=function(){if(arguments.length===1){return jsts.algorithm.Angle.angleFromOrigo(arguments[0]);}else{return jsts.algorithm.Angle.angleBetweenCoords(arguments[0],arguments[1]);}};jsts.algorithm.Angle.angleBetweenCoords=function(p0,p1){var dx,dy;dx=p1.x-p0.x;dy=p1.y-p0.y;return Math.atan2(dy,dx);};jsts.algorithm.Angle.angleFromOrigo=function(p){return Math.atan2(p.y,p.x);};jsts.algorithm.Angle.isAcute=function(p0,p1,p2){var dx0,dy0,dx1,dy1,dotprod;dx0=p0.x-p1.x;dy0=p0.y-p1.y;dx1=p2.x-p1.x;dy1=p2.y-p1.y;dotprod=dx0*dx1+dy0*dy1;return dotprod>0;};jsts.algorithm.Angle.isObtuse=function(p0,p1,p2){var dx0,dy0,dx1,dy1,dotprod;dx0=p0.x-p1.x;dy0=p0.y-p1.y;dx1=p2.x-p1.x;dy1=p2.y-p1.y;dotprod=dx0*dx1+dy0*dy1;return dotprod<0;};jsts.algorithm.Angle.angleBetween=function(tip1,tail,tip2){var a1,a2;a1=jsts.algorithm.Angle.angle(tail,tip1);a2=jsts.algorithm.Angle.angle(tail,tip2);return jsts.algorithm.Angle.diff(a1,a2);};jsts.algorithm.Angle.angleBetweenOriented=function(tip1,tail,tip2){var a1,a2,angDel;a1=jsts.algorithm.Angle.angle(tail,tip1);a2=jsts.algorithm.Angle.angle(tail,tip2);angDel=a2-a1;if(angDel<=-Math.PI){return angDel+jsts.algorithm.Angle.PI_TIMES_2;}
if(angDel>Math.PI){return angDel-jsts.algorithm.Angle.PI_TIMES_2;}
return angDel;};jsts.algorithm.Angle.interiorAngle=function(p0,p1,p2){var anglePrev,angleNext;anglePrev=jsts.algorithm.Angle.angle(p1,p0);angleNext=jsts.algorithm.Angle.angle(p1,p2);return Math.abs(angleNext-anglePrev);};jsts.algorithm.Angle.getTurn=function(ang1,ang2){var crossproduct=Math.sin(ang2-ang1);if(crossproduct>0){return jsts.algorithm.Angle.COUNTERCLOCKWISE;}
if(crossproduct<0){return jsts.algorithm.Angle.CLOCKWISE;}
return jsts.algorithm.Angle.NONE;};jsts.algorithm.Angle.normalize=function(angle){while(angle>Math.PI){angle-=jsts.algorithm.Angle.PI_TIMES_2;}
while(angle<=-Math.PI){angle+=jsts.algorithm.Angle.PI_TIMES_2;}
return angle;};jsts.algorithm.Angle.normalizePositive=function(angle){if(angle<0.0){while(angle<0.0){angle+=jsts.algorithm.Angle.PI_TIMES_2;}
if(angle>=jsts.algorithm.Angle.PI_TIMES_2){angle=0.0;}}
else{while(angle>=jsts.algorithm.Angle.PI_TIMES_2){angle-=jsts.algorithm.Angle.PI_TIMES_2;}
if(angle<0.0){angle=0.0;}}
return angle;};jsts.algorithm.Angle.diff=function(ang1,ang2){var delAngle;if(ang1<ang2){delAngle=ang2-ang1;}else{delAngle=ang1-ang2;}
if(delAngle>Math.PI){delAngle=(2*Math.PI)-delAngle;}
return delAngle;};jsts.geom.GeometryComponentFilter=function(){};jsts.geom.GeometryComponentFilter.prototype.filter=function(geom){throw new jsts.error.AbstractMethodInvocationError();};jsts.geom.util.LinearComponentExtracter=function(lines,isForcedToLineString){this.lines=lines;this.isForcedToLineString=isForcedToLineString;};jsts.geom.util.LinearComponentExtracter.prototype=new jsts.geom.GeometryComponentFilter();jsts.geom.util.LinearComponentExtracter.prototype.lines=null;jsts.geom.util.LinearComponentExtracter.prototype.isForcedToLineString=false;jsts.geom.util.LinearComponentExtracter.getLines=function(geoms,lines){if(arguments.length==1){return jsts.geom.util.LinearComponentExtracter.getLines5.apply(this,arguments);}
else if(arguments.length==2&&typeof lines==='boolean'){return jsts.geom.util.LinearComponentExtracter.getLines6.apply(this,arguments);}
else if(arguments.length==2&&geoms instanceof jsts.geom.Geometry){return jsts.geom.util.LinearComponentExtracter.getLines3.apply(this,arguments);}
else if(arguments.length==3&&geoms instanceof jsts.geom.Geometry){return jsts.geom.util.LinearComponentExtracter.getLines4.apply(this,arguments);}
else if(arguments.length==3){return jsts.geom.util.LinearComponentExtracter.getLines2.apply(this,arguments);}
for(var i=0;i<geoms.length;i++){var g=geoms[i];jsts.geom.util.LinearComponentExtracter.getLines3(g,lines);}
return lines;};jsts.geom.util.LinearComponentExtracter.getLines2=function(geoms,lines,forceToLineString){for(var i=0;i<geoms.length;i++){var g=geoms[i];jsts.geom.util.LinearComponentExtracter.getLines4(g,lines,forceToLineString);}
return lines;};jsts.geom.util.LinearComponentExtracter.getLines3=function(geom,lines){if(geom instanceof LineString){lines.add(geom);}else{geom.apply(new jsts.geom.util.LinearComponentExtracter(lines));}
return lines;};jsts.geom.util.LinearComponentExtracter.getLines4=function(geom,lines,forceToLineString){geom.apply(new jsts.geom.util.LinearComponentExtracter(lines,forceToLineString));return lines;};jsts.geom.util.LinearComponentExtracter.getLines5=function(geom){return jsts.geom.util.LinearComponentExtracter.getLines6(geom,false);};jsts.geom.util.LinearComponentExtracter.getLines6=function(geom,forceToLineString){var lines=[];geom.apply(new jsts.geom.util.LinearComponentExtracter(lines,forceToLineString));return lines;};jsts.geom.util.LinearComponentExtracter.prototype.setForceToLineString=function(isForcedToLineString){this.isForcedToLineString=isForcedToLineString;};jsts.geom.util.LinearComponentExtracter.prototype.filter=function(geom){if(this.isForcedToLineString&&geom instanceof jsts.geom.LinearRing){var line=geom.getFactory().createLineString(geom.getCoordinateSequence());this.lines.push(line);return;}
if(geom instanceof jsts.geom.LineString||geom instanceof jsts.geom.LinearRing)
this.lines.push(geom);};jsts.geom.Location=function(){};jsts.geom.Location.INTERIOR=0;jsts.geom.Location.BOUNDARY=1;jsts.geom.Location.EXTERIOR=2;jsts.geom.Location.NONE=-1;jsts.geom.Location.toLocationSymbol=function(locationValue){switch(locationValue){case jsts.geom.Location.EXTERIOR:return'e';case jsts.geom.Location.BOUNDARY:return'b';case jsts.geom.Location.INTERIOR:return'i';case jsts.geom.Location.NONE:return'-';}
throw new jsts.IllegalArgumentError('Unknown location value: '+
locationValue);};(function(){jsts.io.GeoJSONReader=function(geometryFactory){this.geometryFactory=geometryFactory||new jsts.geom.GeometryFactory();this.precisionModel=this.geometryFactory.getPrecisionModel();this.parser=new jsts.io.GeoJSONParser(this.geometryFactory);};jsts.io.GeoJSONReader.prototype.read=function(geoJson){var geometry=this.parser.read(geoJson);if(this.precisionModel.getType()===jsts.geom.PrecisionModel.FIXED){this.reducePrecision(geometry);}
return geometry;};jsts.io.GeoJSONReader.prototype.reducePrecision=function(geometry){var i,len;if(geometry.coordinate){this.precisionModel.makePrecise(geometry.coordinate);}else if(geometry.points){for(i=0,len=geometry.points.length;i<len;i++){this.precisionModel.makePrecise(geometry.points[i]);}}else if(geometry.geometries){for(i=0,len=geometry.geometries.length;i<len;i++){this.reducePrecision(geometry.geometries[i]);}}};})();jsts.geom.Geometry=function(factory){this.factory=factory;};jsts.geom.Geometry.prototype.envelope=null;jsts.geom.Geometry.prototype.factory=null;jsts.geom.Geometry.prototype.getGeometryType=function(){return'Geometry';};jsts.geom.Geometry.hasNonEmptyElements=function(geometries){var i;for(i=0;i<geometries.length;i++){if(!geometries[i].isEmpty()){return true;}}
return false;};jsts.geom.Geometry.hasNullElements=function(array){var i;for(i=0;i<array.length;i++){if(array[i]===null){return true;}}
return false;};jsts.geom.Geometry.prototype.getFactory=function(){if(this.factory===null||this.factory===undefined){this.factory=new jsts.geom.GeometryFactory();}
return this.factory;};jsts.geom.Geometry.prototype.getNumGeometries=function(){return 1;};jsts.geom.Geometry.prototype.getGeometryN=function(n){return this;};jsts.geom.Geometry.prototype.getPrecisionModel=function(){return this.getFactory().getPrecisionModel();};jsts.geom.Geometry.prototype.getCoordinate=function(){throw new jsts.error.AbstractMethodInvocationError();};jsts.geom.Geometry.prototype.getCoordinates=function(){throw new jsts.error.AbstractMethodInvocationError();};jsts.geom.Geometry.prototype.getNumPoints=function(){throw new jsts.error.AbstractMethodInvocationError();};jsts.geom.Geometry.prototype.isSimple=function(){this.checkNotGeometryCollection(this);var op=new jsts.operation.IsSimpleOp(this);return op.isSimple();};jsts.geom.Geometry.prototype.isValid=function(){var isValidOp=new jsts.operation.valid.IsValidOp(this);return isValidOp.isValid();};jsts.geom.Geometry.prototype.isEmpty=function(){throw new jsts.error.AbstractMethodInvocationError();};jsts.geom.Geometry.prototype.distance=function(g){return jsts.operation.distance.DistanceOp.distance(this,g);};jsts.geom.Geometry.prototype.isWithinDistance=function(geom,distance){var envDist=this.getEnvelopeInternal().distance(geom.getEnvelopeInternal());if(envDist>distance){return false;}
return DistanceOp.isWithinDistance(this,geom,distance);};jsts.geom.Geometry.prototype.isRectangle=function(){return false;};jsts.geom.Geometry.prototype.getArea=function(){return 0.0;};jsts.geom.Geometry.prototype.getLength=function(){return 0.0;};jsts.geom.Geometry.prototype.getCentroid=function(){if(this.isEmpty()){return null;}
var cent;var centPt=null;var dim=this.getDimension();if(dim===0){cent=new jsts.algorithm.CentroidPoint();cent.add(this);centPt=cent.getCentroid();}else if(dim===1){cent=new jsts.algorithm.CentroidLine();cent.add(this);centPt=cent.getCentroid();}else{cent=new jsts.algorithm.CentroidArea();cent.add(this);centPt=cent.getCentroid();}
return this.createPointFromInternalCoord(centPt,this);};jsts.geom.Geometry.prototype.getInteriorPoint=function(){var intPt;var interiorPt=null;var dim=this.getDimension();if(dim===0){intPt=new jsts.algorithm.InteriorPointPoint(this);interiorPt=intPt.getInteriorPoint();}else if(dim===1){intPt=new jsts.algorithm.InteriorPointLine(this);interiorPt=intPt.getInteriorPoint();}else{intPt=new jsts.algorithm.InteriorPointArea(this);interiorPt=intPt.getInteriorPoint();}
return this.createPointFromInternalCoord(interiorPt,this);};jsts.geom.Geometry.prototype.getDimension=function(){throw new jsts.error.AbstractMethodInvocationError();};jsts.geom.Geometry.prototype.getBoundary=function(){throw new jsts.error.AbstractMethodInvocationError();};jsts.geom.Geometry.prototype.getBoundaryDimension=function(){throw new jsts.error.AbstractMethodInvocationError();};jsts.geom.Geometry.prototype.getEnvelope=function(){return this.getFactory().toGeometry(this.getEnvelopeInternal());};jsts.geom.Geometry.prototype.getEnvelopeInternal=function(){if(this.envelope===null){this.envelope=this.computeEnvelopeInternal();}
return this.envelope;};jsts.geom.Geometry.prototype.disjoint=function(g){return!this.intersects(g);};jsts.geom.Geometry.prototype.touches=function(g){if(!this.getEnvelopeInternal().intersects(g.getEnvelopeInternal())){return false;}
return this.relate(g).isTouches(this.getDimension(),g.getDimension());};jsts.geom.Geometry.prototype.intersects=function(g){if(!this.getEnvelopeInternal().intersects(g.getEnvelopeInternal())){return false;}
if(this.isRectangle()){return jsts.operation.predicate.RectangleIntersects.intersects(this,g);}
if(g.isRectangle()){return jsts.operation.predicate.RectangleIntersects.intersects(g,this);}
return this.relate(g).isIntersects();};jsts.geom.Geometry.prototype.crosses=function(g){if(!this.getEnvelopeInternal().intersects(g.getEnvelopeInternal())){return false;}
return this.relate(g).isCrosses(this.getDimension(),g.getDimension());};jsts.geom.Geometry.prototype.within=function(g){return g.contains(this);};jsts.geom.Geometry.prototype.contains=function(g){if(!this.getEnvelopeInternal().contains(g.getEnvelopeInternal())){return false;}
if(this.isRectangle()){return jsts.operation.predicate.RectangleContains.contains(this,g);}
return this.relate(g).isContains();};jsts.geom.Geometry.prototype.overlaps=function(g){if(!this.getEnvelopeInternal().intersects(g.getEnvelopeInternal())){return false;}
return this.relate(g).isOverlaps(this.getDimension(),g.getDimension());};jsts.geom.Geometry.prototype.covers=function(g){if(!this.getEnvelopeInternal().covers(g.getEnvelopeInternal())){return false;}
if(this.isRectangle()){return true;}
return this.relate(g).isCovers();};jsts.geom.Geometry.prototype.coveredBy=function(g){return g.covers(this);};jsts.geom.Geometry.prototype.relate=function(g,intersectionPattern){if(arguments.length===1){return this.relate2.apply(this,arguments);}
return this.relate2(g).matches(intersectionPattern);};jsts.geom.Geometry.prototype.relate2=function(g){this.checkNotGeometryCollection(this);this.checkNotGeometryCollection(g);return jsts.operation.relate.RelateOp.relate(this,g);};jsts.geom.Geometry.prototype.equalsTopo=function(g){if(!this.getEnvelopeInternal().equals(g.getEnvelopeInternal())){return false;}
return this.relate(g).isEquals(this.getDimension(),g.getDimension());};jsts.geom.Geometry.prototype.equals=function(o){if(o instanceof jsts.geom.Geometry||o instanceof jsts.geom.LinearRing||o instanceof jsts.geom.Polygon||o instanceof jsts.geom.GeometryCollection||o instanceof jsts.geom.MultiPoint||o instanceof jsts.geom.MultiLineString||o instanceof jsts.geom.MultiPolygon){return this.equalsExact(o);}
return false;};jsts.geom.Geometry.prototype.buffer=function(distance,quadrantSegments,endCapStyle){var params=new jsts.operation.buffer.BufferParameters(quadrantSegments,endCapStyle)
return jsts.operation.buffer.BufferOp.bufferOp2(this,distance,params);};jsts.geom.Geometry.prototype.convexHull=function(){return new jsts.algorithm.ConvexHull(this).getConvexHull();};jsts.geom.Geometry.prototype.intersection=function(other){if(this.isEmpty()){return this.getFactory().createGeometryCollection(null);}
if(other.isEmpty()){return this.getFactory().createGeometryCollection(null);}
if(this.isGeometryCollection(this)){var g2=other;}
this.checkNotGeometryCollection(this);this.checkNotGeometryCollection(other);return jsts.operation.overlay.snap.SnapIfNeededOverlayOp.overlayOp(this,other,jsts.operation.overlay.OverlayOp.INTERSECTION);};jsts.geom.Geometry.prototype.union=function(other){if(arguments.length===0){return jsts.operation.union.UnaryUnionOp.union(this);}
if(this.isEmpty()){return other.clone();}
if(other.isEmpty()){return this.clone();}
this.checkNotGeometryCollection(this);this.checkNotGeometryCollection(other);return jsts.operation.overlay.snap.SnapIfNeededOverlayOp.overlayOp(this,other,jsts.operation.overlay.OverlayOp.UNION);};jsts.geom.Geometry.prototype.difference=function(other){if(this.isEmpty()){return this.getFactory().createGeometryCollection(null);}
if(other.isEmpty()){return this.clone();}
this.checkNotGeometryCollection(this);this.checkNotGeometryCollection(other);return jsts.operation.overlay.snap.SnapIfNeededOverlayOp.overlayOp(this,other,jsts.operation.overlay.OverlayOp.DIFFERENCE);};jsts.geom.Geometry.prototype.symDifference=function(other){if(this.isEmpty()){return other.clone();}
if(other.isEmpty()){return this.clone();}
this.checkNotGeometryCollection(this);this.checkNotGeometryCollection(other);return jsts.operation.overlay.snap.SnapIfNeededOverlayOp.overlayOp(this,other,jsts.operation.overlay.OverlayOp.SYMDIFFERENCE);};jsts.geom.Geometry.prototype.equalsExact=function(other,tolerance){throw new jsts.error.AbstractMethodInvocationError();};jsts.geom.Geometry.prototype.equalsNorm=function(g){if(g===null||g===undefined)
return false;return this.norm().equalsExact(g.norm());};jsts.geom.Geometry.prototype.apply=function(filter){throw new jsts.error.AbstractMethodInvocationError();};jsts.geom.Geometry.prototype.clone=function(){throw new jsts.error.AbstractMethodInvocationError();};jsts.geom.Geometry.prototype.normalize=function(){throw new jsts.error.AbstractMethodInvocationError();};jsts.geom.Geometry.prototype.norm=function(){var copy=this.clone();copy.normalize();return copy;};jsts.geom.Geometry.prototype.compareTo=function(o){var other=o;if(this.getClassSortIndex()!==other.getClassSortIndex()){return this.getClassSortIndex()-other.getClassSortIndex();}
if(this.isEmpty()&&other.isEmpty()){return 0;}
if(this.isEmpty()){return-1;}
if(other.isEmpty()){return 1;}
return this.compareToSameClass(o);};jsts.geom.Geometry.prototype.isEquivalentClass=function(other){if(this instanceof jsts.geom.Point&&other instanceof jsts.geom.Point){return true;}else if(this instanceof jsts.geom.LineString&&(other instanceof jsts.geom.LineString|other instanceof jsts.geom.LinearRing)){return true;}else if(this instanceof jsts.geom.LinearRing&&(other instanceof jsts.geom.LineString|other instanceof jsts.geom.LinearRing)){return true;}else if(this instanceof jsts.geom.Polygon&&(other instanceof jsts.geom.Polygon)){return true;}else if(this instanceof jsts.geom.MultiPoint&&(other instanceof jsts.geom.MultiPoint)){return true;}else if(this instanceof jsts.geom.MultiLineString&&(other instanceof jsts.geom.MultiLineString)){return true;}else if(this instanceof jsts.geom.MultiPolygon&&(other instanceof jsts.geom.MultiPolygon)){return true;}else if(this instanceof jsts.geom.GeometryCollection&&(other instanceof jsts.geom.GeometryCollection)){return true;}
return false;};jsts.geom.Geometry.prototype.checkNotGeometryCollection=function(g){if(g.isGeometryCollectionBase()){throw new jsts.error.IllegalArgumentError('This method does not support GeometryCollection');}};jsts.geom.Geometry.prototype.isGeometryCollection=function(){return(this instanceof jsts.geom.GeometryCollection);};jsts.geom.Geometry.prototype.isGeometryCollectionBase=function(){return(this.CLASS_NAME==='jsts.geom.GeometryCollection');};jsts.geom.Geometry.prototype.computeEnvelopeInternal=function(){throw new jsts.error.AbstractMethodInvocationError();};jsts.geom.Geometry.prototype.compareToSameClass=function(o){throw new jsts.error.AbstractMethodInvocationError();};jsts.geom.Geometry.prototype.compare=function(a,b){var i=a.iterator();var j=b.iterator();while(i.hasNext()&&j.hasNext()){var aElement=i.next();var bElement=j.next();var comparison=aElement.compareTo(bElement);if(comparison!==0){return comparison;}}
if(i.hasNext()){return 1;}
if(j.hasNext()){return-1;}
return 0;};jsts.geom.Geometry.prototype.equal=function(a,b,tolerance){if(tolerance===undefined||tolerance===null||tolerance===0){return a.equals(b);}
return a.distance(b)<=tolerance;};jsts.geom.Geometry.prototype.getClassSortIndex=function(){var sortedClasses=[jsts.geom.Point,jsts.geom.MultiPoint,jsts.geom.LineString,jsts.geom.LinearRing,jsts.geom.MultiLineString,jsts.geom.Polygon,jsts.geom.MultiPolygon,jsts.geom.GeometryCollection];for(var i=0;i<sortedClasses.length;i++){if(this instanceof sortedClasses[i])
return i;}
jsts.util.Assert.shouldNeverReachHere('Class not supported: '+this);return-1;};jsts.geom.Geometry.prototype.toString=function(){return new jsts.io.WKTWriter().write(this);};jsts.geom.Geometry.prototype.createPointFromInternalCoord=function(coord,exemplar){exemplar.getPrecisionModel().makePrecise(coord);return exemplar.getFactory().createPoint(coord);};(function(){jsts.geom.Coordinate=function(x,y){if(typeof x==='number'){this.x=x;this.y=y;}else if(x instanceof jsts.geom.Coordinate){this.x=parseFloat(x.x);this.y=parseFloat(x.y);}else if(x===undefined||x===null){this.x=0;this.y=0;}else if(typeof x==='string'){this.x=parseFloat(x);this.y=parseFloat(y);}};jsts.geom.Coordinate.prototype.setCoordinate=function(other){this.x=other.x;this.y=other.y;};jsts.geom.Coordinate.prototype.clone=function(){return new jsts.geom.Coordinate(this.x,this.y);};jsts.geom.Coordinate.prototype.distance=function(p){var dx=this.x-p.x;var dy=this.y-p.y;return Math.sqrt(dx*dx+dy*dy);};jsts.geom.Coordinate.prototype.equals2D=function(other){if(this.x!==other.x){return false;}
if(this.y!==other.y){return false;}
return true;};jsts.geom.Coordinate.prototype.equals=function(other){if(!other instanceof jsts.geom.Coordinate||other===undefined){return false;}
return this.equals2D(other);};jsts.geom.Coordinate.prototype.compareTo=function(other){if(this.x<other.x){return-1;}
if(this.x>other.x){return 1;}
if(this.y<other.y){return-1;}
if(this.y>other.y){return 1;}
return 0;};jsts.geom.Coordinate.prototype.toString=function(){return'('+this.x+', '+this.y+')';};})();jsts.geom.Envelope=function(){jsts.geom.Envelope.prototype.init.apply(this,arguments);};jsts.geom.Envelope.prototype.minx=null;jsts.geom.Envelope.prototype.maxx=null;jsts.geom.Envelope.prototype.miny=null;jsts.geom.Envelope.prototype.maxy=null;jsts.geom.Envelope.prototype.init=function(){if(typeof arguments[0]==='number'&&arguments.length===4){this.initFromValues(arguments[0],arguments[1],arguments[2],arguments[3]);}else if(arguments[0]instanceof jsts.geom.Coordinate&&arguments.length===1){this.initFromCoordinate(arguments[0]);}else if(arguments[0]instanceof jsts.geom.Coordinate&&arguments.length===2){this.initFromCoordinates(arguments[0],arguments[1]);}else if(arguments[0]instanceof jsts.geom.Envelope&&arguments.length===1){this.initFromEnvelope(arguments[0]);}else{this.setToNull();}};jsts.geom.Envelope.prototype.initFromValues=function(x1,x2,y1,y2){if(x1<x2){this.minx=x1;this.maxx=x2;}else{this.minx=x2;this.maxx=x1;}
if(y1<y2){this.miny=y1;this.maxy=y2;}else{this.miny=y2;this.maxy=y1;}};jsts.geom.Envelope.prototype.initFromCoordinates=function(p1,p2){this.initFromValues(p1.x,p2.x,p1.y,p2.y);};jsts.geom.Envelope.prototype.initFromCoordinate=function(p){this.initFromValues(p.x,p.x,p.y,p.y);};jsts.geom.Envelope.prototype.initFromEnvelope=function(env){this.minx=env.minx;this.maxx=env.maxx;this.miny=env.miny;this.maxy=env.maxy;};jsts.geom.Envelope.prototype.setToNull=function(){this.minx=0;this.maxx=-1;this.miny=0;this.maxy=-1;};jsts.geom.Envelope.prototype.isNull=function(){return this.maxx<this.minx;};jsts.geom.Envelope.prototype.getHeight=function(){if(this.isNull()){return 0;}
return this.maxy-this.miny;};jsts.geom.Envelope.prototype.getWidth=function(){if(this.isNull()){return 0;}
return this.maxx-this.minx;};jsts.geom.Envelope.prototype.getMinX=function(){return this.minx;};jsts.geom.Envelope.prototype.getMaxX=function(){return this.maxx;};jsts.geom.Envelope.prototype.getMinY=function(){return this.miny;};jsts.geom.Envelope.prototype.getMaxY=function(){return this.maxy;};jsts.geom.Envelope.prototype.getArea=function(){return this.getWidth()*this.getHeight();};jsts.geom.Envelope.prototype.expandToInclude=function(){if(arguments[0]instanceof jsts.geom.Coordinate){this.expandToIncludeCoordinate(arguments[0]);}else if(arguments[0]instanceof jsts.geom.Envelope){this.expandToIncludeEnvelope(arguments[0]);}else{this.expandToIncludeValues(arguments[0],arguments[1]);}};jsts.geom.Envelope.prototype.expandToIncludeCoordinate=function(p){this.expandToIncludeValues(p.x,p.y);};jsts.geom.Envelope.prototype.expandToIncludeValues=function(x,y){if(this.isNull()){this.minx=x;this.maxx=x;this.miny=y;this.maxy=y;}else{if(x<this.minx){this.minx=x;}
if(x>this.maxx){this.maxx=x;}
if(y<this.miny){this.miny=y;}
if(y>this.maxy){this.maxy=y;}}};jsts.geom.Envelope.prototype.expandToIncludeEnvelope=function(other){if(other.isNull()){return;}
if(this.isNull()){this.minx=other.getMinX();this.maxx=other.getMaxX();this.miny=other.getMinY();this.maxy=other.getMaxY();}else{if(other.minx<this.minx){this.minx=other.minx;}
if(other.maxx>this.maxx){this.maxx=other.maxx;}
if(other.miny<this.miny){this.miny=other.miny;}
if(other.maxy>this.maxy){this.maxy=other.maxy;}}};jsts.geom.Envelope.prototype.expandBy=function(){if(arguments.length===1){this.expandByDistance(arguments[0]);}else{this.expandByDistances(arguments[0],arguments[1]);}};jsts.geom.Envelope.prototype.expandByDistance=function(distance){this.expandByDistances(distance,distance);};jsts.geom.Envelope.prototype.expandByDistances=function(deltaX,deltaY){if(this.isNull()){return;}
this.minx-=deltaX;this.maxx+=deltaX;this.miny-=deltaY;this.maxy+=deltaY;if(this.minx>this.maxx||this.miny>this.maxy){this.setToNull();}};jsts.geom.Envelope.prototype.translate=function(transX,transY){if(this.isNull()){return;}
this.init(this.minx+transX,this.maxx+transX,this.miny+transY,this.maxy+transY);};jsts.geom.Envelope.prototype.centre=function(){if(this.isNull()){return null;}
return new jsts.geom.Coordinate((this.minx+this.maxx)/2.0,(this.miny+this.maxy)/2.0);};jsts.geom.Envelope.prototype.intersection=function(env){if(this.isNull()||env.isNull()||!this.intersects(env)){return new jsts.geom.Envelope();}
var intMinX=this.minx>env.minx?this.minx:env.minx;var intMinY=this.miny>env.miny?this.miny:env.miny;var intMaxX=this.maxx<env.maxx?this.maxx:env.maxx;var intMaxY=this.maxy<env.maxy?this.maxy:env.maxy;return new jsts.geom.Envelope(intMinX,intMaxX,intMinY,intMaxY);};jsts.geom.Envelope.prototype.intersects=function(){if(arguments[0]instanceof jsts.geom.Envelope){return this.intersectsEnvelope(arguments[0]);}else if(arguments[0]instanceof jsts.geom.Coordinate){return this.intersectsCoordinate(arguments[0]);}else{return this.intersectsValues(arguments[0],arguments[1]);}};jsts.geom.Envelope.prototype.intersectsEnvelope=function(other){if(this.isNull()||other.isNull()){return false;}
var result=!(other.minx>this.maxx||other.maxx<this.minx||other.miny>this.maxy||other.maxy<this.miny);return result;};jsts.geom.Envelope.prototype.intersectsCoordinate=function(p){return this.intersectsValues(p.x,p.y);};jsts.geom.Envelope.prototype.intersectsValues=function(x,y){if(this.isNull()){return false;}
return!(x>this.maxx||x<this.minx||y>this.maxy||y<this.miny);};jsts.geom.Envelope.prototype.contains=function(){if(arguments[0]instanceof jsts.geom.Envelope){return this.containsEnvelope(arguments[0]);}else if(arguments[0]instanceof jsts.geom.Coordinate){return this.containsCoordinate(arguments[0]);}else{return this.containsValues(arguments[0],arguments[1]);}};jsts.geom.Envelope.prototype.containsEnvelope=function(other){return this.coversEnvelope(other);};jsts.geom.Envelope.prototype.containsCoordinate=function(p){return this.coversCoordinate(p);};jsts.geom.Envelope.prototype.containsValues=function(x,y){return this.coversValues(x,y);};jsts.geom.Envelope.prototype.covers=function(){if(arguments[0]instanceof jsts.geom.Envelope){return this.coversEnvelope(arguments[0]);}else if(arguments[0]instanceof jsts.geom.Coordinate){return this.coversCoordinate(arguments[0]);}else{return this.coversValues(arguments[0],arguments[1]);}};jsts.geom.Envelope.prototype.coversValues=function(x,y){if(this.isNull()){return false;}
return x>=this.minx&&x<=this.maxx&&y>=this.miny&&y<=this.maxy;};jsts.geom.Envelope.prototype.coversCoordinate=function(p){return this.coversValues(p.x,p.y);};jsts.geom.Envelope.prototype.coversEnvelope=function(other){if(this.isNull()||other.isNull()){return false;}
return other.minx>=this.minx&&other.maxx<=this.maxx&&other.miny>=this.miny&&other.maxy<=this.maxy;};jsts.geom.Envelope.prototype.distance=function(env){if(this.intersects(env)){return 0;}
var dx=0.0;if(this.maxx<env.minx){dx=env.minx-this.maxx;}
if(this.minx>env.maxx){dx=this.minx-env.maxx;}
var dy=0.0;if(this.maxy<env.miny){dy=env.miny-this.maxy;}
if(this.miny>env.maxy){dy=this.miny-env.maxy;}
if(dx===0.0){return dy;}
if(dy===0.0){return dx;}
return Math.sqrt(dx*dx+dy*dy);};jsts.geom.Envelope.prototype.equals=function(other){if(this.isNull()){return other.isNull();}
return this.maxx===other.maxx&&this.maxy===other.maxy&&this.minx===other.minx&&this.miny===other.miny;};jsts.geom.Envelope.prototype.toString=function(){return'Env['+this.minx+' : '+this.maxx+', '+this.miny+' : '+
this.maxy+']';};jsts.geom.Envelope.intersects=function(p1,p2,q){if(arguments.length===4){return jsts.geom.Envelope.intersectsEnvelope(arguments[0],arguments[1],arguments[2],arguments[3]);}
var xc1=p1.x<p2.x?p1.x:p2.x;var xc2=p1.x>p2.x?p1.x:p2.x;var yc1=p1.y<p2.y?p1.y:p2.y;var yc2=p1.y>p2.y?p1.y:p2.y;if(((q.x>=xc1)&&(q.x<=xc2))&&((q.y>=yc1)&&(q.y<=yc2))){return true;}
return false;};jsts.geom.Envelope.intersectsEnvelope=function(p1,p2,q1,q2){var minq=Math.min(q1.x,q2.x);var maxq=Math.max(q1.x,q2.x);var minp=Math.min(p1.x,p2.x);var maxp=Math.max(p1.x,p2.x);if(minp>maxq){return false;}
if(maxp<minq){return false;}
minq=Math.min(q1.y,q2.y);maxq=Math.max(q1.y,q2.y);minp=Math.min(p1.y,p2.y);maxp=Math.max(p1.y,p2.y);if(minp>maxq){return false;}
if(maxp<minq){return false;}
return true;};jsts.geom.Envelope.prototype.clone=function(){return new jsts.geom.Envelope(this.minx,this.maxx,this.miny,this.maxy);};jsts.geom.util.GeometryCombiner=function(geoms){this.geomFactory=jsts.geom.util.GeometryCombiner.extractFactory(geoms);this.inputGeoms=geoms;};jsts.geom.util.GeometryCombiner.combine=function(geoms){if(arguments.length>1)return this.combine2.apply(this,arguments);var combiner=new jsts.geom.util.GeometryCombiner(geoms);return combiner.combine();};jsts.geom.util.GeometryCombiner.combine2=function(){var arrayList=new javascript.util.ArrayList();Array.prototype.slice.call(arguments).forEach(function(a){arrayList.add(a);});var combiner=new jsts.geom.util.GeometryCombiner(arrayList);return combiner.combine();};jsts.geom.util.GeometryCombiner.prototype.geomFactory=null;jsts.geom.util.GeometryCombiner.prototype.skipEmpty=false;jsts.geom.util.GeometryCombiner.prototype.inputGeoms;jsts.geom.util.GeometryCombiner.extractFactory=function(geoms){if(geoms.isEmpty())return null;return geoms.iterator().next().getFactory();};jsts.geom.util.GeometryCombiner.prototype.combine=function(){var elems=new javascript.util.ArrayList(),i;for(i=this.inputGeoms.iterator();i.hasNext();){var g=i.next();this.extractElements(g,elems);}
if(elems.size()===0){if(this.geomFactory!==null){return this.geomFactory.createGeometryCollection(null);}
return null;}
return this.geomFactory.buildGeometry(elems);};jsts.geom.util.GeometryCombiner.prototype.extractElements=function(geom,elems){if(geom===null){return;}
for(var i=0;i<geom.getNumGeometries();i++){var elemGeom=geom.getGeometryN(i);if(this.skipEmpty&&elemGeom.isEmpty()){continue;}
elems.add(elemGeom);}};jsts.geom.PrecisionModel=function(modelType){if(typeof modelType==='number'){this.modelType=jsts.geom.PrecisionModel.FIXED;this.scale=modelType;return;}
this.modelType=modelType||jsts.geom.PrecisionModel.FLOATING;if(this.modelType===jsts.geom.PrecisionModel.FIXED){this.scale=1.0;}};jsts.geom.PrecisionModel.FLOATING='FLOATING';jsts.geom.PrecisionModel.FIXED='FIXED';jsts.geom.PrecisionModel.FLOATING_SINGLE='FLOATING_SINGLE';jsts.geom.PrecisionModel.prototype.scale=null;jsts.geom.PrecisionModel.prototype.modelType=null;jsts.geom.PrecisionModel.prototype.isFloating=function(){return this.modelType===jsts.geom.PrecisionModel.FLOATING||this.modelType===jsts.geom.PrecisionModel.FLOATING_SINLGE;};jsts.geom.PrecisionModel.prototype.getScale=function(){return this.scale;};jsts.geom.PrecisionModel.prototype.getType=function(){return this.modelType;};jsts.geom.PrecisionModel.prototype.equals=function(other){return true;if(!(other instanceof jsts.geom.PrecisionModel)){return false;}
var otherPrecisionModel=other;return this.modelType===otherPrecisionModel.modelType&&this.scale===otherPrecisionModel.scale;};jsts.geom.PrecisionModel.prototype.makePrecise=function(val){if(val instanceof jsts.geom.Coordinate){this.makePrecise2(val);return;}
if(isNaN(val))
return val;if(this.modelType===jsts.geom.PrecisionModel.FIXED){return Math.round(val*this.scale)/this.scale;}
return val;};jsts.geom.PrecisionModel.prototype.makePrecise2=function(coord){if(this.modelType===jsts.geom.PrecisionModel.FLOATING)
return;coord.x=this.makePrecise(coord.x);coord.y=this.makePrecise(coord.y);};jsts.geom.PrecisionModel.prototype.compareTo=function(o){var other=o;return 0;};jsts.geom.CoordinateFilter=function(){};jsts.geom.CoordinateFilter.prototype.filter=function(coord){throw new jsts.error.AbstractMethodInvocationError();};jsts.simplify.DouglasPeuckerLineSimplifier=function(pts){this.pts=pts;this.seg=new jsts.geom.LineSegment();};jsts.simplify.DouglasPeuckerLineSimplifier.prototype.pts=null;jsts.simplify.DouglasPeuckerLineSimplifier.prototype.usePt=null;jsts.simplify.DouglasPeuckerLineSimplifier.prototype.distanceTolerance=null;jsts.simplify.DouglasPeuckerLineSimplifier.simplify=function(pts,distanceTolerance){var simp=new jsts.simplify.DouglasPeuckerLineSimplifier(pts);simp.setDistanceTolerance(distanceTolerance);return simp.simplify();};jsts.simplify.DouglasPeuckerLineSimplifier.prototype.setDistanceTolerance=function(distanceTolerance){this.distanceTolerance=distanceTolerance;};jsts.simplify.DouglasPeuckerLineSimplifier.prototype.simplify=function(){this.usePt=[];for(var i=0;i<this.pts.length;i++){this.usePt[i]=true;}
this.simplifySection(0,this.pts.length-1);var coordList=new jsts.geom.CoordinateList();for(var j=0;j<this.pts.length;j++){if(this.usePt[j]){coordList.add(new jsts.geom.Coordinate(this.pts[j]));}}
return coordList.toCoordinateArray();};jsts.simplify.DouglasPeuckerLineSimplifier.prototype.seg=null;jsts.simplify.DouglasPeuckerLineSimplifier.prototype.simplifySection=function(i,j){if(i+1==j){return;}
this.seg.p0=this.pts[i];this.seg.p1=this.pts[j];var maxDistance=-1.0;var maxIndex=i;for(var k=i+1;k<j;k++){var distance=this.seg.distance(this.pts[k]);if(distance>maxDistance){maxDistance=distance;maxIndex=k;}}
if(maxDistance<=this.distanceTolerance){for(var l=i+1;l<j;l++){this.usePt[l]=false;}}else{this.simplifySection(i,maxIndex);this.simplifySection(maxIndex,j);}};jsts.geomgraph.EdgeIntersection=function(coord,segmentIndex,dist){this.coord=new jsts.geom.Coordinate(coord);this.segmentIndex=segmentIndex;this.dist=dist;};jsts.geomgraph.EdgeIntersection.prototype.coord=null;jsts.geomgraph.EdgeIntersection.prototype.segmentIndex=null;jsts.geomgraph.EdgeIntersection.prototype.dist=null;jsts.geomgraph.EdgeIntersection.prototype.getCoordinate=function(){return this.coord;};jsts.geomgraph.EdgeIntersection.prototype.getSegmentIndex=function(){return this.segmentIndex;};jsts.geomgraph.EdgeIntersection.prototype.getDistance=function(){return this.dist;};jsts.geomgraph.EdgeIntersection.prototype.compareTo=function(other){return this.compare(other.segmentIndex,other.dist);};jsts.geomgraph.EdgeIntersection.prototype.compare=function(segmentIndex,dist){if(this.segmentIndex<segmentIndex)
return-1;if(this.segmentIndex>segmentIndex)
return 1;if(this.dist<dist)
return-1;if(this.dist>dist)
return 1;return 0;};jsts.geomgraph.EdgeIntersection.prototype.isEndPoint=function(maxSegmentIndex){if(this.segmentIndex===0&&this.dist===0.0)
return true;if(this.segmentIndex===maxSegmentIndex)
return true;return false;};jsts.geomgraph.EdgeIntersection.prototype.toString=function(){return''+this.segmentIndex+this.dist;};(function(){var EdgeIntersection=jsts.geomgraph.EdgeIntersection;var TreeMap=javascript.util.TreeMap;jsts.geomgraph.EdgeIntersectionList=function(edge){this.nodeMap=new TreeMap();this.edge=edge;};jsts.geomgraph.EdgeIntersectionList.prototype.nodeMap=null;jsts.geomgraph.EdgeIntersectionList.prototype.edge=null;jsts.geomgraph.EdgeIntersectionList.prototype.isIntersection=function(pt){for(var it=this.iterator();it.hasNext();){var ei=it.next();if(ei.coord.equals(pt)){return true;}}
return false;};jsts.geomgraph.EdgeIntersectionList.prototype.add=function(intPt,segmentIndex,dist){var eiNew=new EdgeIntersection(intPt,segmentIndex,dist);var ei=this.nodeMap.get(eiNew);if(ei!==null){return ei;}
this.nodeMap.put(eiNew,eiNew);return eiNew;};jsts.geomgraph.EdgeIntersectionList.prototype.iterator=function(){return this.nodeMap.values().iterator();};jsts.geomgraph.EdgeIntersectionList.prototype.addEndpoints=function(){var maxSegIndex=this.edge.pts.length-1;this.add(this.edge.pts[0],0,0.0);this.add(this.edge.pts[maxSegIndex],maxSegIndex,0.0);};jsts.geomgraph.EdgeIntersectionList.prototype.addSplitEdges=function(edgeList)
{this.addEndpoints();var it=this.iterator();var eiPrev=it.next();while(it.hasNext()){var ei=it.next();var newEdge=this.createSplitEdge(eiPrev,ei);edgeList.add(newEdge);eiPrev=ei;}};jsts.geomgraph.EdgeIntersectionList.prototype.createSplitEdge=function(ei0,ei1){var npts=ei1.segmentIndex-ei0.segmentIndex+2;var lastSegStartPt=this.edge.pts[ei1.segmentIndex];var useIntPt1=ei1.dist>0.0||!ei1.coord.equals2D(lastSegStartPt);if(!useIntPt1){npts--;}
var pts=[];var ipt=0;pts[ipt++]=new jsts.geom.Coordinate(ei0.coord);for(var i=ei0.segmentIndex+1;i<=ei1.segmentIndex;i++){pts[ipt++]=this.edge.pts[i];}
if(useIntPt1)pts[ipt]=ei1.coord;return new jsts.geomgraph.Edge(pts,new jsts.geomgraph.Label(this.edge.label));};})();(function(){var AssertionFailedException=function(message){this.message=message;};AssertionFailedException.prototype=new Error();AssertionFailedException.prototype.name='AssertionFailedException';jsts.util.AssertionFailedException=AssertionFailedException;})();(function(){var AssertionFailedException=jsts.util.AssertionFailedException;jsts.util.Assert=function(){};jsts.util.Assert.isTrue=function(assertion,message){if(!assertion){if(message===null){throw new AssertionFailedException();}else{throw new AssertionFailedException(message);}}};jsts.util.Assert.equals=function(expectedValue,actualValue,message){if(!actualValue.equals(expectedValue)){throw new AssertionFailedException('Expected '+expectedValue+' but encountered '+actualValue+
(message!=null?': '+message:''));}};jsts.util.Assert.shouldNeverReachHere=function(message){throw new AssertionFailedException('Should never reach here'+
(message!=null?': '+message:''));};})();(function(){var Location=jsts.geom.Location;var Assert=jsts.util.Assert;var ArrayList=javascript.util.ArrayList;jsts.operation.relate.RelateComputer=function(arg){this.li=new jsts.algorithm.RobustLineIntersector();this.ptLocator=new jsts.algorithm.PointLocator();this.nodes=new jsts.geomgraph.NodeMap(new jsts.operation.relate.RelateNodeFactory());this.isolatedEdges=new ArrayList();this.arg=arg;};jsts.operation.relate.RelateComputer.prototype.li=null;jsts.operation.relate.RelateComputer.prototype.ptLocator=null;jsts.operation.relate.RelateComputer.prototype.arg=null;jsts.operation.relate.RelateComputer.prototype.nodes=null;jsts.operation.relate.RelateComputer.prototype.im=null;jsts.operation.relate.RelateComputer.prototype.isolatedEdges=null;jsts.operation.relate.RelateComputer.prototype.invalidPoint=null;jsts.operation.relate.RelateComputer.prototype.computeIM=function(){var im=new jsts.geom.IntersectionMatrix();im.set(Location.EXTERIOR,Location.EXTERIOR,2);if(!this.arg[0].getGeometry().getEnvelopeInternal().intersects(this.arg[1].getGeometry().getEnvelopeInternal())){this.computeDisjointIM(im);return im;}
this.arg[0].computeSelfNodes(this.li,false);this.arg[1].computeSelfNodes(this.li,false);var intersector=this.arg[0].computeEdgeIntersections(this.arg[1],this.li,false);this.computeIntersectionNodes(0);this.computeIntersectionNodes(1);this.copyNodesAndLabels(0);this.copyNodesAndLabels(1);this.labelIsolatedNodes();this.computeProperIntersectionIM(intersector,im);var eeBuilder=new jsts.operation.relate.EdgeEndBuilder();var ee0=eeBuilder.computeEdgeEnds(this.arg[0].getEdgeIterator());this.insertEdgeEnds(ee0);var ee1=eeBuilder.computeEdgeEnds(this.arg[1].getEdgeIterator());this.insertEdgeEnds(ee1);this.labelNodeEdges();this.labelIsolatedEdges(0,1);this.labelIsolatedEdges(1,0);this.updateIM(im);return im;};jsts.operation.relate.RelateComputer.prototype.insertEdgeEnds=function(ee){for(var i=ee.iterator();i.hasNext();){var e=i.next();this.nodes.add(e);}};jsts.operation.relate.RelateComputer.prototype.computeProperIntersectionIM=function(intersector,im){var dimA=this.arg[0].getGeometry().getDimension();var dimB=this.arg[1].getGeometry().getDimension();var hasProper=intersector.hasProperIntersection();var hasProperInterior=intersector.hasProperInteriorIntersection();if(dimA===2&&dimB===2){if(hasProper)
im.setAtLeast('212101212');}
else if(dimA===2&&dimB===1){if(hasProper)
im.setAtLeast('FFF0FFFF2');if(hasProperInterior)
im.setAtLeast('1FFFFF1FF');}else if(dimA===1&&dimB===2){if(hasProper)
im.setAtLeast('F0FFFFFF2');if(hasProperInterior)
im.setAtLeast('1F1FFFFFF');}
else if(dimA===1&&dimB===1){if(hasProperInterior)
im.setAtLeast('0FFFFFFFF');}};jsts.operation.relate.RelateComputer.prototype.copyNodesAndLabels=function(argIndex){for(var i=this.arg[argIndex].getNodeIterator();i.hasNext();){var graphNode=i.next();var newNode=this.nodes.addNode(graphNode.getCoordinate());newNode.setLabel(argIndex,graphNode.getLabel().getLocation(argIndex));}};jsts.operation.relate.RelateComputer.prototype.computeIntersectionNodes=function(argIndex){for(var i=this.arg[argIndex].getEdgeIterator();i.hasNext();){var e=i.next();var eLoc=e.getLabel().getLocation(argIndex);for(var eiIt=e.getEdgeIntersectionList().iterator();eiIt.hasNext();){var ei=eiIt.next();var n=this.nodes.addNode(ei.coord);if(eLoc===Location.BOUNDARY)
n.setLabelBoundary(argIndex);else{if(n.getLabel().isNull(argIndex))
n.setLabel(argIndex,Location.INTERIOR);}}}};jsts.operation.relate.RelateComputer.prototype.labelIntersectionNodes=function(argIndex){for(var i=this.arg[argIndex].getEdgeIterator();i.hasNext();){var e=i.next();var eLoc=e.getLabel().getLocation(argIndex);for(var eiIt=e.getEdgeIntersectionList().iterator();eiIt.hasNext();){var ei=eiIt.next();var n=this.nodes.find(ei.coord);if(n.getLabel().isNull(argIndex)){if(eLoc===Location.BOUNDARY)
n.setLabelBoundary(argIndex);else
n.setLabel(argIndex,Location.INTERIOR);}}}};jsts.operation.relate.RelateComputer.prototype.computeDisjointIM=function(im){var ga=this.arg[0].getGeometry();if(!ga.isEmpty()){im.set(Location.INTERIOR,Location.EXTERIOR,ga.getDimension());im.set(Location.BOUNDARY,Location.EXTERIOR,ga.getBoundaryDimension());}
var gb=this.arg[1].getGeometry();if(!gb.isEmpty()){im.set(Location.EXTERIOR,Location.INTERIOR,gb.getDimension());im.set(Location.EXTERIOR,Location.BOUNDARY,gb.getBoundaryDimension());}};jsts.operation.relate.RelateComputer.prototype.labelNodeEdges=function(){for(var ni=this.nodes.iterator();ni.hasNext();){var node=ni.next();node.getEdges().computeLabelling(this.arg);}};jsts.operation.relate.RelateComputer.prototype.updateIM=function(im){for(var ei=this.isolatedEdges.iterator();ei.hasNext();){var e=ei.next();e.updateIM(im);}
for(var ni=this.nodes.iterator();ni.hasNext();){var node=ni.next();node.updateIM(im);node.updateIMFromEdges(im);}};jsts.operation.relate.RelateComputer.prototype.labelIsolatedEdges=function(thisIndex,targetIndex){for(var ei=this.arg[thisIndex].getEdgeIterator();ei.hasNext();){var e=ei.next();if(e.isIsolated()){this.labelIsolatedEdge(e,targetIndex,this.arg[targetIndex].getGeometry());this.isolatedEdges.add(e);}}};jsts.operation.relate.RelateComputer.prototype.labelIsolatedEdge=function(e,targetIndex,target){if(target.getDimension()>0){var loc=this.ptLocator.locate(e.getCoordinate(),target);e.getLabel().setAllLocations(targetIndex,loc);}else{e.getLabel().setAllLocations(targetIndex,Location.EXTERIOR);}};jsts.operation.relate.RelateComputer.prototype.labelIsolatedNodes=function(){for(var ni=this.nodes.iterator();ni.hasNext();){var n=ni.next();var label=n.getLabel();Assert.isTrue(label.getGeometryCount()>0,'node with empty label found');if(n.isIsolated()){if(label.isNull(0))
this.labelIsolatedNode(n,0);else
this.labelIsolatedNode(n,1);}}};jsts.operation.relate.RelateComputer.prototype.labelIsolatedNode=function(n,targetIndex){var loc=this.ptLocator.locate(n.getCoordinate(),this.arg[targetIndex].getGeometry());n.getLabel().setAllLocations(targetIndex,loc);};})();(function(){var Assert=jsts.util.Assert;jsts.geomgraph.GraphComponent=function(label){this.label=label;};jsts.geomgraph.GraphComponent.prototype.label=null;jsts.geomgraph.GraphComponent.prototype._isInResult=false;jsts.geomgraph.GraphComponent.prototype._isCovered=false;jsts.geomgraph.GraphComponent.prototype._isCoveredSet=false;jsts.geomgraph.GraphComponent.prototype._isVisited=false;jsts.geomgraph.GraphComponent.prototype.getLabel=function(){return this.label;};jsts.geomgraph.GraphComponent.prototype.setLabel=function(label){if(arguments.length===2){this.setLabel2.apply(this,arguments);return;}
this.label=label;};jsts.geomgraph.GraphComponent.prototype.setInResult=function(isInResult){this._isInResult=isInResult;};jsts.geomgraph.GraphComponent.prototype.isInResult=function(){return this._isInResult;};jsts.geomgraph.GraphComponent.prototype.setCovered=function(isCovered){this._isCovered=isCovered;this._isCoveredSet=true;};jsts.geomgraph.GraphComponent.prototype.isCovered=function(){return this._isCovered;};jsts.geomgraph.GraphComponent.prototype.isCoveredSet=function(){return this._isCoveredSet;};jsts.geomgraph.GraphComponent.prototype.isVisited=function(){return this._isVisited;};jsts.geomgraph.GraphComponent.prototype.setVisited=function(isVisited){this._isVisited=isVisited;};jsts.geomgraph.GraphComponent.prototype.getCoordinate=function(){throw new jsts.error.AbstractMethodInvocationError();};jsts.geomgraph.GraphComponent.prototype.computeIM=function(im){throw new jsts.error.AbstractMethodInvocationError();};jsts.geomgraph.GraphComponent.prototype.isIsolated=function(){throw new jsts.error.AbstractMethodInvocationError();};jsts.geomgraph.GraphComponent.prototype.updateIM=function(im){Assert.isTrue(this.label.getGeometryCount()>=2,'found partial label');this.computeIM(im);};})();jsts.geomgraph.Node=function(coord,edges){this.coord=coord;this.edges=edges;this.label=new jsts.geomgraph.Label(0,jsts.geom.Location.NONE);};jsts.geomgraph.Node.prototype=new jsts.geomgraph.GraphComponent();jsts.geomgraph.Node.prototype.coord=null;jsts.geomgraph.Node.prototype.edges=null;jsts.geomgraph.Node.prototype.isIsolated=function(){return(this.label.getGeometryCount()==1);};jsts.geomgraph.Node.prototype.setLabel2=function(argIndex,onLocation){if(this.label===null){this.label=new jsts.geomgraph.Label(argIndex,onLocation);}else
this.label.setLocation(argIndex,onLocation);};jsts.geomgraph.Node.prototype.setLabelBoundary=function(argIndex){var loc=jsts.geom.Location.NONE;if(this.label!==null)
loc=this.label.getLocation(argIndex);var newLoc;switch(loc){case jsts.geom.Location.BOUNDARY:newLoc=jsts.geom.Location.INTERIOR;break;case jsts.geom.Location.INTERIOR:newLoc=jsts.geom.Location.BOUNDARY;break;default:newLoc=jsts.geom.Location.BOUNDARY;break;}
this.label.setLocation(argIndex,newLoc);};jsts.geomgraph.Node.prototype.add=function(e){this.edges.insert(e);e.setNode(this);};jsts.geomgraph.Node.prototype.getCoordinate=function(){return this.coord;};jsts.geomgraph.Node.prototype.getEdges=function(){return this.edges;};jsts.geomgraph.Node.prototype.isIncidentEdgeInResult=function(){for(var it=this.getEdges().getEdges().iterator();it.hasNext();){var de=it.next();if(de.getEdge().isInResult())
return true;}
return false;};jsts.geom.Point=function(coordinate,factory){this.factory=factory;if(coordinate===undefined)
return;this.coordinate=coordinate;};jsts.geom.Point.prototype=new jsts.geom.Geometry();jsts.geom.Point.constructor=jsts.geom.Point;jsts.geom.Point.CLASS_NAME='jsts.geom.Point';jsts.geom.Point.prototype.coordinate=null;jsts.geom.Point.prototype.getX=function(){return this.coordinate.x;};jsts.geom.Point.prototype.getY=function(){return this.coordinate.y;};jsts.geom.Point.prototype.getCoordinate=function(){return this.coordinate;};jsts.geom.Point.prototype.getCoordinates=function(){return this.isEmpty()?[]:[this.coordinate];};jsts.geom.Point.prototype.getCoordinateSequence=function(){return this.isEmpty()?[]:[this.coordinate];};jsts.geom.Point.prototype.isEmpty=function(){return this.coordinate===null;};jsts.geom.Point.prototype.equalsExact=function(other,tolerance){if(!this.isEquivalentClass(other)){return false;}
if(this.isEmpty()&&other.isEmpty()){return true;}
return this.equal(other.getCoordinate(),this.getCoordinate(),tolerance);};jsts.geom.Point.prototype.getNumPoints=function(){return this.isEmpty()?0:1;};jsts.geom.Point.prototype.isSimple=function(){return true;};jsts.geom.Point.prototype.getBoundary=function(){return new jsts.geom.GeometryCollection(null);};jsts.geom.Point.prototype.computeEnvelopeInternal=function(){if(this.isEmpty()){return new jsts.geom.Envelope();}
return new jsts.geom.Envelope(this.coordinate);};jsts.geom.Point.prototype.apply=function(filter){if(filter instanceof jsts.geom.GeometryFilter||filter instanceof jsts.geom.GeometryComponentFilter){filter.filter(this);}else if(filter instanceof jsts.geom.CoordinateFilter){if(this.isEmpty()){return;}
filter.filter(this.getCoordinate());}};jsts.geom.Point.prototype.clone=function(){return new jsts.geom.Point(this.coordinate.clone(),this.factory);};jsts.geom.Point.prototype.getDimension=function(){return 0;};jsts.geom.Point.prototype.getBoundaryDimension=function(){return jsts.geom.Dimension.FALSE;};jsts.geom.Point.prototype.reverse=function(){return this.clone();};jsts.geom.Point.prototype.isValid=function(){if(!jsts.operation.valid.IsValidOp.isValid(this.getCoordinate())){return false;}
return true;};jsts.geom.Point.prototype.normalize=function(){};jsts.geom.Point.prototype.compareToSameClass=function(other){var point=other;return this.getCoordinate().compareTo(point.getCoordinate());};jsts.geom.Point.prototype.getGeometryType=function(){return'Point';};jsts.geom.Point.prototype.hashCode=function(){return'Point_'+this.coordinate.hashCode();};jsts.geom.Point.prototype.CLASS_NAME='jsts.geom.Point';jsts.geom.Dimension=function(){};jsts.geom.Dimension.P=0;jsts.geom.Dimension.L=1;jsts.geom.Dimension.A=2;jsts.geom.Dimension.FALSE=-1;jsts.geom.Dimension.TRUE=-2;jsts.geom.Dimension.DONTCARE=-3;jsts.geom.Dimension.toDimensionSymbol=function(dimensionValue){switch(dimensionValue){case jsts.geom.Dimension.FALSE:return'F';case jsts.geom.Dimension.TRUE:return'T';case jsts.geom.Dimension.DONTCARE:return'*';case jsts.geom.Dimension.P:return'0';case jsts.geom.Dimension.L:return'1';case jsts.geom.Dimension.A:return'2';}
throw new jsts.IllegalArgumentError('Unknown dimension value: '+
dimensionValue);};jsts.geom.Dimension.toDimensionValue=function(dimensionSymbol){switch(dimensionSymbol.toUpperCase()){case'F':return jsts.geom.Dimension.FALSE;case'T':return jsts.geom.Dimension.TRUE;case'*':return jsts.geom.Dimension.DONTCARE;case'0':return jsts.geom.Dimension.P;case'1':return jsts.geom.Dimension.L;case'2':return jsts.geom.Dimension.A;}
throw new jsts.error.IllegalArgumentError('Unknown dimension symbol: '+
dimensionSymbol);};(function(){var Dimension=jsts.geom.Dimension;jsts.geom.LineString=function(points,factory){this.factory=factory;this.points=points||[];};jsts.geom.LineString.prototype=new jsts.geom.Geometry();jsts.geom.LineString.constructor=jsts.geom.LineString;jsts.geom.LineString.prototype.points=null;jsts.geom.LineString.prototype.getCoordinates=function(){return this.points;};jsts.geom.LineString.prototype.getCoordinateSequence=function(){return this.points;};jsts.geom.LineString.prototype.getCoordinateN=function(n){return this.points[n];};jsts.geom.LineString.prototype.getCoordinate=function(){if(this.isEmpty()){return null;}
return this.getCoordinateN(0);};jsts.geom.LineString.prototype.getDimension=function(){return 1;};jsts.geom.LineString.prototype.getBoundaryDimension=function(){if(this.isClosed()){return Dimension.FALSE;}
return 0;};jsts.geom.LineString.prototype.isEmpty=function(){return this.points.length===0;};jsts.geom.LineString.prototype.getNumPoints=function(){return this.points.length;};jsts.geom.LineString.prototype.getPointN=function(n){return this.getFactory().createPoint(this.points[n]);};jsts.geom.LineString.prototype.getStartPoint=function(){if(this.isEmpty()){return null;}
return this.getPointN(0);};jsts.geom.LineString.prototype.getEndPoint=function(){if(this.isEmpty()){return null;}
return this.getPointN(this.getNumPoints()-1);};jsts.geom.LineString.prototype.isClosed=function(){if(this.isEmpty()){return false;}
return this.getCoordinateN(0).equals2D(this.getCoordinateN(this.points.length-1));};jsts.geom.LineString.prototype.isRing=function(){return this.isClosed()&&this.isSimple();};jsts.geom.LineString.prototype.getGeometryType=function(){return'LineString';};jsts.geom.LineString.prototype.getLength=function(){return jsts.algorithm.CGAlgorithms.computeLength(this.points);};jsts.geom.LineString.prototype.getBoundary=function(){return(new jsts.operation.BoundaryOp(this)).getBoundary();};jsts.geom.LineString.prototype.computeEnvelopeInternal=function(){if(this.isEmpty()){return new jsts.geom.Envelope();}
var env=new jsts.geom.Envelope();this.points.forEach(function(component){env.expandToInclude(component);});return env;};jsts.geom.LineString.prototype.equalsExact=function(other,tolerance){if(!this.isEquivalentClass(other)){return false;}
if(this.points.length!==other.points.length){return false;}
if(this.isEmpty()&&other.isEmpty()){return true;}
return this.points.reduce(function(equal,point,i){return equal&&jsts.geom.Geometry.prototype.equal(point,other.points[i],tolerance);});};jsts.geom.LineString.prototype.isEquivalentClass=function(other){return other instanceof jsts.geom.LineString;};jsts.geom.LineString.prototype.compareToSameClass=function(o){var line=o;var i=0,il=this.points.length;var j=0,jl=line.points.length;while(i<il&&j<jl){var comparison=this.points[i].compareTo(line.points[j]);if(comparison!==0){return comparison;}
i++;j++;}
if(i<il){return 1;}
if(j<jl){return-1;}
return 0;};jsts.geom.LineString.prototype.apply=function(filter){if(filter instanceof jsts.geom.GeometryFilter||filter instanceof jsts.geom.GeometryComponentFilter){filter.filter(this);}else if(filter instanceof jsts.geom.CoordinateFilter){for(var i=0,len=this.points.length;i<len;i++){filter.filter(this.points[i]);}}else if(filter instanceof jsts.geom.CoordinateSequenceFilter){this.apply2.apply(this,arguments);}};jsts.geom.LineString.prototype.apply2=function(filter){if(this.points.length===0)
return;for(var i=0;i<this.points.length;i++){filter.filter(this.points,i);if(filter.isDone())
break;}
if(filter.isGeometryChanged()){}};jsts.geom.LineString.prototype.clone=function(){var points=[];for(var i=0,len=this.points.length;i<len;i++){points.push(this.points[i].clone());}
return this.factory.createLineString(points);};jsts.geom.LineString.prototype.normalize=function(){var i,il,j,ci,cj,len;len=this.points.length;il=parseInt(len/2);for(i=0;i<il;i++){j=len-1-i;ci=this.points[i];cj=this.points[j];if(!ci.equals(cj)){if(ci.compareTo(cj)>0){this.points.reverse();}
return;}}};jsts.geom.LineString.prototype.CLASS_NAME='jsts.geom.LineString';})();(function(){jsts.geom.Polygon=function(shell,holes,factory){this.shell=shell||factory.createLinearRing(null);this.holes=holes||[];this.factory=factory;};jsts.geom.Polygon.prototype=new jsts.geom.Geometry();jsts.geom.Polygon.constructor=jsts.geom.Polygon;jsts.geom.Polygon.prototype.getCoordinate=function(){return this.shell.getCoordinate();};jsts.geom.Polygon.prototype.getCoordinates=function(){if(this.isEmpty()){return[];}
var coordinates=[];var k=-1;var shellCoordinates=this.shell.getCoordinates();for(var x=0;x<shellCoordinates.length;x++){k++;coordinates[k]=shellCoordinates[x];}
for(var i=0;i<this.holes.length;i++){var childCoordinates=this.holes[i].getCoordinates();for(var j=0;j<childCoordinates.length;j++){k++;coordinates[k]=childCoordinates[j];}}
return coordinates;};jsts.geom.Polygon.prototype.getNumPoints=function(){var numPoints=this.shell.getNumPoints();for(var i=0;i<this.holes.length;i++){numPoints+=this.holes[i].getNumPoints();}
return numPoints;};jsts.geom.Polygon.prototype.isEmpty=function(){return this.shell.isEmpty();};jsts.geom.Polygon.prototype.isRectangle=function(){if(this.getNumInteriorRing()!=0)return false;if(this.shell==null)return false;if(this.shell.getNumPoints()!=5)return false;var seq=this.shell.getCoordinateSequence();var env=this.getEnvelopeInternal();for(var i=0;i<5;i++){var x=seq[i].x;if(!(x==env.getMinX()||x==env.getMaxX()))return false;var y=seq[i].y;if(!(y==env.getMinY()||y==env.getMaxY()))return false;}
var prevX=seq[0].x;var prevY=seq[0].y;for(var i=1;i<=4;i++){var x=seq[i].x;var y=seq[i].y;var xChanged=x!=prevX;var yChanged=y!=prevY;if(xChanged==yChanged)
return false;prevX=x;prevY=y;}
return true;};jsts.geom.Polygon.prototype.getExteriorRing=function(){return this.shell;};jsts.geom.Polygon.prototype.getInteriorRingN=function(n){return this.holes[n];};jsts.geom.Polygon.prototype.getNumInteriorRing=function(){return this.holes.length;};jsts.geom.Polygon.prototype.getArea=function(){var area=0.0;area+=Math.abs(jsts.algorithm.CGAlgorithms.signedArea(this.shell.getCoordinateSequence()));for(var i=0;i<this.holes.length;i++){area-=Math.abs(jsts.algorithm.CGAlgorithms.signedArea(this.holes[i].getCoordinateSequence()));}
return area;};jsts.geom.Polygon.prototype.getLength=function(){var len=0.0;len+=this.shell.getLength();for(var i=0;i<this.holes.length;i++){len+=this.holes[i].getLength();}
return len;};jsts.geom.Polygon.prototype.getBoundary=function(){if(this.isEmpty()){return this.getFactory().createMultiLineString(null);}
var rings=[];rings[0]=this.shell.clone();for(var i=0,len=this.holes.length;i<len;i++){rings[i+1]=this.holes[i].clone();}
if(rings.length<=1)
return rings[0];return this.getFactory().createMultiLineString(rings);};jsts.geom.Polygon.prototype.computeEnvelopeInternal=function(){return this.shell.getEnvelopeInternal();};jsts.geom.Polygon.prototype.getDimension=function(){return 2;};jsts.geom.Polygon.prototype.getBoundaryDimension=function(){return 1;};jsts.geom.Polygon.prototype.equalsExact=function(other,tolerance){if(!this.isEquivalentClass(other)){return false;}
if(this.isEmpty()&&other.isEmpty()){return true;}
if(this.isEmpty()!==other.isEmpty()){return false;}
if(!this.shell.equalsExact(other.shell,tolerance)){return false;}
if(this.holes.length!==other.holes.length){return false;}
if(this.holes.length!==other.holes.length){return false;}
for(var i=0;i<this.holes.length;i++){if(!(this.holes[i]).equalsExact(other.holes[i],tolerance)){return false;}}
return true;};jsts.geom.Polygon.prototype.compareToSameClass=function(o){return this.shell.compareToSameClass(o.shell);};jsts.geom.Polygon.prototype.apply=function(filter){if(filter instanceof jsts.geom.GeometryComponentFilter){filter.filter(this);this.shell.apply(filter);for(var i=0,len=this.holes.length;i<len;i++){this.holes[i].apply(filter);}}else if(filter instanceof jsts.geom.GeometryFilter){filter.filter(this);}else if(filter instanceof jsts.geom.CoordinateFilter){this.shell.apply(filter);for(var i=0,len=this.holes.length;i<len;i++){this.holes[i].apply(filter);}}else if(filter instanceof jsts.geom.CoordinateSequenceFilter){this.apply2.apply(this,arguments);}};jsts.geom.Polygon.prototype.apply2=function(filter){this.shell.apply(filter);if(!filter.isDone()){for(var i=0;i<this.holes.length;i++){this.holes[i].apply(filter);if(filter.isDone())
break;}}
if(filter.isGeometryChanged()){}};jsts.geom.Polygon.prototype.clone=function(){var holes=[];for(var i=0,len=this.holes.length;i<len;i++){holes.push(this.holes[i].clone());}
return this.factory.createPolygon(this.shell.clone(),holes);};jsts.geom.Polygon.prototype.normalize=function(){this.normalize2(this.shell,true);for(var i=0,len=this.holes.length;i<len;i++){this.normalize2(this.holes[i],false);}
this.holes.sort();};jsts.geom.Polygon.prototype.normalize2=function(ring,clockwise){if(ring.isEmpty()){return;}
var uniqueCoordinates=ring.points.slice(0,ring.points.length-1);var minCoordinate=jsts.geom.CoordinateArrays.minCoordinate(ring.points);jsts.geom.CoordinateArrays.scroll(uniqueCoordinates,minCoordinate);ring.points=uniqueCoordinates.concat();ring.points[uniqueCoordinates.length]=uniqueCoordinates[0];if(jsts.algorithm.CGAlgorithms.isCCW(ring.points)===clockwise){ring.points.reverse();}};jsts.geom.Polygon.prototype.getGeometryType=function(){return'Polygon';};jsts.geom.Polygon.prototype.CLASS_NAME='jsts.geom.Polygon';})();(function(){var Geometry=jsts.geom.Geometry;var TreeSet=javascript.util.TreeSet;var Arrays=javascript.util.Arrays;jsts.geom.GeometryCollection=function(geometries,factory){this.geometries=geometries||[];this.factory=factory;};jsts.geom.GeometryCollection.prototype=new Geometry();jsts.geom.GeometryCollection.constructor=jsts.geom.GeometryCollection;jsts.geom.GeometryCollection.prototype.isEmpty=function(){for(var i=0,len=this.geometries.length;i<len;i++){var geometry=this.getGeometryN(i);if(!geometry.isEmpty()){return false;}}
return true;};jsts.geom.GeometryCollection.prototype.getArea=function(){var area=0.0;for(var i=0,len=this.geometries.length;i<len;i++){area+=this.getGeometryN(i).getArea();}
return area;};jsts.geom.GeometryCollection.prototype.getLength=function(){var length=0.0;for(var i=0,len=this.geometries.length;i<len;i++){length+=this.getGeometryN(i).getLength();}
return length;};jsts.geom.GeometryCollection.prototype.getCoordinate=function(){if(this.isEmpty())
return null;return this.getGeometryN(0).getCoordinate();};jsts.geom.GeometryCollection.prototype.getCoordinates=function(){var coordinates=[];var k=-1;for(var i=0,len=this.geometries.length;i<len;i++){var geometry=this.getGeometryN(i);var childCoordinates=geometry.getCoordinates();for(var j=0;j<childCoordinates.length;j++){k++;coordinates[k]=childCoordinates[j];}}
return coordinates;};jsts.geom.GeometryCollection.prototype.getNumGeometries=function(){return this.geometries.length;};jsts.geom.GeometryCollection.prototype.getGeometryN=function(n){var geometry=this.geometries[n];if(geometry instanceof jsts.geom.Coordinate){geometry=new jsts.geom.Point(geometry);}
return geometry;};jsts.geom.GeometryCollection.prototype.getNumPoints=function(n){var numPoints=0;for(var i=0;i<this.geometries.length;i++){numPoints+=this.geometries[i].getNumPoints();}
return numPoints;}
jsts.geom.GeometryCollection.prototype.equalsExact=function(other,tolerance){if(!this.isEquivalentClass(other)){return false;}
if(this.geometries.length!==other.geometries.length){return false;}
for(var i=0,len=this.geometries.length;i<len;i++){var geometry=this.getGeometryN(i);if(!geometry.equalsExact(other.getGeometryN(i),tolerance)){return false;}}
return true;};jsts.geom.GeometryCollection.prototype.clone=function(){var geometries=[];for(var i=0,len=this.geometries.length;i<len;i++){geometries.push(this.geometries[i].clone());}
return this.factory.createGeometryCollection(geometries);};jsts.geom.GeometryCollection.prototype.normalize=function(){for(var i=0,len=this.geometries.length;i<len;i++){this.getGeometryN(i).normalize();}
this.geometries.sort();};jsts.geom.GeometryCollection.prototype.compareToSameClass=function(o){var theseElements=new TreeSet(Arrays.asList(this.geometries));var otherElements=new TreeSet(Arrays.asList(o.geometries));return this.compare(theseElements,otherElements);};jsts.geom.GeometryCollection.prototype.apply=function(filter){if(filter instanceof jsts.geom.GeometryFilter||filter instanceof jsts.geom.GeometryComponentFilter){filter.filter(this);for(var i=0,len=this.geometries.length;i<len;i++){this.getGeometryN(i).apply(filter);}}else if(filter instanceof jsts.geom.CoordinateFilter){for(var i=0,len=this.geometries.length;i<len;i++){this.getGeometryN(i).apply(filter);}}else if(filter instanceof jsts.geom.CoordinateSequenceFilter){this.apply2.apply(this,arguments);}};jsts.geom.GeometryCollection.prototype.apply2=function(filter){if(this.geometries.length==0)
return;for(var i=0;i<this.geometries.length;i++){this.geometries[i].apply(filter);if(filter.isDone()){break;}}
if(filter.isGeometryChanged()){}};jsts.geom.GeometryCollection.prototype.getDimension=function(){var dimension=jsts.geom.Dimension.FALSE;for(var i=0,len=this.geometries.length;i<len;i++){var geometry=this.getGeometryN(i);dimension=Math.max(dimension,geometry.getDimension());}
return dimension;};jsts.geom.GeometryCollection.prototype.computeEnvelopeInternal=function(){var envelope=new jsts.geom.Envelope();for(var i=0,len=this.geometries.length;i<len;i++){var geometry=this.getGeometryN(i);envelope.expandToInclude(geometry.getEnvelopeInternal());}
return envelope;};jsts.geom.GeometryCollection.prototype.CLASS_NAME='jsts.geom.GeometryCollection';})();jsts.algorithm.Centroid=function(geometry){this.areaBasePt=null;this.triangleCent3=new jsts.geom.Coordinate();this.areasum2=0;this.cg3=new jsts.geom.Coordinate();this.lineCentSum=new jsts.geom.Coordinate();this.totalLength=0;this.ptCount=0;this.ptCentSum=new jsts.geom.Coordinate();this.add(geometry);};jsts.algorithm.Centroid.getCentroid=function(geometry){var cent=new jsts.algorithm.Centroid(geometry);return cent.getCentroid();};jsts.algorithm.Centroid.centroid3=function(p1,p2,p3,c){c.x=p1.x+p2.x+p3.x;c.y=p1.y+p2.y+p3.y;};jsts.algorithm.Centroid.area2=function(p1,p2,p3){return(p2.x-p1.x)*(p3.y-p1.y)-(p3.x-p1.x)*(p2.y-p1.y);};jsts.algorithm.Centroid.prototype.add=function(geom){if(geom.isEmpty()){return;}
if(geom instanceof jsts.geom.Point){this.addPoint(geom.getCoordinate());}else if(geom instanceof jsts.geom.LineString){this.addLineSegments(geom.getCoordinates());}else if(geom instanceof jsts.geom.Polygon){this.addPolygon(geom);}else if(geom instanceof jsts.geom.GeometryCollection){for(var i=0;i<geom.getNumGeometries();i++){this.add(geom.getGeometryN(i));}}};jsts.algorithm.Centroid.prototype.getCentroid=function(){var cent=new jsts.geom.Coordinate();if(Math.abs(this.areasum2)>0){cent.x=this.cg3.x/3/this.areasum2;cent.y=this.cg3.y/3/this.areasum2;}else if(this.totalLength>0){cent.x=this.lineCentSum.x/this.totalLength;cent.y=this.lineCentSum.y/this.totalLength;}else if(this.ptCount>0){cent.x=this.ptCentSum.x/this.ptCount;cent.y=this.ptCentSum.y/this.ptCount;}else{return null;}
return cent;};jsts.algorithm.Centroid.prototype.setBasePoint=function(basePt){if(this.areaBasePt===null){this.areaBasePt=basePt;}};jsts.algorithm.Centroid.prototype.addPolygon=function(poly){this.addShell(poly.getExteriorRing().getCoordinates());for(var i=0;i<poly.getNumInteriorRing();i++){this.addHole(poly.getInteriorRingN(i).getCoordinates());}};jsts.algorithm.Centroid.prototype.addShell=function(pts){if(pts.length>0){this.setBasePoint(pts[0]);}
var isPositiveArea=!jsts.algorithm.CGAlgorithms.isCCW(pts);for(var i=0;i<pts.length-1;i++){this.addTriangle(this.areaBasePt,pts[i],pts[i+1],isPositiveArea);}
this.addLineSegments(pts);};jsts.algorithm.Centroid.prototype.addHole=function(pts){var isPositiveArea=jsts.algorithm.CGAlgorithms.isCCW(pts);for(var i=0;i<pts.length-1;i++){this.addTriangle(this.areaBasePt,pts[i],pts[i+1],isPositiveArea);}
this.addLineSegments(pts);};jsts.algorithm.Centroid.prototype.addTriangle=function(p0,p1,p2,isPositiveArea){var sign=(isPositiveArea)?1:-1;jsts.algorithm.Centroid.centroid3(p0,p1,p2,this.triangleCent3);var area2=jsts.algorithm.Centroid.area2(p0,p1,p2);this.cg3.x+=sign*area2*this.triangleCent3.x;this.cg3.y+=sign*area2*this.triangleCent3.y;this.areasum2+=sign*area2;};jsts.algorithm.Centroid.prototype.addLineSegments=function(pts){var lineLen=0;for(var i=0;i<pts.length-1;i++){var segmentLen=pts[i].distance(pts[i+1]);if(segmentLen===0){continue;}
lineLen+=segmentLen;var midx=(pts[i].x+pts[i+1].x)/2;this.lineCentSum.x+=segmentLen*midx;var midy=(pts[i].y+pts[i+1].y)/2;this.lineCentSum.y+=segmentLen*midy;}
this.totalLength+=lineLen;if(lineLen===0&&pts.length>0){this.addPoint(pts[0]);}};jsts.algorithm.Centroid.prototype.addPoint=function(pt){this.ptCount+=1;this.ptCentSum.x+=pt.x;this.ptCentSum.y+=pt.y;};(function(){var EdgeRing=function(factory){this.deList=new javascript.util.ArrayList();this.factory=factory;};EdgeRing.findEdgeRingContaining=function(testEr,shellList){var testRing=testEr.getRing();var testEnv=testRing.getEnvelopeInternal();var testPt=testRing.getCoordinateN(0);var minShell=null;var minEnv=null;for(var it=shellList.iterator();it.hasNext();){var tryShell=it.next();var tryRing=tryShell.getRing();var tryEnv=tryRing.getEnvelopeInternal();if(minShell!=null)
minEnv=minShell.getRing().getEnvelopeInternal();var isContained=false;if(tryEnv.equals(testEnv))
continue;testPt=jsts.geom.CoordinateArrays.ptNotInList(testRing.getCoordinates(),tryRing.getCoordinates());if(tryEnv.contains(testEnv)&&jsts.algorithm.CGAlgorithms.isPointInRing(testPt,tryRing.getCoordinates()))
isContained=true;if(isContained){if(minShell==null||minEnv.contains(tryEnv)){minShell=tryShell;}}}
return minShell;};EdgeRing.ptNotInList=function(testPts,pts){for(var i=0;i<testPts.length;i++){var testPt=testPts[i];if(!isInList(testPt,pts))
return testPt;}
return null;};EdgeRing.isInList=function(pt,pts){for(var i=0;i<pts.length;i++){if(pt.equals(pts[i]))
return true;}
return false;}
EdgeRing.prototype.factory=null;EdgeRing.prototype.deList=null;EdgeRing.prototype.ring=null;EdgeRing.prototype.ringPts=null;EdgeRing.prototype.holes=null;EdgeRing.prototype.add=function(de){this.deList.add(de);};EdgeRing.prototype.isHole=function(){var ring=this.getRing();return jsts.algorithm.CGAlgorithms.isCCW(ring.getCoordinates());};EdgeRing.prototype.addHole=function(hole){if(this.holes==null)
this.holes=new javascript.util.ArrayList();this.holes.add(hole);};EdgeRing.prototype.getPolygon=function(){var holeLR=null;if(this.holes!=null){holeLR=[];for(var i=0;i<this.holes.size();i++){holeLR[i]=this.holes.get(i);}}
var poly=this.factory.createPolygon(this.ring,holeLR);return poly;};EdgeRing.prototype.isValid=function(){this.getCoordinates();if(this.ringPts.length<=3)
return false;this.getRing();return this.ring.isValid();};EdgeRing.prototype.getCoordinates=function(){if(this.ringPts==null){var coordList=new jsts.geom.CoordinateList();for(var i=this.deList.iterator();i.hasNext();){var de=i.next();var edge=de.getEdge();EdgeRing.addEdge(edge.getLine().getCoordinates(),de.getEdgeDirection(),coordList);}
this.ringPts=coordList.toCoordinateArray();}
return this.ringPts;};EdgeRing.prototype.getLineString=function(){this.getCoordinates();return this.factory.createLineString(this.ringPts);};EdgeRing.prototype.getRing=function(){if(this.ring!=null)
return this.ring;this.getCoordinates();if(this.ringPts.length<3)
console.log(this.ringPts);try{this.ring=this.factory.createLinearRing(this.ringPts);}catch(ex){console.log(this.ringPts);}
return this.ring;};EdgeRing.addEdge=function(coords,isForward,coordList){if(isForward){for(var i=0;i<coords.length;i++){coordList.add(coords[i],false);}}else{for(var i=coords.length-1;i>=0;i--){coordList.add(coords[i],false);}}};jsts.operation.polygonize.EdgeRing=EdgeRing;})();(function(){var GraphComponent=function(){};GraphComponent.setVisited=function(i,visited){while(i.hasNext()){var comp=i.next();comp.setVisited(visited);}};GraphComponent.setMarked=function(i,marked){while(i.hasNext()){var comp=i.next();comp.setMarked(marked);}};GraphComponent.getComponentWithVisitedState=function(i,visitedState){while(i.hasNext()){var comp=i.next();if(comp.isVisited()==visitedState)
return comp;}
return null;};GraphComponent.prototype._isMarked=false;GraphComponent.prototype._isVisited=false;GraphComponent.prototype.data;GraphComponent.prototype.isVisited=function(){return this._isVisited;};GraphComponent.prototype.setVisited=function(isVisited){this._isVisited=isVisited;};GraphComponent.prototype.isMarked=function(){return this._isMarked;};GraphComponent.prototype.setMarked=function(isMarked){this._isMarked=isMarked;};GraphComponent.prototype.setContext=function(data){this.data=data;};GraphComponent.prototype.getContext=function(){return data;};GraphComponent.prototype.setData=function(data){this.data=data;};GraphComponent.prototype.getData=function(){return data;};GraphComponent.prototype.isRemoved=function(){throw new jsts.error.AbstractMethodInvocationError();};jsts.planargraph.GraphComponent=GraphComponent;})();(function(){var GraphComponent=jsts.planargraph.GraphComponent;var Edge=function(de0,de1){if(de0===undefined){return;}
this.setDirectedEdges(de0,de1);};Edge.prototype=new GraphComponent();Edge.prototype.dirEdge=null;Edge.prototype.setDirectedEdges=function(de0,de1){this.dirEdge=[de0,de1];de0.setEdge(this);de1.setEdge(this);de0.setSym(de1);de1.setSym(de0);de0.getFromNode().addOutEdge(de0);de1.getFromNode().addOutEdge(de1);};Edge.prototype.getDirEdge=function(i){if(i instanceof jsts.planargraph.Node){this.getDirEdge2(i);}
return this.dirEdge[i];};Edge.prototype.getDirEdge2=function(fromNode){if(this.dirEdge[0].getFromNode()==fromNode)
return this.dirEdge[0];if(this.dirEdge[1].getFromNode()==fromNode)
return this.dirEdge[1];return null;};Edge.prototype.getOppositeNode=function(node){if(this.dirEdge[0].getFromNode()==node)
return this.dirEdge[0].getToNode();if(this.dirEdge[1].getFromNode()==node)
return this.dirEdge[1].getToNode();return null;};Edge.prototype.remove=function(){this.dirEdge=null;};Edge.prototype.isRemoved=function(){return dirEdge==null;};jsts.planargraph.Edge=Edge;})();jsts.operation.polygonize.PolygonizeEdge=function(line){this.line=line;};jsts.operation.polygonize.PolygonizeEdge.prototype=new jsts.planargraph.Edge();jsts.operation.polygonize.PolygonizeEdge.prototype.line=null;jsts.operation.polygonize.PolygonizeEdge.prototype.getLine=function(){return this.line;};(function(){var ArrayList=javascript.util.ArrayList;var GraphComponent=jsts.planargraph.GraphComponent;var DirectedEdge=function(from,to,directionPt,edgeDirection){if(from===undefined){return;}
this.from=from;this.to=to;this.edgeDirection=edgeDirection;this.p0=from.getCoordinate();this.p1=directionPt;var dx=this.p1.x-this.p0.x;var dy=this.p1.y-this.p0.y;this.quadrant=jsts.geomgraph.Quadrant.quadrant(dx,dy);this.angle=Math.atan2(dy,dx);};DirectedEdge.prototype=new GraphComponent();DirectedEdge.toEdges=function(dirEdges){var edges=new ArrayList();for(var i=dirEdges.iterator();i.hasNext();){edges.add((i.next()).parentEdge);}
return edges;};DirectedEdge.prototype.parentEdge=null;DirectedEdge.prototype.from=null;DirectedEdge.prototype.to=null;DirectedEdge.prototype.p0=null;DirectedEdge.prototype.p1=null;DirectedEdge.prototype.sym=null;DirectedEdge.prototype.edgeDirection=null;DirectedEdge.prototype.quadrant=null;DirectedEdge.prototype.angle=null;DirectedEdge.prototype.getEdge=function(){return this.parentEdge;};DirectedEdge.prototype.setEdge=function(parentEdge){this.parentEdge=parentEdge;};DirectedEdge.prototype.getQuadrant=function(){return this.quadrant;};DirectedEdge.prototype.getDirectionPt=function(){return this.p1;};DirectedEdge.prototype.getEdgeDirection=function(){return this.edgeDirection;};DirectedEdge.prototype.getFromNode=function(){return this.from;};DirectedEdge.prototype.getToNode=function(){return this.to;};DirectedEdge.prototype.getCoordinate=function(){return this.from.getCoordinate();};DirectedEdge.prototype.getAngle=function(){return this.angle;};DirectedEdge.prototype.getSym=function(){return this.sym;};DirectedEdge.prototype.setSym=function(sym){this.sym=sym;};DirectedEdge.prototype.remove=function(){this.sym=null;this.parentEdge=null;};DirectedEdge.prototype.isRemoved=function(){return this.parentEdge==null;};DirectedEdge.prototype.compareTo=function(obj){var de=obj;return this.compareDirection(de);};DirectedEdge.prototype.compareDirection=function(e){if(this.quadrant>e.quadrant)
return 1;if(this.quadrant<e.quadrant)
return-1;return jsts.algorithm.CGAlgorithms.computeOrientation(e.p0,e.p1,this.p1);};jsts.planargraph.DirectedEdge=DirectedEdge;})();(function(){var DirectedEdge=jsts.planargraph.DirectedEdge;var PolygonizeDirectedEdge=function(from,to,directionPt,edgeDirection){DirectedEdge.apply(this,arguments);};PolygonizeDirectedEdge.prototype=new DirectedEdge();PolygonizeDirectedEdge.prototype.edgeRing=null;PolygonizeDirectedEdge.prototype.next=null;PolygonizeDirectedEdge.prototype.label=-1;PolygonizeDirectedEdge.prototype.getLabel=function(){return this.label;};PolygonizeDirectedEdge.prototype.setLabel=function(label){this.label=label;};PolygonizeDirectedEdge.prototype.getNext=function(){return this.next;};PolygonizeDirectedEdge.prototype.setNext=function(next){this.next=next;};PolygonizeDirectedEdge.prototype.isInRing=function(){return this.edgeRing!=null;};PolygonizeDirectedEdge.prototype.setRing=function(edgeRing){this.edgeRing=edgeRing;};jsts.operation.polygonize.PolygonizeDirectedEdge=PolygonizeDirectedEdge;})();(function(){var ArrayList=javascript.util.ArrayList;var DirectedEdgeStar=function(){this.outEdges=new ArrayList();};DirectedEdgeStar.prototype.outEdges=null;DirectedEdgeStar.prototype.sorted=false;DirectedEdgeStar.prototype.add=function(de){this.outEdges.add(de);this.sorted=false;};DirectedEdgeStar.prototype.remove=function(de){this.outEdges.remove(de);};DirectedEdgeStar.prototype.iterator=function(){this.sortEdges();return this.outEdges.iterator();};DirectedEdgeStar.prototype.getDegree=function(){return this.outEdges.size();};DirectedEdgeStar.prototype.getCoordinate=function(){var it=iterator();if(!it.hasNext())
return null;var e=it.next();return e.getCoordinate();};DirectedEdgeStar.prototype.getEdges=function(){this.sortEdges();return this.outEdges;};DirectedEdgeStar.prototype.sortEdges=function(){if(!this.sorted){var array=this.outEdges.toArray();array.sort(function(a,b){return a.compareTo(b);});this.outEdges=javascript.util.Arrays.asList(array);this.sorted=true;}};DirectedEdgeStar.prototype.getIndex=function(edge){if(edge instanceof jsts.planargraph.DirectedEdge){return this.getIndex2(edge);}else if(typeof(edge)==='number'){return this.getIndex3(edge);}
this.sortEdges();for(var i=0;i<this.outEdges.size();i++){var de=this.outEdges.get(i);if(de.getEdge()==edge)
return i;}
return-1;};DirectedEdgeStar.prototype.getIndex2=function(dirEdge){this.sortEdges();for(var i=0;i<this.outEdges.size();i++){var de=this.outEdges.get(i);if(de==dirEdge)
return i;}
return-1;};DirectedEdgeStar.prototype.getIndex3=function(i){var modi=toInt(i%this.outEdges.size());if(modi<0)
modi+=this.outEdges.size();return modi;};DirectedEdgeStar.prototype.getNextEdge=function(dirEdge){var i=this.getIndex(dirEdge);return this.outEdges.get(getIndex(i+1));};DirectedEdgeStar.prototype.getNextCWEdge=function(dirEdge){var i=this.getIndex(dirEdge);return this.outEdges.get(getIndex(i-1));};jsts.planargraph.DirectedEdgeStar=DirectedEdgeStar;})();(function(){var GraphComponent=jsts.planargraph.GraphComponent;var DirectedEdgeStar=jsts.planargraph.DirectedEdgeStar;var Node=function(pt,deStar){this.pt=pt;this.deStar=deStar||new DirectedEdgeStar();};Node.prototype=new GraphComponent();Node.getEdgesBetween=function(node0,node1){var edges0=DirectedEdge.toEdges(node0.getOutEdges().getEdges());var commonEdges=new javascript.util.HashSet(edges0);var edges1=DirectedEdge.toEdges(node1.getOutEdges().getEdges());commonEdges.retainAll(edges1);return commonEdges;};Node.prototype.pt=null;Node.prototype.deStar=null;Node.prototype.getCoordinate=function(){return this.pt;};Node.prototype.addOutEdge=function(de){this.deStar.add(de);};Node.prototype.getOutEdges=function(){return this.deStar;};Node.prototype.getDegree=function(){return this.deStar.getDegree();};Node.prototype.getIndex=function(edge){return this.deStar.getIndex(edge);};Node.prototype.remove=function(de){if(de===undefined){return this.remove2();}
this.deStar.remove(de);};Node.prototype.remove2=function(){this.pt=null;};Node.prototype.isRemoved=function(){return this.pt==null;};jsts.planargraph.Node=Node;})();(function(){var NodeMap=function(){this.nodeMap=new javascript.util.TreeMap();};NodeMap.prototype.nodeMap=null;NodeMap.prototype.add=function(n){this.nodeMap.put(n.getCoordinate(),n);return n;};NodeMap.prototype.remove=function(pt){return this.nodeMap.remove(pt);};NodeMap.prototype.find=function(coord){return this.nodeMap.get(coord);};NodeMap.prototype.iterator=function(){return this.nodeMap.values().iterator();};NodeMap.prototype.values=function(){return this.nodeMap.values();};jsts.planargraph.NodeMap=NodeMap;})();(function(){var ArrayList=javascript.util.ArrayList;var PlanarGraph=function(){this.edges=new javascript.util.HashSet();this.dirEdges=new javascript.util.HashSet();this.nodeMap=new jsts.planargraph.NodeMap();};PlanarGraph.prototype.edges=null;PlanarGraph.prototype.dirEdges=null;PlanarGraph.prototype.nodeMap=null;PlanarGraph.prototype.findNode=function(pt){return this.nodeMap.find(pt);};PlanarGraph.prototype.add=function(node){if(node instanceof jsts.planargraph.Edge){return this.add2(node);}else if(node instanceof jsts.planargraph.DirectedEdge){return this.add3(node);}
this.nodeMap.add(node);};PlanarGraph.prototype.add2=function(edge){this.edges.add(edge);this.add(edge.getDirEdge(0));this.add(edge.getDirEdge(1));};PlanarGraph.prototype.add3=function(dirEdge){this.dirEdges.add(dirEdge);};PlanarGraph.prototype.nodeIterator=function(){return this.nodeMap.iterator();};PlanarGraph.prototype.contains=function(e){if(e instanceof jsts.planargraph.DirectedEdge){return this.contains2(e);}
return this.edges.contains(e);};PlanarGraph.prototype.contains2=function(de){return this.dirEdges.contains(de);};PlanarGraph.prototype.getNodes=function(){return this.nodeMap.values();};PlanarGraph.prototype.dirEdgeIterator=function(){return this.dirEdges.iterator();};PlanarGraph.prototype.edgeIterator=function(){return this.edges.iterator();};PlanarGraph.prototype.getEdges=function(){return this.edges;};PlanarGraph.prototype.remove=function(edge){if(edge instanceof jsts.planargraph.DirectedEdge){return this.remove2(edge);}
this.remove(edge.getDirEdge(0));this.remove(edge.getDirEdge(1));this.edges.remove(edge);this.edge.remove();};PlanarGraph.prototype.remove2=function(de){if(de instanceof jsts.planargraph.Node){return this.remove3(de);}
var sym=de.getSym();if(sym!=null)
sym.setSym(null);de.getFromNode().remove(de);de.remove();this.dirEdges.remove(de);};PlanarGraph.prototype.remove3=function(node){var outEdges=node.getOutEdges().getEdges();for(var i=outEdges.iterator();i.hasNext();){var de=i.next();var sym=de.getSym();if(sym!=null)
this.remove(sym);this.dirEdges.remove(de);var edge=de.getEdge();if(edge!=null){this.edges.remove(edge);}}
this.nodeMap.remove(node.getCoordinate());node.remove();};PlanarGraph.prototype.findNodesOfDegree=function(degree){var nodesFound=new ArrayList();for(var i=this.nodeIterator();i.hasNext();){var node=i.next();if(node.getDegree()==degree)
nodesFound.add(node);}
return nodesFound;};jsts.planargraph.PlanarGraph=PlanarGraph;})();(function(){var ArrayList=javascript.util.ArrayList;var Stack=javascript.util.Stack;var HashSet=javascript.util.HashSet;var Assert=jsts.util.Assert;var EdgeRing=jsts.operation.polygonize.EdgeRing;var PolygonizeEdge=jsts.operation.polygonize.PolygonizeEdge;var PolygonizeDirectedEdge=jsts.operation.polygonize.PolygonizeDirectedEdge;var PlanarGraph=jsts.planargraph.PlanarGraph;var Node=jsts.planargraph.Node;var PolygonizeGraph=function(factory){PlanarGraph.apply(this);this.factory=factory;};PolygonizeGraph.prototype=new PlanarGraph();PolygonizeGraph.getDegreeNonDeleted=function(node){var edges=node.getOutEdges().getEdges();var degree=0;for(var i=edges.iterator();i.hasNext();){var de=i.next();if(!de.isMarked())
degree++;}
return degree;};PolygonizeGraph.getDegree=function(node,label){var edges=node.getOutEdges().getEdges();var degree=0;for(var i=edges.iterator();i.hasNext();){var de=i.next();if(de.getLabel()==label)
degree++;}
return degree;};PolygonizeGraph.deleteAllEdges=function(node){var edges=node.getOutEdges().getEdges();for(var i=edges.iterator();i.hasNext();){var de=i.next();de.setMarked(true);var sym=de.getSym();if(sym!=null)
sym.setMarked(true);}};PolygonizeGraph.prototype.factory=null;PolygonizeGraph.prototype.addEdge=function(line){if(line.isEmpty()){return;}
var linePts=jsts.geom.CoordinateArrays.removeRepeatedPoints(line.getCoordinates());if(linePts.length<2){return;}
var startPt=linePts[0];var endPt=linePts[linePts.length-1];var nStart=this.getNode(startPt);var nEnd=this.getNode(endPt);var de0=new PolygonizeDirectedEdge(nStart,nEnd,linePts[1],true);var de1=new PolygonizeDirectedEdge(nEnd,nStart,linePts[linePts.length-2],false);var edge=new PolygonizeEdge(line);edge.setDirectedEdges(de0,de1);this.add(edge);};PolygonizeGraph.prototype.getNode=function(pt){var node=this.findNode(pt);if(node==null){node=new Node(pt);this.add(node);}
return node;};PolygonizeGraph.prototype.computeNextCWEdges=function(){for(var iNode=this.nodeIterator();iNode.hasNext();){var node=iNode.next();PolygonizeGraph.computeNextCWEdges(node);}};PolygonizeGraph.prototype.convertMaximalToMinimalEdgeRings=function(ringEdges){for(var i=ringEdges.iterator();i.hasNext();){var de=i.next();var label=de.getLabel();var intNodes=PolygonizeGraph.findIntersectionNodes(de,label);if(intNodes==null)
continue;for(var iNode=intNodes.iterator();iNode.hasNext();){var node=iNode.next();PolygonizeGraph.computeNextCCWEdges(node,label);}}};PolygonizeGraph.findIntersectionNodes=function(startDE,label){var de=startDE;var intNodes=null;do{var node=de.getFromNode();if(PolygonizeGraph.getDegree(node,label)>1){if(intNodes==null)
intNodes=new ArrayList();intNodes.add(node);}
de=de.getNext();Assert.isTrue(de!=null,'found null DE in ring');Assert.isTrue(de==startDE||!de.isInRing(),'found DE already in ring');}while(de!=startDE);return intNodes;};PolygonizeGraph.prototype.getEdgeRings=function(){this.computeNextCWEdges();PolygonizeGraph.label(this.dirEdges,-1);var maximalRings=PolygonizeGraph.findLabeledEdgeRings(this.dirEdges);this.convertMaximalToMinimalEdgeRings(maximalRings);var edgeRingList=new ArrayList();for(var i=this.dirEdges.iterator();i.hasNext();){var de=i.next();if(de.isMarked())
continue;if(de.isInRing())
continue;var er=this.findEdgeRing(de);edgeRingList.add(er);}
return edgeRingList;};PolygonizeGraph.findLabeledEdgeRings=function(dirEdges){var edgeRingStarts=new ArrayList();var currLabel=1;for(var i=dirEdges.iterator();i.hasNext();){var de=i.next();if(de.isMarked())
continue;if(de.getLabel()>=0)
continue;edgeRingStarts.add(de);var edges=PolygonizeGraph.findDirEdgesInRing(de);PolygonizeGraph.label(edges,currLabel);currLabel++;}
return edgeRingStarts;};PolygonizeGraph.prototype.deleteCutEdges=function(){this.computeNextCWEdges();PolygonizeGraph.findLabeledEdgeRings(this.dirEdges);var cutLines=new ArrayList();for(var i=this.dirEdges.iterator();i.hasNext();){var de=i.next();if(de.isMarked())
continue;var sym=de.getSym();if(de.getLabel()==sym.getLabel()){de.setMarked(true);sym.setMarked(true);var e=de.getEdge();cutLines.add(e.getLine());}}
return cutLines;};PolygonizeGraph.label=function(dirEdges,label){for(var i=dirEdges.iterator();i.hasNext();){var de=i.next();de.setLabel(label);}};PolygonizeGraph.computeNextCWEdges=function(node){var deStar=node.getOutEdges();var startDE=null;var prevDE=null;for(var i=deStar.getEdges().iterator();i.hasNext();){var outDE=i.next();if(outDE.isMarked())
continue;if(startDE==null)
startDE=outDE;if(prevDE!=null){var sym=prevDE.getSym();sym.setNext(outDE);}
prevDE=outDE;}
if(prevDE!=null){var sym=prevDE.getSym();sym.setNext(startDE);}};PolygonizeGraph.computeNextCCWEdges=function(node,label){var deStar=node.getOutEdges();var firstOutDE=null;var prevInDE=null;var edges=deStar.getEdges();for(var i=edges.size()-1;i>=0;i--){var de=edges.get(i);var sym=de.getSym();var outDE=null;if(de.getLabel()==label)
outDE=de;var inDE=null;if(sym.getLabel()==label)
inDE=sym;if(outDE==null&&inDE==null)
continue;if(inDE!=null){prevInDE=inDE;}
if(outDE!=null){if(prevInDE!=null){prevInDE.setNext(outDE);prevInDE=null;}
if(firstOutDE==null)
firstOutDE=outDE;}}
if(prevInDE!=null){Assert.isTrue(firstOutDE!=null);prevInDE.setNext(firstOutDE);}};PolygonizeGraph.findDirEdgesInRing=function(startDE){var de=startDE;var edges=new ArrayList();do{edges.add(de);de=de.getNext();Assert.isTrue(de!=null,'found null DE in ring');Assert.isTrue(de==startDE||!de.isInRing(),'found DE already in ring');}while(de!=startDE);return edges;};PolygonizeGraph.prototype.findEdgeRing=function(startDE){var de=startDE;var er=new EdgeRing(this.factory);do{er.add(de);de.setRing(er);de=de.getNext();Assert.isTrue(de!=null,'found null DE in ring');Assert.isTrue(de==startDE||!de.isInRing(),'found DE already in ring');}while(de!=startDE);return er;};PolygonizeGraph.prototype.deleteDangles=function(){var nodesToRemove=this.findNodesOfDegree(1);var dangleLines=new HashSet();var nodeStack=new Stack();for(var i=nodesToRemove.iterator();i.hasNext();){nodeStack.push(i.next());}
while(!nodeStack.isEmpty()){var node=nodeStack.pop();PolygonizeGraph.deleteAllEdges(node);var nodeOutEdges=node.getOutEdges().getEdges();for(var i=nodeOutEdges.iterator();i.hasNext();){var de=i.next();de.setMarked(true);var sym=de.getSym();if(sym!=null)
sym.setMarked(true);var e=de.getEdge();dangleLines.add(e.getLine());var toNode=de.getToNode();if(PolygonizeGraph.getDegreeNonDeleted(toNode)==1)
nodeStack.push(toNode);}}
return dangleLines;};PolygonizeGraph.prototype.computeDepthParity=function(){while(true){var de=null;if(de==null)
return;this.computeDepthParity(de);}};PolygonizeGraph.prototype.computeDepthParity=function(de){};jsts.operation.polygonize.PolygonizeGraph=PolygonizeGraph;})();jsts.index.strtree.Interval=function(){var other;if(arguments.length===1){other=arguments[0];return jsts.index.strtree.Interval(other.min,other.max);}else if(arguments.length===2){jsts.util.Assert.isTrue(this.min<=this.max);this.min=arguments[0];this.max=arguments[1];}};jsts.index.strtree.Interval.prototype.min=null;jsts.index.strtree.Interval.prototype.max=null;jsts.index.strtree.Interval.prototype.getCentre=function(){return(this.min+this.max)/2;};jsts.index.strtree.Interval.prototype.expandToInclude=function(other){this.max=Math.max(this.max,other.max);this.min=Math.min(this.min,other.min);return this;};jsts.index.strtree.Interval.prototype.intersects=function(other){return!(other.min>this.max||other.max<this.min);};jsts.index.strtree.Interval.prototype.equals=function(o){if(!(o instanceof jsts.index.strtree.Interval)){return false;}
other=o;return this.min===other.min&&this.max===other.max;};jsts.geom.GeometryFactory=function(precisionModel){this.precisionModel=precisionModel||new jsts.geom.PrecisionModel();};jsts.geom.GeometryFactory.prototype.precisionModel=null;jsts.geom.GeometryFactory.prototype.getPrecisionModel=function(){return this.precisionModel;};jsts.geom.GeometryFactory.prototype.createPoint=function(coordinate){var point=new jsts.geom.Point(coordinate,this);return point;};jsts.geom.GeometryFactory.prototype.createLineString=function(coordinates){var lineString=new jsts.geom.LineString(coordinates,this);return lineString;};jsts.geom.GeometryFactory.prototype.createLinearRing=function(coordinates){var linearRing=new jsts.geom.LinearRing(coordinates,this);return linearRing;};jsts.geom.GeometryFactory.prototype.createPolygon=function(shell,holes){var polygon=new jsts.geom.Polygon(shell,holes,this);return polygon;};jsts.geom.GeometryFactory.prototype.createMultiPoint=function(points){if(points&&points[0]instanceof jsts.geom.Coordinate){var converted=[];var i;for(i=0;i<points.length;i++){converted.push(this.createPoint(points[i]));}
points=converted;}
return new jsts.geom.MultiPoint(points,this);};jsts.geom.GeometryFactory.prototype.createMultiLineString=function(lineStrings){return new jsts.geom.MultiLineString(lineStrings,this);};jsts.geom.GeometryFactory.prototype.createMultiPolygon=function(polygons){return new jsts.geom.MultiPolygon(polygons,this);};jsts.geom.GeometryFactory.prototype.buildGeometry=function(geomList){var geomClass=null;var isHeterogeneous=false;var hasGeometryCollection=false;for(var i=geomList.iterator();i.hasNext();){var geom=i.next();var partClass=geom.CLASS_NAME;if(geomClass===null){geomClass=partClass;}
if(!(partClass===geomClass)){isHeterogeneous=true;}
if(geom.isGeometryCollectionBase())
hasGeometryCollection=true;}
if(geomClass===null){return this.createGeometryCollection(null);}
if(isHeterogeneous||hasGeometryCollection){return this.createGeometryCollection(geomList.toArray());}
var geom0=geomList.get(0);var isCollection=geomList.size()>1;if(isCollection){if(geom0 instanceof jsts.geom.Polygon){return this.createMultiPolygon(geomList.toArray());}else if(geom0 instanceof jsts.geom.LineString){return this.createMultiLineString(geomList.toArray());}else if(geom0 instanceof jsts.geom.Point){return this.createMultiPoint(geomList.toArray());}
jsts.util.Assert.shouldNeverReachHere('Unhandled class: '+geom0);}
return geom0;};jsts.geom.GeometryFactory.prototype.createGeometryCollection=function(geometries){return new jsts.geom.GeometryCollection(geometries,this);};jsts.geom.GeometryFactory.prototype.toGeometry=function(envelope){if(envelope.isNull()){return this.createPoint(null);}
if(envelope.getMinX()===envelope.getMaxX()&&envelope.getMinY()===envelope.getMaxY()){return this.createPoint(new jsts.geom.Coordinate(envelope.getMinX(),envelope.getMinY()));}
if(envelope.getMinX()===envelope.getMaxX()||envelope.getMinY()===envelope.getMaxY()){return this.createLineString([new jsts.geom.Coordinate(envelope.getMinX(),envelope.getMinY()),new jsts.geom.Coordinate(envelope.getMaxX(),envelope.getMaxY())]);}
return this.createPolygon(this.createLinearRing([new jsts.geom.Coordinate(envelope.getMinX(),envelope.getMinY()),new jsts.geom.Coordinate(envelope.getMinX(),envelope.getMaxY()),new jsts.geom.Coordinate(envelope.getMaxX(),envelope.getMaxY()),new jsts.geom.Coordinate(envelope.getMaxX(),envelope.getMinY()),new jsts.geom.Coordinate(envelope.getMinX(),envelope.getMinY())]),null);};jsts.geomgraph.NodeFactory=function(){};jsts.geomgraph.NodeFactory.prototype.createNode=function(coord){return new jsts.geomgraph.Node(coord,null);};(function(){jsts.geomgraph.Position=function(){};jsts.geomgraph.Position.ON=0;jsts.geomgraph.Position.LEFT=1;jsts.geomgraph.Position.RIGHT=2;jsts.geomgraph.Position.opposite=function(position){if(position===jsts.geomgraph.Position.LEFT){return jsts.geomgraph.Position.RIGHT;}
if(position===jsts.geomgraph.Position.RIGHT){return jsts.geomgraph.Position.LEFT;}
return position;};})();jsts.geomgraph.TopologyLocation=function(){this.location=[];if(arguments.length===3){var on=arguments[0];var left=arguments[1];var right=arguments[2];this.init(3);this.location[jsts.geomgraph.Position.ON]=on;this.location[jsts.geomgraph.Position.LEFT]=left;this.location[jsts.geomgraph.Position.RIGHT]=right;}else if(arguments[0]instanceof jsts.geomgraph.TopologyLocation){var gl=arguments[0];this.init(gl.location.length);if(gl!=null){for(var i=0;i<this.location.length;i++){this.location[i]=gl.location[i];}}}else if(typeof arguments[0]==='number'){var on=arguments[0];this.init(1);this.location[jsts.geomgraph.Position.ON]=on;}else if(arguments[0]instanceof Array){var location=arguments[0];this.init(location.length);}};jsts.geomgraph.TopologyLocation.prototype.location=null;jsts.geomgraph.TopologyLocation.prototype.init=function(size){this.location[size-1]=null;this.setAllLocations(jsts.geom.Location.NONE);};jsts.geomgraph.TopologyLocation.prototype.get=function(posIndex){if(posIndex<this.location.length)
return this.location[posIndex];return jsts.geom.Location.NONE;};jsts.geomgraph.TopologyLocation.prototype.isNull=function(){for(var i=0;i<this.location.length;i++){if(this.location[i]!==jsts.geom.Location.NONE)
return false;}
return true;};jsts.geomgraph.TopologyLocation.prototype.isAnyNull=function(){for(var i=0;i<this.location.length;i++){if(this.location[i]===jsts.geom.Location.NONE)
return true;}
return false;};jsts.geomgraph.TopologyLocation.prototype.isEqualOnSide=function(le,locIndex){return this.location[locIndex]==le.location[locIndex];};jsts.geomgraph.TopologyLocation.prototype.isArea=function(){return this.location.length>1;};jsts.geomgraph.TopologyLocation.prototype.isLine=function(){return this.location.length===1;};jsts.geomgraph.TopologyLocation.prototype.flip=function(){if(this.location.length<=1)
return;var temp=this.location[jsts.geomgraph.Position.LEFT];this.location[jsts.geomgraph.Position.LEFT]=this.location[jsts.geomgraph.Position.RIGHT];this.location[jsts.geomgraph.Position.RIGHT]=temp;};jsts.geomgraph.TopologyLocation.prototype.setAllLocations=function(locValue){for(var i=0;i<this.location.length;i++){this.location[i]=locValue;}};jsts.geomgraph.TopologyLocation.prototype.setAllLocationsIfNull=function(locValue){for(var i=0;i<this.location.length;i++){if(this.location[i]===jsts.geom.Location.NONE)
this.location[i]=locValue;}};jsts.geomgraph.TopologyLocation.prototype.setLocation=function(locIndex,locValue){if(locValue!==undefined){this.location[locIndex]=locValue;}else{this.setLocation(jsts.geomgraph.Position.ON,locIndex);}};jsts.geomgraph.TopologyLocation.prototype.getLocations=function(){return location;};jsts.geomgraph.TopologyLocation.prototype.setLocations=function(on,left,right){this.location[jsts.geomgraph.Position.ON]=on;this.location[jsts.geomgraph.Position.LEFT]=left;this.location[jsts.geomgraph.Position.RIGHT]=right;};jsts.geomgraph.TopologyLocation.prototype.allPositionsEqual=function(loc){for(var i=0;i<this.location.length;i++){if(this.location[i]!==loc)
return false;}
return true;};jsts.geomgraph.TopologyLocation.prototype.merge=function(gl){if(gl.location.length>this.location.length){var newLoc=[];newLoc[jsts.geomgraph.Position.ON]=this.location[jsts.geomgraph.Position.ON];newLoc[jsts.geomgraph.Position.LEFT]=jsts.geom.Location.NONE;newLoc[jsts.geomgraph.Position.RIGHT]=jsts.geom.Location.NONE;this.location=newLoc;}
for(var i=0;i<this.location.length;i++){if(this.location[i]===jsts.geom.Location.NONE&&i<gl.location.length)
this.location[i]=gl.location[i];}};jsts.geomgraph.Label=function(){this.elt=[];var geomIndex,onLoc,leftLoc,lbl,rightLoc;if(arguments.length===4){geomIndex=arguments[0];onLoc=arguments[1];leftLoc=arguments[2];rightLoc=arguments[3];this.elt[0]=new jsts.geomgraph.TopologyLocation(jsts.geom.Location.NONE,jsts.geom.Location.NONE,jsts.geom.Location.NONE);this.elt[1]=new jsts.geomgraph.TopologyLocation(jsts.geom.Location.NONE,jsts.geom.Location.NONE,jsts.geom.Location.NONE);this.elt[geomIndex].setLocations(onLoc,leftLoc,rightLoc);}else if(arguments.length===3){onLoc=arguments[0];leftLoc=arguments[1];rightLoc=arguments[2];this.elt[0]=new jsts.geomgraph.TopologyLocation(onLoc,leftLoc,rightLoc);this.elt[1]=new jsts.geomgraph.TopologyLocation(onLoc,leftLoc,rightLoc);}else if(arguments.length===2){geomIndex=arguments[0];onLoc=arguments[1];this.elt[0]=new jsts.geomgraph.TopologyLocation(jsts.geom.Location.NONE);this.elt[1]=new jsts.geomgraph.TopologyLocation(jsts.geom.Location.NONE);this.elt[geomIndex].setLocation(onLoc);}else if(arguments[0]instanceof jsts.geomgraph.Label){lbl=arguments[0];this.elt[0]=new jsts.geomgraph.TopologyLocation(lbl.elt[0]);this.elt[1]=new jsts.geomgraph.TopologyLocation(lbl.elt[1]);}else if(typeof arguments[0]==='number'){onLoc=arguments[0];this.elt[0]=new jsts.geomgraph.TopologyLocation(onLoc);this.elt[1]=new jsts.geomgraph.TopologyLocation(onLoc);}};jsts.geomgraph.Label.toLineLabel=function(label){var i,lineLabel=new jsts.geomgraph.Label(jsts.geom.Location.NONE);for(i=0;i<2;i++){lineLabel.setLocation(i,label.getLocation(i));}
return lineLabel;};jsts.geomgraph.Label.prototype.elt=null;jsts.geomgraph.Label.prototype.flip=function(){this.elt[0].flip();this.elt[1].flip();};jsts.geomgraph.Label.prototype.getLocation=function(geomIndex,posIndex){if(arguments.length==1){return this.getLocation2.apply(this,arguments);}
return this.elt[geomIndex].get(posIndex);};jsts.geomgraph.Label.prototype.getLocation2=function(geomIndex){return this.elt[geomIndex].get(jsts.geomgraph.Position.ON);};jsts.geomgraph.Label.prototype.setLocation=function(geomIndex,posIndex,location){if(arguments.length==2){this.setLocation2.apply(this,arguments);return;}
this.elt[geomIndex].setLocation(posIndex,location);};jsts.geomgraph.Label.prototype.setLocation2=function(geomIndex,location){this.elt[geomIndex].setLocation(jsts.geomgraph.Position.ON,location);};jsts.geomgraph.Label.prototype.setAllLocations=function(geomIndex,location){this.elt[geomIndex].setAllLocations(location);};jsts.geomgraph.Label.prototype.setAllLocationsIfNull=function(geomIndex,location){if(arguments.length==1){this.setAllLocationsIfNull2.apply(this,arguments);return;}
this.elt[geomIndex].setAllLocationsIfNull(location);};jsts.geomgraph.Label.prototype.setAllLocationsIfNull2=function(location){this.setAllLocationsIfNull(0,location);this.setAllLocationsIfNull(1,location);};jsts.geomgraph.Label.prototype.merge=function(lbl){var i;for(i=0;i<2;i++){if(this.elt[i]===null&&lbl.elt[i]!==null){this.elt[i]=new jsts.geomgraph.TopologyLocation(lbl.elt[i]);}else{this.elt[i].merge(lbl.elt[i]);}}};jsts.geomgraph.Label.prototype.getGeometryCount=function(){var count=0;if(!this.elt[0].isNull()){count++;}
if(!this.elt[1].isNull()){count++;}
return count;};jsts.geomgraph.Label.prototype.isNull=function(geomIndex){return this.elt[geomIndex].isNull();};jsts.geomgraph.Label.prototype.isAnyNull=function(geomIndex){return this.elt[geomIndex].isAnyNull();};jsts.geomgraph.Label.prototype.isArea=function(){if(arguments.length==1){return this.isArea2(arguments[0]);}
return this.elt[0].isArea()||this.elt[1].isArea();};jsts.geomgraph.Label.prototype.isArea2=function(geomIndex){return this.elt[geomIndex].isArea();};jsts.geomgraph.Label.prototype.isLine=function(geomIndex){return this.elt[geomIndex].isLine();};jsts.geomgraph.Label.prototype.isEqualOnSide=function(lbl,side){return this.elt[0].isEqualOnSide(lbl.elt[0],side)&&this.elt[1].isEqualOnSide(lbl.elt[1],side);};jsts.geomgraph.Label.prototype.allPositionsEqual=function(geomIndex,loc){return this.elt[geomIndex].allPositionsEqual(loc);};jsts.geomgraph.Label.prototype.toLine=function(geomIndex){if(this.elt[geomIndex].isArea()){this.elt[geomIndex]=new jsts.geomgraph.TopologyLocation(this.elt[geomIndex].location[0]);}};jsts.geomgraph.EdgeRing=function(start,geometryFactory){this.edges=[];this.pts=[];this.holes=[];this.label=new jsts.geomgraph.Label(jsts.geom.Location.NONE);this.geometryFactory=geometryFactory;if(start){this.computePoints(start);this.computeRing();}};jsts.geomgraph.EdgeRing.prototype.startDe=null;jsts.geomgraph.EdgeRing.prototype.maxNodeDegree=-1;jsts.geomgraph.EdgeRing.prototype.edges=null;jsts.geomgraph.EdgeRing.prototype.pts=null;jsts.geomgraph.EdgeRing.prototype.label=null;jsts.geomgraph.EdgeRing.prototype.ring=null;jsts.geomgraph.EdgeRing.prototype._isHole=null;jsts.geomgraph.EdgeRing.prototype.shell=null;jsts.geomgraph.EdgeRing.prototype.holes=null;jsts.geomgraph.EdgeRing.prototype.geometryFactory=null;jsts.geomgraph.EdgeRing.prototype.isIsolated=function(){return(this.label.getGeometryCount()==1);};jsts.geomgraph.EdgeRing.prototype.isHole=function(){return this._isHole;};jsts.geomgraph.EdgeRing.prototype.getCoordinate=function(i){return this.pts[i];};jsts.geomgraph.EdgeRing.prototype.getLinearRing=function(){return this.ring;};jsts.geomgraph.EdgeRing.prototype.getLabel=function(){return this.label;};jsts.geomgraph.EdgeRing.prototype.isShell=function(){return this.shell===null;};jsts.geomgraph.EdgeRing.prototype.getShell=function(){return this.shell;};jsts.geomgraph.EdgeRing.prototype.setShell=function(shell){this.shell=shell;if(shell!==null)
shell.addHole(this);};jsts.geomgraph.EdgeRing.prototype.addHole=function(ring){this.holes.push(ring);};jsts.geomgraph.EdgeRing.prototype.toPolygon=function(geometryFactory){var holeLR=[];for(var i=0;i<this.holes.length;i++){holeLR[i]=this.holes[i].getLinearRing();}
var poly=this.geometryFactory.createPolygon(this.getLinearRing(),holeLR);return poly;};jsts.geomgraph.EdgeRing.prototype.computeRing=function(){if(this.ring!==null)
return;var coord=[];for(var i=0;i<this.pts.length;i++){coord[i]=this.pts[i];}
this.ring=this.geometryFactory.createLinearRing(coord);this._isHole=jsts.algorithm.CGAlgorithms.isCCW(this.ring.getCoordinates());};jsts.geomgraph.EdgeRing.prototype.getNext=function(de){throw new jsts.error.AbstractInvocationError();};jsts.geomgraph.EdgeRing.prototype.setEdgeRing=function(de,er){throw new jsts.error.AbstractInvocationError();};jsts.geomgraph.EdgeRing.prototype.getEdges=function(){return this.edges;};jsts.geomgraph.EdgeRing.prototype.computePoints=function(start){this.startDe=start;var de=start;var isFirstEdge=true;do{if(de===null)
throw new jsts.error.TopologyError('Found null DirectedEdge');if(de.getEdgeRing()===this)
throw new jsts.error.TopologyError('Directed Edge visited twice during ring-building at '+
de.getCoordinate());this.edges.push(de);var label=de.getLabel();jsts.util.Assert.isTrue(label.isArea());this.mergeLabel(label);this.addPoints(de.getEdge(),de.isForward(),isFirstEdge);isFirstEdge=false;this.setEdgeRing(de,this);de=this.getNext(de);}while(de!==this.startDe);};jsts.geomgraph.EdgeRing.prototype.getMaxNodeDegree=function(){if(this.maxNodeDegree<0)
this.computeMaxNodeDegree();return this.maxNodeDegree;};jsts.geomgraph.EdgeRing.prototype.computeMaxNodeDegree=function(){this.maxNodeDegree=0;var de=this.startDe;do{var node=de.getNode();var degree=node.getEdges().getOutgoingDegree(this);if(degree>this.maxNodeDegree)
this.maxNodeDegree=degree;de=this.getNext(de);}while(de!==this.startDe);this.maxNodeDegree*=2;};jsts.geomgraph.EdgeRing.prototype.setInResult=function(){var de=this.startDe;do{de.getEdge().setInResult(true);de=de.getNext();}while(de!=this.startDe);};jsts.geomgraph.EdgeRing.prototype.mergeLabel=function(deLabel){this.mergeLabel2(deLabel,0);this.mergeLabel2(deLabel,1);};jsts.geomgraph.EdgeRing.prototype.mergeLabel2=function(deLabel,geomIndex){var loc=deLabel.getLocation(geomIndex,jsts.geomgraph.Position.RIGHT);if(loc==jsts.geom.Location.NONE)
return;if(this.label.getLocation(geomIndex)===jsts.geom.Location.NONE){this.label.setLocation(geomIndex,loc);return;}};jsts.geomgraph.EdgeRing.prototype.addPoints=function(edge,isForward,isFirstEdge){var edgePts=edge.getCoordinates();if(isForward){var startIndex=1;if(isFirstEdge)
startIndex=0;for(var i=startIndex;i<edgePts.length;i++){this.pts.push(edgePts[i]);}}else{var startIndex=edgePts.length-2;if(isFirstEdge)
startIndex=edgePts.length-1;for(var i=startIndex;i>=0;i--){this.pts.push(edgePts[i]);}}};jsts.geomgraph.EdgeRing.prototype.containsPoint=function(p){var shell=this.getLinearRing();var env=shell.getEnvelopeInternal();if(!env.contains(p))
return false;if(!jsts.algorithm.CGAlgorithms.isPointInRing(p,shell.getCoordinates()))
return false;for(var i=0;i<this.holes.length;i++){var hole=this.holes[i];if(hole.containsPoint(p))
return false;}
return true;};(function(){jsts.geom.LinearRing=function(points,factory){jsts.geom.LineString.apply(this,arguments);};jsts.geom.LinearRing.prototype=new jsts.geom.LineString();jsts.geom.LinearRing.constructor=jsts.geom.LinearRing;jsts.geom.LinearRing.prototype.getBoundaryDimension=function(){return jsts.geom.Dimension.FALSE;};jsts.geom.LinearRing.prototype.isSimple=function(){return true;};jsts.geom.LinearRing.prototype.getGeometryType=function(){return'LinearRing';};jsts.geom.LinearRing.MINIMUM_VALID_SIZE=4;jsts.geom.LinearRing.prototype.CLASS_NAME='jsts.geom.LinearRing';})();jsts.index.strtree.Boundable=function(){};jsts.index.strtree.Boundable.prototype.getBounds=function(){throw new jsts.error.AbstractMethodInvocationError();};jsts.index.strtree.AbstractNode=function(level){this.level=level;this.childBoundables=[];};jsts.index.strtree.AbstractNode.prototype=new jsts.index.strtree.Boundable();jsts.index.strtree.AbstractNode.constructor=jsts.index.strtree.AbstractNode;jsts.index.strtree.AbstractNode.prototype.childBoundables=null;jsts.index.strtree.AbstractNode.prototype.bounds=null;jsts.index.strtree.AbstractNode.prototype.level=null;jsts.index.strtree.AbstractNode.prototype.getChildBoundables=function(){return this.childBoundables;};jsts.index.strtree.AbstractNode.prototype.computeBounds=function(){throw new jsts.error.AbstractMethodInvocationError();};jsts.index.strtree.AbstractNode.prototype.getBounds=function(){if(this.bounds===null){this.bounds=this.computeBounds();}
return this.bounds;};jsts.index.strtree.AbstractNode.prototype.getLevel=function(){return this.level;};jsts.index.strtree.AbstractNode.prototype.addChildBoundable=function(childBoundable){this.childBoundables.push(childBoundable);};(function(){jsts.noding.Noder=function(){};jsts.noding.Noder.prototype.computeNodes=jsts.abstractFunc;jsts.noding.Noder.prototype.getNodedSubstrings=jsts.abstractFunc;})();(function(){var Noder=jsts.noding.Noder;jsts.noding.SinglePassNoder=function(){};jsts.noding.SinglePassNoder.prototype=new Noder();jsts.noding.SinglePassNoder.constructor=jsts.noding.SinglePassNoder;jsts.noding.SinglePassNoder.prototype.segInt=null;jsts.noding.SinglePassNoder.prototype.setSegmentIntersector=function(segInt){this.segInt=segInt;};})();jsts.index.SpatialIndex=function(){};jsts.index.SpatialIndex.prototype.insert=function(itemEnv,item){throw new jsts.error.AbstractMethodInvocationError();};jsts.index.SpatialIndex.prototype.query=function(searchEnv,visitor){throw new jsts.error.AbstractMethodInvocationError();};jsts.index.SpatialIndex.prototype.remove=function(itemEnv,item){throw new jsts.error.AbstractMethodInvocationError();};jsts.index.strtree.AbstractSTRtree=function(nodeCapacity){if(nodeCapacity===undefined)
return;this.itemBoundables=[];jsts.util.Assert.isTrue(nodeCapacity>1,'Node capacity must be greater than 1');this.nodeCapacity=nodeCapacity;};jsts.index.strtree.AbstractSTRtree.IntersectsOp=function(){};jsts.index.strtree.AbstractSTRtree.IntersectsOp.prototype.intersects=function(aBounds,bBounds){throw new jsts.error.AbstractMethodInvocationError();};jsts.index.strtree.AbstractSTRtree.prototype.root=null;jsts.index.strtree.AbstractSTRtree.prototype.built=false;jsts.index.strtree.AbstractSTRtree.prototype.itemBoundables=null;jsts.index.strtree.AbstractSTRtree.prototype.nodeCapacity=null;jsts.index.strtree.AbstractSTRtree.prototype.build=function(){jsts.util.Assert.isTrue(!this.built);this.root=this.itemBoundables.length===0?this.createNode(0):this.createHigherLevels(this.itemBoundables,-1);this.built=true;};jsts.index.strtree.AbstractSTRtree.prototype.createNode=function(level){throw new jsts.error.AbstractMethodInvocationError();};jsts.index.strtree.AbstractSTRtree.prototype.createParentBoundables=function(childBoundables,newLevel){jsts.util.Assert.isTrue(!(childBoundables.length===0));var parentBoundables=[];parentBoundables.push(this.createNode(newLevel));var sortedChildBoundables=[];for(var i=0;i<childBoundables.length;i++){sortedChildBoundables.push(childBoundables[i]);}
sortedChildBoundables.sort(this.getComparator());for(var i=0;i<sortedChildBoundables.length;i++){var childBoundable=sortedChildBoundables[i];if(this.lastNode(parentBoundables).getChildBoundables().length===this.getNodeCapacity()){parentBoundables.push(this.createNode(newLevel));}
this.lastNode(parentBoundables).addChildBoundable(childBoundable);}
return parentBoundables;};jsts.index.strtree.AbstractSTRtree.prototype.lastNode=function(nodes){return nodes[nodes.length-1];};jsts.index.strtree.AbstractSTRtree.prototype.compareDoubles=function(a,b){return a>b?1:a<b?-1:0;};jsts.index.strtree.AbstractSTRtree.prototype.createHigherLevels=function(boundablesOfALevel,level){jsts.util.Assert.isTrue(!(boundablesOfALevel.length===0));var parentBoundables=this.createParentBoundables(boundablesOfALevel,level+1);if(parentBoundables.length===1){return parentBoundables[0];}
return this.createHigherLevels(parentBoundables,level+1);};jsts.index.strtree.AbstractSTRtree.prototype.getRoot=function(){if(!this.built)
this.build();return this.root;};jsts.index.strtree.AbstractSTRtree.prototype.getNodeCapacity=function(){return this.nodeCapacity;};jsts.index.strtree.AbstractSTRtree.prototype.size=function(){if(arguments.length===1){return this.size2(arguments[0]);}
if(!this.built){this.build();}
if(this.itemBoundables.length===0){return 0;}
return this.size2(root);};jsts.index.strtree.AbstractSTRtree.prototype.size2=function(node){var size=0;var childBoundables=node.getChildBoundables();for(var i=0;i<childBoundables.length;i++){var childBoundable=childBoundables[i];if(childBoundable instanceof jsts.index.strtree.AbstractNode){size+=this.size(childBoundable);}else if(childBoundable instanceof jsts.index.strtree.ItemBoundable){size+=1;}}
return size;};jsts.index.strtree.AbstractSTRtree.prototype.depth=function(){if(arguments.length===1){return this.depth2(arguments[0]);}
if(!this.built){this.build();}
if(this.itemBoundables.length===0){return 0;}
return this.depth2(root);};jsts.index.strtree.AbstractSTRtree.prototype.depth2=function(){var maxChildDepth=0;var childBoundables=node.getChildBoundables();for(var i=0;i<childBoundables.length;i++){var childBoundable=childBoundables[i];if(childBoundable instanceof jsts.index.strtree.AbstractNode){var childDepth=this.depth(childBoundable);if(childDepth>maxChildDepth)
maxChildDepth=childDepth;}}
return maxChildDepth+1;};jsts.index.strtree.AbstractSTRtree.prototype.insert=function(bounds,item){jsts.util.Assert.isTrue(!this.built,'Cannot insert items into an STR packed R-tree after it has been built.');this.itemBoundables.push(new jsts.index.strtree.ItemBoundable(bounds,item));};jsts.index.strtree.AbstractSTRtree.prototype.query=function(searchBounds){if(arguments.length>1){this.query2.apply(this,arguments);}
if(!this.built){this.build();}
var matches=[];if(this.itemBoundables.length===0){jsts.util.Assert.isTrue(this.root.getBounds()===null);return matches;}
if(this.getIntersectsOp().intersects(this.root.getBounds(),searchBounds)){this.query3(searchBounds,this.root,matches);}
return matches;};jsts.index.strtree.AbstractSTRtree.prototype.query2=function(searchBounds,visitor){if(arguments.length>2){this.query3.apply(this,arguments);}
if(!this.built){this.build();}
if(this.itemBoundables.length===0){jsts.util.Assert.isTrue(this.root.getBounds()===null);}
if(this.getIntersectsOp().intersects(this.root.getBounds(),searchBounds)){this.query4(searchBounds,this.root,visitor);}};jsts.index.strtree.AbstractSTRtree.prototype.query3=function(searchBounds,node,matches){if(!(arguments[2]instanceof Array)){this.query4.apply(this,arguments);}
var childBoundables=node.getChildBoundables();for(var i=0;i<childBoundables.length;i++){var childBoundable=childBoundables[i];if(!this.getIntersectsOp().intersects(childBoundable.getBounds(),searchBounds)){continue;}
if(childBoundable instanceof jsts.index.strtree.AbstractNode){this.query3(searchBounds,childBoundable,matches);}else if(childBoundable instanceof jsts.index.strtree.ItemBoundable){matches.push(childBoundable.getItem());}else{jsts.util.Assert.shouldNeverReachHere();}}};jsts.index.strtree.AbstractSTRtree.prototype.query4=function(searchBounds,node,visitor){var childBoundables=node.getChildBoundables();for(var i=0;i<childBoundables.length;i++){var childBoundable=childBoundables[i];if(!this.getIntersectsOp().intersects(childBoundable.getBounds(),searchBounds)){continue;}
if(childBoundable instanceof jsts.index.strtree.AbstractNode){this.query4(searchBounds,childBoundable,visitor);}else if(childBoundable instanceof jsts.index.strtree.ItemBoundable){visitor.visitItem(childBoundable.getItem());}else{jsts.util.Assert.shouldNeverReachHere();}}};jsts.index.strtree.AbstractSTRtree.prototype.getIntersectsOp=function(){throw new jsts.error.AbstractMethodInvocationError();};jsts.index.strtree.AbstractSTRtree.prototype.itemsTree=function(){if(arguments.length===1){return this.itemsTree2.apply(this,arguments);}
if(!this.built){this.build();}
var valuesTree=this.itemsTree2(this.root);if(valuesTree===null)
return[];return valuesTree;};jsts.index.strtree.AbstractSTRtree.prototype.itemsTree2=function(node){var valuesTreeForNode=[];var childBoundables=node.getChildBoundables();for(var i=0;i<childBoundables.length;i++){var childBoundable=childBoundables[i];if(childBoundable instanceof jsts.index.strtree.AbstractNode){var valuesTreeForChild=this.itemsTree(childBoundable);if(valuesTreeForChild!=null)
valuesTreeForNode.push(valuesTreeForChild);}else if(childBoundable instanceof jsts.index.strtree.ItemBoundable){valuesTreeForNode.push(childBoundable.getItem());}else{jsts.util.Assert.shouldNeverReachHere();}}
if(valuesTreeForNode.length<=0)
return null;return valuesTreeForNode;};jsts.index.strtree.AbstractSTRtree.prototype.remove=function(searchBounds,item){if(!this.built){this.build();}
if(this.itemBoundables.length===0){jsts.util.Assert.isTrue(this.root.getBounds()==null);}
if(this.getIntersectsOp().intersects(this.root.getBounds(),searchBounds)){return this.remove2(searchBounds,this.root,item);}
return false;};jsts.index.strtree.AbstractSTRtree.prototype.remove2=function(searchBounds,node,item){var found=this.removeItem(node,item);if(found)
return true;var childToPrune=null;var childBoundables=node.getChildBoundables();for(var i=0;i<childBoundables.length;i++){var childBoundable=childBoundables[i];if(!this.getIntersectsOp().intersects(childBoundable.getBounds(),searchBounds)){continue;}
if(childBoundable instanceof jsts.index.strtree.AbstractNode){found=this.remove(searchBounds,childBoundable,item);if(found){childToPrune=childBoundable;break;}}}
if(childToPrune!=null){if(childToPrune.getChildBoundables().length===0){childBoundables.splice(childBoundables.indexOf(childToPrune),1);}}
return found;};jsts.index.strtree.AbstractSTRtree.prototype.removeItem=function(node,item){var childToRemove=null;var childBoundables=node.getChildBoundables();for(var i=0;i<childBoundables.length;i++){var childBoundable=childBoundables[i];if(childBoundable instanceof jsts.index.strtree.ItemBoundable){if(childBoundable.getItem()===item)
childToRemove=childBoundable;}}
if(childToRemove!==null){childBoundables.splice(childBoundables.indexOf(childToRemove),1);return true;}
return false;};jsts.index.strtree.AbstractSTRtree.prototype.boundablesAtLevel=function(level){if(arguments.length>1){this.boundablesAtLevel2.apply(this,arguments);return;}
var boundables=[];this.boundablesAtLevel2(level,this.root,boundables);return boundables;};jsts.index.strtree.AbstractSTRtree.prototype.boundablesAtLevel2=function(level,top,boundables){jsts.util.Assert.isTrue(level>-2);if(top.getLevel()===level){boundables.add(top);return;}
var childBoundables=node.getChildBoundables();for(var i=0;i<childBoundables.length;i++){var boundable=childBoundables[i];if(boundable instanceof jsts.index.strtree.AbstractNode){this.boundablesAtLevel(level,boundable,boundables);}else{jsts.util.Assert.isTrue(boundable instanceof jsts.index.strtree.ItemBoundable);if(level===-1){boundables.add(boundable);}}}
return;};jsts.index.strtree.AbstractSTRtree.prototype.getComparator=function(){throw new jsts.error.AbstractMethodInvocationError();};jsts.index.strtree.STRtree=function(nodeCapacity){nodeCapacity=nodeCapacity||jsts.index.strtree.STRtree.DEFAULT_NODE_CAPACITY;jsts.index.strtree.AbstractSTRtree.call(this,nodeCapacity);};jsts.index.strtree.STRtree.prototype=new jsts.index.strtree.AbstractSTRtree();jsts.index.strtree.STRtree.constructor=jsts.index.strtree.STRtree;jsts.index.strtree.STRtree.prototype.xComparator=function(o1,o2){return jsts.index.strtree.AbstractSTRtree.prototype.compareDoubles(jsts.index.strtree.STRtree.prototype.centreX(o1.getBounds()),jsts.index.strtree.STRtree.prototype.centreX(o2.getBounds()));};jsts.index.strtree.STRtree.prototype.yComparator=function(o1,o2){return jsts.index.strtree.AbstractSTRtree.prototype.compareDoubles(jsts.index.strtree.STRtree.prototype.centreY(o1.getBounds()),jsts.index.strtree.STRtree.prototype.centreY(o2.getBounds()));};jsts.index.strtree.STRtree.prototype.centreX=function(e){return jsts.index.strtree.STRtree.prototype.avg(e.getMinX(),e.getMaxX());};jsts.index.strtree.STRtree.prototype.centreY=function(e){return jsts.index.strtree.STRtree.prototype.avg(e.getMinY(),e.getMaxY());};jsts.index.strtree.STRtree.prototype.avg=function(a,b){return(a+b)/2.0;};jsts.index.strtree.STRtree.prototype.intersectsOp={intersects:function(aBounds,bBounds){return aBounds.intersects(bBounds);}};jsts.index.strtree.STRtree.prototype.createParentBoundables=function(childBoundables,newLevel){jsts.util.Assert.isTrue(!(childBoundables.length===0));var minLeafCount=Math.ceil(childBoundables.length/this.getNodeCapacity());var sortedChildBoundables=[];for(var i=0;i<childBoundables.length;i++){sortedChildBoundables.push(childBoundables[i]);}
sortedChildBoundables.sort(this.xComparator);var verticalSlices=this.verticalSlices(sortedChildBoundables,Math.ceil(Math.sqrt(minLeafCount)));return this.createParentBoundablesFromVerticalSlices(verticalSlices,newLevel);};jsts.index.strtree.STRtree.prototype.createParentBoundablesFromVerticalSlices=function(verticalSlices,newLevel){jsts.util.Assert.isTrue(verticalSlices.length>0);var parentBoundables=[];for(var i=0;i<verticalSlices.length;i++){parentBoundables=parentBoundables.concat(this.createParentBoundablesFromVerticalSlice(verticalSlices[i],newLevel));}
return parentBoundables;};jsts.index.strtree.STRtree.prototype.createParentBoundablesFromVerticalSlice=function(childBoundables,newLevel){return jsts.index.strtree.AbstractSTRtree.prototype.createParentBoundables.call(this,childBoundables,newLevel);};jsts.index.strtree.STRtree.prototype.verticalSlices=function(childBoundables,sliceCount){var sliceCapacity=Math.ceil(childBoundables.length/sliceCount);var slices=[];var i=0,boundablesAddedToSlice,childBoundable;for(var j=0;j<sliceCount;j++){slices[j]=[];boundablesAddedToSlice=0;while(i<childBoundables.length&&boundablesAddedToSlice<sliceCapacity){childBoundable=childBoundables[i++];slices[j].push(childBoundable);boundablesAddedToSlice++;}}
return slices;};jsts.index.strtree.STRtree.DEFAULT_NODE_CAPACITY=10;jsts.index.strtree.STRtree.prototype.createNode=function(level){var abstractNode=new jsts.index.strtree.AbstractNode(level);abstractNode.computeBounds=function(){var bounds=null;var childBoundables=this.getChildBoundables();for(var i=0;i<childBoundables.length;i++){var childBoundable=childBoundables[i];if(bounds===null){bounds=new jsts.geom.Envelope(childBoundable.getBounds());}else{bounds.expandToInclude(childBoundable.getBounds());}}
return bounds;};return abstractNode;};jsts.index.strtree.STRtree.prototype.getIntersectsOp=function(){return this.intersectsOp;};jsts.index.strtree.STRtree.prototype.insert=function(itemEnv,item){if(itemEnv.isNull()){return;}
jsts.index.strtree.AbstractSTRtree.prototype.insert.call(this,itemEnv,item);};jsts.index.strtree.STRtree.prototype.query=function(searchEnv,visitor){return jsts.index.strtree.AbstractSTRtree.prototype.query.apply(this,arguments);};jsts.index.strtree.STRtree.prototype.remove=function(itemEnv,item){return jsts.index.strtree.AbstractSTRtree.prototype.remove.call(this,itemEnv,item);};jsts.index.strtree.STRtree.prototype.size=function(){return jsts.index.strtree.AbstractSTRtree.prototype.size.call(this);};jsts.index.strtree.STRtree.prototype.depth=function(){return jsts.index.strtree.AbstractSTRtree.prototype.depth.call(this);};jsts.index.strtree.STRtree.prototype.getComparator=function(){return this.yComparator;};jsts.index.strtree.STRtree.prototype.nearestNeighbour=function(itemDist){var bp=new jsts.index.strtree.BoundablePair(this.getRoot(),this.getRoot(),itemDist);return this.nearestNeighbour4(bp);};jsts.index.strtree.STRtree.prototype.nearestNeighbour2=function(env,item,itemDist){var bnd=new jsts.index.strtree.ItemBoundable(env,item);var bp=new jsts.index.strtree.BoundablePair(this.getRoot(),bnd,itemDist);return this.nearestNeighbour4(bp)[0];};jsts.index.strtree.STRtree.prototype.nearestNeighbour3=function(tree,itemDist){var bp=new jsts.index.strtree.BoundablePair(this.getRoot(),tree.getRoot(),itemDist);return this.nearestNeighbour4(bp);};jsts.index.strtree.STRtree.prototype.nearestNeighbour4=function(initBndPair){return this.nearestNeighbour5(initBndPair,Double.POSITIVE_INFINITY);};jsts.index.strtree.STRtree.prototype.nearestNeighbour5=function(initBndPair,maxDistance){var distanceLowerBound=maxDistance;var minPair=null;var priQ=[];priQ.push(initBndPair);while(!priQ.isEmpty()&&distanceLowerBound>0.0){var bndPair=priQ.pop();var currentDistance=bndPair.getDistance();if(currentDistance>=distanceLowerBound)
break;if(bndPair.isLeaves()){distanceLowerBound=currentDistance;minPair=bndPair;}else{bndPair.expandToQueue(priQ,distanceLowerBound);}}
return[minPair.getBoundable(0).getItem(),minPair.getBoundable(1).getItem()];};jsts.noding.SegmentString=function(){};jsts.noding.SegmentString.prototype.getData=jsts.abstractFunc;jsts.noding.SegmentString.prototype.setData=jsts.abstractFunc;jsts.noding.SegmentString.prototype.size=jsts.abstractFunc;jsts.noding.SegmentString.prototype.getCoordinate=jsts.abstractFunc;jsts.noding.SegmentString.prototype.getCoordinates=jsts.abstractFunc;jsts.noding.SegmentString.prototype.isClosed=jsts.abstractFunc;jsts.noding.NodableSegmentString=function(){};jsts.noding.NodableSegmentString.prototype=new jsts.noding.SegmentString();jsts.noding.NodableSegmentString.prototype.addIntersection=jsts.abstractFunc;jsts.noding.NodedSegmentString=function(pts,data){this.nodeList=new jsts.noding.SegmentNodeList(this);this.pts=pts;this.data=data;};jsts.noding.NodedSegmentString.prototype=new jsts.noding.NodableSegmentString();jsts.noding.NodedSegmentString.constructor=jsts.noding.NodedSegmentString;jsts.noding.NodedSegmentString.getNodedSubstrings=function(segStrings){if(arguments.length===2){jsts.noding.NodedSegmentString.getNodedSubstrings2.apply(this,arguments);return;}
var resultEdgelist=new javascript.util.ArrayList();jsts.noding.NodedSegmentString.getNodedSubstrings2(segStrings,resultEdgelist);return resultEdgelist;};jsts.noding.NodedSegmentString.getNodedSubstrings2=function(segStrings,resultEdgelist){for(var i=segStrings.iterator();i.hasNext();){var ss=i.next();ss.getNodeList().addSplitEdges(resultEdgelist);}};jsts.noding.NodedSegmentString.prototype.nodeList=null;jsts.noding.NodedSegmentString.prototype.pts=null;jsts.noding.NodedSegmentString.prototype.data=null;jsts.noding.NodedSegmentString.prototype.getData=function(){return this.data;};jsts.noding.NodedSegmentString.prototype.setData=function(data){this.data=data;};jsts.noding.NodedSegmentString.prototype.getNodeList=function(){return this.nodeList;};jsts.noding.NodedSegmentString.prototype.size=function(){return this.pts.length;};jsts.noding.NodedSegmentString.prototype.getCoordinate=function(i){return this.pts[i];};jsts.noding.NodedSegmentString.prototype.getCoordinates=function(){return this.pts;};jsts.noding.NodedSegmentString.prototype.isClosed=function(){return this.pts[0].equals(this.pts[this.pts.length-1]);};jsts.noding.NodedSegmentString.prototype.getSegmentOctant=function(index){if(index===this.pts.length-1)
return-1;return this.safeOctant(this.getCoordinate(index),this.getCoordinate(index+1));};jsts.noding.NodedSegmentString.prototype.safeOctant=function(p0,p1){if(p0.equals2D(p1))
return 0;return jsts.noding.Octant.octant(p0,p1);};jsts.noding.NodedSegmentString.prototype.addIntersections=function(li,segmentIndex,geomIndex){for(var i=0;i<li.getIntersectionNum();i++){this.addIntersection(li,segmentIndex,geomIndex,i);}};jsts.noding.NodedSegmentString.prototype.addIntersection=function(li,segmentIndex,geomIndex,intIndex){if(li instanceof jsts.geom.Coordinate){this.addIntersection2.apply(this,arguments);return;}
var intPt=new jsts.geom.Coordinate(li.getIntersection(intIndex));this.addIntersection2(intPt,segmentIndex);};jsts.noding.NodedSegmentString.prototype.addIntersection2=function(intPt,segmentIndex){this.addIntersectionNode(intPt,segmentIndex);};jsts.noding.NodedSegmentString.prototype.addIntersectionNode=function(intPt,segmentIndex){var normalizedSegmentIndex=segmentIndex;var nextSegIndex=normalizedSegmentIndex+1;if(nextSegIndex<this.pts.length){var nextPt=this.pts[nextSegIndex];if(intPt.equals2D(nextPt)){normalizedSegmentIndex=nextSegIndex;}}
var ei=this.nodeList.add(intPt,normalizedSegmentIndex);return ei;};jsts.noding.NodedSegmentString.prototype.toString=function(){var geometryFactory=new jsts.geom.GeometryFactory();return new jsts.io.WKTWriter().write(geometryFactory.createLineString(this.pts));};jsts.index.chain.MonotoneChainBuilder=function(){};jsts.index.chain.MonotoneChainBuilder.toIntArray=function(list){var array=[];for(var i=0;i<list.length;i++){array[i]=list[i];}
return array;};jsts.index.chain.MonotoneChainBuilder.getChains=function(pts){if(arguments.length===2){return jsts.index.chain.MonotoneChainBuilder.getChains2.apply(this,arguments);}
return jsts.index.chain.MonotoneChainBuilder.getChains2(pts,null);};jsts.index.chain.MonotoneChainBuilder.getChains2=function(pts,context){var mcList=[];var startIndex=jsts.index.chain.MonotoneChainBuilder.getChainStartIndices(pts);for(var i=0;i<startIndex.length-1;i++){var mc=new jsts.index.chain.MonotoneChain(pts,startIndex[i],startIndex[i+1],context);mcList.push(mc);}
return mcList;};jsts.index.chain.MonotoneChainBuilder.getChainStartIndices=function(pts){var start=0;var startIndexList=[];startIndexList.push(start);do{var last=jsts.index.chain.MonotoneChainBuilder.findChainEnd(pts,start);startIndexList.push(last);start=last;}while(start<pts.length-1);var startIndex=jsts.index.chain.MonotoneChainBuilder.toIntArray(startIndexList);return startIndex;};jsts.index.chain.MonotoneChainBuilder.findChainEnd=function(pts,start){var safeStart=start;while(safeStart<pts.length-1&&pts[safeStart].equals2D(pts[safeStart+1])){safeStart++;}
if(safeStart>=pts.length-1){return pts.length-1;}
var chainQuad=jsts.geomgraph.Quadrant.quadrant(pts[safeStart],pts[safeStart+1]);var last=start+1;while(last<pts.length){if(!pts[last-1].equals2D(pts[last])){var quad=jsts.geomgraph.Quadrant.quadrant(pts[last-1],pts[last]);if(quad!==chainQuad)
break;}
last++;}
return last-1;};jsts.algorithm.LineIntersector=function(){this.inputLines=[[],[]];this.intPt=[null,null];this.pa=this.intPt[0];this.pb=this.intPt[1];this.result=jsts.algorithm.LineIntersector.NO_INTERSECTION;};jsts.algorithm.LineIntersector.NO_INTERSECTION=0;jsts.algorithm.LineIntersector.POINT_INTERSECTION=1;jsts.algorithm.LineIntersector.COLLINEAR_INTERSECTION=2;jsts.algorithm.LineIntersector.prototype.setPrecisionModel=function(precisionModel){this.precisionModel=precisionModel;};jsts.algorithm.LineIntersector.prototype.getEndpoint=function(segmentIndex,ptIndex){return this.inputLines[segmentIndex][ptIndex];};jsts.algorithm.LineIntersector.computeEdgeDistance=function(p,p0,p1){var dx=Math.abs(p1.x-p0.x);var dy=Math.abs(p1.y-p0.y);var dist=-1.0;if(p.equals(p0)){dist=0.0;}else if(p.equals(p1)){if(dx>dy){dist=dx;}else{dist=dy;}}else{var pdx=Math.abs(p.x-p0.x);var pdy=Math.abs(p.y-p0.y);if(dx>dy){dist=pdx;}else{dist=pdy;}
if(dist===0.0&&!p.equals(p0)){dist=Math.max(pdx,pdy);}}
if(dist===0.0&&!p.equals(p0)){throw new jsts.error.IllegalArgumentError('Bad distance calculation');}
return dist;};jsts.algorithm.LineIntersector.nonRobustComputeEdgeDistance=function(p,p1,p2){var dx=p.x-p1.x;var dy=p.y-p1.y;var dist=Math.sqrt(dx*dx+dy*dy);if(!(dist===0.0&&!p.equals(p1))){throw new jsts.error.IllegalArgumentError('Invalid distance calculation');}
return dist;};jsts.algorithm.LineIntersector.prototype.result=null;jsts.algorithm.LineIntersector.prototype.inputLines=null;jsts.algorithm.LineIntersector.prototype.intPt=null;jsts.algorithm.LineIntersector.prototype.intLineIndex=null;jsts.algorithm.LineIntersector.prototype._isProper=null;jsts.algorithm.LineIntersector.prototype.pa=null;jsts.algorithm.LineIntersector.prototype.pb=null;jsts.algorithm.LineIntersector.prototype.precisionModel=null;jsts.algorithm.LineIntersector.prototype.computeIntersection=function(p,p1,p2){throw new jsts.error.AbstractMethodInvocationError();};jsts.algorithm.LineIntersector.prototype.isCollinear=function(){return this.result===jsts.algorithm.LineIntersector.COLLINEAR_INTERSECTION;};jsts.algorithm.LineIntersector.prototype.computeIntersection=function(p1,p2,p3,p4){this.inputLines[0][0]=p1;this.inputLines[0][1]=p2;this.inputLines[1][0]=p3;this.inputLines[1][1]=p4;this.result=this.computeIntersect(p1,p2,p3,p4);};jsts.algorithm.LineIntersector.prototype.computeIntersect=function(p1,p2,q1,q2){throw new jsts.error.AbstractMethodInvocationError();};jsts.algorithm.LineIntersector.prototype.isEndPoint=function(){return this.hasIntersection()&&!this._isProper;};jsts.algorithm.LineIntersector.prototype.hasIntersection=function(){return this.result!==jsts.algorithm.LineIntersector.NO_INTERSECTION;};jsts.algorithm.LineIntersector.prototype.getIntersectionNum=function(){return this.result;};jsts.algorithm.LineIntersector.prototype.getIntersection=function(intIndex){return this.intPt[intIndex];};jsts.algorithm.LineIntersector.prototype.computeIntLineIndex=function(){if(this.intLineIndex===null){this.intLineIndex=[[],[]];this.computeIntLineIndex(0);this.computeIntLineIndex(1);}};jsts.algorithm.LineIntersector.prototype.isIntersection=function(pt){var i;for(i=0;i<this.result;i++){if(this.intPt[i].equals2D(pt)){return true;}}
return false;};jsts.algorithm.LineIntersector.prototype.isInteriorIntersection=function(){if(arguments.length===1){return this.isInteriorIntersection2.apply(this,arguments);}
if(this.isInteriorIntersection(0)){return true;}
if(this.isInteriorIntersection(1)){return true;}
return false;};jsts.algorithm.LineIntersector.prototype.isInteriorIntersection2=function(inputLineIndex){var i;for(i=0;i<this.result;i++){if(!(this.intPt[i].equals2D(this.inputLines[inputLineIndex][0])||this.intPt[i].equals2D(this.inputLines[inputLineIndex][1]))){return true;}}
return false;};jsts.algorithm.LineIntersector.prototype.isProper=function(){return this.hasIntersection()&&this._isProper;};jsts.algorithm.LineIntersector.prototype.getIntersectionAlongSegment=function(segmentIndex,intIndex){this.computeIntLineIndex();return this.intPt[intLineIndex[segmentIndex][intIndex]];};jsts.algorithm.LineIntersector.prototype.getIndexAlongSegment=function(segmentIndex,intIndex){this.computeIntLineIndex();return this.intLineIndex[segmentIndex][intIndex];};jsts.algorithm.LineIntersector.prototype.computeIntLineIndex=function(segmentIndex){var dist0=this.getEdgeDistance(segmentIndex,0);var dist1=this.getEdgeDistance(segmentIndex,1);if(dist0>dist1){this.intLineIndex[segmentIndex][0]=0;this.intLineIndex[segmentIndex][1]=1;}else{this.intLineIndex[segmentIndex][0]=1;this.intLineIndex[segmentIndex][1]=0;}};jsts.algorithm.LineIntersector.prototype.getEdgeDistance=function(segmentIndex,intIndex){var dist=jsts.algorithm.LineIntersector.computeEdgeDistance(this.intPt[intIndex],this.inputLines[segmentIndex][0],this.inputLines[segmentIndex][1]);return dist;};jsts.algorithm.RobustLineIntersector=function(){jsts.algorithm.RobustLineIntersector.prototype.constructor.call(this);};jsts.algorithm.RobustLineIntersector.prototype=new jsts.algorithm.LineIntersector();jsts.algorithm.RobustLineIntersector.prototype.computeIntersection=function(p,p1,p2){if(arguments.length===4){jsts.algorithm.LineIntersector.prototype.computeIntersection.apply(this,arguments);return;}
this._isProper=false;if(jsts.geom.Envelope.intersects(p1,p2,p)){if((jsts.algorithm.CGAlgorithms.orientationIndex(p1,p2,p)===0)&&(jsts.algorithm.CGAlgorithms.orientationIndex(p2,p1,p)===0)){this._isProper=true;if(p.equals(p1)||p.equals(p2)){this._isProper=false;}
this.result=jsts.algorithm.LineIntersector.POINT_INTERSECTION;return;}}
this.result=jsts.algorithm.LineIntersector.NO_INTERSECTION;};jsts.algorithm.RobustLineIntersector.prototype.computeIntersect=function(p1,p2,q1,q2){this._isProper=false;if(!jsts.geom.Envelope.intersects(p1,p2,q1,q2)){return jsts.algorithm.LineIntersector.NO_INTERSECTION;}
var Pq1=jsts.algorithm.CGAlgorithms.orientationIndex(p1,p2,q1);var Pq2=jsts.algorithm.CGAlgorithms.orientationIndex(p1,p2,q2);if((Pq1>0&&Pq2>0)||(Pq1<0&&Pq2<0)){return jsts.algorithm.LineIntersector.NO_INTERSECTION;}
var Qp1=jsts.algorithm.CGAlgorithms.orientationIndex(q1,q2,p1);var Qp2=jsts.algorithm.CGAlgorithms.orientationIndex(q1,q2,p2);if((Qp1>0&&Qp2>0)||(Qp1<0&&Qp2<0)){return jsts.algorithm.LineIntersector.NO_INTERSECTION;}
var collinear=Pq1===0&&Pq2===0&&Qp1===0&&Qp2===0;if(collinear){return this.computeCollinearIntersection(p1,p2,q1,q2);}
if(Pq1===0||Pq2===0||Qp1===0||Qp2===0){this._isProper=false;if(p1.equals2D(q1)||p1.equals2D(q2)){this.intPt[0]=p1;}else if(p2.equals2D(q1)||p2.equals2D(q2)){this.intPt[0]=p2;}
else if(Pq1===0){this.intPt[0]=new jsts.geom.Coordinate(q1);}else if(Pq2===0){this.intPt[0]=new jsts.geom.Coordinate(q2);}else if(Qp1===0){this.intPt[0]=new jsts.geom.Coordinate(p1);}else if(Qp2===0){this.intPt[0]=new jsts.geom.Coordinate(p2);}}else{this._isProper=true;this.intPt[0]=this.intersection(p1,p2,q1,q2);}
return jsts.algorithm.LineIntersector.POINT_INTERSECTION;};jsts.algorithm.RobustLineIntersector.prototype.computeCollinearIntersection=function(p1,p2,q1,q2){var p1q1p2=jsts.geom.Envelope.intersects(p1,p2,q1);var p1q2p2=jsts.geom.Envelope.intersects(p1,p2,q2);var q1p1q2=jsts.geom.Envelope.intersects(q1,q2,p1);var q1p2q2=jsts.geom.Envelope.intersects(q1,q2,p2);if(p1q1p2&&p1q2p2){this.intPt[0]=q1;this.intPt[1]=q2;return jsts.algorithm.LineIntersector.COLLINEAR_INTERSECTION;}
if(q1p1q2&&q1p2q2){this.intPt[0]=p1;this.intPt[1]=p2;return jsts.algorithm.LineIntersector.COLLINEAR_INTERSECTION;}
if(p1q1p2&&q1p1q2){this.intPt[0]=q1;this.intPt[1]=p1;return q1.equals(p1)&&!p1q2p2&&!q1p2q2?jsts.algorithm.LineIntersector.POINT_INTERSECTION:jsts.algorithm.LineIntersector.COLLINEAR_INTERSECTION;}
if(p1q1p2&&q1p2q2){this.intPt[0]=q1;this.intPt[1]=p2;return q1.equals(p2)&&!p1q2p2&&!q1p1q2?jsts.algorithm.LineIntersector.POINT_INTERSECTION:jsts.algorithm.LineIntersector.COLLINEAR_INTERSECTION;}
if(p1q2p2&&q1p1q2){this.intPt[0]=q2;this.intPt[1]=p1;return q2.equals(p1)&&!p1q1p2&&!q1p2q2?jsts.algorithm.LineIntersector.POINT_INTERSECTION:jsts.algorithm.LineIntersector.COLLINEAR_INTERSECTION;}
if(p1q2p2&&q1p2q2){this.intPt[0]=q2;this.intPt[1]=p2;return q2.equals(p2)&&!p1q1p2&&!q1p1q2?jsts.algorithm.LineIntersector.POINT_INTERSECTION:jsts.algorithm.LineIntersector.COLLINEAR_INTERSECTION;}
return jsts.algorithm.LineIntersector.NO_INTERSECTION;};jsts.algorithm.RobustLineIntersector.prototype.intersection=function(p1,p2,q1,q2){var intPt=this.intersectionWithNormalization(p1,p2,q1,q2);if(!this.isInSegmentEnvelopes(intPt)){intPt=jsts.algorithm.CentralEndpointIntersector.getIntersection(p1,p2,q1,q2);}
if(this.precisionModel!==null){this.precisionModel.makePrecise(intPt);}
return intPt;};jsts.algorithm.RobustLineIntersector.prototype.intersectionWithNormalization=function(p1,p2,q1,q2){var n1=new jsts.geom.Coordinate(p1);var n2=new jsts.geom.Coordinate(p2);var n3=new jsts.geom.Coordinate(q1);var n4=new jsts.geom.Coordinate(q2);var normPt=new jsts.geom.Coordinate();this.normalizeToEnvCentre(n1,n2,n3,n4,normPt);var intPt=this.safeHCoordinateIntersection(n1,n2,n3,n4);intPt.x+=normPt.x;intPt.y+=normPt.y;return intPt;};jsts.algorithm.RobustLineIntersector.prototype.safeHCoordinateIntersection=function(p1,p2,q1,q2){var intPt=null;try{intPt=jsts.algorithm.HCoordinate.intersection(p1,p2,q1,q2);}catch(e){if(e instanceof jsts.error.NotRepresentableError){intPt=jsts.algorithm.CentralEndpointIntersector.getIntersection(p1,p2,q1,q2);}else{throw e;}}
return intPt;};jsts.algorithm.RobustLineIntersector.prototype.normalizeToMinimum=function(n1,n2,n3,n4,normPt){normPt.x=this.smallestInAbsValue(n1.x,n2.x,n3.x,n4.x);normPt.y=this.smallestInAbsValue(n1.y,n2.y,n3.y,n4.y);n1.x-=normPt.x;n1.y-=normPt.y;n2.x-=normPt.x;n2.y-=normPt.y;n3.x-=normPt.x;n3.y-=normPt.y;n4.x-=normPt.x;n4.y-=normPt.y;};jsts.algorithm.RobustLineIntersector.prototype.normalizeToEnvCentre=function(n00,n01,n10,n11,normPt){var minX0=n00.x<n01.x?n00.x:n01.x;var minY0=n00.y<n01.y?n00.y:n01.y;var maxX0=n00.x>n01.x?n00.x:n01.x;var maxY0=n00.y>n01.y?n00.y:n01.y;var minX1=n10.x<n11.x?n10.x:n11.x;var minY1=n10.y<n11.y?n10.y:n11.y;var maxX1=n10.x>n11.x?n10.x:n11.x;var maxY1=n10.y>n11.y?n10.y:n11.y;var intMinX=minX0>minX1?minX0:minX1;var intMaxX=maxX0<maxX1?maxX0:maxX1;var intMinY=minY0>minY1?minY0:minY1;var intMaxY=maxY0<maxY1?maxY0:maxY1;var intMidX=(intMinX+intMaxX)/2.0;var intMidY=(intMinY+intMaxY)/2.0;normPt.x=intMidX;normPt.y=intMidY;n00.x-=normPt.x;n00.y-=normPt.y;n01.x-=normPt.x;n01.y-=normPt.y;n10.x-=normPt.x;n10.y-=normPt.y;n11.x-=normPt.x;n11.y-=normPt.y;};jsts.algorithm.RobustLineIntersector.prototype.smallestInAbsValue=function(x1,x2,x3,x4){var x=x1;var xabs=Math.abs(x);if(Math.abs(x2)<xabs){x=x2;xabs=Math.abs(x2);}
if(Math.abs(x3)<xabs){x=x3;xabs=Math.abs(x3);}
if(Math.abs(x4)<xabs){x=x4;}
return x;};jsts.algorithm.RobustLineIntersector.prototype.isInSegmentEnvelopes=function(intPt){var env0=new jsts.geom.Envelope(this.inputLines[0][0],this.inputLines[0][1]);var env1=new jsts.geom.Envelope(this.inputLines[1][0],this.inputLines[1][1]);return env0.contains(intPt)&&env1.contains(intPt);};jsts.algorithm.HCoordinate=function(){this.x=0.0;this.y=0.0;this.w=1.0;if(arguments.length===1){this.initFrom1Coordinate(arguments[0]);}else if(arguments.length===2&&arguments[0]instanceof jsts.geom.Coordinate){this.initFrom2Coordinates(arguments[0],arguments[1]);}else if(arguments.length===2&&arguments[0]instanceof jsts.algorithm.HCoordinate){this.initFrom2HCoordinates(arguments[0],arguments[1]);}else if(arguments.length===2){this.initFromXY(arguments[0],arguments[1]);}else if(arguments.length===3){this.initFromXYW(arguments[0],arguments[1],arguments[2]);}else if(arguments.length===4){this.initFromXYW(arguments[0],arguments[1],arguments[2],arguments[3]);}};jsts.algorithm.HCoordinate.intersection=function(p1,p2,q1,q2){var px,py,pw,qx,qy,qw,x,y,w,xInt,yInt;px=p1.y-p2.y;py=p2.x-p1.x;pw=p1.x*p2.y-p2.x*p1.y;qx=q1.y-q2.y;qy=q2.x-q1.x;qw=q1.x*q2.y-q2.x*q1.y;x=py*qw-qy*pw;y=qx*pw-px*qw;w=px*qy-qx*py;xInt=x/w;yInt=y/w;if(!isFinite(xInt)||!isFinite(yInt)){throw new jsts.error.NotRepresentableError();}
return new jsts.geom.Coordinate(xInt,yInt);};jsts.algorithm.HCoordinate.prototype.initFrom1Coordinate=function(p){this.x=p.x;this.y=p.y;this.w=1.0;};jsts.algorithm.HCoordinate.prototype.initFrom2Coordinates=function(p1,p2){this.x=p1.y-p2.y;this.y=p2.x-p1.x;this.w=p1.x*p2.y-p2.x*p1.y;};jsts.algorithm.HCoordinate.prototype.initFrom2HCoordinates=function(p1,p2){this.x=p1.y*p2.w-p2.y*p1.w;this.y=p2.x*p1.w-p1.x*p2.w;this.w=p1.x*p2.y-p2.x*p1.y;};jsts.algorithm.HCoordinate.prototype.initFromXYW=function(x,y,w){this.x=x;this.y=y;this.w=w;};jsts.algorithm.HCoordinate.prototype.initFromXY=function(x,y){this.x=x;this.y=y;this.w=1.0;};jsts.algorithm.HCoordinate.prototype.initFrom4Coordinates=function(p1,p2,q1,q2){var px,py,pw,qx,qy,qw;px=p1.y-p2.y;py=p2.x-p1.x;pw=p1.x*p2.y-p2.x*p1.y;qx=q1.y-q2.y;qy=q2.x-q1.x;qw=q1.x*q2.y-q2.x*q1.y;this.x=py*qw-qy*pw;this.y=qx*pw-px*qw;this.w=px*qy-qx*py;};jsts.algorithm.HCoordinate.prototype.getX=function(){var a=this.x/this.w;if(!isFinite(a)){throw new jsts.error.NotRepresentableError();}
return a;};jsts.algorithm.HCoordinate.prototype.getY=function(){var a=this.y/this.w;if(!isFinite(a)){throw new jsts.error.NotRepresentableError();}
return a;};jsts.algorithm.HCoordinate.prototype.getCoordinate=function(){var p=new jsts.geom.Coordinate();p.x=this.getX();p.y=this.getY();return p;};jsts.geom.LineSegment=function(){if(arguments.length===0){this.p0=new jsts.geom.Coordinate();this.p1=new jsts.geom.Coordinate();}else if(arguments.length===1){this.p0=arguments[0].p0;this.p1=arguments[0].p1;}else if(arguments.length===2){this.p0=arguments[0];this.p1=arguments[1];}else if(arguments.length===4){this.p0=new jsts.geom.Coordinate(arguments[0],arguments[1]);this.p1=new jsts.geom.Coordinate(arguments[2],arguments[3]);}};jsts.geom.LineSegment.prototype.p0=null;jsts.geom.LineSegment.prototype.p1=null;jsts.geom.LineSegment.midPoint=function(p0,p1){return new jsts.geom.Coordinate((p0.x+p1.x)/2,(p0.y+p1.y)/2);};jsts.geom.LineSegment.prototype.getCoordinate=function(i){if(i===0)return this.p0;return this.p1;};jsts.geom.LineSegment.prototype.getLength=function(){return this.p0.distance(this.p1);};jsts.geom.LineSegment.prototype.isHorizontal=function(){return this.p0.y===this.p1.y;};jsts.geom.LineSegment.prototype.isVertical=function(){return this.p0.x===this.p1.x;};jsts.geom.LineSegment.prototype.orientationIndex=function(arg){if(arg instanceof jsts.geom.LineSegment){return this.orientationIndex1(arg);}else if(arg instanceof jsts.geom.Coordinate){return this.orientationIndex2(arg);}};jsts.geom.LineSegment.prototype.orientationIndex1=function(seg){var orient0=jsts.algorithm.CGAlgorithms.orientationIndex(this.p0,this.p1,seg.p0);var orient1=jsts.algorithm.CGAlgorithms.orientationIndex(this.p0,this.p1,seg.p1);if(orient0>=0&&orient1>=0){return Math.max(orient0,orient1);}
if(orient0<=0&&orient1<=0){return Math.max(orient0,orient1);}
return 0;};jsts.geom.LineSegment.prototype.orientationIndex2=function(p){return jsts.algorithm.CGAlgorithms.orientationIndex(this.p0,this.p1,p);};jsts.geom.LineSegment.prototype.reverse=function(){var temp=this.p0;this.p0=this.p1;this.p1=temp;};jsts.geom.LineSegment.prototype.normalize=function(){if(this.p1.compareTo(this.p0)<0)this.reverse();};jsts.geom.LineSegment.prototype.angle=function(){return Math.atan2(this.p1.y-this.p0.y,this.p1.x-this.p0.x);};jsts.geom.LineSegment.prototype.midPoint=function(){return jsts.geom.LineSegment.midPoint(this.p0,this.p1);};jsts.geom.LineSegment.prototype.distance=function(arg){if(arg instanceof jsts.geom.LineSegment){return this.distance1(arg);}else if(arg instanceof jsts.geom.Coordinate){return this.distance2(arg);}};jsts.geom.LineSegment.prototype.distance1=function(ls){return jsts.algorithm.CGAlgorithms.distanceLineLine(this.p0,this.p1,ls.p0,ls.p1);};jsts.geom.LineSegment.prototype.distance2=function(p){return jsts.algorithm.CGAlgorithms.distancePointLine(p,this.p0,this.p1);};jsts.geom.LineSegment.prototype.pointAlong=function(segmentLengthFraction){var coord=new jsts.geom.Coordinate();coord.x=this.p0.x+segmentLengthFraction*(this.p1.x-this.p0.x);coord.y=this.p0.y+segmentLengthFraction*(this.p1.y-this.p0.y);return coord;};jsts.geom.LineSegment.prototype.pointAlongOffset=function(segmentLengthFraction,offsetDistance){var segx=this.p0.x+segmentLengthFraction*(this.p1.x-this.p0.x);var segy=this.p0.y+segmentLengthFraction*(this.p1.y-this.p0.y);var dx=this.p1.x-this.p0.x;var dy=this.p1.y-this.p0.y;var len=Math.sqrt(dx*dx+dy*dy);var ux=0;var uy=0;if(offsetDistance!==0){if(len<=0){throw"Cannot compute offset from zero-length line segment";}
ux=offsetDistance*dx/len;uy=offsetDistance*dy/len;}
var offsetx=segx-uy;var offsety=segy+ux;var coord=new jsts.geom.Coordinate(offsetx,offsety);return coord;};jsts.geom.LineSegment.prototype.projectionFactor=function(p){if(p.equals(this.p0))
return 0.0;if(p.equals(this.p1))
return 1.0;var dx=this.p1.x-this.p0.x;var dy=this.p1.y-this.p0.y;var len2=dx*dx+dy*dy;var r=((p.x-this.p0.x)*dx+(p.y-this.p0.y)*dy)/len2;return r;};jsts.geom.LineSegment.prototype.segmentFraction=function(inputPt){var segFrac=this.projectionFactor(inputPt);if(segFrac<0){segFrac=0;}else if(segFrac>1||isNaN(segFrac)){segFrac=1;}
return segFrac;};jsts.geom.LineSegment.prototype.project=function(arg){if(arg instanceof jsts.geom.Coordinate){return this.project1(arg);}else if(arg instanceof jsts.geom.LineSegment){return this.project2(arg);}};jsts.geom.LineSegment.prototype.project1=function(p){if(p.equals(this.p0)||p.equals(this.p1)){return new jsts.geom.Coordinate(p);}
var r=this.projectionFactor(p);var coord=new jsts.geom.Coordinate();coord.x=this.p0.x+r*(this.p1.x-this.p0.x);coord.y=this.p0.y+r*(this.p1.y-this.p0.y);return coord;};jsts.geom.LineSegment.prototype.project2=function(seg){var pf0=this.projectionFactor(seg.p0);var pf1=this.projectionFactor(seg.p1);if(pf0>=1&&pf1>=1)return null;if(pf0<=0&&pf1<=0)return null;var newp0=this.project(seg.p0);if(pf0<0)newp0=p0;if(pf0>1)newp0=p1;var newp1=this.project(seg.p1);if(pf1<0.0)newp1=p0;if(pf1>1.0)newp1=p1;return new jsts.geom.LineSegment(newp0,newp1);};jsts.geom.LineSegment.prototype.closestPoint=function(p){var factor=this.projectionFactor(p);if(factor>0&&factor<1){return this.project(p);}
var dist0=this.p0.distance(p);var dist1=this.p1.distance(p);if(dist0<dist1)
return this.p0;return this.p1;};jsts.geom.LineSegment.prototype.closestPoints=function(line){var intPt=this.intersection(line);if(intPt!==null){return[intPt,intPt];}
var closestPt=[];var minDistance=Number.MAX_VALUE;var dist;var close00=this.closestPoint(line.p0);minDistance=close00.distance(line.p0);closestPt[0]=close00;closestPt[1]=line.p0;var close01=this.closestPoint(line.p1);dist=close01.distance(line.p1);if(dist<minDistance){minDistance=dist;closestPt[0]=close01;closestPt[1]=line.p1;}
var close10=line.closestPoint(this.p0);dist=close10.distance(this.p0);if(dist<minDistance){minDistance=dist;closestPt[0]=this.p0;closestPt[1]=close10;}
var close11=line.closestPoint(this.p1);dist=close11.distance(this.p1);if(dist<minDistance){minDistance=dist;closestPt[0]=this.p1;closestPt[1]=close11;}
return closestPt;};jsts.geom.LineSegment.prototype.intersection=function(line){var li=new jsts.algorithm.RobustLineIntersector();li.computeIntersection(this.p0,this.p1,line.p0,line.p1);if(li.hasIntersection())
return li.getIntersection(0);return null;};jsts.geom.LineSegment.prototype.setCoordinates=function(ls){if(ls instanceof jsts.geom.Coordinate){this.setCoordinates2.apply(this,arguments);return;}
this.setCoordinates2(ls.p0,ls.p1);};jsts.geom.LineSegment.prototype.setCoordinates2=function(p0,p1){this.p0.x=p0.x;this.p0.y=p0.y;this.p1.x=p1.x;this.p1.y=p1.y;};jsts.geom.LineSegment.prototype.distancePerpendicular=function(p){return jsts.algorithm.CGAlgorithms.distancePointLinePerpendicular(p,this.p0,this.p1);};jsts.geom.LineSegment.prototype.lineIntersection=function(line){try{var intPt=jsts.algorithm.HCoordinate.intersection(this.p0,this.p1,line.p0,line.p1);return intPt;}catch(ex){}
return null;};jsts.geom.LineSegment.prototype.toGeometry=function(geomFactory){return geomFactory.createLineString([this.p0,this.p1]);};jsts.geom.LineSegment.prototype.equals=function(o){if(!(o instanceof jsts.geom.LineSegment)){return false;}
return this.p0.equals(o.p0)&&this.p1.equals(o.p1);};jsts.geom.LineSegment.prototype.compareTo=function(o){var comp0=this.p0.compareTo(o.p0);if(comp0!==0)return comp0;return this.p1.compareTo(o.p1);};jsts.geom.LineSegment.prototype.equalsTopo=function(other){return this.p0.equals(other.p0)&&this.p1.equals(other.p1)||this.p0.equals(other.p1)&&this.p1.equals(other.p0);};jsts.geom.LineSegment.prototype.toString=function(){return"LINESTRING("+
this.p0.x+" "+this.p0.y
+", "+
this.p1.x+" "+this.p1.y+")";};jsts.index.chain.MonotoneChainOverlapAction=function(){this.tempEnv1=new jsts.geom.Envelope();this.tempEnv2=new jsts.geom.Envelope();this.overlapSeg1=new jsts.geom.LineSegment();this.overlapSeg2=new jsts.geom.LineSegment();};jsts.index.chain.MonotoneChainOverlapAction.prototype.tempEnv1=null;jsts.index.chain.MonotoneChainOverlapAction.prototype.tempEnv2=null;jsts.index.chain.MonotoneChainOverlapAction.prototype.overlapSeg1=null;jsts.index.chain.MonotoneChainOverlapAction.prototype.overlapSeg2=null;jsts.index.chain.MonotoneChainOverlapAction.prototype.overlap=function(mc1,start1,mc2,start2){this.mc1.getLineSegment(start1,this.overlapSeg1);this.mc2.getLineSegment(start2,this.overlapSeg2);this.overlap2(this.overlapSeg1,this.overlapSeg2);};jsts.index.chain.MonotoneChainOverlapAction.prototype.overlap2=function(seg1,seg2){};(function(){var MonotoneChainOverlapAction=jsts.index.chain.MonotoneChainOverlapAction;var SinglePassNoder=jsts.noding.SinglePassNoder;var STRtree=jsts.index.strtree.STRtree;var NodedSegmentString=jsts.noding.NodedSegmentString;var MonotoneChainBuilder=jsts.index.chain.MonotoneChainBuilder;var SegmentOverlapAction=function(si){this.si=si;};SegmentOverlapAction.prototype=new MonotoneChainOverlapAction();SegmentOverlapAction.constructor=SegmentOverlapAction;SegmentOverlapAction.prototype.si=null;SegmentOverlapAction.prototype.overlap=function(mc1,start1,mc2,start2){var ss1=mc1.getContext();var ss2=mc2.getContext();this.si.processIntersections(ss1,start1,ss2,start2);};jsts.noding.MCIndexNoder=function(){this.monoChains=[];this.index=new STRtree();};jsts.noding.MCIndexNoder.prototype=new SinglePassNoder();jsts.noding.MCIndexNoder.constructor=jsts.noding.MCIndexNoder;jsts.noding.MCIndexNoder.prototype.monoChains=null;jsts.noding.MCIndexNoder.prototype.index=null;jsts.noding.MCIndexNoder.prototype.idCounter=0;jsts.noding.MCIndexNoder.prototype.nodedSegStrings=null;jsts.noding.MCIndexNoder.prototype.nOverlaps=0;jsts.noding.MCIndexNoder.prototype.getMonotoneChains=function(){return this.monoChains;};jsts.noding.MCIndexNoder.prototype.getIndex=function(){return this.index;};jsts.noding.MCIndexNoder.prototype.getNodedSubstrings=function(){return NodedSegmentString.getNodedSubstrings(this.nodedSegStrings);};jsts.noding.MCIndexNoder.prototype.computeNodes=function(inputSegStrings){this.nodedSegStrings=inputSegStrings;for(var i=inputSegStrings.iterator();i.hasNext();){this.add(i.next());}
this.intersectChains();};jsts.noding.MCIndexNoder.prototype.intersectChains=function(){var overlapAction=new SegmentOverlapAction(this.segInt);for(var i=0;i<this.monoChains.length;i++){var queryChain=this.monoChains[i];var overlapChains=this.index.query(queryChain.getEnvelope());for(var j=0;j<overlapChains.length;j++){var testChain=overlapChains[j];if(testChain.getId()>queryChain.getId()){queryChain.computeOverlaps(testChain,overlapAction);this.nOverlaps++;}
if(this.segInt.isDone())
return;}}};jsts.noding.MCIndexNoder.prototype.add=function(segStr){var segChains=MonotoneChainBuilder.getChains(segStr.getCoordinates(),segStr);for(var i=0;i<segChains.length;i++){var mc=segChains[i];mc.setId(this.idCounter++);this.index.insert(mc.getEnvelope(),mc);this.monoChains.push(mc);}};})();jsts.simplify.LineSegmentIndex=function(){this.index=new jsts.index.quadtree.Quadtree();};jsts.simplify.LineSegmentIndex.prototype.index=null;jsts.simplify.LineSegmentIndex.prototype.add=function(line){if(line instanceof jsts.geom.LineSegment){this.add2(line);return;}
var segs=line.getSegments();for(var i=0;i<segs.length;i++){var seg=segs[i];this.add2(seg);}};jsts.simplify.LineSegmentIndex.prototype.add2=function(seg){this.index.insert(new jsts.geom.Envelope(seg.p0,seg.p1),seg);};jsts.simplify.LineSegmentIndex.prototype.remove=function(seg){this.index.remove(new jsts.geom.Envelope(seg.p0,seg.p1),seg);};jsts.simplify.LineSegmentIndex.prototype.query=function(querySeg){var env=new jsts.geom.Envelope(querySeg.p0,querySeg.p1);var visitor=new jsts.simplify.LineSegmentIndex.LineSegmentVisitor(querySeg);this.index.query(env,visitor);var itemsFound=visitor.getItems();return itemsFound;};jsts.simplify.LineSegmentIndex.LineSegmentVisitor=function(querySeg){this.items=[];this.querySeg=querySeg;};jsts.simplify.LineSegmentIndex.LineSegmentVisitor.prototype=new jsts.index.ItemVisitor();jsts.simplify.LineSegmentIndex.LineSegmentVisitor.prototype.querySeg=null;jsts.simplify.LineSegmentIndex.LineSegmentVisitor.prototype.items=null;jsts.simplify.LineSegmentIndex.LineSegmentVisitor.prototype.visitItem=function(item){var seg=item;if(jsts.geom.Envelope.intersects(seg.p0,seg.p1,this.querySeg.p0,this.querySeg.p1))
this.items.push(item);};jsts.simplify.LineSegmentIndex.LineSegmentVisitor.prototype.getItems=function(){return this.items;};jsts.geomgraph.EdgeEndStar=function(){this.edgeMap=new javascript.util.TreeMap();this.edgeList=null;this.ptInAreaLocation=[jsts.geom.Location.NONE,jsts.geom.Location.NONE];};jsts.geomgraph.EdgeEndStar.prototype.edgeMap=null;jsts.geomgraph.EdgeEndStar.prototype.edgeList=null;jsts.geomgraph.EdgeEndStar.prototype.ptInAreaLocation=null;jsts.geomgraph.EdgeEndStar.prototype.insert=function(e){throw new jsts.error.AbstractMethodInvocationError();};jsts.geomgraph.EdgeEndStar.prototype.insertEdgeEnd=function(e,obj){this.edgeMap.put(e,obj);this.edgeList=null;};jsts.geomgraph.EdgeEndStar.prototype.getCoordinate=function(){var it=this.iterator();if(!it.hasNext())
return null;var e=it.next();return e.getCoordinate();};jsts.geomgraph.EdgeEndStar.prototype.getDegree=function(){return this.edgeMap.size();};jsts.geomgraph.EdgeEndStar.prototype.iterator=function(){return this.getEdges().iterator();};jsts.geomgraph.EdgeEndStar.prototype.getEdges=function(){if(this.edgeList===null){this.edgeList=new javascript.util.ArrayList(this.edgeMap.values());}
return this.edgeList;};jsts.geomgraph.EdgeEndStar.prototype.getNextCW=function(ee){this.getEdges();var i=this.edgeList.indexOf(ee);var iNextCW=i-1;if(i===0)
iNextCW=this.edgeList.length-1;return this.edgeList[iNextCW];};jsts.geomgraph.EdgeEndStar.prototype.computeLabelling=function(geomGraph){this.computeEdgeEndLabels(geomGraph[0].getBoundaryNodeRule());this.propagateSideLabels(0);this.propagateSideLabels(1);var hasDimensionalCollapseEdge=[false,false];for(var it=this.iterator();it.hasNext();){var e=it.next();var label=e.getLabel();for(var geomi=0;geomi<2;geomi++){if(label.isLine(geomi)&&label.getLocation(geomi)===jsts.geom.Location.BOUNDARY)
hasDimensionalCollapseEdge[geomi]=true;}}
for(var it=this.iterator();it.hasNext();){var e=it.next();var label=e.getLabel();for(var geomi=0;geomi<2;geomi++){if(label.isAnyNull(geomi)){var loc=jsts.geom.Location.NONE;if(hasDimensionalCollapseEdge[geomi]){loc=jsts.geom.Location.EXTERIOR;}else{var p=e.getCoordinate();loc=this.getLocation(geomi,p,geomGraph);}
label.setAllLocationsIfNull(geomi,loc);}}}};jsts.geomgraph.EdgeEndStar.prototype.computeEdgeEndLabels=function(boundaryNodeRule){for(var it=this.iterator();it.hasNext();){var ee=it.next();ee.computeLabel(boundaryNodeRule);}};jsts.geomgraph.EdgeEndStar.prototype.getLocation=function(geomIndex,p,geom){if(this.ptInAreaLocation[geomIndex]===jsts.geom.Location.NONE){this.ptInAreaLocation[geomIndex]=jsts.algorithm.locate.SimplePointInAreaLocator.locate(p,geom[geomIndex].getGeometry());}
return this.ptInAreaLocation[geomIndex];};jsts.geomgraph.EdgeEndStar.prototype.isAreaLabelsConsistent=function(geomGraph){this.computeEdgeEndLabels(geomGraph.getBoundaryNodeRule());return this.checkAreaLabelsConsistent(0);};jsts.geomgraph.EdgeEndStar.prototype.checkAreaLabelsConsistent=function(geomIndex){var edges=this.getEdges();if(edges.size()<=0)
return true;var lastEdgeIndex=edges.size()-1;var startLabel=edges.get(lastEdgeIndex).getLabel();var startLoc=startLabel.getLocation(geomIndex,jsts.geomgraph.Position.LEFT);jsts.util.Assert.isTrue(startLoc!=jsts.geom.Location.NONE,'Found unlabelled area edge');var currLoc=startLoc;for(var it=this.iterator();it.hasNext();){var e=it.next();var label=e.getLabel();jsts.util.Assert.isTrue(label.isArea(geomIndex),'Found non-area edge');var leftLoc=label.getLocation(geomIndex,jsts.geomgraph.Position.LEFT);var rightLoc=label.getLocation(geomIndex,jsts.geomgraph.Position.RIGHT);if(leftLoc===rightLoc){return false;}
if(rightLoc!==currLoc){return false;}
currLoc=leftLoc;}
return true;};jsts.geomgraph.EdgeEndStar.prototype.propagateSideLabels=function(geomIndex){var startLoc=jsts.geom.Location.NONE;for(var it=this.iterator();it.hasNext();){var e=it.next();var label=e.getLabel();if(label.isArea(geomIndex)&&label.getLocation(geomIndex,jsts.geomgraph.Position.LEFT)!==jsts.geom.Location.NONE)
startLoc=label.getLocation(geomIndex,jsts.geomgraph.Position.LEFT);}
if(startLoc===jsts.geom.Location.NONE)
return;var currLoc=startLoc;for(var it=this.iterator();it.hasNext();){var e=it.next();var label=e.getLabel();if(label.getLocation(geomIndex,jsts.geomgraph.Position.ON)===jsts.geom.Location.NONE)
label.setLocation(geomIndex,jsts.geomgraph.Position.ON,currLoc);if(label.isArea(geomIndex)){var leftLoc=label.getLocation(geomIndex,jsts.geomgraph.Position.LEFT);var rightLoc=label.getLocation(geomIndex,jsts.geomgraph.Position.RIGHT);if(rightLoc!==jsts.geom.Location.NONE){if(rightLoc!==currLoc)
throw new jsts.error.TopologyError('side location conflict',e.getCoordinate());if(leftLoc===jsts.geom.Location.NONE){jsts.util.Assert.shouldNeverReachHere('found single null side (at '+
e.getCoordinate()+')');}
currLoc=leftLoc;}else{jsts.util.Assert.isTrue(label.getLocation(geomIndex,jsts.geomgraph.Position.LEFT)===jsts.geom.Location.NONE,'found single null side');label.setLocation(geomIndex,jsts.geomgraph.Position.RIGHT,currLoc);label.setLocation(geomIndex,jsts.geomgraph.Position.LEFT,currLoc);}}}};jsts.geomgraph.EdgeEndStar.prototype.findIndex=function(eSearch){this.iterator();for(var i=0;i<this.edgeList.size();i++){var e=this.edgeList.get(i);if(e===eSearch)
return i;}
return-1;};jsts.operation.relate.EdgeEndBundleStar=function(){jsts.geomgraph.EdgeEndStar.apply(this,arguments);};jsts.operation.relate.EdgeEndBundleStar.prototype=new jsts.geomgraph.EdgeEndStar();jsts.operation.relate.EdgeEndBundleStar.prototype.insert=function(e){var eb=this.edgeMap.get(e);if(eb===null){eb=new jsts.operation.relate.EdgeEndBundle(e);this.insertEdgeEnd(e,eb);}
else{eb.insert(e);}};jsts.operation.relate.EdgeEndBundleStar.prototype.updateIM=function(im){for(var it=this.iterator();it.hasNext();){var esb=it.next();esb.updateIM(im);}};jsts.index.ArrayListVisitor=function(){this.items=[];};jsts.index.ArrayListVisitor.prototype.visitItem=function(item){this.items.push(item);};jsts.index.ArrayListVisitor.prototype.getItems=function(){return this.items;};jsts.algorithm.distance.DistanceToPoint=function(){};jsts.algorithm.distance.DistanceToPoint.computeDistance=function(geom,pt,ptDist){if(geom instanceof jsts.geom.LineString){jsts.algorithm.distance.DistanceToPoint.computeDistance2(geom,pt,ptDist);}else if(geom instanceof jsts.geom.Polygon){jsts.algorithm.distance.DistanceToPoint.computeDistance4(geom,pt,ptDist);}else if(geom instanceof jsts.geom.GeometryCollection){var gc=geom;for(var i=0;i<gc.getNumGeometries();i++){var g=gc.getGeometryN(i);jsts.algorithm.distance.DistanceToPoint.computeDistance(g,pt,ptDist);}}else{ptDist.setMinimum(geom.getCoordinate(),pt);}};jsts.algorithm.distance.DistanceToPoint.computeDistance2=function(line,pt,ptDist){var tempSegment=new jsts.geom.LineSegment();var coords=line.getCoordinates();for(var i=0;i<coords.length-1;i++){tempSegment.setCoordinates(coords[i],coords[i+1]);var closestPt=tempSegment.closestPoint(pt);ptDist.setMinimum(closestPt,pt);}};jsts.algorithm.distance.DistanceToPoint.computeDistance3=function(segment,pt,ptDist){var closestPt=segment.closestPoint(pt);ptDist.setMinimum(closestPt,pt);};jsts.algorithm.distance.DistanceToPoint.computeDistance4=function(poly,pt,ptDist){jsts.algorithm.distance.DistanceToPoint.computeDistance2(poly.getExteriorRing(),pt,ptDist);for(var i=0;i<poly.getNumInteriorRing();i++){jsts.algorithm.distance.DistanceToPoint.computeDistance2(poly.getInteriorRingN(i),pt,ptDist);}};jsts.index.strtree.ItemBoundable=function(bounds,item){this.bounds=bounds;this.item=item;};jsts.index.strtree.ItemBoundable.prototype=new jsts.index.strtree.Boundable();jsts.index.strtree.ItemBoundable.constructor=jsts.index.strtree.ItemBoundable;jsts.index.strtree.ItemBoundable.prototype.bounds=null;jsts.index.strtree.ItemBoundable.prototype.item=null;jsts.index.strtree.ItemBoundable.prototype.getBounds=function(){return this.bounds;};jsts.index.strtree.ItemBoundable.prototype.getItem=function(){return this.item;};(function(){var ArrayList=javascript.util.ArrayList;var TreeMap=javascript.util.TreeMap;jsts.geomgraph.EdgeList=function(){this.edges=new ArrayList();this.ocaMap=new TreeMap();};jsts.geomgraph.EdgeList.prototype.edges=null;jsts.geomgraph.EdgeList.prototype.ocaMap=null;jsts.geomgraph.EdgeList.prototype.add=function(e){this.edges.add(e);var oca=new jsts.noding.OrientedCoordinateArray(e.getCoordinates());this.ocaMap.put(oca,e);};jsts.geomgraph.EdgeList.prototype.addAll=function(edgeColl){for(var i=edgeColl.iterator();i.hasNext();){this.add(i.next());}};jsts.geomgraph.EdgeList.prototype.getEdges=function(){return this.edges;};jsts.geomgraph.EdgeList.prototype.findEqualEdge=function(e){var oca=new jsts.noding.OrientedCoordinateArray(e.getCoordinates());var matchEdge=this.ocaMap.get(oca);return matchEdge;};jsts.geomgraph.EdgeList.prototype.getEdges=function(){return this.edges;};jsts.geomgraph.EdgeList.prototype.iterator=function(){return this.edges.iterator();};jsts.geomgraph.EdgeList.prototype.get=function(i){return this.edges.get(i);};jsts.geomgraph.EdgeList.prototype.findEdgeIndex=function(e){for(var i=0;i<this.edges.size();i++){if(this.edges.get(i).equals(e))
return i;}
return-1;};})();jsts.operation.IsSimpleOp=function(geom){this.geom=geom;};jsts.operation.IsSimpleOp.prototype.geom=null;jsts.operation.IsSimpleOp.prototype.isClosedEndpointsInInterior=true;jsts.operation.IsSimpleOp.prototype.nonSimpleLocation=null;jsts.operation.IsSimpleOp.prototype.IsSimpleOp=function(geom){this.geom=geom;};jsts.operation.IsSimpleOp.prototype.isSimple=function(){this.nonSimpleLocation=null;if(this.geom instanceof jsts.geom.LineString){return this.isSimpleLinearGeometry(this.geom);}
if(this.geom instanceof jsts.geom.MultiLineString){return this.isSimpleLinearGeometry(this.geom);}
if(this.geom instanceof jsts.geom.MultiPoint){return this.isSimpleMultiPoint(this.geom);}
return true;};jsts.operation.IsSimpleOp.prototype.isSimpleMultiPoint=function(mp){if(mp.isEmpty())
return true;var points=[];for(var i=0;i<mp.getNumGeometries();i++){var pt=mp.getGeometryN(i);var p=pt.getCoordinate();for(var j=0;j<points.length;j++){var point=points[j];if(p.equals2D(point)){this.nonSimpleLocation=p;return false;}}
points.push(p);}
return true;};jsts.operation.IsSimpleOp.prototype.isSimpleLinearGeometry=function(geom){if(geom.isEmpty())
return true;var graph=new jsts.geomgraph.GeometryGraph(0,geom);var li=new jsts.algorithm.RobustLineIntersector();var si=graph.computeSelfNodes(li,true);if(!si.hasIntersection())
return true;if(si.hasProperIntersection()){this.nonSimpleLocation=si.getProperIntersectionPoint();return false;}
if(this.hasNonEndpointIntersection(graph))
return false;if(this.isClosedEndpointsInInterior){if(this.hasClosedEndpointIntersection(graph))
return false;}
return true;};jsts.operation.IsSimpleOp.prototype.hasNonEndpointIntersection=function(graph){for(var i=graph.getEdgeIterator();i.hasNext();){var e=i.next();var maxSegmentIndex=e.getMaximumSegmentIndex();for(var eiIt=e.getEdgeIntersectionList().iterator();eiIt.hasNext();){var ei=eiIt.next();if(!ei.isEndPoint(maxSegmentIndex)){this.nonSimpleLocation=ei.getCoordinate();return true;}}}
return false;};jsts.operation.IsSimpleOp.prototype.hasClosedEndpointIntersection=function(graph){var endPoints=new javascript.util.TreeMap();for(var i=graph.getEdgeIterator();i.hasNext();){var e=i.next();var maxSegmentIndex=e.getMaximumSegmentIndex();var isClosed=e.isClosed();var p0=e.getCoordinate(0);this.addEndpoint(endPoints,p0,isClosed);var p1=e.getCoordinate(e.getNumPoints()-1);this.addEndpoint(endPoints,p1,isClosed);}
for(var i=endPoints.values().iterator();i.hasNext();){var eiInfo=i.next();if(eiInfo.isClosed&&eiInfo.degree!=2){this.nonSimpleLocation=eiInfo.getCoordinate();return true;}}
return false;};jsts.operation.IsSimpleOp.EndpointInfo=function(pt){this.pt=pt;this.isClosed=false;this.degree=0;};jsts.operation.IsSimpleOp.EndpointInfo.prototype.pt=null;jsts.operation.IsSimpleOp.EndpointInfo.prototype.isClosed=null;jsts.operation.IsSimpleOp.EndpointInfo.prototype.degree=null;jsts.operation.IsSimpleOp.EndpointInfo.prototype.getCoordinate=function(){return this.pt;};jsts.operation.IsSimpleOp.EndpointInfo.prototype.addEndpoint=function(isClosed){this.degree++;this.isClosed=this.isClosed||isClosed;};jsts.operation.IsSimpleOp.prototype.addEndpoint=function(endPoints,p,isClosed){var eiInfo=endPoints.get(p);if(eiInfo===null){eiInfo=new jsts.operation.IsSimpleOp.EndpointInfo(p);endPoints.put(p,eiInfo);}
eiInfo.addEndpoint(isClosed);};(function(){var LineStringSnapper=function(){this.snapTolerance=0.0;this.seg=new jsts.geom.LineSegment();this.allowSnappingToSourceVertices=false;this.isClosed=false;this.srcPts=[];if(arguments[0]instanceof jsts.geom.LineString){this.initFromLine.apply(this,arguments);}else{this.initFromPoints.apply(this,arguments);}};LineStringSnapper.prototype.initFromLine=function(srcLine,snapTolerance){this.initFromPoints(srcLine.getCoordinates(),snapTolerance);};LineStringSnapper.prototype.initFromPoints=function(srcPts,snapTolerance){this.srcPts=srcPts;this.isClosed=this.calcIsClosed(srcPts);this.snapTolerance=snapTolerance;};LineStringSnapper.prototype.setAllowSnappingToSourceVertices=function(allowSnappingToSourceVertices){this.allowSnappingToSourceVertices=allowSnappingToSourceVertices;};LineStringSnapper.prototype.calcIsClosed=function(pts){if(pts.length<=1){return false;}
return pts[0].equals(pts[pts.length-1]);};LineStringSnapper.prototype.snapTo=function(snapPts){var coordList=new jsts.geom.CoordinateList(this.srcPts);this.snapVertices(coordList,snapPts);this.snapSegments(coordList,snapPts);return coordList.toCoordinateArray();};LineStringSnapper.prototype.snapVertices=function(srcCoords,snapPts){var end=this.isClosed?srcCoords.size()-1:srcCoords.size(),i=0,srcPt,snapVert;for(i;i<end;i++){srcPt=srcCoords.get(i);snapVert=this.findSnapForVertex(srcPt,snapPts);if(snapVert!==null){srcCoords.set(i,new jsts.geom.Coordinate(snapVert));if(i===0&&this.isClosed)
srcCoords.set(srcCoords.size()-1,new jsts.geom.Coordinate(snapVert));}}};LineStringSnapper.prototype.findSnapForVertex=function(pt,snapPts){var i=0,il=snapPts.length;for(i=0;i<il;i++){if(pt.equals(snapPts[i])){return null;}
if(pt.distance(snapPts[i])<this.snapTolerance){return snapPts[i];}}
return null;};LineStringSnapper.prototype.snapSegments=function(srcCoords,snapPts){if(snapPts.length===0){return;}
var distinctPtCount=snapPts.length,i,snapPt,index;if(snapPts.length>1&&snapPts[0].equals2D(snapPts[snapPts.length-1])){distinctPtCount=snapPts.length-1;}
i=0;for(i;i<distinctPtCount;i++){snapPt=snapPts[i];index=this.findSegmentIndexToSnap(snapPt,srcCoords);if(index>=0){srcCoords.add(index+1,new jsts.geom.Coordinate(snapPt),false);}}};LineStringSnapper.prototype.findSegmentIndexToSnap=function(snapPt,srcCoords){var minDist=Number.MAX_VALUE,snapIndex=-1,i=0,dist;for(i;i<srcCoords.size()-1;i++){this.seg.p0=srcCoords.get(i);this.seg.p1=srcCoords.get(i+1);if(this.seg.p0.equals(snapPt)||this.seg.p1.equals(snapPt)){if(this.allowSnappingToSourceVertices){continue;}else{return-1;}}
dist=this.seg.distance(snapPt);if(dist<this.snapTolerance&&dist<minDist){minDist=dist;snapIndex=i;}}
return snapIndex;};jsts.operation.overlay.snap.LineStringSnapper=LineStringSnapper;})();(function(){var ArrayList=javascript.util.ArrayList;var GeometryComponentFilter=jsts.geom.GeometryComponentFilter;var LineString=jsts.geom.LineString;var EdgeRing=jsts.operation.polygonize.EdgeRing;var PolygonizeGraph=jsts.operation.polygonize.PolygonizeGraph;var Polygonizer=function(){var that=this;var LineStringAdder=function(){};LineStringAdder.prototype=new GeometryComponentFilter();LineStringAdder.prototype.filter=function(g){if(g instanceof LineString)
that.add(g);};this.lineStringAdder=new LineStringAdder();this.dangles=new ArrayList();this.cutEdges=new ArrayList();this.invalidRingLines=new ArrayList();};Polygonizer.prototype.lineStringAdder=null;Polygonizer.prototype.graph=null;Polygonizer.prototype.dangles=null;Polygonizer.prototype.cutEdges=null;Polygonizer.prototype.invalidRingLines=null;Polygonizer.prototype.holeList=null;Polygonizer.prototype.shellList=null;Polygonizer.prototype.polyList=null;Polygonizer.prototype.add=function(geomList){if(geomList instanceof jsts.geom.LineString){return this.add3(geomList);}else if(geomList instanceof jsts.geom.Geometry){return this.add2(geomList);}
for(var i=geomList.iterator();i.hasNext();){var geometry=i.next();this.add2(geometry);}};Polygonizer.prototype.add2=function(g){g.apply(this.lineStringAdder);};Polygonizer.prototype.add3=function(line){if(this.graph==null)
this.graph=new PolygonizeGraph(line.getFactory());this.graph.addEdge(line);};Polygonizer.prototype.getPolygons=function(){this.polygonize();return this.polyList;};Polygonizer.prototype.getDangles=function(){this.polygonize();return this.dangles;};Polygonizer.prototype.getCutEdges=function(){this.polygonize();return this.cutEdges;};Polygonizer.prototype.getInvalidRingLines=function(){this.polygonize();return this.invalidRingLines;};Polygonizer.prototype.polygonize=function(){if(this.polyList!=null)
return;this.polyList=new ArrayList();if(this.graph==null)
return;this.dangles=this.graph.deleteDangles();this.cutEdges=this.graph.deleteCutEdges();var edgeRingList=this.graph.getEdgeRings();var validEdgeRingList=new ArrayList();this.invalidRingLines=new ArrayList();this.findValidRings(edgeRingList,validEdgeRingList,this.invalidRingLines);this.findShellsAndHoles(validEdgeRingList);Polygonizer.assignHolesToShells(this.holeList,this.shellList);this.polyList=new ArrayList();for(var i=this.shellList.iterator();i.hasNext();){var er=i.next();this.polyList.add(er.getPolygon());}};Polygonizer.prototype.findValidRings=function(edgeRingList,validEdgeRingList,invalidRingList){for(var i=edgeRingList.iterator();i.hasNext();){var er=i.next();if(er.isValid())
validEdgeRingList.add(er);else
invalidRingList.add(er.getLineString());}};Polygonizer.prototype.findShellsAndHoles=function(edgeRingList){this.holeList=new ArrayList();this.shellList=new ArrayList();for(var i=edgeRingList.iterator();i.hasNext();){var er=i.next();if(er.isHole())
this.holeList.add(er);else
this.shellList.add(er);}};Polygonizer.assignHolesToShells=function(holeList,shellList){for(var i=holeList.iterator();i.hasNext();){var holeER=i.next();Polygonizer.assignHoleToShell(holeER,shellList);}};Polygonizer.assignHoleToShell=function(holeER,shellList){var shell=EdgeRing.findEdgeRingContaining(holeER,shellList);if(shell!=null)
shell.addHole(holeER.getRing());};jsts.operation.polygonize.Polygonizer=Polygonizer;})();(function(){var ArrayList=javascript.util.ArrayList;var GeometryTransformer=function(){};GeometryTransformer.prototype.inputGeom=null;GeometryTransformer.prototype.factory=null;GeometryTransformer.prototype.pruneEmptyGeometry=true;GeometryTransformer.prototype.preserveGeometryCollectionType=true;GeometryTransformer.prototype.preserveCollections=false;GeometryTransformer.prototype.reserveType=false;GeometryTransformer.prototype.getInputGeometry=function(){return this.inputGeom;};GeometryTransformer.prototype.transform=function(inputGeom){this.inputGeom=inputGeom;this.factory=inputGeom.getFactory();if(inputGeom instanceof jsts.geom.Point)
return this.transformPoint(inputGeom,null);if(inputGeom instanceof jsts.geom.MultiPoint)
return this.transformMultiPoint(inputGeom,null);if(inputGeom instanceof jsts.geom.LinearRing)
return this.transformLinearRing(inputGeom,null);if(inputGeom instanceof jsts.geom.LineString)
return this.transformLineString(inputGeom,null);if(inputGeom instanceof jsts.geom.MultiLineString)
return this.transformMultiLineString(inputGeom,null);if(inputGeom instanceof jsts.geom.Polygon)
return this.transformPolygon(inputGeom,null);if(inputGeom instanceof jsts.geom.MultiPolygon)
return this.transformMultiPolygon(inputGeom,null);if(inputGeom instanceof jsts.geom.GeometryCollection)
return this.transformGeometryCollection(inputGeom,null);throw new jsts.error.IllegalArgumentException('Unknown Geometry subtype: '+
inputGeom.getClass().getName());};GeometryTransformer.prototype.createCoordinateSequence=function(coords){return this.factory.getCoordinateSequenceFactory().create(coords);};GeometryTransformer.prototype.copy=function(seq){return seq.clone();};GeometryTransformer.prototype.transformCoordinates=function(coords,parent){return this.copy(coords);};GeometryTransformer.prototype.transformPoint=function(geom,parent){return this.factory.createPoint(this.transformCoordinates(geom.getCoordinateSequence(),geom));};GeometryTransformer.prototype.transformMultiPoint=function(geom,parent){var transGeomList=new ArrayList();for(var i=0;i<geom.getNumGeometries();i++){var transformGeom=this.transformPoint(geom.getGeometryN(i),geom);if(transformGeom==null)
continue;if(transformGeom.isEmpty())
continue;transGeomList.add(transformGeom);}
return this.factory.buildGeometry(transGeomList);};GeometryTransformer.prototype.transformLinearRing=function(geom,parent){var seq=this.transformCoordinates(geom.getCoordinateSequence(),geom);var seqSize=seq.length;if(seqSize>0&&seqSize<4&&!this.preserveType)
return this.factory.createLineString(seq);return this.factory.createLinearRing(seq);};GeometryTransformer.prototype.transformLineString=function(geom,parent){return this.factory.createLineString(this.transformCoordinates(geom.getCoordinateSequence(),geom));};GeometryTransformer.prototype.transformMultiLineString=function(geom,parent){var transGeomList=new ArrayList();for(var i=0;i<geom.getNumGeometries();i++){var transformGeom=this.transformLineString(geom.getGeometryN(i),geom);if(transformGeom==null)
continue;if(transformGeom.isEmpty())
continue;transGeomList.add(transformGeom);}
return this.factory.buildGeometry(transGeomList);};GeometryTransformer.prototype.transformPolygon=function(geom,parent){var isAllValidLinearRings=true;var shell=this.transformLinearRing(geom.getExteriorRing(),geom);if(shell==null||!(shell instanceof jsts.geom.LinearRing)||shell.isEmpty())
isAllValidLinearRings=false;var holes=new ArrayList();for(var i=0;i<geom.getNumInteriorRing();i++){var hole=this.transformLinearRing(geom.getInteriorRingN(i),geom);if(hole==null||hole.isEmpty()){continue;}
if(!(hole instanceof jsts.geom.LinearRing))
isAllValidLinearRings=false;holes.add(hole);}
if(isAllValidLinearRings)
return this.factory.createPolygon(shell,holes.toArray());else{var components=new ArrayList();if(shell!=null)
components.add(shell);components.addAll(holes);return this.factory.buildGeometry(components);}};GeometryTransformer.prototype.transformMultiPolygon=function(geom,parent){var transGeomList=new ArrayList();for(var i=0;i<geom.getNumGeometries();i++){var transformGeom=this.transformPolygon(geom.getGeometryN(i),geom);if(transformGeom==null)
continue;if(transformGeom.isEmpty())
continue;transGeomList.add(transformGeom);}
return this.factory.buildGeometry(transGeomList);};GeometryTransformer.prototype.transformGeometryCollection=function(geom,parent){var transGeomList=new ArrayList();for(var i=0;i<geom.getNumGeometries();i++){var transformGeom=this.transform(geom.getGeometryN(i));if(transformGeom==null)
continue;if(this.pruneEmptyGeometry&&transformGeom.isEmpty())
continue;transGeomList.add(transformGeom);}
if(this.preserveGeometryCollectionType)
return this.factory.createGeometryCollection(GeometryFactory.toGeometryArray(transGeomList));return this.factory.buildGeometry(transGeomList);};jsts.geom.util.GeometryTransformer=GeometryTransformer;})();(function(){var LineStringSnapper=jsts.operation.overlay.snap.LineStringSnapper;var PrecisionModel=jsts.geom.PrecisionModel;var TreeSet=javascript.util.TreeSet;var SnapTransformer=function(snapTolerance,snapPts,isSelfSnap){this.snapTolerance=snapTolerance;this.snapPts=snapPts;this.isSelfSnap=isSelfSnap||false;};SnapTransformer.prototype=new jsts.geom.util.GeometryTransformer();SnapTransformer.prototype.snapTolerance=null;SnapTransformer.prototype.snapPts=null;SnapTransformer.prototype.isSelfSnap=false;SnapTransformer.prototype.transformCoordinates=function(coords,parent){var srcPts=coords;var newPts=this.snapLine(srcPts,this.snapPts);return newPts;};SnapTransformer.prototype.snapLine=function(srcPts,snapPts){var snapper=new LineStringSnapper(srcPts,this.snapTolerance);snapper.setAllowSnappingToSourceVertices(this.isSelfSnap);return snapper.snapTo(snapPts);};var GeometrySnapper=function(srcGeom){this.srcGeom=srcGeom;};GeometrySnapper.SNAP_PRECISION_FACTOR=1e-9;GeometrySnapper.computeOverlaySnapTolerance=function(g){if(arguments.length===2){return GeometrySnapper.computeOverlaySnapTolerance2.apply(this,arguments);}
var snapTolerance=this.computeSizeBasedSnapTolerance(g);var pm=g.getPrecisionModel();if(pm.getType()==PrecisionModel.FIXED){var fixedSnapTol=(1/pm.getScale())*2/1.415;if(fixedSnapTol>snapTolerance)
snapTolerance=fixedSnapTol;}
return snapTolerance;};GeometrySnapper.computeSizeBasedSnapTolerance=function(g){var env=g.getEnvelopeInternal();var minDimension=Math.min(env.getHeight(),env.getWidth());var snapTol=minDimension*GeometrySnapper.SNAP_PRECISION_FACTOR;return snapTol;};GeometrySnapper.computeOverlaySnapTolerance2=function(g0,g1){return Math.min(this.computeOverlaySnapTolerance(g0),this.computeOverlaySnapTolerance(g1));};GeometrySnapper.snap=function(g0,g1,snapTolerance){var snapGeom=[];var snapper0=new GeometrySnapper(g0);snapGeom[0]=snapper0.snapTo(g1,snapTolerance);var snapper1=new GeometrySnapper(g1);snapGeom[1]=snapper1.snapTo(snapGeom[0],snapTolerance);return snapGeom;};GeometrySnapper.snapToSelf=function(g0,snapTolerance,cleanResult){var snapper0=new GeometrySnapper(g0);return snapper0.snapToSelf(snapTolerance,cleanResult);};GeometrySnapper.prototype.srcGeom=null;GeometrySnapper.prototype.snapTo=function(snapGeom,snapTolerance){var snapPts=this.extractTargetCoordinates(snapGeom);var snapTrans=new SnapTransformer(snapTolerance,snapPts);return snapTrans.transform(this.srcGeom);};GeometrySnapper.prototype.snapToSelf=function(snapTolerance,cleanResult){var snapPts=this.extractTargetCoordinates(srcGeom);var snapTrans=new SnapTransformer(snapTolerance,snapPts,true);var snappedGeom=snapTrans.transform(srcGeom);var result=snappedGeom;if(cleanResult&&result instanceof Polygonal){result=snappedGeom.buffer(0);}
return result;};GeometrySnapper.prototype.extractTargetCoordinates=function(g){var ptSet=new TreeSet();var pts=g.getCoordinates();for(var i=0;i<pts.length;i++){ptSet.add(pts[i]);}
return ptSet.toArray();};GeometrySnapper.prototype.computeSnapTolerance=function(ringPts){var minSegLen=this.computeMinimumSegmentLength(ringPts);var snapTol=minSegLen/10;return snapTol;};GeometrySnapper.prototype.computeMinimumSegmentLength=function(pts){var minSegLen=Number.MAX_VALUE;for(var i=0;i<pts.length-1;i++){var segLen=pts[i].distance(pts[i+1]);if(segLen<minSegLen)
minSegLen=segLen;}
return minSegLen;};jsts.operation.overlay.snap.GeometrySnapper=GeometrySnapper;})();jsts.algorithm.PointLocator=function(boundaryRule){this.boundaryRule=boundaryRule?boundaryRule:jsts.algorithm.BoundaryNodeRule.OGC_SFS_BOUNDARY_RULE;};jsts.algorithm.PointLocator.prototype.boundaryRule=null;jsts.algorithm.PointLocator.prototype.isIn=null;jsts.algorithm.PointLocator.prototype.numBoundaries=null;jsts.algorithm.PointLocator.prototype.intersects=function(p,geom){return this.locate(p,geom)!==jsts.geom.Location.EXTERIOR;};jsts.algorithm.PointLocator.prototype.locate=function(p,geom){if(geom.isEmpty())
return jsts.geom.Location.EXTERIOR;if(geom instanceof jsts.geom.Point){return this.locate2(p,geom);}else if(geom instanceof jsts.geom.LineString){return this.locate3(p,geom);}else if(geom instanceof jsts.geom.Polygon){return this.locate4(p,geom);}
this.isIn=false;this.numBoundaries=0;this.computeLocation(p,geom);if(this.boundaryRule.isInBoundary(this.numBoundaries))
return jsts.geom.Location.BOUNDARY;if(this.numBoundaries>0||this.isIn)
return jsts.geom.Location.INTERIOR;return jsts.geom.Location.EXTERIOR;};jsts.algorithm.PointLocator.prototype.computeLocation=function(p,geom){if(geom instanceof jsts.geom.Point||geom instanceof jsts.geom.LineString||geom instanceof jsts.geom.Polygon){this.updateLocationInfo(this.locate(p,geom));}else if(geom instanceof jsts.geom.MultiLineString){var ml=geom;for(var i=0;i<ml.getNumGeometries();i++){var l=ml.getGeometryN(i);this.updateLocationInfo(this.locate(p,l));}}else if(geom instanceof jsts.geom.MultiPolygon){var mpoly=geom;for(var i=0;i<mpoly.getNumGeometries();i++){var poly=mpoly.getGeometryN(i);this.updateLocationInfo(this.locate(p,poly));}}else if(geom instanceof jsts.geom.MultiPoint||geom instanceof jsts.geom.GeometryCollection){for(var i=0;i<geom.getNumGeometries();i++){var part=geom.getGeometryN(i);if(part!==geom){this.computeLocation(p,part);}}}};jsts.algorithm.PointLocator.prototype.updateLocationInfo=function(loc){if(loc===jsts.geom.Location.INTERIOR)
this.isIn=true;if(loc===jsts.geom.Location.BOUNDARY)
this.numBoundaries++;};jsts.algorithm.PointLocator.prototype.locate2=function(p,pt){var ptCoord=pt.getCoordinate();if(ptCoord.equals2D(p))
return jsts.geom.Location.INTERIOR;return jsts.geom.Location.EXTERIOR;};jsts.algorithm.PointLocator.prototype.locate3=function(p,l){if(!l.getEnvelopeInternal().intersects(p))
return jsts.geom.Location.EXTERIOR;var pt=l.getCoordinates();if(!l.isClosed()){if(p.equals(pt[0])||p.equals(pt[pt.length-1])){return jsts.geom.Location.BOUNDARY;}}
if(jsts.algorithm.CGAlgorithms.isOnLine(p,pt))
return jsts.geom.Location.INTERIOR;return jsts.geom.Location.EXTERIOR;};jsts.algorithm.PointLocator.prototype.locateInPolygonRing=function(p,ring){if(!ring.getEnvelopeInternal().intersects(p))
return jsts.geom.Location.EXTERIOR;return jsts.algorithm.CGAlgorithms.locatePointInRing(p,ring.getCoordinates());};jsts.algorithm.PointLocator.prototype.locate4=function(p,poly){if(poly.isEmpty())
return jsts.geom.Location.EXTERIOR;var shell=poly.getExteriorRing();var shellLoc=this.locateInPolygonRing(p,shell);if(shellLoc===jsts.geom.Location.EXTERIOR)
return jsts.geom.Location.EXTERIOR;if(shellLoc===jsts.geom.Location.BOUNDARY)
return jsts.geom.Location.BOUNDARY;for(var i=0;i<poly.getNumInteriorRing();i++){var hole=poly.getInteriorRingN(i);var holeLoc=this.locateInPolygonRing(p,hole);if(holeLoc===jsts.geom.Location.INTERIOR)
return jsts.geom.Location.EXTERIOR;if(holeLoc===jsts.geom.Location.BOUNDARY)
return jsts.geom.Location.BOUNDARY;}
return jsts.geom.Location.INTERIOR;};(function(){var Location=jsts.geom.Location;var ArrayList=javascript.util.ArrayList;var TreeMap=javascript.util.TreeMap;jsts.geomgraph.NodeMap=function(nodeFactory){this.nodeMap=new TreeMap();this.nodeFact=nodeFactory;};jsts.geomgraph.NodeMap.prototype.nodeMap=null;jsts.geomgraph.NodeMap.prototype.nodeFact=null;jsts.geomgraph.NodeMap.prototype.addNode=function(arg){var node,coord;if(arg instanceof jsts.geom.Coordinate){coord=arg;node=this.nodeMap.get(coord);if(node===null){node=this.nodeFact.createNode(coord);this.nodeMap.put(coord,node);}
return node;}else if(arg instanceof jsts.geomgraph.Node){var n=arg;coord=n.getCoordinate();node=this.nodeMap.get(coord);if(node===null){this.nodeMap.put(coord,n);return n;}
node.mergeLabel(n);return node;}};jsts.geomgraph.NodeMap.prototype.add=function(e){var p=e.getCoordinate();var n=this.addNode(p);n.add(e);};jsts.geomgraph.NodeMap.prototype.find=function(coord){return this.nodeMap.get(coord);};jsts.geomgraph.NodeMap.prototype.values=function(){return this.nodeMap.values();};jsts.geomgraph.NodeMap.prototype.iterator=function(){return this.values().iterator();};jsts.geomgraph.NodeMap.prototype.getBoundaryNodes=function(geomIndex){var bdyNodes=new ArrayList();for(var i=this.iterator();i.hasNext();){var node=i.next();if(node.getLabel().getLocation(geomIndex)===Location.BOUNDARY){bdyNodes.add(node);}}
return bdyNodes;};})();(function(){var ArrayList=javascript.util.ArrayList;jsts.geomgraph.PlanarGraph=function(nodeFactory){this.edges=new ArrayList();this.edgeEndList=new ArrayList();this.nodes=new jsts.geomgraph.NodeMap(nodeFactory||new jsts.geomgraph.NodeFactory());};jsts.geomgraph.PlanarGraph.prototype.edges=null;jsts.geomgraph.PlanarGraph.prototype.nodes=null;jsts.geomgraph.PlanarGraph.prototype.edgeEndList=null;jsts.geomgraph.PlanarGraph.linkResultDirectedEdges=function(nodes){for(var nodeit=nodes.iterator();nodeit.hasNext();){var node=nodeit.next();node.getEdges().linkResultDirectedEdges();}};jsts.geomgraph.PlanarGraph.prototype.getEdgeIterator=function(){return this.edges.iterator();};jsts.geomgraph.PlanarGraph.prototype.getEdgeEnds=function(){return this.edgeEndList;};jsts.geomgraph.PlanarGraph.prototype.isBoundaryNode=function(geomIndex,coord){var node=this.nodes.find(coord);if(node===null)
return false;var label=node.getLabel();if(label!==null&&label.getLocation(geomIndex)===jsts.geom.Location.BOUNDARY)
return true;return false;};jsts.geomgraph.PlanarGraph.prototype.insertEdge=function(e){this.edges.add(e);};jsts.geomgraph.PlanarGraph.prototype.add=function(e){this.nodes.add(e);this.edgeEndList.add(e);};jsts.geomgraph.PlanarGraph.prototype.getNodeIterator=function(){return this.nodes.iterator();};jsts.geomgraph.PlanarGraph.prototype.getNodes=function(){return this.nodes.values();};jsts.geomgraph.PlanarGraph.prototype.addNode=function(node){return this.nodes.addNode(node);};jsts.geomgraph.PlanarGraph.prototype.addEdges=function(edgesToAdd){for(var it=edgesToAdd.iterator();it.hasNext();){var e=it.next();this.edges.add(e);var de1=new jsts.geomgraph.DirectedEdge(e,true);var de2=new jsts.geomgraph.DirectedEdge(e,false);de1.setSym(de2);de2.setSym(de1);this.add(de1);this.add(de2);}};jsts.geomgraph.PlanarGraph.prototype.linkResultDirectedEdges=function(){for(var nodeit=this.nodes.iterator();nodeit.hasNext();){var node=nodeit.next();node.getEdges().linkResultDirectedEdges();}};jsts.geomgraph.PlanarGraph.prototype.findEdgeInSameDirection=function(p0,p1){var i=0,il=this.edges.size(),e,eCoord;for(i;i<il;i++){e=this.edges.get(i);eCoord=e.getCoordinates();if(this.matchInSameDirection(p0,p1,eCoord[0],eCoord[1])){return e;}
if(this.matchInSameDirection(p0,p1,eCoord[eCoord.length-1],eCoord[eCoord.length-2])){return e;}}
return null;};jsts.geomgraph.PlanarGraph.prototype.matchInSameDirection=function(p0,p1,ep0,ep1){if(!p0.equals(ep0)){return false;}
if(jsts.algorithm.CGAlgorithms.computeOrientation(p0,p1,ep1)===jsts.algorithm.CGAlgorithms.COLLINEAR&&jsts.geomgraph.Quadrant.quadrant(p0,p1)===jsts.geomgraph.Quadrant.quadrant(ep0,ep1)){return true;}
return false;};jsts.geomgraph.PlanarGraph.prototype.findEdgeEnd=function(e){for(var i=this.getEdgeEnds().iterator();i.hasNext();){var ee=i.next();if(ee.getEdge()===e){return ee;}}
return null;};})();jsts.noding.SegmentIntersector=function(){};jsts.noding.SegmentIntersector.prototype.processIntersections=jsts.abstractFunc;jsts.noding.SegmentIntersector.prototype.isDone=jsts.abstractFunc;(function(){var SegmentIntersector=jsts.noding.SegmentIntersector;var ArrayList=javascript.util.ArrayList;jsts.noding.InteriorIntersectionFinder=function(li){this.li=li;this.intersections=new ArrayList();this.interiorIntersection=null;};jsts.noding.InteriorIntersectionFinder.prototype=new SegmentIntersector();jsts.noding.InteriorIntersectionFinder.constructor=jsts.noding.InteriorIntersectionFinder;jsts.noding.InteriorIntersectionFinder.prototype.findAllIntersections=false;jsts.noding.InteriorIntersectionFinder.prototype.isCheckEndSegmentsOnly=false;jsts.noding.InteriorIntersectionFinder.prototype.li=null;jsts.noding.InteriorIntersectionFinder.prototype.interiorIntersection=null;jsts.noding.InteriorIntersectionFinder.prototype.intSegments=null;jsts.noding.InteriorIntersectionFinder.prototype.intersections=null;jsts.noding.InteriorIntersectionFinder.prototype.setFindAllIntersections=function(findAllIntersections){this.findAllIntersections=findAllIntersections;};jsts.noding.InteriorIntersectionFinder.prototype.getIntersections=function(){return intersections;};jsts.noding.InteriorIntersectionFinder.prototype.setCheckEndSegmentsOnly=function(isCheckEndSegmentsOnly){this.isCheckEndSegmentsOnly=isCheckEndSegmentsOnly;}
jsts.noding.InteriorIntersectionFinder.prototype.hasIntersection=function(){return this.interiorIntersection!=null;};jsts.noding.InteriorIntersectionFinder.prototype.getInteriorIntersection=function(){return this.interiorIntersection;};jsts.noding.InteriorIntersectionFinder.prototype.getIntersectionSegments=function(){return this.intSegments;};jsts.noding.InteriorIntersectionFinder.prototype.processIntersections=function(e0,segIndex0,e1,segIndex1){if(this.hasIntersection())
return;if(e0==e1&&segIndex0==segIndex1)
return;if(this.isCheckEndSegmentsOnly){var isEndSegPresent=this.isEndSegment(e0,segIndex0)||isEndSegment(e1,segIndex1);if(!isEndSegPresent)
return;}
var p00=e0.getCoordinates()[segIndex0];var p01=e0.getCoordinates()[segIndex0+1];var p10=e1.getCoordinates()[segIndex1];var p11=e1.getCoordinates()[segIndex1+1];this.li.computeIntersection(p00,p01,p10,p11);if(this.li.hasIntersection()){if(this.li.isInteriorIntersection()){this.intSegments=[];this.intSegments[0]=p00;this.intSegments[1]=p01;this.intSegments[2]=p10;this.intSegments[3]=p11;this.interiorIntersection=this.li.getIntersection(0);this.intersections.add(this.interiorIntersection);}}};jsts.noding.InteriorIntersectionFinder.prototype.isEndSegment=function(segStr,index){if(index==0)
return true;if(index>=segStr.size()-2)
return true;return false;};jsts.noding.InteriorIntersectionFinder.prototype.isDone=function(){if(this.findAllIntersections)
return false;return this.interiorIntersection!=null;};})();(function(){var RobustLineIntersector=jsts.algorithm.RobustLineIntersector;var InteriorIntersectionFinder=jsts.noding.InteriorIntersectionFinder;var MCIndexNoder=jsts.noding.MCIndexNoder;jsts.noding.FastNodingValidator=function(segStrings){this.li=new RobustLineIntersector();this.segStrings=segStrings;};jsts.noding.FastNodingValidator.prototype.li=null;jsts.noding.FastNodingValidator.prototype.segStrings=null;jsts.noding.FastNodingValidator.prototype.findAllIntersections=false;jsts.noding.FastNodingValidator.prototype.segInt=null;jsts.noding.FastNodingValidator.prototype._isValid=true;jsts.noding.FastNodingValidator.prototype.setFindAllIntersections=function(findAllIntersections){this.findAllIntersections=findAllIntersections;};jsts.noding.FastNodingValidator.prototype.getIntersections=function(){return segInt.getIntersections();};jsts.noding.FastNodingValidator.prototype.isValid=function(){this.execute();return this._isValid;};jsts.noding.FastNodingValidator.prototype.getErrorMessage=function(){if(this._isValid)
return'no intersections found';var intSegs=this.segInt.getIntersectionSegments();return'found non-noded intersection between '+
jsts.io.WKTWriter.toLineString(intSegs[0],intSegs[1])+' and '+
jsts.io.WKTWriter.toLineString(intSegs[2],intSegs[3]);};jsts.noding.FastNodingValidator.prototype.checkValid=function(){this.execute();if(!this._isValid)
throw new jsts.error.TopologyError(this.getErrorMessage(),this.segInt.getInteriorIntersection());};jsts.noding.FastNodingValidator.prototype.execute=function(){if(this.segInt!=null)
return;this.checkInteriorIntersections();};jsts.noding.FastNodingValidator.prototype.checkInteriorIntersections=function(){this._isValid=true;this.segInt=new InteriorIntersectionFinder(this.li);this.segInt.setFindAllIntersections(this.findAllIntersections);var noder=new MCIndexNoder();noder.setSegmentIntersector(this.segInt);noder.computeNodes(this.segStrings);if(this.segInt.hasIntersection()){this._isValid=false;return;}};})();(function(){jsts.noding.BasicSegmentString=function(pts,data){this.pts=pts;this.data=data;};jsts.noding.BasicSegmentString.prototype=new jsts.noding.SegmentString();jsts.noding.BasicSegmentString.prototype.pts=null;jsts.noding.BasicSegmentString.prototype.data=null;jsts.noding.BasicSegmentString.prototype.getData=function(){return this.data;}
jsts.noding.BasicSegmentString.prototype.setData=function(data){this.data=data;};jsts.noding.BasicSegmentString.prototype.size=function(){return this.pts.length;};jsts.noding.BasicSegmentString.prototype.getCoordinate=function(i){return this.pts[i];};jsts.noding.BasicSegmentString.prototype.getCoordinates=function(){return this.pts;};jsts.noding.BasicSegmentString.prototype.isClosed=function(){return this.pts[0].equals(this.pts[this.pts.length-1]);};jsts.noding.BasicSegmentString.prototype.getSegmentOctant=function(index){if(index==this.pts.length-1)
return-1;return jsts.noding.Octant.octant(this.getCoordinate(index),this.getCoordinate(index+1));};})();(function(){var FastNodingValidator=jsts.noding.FastNodingValidator;var BasicSegmentString=jsts.noding.BasicSegmentString;var ArrayList=javascript.util.ArrayList;jsts.geomgraph.EdgeNodingValidator=function(edges){this.nv=new FastNodingValidator(jsts.geomgraph.EdgeNodingValidator.toSegmentStrings(edges));};jsts.geomgraph.EdgeNodingValidator.checkValid=function(edges){var validator=new jsts.geomgraph.EdgeNodingValidator(edges);validator.checkValid();};jsts.geomgraph.EdgeNodingValidator.toSegmentStrings=function(edges){var segStrings=new ArrayList();for(var i=edges.iterator();i.hasNext();){var e=i.next();segStrings.add(new BasicSegmentString(e.getCoordinates(),e));}
return segStrings;};jsts.geomgraph.EdgeNodingValidator.prototype.nv=null;jsts.geomgraph.EdgeNodingValidator.prototype.checkValid=function(){this.nv.checkValid();};})();jsts.operation.GeometryGraphOperation=function(g0,g1,boundaryNodeRule){this.li=new jsts.algorithm.RobustLineIntersector();this.arg=[];if(g0===undefined){return;}
if(g1===undefined){this.setComputationPrecision(g0.getPrecisionModel());this.arg[0]=new jsts.geomgraph.GeometryGraph(0,g0);return;}
boundaryNodeRule=boundaryNodeRule||jsts.algorithm.BoundaryNodeRule.OGC_SFS_BOUNDARY_RULE;if(g0.getPrecisionModel().compareTo(g1.getPrecisionModel())>=0)
this.setComputationPrecision(g0.getPrecisionModel());else
this.setComputationPrecision(g1.getPrecisionModel());this.arg[0]=new jsts.geomgraph.GeometryGraph(0,g0,boundaryNodeRule);this.arg[1]=new jsts.geomgraph.GeometryGraph(1,g1,boundaryNodeRule);};jsts.operation.GeometryGraphOperation.prototype.li=null;jsts.operation.GeometryGraphOperation.prototype.resultPrecisionModel=null;jsts.operation.GeometryGraphOperation.prototype.arg=null;jsts.operation.GeometryGraphOperation.prototype.getArgGeometry=function(i){return arg[i].getGeometry();};jsts.operation.GeometryGraphOperation.prototype.setComputationPrecision=function(pm){this.resultPrecisionModel=pm;this.li.setPrecisionModel(this.resultPrecisionModel);};jsts.operation.overlay.OverlayNodeFactory=function(){};jsts.operation.overlay.OverlayNodeFactory.prototype=new jsts.geomgraph.NodeFactory();jsts.operation.overlay.OverlayNodeFactory.constructor=jsts.operation.overlay.OverlayNodeFactory;jsts.operation.overlay.OverlayNodeFactory.prototype.createNode=function(coord){return new jsts.geomgraph.Node(coord,new jsts.geomgraph.DirectedEdgeStar());};jsts.operation.overlay.PolygonBuilder=function(geometryFactory){this.shellList=[];this.geometryFactory=geometryFactory;};jsts.operation.overlay.PolygonBuilder.prototype.geometryFactory=null;jsts.operation.overlay.PolygonBuilder.prototype.shellList=null;jsts.operation.overlay.PolygonBuilder.prototype.add=function(graph){if(arguments.length===2){this.add2.apply(this,arguments);return;}
this.add2(graph.getEdgeEnds(),graph.getNodes());};jsts.operation.overlay.PolygonBuilder.prototype.add2=function(dirEdges,nodes){jsts.geomgraph.PlanarGraph.linkResultDirectedEdges(nodes);var maxEdgeRings=this.buildMaximalEdgeRings(dirEdges);var freeHoleList=[];var edgeRings=this.buildMinimalEdgeRings(maxEdgeRings,this.shellList,freeHoleList);this.sortShellsAndHoles(edgeRings,this.shellList,freeHoleList);this.placeFreeHoles(this.shellList,freeHoleList);};jsts.operation.overlay.PolygonBuilder.prototype.getPolygons=function(){var resultPolyList=this.computePolygons(this.shellList);return resultPolyList;};jsts.operation.overlay.PolygonBuilder.prototype.buildMaximalEdgeRings=function(dirEdges){var maxEdgeRings=[];for(var it=dirEdges.iterator();it.hasNext();){var de=it.next();if(de.isInResult()&&de.getLabel().isArea()){if(de.getEdgeRing()==null){var er=new jsts.operation.overlay.MaximalEdgeRing(de,this.geometryFactory);maxEdgeRings.push(er);er.setInResult();}}}
return maxEdgeRings;};jsts.operation.overlay.PolygonBuilder.prototype.buildMinimalEdgeRings=function(maxEdgeRings,shellList,freeHoleList){var edgeRings=[];for(var i=0;i<maxEdgeRings.length;i++){var er=maxEdgeRings[i];if(er.getMaxNodeDegree()>2){er.linkDirectedEdgesForMinimalEdgeRings();var minEdgeRings=er.buildMinimalRings();var shell=this.findShell(minEdgeRings);if(shell!==null){this.placePolygonHoles(shell,minEdgeRings);shellList.push(shell);}else{freeHoleList=freeHoleList.concat(minEdgeRings);}}else{edgeRings.push(er);}}
return edgeRings;};jsts.operation.overlay.PolygonBuilder.prototype.findShell=function(minEdgeRings){var shellCount=0;var shell=null;for(var i=0;i<minEdgeRings.length;i++){var er=minEdgeRings[i];if(!er.isHole()){shell=er;shellCount++;}}
jsts.util.Assert.isTrue(shellCount<=1,'found two shells in MinimalEdgeRing list');return shell;};jsts.operation.overlay.PolygonBuilder.prototype.placePolygonHoles=function(shell,minEdgeRings){for(var i=0;i<minEdgeRings.length;i++){var er=minEdgeRings[i];if(er.isHole()){er.setShell(shell);}}};jsts.operation.overlay.PolygonBuilder.prototype.sortShellsAndHoles=function(edgeRings,shellList,freeHoleList){for(var i=0;i<edgeRings.length;i++){var er=edgeRings[i];if(er.isHole()){freeHoleList.push(er);}else{shellList.push(er);}}};jsts.operation.overlay.PolygonBuilder.prototype.placeFreeHoles=function(shellList,freeHoleList){for(var i=0;i<freeHoleList.length;i++){var hole=freeHoleList[i];if(hole.getShell()==null){var shell=this.findEdgeRingContaining(hole,shellList);if(shell===null)
throw new jsts.error.TopologyError('unable to assign hole to a shell',hole.getCoordinate(0));hole.setShell(shell);}}};jsts.operation.overlay.PolygonBuilder.prototype.findEdgeRingContaining=function(testEr,shellList){var testRing=testEr.getLinearRing();var testEnv=testRing.getEnvelopeInternal();var testPt=testRing.getCoordinateN(0);var minShell=null;var minEnv=null;for(var i=0;i<shellList.length;i++){var tryShell=shellList[i];var tryRing=tryShell.getLinearRing();var tryEnv=tryRing.getEnvelopeInternal();if(minShell!==null)
minEnv=minShell.getLinearRing().getEnvelopeInternal();var isContained=false;if(tryEnv.contains(testEnv)&&jsts.algorithm.CGAlgorithms.isPointInRing(testPt,tryRing.getCoordinates()))
isContained=true;if(isContained){if(minShell==null||minEnv.contains(tryEnv)){minShell=tryShell;}}}
return minShell;};jsts.operation.overlay.PolygonBuilder.prototype.computePolygons=function(shellList){var resultPolyList=new javascript.util.ArrayList();for(var i=0;i<shellList.length;i++){var er=shellList[i];var poly=er.toPolygon(this.geometryFactory);resultPolyList.add(poly);}
return resultPolyList;};jsts.operation.overlay.PolygonBuilder.prototype.containsPoint=function(p){for(var i=0;i<this.shellList.length;i++){var er=this.shellList[i];if(er.containsPoint(p))
return true;}
return false;};(function(){var Assert=jsts.util.Assert;var ArrayList=javascript.util.ArrayList;var LineBuilder=function(op,geometryFactory,ptLocator){this.lineEdgesList=new ArrayList();this.resultLineList=new ArrayList();this.op=op;this.geometryFactory=geometryFactory;this.ptLocator=ptLocator;};LineBuilder.prototype.op=null;LineBuilder.prototype.geometryFactory=null;LineBuilder.prototype.ptLocator=null;LineBuilder.prototype.lineEdgesList=null;LineBuilder.prototype.resultLineList=null;LineBuilder.prototype.build=function(opCode){this.findCoveredLineEdges();this.collectLines(opCode);this.buildLines(opCode);return this.resultLineList;};LineBuilder.prototype.findCoveredLineEdges=function(){for(var nodeit=this.op.getGraph().getNodes().iterator();nodeit.hasNext();){var node=nodeit.next();node.getEdges().findCoveredLineEdges();}
for(var it=this.op.getGraph().getEdgeEnds().iterator();it.hasNext();){var de=it.next();var e=de.getEdge();if(de.isLineEdge()&&!e.isCoveredSet()){var isCovered=this.op.isCoveredByA(de.getCoordinate());e.setCovered(isCovered);}}};LineBuilder.prototype.collectLines=function(opCode){for(var it=this.op.getGraph().getEdgeEnds().iterator();it.hasNext();){var de=it.next();this.collectLineEdge(de,opCode,this.lineEdgesList);this.collectBoundaryTouchEdge(de,opCode,this.lineEdgesList);}};LineBuilder.prototype.collectLineEdge=function(de,opCode,edges){var label=de.getLabel();var e=de.getEdge();if(de.isLineEdge()){if(!de.isVisited()&&jsts.operation.overlay.OverlayOp.isResultOfOp(label,opCode)&&!e.isCovered()){edges.add(e);de.setVisitedEdge(true);}}};LineBuilder.prototype.collectBoundaryTouchEdge=function(de,opCode,edges){var label=de.getLabel();if(de.isLineEdge())
return;if(de.isVisited())
return;if(de.isInteriorAreaEdge())
return;if(de.getEdge().isInResult())
return;Assert.isTrue(!(de.isInResult()||de.getSym().isInResult())||!de.getEdge().isInResult());if(jsts.operation.overlay.OverlayOp.isResultOfOp(label,opCode)&&opCode===jsts.operation.overlay.OverlayOp.INTERSECTION){edges.add(de.getEdge());de.setVisitedEdge(true);}};LineBuilder.prototype.buildLines=function(opCode){for(var it=this.lineEdgesList.iterator();it.hasNext();){var e=it.next();var label=e.getLabel();var line=this.geometryFactory.createLineString(e.getCoordinates());this.resultLineList.add(line);e.setInResult(true);}};LineBuilder.prototype.labelIsolatedLines=function(edgesList){for(var it=edgesList.iterator();it.hasNext();){var e=it.next();var label=e.getLabel();if(e.isIsolated()){if(label.isNull(0))
this.labelIsolatedLine(e,0);else
this.labelIsolatedLine(e,1);}}};LineBuilder.prototype.labelIsolatedLine=function(e,targetIndex){var loc=ptLocator.locate(e.getCoordinate(),op.getArgGeometry(targetIndex));e.getLabel().setLocation(targetIndex,loc);};jsts.operation.overlay.LineBuilder=LineBuilder;})();(function(){var ArrayList=javascript.util.ArrayList;var PointBuilder=function(op,geometryFactory,ptLocator){this.resultPointList=new ArrayList();this.op=op;this.geometryFactory=geometryFactory;};PointBuilder.prototype.op=null;PointBuilder.prototype.geometryFactory=null;PointBuilder.prototype.resultPointList=null;PointBuilder.prototype.build=function(opCode){this.extractNonCoveredResultNodes(opCode);return this.resultPointList;};PointBuilder.prototype.extractNonCoveredResultNodes=function(opCode){for(var nodeit=this.op.getGraph().getNodes().iterator();nodeit.hasNext();){var n=nodeit.next();if(n.isInResult())
continue;if(n.isIncidentEdgeInResult())
continue;if(n.getEdges().getDegree()===0||opCode===jsts.operation.overlay.OverlayOp.INTERSECTION){var label=n.getLabel();if(jsts.operation.overlay.OverlayOp.isResultOfOp(label,opCode)){this.filterCoveredNodeToPoint(n);}}}};PointBuilder.prototype.filterCoveredNodeToPoint=function(n){var coord=n.getCoordinate();if(!this.op.isCoveredByLA(coord)){var pt=this.geometryFactory.createPoint(coord);this.resultPointList.add(pt);}};jsts.operation.overlay.PointBuilder=PointBuilder;})();(function(){var PointLocator=jsts.algorithm.PointLocator;var Location=jsts.geom.Location;var EdgeList=jsts.geomgraph.EdgeList;var Label=jsts.geomgraph.Label;var PlanarGraph=jsts.geomgraph.PlanarGraph;var Position=jsts.geomgraph.Position;var EdgeNodingValidator=jsts.geomgraph.EdgeNodingValidator;var GeometryGraphOperation=jsts.operation.GeometryGraphOperation;var OverlayNodeFactory=jsts.operation.overlay.OverlayNodeFactory;var PolygonBuilder=jsts.operation.overlay.PolygonBuilder;var LineBuilder=jsts.operation.overlay.LineBuilder;var PointBuilder=jsts.operation.overlay.PointBuilder;var Assert=jsts.util.Assert;var ArrayList=javascript.util.ArrayList;jsts.operation.overlay.OverlayOp=function(g0,g1){this.ptLocator=new PointLocator();this.edgeList=new EdgeList();this.resultPolyList=new ArrayList();this.resultLineList=new ArrayList();this.resultPointList=new ArrayList();GeometryGraphOperation.call(this,g0,g1);this.graph=new PlanarGraph(new OverlayNodeFactory());this.geomFact=g0.getFactory();};jsts.operation.overlay.OverlayOp.prototype=new GeometryGraphOperation();jsts.operation.overlay.OverlayOp.constructor=jsts.operation.overlay.OverlayOp;jsts.operation.overlay.OverlayOp.INTERSECTION=1;jsts.operation.overlay.OverlayOp.UNION=2;jsts.operation.overlay.OverlayOp.DIFFERENCE=3;jsts.operation.overlay.OverlayOp.SYMDIFFERENCE=4;jsts.operation.overlay.OverlayOp.overlayOp=function(geom0,geom1,opCode){var gov=new jsts.operation.overlay.OverlayOp(geom0,geom1);var geomOv=gov.getResultGeometry(opCode);return geomOv;}
jsts.operation.overlay.OverlayOp.isResultOfOp=function(label,opCode){if(arguments.length===3){return jsts.operation.overlay.OverlayOp.isResultOfOp2.apply(this,arguments);}
var loc0=label.getLocation(0);var loc1=label.getLocation(1);return jsts.operation.overlay.OverlayOp.isResultOfOp2(loc0,loc1,opCode);}
jsts.operation.overlay.OverlayOp.isResultOfOp2=function(loc0,loc1,opCode){if(loc0==Location.BOUNDARY)
loc0=Location.INTERIOR;if(loc1==Location.BOUNDARY)
loc1=Location.INTERIOR;switch(opCode){case jsts.operation.overlay.OverlayOp.INTERSECTION:return loc0==Location.INTERIOR&&loc1==Location.INTERIOR;case jsts.operation.overlay.OverlayOp.UNION:return loc0==Location.INTERIOR||loc1==Location.INTERIOR;case jsts.operation.overlay.OverlayOp.DIFFERENCE:return loc0==Location.INTERIOR&&loc1!=Location.INTERIOR;case jsts.operation.overlay.OverlayOp.SYMDIFFERENCE:return(loc0==Location.INTERIOR&&loc1!=Location.INTERIOR)||(loc0!=Location.INTERIOR&&loc1==Location.INTERIOR);}
return false;}
jsts.operation.overlay.OverlayOp.prototype.ptLocator=null;jsts.operation.overlay.OverlayOp.prototype.geomFact=null;jsts.operation.overlay.OverlayOp.prototype.resultGeom=null;jsts.operation.overlay.OverlayOp.prototype.graph=null;jsts.operation.overlay.OverlayOp.prototype.edgeList=null;jsts.operation.overlay.OverlayOp.prototype.resultPolyList=null;jsts.operation.overlay.OverlayOp.prototype.resultLineList=null;jsts.operation.overlay.OverlayOp.prototype.resultPointList=null;jsts.operation.overlay.OverlayOp.prototype.getResultGeometry=function(funcCode){this.computeOverlay(funcCode);return this.resultGeom;}
jsts.operation.overlay.OverlayOp.prototype.getGraph=function(){return this.graph;}
jsts.operation.overlay.OverlayOp.prototype.computeOverlay=function(opCode){this.copyPoints(0);this.copyPoints(1);this.arg[0].computeSelfNodes(this.li,false);this.arg[1].computeSelfNodes(this.li,false);this.arg[0].computeEdgeIntersections(this.arg[1],this.li,true);var baseSplitEdges=new ArrayList();this.arg[0].computeSplitEdges(baseSplitEdges);this.arg[1].computeSplitEdges(baseSplitEdges);var splitEdges=baseSplitEdges;this.insertUniqueEdges(baseSplitEdges);this.computeLabelsFromDepths();this.replaceCollapsedEdges();EdgeNodingValidator.checkValid(this.edgeList.getEdges());this.graph.addEdges(this.edgeList.getEdges());this.computeLabelling();this.labelIncompleteNodes();this.findResultAreaEdges(opCode);this.cancelDuplicateResultEdges();var polyBuilder=new PolygonBuilder(this.geomFact);polyBuilder.add(this.graph);this.resultPolyList=polyBuilder.getPolygons();var lineBuilder=new LineBuilder(this,this.geomFact,this.ptLocator);this.resultLineList=lineBuilder.build(opCode);var pointBuilder=new PointBuilder(this,this.geomFact,this.ptLocator);this.resultPointList=pointBuilder.build(opCode);this.resultGeom=this.computeGeometry(this.resultPointList,this.resultLineList,this.resultPolyList,opCode);}
jsts.operation.overlay.OverlayOp.prototype.insertUniqueEdges=function(edges){for(var i=edges.iterator();i.hasNext();){var e=i.next();this.insertUniqueEdge(e);}}
jsts.operation.overlay.OverlayOp.prototype.insertUniqueEdge=function(e){var existingEdge=this.edgeList.findEqualEdge(e);if(existingEdge!==null){var existingLabel=existingEdge.getLabel();var labelToMerge=e.getLabel();if(!existingEdge.isPointwiseEqual(e)){labelToMerge=new Label(e.getLabel());labelToMerge.flip();}
var depth=existingEdge.getDepth();if(depth.isNull()){depth.add(existingLabel);}
depth.add(labelToMerge);existingLabel.merge(labelToMerge);}else{this.edgeList.add(e);}};jsts.operation.overlay.OverlayOp.prototype.computeLabelsFromDepths=function(){for(var it=this.edgeList.iterator();it.hasNext();){var e=it.next();var lbl=e.getLabel();var depth=e.getDepth();if(!depth.isNull()){depth.normalize();for(var i=0;i<2;i++){if(!lbl.isNull(i)&&lbl.isArea()&&!depth.isNull(i)){if(depth.getDelta(i)==0){lbl.toLine(i);}else{Assert.isTrue(!depth.isNull(i,Position.LEFT),'depth of LEFT side has not been initialized');lbl.setLocation(i,Position.LEFT,depth.getLocation(i,Position.LEFT));Assert.isTrue(!depth.isNull(i,Position.RIGHT),'depth of RIGHT side has not been initialized');lbl.setLocation(i,Position.RIGHT,depth.getLocation(i,Position.RIGHT));}}}}}}
jsts.operation.overlay.OverlayOp.prototype.replaceCollapsedEdges=function(){var newEdges=new ArrayList();for(var it=this.edgeList.iterator();it.hasNext();){var e=it.next();if(e.isCollapsed()){it.remove();newEdges.add(e.getCollapsedEdge());}}
this.edgeList.addAll(newEdges);}
jsts.operation.overlay.OverlayOp.prototype.copyPoints=function(argIndex){for(var i=this.arg[argIndex].getNodeIterator();i.hasNext();){var graphNode=i.next();var newNode=this.graph.addNode(graphNode.getCoordinate());newNode.setLabel(argIndex,graphNode.getLabel().getLocation(argIndex));}}
jsts.operation.overlay.OverlayOp.prototype.computeLabelling=function(){for(var nodeit=this.graph.getNodes().iterator();nodeit.hasNext();){var node=nodeit.next();node.getEdges().computeLabelling(this.arg);}
this.mergeSymLabels();this.updateNodeLabelling();}
jsts.operation.overlay.OverlayOp.prototype.mergeSymLabels=function(){for(var nodeit=this.graph.getNodes().iterator();nodeit.hasNext();){var node=nodeit.next();node.getEdges().mergeSymLabels();}}
jsts.operation.overlay.OverlayOp.prototype.updateNodeLabelling=function(){for(var nodeit=this.graph.getNodes().iterator();nodeit.hasNext();){var node=nodeit.next();var lbl=node.getEdges().getLabel();node.getLabel().merge(lbl);}}
jsts.operation.overlay.OverlayOp.prototype.labelIncompleteNodes=function(){var nodeCount=0;for(var ni=this.graph.getNodes().iterator();ni.hasNext();){var n=ni.next();var label=n.getLabel();if(n.isIsolated()){nodeCount++;if(label.isNull(0))
this.labelIncompleteNode(n,0);else
this.labelIncompleteNode(n,1);}
n.getEdges().updateLabelling(label);}};jsts.operation.overlay.OverlayOp.prototype.labelIncompleteNode=function(n,targetIndex){var loc=this.ptLocator.locate(n.getCoordinate(),this.arg[targetIndex].getGeometry());n.getLabel().setLocation(targetIndex,loc);};jsts.operation.overlay.OverlayOp.prototype.findResultAreaEdges=function(opCode){for(var it=this.graph.getEdgeEnds().iterator();it.hasNext();){var de=it.next();var label=de.getLabel();if(label.isArea()&&!de.isInteriorAreaEdge()&&jsts.operation.overlay.OverlayOp.isResultOfOp(label.getLocation(0,Position.RIGHT),label.getLocation(1,Position.RIGHT),opCode)){de.setInResult(true);}}};jsts.operation.overlay.OverlayOp.prototype.cancelDuplicateResultEdges=function(){for(var it=this.graph.getEdgeEnds().iterator();it.hasNext();){var de=it.next();var sym=de.getSym();if(de.isInResult()&&sym.isInResult()){de.setInResult(false);sym.setInResult(false);}}};jsts.operation.overlay.OverlayOp.prototype.isCoveredByLA=function(coord){if(this.isCovered(coord,this.resultLineList))
return true;if(this.isCovered(coord,this.resultPolyList))
return true;return false;};jsts.operation.overlay.OverlayOp.prototype.isCoveredByA=function(coord){if(this.isCovered(coord,this.resultPolyList))
return true;return false;};jsts.operation.overlay.OverlayOp.prototype.isCovered=function(coord,geomList){for(var it=geomList.iterator();it.hasNext();){var geom=it.next();var loc=this.ptLocator.locate(coord,geom);if(loc!=Location.EXTERIOR)
return true;}
return false;};jsts.operation.overlay.OverlayOp.prototype.computeGeometry=function(resultPointList,resultLineList,resultPolyList,opcode){var geomList=new ArrayList();geomList.addAll(resultPointList);geomList.addAll(resultLineList);geomList.addAll(resultPolyList);return this.geomFact.buildGeometry(geomList);};jsts.operation.overlay.OverlayOp.prototype.createEmptyResult=function(opCode){var result=null;switch(resultDimension(opCode,this.arg[0].getGeometry(),this.arg[1].getGeometry())){case-1:result=geomFact.createGeometryCollection();break;case 0:result=geomFact.createPoint(null);break;case 1:result=geomFact.createLineString(null);break;case 2:result=geomFact.createPolygon(null,null);break;}
return result;};jsts.operation.overlay.OverlayOp.prototype.resultDimension=function(opCode,g0,g1){var dim0=g0.getDimension();var dim1=g1.getDimension();var resultDimension=-1;switch(opCode){case jsts.operation.overlay.OverlayOp.INTERSECTION:resultDimension=Math.min(dim0,dim1);break;case jsts.operation.overlay.OverlayOp.UNION:resultDimension=Math.max(dim0,dim1);break;case jsts.operation.overlay.OverlayOp.DIFFERENCE:resultDimension=dim0;break;case jsts.operation.overlay.OverlayOp.SYMDIFFERENCE:resultDimension=Math.max(dim0,dim1);break;}
return resultDimension;};})();(function(){var OverlayOp=jsts.operation.overlay.OverlayOp;var GeometrySnapper=jsts.operation.overlay.snap.GeometrySnapper;var SnapOverlayOp=function(g1,g2){this.geom=[];this.geom[0]=g1;this.geom[1]=g2;this.computeSnapTolerance();};SnapOverlayOp.overlayOp=function(g0,g1,opCode){var op=new SnapOverlayOp(g0,g1);return op.getResultGeometry(opCode);};SnapOverlayOp.intersection=function(g0,g1){return this.overlayOp(g0,g1,OverlayOp.INTERSECTION);};SnapOverlayOp.union=function(g0,g1){return this.overlayOp(g0,g1,OverlayOp.UNION);};SnapOverlayOp.difference=function(g0,g1){return overlayOp(g0,g1,OverlayOp.DIFFERENCE);};SnapOverlayOp.symDifference=function(g0,g1){return overlayOp(g0,g1,OverlayOp.SYMDIFFERENCE);};SnapOverlayOp.prototype.geom=null;SnapOverlayOp.prototype.snapTolerance=null;SnapOverlayOp.prototype.computeSnapTolerance=function(){this.snapTolerance=GeometrySnapper.computeOverlaySnapTolerance(this.geom[0],this.geom[1]);};SnapOverlayOp.prototype.getResultGeometry=function(opCode){var prepGeom=this.snap(this.geom);var result=OverlayOp.overlayOp(prepGeom[0],prepGeom[1],opCode);return this.prepareResult(result);};SnapOverlayOp.prototype.selfSnap=function(geom){var snapper0=new GeometrySnapper(geom);var snapGeom=snapper0.snapTo(geom,this.snapTolerance);return snapGeom;};SnapOverlayOp.prototype.snap=function(geom){var remGeom=geom;var snapGeom=GeometrySnapper.snap(remGeom[0],remGeom[1],this.snapTolerance);return snapGeom;};SnapOverlayOp.prototype.prepareResult=function(geom){return geom;};SnapOverlayOp.prototype.cbr=null;SnapOverlayOp.prototype.removeCommonBits=function(geom){this.cbr=new jsts.precision.CommonBitsRemover();this.cbr.add(this.geom[0]);this.cbr.add(this.geom[1]);var remGeom=[];remGeom[0]=cbr.removeCommonBits(this.geom[0].clone());remGeom[1]=cbr.removeCommonBits(this.geom[1].clone());return remGeom;};jsts.operation.overlay.snap.SnapOverlayOp=SnapOverlayOp;})();jsts.geomgraph.index.EdgeSetIntersector=function(){};jsts.geomgraph.index.EdgeSetIntersector.prototype.computeIntersections=function(edges,si,testAllSegments){throw new jsts.error.AbstractMethodInvocationError();};jsts.geomgraph.index.EdgeSetIntersector.prototype.computeIntersections2=function(edges0,edges1,si){throw new jsts.error.AbstractMethodInvocationError();};jsts.geomgraph.index.SimpleMCSweepLineIntersector=function(){this.events=[];};jsts.geomgraph.index.SimpleMCSweepLineIntersector.prototype=new jsts.geomgraph.index.EdgeSetIntersector();jsts.geomgraph.index.SimpleMCSweepLineIntersector.prototype.events=null;jsts.geomgraph.index.SimpleMCSweepLineIntersector.prototype.nOverlaps=0;jsts.geomgraph.index.SimpleMCSweepLineIntersector.prototype.computeIntersections=function(edges,si,testAllSegments){if(si instanceof javascript.util.List){this.computeIntersections2.apply(this,arguments);return;}
if(testAllSegments){this.addList2(edges,null);}else{this.addList(edges);}
this.computeIntersections3(si);};jsts.geomgraph.index.SimpleMCSweepLineIntersector.prototype.computeIntersections2=function(edges0,edges1,si){this.addList2(edges0,edges0);this.addList2(edges1,edges1);this.computeIntersections3(si);};jsts.geomgraph.index.SimpleMCSweepLineIntersector.prototype.add=function(edge,edgeSet){if(edge instanceof javascript.util.List){this.addList.apply(this,arguments);return;}
var mce=edge.getMonotoneChainEdge();var startIndex=mce.getStartIndexes();for(var i=0;i<startIndex.length-1;i++){var mc=new jsts.geomgraph.index.MonotoneChain(mce,i);var insertEvent=new jsts.geomgraph.index.SweepLineEvent(mce.getMinX(i),mc,edgeSet);this.events.push(insertEvent);this.events.push(new jsts.geomgraph.index.SweepLineEvent(mce.getMaxX(i),insertEvent));}};jsts.geomgraph.index.SimpleMCSweepLineIntersector.prototype.addList=function(edges){for(var i=edges.iterator();i.hasNext();){var edge=i.next();this.add(edge,edge);}};jsts.geomgraph.index.SimpleMCSweepLineIntersector.prototype.addList2=function(edges,edgeSet){for(var i=edges.iterator();i.hasNext();){var edge=i.next();this.add(edge,edgeSet);}};jsts.geomgraph.index.SimpleMCSweepLineIntersector.prototype.prepareEvents=function(){this.events.sort(function(a,b){return a.compareTo(b);});for(var i=0;i<this.events.length;i++){var ev=this.events[i];if(ev.isDelete()){ev.getInsertEvent().setDeleteEventIndex(i);}}};jsts.geomgraph.index.SimpleMCSweepLineIntersector.prototype.computeIntersections3=function(si){this.nOverlaps=0;this.prepareEvents();for(var i=0;i<this.events.length;i++){var ev=this.events[i];if(ev.isInsert()){this.processOverlaps(i,ev.getDeleteEventIndex(),ev,si);}}};jsts.geomgraph.index.SimpleMCSweepLineIntersector.prototype.processOverlaps=function(start,end,ev0,si){var mc0=ev0.getObject();for(var i=start;i<end;i++){var ev1=this.events[i];if(ev1.isInsert()){var mc1=ev1.getObject();if(!ev0.isSameLabel(ev1)){mc0.computeIntersections(mc1,si);this.nOverlaps++;}}}};jsts.algorithm.locate.SimplePointInAreaLocator=function(geom){this.geom=geom;};jsts.algorithm.locate.SimplePointInAreaLocator.locate=function(p,geom){if(geom.isEmpty())
return jsts.geom.Location.EXTERIOR;if(jsts.algorithm.locate.SimplePointInAreaLocator.containsPoint(p,geom))
return jsts.geom.Location.INTERIOR;return jsts.geom.Location.EXTERIOR;};jsts.algorithm.locate.SimplePointInAreaLocator.containsPoint=function(p,geom){if(geom instanceof jsts.geom.Polygon){return jsts.algorithm.locate.SimplePointInAreaLocator.containsPointInPolygon(p,geom);}else if(geom instanceof jsts.geom.GeometryCollection||geom instanceof jsts.geom.MultiPoint||geom instanceof jsts.geom.MultiLineString||geom instanceof jsts.geom.MultiPolygon){for(var i=0;i<geom.geometries.length;i++){var g2=geom.geometries[i];if(g2!==geom)
if(jsts.algorithm.locate.SimplePointInAreaLocator.containsPoint(p,g2))
return true;}}
return false;};jsts.algorithm.locate.SimplePointInAreaLocator.containsPointInPolygon=function(p,poly){if(poly.isEmpty())
return false;var shell=poly.getExteriorRing();if(!jsts.algorithm.locate.SimplePointInAreaLocator.isPointInRing(p,shell))
return false;for(var i=0;i<poly.getNumInteriorRing();i++){var hole=poly.getInteriorRingN(i);if(jsts.algorithm.locate.SimplePointInAreaLocator.isPointInRing(p,hole))
return false;}
return true;};jsts.algorithm.locate.SimplePointInAreaLocator.isPointInRing=function(p,ring){if(!ring.getEnvelopeInternal().intersects(p))
return false;return jsts.algorithm.CGAlgorithms.isPointInRing(p,ring.getCoordinates());};jsts.algorithm.locate.SimplePointInAreaLocator.prototype.geom=null;jsts.algorithm.locate.SimplePointInAreaLocator.prototype.locate=function(p){return jsts.algorithm.locate.SimplePointInAreaLocator.locate(p,geom);};(function(){var Location=jsts.geom.Location;var Position=jsts.geomgraph.Position;var EdgeEndStar=jsts.geomgraph.EdgeEndStar;var Assert=jsts.util.Assert;jsts.geomgraph.DirectedEdgeStar=function(){jsts.geomgraph.EdgeEndStar.call(this);};jsts.geomgraph.DirectedEdgeStar.prototype=new EdgeEndStar();jsts.geomgraph.DirectedEdgeStar.constructor=jsts.geomgraph.DirectedEdgeStar;jsts.geomgraph.DirectedEdgeStar.prototype.resultAreaEdgeList=null;jsts.geomgraph.DirectedEdgeStar.prototype.label=null;jsts.geomgraph.DirectedEdgeStar.prototype.insert=function(ee){var de=ee;this.insertEdgeEnd(de,de);};jsts.geomgraph.DirectedEdgeStar.prototype.getLabel=function(){return this.label;};jsts.geomgraph.DirectedEdgeStar.prototype.getOutgoingDegree=function(){var degree=0;for(var it=this.iterator();it.hasNext();){var de=it.next();if(de.isInResult())
degree++;}
return degree;};jsts.geomgraph.DirectedEdgeStar.prototype.getOutgoingDegree=function(er){var degree=0;for(var it=this.iterator();it.hasNext();){var de=it.next();if(de.getEdgeRing()===er)
degree++;}
return degree;};jsts.geomgraph.DirectedEdgeStar.prototype.getRightmostEdge=function(){var edges=this.getEdges();var size=edges.size();if(size<1)
return null;var de0=edges.get(0);if(size==1)
return de0;var deLast=edges.get(size-1);var quad0=de0.getQuadrant();var quad1=deLast.getQuadrant();if(jsts.geomgraph.Quadrant.isNorthern(quad0)&&jsts.geomgraph.Quadrant.isNorthern(quad1))
return de0;else if(!jsts.geomgraph.Quadrant.isNorthern(quad0)&&!jsts.geomgraph.Quadrant.isNorthern(quad1))
return deLast;else{var nonHorizontalEdge=null;if(de0.getDy()!=0)
return de0;else if(deLast.getDy()!=0)
return deLast;}
Assert.shouldNeverReachHere('found two horizontal edges incident on node');return null;};jsts.geomgraph.DirectedEdgeStar.prototype.computeLabelling=function(geom){EdgeEndStar.prototype.computeLabelling.call(this,geom);this.label=new jsts.geomgraph.Label(Location.NONE);for(var it=this.iterator();it.hasNext();){var ee=it.next();var e=ee.getEdge();var eLabel=e.getLabel();for(var i=0;i<2;i++){var eLoc=eLabel.getLocation(i);if(eLoc===Location.INTERIOR||eLoc===Location.BOUNDARY)
this.label.setLocation(i,Location.INTERIOR);}}};jsts.geomgraph.DirectedEdgeStar.prototype.mergeSymLabels=function(){for(var it=this.iterator();it.hasNext();){var de=it.next();var label=de.getLabel();label.merge(de.getSym().getLabel());}};jsts.geomgraph.DirectedEdgeStar.prototype.updateLabelling=function(nodeLabel){for(var it=this.iterator();it.hasNext();){var de=it.next();var label=de.getLabel();label.setAllLocationsIfNull(0,nodeLabel.getLocation(0));label.setAllLocationsIfNull(1,nodeLabel.getLocation(1));}};jsts.geomgraph.DirectedEdgeStar.prototype.getResultAreaEdges=function(){if(this.resultAreaEdgeList!==null)
return this.resultAreaEdgeList;this.resultAreaEdgeList=new javascript.util.ArrayList();for(var it=this.iterator();it.hasNext();){var de=it.next();if(de.isInResult()||de.getSym().isInResult())
this.resultAreaEdgeList.add(de);}
return this.resultAreaEdgeList;};jsts.geomgraph.DirectedEdgeStar.prototype.SCANNING_FOR_INCOMING=1;jsts.geomgraph.DirectedEdgeStar.prototype.LINKING_TO_OUTGOING=2;jsts.geomgraph.DirectedEdgeStar.prototype.linkResultDirectedEdges=function(){this.getResultAreaEdges();var firstOut=null;var incoming=null;var state=this.SCANNING_FOR_INCOMING;for(var i=0;i<this.resultAreaEdgeList.size();i++){var nextOut=this.resultAreaEdgeList.get(i);var nextIn=nextOut.getSym();if(!nextOut.getLabel().isArea())
continue;if(firstOut===null&&nextOut.isInResult())
firstOut=nextOut;switch(state){case this.SCANNING_FOR_INCOMING:if(!nextIn.isInResult())
continue;incoming=nextIn;state=this.LINKING_TO_OUTGOING;break;case this.LINKING_TO_OUTGOING:if(!nextOut.isInResult())
continue;incoming.setNext(nextOut);state=this.SCANNING_FOR_INCOMING;break;}}
if(state===this.LINKING_TO_OUTGOING){if(firstOut===null)
throw new jsts.error.TopologyError('no outgoing dirEdge found',this.getCoordinate());Assert.isTrue(firstOut.isInResult(),'unable to link last incoming dirEdge');incoming.setNext(firstOut);}};jsts.geomgraph.DirectedEdgeStar.prototype.linkMinimalDirectedEdges=function(er){var firstOut=null;var incoming=null;var state=this.SCANNING_FOR_INCOMING;for(var i=this.resultAreaEdgeList.size()-1;i>=0;i--){var nextOut=this.resultAreaEdgeList.get(i);var nextIn=nextOut.getSym();if(firstOut===null&&nextOut.getEdgeRing()===er)
firstOut=nextOut;switch(state){case this.SCANNING_FOR_INCOMING:if(nextIn.getEdgeRing()!=er)
continue;incoming=nextIn;state=this.LINKING_TO_OUTGOING;break;case this.LINKING_TO_OUTGOING:if(nextOut.getEdgeRing()!==er)
continue;incoming.setNextMin(nextOut);state=this.SCANNING_FOR_INCOMING;break;}}
if(state===this.LINKING_TO_OUTGOING){Assert.isTrue(firstOut!==null,'found null for first outgoing dirEdge');Assert.isTrue(firstOut.getEdgeRing()===er,'unable to link last incoming dirEdge');incoming.setNextMin(firstOut);}};jsts.geomgraph.DirectedEdgeStar.prototype.linkAllDirectedEdges=function(){this.getEdges();var prevOut=null;var firstIn=null;for(var i=this.edgeList.size()-1;i>=0;i--){var nextOut=this.edgeList.get(i);var nextIn=nextOut.getSym();if(firstIn===null)
firstIn=nextIn;if(prevOut!==null)
nextIn.setNext(prevOut);prevOut=nextOut;}
firstIn.setNext(prevOut);};jsts.geomgraph.DirectedEdgeStar.prototype.findCoveredLineEdges=function(){var startLoc=Location.NONE;for(var it=this.iterator();it.hasNext();){var nextOut=it.next();var nextIn=nextOut.getSym();if(!nextOut.isLineEdge()){if(nextOut.isInResult()){startLoc=Location.INTERIOR;break;}
if(nextIn.isInResult()){startLoc=Location.EXTERIOR;break;}}}
if(startLoc===Location.NONE)
return;var currLoc=startLoc;for(var it=this.iterator();it.hasNext();){var nextOut=it.next();var nextIn=nextOut.getSym();if(nextOut.isLineEdge()){nextOut.getEdge().setCovered(currLoc===Location.INTERIOR);}else{if(nextOut.isInResult())
currLoc=Location.EXTERIOR;if(nextIn.isInResult())
currLoc=Location.INTERIOR;}}};jsts.geomgraph.DirectedEdgeStar.prototype.computeDepths=function(de){if(arguments.length===2){this.computeDepths2.apply(this,arguments);return;}
var edgeIndex=this.findIndex(de);var label=de.getLabel();var startDepth=de.getDepth(Position.LEFT);var targetLastDepth=de.getDepth(Position.RIGHT);var nextDepth=this.computeDepths2(edgeIndex+1,this.edgeList.size(),startDepth);var lastDepth=this.computeDepths2(0,edgeIndex,nextDepth);if(lastDepth!=targetLastDepth)
throw new jsts.error.TopologyError('depth mismatch at '+
de.getCoordinate());};jsts.geomgraph.DirectedEdgeStar.prototype.computeDepths2=function(startIndex,endIndex,startDepth){var currDepth=startDepth;for(var i=startIndex;i<endIndex;i++){var nextDe=this.edgeList.get(i);var label=nextDe.getLabel();nextDe.setEdgeDepths(Position.RIGHT,currDepth);currDepth=nextDe.getDepth(Position.LEFT);}
return currDepth;};})();jsts.algorithm.CentroidLine=function(){this.centSum=new jsts.geom.Coordinate();};jsts.algorithm.CentroidLine.prototype.centSum=null;jsts.algorithm.CentroidLine.prototype.totalLength=0.0;jsts.algorithm.CentroidLine.prototype.add=function(geom){if(geom instanceof Array){this.add2.apply(this,arguments);return;}
if(geom instanceof jsts.geom.LineString){this.add(geom.getCoordinates());}else if(geom instanceof jsts.geom.Polygon){var poly=geom;this.add(poly.getExteriorRing().getCoordinates());for(var i=0;i<poly.getNumInteriorRing();i++){this.add(poly.getInteriorRingN(i).getCoordinates());}}else if(geom instanceof jsts.geom.GeometryCollection||geom instanceof jsts.geom.MultiPoint||geom instanceof jsts.geom.MultiLineString||geom instanceof jsts.geom.MultiPolygon){var gc=geom;for(var i=0;i<gc.getNumGeometries();i++){this.add(gc.getGeometryN(i));}}};jsts.algorithm.CentroidLine.prototype.getCentroid=function(){var cent=new jsts.geom.Coordinate();cent.x=this.centSum.x/this.totalLength;cent.y=this.centSum.y/this.totalLength;return cent;};jsts.algorithm.CentroidLine.prototype.add2=function(pts){for(var i=0;i<pts.length-1;i++){var segmentLen=pts[i].distance(pts[i+1]);this.totalLength+=segmentLen;var midx=(pts[i].x+pts[i+1].x)/2;this.centSum.x+=segmentLen*midx;var midy=(pts[i].y+pts[i+1].y)/2;this.centSum.y+=segmentLen*midy;}};jsts.index.IntervalSize=function(){};jsts.index.IntervalSize.MIN_BINARY_EXPONENT=-50;jsts.index.IntervalSize.isZeroWidth=function(min,max){var width=max-min;if(width===0.0){return true;}
var maxAbs,scaledInterval,level;maxAbs=Math.max(Math.abs(min),Math.abs(max));scaledInterval=width/maxAbs;level=jsts.index.DoubleBits.exponent(scaledInterval);return level<=jsts.index.IntervalSize.MIN_BINARY_EXPONENT;};jsts.geomgraph.index.SimpleEdgeSetIntersector=function(){};jsts.geomgraph.index.SimpleEdgeSetIntersector.prototype=new jsts.geomgraph.index.EdgeSetIntersector();jsts.geomgraph.index.SimpleEdgeSetIntersector.prototype.nOverlaps=0;jsts.geomgraph.index.SimpleEdgeSetIntersector.prototype.computeIntersections=function(edges,si,testAllSegments){if(si instanceof javascript.util.List){this.computeIntersections2.apply(this,arguments);return;}
this.nOverlaps=0;for(var i0=edges.iterator();i0.hasNext();){var edge0=i0.next();for(var i1=edges.iterator();i1.hasNext();){var edge1=i1.next();if(testAllSegments||edge0!=edge1)
this.computeIntersects(edge0,edge1,si);}}};jsts.geomgraph.index.SimpleEdgeSetIntersector.prototype.computeIntersections2=function(edges0,edges1,si){this.nOverlaps=0;for(var i0=edges0.iterator();i0.hasNext();){var edge0=i0.next();for(var i1=edges1.iterator();i1.hasNext();){var edge1=i1.next();this.computeIntersects(edge0,edge1,si);}}};jsts.geomgraph.index.SimpleEdgeSetIntersector.prototype.computeIntersects=function(e0,e1,si){var pts0=e0.getCoordinates();var pts1=e1.getCoordinates();var i0,i1;for(i0=0;i0<pts0.length-1;i0++){for(i1=0;i1<pts1.length-1;i1++){si.addIntersections(e0,i0,e1,i1);}}};jsts.geomgraph.Edge=function(pts,label){this.pts=pts;this.label=label;this.eiList=new jsts.geomgraph.EdgeIntersectionList(this);this.depth=new jsts.geomgraph.Depth();};jsts.geomgraph.Edge.prototype=new jsts.geomgraph.GraphComponent();jsts.geomgraph.Edge.constructor=jsts.geomgraph.Edge;jsts.geomgraph.Edge.updateIM=function(label,im){im.setAtLeastIfValid(label.getLocation(0,jsts.geomgraph.Position.ON),label.getLocation(1,jsts.geomgraph.Position.ON),1);if(label.isArea()){im.setAtLeastIfValid(label.getLocation(0,jsts.geomgraph.Position.LEFT),label.getLocation(1,jsts.geomgraph.Position.LEFT),2);im.setAtLeastIfValid(label.getLocation(0,jsts.geomgraph.Position.RIGHT),label.getLocation(1,jsts.geomgraph.Position.RIGHT),2);}};jsts.geomgraph.Edge.prototype.pts=null;jsts.geomgraph.Edge.prototype.env=null;jsts.geomgraph.Edge.prototype.name=null;jsts.geomgraph.Edge.prototype.mce=null;jsts.geomgraph.Edge.prototype._isIsolated=true;jsts.geomgraph.Edge.prototype.depth=null;jsts.geomgraph.Edge.prototype.depthDelta=0;jsts.geomgraph.Edge.prototype.eiList=null;jsts.geomgraph.Edge.prototype.getNumPoints=function(){return this.pts.length;};jsts.geomgraph.Edge.prototype.getEnvelope=function(){if(this.env===null){this.env=new jsts.geom.Envelope();for(var i=0;i<this.pts.length;i++){this.env.expandToInclude(pts[i]);}}
return env;};jsts.geomgraph.Edge.prototype.getDepth=function(){return this.depth;};jsts.geomgraph.Edge.prototype.getDepthDelta=function(){return this.depthDelta;};jsts.geomgraph.Edge.prototype.setDepthDelta=function(depthDelta){this.depthDelta=depthDelta;};jsts.geomgraph.Edge.prototype.getCoordinates=function(){return this.pts;};jsts.geomgraph.Edge.prototype.getCoordinate=function(i){if(i===undefined){if(this.pts.length>0){return this.pts[0];}else{return null;}}
return this.pts[i];};jsts.geomgraph.Edge.prototype.isClosed=function(){return this.pts[0].equals(this.pts[this.pts.length-1]);};jsts.geomgraph.Edge.prototype.setIsolated=function(isIsolated){this._isIsolated=isIsolated;};jsts.geomgraph.Edge.prototype.isIsolated=function(){return this._isIsolated;};jsts.geomgraph.Edge.prototype.addIntersections=function(li,segmentIndex,geomIndex){for(var i=0;i<li.getIntersectionNum();i++){this.addIntersection(li,segmentIndex,geomIndex,i);}};jsts.geomgraph.Edge.prototype.addIntersection=function(li,segmentIndex,geomIndex,intIndex){var intPt=new jsts.geom.Coordinate(li.getIntersection(intIndex));var normalizedSegmentIndex=segmentIndex;var dist=li.getEdgeDistance(geomIndex,intIndex);var nextSegIndex=normalizedSegmentIndex+1;if(nextSegIndex<this.pts.length){var nextPt=this.pts[nextSegIndex];if(intPt.equals2D(nextPt)){normalizedSegmentIndex=nextSegIndex;dist=0.0;}}
var ei=this.eiList.add(intPt,normalizedSegmentIndex,dist);};jsts.geomgraph.Edge.prototype.getMaximumSegmentIndex=function(){return this.pts.length-1;};jsts.geomgraph.Edge.prototype.getEdgeIntersectionList=function(){return this.eiList;};jsts.geomgraph.Edge.prototype.getMonotoneChainEdge=function(){if(this.mce==null){this.mce=new jsts.geomgraph.index.MonotoneChainEdge(this);}
return this.mce;};jsts.geomgraph.Edge.prototype.isClosed=function()
{return this.pts[0].equals(this.pts[this.pts.length-1]);};jsts.geomgraph.Edge.prototype.isCollapsed=function()
{if(!this.label.isArea())return false;if(this.pts.length!=3)return false;if(this.pts[0].equals(this.pts[2]))return true;return false;};jsts.geomgraph.Edge.prototype.getCollapsedEdge=function()
{var newPts=[];newPts[0]=this.pts[0];newPts[1]=this.pts[1];var newe=new jsts.geomgraph.Edge(newPts,jsts.geomgraph.Label.toLineLabel(this.label));return newe;};jsts.geomgraph.Edge.prototype.computeIM=function(im){jsts.geomgraph.Edge.updateIM(this.label,im);};jsts.geomgraph.Edge.prototype.isPointwiseEqual=function(e)
{if(this.pts.length!=e.pts.length)return false;for(var i=0;i<this.pts.length;i++){if(!this.pts[i].equals2D(e.pts[i])){return false;}}
return true;};jsts.noding.Octant=function(){throw jsts.error.AbstractMethodInvocationError();};jsts.noding.Octant.octant=function(dx,dy){if(dx instanceof jsts.geom.Coordinate){return jsts.noding.Octant.octant2.apply(this,arguments);}
if(dx===0.0&&dy===0.0)
throw new jsts.error.IllegalArgumentError('Cannot compute the octant for point ( '+dx+', '+dy+' )');var adx=Math.abs(dx);var ady=Math.abs(dy);if(dx>=0){if(dy>=0){if(adx>=ady)
return 0;else
return 1;}
else{if(adx>=ady)
return 7;else
return 6;}}
else{if(dy>=0){if(adx>=ady)
return 3;else
return 2;}
else{if(adx>=ady)
return 4;else
return 5;}}};jsts.noding.Octant.octant2=function(p0,p1){var dx=p1.x-p0.x;var dy=p1.y-p0.y;if(dx===0.0&&dy===0.0)
throw new jsts.error.IllegalArgumentError('Cannot compute the octant for two identical points '+p0);return jsts.noding.Octant.octant(dx,dy);};jsts.operation.union.UnionInteracting=function(g0,g1){this.g0=g0;this.g1=g1;this.geomFactory=g0.getFactory();this.interacts0=[];this.interacts1=[];};jsts.operation.union.UnionInteracting.union=function(g0,g1){var uue=new jsts.operation.union.UnionInteracting(g0,g1);return uue.union();};jsts.operation.union.UnionInteracting.prototype.geomFactory=null;jsts.operation.union.UnionInteracting.prototype.g0=null;jsts.operation.union.UnionInteracting.prototype.g1=null;jsts.operation.union.UnionInteracting.prototype.interacts0=null;jsts.operation.union.UnionInteracting.prototype.interacts1=null;jsts.operation.union.UnionInteracting.prototype.union=function(){this.computeInteracting();var int0=this.extractElements(this.g0,this.interacts0,true);var int1=this.extractElements(this.g1,this.interacts1,true);if(int0.isEmpty()||int1.isEmpty()){}
var union=in0.union(int1);var disjoint0=this.extractElements(this.g0,this.interacts0,false);var disjoint1=this.extractElements(this.g1,this.interacts1,false);var overallUnion=jsts.geom.util.GeometryCombiner.combine(union,disjoint0,disjoint1);return overallUnion;};jsts.operation.union.UnionInteracting.prototype.bufferUnion=function(g0,g1){var factory=g0.getFactory();var gColl=factory.createGeometryCollection([g0,g1]);var unionAll=gColl.buffer(0.0);return unionAll;};jsts.operation.union.UnionInteracting.prototype.computeInteracting=function(elem0){if(!elem0){for(var i=0,l=this.g0.getNumGeometries();i<l;i++){var elem=this.g0.getGeometryN(i);this.interacts0[i]=this.computeInteracting(elem);}}
else{var interactsWithAny=false;for(var i=0,l=g1.getNumGeometries();i<l;i++){var elem1=this.g1.getGeometryN(i);var interacts=elem1.getEnvelopeInternal().intersects(elem0.getEnvelopeInternal());if(interacts){this.interacts1[i]=true;interactsWithAny=true;}}
return interactsWithAny;}};jsts.operation.union.UnionInteracting.prototype.extractElements=function(geom,interacts,isInteracting){var extractedGeoms=[];for(var i=0,l=geom.getNumGeometries();i<l;i++){var elem=geom.getGeometryN(i);if(interacts[i]===isInteracting){extractedGeoms.push(elem);}}
return this.geomFactory.buildGeometry(extractedGeoms);};jsts.triangulate.quadedge.TrianglePredicate=function(){};jsts.triangulate.quadedge.TrianglePredicate.isInCircleNonRobust=function(a,b,c,p){var isInCircle=(a.x*a.x+a.y*a.y)*jsts.triangulate.quadedge.TrianglePredicate.triArea(b,c,p)-
(b.x*b.x+b.y*b.y)*jsts.triangulate.quadedge.TrianglePredicate.triArea(a,c,p)+
(c.x*c.x+c.y*c.y)*jsts.triangulate.quadedge.TrianglePredicate.triArea(a,b,p)-
(p.x*p.x+p.y*p.y)*jsts.triangulate.quadedge.TrianglePredicate.triArea(a,b,c)>0;return isInCircle;};jsts.triangulate.quadedge.TrianglePredicate.isInCircleNormalized=function(a,b,c,p){var adx,ady,bdx,bdy,cdx,cdy,abdet,bcdet,cadet,alift,blift,clift,disc;adx=a.x-p.x;ady=a.y-p.y;bdx=b.x-p.x;bdy=b.y-p.y;cdx=c.x-p.x;cdy=c.y-p.y;abdet=adx*bdy-bdx*ady;bcdet=bdx*cdy-cdx*bdy;cadet=cdx*ady-adx*cdy;alift=adx*adx+ady*ady;blift=bdx*bdx+bdy*bdy;clift=cdx*cdx+cdy*cdy;disc=alift*bcdet+blift*cadet+clift*abdet;return disc>0;};jsts.triangulate.quadedge.TrianglePredicate.triArea=function(a,b,c){return(b.x-a.x)*(c.y-a.y)-(b.y-a.y)*(c.x-a.x);};jsts.triangulate.quadedge.TrianglePredicate.isInCircleRobust=function(a,b,c,p){return jsts.triangulate.quadedge.TrianglePredicate.isInCircleNormalized(a,b,c,p);};jsts.triangulate.quadedge.TrianglePredicate.isInCircleDDSlow=function(a,b,c,p){var px,py,ax,ay,bx,by,cx,cy,aTerm,bTerm,cTerm,pTerm,sum,isInCircle;px=jsts.math.DD.valueOf(p.x);py=jsts.math.DD.valueOf(p.y);ax=jsts.math.DD.valueOf(a.x);ay=jsts.math.DD.valueOf(a.y);bx=jsts.math.DD.valueOf(b.x);by=jsts.math.DD.valueOf(b.y);cx=jsts.math.DD.valueOf(c.x);cy=jsts.math.DD.valueOf(c.y);aTerm=(ax.multiply(ax).add(ay.multiply(ay))).multiply(jsts.triangulate.quadedge.TrianglePredicate.triAreaDDSlow(bx,by,cx,cy,px,py));bTerm=(bx.multiply(bx).add(by.multiply(by))).multiply(jsts.triangulate.quadedge.TrianglePredicate.triAreaDDSlow(ax,ay,cx,cy,px,py));cTerm=(cx.multiply(cx).add(cy.multiply(cy))).multiply(jsts.triangulate.quadedge.TrianglePredicate.triAreaDDSlow(ax,ay,bx,by,px,py));pTerm=(px.multiply(px).add(py.multiply(py))).multiply(jsts.triangulate.quadedge.TrianglePredicate.triAreaDDSlow(ax,ay,bx,by,cx,cy));sum=aTerm.subtract(bTerm).add(cTerm).subtract(pTerm);isInCircle=sum.doubleValue()>0;return isInCircle;};jsts.triangulate.quadedge.TrianglePredicate.triAreaDDSlow=function(ax,ay,bx,by,cx,cy){return(bx.subtract(ax).multiply(cy.subtract(ay)).subtract(by.subtract(ay).multiply(cx.subtract(ax))));};jsts.triangulate.quadedge.TrianglePredicate.isInCircleDDFast=function(a,b,c,p){var aTerm,bTerm,cTerm,pTerm,sum,isInCircle;aTerm=(jsts.math.DD.sqr(a.x).selfAdd(jsts.math.DD.sqr(a.y))).selfMultiply(jsts.triangulate.quadedge.TrianglePredicate.triAreaDDFast(b,c,p));bTerm=(jsts.math.DD.sqr(b.x).selfAdd(jsts.math.DD.sqr(b.y))).selfMultiply(jsts.triangulate.quadedge.TrianglePredicate.triAreaDDFast(a,c,p));cTerm=(jsts.math.DD.sqr(c.x).selfAdd(jsts.math.DD.sqr(c.y))).selfMultiply(jsts.triangulate.quadedge.TrianglePredicate.triAreaDDFast(a,b,p));pTerm=(jsts.math.DD.sqr(p.x).selfAdd(jsts.math.DD.sqr(p.y))).selfMultiply(jsts.triangulate.quadedge.TrianglePredicate.triAreaDDFast(a,b,c));sum=aTerm.selfSubtract(bTerm).selfAdd(cTerm).selfSubtract(pTerm);isInCircle=sum.doubleValue()>0;return isInCircle;};jsts.triangulate.quadedge.TrianglePredicate.triAreaDDFast=function(a,b,c){var t1,t2;t1=jsts.math.DD.valueOf(b.x).selfSubtract(a.x).selfMultiply(jsts.math.DD.valueOf(c.y).selfSubtract(a.y));t2=jsts.math.DD.valueOf(b.y).selSubtract(a.y).selfMultiply(jsts.math.DD.valueOf(c.x).selfSubtract(a.x));return t1.selfSubtract(t2);};jsts.triangulate.quadedge.TrianglePredicate.isInCircleDDNormalized=function(a,b,c,p){var adx,ady,bdx,bdy,cdx,cdy,abdet,bcdet,cadet,alift,blift,clift,sum,isInCircle;adx=jsts.math.DD.valueOf(a.x).selfSubtract(p.x);ady=jsts.math.DD.valueOf(a.y).selfSubtract(p.y);bdx=jsts.math.DD.valueOf(b.x).selfSubtract(p.x);bdx=jsts.math.DD.valueOf(b.y).selfSubtract(p.y);cdx=jsts.math.DD.valueOf(c.x).selfSubtract(p.x);cdx=jsts.math.DD.valueOf(c.y).selfSubtract(p.y);abdet=adx.multiply(bdy).selfSubtract(bdx.multiply(ady));bcdet=bdx.multiply(cdy).selfSubtract(cdx.multiply(bdy));cadet=cdx.multiply(ady).selfSubtract(adx.multiply(cdy));alift=adx.multiply(adx).selfAdd(ady.multiply(ady));blift=bdx.multiply(bdx).selfAdd(bdy.multiply(bdy));clift=cdx.multiply(cdx).selfAdd(cdy.multiply(cdy));sum=alift.selfMultiply(bcdet).selfAdd(blift.selfMultiply(cadet)).selfAdd(clift.selfMultiply(abdet));isInCircle=sum.doubleValue()>0;return isInCircle;};jsts.triangulate.quadedge.TrianglePredicate.isInCircleCC=function(a,b,c,p){var cc,ccRadius,pRadiusDiff;cc=jsts.geom.Triangle.circumcentre(a,b,c);ccRadius=a.distance(cc);pRadiusDiff=p.distance(cc)-ccRadius;return pRadiusDiff<=0;};jsts.operation.union.PointGeometryUnion=function(pointGeom,otherGeom){this.pointGeom=pointGeom;this.otherGeom=otherGeom;this.geomFact=otherGeom.getFactory();};jsts.operation.union.PointGeometryUnion.union=function(pointGeom,otherGeom){var unioner=new jsts.operation.union.PointGeometryUnion(pointGeom,otherGeom);return unioner.union();};jsts.operation.union.PointGeometryUnion.prototype.pointGeom=null;jsts.operation.union.PointGeometryUnion.prototype.otherGeom=null;jsts.operation.union.PointGeometryUnion.prototype.geomFact=null;jsts.operation.union.PointGeometryUnion.prototype.union=function(){var locator=new jsts.algorithm.PointLocator();var exteriorCoords=[];for(var i=0,l=this.pointGeom.getNumGeometries();i<l;i++){var point=this.pointGeom.getGeometryN(i);var coord=point.getCoordinate();var loc=locator.locate(coord,this.otherGeom);if(loc===jsts.geom.Location.EXTERIOR){var include=true;for(var j=exteriorCoords.length;i--;){if(exteriorCoords[j].equals(coord)){include=false;break;}}
if(include){exteriorCoords.push(coord);}}}
exteriorCoords.sort(function(x,y){return x.compareTo(y);});if(exteriorCoords.length===0){return this.otherGeom;}
var ptComp=null;var coords=jsts.geom.CoordinateArrays.toCoordinateArray(exteriorCoords);if(coords.length===1){ptComp=this.geomFact.createPoint(coords[0]);}
else{ptComp=this.geomFact.createMultiPoint(coords);}
return jsts.geom.util.GeometryCombiner.combine(ptComp,this.otherGeom);};jsts.noding.IntersectionFinderAdder=function(li){this.li=li;this.interiorIntersections=new javascript.util.ArrayList();};jsts.noding.IntersectionFinderAdder.prototype=new jsts.noding.SegmentIntersector();jsts.noding.IntersectionFinderAdder.constructor=jsts.noding.IntersectionFinderAdder;jsts.noding.IntersectionFinderAdder.prototype.li=null;jsts.noding.IntersectionFinderAdder.prototype.interiorIntersections=null;jsts.noding.IntersectionFinderAdder.prototype.getInteriorIntersections=function(){return this.interiorIntersections;};jsts.noding.IntersectionFinderAdder.prototype.processIntersections=function(e0,segIndex0,e1,segIndex1){if(e0===e1&&segIndex0===segIndex1)
return;var p00=e0.getCoordinates()[segIndex0];var p01=e0.getCoordinates()[segIndex0+1];var p10=e1.getCoordinates()[segIndex1];var p11=e1.getCoordinates()[segIndex1+1];this.li.computeIntersection(p00,p01,p10,p11);if(this.li.hasIntersection()){if(this.li.isInteriorIntersection()){for(var intIndex=0;intIndex<this.li.getIntersectionNum();intIndex++){this.interiorIntersections.add(this.li.getIntersection(intIndex));}
e0.addIntersections(this.li,segIndex0,0);e1.addIntersections(this.li,segIndex1,1);}}};jsts.noding.IntersectionFinderAdder.prototype.isDone=function(){return false;};jsts.noding.snapround.MCIndexSnapRounder=function(pm){this.pm=pm;this.li=new jsts.algorithm.RobustLineIntersector();this.li.setPrecisionModel(pm);this.scaleFactor=pm.getScale();};jsts.noding.snapround.MCIndexSnapRounder.prototype=new jsts.noding.Noder();jsts.noding.snapround.MCIndexSnapRounder.constructor=jsts.noding.snapround.MCIndexSnapRounder;jsts.noding.snapround.MCIndexSnapRounder.prototype.pm=null;jsts.noding.snapround.MCIndexSnapRounder.prototype.li=null;jsts.noding.snapround.MCIndexSnapRounder.prototype.scaleFactor=null;jsts.noding.snapround.MCIndexSnapRounder.prototype.noder=null;jsts.noding.snapround.MCIndexSnapRounder.prototype.pointSnapper=null;jsts.noding.snapround.MCIndexSnapRounder.prototype.nodedSegStrings=null;jsts.noding.snapround.MCIndexSnapRounder.prototype.getNodedSubstrings=function(){return jsts.noding.NodedSegmentString.getNodedSubstrings(this.nodedSegStrings);};jsts.noding.snapround.MCIndexSnapRounder.prototype.computeNodes=function(inputSegmentStrings){this.nodedSegStrings=inputSegmentStrings;this.noder=new jsts.noding.MCIndexNoder();this.pointSnapper=new jsts.noding.snapround.MCIndexPointSnapper(this.noder.getIndex());this.snapRound(inputSegmentStrings,this.li);};jsts.noding.snapround.MCIndexSnapRounder.prototype.snapRound=function(segStrings,li){var intersections=this.findInteriorIntersections(segStrings,li);this.computeIntersectionSnaps(intersections);this.computeVertexSnaps(segStrings);};jsts.noding.snapround.MCIndexSnapRounder.prototype.findInteriorIntersections=function(segStrings,li){var intFinderAdder=new jsts.noding.IntersectionFinderAdder(li);this.noder.setSegmentIntersector(intFinderAdder);this.noder.computeNodes(segStrings);return intFinderAdder.getInteriorIntersections();};jsts.noding.snapround.MCIndexSnapRounder.prototype.computeIntersectionSnaps=function(snapPts){for(var it=snapPts.iterator();it.hasNext();){var snapPt=it.next();var hotPixel=new jsts.noding.snapround.HotPixel(snapPt,this.scaleFactor,this.li);this.pointSnapper.snap(hotPixel);}};jsts.noding.snapround.MCIndexSnapRounder.prototype.computeVertexSnaps=function(edges){if(edges instanceof jsts.noding.NodedSegmentString){this.computeVertexSnaps2.apply(this,arguments);return;}
for(var i0=edges.iterator();i0.hasNext();){var edge0=i0.next();this.computeVertexSnaps(edge0);}};jsts.noding.snapround.MCIndexSnapRounder.prototype.computeVertexSnaps2=function(e){var pts0=e.getCoordinates();for(var i=0;i<pts0.length-1;i++){var hotPixel=new jsts.noding.snapround.HotPixel(pts0[i],this.scaleFactor,this.li);var isNodeAdded=this.pointSnapper.snap(hotPixel,e,i);if(isNodeAdded){e.addIntersection(pts0[i],i);}}};jsts.operation.valid.ConnectedInteriorTester=function(geomGraph){this.geomGraph=geomGraph;this.geometryFactory=new jsts.geom.GeometryFactory();this.disconnectedRingcoord=null;};jsts.operation.valid.ConnectedInteriorTester.findDifferentPoint=function(coord,pt){var i=0,il=coord.length;for(i;i<il;i++){if(!coord[i].equals(pt))
return coord[i];}
return null;};jsts.operation.valid.ConnectedInteriorTester.prototype.getCoordinate=function(){return this.disconnectedRingcoord;};jsts.operation.valid.ConnectedInteriorTester.prototype.isInteriorsConnected=function(){var splitEdges=new javascript.util.ArrayList();this.geomGraph.computeSplitEdges(splitEdges);var graph=new jsts.geomgraph.PlanarGraph(new jsts.operation.overlay.OverlayNodeFactory());graph.addEdges(splitEdges);this.setInteriorEdgesInResult(graph);graph.linkResultDirectedEdges();var edgeRings=this.buildEdgeRings(graph.getEdgeEnds());this.visitShellInteriors(this.geomGraph.getGeometry(),graph);return!this.hasUnvisitedShellEdge(edgeRings);};jsts.operation.valid.ConnectedInteriorTester.prototype.setInteriorEdgesInResult=function(graph){var it=graph.getEdgeEnds().iterator(),de;while(it.hasNext()){de=it.next();if(de.getLabel().getLocation(0,jsts.geomgraph.Position.RIGHT)==jsts.geom.Location.INTERIOR){de.setInResult(true);}}};jsts.operation.valid.ConnectedInteriorTester.prototype.buildEdgeRings=function(dirEdges){var edgeRings=new javascript.util.ArrayList();for(var it=dirEdges.iterator();it.hasNext();){var de=it.next();if(de.isInResult()&&de.getEdgeRing()==null){var er=new jsts.operation.overlay.MaximalEdgeRing(de,this.geometryFactory);er.linkDirectedEdgesForMinimalEdgeRings();var minEdgeRings=er.buildMinimalRings();var i=0,il=minEdgeRings.length;for(i;i<il;i++){edgeRings.add(minEdgeRings[i]);}}}
return edgeRings;};jsts.operation.valid.ConnectedInteriorTester.prototype.visitShellInteriors=function(g,graph){if(g instanceof jsts.geom.Polygon){var p=g;this.visitInteriorRing(p.getExteriorRing(),graph);}
if(g instanceof jsts.geom.MultiPolygon){var mp=g;for(var i=0;i<mp.getNumGeometries();i++){var p=mp.getGeometryN(i);this.visitInteriorRing(p.getExteriorRing(),graph);}}};jsts.operation.valid.ConnectedInteriorTester.prototype.visitInteriorRing=function(ring,graph){var pts=ring.getCoordinates();var pt0=pts[0];var pt1=jsts.operation.valid.ConnectedInteriorTester.findDifferentPoint(pts,pt0);var e=graph.findEdgeInSameDirection(pt0,pt1);var de=graph.findEdgeEnd(e);var intDe=null;if(de.getLabel().getLocation(0,jsts.geomgraph.Position.RIGHT)==jsts.geom.Location.INTERIOR){intDe=de;}else if(de.getSym().getLabel().getLocation(0,jsts.geomgraph.Position.RIGHT)==jsts.geom.Location.INTERIOR){intDe=de.getSym();}
this.visitLinkedDirectedEdges(intDe);};jsts.operation.valid.ConnectedInteriorTester.prototype.visitLinkedDirectedEdges=function(start){var startDe=start;var de=start;do{de.setVisited(true);de=de.getNext();}while(de!=startDe);};jsts.operation.valid.ConnectedInteriorTester.prototype.hasUnvisitedShellEdge=function(edgeRings){for(var i=0;i<edgeRings.size();i++){var er=edgeRings.get(i);if(er.isHole()){continue;}
var edges=er.getEdges();var de=edges[0];if(de.getLabel().getLocation(0,jsts.geomgraph.Position.RIGHT)!=jsts.geom.Location.INTERIOR){continue;}
for(var j=0;j<edges.length;j++){de=edges[j];if(!de.isVisited()){disconnectedRingcoord=de.getCoordinate();return true;}}}
return false;};jsts.algorithm.InteriorPointLine=function(geometry){this.centroid;this.minDistance=Number.MAX_VALUE;this.interiorPoint=null;this.centroid=geometry.getCentroid().getCoordinate();this.addInterior(geometry);if(this.interiorPoint==null){this.addEndpoints(geometry);}};jsts.algorithm.InteriorPointLine.prototype.getInteriorPoint=function(){return this.interiorPoint;};jsts.algorithm.InteriorPointLine.prototype.addInterior=function(geometry){if(geometry instanceof jsts.geom.LineString){this.addInteriorCoord(geometry.getCoordinates());}else if(geometry instanceof jsts.geom.GeometryCollection){for(var i=0;i<geometry.getNumGeometries();i++){this.addInterior(geometry.getGeometryN(i));}}};jsts.algorithm.InteriorPointLine.prototype.addInteriorCoord=function(pts){for(var i=1;i<pts.length-1;i++){this.add(pts[i]);}};jsts.algorithm.InteriorPointLine.prototype.addEndpoints=function(geometry){if(geometry instanceof jsts.geom.LineString){this.addEndpointsCoord(geometry.getCoordinates());}else if(geometry instanceof jsts.geom.GeometryCollection){for(var i=0;i<geometry.getNumGeometries();i++){this.addEndpoints(geometry.getGeometryN(i));}}};jsts.algorithm.InteriorPointLine.prototype.addEndpointsCoord=function(pts){this.add(pts[0]);this.add(pts[pts.length-1]);};jsts.algorithm.InteriorPointLine.prototype.add=function(point){var dist=point.distance(this.centroid);if(dist<this.minDistance){this.interiorPoint=new jsts.geom.Coordinate(point);this.minDistance=dist;}};jsts.index.chain.MonotoneChainSelectAction=function(){this.tempEnv1=new jsts.geom.Envelope();this.selectedSegment=new jsts.geom.LineSegment();};jsts.index.chain.MonotoneChainSelectAction.prototype.tempEnv1=null;jsts.index.chain.MonotoneChainSelectAction.prototype.selectedSegment=null;jsts.index.chain.MonotoneChainSelectAction.prototype.select=function(mc,start){mc.getLineSegment(start,this.selectedSegment);this.select2(this.selectedSegment);};jsts.index.chain.MonotoneChainSelectAction.prototype.select2=function(seg){};jsts.algorithm.MCPointInRing=function(ring){this.ring=ring;this.tree=null;this.crossings=0;this.interval=new jsts.index.bintree.Interval();this.buildIndex();};jsts.algorithm.MCPointInRing.MCSelecter=function(p,parent){this.parent=parent;this.p=p;};jsts.algorithm.MCPointInRing.MCSelecter.prototype=new jsts.index.chain.MonotoneChainSelectAction;jsts.algorithm.MCPointInRing.MCSelecter.prototype.constructor=jsts.algorithm.MCPointInRing.MCSelecter;jsts.algorithm.MCPointInRing.MCSelecter.prototype.select2=function(ls){this.parent.testLineSegment.apply(this.parent,[this.p,ls]);};jsts.algorithm.MCPointInRing.prototype.buildIndex=function(){this.tree=new jsts.index.bintree.Bintree();var pts=jsts.geom.CoordinateArrays.removeRepeatedPoints(this.ring.getCoordinates());var mcList=jsts.index.chain.MonotoneChainBuilder.getChains(pts);for(var i=0;i<mcList.length;i++){var mc=mcList[i];var mcEnv=mc.getEnvelope();this.interval.min=mcEnv.getMinY();this.interval.max=mcEnv.getMaxY();this.tree.insert(this.interval,mc);}};jsts.algorithm.MCPointInRing.prototype.isInside=function(pt){this.crossings=0;var rayEnv=new jsts.geom.Envelope(-Number.MAX_VALUE,Number.MAX_VALUE,pt.y,pt.y);this.interval.min=pt.y;this.interval.max=pt.y;var segs=this.tree.query(this.interval);var mcSelecter=new jsts.algorithm.MCPointInRing.MCSelecter(pt,this);for(var i=segs.iterator();i.hasNext();){var mc=i.next();this.testMonotoneChain(rayEnv,mcSelecter,mc);}
if((this.crossings%2)==1){return true;}
return false;};jsts.algorithm.MCPointInRing.prototype.testMonotoneChain=function(rayEnv,mcSelecter,mc){mc.select(rayEnv,mcSelecter);};jsts.algorithm.MCPointInRing.prototype.testLineSegment=function(p,seg){var xInt,x1,y1,x2,y2,p1,p2;p1=seg.p0;p2=seg.p1;x1=p1.x-p.x;y1=p1.y-p.y;x2=p2.x-p.x;y2=p2.y-p.y;if(((y1>0)&&(y2<=0))||((y2>0)&&(y1<=0))){xInt=jsts.algorithm.RobustDeterminant.signOfDet2x2(x1,y1,x2,y2)/(y2-y1);if(0.0<xInt){this.crossings++;}}};jsts.operation.valid.TopologyValidationError=function(errorType,pt){this.errorType=errorType;this.pt=null;if(pt!=null){this.pt=pt.clone();}};jsts.operation.valid.TopologyValidationError.HOLE_OUTSIDE_SHELL=2;jsts.operation.valid.TopologyValidationError.NESTED_HOLES=3;jsts.operation.valid.TopologyValidationError.DISCONNECTED_INTERIOR=4;jsts.operation.valid.TopologyValidationError.SELF_INTERSECTION=5;jsts.operation.valid.TopologyValidationError.RING_SELF_INTERSECTION=6;jsts.operation.valid.TopologyValidationError.NESTED_SHELLS=7;jsts.operation.valid.TopologyValidationError.DUPLICATE_RINGS=8;jsts.operation.valid.TopologyValidationError.TOO_FEW_POINTS=9;jsts.operation.valid.TopologyValidationError.INVALID_COORDINATE=10;jsts.operation.valid.TopologyValidationError.RING_NOT_CLOSED=11;jsts.operation.valid.TopologyValidationError.prototype.errMsg=['Topology Validation Error','Repeated Point','Hole lies outside shell','Holes are nested','Interior is disconnected','Self-intersection','Ring Self-intersection','Nested shells','Duplicate Rings','Too few distinct points in geometry component','Invalid Coordinate','Ring is not closed'];jsts.operation.valid.TopologyValidationError.prototype.getCoordinate=function(){return this.pt;};jsts.operation.valid.TopologyValidationError.prototype.getErrorType=function(){return this.errorType;};jsts.operation.valid.TopologyValidationError.prototype.getMessage=function(){return this.errMsg[this.errorType];};jsts.operation.valid.TopologyValidationError.prototype.toString=function(){var locStr='';if(this.pt!=null){locStr=' at or near point '+this.pt;return this.getMessage()+locStr;}
return locStr;};(function(){jsts.geom.MultiPolygon=function(geometries,factory){this.geometries=geometries||[];this.factory=factory;};jsts.geom.MultiPolygon.prototype=new jsts.geom.GeometryCollection();jsts.geom.MultiPolygon.constructor=jsts.geom.MultiPolygon;jsts.geom.MultiPolygon.prototype.getBoundary=function(){if(this.isEmpty()){return this.getFactory().createMultiLineString(null);}
var allRings=[];for(var i=0;i<this.geometries.length;i++){var polygon=this.geometries[i];var rings=polygon.getBoundary();for(var j=0;j<rings.getNumGeometries();j++){allRings.push(rings.getGeometryN(j));}}
return this.getFactory().createMultiLineString(allRings);};jsts.geom.MultiPolygon.prototype.equalsExact=function(other,tolerance){if(!this.isEquivalentClass(other)){return false;}
return jsts.geom.GeometryCollection.prototype.equalsExact.call(this,other,tolerance);};jsts.geom.MultiPolygon.prototype.CLASS_NAME='jsts.geom.MultiPolygon';})();jsts.geom.CoordinateSequenceFilter=function(){};jsts.geom.CoordinateSequenceFilter.prototype.filter=jsts.abstractFunc;jsts.geom.CoordinateSequenceFilter.prototype.isDone=jsts.abstractFunc;jsts.geom.CoordinateSequenceFilter.prototype.isGeometryChanged=jsts.abstractFunc;(function(){var Interval=function(){this.min=0.0;this.max=0.0;if(arguments.length===1){var interval=arguments[0];this.init(interval.min,interval.max);}else if(arguments.length===2){this.init(arguments[0],arguments[1]);}};Interval.prototype.init=function(min,max){this.min=min;this.max=max;if(min>max){this.min=max;this.max=min;}};Interval.prototype.getMin=function(){return this.min;};Interval.prototype.getMax=function(){return this.max;};Interval.prototype.getWidth=function(){return(this.max-this.min);};Interval.prototype.expandToInclude=function(interval){if(interval.max>this.max){this.max=interval.max;}
if(interval.min<this.min){this.min=interval.min;}};Interval.prototype.overlaps=function(){if(arguments.length===1){return this.overlapsInterval.apply(this,arguments);}else{return this.overlapsMinMax.apply(this,arguments);}};Interval.prototype.overlapsInterval=function(interval){return this.overlaps(interval.min,interval.max);};Interval.prototype.overlapsMinMax=function(min,max){if(this.min>max||this.max<min){return false;}
return true;};Interval.prototype.contains=function(){var interval;if(arguments[0]instanceof jsts.index.bintree.Interval){interval=arguments[0];return this.containsMinMax(interval.min,interval.max);}else if(arguments.length===1){return this.containsPoint(arguments[0]);}else{return this.containsMinMax(arguments[0],arguments[1]);}};Interval.prototype.containsMinMax=function(min,max){return(min>=this.min&&max<=this.max);};Interval.prototype.containsPoint=function(p){return(p>=this.min&&p<=this.max);};jsts.index.bintree.Interval=Interval;})();jsts.index.DoubleBits=function(){};jsts.index.DoubleBits.powerOf2=function(exp){return Math.pow(2,exp);};jsts.index.DoubleBits.exponent=function(d){return jsts.index.DoubleBits.CVTFWD(64,d)-1023;};jsts.index.DoubleBits.CVTFWD=function(NumW,Qty){var Sign,Expo,Mant,Bin,nb01='';var Inf={32:{d:0x7F,c:0x80,b:0,a:0},64:{d:0x7FF0,c:0,b:0,a:0}};var ExW={32:8,64:11}[NumW],MtW=NumW-ExW-1;if(!Bin){Sign=Qty<0||1/Qty<0;if(!isFinite(Qty)){Bin=Inf[NumW];if(Sign){Bin.d+=1<<(NumW/4-1);}
Expo=Math.pow(2,ExW)-1;Mant=0;}}
if(!Bin){Expo={32:127,64:1023}[NumW];Mant=Math.abs(Qty);while(Mant>=2){Expo++;Mant/=2;}
while(Mant<1&&Expo>0){Expo--;Mant*=2;}
if(Expo<=0){Mant/=2;nb01='Zero or Denormal';}
if(NumW===32&&Expo>254){nb01='Too big for Single';Bin={d:Sign?0xFF:0x7F,c:0x80,b:0,a:0};Expo=Math.pow(2,ExW)-1;Mant=0;}}
return Expo;};(function(){var DoubleBits=jsts.index.DoubleBits;var Interval=jsts.index.bintree.Interval;var Key=function(interval){this.pt=0.0;this.level=0;this.computeKey(interval);};Key.computeLevel=function(interval){var dx=interval.getWidth(),level;level=DoubleBits.exponent(dx)+1;return level;};Key.prototype.getPoint=function(){return this.pt;};Key.prototype.getLevel=function(){return this.level;};Key.prototype.getInterval=function(){return this.interval;};Key.prototype.computeKey=function(itemInterval){this.level=Key.computeLevel(itemInterval);this.interval=new Interval();this.computeInterval(this.level,itemInterval);while(!this.interval.contains(itemInterval)){this.level+=1;this.computeInterval(this.level,itemInterval);}};Key.prototype.computeInterval=function(level,itemInterval){var size=DoubleBits.powerOf2(level);this.pt=Math.floor(itemInterval.getMin()/size)*size;this.interval.init(this.pt,this.pt+size);};jsts.index.bintree.Key=Key;})();jsts.operation.buffer.SubgraphDepthLocater=function(subgraphs){this.subgraphs=[];this.seg=new jsts.geom.LineSegment();this.subgraphs=subgraphs;};jsts.operation.buffer.SubgraphDepthLocater.prototype.subgraphs=null;jsts.operation.buffer.SubgraphDepthLocater.prototype.seg=null;jsts.operation.buffer.SubgraphDepthLocater.prototype.getDepth=function(p){var stabbedSegments=this.findStabbedSegments(p);if(stabbedSegments.length===0)
return 0;stabbedSegments.sort();var ds=stabbedSegments[0];return ds.leftDepth;};jsts.operation.buffer.SubgraphDepthLocater.prototype.findStabbedSegments=function(stabbingRayLeftPt){if(arguments.length===3){this.findStabbedSegments2.apply(this,arguments);return;}
var stabbedSegments=[];for(var i=0;i<this.subgraphs.length;i++){var bsg=this.subgraphs[i];var env=bsg.getEnvelope();if(stabbingRayLeftPt.y<env.getMinY()||stabbingRayLeftPt.y>env.getMaxY())
continue;this.findStabbedSegments2(stabbingRayLeftPt,bsg.getDirectedEdges(),stabbedSegments);}
return stabbedSegments;};jsts.operation.buffer.SubgraphDepthLocater.prototype.findStabbedSegments2=function(stabbingRayLeftPt,dirEdges,stabbedSegments){if(arguments[1]instanceof jsts.geomgraph.DirectedEdge){this.findStabbedSegments3(stabbingRayLeftPt,dirEdges,stabbedSegments);return;}
for(var i=dirEdges.iterator();i.hasNext();){var de=i.next();if(!de.isForward())
continue;this.findStabbedSegments3(stabbingRayLeftPt,de,stabbedSegments);}};jsts.operation.buffer.SubgraphDepthLocater.prototype.findStabbedSegments3=function(stabbingRayLeftPt,dirEdge,stabbedSegments){var pts=dirEdge.getEdge().getCoordinates();for(var i=0;i<pts.length-1;i++){this.seg.p0=pts[i];this.seg.p1=pts[i+1];if(this.seg.p0.y>this.seg.p1.y)
this.seg.reverse();var maxx=Math.max(this.seg.p0.x,this.seg.p1.x);if(maxx<stabbingRayLeftPt.x)
continue;if(this.seg.isHorizontal())
continue;if(stabbingRayLeftPt.y<this.seg.p0.y||stabbingRayLeftPt.y>this.seg.p1.y)
continue;if(jsts.algorithm.CGAlgorithms.computeOrientation(this.seg.p0,this.seg.p1,stabbingRayLeftPt)===jsts.algorithm.CGAlgorithms.RIGHT)
continue;var depth=dirEdge.getDepth(jsts.geomgraph.Position.LEFT);if(!this.seg.p0.equals(pts[i]))
depth=dirEdge.getDepth(jsts.geomgraph.Position.RIGHT);var ds=new jsts.operation.buffer.SubgraphDepthLocater.DepthSegment(this.seg,depth);stabbedSegments.push(ds);}};jsts.operation.buffer.SubgraphDepthLocater.DepthSegment=function(seg,depth){this.upwardSeg=new jsts.geom.LineSegment(seg);this.leftDepth=depth;};jsts.operation.buffer.SubgraphDepthLocater.DepthSegment.prototype.upwardSeg=null;jsts.operation.buffer.SubgraphDepthLocater.DepthSegment.prototype.leftDepth=null;jsts.operation.buffer.SubgraphDepthLocater.DepthSegment.prototype.compareTo=function(obj){var other=obj;var orientIndex=this.upwardSeg.orientationIndex(other.upwardSeg);if(orientIndex===0)
orientIndex=-1*other.upwardSeg.orientationIndex(upwardSeg);if(orientIndex!==0)
return orientIndex;return this.compareX(this.upwardSeg,other.upwardSeg);};jsts.operation.buffer.SubgraphDepthLocater.DepthSegment.prototype.compareX=function(seg0,seg1){var compare0=seg0.p0.compareTo(seg1.p0);if(compare0!==0)
return compare0;return seg0.p1.compareTo(seg1.p1);};jsts.noding.snapround.HotPixel=function(pt,scaleFactor,li){this.corner=[];this.originalPt=pt;this.pt=pt;this.scaleFactor=scaleFactor;this.li=li;if(this.scaleFactor!==1.0){this.pt=new jsts.geom.Coordinate(this.scale(pt.x),this.scale(pt.y));this.p0Scaled=new jsts.geom.Coordinate();this.p1Scaled=new jsts.geom.Coordinate();}
this.initCorners(this.pt);};jsts.noding.snapround.HotPixel.prototype.li=null;jsts.noding.snapround.HotPixel.prototype.pt=null;jsts.noding.snapround.HotPixel.prototype.originalPt=null;jsts.noding.snapround.HotPixel.prototype.ptScaled=null;jsts.noding.snapround.HotPixel.prototype.p0Scaled=null;jsts.noding.snapround.HotPixel.prototype.p1Scaled=null;jsts.noding.snapround.HotPixel.prototype.scaleFactor=undefined;jsts.noding.snapround.HotPixel.prototype.minx=undefined;jsts.noding.snapround.HotPixel.prototype.maxx=undefined;jsts.noding.snapround.HotPixel.prototype.miny=undefined;jsts.noding.snapround.HotPixel.prototype.maxy=undefined;jsts.noding.snapround.HotPixel.prototype.corner=null;jsts.noding.snapround.HotPixel.prototype.safeEnv=null;jsts.noding.snapround.HotPixel.prototype.getCoordinate=function(){return this.originalPt;};jsts.noding.snapround.HotPixel.SAFE_ENV_EXPANSION_FACTOR=0.75;jsts.noding.snapround.HotPixel.prototype.getSafeEnvelope=function(){if(this.safeEnv===null){var safeTolerance=jsts.noding.snapround.HotPixel.SAFE_ENV_EXPANSION_FACTOR/this.scaleFactor;this.safeEnv=new jsts.geom.Envelope(this.originalPt.x-safeTolerance,this.originalPt.x+safeTolerance,this.originalPt.y-safeTolerance,this.originalPt.y+safeTolerance);}
return this.safeEnv;};jsts.noding.snapround.HotPixel.prototype.initCorners=function(pt){var tolerance=0.5;this.minx=pt.x-tolerance;this.maxx=pt.x+tolerance;this.miny=pt.y-tolerance;this.maxy=pt.y+tolerance;this.corner[0]=new jsts.geom.Coordinate(this.maxx,this.maxy);this.corner[1]=new jsts.geom.Coordinate(this.minx,this.maxy);this.corner[2]=new jsts.geom.Coordinate(this.minx,this.miny);this.corner[3]=new jsts.geom.Coordinate(this.maxx,this.miny);};jsts.noding.snapround.HotPixel.prototype.scale=function(val){return Math.round(val*this.scaleFactor);};jsts.noding.snapround.HotPixel.prototype.intersects=function(p0,p1){if(this.scaleFactor===1.0)
return this.intersectsScaled(p0,p1);this.copyScaled(p0,this.p0Scaled);this.copyScaled(p1,this.p1Scaled);return this.intersectsScaled(this.p0Scaled,this.p1Scaled);};jsts.noding.snapround.HotPixel.prototype.copyScaled=function(p,pScaled){pScaled.x=this.scale(p.x);pScaled.y=this.scale(p.y);};jsts.noding.snapround.HotPixel.prototype.intersectsScaled=function(p0,p1){var segMinx=Math.min(p0.x,p1.x);var segMaxx=Math.max(p0.x,p1.x);var segMiny=Math.min(p0.y,p1.y);var segMaxy=Math.max(p0.y,p1.y);var isOutsidePixelEnv=this.maxx<segMinx||this.minx>segMaxx||this.maxy<segMiny||this.miny>segMaxy;if(isOutsidePixelEnv)
return false;var intersects=this.intersectsToleranceSquare(p0,p1);jsts.util.Assert.isTrue(!(isOutsidePixelEnv&&intersects),'Found bad envelope test');return intersects;};jsts.noding.snapround.HotPixel.prototype.intersectsToleranceSquare=function(p0,p1){var intersectsLeft=false;var intersectsBottom=false;this.li.computeIntersection(p0,p1,this.corner[0],this.corner[1]);if(this.li.isProper())
return true;this.li.computeIntersection(p0,p1,this.corner[1],this.corner[2]);if(this.li.isProper())
return true;if(this.li.hasIntersection())
intersectsLeft=true;this.li.computeIntersection(p0,p1,this.corner[2],this.corner[3]);if(this.li.isProper())
return true;if(this.li.hasIntersection())
intersectsBottom=true;this.li.computeIntersection(p0,p1,this.corner[3],this.corner[0]);if(this.li.isProper())
return true;if(intersectsLeft&&intersectsBottom)
return true;if(p0.equals(this.pt))
return true;if(p1.equals(this.pt))
return true;return false;};jsts.noding.snapround.HotPixel.prototype.intersectsPixelClosure=function(p0,p1){this.li.computeIntersection(p0,p1,this.corner[0],this.corner[1]);if(this.li.hasIntersection())
return true;this.li.computeIntersection(p0,p1,this.corner[1],this.corner[2]);if(this.li.hasIntersection())
return true;this.li.computeIntersection(p0,p1,this.corner[2],this.corner[3]);if(this.li.hasIntersection())
return true;this.li.computeIntersection(p0,p1,this.corner[3],this.corner[0]);if(this.li.hasIntersection())
return true;return false;};jsts.noding.snapround.HotPixel.prototype.addSnappedNode=function(segStr,segIndex){var p0=segStr.getCoordinate(segIndex);var p1=segStr.getCoordinate(segIndex+1);if(this.intersects(p0,p1)){segStr.addIntersection(this.getCoordinate(),segIndex);return true;}
return false;};jsts.operation.buffer.BufferInputLineSimplifier=function(inputLine){this.inputLine=inputLine;};jsts.operation.buffer.BufferInputLineSimplifier.simplify=function(inputLine,distanceTol){var simp=new jsts.operation.buffer.BufferInputLineSimplifier(inputLine);return simp.simplify(distanceTol);};jsts.operation.buffer.BufferInputLineSimplifier.INIT=0;jsts.operation.buffer.BufferInputLineSimplifier.DELETE=1;jsts.operation.buffer.BufferInputLineSimplifier.KEEP=1;jsts.operation.buffer.BufferInputLineSimplifier.prototype.inputLine=null;jsts.operation.buffer.BufferInputLineSimplifier.prototype.distanceTol=null;jsts.operation.buffer.BufferInputLineSimplifier.prototype.isDeleted=null;jsts.operation.buffer.BufferInputLineSimplifier.prototype.angleOrientation=jsts.algorithm.CGAlgorithms.COUNTERCLOCKWISE;jsts.operation.buffer.BufferInputLineSimplifier.prototype.simplify=function(distanceTol){this.distanceTol=Math.abs(distanceTol);if(distanceTol<0)
this.angleOrientation=jsts.algorithm.CGAlgorithms.CLOCKWISE;this.isDeleted=[];this.isDeleted.length=this.inputLine.length;var isChanged=false;do{isChanged=this.deleteShallowConcavities();}while(isChanged);return this.collapseLine();};jsts.operation.buffer.BufferInputLineSimplifier.prototype.deleteShallowConcavities=function(){var index=1;var maxIndex=this.inputLine.length-1;var midIndex=this.findNextNonDeletedIndex(index);var lastIndex=this.findNextNonDeletedIndex(midIndex);var isChanged=false;while(lastIndex<this.inputLine.length){var isMiddleVertexDeleted=false;if(this.isDeletable(index,midIndex,lastIndex,this.distanceTol)){this.isDeleted[midIndex]=jsts.operation.buffer.BufferInputLineSimplifier.DELETE;isMiddleVertexDeleted=true;isChanged=true;}
if(isMiddleVertexDeleted)
index=lastIndex;else
index=midIndex;midIndex=this.findNextNonDeletedIndex(index);lastIndex=this.findNextNonDeletedIndex(midIndex);}
return isChanged;};jsts.operation.buffer.BufferInputLineSimplifier.prototype.findNextNonDeletedIndex=function(index){var next=index+1;while(next<this.inputLine.length&&this.isDeleted[next]===jsts.operation.buffer.BufferInputLineSimplifier.DELETE)
next++;return next;};jsts.operation.buffer.BufferInputLineSimplifier.prototype.collapseLine=function(){var coordList=[];for(var i=0;i<this.inputLine.length;i++){if(this.isDeleted[i]!==jsts.operation.buffer.BufferInputLineSimplifier.DELETE)
coordList.push(this.inputLine[i]);}
return coordList;};jsts.operation.buffer.BufferInputLineSimplifier.prototype.isDeletable=function(i0,i1,i2,distanceTol){var p0=this.inputLine[i0];var p1=this.inputLine[i1];var p2=this.inputLine[i2];if(!this.isConcave(p0,p1,p2))
return false;if(!this.isShallow(p0,p1,p2,distanceTol))
return false;return this.isShallowSampled(p0,p1,i0,i2,distanceTol);};jsts.operation.buffer.BufferInputLineSimplifier.prototype.isShallowConcavity=function(p0,p1,p2,distanceTol){var orientation=jsts.algorithm.CGAlgorithms.computeOrientation(p0,p1,p2);var isAngleToSimplify=(orientation===this.angleOrientation);if(!isAngleToSimplify)
return false;var dist=jsts.algorithm.CGAlgorithms.distancePointLine(p1,p0,p2);return dist<distanceTol;};jsts.operation.buffer.BufferInputLineSimplifier.NUM_PTS_TO_CHECK=10;jsts.operation.buffer.BufferInputLineSimplifier.prototype.isShallowSampled=function(p0,p2,i0,i2,distanceTol){var inc=parseInt((i2-i0)/jsts.operation.buffer.BufferInputLineSimplifier.NUM_PTS_TO_CHECK);if(inc<=0)
inc=1;for(var i=i0;i<i2;i+=inc){if(!this.isShallow(p0,p2,this.inputLine[i],distanceTol))
return false;}
return true;};jsts.operation.buffer.BufferInputLineSimplifier.prototype.isShallow=function(p0,p1,p2,distanceTol){var dist=jsts.algorithm.CGAlgorithms.distancePointLine(p1,p0,p2);return dist<distanceTol;};jsts.operation.buffer.BufferInputLineSimplifier.prototype.isConcave=function(p0,p1,p2){var orientation=jsts.algorithm.CGAlgorithms.computeOrientation(p0,p1,p2);var isConcave=(orientation===this.angleOrientation);return isConcave;};jsts.geomgraph.index.SweepLineEvent=function(x,obj,label){if(!(obj instanceof jsts.geomgraph.index.SweepLineEvent)){this.eventType=jsts.geomgraph.index.SweepLineEvent.INSERT;this.label=label;this.xValue=x;this.obj=obj;return;}
this.eventType=jsts.geomgraph.index.SweepLineEvent.DELETE;this.xValue=x;this.insertEvent=obj;};jsts.geomgraph.index.SweepLineEvent.INSERT=1;jsts.geomgraph.index.SweepLineEvent.DELETE=2;jsts.geomgraph.index.SweepLineEvent.prototype.label=null;jsts.geomgraph.index.SweepLineEvent.prototype.xValue=null;jsts.geomgraph.index.SweepLineEvent.prototype.eventType=null;jsts.geomgraph.index.SweepLineEvent.prototype.insertEvent=null;jsts.geomgraph.index.SweepLineEvent.prototype.deleteEventIndex=null;jsts.geomgraph.index.SweepLineEvent.prototype.obj=null;jsts.geomgraph.index.SweepLineEvent.prototype.isInsert=function(){return this.eventType==jsts.geomgraph.index.SweepLineEvent.INSERT;};jsts.geomgraph.index.SweepLineEvent.prototype.isDelete=function(){return this.eventType==jsts.geomgraph.index.SweepLineEvent.DELETE;};jsts.geomgraph.index.SweepLineEvent.prototype.getInsertEvent=function(){return this.insertEvent;};jsts.geomgraph.index.SweepLineEvent.prototype.getDeleteEventIndex=function(){return this.deleteEventIndex;};jsts.geomgraph.index.SweepLineEvent.prototype.setDeleteEventIndex=function(deleteEventIndex){this.deleteEventIndex=deleteEventIndex;};jsts.geomgraph.index.SweepLineEvent.prototype.getObject=function(){return this.obj;};jsts.geomgraph.index.SweepLineEvent.prototype.isSameLabel=function(ev){if(this.label==null){return false;}
return this.label==ev.label;};jsts.geomgraph.index.SweepLineEvent.prototype.compareTo=function(pe){if(this.xValue<pe.xValue){return-1;}
if(this.xValue>pe.xValue){return 1;}
if(this.eventType<pe.eventType){return-1;}
if(this.eventType>pe.eventType){return 1;}
return 0;};jsts.geom.CoordinateList=function(coord,allowRepeated){this.array=[];allowRepeated=(allowRepeated===undefined)?true:allowRepeated;if(coord!==undefined){this.add(coord,allowRepeated);}};jsts.geom.CoordinateList.prototype=new javascript.util.ArrayList();jsts.geom.CoordinateList.prototype.iterator=null;jsts.geom.CoordinateList.prototype.remove=null;jsts.geom.CoordinateList.prototype.get=function(i){return this.array[i];};jsts.geom.CoordinateList.prototype.set=function(i,e){var o=this.array[i];this.array[i]=e;return o;};jsts.geom.CoordinateList.prototype.size=function(){return this.array.length;};jsts.geom.CoordinateList.prototype.add=function(){if(arguments.length>1){return this.addCoordinates.apply(this,arguments);}else{return this.array.push(arguments[0]);}};jsts.geom.CoordinateList.prototype.addCoordinates=function(coord,allowRepeated,direction){if(coord instanceof jsts.geom.Coordinate){return this.addCoordinate.apply(this,arguments);}else if(typeof coord==='number'){return this.insertCoordinate.apply(this,arguments);}
direction=direction||true;if(direction){for(var i=0;i<coord.length;i++){this.addCoordinate(coord[i],allowRepeated);}}else{for(var i=coord.length-1;i>=0;i--){this.addCoordinate(coord[i],allowRepeated);}}
return true;};jsts.geom.CoordinateList.prototype.addCoordinate=function(coord,allowRepeated){if(!allowRepeated){if(this.size()>=1){var last=this.get(this.size()-1);if(last.equals2D(coord))return;}}
this.add(coord);};jsts.geom.CoordinateList.prototype.insertCoordinate=function(index,coord,allowRepeated){if(!allowRepeated){var before=index>0?index-1:-1;if(before!==-1&&this.get(before).equals2D(coord)){return;}
var after=index<this.size()-1?index+1:-1;if(after!==-1&&this.get(after).equals2D(coord)){return;}}
this.array.splice(index,0,coord);};jsts.geom.CoordinateList.prototype.closeRing=function(){if(this.size()>0){this.addCoordinate(new jsts.geom.Coordinate(this.get(0)),false);}};jsts.geom.CoordinateList.prototype.toArray=function(){return this.array;};jsts.geom.CoordinateList.prototype.toCoordinateArray=function(){return this.array;};jsts.operation.buffer.OffsetSegmentGenerator=function(precisionModel,bufParams,distance){this.seg0=new jsts.geom.LineSegment();this.seg1=new jsts.geom.LineSegment();this.offset0=new jsts.geom.LineSegment();this.offset1=new jsts.geom.LineSegment();this.precisionModel=precisionModel;this.bufParams=bufParams;this.li=new jsts.algorithm.RobustLineIntersector();this.filletAngleQuantum=Math.PI/2.0/bufParams.getQuadrantSegments();if(this.bufParams.getQuadrantSegments()>=8&&this.bufParams.getJoinStyle()===jsts.operation.buffer.BufferParameters.JOIN_ROUND){this.closingSegLengthFactor=jsts.operation.buffer.OffsetSegmentGenerator.MAX_CLOSING_SEG_LEN_FACTOR;}
this.init(distance);};jsts.operation.buffer.OffsetSegmentGenerator.OFFSET_SEGMENT_SEPARATION_FACTOR=1.0E-3;jsts.operation.buffer.OffsetSegmentGenerator.INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR=1.0E-3;jsts.operation.buffer.OffsetSegmentGenerator.CURVE_VERTEX_SNAP_DISTANCE_FACTOR=1.0E-6;jsts.operation.buffer.OffsetSegmentGenerator.MAX_CLOSING_SEG_LEN_FACTOR=80;jsts.operation.buffer.OffsetSegmentGenerator.prototype.maxCurveSegmentError=0.0;jsts.operation.buffer.OffsetSegmentGenerator.prototype.filletAngleQuantum=null;jsts.operation.buffer.OffsetSegmentGenerator.prototype.closingSegLengthFactor=1;jsts.operation.buffer.OffsetSegmentGenerator.prototype.segList=null;jsts.operation.buffer.OffsetSegmentGenerator.prototype.distance=0.0;jsts.operation.buffer.OffsetSegmentGenerator.prototype.precisionModel=null;jsts.operation.buffer.OffsetSegmentGenerator.prototype.bufParams=null;jsts.operation.buffer.OffsetSegmentGenerator.prototype.li=null;jsts.operation.buffer.OffsetSegmentGenerator.prototype.s0=null;jsts.operation.buffer.OffsetSegmentGenerator.prototype.s1=null;jsts.operation.buffer.OffsetSegmentGenerator.prototype.s2=null;jsts.operation.buffer.OffsetSegmentGenerator.prototype.seg0=null;jsts.operation.buffer.OffsetSegmentGenerator.prototype.seg1=null;jsts.operation.buffer.OffsetSegmentGenerator.prototype.offset0=null;jsts.operation.buffer.OffsetSegmentGenerator.prototype.offset1=null;jsts.operation.buffer.OffsetSegmentGenerator.prototype.side=0;jsts.operation.buffer.OffsetSegmentGenerator.prototype.hasNarrowConcaveAngle=false;jsts.operation.buffer.OffsetSegmentGenerator.prototype.hasNarrowConcaveAngle=function(){return this.hasNarrowConcaveAngle;};jsts.operation.buffer.OffsetSegmentGenerator.prototype.init=function(distance){this.distance=distance;this.maxCurveSegmentError=this.distance*(1-Math.cos(this.filletAngleQuantum/2.0));this.segList=new jsts.operation.buffer.OffsetSegmentString();this.segList.setPrecisionModel(this.precisionModel);this.segList.setMinimumVertexDistance(this.distance*jsts.operation.buffer.OffsetSegmentGenerator.CURVE_VERTEX_SNAP_DISTANCE_FACTOR);};jsts.operation.buffer.OffsetSegmentGenerator.prototype.initSideSegments=function(s1,s2,side){this.s1=s1;this.s2=s2;this.side=side;this.seg1.setCoordinates(this.s1,this.s2);this.computeOffsetSegment(this.seg1,this.side,this.distance,this.offset1);};jsts.operation.buffer.OffsetSegmentGenerator.prototype.getCoordinates=function(){return this.segList.getCoordinates();};jsts.operation.buffer.OffsetSegmentGenerator.prototype.closeRing=function(){this.segList.closeRing();};jsts.operation.buffer.OffsetSegmentGenerator.prototype.addSegments=function(pt,isForward){this.segList.addPts(pt,isForward);};jsts.operation.buffer.OffsetSegmentGenerator.prototype.addFirstSegment=function(){this.segList.addPt(this.offset1.p0);};jsts.operation.buffer.OffsetSegmentGenerator.prototype.addLastSegment=function(){this.segList.addPt(this.offset1.p1);};jsts.operation.buffer.OffsetSegmentGenerator.prototype.addNextSegment=function(p,addStartPoint){this.s0=this.s1;this.s1=this.s2;this.s2=p;this.seg0.setCoordinates(this.s0,this.s1);this.computeOffsetSegment(this.seg0,this.side,this.distance,this.offset0);this.seg1.setCoordinates(this.s1,this.s2);this.computeOffsetSegment(this.seg1,this.side,this.distance,this.offset1);if(this.s1.equals(this.s2))
return;var orientation=jsts.algorithm.CGAlgorithms.computeOrientation(this.s0,this.s1,this.s2);var outsideTurn=(orientation===jsts.algorithm.CGAlgorithms.CLOCKWISE&&this.side===jsts.geomgraph.Position.LEFT)||(orientation===jsts.algorithm.CGAlgorithms.COUNTERCLOCKWISE&&this.side===jsts.geomgraph.Position.RIGHT);if(orientation==0){this.addCollinear(addStartPoint);}else if(outsideTurn){this.addOutsideTurn(orientation,addStartPoint);}else{this.addInsideTurn(orientation,addStartPoint);}};jsts.operation.buffer.OffsetSegmentGenerator.prototype.addCollinear=function(addStartPoint){this.li.computeIntersection(this.s0,this.s1,this.s1,this.s2);var numInt=this.li.getIntersectionNum();if(numInt>=2){if(this.bufParams.getJoinStyle()===jsts.operation.buffer.BufferParameters.JOIN_BEVEL||this.bufParams.getJoinStyle()===jsts.operation.buffer.BufferParameters.JOIN_MITRE){if(addStartPoint)
this.segList.addPt(this.offset0.p1);this.segList.addPt(this.offset1.p0);}else{this.addFillet(this.s1,this.offset0.p1,this.offset1.p0,jsts.algorithm.CGAlgorithms.CLOCKWISE,this.distance);}}};jsts.operation.buffer.OffsetSegmentGenerator.prototype.addOutsideTurn=function(orientation,addStartPoint){if(this.offset0.p1.distance(this.offset1.p0)<this.distance*jsts.operation.buffer.OffsetSegmentGenerator.OFFSET_SEGMENT_SEPARATION_FACTOR){this.segList.addPt(this.offset0.p1);return;}
if(this.bufParams.getJoinStyle()===jsts.operation.buffer.BufferParameters.JOIN_MITRE){this.addMitreJoin(this.s1,this.offset0,this.offset1,this.distance);}else if(this.bufParams.getJoinStyle()===jsts.operation.buffer.BufferParameters.JOIN_BEVEL){this.addBevelJoin(this.offset0,this.offset1);}else{if(addStartPoint)
this.segList.addPt(this.offset0.p1);this.addFillet(this.s1,this.offset0.p1,this.offset1.p0,orientation,this.distance);this.segList.addPt(this.offset1.p0);}};jsts.operation.buffer.OffsetSegmentGenerator.prototype.addInsideTurn=function(orientation,addStartPoint){this.li.computeIntersection(this.offset0.p0,this.offset0.p1,this.offset1.p0,this.offset1.p1);if(this.li.hasIntersection()){this.segList.addPt(this.li.getIntersection(0));}else{this.hasNarrowConcaveAngle=true;if(this.offset0.p1.distance(this.offset1.p0)<this.distance*jsts.operation.buffer.OffsetSegmentGenerator.INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR){this.segList.addPt(this.offset0.p1);}else{this.segList.addPt(this.offset0.p1);if(this.closingSegLengthFactor>0){var mid0=new jsts.geom.Coordinate((this.closingSegLengthFactor*this.offset0.p1.x+this.s1.x)/(this.closingSegLengthFactor+1),(this.closingSegLengthFactor*this.offset0.p1.y+this.s1.y)/(this.closingSegLengthFactor+1));this.segList.addPt(mid0);var mid1=new jsts.geom.Coordinate((this.closingSegLengthFactor*this.offset1.p0.x+this.s1.x)/(this.closingSegLengthFactor+1),(this.closingSegLengthFactor*this.offset1.p0.y+this.s1.y)/(this.closingSegLengthFactor+1));this.segList.addPt(mid1);}else{this.segList.addPt(this.s1);}
this.segList.addPt(this.offset1.p0);}}};jsts.operation.buffer.OffsetSegmentGenerator.prototype.computeOffsetSegment=function(seg,side,distance,offset){var sideSign=side===jsts.geomgraph.Position.LEFT?1:-1;var dx=seg.p1.x-seg.p0.x;var dy=seg.p1.y-seg.p0.y;var len=Math.sqrt(dx*dx+dy*dy);var ux=sideSign*distance*dx/len;var uy=sideSign*distance*dy/len;offset.p0.x=seg.p0.x-uy;offset.p0.y=seg.p0.y+ux;offset.p1.x=seg.p1.x-uy;offset.p1.y=seg.p1.y+ux;};jsts.operation.buffer.OffsetSegmentGenerator.prototype.addLineEndCap=function(p0,p1){var seg=new jsts.geom.LineSegment(p0,p1);var offsetL=new jsts.geom.LineSegment();this.computeOffsetSegment(seg,jsts.geomgraph.Position.LEFT,this.distance,offsetL);var offsetR=new jsts.geom.LineSegment();this.computeOffsetSegment(seg,jsts.geomgraph.Position.RIGHT,this.distance,offsetR);var dx=p1.x-p0.x;var dy=p1.y-p0.y;var angle=Math.atan2(dy,dx);switch(this.bufParams.getEndCapStyle()){case jsts.operation.buffer.BufferParameters.CAP_ROUND:this.segList.addPt(offsetL.p1);this.addFillet(p1,angle+Math.PI/2,angle-Math.PI/2,jsts.algorithm.CGAlgorithms.CLOCKWISE,this.distance);this.segList.addPt(offsetR.p1);break;case jsts.operation.buffer.BufferParameters.CAP_FLAT:this.segList.addPt(offsetL.p1);this.segList.addPt(offsetR.p1);break;case jsts.operation.buffer.BufferParameters.CAP_SQUARE:var squareCapSideOffset=new jsts.geom.Coordinate();squareCapSideOffset.x=Math.abs(this.distance)*Math.cos(angle);squareCapSideOffset.y=Math.abs(this.distance)*Math.sin(angle);var squareCapLOffset=new jsts.geom.Coordinate(offsetL.p1.x+
squareCapSideOffset.x,offsetL.p1.y+squareCapSideOffset.y);var squareCapROffset=new jsts.geom.Coordinate(offsetR.p1.x+
squareCapSideOffset.x,offsetR.p1.y+squareCapSideOffset.y);this.segList.addPt(squareCapLOffset);this.segList.addPt(squareCapROffset);break;}};jsts.operation.buffer.OffsetSegmentGenerator.prototype.addMitreJoin=function(p,offset0,offset1,distance){var isMitreWithinLimit=true;var intPt=null;try{intPt=jsts.algorithm.HCoordinate.intersection(offset0.p0,offset0.p1,offset1.p0,offset1.p1);var mitreRatio=distance<=0.0?1.0:intPt.distance(p)/Math.abs(distance);if(mitreRatio>this.bufParams.getMitreLimit())
this.isMitreWithinLimit=false;}catch(e){if(e instanceof jsts.error.NotRepresentableError){intPt=new jsts.geom.Coordinate(0,0);this.isMitreWithinLimit=false;}}
if(isMitreWithinLimit){this.segList.addPt(intPt);}else{this.addLimitedMitreJoin(offset0,offset1,distance,bufParams.getMitreLimit());}};jsts.operation.buffer.OffsetSegmentGenerator.prototype.addLimitedMitreJoin=function(offset0,offset1,distance,mitreLimit){var basePt=this.seg0.p1;var ang0=jsts.algorithm.Angle.angle(basePt,this.seg0.p0);var ang1=jsts.algorithm.Angle.angle(basePt,this.seg1.p1);var angDiff=jsts.algorithm.Angle.angleBetweenOriented(this.seg0.p0,basePt,this.seg1.p1);var angDiffHalf=angDiff/2;var midAng=jsts.algorithm.Angle.normalize(ang0+angDiffHalf);var mitreMidAng=jsts.algorithm.Angle.normalize(midAng+Math.PI);var mitreDist=mitreLimit*distance;var bevelDelta=mitreDist*Math.abs(Math.sin(angDiffHalf));var bevelHalfLen=distance-bevelDelta;var bevelMidX=basePt.x+mitreDist*Math.cos(mitreMidAng);var bevelMidY=basePt.y+mitreDist*Math.sin(mitreMidAng);var bevelMidPt=new jsts.geom.Coordinate(bevelMidX,bevelMidY);var mitreMidLine=new jsts.geom.LineSegment(basePt,bevelMidPt);var bevelEndLeft=mitreMidLine.pointAlongOffset(1.0,bevelHalfLen);var bevelEndRight=mitreMidLine.pointAlongOffset(1.0,-bevelHalfLen);if(this.side==jsts.geomgraph.Position.LEFT){this.segList.addPt(bevelEndLeft);this.segList.addPt(bevelEndRight);}else{this.segList.addPt(bevelEndRight);this.segList.addPt(bevelEndLeft);}};jsts.operation.buffer.OffsetSegmentGenerator.prototype.addBevelJoin=function(offset0,offset1){this.segList.addPt(offset0.p1);this.segList.addPt(offset1.p0);};jsts.operation.buffer.OffsetSegmentGenerator.prototype.addFillet=function(p,p0,p1,direction,radius){if(!(p1 instanceof jsts.geom.Coordinate)){this.addFillet2.apply(this,arguments);return;}
var dx0=p0.x-p.x;var dy0=p0.y-p.y;var startAngle=Math.atan2(dy0,dx0);var dx1=p1.x-p.x;var dy1=p1.y-p.y;var endAngle=Math.atan2(dy1,dx1);if(direction===jsts.algorithm.CGAlgorithms.CLOCKWISE){if(startAngle<=endAngle)
startAngle+=2.0*Math.PI;}else{if(startAngle>=endAngle)
startAngle-=2.0*Math.PI;}
this.segList.addPt(p0);this.addFillet(p,startAngle,endAngle,direction,radius);this.segList.addPt(p1);};jsts.operation.buffer.OffsetSegmentGenerator.prototype.addFillet2=function(p,startAngle,endAngle,direction,radius){var directionFactor=direction===jsts.algorithm.CGAlgorithms.CLOCKWISE?-1:1;var totalAngle=Math.abs(startAngle-endAngle);var nSegs=parseInt((totalAngle/this.filletAngleQuantum+0.5));if(nSegs<1)
return;var initAngle,currAngleInc;initAngle=0.0;currAngleInc=totalAngle/nSegs;var currAngle=initAngle;var pt=new jsts.geom.Coordinate();while(currAngle<totalAngle){var angle=startAngle+directionFactor*currAngle;pt.x=p.x+radius*Math.cos(angle);pt.y=p.y+radius*Math.sin(angle);this.segList.addPt(pt);currAngle+=currAngleInc;}};jsts.operation.buffer.OffsetSegmentGenerator.prototype.createCircle=function(p){var pt=new jsts.geom.Coordinate(p.x+this.distance,p.y);this.segList.addPt(pt);this.addFillet(p,0.0,2.0*Math.PI,-1,this.distance);this.segList.closeRing();};jsts.operation.buffer.OffsetSegmentGenerator.prototype.createSquare=function(p){this.segList.addPt(new jsts.geom.Coordinate(p.x+distance,p.y+distance));this.segList.addPt(new jsts.geom.Coordinate(p.x+distance,p.y-distance));this.segList.addPt(new jsts.geom.Coordinate(p.x-distance,p.y-distance));this.segList.addPt(new jsts.geom.Coordinate(p.x-distance,p.y+distance));this.segList.closeRing();};jsts.operation.overlay.MaximalEdgeRing=function(start,geometryFactory){jsts.geomgraph.EdgeRing.call(this,start,geometryFactory);};jsts.operation.overlay.MaximalEdgeRing.prototype=new jsts.geomgraph.EdgeRing();jsts.operation.overlay.MaximalEdgeRing.constructor=jsts.operation.overlay.MaximalEdgeRing;jsts.operation.overlay.MaximalEdgeRing.prototype.getNext=function(de)
{return de.getNext();};jsts.operation.overlay.MaximalEdgeRing.prototype.setEdgeRing=function(de,er)
{de.setEdgeRing(er);};jsts.operation.overlay.MaximalEdgeRing.prototype.linkDirectedEdgesForMinimalEdgeRings=function()
{var de=this.startDe;do{var node=de.getNode();node.getEdges().linkMinimalDirectedEdges(this);de=de.getNext();}while(de!=this.startDe);};jsts.operation.overlay.MaximalEdgeRing.prototype.buildMinimalRings=function()
{var minEdgeRings=[];var de=this.startDe;do{if(de.getMinEdgeRing()===null){var minEr=new jsts.operation.overlay.MinimalEdgeRing(de,this.geometryFactory);minEdgeRings.push(minEr);}
de=de.getNext();}while(de!=this.startDe);return minEdgeRings;};jsts.algorithm.CentroidPoint=function(){this.centSum=new jsts.geom.Coordinate();};jsts.algorithm.CentroidPoint.prototype.ptCount=0;jsts.algorithm.CentroidPoint.prototype.centSum=null;jsts.algorithm.CentroidPoint.prototype.add=function(geom){if(geom instanceof jsts.geom.Point){this.add2(geom.getCoordinate());}else if(geom instanceof jsts.geom.GeometryCollection||geom instanceof jsts.geom.MultiPoint||geom instanceof jsts.geom.MultiLineString||geom instanceof jsts.geom.MultiPolygon){var gc=geom;for(var i=0;i<gc.getNumGeometries();i++){this.add(gc.getGeometryN(i));}}};jsts.algorithm.CentroidPoint.prototype.add2=function(pt){this.ptCount+=1;this.centSum.x+=pt.x;this.centSum.y+=pt.y;};jsts.algorithm.CentroidPoint.prototype.getCentroid=function(){var cent=new jsts.geom.Coordinate();cent.x=this.centSum.x/this.ptCount;cent.y=this.centSum.y/this.ptCount;return cent;};jsts.operation.distance.ConnectedElementLocationFilter=function(locations){this.locations=locations;};jsts.operation.distance.ConnectedElementLocationFilter.prototype=new jsts.geom.GeometryFilter();jsts.operation.distance.ConnectedElementLocationFilter.prototype.locations=null;jsts.operation.distance.ConnectedElementLocationFilter.getLocations=function(geom){var locations=[];geom.apply(new jsts.operation.distance.ConnectedElementLocationFilter(locations));return locations;};jsts.operation.distance.ConnectedElementLocationFilter.prototype.filter=function(geom){if(geom instanceof jsts.geom.Point||geom instanceof jsts.geom.LineString||geom instanceof jsts.geom.Polygon)
this.locations.push(new jsts.operation.distance.GeometryLocation(geom,0,geom.getCoordinate()));};jsts.geomgraph.index.MonotoneChainEdge=function(e){this.e=e;this.pts=e.getCoordinates();var mcb=new jsts.geomgraph.index.MonotoneChainIndexer();this.startIndex=mcb.getChainStartIndices(this.pts);};jsts.geomgraph.index.MonotoneChainEdge.prototype.e=null;jsts.geomgraph.index.MonotoneChainEdge.prototype.pts=null;jsts.geomgraph.index.MonotoneChainEdge.prototype.startIndex=null;jsts.geomgraph.index.MonotoneChainEdge.prototype.env1=new jsts.geom.Envelope();jsts.geomgraph.index.MonotoneChainEdge.prototype.env2=new jsts.geom.Envelope();jsts.geomgraph.index.MonotoneChainEdge.prototype.getCoordinates=function(){return this.pts;};jsts.geomgraph.index.MonotoneChainEdge.prototype.getStartIndexes=function(){return this.startIndex;};jsts.geomgraph.index.MonotoneChainEdge.prototype.getMinX=function(chainIndex){var x1=this.pts[this.startIndex[chainIndex]].x;var x2=this.pts[this.startIndex[chainIndex+1]].x;if(x1<x2){return x1;}
return x2;};jsts.geomgraph.index.MonotoneChainEdge.prototype.getMaxX=function(chainIndex){var x1=this.pts[this.startIndex[chainIndex]].x;var x2=this.pts[this.startIndex[chainIndex+1]].x;if(x1>x2){return x1;}
return x2;};jsts.geomgraph.index.MonotoneChainEdge.prototype.computeIntersects=function(mce,si){for(var i=0;i<this.startIndex.length-1;i++){for(var j=0;j<mce.startIndex.length-1;j++){this.computeIntersectsForChain(i,mce,j,si);}}};jsts.geomgraph.index.MonotoneChainEdge.prototype.computeIntersectsForChain=function(chainIndex0,mce,chainIndex1,si){this.computeIntersectsForChain2(this.startIndex[chainIndex0],this.startIndex[chainIndex0+1],mce,mce.startIndex[chainIndex1],mce.startIndex[chainIndex1+1],si);};jsts.geomgraph.index.MonotoneChainEdge.prototype.computeIntersectsForChain2=function(start0,end0,mce,start1,end1,ei){var p00=this.pts[start0];var p01=this.pts[end0];var p10=mce.pts[start1];var p11=mce.pts[end1];if(end0-start0==1&&end1-start1==1){ei.addIntersections(this.e,start0,mce.e,start1);return;}
this.env1.init(p00,p01);this.env2.init(p10,p11);if(!this.env1.intersects(this.env2)){return;}
var mid0=Math.floor((start0+end0)/2);var mid1=Math.floor((start1+end1)/2);if(start0<mid0){if(start1<mid1){this.computeIntersectsForChain2(start0,mid0,mce,start1,mid1,ei);}
if(mid1<end1){this.computeIntersectsForChain2(start0,mid0,mce,mid1,end1,ei);}}
if(mid0<end0){if(start1<mid1){this.computeIntersectsForChain2(mid0,end0,mce,start1,mid1,ei);}
if(mid1<end1){this.computeIntersectsForChain2(mid0,end0,mce,mid1,end1,ei);}}};(function(){var ArrayList=javascript.util.ArrayList;jsts.operation.relate.EdgeEndBuilder=function(){};jsts.operation.relate.EdgeEndBuilder.prototype.computeEdgeEnds=function(edges){if(arguments.length==2){this.computeEdgeEnds2.apply(this,arguments);return;}
var l=new ArrayList();for(var i=edges;i.hasNext();){var e=i.next();this.computeEdgeEnds2(e,l);}
return l;};jsts.operation.relate.EdgeEndBuilder.prototype.computeEdgeEnds2=function(edge,l){var eiList=edge.getEdgeIntersectionList();eiList.addEndpoints();var it=eiList.iterator();var eiPrev=null;var eiCurr=null;if(!it.hasNext())
return;var eiNext=it.next();do{eiPrev=eiCurr;eiCurr=eiNext;eiNext=null;if(it.hasNext())
eiNext=it.next();if(eiCurr!==null){this.createEdgeEndForPrev(edge,l,eiCurr,eiPrev);this.createEdgeEndForNext(edge,l,eiCurr,eiNext);}}while(eiCurr!==null);};jsts.operation.relate.EdgeEndBuilder.prototype.createEdgeEndForPrev=function(edge,l,eiCurr,eiPrev){var iPrev=eiCurr.segmentIndex;if(eiCurr.dist===0.0){if(iPrev===0)
return;iPrev--;}
var pPrev=edge.getCoordinate(iPrev);if(eiPrev!==null&&eiPrev.segmentIndex>=iPrev)
pPrev=eiPrev.coord;var label=new jsts.geomgraph.Label(edge.getLabel());label.flip();var e=new jsts.geomgraph.EdgeEnd(edge,eiCurr.coord,pPrev,label);l.add(e);};jsts.operation.relate.EdgeEndBuilder.prototype.createEdgeEndForNext=function(edge,l,eiCurr,eiNext){var iNext=eiCurr.segmentIndex+1;if(iNext>=edge.getNumPoints()&&eiNext===null)
return;var pNext=edge.getCoordinate(iNext);if(eiNext!==null&&eiNext.segmentIndex===eiCurr.segmentIndex)
pNext=eiNext.coord;var e=new jsts.geomgraph.EdgeEnd(edge,eiCurr.coord,pNext,new jsts.geomgraph.Label(edge.getLabel()));l.add(e);};})();(function(){var ArrayList=javascript.util.ArrayList;var TreeSet=javascript.util.TreeSet;var CoordinateFilter=jsts.geom.CoordinateFilter;jsts.util.UniqueCoordinateArrayFilter=function(){this.treeSet=new TreeSet();this.list=new ArrayList();};jsts.util.UniqueCoordinateArrayFilter.prototype=new CoordinateFilter();jsts.util.UniqueCoordinateArrayFilter.prototype.treeSet=null;jsts.util.UniqueCoordinateArrayFilter.prototype.list=null;jsts.util.UniqueCoordinateArrayFilter.prototype.getCoordinates=function(){return this.list.toArray();};jsts.util.UniqueCoordinateArrayFilter.prototype.filter=function(coord){if(!this.treeSet.contains(coord)){this.list.add(coord);this.treeSet.add(coord);}};})();(function(){var CGAlgorithms=jsts.algorithm.CGAlgorithms;var UniqueCoordinateArrayFilter=jsts.util.UniqueCoordinateArrayFilter;var Assert=jsts.util.Assert;var Stack=javascript.util.Stack;var ArrayList=javascript.util.ArrayList;var Arrays=javascript.util.Arrays;var RadialComparator=function(origin){this.origin=origin;};RadialComparator.prototype.origin=null;RadialComparator.prototype.compare=function(o1,o2){var p1=o1;var p2=o2;return RadialComparator.polarCompare(this.origin,p1,p2);};RadialComparator.polarCompare=function(o,p,q){var dxp=p.x-o.x;var dyp=p.y-o.y;var dxq=q.x-o.x;var dyq=q.y-o.y;var orient=CGAlgorithms.computeOrientation(o,p,q);if(orient==CGAlgorithms.COUNTERCLOCKWISE)
return 1;if(orient==CGAlgorithms.CLOCKWISE)
return-1;var op=dxp*dxp+dyp*dyp;var oq=dxq*dxq+dyq*dyq;if(op<oq){return-1;}
if(op>oq){return 1;}
return 0;};jsts.algorithm.ConvexHull=function(){if(arguments.length===1){var geometry=arguments[0];this.inputPts=jsts.algorithm.ConvexHull.extractCoordinates(geometry);this.geomFactory=geometry.getFactory();}else{this.pts=arguments[0];this.geomFactory=arguments[1];}};jsts.algorithm.ConvexHull.prototype.geomFactory=null;jsts.algorithm.ConvexHull.prototype.inputPts=null;jsts.algorithm.ConvexHull.extractCoordinates=function(geom){var filter=new UniqueCoordinateArrayFilter();geom.apply(filter);return filter.getCoordinates();};jsts.algorithm.ConvexHull.prototype.getConvexHull=function(){if(this.inputPts.length==0){return this.geomFactory.createGeometryCollection(null);}
if(this.inputPts.length==1){return this.geomFactory.createPoint(this.inputPts[0]);}
if(this.inputPts.length==2){return this.geomFactory.createLineString(this.inputPts);}
var reducedPts=this.inputPts;if(this.inputPts.length>50){reducedPts=this.reduce(this.inputPts);}
var sortedPts=this.preSort(reducedPts);var cHS=this.grahamScan(sortedPts);var cH=cHS.toArray();return this.lineOrPolygon(cH);};jsts.algorithm.ConvexHull.prototype.reduce=function(inputPts){var polyPts=this.computeOctRing(inputPts);if(polyPts==null)
return this.inputPts;var reducedSet=new javascript.util.TreeSet();for(var i=0;i<polyPts.length;i++){reducedSet.add(polyPts[i]);}
for(var i=0;i<inputPts.length;i++){if(!CGAlgorithms.isPointInRing(inputPts[i],polyPts)){reducedSet.add(inputPts[i]);}}
var reducedPts=reducedSet.toArray();if(reducedPts.length<3)
return this.padArray3(reducedPts);return reducedPts;};jsts.algorithm.ConvexHull.prototype.padArray3=function(pts){var pad=[];for(var i=0;i<pad.length;i++){if(i<pts.length){pad[i]=pts[i];}else
pad[i]=pts[0];}
return pad;};jsts.algorithm.ConvexHull.prototype.preSort=function(pts){var t;for(var i=1;i<pts.length;i++){if((pts[i].y<pts[0].y)||((pts[i].y==pts[0].y)&&(pts[i].x<pts[0].x))){t=pts[0];pts[0]=pts[i];pts[i]=t;}}
Arrays.sort(pts,1,pts.length,new RadialComparator(pts[0]));return pts;};jsts.algorithm.ConvexHull.prototype.grahamScan=function(c){var p;var ps=new Stack();p=ps.push(c[0]);p=ps.push(c[1]);p=ps.push(c[2]);for(var i=3;i<c.length;i++){p=ps.pop();while(!ps.empty()&&CGAlgorithms.computeOrientation(ps.peek(),p,c[i])>0){p=ps.pop();}
p=ps.push(p);p=ps.push(c[i]);}
p=ps.push(c[0]);return ps;};jsts.algorithm.ConvexHull.prototype.isBetween=function(c1,c2,c3){if(CGAlgorithms.computeOrientation(c1,c2,c3)!==0){return false;}
if(c1.x!=c3.x){if(c1.x<=c2.x&&c2.x<=c3.x){return true;}
if(c3.x<=c2.x&&c2.x<=c1.x){return true;}}
if(c1.y!=c3.y){if(c1.y<=c2.y&&c2.y<=c3.y){return true;}
if(c3.y<=c2.y&&c2.y<=c1.y){return true;}}
return false;};jsts.algorithm.ConvexHull.prototype.computeOctRing=function(inputPts){var octPts=this.computeOctPts(inputPts);var coordList=new jsts.geom.CoordinateList();coordList.add(octPts,false);if(coordList.size()<3){return null;}
coordList.closeRing();return coordList.toCoordinateArray();};jsts.algorithm.ConvexHull.prototype.computeOctPts=function(inputPts){var pts=[];for(var j=0;j<8;j++){pts[j]=inputPts[0];}
for(var i=1;i<inputPts.length;i++){if(inputPts[i].x<pts[0].x){pts[0]=inputPts[i];}
if(inputPts[i].x-inputPts[i].y<pts[1].x-pts[1].y){pts[1]=inputPts[i];}
if(inputPts[i].y>pts[2].y){pts[2]=inputPts[i];}
if(inputPts[i].x+inputPts[i].y>pts[3].x+pts[3].y){pts[3]=inputPts[i];}
if(inputPts[i].x>pts[4].x){pts[4]=inputPts[i];}
if(inputPts[i].x-inputPts[i].y>pts[5].x-pts[5].y){pts[5]=inputPts[i];}
if(inputPts[i].y<pts[6].y){pts[6]=inputPts[i];}
if(inputPts[i].x+inputPts[i].y<pts[7].x+pts[7].y){pts[7]=inputPts[i];}}
return pts;};jsts.algorithm.ConvexHull.prototype.lineOrPolygon=function(coordinates){coordinates=this.cleanRing(coordinates);if(coordinates.length==3){return this.geomFactory.createLineString([coordinates[0],coordinates[1]]);}
var linearRing=this.geomFactory.createLinearRing(coordinates);return this.geomFactory.createPolygon(linearRing,null);};jsts.algorithm.ConvexHull.prototype.cleanRing=function(original){Assert.equals(original[0],original[original.length-1]);var cleanedRing=new ArrayList();var previousDistinctCoordinate=null;for(var i=0;i<=original.length-2;i++){var currentCoordinate=original[i];var nextCoordinate=original[i+1];if(currentCoordinate.equals(nextCoordinate)){continue;}
if(previousDistinctCoordinate!=null&&this.isBetween(previousDistinctCoordinate,currentCoordinate,nextCoordinate)){continue;}
cleanedRing.add(currentCoordinate);previousDistinctCoordinate=currentCoordinate;}
cleanedRing.add(original[original.length-1]);var cleanedRingCoordinates=[];return cleanedRing.toArray(cleanedRingCoordinates);};})();jsts.algorithm.MinimumDiameter=function(inputGeom,isConvex){this.convexHullPts=null;this.minBaseSeg=new jsts.geom.LineSegment();this.minWidthPt=null;this.minPtIndex=0;this.minWidth=0;jsts.algorithm.MinimumDiameter.inputGeom=inputGeom;jsts.algorithm.MinimumDiameter.isConvex=isConvex||false;};jsts.algorithm.MinimumDiameter.inputGeom=null;jsts.algorithm.MinimumDiameter.isConvex=false;jsts.algorithm.MinimumDiameter.nextIndex=function(pts,index){index++;if(index>=pts.length){index=0;}
return index;};jsts.algorithm.MinimumDiameter.computeC=function(a,b,p){return a*p.y-b*p.x;};jsts.algorithm.MinimumDiameter.computeSegmentForLine=function(a,b,c){var p0;var p1;if(Math.abs(b)>Math.abs(a)){p0=new jsts.geom.Coordinate(0,c/b);p1=new jsts.geom.Coordinate(1,c/b-a/b);}
else{p0=new jsts.geom.Coordinate(c/a,0);p1=new jsts.geom.Coordinate(c/a-b/a,1);}
return new jsts.geom.LineSegment(p0,p1);};jsts.algorithm.MinimumDiameter.prototype.getLength=function(){this.computeMinimumDiameter();return this.minWidth;};jsts.algorithm.MinimumDiameter.prototype.getWidthCoordinate=function(){this.computeMinimumDiameter();return this.minWidthPt;};jsts.algorithm.MinimumDiameter.prototype.getSupportingSegment=function(){this.computeMinimumDiameter();var coord=[this.minBaseSeg.p0,this.minBaseSeg.p1];return jsts.algorithm.MinimumDiameter.inputGeom.getFactory().createLineString(coord);};jsts.algorithm.MinimumDiameter.prototype.getDiameter=function(){this.computeMinimumDiameter();if(this.minWidthPt===null){return jsts.algorithm.MinimumDiameter.inputGeom.getFactory().createLineString(null);}
var basePt=this.minBaseSeg.project(this.minWidthPt);return jsts.algorithm.MinimumDiameter.inputGeom.getFactory().createLineString([basePt,this.minWidthPt]);};jsts.algorithm.MinimumDiameter.prototype.computeMinimumDiameter=function(){if(this.minWidthPt!==null){return;}
if(jsts.algorithm.MinimumDiameter.isConvex)
this.computeWidthConvex(jsts.algorithm.MinimumDiameter.inputGeom);else{var convexGeom=new jsts.algorithm.ConvexHull(jsts.algorithm.MinimumDiameter.inputGeom).getConvexHull();this.computeWidthConvex(convexGeom);}};jsts.algorithm.MinimumDiameter.prototype.computeWidthConvex=function(convexGeom){if(convexGeom instanceof jsts.geom.Polygon){this.convexHullPts=convexGeom.getExteriorRing().getCoordinates();}else{this.convexHullPts=convexGeom.getCoordinates();}
if(this.convexHullPts.length===0){this.minWidth=0;this.minWidthPt=null;this.minBaseSeg=null;}else if(this.convexHullPts.length===1){this.minWidth=0;this.minWidthPt=this.convexHullPts[0];this.minBaseSeg.p0=this.convexHullPts[0];this.minBaseSeg.p1=this.convexHullPts[0];}else if(this.convexHullPts.length===2||this.convexHullPts.length===3){this.minWidth=0;this.minWidthPt=this.convexHullPts[0];this.minBaseSeg.p0=this.convexHullPts[0];this.minBaseSeg.p1=this.convexHullPts[1];}else{this.computeConvexRingMinDiameter(this.convexHullPts);}};jsts.algorithm.MinimumDiameter.prototype.computeConvexRingMinDiameter=function(pts){this.minWidth=Number.MAX_VALUE;var currMaxIndex=1;var seg=new jsts.geom.LineSegment();for(var i=0;i<pts.length-1;i++){seg.p0=pts[i];seg.p1=pts[i+1];currMaxIndex=this.findMaxPerpDistance(pts,seg,currMaxIndex);}};jsts.algorithm.MinimumDiameter.prototype.findMaxPerpDistance=function(pts,seg,startIndex){var maxPerpDistance=seg.distancePerpendicular(pts[startIndex]);var nextPerpDistance=maxPerpDistance;var maxIndex=startIndex;var nextIndex=maxIndex;while(nextPerpDistance>=maxPerpDistance){maxPerpDistance=nextPerpDistance;maxIndex=nextIndex;nextIndex=jsts.algorithm.MinimumDiameter.nextIndex(pts,maxIndex);nextPerpDistance=seg.distancePerpendicular(pts[nextIndex]);}
if(maxPerpDistance<this.minWidth){this.minPtIndex=maxIndex;this.minWidth=maxPerpDistance;this.minWidthPt=pts[this.minPtIndex];this.minBaseSeg=new jsts.geom.LineSegment(seg);}
return maxIndex;};jsts.algorithm.MinimumDiameter.prototype.getMinimumRectangle=function(){this.computeMinimumDiameter();if(this.minWidth===0){if(this.minBaseSeg.p0.equals2D(this.minBaseSeg.p1)){return jsts.algorithm.MinimumDiameter.inputGeom.getFactory().createPoint(this.minBaseSeg.p0);}
return this.minBaseSeg.toGeometry(jsts.algorithm.MinimumDiameter.inputGeom.getFactory());}
var dx=this.minBaseSeg.p1.x-this.minBaseSeg.p0.x;var dy=this.minBaseSeg.p1.y-this.minBaseSeg.p0.y;var minPara=Number.MAX_VALUE;var maxPara=-Number.MAX_VALUE;var minPerp=Number.MAX_VALUE;var maxPerp=-Number.MAX_VALUE;for(var i=0;i<this.convexHullPts.length;i++){var paraC=jsts.algorithm.MinimumDiameter.computeC(dx,dy,this.convexHullPts[i]);if(paraC>maxPara)maxPara=paraC;if(paraC<minPara)minPara=paraC;var perpC=jsts.algorithm.MinimumDiameter.computeC(-dy,dx,this.convexHullPts[i]);if(perpC>maxPerp)maxPerp=perpC;if(perpC<minPerp)minPerp=perpC;}
var maxPerpLine=jsts.algorithm.MinimumDiameter.computeSegmentForLine(-dx,-dy,maxPerp);var minPerpLine=jsts.algorithm.MinimumDiameter.computeSegmentForLine(-dx,-dy,minPerp);var maxParaLine=jsts.algorithm.MinimumDiameter.computeSegmentForLine(-dy,dx,maxPara);var minParaLine=jsts.algorithm.MinimumDiameter.computeSegmentForLine(-dy,dx,minPara);var p0=maxParaLine.lineIntersection(maxPerpLine);var p1=minParaLine.lineIntersection(maxPerpLine);var p2=minParaLine.lineIntersection(minPerpLine);var p3=maxParaLine.lineIntersection(minPerpLine);var shell=jsts.algorithm.MinimumDiameter.inputGeom.getFactory().createLinearRing([p0,p1,p2,p3,p0]);return jsts.algorithm.MinimumDiameter.inputGeom.getFactory().createPolygon(shell,null);};(function(){jsts.io.GeoJSONParser=function(geometryFactory){this.geometryFactory=geometryFactory||new jsts.geom.GeometryFactory();this.geometryTypes=['Point','MultiPoint','LineString','MultiLineString','Polygon','MultiPolygon'];};jsts.io.GeoJSONParser.prototype.read=function(json){var obj;if(typeof json==='string'){obj=JSON.parse(json);}else{obj=json;}
var type=obj.type;if(!this.parse[type]){throw new Error('Unknown GeoJSON type: '+obj.type);}
if(this.geometryTypes.indexOf(type)!=-1){return this.parse[type].apply(this,[obj.coordinates]);}else if(type==='GeometryCollection'){return this.parse[type].apply(this,[obj.geometries]);}
return this.parse[type].apply(this,[obj]);};jsts.io.GeoJSONParser.prototype.parse={'Feature':function(obj){var feature={};for(var key in obj){feature[key]=obj[key];}
if(obj.geometry){var type=obj.geometry.type;if(!this.parse[type]){throw new Error('Unknown GeoJSON type: '+obj.type);}
feature.geometry=this.read(obj.geometry);}
if(obj.bbox){feature.bbox=this.parse.bbox.apply(this,[obj.bbox]);}
return feature;},'FeatureCollection':function(obj){var featureCollection={};if(obj.features){featureCollection.features=[];for(var i=0;i<obj.features.length;++i){featureCollection.features.push(this.read(obj.features[i]));}}
if(obj.bbox){featureCollection.bbox=this.parse.bbox.apply(this,[obj.bbox]);}
return featureCollection;},'coordinates':function(array){var coordinates=[];for(var i=0;i<array.length;++i){var sub=array[i];coordinates.push(new jsts.geom.Coordinate(sub[0],sub[1]));}
return coordinates;},'bbox':function(array){return this.geometryFactory.createLinearRing([new jsts.geom.Coordinate(array[0],array[1]),new jsts.geom.Coordinate(array[2],array[1]),new jsts.geom.Coordinate(array[2],array[3]),new jsts.geom.Coordinate(array[0],array[3]),new jsts.geom.Coordinate(array[0],array[1])]);},'Point':function(array){var coordinate=new jsts.geom.Coordinate(array[0],array[1]);return this.geometryFactory.createPoint(coordinate);},'MultiPoint':function(array){var points=[];for(var i=0;i<array.length;++i){points.push(this.parse.Point.apply(this,[array[i]]));}
return this.geometryFactory.createMultiPoint(points);},'LineString':function(array){var coordinates=this.parse.coordinates.apply(this,[array]);return this.geometryFactory.createLineString(coordinates);},'MultiLineString':function(array){var lineStrings=[];for(var i=0;i<array.length;++i){lineStrings.push(this.parse.LineString.apply(this,[array[i]]));}
return this.geometryFactory.createMultiLineString(lineStrings);},'Polygon':function(array){var shellCoordinates=this.parse.coordinates.apply(this,[array[0]]);var shell=this.geometryFactory.createLinearRing(shellCoordinates);var holes=[];for(var i=1;i<array.length;++i){var hole=array[i];var coordinates=this.parse.coordinates.apply(this,[hole]);var linearRing=this.geometryFactory.createLinearRing(coordinates);holes.push(linearRing);}
return this.geometryFactory.createPolygon(shell,holes);},'MultiPolygon':function(array){var polygons=[];for(var i=0;i<array.length;++i){var polygon=array[i];polygons.push(this.parse.Polygon.apply(this,[polygon]));}
return this.geometryFactory.createMultiPolygon(polygons);},'GeometryCollection':function(array){var geometries=[];for(var i=0;i<array.length;++i){var geometry=array[i];geometries.push(this.read(geometry));}
return this.geometryFactory.createGeometryCollection(geometries);}};jsts.io.GeoJSONParser.prototype.write=function(geometry){var type=geometry.CLASS_NAME.slice(10);if(!this.extract[type]){throw new Error('Geometry is not supported');}
return this.extract[type].apply(this,[geometry]);};jsts.io.GeoJSONParser.prototype.extract={'coordinate':function(coordinate){return[coordinate.x,coordinate.y];},'Point':function(point){var array=this.extract.coordinate.apply(this,[point.coordinate]);return{type:'Point',coordinates:array};},'MultiPoint':function(multipoint){var array=[];for(var i=0;i<multipoint.geometries.length;++i){var point=multipoint.geometries[i];var geoJson=this.extract.Point.apply(this,[point]);array.push(geoJson.coordinates);}
return{type:'MultiPoint',coordinates:array};},'LineString':function(linestring){var array=[];for(var i=0;i<linestring.points.length;++i){var coordinate=linestring.points[i];array.push(this.extract.coordinate.apply(this,[coordinate]));}
return{type:'LineString',coordinates:array};},'MultiLineString':function(multilinestring){var array=[];for(var i=0;i<multilinestring.geometries.length;++i){var linestring=multilinestring.geometries[i];var geoJson=this.extract.LineString.apply(this,[linestring]);array.push(geoJson.coordinates);}
return{type:'MultiLineString',coordinates:array};},'Polygon':function(polygon){var array=[];var shellGeoJson=this.extract.LineString.apply(this,[polygon.shell]);array.push(shellGeoJson.coordinates);for(var i=0;i<polygon.holes.length;++i){var hole=polygon.holes[i];var holeGeoJson=this.extract.LineString.apply(this,[hole]);array.push(holeGeoJson.coordinates);}
return{type:'Polygon',coordinates:array};},'MultiPolygon':function(multipolygon){var array=[];for(var i=0;i<multipolygon.geometries.length;++i){var polygon=multipolygon.geometries[i];var geoJson=this.extract.Polygon.apply(this,[polygon]);array.push(geoJson.coordinates);}
return{type:'MultiPolygon',coordinates:array};},'GeometryCollection':function(collection){var array=[];for(var i=0;i<collection.geometries.length;++i){var geometry=collection.geometries[i];var type=geometry.CLASS_NAME.slice(10);array.push(this.extract[type].apply(this,[geometry]));}
return{type:'GeometryCollection',geometries:array};}};})();jsts.triangulate.quadedge.Vertex=function(){if(arguments.length===1){this.initFromCoordinate(arguments[0]);}else{this.initFromXY(arguments[0],arguments[1]);}};jsts.triangulate.quadedge.Vertex.LEFT=0;jsts.triangulate.quadedge.Vertex.RIGHT=1;jsts.triangulate.quadedge.Vertex.BEYOND=2;jsts.triangulate.quadedge.Vertex.BEHIND=3;jsts.triangulate.quadedge.Vertex.BETWEEN=4;jsts.triangulate.quadedge.Vertex.ORIGIN=5;jsts.triangulate.quadedge.Vertex.DESTINATION=6;jsts.triangulate.quadedge.Vertex.prototype.initFromXY=function(x,y){this.p=new jsts.geom.Coordinate(x,y);};jsts.triangulate.quadedge.Vertex.prototype.initFromCoordinate=function(_p){this.p=new jsts.geom.Coordinate(_p);};jsts.triangulate.quadedge.Vertex.prototype.getX=function(){return this.p.x;};jsts.triangulate.quadedge.Vertex.prototype.getY=function(){return this.p.y;};jsts.triangulate.quadedge.Vertex.prototype.getZ=function(){return this.p.z;};jsts.triangulate.quadedge.Vertex.prototype.setZ=function(z){this.p.z=z;};jsts.triangulate.quadedge.Vertex.prototype.getCoordinate=function(){return this.p;};jsts.triangulate.quadedge.Vertex.prototype.toString=function(){return'POINT ('+this.p.x+' '+this.p.y+')';};jsts.triangulate.quadedge.Vertex.prototype.equals=function(){if(arguments.length===1){return this.equalsExact(arguments[0]);}else{return this.equalsWithTolerance(arguments[0],arguments[1]);}};jsts.triangulate.quadedge.Vertex.prototype.equalsExact=function(other){return(this.p.x===other.getX()&&this.p.y===other.getY());};jsts.triangulate.quadedge.Vertex.prototype.equalsWithTolerance=function(other,tolerance){return(this.p.distance(other.getCoordinate())<tolerance);};jsts.triangulate.quadedge.Vertex.prototype.classify=function(p0,p1){var p2,a,b,sa;p2=this;a=p1.sub(p0);b=p2.sub(p0);sa=a.crossProduct(b);if(sa>0.0){return jsts.triangulate.quadedge.Vertex.LEFT;}
if(sa<0.0){return jsts.triangulate.quadedge.Vertex.RIGHT;}
if((a.getX()*b.getX()<0.0)||(a.getY()*b.getY()<0.0)){return jsts.triangulate.quadedge.Vertex.BEHIND;}
if(a.magn()<b.magn()){return jsts.triangulate.quadedge.Vertex.BEYOND;}
if(p0.equals(p2)){return jsts.triangulate.quadedge.Vertex.ORIGIN;}
if(p1.equals(p2)){return jsts.triangulate.quadedge.Vertex.DESTINATION;}
return jsts.triangulate.quadedge.Vertex.BETWEEN;};jsts.triangulate.quadedge.Vertex.prototype.crossProduct=function(v){return((this.p.x*v.getY())-(this.p.y*v.getX()));};jsts.triangulate.quadedge.Vertex.prototype.dot=function(v){return((this.p.x*v.getX())+(this.p.y*v.getY()));};jsts.triangulate.quadedge.Vertex.prototype.times=function(c){return new jsts.triangulate.quadedge.Vertex(c*this.p.x,c*this.p.y);};jsts.triangulate.quadedge.Vertex.prototype.sum=function(v){return new jsts.triangulate.quadedge.Vertex(this.p.x+v.getX(),this.p.y+
v.getY());};jsts.triangulate.quadedge.Vertex.prototype.sub=function(v){return new jsts.triangulate.quadedge.Vertex(this.p.x-v.getX(),this.p.y-
v.getY());};jsts.triangulate.quadedge.Vertex.prototype.magn=function(){return(Math.sqrt((this.p.x*this.p.x)+(this.p.y*this.p.y)));};jsts.triangulate.quadedge.Vertex.prototype.cross=function(){return new Vertex(this.p.y,-this.p.x);};jsts.triangulate.quadedge.Vertex.prototype.isInCircle=function(a,b,c){return jsts.triangulate.quadedge.TrianglePredicate.isInCircleRobust(a.p,b.p,c.p,this.p);};jsts.triangulate.quadedge.Vertex.prototype.isCCW=function(b,c){return((b.p.x-this.p.x)*(c.p.y-this.p.y)-(b.p.y-this.p.y)*(c.p.x-this.p.x)>0);};jsts.triangulate.quadedge.Vertex.prototype.rightOf=function(e){return this.isCCW(e.dest(),e.orig());};jsts.triangulate.quadedge.Vertex.prototype.leftOf=function(e){return this.isCCW(e.orig(),e.dest());};jsts.triangulate.quadedge.Vertex.prototype.bisector=function(a,b){var dx,dy,l1,l2;dx=b.getX()-a.getX();dy=b.getY()-a.getY();l1=new jsts.algorithm.HCoordinate(a.getX()+(dx/2.0),a.getY()+
(dy/2.0),1.0);l2=new jsts.algorithm.HCoordinate(a.getX()-dy+(dx/2.0),a.getY()+
dx+(dy/2.0),1.0);return new jsts.algorithm.HCoordinate(l1,l2);};jsts.triangulate.quadedge.Vertex.prototype.distance=function(v1,v2){return v1.p.distance(v2.p);};jsts.triangulate.quadedge.Vertex.prototype.circumRadiusRatio=function(b,c){var x,radius,edgeLength,el;x=this.circleCenter(b,c);radius=this.distance(x,b);edgeLength=this.distance(this,b);el=this.distance(b,c);if(el<edgeLength){edgeLength=el;}
el=this.distance(c,this);if(el<edgeLength){edgeLength=el;}
return radius/edgeLength;};jsts.triangulate.quadedge.Vertex.prototype.midPoint=function(a){var xm,ym;xm=(this.p.x+a.getX())/2.0;ym=(this.p.y+a.getY())/2.0;return new jsts.triangulate.quadedge.Vertex(xm,ym);};jsts.triangulate.quadedge.Vertex.prototype.circleCenter=function(b,c){var a,cab,cbc,hcc,cc;a=new jsts.triangulate.quadedge.Vertex(this.getX(),this.getY());cab=this.bisector(a,b);cbc=this.bisector(b,c);hcc=new jsts.algorithm.HCoordinate(cab,cbc);cc=null;try{cc=new jsts.triangulate.quadedge.Vertex(hcc.getX(),hcc.getY());}catch(err){}
return cc;};jsts.operation.valid.IsValidOp=function(parentGeometry){this.parentGeometry=parentGeometry;this.isSelfTouchingRingFormingHoleValid=false;this.validErr=null;};jsts.operation.valid.IsValidOp.isValid=function(arg){if(arguments[0]instanceof jsts.geom.Coordinate){if(isNaN(arg.x)){return false;}
if(!isFinite(arg.x)&&!isNaN(arg.x)){return false;}
if(isNaN(arg.y)){return false;}
if(!isFinite(arg.y)&&!isNaN(arg.y)){return false;}
return true;}else{var isValidOp=new jsts.operation.valid.IsValidOp(arg);return isValidOp.isValid();}};jsts.operation.valid.IsValidOp.findPtNotNode=function(testCoords,searchRing,graph){var searchEdge=graph.findEdge(searchRing);var eiList=searchEdge.getEdgeIntersectionList();for(var i=0;i<testCoords.length;i++){var pt=testCoords[i];if(!eiList.isIntersection(pt)){return pt;}}
return null;};jsts.operation.valid.IsValidOp.prototype.setSelfTouchingRingFormingHoleValid=function(isValid){this.isSelfTouchingRingFormingHoleValid=isValid;};jsts.operation.valid.IsValidOp.prototype.isValid=function(){this.checkValid(this.parentGeometry);return this.validErr==null;};jsts.operation.valid.IsValidOp.prototype.getValidationError=function(){this.checkValid(this.parentGeometry);return this.validErr;};jsts.operation.valid.IsValidOp.prototype.checkValid=function(g){this.validErr=null;if(g.isEmpty()){return;}
if(g instanceof jsts.geom.Point){this.checkValidPoint(g);}else if(g instanceof jsts.geom.MultiPoint){this.checkValidMultiPoint(g);}else if(g instanceof jsts.geom.LinearRing){this.checkValidLinearRing(g);}else if(g instanceof jsts.geom.LineString){this.checkValidLineString(g);}else if(g instanceof jsts.geom.Polygon){this.checkValidPolygon(g);}else if(g instanceof jsts.geom.MultiPolygon){this.checkValidMultiPolygon(g);}else if(g instanceof jsts.geom.GeometryCollection){this.checkValidGeometryCollection(g);}else{throw g.constructor;}};jsts.operation.valid.IsValidOp.prototype.checkValidPoint=function(g){this.checkInvalidCoordinates(g.getCoordinates());};jsts.operation.valid.IsValidOp.prototype.checkValidMultiPoint=function(g){this.checkInvalidCoordinates(g.getCoordinates());};jsts.operation.valid.IsValidOp.prototype.checkValidLineString=function(g){this.checkInvalidCoordinates(g.getCoordinates());if(this.validErr!=null){return;}
var graph=new jsts.geomgraph.GeometryGraph(0,g);this.checkTooFewPoints(graph);};jsts.operation.valid.IsValidOp.prototype.checkValidLinearRing=function(g){this.checkInvalidCoordinates(g.getCoordinates());if(this.validErr!=null){return;}
this.checkClosedRing(g);if(this.validErr!=null){return;}
var graph=new jsts.geomgraph.GeometryGraph(0,g);this.checkTooFewPoints(graph);if(this.validErr!=null){return;}
var li=new jsts.algorithm.RobustLineIntersector();graph.computeSelfNodes(li,true);this.checkNoSelfIntersectingRings(graph);};jsts.operation.valid.IsValidOp.prototype.checkValidPolygon=function(g){this.checkInvalidCoordinates(g);if(this.validErr!=null){return;}
this.checkClosedRings(g);if(this.validErr!=null){return;}
var graph=new jsts.geomgraph.GeometryGraph(0,g);this.checkTooFewPoints(graph);if(this.validErr!=null){return;}
this.checkConsistentArea(graph);if(this.validErr!=null){return;}
if(!this.isSelfTouchingRingFormingHoleValid){this.checkNoSelfIntersectingRings(graph);if(this.validErr!=null){return;}}
this.checkHolesInShell(g,graph);if(this.validErr!=null){return;}
this.checkHolesNotNested(g,graph);if(this.validErr!=null){return;}
this.checkConnectedInteriors(graph);};jsts.operation.valid.IsValidOp.prototype.checkValidMultiPolygon=function(g){var il=g.getNumGeometries();for(var i=0;i<il;i++){var p=g.getGeometryN(i);this.checkInvalidCoordinates(p);if(this.validErr!=null){return;}
this.checkClosedRings(p);if(this.validErr!=null){return;}}
var graph=new jsts.geomgraph.GeometryGraph(0,g);this.checkTooFewPoints(graph);if(this.validErr!=null){return;}
this.checkConsistentArea(graph);if(this.validErr!=null){return;}
if(!this.isSelfTouchingRingFormingHoleValid){this.checkNoSelfIntersectingRings(graph);if(this.validErr!=null){return;}}
for(var i=0;i<g.getNumGeometries();i++){var p=g.getGeometryN(i);this.checkHolesInShell(p,graph);if(this.validErr!=null){return;}}
for(var i=0;i<g.getNumGeometries();i++){var p=g.getGeometryN(i);this.checkHolesNotNested(p,graph);if(this.validErr!=null){return;}}
this.checkShellsNotNested(g,graph);if(this.validErr!=null){return;}
this.checkConnectedInteriors(graph);};jsts.operation.valid.IsValidOp.prototype.checkValidGeometryCollection=function(gc){for(var i=0;i<gc.getNumGeometries();i++){var g=gc.getGeometryN(i);this.checkValid(g);if(this.validErr!=null){return;}}};jsts.operation.valid.IsValidOp.prototype.checkInvalidCoordinates=function(arg){if(arg instanceof jsts.geom.Polygon){var poly=arg;this.checkInvalidCoordinates(poly.getExteriorRing().getCoordinates());if(this.validErr!=null){return;}
for(var i=0;i<poly.getNumInteriorRing();i++){this.checkInvalidCoordinates(poly.getInteriorRingN(i).getCoordinates());if(this.validErr!=null){return;}}}else{var coords=arg;for(var i=0;i<coords.length;i++){if(!jsts.operation.valid.IsValidOp.isValid(coords[i])){this.validErr=new jsts.operation.valid.TopologyValidationError(jsts.operation.valid.TopologyValidationError.INVALID_COORDINATE,coords[i]);return;}}}};jsts.operation.valid.IsValidOp.prototype.checkClosedRings=function(poly){this.checkClosedRing(poly.getExteriorRing());if(this.validErr!=null){return;}
for(var i=0;i<poly.getNumInteriorRing();i++){this.checkClosedRing(poly.getInteriorRingN(i));if(this.validErr!=null){return;}}};jsts.operation.valid.IsValidOp.prototype.checkClosedRing=function(ring){if(!ring.isClosed()){var pt=null;if(ring.getNumPoints()>=1){pt=ring.getCoordinateN(0);}
this.validErr=new jsts.operation.valid.TopologyValidationError(jsts.operation.valid.TopologyValidationError.RING_NOT_CLOSED,pt);}};jsts.operation.valid.IsValidOp.prototype.checkTooFewPoints=function(graph){if(graph.hasTooFewPoints){this.validErr=new jsts.operation.valid.TopologyValidationError(jsts.operation.valid.TopologyValidationError.TOO_FEW_POINTS,graph.getInvalidPoint());return;}};jsts.operation.valid.IsValidOp.prototype.checkConsistentArea=function(graph){var cat=new jsts.operation.valid.ConsistentAreaTester(graph);var isValidArea=cat.isNodeConsistentArea();if(!isValidArea){this.validErr=new jsts.operation.valid.TopologyValidationError(jsts.operation.valid.TopologyValidationError.SELF_INTERSECTION,cat.getInvalidPoint());return;}
if(cat.hasDuplicateRings()){this.validErr=new jsts.operation.valid.TopologyValidationError(jsts.operation.valid.TopologyValidationError.DUPLICATE_RINGS,cat.getInvalidPoint());}};jsts.operation.valid.IsValidOp.prototype.checkNoSelfIntersectingRings=function(graph){for(var i=graph.getEdgeIterator();i.hasNext();){var e=i.next();this.checkNoSelfIntersectingRing(e.getEdgeIntersectionList());if(this.validErr!=null){return;}}};jsts.operation.valid.IsValidOp.prototype.checkNoSelfIntersectingRing=function(eiList){var nodeSet=[];var isFirst=true;for(var i=eiList.iterator();i.hasNext();){var ei=i.next();if(isFirst){isFirst=false;continue;}
if(nodeSet.indexOf(ei.coord)>=0){this.validErr=new jsts.operation.valid.TopologyValidationError(jsts.operation.valid.TopologyValidationError.RING_SELF_INTERSECTION,ei.coord);return;}else{nodeSet.push(ei.coord);}}};jsts.operation.valid.IsValidOp.prototype.checkHolesInShell=function(p,graph){var shell=p.getExteriorRing();var pir=new jsts.algorithm.MCPointInRing(shell);for(var i=0;i<p.getNumInteriorRing();i++){var hole=p.getInteriorRingN(i);var holePt=jsts.operation.valid.IsValidOp.findPtNotNode(hole.getCoordinates(),shell,graph);if(holePt==null){return;}
var outside=!pir.isInside(holePt);if(outside){this.validErr=new jsts.operation.valid.TopologyValidationError(jsts.operation.valid.TopologyValidationError.HOLE_OUTSIDE_SHELL,holePt);return;}}};jsts.operation.valid.IsValidOp.prototype.checkHolesNotNested=function(p,graph){var nestedTester=new jsts.operation.valid.IndexedNestedRingTester(graph);for(var i=0;i<p.getNumInteriorRing();i++){var innerHole=p.getInteriorRingN(i);nestedTester.add(innerHole);}
var isNonNested=nestedTester.isNonNested();if(!isNonNested){this.validErr=new jsts.operation.valid.TopologyValidationError(jsts.operation.valid.TopologyValidationError.NESTED_HOLES,nestedTester.getNestedPoint());}};jsts.operation.valid.IsValidOp.prototype.checkShellsNotNested=function(mp,graph){for(var i=0;i<mp.getNumGeometries();i++){var p=mp.getGeometryN(i);var shell=p.getExteriorRing();for(var j=0;j<mp.getNumGeometries();j++){if(i==j){continue;}
var p2=mp.getGeometryN(j);this.checkShellNotNested(shell,p2,graph);if(this.validErr!=null){return;}}}};jsts.operation.valid.IsValidOp.prototype.checkShellNotNested=function(shell,p,graph){var shellPts=shell.getCoordinates();var polyShell=p.getExteriorRing();var polyPts=polyShell.getCoordinates();var shellPt=jsts.operation.valid.IsValidOp.findPtNotNode(shellPts,polyShell,graph);if(shellPt==null){return;}
var insidePolyShell=jsts.algorithm.CGAlgorithms.isPointInRing(shellPt,polyPts);if(!insidePolyShell){return;}
if(p.getNumInteriorRing()<=0){this.validErr=new jsts.operation.valid.TopologyValidationError(jsts.operation.valid.TopologyValidationError.NESTED_SHELLS,shellPt);return;}
var badNestedPt=null;for(var i=0;i<p.getNumInteriorRing();i++){var hole=p.getInteriorRingN(i);badNestedPt=this.checkShellInsideHole(shell,hole,graph);if(badNestedPt==null){return;}}
this.validErr=new jsts.operation.valid.TopologyValidationError(jsts.operation.valid.TopologyValidationError.NESTED_SHELLS,badNestedPt);};jsts.operation.valid.IsValidOp.prototype.checkShellInsideHole=function(shell,hole,graph){var shellPts=shell.getCoordinates();var holePts=hole.getCoordinates();var shellPt=jsts.operation.valid.IsValidOp.findPtNotNode(shellPts,hole,graph);if(shellPt!=null){var insideHole=jsts.algorithm.CGAlgorithms.isPointInRing(shellPt,holePts);if(!insideHole){return shellPt;}}
var holePt=jsts.operation.valid.IsValidOp.findPtNotNode(holePts,shell,graph);if(holePt!=null){var insideShell=jsts.algorithm.CGAlgorithms.isPointInRing(holePt,shellPts);if(insideShell){return holePt;}
return null;}
jsts.util.Assert.shouldNeverReachHere('points in shell and hole appear to be equal');return null;};jsts.operation.valid.IsValidOp.prototype.checkConnectedInteriors=function(graph){var cit=new jsts.operation.valid.ConnectedInteriorTester(graph);if(!cit.isInteriorsConnected()){this.validErr=new jsts.operation.valid.TopologyValidationError(jsts.operation.valid.TopologyValidationError.DISCONNECTED_INTERIOR,cit.getCoordinate());}};jsts.algorithm.RobustDeterminant=function(){};jsts.algorithm.RobustDeterminant.signOfDet2x2=function(x1,y1,x2,y2){var sign,swap,k,count;count=0;sign=1;if((x1===0.0)||(y2===0.0)){if((y1===0.0)||(x2===0.0)){return 0;}
else if(y1>0){if(x2>0){return-sign;}
else{return sign;}}
else{if(x2>0){return sign;}
else{return-sign;}}}
if((y1===0.0)||(x2===0.0)){if(y2>0){if(x1>0){return sign;}
else{return-sign;}}
else{if(x1>0){return-sign;}
else{return sign;}}}
if(0.0<y1){if(0.0<y2){if(y1>y2){sign=-sign;swap=x1;x1=x2;x2=swap;swap=y1;y1=y2;y2=swap;}}
else{if(y1<=-y2){sign=-sign;x2=-x2;y2=-y2;}
else{swap=x1;x1=-x2;x2=swap;swap=y1;y1=-y2;y2=swap;}}}
else{if(0.0<y2){if(-y1<=y2){sign=-sign;x1=-x1;y1=-y1;}
else{swap=-x1;x1=x2;x2=swap;swap=-y1;y1=y2;y2=swap;}}
else{if(y1>=y2){x1=-x1;y1=-y1;x2=-x2;y2=-y2;}
else{sign=-sign;swap=-x1;x1=-x2;x2=swap;swap=-y1;y1=-y2;y2=swap;}}}
if(0.0<x1){if(0.0<x2){if(x1>x2){return sign;}}
else{return sign;}}
else{if(0.0<x2){return-sign;}
else{if(x1>=x2){sign=-sign;x1=-x1;x2=-x2;}
else{return-sign;}}}
while(true){count=count+1;k=Math.floor(x2/x1);x2=x2-k*x1;y2=y2-k*y1;if(y2<0.0){return-sign;}
if(y2>y1){return sign;}
if(x1>x2+x2){if(y1<y2+y2){return sign;}}
else{if(y1>y2+y2){return-sign;}
else{x2=x1-x2;y2=y1-y2;sign=-sign;}}
if(y2===0.0){if(x2===0.0){return 0;}
else{return-sign;}}
if(x2===0.0){return sign;}
k=Math.floor(x1/x2);x1=x1-k*x2;y1=y1-k*y2;if(y1<0.0){return sign;}
if(y1>y2){return-sign;}
if(x2>x1+x1){if(y2<y1+y1){return-sign;}}
else{if(y2>y1+y1){return sign;}
else{x1=x2-x1;y1=y2-y1;sign=-sign;}}
if(y1===0.0){if(x1===0.0){return 0;}
else{return sign;}}
if(x1===0.0){return-sign;}}};jsts.algorithm.RobustDeterminant.orientationIndex=function(p1,p2,q){var dx1=p2.x-p1.x;var dy1=p2.y-p1.y;var dx2=q.x-p2.x;var dy2=q.y-p2.y;return jsts.algorithm.RobustDeterminant.signOfDet2x2(dx1,dy1,dx2,dy2);};jsts.index.quadtree.NodeBase=function(){this.subnode=new Array(4);this.subnode[0]=null;this.subnode[1]=null;this.subnode[2]=null;this.subnode[3]=null;this.items=[];};jsts.index.quadtree.NodeBase.prototype.getSubnodeIndex=function(env,centre){var subnodeIndex=-1;if(env.getMinX()>=centre.x){if(env.getMinY()>=centre.y){subnodeIndex=3;}
if(env.getMaxY()<=centre.y){subnodeIndex=1;}}
if(env.getMaxX()<=centre.x){if(env.getMinY()>=centre.y){subnodeIndex=2;}
if(env.getMaxY()<=centre.y){subnodeIndex=0;}}
return subnodeIndex;};jsts.index.quadtree.NodeBase.prototype.getItems=function(){return this.items;};jsts.index.quadtree.NodeBase.prototype.hasItems=function(){return(this.items.length>0);};jsts.index.quadtree.NodeBase.prototype.add=function(item){this.items.push(item);};jsts.index.quadtree.NodeBase.prototype.remove=function(itemEnv,item){if(!this.isSearchMatch(itemEnv)){return false;}
var found=false,i=0;for(i;i<4;i++){if(this.subnode[i]!==null){found=this.subnode[i].remove(itemEnv,item);if(found){if(this.subnode[i].isPrunable()){this.subnode[i]=null;}
break;}}}
if(found){return found;}
if(this.items.indexOf(item)!==-1){for(var i=this.items.length-1;i>=0;i--){if(this.items[i]===item){this.items.splice(i,1);}}
found=true;}
return found;};jsts.index.quadtree.NodeBase.prototype.isPrunable=function(){return!(this.hasChildren()||this.hasItems());};jsts.index.quadtree.NodeBase.prototype.hasChildren=function(){var i=0;for(i;i<4;i++){if(this.subnode[i]!==null){return true;}}
return false;};jsts.index.quadtree.NodeBase.prototype.isEmpty=function(){var isEmpty=true;if(this.items.length>0){isEmpty=false;}
var i=0;for(i;i<4;i++){if(this.subnode[i]!==null){if(!this.subnode[i].isEmpty()){isEmpty=false;}}}
return isEmpty;};jsts.index.quadtree.NodeBase.prototype.addAllItems=function(resultItems){resultItems=resultItems.concat(this.items);var i=0;for(i;i<4;i++){if(this.subnode[i]!==null){resultItems=this.subnode[i].addAllItems(resultItems);}}
return resultItems;};jsts.index.quadtree.NodeBase.prototype.addAllItemsFromOverlapping=function(searchEnv,resultItems){if(!this.isSearchMatch(searchEnv)){return;}
resultItems=resultItems.concat(this.items);var i=0;for(i;i<4;i++){if(this.subnode[i]!==null){resultItems=this.subnode[i].addAllItemsFromOverlapping(searchEnv,resultItems);}}};jsts.index.quadtree.NodeBase.prototype.visit=function(searchEnv,visitor){if(!this.isSearchMatch(searchEnv)){return;}
this.visitItems(searchEnv,visitor);var i=0;for(i;i<4;i++){if(this.subnode[i]!==null){this.subnode[i].visit(searchEnv,visitor);}}};jsts.index.quadtree.NodeBase.prototype.visitItems=function(env,visitor){var i=0,il=this.items.length;for(i;i<il;i++){visitor.visitItem(this.items[i]);}};jsts.index.quadtree.NodeBase.prototype.depth=function(){var maxSubDepth=0,i=0,sqd;for(i;i<4;i++){if(this.subnode[i]!==null){sqd=this.subnode[i].depth();if(sqd>maxSubDepth){maxSubDepth=sqd;}}}
return maxSubDepth+1;};jsts.index.quadtree.NodeBase.prototype.size=function(){var subSize=0,i=0;for(i;i<4;i++){if(this.subnode[i]!==null){subSize+=this.subnode[i].size();}}
return subSize+this.items.length;};jsts.index.quadtree.NodeBase.prototype.getNodeCount=function(){var subSize=0,i=0;for(i;i<4;i++){if(this.subnode[i]!==null){subSize+=this.subnode[i].size();}}
return subSize+1;};jsts.index.quadtree.Node=function(env,level){jsts.index.quadtree.NodeBase.prototype.constructor.apply(this,arguments);this.env=env;this.level=level;this.centre=new jsts.geom.Coordinate();this.centre.x=(env.getMinX()+env.getMaxX())/2;this.centre.y=(env.getMinY()+env.getMaxY())/2;};jsts.index.quadtree.Node.prototype=new jsts.index.quadtree.NodeBase();jsts.index.quadtree.Node.createNode=function(env){var key,node;key=new jsts.index.quadtree.Key(env);node=new jsts.index.quadtree.Node(key.getEnvelope(),key.getLevel());return node;};jsts.index.quadtree.Node.createExpanded=function(node,addEnv){var expandEnv=new jsts.geom.Envelope(addEnv),largerNode;if(node!==null){expandEnv.expandToInclude(node.env);}
largerNode=jsts.index.quadtree.Node.createNode(expandEnv);if(node!==null){largerNode.insertNode(node);}
return largerNode;};jsts.index.quadtree.Node.prototype.getEnvelope=function(){return this.env;};jsts.index.quadtree.Node.prototype.isSearchMatch=function(searchEnv){return this.env.intersects(searchEnv);};jsts.index.quadtree.Node.prototype.getNode=function(searchEnv){var subnodeIndex=this.getSubnodeIndex(searchEnv,this.centre),node;if(subnodeIndex!==-1){node=this.getSubnode(subnodeIndex);return node.getNode(searchEnv);}else{return this;}};jsts.index.quadtree.Node.prototype.find=function(searchEnv){var subnodeIndex=this.getSubnodeIndex(searchEnv,this.centre),node;if(subnodeIndex===-1){return this;}
if(this.subnode[subnodeIndex]!==null){node=this.subnode[subnodeIndex];return node.find(searchEnv);}
return this;};jsts.index.quadtree.Node.prototype.insertNode=function(node){var index=this.getSubnodeIndex(node.env,this.centre),childNode;if(node.level===this.level-1){this.subnode[index]=node;}else{childNode=this.createSubnode(index);childNode.insertNode(node);this.subnode[index]=childNode;}};jsts.index.quadtree.Node.prototype.getSubnode=function(index){if(this.subnode[index]===null){this.subnode[index]=this.createSubnode(index);}
return this.subnode[index];};jsts.index.quadtree.Node.prototype.createSubnode=function(index){var minx=0.0,maxx=0.0,miny=0.0,maxy=0.0,sqEnv,node;switch(index){case 0:minx=this.env.getMinX();maxx=this.centre.x;miny=this.env.getMinY();maxy=this.centre.y;break;case 1:minx=this.centre.x;maxx=this.env.getMaxX();miny=this.env.getMinY();maxy=this.centre.y;break;case 2:minx=this.env.getMinX();maxx=this.centre.x;miny=this.centre.y;maxy=this.env.getMaxY();break;case 3:minx=this.centre.x;maxx=this.env.getMaxX();miny=this.centre.y;maxy=this.env.getMaxY();break;}
sqEnv=new jsts.geom.Envelope(minx,maxx,miny,maxy);node=new jsts.index.quadtree.Node(sqEnv,this.level-1);return node;};(function(){jsts.triangulate.quadedge.QuadEdge=function(){this.rot=null;this.vertex=null;this.next=null;this.data=null;};var QuadEdge=jsts.triangulate.quadedge.QuadEdge;jsts.triangulate.quadedge.QuadEdge.makeEdge=function(o,d){var q0,q1,q2,q3,base;q0=new QuadEdge();q1=new QuadEdge();q2=new QuadEdge();q3=new QuadEdge();q0.rot=q1;q1.rot=q2;q2.rot=q3;q3.rot=q0;q0.setNext(q0);q1.setNext(q3);q2.setNext(q2);q3.setNext(q1);base=q0;base.setOrig(o);base.setDest(d);return base;};jsts.triangulate.quadedge.QuadEdge.connect=function(a,b){var e=QuadEdge.makeEdge(a.dest(),b.orig());QuadEdge.splice(e,a.lNext());QuadEdge.splice(e.sym(),b);return e;};jsts.triangulate.quadedge.QuadEdge.splice=function(a,b){var alpha,beta,t1,t2,t3,t4;alpha=a.oNext().rot;beta=b.oNext().rot;t1=b.oNext();t2=a.oNext();t3=beta.oNext();t4=alpha.oNext();a.setNext(t1);b.setNext(t2);alpha.setNext(t3);beta.setNext(t4);};jsts.triangulate.quadedge.QuadEdge.swap=function(e){var a,b;a=e.oPrev();b=e.sym().oPrev();QuadEdge.splice(e,a);QuadEdge.splice(e.sym(),b);QuadEdge.splice(e,a.lNext());QuadEdge.splice(e.sym(),b.lNext());e.setOrig(a.dest());e.setDest(b.dest());};jsts.triangulate.quadedge.QuadEdge.prototype.getPrimary=function(){if(this.orig().getCoordinate().compareTo(this.dest().getCoordinate())<=0){return this;}
else{return this.sym();}};jsts.triangulate.quadedge.QuadEdge.prototype.setData=function(data){this.data=data;};jsts.triangulate.quadedge.QuadEdge.prototype.getData=function(){return this.data;};jsts.triangulate.quadedge.QuadEdge.prototype.delete_jsts=function(){this.rot=null;};jsts.triangulate.quadedge.QuadEdge.prototype.isLive=function(){return this.rot!==null;};jsts.triangulate.quadedge.QuadEdge.prototype.setNext=function(next){this.next=next;};jsts.triangulate.quadedge.QuadEdge.prototype.invRot=function(){return this.rot.sym();};jsts.triangulate.quadedge.QuadEdge.prototype.sym=function(){return this.rot.rot;};jsts.triangulate.quadedge.QuadEdge.prototype.oNext=function(){return this.next;};jsts.triangulate.quadedge.QuadEdge.prototype.oPrev=function(){return this.rot.next.rot;};jsts.triangulate.quadedge.QuadEdge.prototype.dNext=function(){return this.sym().oNext().sym();};jsts.triangulate.quadedge.QuadEdge.prototype.dPrev=function(){return this.invRot().oNext().invRot();};jsts.triangulate.quadedge.QuadEdge.prototype.lNext=function(){return this.invRot().oNext().rot;};jsts.triangulate.quadedge.QuadEdge.prototype.lPrev=function(){return this.next.sym();};jsts.triangulate.quadedge.QuadEdge.prototype.rNext=function(){return this.rot.next.invRot();};jsts.triangulate.quadedge.QuadEdge.prototype.rPrev=function(){return this.sym().oNext();};jsts.triangulate.quadedge.QuadEdge.prototype.setOrig=function(o){this.vertex=o;};jsts.triangulate.quadedge.QuadEdge.prototype.setDest=function(d){this.sym().setOrig(d);};jsts.triangulate.quadedge.QuadEdge.prototype.orig=function(){return this.vertex;};jsts.triangulate.quadedge.QuadEdge.prototype.dest=function(){return this.sym().orig();};jsts.triangulate.quadedge.QuadEdge.prototype.getLength=function(){return this.orig().getCoordinate().distance(dest().getCoordinate());};jsts.triangulate.quadedge.QuadEdge.prototype.equalsNonOriented=function(qe){if(this.equalsOriented(qe)){return true;}
if(this.equalsOriented(qe.sym())){return true;}
return false;};jsts.triangulate.quadedge.QuadEdge.prototype.equalsOriented=function(qe){if(this.orig().getCoordinate().equals2D(qe.orig().getCoordinate())&&this.dest().getCoordinate().equals2D(qe.dest().getCoordinate())){return true;}
return false;};jsts.triangulate.quadedge.QuadEdge.prototype.toLineSegment=function()
{return new jsts.geom.LineSegment(this.vertex.getCoordinate(),this.dest().getCoordinate());};jsts.triangulate.quadedge.QuadEdge.prototype.toString=function(){var p0,p1;p0=this.vertex.getCoordinate();p1=this.dest().getCoordinate();return jsts.io.WKTWriter.toLineString(p0,p1);};})();(function(){var Assert=jsts.util.Assert;jsts.geomgraph.EdgeEnd=function(edge,p0,p1,label){this.edge=edge;if(p0&&p1){this.init(p0,p1);}
if(label){this.label=label||null;}};jsts.geomgraph.EdgeEnd.prototype.edge=null;jsts.geomgraph.EdgeEnd.prototype.label=null;jsts.geomgraph.EdgeEnd.prototype.node=null;jsts.geomgraph.EdgeEnd.prototype.p0=null;jsts.geomgraph.EdgeEnd.prototype.p1=null;jsts.geomgraph.EdgeEnd.prototype.dx=null;jsts.geomgraph.EdgeEnd.prototype.dy=null;jsts.geomgraph.EdgeEnd.prototype.quadrant=null;jsts.geomgraph.EdgeEnd.prototype.init=function(p0,p1){this.p0=p0;this.p1=p1;this.dx=p1.x-p0.x;this.dy=p1.y-p0.y;this.quadrant=jsts.geomgraph.Quadrant.quadrant(this.dx,this.dy);Assert.isTrue(!(this.dx===0&&this.dy===0),'EdgeEnd with identical endpoints found');};jsts.geomgraph.EdgeEnd.prototype.getEdge=function(){return this.edge;};jsts.geomgraph.EdgeEnd.prototype.getLabel=function(){return this.label;};jsts.geomgraph.EdgeEnd.prototype.getCoordinate=function(){return this.p0;};jsts.geomgraph.EdgeEnd.prototype.getDirectedCoordinate=function(){return this.p1;};jsts.geomgraph.EdgeEnd.prototype.getQuadrant=function(){return this.quadrant;};jsts.geomgraph.EdgeEnd.prototype.getDx=function(){return this.dx;};jsts.geomgraph.EdgeEnd.prototype.getDy=function(){return this.dy;};jsts.geomgraph.EdgeEnd.prototype.setNode=function(node){this.node=node;};jsts.geomgraph.EdgeEnd.prototype.getNode=function(){return this.node;};jsts.geomgraph.EdgeEnd.prototype.compareTo=function(e){return this.compareDirection(e);};jsts.geomgraph.EdgeEnd.prototype.compareDirection=function(e){if(this.dx===e.dx&&this.dy===e.dy)
return 0;if(this.quadrant>e.quadrant)
return 1;if(this.quadrant<e.quadrant)
return-1;return jsts.algorithm.CGAlgorithms.computeOrientation(e.p0,e.p1,this.p1);};jsts.geomgraph.EdgeEnd.prototype.computeLabel=function(boundaryNodeRule){};})();jsts.operation.buffer.RightmostEdgeFinder=function(){};jsts.operation.buffer.RightmostEdgeFinder.prototype.minIndex=-1;jsts.operation.buffer.RightmostEdgeFinder.prototype.minCoord=null;jsts.operation.buffer.RightmostEdgeFinder.prototype.minDe=null;jsts.operation.buffer.RightmostEdgeFinder.prototype.orientedDe=null;jsts.operation.buffer.RightmostEdgeFinder.prototype.getEdge=function(){return this.orientedDe;};jsts.operation.buffer.RightmostEdgeFinder.prototype.getCoordinate=function(){return this.minCoord;};jsts.operation.buffer.RightmostEdgeFinder.prototype.findEdge=function(dirEdgeList){for(var i=dirEdgeList.iterator();i.hasNext();){var de=i.next();if(!de.isForward())
continue;this.checkForRightmostCoordinate(de);}
jsts.util.Assert.isTrue(this.minIndex!==0||this.minCoord.equals(this.minDe.getCoordinate()),'inconsistency in rightmost processing');if(this.minIndex===0){this.findRightmostEdgeAtNode();}else{this.findRightmostEdgeAtVertex();}
this.orientedDe=this.minDe;var rightmostSide=this.getRightmostSide(this.minDe,this.minIndex);if(rightmostSide==jsts.geomgraph.Position.LEFT){this.orientedDe=this.minDe.getSym();}};jsts.operation.buffer.RightmostEdgeFinder.prototype.findRightmostEdgeAtNode=function(){var node=this.minDe.getNode();var star=node.getEdges();this.minDe=star.getRightmostEdge();if(!this.minDe.isForward()){this.minDe=this.minDe.getSym();this.minIndex=this.minDe.getEdge().getCoordinates().length-1;}};jsts.operation.buffer.RightmostEdgeFinder.prototype.findRightmostEdgeAtVertex=function(){var pts=this.minDe.getEdge().getCoordinates();jsts.util.Assert.isTrue(this.minIndex>0&&this.minIndex<pts.length,'rightmost point expected to be interior vertex of edge');var pPrev=pts[this.minIndex-1];var pNext=pts[this.minIndex+1];var orientation=jsts.algorithm.CGAlgorithms.computeOrientation(this.minCoord,pNext,pPrev);var usePrev=false;if(pPrev.y<this.minCoord.y&&pNext.y<this.minCoord.y&&orientation===jsts.algorithm.CGAlgorithms.COUNTERCLOCKWISE){usePrev=true;}else if(pPrev.y>this.minCoord.y&&pNext.y>this.minCoord.y&&orientation===jsts.algorithm.CGAlgorithms.CLOCKWISE){usePrev=true;}
if(usePrev){this.minIndex=this.minIndex-1;}};jsts.operation.buffer.RightmostEdgeFinder.prototype.checkForRightmostCoordinate=function(de){var coord=de.getEdge().getCoordinates();for(var i=0;i<coord.length-1;i++){if(this.minCoord===null||coord[i].x>this.minCoord.x){this.minDe=de;this.minIndex=i;this.minCoord=coord[i];}}};jsts.operation.buffer.RightmostEdgeFinder.prototype.getRightmostSide=function(de,index){var side=this.getRightmostSideOfSegment(de,index);if(side<0)
side=this.getRightmostSideOfSegment(de,index-1);if(side<0){this.minCoord=null;this.checkForRightmostCoordinate(de);}
return side;};jsts.operation.buffer.RightmostEdgeFinder.prototype.getRightmostSideOfSegment=function(de,i){var e=de.getEdge();var coord=e.getCoordinates();if(i<0||i+1>=coord.length)
return-1;if(coord[i].y==coord[i+1].y)
return-1;var pos=jsts.geomgraph.Position.LEFT;if(coord[i].y<coord[i+1].y)
pos=jsts.geomgraph.Position.RIGHT;return pos;};(function(){jsts.triangulate.IncrementalDelaunayTriangulator=function(subdiv){this.subdiv=subdiv;this.isUsingTolerance=subdiv.getTolerance()>0.0;};jsts.triangulate.IncrementalDelaunayTriangulator.prototype.insertSites=function(vertices){var i=0,il=vertices.length,v;for(i;i<il;i++){v=vertices[i];this.insertSite(v);}};jsts.triangulate.IncrementalDelaunayTriangulator.prototype.insertSite=function(v){var e,base,startEdge,t;e=this.subdiv.locate(v);if(this.subdiv.isVertexOfEdge(e,v)){return e;}
else if(this.subdiv.isOnEdge(e,v.getCoordinate())){e=e.oPrev();this.subdiv.delete_jsts(e.oNext());}
base=this.subdiv.makeEdge(e.orig(),v);jsts.triangulate.quadedge.QuadEdge.splice(base,e);startEdge=base;do{base=this.subdiv.connect(e,base.sym());e=base.oPrev();}while(e.lNext()!=startEdge);do{t=e.oPrev();if(t.dest().rightOf(e)&&v.isInCircle(e.orig(),t.dest(),e.dest())){jsts.triangulate.quadedge.QuadEdge.swap(e);e=e.oPrev();}else if(e.oNext()==startEdge){return base;}else{e=e.oNext().lPrev();}}while(true);};}());jsts.algorithm.CentroidArea=function(){this.basePt=null;this.triangleCent3=new jsts.geom.Coordinate();this.centSum=new jsts.geom.Coordinate();this.cg3=new jsts.geom.Coordinate();};jsts.algorithm.CentroidArea.prototype.basePt=null;jsts.algorithm.CentroidArea.prototype.triangleCent3=null;jsts.algorithm.CentroidArea.prototype.areasum2=0;jsts.algorithm.CentroidArea.prototype.cg3=null;jsts.algorithm.CentroidArea.prototype.centSum=null;jsts.algorithm.CentroidArea.prototype.totalLength=0.0;jsts.algorithm.CentroidArea.prototype.add=function(geom){if(geom instanceof jsts.geom.Polygon){var poly=geom;this.setBasePoint(poly.getExteriorRing().getCoordinateN(0));this.add3(poly);}else if(geom instanceof jsts.geom.GeometryCollection||geom instanceof jsts.geom.MultiPolygon){var gc=geom;for(var i=0;i<gc.getNumGeometries();i++){this.add(gc.getGeometryN(i));}}else if(geom instanceof Array){this.add2(geom);}};jsts.algorithm.CentroidArea.prototype.add2=function(ring){this.setBasePoint(ring[0]);this.addShell(ring);};jsts.algorithm.CentroidArea.prototype.getCentroid=function(){var cent=new jsts.geom.Coordinate();if(Math.abs(this.areasum2)>0.0){cent.x=this.cg3.x/3/this.areasum2;cent.y=this.cg3.y/3/this.areasum2;}else{cent.x=this.centSum.x/this.totalLength;cent.y=this.centSum.y/this.totalLength;}
return cent;};jsts.algorithm.CentroidArea.prototype.setBasePoint=function(basePt){if(this.basePt==null)
this.basePt=basePt;};jsts.algorithm.CentroidArea.prototype.add3=function(poly){this.addShell(poly.getExteriorRing().getCoordinates());for(var i=0;i<poly.getNumInteriorRing();i++){this.addHole(poly.getInteriorRingN(i).getCoordinates());}};jsts.algorithm.CentroidArea.prototype.addShell=function(pts){var isPositiveArea=!jsts.algorithm.CGAlgorithms.isCCW(pts);for(var i=0;i<pts.length-1;i++){this.addTriangle(this.basePt,pts[i],pts[i+1],isPositiveArea);}
this.addLinearSegments(pts);};jsts.algorithm.CentroidArea.prototype.addHole=function(pts){var isPositiveArea=jsts.algorithm.CGAlgorithms.isCCW(pts);for(var i=0;i<pts.length-1;i++){this.addTriangle(this.basePt,pts[i],pts[i+1],isPositiveArea);}
this.addLinearSegments(pts);};jsts.algorithm.CentroidArea.prototype.addTriangle=function(p0,p1,p2,isPositiveArea){var sign=(isPositiveArea)?1.0:-1.0;jsts.algorithm.CentroidArea.centroid3(p0,p1,p2,this.triangleCent3);var area2=jsts.algorithm.CentroidArea.area2(p0,p1,p2);this.cg3.x+=sign*area2*this.triangleCent3.x;this.cg3.y+=sign*area2*this.triangleCent3.y;this.areasum2+=sign*area2;};jsts.algorithm.CentroidArea.centroid3=function(p1,p2,p3,c){c.x=p1.x+p2.x+p3.x;c.y=p1.y+p2.y+p3.y;return;};jsts.algorithm.CentroidArea.area2=function(p1,p2,p3){return(p2.x-p1.x)*(p3.y-p1.y)-(p3.x-p1.x)*(p2.y-p1.y);};jsts.algorithm.CentroidArea.prototype.addLinearSegments=function(pts){for(var i=0;i<pts.length-1;i++){var segmentLen=pts[i].distance(pts[i+1]);this.totalLength+=segmentLen;var midx=(pts[i].x+pts[i+1].x)/2;this.centSum.x+=segmentLen*midx;var midy=(pts[i].y+pts[i+1].y)/2;this.centSum.y+=segmentLen*midy;}};jsts.geomgraph.index.SweepLineSegment=function(edge,ptIndex){this.edge=edge;this.ptIndex=ptIndex;this.pts=edge.getCoordinates();};jsts.geomgraph.index.SweepLineSegment.prototype.edge=null;jsts.geomgraph.index.SweepLineSegment.prototype.pts=null;jsts.geomgraph.index.SweepLineSegment.prototype.ptIndex=null;jsts.geomgraph.index.SweepLineSegment.prototype.getMinX=function(){var x1=this.pts[this.ptIndex].x;var x2=this.pts[this.ptIndex+1].x;if(x1<x2){return x1;}
return x2;};jsts.geomgraph.index.SweepLineSegment.prototype.getMaxX=function(){var x1=this.pts[this.ptIndex].x;var x2=this.pts[this.ptIndex+1].x;if(x1>x2){return x1;}
return x2;};jsts.geomgraph.index.SweepLineSegment.prototype.computeIntersections=function(ss,si){si.addIntersections(this.edge,this.ptIndex,ss.edge,ss.ptIndex);};jsts.index.quadtree.Root=function(){jsts.index.quadtree.NodeBase.prototype.constructor.apply(this,arguments);this.origin=new jsts.geom.Coordinate(0.0,0.0);};jsts.index.quadtree.Root.prototype=new jsts.index.quadtree.NodeBase();jsts.index.quadtree.Root.prototype.insert=function(itemEnv,item){var index=this.getSubnodeIndex(itemEnv,this.origin);if(index===-1){this.add(item);return;}
var node=this.subnode[index];if(node===null||!node.getEnvelope().contains(itemEnv)){var largerNode=jsts.index.quadtree.Node.createExpanded(node,itemEnv);this.subnode[index]=largerNode;}
this.insertContained(this.subnode[index],itemEnv,item);};jsts.index.quadtree.Root.prototype.insertContained=function(tree,itemEnv,item){var isZeroX,isZeroY,node;isZeroX=jsts.index.IntervalSize.isZeroWidth(itemEnv.getMinX(),itemEnv.getMaxX());isZeroY=jsts.index.IntervalSize.isZeroWidth(itemEnv.getMinY(),itemEnv.getMaxY());if(isZeroX||isZeroY){node=tree.find(itemEnv);}else{node=tree.getNode(itemEnv);}
node.add(item);};jsts.index.quadtree.Root.prototype.isSearchMatch=function(searchEnv){return true;};jsts.geomgraph.index.MonotoneChainIndexer=function(){};jsts.geomgraph.index.MonotoneChainIndexer.toIntArray=function(list){var array=[];for(var i=list.iterator();i.hasNext();){var element=i.next();array.push(element);}
return array;};jsts.geomgraph.index.MonotoneChainIndexer.prototype.getChainStartIndices=function(pts){var start=0;var startIndexList=new javascript.util.ArrayList();startIndexList.add(start);do{var last=this.findChainEnd(pts,start);startIndexList.add(last);start=last;}while(start<pts.length-1);var startIndex=jsts.geomgraph.index.MonotoneChainIndexer.toIntArray(startIndexList);return startIndex;};jsts.geomgraph.index.MonotoneChainIndexer.prototype.findChainEnd=function(pts,start){var chainQuad=jsts.geomgraph.Quadrant.quadrant(pts[start],pts[start+1]);var last=start+1;while(last<pts.length){var quad=jsts.geomgraph.Quadrant.quadrant(pts[last-1],pts[last]);if(quad!=chainQuad){break;}
last++;}
return last-1;};jsts.noding.IntersectionAdder=function(li){this.li=li;};jsts.noding.IntersectionAdder.prototype=new jsts.noding.SegmentIntersector();jsts.noding.IntersectionAdder.constructor=jsts.noding.IntersectionAdder;jsts.noding.IntersectionAdder.isAdjacentSegments=function(i1,i2){return Math.abs(i1-i2)===1;};jsts.noding.IntersectionAdder.prototype._hasIntersection=false;jsts.noding.IntersectionAdder.prototype.hasProper=false;jsts.noding.IntersectionAdder.prototype.hasProperInterior=false;jsts.noding.IntersectionAdder.prototype.hasInterior=false;jsts.noding.IntersectionAdder.prototype.properIntersectionPoint=null;jsts.noding.IntersectionAdder.prototype.li=null;jsts.noding.IntersectionAdder.prototype.isSelfIntersection=null;jsts.noding.IntersectionAdder.prototype.numIntersections=0;jsts.noding.IntersectionAdder.prototype.numInteriorIntersections=0;jsts.noding.IntersectionAdder.prototype.numProperIntersections=0;jsts.noding.IntersectionAdder.prototype.numTests=0;jsts.noding.IntersectionAdder.prototype.getLineIntersector=function(){return this.li;};jsts.noding.IntersectionAdder.prototype.getProperIntersectionPoint=function(){return this.properIntersectionPoint;};jsts.noding.IntersectionAdder.prototype.hasIntersection=function(){return this._hasIntersection;};jsts.noding.IntersectionAdder.prototype.hasProperIntersection=function(){return this.hasProper;};jsts.noding.IntersectionAdder.prototype.hasProperInteriorIntersection=function(){return this.hasProperInterior;};jsts.noding.IntersectionAdder.prototype.hasInteriorIntersection=function(){return this.hasInterior;};jsts.noding.IntersectionAdder.prototype.isTrivialIntersection=function(e0,segIndex0,e1,segIndex1){if(e0==e1){if(this.li.getIntersectionNum()==1){if(jsts.noding.IntersectionAdder.isAdjacentSegments(segIndex0,segIndex1))
return true;if(e0.isClosed()){var maxSegIndex=e0.size()-1;if((segIndex0===0&&segIndex1===maxSegIndex)||(segIndex1===0&&segIndex0===maxSegIndex)){return true;}}}}
return false;};jsts.noding.IntersectionAdder.prototype.processIntersections=function(e0,segIndex0,e1,segIndex1){if(e0===e1&&segIndex0===segIndex1)
return;this.numTests++;var p00=e0.getCoordinates()[segIndex0];var p01=e0.getCoordinates()[segIndex0+1];var p10=e1.getCoordinates()[segIndex1];var p11=e1.getCoordinates()[segIndex1+1];this.li.computeIntersection(p00,p01,p10,p11);if(this.li.hasIntersection()){this.numIntersections++;if(this.li.isInteriorIntersection()){this.numInteriorIntersections++;this.hasInterior=true;}
if(!this.isTrivialIntersection(e0,segIndex0,e1,segIndex1)){this._hasIntersection=true;e0.addIntersections(this.li,segIndex0,0);e1.addIntersections(this.li,segIndex1,1);if(this.li.isProper()){this.numProperIntersections++;this.hasProper=true;this.hasProperInterior=true;}}}};jsts.noding.IntersectionAdder.prototype.isDone=function(){return false;};jsts.operation.union.CascadedPolygonUnion=function(polys){this.inputPolys=polys;};jsts.operation.union.CascadedPolygonUnion.union=function(polys){var op=new jsts.operation.union.CascadedPolygonUnion(polys);return op.union();};jsts.operation.union.CascadedPolygonUnion.prototype.inputPolys;jsts.operation.union.CascadedPolygonUnion.prototype.geomFactory=null;jsts.operation.union.CascadedPolygonUnion.prototype.STRTREE_NODE_CAPACITY=4;jsts.operation.union.CascadedPolygonUnion.prototype.union=function(){if(this.inputPolys.length===0){return null;}
this.geomFactory=this.inputPolys[0].getFactory();var index=new jsts.index.strtree.STRtree(this.STRTREE_NODE_CAPACITY);for(var i=0,l=this.inputPolys.length;i<l;i++){var item=this.inputPolys[i];index.insert(item.getEnvelopeInternal(),item);}
var itemTree=index.itemsTree();var unionAll=this.unionTree(itemTree);return unionAll;};jsts.operation.union.CascadedPolygonUnion.prototype.unionTree=function(geomTree){var geoms=this.reduceToGeometries(geomTree);var union=this.binaryUnion(geoms);return union;};jsts.operation.union.CascadedPolygonUnion.prototype.binaryUnion=function(geoms,start,end){start=start||0;end=end||geoms.length;if(end-start<=1){var g0=this.getGeometry(geoms,start);return this.unionSafe(g0,null);}
else if(end-start===2){return this.unionSafe(this.getGeometry(geoms,start),this.getGeometry(geoms,start+1));}
else{var mid=parseInt((end+start)/2);var g0=this.binaryUnion(geoms,start,mid);var g1=this.binaryUnion(geoms,mid,end);return this.unionSafe(g0,g1);}};jsts.operation.union.CascadedPolygonUnion.prototype.getGeometry=function(list,index){if(index>=list.length){return null;}
return list[index];};jsts.operation.union.CascadedPolygonUnion.prototype.reduceToGeometries=function(geomTree){var geoms=[];for(var i=0,l=geomTree.length;i<l;i++){var o=geomTree[i],geom=null;if(o instanceof Array){geom=this.unionTree(o);}
else if(o instanceof jsts.geom.Geometry){geom=o;}
geoms.push(geom);}
return geoms;};jsts.operation.union.CascadedPolygonUnion.prototype.unionSafe=function(g0,g1){if(g0===null&&g1===null){return null;}
if(g0===null){return g1.clone();}
if(g1===null){return g0.clone();}
return this.unionOptimized(g0,g1);};jsts.operation.union.CascadedPolygonUnion.prototype.unionOptimized=function(g0,g1){var g0Env=g0.getEnvelopeInternal(),g1Env=g1.getEnvelopeInternal();if(!g0Env.intersects(g1Env)){var combo=jsts.geom.util.GeometryCombiner.combine(g0,g1);return combo;}
if(g0.getNumGeometries<=1&&g1.getNumGeometries<=1){return this.unionActual(g0,g1);}
var commonEnv=g0Env.intersection(g1Env);return this.unionUsingEnvelopeIntersection(g0,g1,commonEnv);};jsts.operation.union.CascadedPolygonUnion.prototype.unionUsingEnvelopeIntersection=function(g0,g1,common){var disjointPolys=new javascript.util.ArrayList();var g0Int=this.extractByEnvelope(common,g0,disjointPolys);var g1Int=this.extractByEnvelope(common,g1,disjointPolys);var union=this.unionActual(g0Int,g1Int);disjointPolys.add(union);var overallUnion=jsts.geom.util.GeometryCombiner.combine(disjointPolys);return overallUnion;};jsts.operation.union.CascadedPolygonUnion.prototype.extractByEnvelope=function(env,geom,disjointGeoms){var intersectingGeoms=new javascript.util.ArrayList();for(var i=0;i<geom.getNumGeometries();i++){var elem=geom.getGeometryN(i);if(elem.getEnvelopeInternal().intersects(env)){intersectingGeoms.add(elem);}
else{disjointGeoms.add(elem);}}
return this.geomFactory.buildGeometry(intersectingGeoms);};jsts.operation.union.CascadedPolygonUnion.prototype.unionActual=function(g0,g1){return g0.union(g1);};(function(){jsts.geom.MultiPoint=function(points,factory){this.geometries=points||[];this.factory=factory;};jsts.geom.MultiPoint.prototype=new jsts.geom.GeometryCollection();jsts.geom.MultiPoint.constructor=jsts.geom.MultiPoint;jsts.geom.MultiPoint.prototype.getBoundary=function(){return this.getFactory().createGeometryCollection(null);};jsts.geom.MultiPoint.prototype.getGeometryN=function(n){return this.geometries[n];};jsts.geom.MultiPoint.prototype.equalsExact=function(other,tolerance){if(!this.isEquivalentClass(other)){return false;}
return jsts.geom.GeometryCollection.prototype.equalsExact.call(this,other,tolerance);};jsts.geom.MultiPoint.prototype.CLASS_NAME='jsts.geom.MultiPoint';})();jsts.operation.buffer.OffsetCurveBuilder=function(precisionModel,bufParams){this.precisionModel=precisionModel;this.bufParams=bufParams;};jsts.operation.buffer.OffsetCurveBuilder.prototype.distance=0.0;jsts.operation.buffer.OffsetCurveBuilder.prototype.precisionModel=null;jsts.operation.buffer.OffsetCurveBuilder.prototype.bufParams=null;jsts.operation.buffer.OffsetCurveBuilder.prototype.getBufferParameters=function(){return this.bufParams;};jsts.operation.buffer.OffsetCurveBuilder.prototype.getLineCurve=function(inputPts,distance){this.distance=distance;if(this.distance<0.0&&!this.bufParams.isSingleSided())
return null;if(this.distance==0.0)
return null;var posDistance=Math.abs(this.distance);var segGen=this.getSegGen(posDistance);if(inputPts.length<=1){this.computePointCurve(inputPts[0],segGen);}else{if(this.bufParams.isSingleSided()){var isRightSide=distance<0.0;this.computeSingleSidedBufferCurve(inputPts,isRightSide,segGen);}else
this.computeLineBufferCurve(inputPts,segGen);}
var lineCoord=segGen.getCoordinates();return lineCoord;};jsts.operation.buffer.OffsetCurveBuilder.prototype.getRingCurve=function(inputPts,side,distance){this.distance=distance;if(inputPts.length<=2)
return this.getLineCurve(inputPts,distance);if(this.distance==0.0){return jsts.operation.buffer.OffsetCurveBuilder.copyCoordinates(inputPts);}
var segGen=this.getSegGen(this.distance);this.computeRingBufferCurve(inputPts,side,segGen);return segGen.getCoordinates();};jsts.operation.buffer.OffsetCurveBuilder.prototype.getOffsetCurve=function(inputPts,distance){this.distance=distance;if(this.distance===0.0)
return null;var isRightSide=this.distance<0.0;var posDistance=Math.abs(this.distance);var segGen=this.getSegGen(posDistance);if(inputPts.length<=1){this.computePointCurve(inputPts[0],segGen);}else{this.computeOffsetCurve(inputPts,isRightSide,segGen);}
var curvePts=segGen.getCoordinates();if(isRightSide)
curvePts.reverse();return curvePts;};jsts.operation.buffer.OffsetCurveBuilder.copyCoordinates=function(pts){var copy=[];for(var i=0;i<pts.length;i++){copy.push(pts[i].clone());}
return copy;};jsts.operation.buffer.OffsetCurveBuilder.prototype.getSegGen=function(distance){return new jsts.operation.buffer.OffsetSegmentGenerator(this.precisionModel,this.bufParams,distance);};jsts.operation.buffer.OffsetCurveBuilder.SIMPLIFY_FACTOR=100.0;jsts.operation.buffer.OffsetCurveBuilder.simplifyTolerance=function(bufDistance){return bufDistance/jsts.operation.buffer.OffsetCurveBuilder.SIMPLIFY_FACTOR;};jsts.operation.buffer.OffsetCurveBuilder.prototype.computePointCurve=function(pt,segGen){switch(this.bufParams.getEndCapStyle()){case jsts.operation.buffer.BufferParameters.CAP_ROUND:segGen.createCircle(pt);break;case jsts.operation.buffer.BufferParameters.CAP_SQUARE:segGen.createSquare(pt);break;}};jsts.operation.buffer.OffsetCurveBuilder.prototype.computeLineBufferCurve=function(inputPts,segGen){var distTol=jsts.operation.buffer.OffsetCurveBuilder.simplifyTolerance(this.distance);var simp1=jsts.operation.buffer.BufferInputLineSimplifier.simplify(inputPts,distTol);var n1=simp1.length-1;segGen.initSideSegments(simp1[0],simp1[1],jsts.geomgraph.Position.LEFT);for(var i=2;i<=n1;i++){segGen.addNextSegment(simp1[i],true);}
segGen.addLastSegment();segGen.addLineEndCap(simp1[n1-1],simp1[n1]);var simp2=jsts.operation.buffer.BufferInputLineSimplifier.simplify(inputPts,-distTol);var n2=simp2.length-1;segGen.initSideSegments(simp2[n2],simp2[n2-1],jsts.geomgraph.Position.LEFT);for(var i=n2-2;i>=0;i--){segGen.addNextSegment(simp2[i],true);}
segGen.addLastSegment();segGen.addLineEndCap(simp2[1],simp2[0]);segGen.closeRing();};jsts.operation.buffer.OffsetCurveBuilder.prototype.computeSingleSidedBufferCurve=function(inputPts,isRightSide,segGen){var distTol=jsts.operation.buffer.OffsetCurveBuilder.simplifyTolerance(this.distance);if(isRightSide){segGen.addSegments(inputPts,true);var simp2=jsts.operation.buffer.BufferInputLineSimplifier.simplify(inputPts,-distTol);var n2=simp2.length-1;segGen.initSideSegments(simp2[n2],simp2[n2-1],jsts.geomgraph.Position.LEFT);segGen.addFirstSegment();for(var i=n2-2;i>=0;i--){segGen.addNextSegment(simp2[i],true);}}else{segGen.addSegments(inputPts,false);var simp1=jsts.operation.buffer.BufferInputLineSimplifier.simplify(inputPts,distTol);var n1=simp1.length-1;segGen.initSideSegments(simp1[0],simp1[1],jsts.geomgraph.Position.LEFT);segGen.addFirstSegment();for(var i=2;i<=n1;i++){segGen.addNextSegment(simp1[i],true);}}
segGen.addLastSegment();segGen.closeRing();};jsts.operation.buffer.OffsetCurveBuilder.prototype.computeOffsetCurve=function(inputPts,isRightSide,segGen){var distTol=jsts.operation.buffer.OffsetCurveBuilder.simplifyTolerance(this.distance);if(isRightSide){var simp2=jsts.operation.buffer.BufferInputLineSimplifier.simplify(inputPts,-distTol);var n2=simp2.length-1;segGen.initSideSegments(simp2[n2],simp2[n2-1],jsts.geomgraph.Position.LEFT);segGen.addFirstSegment();for(var i=n2-2;i>=0;i--){segGen.addNextSegment(simp2[i],true);}}else{var simp1=jsts.operation.buffer.BufferInputLineSimplifier.simplify(inputPts,distTol);var n1=simp1.length-1;segGen.initSideSegments(simp1[0],simp1[1],jsts.geomgraph.Position.LEFT);segGen.addFirstSegment();for(var i=2;i<=n1;i++){segGen.addNextSegment(simp1[i],true);}}
segGen.addLastSegment();};jsts.operation.buffer.OffsetCurveBuilder.prototype.computeRingBufferCurve=function(inputPts,side,segGen){var distTol=jsts.operation.buffer.OffsetCurveBuilder.simplifyTolerance(this.distance);if(side===jsts.geomgraph.Position.RIGHT)
distTol=-distTol;var simp=jsts.operation.buffer.BufferInputLineSimplifier.simplify(inputPts,distTol);var n=simp.length-1;segGen.initSideSegments(simp[n-1],simp[0],side);for(var i=1;i<=n;i++){var addStartPoint=i!==1;segGen.addNextSegment(simp[i],addStartPoint);}
segGen.closeRing();};(function(){var HotPixelSnapAction=function(hotPixel,parentEdge,vertexIndex){this.hotPixel=hotPixel;this.parentEdge=parentEdge;this.vertexIndex=vertexIndex;};HotPixelSnapAction.prototype=new jsts.index.chain.MonotoneChainSelectAction();HotPixelSnapAction.constructor=HotPixelSnapAction;HotPixelSnapAction.prototype.hotPixel=null;HotPixelSnapAction.prototype.parentEdge=null;HotPixelSnapAction.prototype.vertexIndex=null;HotPixelSnapAction.prototype._isNodeAdded=false;HotPixelSnapAction.prototype.isNodeAdded=function(){return this._isNodeAdded;};HotPixelSnapAction.prototype.select=function(mc,startIndex){var ss=mc.getContext();if(this.parentEdge!==null){if(ss===this.parentEdge&&startIndex===this.vertexIndex)
return;}
this._isNodeAdded=this.hotPixel.addSnappedNode(ss,startIndex);};jsts.noding.snapround.MCIndexPointSnapper=function(index){this.index=index;};jsts.noding.snapround.MCIndexPointSnapper.prototype.index=null;jsts.noding.snapround.MCIndexPointSnapper.prototype.snap=function(hotPixel,parentEdge,vertexIndex){if(arguments.length===1){this.snap2.apply(this,arguments);return;}
var pixelEnv=hotPixel.getSafeEnvelope();var hotPixelSnapAction=new HotPixelSnapAction(hotPixel,parentEdge,vertexIndex);this.index.query(pixelEnv,{visitItem:function(testChain){testChain.select(pixelEnv,hotPixelSnapAction);}});return hotPixelSnapAction.isNodeAdded();};jsts.noding.snapround.MCIndexPointSnapper.prototype.snap2=function(hotPixel){return this.snap(hotPixel,null,-1);};})();(function(){var NodeBase=function(){this.items=new javascript.util.ArrayList();this.subnode=[null,null];};NodeBase.getSubnodeIndex=function(interval,centre){var subnodeIndex=-1;if(interval.min>=centre){subnodeIndex=1;}
if(interval.max<=centre){subnodeIndex=0;}
return subnodeIndex;};NodeBase.prototype.getItems=function(){return this.items;};NodeBase.prototype.add=function(item){this.items.add(item);};NodeBase.prototype.addAllItems=function(items){items.addAll(this.items);var i=0,il=2;for(i;i<il;i++){if(this.subnode[i]!==null){this.subnode[i].addAllItems(items);}}
return items;};NodeBase.prototype.addAllItemsFromOverlapping=function(interval,resultItems){if(interval!==null&&!this.isSearchMatch(interval)){return;}
resultItems.addAll(this.items);if(this.subnode[0]!==null){this.subnode[0].addAllItemsFromOverlapping(interval,resultItems);}
if(this.subnode[1]!==null){this.subnode[1].addAllItemsFromOverlapping(interval,resultItems);}};NodeBase.prototype.remove=function(itemInterval,item){if(!this.isSearchMatch(itemInterval)){return false;}
var found=false,i=0,il=2;for(i;i<il;i++){if(this.subnode[i]!==null){found=this.subnode[i].remove(itemInterval,item);if(found){if(this.subnode[i].isPrunable()){this.subnode[i]=null;}
break;}}}
if(found){return found;}
found=this.items.remove(item);return found;};NodeBase.prototype.isPrunable=function(){return!(this.hasChildren()||this.hasItems());};NodeBase.prototype.hasChildren=function(){var i=0,il=2;for(i;i<il;i++){if(this.subnode[i]!==null){return true;}}
return false;};NodeBase.prototype.hasItems=function(){return!this.items.isEmpty();};NodeBase.prototype.depth=function(){var maxSubDepth=0,i=0,il=2,sqd;for(i;i<il;i++){if(this.subnode[i]!==null){sqd=this.subnode[i].depth();if(sqd>maxSubDepth){maxSubDepth=sqd;}}}
return maxSubDepth+1;};NodeBase.prototype.size=function(){var subSize=0,i=0,il=2;for(i;i<il;i++){if(this.subnode[i]!==null){subSize+=this.subnode[i].size();}}
return subSize+this.items.size();};NodeBase.prototype.nodeSize=function(){var subSize=0,i=0,il=2;for(i;i<il;i++){if(this.subnode[i]!==null){subSize+=this.subnode[i].nodeSize();}}
return subSize+1;};jsts.index.bintree.NodeBase=NodeBase;})();(function(){var NodeBase=jsts.index.bintree.NodeBase;var Key=jsts.index.bintree.Key;var Interval=jsts.index.bintree.Interval;var Node=function(interval,level){this.items=new javascript.util.ArrayList();this.subnode=[null,null];this.interval=interval;this.level=level;this.centre=(interval.getMin()+interval.getMax())/2;};Node.prototype=new NodeBase();Node.constructor=Node;Node.createNode=function(itemInterval){var key,node;key=new Key(itemInterval);node=new Node(key.getInterval(),key.getLevel());return node;};Node.createExpanded=function(node,addInterval){var expandInt,largerNode;expandInt=new Interval(addInterval);if(node!==null){expandInt.expandToInclude(node.interval);}
largerNode=Node.createNode(expandInt);if(node!==null){largerNode.insert(node);}
return largerNode;};Node.prototype.getInterval=function(){return this.interval;};Node.prototype.isSearchMatch=function(itemInterval){return itemInterval.overlaps(this.interval);};Node.prototype.getNode=function(searchInterval){var subnodeIndex=NodeBase.getSubnodeIndex(searchInterval,this.centre),node;if(subnodeIndex!=-1){node=this.getSubnode(subnodeIndex);return node.getNode(searchInterval);}else{return this;}};Node.prototype.find=function(searchInterval){var subnodeIndex=NodeBase.getSubnodeIndex(searchInterval,this.centre),node;if(subnodeIndex===-1){return this;}
if(this.subnode[subnodeIndex]!==null){node=this.subnode[subnodeIndex];return node.find(searchInterval);}
return this;};Node.prototype.insert=function(node){var index=NodeBase.getSubnodeIndex(node.interval,this.centre),childNode;if(node.level===this.level-1){this.subnode[index]=node;}else{childNode=this.createSubnode(index);childNode.insert(node);this.subnode[index]=childNode;}};Node.prototype.getSubnode=function(index){if(this.subnode[index]===null){this.subnode[index]=this.createSubnode(index);}
return this.subnode[index];};Node.prototype.createSubnode=function(index){var min,max,subInt,node;min=0.0;max=0.0;switch(index){case 0:min=this.interval.getMin();max=this.centre;break;case 1:min=this.centre;max=this.interval.getMax();break;}
subInt=new Interval(min,max);node=new Node(subInt,this.level-1);return node;};jsts.index.bintree.Node=Node;})();(function(){var Node=jsts.index.bintree.Node;var NodeBase=jsts.index.bintree.NodeBase;var Root=function(){this.subnode=[null,null];this.items=new javascript.util.ArrayList();};Root.prototype=new jsts.index.bintree.NodeBase();Root.constructor=Root;Root.origin=0.0;Root.prototype.insert=function(itemInterval,item){var index=NodeBase.getSubnodeIndex(itemInterval,Root.origin),node,largerNode;if(index===-1){this.add(item);return;}
node=this.subnode[index];if(node===null||!node.getInterval().contains(itemInterval)){largerNode=Node.createExpanded(node,itemInterval);this.subnode[index]=largerNode;}
this.insertContained(this.subnode[index],itemInterval,item);};Root.prototype.insertContained=function(tree,itemInterval,item){var isZeroArea,node;isZeroArea=jsts.index.IntervalSize.isZeroWidth(itemInterval.getMin(),itemInterval.getMax());node=isZeroArea?tree.find(itemInterval):tree.getNode(itemInterval);node.add(item);};Root.prototype.isSearchMatch=function(interval){return true;};jsts.index.bintree.Root=Root;})();jsts.geomgraph.Quadrant=function(){};jsts.geomgraph.Quadrant.NE=0;jsts.geomgraph.Quadrant.NW=1;jsts.geomgraph.Quadrant.SW=2;jsts.geomgraph.Quadrant.SE=3;jsts.geomgraph.Quadrant.quadrant=function(dx,dy){if(dx instanceof jsts.geom.Coordinate){return jsts.geomgraph.Quadrant.quadrant2.apply(this,arguments);}
if(dx===0.0&&dy===0.0)
throw new jsts.error.IllegalArgumentError('Cannot compute the quadrant for point ( '+dx+', '+dy+' )');if(dx>=0.0){if(dy>=0.0)
return jsts.geomgraph.Quadrant.NE;else
return jsts.geomgraph.Quadrant.SE;}else{if(dy>=0.0)
return jsts.geomgraph.Quadrant.NW;else
return jsts.geomgraph.Quadrant.SW;}};jsts.geomgraph.Quadrant.quadrant2=function(p0,p1){if(p1.x===p0.x&&p1.y===p0.y)
throw new jsts.error.IllegalArgumentError('Cannot compute the quadrant for two identical points '+p0);if(p1.x>=p0.x){if(p1.y>=p0.y)
return jsts.geomgraph.Quadrant.NE;else
return jsts.geomgraph.Quadrant.SE;}else{if(p1.y>=p0.y)
return jsts.geomgraph.Quadrant.NW;else
return jsts.geomgraph.Quadrant.SW;}};jsts.geomgraph.Quadrant.isOpposite=function(quad1,quad2){if(quad1===quad2)
return false;var diff=(quad1-quad2+4)%4;if(diff===2)
return true;return false;};jsts.geomgraph.Quadrant.commonHalfPlane=function(quad1,quad2){if(quad1===quad2)
return quad1;var diff=(quad1-quad2+4)%4;if(diff===2)
return-1;var min=(quad1<quad2)?quad1:quad2;var max=(quad1>quad2)?quad1:quad2;if(min===0&&max===3)
return 3;return min;};jsts.geomgraph.Quadrant.isInHalfPlane=function(quad,halfPlane){if(halfPlane===jsts.geomgraph.Quadrant.SE){return quad===jsts.geomgraph.Quadrant.SE||quad===jsts.geomgraph.Quadrant.SW;}
return quad===halfPlane||quad===halfPlane+1;};jsts.geomgraph.Quadrant.isNorthern=function(quad){return quad===jsts.geomgraph.Quadrant.NE||quad===jsts.geomgraph.Quadrant.NW;};jsts.operation.valid.ConsistentAreaTester=function(geomGraph){this.geomGraph=geomGraph;this.li=new jsts.algorithm.RobustLineIntersector();this.nodeGraph=new jsts.operation.relate.RelateNodeGraph();this.invalidPoint=null;};jsts.operation.valid.ConsistentAreaTester.prototype.getInvalidPoint=function(){return this.invalidPoint;};jsts.operation.valid.ConsistentAreaTester.prototype.isNodeConsistentArea=function(){var intersector=this.geomGraph.computeSelfNodes(this.li,true);if(intersector.hasProperIntersection()){this.invalidPoint=intersector.getProperIntersectionPoint();return false;}
this.nodeGraph.build(this.geomGraph);return this.isNodeEdgeAreaLabelsConsistent();};jsts.operation.valid.ConsistentAreaTester.prototype.isNodeEdgeAreaLabelsConsistent=function(){for(var nodeIt=this.nodeGraph.getNodeIterator();nodeIt.hasNext();){var node=nodeIt.next();if(!node.getEdges().isAreaLabelsConsistent(this.geomGraph)){this.invalidPoint=node.getCoordinate().clone();return false;}}
return true;};jsts.operation.valid.ConsistentAreaTester.prototype.hasDuplicateRings=function(){for(var nodeIt=this.nodeGraph.getNodeIterator();nodeIt.hasNext();){var node=nodeIt.next();for(var i=node.getEdges().iterator();i.hasNext();){var eeb=i.next();if(eeb.getEdgeEnds().length>1){invalidPoint=eeb.getEdge().getCoordinate(0);return true;}}}
return false;};jsts.operation.relate.RelateNode=function(coord,edges){jsts.geomgraph.Node.apply(this,arguments);};jsts.operation.relate.RelateNode.prototype=new jsts.geomgraph.Node();jsts.operation.relate.RelateNode.prototype.computeIM=function(im){im.setAtLeastIfValid(this.label.getLocation(0),this.label.getLocation(1),0);};jsts.operation.relate.RelateNode.prototype.updateIMFromEdges=function(im){this.edges.updateIM(im);};(function(){var Location=jsts.geom.Location;var Position=jsts.geomgraph.Position;var EdgeEnd=jsts.geomgraph.EdgeEnd;jsts.geomgraph.DirectedEdge=function(edge,isForward){EdgeEnd.call(this,edge);this.depth=[0,-999,-999];this._isForward=isForward;if(isForward){this.init(edge.getCoordinate(0),edge.getCoordinate(1));}else{var n=edge.getNumPoints()-1;this.init(edge.getCoordinate(n),edge.getCoordinate(n-1));}
this.computeDirectedLabel();};jsts.geomgraph.DirectedEdge.prototype=new EdgeEnd();jsts.geomgraph.DirectedEdge.constructor=jsts.geomgraph.DirectedEdge;jsts.geomgraph.DirectedEdge.depthFactor=function(currLocation,nextLocation){if(currLocation===Location.EXTERIOR&&nextLocation===Location.INTERIOR)
return 1;else if(currLocation===Location.INTERIOR&&nextLocation===Location.EXTERIOR)
return-1;return 0;};jsts.geomgraph.DirectedEdge.prototype._isForward=null;jsts.geomgraph.DirectedEdge.prototype._isInResult=false;jsts.geomgraph.DirectedEdge.prototype._isVisited=false;jsts.geomgraph.DirectedEdge.prototype.sym=null;jsts.geomgraph.DirectedEdge.prototype.next=null;jsts.geomgraph.DirectedEdge.prototype.nextMin=null;jsts.geomgraph.DirectedEdge.prototype.edgeRing=null;jsts.geomgraph.DirectedEdge.prototype.minEdgeRing=null;jsts.geomgraph.DirectedEdge.prototype.depth=null;jsts.geomgraph.DirectedEdge.prototype.getEdge=function(){return this.edge;};jsts.geomgraph.DirectedEdge.prototype.setInResult=function(isInResult){this._isInResult=isInResult;};jsts.geomgraph.DirectedEdge.prototype.isInResult=function(){return this._isInResult;};jsts.geomgraph.DirectedEdge.prototype.isVisited=function(){return this._isVisited;};jsts.geomgraph.DirectedEdge.prototype.setVisited=function(isVisited){this._isVisited=isVisited;};jsts.geomgraph.DirectedEdge.prototype.setEdgeRing=function(edgeRing){this.edgeRing=edgeRing;};jsts.geomgraph.DirectedEdge.prototype.getEdgeRing=function(){return this.edgeRing;};jsts.geomgraph.DirectedEdge.prototype.setMinEdgeRing=function(minEdgeRing){this.minEdgeRing=minEdgeRing;};jsts.geomgraph.DirectedEdge.prototype.getMinEdgeRing=function(){return this.minEdgeRing;};jsts.geomgraph.DirectedEdge.prototype.getDepth=function(position){return this.depth[position];};jsts.geomgraph.DirectedEdge.prototype.setDepth=function(position,depthVal){if(this.depth[position]!==-999){if(this.depth[position]!==depthVal)
throw new jsts.error.TopologyError('assigned depths do not match',this.getCoordinate());}
this.depth[position]=depthVal;};jsts.geomgraph.DirectedEdge.prototype.getDepthDelta=function(){var depthDelta=this.edge.getDepthDelta();if(!this._isForward)
depthDelta=-depthDelta;return depthDelta;};jsts.geomgraph.DirectedEdge.prototype.setVisitedEdge=function(isVisited){this.setVisited(isVisited);this.sym.setVisited(isVisited);};jsts.geomgraph.DirectedEdge.prototype.getSym=function(){return this.sym;};jsts.geomgraph.DirectedEdge.prototype.isForward=function(){return this._isForward;};jsts.geomgraph.DirectedEdge.prototype.setSym=function(de){this.sym=de;};jsts.geomgraph.DirectedEdge.prototype.getNext=function(){return this.next;};jsts.geomgraph.DirectedEdge.prototype.setNext=function(next){this.next=next;};jsts.geomgraph.DirectedEdge.prototype.getNextMin=function(){return this.nextMin;};jsts.geomgraph.DirectedEdge.prototype.setNextMin=function(nextMin){this.nextMin=nextMin;};jsts.geomgraph.DirectedEdge.prototype.isLineEdge=function(){var isLine=this.label.isLine(0)||this.label.isLine(1);var isExteriorIfArea0=!this.label.isArea(0)||this.label.allPositionsEqual(0,Location.EXTERIOR);var isExteriorIfArea1=!this.label.isArea(1)||this.label.allPositionsEqual(1,Location.EXTERIOR);return isLine&&isExteriorIfArea0&&isExteriorIfArea1;};jsts.geomgraph.DirectedEdge.prototype.isInteriorAreaEdge=function(){var isInteriorAreaEdge=true;for(var i=0;i<2;i++){if(!(this.label.isArea(i)&&this.label.getLocation(i,Position.LEFT)===Location.INTERIOR&&this.label.getLocation(i,Position.RIGHT)===Location.INTERIOR)){isInteriorAreaEdge=false;}}
return isInteriorAreaEdge;};jsts.geomgraph.DirectedEdge.prototype.computeDirectedLabel=function(){this.label=new jsts.geomgraph.Label(this.edge.getLabel());if(!this._isForward)
this.label.flip();};jsts.geomgraph.DirectedEdge.prototype.setEdgeDepths=function(position,depth){var depthDelta=this.getEdge().getDepthDelta();if(!this._isForward)
depthDelta=-depthDelta;var directionFactor=1;if(position===Position.LEFT)
directionFactor=-1;var oppositePos=Position.opposite(position);var delta=depthDelta*directionFactor;var oppositeDepth=depth+delta;this.setDepth(position,depth);this.setDepth(oppositePos,oppositeDepth);};})();jsts.operation.distance.DistanceOp=function(g0,g1,terminateDistance){this.ptLocator=new jsts.algorithm.PointLocator();this.geom=[];this.geom[0]=g0;this.geom[1]=g1;this.terminateDistance=terminateDistance;};jsts.operation.distance.DistanceOp.prototype.geom=null;jsts.operation.distance.DistanceOp.prototype.terminateDistance=0.0;jsts.operation.distance.DistanceOp.prototype.ptLocator=null;jsts.operation.distance.DistanceOp.prototype.minDistanceLocation=null;jsts.operation.distance.DistanceOp.prototype.minDistance=Number.MAX_VALUE;jsts.operation.distance.DistanceOp.distance=function(g0,g1){var distOp=new jsts.operation.distance.DistanceOp(g0,g1,0.0);return distOp.distance();};jsts.operation.distance.DistanceOp.isWithinDistance=function(g0,g1,distance){var distOp=new jsts.operation.distance.DistanceOp(g0,g1,distance);return distOp.distance()<=distance;};jsts.operation.distance.DistanceOp.nearestPoints=function(g0,g1){var distOp=new jsts.operation.distance.DistanceOp(g0,g1,0.0);return distOp.nearestPoints();};jsts.operation.distance.DistanceOp.prototype.distance=function(){if(this.geom[0]===null||this.geom[1]===null)
throw new jsts.error.IllegalArgumentError('null geometries are not supported');if(this.geom[0].isEmpty()||this.geom[1].isEmpty())
return 0.0;this.computeMinDistance();return this.minDistance;};jsts.operation.distance.DistanceOp.prototype.nearestPoints=function(){this.computeMinDistance();var nearestPts=[this.minDistanceLocation[0].getCoordinate(),this.minDistanceLocation[1].getCoordinate()];return nearestPts;};jsts.operation.distance.DistanceOp.prototype.nearestLocations=function(){this.computeMinDistance();return this.minDistanceLocation;};jsts.operation.distance.DistanceOp.prototype.updateMinDistance=function(locGeom,flip){if(locGeom[0]===null)
return;if(flip){this.minDistanceLocation[0]=locGeom[1];this.minDistanceLocation[1]=locGeom[0];}else{this.minDistanceLocation[0]=locGeom[0];this.minDistanceLocation[1]=locGeom[1];}};jsts.operation.distance.DistanceOp.prototype.computeMinDistance=function(){if(arguments.length>0){this.computeMinDistance2.apply(this,arguments);return;}
if(this.minDistanceLocation!==null)
return;this.minDistanceLocation=[];this.computeContainmentDistance();if(this.minDistance<=this.terminateDistance)
return;this.computeFacetDistance();};jsts.operation.distance.DistanceOp.prototype.computeContainmentDistance=function(){if(arguments.length===2){this.computeContainmentDistance2.apply(this,arguments);return;}else if(arguments.length===3&&(!arguments[0]instanceof jsts.operation.distance.GeometryLocation)){this.computeContainmentDistance3.apply(this,arguments);return;}else if(arguments.length===3){this.computeContainmentDistance4.apply(this,arguments);return;}
var locPtPoly=[];this.computeContainmentDistance2(0,locPtPoly);if(this.minDistance<=this.terminateDistance)
return;this.computeContainmentDistance2(1,locPtPoly);};jsts.operation.distance.DistanceOp.prototype.computeContainmentDistance2=function(polyGeomIndex,locPtPoly){var locationsIndex=1-polyGeomIndex;var polys=jsts.geom.util.PolygonExtracter.getPolygons(this.geom[polyGeomIndex]);if(polys.length>0){var insideLocs=jsts.operation.distance.ConnectedElementLocationFilter.getLocations(this.geom[locationsIndex]);this.computeContainmentDistance3(insideLocs,polys,locPtPoly);if(this.minDistance<=this.terminateDistance){this.minDistanceLocation[locationsIndex]=locPtPoly[0];this.minDistanceLocation[polyGeomIndex]=locPtPoly[1];return;}}};jsts.operation.distance.DistanceOp.prototype.computeContainmentDistance3=function(locs,polys,locPtPoly){for(var i=0;i<locs.length;i++){var loc=locs[i];for(var j=0;j<polys.length;j++){this.computeContainmentDistance4(loc,polys[j],locPtPoly);if(this.minDistance<=this.terminateDistance)
return;}}};jsts.operation.distance.DistanceOp.prototype.computeContainmentDistance4=function(ptLoc,poly,locPtPoly){var pt=ptLoc.getCoordinate();if(jsts.geom.Location.EXTERIOR!==this.ptLocator.locate(pt,poly)){this.minDistance=0.0;locPtPoly[0]=ptLoc;locPtPoly[1]=new jsts.operation.distance.GeometryLocation(poly,pt);return;}};jsts.operation.distance.DistanceOp.prototype.computeFacetDistance=function(){var locGeom=[];var lines0=jsts.geom.util.LinearComponentExtracter.getLines(this.geom[0]);var lines1=jsts.geom.util.LinearComponentExtracter.getLines(this.geom[1]);var pts0=jsts.geom.util.PointExtracter.getPoints(this.geom[0]);var pts1=jsts.geom.util.PointExtracter.getPoints(this.geom[1]);this.computeMinDistanceLines(lines0,lines1,locGeom);this.updateMinDistance(locGeom,false);if(this.minDistance<=this.terminateDistance)
return;locGeom[0]=null;locGeom[1]=null;this.computeMinDistanceLinesPoints(lines0,pts1,locGeom);this.updateMinDistance(locGeom,false);if(this.minDistance<=this.terminateDistance)
return;locGeom[0]=null;locGeom[1]=null;this.computeMinDistanceLinesPoints(lines1,pts0,locGeom);this.updateMinDistance(locGeom,true);if(this.minDistance<=this.terminateDistance)
return;locGeom[0]=null;locGeom[1]=null;this.computeMinDistancePoints(pts0,pts1,locGeom);this.updateMinDistance(locGeom,false);};jsts.operation.distance.DistanceOp.prototype.computeMinDistanceLines=function(lines0,lines1,locGeom){for(var i=0;i<lines0.length;i++){var line0=lines0[i];for(var j=0;j<lines1.length;j++){var line1=lines1[j];this.computeMinDistance(line0,line1,locGeom);if(this.minDistance<=this.terminateDistance)
return;}}};jsts.operation.distance.DistanceOp.prototype.computeMinDistancePoints=function(points0,points1,locGeom){for(var i=0;i<points0.length;i++){var pt0=points0[i];for(var j=0;j<points1.length;j++){var pt1=points1[j];var dist=pt0.getCoordinate().distance(pt1.getCoordinate());if(dist<this.minDistance){this.minDistance=dist;locGeom[0]=new jsts.operation.distance.GeometryLocation(pt0,0,pt0.getCoordinate());locGeom[1]=new jsts.operation.distance.GeometryLocation(pt1,0,pt1.getCoordinate());}
if(this.minDistance<=this.terminateDistance)
return;}}};jsts.operation.distance.DistanceOp.prototype.computeMinDistanceLinesPoints=function(lines,points,locGeom){for(var i=0;i<lines.length;i++){var line=lines[i];for(var j=0;j<points.length;j++){var pt=points[j];this.computeMinDistance(line,pt,locGeom);if(this.minDistance<=this.terminateDistance)
return;}}};jsts.operation.distance.DistanceOp.prototype.computeMinDistance2=function(line0,line1,locGeom){if(line1 instanceof jsts.geom.Point){this.computeMinDistance3(line0,line1,locGeom);return;}
if(line0.getEnvelopeInternal().distance(line1.getEnvelopeInternal())>this.minDistance){return;}
var coord0=line0.getCoordinates();var coord1=line1.getCoordinates();for(var i=0;i<coord0.length-1;i++){for(var j=0;j<coord1.length-1;j++){var dist=jsts.algorithm.CGAlgorithms.distanceLineLine(coord0[i],coord0[i+1],coord1[j],coord1[j+1]);if(dist<this.minDistance){this.minDistance=dist;var seg0=new jsts.geom.LineSegment(coord0[i],coord0[i+1]);var seg1=new jsts.geom.LineSegment(coord1[j],coord1[j+1]);var closestPt=seg0.closestPoints(seg1);locGeom[0]=new jsts.operation.distance.GeometryLocation(line0,i,closestPt[0]);locGeom[1]=new jsts.operation.distance.GeometryLocation(line1,j,closestPt[1]);}
if(this.minDistance<=this.terminateDistance){return;}}}};jsts.operation.distance.DistanceOp.prototype.computeMinDistance3=function(line,pt,locGeom){if(line.getEnvelopeInternal().distance(pt.getEnvelopeInternal())>this.minDistance){return;}
var coord0=line.getCoordinates();var coord=pt.getCoordinate();for(var i=0;i<coord0.length-1;i++){var dist=jsts.algorithm.CGAlgorithms.distancePointLine(coord,coord0[i],coord0[i+1]);if(dist<this.minDistance){this.minDistance=dist;var seg=new jsts.geom.LineSegment(coord0[i],coord0[i+1]);var segClosestPoint=seg.closestPoint(coord);locGeom[0]=new jsts.operation.distance.GeometryLocation(line,i,segClosestPoint);locGeom[1]=new jsts.operation.distance.GeometryLocation(pt,0,coord);}
if(this.minDistance<=this.terminateDistance){return;}}};jsts.index.strtree.SIRtree=function(nodeCapacity){nodeCapacity=nodeCapacity||10;jsts.index.strtree.AbstractSTRtree.call(this,nodeCapacity);};jsts.index.strtree.SIRtree.prototype=new jsts.index.strtree.AbstractSTRtree();jsts.index.strtree.SIRtree.constructor=jsts.index.strtree.SIRtree;jsts.index.strtree.SIRtree.prototype.comperator={compare:function(o1,o2){return o1.getBounds().getCentre()-o2.getBounds().getCentre();}};jsts.index.strtree.SIRtree.prototype.intersectionOp={intersects:function(aBounds,bBounds){return aBounds.intersects(bBounds);}};jsts.index.strtree.SIRtree.prototype.createNode=function(level){var AbstractNode=function(level){jsts.index.strtree.AbstractNode.apply(this,arguments);};AbstractNode.prototype=new jsts.index.strtree.AbstractNode();AbstractNode.constructor=AbstractNode;AbstractNode.prototype.computeBounds=function(){var bounds=null,childBoundables=this.getChildBoundables(),childBoundable;for(var i=0,l=childBoundables.length;i<l;i++){childBoundable=childBoundables[i];if(bounds===null){bounds=new jsts.index.strtree.Interval(childBoundable.getBounds());}
else{bounds.expandToInclude(childBoundable.getBounds());}}
return bounds;};return AbstractNode;};jsts.index.strtree.SIRtree.prototype.insert=function(x1,x2,item){jsts.index.strtree.AbstractSTRtree.prototype.insert(new jsts.index.strtree.Interval(Math.min(x1,x2),Math.max(x1,x2)),item);};jsts.index.strtree.SIRtree.prototype.query=function(x1,x2){x2=x2||x1;jsts.index.strtree.AbstractSTRtree.prototype.query(new jsts.index.strtree.Interval(Math.min(x1,x2),Math.max(x1,x2)));};jsts.index.strtree.SIRtree.prototype.getIntersectsOp=function(){return this.intersectionOp;};jsts.index.strtree.SIRtree.prototype.getComparator=function(){return this.comperator;};jsts.simplify.DouglasPeuckerSimplifier=function(inputGeom){this.inputGeom=inputGeom;this.isEnsureValidTopology=true;};jsts.simplify.DouglasPeuckerSimplifier.prototype.inputGeom=null;jsts.simplify.DouglasPeuckerSimplifier.prototype.distanceTolerance=null;jsts.simplify.DouglasPeuckerSimplifier.prototype.isEnsureValidTopology=null;jsts.simplify.DouglasPeuckerSimplifier.simplify=function(geom,distanceTolerance){var tss=new jsts.simplify.DouglasPeuckerSimplifier(geom);tss.setDistanceTolerance(distanceTolerance);return tss.getResultGeometry();};jsts.simplify.DouglasPeuckerSimplifier.prototype.setDistanceTolerance=function(distanceTolerance){if(distanceTolerance<0.0){throw"Tolerance must be non-negative";}
this.distanceTolerance=distanceTolerance;};jsts.simplify.DouglasPeuckerSimplifier.prototype.setEnsureValid=function(isEnsureValidTopology){this.isEnsureValidTopology=isEnsureValidTopology;};jsts.simplify.DouglasPeuckerSimplifier.prototype.getResultGeometry=function(){if(this.inputGeom.isEmpty()){return this.inputGeom.clone();}
return(new jsts.simplify.DPTransformer(this.distanceTolerance,this.isEnsureValidTopology)).transform(this.inputGeom);};(function(){jsts.operation.predicate.RectangleContains=function(rectangle){this.rectEnv=rectangle.getEnvelopeInternal();}
jsts.operation.predicate.RectangleContains.contains=function(rectangle,b){var rc=new jsts.operation.predicate.RectangleContains(rectangle);return rc.contains(b);}
jsts.operation.predicate.RectangleContains.prototype.rectEnv=null;jsts.operation.predicate.RectangleContains.prototype.contains=function(geom){if(!this.rectEnv.contains(geom.getEnvelopeInternal()))
return false;if(this.isContainedInBoundary(geom))
return false;return true;}
jsts.operation.predicate.RectangleContains.prototype.isContainedInBoundary=function(geom){if(geom instanceof jsts.geom.Polygon)return false;if(geom instanceof jsts.geom.Point)return this.isPointContainedInBoundary(geom.getCoordinate());if(geom instanceof jsts.geom.LineString)return this.isLineStringContainedInBoundary(geom);for(var i=0;i<geom.getNumGeometries();i++){var comp=geom.getGeometryN(i);if(!this.isContainedInBoundary(comp))
return false;}
return true;}
jsts.operation.predicate.RectangleContains.prototype.isPointContainedInBoundary=function(pt){return pt.x==this.rectEnv.getMinX()||pt.x==this.rectEnv.getMaxX()||pt.y==this.rectEnv.getMinY()||pt.y==this.rectEnv.getMaxY();}
jsts.operation.predicate.RectangleContains.prototype.isLineStringContainedInBoundary=function(line){var seq=line.getCoordinateSequence();for(var i=0;i<seq.length-1;i++){var p0=seq[i];var p1=seq[i+1];if(!this.isLineSegmentContainedInBoundary(p0,p1))
return false;}
return true;}
jsts.operation.predicate.RectangleContains.prototype.isLineSegmentContainedInBoundary=function(p0,p1){if(p0.equals(p1))
return this.isPointContainedInBoundary(p0);if(p0.x==p1.x){if(p0.x==this.rectEnv.getMinX()||p0.x==this.rectEnv.getMaxX())
return true;}
else if(p0.y==p1.y){if(p0.y==this.rectEnv.getMinY()||p0.y==this.rectEnv.getMaxY())
return true;}
return false;}})();(function(){var Location=jsts.geom.Location;var Position=jsts.geomgraph.Position;jsts.geomgraph.Depth=function(){this.depth=[[],[]];for(var i=0;i<2;i++){for(var j=0;j<3;j++){this.depth[i][j]=jsts.geomgraph.Depth.NULL_VALUE;}}};jsts.geomgraph.Depth.NULL_VALUE=-1;jsts.geomgraph.Depth.depthAtLocation=function(location){if(location===Location.EXTERIOR)
return 0;if(location===Location.INTERIOR)
return 1;return jsts.geomgraph.Depth.NULL_VALUE;};jsts.geomgraph.Depth.prototype.depth=null;jsts.geomgraph.Depth.prototype.getDepth=function(geomIndex,posIndex){return this.depth[geomIndex][posIndex];};jsts.geomgraph.Depth.prototype.setDepth=function(geomIndex,posIndex,depthValue){this.depth[geomIndex][posIndex]=depthValue;};jsts.geomgraph.Depth.prototype.getLocation=function(geomIndex,posIndex){if(this.depth[geomIndex][posIndex]<=0)
return Location.EXTERIOR;return Location.INTERIOR;};jsts.geomgraph.Depth.prototype.add=function(geomIndex,posIndex,location){if(location===Location.INTERIOR)
this.depth[geomIndex][posIndex]++;};jsts.geomgraph.Depth.prototype.isNull=function(){if(arguments.length>0){return this.isNull2.apply(this,arguments);}
for(var i=0;i<2;i++){for(var j=0;j<3;j++){if(this.depth[i][j]!==jsts.geomgraph.Depth.NULL_VALUE)
return false;}}
return true;};jsts.geomgraph.Depth.prototype.isNull2=function(geomIndex){if(arguments.length>1){return this.isNull3.apply(this,arguments);}
return this.depth[geomIndex][1]==jsts.geomgraph.Depth.NULL_VALUE;};jsts.geomgraph.Depth.prototype.isNull3=function(geomIndex,posIndex){return this.depth[geomIndex][posIndex]==jsts.geomgraph.Depth.NULL_VALUE;};jsts.geomgraph.Depth.prototype.add=function(lbl){for(var i=0;i<2;i++){for(var j=1;j<3;j++){var loc=lbl.getLocation(i,j);if(loc===Location.EXTERIOR||loc===Location.INTERIOR){if(this.isNull(i,j)){this.depth[i][j]=jsts.geomgraph.Depth.depthAtLocation(loc);}else
this.depth[i][j]+=jsts.geomgraph.Depth.depthAtLocation(loc);}}}};jsts.geomgraph.Depth.prototype.getDelta=function(geomIndex){return this.depth[geomIndex][Position.RIGHT]-
this.depth[geomIndex][Position.LEFT];};jsts.geomgraph.Depth.prototype.normalize=function(){for(var i=0;i<2;i++){if(!this.isNull(i)){var minDepth=this.depth[i][1];if(this.depth[i][2]<minDepth)
minDepth=this.depth[i][2];if(minDepth<0)
minDepth=0;for(var j=1;j<3;j++){var newValue=0;if(this.depth[i][j]>minDepth)
newValue=1;this.depth[i][j]=newValue;}}}};jsts.geomgraph.Depth.prototype.toString=function(){return'A: '+this.depth[0][1]+','+this.depth[0][2]+' B: '+
this.depth[1][1]+','+this.depth[1][2];};})();jsts.algorithm.BoundaryNodeRule=function(){};jsts.algorithm.BoundaryNodeRule.prototype.isInBoundary=function(boundaryCount){throw new jsts.error.AbstractMethodInvocationError();};jsts.algorithm.Mod2BoundaryNodeRule=function(){};jsts.algorithm.Mod2BoundaryNodeRule.prototype=new jsts.algorithm.BoundaryNodeRule();jsts.algorithm.Mod2BoundaryNodeRule.prototype.isInBoundary=function(boundaryCount){return boundaryCount%2===1;};jsts.algorithm.BoundaryNodeRule.MOD2_BOUNDARY_RULE=new jsts.algorithm.Mod2BoundaryNodeRule();jsts.algorithm.BoundaryNodeRule.OGC_SFS_BOUNDARY_RULE=jsts.algorithm.BoundaryNodeRule.MOD2_BOUNDARY_RULE;jsts.operation.distance.GeometryLocation=function(component,segIndex,pt){this.component=component;this.segIndex=segIndex;this.pt=pt;};jsts.operation.distance.GeometryLocation.INSIDE_AREA=-1;jsts.operation.distance.GeometryLocation.prototype.component=null;jsts.operation.distance.GeometryLocation.prototype.segIndex=null;jsts.operation.distance.GeometryLocation.prototype.pt=null;jsts.operation.distance.GeometryLocation.prototype.getGeometryComponent=function(){return this.component;};jsts.operation.distance.GeometryLocation.prototype.getSegmentIndex=function(){return this.segIndex;};jsts.operation.distance.GeometryLocation.prototype.getCoordinate=function(){return this.pt;};jsts.operation.distance.GeometryLocation.prototype.isInsideArea=function(){return this.segIndex===jsts.operation.distance.GeometryLocation.INSIDE_AREA;};jsts.geom.util.PointExtracter=function(pts){this.pts=pts;};jsts.geom.util.PointExtracter.prototype=new jsts.geom.GeometryFilter();jsts.geom.util.PointExtracter.prototype.pts=null;jsts.geom.util.PointExtracter.getPoints=function(geom,list){if(list===undefined){list=[];}
if(geom instanceof jsts.geom.Point){list.push(geom);}else if(geom instanceof jsts.geom.GeometryCollection||geom instanceof jsts.geom.MultiPoint||geom instanceof jsts.geom.MultiLineString||geom instanceof jsts.geom.MultiPolygon){geom.apply(new jsts.geom.util.PointExtracter(list));}
return list;};jsts.geom.util.PointExtracter.prototype.filter=function(geom){if(geom instanceof jsts.geom.Point)
this.pts.push(geom);};(function(){var Location=jsts.geom.Location;jsts.operation.relate.RelateNodeGraph=function(){this.nodes=new jsts.geomgraph.NodeMap(new jsts.operation.relate.RelateNodeFactory());};jsts.operation.relate.RelateNodeGraph.prototype.nodes=null;jsts.operation.relate.RelateNodeGraph.prototype.build=function(geomGraph){this.computeIntersectionNodes(geomGraph,0);this.copyNodesAndLabels(geomGraph,0);var eeBuilder=new jsts.operation.relate.EdgeEndBuilder();var eeList=eeBuilder.computeEdgeEnds(geomGraph.getEdgeIterator());this.insertEdgeEnds(eeList);};jsts.operation.relate.RelateNodeGraph.prototype.computeIntersectionNodes=function(geomGraph,argIndex){for(var edgeIt=geomGraph.getEdgeIterator();edgeIt.hasNext();){var e=edgeIt.next();var eLoc=e.getLabel().getLocation(argIndex);for(var eiIt=e.getEdgeIntersectionList().iterator();eiIt.hasNext();){var ei=eiIt.next();var n=this.nodes.addNode(ei.coord);if(eLoc===Location.BOUNDARY)
n.setLabelBoundary(argIndex);else{if(n.getLabel().isNull(argIndex))
n.setLabel(argIndex,Location.INTERIOR);}}}};jsts.operation.relate.RelateNodeGraph.prototype.copyNodesAndLabels=function(geomGraph,argIndex){for(var nodeIt=geomGraph.getNodeIterator();nodeIt.hasNext();){var graphNode=nodeIt.next();var newNode=this.nodes.addNode(graphNode.getCoordinate());newNode.setLabel(argIndex,graphNode.getLabel().getLocation(argIndex));}};jsts.operation.relate.RelateNodeGraph.prototype.insertEdgeEnds=function(ee){for(var i=ee.iterator();i.hasNext();){var e=i.next();this.nodes.add(e);}};jsts.operation.relate.RelateNodeGraph.prototype.getNodeIterator=function(){return this.nodes.iterator();};})();jsts.geomgraph.index.SimpleSweepLineIntersector=function(){};jsts.geomgraph.index.SimpleSweepLineIntersector.prototype=new jsts.geomgraph.index.EdgeSetIntersector();jsts.geomgraph.index.SimpleSweepLineIntersector.prototype.events=[];jsts.geomgraph.index.SimpleSweepLineIntersector.prototype.nOverlaps=null;jsts.geomgraph.index.SimpleSweepLineIntersector.prototype.computeIntersections=function(edges,si,testAllSegments){if(si instanceof javascript.util.List){this.computeIntersections2.apply(this,arguments);return;}
if(testAllSegments){this.add(edges,null);}else{this.add(edges);}
this.computeIntersections3(si);};jsts.geomgraph.index.SimpleSweepLineIntersector.prototype.computeIntersections2=function(edges0,edges1,si){this.add(edges0,edges0);this.add(edges1,edges1);this.computeIntersections3(si);};jsts.geomgraph.index.SimpleSweepLineIntersector.prototype.add=function(edge,edgeSet){if(edge instanceof javascript.util.List){this.add2.apply(this,arguments);return;}
var pts=edge.getCoordinates();for(var i=0;i<pts.length-1;i++){var ss=new jsts.geomgraph.index.SweepLineSegment(edge,i);var insertEvent=new jsts.geomgraph.index.SweepLineEvent(ss.getMinX(),ss,edgeSet);this.events.push(insertEvent);this.events.push(new jsts.geomgraph.index.SweepLineEvent(ss.getMaxX(),insertEvent));}};jsts.geomgraph.index.SimpleSweepLineIntersector.prototype.add2=function(edges,edgeSet){for(var i=edges.iterator();i.hasNext();){var edge=i.next();if(edgeSet){this.add(edge,edgeSet);}else{this.add(edge,edge);}}};jsts.geomgraph.index.SimpleSweepLineIntersector.prototype.prepareEvents=function(){this.events.sort(function(a,b){return a.compareTo(b);});for(var i=0;i<this.events.length;i++){var ev=this.events[i];if(ev.isDelete()){ev.getInsertEvent().setDeleteEventIndex(i);}}};jsts.geomgraph.index.SimpleSweepLineIntersector.prototype.computeIntersections3=function(si){this.nOverlaps=0;this.prepareEvents();for(var i=0;i<this.events.length;i++){var ev=this.events[i];if(ev.isInsert()){this.processOverlaps(i,ev.getDeleteEventIndex(),ev,si);}}};jsts.geomgraph.index.SimpleSweepLineIntersector.prototype.processOverlaps=function(start,end,ev0,si){var ss0=ev0.getObject();for(var i=start;i<end;i++){var ev1=this.events[i];if(ev1.isInsert()){var ss1=ev1.getObject();if(!ev0.isSameLabel(ev1)){ss0.computeIntersections(ss1,si);this.nOverlaps++;}}}}
jsts.triangulate.VoronoiDiagramBuilder=function(){this.siteCoords=null;this.tolerance=0.0;this.subdiv=null;this.clipEnv=null;this.diagramEnv=null;};jsts.triangulate.VoronoiDiagramBuilder.prototype.setSites=function(){var arg=arguments[0];if(arg instanceof jsts.geom.Geometry||arg instanceof jsts.geom.Coordinate||arg instanceof jsts.geom.Point||arg instanceof jsts.geom.MultiPoint||arg instanceof jsts.geom.LineString||arg instanceof jsts.geom.MultiLineString||arg instanceof jsts.geom.LinearRing||arg instanceof jsts.geom.Polygon||arg instanceof jsts.geom.MultiPolygon){this.setSitesByGeometry(arg);}else{this.setSitesByArray(arg);}};jsts.triangulate.VoronoiDiagramBuilder.prototype.setSitesByGeometry=function(geom){this.siteCoords=jsts.triangulate.DelaunayTriangulationBuilder.extractUniqueCoordinates(geom);};jsts.triangulate.VoronoiDiagramBuilder.prototype.setSitesByArray=function(coords){this.siteCoords=jsts.triangulate.DelaunayTriangulationBuilder.unique(coords);};jsts.triangulate.VoronoiDiagramBuilder.prototype.setClipEnvelope=function(clipEnv){this.clipEnv=clipEnv;};jsts.triangulate.VoronoiDiagramBuilder.prototype.setTolerance=function(tolerance)
{this.tolerance=tolerance;};jsts.triangulate.VoronoiDiagramBuilder.prototype.create=function(){if(this.subdiv!==null){return;}
var siteEnv,expandBy,vertices,triangulator;siteEnv=jsts.triangulate.DelaunayTriangulationBuilder.envelope(this.siteCoords);this.diagramEnv=siteEnv;expandBy=Math.max(this.diagramEnv.getWidth(),this.diagramEnv.getHeight());this.diagramEnv.expandBy(expandBy);if(this.clipEnv!==null){this.diagramEnv.expandToInclude(this.clipEnv);}
vertices=jsts.triangulate.DelaunayTriangulationBuilder.toVertices(this.siteCoords);this.subdiv=new jsts.triangulate.quadedge.QuadEdgeSubdivision(siteEnv,this.tolerance);triangulator=new jsts.triangulate.IncrementalDelaunayTriangulator(this.subdiv);triangulator.insertSites(vertices);};jsts.triangulate.VoronoiDiagramBuilder.prototype.getSubdivision=function(){this.create();return this.subdiv;};jsts.triangulate.VoronoiDiagramBuilder.prototype.getDiagram=function(geomFact){this.create();var polys=this.subdiv.getVoronoiDiagram(geomFact);return this.clipGeometryCollection(polys,this.diagramEnv);};jsts.triangulate.VoronoiDiagramBuilder.prototype.clipGeometryCollection=function(geom,clipEnv){var clipPoly,clipped,i,il,g,result;clipPoly=geom.getFactory().toGeometry(clipEnv);clipped=[];i=0,il=geom.getNumGeometries();for(i;i<il;i++){g=geom.getGeometryN(i);result=null;if(clipEnv.contains(g.getEnvelopeInternal())){result=g;}
else if(clipEnv.intersects(g.getEnvelopeInternal())){result=clipPoly.intersection(g);}
if(result!==null&&!result.isEmpty()){clipped.push(result);}}
return geom.getFactory().createGeometryCollection(clipped);};jsts.operation.valid.IndexedNestedRingTester=function(graph){this.graph=graph;this.rings=new javascript.util.ArrayList();this.totalEnv=new jsts.geom.Envelope();this.index=null;this.nestedPt=null;};jsts.operation.valid.IndexedNestedRingTester.prototype.getNestedPoint=function(){return this.nestedPt;};jsts.operation.valid.IndexedNestedRingTester.prototype.add=function(ring){this.rings.add(ring);this.totalEnv.expandToInclude(ring.getEnvelopeInternal());};jsts.operation.valid.IndexedNestedRingTester.prototype.isNonNested=function(){this.buildIndex();for(var i=0;i<this.rings.size();i++){var innerRing=this.rings.get(i);var innerRingPts=innerRing.getCoordinates();var results=this.index.query(innerRing.getEnvelopeInternal());for(var j=0;j<results.length;j++){var searchRing=results[j];var searchRingPts=searchRing.getCoordinates();if(innerRing==searchRing){continue;}
if(!innerRing.getEnvelopeInternal().intersects(searchRing.getEnvelopeInternal())){continue;}
var innerRingPt=jsts.operation.valid.IsValidOp.findPtNotNode(innerRingPts,searchRing,this.graph);if(innerRingPt==null){continue;}
var isInside=jsts.algorithm.CGAlgorithms.isPointInRing(innerRingPt,searchRingPts);if(isInside){this.nestedPt=innerRingPt;return false;}}}
return true;};jsts.operation.valid.IndexedNestedRingTester.prototype.buildIndex=function(){this.index=new jsts.index.strtree.STRtree();for(var i=0;i<this.rings.size();i++){var ring=this.rings.get(i);var env=ring.getEnvelopeInternal();this.index.insert(env,ring);}};jsts.geomgraph.index.MonotoneChain=function(mce,chainIndex){this.mce=mce;this.chainIndex=chainIndex;};jsts.geomgraph.index.MonotoneChain.prototype.mce=null;jsts.geomgraph.index.MonotoneChain.prototype.chainIndex=null;jsts.geomgraph.index.MonotoneChain.prototype.computeIntersections=function(mc,si){this.mce.computeIntersectsForChain(this.chainIndex,mc.mce,mc.chainIndex,si);};jsts.noding.SegmentNode=function(segString,coord,segmentIndex,segmentOctant){this.segString=segString;this.coord=new jsts.geom.Coordinate(coord);this.segmentIndex=segmentIndex;this.segmentOctant=segmentOctant;this._isInterior=!coord.equals2D(segString.getCoordinate(segmentIndex));};jsts.noding.SegmentNode.prototype.segString=null;jsts.noding.SegmentNode.prototype.coord=null;jsts.noding.SegmentNode.prototype.segmentIndex=null;jsts.noding.SegmentNode.prototype.segmentOctant=null;jsts.noding.SegmentNode.prototype._isInterior=null;jsts.noding.SegmentNode.prototype.getCoordinate=function(){return this.coord;};jsts.noding.SegmentNode.prototype.isInterior=function(){return this._isInterior;};jsts.noding.SegmentNode.prototype.isEndPoint=function(maxSegmentIndex){if(this.segmentIndex===0&&!this._isInterior)return true;if(this.segmentIndex===this.maxSegmentIndex)return true;return false;};jsts.noding.SegmentNode.prototype.compareTo=function(obj){var other=obj;if(this.segmentIndex<other.segmentIndex)return-1;if(this.segmentIndex>other.segmentIndex)return 1;if(this.coord.equals2D(other.coord))return 0;return jsts.noding.SegmentPointComparator.compare(this.segmentOctant,this.coord,other.coord);};(function(){jsts.io.GeoJSONWriter=function(){this.parser=new jsts.io.GeoJSONParser(this.geometryFactory);};jsts.io.GeoJSONWriter.prototype.write=function(geometry){var geoJson=this.parser.write(geometry);return geoJson;};})();jsts.io.OpenLayersParser=function(geometryFactory){this.geometryFactory=geometryFactory||new jsts.geom.GeometryFactory();};jsts.io.OpenLayersParser.prototype.read=function(geometry){if(geometry.CLASS_NAME==='OpenLayers.Geometry.Point'){return this.convertFromPoint(geometry);}else if(geometry.CLASS_NAME==='OpenLayers.Geometry.LineString'){return this.convertFromLineString(geometry);}else if(geometry.CLASS_NAME==='OpenLayers.Geometry.LinearRing'){return this.convertFromLinearRing(geometry);}else if(geometry.CLASS_NAME==='OpenLayers.Geometry.Polygon'){return this.convertFromPolygon(geometry);}else if(geometry.CLASS_NAME==='OpenLayers.Geometry.MultiPoint'){return this.convertFromMultiPoint(geometry);}else if(geometry.CLASS_NAME==='OpenLayers.Geometry.MultiLineString'){return this.convertFromMultiLineString(geometry);}else if(geometry.CLASS_NAME==='OpenLayers.Geometry.MultiPolygon'){return this.convertFromMultiPolygon(geometry);}else if(geometry.CLASS_NAME==='OpenLayers.Geometry.Collection'){return this.convertFromCollection(geometry);}};jsts.io.OpenLayersParser.prototype.convertFromPoint=function(point){return this.geometryFactory.createPoint(new jsts.geom.Coordinate(point.x,point.y));};jsts.io.OpenLayersParser.prototype.convertFromLineString=function(lineString){var i;var coordinates=[];for(i=0;i<lineString.components.length;i++){coordinates.push(new jsts.geom.Coordinate(lineString.components[i].x,lineString.components[i].y));}
return this.geometryFactory.createLineString(coordinates);};jsts.io.OpenLayersParser.prototype.convertFromLinearRing=function(linearRing){var i;var coordinates=[];for(i=0;i<linearRing.components.length;i++){coordinates.push(new jsts.geom.Coordinate(linearRing.components[i].x,linearRing.components[i].y));}
return this.geometryFactory.createLinearRing(coordinates);};jsts.io.OpenLayersParser.prototype.convertFromPolygon=function(polygon){var i;var shell=null;var holes=[];for(i=0;i<polygon.components.length;i++){var linearRing=this.convertFromLinearRing(polygon.components[i]);if(i===0){shell=linearRing;}else{holes.push(linearRing);}}
return this.geometryFactory.createPolygon(shell,holes);};jsts.io.OpenLayersParser.prototype.convertFromMultiPoint=function(multiPoint){var i;var points=[];for(i=0;i<multiPoint.components.length;i++){points.push(this.convertFromPoint(multiPoint.components[i]));}
return this.geometryFactory.createMultiPoint(points);};jsts.io.OpenLayersParser.prototype.convertFromMultiLineString=function(multiLineString){var i;var lineStrings=[];for(i=0;i<multiLineString.components.length;i++){lineStrings.push(this.convertFromLineString(multiLineString.components[i]));}
return this.geometryFactory.createMultiLineString(lineStrings);};jsts.io.OpenLayersParser.prototype.convertFromMultiPolygon=function(multiPolygon){var i;var polygons=[];for(i=0;i<multiPolygon.components.length;i++){polygons.push(this.convertFromPolygon(multiPolygon.components[i]));}
return this.geometryFactory.createMultiPolygon(polygons);};jsts.io.OpenLayersParser.prototype.convertFromCollection=function(collection){var i;var geometries=[];for(i=0;i<collection.components.length;i++){geometries.push(this.read(collection.components[i]));}
return this.geometryFactory.createGeometryCollection(geometries);};jsts.io.OpenLayersParser.prototype.write=function(geometry){if(geometry.CLASS_NAME==='jsts.geom.Point'){return this.convertToPoint(geometry.coordinate);}else if(geometry.CLASS_NAME==='jsts.geom.LineString'){return this.convertToLineString(geometry);}else if(geometry.CLASS_NAME==='jsts.geom.LinearRing'){return this.convertToLinearRing(geometry);}else if(geometry.CLASS_NAME==='jsts.geom.Polygon'){return this.convertToPolygon(geometry);}else if(geometry.CLASS_NAME==='jsts.geom.MultiPoint'){return this.convertToMultiPoint(geometry);}else if(geometry.CLASS_NAME==='jsts.geom.MultiLineString'){return this.convertToMultiLineString(geometry);}else if(geometry.CLASS_NAME==='jsts.geom.MultiPolygon'){return this.convertToMultiPolygon(geometry);}else if(geometry.CLASS_NAME==='jsts.geom.GeometryCollection'){return this.convertToCollection(geometry);}};jsts.io.OpenLayersParser.prototype.convertToPoint=function(coordinate){return new OpenLayers.Geometry.Point(coordinate.x,coordinate.y);};jsts.io.OpenLayersParser.prototype.convertToLineString=function(lineString){var i;var points=[];for(i=0;i<lineString.points.length;i++){var coordinate=lineString.points[i];points.push(this.convertToPoint(coordinate));}
return new OpenLayers.Geometry.LineString(points);};jsts.io.OpenLayersParser.prototype.convertToLinearRing=function(linearRing){var i;var points=[];for(i=0;i<linearRing.points.length;i++){var coordinate=linearRing.points[i];points.push(this.convertToPoint(coordinate));}
return new OpenLayers.Geometry.LinearRing(points);};jsts.io.OpenLayersParser.prototype.convertToPolygon=function(polygon){var i;var rings=[];rings.push(this.convertToLinearRing(polygon.shell));for(i=0;i<polygon.holes.length;i++){var ring=polygon.holes[i];rings.push(this.convertToLinearRing(ring));}
return new OpenLayers.Geometry.Polygon(rings);};jsts.io.OpenLayersParser.prototype.convertToMultiPoint=function(multiPoint){var i;var points=[];for(i=0;i<multiPoint.geometries.length;i++){var coordinate=multiPoint.geometries[i].coordinate;points.push(new OpenLayers.Geometry.Point(coordinate.x,coordinate.y));}
return new OpenLayers.Geometry.MultiPoint(points);};jsts.io.OpenLayersParser.prototype.convertToMultiLineString=function(multiLineString){var i;var lineStrings=[];for(i=0;i<multiLineString.geometries.length;i++){lineStrings.push(this.convertToLineString(multiLineString.geometries[i]));}
return new OpenLayers.Geometry.MultiLineString(lineStrings);};jsts.io.OpenLayersParser.prototype.convertToMultiPolygon=function(multiPolygon){var i;var polygons=[];for(i=0;i<multiPolygon.geometries.length;i++){polygons.push(this.convertToPolygon(multiPolygon.geometries[i]));}
return new OpenLayers.Geometry.MultiPolygon(polygons);};jsts.io.OpenLayersParser.prototype.convertToCollection=function(geometryCollection){var i;var geometries=[];for(i=0;i<geometryCollection.geometries.length;i++){var geometry=geometryCollection.geometries[i];var geometryOpenLayers=this.write(geometry);geometries.push(geometryOpenLayers);}
return new OpenLayers.Geometry.Collection(geometries);};jsts.index.quadtree.Quadtree=function(){this.root=new jsts.index.quadtree.Root();this.minExtent=1.0;};jsts.index.quadtree.Quadtree.ensureExtent=function(itemEnv,minExtent){var minx,maxx,miny,maxy;minx=itemEnv.getMinX();maxx=itemEnv.getMaxX();miny=itemEnv.getMinY();maxy=itemEnv.getMaxY();if(minx!==maxx&&miny!==maxy){return itemEnv;}
if(minx===maxx){minx=minx-(minExtent/2.0);maxx=minx+(minExtent/2.0);}
if(miny===maxy){miny=miny-(minExtent/2.0);maxy=miny+(minExtent/2.0);}
return new jsts.geom.Envelope(minx,maxx,miny,maxy);};jsts.index.quadtree.Quadtree.prototype.depth=function(){return this.root.depth();};jsts.index.quadtree.Quadtree.prototype.size=function(){return this.root.size();};jsts.index.quadtree.Quadtree.prototype.insert=function(itemEnv,item){this.collectStats(itemEnv);var insertEnv=jsts.index.quadtree.Quadtree.ensureExtent(itemEnv,this.minExtent);this.root.insert(insertEnv,item);};jsts.index.quadtree.Quadtree.prototype.remove=function(itemEnv,item){var posEnv=jsts.index.quadtree.Quadtree.ensureExtent(itemEnv,this.minExtent);return this.root.remove(posEnv,item);};jsts.index.quadtree.Quadtree.prototype.query=function(){if(arguments.length===1){return jsts.index.quadtree.Quadtree.prototype.queryByEnvelope.apply(this,arguments);}else{jsts.index.quadtree.Quadtree.prototype.queryWithVisitor.apply(this,arguments);}};jsts.index.quadtree.Quadtree.prototype.queryByEnvelope=function(searchEnv){var visitor=new jsts.index.ArrayListVisitor();this.query(searchEnv,visitor);return visitor.getItems();};jsts.index.quadtree.Quadtree.prototype.queryWithVisitor=function(searchEnv,visitor){this.root.visit(searchEnv,visitor);};jsts.index.quadtree.Quadtree.prototype.queryAll=function(){var foundItems=[];foundItems=this.root.addAllItems(foundItems);return foundItems;};jsts.index.quadtree.Quadtree.prototype.collectStats=function(itemEnv){var delX=itemEnv.getWidth();if(delX<this.minExtent&&delX>0.0){this.minExtent=delX;}
var delY=itemEnv.getHeight();if(delY<this.minExtent&&delY>0.0){this.minExtent=delY;}};jsts.operation.relate.RelateNodeFactory=function(){};jsts.operation.relate.RelateNodeFactory.prototype=new jsts.geomgraph.NodeFactory();jsts.operation.relate.RelateNodeFactory.prototype.createNode=function(coord){return new jsts.operation.relate.RelateNode(coord,new jsts.operation.relate.EdgeEndBundleStar());};jsts.index.quadtree.Key=function(itemEnv){this.pt=new jsts.geom.Coordinate();this.level=0;this.env=null;this.computeKey(itemEnv);};jsts.index.quadtree.Key.computeQuadLevel=function(env){var dx,dy,dMax,level;dx=env.getWidth();dy=env.getHeight();dMax=dx>dy?dx:dy;level=jsts.index.DoubleBits.exponent(dMax)+1;return level;};jsts.index.quadtree.Key.prototype.getPoint=function(){return this.pt;};jsts.index.quadtree.Key.prototype.getLevel=function(){return this.level;};jsts.index.quadtree.Key.prototype.getEnvelope=function(){return this.env;};jsts.index.quadtree.Key.prototype.getCentre=function(){var x,y;x=(this.env.getMinX()+this.env.getMaxX())/2;y=(this.env.getMinY()+this.env.getMaxY())/2;return new jsts.geom.Coordinate(x,y);};jsts.index.quadtree.Key.prototype.computeKey=function(){if(arguments[0]instanceof jsts.geom.Envelope){this.computeKeyFromEnvelope(arguments[0]);}else{this.computeKeyFromLevel(arguments[0],arguments[1]);}};jsts.index.quadtree.Key.prototype.computeKeyFromEnvelope=function(env){this.level=jsts.index.quadtree.Key.computeQuadLevel(env);this.env=new jsts.geom.Envelope();this.computeKey(this.level,env);while(!this.env.contains(env)){this.level+=1;this.computeKey(this.level,env);}};jsts.index.quadtree.Key.prototype.computeKeyFromLevel=function(level,env){var quadSize=jsts.index.DoubleBits.powerOf2(level);this.pt.x=Math.floor(env.getMinX()/quadSize)*quadSize;this.pt.y=Math.floor(env.getMinY()/quadSize)*quadSize;this.env.init(this.pt.x,this.pt.x+quadSize,this.pt.y,this.pt.y+
quadSize);};jsts.geom.CoordinateArrays=function(){throw new jsts.error.AbstractMethodInvocationError();};jsts.geom.CoordinateArrays.copyDeep=function(){if(arguments.length===1){return jsts.geom.CoordinateArrays.copyDeep1(arguments[0]);}else if(arguments.length===5){jsts.geom.CoordinateArrays.copyDeep2(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4]);}};jsts.geom.CoordinateArrays.copyDeep1=function(coordinates){var copy=[];for(var i=0;i<coordinates.length;i++){copy[i]=new jsts.geom.Coordinate(coordinates[i]);}
return copy;};jsts.geom.CoordinateArrays.copyDeep2=function(src,srcStart,dest,destStart,length){for(var i=0;i<length;i++){dest[destStart+i]=new jsts.geom.Coordinate(src[srcStart+i]);}};jsts.geom.CoordinateArrays.removeRepeatedPoints=function(coord){var coordList;if(!this.hasRepeatedPoints(coord)){return coord;}
coordList=new jsts.geom.CoordinateList(coord,false);return coordList.toCoordinateArray();};jsts.geom.CoordinateArrays.hasRepeatedPoints=function(coord){var i;for(i=1;i<coord.length;i++){if(coord[i-1].equals(coord[i])){return true;}}
return false;};jsts.geom.CoordinateArrays.ptNotInList=function(testPts,pts){for(var i=0;i<testPts.length;i++){var testPt=testPts[i];if(jsts.geom.CoordinateArrays.indexOf(testPt,pts)<0)
return testPt;}
return null;};jsts.geom.CoordinateArrays.increasingDirection=function(pts){for(var i=0;i<parseInt(pts.length/2);i++){var j=pts.length-1-i;var comp=pts[i].compareTo(pts[j]);if(comp!=0)
return comp;}
return 1;};jsts.geom.CoordinateArrays.minCoordinate=function(coordinates){var minCoord=null;for(var i=0;i<coordinates.length;i++){if(minCoord===null||minCoord.compareTo(coordinates[i])>0){minCoord=coordinates[i];}}
return minCoord;};jsts.geom.CoordinateArrays.scroll=function(coordinates,firstCoordinate){var i=jsts.geom.CoordinateArrays.indexOf(firstCoordinate,coordinates);if(i<0)
return;var newCoordinates=coordinates.slice(i).concat(coordinates.slice(0,i));for(i=0;i<newCoordinates.length;i++){coordinates[i]=newCoordinates[i];}};jsts.geom.CoordinateArrays.indexOf=function(coordinate,coordinates){for(var i=0;i<coordinates.length;i++){if(coordinate.equals(coordinates[i])){return i;}}
return-1;};jsts.operation.overlay.MinimalEdgeRing=function(start,geometryFactory){jsts.geomgraph.EdgeRing.call(this,start,geometryFactory);};jsts.operation.overlay.MinimalEdgeRing.prototype=new jsts.geomgraph.EdgeRing();jsts.operation.overlay.MinimalEdgeRing.constructor=jsts.operation.overlay.MinimalEdgeRing;jsts.operation.overlay.MinimalEdgeRing.prototype.getNext=function(de){return de.getNextMin();};jsts.operation.overlay.MinimalEdgeRing.prototype.setEdgeRing=function(de,er){de.setMinEdgeRing(er);};jsts.triangulate.DelaunayTriangulationBuilder=function(){this.siteCoords=null;this.tolerance=0.0;this.subdiv=null;};jsts.triangulate.DelaunayTriangulationBuilder.extractUniqueCoordinates=function(geom){if(geom===undefined||geom===null){return new jsts.geom.CoordinateList([],false).toArray();}
var coords=geom.getCoordinates();return jsts.triangulate.DelaunayTriangulationBuilder.unique(coords);};jsts.triangulate.DelaunayTriangulationBuilder.unique=function(coords){coords.sort(function(a,b){return a.compareTo(b);});var coordList=new jsts.geom.CoordinateList(coords,false);return coordList.toArray();};jsts.triangulate.DelaunayTriangulationBuilder.toVertices=function(coords){var verts=new Array(coords.length),i=0,il=coords.length,coord;for(i;i<il;i++){coord=coords[i];verts[i]=new jsts.triangulate.quadedge.Vertex(coord);}
return verts;};jsts.triangulate.DelaunayTriangulationBuilder.envelope=function(coords){var env=new jsts.geom.Envelope(),i=0,il=coords.length;for(i;i<il;i++){env.expandToInclude(coords[i]);}
return env;};jsts.triangulate.DelaunayTriangulationBuilder.prototype.setSites=function(){var arg=arguments[0];if(arg instanceof jsts.geom.Geometry||arg instanceof jsts.geom.Coordinate||arg instanceof jsts.geom.Point||arg instanceof jsts.geom.MultiPoint||arg instanceof jsts.geom.LineString||arg instanceof jsts.geom.MultiLineString||arg instanceof jsts.geom.LinearRing||arg instanceof jsts.geom.Polygon||arg instanceof jsts.geom.MultiPolygon){this.setSitesFromGeometry(arg);}else{this.setSitesFromCollection(arg);}};jsts.triangulate.DelaunayTriangulationBuilder.prototype.setSitesFromGeometry=function(geom){this.siteCoords=jsts.triangulate.DelaunayTriangulationBuilder.extractUniqueCoordinates(geom);};jsts.triangulate.DelaunayTriangulationBuilder.prototype.setSitesFromCollection=function(coords){this.siteCoords=jsts.triangulate.DelaunayTriangulationBuilder.unique(coords);};jsts.triangulate.DelaunayTriangulationBuilder.prototype.setTolerance=function(tolerance){this.tolerance=tolerance;};jsts.triangulate.DelaunayTriangulationBuilder.prototype.create=function(){if(this.subdiv===null){var siteEnv,vertices,triangulator;siteEnv=jsts.triangulate.DelaunayTriangulationBuilder.envelope(this.siteCoords);vertices=jsts.triangulate.DelaunayTriangulationBuilder.toVertices(this.siteCoords);this.subdiv=new jsts.triangulate.quadedge.QuadEdgeSubdivision(siteEnv,this.tolerance);triangulator=new jsts.triangulate.IncrementalDelaunayTriangulator(this.subdiv);triangulator.insertSites(vertices);}};jsts.triangulate.DelaunayTriangulationBuilder.prototype.getSubdivision=function(){this.create();return this.subdiv;};jsts.triangulate.DelaunayTriangulationBuilder.prototype.getEdges=function(geomFact){this.create();return this.subdiv.getEdges(geomFact);};jsts.triangulate.DelaunayTriangulationBuilder.prototype.getTriangles=function(geomFact){this.create();return this.subdiv.getTriangles(geomFact);};jsts.algorithm.RayCrossingCounter=function(p){this.p=p;};jsts.algorithm.RayCrossingCounter.locatePointInRing=function(p,ring){var counter=new jsts.algorithm.RayCrossingCounter(p);for(var i=1;i<ring.length;i++){var p1=ring[i];var p2=ring[i-1];counter.countSegment(p1,p2);if(counter.isOnSegment())
return counter.getLocation();}
return counter.getLocation();};jsts.algorithm.RayCrossingCounter.prototype.p=null;jsts.algorithm.RayCrossingCounter.prototype.crossingCount=0;jsts.algorithm.RayCrossingCounter.prototype.isPointOnSegment=false;jsts.algorithm.RayCrossingCounter.prototype.countSegment=function(p1,p2){if(p1.x<this.p.x&&p2.x<this.p.x)
return;if(this.p.x==p2.x&&this.p.y===p2.y){this.isPointOnSegment=true;return;}
if(p1.y===this.p.y&&p2.y===this.p.y){var minx=p1.x;var maxx=p2.x;if(minx>maxx){minx=p2.x;maxx=p1.x;}
if(this.p.x>=minx&&this.p.x<=maxx){this.isPointOnSegment=true;}
return;}
if(((p1.y>this.p.y)&&(p2.y<=this.p.y))||((p2.y>this.p.y)&&(p1.y<=this.p.y))){var x1=p1.x-this.p.x;var y1=p1.y-this.p.y;var x2=p2.x-this.p.x;var y2=p2.y-this.p.y;var xIntSign=jsts.algorithm.RobustDeterminant.signOfDet2x2(x1,y1,x2,y2);if(xIntSign===0.0){this.isPointOnSegment=true;return;}
if(y2<y1)
xIntSign=-xIntSign;if(xIntSign>0.0){this.crossingCount++;}}};jsts.algorithm.RayCrossingCounter.prototype.isOnSegment=function(){return jsts.geom.isPointOnSegment;};jsts.algorithm.RayCrossingCounter.prototype.getLocation=function(){if(this.isPointOnSegment)
return jsts.geom.Location.BOUNDARY;if((this.crossingCount%2)===1){return jsts.geom.Location.INTERIOR;}
return jsts.geom.Location.EXTERIOR;};jsts.algorithm.RayCrossingCounter.prototype.isPointInPolygon=function(){return this.getLocation()!==jsts.geom.Location.EXTERIOR;};jsts.operation.BoundaryOp=function(geom,bnRule){this.geom=geom;this.geomFact=geom.getFactory();this.bnRule=bnRule||jsts.algorithm.BoundaryNodeRule.MOD2_BOUNDARY_RULE;};jsts.operation.BoundaryOp.prototype.geom=null;jsts.operation.BoundaryOp.prototype.geomFact=null;jsts.operation.BoundaryOp.prototype.bnRule=null;jsts.operation.BoundaryOp.prototype.getBoundary=function(){if(this.geom instanceof jsts.geom.LineString)return this.boundaryLineString(this.geom);if(this.geom instanceof jsts.geom.MultiLineString)return this.boundaryMultiLineString(this.geom);return this.geom.getBoundary();};jsts.operation.BoundaryOp.prototype.getEmptyMultiPoint=function(){return this.geomFact.createMultiPoint(null);};jsts.operation.BoundaryOp.prototype.boundaryMultiLineString=function(mLine){if(this.geom.isEmpty()){return this.getEmptyMultiPoint();}
var bdyPts=this.computeBoundaryCoordinates(mLine);if(bdyPts.length==1){return this.geomFact.createPoint(bdyPts[0]);}
return this.geomFact.createMultiPoint(bdyPts);};jsts.operation.BoundaryOp.prototype.endpoints=null;jsts.operation.BoundaryOp.prototype.computeBoundaryCoordinates=function(mLine){var i,line,endpoint,bdyPts=[];this.endpoints=[];for(i=0;i<mLine.getNumGeometries();i++){line=mLine.getGeometryN(i);if(line.getNumPoints()==0)
continue;this.addEndpoint(line.getCoordinateN(0));this.addEndpoint(line.getCoordinateN(line.getNumPoints()-1));}
for(i=0;i<this.endpoints.length;i++){endpoint=this.endpoints[i];if(this.bnRule.isInBoundary(endpoint.count)){bdyPts.push(endpoint.coordinate);}}
return bdyPts;};jsts.operation.BoundaryOp.prototype.addEndpoint=function(pt){var i,endpoint,found=false;for(i=0;i<this.endpoints.length;i++){endpoint=this.endpoints[i];if(endpoint.coordinate.equals(pt)){found=true;break;}}
if(!found){endpoint={};endpoint.coordinate=pt;endpoint.count=0;this.endpoints.push(endpoint);}
endpoint.count++;};jsts.operation.BoundaryOp.prototype.boundaryLineString=function(line){if(this.geom.isEmpty()){return this.getEmptyMultiPoint();}
if(line.isClosed()){var closedEndpointOnBoundary=this.bnRule.isInBoundary(2);if(closedEndpointOnBoundary){return line.getStartPoint();}
else{return this.geomFact.createMultiPoint(null);}}
return this.geomFact.createMultiPoint([line.getStartPoint(),line.getEndPoint()]);};jsts.operation.buffer.OffsetCurveSetBuilder=function(inputGeom,distance,curveBuilder){this.inputGeom=inputGeom;this.distance=distance;this.curveBuilder=curveBuilder;this.curveList=new javascript.util.ArrayList();};jsts.operation.buffer.OffsetCurveSetBuilder.prototype.inputGeom=null;jsts.operation.buffer.OffsetCurveSetBuilder.prototype.distance=null;jsts.operation.buffer.OffsetCurveSetBuilder.prototype.curveBuilder=null;jsts.operation.buffer.OffsetCurveSetBuilder.prototype.curveList=null;jsts.operation.buffer.OffsetCurveSetBuilder.prototype.getCurves=function(){this.add(this.inputGeom);return this.curveList;};jsts.operation.buffer.OffsetCurveSetBuilder.prototype.addCurve=function(coord,leftLoc,rightLoc){if(coord==null||coord.length<2)
return;var e=new jsts.noding.NodedSegmentString(coord,new jsts.geomgraph.Label(0,jsts.geom.Location.BOUNDARY,leftLoc,rightLoc));this.curveList.add(e);};jsts.operation.buffer.OffsetCurveSetBuilder.prototype.add=function(g){if(g.isEmpty())
return;if(g instanceof jsts.geom.Polygon)
this.addPolygon(g);else if(g instanceof jsts.geom.LineString)
this.addLineString(g);else if(g instanceof jsts.geom.Point)
this.addPoint(g);else if(g instanceof jsts.geom.MultiPoint)
this.addCollection(g);else if(g instanceof jsts.geom.MultiLineString)
this.addCollection(g);else if(g instanceof jsts.geom.MultiPolygon)
this.addCollection(g);else if(g instanceof jsts.geom.GeometryCollection)
this.addCollection(g);else
throw new jsts.error.IllegalArgumentError();};jsts.operation.buffer.OffsetCurveSetBuilder.prototype.addCollection=function(gc){for(var i=0;i<gc.getNumGeometries();i++){var g=gc.getGeometryN(i);this.add(g);}};jsts.operation.buffer.OffsetCurveSetBuilder.prototype.addPoint=function(p){if(this.distance<=0.0)
return;var coord=p.getCoordinates();var curve=this.curveBuilder.getLineCurve(coord,this.distance);this.addCurve(curve,jsts.geom.Location.EXTERIOR,jsts.geom.Location.INTERIOR);};jsts.operation.buffer.OffsetCurveSetBuilder.prototype.addLineString=function(line){if(this.distance<=0.0&&!this.curveBuilder.getBufferParameters().isSingleSided())
return;var coord=jsts.geom.CoordinateArrays.removeRepeatedPoints(line.getCoordinates());var curve=this.curveBuilder.getLineCurve(coord,this.distance);this.addCurve(curve,jsts.geom.Location.EXTERIOR,jsts.geom.Location.INTERIOR);};jsts.operation.buffer.OffsetCurveSetBuilder.prototype.addPolygon=function(p){var offsetDistance=this.distance;var offsetSide=jsts.geomgraph.Position.LEFT;if(this.distance<0.0){offsetDistance=-this.distance;offsetSide=jsts.geomgraph.Position.RIGHT;}
var shell=p.getExteriorRing();var shellCoord=jsts.geom.CoordinateArrays.removeRepeatedPoints(shell.getCoordinates());if(this.distance<0.0&&this.isErodedCompletely(shell,this.distance))
return;if(this.distance<=0.0&&shellCoord.length<3)
return;this.addPolygonRing(shellCoord,offsetDistance,offsetSide,jsts.geom.Location.EXTERIOR,jsts.geom.Location.INTERIOR);for(var i=0;i<p.getNumInteriorRing();i++){var hole=p.getInteriorRingN(i);var holeCoord=jsts.geom.CoordinateArrays.removeRepeatedPoints(hole.getCoordinates());if(this.distance>0.0&&this.isErodedCompletely(hole,-this.distance))
continue;this.addPolygonRing(holeCoord,offsetDistance,jsts.geomgraph.Position.opposite(offsetSide),jsts.geom.Location.INTERIOR,jsts.geom.Location.EXTERIOR);}};jsts.operation.buffer.OffsetCurveSetBuilder.prototype.addPolygonRing=function(coord,offsetDistance,side,cwLeftLoc,cwRightLoc){if(offsetDistance==0.0&&coord.length<jsts.geom.LinearRing.MINIMUM_VALID_SIZE)
return;var leftLoc=cwLeftLoc;var rightLoc=cwRightLoc;if(coord.length>=jsts.geom.LinearRing.MINIMUM_VALID_SIZE&&jsts.algorithm.CGAlgorithms.isCCW(coord)){leftLoc=cwRightLoc;rightLoc=cwLeftLoc;side=jsts.geomgraph.Position.opposite(side);}
var curve=this.curveBuilder.getRingCurve(coord,side,offsetDistance);this.addCurve(curve,leftLoc,rightLoc);};jsts.operation.buffer.OffsetCurveSetBuilder.prototype.isErodedCompletely=function(ring,bufferDistance){var ringCoord=ring.getCoordinates();var minDiam=0.0;if(ringCoord.length<4)
return bufferDistance<0;if(ringCoord.length==4)
return this.isTriangleErodedCompletely(ringCoord,bufferDistance);var env=ring.getEnvelopeInternal();var envMinDimension=Math.min(env.getHeight(),env.getWidth());if(bufferDistance<0.0&&2*Math.abs(bufferDistance)>envMinDimension)
return true;return false;};jsts.operation.buffer.OffsetCurveSetBuilder.prototype.isTriangleErodedCompletely=function(triangleCoord,bufferDistance){var tri=new jsts.geom.Triangle(triangleCoord[0],triangleCoord[1],triangleCoord[2]);var inCentre=tri.inCentre();var distToCentre=jsts.algorithm.CGAlgorithms.distancePointLine(inCentre,tri.p0,tri.p1);return distToCentre<Math.abs(bufferDistance);};jsts.operation.buffer.BufferSubgraph=function(){this.dirEdgeList=new javascript.util.ArrayList();this.nodes=new javascript.util.ArrayList();this.finder=new jsts.operation.buffer.RightmostEdgeFinder();};jsts.operation.buffer.BufferSubgraph.prototype.finder=null;jsts.operation.buffer.BufferSubgraph.prototype.dirEdgeList=null;jsts.operation.buffer.BufferSubgraph.prototype.nodes=null;jsts.operation.buffer.BufferSubgraph.prototype.rightMostCoord=null;jsts.operation.buffer.BufferSubgraph.prototype.env=null;jsts.operation.buffer.BufferSubgraph.prototype.getDirectedEdges=function(){return this.dirEdgeList;};jsts.operation.buffer.BufferSubgraph.prototype.getNodes=function(){return this.nodes;};jsts.operation.buffer.BufferSubgraph.prototype.getEnvelope=function(){if(this.env===null){var edgeEnv=new jsts.geom.Envelope();for(var it=this.dirEdgeList.iterator();it.hasNext();){var dirEdge=it.next();var pts=dirEdge.getEdge().getCoordinates();for(var j=0;j<pts.length-1;j++){edgeEnv.expandToInclude(pts[j]);}}
this.env=edgeEnv;}
return this.env;};jsts.operation.buffer.BufferSubgraph.prototype.getRightmostCoordinate=function(){return this.rightMostCoord;};jsts.operation.buffer.BufferSubgraph.prototype.create=function(node){this.addReachable(node);this.finder.findEdge(this.dirEdgeList);this.rightMostCoord=this.finder.getCoordinate();};jsts.operation.buffer.BufferSubgraph.prototype.addReachable=function(startNode){var nodeStack=[];nodeStack.push(startNode);while(nodeStack.length!==0){var node=nodeStack.pop();this.add(node,nodeStack);}};jsts.operation.buffer.BufferSubgraph.prototype.add=function(node,nodeStack){node.setVisited(true);this.nodes.add(node);for(var i=node.getEdges().iterator();i.hasNext();){var de=i.next();this.dirEdgeList.add(de);var sym=de.getSym();var symNode=sym.getNode();if(!symNode.isVisited())
nodeStack.push(symNode);}};jsts.operation.buffer.BufferSubgraph.prototype.clearVisitedEdges=function(){for(var it=this.dirEdgeList.iterator();it.hasNext();){var de=it.next();de.setVisited(false);}};jsts.operation.buffer.BufferSubgraph.prototype.computeDepth=function(outsideDepth){this.clearVisitedEdges();var de=this.finder.getEdge();var n=de.getNode();var label=de.getLabel();de.setEdgeDepths(jsts.geomgraph.Position.RIGHT,outsideDepth);this.copySymDepths(de);this.computeDepths(de);};jsts.operation.buffer.BufferSubgraph.prototype.computeDepths=function(startEdge){var nodesVisited=[];var nodeQueue=[];var startNode=startEdge.getNode();nodeQueue.push(startNode);nodesVisited.push(startNode);startEdge.setVisited(true);while(nodeQueue.length!==0){var n=nodeQueue.shift();nodesVisited.push(n);this.computeNodeDepth(n);for(var i=n.getEdges().iterator();i.hasNext();){var de=i.next();var sym=de.getSym();if(sym.isVisited())
continue;var adjNode=sym.getNode();if(nodesVisited.indexOf(adjNode)===-1){nodeQueue.push(adjNode);nodesVisited.push(adjNode);}}}};jsts.operation.buffer.BufferSubgraph.prototype.computeNodeDepth=function(n){var startEdge=null;for(var i=n.getEdges().iterator();i.hasNext();){var de=i.next();if(de.isVisited()||de.getSym().isVisited()){startEdge=de;break;}}
if(startEdge==null)
throw new jsts.error.TopologyError('unable to find edge to compute depths at '+n.getCoordinate());n.getEdges().computeDepths(startEdge);for(var i=n.getEdges().iterator();i.hasNext();){var de=i.next();de.setVisited(true);this.copySymDepths(de);}};jsts.operation.buffer.BufferSubgraph.prototype.copySymDepths=function(de){var sym=de.getSym();sym.setDepth(jsts.geomgraph.Position.LEFT,de.getDepth(jsts.geomgraph.Position.RIGHT));sym.setDepth(jsts.geomgraph.Position.RIGHT,de.getDepth(jsts.geomgraph.Position.LEFT));};jsts.operation.buffer.BufferSubgraph.prototype.findResultEdges=function(){for(var it=this.dirEdgeList.iterator();it.hasNext();){var de=it.next();if(de.getDepth(jsts.geomgraph.Position.RIGHT)>=1&&de.getDepth(jsts.geomgraph.Position.LEFT)<=0&&!de.isInteriorAreaEdge()){de.setInResult(true);}}};jsts.operation.buffer.BufferSubgraph.prototype.compareTo=function(o){var graph=o;if(this.rightMostCoord.x<graph.rightMostCoord.x){return-1;}
if(this.rightMostCoord.x>graph.rightMostCoord.x){return 1;}
return 0;};jsts.simplify.DPTransformer=function(distanceTolerance,isEnsureValidTopology){this.distanceTolerance=distanceTolerance;this.isEnsureValidTopology=isEnsureValidTopology;};jsts.simplify.DPTransformer.prototype=new jsts.geom.util.GeometryTransformer();jsts.simplify.DPTransformer.prototype.distanceTolerance=null;jsts.simplify.DPTransformer.prototype.isEnsureValidTopology=null;jsts.simplify.DPTransformer.prototype.transformCoordinates=function(coords,parent){var inputPts=coords;var newPts=null;if(inputPts.length==0){newPts=[];}else{newPts=jsts.simplify.DouglasPeuckerLineSimplifier.simplify(inputPts,this.distanceTolerance);}
return newPts;};jsts.simplify.DPTransformer.prototype.transformPolygon=function(geom,parent){if(geom.isEmpty()){return null;}
var rawGeom=jsts.geom.util.GeometryTransformer.prototype.transformPolygon.apply(this,arguments);if(parent instanceof jsts.geom.MultiPolygon){return rawGeom;}
return this.createValidArea(rawGeom);};jsts.simplify.DPTransformer.prototype.transformLinearRing=function(geom,parent){var removeDegenerateRings=parent instanceof jsts.geom.Polygon;var simpResult=jsts.geom.util.GeometryTransformer.prototype.transformLinearRing.apply(this,arguments);if(removeDegenerateRings&&!(simpResult instanceof jsts.geom.LinearRing)){return null;}
return simpResult;};jsts.simplify.DPTransformer.prototype.transformMultiPolygon=function(geom,parent){var rawGeom=jsts.geom.util.GeometryTransformer.prototype.transformMultiPolygon.apply(this,arguments);return this.createValidArea(rawGeom);};jsts.simplify.DPTransformer.prototype.createValidArea=function(rawAreaGeom){if(this.isEnsureValidTopology){return rawAreaGeom.buffer(0.0);}
return rawAreaGeom;};jsts.geom.util.GeometryExtracter=function(clz,comps){this.clz=clz;this.comps=comps;};jsts.geom.util.GeometryExtracter.prototype=new jsts.geom.GeometryFilter();jsts.geom.util.GeometryExtracter.prototype.clz=null;jsts.geom.util.GeometryExtracter.prototype.comps=null;jsts.geom.util.GeometryExtracter.extract=function(geom,clz,list){list=list||new javascript.util.ArrayList();if(geom instanceof clz){list.add(geom);}
else if(geom instanceof jsts.geom.GeometryCollection||geom instanceof jsts.geom.MultiPoint||geom instanceof jsts.geom.MultiLineString||geom instanceof jsts.geom.MultiPolygon){geom.apply(new jsts.geom.util.GeometryExtracter(clz,list));}
return list;};jsts.geom.util.GeometryExtracter.prototype.filter=function(geom){if(this.clz===null||geom instanceof this.clz){this.comps.add(geom);}};(function(){var OverlayOp=jsts.operation.overlay.OverlayOp;var SnapOverlayOp=jsts.operation.overlay.snap.SnapOverlayOp;var SnapIfNeededOverlayOp=function(g1,g2){this.geom=[];this.geom[0]=g1;this.geom[1]=g2;};SnapIfNeededOverlayOp.overlayOp=function(g0,g1,opCode){var op=new SnapIfNeededOverlayOp(g0,g1);return op.getResultGeometry(opCode);};SnapIfNeededOverlayOp.intersection=function(g0,g1){return overlayOp(g0,g1,OverlayOp.INTERSECTION);};SnapIfNeededOverlayOp.union=function(g0,g1){return overlayOp(g0,g1,OverlayOp.UNION);};SnapIfNeededOverlayOp.difference=function(g0,g1){return overlayOp(g0,g1,OverlayOp.DIFFERENCE);};SnapIfNeededOverlayOp.symDifference=function(g0,g1){return overlayOp(g0,g1,OverlayOp.SYMDIFFERENCE);};SnapIfNeededOverlayOp.prototype.geom=null;SnapIfNeededOverlayOp.prototype.getResultGeometry=function(opCode){var result=null;var isSuccess=false;var savedException=null;try{result=OverlayOp.overlayOp(this.geom[0],this.geom[1],opCode);var isValid=true;if(isValid)
isSuccess=true;}catch(ex){savedException=ex;}
if(!isSuccess){try{result=SnapOverlayOp.overlayOp(this.geom[0],this.geom[1],opCode);}catch(ex){throw savedException;}}
return result;};jsts.operation.overlay.snap.SnapIfNeededOverlayOp=SnapIfNeededOverlayOp;})();(function(){var GeometryExtracter=jsts.geom.util.GeometryExtracter;var CascadedPolygonUnion=jsts.operation.union.CascadedPolygonUnion;var PointGeometryUnion=jsts.operation.union.PointGeometryUnion;var OverlayOp=jsts.operation.overlay.OverlayOp;var SnapIfNeededOverlayOp=jsts.operation.overlay.snap.SnapIfNeededOverlayOp;var ArrayList=javascript.util.ArrayList;jsts.operation.union.UnaryUnionOp=function(geoms,geomFact){this.polygons=new ArrayList();this.lines=new ArrayList();this.points=new ArrayList();if(geomFact){this.geomFact=geomFact;}
this.extract(geoms);};jsts.operation.union.UnaryUnionOp.union=function(geoms,geomFact){var op=new jsts.operation.union.UnaryUnionOp(geoms,geomFact);return op.union();};jsts.operation.union.UnaryUnionOp.prototype.polygons=null;jsts.operation.union.UnaryUnionOp.prototype.lines=null;jsts.operation.union.UnaryUnionOp.prototype.points=null;jsts.operation.union.UnaryUnionOp.prototype.geomFact=null;jsts.operation.union.UnaryUnionOp.prototype.extract=function(geoms){if(geoms instanceof ArrayList){for(var i=geoms.iterator();i.hasNext();){var geom=i.next();this.extract(geom);}}else{if(this.geomFact===null){this.geomFact=geoms.getFactory();}
GeometryExtracter.extract(geoms,jsts.geom.Polygon,this.polygons);GeometryExtracter.extract(geoms,jsts.geom.LineString,this.lines);GeometryExtracter.extract(geoms,jsts.geom.Point,this.points);}};jsts.operation.union.UnaryUnionOp.prototype.union=function(){if(this.geomFact===null){return null;}
var unionPoints=null;if(this.points.size()>0){var ptGeom=this.geomFact.buildGeometry(this.points);unionPoints=this.unionNoOpt(ptGeom);}
var unionLines=null;if(this.lines.size()>0){var lineGeom=this.geomFact.buildGeometry(this.lines);unionLines=this.unionNoOpt(lineGeom);}
var unionPolygons=null;if(this.polygons.size()>0){unionPolygons=CascadedPolygonUnion.union(this.polygons);}
var unionLA=this.unionWithNull(unionLines,unionPolygons);var union=null;if(unionPoints===null){union=unionLA;}else if(unionLA===null){union=unionPoints;}else{union=PointGeometryUnion(unionPoints,unionLA);}
if(union===null){return this.geomFact.createGeometryCollection(null);}
return union;};jsts.operation.union.UnaryUnionOp.prototype.unionWithNull=function(g0,g1){if(g0===null&&g1===null){return null;}
if(g1===null){return g0;}
if(g0===null){return g1;}
return g0.union(g1);};jsts.operation.union.UnaryUnionOp.prototype.unionNoOpt=function(g0){var empty=this.geomFact.createPoint(null);return SnapIfNeededOverlayOp.overlayOp(g0,empty,OverlayOp.UNION);};}());jsts.index.kdtree.KdNode=function(){this.left=null;this.right=null;this.count=1;if(arguments.length===2){this.initializeFromCoordinate.apply(this,arguments[0],arguments[1]);}else if(arguments.length===3){this.initializeFromXY.apply(this,arguments[0],arguments[1],arguments[2]);}};jsts.index.kdtree.KdNode.prototype.initializeFromXY=function(x,y,data){this.p=new jsts.geom.Coordinate(x,y);this.data=data;};jsts.index.kdtree.KdNode.prototype.initializeFromCoordinate=function(p,data){this.p=p;this.data=data;};jsts.index.kdtree.KdNode.prototype.getX=function(){return this.p.x;};jsts.index.kdtree.KdNode.prototype.getY=function(){return this.p.y;};jsts.index.kdtree.KdNode.prototype.getCoordinate=function(){return this.p;};jsts.index.kdtree.KdNode.prototype.getData=function(){return this.data;};jsts.index.kdtree.KdNode.prototype.getLeft=function(){return this.left;};jsts.index.kdtree.KdNode.prototype.getRight=function(){return this.right;};jsts.index.kdtree.KdNode.prototype.increment=function(){this.count+=1;};jsts.index.kdtree.KdNode.prototype.getCount=function(){return this.count;};jsts.index.kdtree.KdNode.prototype.isRepeated=function(){return count>1;};jsts.index.kdtree.KdNode.prototype.setLeft=function(left){this.left=left;};jsts.index.kdtree.KdNode.prototype.setRight=function(right){this.right=right;};jsts.algorithm.InteriorPointPoint=function(geometry){this.minDistance=Number.MAX_VALUE;this.interiorPoint=null;this.centroid=geometry.getCentroid().getCoordinate();this.add(geometry);};jsts.algorithm.InteriorPointPoint.prototype.add=function(geometry){if(geometry instanceof jsts.geom.Point){this.addPoint(geometry.getCoordinate());}else if(geometry instanceof jsts.geom.GeometryCollection){for(var i=0;i<geometry.getNumGeometries();i++){this.add(geometry.getGeometryN(i));}}};jsts.algorithm.InteriorPointPoint.prototype.addPoint=function(point){var dist=point.distance(this.centroid);if(dist<this.minDistance){this.interiorPoint=new jsts.geom.Coordinate(point);this.minDistance=dist;}};jsts.algorithm.InteriorPointPoint.prototype.getInteriorPoint=function(){return this.interiorPoint;};(function(){jsts.geom.MultiLineString=function(geometries,factory){this.geometries=geometries||[];this.factory=factory;};jsts.geom.MultiLineString.prototype=new jsts.geom.GeometryCollection();jsts.geom.MultiLineString.constructor=jsts.geom.MultiLineString;jsts.geom.MultiLineString.prototype.getBoundary=function(){return(new jsts.operation.BoundaryOp(this)).getBoundary();};jsts.geom.MultiLineString.prototype.equalsExact=function(other,tolerance){if(!this.isEquivalentClass(other)){return false;}
return jsts.geom.GeometryCollection.prototype.equalsExact.call(this,other,tolerance);};jsts.geom.MultiLineString.prototype.CLASS_NAME='jsts.geom.MultiLineString';})();(function(){var Interval=jsts.index.bintree.Interval;var Root=jsts.index.bintree.Root;var Bintree=function(){this.root=new Root();this.minExtent=1.0;};Bintree.ensureExtent=function(itemInterval,minExtent){var min,max;min=itemInterval.getMin();max=itemInterval.getMax();if(min!==max){return itemInterval;}
if(min===max){min=min-(minExtent/2.0);max=min+(minExtent/2.0);}
return new Interval(min,max);};Bintree.prototype.depth=function(){if(this.root!==null){return this.root.depth();}
return 0;};Bintree.prototype.size=function(){if(this.root!==null){return this.root.size();}
return 0;};Bintree.prototype.nodeSize=function(){if(this.root!==null){return this.root.nodeSize();}
return 0;};Bintree.prototype.insert=function(itemInterval,item){this.collectStats(itemInterval);var insertInterval=Bintree.ensureExtent(itemInterval,this.minExtent);this.root.insert(insertInterval,item);};Bintree.prototype.remove=function(itemInterval,item){var insertInterval=Bintree.ensureExtent(itemInterval,this.minExtent);return this.root.remove(insertInterval,item);};Bintree.prototype.iterator=function(){var foundItems=new javascript.util.ArrayList();this.root.addAllItems(foundItems);return foundItems.iterator();};Bintree.prototype.query=function(){if(arguments.length===2){this.queryAndAdd(arguments[0],arguments[1]);}else{var x=arguments[0];if(!x instanceof Interval){x=new Interval(x,x);}
return this.queryInterval(x);}};Bintree.prototype.queryInterval=function(interval){var foundItems=new javascript.util.ArrayList();this.query(interval,foundItems);return foundItems;};Bintree.prototype.queryAndAdd=function(interval,foundItems){this.root.addAllItemsFromOverlapping(interval,foundItems);};Bintree.prototype.collectStats=function(interval){var del=interval.getWidth();if(del<this.minExtent&&del>0.0){this.minExtent=del;}};jsts.index.bintree.Bintree=Bintree;})();jsts.algorithm.InteriorPointArea=function(geometry){this.factory;this.interiorPoint=null;this.maxWidth=0;this.factory=geometry.getFactory();this.add(geometry);};jsts.algorithm.InteriorPointArea.avg=function(a,b){return(a+b)/2;};jsts.algorithm.InteriorPointArea.prototype.getInteriorPoint=function(){return this.interiorPoint;};jsts.algorithm.InteriorPointArea.prototype.add=function(geometry){if(geometry instanceof jsts.geom.Polygon){this.addPolygon(geometry);}else if(geometry instanceof jsts.geom.GeometryCollection){for(var i=0;i<geometry.getNumGeometries();i++){this.add(geometry.getGeometryN(i));}}};jsts.algorithm.InteriorPointArea.prototype.addPolygon=function(geometry){if(geometry.isEmpty()){return;}
var intPt;var width=0;var bisector=this.horizontalBisector(geometry);if(bisector.getLength()==0.0){width=0;intPt=bisector.getCoordinate();}else{var intersections=bisector.intersection(geometry);var widestIntersection=this.widestGeometry(intersections);width=widestIntersection.getEnvelopeInternal().getWidth();intPt=this.centre(widestIntersection.getEnvelopeInternal());}
if(this.interiorPoint==null||width>this.maxWidth){this.interiorPoint=intPt;this.maxWidth=width;}};jsts.algorithm.InteriorPointArea.prototype.widestGeometry=function(obj){if(obj instanceof jsts.geom.GeometryCollection){var gc=obj;if(gc.isEmpty()){return gc;}
var widestGeometry=gc.getGeometryN(0);for(var i=1;i<gc.getNumGeometries();i++){if(gc.getGeometryN(i).getEnvelopeInternal().getWidth()>widestGeometry.getEnvelopeInternal().getWidth()){widestGeometry=gc.getGeometryN(i);}}
return widestGeometry;}else if(obj instanceof jsts.geom.Geometry){return obj;}};jsts.algorithm.InteriorPointArea.prototype.horizontalBisector=function(geometry){var envelope=geometry.getEnvelopeInternal();var bisectY=jsts.algorithm.SafeBisectorFinder.getBisectorY(geometry);return this.factory.createLineString([new jsts.geom.Coordinate(envelope.getMinX(),bisectY),new jsts.geom.Coordinate(envelope.getMaxX(),bisectY)]);};jsts.algorithm.InteriorPointArea.prototype.centre=function(envelope){return new jsts.geom.Coordinate(jsts.algorithm.InteriorPointArea.avg(envelope.getMinX(),envelope.getMaxX()),jsts.algorithm.InteriorPointArea.avg(envelope.getMinY(),envelope.getMaxY()));};jsts.algorithm.SafeBisectorFinder=function(poly){this.poly;this.centreY;this.hiY=Number.MAX_VALUE;this.loY=-Number.MAX_VALUE;this.poly=poly;this.hiY=poly.getEnvelopeInternal().getMaxY();this.loY=poly.getEnvelopeInternal().getMinY();this.centreY=jsts.algorithm.InteriorPointArea.avg(this.loY,this.hiY);};jsts.algorithm.SafeBisectorFinder.getBisectorY=function(poly){var finder=new jsts.algorithm.SafeBisectorFinder(poly);return finder.getBisectorY();};jsts.algorithm.SafeBisectorFinder.prototype.getBisectorY=function(){this.process(this.poly.getExteriorRing());for(var i=0;i<this.poly.getNumInteriorRing();i++){this.process(this.poly.getInteriorRingN(i));}
var bisectY=jsts.algorithm.InteriorPointArea.avg(this.hiY,this.loY);return bisectY;};jsts.algorithm.SafeBisectorFinder.prototype.process=function(line){var seq=line.getCoordinateSequence();for(var i=0;i<seq.length;i++){var y=seq[i].y;this.updateInterval(y);}};jsts.algorithm.SafeBisectorFinder.prototype.updateInterval=function(y){if(y<=this.centreY){if(y>this.loY){this.loY=y;}}else if(y>this.centreY){if(y<this.hiY){this.hiY=y;}}};jsts.operation.buffer.BufferParameters=function(quadrantSegments,endCapStyle,joinStyle,mitreLimit){if(quadrantSegments)
this.setQuadrantSegments(quadrantSegments);if(endCapStyle)
this.setEndCapStyle(endCapStyle);if(joinStyle)
this.setJoinStyle(joinStyle);if(mitreLimit)
this.setMitreLimit(mitreLimit);};jsts.operation.buffer.BufferParameters.CAP_ROUND=1;jsts.operation.buffer.BufferParameters.CAP_FLAT=2;jsts.operation.buffer.BufferParameters.CAP_SQUARE=3;jsts.operation.buffer.BufferParameters.JOIN_ROUND=1;jsts.operation.buffer.BufferParameters.JOIN_MITRE=2;jsts.operation.buffer.BufferParameters.JOIN_BEVEL=3;jsts.operation.buffer.BufferParameters.DEFAULT_QUADRANT_SEGMENTS=8;jsts.operation.buffer.BufferParameters.DEFAULT_MITRE_LIMIT=5.0;jsts.operation.buffer.BufferParameters.prototype.quadrantSegments=jsts.operation.buffer.BufferParameters.DEFAULT_QUADRANT_SEGMENTS;jsts.operation.buffer.BufferParameters.prototype.endCapStyle=jsts.operation.buffer.BufferParameters.CAP_ROUND;jsts.operation.buffer.BufferParameters.prototype.joinStyle=jsts.operation.buffer.BufferParameters.JOIN_ROUND;jsts.operation.buffer.BufferParameters.prototype.mitreLimit=jsts.operation.buffer.BufferParameters.DEFAULT_MITRE_LIMIT;jsts.operation.buffer.BufferParameters.prototype._isSingleSided=false;jsts.operation.buffer.BufferParameters.prototype.getQuadrantSegments=function(){return this.quadrantSegments;};jsts.operation.buffer.BufferParameters.prototype.setQuadrantSegments=function(quadrantSegments){this.quadrantSegments=quadrantSegments;};jsts.operation.buffer.BufferParameters.prototype.setQuadrantSegments=function(quadSegs){this.quadrantSegments=quadSegs;if(this.quadrantSegments===0)
this.joinStyle=jsts.operation.buffer.BufferParameters.JOIN_BEVEL;if(this.quadrantSegments<0){this.joinStyle=jsts.operation.buffer.BufferParameters.JOIN_MITRE;this.mitreLimit=Math.abs(this.quadrantSegments);}
if(quadSegs<=0){this.quadrantSegments=1;}
if(this.joinStyle!==jsts.operation.buffer.BufferParameters.JOIN_ROUND){this.quadrantSegments=jsts.operation.buffer.BufferParameters.DEFAULT_QUADRANT_SEGMENTS;}};jsts.operation.buffer.BufferParameters.bufferDistanceError=function(quadSegs){var alpha=Math.PI/2.0/quadSegs;return 1-Math.cos(alpha/2.0);};jsts.operation.buffer.BufferParameters.prototype.getEndCapStyle=function(){return this.endCapStyle;};jsts.operation.buffer.BufferParameters.prototype.setEndCapStyle=function(endCapStyle){this.endCapStyle=endCapStyle;};jsts.operation.buffer.BufferParameters.prototype.getJoinStyle=function(){return this.joinStyle;};jsts.operation.buffer.BufferParameters.prototype.setJoinStyle=function(joinStyle){this.joinStyle=joinStyle;};jsts.operation.buffer.BufferParameters.prototype.getMitreLimit=function(){return this.mitreLimit;};jsts.operation.buffer.BufferParameters.prototype.setMitreLimit=function(mitreLimit){this.mitreLimit=mitreLimit;};jsts.operation.buffer.BufferParameters.prototype.setSingleSided=function(isSingleSided){this._isSingleSided=isSingleSided;};jsts.operation.buffer.BufferParameters.prototype.isSingleSided=function(){return this._isSingleSided;};(function(){jsts.geom.util.ShortCircuitedGeometryVisitor=function(){};jsts.geom.util.ShortCircuitedGeometryVisitor.prototype.isDone=false;jsts.geom.util.ShortCircuitedGeometryVisitor.prototype.applyTo=function(geom){for(var i=0;i<geom.getNumGeometries()&&!this.isDone;i++){var element=geom.getGeometryN(i);if(!(element instanceof jsts.geom.GeometryCollection)){this.visit(element);if(this.isDone()){this.isDone=true;return;}}
else
this.applyTo(element);}}
jsts.geom.util.ShortCircuitedGeometryVisitor.prototype.visit=function(element){};jsts.geom.util.ShortCircuitedGeometryVisitor.prototype.isDone=function(){};})();(function(){var EnvelopeIntersectsVisitor=function(rectEnv){this.rectEnv=rectEnv;};EnvelopeIntersectsVisitor.prototype=new jsts.geom.util.ShortCircuitedGeometryVisitor();EnvelopeIntersectsVisitor.constructor=EnvelopeIntersectsVisitor;EnvelopeIntersectsVisitor.prototype.rectEnv=null;EnvelopeIntersectsVisitor.prototype.intersects=false;EnvelopeIntersectsVisitor.prototype.intersects=function(){return this.intersects;}
EnvelopeIntersectsVisitor.prototype.visit=function(element){var elementEnv=element.getEnvelopeInternal();if(!this.rectEnv.intersects(elementEnv)){return;}
if(this.rectEnv.contains(elementEnv)){this.intersects=true;return;}
if(elementEnv.getMinX()>=rectEnv.getMinX()&&elementEnv.getMaxX()<=rectEnv.getMaxX()){this.intersects=true;return;}
if(elementEnv.getMinY()>=rectEnv.getMinY()&&elementEnv.getMaxY()<=rectEnv.getMaxY()){this.intersects=true;return;}}
EnvelopeIntersectsVisitor.prototype.isDone=function(){return this.intersects==true;}
var GeometryContainsPointVisitor=function(rectangle){this.rectSeq=rectangle.getExteriorRing().getCoordinateSequence();this.rectEnv=rectangle.getEnvelopeInternal();};GeometryContainsPointVisitor.prototype=new jsts.geom.util.ShortCircuitedGeometryVisitor();GeometryContainsPointVisitor.constructor=GeometryContainsPointVisitor;GeometryContainsPointVisitor.prototype.rectSeq=null;GeometryContainsPointVisitor.prototype.rectEnv=null;GeometryContainsPointVisitor.prototype.containsPoint=false;GeometryContainsPointVisitor.prototype.containsPoint=function(){return this.containsPoint;}
GeometryContainsPointVisitor.prototype.visit=function(geom){if(!(geom instanceof jsts.geom.Polygon))
return;var elementEnv=geom.getEnvelopeInternal();if(!this.rectEnv.intersects(elementEnv))
return;var rectPt=new jsts.geom.Coordinate();for(var i=0;i<4;i++){this.rectSeq.getCoordinate(i,rectPt);if(!elementEnv.contains(rectPt))
continue;if(SimplePointInAreaLocator.containsPointInPolygon(rectPt,geom)){this.containsPoint=true;return;}}}
GeometryContainsPointVisitor.prototype.isDone=function(){return this.containsPoint==true;}
var RectangleIntersectsSegmentVisitor=function(rectangle){this.rectEnv=rectangle.getEnvelopeInternal();this.rectIntersector=new RectangleLineIntersector(rectEnv);};RectangleIntersectsSegmentVisitor.prototype=new jsts.geom.util.ShortCircuitedGeometryVisitor();RectangleIntersectsSegmentVisitor.constructor=RectangleIntersectsSegmentVisitor;RectangleIntersectsSegmentVisitor.prototype.rectEnv=null;RectangleIntersectsSegmentVisitor.prototype.rectIntersector=null;RectangleIntersectsSegmentVisitor.prototype.hasIntersection=false;RectangleIntersectsSegmentVisitor.prototype.p0=null;RectangleIntersectsSegmentVisitor.prototype.p1=null;RectangleIntersectsSegmentVisitor.prototype.intersects=function(){return this.hasIntersection;}
RectangleIntersectsSegmentVisitor.prototype.visit=function(geom){var elementEnv=geom.getEnvelopeInternal();if(!this.rectEnv.intersects(elementEnv))
return;var lines=LinearComponentExtracter.getLines(geom);this.checkIntersectionWithLineStrings(lines);}
RectangleIntersectsSegmentVisitor.prototype.checkIntersectionWithLineStrings=function(lines){for(var i=lines.iterator();i.hasNext();){var testLine=i.next();this.checkIntersectionWithSegments(testLine);if(this.hasIntersection)
return;}}
RectangleIntersectsSegmentVisitor.prototype.checkIntersectionWithSegments=function(testLine){var seq1=testLine.getCoordinateSequence();for(var j=1;j<seq1.length;j++){this.p0=seq1[j-1];this.p1=seq1[j];if(rectIntersector.intersects(p0,p1)){this.hasIntersection=true;return;}}}
RectangleIntersectsSegmentVisitor.prototype.isDone=function(){return this.hasIntersection==true;}
jsts.operation.predicate.RectangleIntersects=function(rectangle){this.rectangle=rectangle;this.rectEnv=rectangle.getEnvelopeInternal();}
jsts.operation.predicate.RectangleIntersects.intersects=function(rectangle,b){var rp=new jsts.operation.predicate.RectangleIntersects(rectangle);return rp.intersects(b);}
jsts.operation.predicate.RectangleIntersects.prototype.rectangle=null;jsts.operation.predicate.RectangleIntersects.prototype.rectEnv=null;jsts.operation.predicate.RectangleIntersects.prototype.intersects=function(geom){if(!this.rectEnv.intersects(geom.getEnvelopeInternal()))
return false;var visitor=new EnvelopeIntersectsVisitor(this.rectEnv);visitor.applyTo(geom);if(visitor.intersects())
return true;var ecpVisitor=new GeometryContainsPointVisitor(rectangle);ecpVisitor.applyTo(geom);if(ecpVisitor.containsPoint())
return true;var riVisitor=new RectangleIntersectsSegmentVisitor(rectangle);riVisitor.applyTo(geom);if(riVisitor.intersects())
return true;return false;}})();jsts.operation.buffer.BufferBuilder=function(bufParams){this.bufParams=bufParams;this.edgeList=new jsts.geomgraph.EdgeList();};jsts.operation.buffer.BufferBuilder.depthDelta=function(label){var lLoc=label.getLocation(0,jsts.geomgraph.Position.LEFT);var rLoc=label.getLocation(0,jsts.geomgraph.Position.RIGHT);if(lLoc===jsts.geom.Location.INTERIOR&&rLoc===jsts.geom.Location.EXTERIOR)
return 1;else if(lLoc===jsts.geom.Location.EXTERIOR&&rLoc===jsts.geom.Location.INTERIOR)
return-1;return 0;};jsts.operation.buffer.BufferBuilder.prototype.bufParams=null;jsts.operation.buffer.BufferBuilder.prototype.workingPrecisionModel=null;jsts.operation.buffer.BufferBuilder.prototype.workingNoder=null;jsts.operation.buffer.BufferBuilder.prototype.geomFact=null;jsts.operation.buffer.BufferBuilder.prototype.graph=null;jsts.operation.buffer.BufferBuilder.prototype.edgeList=null;jsts.operation.buffer.BufferBuilder.prototype.setWorkingPrecisionModel=function(pm){this.workingPrecisionModel=pm;};jsts.operation.buffer.BufferBuilder.prototype.setNoder=function(noder){this.workingNoder=noder;};jsts.operation.buffer.BufferBuilder.prototype.buffer=function(g,distance){var precisionModel=this.workingPrecisionModel;if(precisionModel===null)
precisionModel=g.getPrecisionModel();this.geomFact=g.getFactory();var curveBuilder=new jsts.operation.buffer.OffsetCurveBuilder(precisionModel,this.bufParams);var curveSetBuilder=new jsts.operation.buffer.OffsetCurveSetBuilder(g,distance,curveBuilder);var bufferSegStrList=curveSetBuilder.getCurves();if(bufferSegStrList.size()<=0){return this.createEmptyResultGeometry();}
this.computeNodedEdges(bufferSegStrList,precisionModel);this.graph=new jsts.geomgraph.PlanarGraph(new jsts.operation.overlay.OverlayNodeFactory());this.graph.addEdges(this.edgeList.getEdges());var subgraphList=this.createSubgraphs(this.graph);var polyBuilder=new jsts.operation.overlay.PolygonBuilder(this.geomFact);this.buildSubgraphs(subgraphList,polyBuilder);var resultPolyList=polyBuilder.getPolygons();if(resultPolyList.size()<=0){return this.createEmptyResultGeometry();}
var resultGeom=this.geomFact.buildGeometry(resultPolyList);return resultGeom;};jsts.operation.buffer.BufferBuilder.prototype.getNoder=function(precisionModel){if(this.workingNoder!==null)
return this.workingNoder;var noder=new jsts.noding.MCIndexNoder();var li=new jsts.algorithm.RobustLineIntersector();li.setPrecisionModel(precisionModel);noder.setSegmentIntersector(new jsts.noding.IntersectionAdder(li));return noder;};jsts.operation.buffer.BufferBuilder.prototype.computeNodedEdges=function(bufferSegStrList,precisionModel){var noder=this.getNoder(precisionModel);noder.computeNodes(bufferSegStrList);var nodedSegStrings=noder.getNodedSubstrings();for(var i=nodedSegStrings.iterator();i.hasNext();){var segStr=i.next();var oldLabel=segStr.getData();var edge=new jsts.geomgraph.Edge(segStr.getCoordinates(),new jsts.geomgraph.Label(oldLabel));this.insertUniqueEdge(edge);}};jsts.operation.buffer.BufferBuilder.prototype.insertUniqueEdge=function(e){var existingEdge=this.edgeList.findEqualEdge(e);if(existingEdge!=null){var existingLabel=existingEdge.getLabel();var labelToMerge=e.getLabel();if(!existingEdge.isPointwiseEqual(e)){labelToMerge=new jsts.geomgraph.Label(e.getLabel());labelToMerge.flip();}
existingLabel.merge(labelToMerge);var mergeDelta=jsts.operation.buffer.BufferBuilder.depthDelta(labelToMerge);var existingDelta=existingEdge.getDepthDelta();var newDelta=existingDelta+mergeDelta;existingEdge.setDepthDelta(newDelta);}else{this.edgeList.add(e);e.setDepthDelta(jsts.operation.buffer.BufferBuilder.depthDelta(e.getLabel()));}};jsts.operation.buffer.BufferBuilder.prototype.createSubgraphs=function(graph){var subgraphList=[];for(var i=graph.getNodes().iterator();i.hasNext();){var node=i.next();if(!node.isVisited()){var subgraph=new jsts.operation.buffer.BufferSubgraph();subgraph.create(node);subgraphList.push(subgraph);}}
var compare=function(a,b){return a.compareTo(b);};subgraphList.sort(compare);subgraphList.reverse();return subgraphList;};jsts.operation.buffer.BufferBuilder.prototype.buildSubgraphs=function(subgraphList,polyBuilder){var processedGraphs=[];for(var i=0;i<subgraphList.length;i++){var subgraph=subgraphList[i];var p=subgraph.getRightmostCoordinate();var locater=new jsts.operation.buffer.SubgraphDepthLocater(processedGraphs);var outsideDepth=locater.getDepth(p);subgraph.computeDepth(outsideDepth);subgraph.findResultEdges();processedGraphs.push(subgraph);polyBuilder.add(subgraph.getDirectedEdges(),subgraph.getNodes());}};jsts.operation.buffer.BufferBuilder.convertSegStrings=function(it){var fact=new jsts.geom.GeometryFactory();var lines=new javascript.util.ArrayList();while(it.hasNext()){var ss=it.next();var line=fact.createLineString(ss.getCoordinates());lines.add(line);}
return fact.buildGeometry(lines);};jsts.operation.buffer.BufferBuilder.prototype.createEmptyResultGeometry=function(){var emptyGeom=this.geomFact.createPolygon(null,null);return emptyGeom;};jsts.noding.SegmentPointComparator=function(){};jsts.noding.SegmentPointComparator.compare=function(octant,p0,p1){if(p0.equals2D(p1))
return 0;var xSign=jsts.noding.SegmentPointComparator.relativeSign(p0.x,p1.x);var ySign=jsts.noding.SegmentPointComparator.relativeSign(p0.y,p1.y);switch(octant){case 0:return jsts.noding.SegmentPointComparator.compareValue(xSign,ySign);case 1:return jsts.noding.SegmentPointComparator.compareValue(ySign,xSign);case 2:return jsts.noding.SegmentPointComparator.compareValue(ySign,-xSign);case 3:return jsts.noding.SegmentPointComparator.compareValue(-xSign,ySign);case 4:return jsts.noding.SegmentPointComparator.compareValue(-xSign,-ySign);case 5:return jsts.noding.SegmentPointComparator.compareValue(-ySign,-xSign);case 6:return jsts.noding.SegmentPointComparator.compareValue(-ySign,xSign);case 7:return jsts.noding.SegmentPointComparator.compareValue(xSign,-ySign);}
return 0;};jsts.noding.SegmentPointComparator.relativeSign=function(x0,x1){if(x0<x1)
return-1;if(x0>x1)
return 1;return 0;};jsts.noding.SegmentPointComparator.compareValue=function(compareSign0,compareSign1){if(compareSign0<0)
return-1;if(compareSign0>0)
return 1;if(compareSign1<0)
return-1;if(compareSign1>0)
return 1;return 0;};jsts.operation.relate.RelateOp=function(){jsts.operation.GeometryGraphOperation.apply(this,arguments);this._relate=new jsts.operation.relate.RelateComputer(this.arg);};jsts.operation.relate.RelateOp.prototype=new jsts.operation.GeometryGraphOperation();jsts.operation.relate.RelateOp.relate=function(a,b,boundaryNodeRule){var relOp=new jsts.operation.relate.RelateOp(a,b,boundaryNodeRule);var im=relOp.getIntersectionMatrix();return im;};jsts.operation.relate.RelateOp.prototype._relate=null;jsts.operation.relate.RelateOp.prototype.getIntersectionMatrix=function(){return this._relate.computeIM();};jsts.index.chain.MonotoneChain=function(pts,start,end,context){this.pts=pts;this.start=start;this.end=end;this.context=context;};jsts.index.chain.MonotoneChain.prototype.pts=null;jsts.index.chain.MonotoneChain.prototype.start=null;jsts.index.chain.MonotoneChain.prototype.end=null;jsts.index.chain.MonotoneChain.prototype.env=null;jsts.index.chain.MonotoneChain.prototype.context=null;jsts.index.chain.MonotoneChain.prototype.id=null;jsts.index.chain.MonotoneChain.prototype.setId=function(id){this.id=id;};jsts.index.chain.MonotoneChain.prototype.getId=function(){return this.id;};jsts.index.chain.MonotoneChain.prototype.getContext=function(){return this.context;};jsts.index.chain.MonotoneChain.prototype.getEnvelope=function(){if(this.env==null){var p0=this.pts[this.start];var p1=this.pts[this.end];this.env=new jsts.geom.Envelope(p0,p1);}
return this.env;};jsts.index.chain.MonotoneChain.prototype.getStartIndex=function(){return this.start;};jsts.index.chain.MonotoneChain.prototype.getEndIndex=function(){return this.end;};jsts.index.chain.MonotoneChain.prototype.getLineSegment=function(index,ls){ls.p0=this.pts[index];ls.p1=this.pts[index+1];};jsts.index.chain.MonotoneChain.prototype.getCoordinates=function(){var coord=[];var index=0;for(var i=this.start;i<=this.end;i++){coord[index++]=this.pts[i];}
return coord;};jsts.index.chain.MonotoneChain.prototype.select=function(searchEnv,mcs){this.computeSelect2(searchEnv,this.start,this.end,mcs);};jsts.index.chain.MonotoneChain.prototype.computeSelect2=function(searchEnv,start0,end0,mcs){var p0=this.pts[start0];var p1=this.pts[end0];mcs.tempEnv1.init(p0,p1);if(end0-start0===1){mcs.select(this,start0);return;}
if(!searchEnv.intersects(mcs.tempEnv1))
return;var mid=parseInt((start0+end0)/2);if(start0<mid){this.computeSelect2(searchEnv,start0,mid,mcs);}
if(mid<end0){this.computeSelect2(searchEnv,mid,end0,mcs);}};jsts.index.chain.MonotoneChain.prototype.computeOverlaps=function(mc,mco){if(arguments.length===6){return this.computeOverlaps2.apply(this,arguments);}
this.computeOverlaps2(this.start,this.end,mc,mc.start,mc.end,mco);};jsts.index.chain.MonotoneChain.prototype.computeOverlaps2=function(start0,end0,mc,start1,end1,mco){var p00=this.pts[start0];var p01=this.pts[end0];var p10=mc.pts[start1];var p11=mc.pts[end1];if(end0-start0===1&&end1-start1===1){mco.overlap(this,start0,mc,start1);return;}
mco.tempEnv1.init(p00,p01);mco.tempEnv2.init(p10,p11);if(!mco.tempEnv1.intersects(mco.tempEnv2))
return;var mid0=parseInt((start0+end0)/2);var mid1=parseInt((start1+end1)/2);if(start0<mid0){if(start1<mid1)
this.computeOverlaps2(start0,mid0,mc,start1,mid1,mco);if(mid1<end1)
this.computeOverlaps2(start0,mid0,mc,mid1,end1,mco);}
if(mid0<end0){if(start1<mid1)
this.computeOverlaps2(mid0,end0,mc,start1,mid1,mco);if(mid1<end1)
this.computeOverlaps2(mid0,end0,mc,mid1,end1,mco);}};(function(){var Location=jsts.geom.Location;var Dimension=jsts.geom.Dimension;jsts.geom.IntersectionMatrix=function(elements){var other=elements;if(elements===undefined||elements===null){this.matrix=[[],[],[]];this.setAll(Dimension.FALSE);}else if(typeof elements==='string'){this.set(elements);}else if(other instanceof jsts.geom.IntersectionMatrix){this.matrix[Location.INTERIOR][Location.INTERIOR]=other.matrix[Location.INTERIOR][Location.INTERIOR];this.matrix[Location.INTERIOR][Location.BOUNDARY]=other.matrix[Location.INTERIOR][Location.BOUNDARY];this.matrix[Location.INTERIOR][Location.EXTERIOR]=other.matrix[Location.INTERIOR][Location.EXTERIOR];this.matrix[Location.BOUNDARY][Location.INTERIOR]=other.matrix[Location.BOUNDARY][Location.INTERIOR];this.matrix[Location.BOUNDARY][Location.BOUNDARY]=other.matrix[Location.BOUNDARY][Location.BOUNDARY];this.matrix[Location.BOUNDARY][Location.EXTERIOR]=other.matrix[Location.BOUNDARY][Location.EXTERIOR];this.matrix[Location.EXTERIOR][Location.INTERIOR]=other.matrix[Location.EXTERIOR][Location.INTERIOR];this.matrix[Location.EXTERIOR][Location.BOUNDARY]=other.matrix[Location.EXTERIOR][Location.BOUNDARY];this.matrix[Location.EXTERIOR][Location.EXTERIOR]=other.matrix[Location.EXTERIOR][Location.EXTERIOR];}};jsts.geom.IntersectionMatrix.prototype.matrix=null;jsts.geom.IntersectionMatrix.prototype.add=function(im){var i,j;for(i=0;i<3;i++){for(j=0;j<3;j++){this.setAtLeast(i,j,im.get(i,j));}}};jsts.geom.IntersectionMatrix.matches=function(actualDimensionValue,requiredDimensionSymbol){if(typeof actualDimensionValue==='string'){return jsts.geom.IntersectionMatrix.matches2.call(this,arguments);}
if(requiredDimensionSymbol==='*'){return true;}
if(requiredDimensionSymbol==='T'&&(actualDimensionValue>=0||actualDimensionValue===Dimension.TRUE)){return true;}
if(requiredDimensionSymbol==='F'&&actualDimensionValue===Dimension.FALSE){return true;}
if(requiredDimensionSymbol==='0'&&actualDimensionValue===Dimension.P){return true;}
if(requiredDimensionSymbol==='1'&&actualDimensionValue===Dimension.L){return true;}
if(requiredDimensionSymbol==='2'&&actualDimensionValue===Dimension.A){return true;}
return false;};jsts.geom.IntersectionMatrix.matches2=function(actualDimensionSymbols,requiredDimensionSymbols){var m=new jsts.geom.IntersectionMatrix(actualDimensionSymbols);return m.matches(requiredDimensionSymbols);};jsts.geom.IntersectionMatrix.prototype.set=function(row,column,dimensionValue){if(typeof row==='string'){this.set2(row);return;}
this.matrix[row][column]=dimensionValue;};jsts.geom.IntersectionMatrix.prototype.set2=function(dimensionSymbols){for(var i=0;i<dimensionSymbols.length();i++){var row=i/3;var col=i%3;this.matrix[row][col]=Dimension.toDimensionValue(dimensionSymbols.charAt(i));}};jsts.geom.IntersectionMatrix.prototype.setAtLeast=function(row,column,minimumDimensionValue){if(arguments.length===1){this.setAtLeast2(arguments[0]);return;}
if(this.matrix[row][column]<minimumDimensionValue){this.matrix[row][column]=minimumDimensionValue;}};jsts.geom.IntersectionMatrix.prototype.setAtLeastIfValid=function(row,column,minimumDimensionValue){if(row>=0&&column>=0){this.setAtLeast(row,column,minimumDimensionValue);}};jsts.geom.IntersectionMatrix.prototype.setAtLeast2=function(minimumDimensionSymbols){var i;for(i=0;i<minimumDimensionSymbols.length;i++){var row=parseInt(i/3);var col=parseInt(i%3);this.setAtLeast(row,col,jsts.geom.Dimension.toDimensionValue(minimumDimensionSymbols.charAt(i)));}};jsts.geom.IntersectionMatrix.prototype.setAll=function(dimensionValue){var ai,bi;for(ai=0;ai<3;ai++){for(bi=0;bi<3;bi++){this.matrix[ai][bi]=dimensionValue;}}};jsts.geom.IntersectionMatrix.prototype.get=function(row,column){return this.matrix[row][column];};jsts.geom.IntersectionMatrix.prototype.isDisjoint=function(){return this.matrix[Location.INTERIOR][Location.INTERIOR]===Dimension.FALSE&&this.matrix[Location.INTERIOR][Location.BOUNDARY]===Dimension.FALSE&&this.matrix[Location.BOUNDARY][Location.INTERIOR]===Dimension.FALSE&&this.matrix[Location.BOUNDARY][Location.BOUNDARY]===Dimension.FALSE;};jsts.geom.IntersectionMatrix.prototype.isIntersects=function(){return!this.isDisjoint();};jsts.geom.IntersectionMatrix.prototype.isTouches=function(dimensionOfGeometryA,dimensionOfGeometryB){if(dimensionOfGeometryA>dimensionOfGeometryB){return this.isTouches(dimensionOfGeometryB,dimensionOfGeometryA);}
if((dimensionOfGeometryA==Dimension.A&&dimensionOfGeometryB==Dimension.A)||(dimensionOfGeometryA==Dimension.L&&dimensionOfGeometryB==Dimension.L)||(dimensionOfGeometryA==Dimension.L&&dimensionOfGeometryB==Dimension.A)||(dimensionOfGeometryA==Dimension.P&&dimensionOfGeometryB==Dimension.A)||(dimensionOfGeometryA==Dimension.P&&dimensionOfGeometryB==Dimension.L)){return this.matrix[Location.INTERIOR][Location.INTERIOR]===Dimension.FALSE&&(jsts.geom.IntersectionMatrix.matches(this.matrix[Location.INTERIOR][Location.BOUNDARY],'T')||jsts.geom.IntersectionMatrix.matches(this.matrix[Location.BOUNDARY][Location.INTERIOR],'T')||jsts.geom.IntersectionMatrix.matches(this.matrix[Location.BOUNDARY][Location.BOUNDARY],'T'));}
return false;};jsts.geom.IntersectionMatrix.prototype.isCrosses=function(dimensionOfGeometryA,dimensionOfGeometryB){if((dimensionOfGeometryA==Dimension.P&&dimensionOfGeometryB==Dimension.L)||(dimensionOfGeometryA==Dimension.P&&dimensionOfGeometryB==Dimension.A)||(dimensionOfGeometryA==Dimension.L&&dimensionOfGeometryB==Dimension.A)){return jsts.geom.IntersectionMatrix.matches(this.matrix[Location.INTERIOR][Location.INTERIOR],'T')&&jsts.geom.IntersectionMatrix.matches(this.matrix[Location.INTERIOR][Location.EXTERIOR],'T');}
if((dimensionOfGeometryA==Dimension.L&&dimensionOfGeometryB==Dimension.P)||(dimensionOfGeometryA==Dimension.A&&dimensionOfGeometryB==Dimension.P)||(dimensionOfGeometryA==Dimension.A&&dimensionOfGeometryB==Dimension.L)){return jsts.geom.IntersectionMatrix.matches(matrix[Location.INTERIOR][Location.INTERIOR],'T')&&jsts.geom.IntersectionMatrix.matches(this.matrix[Location.EXTERIOR][Location.INTERIOR],'T');}
if(dimensionOfGeometryA===Dimension.L&&dimensionOfGeometryB===Dimension.L){return this.matrix[Location.INTERIOR][Location.INTERIOR]===0;}
return false;};jsts.geom.IntersectionMatrix.prototype.isWithin=function(){return jsts.geom.IntersectionMatrix.matches(this.matrix[Location.INTERIOR][Location.INTERIOR],'T')&&this.matrix[Location.INTERIOR][Location.EXTERIOR]==Dimension.FALSE&&this.matrix[Location.BOUNDARY][Location.EXTERIOR]==Dimension.FALSE;};jsts.geom.IntersectionMatrix.prototype.isContains=function(){return jsts.geom.IntersectionMatrix.matches(this.matrix[Location.INTERIOR][Location.INTERIOR],'T')&&this.matrix[Location.EXTERIOR][Location.INTERIOR]==Dimension.FALSE&&this.matrix[Location.EXTERIOR][Location.BOUNDARY]==Dimension.FALSE;};jsts.geom.IntersectionMatrix.prototype.isCovers=function(){var hasPointInCommon=jsts.geom.IntersectionMatrix.matches(this.matrix[Location.INTERIOR][Location.INTERIOR],'T')||jsts.geom.IntersectionMatrix.matches(this.matrix[Location.INTERIOR][Location.BOUNDARY],'T')||jsts.geom.IntersectionMatrix.matches(this.matrix[Location.BOUNDARY][Location.INTERIOR],'T')||jsts.geom.IntersectionMatrix.matches(this.matrix[Location.BOUNDARY][Location.BOUNDARY],'T');return hasPointInCommon&&this.matrix[Location.EXTERIOR][Location.INTERIOR]==Dimension.FALSE&&this.matrix[Location.EXTERIOR][Location.BOUNDARY]==Dimension.FALSE;};jsts.geom.IntersectionMatrix.prototype.isCoveredBy=function(){var hasPointInCommon=jsts.geom.IntersectionMatrix.matches(this.matrix[Location.INTERIOR][Location.INTERIOR],'T')||jsts.geom.IntersectionMatrix.matches(this.matrix[Location.INTERIOR][Location.BOUNDARY],'T')||jsts.geom.IntersectionMatrix.matches(this.matrix[Location.BOUNDARY][Location.INTERIOR],'T')||jsts.geom.IntersectionMatrix.matches(this.matrix[Location.BOUNDARY][Location.BOUNDARY],'T');return hasPointInCommon&&this.matrix[Location.INTERIOR][Location.EXTERIOR]===Dimension.FALSE&&this.matrix[Location.BOUNDARY][Location.EXTERIOR]===Dimension.FALSE;};jsts.geom.IntersectionMatrix.prototype.isEquals=function(dimensionOfGeometryA,dimensionOfGeometryB){if(dimensionOfGeometryA!==dimensionOfGeometryB){return false;}
return jsts.geom.IntersectionMatrix.matches(this.matrix[Location.INTERIOR][Location.INTERIOR],'T')&&this.matrix[Location.EXTERIOR][Location.INTERIOR]===Dimension.FALSE&&this.matrix[Location.INTERIOR][Location.EXTERIOR]===Dimension.FALSE&&this.matrix[Location.EXTERIOR][Location.BOUNDARY]===Dimension.FALSE&&this.matrix[Location.BOUNDARY][Location.EXTERIOR]===Dimension.FALSE;};jsts.geom.IntersectionMatrix.prototype.isOverlaps=function(dimensionOfGeometryA,dimensionOfGeometryB){if((dimensionOfGeometryA==Dimension.P&&dimensionOfGeometryB===Dimension.P)||(dimensionOfGeometryA==Dimension.A&&dimensionOfGeometryB===Dimension.A)){return jsts.geom.IntersectionMatrix.matches(this.matrix[Location.INTERIOR][Location.INTERIOR],'T')&&jsts.geom.IntersectionMatrix.matches(this.matrix[Location.INTERIOR][Location.EXTERIOR],'T')&&jsts.geom.IntersectionMatrix.matches(this.matrix[Location.EXTERIOR][Location.INTERIOR],'T');}
if(dimensionOfGeometryA===Dimension.L&&dimensionOfGeometryB===Dimension.L){return this.matrix[Location.INTERIOR][Location.INTERIOR]==1&&jsts.geom.IntersectionMatrix.matches(this.matrix[Location.INTERIOR][Location.EXTERIOR],'T')&&jsts.geom.IntersectionMatrix.matches(this.matrix[Location.EXTERIOR][Location.INTERIOR],'T');}
return false;};jsts.geom.IntersectionMatrix.prototype.matches=function(requiredDimensionSymbols){if(requiredDimensionSymbols.length!=9){throw new jsts.error.IllegalArgumentException('Should be length 9: '+
requiredDimensionSymbols);}
for(var ai=0;ai<3;ai++){for(var bi=0;bi<3;bi++){if(!jsts.geom.IntersectionMatrix.matches(this.matrix[ai][bi],requiredDimensionSymbols.charAt(3*ai+bi))){return false;}}}
return true;};jsts.geom.IntersectionMatrix.prototype.transpose=function(){var temp=matrix[1][0];this.matrix[1][0]=this.matrix[0][1];this.matrix[0][1]=temp;temp=this.matrix[2][0];this.matrix[2][0]=this.matrix[0][2];this.matrix[0][2]=temp;temp=this.matrix[2][1];this.matrix[2][1]=this.matrix[1][2];this.matrix[1][2]=temp;return this;};jsts.geom.IntersectionMatrix.prototype.toString=function(){var ai,bi,buf='';for(ai=0;ai<3;ai++){for(bi=0;bi<3;bi++){buf+=Dimension.toDimensionSymbol(this.matrix[ai][bi]);}}
return buf;};})();jsts.triangulate.quadedge.LastFoundQuadEdgeLocator=function(subdiv){this.subdiv=subdiv;this.lastEdge=null;this.init();};jsts.triangulate.quadedge.LastFoundQuadEdgeLocator.prototype.init=function(){this.lastEdge=this.findEdge();};jsts.triangulate.quadedge.LastFoundQuadEdgeLocator.prototype.findEdge=function(){var edges=this.subdiv.getEdges();return edges[0];};jsts.triangulate.quadedge.LastFoundQuadEdgeLocator.prototype.locate=function(v){if(!this.lastEdge.isLive()){this.init();}
var e=this.subdiv.locateFromEdge(v,this.lastEdge);this.lastEdge=e;return e;};jsts.noding.SegmentNodeList=function(edge){this.nodeMap=new javascript.util.TreeMap();this.edge=edge;};jsts.noding.SegmentNodeList.prototype.nodeMap=null;jsts.noding.SegmentNodeList.prototype.iterator=function(){return this.nodeMap.values().iterator();};jsts.noding.SegmentNodeList.prototype.edge=null;jsts.noding.SegmentNodeList.prototype.getEdge=function(){return this.edge;};jsts.noding.SegmentNodeList.prototype.add=function(intPt,segmentIndex){var eiNew=new jsts.noding.SegmentNode(this.edge,intPt,segmentIndex,this.edge.getSegmentOctant(segmentIndex));var ei=this.nodeMap.get(eiNew);if(ei!==null){jsts.util.Assert.isTrue(ei.coord.equals2D(intPt),'Found equal nodes with different coordinates');return ei;}
this.nodeMap.put(eiNew,eiNew);return eiNew;};jsts.noding.SegmentNodeList.prototype.addEndpoints=function(){var maxSegIndex=this.edge.size()-1;this.add(this.edge.getCoordinate(0),0);this.add(this.edge.getCoordinate(maxSegIndex),maxSegIndex);};jsts.noding.SegmentNodeList.prototype.addCollapsedNodes=function(){var collapsedVertexIndexes=[];this.findCollapsesFromInsertedNodes(collapsedVertexIndexes);this.findCollapsesFromExistingVertices(collapsedVertexIndexes);for(var i=0;i<collapsedVertexIndexes.length;i++){var vertexIndex=collapsedVertexIndexes[i];this.add(this.edge.getCoordinate(vertexIndex),vertexIndex);}};jsts.noding.SegmentNodeList.prototype.findCollapsesFromExistingVertices=function(collapsedVertexIndexes){for(var i=0;i<this.edge.size()-2;i++){var p0=this.edge.getCoordinate(i);var p1=this.edge.getCoordinate(i+1);var p2=this.edge.getCoordinate(i+2);if(p0.equals2D(p2)){collapsedVertexIndexes.push(i+1);}}};jsts.noding.SegmentNodeList.prototype.findCollapsesFromInsertedNodes=function(collapsedVertexIndexes){var collapsedVertexIndex=[null];var it=this.iterator();var eiPrev=it.next();while(it.hasNext()){var ei=it.next();var isCollapsed=this.findCollapseIndex(eiPrev,ei,collapsedVertexIndex);if(isCollapsed)
collapsedVertexIndexes.push(collapsedVertexIndex[0]);eiPrev=ei;}};jsts.noding.SegmentNodeList.prototype.findCollapseIndex=function(ei0,ei1,collapsedVertexIndex){if(!ei0.coord.equals2D(ei1.coord))
return false;var numVerticesBetween=ei1.segmentIndex-ei0.segmentIndex;if(!ei1.isInterior()){numVerticesBetween--;}
if(numVerticesBetween===1){collapsedVertexIndex[0]=ei0.segmentIndex+1;return true;}
return false;};jsts.noding.SegmentNodeList.prototype.addSplitEdges=function(edgeList){this.addEndpoints();this.addCollapsedNodes();var it=this.iterator();var eiPrev=it.next();while(it.hasNext()){var ei=it.next();var newEdge=this.createSplitEdge(eiPrev,ei);edgeList.add(newEdge);eiPrev=ei;}};jsts.noding.SegmentNodeList.prototype.checkSplitEdgesCorrectness=function(splitEdges){var edgePts=edge.getCoordinates();var split0=splitEdges[0];var pt0=split0.getCoordinate(0);if(!pt0.equals2D(edgePts[0]))
throw new Error('bad split edge start point at '+pt0);var splitn=splitEdges[splitEdges.length-1];var splitnPts=splitn.getCoordinates();var ptn=splitnPts[splitnPts.length-1];if(!ptn.equals2D(edgePts[edgePts.length-1]))
throw new Error('bad split edge end point at '+ptn);};jsts.noding.SegmentNodeList.prototype.createSplitEdge=function(ei0,ei1){var npts=ei1.segmentIndex-ei0.segmentIndex+2;var lastSegStartPt=this.edge.getCoordinate(ei1.segmentIndex);var useIntPt1=ei1.isInterior()||!ei1.coord.equals2D(lastSegStartPt);if(!useIntPt1){npts--;}
var pts=[];var ipt=0;pts[ipt++]=new jsts.geom.Coordinate(ei0.coord);for(var i=ei0.segmentIndex+1;i<=ei1.segmentIndex;i++){pts[ipt++]=this.edge.getCoordinate(i);}
if(useIntPt1)
pts[ipt]=ei1.coord;return new jsts.noding.NodedSegmentString(pts,this.edge.getData());};jsts.io.WKTWriter=function(){this.parser=new jsts.io.WKTParser(this.geometryFactory);};jsts.io.WKTWriter.prototype.write=function(geometry){var wkt=this.parser.write(geometry);return wkt;};jsts.io.WKTWriter.toLineString=function(p0,p1){if(arguments.length!==2){throw new jsts.error.NotImplementedError();}
return'LINESTRING ( '+p0.x+' '+p0.y+', '+p1.x+' '+p1.y+' )';};jsts.io.WKTReader=function(geometryFactory){this.geometryFactory=geometryFactory||new jsts.geom.GeometryFactory();this.precisionModel=this.geometryFactory.getPrecisionModel();this.parser=new jsts.io.WKTParser(this.geometryFactory);};jsts.io.WKTReader.prototype.read=function(wkt){var geometry=this.parser.read(wkt);if(this.precisionModel.getType()===jsts.geom.PrecisionModel.FIXED){this.reducePrecision(geometry);}
return geometry;};jsts.io.WKTReader.prototype.reducePrecision=function(geometry){var i,len;if(geometry.coordinate){this.precisionModel.makePrecise(geometry.coordinate);}else if(geometry.points){for(i=0,len=geometry.points.length;i<len;i++){this.precisionModel.makePrecise(geometry.points[i]);}}else if(geometry.geometries){for(i=0,len=geometry.geometries.length;i<len;i++){this.reducePrecision(geometry.geometries[i]);}}};jsts.triangulate.quadedge.QuadEdgeSubdivision=function(env,tolerance){this.tolerance=tolerance;this.edgeCoincidenceTolerance=tolerance/jsts.triangulate.quadedge.QuadEdgeSubdivision.EDGE_COINCIDENCE_TOL_FACTOR;this.visitedKey=0;this.quadEdges=[];this.startingEdge;this.tolerance;this.edgeCoincidenceTolerance;this.frameEnv;this.locator=null;this.seg=new jsts.geom.LineSegment();this.triEdges=new Array(3);this.frameVertex=new Array(3);this.createFrame(env);this.startingEdge=this.initSubdiv();this.locator=new jsts.triangulate.quadedge.LastFoundQuadEdgeLocator(this);};jsts.triangulate.quadedge.QuadEdgeSubdivision.EDGE_COINCIDENCE_TOL_FACTOR=1000;jsts.triangulate.quadedge.QuadEdgeSubdivision.getTriangleEdges=function(startQE,triEdge){triEdge[0]=startQE;triEdge[1]=triEdge[0].lNext();triEdge[2]=triEdge[1].lNext();if(triEdge[2].lNext()!=triEdge[0]){throw new jsts.IllegalArgumentError('Edges do not form a triangle');}};jsts.triangulate.quadedge.QuadEdgeSubdivision.prototype.createFrame=function(env){var deltaX,deltaY,offset;deltaX=env.getWidth();deltaY=env.getHeight();offset=0.0;if(deltaX>deltaY){offset=deltaX*10.0;}else{offset=deltaY*10.0;}
this.frameVertex[0]=new jsts.triangulate.quadedge.Vertex((env.getMaxX()+env.getMinX())/2.0,env.getMaxY()
+offset);this.frameVertex[1]=new jsts.triangulate.quadedge.Vertex(env.getMinX()-offset,env.getMinY()-offset);this.frameVertex[2]=new jsts.triangulate.quadedge.Vertex(env.getMaxX()+offset,env.getMinY()-offset);this.frameEnv=new jsts.geom.Envelope(this.frameVertex[0].getCoordinate(),this.frameVertex[1].getCoordinate());this.frameEnv.expandToInclude(this.frameVertex[2].getCoordinate());};jsts.triangulate.quadedge.QuadEdgeSubdivision.prototype.initSubdiv=function(){var ea,eb,ec;ea=this.makeEdge(this.frameVertex[0],this.frameVertex[1]);eb=this.makeEdge(this.frameVertex[1],this.frameVertex[2]);jsts.triangulate.quadedge.QuadEdge.splice(ea.sym(),eb);ec=this.makeEdge(this.frameVertex[2],this.frameVertex[0]);jsts.triangulate.quadedge.QuadEdge.splice(eb.sym(),ec);jsts.triangulate.quadedge.QuadEdge.splice(ec.sym(),ea);return ea;};jsts.triangulate.quadedge.QuadEdgeSubdivision.prototype.getTolerance=function(){return this.tolerance;};jsts.triangulate.quadedge.QuadEdgeSubdivision.prototype.getEnvelope=function(){return new jsts.geom.Envelope(this.frameEnv);};jsts.triangulate.quadedge.QuadEdgeSubdivision.prototype.getEdges=function(){if(arguments.length>0){return this.getEdgesByFactory(arguments[0]);}else{return this.quadEdges;}};jsts.triangulate.quadedge.QuadEdgeSubdivision.prototype.setLocator=function(locator){this.locator=locator;};jsts.triangulate.quadedge.QuadEdgeSubdivision.prototype.makeEdge=function(o,d){var q=jsts.triangulate.quadedge.QuadEdge.makeEdge(o,d);this.quadEdges.push(q);return q;};jsts.triangulate.quadedge.QuadEdgeSubdivision.prototype.connect=function(a,b){var q=jsts.triangulate.quadedge.QuadEdge.connect(a,b);this.quadEdges.push(q);return q;};jsts.triangulate.quadedge.QuadEdgeSubdivision.prototype.delete_jsts=function(e){jsts.triangulate.quadedge.QuadEdge.splice(e,e.oPrev());jsts.triangulate.quadedge.QuadEdge.splice(e.sym(),e.sym().oPrev());var eSym,eRot,eRotSym;e.eSym=e.sym();eRot=e.rot;eRotSym=e.rot.sym();var idx=this.quadEdges.indexOf(e);if(idx!==-1){this.quadEdges.splice(idx,1);}
idx=this.quadEdges.indexOf(eSym);if(idx!==-1){this.quadEdges.splice(idx,1);}
idx=this.quadEdges.indexOf(eRot);if(idx!==-1){this.quadEdges.splice(idx,1);}
idx=this.quadEdges.indexOf(eRotSym);if(idx!==-1){this.quadEdges.splice(idx,1);}
e.delete_jsts();eSym.delete_jsts();eRot.delete_jsts();eRotSym.delete_jsts();};jsts.triangulate.quadedge.QuadEdgeSubdivision.prototype.locateFromEdge=function(v,startEdge){var iter=0,maxIter=this.quadEdges.length,e;e=startEdge;while(true){iter++;if(iter>maxIter){throw new jsts.error.LocateFailureError(e.toLineSegment());}
if((v.equals(e.orig()))||(v.equals(e.dest()))){break;}else if(v.rightOf(e)){e=e.sym();}else if(!v.rightOf(e.oNext())){e=e.oNext();}else if(!v.rightOf(e.dPrev())){e=e.dPrev();}else{break;}}
return e;};jsts.triangulate.quadedge.QuadEdgeSubdivision.prototype.locate=function(){if(arguments.length===1){if(arguments[0]instanceof jsts.triangulate.quadedge.Vertex){return this.locateByVertex(arguments[0]);}else{return this.locateByCoordinate(arguments[0]);}}else{return this.locateByCoordinates(arguments[0],arguments[1]);}};jsts.triangulate.quadedge.QuadEdgeSubdivision.prototype.locateByVertex=function(v){return this.locator.locate(v);};jsts.triangulate.quadedge.QuadEdgeSubdivision.prototype.locateByCoordinate=function(p){return this.locator.locate(new jsts.triangulate.quadedge.Vertex(p));};jsts.triangulate.quadedge.QuadEdgeSubdivision.prototype.locateByCoordinates=function(p0,p1){var e,base,locEdge;var e=this.locator.locate(new jsts.triangulate.quadedge.Vertex(p0));if(e===null){return null;}
base=e;if(e.dest().getCoordinate().equals2D(p0)){base=e.sym();}
locEdge=base;do{if(locEdge.dest().getCoordinate().equals2D(p1)){return locEdge;}
locEdge=locEdge.oNext();}while(locEdge!=base);return null;};jsts.triangulate.quadedge.QuadEdgeSubdivision.prototype.insertSite=function(v){var e,base,startEdge;e=this.locate(v);if((v.equals(e.orig(),this.tolerance))||(v.equals(e.dest(),this.tolerance))){return e;}
base=this.makeEdge(e.orig(),v);jsts.triangulate.quadedge.QuadEdge.splice(base,e);startEdge=base;do{base=this.connect(e,base.sym());e=base.oPrev();}while(e.lNext()!=startEdge);return startEdge;};jsts.triangulate.quadedge.QuadEdgeSubdivision.prototype.isFrameEdge=function(e){if(this.isFrameVertex(e.orig())||this.isFrameVertex(e.dest())){return true;}
return false;};jsts.triangulate.quadedge.QuadEdgeSubdivision.prototype.isFrameBorderEdge=function(e){var leftTri,rightTri,vLeftTriOther,vRightTriOther;leftTri=new Array(3);this.getTriangleEdges(e,leftTri);rightTri=new Array(3);this.getTriangleEdges(e.sym(),rightTri);vLeftTriOther=e.lNext().dest();if(this.isFrameVertex(vLeftTriOther)){return true;}
vRightTriOther=e.sym().lNext().dest();if(this.isFrameVertex(vRightTriOther)){return true;}
return false;};jsts.triangulate.quadedge.QuadEdgeSubdivision.prototype.isFrameVertex=function(v){if(v.equals(this.frameVertex[0])){return true;}
if(v.equals(this.frameVertex[1])){return true;}
if(v.equals(this.frameVertex[2])){return true;}
return false;};jsts.triangulate.quadedge.QuadEdgeSubdivision.prototype.isOnEdge=function(e,p){this.seg.setCoordinates(e.orig().getCoordinate(),e.dest().getCoordinate());var dist=this.seg.distance(p);return dist<this.edgeCoincidenceTolerance;};jsts.triangulate.quadedge.QuadEdgeSubdivision.prototype.isVertexOfEdge=function(e,v){if((v.equals(e.orig(),this.tolerance))||(v.equals(e.dest(),this.tolerance))){return true;}
return false;};jsts.triangulate.quadedge.QuadEdgeSubdivision.prototype.getVertices=function(includeFrame)
{var vertices=[],i,il,qe,v,vd;i=0,il=this.quadEdges.length;for(i;i<il;i++){qe=this.quadEdges[i];v=qe.orig();if(includeFrame||!this.isFrameVertex(v)){vertices.push(v);}
vd=qe.dest();if(includeFrame||!this.isFrameVertex(vd)){vertices.push(vd);}}
return vertices;};jsts.triangulate.quadedge.QuadEdgeSubdivision.prototype.getVertexUniqueEdges=function(includeFrame)
{var edges,visitedVertices,i,il,qe,v,qd,vd;edges=[];visitedVertices=[];i=0,il=this.quadEdges.length;for(i;i<il;i++){qe=this.quadEdges[i];v=qe.orig();if(visitedVertices.indexOf(v)===-1){visitedVertices.push(v);if(includeFrame||!this.isFrameVertex(v)){edges.push(qe);}}
qd=qe.sym();vd=qd.orig();if(visitedVertices.indexOf(vd)===-1){visitedVertices.push(vd);if(includeFrame||!this.isFrameVertex(vd)){edges.push(qd);}}}
return edges;};jsts.triangulate.quadedge.QuadEdgeSubdivision.prototype.getPrimaryEdges=function(includeFrame){this.visitedKey++;var edges,edgeStack,visitedEdges,edge,priQE;edges=[];edgeStack=[];edgeStack.push(this.startingEdge);visitedEdges=[];while(edgeStack.length>0){edge=edgeStack.pop();if(visitedEdges.indexOf(edge)===-1){priQE=edge.getPrimary();if(includeFrame||!this.isFrameEdge(priQE)){edges.push(priQE);}
edgeStack.push(edge.oNext());edgeStack.push(edge.sym().oNext());visitedEdges.push(edge);visitedEdges.push(edge.sym());}}
return edges;};jsts.triangulate.quadedge.QuadEdgeSubdivision.prototype.visitTriangles=function(triVisitor,includeFrame){this.visitedKey++;var edgeStack,visitedEdges,edge,triEdges;edgeStack=[];edgeStack.push(this.startingEdge);visitedEdges=[];while(edgeStack.length>0){edge=edgeStack.pop();if(visitedEdges.indexOf(edge)===-1){triEdges=this.fetchTriangleToVisit(edge,edgeStack,includeFrame,visitedEdges);if(triEdges!==null)
triVisitor.visit(triEdges);}}};jsts.triangulate.quadedge.QuadEdgeSubdivision.prototype.fetchTriangleToVisit=function(edge,edgeStack,includeFrame,visitedEdges){var curr,edgeCount,isFrame,sym;curr=edge;edgeCount=0;isFrame=false;do{this.triEdges[edgeCount]=curr;if(this.isFrameEdge(curr)){isFrame=true;}
sym=curr.sym();if(visitedEdges.indexOf(sym)===-1){edgeStack.push(sym);}
visitedEdges.push(curr);edgeCount++;curr=curr.lNext();}while(curr!==edge);if(isFrame&&!includeFrame){return null;}
return this.triEdges;};jsts.triangulate.quadedge.QuadEdgeSubdivision.prototype.getTriangleEdges=function(includeFrame){var visitor=new jsts.triangulate.quadedge.TriangleEdgesListVisitor();this.visitTriangles(visitor,includeFrame);return visitor.getTriangleEdges();};jsts.triangulate.quadedge.QuadEdgeSubdivision.prototype.getTriangleVertices=function(includeFrame){var visitor=new TriangleVertexListVisitor();this.visitTriangles(visitor,includeFrame);return visitor.getTriangleVertices();};jsts.triangulate.quadedge.QuadEdgeSubdivision.prototype.getTriangleCoordinates=function(includeFrame){var visitor=new jsts.triangulate.quadedge.TriangleCoordinatesVisitor();this.visitTriangles(visitor,includeFrame);return visitor.getTriangles();};jsts.triangulate.quadedge.QuadEdgeSubdivision.prototype.getEdgesByFactory=function(geomFact){var quadEdges,edges,i,il,qe,coords;quadEdges=this.getPrimaryEdges(false);edges=[];i=0;il=quadEdges.length;for(i;i<il;i++){qe=quadEdges[i];coords=[];coords[0]=(qe.orig().getCoordinate());coords[1]=(qe.dest().getCoordinate());edges[i]=geomFact.createLineString(coords);}
return geomFact.createMultiLineString(edges);};jsts.triangulate.quadedge.QuadEdgeSubdivision.prototype.getTriangles=function(geomFact){var triPtsList,tris,triPt,i,il;triPtsList=this.getTriangleCoordinates(false);tris=new Array(triPtsList.length);i=0,il=triPtsList.length;for(i;i<il;i++){triPt=triPtsList[i];tris[i]=geomFact.createPolygon(geomFact.createLinearRing(triPt,null));}
return geomFact.createGeometryCollection(tris);};jsts.triangulate.quadedge.QuadEdgeSubdivision.prototype.getVoronoiDiagram=function(geomFact)
{var vorCells=this.getVoronoiCellPolygons(geomFact);return geomFact.createGeometryCollection(vorCells);};jsts.triangulate.quadedge.QuadEdgeSubdivision.prototype.getVoronoiCellPolygons=function(geomFact)
{this.visitTriangles(new jsts.triangulate.quadedge.TriangleCircumcentreVisitor(),true);var cells,edges,i,il,qe;cells=[];edges=this.getVertexUniqueEdges(false);i=0,il=edges.length;for(i;i<il;i++){qe=edges[i];cells.push(this.getVoronoiCellPolygon(qe,geomFact));}
return cells;};jsts.triangulate.quadedge.QuadEdgeSubdivision.prototype.getVoronoiCellPolygon=function(qe,geomFact)
{var cellPts,startQe,cc,coordList,cellPoly,v;cellPts=[];startQE=qe;do{cc=qe.rot.orig().getCoordinate();cellPts.push(cc);qe=qe.oPrev();}while(qe!==startQE);coordList=new jsts.geom.CoordinateList([],false);coordList.add(cellPts,false);coordList.closeRing();if(coordList.size()<4){coordList.add(coordList.get(coordList.size()-1),true);}
cellPoly=geomFact.createPolygon(geomFact.createLinearRing(coordList.toArray()),null);v=startQE.orig();return cellPoly;};jsts.triangulate.quadedge.TriangleCircumcentreVisitor=function(){};jsts.triangulate.quadedge.TriangleCircumcentreVisitor.prototype.visit=function(triEdges){var a,b,c,cc,ccVertex,i;a=triEdges[0].orig().getCoordinate();b=triEdges[1].orig().getCoordinate();c=triEdges[2].orig().getCoordinate();cc=jsts.geom.Triangle.circumcentre(a,b,c);ccVertex=new jsts.triangulate.quadedge.Vertex(cc);i=0;for(i;i<3;i++){triEdges[i].rot.setOrig(ccVertex);}};jsts.triangulate.quadedge.TriangleEdgesListVisitor=function(){this.triList=[];};jsts.triangulate.quadedge.TriangleEdgesListVisitor.prototype.visit=function(triEdges){var clone=triEdges.concat();this.triList.push(clone);};jsts.triangulate.quadedge.TriangleEdgesListVisitor.prototype.getTriangleEdges=function(){return this.triList;};jsts.triangulate.quadedge.TriangleVertexListVisitor=function(){this.triList=[];};jsts.triangulate.quadedge.TriangleVertexListVisitor.prototype.visit=function(triEdges){var vertices=[];vertices.push(trieEdges[0].orig());vertices.push(trieEdges[1].orig());vertices.push(trieEdges[2].orig());this.triList.push(vertices);};jsts.triangulate.quadedge.TriangleVertexListVisitor.prototype.getTriangleVertices=function(){return this.triList;};jsts.triangulate.quadedge.TriangleCoordinatesVisitor=function(){this.coordList=new jsts.geom.CoordinateList([],false);this.triCoords=[];};jsts.triangulate.quadedge.TriangleCoordinatesVisitor.prototype.visit=function(triEdges){this.coordList=new jsts.geom.CoordinateList([],false);var i=0,v,pts;for(i;i<3;i++){v=triEdges[i].orig();this.coordList.add(v.getCoordinate());}
if(this.coordList.size()>0){this.coordList.closeRing();pts=this.coordList.toArray();if(pts.length!==4){return;}
this.triCoords.push(pts);}};jsts.triangulate.quadedge.TriangleCoordinatesVisitor.prototype.getTriangles=function(){return this.triCoords;};jsts.operation.relate.EdgeEndBundle=function(){this.edgeEnds=[];var e=arguments[0]instanceof jsts.geomgraph.EdgeEnd?arguments[0]:arguments[1];var edge=e.getEdge();var coord=e.getCoordinate();var dirCoord=e.getDirectedCoordinate();var label=new jsts.geomgraph.Label(e.getLabel());jsts.geomgraph.EdgeEnd.call(this,edge,coord,dirCoord,label);this.insert(e);};jsts.operation.relate.EdgeEndBundle.prototype=new jsts.geomgraph.EdgeEnd();jsts.operation.relate.EdgeEndBundle.prototype.edgeEnds=null;jsts.operation.relate.EdgeEndBundle.prototype.getLabel=function(){return this.label;};jsts.operation.relate.EdgeEndBundle.prototype.getEdgeEnds=function(){return this.edgeEnds;};jsts.operation.relate.EdgeEndBundle.prototype.insert=function(e){this.edgeEnds.push(e);};jsts.operation.relate.EdgeEndBundle.prototype.computeLabel=function(boundaryNodeRule){var isArea=false;for(var i=0;i<this.edgeEnds.length;i++){var e=this.edgeEnds[i];if(e.getLabel().isArea())
isArea=true;}
if(isArea)
this.label=new jsts.geomgraph.Label(jsts.geom.Location.NONE,jsts.geom.Location.NONE,jsts.geom.Location.NONE);else
this.label=new jsts.geomgraph.Label(jsts.geom.Location.NONE);for(var i=0;i<2;i++){this.computeLabelOn(i,boundaryNodeRule);if(isArea)
this.computeLabelSides(i);}};jsts.operation.relate.EdgeEndBundle.prototype.computeLabelOn=function(geomIndex,boundaryNodeRule){var boundaryCount=0;var foundInterior=false;for(var i=0;i<this.edgeEnds.length;i++){var e=this.edgeEnds[i];var loc=e.getLabel().getLocation(geomIndex);if(loc==jsts.geom.Location.BOUNDARY)
boundaryCount++;if(loc==jsts.geom.Location.INTERIOR)
foundInterior=true;}
var loc=jsts.geom.Location.NONE;if(foundInterior)
loc=jsts.geom.Location.INTERIOR;if(boundaryCount>0){loc=jsts.geomgraph.GeometryGraph.determineBoundary(boundaryNodeRule,boundaryCount);}
this.label.setLocation(geomIndex,loc);};jsts.operation.relate.EdgeEndBundle.prototype.computeLabelSides=function(geomIndex){this.computeLabelSide(geomIndex,jsts.geomgraph.Position.LEFT);this.computeLabelSide(geomIndex,jsts.geomgraph.Position.RIGHT);};jsts.operation.relate.EdgeEndBundle.prototype.computeLabelSide=function(geomIndex,side){for(var i=0;i<this.edgeEnds.length;i++){var e=this.edgeEnds[i];if(e.getLabel().isArea()){var loc=e.getLabel().getLocation(geomIndex,side);if(loc===jsts.geom.Location.INTERIOR){this.label.setLocation(geomIndex,side,jsts.geom.Location.INTERIOR);return;}else if(loc===jsts.geom.Location.EXTERIOR)
this.label.setLocation(geomIndex,side,jsts.geom.Location.EXTERIOR);}}};jsts.operation.relate.EdgeEndBundle.prototype.updateIM=function(im){jsts.geomgraph.Edge.updateIM(this.label,im);};jsts.index.kdtree.KdTree=function(tolerance){var tol=0.0;if(tolerance!==undefined){tol=tolerance;}
this.root=null;this.last=null;this.numberOfNodes=0;this.tolerance=tol;};jsts.index.kdtree.KdTree.prototype.insert=function(){if(arguments.length===1){return this.insertCoordinate.apply(this,arguments[0]);}else{return this.insertWithData.apply(this,arguments[0],arguments[1]);}};jsts.index.kdtree.KdTree.prototype.insertCoordinate=function(p){return this.insertWithData(p,null);};jsts.index.kdtree.KdTree.prototype.insertWithData=function(p,data){if(this.root===null){this.root=new jsts.index.kdtree.KdNode(p,data);return this.root;}
var currentNode=this.root,leafNode=this.root,isOddLevel=true,isLessThan=true;while(currentNode!==last){if(isOddLevel){isLessThan=p.x<currentNode.getX();}else{isLessThan=p.y<currentNode.getY();}
leafNode=currentNode;if(isLessThan){currentNode=currentNode.getLeft();}else{currentNode=currentNode.getRight();}
if(currentNode!==null){var isInTolerance=p.distance(currentNode.getCoordinate())<=this.tolerance;if(isInTolerance){currentNode.increment();return currentNode;}}
isOddLevel=!isOddLevel;}
this.numberOfNodes=numberOfNodes+1;var node=new jsts.index.kdtree.KdNode(p,data);node.setLeft(this.last);node.setRight(this.last);if(isLessThan){leafNode.setLeft(node);}else{leafNode.setRight(node);}
return node;};jsts.index.kdtree.KdTree.prototype.queryNode=function(currentNode,bottomNode,queryEnv,odd,result){if(currentNode===bottomNode){return;}
var min,max,discriminant;if(odd){min=queryEnv.getMinX();max=queryEnv.getMaxX();discriminant=currentNode.getX();}else{min=queryEnv.getMinY();max=queryEnv.getMaxY();discriminant=currentNode.getY();}
var searchLeft=min<discriminant;var searchRight=discriminant<=max;if(searchLeft){this.queryNode(currentNode.getLeft(),bottomNode,queryEnv,!odd,result);}
if(queryEnv.contains(currentNode.getCoordinate())){result.add(currentNode);}
if(searchRight){this.queryNode(currentNode.getRight(),bottomNode,queryEnv,!odd,result);}};jsts.index.kdtree.KdTree.prototype.query=function(){if(arguments.length===1){return this.queryByEnvelope.apply(this,arguments[0]);}else{return this.queryWithArray.apply(this,arguments[0],arguments[1]);}};jsts.index.kdtree.KdTree.prototype.queryByEnvelope=function(queryEnv){var result=[];this.queryNode(this.root,this.last,queryEnv,true,result);return result;};jsts.index.kdtree.KdTree.prototype.queryWithArray=function(queryEnv,result){this.queryNode(this.root,this.last,queryEnv,true,result);};jsts.geom.Triangle=function(p0,p1,p2){this.p0=p0;this.p1=p1;this.p2=p2;};jsts.geom.Triangle.isAcute=function(a,b,c){if(!jsts.algorithm.Angle.isAcute(a,b,c)){return false;}
if(!jsts.algorithm.Angle.isAcute(b,c,a)){return false;}
if(!jsts.algorithm.Angle.isAcute(c,a,b)){return false;}
return true;};jsts.geom.Triangle.perpendicularBisector=function(a,b){var dx,dy,l1,l2;dx=b.x-a.x;dy=b.y-a.y;l1=new jsts.algorithm.HCoordinate(a.x+dx/2.0,a.y+dy/2.0,1.0);l2=new jsts.algorithm.HCoordinate(a.x-dy+dx/2.0,a.y+dx+dy/2.0,1.0);return new jsts.algorithm.HCoordinate(l1,l2);};jsts.geom.Triangle.circumcentre=function(a,b,c){var cx,cy,ax,ay,bx,by,denom,numx,numy,ccx,ccy;cx=c.x;cy=c.y;ax=a.x-cx;ay=a.y-cy;bx=b.x-cx;by=b.y-cy;denom=2*jsts.geom.Triangle.det(ax,ay,bx,by);numx=jsts.geom.Triangle.det(ay,ax*ax+ay*ay,by,bx*bx+by*by);numy=jsts.geom.Triangle.det(ax,ax*ax+ay*ay,bx,bx*bx+by*by);ccx=cx-numx/denom;ccy=cy+numy/denom;return new jsts.geom.Coordinate(ccx,ccy);};jsts.geom.Triangle.det=function(m00,m01,m10,m11){return m00*m11-m01*m10;};jsts.geom.Triangle.inCentre=function(a,b,c){var len0,len1,len2,circum,inCentreX,inCentreY;len0=b.distance(c);len1=a.distance(c);len2=a.distance(b);circum=len0+len1+len2;inCentreX=(len0*a.x+len1*b.x+len2*c.x)/circum;inCentreY=(len0*a.y+len1*b.y+len2*c.y)/circum;return new jsts.geom.Coordinate(inCentreX,inCentreY);};jsts.geom.Triangle.centroid=function(a,b,c){var x,y;x=(a.x+b.x+c.x)/3;y=(a.y+b.y+c.y)/3;return new jsts.geom.Coordinate(x,y);};jsts.geom.Triangle.longestSideLength=function(a,b,c){var lenAB,lenBC,lenCA,maxLen;lenAB=a.distance(b);lenBC=b.distance(c);lenCA=c.distance(a);maxLen=lenAB;if(lenBC>maxLen){maxLen=lenBC;}
if(lenCA>maxLen){maxLen=lenCA;}
return maxLen;};jsts.geom.Triangle.angleBisector=function(a,b,c){var len0,len2,frac,dx,dy,splitPt;len0=b.distance(a);len2=b.distance(c);frac=len0/(len0+len2);dx=c.x-a.x;dy=c.y-a.y;splitPt=new jsts.geom.Coordinate(a.x+frac*dx,a.y+frac*dy);return splitPt;};jsts.geom.Triangle.area=function(a,b,c){return Math.abs(((c.x-a.x)*(b.y-a.y)-(b.x-a.x)*(c.y-a.y))/2.0);};jsts.geom.Triangle.signedArea=function(a,b,c){return((c.x-a.x)*(b.y-a.y)-(b.x-a.x)*(c.y-a.y))/2.0;};jsts.geom.Triangle.prototype.inCentre=function(){return jsts.geom.Triangle.inCentre(this.p0,this.p1,this.p2);};jsts.noding.OrientedCoordinateArray=function(pts){this.pts=pts;this._orientation=jsts.noding.OrientedCoordinateArray.orientation(pts);};jsts.noding.OrientedCoordinateArray.prototype.pts=null;jsts.noding.OrientedCoordinateArray.prototype._orientation=undefined;jsts.noding.OrientedCoordinateArray.orientation=function(pts){return jsts.geom.CoordinateArrays.increasingDirection(pts)===1;};jsts.noding.OrientedCoordinateArray.prototype.compareTo=function(o1){var oca=o1;var comp=jsts.noding.OrientedCoordinateArray.compareOriented(this.pts,this._orientation,oca.pts,oca._orientation);return comp;};jsts.noding.OrientedCoordinateArray.compareOriented=function(pts1,orientation1,pts2,orientation2){var dir1=orientation1?1:-1;var dir2=orientation2?1:-1;var limit1=orientation1?pts1.length:-1;var limit2=orientation2?pts2.length:-1;var i1=orientation1?0:pts1.length-1;var i2=orientation2?0:pts2.length-1;var comp=0;while(true){var compPt=pts1[i1].compareTo(pts2[i2]);if(compPt!==0)
return compPt;i1+=dir1;i2+=dir2;var done1=i1===limit1;var done2=i2===limit2;if(done1&&!done2)
return-1;if(!done1&&done2)
return 1;if(done1&&done2)
return 0;}};jsts.algorithm.CentralEndpointIntersector=function(p00,p01,p10,p11){this.pts=[p00,p01,p10,p11];this.compute();};jsts.algorithm.CentralEndpointIntersector.getIntersection=function(p00,p01,p10,p11){var intor=new jsts.algorithm.CentralEndpointIntersector(p00,p01,p10,p11);return intor.getIntersection();};jsts.algorithm.CentralEndpointIntersector.prototype.pts=null;jsts.algorithm.CentralEndpointIntersector.prototype.intPt=null;jsts.algorithm.CentralEndpointIntersector.prototype.compute=function(){var centroid=jsts.algorithm.CentralEndpointIntersector.average(this.pts);this.intPt=this.findNearestPoint(centroid,this.pts);};jsts.algorithm.CentralEndpointIntersector.prototype.getIntersection=function(){return this.intPt;};jsts.algorithm.CentralEndpointIntersector.average=function(pts){var avg=new jsts.geom.Coordinate();var i,n=pts.length;for(i=0;i<n;i++){avg.x+=pts[i].x;avg.y+=pts[i].y;}
if(n>0){avg.x/=n;avg.y/=n;}
return avg;};jsts.algorithm.CentralEndpointIntersector.prototype.findNearestPoint=function(p,pts){var minDist=Number.MAX_VALUE;var i,result=null,dist;for(i=0;i<pts.length;i++){dist=p.distance(pts[i]);if(dist<minDist){minDist=dist;result=pts[i];}}
return result;};jsts.operation.buffer.BufferOp=function(g,bufParams){this.argGeom=g;this.bufParams=bufParams?bufParams:new jsts.operation.buffer.BufferParameters();};jsts.operation.buffer.BufferOp.MAX_PRECISION_DIGITS=12;jsts.operation.buffer.BufferOp.precisionScaleFactor=function(g,distance,maxPrecisionDigits){var env=g.getEnvelopeInternal();var envSize=Math.max(env.getHeight(),env.getWidth());var expandByDistance=distance>0.0?distance:0.0;var bufEnvSize=envSize+2*expandByDistance;var bufEnvLog10=(Math.log(bufEnvSize)/Math.log(10)+1.0);var minUnitLog10=bufEnvLog10-maxPrecisionDigits;var scaleFactor=Math.pow(10.0,-minUnitLog10);return scaleFactor;};jsts.operation.buffer.BufferOp.bufferOp=function(g,distance){if(arguments.length>2){return jsts.operation.buffer.BufferOp.bufferOp2.apply(this,arguments);}
var gBuf=new jsts.operation.buffer.BufferOp(g);var geomBuf=gBuf.getResultGeometry(distance);return geomBuf;};jsts.operation.buffer.BufferOp.bufferOp2=function(g,distance,params){if(arguments.length>3){return jsts.operation.buffer.BufferOp.bufferOp3.apply(this,arguments);}
var bufOp=new jsts.operation.buffer.BufferOp(g,params);var geomBuf=bufOp.getResultGeometry(distance);return geomBuf;};jsts.operation.buffer.BufferOp.bufferOp3=function(g,distance,quadrantSegments){if(arguments.length>4){return jsts.operation.buffer.BufferOp.bufferOp4.apply(this,arguments);}
var bufOp=new jsts.operation.buffer.BufferOp(g);bufOp.setQuadrantSegments(quadrantSegments);var geomBuf=bufOp.getResultGeometry(distance);return geomBuf;};jsts.operation.buffer.BufferOp.bufferOp4=function(g,distance,quadrantSegments,endCapStyle){var bufOp=new jsts.operation.buffer.BufferOp(g);bufOp.setQuadrantSegments(quadrantSegments);bufOp.setEndCapStyle(endCapStyle);var geomBuf=bufOp.getResultGeometry(distance);return geomBuf;};jsts.operation.buffer.BufferOp.prototype.argGeom=null;jsts.operation.buffer.BufferOp.prototype.distance=null;jsts.operation.buffer.BufferOp.prototype.bufParams=null;jsts.operation.buffer.BufferOp.prototype.resultGeometry=null;jsts.operation.buffer.BufferOp.prototype.setEndCapStyle=function(endCapStyle){this.bufParams.setEndCapStyle(endCapStyle);};jsts.operation.buffer.BufferOp.prototype.setQuadrantSegments=function(quadrantSegments){this.bufParams.setQuadrantSegments(quadrantSegments);};jsts.operation.buffer.BufferOp.prototype.getResultGeometry=function(dist){this.distance=dist;this.computeGeometry();return this.resultGeometry;};jsts.operation.buffer.BufferOp.prototype.computeGeometry=function(){this.bufferOriginalPrecision();if(this.resultGeometry!==null){return;}
var argPM=this.argGeom.getPrecisionModel();if(argPM.getType()===jsts.geom.PrecisionModel.FIXED){this.bufferFixedPrecision(argPM);}else{this.bufferReducedPrecision();}};jsts.operation.buffer.BufferOp.prototype.bufferReducedPrecision=function(){var precDigits;var saveException=null;for(precDigits=jsts.operation.buffer.BufferOp.MAX_PRECISION_DIGITS;precDigits>=0;precDigits--){try{this.bufferReducedPrecision2(precDigits);}catch(ex){saveException=ex;}
if(this.resultGeometry!==null){return;}}
throw saveException;};jsts.operation.buffer.BufferOp.prototype.bufferOriginalPrecision=function(){try{var bufBuilder=new jsts.operation.buffer.BufferBuilder(this.bufParams);this.resultGeometry=bufBuilder.buffer(this.argGeom,this.distance);}catch(e){}};jsts.operation.buffer.BufferOp.prototype.bufferReducedPrecision2=function(precisionDigits){var sizeBasedScaleFactor=jsts.operation.buffer.BufferOp.precisionScaleFactor(this.argGeom,this.distance,precisionDigits);var fixedPM=new jsts.geom.PrecisionModel(sizeBasedScaleFactor);this.bufferFixedPrecision(fixedPM);};jsts.operation.buffer.BufferOp.prototype.bufferFixedPrecision=function(fixedPM){var noder=new jsts.noding.ScaledNoder(new jsts.noding.snapround.MCIndexSnapRounder(new jsts.geom.PrecisionModel(1.0)),fixedPM.getScale());var bufBuilder=new jsts.operation.buffer.BufferBuilder(this.bufParams);bufBuilder.setWorkingPrecisionModel(fixedPM);bufBuilder.setNoder(noder);this.resultGeometry=bufBuilder.buffer(this.argGeom,this.distance);};(function(){var Location=jsts.geom.Location;var Position=jsts.geomgraph.Position;var Assert=jsts.util.Assert;jsts.geomgraph.GeometryGraph=function(argIndex,parentGeom,boundaryNodeRule){jsts.geomgraph.PlanarGraph.call(this);this.lineEdgeMap=new javascript.util.HashMap();this.ptLocator=new jsts.algorithm.PointLocator();this.argIndex=argIndex;this.parentGeom=parentGeom;this.boundaryNodeRule=boundaryNodeRule||jsts.algorithm.BoundaryNodeRule.OGC_SFS_BOUNDARY_RULE;if(parentGeom!==null){this.add(parentGeom);}};jsts.geomgraph.GeometryGraph.prototype=new jsts.geomgraph.PlanarGraph();jsts.geomgraph.GeometryGraph.constructor=jsts.geomgraph.GeometryGraph;jsts.geomgraph.GeometryGraph.prototype.createEdgeSetIntersector=function(){return new jsts.geomgraph.index.SimpleMCSweepLineIntersector();};jsts.geomgraph.GeometryGraph.determineBoundary=function(boundaryNodeRule,boundaryCount){return boundaryNodeRule.isInBoundary(boundaryCount)?Location.BOUNDARY:Location.INTERIOR;};jsts.geomgraph.GeometryGraph.prototype.parentGeom=null;jsts.geomgraph.GeometryGraph.prototype.lineEdgeMap=null;jsts.geomgraph.GeometryGraph.prototype.boundaryNodeRule=null;jsts.geomgraph.GeometryGraph.prototype.useBoundaryDeterminationRule=true;jsts.geomgraph.GeometryGraph.prototype.argIndex=null;jsts.geomgraph.GeometryGraph.prototype.boundaryNodes=null;jsts.geomgraph.GeometryGraph.prototype.hasTooFewPoints=false;jsts.geomgraph.GeometryGraph.prototype.invalidPoint=null;jsts.geomgraph.GeometryGraph.prototype.areaPtLocator=null;jsts.geomgraph.GeometryGraph.prototype.ptLocator=null;jsts.geomgraph.GeometryGraph.prototype.getGeometry=function(){return this.parentGeom;};jsts.geomgraph.GeometryGraph.prototype.getBoundaryNodes=function(){if(this.boundaryNodes===null)
this.boundaryNodes=this.nodes.getBoundaryNodes(this.argIndex);return this.boundaryNodes;};jsts.geomgraph.GeometryGraph.prototype.getBoundaryNodeRule=function(){return this.boundaryNodeRule;};jsts.geomgraph.GeometryGraph.prototype.findEdge=function(line){return this.lineEdgeMap.get(line);};jsts.geomgraph.GeometryGraph.prototype.computeSplitEdges=function(edgelist){for(var i=this.edges.iterator();i.hasNext();){var e=i.next();e.eiList.addSplitEdges(edgelist);}}
jsts.geomgraph.GeometryGraph.prototype.add=function(g){if(g.isEmpty()){return;}
if(g instanceof jsts.geom.MultiPolygon)
this.useBoundaryDeterminationRule=false;if(g instanceof jsts.geom.Polygon)
this.addPolygon(g);else if(g instanceof jsts.geom.LineString)
this.addLineString(g);else if(g instanceof jsts.geom.Point)
this.addPoint(g);else if(g instanceof jsts.geom.MultiPoint)
this.addCollection(g);else if(g instanceof jsts.geom.MultiLineString)
this.addCollection(g);else if(g instanceof jsts.geom.MultiPolygon)
this.addCollection(g);else if(g instanceof jsts.geom.GeometryCollection)
this.addCollection(g);else
throw new jsts.error.IllegalArgumentError('Geometry type not supported.');};jsts.geomgraph.GeometryGraph.prototype.addCollection=function(gc){for(var i=0;i<gc.getNumGeometries();i++){var g=gc.getGeometryN(i);this.add(g);}};jsts.geomgraph.GeometryGraph.prototype.addEdge=function(e){this.insertEdge(e);var coord=e.getCoordinates();this.insertPoint(this.argIndex,coord[0],Location.BOUNDARY);this.insertPoint(this.argIndex,coord[coord.length-1],Location.BOUNDARY);};jsts.geomgraph.GeometryGraph.prototype.addPoint=function(p){var coord=p.getCoordinate();this.insertPoint(this.argIndex,coord,Location.INTERIOR);};jsts.geomgraph.GeometryGraph.prototype.addLineString=function(line){var coord=jsts.geom.CoordinateArrays.removeRepeatedPoints(line.getCoordinates());if(coord.length<2){this.hasTooFewPoints=true;this.invalidPoint=coords[0];return;}
var e=new jsts.geomgraph.Edge(coord,new jsts.geomgraph.Label(this.argIndex,Location.INTERIOR));this.lineEdgeMap.put(line,e);this.insertEdge(e);Assert.isTrue(coord.length>=2,'found LineString with single point');this.insertBoundaryPoint(this.argIndex,coord[0]);this.insertBoundaryPoint(this.argIndex,coord[coord.length-1]);};jsts.geomgraph.GeometryGraph.prototype.addPolygonRing=function(lr,cwLeft,cwRight){if(lr.isEmpty())
return;var coord=jsts.geom.CoordinateArrays.removeRepeatedPoints(lr.getCoordinates());if(coord.length<4){this.hasTooFewPoints=true;this.invalidPoint=coord[0];return;}
var left=cwLeft;var right=cwRight;if(jsts.algorithm.CGAlgorithms.isCCW(coord)){left=cwRight;right=cwLeft;}
var e=new jsts.geomgraph.Edge(coord,new jsts.geomgraph.Label(this.argIndex,Location.BOUNDARY,left,right));this.lineEdgeMap.put(lr,e);this.insertEdge(e);this.insertPoint(this.argIndex,coord[0],Location.BOUNDARY);};jsts.geomgraph.GeometryGraph.prototype.addPolygon=function(p){this.addPolygonRing(p.getExteriorRing(),Location.EXTERIOR,Location.INTERIOR);for(var i=0;i<p.getNumInteriorRing();i++){var hole=p.getInteriorRingN(i);this.addPolygonRing(hole,Location.INTERIOR,Location.EXTERIOR);}};jsts.geomgraph.GeometryGraph.prototype.computeEdgeIntersections=function(g,li,includeProper){var si=new jsts.geomgraph.index.SegmentIntersector(li,includeProper,true);si.setBoundaryNodes(this.getBoundaryNodes(),g.getBoundaryNodes());var esi=this.createEdgeSetIntersector();esi.computeIntersections(this.edges,g.edges,si);return si;};jsts.geomgraph.GeometryGraph.prototype.computeSelfNodes=function(li,computeRingSelfNodes){var si=new jsts.geomgraph.index.SegmentIntersector(li,true,false);var esi=this.createEdgeSetIntersector();if(!computeRingSelfNodes&&(this.parentGeom instanceof jsts.geom.LinearRing||this.parentGeom instanceof jsts.geom.Polygon||this.parentGeom instanceof jsts.geom.MultiPolygon)){esi.computeIntersections(this.edges,si,false);}else{esi.computeIntersections(this.edges,si,true);}
this.addSelfIntersectionNodes(this.argIndex);return si;};jsts.geomgraph.GeometryGraph.prototype.insertPoint=function(argIndex,coord,onLocation){var n=this.nodes.addNode(coord);var lbl=n.getLabel();if(lbl==null){n.label=new jsts.geomgraph.Label(argIndex,onLocation);}else
lbl.setLocation(argIndex,onLocation);};jsts.geomgraph.GeometryGraph.prototype.insertBoundaryPoint=function(argIndex,coord){var n=this.nodes.addNode(coord);var lbl=n.getLabel();var boundaryCount=1;var loc=Location.NONE;if(lbl!==null)
loc=lbl.getLocation(argIndex,Position.ON);if(loc===Location.BOUNDARY)
boundaryCount++;var newLoc=jsts.geomgraph.GeometryGraph.determineBoundary(this.boundaryNodeRule,boundaryCount);lbl.setLocation(argIndex,newLoc);};jsts.geomgraph.GeometryGraph.prototype.addSelfIntersectionNodes=function(argIndex){for(var i=this.edges.iterator();i.hasNext();){var e=i.next();var eLoc=e.getLabel().getLocation(argIndex);for(var eiIt=e.eiList.iterator();eiIt.hasNext();){var ei=eiIt.next();this.addSelfIntersectionNode(argIndex,ei.coord,eLoc);}}};jsts.geomgraph.GeometryGraph.prototype.addSelfIntersectionNode=function(argIndex,coord,loc){if(this.isBoundaryNode(argIndex,coord))
return;if(loc===Location.BOUNDARY&&this.useBoundaryDeterminationRule)
this.insertBoundaryPoint(argIndex,coord);else
this.insertPoint(argIndex,coord,loc);};jsts.geomgraph.GeometryGraph.prototype.getInvalidPoint=function(){return this.invalidPoint;};})();jsts.operation.buffer.OffsetSegmentString=function(){this.ptList=[];};jsts.operation.buffer.OffsetSegmentString.prototype.ptList=null;jsts.operation.buffer.OffsetSegmentString.prototype.precisionModel=null;jsts.operation.buffer.OffsetSegmentString.prototype.minimimVertexDistance=0.0;jsts.operation.buffer.OffsetSegmentString.prototype.setPrecisionModel=function(precisionModel){this.precisionModel=precisionModel;};jsts.operation.buffer.OffsetSegmentString.prototype.setMinimumVertexDistance=function(minimimVertexDistance){this.minimimVertexDistance=minimimVertexDistance;};jsts.operation.buffer.OffsetSegmentString.prototype.addPt=function(pt){var bufPt=new jsts.geom.Coordinate(pt);this.precisionModel.makePrecise(bufPt);if(this.isRedundant(bufPt))
return;this.ptList.push(bufPt);};jsts.operation.buffer.OffsetSegmentString.prototype.addPts=function(pt,isForward){if(isForward){for(var i=0;i<pt.length;i++){this.addPt(pt[i]);}}else{for(var i=pt.length-1;i>=0;i--){this.addPt(pt[i]);}}};jsts.operation.buffer.OffsetSegmentString.prototype.isRedundant=function(pt){if(this.ptList.length<1)
return false;var lastPt=this.ptList[this.ptList.length-1];var ptDist=pt.distance(lastPt);if(ptDist<this.minimimVertexDistance)
return true;return false;};jsts.operation.buffer.OffsetSegmentString.prototype.closeRing=function(){if(this.ptList.length<1)
return;var startPt=new jsts.geom.Coordinate(this.ptList[0]);var lastPt=this.ptList[this.ptList.length-1];var last2Pt=null;if(this.ptList.length>=2)
last2Pt=this.ptList[this.ptList.length-2];if(startPt.equals(lastPt))
return;this.ptList.push(startPt);};jsts.operation.buffer.OffsetSegmentString.prototype.reverse=function(){};jsts.operation.buffer.OffsetSegmentString.prototype.getCoordinates=function(){return this.ptList;};jsts.algorithm.distance.PointPairDistance=function(){this.pt=[new jsts.geom.Coordinate(),new jsts.geom.Coordinate()];};jsts.algorithm.distance.PointPairDistance.prototype.pt=null;jsts.algorithm.distance.PointPairDistance.prototype.distance=NaN;jsts.algorithm.distance.PointPairDistance.prototype.isNull=true;jsts.algorithm.distance.PointPairDistance.prototype.initialize=function(p0,p1,distance){if(p0===undefined){this.isNull=true;return;}
this.pt[0].setCoordinate(p0);this.pt[1].setCoordinate(p1);this.distance=distance!==undefined?distance:p0.distance(p1);this.isNull=false;};jsts.algorithm.distance.PointPairDistance.prototype.getDistance=function(){return this.distance;};jsts.algorithm.distance.PointPairDistance.prototype.getCoordinates=function(){return this.pt;};jsts.algorithm.distance.PointPairDistance.prototype.getCoordinate=function(i){return this.pt[i];};jsts.algorithm.distance.PointPairDistance.prototype.setMaximum=function(ptDist){if(arguments.length===2){this.setMaximum2.apply(this,arguments);return;}
this.setMaximum(ptDist.pt[0],ptDist.pt[1]);};jsts.algorithm.distance.PointPairDistance.prototype.setMaximum2=function(p0,p1){if(this.isNull){this.initialize(p0,p1);return;}
var dist=p0.distance(p1);if(dist>this.distance)
this.initialize(p0,p1,dist);};jsts.algorithm.distance.PointPairDistance.prototype.setMinimum=function(ptDist){if(arguments.length===2){this.setMinimum2.apply(this,arguments);return;}
this.setMinimum(ptDist.pt[0],ptDist.pt[1]);};jsts.algorithm.distance.PointPairDistance.prototype.setMinimum2=function(p0,p1){if(this.isNull){this.initialize(p0,p1);return;}
var dist=p0.distance(p1);if(dist<this.distance)
this.initialize(p0,p1,dist);};(function(){var PointPairDistance=jsts.algorithm.distance.PointPairDistance;var DistanceToPoint=jsts.algorithm.distance.DistanceToPoint;var MaxPointDistanceFilter=function(geom){this.maxPtDist=new PointPairDistance();this.minPtDist=new PointPairDistance();this.euclideanDist=new DistanceToPoint();this.geom=geom;};MaxPointDistanceFilter.prototype=new jsts.geom.CoordinateFilter();MaxPointDistanceFilter.prototype.maxPtDist=new PointPairDistance();MaxPointDistanceFilter.prototype.minPtDist=new PointPairDistance();MaxPointDistanceFilter.prototype.euclideanDist=new DistanceToPoint();MaxPointDistanceFilter.prototype.geom;MaxPointDistanceFilter.prototype.filter=function(pt){this.minPtDist.initialize();DistanceToPoint.computeDistance(this.geom,pt,this.minPtDist);this.maxPtDist.setMaximum(this.minPtDist);};MaxPointDistanceFilter.prototype.getMaxPointDistance=function(){return this.maxPtDist;};var MaxDensifiedByFractionDistanceFilter=function(geom,fraction){this.maxPtDist=new PointPairDistance();this.minPtDist=new PointPairDistance();this.geom=geom;this.numSubSegs=Math.round(1.0/fraction);};MaxDensifiedByFractionDistanceFilter.prototype=new jsts.geom.CoordinateSequenceFilter();MaxDensifiedByFractionDistanceFilter.prototype.maxPtDist=new PointPairDistance();MaxDensifiedByFractionDistanceFilter.prototype.minPtDist=new PointPairDistance();MaxDensifiedByFractionDistanceFilter.prototype.geom;MaxDensifiedByFractionDistanceFilter.prototype.numSubSegs=0;MaxDensifiedByFractionDistanceFilter.prototype.filter=function(seq,index){if(index==0)
return;var p0=seq[index-1];var p1=seq[index];var delx=(p1.x-p0.x)/this.numSubSegs;var dely=(p1.y-p0.y)/this.numSubSegs;for(var i=0;i<this.numSubSegs;i++){var x=p0.x+i*delx;var y=p0.y+i*dely;var pt=new jsts.geom.Coordinate(x,y);this.minPtDist.initialize();DistanceToPoint.computeDistance(this.geom,pt,this.minPtDist);this.maxPtDist.setMaximum(this.minPtDist);}};MaxDensifiedByFractionDistanceFilter.prototype.isGeometryChanged=function(){return false;};MaxDensifiedByFractionDistanceFilter.prototype.isDone=function(){return false;};MaxDensifiedByFractionDistanceFilter.prototype.getMaxPointDistance=function(){return this.maxPtDist;};jsts.algorithm.distance.DiscreteHausdorffDistance=function(g0,g1){this.g0=g0;this.g1=g1;this.ptDist=new jsts.algorithm.distance.PointPairDistance();};jsts.algorithm.distance.DiscreteHausdorffDistance.prototype.g0=null;jsts.algorithm.distance.DiscreteHausdorffDistance.prototype.g1=null;jsts.algorithm.distance.DiscreteHausdorffDistance.prototype.ptDist=null;jsts.algorithm.distance.DiscreteHausdorffDistance.prototype.densifyFrac=0.0;jsts.algorithm.distance.DiscreteHausdorffDistance.distance=function(g0,g1,densifyFrac){var dist=new jsts.algorithm.distance.DiscreteHausdorffDistance(g0,g1);if(densifyFrac!==undefined)
dist.setDensifyFraction(densifyFrac);return dist.distance();};jsts.algorithm.distance.DiscreteHausdorffDistance.prototype.setDensifyFraction=function(densifyFrac){if(densifyFrac>1.0||densifyFrac<=0.0)
throw new jsts.error.IllegalArgumentError('Fraction is not in range (0.0 - 1.0]');this.densifyFrac=densifyFrac;};jsts.algorithm.distance.DiscreteHausdorffDistance.prototype.distance=function(){this.compute(this.g0,this.g1);return ptDist.getDistance();};jsts.algorithm.distance.DiscreteHausdorffDistance.prototype.orientedDistance=function(){this.computeOrientedDistance(this.g0,this.g1,this.ptDist);return this.ptDist.getDistance();};jsts.algorithm.distance.DiscreteHausdorffDistance.prototype.getCoordinates=function(){return ptDist.getCoordinates();};jsts.algorithm.distance.DiscreteHausdorffDistance.prototype.compute=function(g0,g1){this.computeOrientedDistance(g0,g1,this.ptDist);this.computeOrientedDistance(g1,g0,this.ptDist);};jsts.algorithm.distance.DiscreteHausdorffDistance.prototype.computeOrientedDistance=function(discreteGeom,geom,ptDist){var distFilter=new MaxPointDistanceFilter(geom);discreteGeom.apply(distFilter);ptDist.setMaximum(distFilter.getMaxPointDistance());if(this.densifyFrac>0){var fracFilter=new MaxDensifiedByFractionDistanceFilter(geom,this.densifyFrac);discreteGeom.apply(fracFilter);ptDist.setMaximum(fracFilter.getMaxPointDistance());}};})();jsts.algorithm.MinimumBoundingCircle=function(geom){this.input=null;this.extremalPts=null;this.centre=null;this.radius=0;this.input=geom;};jsts.algorithm.MinimumBoundingCircle.prototype.getCircle=function(){this.compute();if(this.centre===null){return this.input.getFactory().createPolygon(null,null);}
var centrePoint=this.input.getFactory().createPoint(this.centre);if(this.radius===0){return centrePoint;}
return centrePoint.buffer(this.radius);};jsts.algorithm.MinimumBoundingCircle.prototype.getExtremalPoints=function(){this.compute();return this.extremalPts;};jsts.algorithm.MinimumBoundingCircle.prototype.getCentre=function(){this.compute();return this.centre;};jsts.algorithm.MinimumBoundingCircle.prototype.getRadius=function(){this.compute();return this.radius;};jsts.algorithm.MinimumBoundingCircle.prototype.computeCentre=function(){switch(this.extremalPts.length){case 0:this.centre=null;break;case 1:this.centre=this.extremalPts[0];break;case 2:this.centre=new jsts.geom.Coordinate((this.extremalPts[0].x+this.extremalPts[1].x)/2,(this.extremalPts[0].y+this.extremalPts[1].y)/2);break;case 3:this.centre=jsts.geom.Triangle.circumcentre(this.extremalPts[0],this.extremalPts[1],this.extremalPts[2]);break;}};jsts.algorithm.MinimumBoundingCircle.prototype.compute=function(){if(this.extremalPts!==null){return;}
this.computeCirclePoints();this.computeCentre();if(this.centre!==null){this.radius=this.centre.distance(this.extremalPts[0]);}};jsts.algorithm.MinimumBoundingCircle.prototype.computeCirclePoints=function(){if(this.input.isEmpty()){this.extremalPts=[];return;}
var pts;if(this.input.getNumPoints()===1){pts=this.input.getCoordinates();this.extremalPts=[new jsts.geom.Coordinate(pts[0])];return;}
var convexHull=this.input.convexHull();var hullPts=convexHull.getCoordinates();pts=hullPts;if(hullPts[0].equals2D(hullPts[hullPts.length-1])){pts=[];jsts.geom.CoordinateArrays.copyDeep(hullPts,0,pts,0,hullPts.length-1);}
if(pts.length<=2){this.extremalPts=jsts.geom.CoordinateArrays.copyDeep(pts);return;}
var P=jsts.algorithm.MinimumBoundingCircle.lowestPoint(pts);var Q=jsts.algorithm.MinimumBoundingCircle.pointWitMinAngleWithX(pts,P);for(var i=0;i<pts.length;i++){var R=jsts.algorithm.MinimumBoundingCircle.pointWithMinAngleWithSegment(pts,P,Q);if(jsts.algorithm.Angle.isObtuse(P,R,Q)){this.extremalPts=[new jsts.geom.Coordinate(P),new jsts.geom.Coordinate(Q)];return;}
if(jsts.algorithm.Angle.isObtuse(R,P,Q)){P=R;continue;}
if(jsts.algorithm.Angle.isObtuse(R,Q,P)){Q=R;continue;}
this.extremalPts=[new jsts.geom.Coordinate(P),new jsts.geom.Coordinate(Q),new jsts.geom.Coordinate(R)];return;}
throw new Error("Logic failure in Minimum Bounding Circle algorithm!");};jsts.algorithm.MinimumBoundingCircle.lowestPoint=function(pts){var min=pts[0];for(var i=1;i<pts.length;i++){if(pts[i].y<min.y){min=pts[i];}}
return min;};jsts.algorithm.MinimumBoundingCircle.pointWitMinAngleWithX=function(pts,P){var minSin=Number.MAX_VALUE;var minAngPt=null;for(var i=0;i<pts.length;i++){var p=pts[i];if(p===P)continue;var dx=p.x-P.x;var dy=p.y-P.y;if(dy<0)dy=-dy;var len=Math.sqrt(dx*dx+dy*dy);var sin=dy/len;if(sin<minSin){minSin=sin;minAngPt=p;}}
return minAngPt;};jsts.algorithm.MinimumBoundingCircle.pointWithMinAngleWithSegment=function(pts,P,Q){var minAng=Number.MAX_VALUE;var minAngPt=null;for(var i=0;i<pts.length;i++){var p=pts[i];if(p===P)continue;if(p===Q)continue;var ang=jsts.algorithm.Angle.angleBetween(P,p,Q);if(ang<minAng){minAng=ang;minAngPt=p;}}
return minAngPt;};jsts.noding.ScaledNoder=function(noder,scaleFactor,offsetX,offsetY){this.offsetX=offsetX?offsetX:0;this.offsetY=offsetY?offsetY:0;this.noder=noder;this.scaleFactor=scaleFactor;this.isScaled=!this.isIntegerPrecision();};jsts.noding.ScaledNoder.prototype=new jsts.noding.Noder();jsts.noding.ScaledNoder.constructor=jsts.noding.ScaledNoder;jsts.noding.ScaledNoder.prototype.noder=null;jsts.noding.ScaledNoder.prototype.scaleFactor=undefined;jsts.noding.ScaledNoder.prototype.offsetX=undefined;jsts.noding.ScaledNoder.prototype.offsetY=undefined;jsts.noding.ScaledNoder.prototype.isScaled=false;jsts.noding.ScaledNoder.prototype.isIntegerPrecision=function(){return this.scaleFactor===1.0;};jsts.noding.ScaledNoder.prototype.getNodedSubstrings=function(){var splitSS=this.noder.getNodedSubstrings();if(this.isScaled)
this.rescale(splitSS);return splitSS;};jsts.noding.ScaledNoder.prototype.computeNodes=function(inputSegStrings){var intSegStrings=inputSegStrings;if(this.isScaled)
intSegStrings=this.scale(inputSegStrings);this.noder.computeNodes(intSegStrings);};jsts.noding.ScaledNoder.prototype.scale=function(segStrings){if(segStrings instanceof Array){return this.scale2(segStrings);}
var transformed=new javascript.util.ArrayList();for(var i=segStrings.iterator();i.hasNext();){var ss=i.next();transformed.add(new jsts.noding.NodedSegmentString(this.scale(ss.getCoordinates()),ss.getData()));}
return transformed;};jsts.noding.ScaledNoder.prototype.scale2=function(pts){var roundPts=[];for(var i=0;i<pts.length;i++){roundPts[i]=new jsts.geom.Coordinate(Math.round((pts[i].x-this.offsetX)*this.scaleFactor),Math.round((pts[i].y-this.offsetY)*this.scaleFactor));}
var roundPtsNoDup=jsts.geom.CoordinateArrays.removeRepeatedPoints(roundPts);return roundPtsNoDup;};jsts.noding.ScaledNoder.prototype.rescale=function(segStrings){if(segStrings instanceof Array){this.rescale2(segStrings);return;}
for(var i=segStrings.iterator();i.hasNext();){var ss=i.next();this.rescale(ss.getCoordinates());}};jsts.noding.ScaledNoder.prototype.rescale2=function(pts){for(var i=0;i<pts.length;i++){pts[i].x=pts[i].x/this.scaleFactor+this.offsetX;pts[i].y=pts[i].y/this.scaleFactor+this.offsetY;}};(function(){var ArrayList=javascript.util.ArrayList;jsts.geomgraph.index.SegmentIntersector=function(li,includeProper,recordIsolated){this.li=li;this.includeProper=includeProper;this.recordIsolated=recordIsolated;};jsts.geomgraph.index.SegmentIntersector.isAdjacentSegments=function(i1,i2){return Math.abs(i1-i2)===1;};jsts.geomgraph.index.SegmentIntersector.prototype._hasIntersection=false;jsts.geomgraph.index.SegmentIntersector.prototype.hasProper=false;jsts.geomgraph.index.SegmentIntersector.prototype.hasProperInterior=false;jsts.geomgraph.index.SegmentIntersector.prototype.properIntersectionPoint=null;jsts.geomgraph.index.SegmentIntersector.prototype.li=null;jsts.geomgraph.index.SegmentIntersector.prototype.includeProper=null;jsts.geomgraph.index.SegmentIntersector.prototype.recordIsolated=null;jsts.geomgraph.index.SegmentIntersector.prototype.isSelfIntersection=null;jsts.geomgraph.index.SegmentIntersector.prototype.numIntersections=0;jsts.geomgraph.index.SegmentIntersector.prototype.numTests=0;jsts.geomgraph.index.SegmentIntersector.prototype.bdyNodes=null;jsts.geomgraph.index.SegmentIntersector.prototype.setBoundaryNodes=function(bdyNodes0,bdyNodes1){this.bdyNodes=[];this.bdyNodes[0]=bdyNodes0;this.bdyNodes[1]=bdyNodes1;};jsts.geomgraph.index.SegmentIntersector.prototype.getProperIntersectionPoint=function(){return this.properIntersectionPoint;};jsts.geomgraph.index.SegmentIntersector.prototype.hasIntersection=function(){return this._hasIntersection;};jsts.geomgraph.index.SegmentIntersector.prototype.hasProperIntersection=function(){return this.hasProper;};jsts.geomgraph.index.SegmentIntersector.prototype.hasProperInteriorIntersection=function(){return this.hasProperInterior;};jsts.geomgraph.index.SegmentIntersector.prototype.isTrivialIntersection=function(e0,segIndex0,e1,segIndex1){if(e0===e1){if(this.li.getIntersectionNum()===1){if(jsts.geomgraph.index.SegmentIntersector.isAdjacentSegments(segIndex0,segIndex1))
return true;if(e0.isClosed()){var maxSegIndex=e0.getNumPoints()-1;if((segIndex0===0&&segIndex1===maxSegIndex)||(segIndex1===0&&segIndex0===maxSegIndex)){return true;}}}}
return false;};jsts.geomgraph.index.SegmentIntersector.prototype.addIntersections=function(e0,segIndex0,e1,segIndex1){if(e0===e1&&segIndex0===segIndex1)
return;this.numTests++;var p00=e0.getCoordinates()[segIndex0];var p01=e0.getCoordinates()[segIndex0+1];var p10=e1.getCoordinates()[segIndex1];var p11=e1.getCoordinates()[segIndex1+1];this.li.computeIntersection(p00,p01,p10,p11);if(this.li.hasIntersection()){if(this.recordIsolated){e0.setIsolated(false);e1.setIsolated(false);}
this.numIntersections++;if(!this.isTrivialIntersection(e0,segIndex0,e1,segIndex1)){this._hasIntersection=true;if(this.includeProper||!this.li.isProper()){e0.addIntersections(this.li,segIndex0,0);e1.addIntersections(this.li,segIndex1,1);}
if(this.li.isProper()){this.properIntersectionPoint=this.li.getIntersection(0).clone();this.hasProper=true;if(!this.isBoundaryPoint(this.li,this.bdyNodes))
this.hasProperInterior=true;}}}};jsts.geomgraph.index.SegmentIntersector.prototype.isBoundaryPoint=function(li,bdyNodes){if(bdyNodes===null)
return false;if(bdyNodes instanceof Array){if(this.isBoundaryPoint(li,bdyNodes[0]))
return true;if(this.isBoundaryPoint(li,bdyNodes[1]))
return true;return false;}else{for(var i=bdyNodes.iterator();i.hasNext();){var node=i.next();var pt=node.getCoordinate();if(li.isIntersection(pt))
return true;}
return false;}};})();
},{}],6:[function(require,module,exports){
(function (global){
/*
  javascript.util is a port of selected parts of java.util to JavaScript which
  main purpose is to ease porting Java code to JavaScript.
  
  The MIT License (MIT)

  Copyright (C) 2011-2014 by The Authors

  Permission is hereby granted, free of charge, to any person obtaining a copy
  of this software and associated documentation files (the "Software"), to deal
  in the Software without restriction, including without limitation the rights
  to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
  copies of the Software, and to permit persons to whom the Software is
  furnished to do so, subject to the following conditions:

  The above copyright notice and this permission notice shall be included in
  all copies or substantial portions of the Software.

  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
  FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
  OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
  THE SOFTWARE.
*/
;(function(){var e=this;function f(a,b){var c=a.split("."),d=e;c[0]in d||!d.execScript||d.execScript("var "+c[0]);for(var t;c.length&&(t=c.shift());)c.length||void 0===b?d=d[t]?d[t]:d[t]={}:d[t]=b}function g(a,b){function c(){}c.prototype=b.prototype;a.q=b.prototype;a.prototype=new c;a.prototype.constructor=a;a.p=function(a,c,O){var M=Array.prototype.slice.call(arguments,2);return b.prototype[c].apply(a,M)}};function h(a){this.message=a||""}g(h,Error);f("javascript.util.EmptyStackException",h);h.prototype.name="EmptyStackException";function k(a){this.message=a||""}g(k,Error);f("javascript.util.IndexOutOfBoundsException",k);k.prototype.name="IndexOutOfBoundsException";function l(){}f("javascript.util.Iterator",l);l.prototype.hasNext=l.prototype.c;l.prototype.next=l.prototype.next;l.prototype.remove=l.prototype.remove;function m(){}f("javascript.util.Collection",m);function n(){}g(n,m);f("javascript.util.List",n);function p(){}f("javascript.util.Map",p);function q(a){this.message=a||""}g(q,Error);f("javascript.util.NoSuchElementException",q);q.prototype.name="NoSuchElementException";function r(a){this.message=a||""}g(r,Error);r.prototype.name="OperationNotSupported";function s(a){this.a=[];a instanceof m&&this.e(a)}g(s,n);f("javascript.util.ArrayList",s);s.prototype.a=null;s.prototype.add=function(a){this.a.push(a);return!0};s.prototype.add=s.prototype.add;s.prototype.e=function(a){for(a=a.f();a.c();)this.add(a.next());return!0};s.prototype.addAll=s.prototype.e;s.prototype.set=function(a,b){var c=this.a[a];this.a[a]=b;return c};s.prototype.set=s.prototype.set;s.prototype.f=function(){return new u(this)};s.prototype.iterator=s.prototype.f;
s.prototype.get=function(a){if(0>a||a>=this.size())throw new k;return this.a[a]};s.prototype.get=s.prototype.get;s.prototype.g=function(){return 0===this.a.length};s.prototype.isEmpty=s.prototype.g;s.prototype.size=function(){return this.a.length};s.prototype.size=s.prototype.size;s.prototype.h=function(){for(var a=[],b=0,c=this.a.length;b<c;b++)a.push(this.a[b]);return a};s.prototype.toArray=s.prototype.h;
s.prototype.remove=function(a){for(var b=!1,c=0,d=this.a.length;c<d;c++)if(this.a[c]===a){this.a.splice(c,1);b=!0;break}return b};s.prototype.remove=s.prototype.remove;function u(a){this.j=a}f("$jscomp.scope.Iterator_",u);u.prototype.j=null;u.prototype.b=0;u.prototype.next=function(){if(this.b===this.j.size())throw new q;return this.j.get(this.b++)};u.prototype.next=u.prototype.next;u.prototype.c=function(){return this.b<this.j.size()?!0:!1};u.prototype.hasNext=u.prototype.c;
u.prototype.remove=function(){throw new r;};u.prototype.remove=u.prototype.remove;function v(){}f("javascript.util.Arrays",v);
v.sort=function(){var a=arguments[0],b,c,d;if(1===arguments.length)a.sort();else if(2===arguments.length)c=arguments[1],d=function(a,b){return c.compare(a,b)},a.sort(d);else if(3===arguments.length)for(b=a.slice(arguments[1],arguments[2]),b.sort(),d=a.slice(0,arguments[1]).concat(b,a.slice(arguments[2],a.length)),a.splice(0,a.length),b=0;b<d.length;b++)a.push(d[b]);else if(4===arguments.length)for(b=a.slice(arguments[1],arguments[2]),c=arguments[3],d=function(a,b){return c.compare(a,b)},b.sort(d),
d=a.slice(0,arguments[1]).concat(b,a.slice(arguments[2],a.length)),a.splice(0,a.length),b=0;b<d.length;b++)a.push(d[b])};v.asList=function(a){for(var b=new s,c=0,d=a.length;c<d;c++)b.add(a[c]);return b};function w(){this.i={}}g(w,p);f("javascript.util.HashMap",w);w.prototype.i=null;w.prototype.get=function(a){return this.i[a]||null};w.prototype.get=w.prototype.get;w.prototype.put=function(a,b){return this.i[a]=b};w.prototype.put=w.prototype.put;w.prototype.m=function(){var a=new s,b;for(b in this.i)this.i.hasOwnProperty(b)&&a.add(this.i[b]);return a};w.prototype.values=w.prototype.m;w.prototype.size=function(){return this.m().size()};w.prototype.size=w.prototype.size;function x(){}g(x,m);f("javascript.util.Set",x);function y(a){this.a=[];a instanceof m&&this.e(a)}g(y,x);f("javascript.util.HashSet",y);y.prototype.a=null;y.prototype.contains=function(a){for(var b=0,c=this.a.length;b<c;b++)if(this.a[b]===a)return!0;return!1};y.prototype.contains=y.prototype.contains;y.prototype.add=function(a){if(this.contains(a))return!1;this.a.push(a);return!0};y.prototype.add=y.prototype.add;y.prototype.e=function(a){for(a=a.f();a.c();)this.add(a.next());return!0};y.prototype.addAll=y.prototype.e;
y.prototype.remove=function(){throw new r;};y.prototype.remove=y.prototype.remove;y.prototype.size=function(){return this.a.length};y.prototype.g=function(){return 0===this.a.length};y.prototype.isEmpty=y.prototype.g;y.prototype.h=function(){for(var a=[],b=0,c=this.a.length;b<c;b++)a.push(this.a[b]);return a};y.prototype.toArray=y.prototype.h;y.prototype.f=function(){return new z(this)};y.prototype.iterator=y.prototype.f;function z(a){this.k=a}f("$jscomp.scope.Iterator_$1",z);z.prototype.k=null;
z.prototype.b=0;z.prototype.next=function(){if(this.b===this.k.size())throw new q;return this.k.a[this.b++]};z.prototype.next=z.prototype.next;z.prototype.c=function(){return this.b<this.k.size()?!0:!1};z.prototype.hasNext=z.prototype.c;z.prototype.remove=function(){throw new r;};z.prototype.remove=z.prototype.remove;function A(){}g(A,p);f("javascript.util.SortedMap",A);function B(){}g(B,x);f("javascript.util.SortedSet",B);function C(){this.a=[]}g(C,n);f("javascript.util.Stack",C);C.prototype.a=null;C.prototype.push=function(a){this.a.push(a);return a};C.prototype.push=C.prototype.push;C.prototype.pop=function(){if(0===this.a.length)throw new h;return this.a.pop()};C.prototype.pop=C.prototype.pop;C.prototype.o=function(){if(0===this.a.length)throw new h;return this.a[this.a.length-1]};C.prototype.peek=C.prototype.o;C.prototype.empty=function(){return 0===this.a.length?!0:!1};C.prototype.empty=C.prototype.empty;
C.prototype.g=function(){return this.empty()};C.prototype.isEmpty=C.prototype.g;C.prototype.search=function(a){return this.a.indexOf(a)};C.prototype.search=C.prototype.search;C.prototype.size=function(){return this.a.length};C.prototype.size=C.prototype.size;C.prototype.h=function(){for(var a=[],b=0,c=this.a.length;b<c;b++)a.push(this.a[b]);return a};C.prototype.toArray=C.prototype.h;function D(a){return null==a?null:a.parent}function E(a,b){null!==a&&(a.color=b)}function F(a){return null==a?null:a.left}function G(a){return null==a?null:a.right}function H(){this.d=null;this.n=0}g(H,A);f("javascript.util.TreeMap",H);H.prototype.get=function(a){for(var b=this.d;null!==b;){var c=a.compareTo(b.key);if(0>c)b=b.left;else if(0<c)b=b.right;else return b.value}return null};H.prototype.get=H.prototype.get;
H.prototype.put=function(a,b){if(null===this.d)return this.d={key:a,value:b,left:null,right:null,parent:null,color:0},this.n=1,null;var c=this.d,d,t;do if(d=c,t=a.compareTo(c.key),0>t)c=c.left;else if(0<t)c=c.right;else return d=c.value,c.value=b,d;while(null!==c);c={key:a,left:null,right:null,value:b,parent:d,color:0};0>t?d.left=c:d.right=c;for(c.color=1;null!=c&&c!=this.d&&1==c.parent.color;)D(c)==F(D(D(c)))?(d=G(D(D(c))),1==(null==d?0:d.color)?(E(D(c),0),E(d,0),E(D(D(c)),1),c=D(D(c))):(c==G(D(c))&&
(c=D(c),I(this,c)),E(D(c),0),E(D(D(c)),1),J(this,D(D(c))))):(d=F(D(D(c))),1==(null==d?0:d.color)?(E(D(c),0),E(d,0),E(D(D(c)),1),c=D(D(c))):(c==F(D(c))&&(c=D(c),J(this,c)),E(D(c),0),E(D(D(c)),1),I(this,D(D(c)))));this.d.color=0;this.n++;return null};H.prototype.put=H.prototype.put;H.prototype.m=function(){var a=new s,b;b=this.d;if(null!=b)for(;null!=b.left;)b=b.left;if(null!==b)for(a.add(b.value);null!==(b=K(b));)a.add(b.value);return a};H.prototype.values=H.prototype.m;
function I(a,b){if(null!=b){var c=b.right;b.right=c.left;null!=c.left&&(c.left.parent=b);c.parent=b.parent;null==b.parent?a.d=c:b.parent.left==b?b.parent.left=c:b.parent.right=c;c.left=b;b.parent=c}}function J(a,b){if(null!=b){var c=b.left;b.left=c.right;null!=c.right&&(c.right.parent=b);c.parent=b.parent;null==b.parent?a.d=c:b.parent.right==b?b.parent.right=c:b.parent.left=c;c.right=b;b.parent=c}}
function K(a){if(null===a)return null;if(null!==a.right)for(var b=a.right;null!==b.left;)b=b.left;else for(b=a.parent;null!==b&&a===b.right;)a=b,b=b.parent;return b}H.prototype.size=function(){return this.n};H.prototype.size=H.prototype.size;function L(a){this.a=[];a instanceof m&&this.e(a)}g(L,B);f("javascript.util.TreeSet",L);L.prototype.a=null;L.prototype.contains=function(a){for(var b=0,c=this.a.length;b<c;b++)if(0===this.a[b].compareTo(a))return!0;return!1};L.prototype.contains=L.prototype.contains;L.prototype.add=function(a){if(this.contains(a))return!1;for(var b=0,c=this.a.length;b<c;b++)if(1===this.a[b].compareTo(a))return this.a.splice(b,0,a),!0;this.a.push(a);return!0};L.prototype.add=L.prototype.add;
L.prototype.e=function(a){for(a=a.f();a.c();)this.add(a.next());return!0};L.prototype.addAll=L.prototype.e;L.prototype.remove=function(){throw new r;};L.prototype.remove=L.prototype.remove;L.prototype.size=function(){return this.a.length};L.prototype.size=L.prototype.size;L.prototype.g=function(){return 0===this.a.length};L.prototype.isEmpty=L.prototype.g;L.prototype.h=function(){for(var a=[],b=0,c=this.a.length;b<c;b++)a.push(this.a[b]);return a};L.prototype.toArray=L.prototype.h;L.prototype.f=function(){return new N(this)};
L.prototype.iterator=L.prototype.f;function N(a){this.l=a}f("$jscomp.scope.Iterator_$2",N);N.prototype.l=null;N.prototype.b=0;N.prototype.next=function(){if(this.b===this.l.size())throw new q;return this.l.a[this.b++]};N.prototype.next=N.prototype.next;N.prototype.c=function(){return this.b<this.l.size()?!0:!1};N.prototype.hasNext=N.prototype.c;N.prototype.remove=function(){throw new r;};N.prototype.remove=N.prototype.remove;"undefined"!==typeof global&&(global.javascript={},global.javascript.util={},global.javascript.util.ArrayList=s,global.javascript.util.Arrays=v,global.javascript.util.Collection=m,global.javascript.util.EmptyStackException=h,global.javascript.util.HashMap=w,global.javascript.util.HashSet=y,global.javascript.util.IndexOutOfBoundsException=k,global.javascript.util.Iterator=l,global.javascript.util.List=n,global.javascript.util.Map=p,global.javascript.util.NoSuchElementException=q,global.javascript.util.OperationNotSupported=
r,global.javascript.util.Set=x,global.javascript.util.SortedMap=A,global.javascript.util.SortedSet=B,global.javascript.util.Stack=C,global.javascript.util.TreeMap=H,global.javascript.util.TreeSet=L);}).call(this);

}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})

},{}],7:[function(require,module,exports){
require('./dist/javascript.util-node.min.js');

},{"./dist/javascript.util-node.min.js":6}],8:[function(require,module,exports){
/**
 * Takes one or more {@link Feature|Features} and creates a {@link FeatureCollection}
 *
 * @module turf/featurecollection
 * @category helper
 * @param {Feature} features input Features
 * @returns {FeatureCollection} a FeatureCollection of input features
 * @example
 * var features = [
 *  turf.point([-75.343, 39.984], {name: 'Location A'}),
 *  turf.point([-75.833, 39.284], {name: 'Location B'}),
 *  turf.point([-75.534, 39.123], {name: 'Location C'})
 * ];
 *
 * var fc = turf.featurecollection(features);
 *
 * //=fc
 */
module.exports = function(features){
  return {
    type: "FeatureCollection",
    features: features
  };
};

},{}],9:[function(require,module,exports){
arguments[4][8][0].apply(exports,arguments)
},{"dup":8}],10:[function(require,module,exports){
/**
 * Takes coordinates and properties (optional) and returns a new {@link Point} feature.
 *
 * @module turf/point
 * @category helper
 * @param {number} longitude position west to east in decimal degrees
 * @param {number} latitude position south to north in decimal degrees
 * @param {Object} properties an Object that is used as the {@link Feature}'s
 * properties
 * @return {Point} a Point feature
 * @example
 * var pt1 = turf.point([-75.343, 39.984]);
 *
 * //=pt1
 */
var isArray = Array.isArray || function(arg) {
  return Object.prototype.toString.call(arg) === '[object Array]';
};
module.exports = function(coordinates, properties) {
  if (!isArray(coordinates)) throw new Error('Coordinates must be an array');
  if (coordinates.length < 2) throw new Error('Coordinates must be at least 2 numbers long');
  return {
    type: "Feature",
    geometry: {
      type: "Point",
      coordinates: coordinates
    },
    properties: properties || {}
  };
};

},{}],11:[function(require,module,exports){
var inside = require('turf-inside');
var featureCollection = require('turf-featurecollection');

/**
 * Takes a {@link FeatureCollection} of {@link Point} features and a FeatureCollection of {@link Polygon} features and returns a FeatureCollection of Point features representing all points that fall within a collection of polygons.
 *
 * @module turf/within
 * @category joins
 * @param {FeatureCollection} points a FeatureCollection of {@link Point} features
 * @param {FeatureCollection} polygons a FeatureCollection of {@link Polygon} features
 * @return {FeatureCollection} a collection of all points that land
 * within at least one polygon
 * @example
 * var searchWithin = {
 *   "type": "FeatureCollection",
 *   "features": [
 *     {
 *       "type": "Feature",
 *       "properties": {},
 *       "geometry": {
 *         "type": "Polygon",
 *         "coordinates": [[
 *           [-46.653,-23.543],
 *           [-46.634,-23.5346],
 *           [-46.613,-23.543],
 *           [-46.614,-23.559],
 *           [-46.631,-23.567],
 *           [-46.653,-23.560],
 *           [-46.653,-23.543]
 *         ]]
 *       }
 *     }
 *   ]
 * };
 * var points = {
 *   "type": "FeatureCollection",
 *   "features": [
 *     {
 *       "type": "Feature",
 *       "properties": {},
 *       "geometry": {
 *         "type": "Point",
 *         "coordinates": [-46.6318, -23.5523]
 *       }
 *     }, {
 *       "type": "Feature",
 *       "properties": {},
 *       "geometry": {
 *         "type": "Point",
 *         "coordinates": [-46.6246, -23.5325]
 *       }
 *     }, {
 *       "type": "Feature",
 *       "properties": {},
 *       "geometry": {
 *         "type": "Point",
 *         "coordinates": [-46.6062, -23.5513]
 *       }
 *     }, {
 *       "type": "Feature",
 *       "properties": {},
 *       "geometry": {
 *         "type": "Point",
 *         "coordinates": [-46.663, -23.554]
 *       }
 *     }, {
 *       "type": "Feature",
 *       "properties": {},
 *       "geometry": {
 *         "type": "Point",
 *         "coordinates": [-46.643, -23.557]
 *       }
 *     }
 *   ]
 * };
 *
 * var ptsWithin = turf.within(points, searchWithin);
 *
 * //=points
 *
 * //=searchWithin
 *
 * //=ptsWithin
 */
module.exports = function(ptFC, polyFC){
  var pointsWithin = featureCollection([]);
  for (var i = 0; i < polyFC.features.length; i++) {
    for (var j = 0; j < ptFC.features.length; j++) {
      var isInside = inside(ptFC.features[j], polyFC.features[i]);
      if(isInside){
        pointsWithin.features.push(ptFC.features[j]);
      }
    }
  }
  return pointsWithin;
};

},{"turf-featurecollection":12,"turf-inside":13}],12:[function(require,module,exports){
arguments[4][8][0].apply(exports,arguments)
},{"dup":8}],13:[function(require,module,exports){
// http://en.wikipedia.org/wiki/Even%E2%80%93odd_rule
// modified from: https://github.com/substack/point-in-polygon/blob/master/index.js
// which was modified from http://www.ecse.rpi.edu/Homepages/wrf/Research/Short_Notes/pnpoly.html

/**
 * Takes a {@link Point} feature and a {@link Polygon} feature and determines if the Point resides inside the Polygon. The Polygon can
 * be convex or concave. The function accepts any valid Polygon or {@link MultiPolygon}
 * and accounts for holes.
 *
 * @module turf/inside
 * @category joins
 * @param {Point} point a Point feature
 * @param {Polygon} polygon a Polygon feature
 * @return {Boolean} `true` if the Point is inside the Polygon; `false` if the Point is not inside the Polygon
 * @example
 * var pt1 = {
 *   "type": "Feature",
 *   "properties": {
 *     "marker-color": "#f00"
 *   },
 *   "geometry": {
 *     "type": "Point",
 *     "coordinates": [-111.467285, 40.75766]
 *   }
 * };
 * var pt2 = {
 *   "type": "Feature",
 *   "properties": {
 *     "marker-color": "#0f0"
 *   },
 *   "geometry": {
 *     "type": "Point",
 *     "coordinates": [-111.873779, 40.647303]
 *   }
 * };
 * var poly = {
 *   "type": "Feature",
 *   "properties": {},
 *   "geometry": {
 *     "type": "Polygon",
 *     "coordinates": [[
 *       [-112.074279, 40.52215],
 *       [-112.074279, 40.853293],
 *       [-111.610107, 40.853293],
 *       [-111.610107, 40.52215],
 *       [-112.074279, 40.52215]
 *     ]]
 *   }
 * };
 *
 * var features = {
 *   "type": "FeatureCollection",
 *   "features": [pt1, pt2, poly]
 * };
 *
 * //=features
 *
 * var isInside1 = turf.inside(pt1, poly);
 * //=isInside1
 *
 * var isInside2 = turf.inside(pt2, poly);
 * //=isInside2
 */
module.exports = function(point, polygon) {
  var polys = polygon.geometry.coordinates;
  var pt = [point.geometry.coordinates[0], point.geometry.coordinates[1]];
  // normalize to multipolygon
  if(polygon.geometry.type === 'Polygon') polys = [polys];

  var insidePoly = false;
  var i = 0;
  while (i < polys.length && !insidePoly) {
    // check if it is in the outer ring first
    if(inRing(pt, polys[i][0])) {
      var inHole = false;
      var k = 1;
      // check for the point in any of the holes
      while(k < polys[i].length && !inHole) {
        if(inRing(pt, polys[i][k])) {
          inHole = true;
        }
        k++;
      }
      if(!inHole) insidePoly = true;
    }
    i++;
  }
  return insidePoly;
}

// pt is [x,y] and ring is [[x,y], [x,y],..]
function inRing (pt, ring) {
  var isInside = false;
  for (var i = 0, j = ring.length - 1; i < ring.length; j = i++) {
    var xi = ring[i][0], yi = ring[i][1];
    var xj = ring[j][0], yj = ring[j][1];
    
    var intersect = ((yi > pt[1]) != (yj > pt[1]))
        && (pt[0] < (xj - xi) * (pt[1] - yi) / (yj - yi) + xi);
    if (intersect) isInside = !isInside;
  }
  return isInside;
}


},{}],14:[function(require,module,exports){
var buffer = require('turf-buffer');
var within = require('turf-within');
var fc = require('turf-featurecollection');
var point = require('turf-point');

var $ = require('jquery');
//var turf = require('turf');

var baseURI = window.location.href;
var currentRadius = 0.5;

L.mapbox.accessToken = 'pk.eyJ1Ijoic3J0aHVybWFuIiwiYSI6IkVGXy1NMHcifQ.EouINDEZGzjGs0x0VMhHxg';

var map = L.mapbox.map('map','srthurman.n9l71i86')
    .setView([38.901078, -77.024361], 15);
    
var wmataRoutes = L.mapbox.featureLayer()
    .loadURL(baseURI+'wmataRoutes')
    .addTo(map);
    
var marker = L.marker(new L.LatLng(38.901078, -77.024361), {
    icon: L.mapbox.marker.icon({
        "marker-color": "#FF00FF",
        "title": "You need coffee",
        "marker-symbol": "pitch",
        "marker-size": "large"
    }),
    draggable: true,
    zIndexOffset:999
}).addTo(map);


$.get(baseURI+'wmataStops', function(data) {
    //click-move functionality
    map.on('click',function(e){
        marker.setLatLng([e.latlng.lat, e.latlng.lng]);
        map.setView([e.latlng.lat, e.latlng.lng],15);
        updateTransitPoints();
    });
    
    // get position, get radius, draw buffer, find within, calculate distances, find nearest, add to map
    function updateTransitPoints(){
        $('path').remove();
        $('.leaflet-marker-pane *').not(':first').remove();
        var position=marker.getLatLng();
        var pt=point([position.lng, position.lat]);

        //draw buffer
        var bufferLayer = L.mapbox.featureLayer().addTo(map);
        
        var transitBuffer = buffer(pt, currentRadius, 'miles');
        transitBuffer.properties = {
            "fill": "#00704A",
            "fill-opacity":0.05,
            "stroke": "#00704A",
            "stroke-width": 2,
            "stroke-opacity": 0.5
        };
        
        bufferLayer.setGeoJSON(transitBuffer);
        
        //load stops and filter based on buffer
        var filteredStops = L.mapbox.featureLayer().addTo(map);
        var stops = within(data, fc([transitBuffer]));
        console.log(stops);
        
        var metroStops = [];
        for (s=0,l=stops.features.length;s<l;s++) {
            var currStop = stops.features[s];
            var str = currStop['name'];
            var re = /metro station/i;
            var found = str.match(re);
            if (found) {
                metroStops.push(currStop);
            };
        }
        console.log(fc([metroStops]).features[0]);
        filteredStops.setGeoJSON(fc([metroStops]).features[0]);
        
        var metroStopCount = metroStops.length;
        var busStopCount = stops.features.length - metroStopCount;
        
        $('#metroStopTally').html(metroStopCount);
        $('#busStopTally').html(busStopCount);
    }
    marker.on('drag', function(){updateTransitPoints()});
    updateTransitPoints();
});
},{"jquery":1,"turf-buffer":2,"turf-featurecollection":9,"turf-point":10,"turf-within":11}]},{},[14])
//# sourceMappingURL=data:application/json;charset:utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy5udm0vdjAuMTAuMzUvbGliL25vZGVfbW9kdWxlcy93YXRjaGlmeS9ub2RlX21vZHVsZXMvYnJvd3NlcmlmeS9ub2RlX21vZHVsZXMvYnJvd3Nlci1wYWNrL19wcmVsdWRlLmpzIiwiLi4vbm9kZV9tb2R1bGVzL2pxdWVyeS9kaXN0L2pxdWVyeS5qcyIsIi4uL25vZGVfbW9kdWxlcy90dXJmLWJ1ZmZlci9pbmRleC5qcyIsIi4uL25vZGVfbW9kdWxlcy90dXJmLWJ1ZmZlci9ub2RlX21vZHVsZXMvZ2VvanNvbi1ub3JtYWxpemUvaW5kZXguanMiLCIuLi9ub2RlX21vZHVsZXMvdHVyZi1idWZmZXIvbm9kZV9tb2R1bGVzL2pzdHMvaW5kZXguanMiLCIuLi9ub2RlX21vZHVsZXMvdHVyZi1idWZmZXIvbm9kZV9tb2R1bGVzL2pzdHMvbGliL2pzdHMuanMiLCIuLi9ub2RlX21vZHVsZXMvdHVyZi1idWZmZXIvbm9kZV9tb2R1bGVzL2pzdHMvbm9kZV9tb2R1bGVzL2phdmFzY3JpcHQudXRpbC9kaXN0L2phdmFzY3JpcHQudXRpbC1ub2RlLm1pbi5qcyIsIi4uL25vZGVfbW9kdWxlcy90dXJmLWJ1ZmZlci9ub2RlX21vZHVsZXMvanN0cy9ub2RlX21vZHVsZXMvamF2YXNjcmlwdC51dGlsL2luZGV4LmpzIiwiLi4vbm9kZV9tb2R1bGVzL3R1cmYtYnVmZmVyL25vZGVfbW9kdWxlcy90dXJmLWZlYXR1cmVjb2xsZWN0aW9uL2luZGV4LmpzIiwiLi4vbm9kZV9tb2R1bGVzL3R1cmYtcG9pbnQvaW5kZXguanMiLCIuLi9ub2RlX21vZHVsZXMvdHVyZi13aXRoaW4vaW5kZXguanMiLCIuLi9ub2RlX21vZHVsZXMvdHVyZi13aXRoaW4vbm9kZV9tb2R1bGVzL3R1cmYtaW5zaWRlL2luZGV4LmpzIiwibWFwLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0FDQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDMS9SQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzVFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzNDQTtBQUNBO0FBQ0E7QUFDQTs7QUNIQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUM1cURBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7O0FDMUNBO0FBQ0E7O0FDREE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7QUN4QkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDOUJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7O0FDaEdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN4R0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJmaWxlIjoiZ2VuZXJhdGVkLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbiBlKHQsbixyKXtmdW5jdGlvbiBzKG8sdSl7aWYoIW5bb10pe2lmKCF0W29dKXt2YXIgYT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2lmKCF1JiZhKXJldHVybiBhKG8sITApO2lmKGkpcmV0dXJuIGkobywhMCk7dmFyIGY9bmV3IEVycm9yKFwiQ2Fubm90IGZpbmQgbW9kdWxlICdcIitvK1wiJ1wiKTt0aHJvdyBmLmNvZGU9XCJNT0RVTEVfTk9UX0ZPVU5EXCIsZn12YXIgbD1uW29dPXtleHBvcnRzOnt9fTt0W29dWzBdLmNhbGwobC5leHBvcnRzLGZ1bmN0aW9uKGUpe3ZhciBuPXRbb11bMV1bZV07cmV0dXJuIHMobj9uOmUpfSxsLGwuZXhwb3J0cyxlLHQsbixyKX1yZXR1cm4gbltvXS5leHBvcnRzfXZhciBpPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7Zm9yKHZhciBvPTA7bzxyLmxlbmd0aDtvKyspcyhyW29dKTtyZXR1cm4gc30pIiwiLyohXG4gKiBqUXVlcnkgSmF2YVNjcmlwdCBMaWJyYXJ5IHYyLjEuNFxuICogaHR0cDovL2pxdWVyeS5jb20vXG4gKlxuICogSW5jbHVkZXMgU2l6emxlLmpzXG4gKiBodHRwOi8vc2l6emxlanMuY29tL1xuICpcbiAqIENvcHlyaWdodCAyMDA1LCAyMDE0IGpRdWVyeSBGb3VuZGF0aW9uLCBJbmMuIGFuZCBvdGhlciBjb250cmlidXRvcnNcbiAqIFJlbGVhc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZVxuICogaHR0cDovL2pxdWVyeS5vcmcvbGljZW5zZVxuICpcbiAqIERhdGU6IDIwMTUtMDQtMjhUMTY6MDFaXG4gKi9cblxuKGZ1bmN0aW9uKCBnbG9iYWwsIGZhY3RvcnkgKSB7XG5cblx0aWYgKCB0eXBlb2YgbW9kdWxlID09PSBcIm9iamVjdFwiICYmIHR5cGVvZiBtb2R1bGUuZXhwb3J0cyA9PT0gXCJvYmplY3RcIiApIHtcblx0XHQvLyBGb3IgQ29tbW9uSlMgYW5kIENvbW1vbkpTLWxpa2UgZW52aXJvbm1lbnRzIHdoZXJlIGEgcHJvcGVyIGB3aW5kb3dgXG5cdFx0Ly8gaXMgcHJlc2VudCwgZXhlY3V0ZSB0aGUgZmFjdG9yeSBhbmQgZ2V0IGpRdWVyeS5cblx0XHQvLyBGb3IgZW52aXJvbm1lbnRzIHRoYXQgZG8gbm90IGhhdmUgYSBgd2luZG93YCB3aXRoIGEgYGRvY3VtZW50YFxuXHRcdC8vIChzdWNoIGFzIE5vZGUuanMpLCBleHBvc2UgYSBmYWN0b3J5IGFzIG1vZHVsZS5leHBvcnRzLlxuXHRcdC8vIFRoaXMgYWNjZW50dWF0ZXMgdGhlIG5lZWQgZm9yIHRoZSBjcmVhdGlvbiBvZiBhIHJlYWwgYHdpbmRvd2AuXG5cdFx0Ly8gZS5nLiB2YXIgalF1ZXJ5ID0gcmVxdWlyZShcImpxdWVyeVwiKSh3aW5kb3cpO1xuXHRcdC8vIFNlZSB0aWNrZXQgIzE0NTQ5IGZvciBtb3JlIGluZm8uXG5cdFx0bW9kdWxlLmV4cG9ydHMgPSBnbG9iYWwuZG9jdW1lbnQgP1xuXHRcdFx0ZmFjdG9yeSggZ2xvYmFsLCB0cnVlICkgOlxuXHRcdFx0ZnVuY3Rpb24oIHcgKSB7XG5cdFx0XHRcdGlmICggIXcuZG9jdW1lbnQgKSB7XG5cdFx0XHRcdFx0dGhyb3cgbmV3IEVycm9yKCBcImpRdWVyeSByZXF1aXJlcyBhIHdpbmRvdyB3aXRoIGEgZG9jdW1lbnRcIiApO1xuXHRcdFx0XHR9XG5cdFx0XHRcdHJldHVybiBmYWN0b3J5KCB3ICk7XG5cdFx0XHR9O1xuXHR9IGVsc2Uge1xuXHRcdGZhY3RvcnkoIGdsb2JhbCApO1xuXHR9XG5cbi8vIFBhc3MgdGhpcyBpZiB3aW5kb3cgaXMgbm90IGRlZmluZWQgeWV0XG59KHR5cGVvZiB3aW5kb3cgIT09IFwidW5kZWZpbmVkXCIgPyB3aW5kb3cgOiB0aGlzLCBmdW5jdGlvbiggd2luZG93LCBub0dsb2JhbCApIHtcblxuLy8gU3VwcG9ydDogRmlyZWZveCAxOCtcbi8vIENhbid0IGJlIGluIHN0cmljdCBtb2RlLCBzZXZlcmFsIGxpYnMgaW5jbHVkaW5nIEFTUC5ORVQgdHJhY2Vcbi8vIHRoZSBzdGFjayB2aWEgYXJndW1lbnRzLmNhbGxlci5jYWxsZWUgYW5kIEZpcmVmb3ggZGllcyBpZlxuLy8geW91IHRyeSB0byB0cmFjZSB0aHJvdWdoIFwidXNlIHN0cmljdFwiIGNhbGwgY2hhaW5zLiAoIzEzMzM1KVxuLy9cblxudmFyIGFyciA9IFtdO1xuXG52YXIgc2xpY2UgPSBhcnIuc2xpY2U7XG5cbnZhciBjb25jYXQgPSBhcnIuY29uY2F0O1xuXG52YXIgcHVzaCA9IGFyci5wdXNoO1xuXG52YXIgaW5kZXhPZiA9IGFyci5pbmRleE9mO1xuXG52YXIgY2xhc3MydHlwZSA9IHt9O1xuXG52YXIgdG9TdHJpbmcgPSBjbGFzczJ0eXBlLnRvU3RyaW5nO1xuXG52YXIgaGFzT3duID0gY2xhc3MydHlwZS5oYXNPd25Qcm9wZXJ0eTtcblxudmFyIHN1cHBvcnQgPSB7fTtcblxuXG5cbnZhclxuXHQvLyBVc2UgdGhlIGNvcnJlY3QgZG9jdW1lbnQgYWNjb3JkaW5nbHkgd2l0aCB3aW5kb3cgYXJndW1lbnQgKHNhbmRib3gpXG5cdGRvY3VtZW50ID0gd2luZG93LmRvY3VtZW50LFxuXG5cdHZlcnNpb24gPSBcIjIuMS40XCIsXG5cblx0Ly8gRGVmaW5lIGEgbG9jYWwgY29weSBvZiBqUXVlcnlcblx0alF1ZXJ5ID0gZnVuY3Rpb24oIHNlbGVjdG9yLCBjb250ZXh0ICkge1xuXHRcdC8vIFRoZSBqUXVlcnkgb2JqZWN0IGlzIGFjdHVhbGx5IGp1c3QgdGhlIGluaXQgY29uc3RydWN0b3IgJ2VuaGFuY2VkJ1xuXHRcdC8vIE5lZWQgaW5pdCBpZiBqUXVlcnkgaXMgY2FsbGVkIChqdXN0IGFsbG93IGVycm9yIHRvIGJlIHRocm93biBpZiBub3QgaW5jbHVkZWQpXG5cdFx0cmV0dXJuIG5ldyBqUXVlcnkuZm4uaW5pdCggc2VsZWN0b3IsIGNvbnRleHQgKTtcblx0fSxcblxuXHQvLyBTdXBwb3J0OiBBbmRyb2lkPDQuMVxuXHQvLyBNYWtlIHN1cmUgd2UgdHJpbSBCT00gYW5kIE5CU1Bcblx0cnRyaW0gPSAvXltcXHNcXHVGRUZGXFx4QTBdK3xbXFxzXFx1RkVGRlxceEEwXSskL2csXG5cblx0Ly8gTWF0Y2hlcyBkYXNoZWQgc3RyaW5nIGZvciBjYW1lbGl6aW5nXG5cdHJtc1ByZWZpeCA9IC9eLW1zLS8sXG5cdHJkYXNoQWxwaGEgPSAvLShbXFxkYS16XSkvZ2ksXG5cblx0Ly8gVXNlZCBieSBqUXVlcnkuY2FtZWxDYXNlIGFzIGNhbGxiYWNrIHRvIHJlcGxhY2UoKVxuXHRmY2FtZWxDYXNlID0gZnVuY3Rpb24oIGFsbCwgbGV0dGVyICkge1xuXHRcdHJldHVybiBsZXR0ZXIudG9VcHBlckNhc2UoKTtcblx0fTtcblxualF1ZXJ5LmZuID0galF1ZXJ5LnByb3RvdHlwZSA9IHtcblx0Ly8gVGhlIGN1cnJlbnQgdmVyc2lvbiBvZiBqUXVlcnkgYmVpbmcgdXNlZFxuXHRqcXVlcnk6IHZlcnNpb24sXG5cblx0Y29uc3RydWN0b3I6IGpRdWVyeSxcblxuXHQvLyBTdGFydCB3aXRoIGFuIGVtcHR5IHNlbGVjdG9yXG5cdHNlbGVjdG9yOiBcIlwiLFxuXG5cdC8vIFRoZSBkZWZhdWx0IGxlbmd0aCBvZiBhIGpRdWVyeSBvYmplY3QgaXMgMFxuXHRsZW5ndGg6IDAsXG5cblx0dG9BcnJheTogZnVuY3Rpb24oKSB7XG5cdFx0cmV0dXJuIHNsaWNlLmNhbGwoIHRoaXMgKTtcblx0fSxcblxuXHQvLyBHZXQgdGhlIE50aCBlbGVtZW50IGluIHRoZSBtYXRjaGVkIGVsZW1lbnQgc2V0IE9SXG5cdC8vIEdldCB0aGUgd2hvbGUgbWF0Y2hlZCBlbGVtZW50IHNldCBhcyBhIGNsZWFuIGFycmF5XG5cdGdldDogZnVuY3Rpb24oIG51bSApIHtcblx0XHRyZXR1cm4gbnVtICE9IG51bGwgP1xuXG5cdFx0XHQvLyBSZXR1cm4ganVzdCB0aGUgb25lIGVsZW1lbnQgZnJvbSB0aGUgc2V0XG5cdFx0XHQoIG51bSA8IDAgPyB0aGlzWyBudW0gKyB0aGlzLmxlbmd0aCBdIDogdGhpc1sgbnVtIF0gKSA6XG5cblx0XHRcdC8vIFJldHVybiBhbGwgdGhlIGVsZW1lbnRzIGluIGEgY2xlYW4gYXJyYXlcblx0XHRcdHNsaWNlLmNhbGwoIHRoaXMgKTtcblx0fSxcblxuXHQvLyBUYWtlIGFuIGFycmF5IG9mIGVsZW1lbnRzIGFuZCBwdXNoIGl0IG9udG8gdGhlIHN0YWNrXG5cdC8vIChyZXR1cm5pbmcgdGhlIG5ldyBtYXRjaGVkIGVsZW1lbnQgc2V0KVxuXHRwdXNoU3RhY2s6IGZ1bmN0aW9uKCBlbGVtcyApIHtcblxuXHRcdC8vIEJ1aWxkIGEgbmV3IGpRdWVyeSBtYXRjaGVkIGVsZW1lbnQgc2V0XG5cdFx0dmFyIHJldCA9IGpRdWVyeS5tZXJnZSggdGhpcy5jb25zdHJ1Y3RvcigpLCBlbGVtcyApO1xuXG5cdFx0Ly8gQWRkIHRoZSBvbGQgb2JqZWN0IG9udG8gdGhlIHN0YWNrIChhcyBhIHJlZmVyZW5jZSlcblx0XHRyZXQucHJldk9iamVjdCA9IHRoaXM7XG5cdFx0cmV0LmNvbnRleHQgPSB0aGlzLmNvbnRleHQ7XG5cblx0XHQvLyBSZXR1cm4gdGhlIG5ld2x5LWZvcm1lZCBlbGVtZW50IHNldFxuXHRcdHJldHVybiByZXQ7XG5cdH0sXG5cblx0Ly8gRXhlY3V0ZSBhIGNhbGxiYWNrIGZvciBldmVyeSBlbGVtZW50IGluIHRoZSBtYXRjaGVkIHNldC5cblx0Ly8gKFlvdSBjYW4gc2VlZCB0aGUgYXJndW1lbnRzIHdpdGggYW4gYXJyYXkgb2YgYXJncywgYnV0IHRoaXMgaXNcblx0Ly8gb25seSB1c2VkIGludGVybmFsbHkuKVxuXHRlYWNoOiBmdW5jdGlvbiggY2FsbGJhY2ssIGFyZ3MgKSB7XG5cdFx0cmV0dXJuIGpRdWVyeS5lYWNoKCB0aGlzLCBjYWxsYmFjaywgYXJncyApO1xuXHR9LFxuXG5cdG1hcDogZnVuY3Rpb24oIGNhbGxiYWNrICkge1xuXHRcdHJldHVybiB0aGlzLnB1c2hTdGFjayggalF1ZXJ5Lm1hcCh0aGlzLCBmdW5jdGlvbiggZWxlbSwgaSApIHtcblx0XHRcdHJldHVybiBjYWxsYmFjay5jYWxsKCBlbGVtLCBpLCBlbGVtICk7XG5cdFx0fSkpO1xuXHR9LFxuXG5cdHNsaWNlOiBmdW5jdGlvbigpIHtcblx0XHRyZXR1cm4gdGhpcy5wdXNoU3RhY2soIHNsaWNlLmFwcGx5KCB0aGlzLCBhcmd1bWVudHMgKSApO1xuXHR9LFxuXG5cdGZpcnN0OiBmdW5jdGlvbigpIHtcblx0XHRyZXR1cm4gdGhpcy5lcSggMCApO1xuXHR9LFxuXG5cdGxhc3Q6IGZ1bmN0aW9uKCkge1xuXHRcdHJldHVybiB0aGlzLmVxKCAtMSApO1xuXHR9LFxuXG5cdGVxOiBmdW5jdGlvbiggaSApIHtcblx0XHR2YXIgbGVuID0gdGhpcy5sZW5ndGgsXG5cdFx0XHRqID0gK2kgKyAoIGkgPCAwID8gbGVuIDogMCApO1xuXHRcdHJldHVybiB0aGlzLnB1c2hTdGFjayggaiA+PSAwICYmIGogPCBsZW4gPyBbIHRoaXNbal0gXSA6IFtdICk7XG5cdH0sXG5cblx0ZW5kOiBmdW5jdGlvbigpIHtcblx0XHRyZXR1cm4gdGhpcy5wcmV2T2JqZWN0IHx8IHRoaXMuY29uc3RydWN0b3IobnVsbCk7XG5cdH0sXG5cblx0Ly8gRm9yIGludGVybmFsIHVzZSBvbmx5LlxuXHQvLyBCZWhhdmVzIGxpa2UgYW4gQXJyYXkncyBtZXRob2QsIG5vdCBsaWtlIGEgalF1ZXJ5IG1ldGhvZC5cblx0cHVzaDogcHVzaCxcblx0c29ydDogYXJyLnNvcnQsXG5cdHNwbGljZTogYXJyLnNwbGljZVxufTtcblxualF1ZXJ5LmV4dGVuZCA9IGpRdWVyeS5mbi5leHRlbmQgPSBmdW5jdGlvbigpIHtcblx0dmFyIG9wdGlvbnMsIG5hbWUsIHNyYywgY29weSwgY29weUlzQXJyYXksIGNsb25lLFxuXHRcdHRhcmdldCA9IGFyZ3VtZW50c1swXSB8fCB7fSxcblx0XHRpID0gMSxcblx0XHRsZW5ndGggPSBhcmd1bWVudHMubGVuZ3RoLFxuXHRcdGRlZXAgPSBmYWxzZTtcblxuXHQvLyBIYW5kbGUgYSBkZWVwIGNvcHkgc2l0dWF0aW9uXG5cdGlmICggdHlwZW9mIHRhcmdldCA9PT0gXCJib29sZWFuXCIgKSB7XG5cdFx0ZGVlcCA9IHRhcmdldDtcblxuXHRcdC8vIFNraXAgdGhlIGJvb2xlYW4gYW5kIHRoZSB0YXJnZXRcblx0XHR0YXJnZXQgPSBhcmd1bWVudHNbIGkgXSB8fCB7fTtcblx0XHRpKys7XG5cdH1cblxuXHQvLyBIYW5kbGUgY2FzZSB3aGVuIHRhcmdldCBpcyBhIHN0cmluZyBvciBzb21ldGhpbmcgKHBvc3NpYmxlIGluIGRlZXAgY29weSlcblx0aWYgKCB0eXBlb2YgdGFyZ2V0ICE9PSBcIm9iamVjdFwiICYmICFqUXVlcnkuaXNGdW5jdGlvbih0YXJnZXQpICkge1xuXHRcdHRhcmdldCA9IHt9O1xuXHR9XG5cblx0Ly8gRXh0ZW5kIGpRdWVyeSBpdHNlbGYgaWYgb25seSBvbmUgYXJndW1lbnQgaXMgcGFzc2VkXG5cdGlmICggaSA9PT0gbGVuZ3RoICkge1xuXHRcdHRhcmdldCA9IHRoaXM7XG5cdFx0aS0tO1xuXHR9XG5cblx0Zm9yICggOyBpIDwgbGVuZ3RoOyBpKysgKSB7XG5cdFx0Ly8gT25seSBkZWFsIHdpdGggbm9uLW51bGwvdW5kZWZpbmVkIHZhbHVlc1xuXHRcdGlmICggKG9wdGlvbnMgPSBhcmd1bWVudHNbIGkgXSkgIT0gbnVsbCApIHtcblx0XHRcdC8vIEV4dGVuZCB0aGUgYmFzZSBvYmplY3Rcblx0XHRcdGZvciAoIG5hbWUgaW4gb3B0aW9ucyApIHtcblx0XHRcdFx0c3JjID0gdGFyZ2V0WyBuYW1lIF07XG5cdFx0XHRcdGNvcHkgPSBvcHRpb25zWyBuYW1lIF07XG5cblx0XHRcdFx0Ly8gUHJldmVudCBuZXZlci1lbmRpbmcgbG9vcFxuXHRcdFx0XHRpZiAoIHRhcmdldCA9PT0gY29weSApIHtcblx0XHRcdFx0XHRjb250aW51ZTtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdC8vIFJlY3Vyc2UgaWYgd2UncmUgbWVyZ2luZyBwbGFpbiBvYmplY3RzIG9yIGFycmF5c1xuXHRcdFx0XHRpZiAoIGRlZXAgJiYgY29weSAmJiAoIGpRdWVyeS5pc1BsYWluT2JqZWN0KGNvcHkpIHx8IChjb3B5SXNBcnJheSA9IGpRdWVyeS5pc0FycmF5KGNvcHkpKSApICkge1xuXHRcdFx0XHRcdGlmICggY29weUlzQXJyYXkgKSB7XG5cdFx0XHRcdFx0XHRjb3B5SXNBcnJheSA9IGZhbHNlO1xuXHRcdFx0XHRcdFx0Y2xvbmUgPSBzcmMgJiYgalF1ZXJ5LmlzQXJyYXkoc3JjKSA/IHNyYyA6IFtdO1xuXG5cdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdGNsb25lID0gc3JjICYmIGpRdWVyeS5pc1BsYWluT2JqZWN0KHNyYykgPyBzcmMgOiB7fTtcblx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHQvLyBOZXZlciBtb3ZlIG9yaWdpbmFsIG9iamVjdHMsIGNsb25lIHRoZW1cblx0XHRcdFx0XHR0YXJnZXRbIG5hbWUgXSA9IGpRdWVyeS5leHRlbmQoIGRlZXAsIGNsb25lLCBjb3B5ICk7XG5cblx0XHRcdFx0Ly8gRG9uJ3QgYnJpbmcgaW4gdW5kZWZpbmVkIHZhbHVlc1xuXHRcdFx0XHR9IGVsc2UgaWYgKCBjb3B5ICE9PSB1bmRlZmluZWQgKSB7XG5cdFx0XHRcdFx0dGFyZ2V0WyBuYW1lIF0gPSBjb3B5O1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fVxuXHR9XG5cblx0Ly8gUmV0dXJuIHRoZSBtb2RpZmllZCBvYmplY3Rcblx0cmV0dXJuIHRhcmdldDtcbn07XG5cbmpRdWVyeS5leHRlbmQoe1xuXHQvLyBVbmlxdWUgZm9yIGVhY2ggY29weSBvZiBqUXVlcnkgb24gdGhlIHBhZ2Vcblx0ZXhwYW5kbzogXCJqUXVlcnlcIiArICggdmVyc2lvbiArIE1hdGgucmFuZG9tKCkgKS5yZXBsYWNlKCAvXFxEL2csIFwiXCIgKSxcblxuXHQvLyBBc3N1bWUgalF1ZXJ5IGlzIHJlYWR5IHdpdGhvdXQgdGhlIHJlYWR5IG1vZHVsZVxuXHRpc1JlYWR5OiB0cnVlLFxuXG5cdGVycm9yOiBmdW5jdGlvbiggbXNnICkge1xuXHRcdHRocm93IG5ldyBFcnJvciggbXNnICk7XG5cdH0sXG5cblx0bm9vcDogZnVuY3Rpb24oKSB7fSxcblxuXHRpc0Z1bmN0aW9uOiBmdW5jdGlvbiggb2JqICkge1xuXHRcdHJldHVybiBqUXVlcnkudHlwZShvYmopID09PSBcImZ1bmN0aW9uXCI7XG5cdH0sXG5cblx0aXNBcnJheTogQXJyYXkuaXNBcnJheSxcblxuXHRpc1dpbmRvdzogZnVuY3Rpb24oIG9iaiApIHtcblx0XHRyZXR1cm4gb2JqICE9IG51bGwgJiYgb2JqID09PSBvYmoud2luZG93O1xuXHR9LFxuXG5cdGlzTnVtZXJpYzogZnVuY3Rpb24oIG9iaiApIHtcblx0XHQvLyBwYXJzZUZsb2F0IE5hTnMgbnVtZXJpYy1jYXN0IGZhbHNlIHBvc2l0aXZlcyAobnVsbHx0cnVlfGZhbHNlfFwiXCIpXG5cdFx0Ly8gLi4uYnV0IG1pc2ludGVycHJldHMgbGVhZGluZy1udW1iZXIgc3RyaW5ncywgcGFydGljdWxhcmx5IGhleCBsaXRlcmFscyAoXCIweC4uLlwiKVxuXHRcdC8vIHN1YnRyYWN0aW9uIGZvcmNlcyBpbmZpbml0aWVzIHRvIE5hTlxuXHRcdC8vIGFkZGluZyAxIGNvcnJlY3RzIGxvc3Mgb2YgcHJlY2lzaW9uIGZyb20gcGFyc2VGbG9hdCAoIzE1MTAwKVxuXHRcdHJldHVybiAhalF1ZXJ5LmlzQXJyYXkoIG9iaiApICYmIChvYmogLSBwYXJzZUZsb2F0KCBvYmogKSArIDEpID49IDA7XG5cdH0sXG5cblx0aXNQbGFpbk9iamVjdDogZnVuY3Rpb24oIG9iaiApIHtcblx0XHQvLyBOb3QgcGxhaW4gb2JqZWN0czpcblx0XHQvLyAtIEFueSBvYmplY3Qgb3IgdmFsdWUgd2hvc2UgaW50ZXJuYWwgW1tDbGFzc11dIHByb3BlcnR5IGlzIG5vdCBcIltvYmplY3QgT2JqZWN0XVwiXG5cdFx0Ly8gLSBET00gbm9kZXNcblx0XHQvLyAtIHdpbmRvd1xuXHRcdGlmICggalF1ZXJ5LnR5cGUoIG9iaiApICE9PSBcIm9iamVjdFwiIHx8IG9iai5ub2RlVHlwZSB8fCBqUXVlcnkuaXNXaW5kb3coIG9iaiApICkge1xuXHRcdFx0cmV0dXJuIGZhbHNlO1xuXHRcdH1cblxuXHRcdGlmICggb2JqLmNvbnN0cnVjdG9yICYmXG5cdFx0XHRcdCFoYXNPd24uY2FsbCggb2JqLmNvbnN0cnVjdG9yLnByb3RvdHlwZSwgXCJpc1Byb3RvdHlwZU9mXCIgKSApIHtcblx0XHRcdHJldHVybiBmYWxzZTtcblx0XHR9XG5cblx0XHQvLyBJZiB0aGUgZnVuY3Rpb24gaGFzbid0IHJldHVybmVkIGFscmVhZHksIHdlJ3JlIGNvbmZpZGVudCB0aGF0XG5cdFx0Ly8gfG9ianwgaXMgYSBwbGFpbiBvYmplY3QsIGNyZWF0ZWQgYnkge30gb3IgY29uc3RydWN0ZWQgd2l0aCBuZXcgT2JqZWN0XG5cdFx0cmV0dXJuIHRydWU7XG5cdH0sXG5cblx0aXNFbXB0eU9iamVjdDogZnVuY3Rpb24oIG9iaiApIHtcblx0XHR2YXIgbmFtZTtcblx0XHRmb3IgKCBuYW1lIGluIG9iaiApIHtcblx0XHRcdHJldHVybiBmYWxzZTtcblx0XHR9XG5cdFx0cmV0dXJuIHRydWU7XG5cdH0sXG5cblx0dHlwZTogZnVuY3Rpb24oIG9iaiApIHtcblx0XHRpZiAoIG9iaiA9PSBudWxsICkge1xuXHRcdFx0cmV0dXJuIG9iaiArIFwiXCI7XG5cdFx0fVxuXHRcdC8vIFN1cHBvcnQ6IEFuZHJvaWQ8NC4wLCBpT1M8NiAoZnVuY3Rpb25pc2ggUmVnRXhwKVxuXHRcdHJldHVybiB0eXBlb2Ygb2JqID09PSBcIm9iamVjdFwiIHx8IHR5cGVvZiBvYmogPT09IFwiZnVuY3Rpb25cIiA/XG5cdFx0XHRjbGFzczJ0eXBlWyB0b1N0cmluZy5jYWxsKG9iaikgXSB8fCBcIm9iamVjdFwiIDpcblx0XHRcdHR5cGVvZiBvYmo7XG5cdH0sXG5cblx0Ly8gRXZhbHVhdGVzIGEgc2NyaXB0IGluIGEgZ2xvYmFsIGNvbnRleHRcblx0Z2xvYmFsRXZhbDogZnVuY3Rpb24oIGNvZGUgKSB7XG5cdFx0dmFyIHNjcmlwdCxcblx0XHRcdGluZGlyZWN0ID0gZXZhbDtcblxuXHRcdGNvZGUgPSBqUXVlcnkudHJpbSggY29kZSApO1xuXG5cdFx0aWYgKCBjb2RlICkge1xuXHRcdFx0Ly8gSWYgdGhlIGNvZGUgaW5jbHVkZXMgYSB2YWxpZCwgcHJvbG9ndWUgcG9zaXRpb25cblx0XHRcdC8vIHN0cmljdCBtb2RlIHByYWdtYSwgZXhlY3V0ZSBjb2RlIGJ5IGluamVjdGluZyBhXG5cdFx0XHQvLyBzY3JpcHQgdGFnIGludG8gdGhlIGRvY3VtZW50LlxuXHRcdFx0aWYgKCBjb2RlLmluZGV4T2YoXCJ1c2Ugc3RyaWN0XCIpID09PSAxICkge1xuXHRcdFx0XHRzY3JpcHQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwic2NyaXB0XCIpO1xuXHRcdFx0XHRzY3JpcHQudGV4dCA9IGNvZGU7XG5cdFx0XHRcdGRvY3VtZW50LmhlYWQuYXBwZW5kQ2hpbGQoIHNjcmlwdCApLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQoIHNjcmlwdCApO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdC8vIE90aGVyd2lzZSwgYXZvaWQgdGhlIERPTSBub2RlIGNyZWF0aW9uLCBpbnNlcnRpb25cblx0XHRcdC8vIGFuZCByZW1vdmFsIGJ5IHVzaW5nIGFuIGluZGlyZWN0IGdsb2JhbCBldmFsXG5cdFx0XHRcdGluZGlyZWN0KCBjb2RlICk7XG5cdFx0XHR9XG5cdFx0fVxuXHR9LFxuXG5cdC8vIENvbnZlcnQgZGFzaGVkIHRvIGNhbWVsQ2FzZTsgdXNlZCBieSB0aGUgY3NzIGFuZCBkYXRhIG1vZHVsZXNcblx0Ly8gU3VwcG9ydDogSUU5LTExK1xuXHQvLyBNaWNyb3NvZnQgZm9yZ290IHRvIGh1bXAgdGhlaXIgdmVuZG9yIHByZWZpeCAoIzk1NzIpXG5cdGNhbWVsQ2FzZTogZnVuY3Rpb24oIHN0cmluZyApIHtcblx0XHRyZXR1cm4gc3RyaW5nLnJlcGxhY2UoIHJtc1ByZWZpeCwgXCJtcy1cIiApLnJlcGxhY2UoIHJkYXNoQWxwaGEsIGZjYW1lbENhc2UgKTtcblx0fSxcblxuXHRub2RlTmFtZTogZnVuY3Rpb24oIGVsZW0sIG5hbWUgKSB7XG5cdFx0cmV0dXJuIGVsZW0ubm9kZU5hbWUgJiYgZWxlbS5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpID09PSBuYW1lLnRvTG93ZXJDYXNlKCk7XG5cdH0sXG5cblx0Ly8gYXJncyBpcyBmb3IgaW50ZXJuYWwgdXNhZ2Ugb25seVxuXHRlYWNoOiBmdW5jdGlvbiggb2JqLCBjYWxsYmFjaywgYXJncyApIHtcblx0XHR2YXIgdmFsdWUsXG5cdFx0XHRpID0gMCxcblx0XHRcdGxlbmd0aCA9IG9iai5sZW5ndGgsXG5cdFx0XHRpc0FycmF5ID0gaXNBcnJheWxpa2UoIG9iaiApO1xuXG5cdFx0aWYgKCBhcmdzICkge1xuXHRcdFx0aWYgKCBpc0FycmF5ICkge1xuXHRcdFx0XHRmb3IgKCA7IGkgPCBsZW5ndGg7IGkrKyApIHtcblx0XHRcdFx0XHR2YWx1ZSA9IGNhbGxiYWNrLmFwcGx5KCBvYmpbIGkgXSwgYXJncyApO1xuXG5cdFx0XHRcdFx0aWYgKCB2YWx1ZSA9PT0gZmFsc2UgKSB7XG5cdFx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdGZvciAoIGkgaW4gb2JqICkge1xuXHRcdFx0XHRcdHZhbHVlID0gY2FsbGJhY2suYXBwbHkoIG9ialsgaSBdLCBhcmdzICk7XG5cblx0XHRcdFx0XHRpZiAoIHZhbHVlID09PSBmYWxzZSApIHtcblx0XHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0fVxuXG5cdFx0Ly8gQSBzcGVjaWFsLCBmYXN0LCBjYXNlIGZvciB0aGUgbW9zdCBjb21tb24gdXNlIG9mIGVhY2hcblx0XHR9IGVsc2Uge1xuXHRcdFx0aWYgKCBpc0FycmF5ICkge1xuXHRcdFx0XHRmb3IgKCA7IGkgPCBsZW5ndGg7IGkrKyApIHtcblx0XHRcdFx0XHR2YWx1ZSA9IGNhbGxiYWNrLmNhbGwoIG9ialsgaSBdLCBpLCBvYmpbIGkgXSApO1xuXG5cdFx0XHRcdFx0aWYgKCB2YWx1ZSA9PT0gZmFsc2UgKSB7XG5cdFx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdGZvciAoIGkgaW4gb2JqICkge1xuXHRcdFx0XHRcdHZhbHVlID0gY2FsbGJhY2suY2FsbCggb2JqWyBpIF0sIGksIG9ialsgaSBdICk7XG5cblx0XHRcdFx0XHRpZiAoIHZhbHVlID09PSBmYWxzZSApIHtcblx0XHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH1cblxuXHRcdHJldHVybiBvYmo7XG5cdH0sXG5cblx0Ly8gU3VwcG9ydDogQW5kcm9pZDw0LjFcblx0dHJpbTogZnVuY3Rpb24oIHRleHQgKSB7XG5cdFx0cmV0dXJuIHRleHQgPT0gbnVsbCA/XG5cdFx0XHRcIlwiIDpcblx0XHRcdCggdGV4dCArIFwiXCIgKS5yZXBsYWNlKCBydHJpbSwgXCJcIiApO1xuXHR9LFxuXG5cdC8vIHJlc3VsdHMgaXMgZm9yIGludGVybmFsIHVzYWdlIG9ubHlcblx0bWFrZUFycmF5OiBmdW5jdGlvbiggYXJyLCByZXN1bHRzICkge1xuXHRcdHZhciByZXQgPSByZXN1bHRzIHx8IFtdO1xuXG5cdFx0aWYgKCBhcnIgIT0gbnVsbCApIHtcblx0XHRcdGlmICggaXNBcnJheWxpa2UoIE9iamVjdChhcnIpICkgKSB7XG5cdFx0XHRcdGpRdWVyeS5tZXJnZSggcmV0LFxuXHRcdFx0XHRcdHR5cGVvZiBhcnIgPT09IFwic3RyaW5nXCIgP1xuXHRcdFx0XHRcdFsgYXJyIF0gOiBhcnJcblx0XHRcdFx0KTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdHB1c2guY2FsbCggcmV0LCBhcnIgKTtcblx0XHRcdH1cblx0XHR9XG5cblx0XHRyZXR1cm4gcmV0O1xuXHR9LFxuXG5cdGluQXJyYXk6IGZ1bmN0aW9uKCBlbGVtLCBhcnIsIGkgKSB7XG5cdFx0cmV0dXJuIGFyciA9PSBudWxsID8gLTEgOiBpbmRleE9mLmNhbGwoIGFyciwgZWxlbSwgaSApO1xuXHR9LFxuXG5cdG1lcmdlOiBmdW5jdGlvbiggZmlyc3QsIHNlY29uZCApIHtcblx0XHR2YXIgbGVuID0gK3NlY29uZC5sZW5ndGgsXG5cdFx0XHRqID0gMCxcblx0XHRcdGkgPSBmaXJzdC5sZW5ndGg7XG5cblx0XHRmb3IgKCA7IGogPCBsZW47IGorKyApIHtcblx0XHRcdGZpcnN0WyBpKysgXSA9IHNlY29uZFsgaiBdO1xuXHRcdH1cblxuXHRcdGZpcnN0Lmxlbmd0aCA9IGk7XG5cblx0XHRyZXR1cm4gZmlyc3Q7XG5cdH0sXG5cblx0Z3JlcDogZnVuY3Rpb24oIGVsZW1zLCBjYWxsYmFjaywgaW52ZXJ0ICkge1xuXHRcdHZhciBjYWxsYmFja0ludmVyc2UsXG5cdFx0XHRtYXRjaGVzID0gW10sXG5cdFx0XHRpID0gMCxcblx0XHRcdGxlbmd0aCA9IGVsZW1zLmxlbmd0aCxcblx0XHRcdGNhbGxiYWNrRXhwZWN0ID0gIWludmVydDtcblxuXHRcdC8vIEdvIHRocm91Z2ggdGhlIGFycmF5LCBvbmx5IHNhdmluZyB0aGUgaXRlbXNcblx0XHQvLyB0aGF0IHBhc3MgdGhlIHZhbGlkYXRvciBmdW5jdGlvblxuXHRcdGZvciAoIDsgaSA8IGxlbmd0aDsgaSsrICkge1xuXHRcdFx0Y2FsbGJhY2tJbnZlcnNlID0gIWNhbGxiYWNrKCBlbGVtc1sgaSBdLCBpICk7XG5cdFx0XHRpZiAoIGNhbGxiYWNrSW52ZXJzZSAhPT0gY2FsbGJhY2tFeHBlY3QgKSB7XG5cdFx0XHRcdG1hdGNoZXMucHVzaCggZWxlbXNbIGkgXSApO1xuXHRcdFx0fVxuXHRcdH1cblxuXHRcdHJldHVybiBtYXRjaGVzO1xuXHR9LFxuXG5cdC8vIGFyZyBpcyBmb3IgaW50ZXJuYWwgdXNhZ2Ugb25seVxuXHRtYXA6IGZ1bmN0aW9uKCBlbGVtcywgY2FsbGJhY2ssIGFyZyApIHtcblx0XHR2YXIgdmFsdWUsXG5cdFx0XHRpID0gMCxcblx0XHRcdGxlbmd0aCA9IGVsZW1zLmxlbmd0aCxcblx0XHRcdGlzQXJyYXkgPSBpc0FycmF5bGlrZSggZWxlbXMgKSxcblx0XHRcdHJldCA9IFtdO1xuXG5cdFx0Ly8gR28gdGhyb3VnaCB0aGUgYXJyYXksIHRyYW5zbGF0aW5nIGVhY2ggb2YgdGhlIGl0ZW1zIHRvIHRoZWlyIG5ldyB2YWx1ZXNcblx0XHRpZiAoIGlzQXJyYXkgKSB7XG5cdFx0XHRmb3IgKCA7IGkgPCBsZW5ndGg7IGkrKyApIHtcblx0XHRcdFx0dmFsdWUgPSBjYWxsYmFjayggZWxlbXNbIGkgXSwgaSwgYXJnICk7XG5cblx0XHRcdFx0aWYgKCB2YWx1ZSAhPSBudWxsICkge1xuXHRcdFx0XHRcdHJldC5wdXNoKCB2YWx1ZSApO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cblx0XHQvLyBHbyB0aHJvdWdoIGV2ZXJ5IGtleSBvbiB0aGUgb2JqZWN0LFxuXHRcdH0gZWxzZSB7XG5cdFx0XHRmb3IgKCBpIGluIGVsZW1zICkge1xuXHRcdFx0XHR2YWx1ZSA9IGNhbGxiYWNrKCBlbGVtc1sgaSBdLCBpLCBhcmcgKTtcblxuXHRcdFx0XHRpZiAoIHZhbHVlICE9IG51bGwgKSB7XG5cdFx0XHRcdFx0cmV0LnB1c2goIHZhbHVlICk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9XG5cblx0XHQvLyBGbGF0dGVuIGFueSBuZXN0ZWQgYXJyYXlzXG5cdFx0cmV0dXJuIGNvbmNhdC5hcHBseSggW10sIHJldCApO1xuXHR9LFxuXG5cdC8vIEEgZ2xvYmFsIEdVSUQgY291bnRlciBmb3Igb2JqZWN0c1xuXHRndWlkOiAxLFxuXG5cdC8vIEJpbmQgYSBmdW5jdGlvbiB0byBhIGNvbnRleHQsIG9wdGlvbmFsbHkgcGFydGlhbGx5IGFwcGx5aW5nIGFueVxuXHQvLyBhcmd1bWVudHMuXG5cdHByb3h5OiBmdW5jdGlvbiggZm4sIGNvbnRleHQgKSB7XG5cdFx0dmFyIHRtcCwgYXJncywgcHJveHk7XG5cblx0XHRpZiAoIHR5cGVvZiBjb250ZXh0ID09PSBcInN0cmluZ1wiICkge1xuXHRcdFx0dG1wID0gZm5bIGNvbnRleHQgXTtcblx0XHRcdGNvbnRleHQgPSBmbjtcblx0XHRcdGZuID0gdG1wO1xuXHRcdH1cblxuXHRcdC8vIFF1aWNrIGNoZWNrIHRvIGRldGVybWluZSBpZiB0YXJnZXQgaXMgY2FsbGFibGUsIGluIHRoZSBzcGVjXG5cdFx0Ly8gdGhpcyB0aHJvd3MgYSBUeXBlRXJyb3IsIGJ1dCB3ZSB3aWxsIGp1c3QgcmV0dXJuIHVuZGVmaW5lZC5cblx0XHRpZiAoICFqUXVlcnkuaXNGdW5jdGlvbiggZm4gKSApIHtcblx0XHRcdHJldHVybiB1bmRlZmluZWQ7XG5cdFx0fVxuXG5cdFx0Ly8gU2ltdWxhdGVkIGJpbmRcblx0XHRhcmdzID0gc2xpY2UuY2FsbCggYXJndW1lbnRzLCAyICk7XG5cdFx0cHJveHkgPSBmdW5jdGlvbigpIHtcblx0XHRcdHJldHVybiBmbi5hcHBseSggY29udGV4dCB8fCB0aGlzLCBhcmdzLmNvbmNhdCggc2xpY2UuY2FsbCggYXJndW1lbnRzICkgKSApO1xuXHRcdH07XG5cblx0XHQvLyBTZXQgdGhlIGd1aWQgb2YgdW5pcXVlIGhhbmRsZXIgdG8gdGhlIHNhbWUgb2Ygb3JpZ2luYWwgaGFuZGxlciwgc28gaXQgY2FuIGJlIHJlbW92ZWRcblx0XHRwcm94eS5ndWlkID0gZm4uZ3VpZCA9IGZuLmd1aWQgfHwgalF1ZXJ5Lmd1aWQrKztcblxuXHRcdHJldHVybiBwcm94eTtcblx0fSxcblxuXHRub3c6IERhdGUubm93LFxuXG5cdC8vIGpRdWVyeS5zdXBwb3J0IGlzIG5vdCB1c2VkIGluIENvcmUgYnV0IG90aGVyIHByb2plY3RzIGF0dGFjaCB0aGVpclxuXHQvLyBwcm9wZXJ0aWVzIHRvIGl0IHNvIGl0IG5lZWRzIHRvIGV4aXN0LlxuXHRzdXBwb3J0OiBzdXBwb3J0XG59KTtcblxuLy8gUG9wdWxhdGUgdGhlIGNsYXNzMnR5cGUgbWFwXG5qUXVlcnkuZWFjaChcIkJvb2xlYW4gTnVtYmVyIFN0cmluZyBGdW5jdGlvbiBBcnJheSBEYXRlIFJlZ0V4cCBPYmplY3QgRXJyb3JcIi5zcGxpdChcIiBcIiksIGZ1bmN0aW9uKGksIG5hbWUpIHtcblx0Y2xhc3MydHlwZVsgXCJbb2JqZWN0IFwiICsgbmFtZSArIFwiXVwiIF0gPSBuYW1lLnRvTG93ZXJDYXNlKCk7XG59KTtcblxuZnVuY3Rpb24gaXNBcnJheWxpa2UoIG9iaiApIHtcblxuXHQvLyBTdXBwb3J0OiBpT1MgOC4yIChub3QgcmVwcm9kdWNpYmxlIGluIHNpbXVsYXRvcilcblx0Ly8gYGluYCBjaGVjayB1c2VkIHRvIHByZXZlbnQgSklUIGVycm9yIChnaC0yMTQ1KVxuXHQvLyBoYXNPd24gaXNuJ3QgdXNlZCBoZXJlIGR1ZSB0byBmYWxzZSBuZWdhdGl2ZXNcblx0Ly8gcmVnYXJkaW5nIE5vZGVsaXN0IGxlbmd0aCBpbiBJRVxuXHR2YXIgbGVuZ3RoID0gXCJsZW5ndGhcIiBpbiBvYmogJiYgb2JqLmxlbmd0aCxcblx0XHR0eXBlID0galF1ZXJ5LnR5cGUoIG9iaiApO1xuXG5cdGlmICggdHlwZSA9PT0gXCJmdW5jdGlvblwiIHx8IGpRdWVyeS5pc1dpbmRvdyggb2JqICkgKSB7XG5cdFx0cmV0dXJuIGZhbHNlO1xuXHR9XG5cblx0aWYgKCBvYmoubm9kZVR5cGUgPT09IDEgJiYgbGVuZ3RoICkge1xuXHRcdHJldHVybiB0cnVlO1xuXHR9XG5cblx0cmV0dXJuIHR5cGUgPT09IFwiYXJyYXlcIiB8fCBsZW5ndGggPT09IDAgfHxcblx0XHR0eXBlb2YgbGVuZ3RoID09PSBcIm51bWJlclwiICYmIGxlbmd0aCA+IDAgJiYgKCBsZW5ndGggLSAxICkgaW4gb2JqO1xufVxudmFyIFNpenpsZSA9XG4vKiFcbiAqIFNpenpsZSBDU1MgU2VsZWN0b3IgRW5naW5lIHYyLjIuMC1wcmVcbiAqIGh0dHA6Ly9zaXp6bGVqcy5jb20vXG4gKlxuICogQ29weXJpZ2h0IDIwMDgsIDIwMTQgalF1ZXJ5IEZvdW5kYXRpb24sIEluYy4gYW5kIG90aGVyIGNvbnRyaWJ1dG9yc1xuICogUmVsZWFzZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlXG4gKiBodHRwOi8vanF1ZXJ5Lm9yZy9saWNlbnNlXG4gKlxuICogRGF0ZTogMjAxNC0xMi0xNlxuICovXG4oZnVuY3Rpb24oIHdpbmRvdyApIHtcblxudmFyIGksXG5cdHN1cHBvcnQsXG5cdEV4cHIsXG5cdGdldFRleHQsXG5cdGlzWE1MLFxuXHR0b2tlbml6ZSxcblx0Y29tcGlsZSxcblx0c2VsZWN0LFxuXHRvdXRlcm1vc3RDb250ZXh0LFxuXHRzb3J0SW5wdXQsXG5cdGhhc0R1cGxpY2F0ZSxcblxuXHQvLyBMb2NhbCBkb2N1bWVudCB2YXJzXG5cdHNldERvY3VtZW50LFxuXHRkb2N1bWVudCxcblx0ZG9jRWxlbSxcblx0ZG9jdW1lbnRJc0hUTUwsXG5cdHJidWdneVFTQSxcblx0cmJ1Z2d5TWF0Y2hlcyxcblx0bWF0Y2hlcyxcblx0Y29udGFpbnMsXG5cblx0Ly8gSW5zdGFuY2Utc3BlY2lmaWMgZGF0YVxuXHRleHBhbmRvID0gXCJzaXp6bGVcIiArIDEgKiBuZXcgRGF0ZSgpLFxuXHRwcmVmZXJyZWREb2MgPSB3aW5kb3cuZG9jdW1lbnQsXG5cdGRpcnJ1bnMgPSAwLFxuXHRkb25lID0gMCxcblx0Y2xhc3NDYWNoZSA9IGNyZWF0ZUNhY2hlKCksXG5cdHRva2VuQ2FjaGUgPSBjcmVhdGVDYWNoZSgpLFxuXHRjb21waWxlckNhY2hlID0gY3JlYXRlQ2FjaGUoKSxcblx0c29ydE9yZGVyID0gZnVuY3Rpb24oIGEsIGIgKSB7XG5cdFx0aWYgKCBhID09PSBiICkge1xuXHRcdFx0aGFzRHVwbGljYXRlID0gdHJ1ZTtcblx0XHR9XG5cdFx0cmV0dXJuIDA7XG5cdH0sXG5cblx0Ly8gR2VuZXJhbC1wdXJwb3NlIGNvbnN0YW50c1xuXHRNQVhfTkVHQVRJVkUgPSAxIDw8IDMxLFxuXG5cdC8vIEluc3RhbmNlIG1ldGhvZHNcblx0aGFzT3duID0gKHt9KS5oYXNPd25Qcm9wZXJ0eSxcblx0YXJyID0gW10sXG5cdHBvcCA9IGFyci5wb3AsXG5cdHB1c2hfbmF0aXZlID0gYXJyLnB1c2gsXG5cdHB1c2ggPSBhcnIucHVzaCxcblx0c2xpY2UgPSBhcnIuc2xpY2UsXG5cdC8vIFVzZSBhIHN0cmlwcGVkLWRvd24gaW5kZXhPZiBhcyBpdCdzIGZhc3RlciB0aGFuIG5hdGl2ZVxuXHQvLyBodHRwOi8vanNwZXJmLmNvbS90aG9yLWluZGV4b2YtdnMtZm9yLzVcblx0aW5kZXhPZiA9IGZ1bmN0aW9uKCBsaXN0LCBlbGVtICkge1xuXHRcdHZhciBpID0gMCxcblx0XHRcdGxlbiA9IGxpc3QubGVuZ3RoO1xuXHRcdGZvciAoIDsgaSA8IGxlbjsgaSsrICkge1xuXHRcdFx0aWYgKCBsaXN0W2ldID09PSBlbGVtICkge1xuXHRcdFx0XHRyZXR1cm4gaTtcblx0XHRcdH1cblx0XHR9XG5cdFx0cmV0dXJuIC0xO1xuXHR9LFxuXG5cdGJvb2xlYW5zID0gXCJjaGVja2VkfHNlbGVjdGVkfGFzeW5jfGF1dG9mb2N1c3xhdXRvcGxheXxjb250cm9sc3xkZWZlcnxkaXNhYmxlZHxoaWRkZW58aXNtYXB8bG9vcHxtdWx0aXBsZXxvcGVufHJlYWRvbmx5fHJlcXVpcmVkfHNjb3BlZFwiLFxuXG5cdC8vIFJlZ3VsYXIgZXhwcmVzc2lvbnNcblxuXHQvLyBXaGl0ZXNwYWNlIGNoYXJhY3RlcnMgaHR0cDovL3d3dy53My5vcmcvVFIvY3NzMy1zZWxlY3RvcnMvI3doaXRlc3BhY2Vcblx0d2hpdGVzcGFjZSA9IFwiW1xcXFx4MjBcXFxcdFxcXFxyXFxcXG5cXFxcZl1cIixcblx0Ly8gaHR0cDovL3d3dy53My5vcmcvVFIvY3NzMy1zeW50YXgvI2NoYXJhY3RlcnNcblx0Y2hhcmFjdGVyRW5jb2RpbmcgPSBcIig/OlxcXFxcXFxcLnxbXFxcXHctXXxbXlxcXFx4MDAtXFxcXHhhMF0pK1wiLFxuXG5cdC8vIExvb3NlbHkgbW9kZWxlZCBvbiBDU1MgaWRlbnRpZmllciBjaGFyYWN0ZXJzXG5cdC8vIEFuIHVucXVvdGVkIHZhbHVlIHNob3VsZCBiZSBhIENTUyBpZGVudGlmaWVyIGh0dHA6Ly93d3cudzMub3JnL1RSL2NzczMtc2VsZWN0b3JzLyNhdHRyaWJ1dGUtc2VsZWN0b3JzXG5cdC8vIFByb3BlciBzeW50YXg6IGh0dHA6Ly93d3cudzMub3JnL1RSL0NTUzIxL3N5bmRhdGEuaHRtbCN2YWx1ZS1kZWYtaWRlbnRpZmllclxuXHRpZGVudGlmaWVyID0gY2hhcmFjdGVyRW5jb2RpbmcucmVwbGFjZSggXCJ3XCIsIFwidyNcIiApLFxuXG5cdC8vIEF0dHJpYnV0ZSBzZWxlY3RvcnM6IGh0dHA6Ly93d3cudzMub3JnL1RSL3NlbGVjdG9ycy8jYXR0cmlidXRlLXNlbGVjdG9yc1xuXHRhdHRyaWJ1dGVzID0gXCJcXFxcW1wiICsgd2hpdGVzcGFjZSArIFwiKihcIiArIGNoYXJhY3RlckVuY29kaW5nICsgXCIpKD86XCIgKyB3aGl0ZXNwYWNlICtcblx0XHQvLyBPcGVyYXRvciAoY2FwdHVyZSAyKVxuXHRcdFwiKihbKl4kfCF+XT89KVwiICsgd2hpdGVzcGFjZSArXG5cdFx0Ly8gXCJBdHRyaWJ1dGUgdmFsdWVzIG11c3QgYmUgQ1NTIGlkZW50aWZpZXJzIFtjYXB0dXJlIDVdIG9yIHN0cmluZ3MgW2NhcHR1cmUgMyBvciBjYXB0dXJlIDRdXCJcblx0XHRcIiooPzonKCg/OlxcXFxcXFxcLnxbXlxcXFxcXFxcJ10pKiknfFxcXCIoKD86XFxcXFxcXFwufFteXFxcXFxcXFxcXFwiXSkqKVxcXCJ8KFwiICsgaWRlbnRpZmllciArIFwiKSl8KVwiICsgd2hpdGVzcGFjZSArXG5cdFx0XCIqXFxcXF1cIixcblxuXHRwc2V1ZG9zID0gXCI6KFwiICsgY2hhcmFjdGVyRW5jb2RpbmcgKyBcIikoPzpcXFxcKChcIiArXG5cdFx0Ly8gVG8gcmVkdWNlIHRoZSBudW1iZXIgb2Ygc2VsZWN0b3JzIG5lZWRpbmcgdG9rZW5pemUgaW4gdGhlIHByZUZpbHRlciwgcHJlZmVyIGFyZ3VtZW50czpcblx0XHQvLyAxLiBxdW90ZWQgKGNhcHR1cmUgMzsgY2FwdHVyZSA0IG9yIGNhcHR1cmUgNSlcblx0XHRcIignKCg/OlxcXFxcXFxcLnxbXlxcXFxcXFxcJ10pKiknfFxcXCIoKD86XFxcXFxcXFwufFteXFxcXFxcXFxcXFwiXSkqKVxcXCIpfFwiICtcblx0XHQvLyAyLiBzaW1wbGUgKGNhcHR1cmUgNilcblx0XHRcIigoPzpcXFxcXFxcXC58W15cXFxcXFxcXCgpW1xcXFxdXXxcIiArIGF0dHJpYnV0ZXMgKyBcIikqKXxcIiArXG5cdFx0Ly8gMy4gYW55dGhpbmcgZWxzZSAoY2FwdHVyZSAyKVxuXHRcdFwiLipcIiArXG5cdFx0XCIpXFxcXCl8KVwiLFxuXG5cdC8vIExlYWRpbmcgYW5kIG5vbi1lc2NhcGVkIHRyYWlsaW5nIHdoaXRlc3BhY2UsIGNhcHR1cmluZyBzb21lIG5vbi13aGl0ZXNwYWNlIGNoYXJhY3RlcnMgcHJlY2VkaW5nIHRoZSBsYXR0ZXJcblx0cndoaXRlc3BhY2UgPSBuZXcgUmVnRXhwKCB3aGl0ZXNwYWNlICsgXCIrXCIsIFwiZ1wiICksXG5cdHJ0cmltID0gbmV3IFJlZ0V4cCggXCJeXCIgKyB3aGl0ZXNwYWNlICsgXCIrfCgoPzpefFteXFxcXFxcXFxdKSg/OlxcXFxcXFxcLikqKVwiICsgd2hpdGVzcGFjZSArIFwiKyRcIiwgXCJnXCIgKSxcblxuXHRyY29tbWEgPSBuZXcgUmVnRXhwKCBcIl5cIiArIHdoaXRlc3BhY2UgKyBcIiosXCIgKyB3aGl0ZXNwYWNlICsgXCIqXCIgKSxcblx0cmNvbWJpbmF0b3JzID0gbmV3IFJlZ0V4cCggXCJeXCIgKyB3aGl0ZXNwYWNlICsgXCIqKFs+K35dfFwiICsgd2hpdGVzcGFjZSArIFwiKVwiICsgd2hpdGVzcGFjZSArIFwiKlwiICksXG5cblx0cmF0dHJpYnV0ZVF1b3RlcyA9IG5ldyBSZWdFeHAoIFwiPVwiICsgd2hpdGVzcGFjZSArIFwiKihbXlxcXFxdJ1xcXCJdKj8pXCIgKyB3aGl0ZXNwYWNlICsgXCIqXFxcXF1cIiwgXCJnXCIgKSxcblxuXHRycHNldWRvID0gbmV3IFJlZ0V4cCggcHNldWRvcyApLFxuXHRyaWRlbnRpZmllciA9IG5ldyBSZWdFeHAoIFwiXlwiICsgaWRlbnRpZmllciArIFwiJFwiICksXG5cblx0bWF0Y2hFeHByID0ge1xuXHRcdFwiSURcIjogbmV3IFJlZ0V4cCggXCJeIyhcIiArIGNoYXJhY3RlckVuY29kaW5nICsgXCIpXCIgKSxcblx0XHRcIkNMQVNTXCI6IG5ldyBSZWdFeHAoIFwiXlxcXFwuKFwiICsgY2hhcmFjdGVyRW5jb2RpbmcgKyBcIilcIiApLFxuXHRcdFwiVEFHXCI6IG5ldyBSZWdFeHAoIFwiXihcIiArIGNoYXJhY3RlckVuY29kaW5nLnJlcGxhY2UoIFwid1wiLCBcIncqXCIgKSArIFwiKVwiICksXG5cdFx0XCJBVFRSXCI6IG5ldyBSZWdFeHAoIFwiXlwiICsgYXR0cmlidXRlcyApLFxuXHRcdFwiUFNFVURPXCI6IG5ldyBSZWdFeHAoIFwiXlwiICsgcHNldWRvcyApLFxuXHRcdFwiQ0hJTERcIjogbmV3IFJlZ0V4cCggXCJeOihvbmx5fGZpcnN0fGxhc3R8bnRofG50aC1sYXN0KS0oY2hpbGR8b2YtdHlwZSkoPzpcXFxcKFwiICsgd2hpdGVzcGFjZSArXG5cdFx0XHRcIiooZXZlbnxvZGR8KChbKy1dfCkoXFxcXGQqKW58KVwiICsgd2hpdGVzcGFjZSArIFwiKig/OihbKy1dfClcIiArIHdoaXRlc3BhY2UgK1xuXHRcdFx0XCIqKFxcXFxkKyl8KSlcIiArIHdoaXRlc3BhY2UgKyBcIipcXFxcKXwpXCIsIFwiaVwiICksXG5cdFx0XCJib29sXCI6IG5ldyBSZWdFeHAoIFwiXig/OlwiICsgYm9vbGVhbnMgKyBcIikkXCIsIFwiaVwiICksXG5cdFx0Ly8gRm9yIHVzZSBpbiBsaWJyYXJpZXMgaW1wbGVtZW50aW5nIC5pcygpXG5cdFx0Ly8gV2UgdXNlIHRoaXMgZm9yIFBPUyBtYXRjaGluZyBpbiBgc2VsZWN0YFxuXHRcdFwibmVlZHNDb250ZXh0XCI6IG5ldyBSZWdFeHAoIFwiXlwiICsgd2hpdGVzcGFjZSArIFwiKls+K35dfDooZXZlbnxvZGR8ZXF8Z3R8bHR8bnRofGZpcnN0fGxhc3QpKD86XFxcXChcIiArXG5cdFx0XHR3aGl0ZXNwYWNlICsgXCIqKCg/Oi1cXFxcZCk/XFxcXGQqKVwiICsgd2hpdGVzcGFjZSArIFwiKlxcXFwpfCkoPz1bXi1dfCQpXCIsIFwiaVwiIClcblx0fSxcblxuXHRyaW5wdXRzID0gL14oPzppbnB1dHxzZWxlY3R8dGV4dGFyZWF8YnV0dG9uKSQvaSxcblx0cmhlYWRlciA9IC9eaFxcZCQvaSxcblxuXHRybmF0aXZlID0gL15bXntdK1xce1xccypcXFtuYXRpdmUgXFx3LyxcblxuXHQvLyBFYXNpbHktcGFyc2VhYmxlL3JldHJpZXZhYmxlIElEIG9yIFRBRyBvciBDTEFTUyBzZWxlY3RvcnNcblx0cnF1aWNrRXhwciA9IC9eKD86IyhbXFx3LV0rKXwoXFx3Kyl8XFwuKFtcXHctXSspKSQvLFxuXG5cdHJzaWJsaW5nID0gL1srfl0vLFxuXHRyZXNjYXBlID0gLyd8XFxcXC9nLFxuXG5cdC8vIENTUyBlc2NhcGVzIGh0dHA6Ly93d3cudzMub3JnL1RSL0NTUzIxL3N5bmRhdGEuaHRtbCNlc2NhcGVkLWNoYXJhY3RlcnNcblx0cnVuZXNjYXBlID0gbmV3IFJlZ0V4cCggXCJcXFxcXFxcXChbXFxcXGRhLWZdezEsNn1cIiArIHdoaXRlc3BhY2UgKyBcIj98KFwiICsgd2hpdGVzcGFjZSArIFwiKXwuKVwiLCBcImlnXCIgKSxcblx0ZnVuZXNjYXBlID0gZnVuY3Rpb24oIF8sIGVzY2FwZWQsIGVzY2FwZWRXaGl0ZXNwYWNlICkge1xuXHRcdHZhciBoaWdoID0gXCIweFwiICsgZXNjYXBlZCAtIDB4MTAwMDA7XG5cdFx0Ly8gTmFOIG1lYW5zIG5vbi1jb2RlcG9pbnRcblx0XHQvLyBTdXBwb3J0OiBGaXJlZm94PDI0XG5cdFx0Ly8gV29ya2Fyb3VuZCBlcnJvbmVvdXMgbnVtZXJpYyBpbnRlcnByZXRhdGlvbiBvZiArXCIweFwiXG5cdFx0cmV0dXJuIGhpZ2ggIT09IGhpZ2ggfHwgZXNjYXBlZFdoaXRlc3BhY2UgP1xuXHRcdFx0ZXNjYXBlZCA6XG5cdFx0XHRoaWdoIDwgMCA/XG5cdFx0XHRcdC8vIEJNUCBjb2RlcG9pbnRcblx0XHRcdFx0U3RyaW5nLmZyb21DaGFyQ29kZSggaGlnaCArIDB4MTAwMDAgKSA6XG5cdFx0XHRcdC8vIFN1cHBsZW1lbnRhbCBQbGFuZSBjb2RlcG9pbnQgKHN1cnJvZ2F0ZSBwYWlyKVxuXHRcdFx0XHRTdHJpbmcuZnJvbUNoYXJDb2RlKCBoaWdoID4+IDEwIHwgMHhEODAwLCBoaWdoICYgMHgzRkYgfCAweERDMDAgKTtcblx0fSxcblxuXHQvLyBVc2VkIGZvciBpZnJhbWVzXG5cdC8vIFNlZSBzZXREb2N1bWVudCgpXG5cdC8vIFJlbW92aW5nIHRoZSBmdW5jdGlvbiB3cmFwcGVyIGNhdXNlcyBhIFwiUGVybWlzc2lvbiBEZW5pZWRcIlxuXHQvLyBlcnJvciBpbiBJRVxuXHR1bmxvYWRIYW5kbGVyID0gZnVuY3Rpb24oKSB7XG5cdFx0c2V0RG9jdW1lbnQoKTtcblx0fTtcblxuLy8gT3B0aW1pemUgZm9yIHB1c2guYXBwbHkoIF8sIE5vZGVMaXN0IClcbnRyeSB7XG5cdHB1c2guYXBwbHkoXG5cdFx0KGFyciA9IHNsaWNlLmNhbGwoIHByZWZlcnJlZERvYy5jaGlsZE5vZGVzICkpLFxuXHRcdHByZWZlcnJlZERvYy5jaGlsZE5vZGVzXG5cdCk7XG5cdC8vIFN1cHBvcnQ6IEFuZHJvaWQ8NC4wXG5cdC8vIERldGVjdCBzaWxlbnRseSBmYWlsaW5nIHB1c2guYXBwbHlcblx0YXJyWyBwcmVmZXJyZWREb2MuY2hpbGROb2Rlcy5sZW5ndGggXS5ub2RlVHlwZTtcbn0gY2F0Y2ggKCBlICkge1xuXHRwdXNoID0geyBhcHBseTogYXJyLmxlbmd0aCA/XG5cblx0XHQvLyBMZXZlcmFnZSBzbGljZSBpZiBwb3NzaWJsZVxuXHRcdGZ1bmN0aW9uKCB0YXJnZXQsIGVscyApIHtcblx0XHRcdHB1c2hfbmF0aXZlLmFwcGx5KCB0YXJnZXQsIHNsaWNlLmNhbGwoZWxzKSApO1xuXHRcdH0gOlxuXG5cdFx0Ly8gU3VwcG9ydDogSUU8OVxuXHRcdC8vIE90aGVyd2lzZSBhcHBlbmQgZGlyZWN0bHlcblx0XHRmdW5jdGlvbiggdGFyZ2V0LCBlbHMgKSB7XG5cdFx0XHR2YXIgaiA9IHRhcmdldC5sZW5ndGgsXG5cdFx0XHRcdGkgPSAwO1xuXHRcdFx0Ly8gQ2FuJ3QgdHJ1c3QgTm9kZUxpc3QubGVuZ3RoXG5cdFx0XHR3aGlsZSAoICh0YXJnZXRbaisrXSA9IGVsc1tpKytdKSApIHt9XG5cdFx0XHR0YXJnZXQubGVuZ3RoID0gaiAtIDE7XG5cdFx0fVxuXHR9O1xufVxuXG5mdW5jdGlvbiBTaXp6bGUoIHNlbGVjdG9yLCBjb250ZXh0LCByZXN1bHRzLCBzZWVkICkge1xuXHR2YXIgbWF0Y2gsIGVsZW0sIG0sIG5vZGVUeXBlLFxuXHRcdC8vIFFTQSB2YXJzXG5cdFx0aSwgZ3JvdXBzLCBvbGQsIG5pZCwgbmV3Q29udGV4dCwgbmV3U2VsZWN0b3I7XG5cblx0aWYgKCAoIGNvbnRleHQgPyBjb250ZXh0Lm93bmVyRG9jdW1lbnQgfHwgY29udGV4dCA6IHByZWZlcnJlZERvYyApICE9PSBkb2N1bWVudCApIHtcblx0XHRzZXREb2N1bWVudCggY29udGV4dCApO1xuXHR9XG5cblx0Y29udGV4dCA9IGNvbnRleHQgfHwgZG9jdW1lbnQ7XG5cdHJlc3VsdHMgPSByZXN1bHRzIHx8IFtdO1xuXHRub2RlVHlwZSA9IGNvbnRleHQubm9kZVR5cGU7XG5cblx0aWYgKCB0eXBlb2Ygc2VsZWN0b3IgIT09IFwic3RyaW5nXCIgfHwgIXNlbGVjdG9yIHx8XG5cdFx0bm9kZVR5cGUgIT09IDEgJiYgbm9kZVR5cGUgIT09IDkgJiYgbm9kZVR5cGUgIT09IDExICkge1xuXG5cdFx0cmV0dXJuIHJlc3VsdHM7XG5cdH1cblxuXHRpZiAoICFzZWVkICYmIGRvY3VtZW50SXNIVE1MICkge1xuXG5cdFx0Ly8gVHJ5IHRvIHNob3J0Y3V0IGZpbmQgb3BlcmF0aW9ucyB3aGVuIHBvc3NpYmxlIChlLmcuLCBub3QgdW5kZXIgRG9jdW1lbnRGcmFnbWVudClcblx0XHRpZiAoIG5vZGVUeXBlICE9PSAxMSAmJiAobWF0Y2ggPSBycXVpY2tFeHByLmV4ZWMoIHNlbGVjdG9yICkpICkge1xuXHRcdFx0Ly8gU3BlZWQtdXA6IFNpenpsZShcIiNJRFwiKVxuXHRcdFx0aWYgKCAobSA9IG1hdGNoWzFdKSApIHtcblx0XHRcdFx0aWYgKCBub2RlVHlwZSA9PT0gOSApIHtcblx0XHRcdFx0XHRlbGVtID0gY29udGV4dC5nZXRFbGVtZW50QnlJZCggbSApO1xuXHRcdFx0XHRcdC8vIENoZWNrIHBhcmVudE5vZGUgdG8gY2F0Y2ggd2hlbiBCbGFja2JlcnJ5IDQuNiByZXR1cm5zXG5cdFx0XHRcdFx0Ly8gbm9kZXMgdGhhdCBhcmUgbm8gbG9uZ2VyIGluIHRoZSBkb2N1bWVudCAoalF1ZXJ5ICM2OTYzKVxuXHRcdFx0XHRcdGlmICggZWxlbSAmJiBlbGVtLnBhcmVudE5vZGUgKSB7XG5cdFx0XHRcdFx0XHQvLyBIYW5kbGUgdGhlIGNhc2Ugd2hlcmUgSUUsIE9wZXJhLCBhbmQgV2Via2l0IHJldHVybiBpdGVtc1xuXHRcdFx0XHRcdFx0Ly8gYnkgbmFtZSBpbnN0ZWFkIG9mIElEXG5cdFx0XHRcdFx0XHRpZiAoIGVsZW0uaWQgPT09IG0gKSB7XG5cdFx0XHRcdFx0XHRcdHJlc3VsdHMucHVzaCggZWxlbSApO1xuXHRcdFx0XHRcdFx0XHRyZXR1cm4gcmVzdWx0cztcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0cmV0dXJuIHJlc3VsdHM7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdC8vIENvbnRleHQgaXMgbm90IGEgZG9jdW1lbnRcblx0XHRcdFx0XHRpZiAoIGNvbnRleHQub3duZXJEb2N1bWVudCAmJiAoZWxlbSA9IGNvbnRleHQub3duZXJEb2N1bWVudC5nZXRFbGVtZW50QnlJZCggbSApKSAmJlxuXHRcdFx0XHRcdFx0Y29udGFpbnMoIGNvbnRleHQsIGVsZW0gKSAmJiBlbGVtLmlkID09PSBtICkge1xuXHRcdFx0XHRcdFx0cmVzdWx0cy5wdXNoKCBlbGVtICk7XG5cdFx0XHRcdFx0XHRyZXR1cm4gcmVzdWx0cztcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblxuXHRcdFx0Ly8gU3BlZWQtdXA6IFNpenpsZShcIlRBR1wiKVxuXHRcdFx0fSBlbHNlIGlmICggbWF0Y2hbMl0gKSB7XG5cdFx0XHRcdHB1c2guYXBwbHkoIHJlc3VsdHMsIGNvbnRleHQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoIHNlbGVjdG9yICkgKTtcblx0XHRcdFx0cmV0dXJuIHJlc3VsdHM7XG5cblx0XHRcdC8vIFNwZWVkLXVwOiBTaXp6bGUoXCIuQ0xBU1NcIilcblx0XHRcdH0gZWxzZSBpZiAoIChtID0gbWF0Y2hbM10pICYmIHN1cHBvcnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSApIHtcblx0XHRcdFx0cHVzaC5hcHBseSggcmVzdWx0cywgY29udGV4dC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCBtICkgKTtcblx0XHRcdFx0cmV0dXJuIHJlc3VsdHM7XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0Ly8gUVNBIHBhdGhcblx0XHRpZiAoIHN1cHBvcnQucXNhICYmICghcmJ1Z2d5UVNBIHx8ICFyYnVnZ3lRU0EudGVzdCggc2VsZWN0b3IgKSkgKSB7XG5cdFx0XHRuaWQgPSBvbGQgPSBleHBhbmRvO1xuXHRcdFx0bmV3Q29udGV4dCA9IGNvbnRleHQ7XG5cdFx0XHRuZXdTZWxlY3RvciA9IG5vZGVUeXBlICE9PSAxICYmIHNlbGVjdG9yO1xuXG5cdFx0XHQvLyBxU0Egd29ya3Mgc3RyYW5nZWx5IG9uIEVsZW1lbnQtcm9vdGVkIHF1ZXJpZXNcblx0XHRcdC8vIFdlIGNhbiB3b3JrIGFyb3VuZCB0aGlzIGJ5IHNwZWNpZnlpbmcgYW4gZXh0cmEgSUQgb24gdGhlIHJvb3Rcblx0XHRcdC8vIGFuZCB3b3JraW5nIHVwIGZyb20gdGhlcmUgKFRoYW5rcyB0byBBbmRyZXcgRHVwb250IGZvciB0aGUgdGVjaG5pcXVlKVxuXHRcdFx0Ly8gSUUgOCBkb2Vzbid0IHdvcmsgb24gb2JqZWN0IGVsZW1lbnRzXG5cdFx0XHRpZiAoIG5vZGVUeXBlID09PSAxICYmIGNvbnRleHQubm9kZU5hbWUudG9Mb3dlckNhc2UoKSAhPT0gXCJvYmplY3RcIiApIHtcblx0XHRcdFx0Z3JvdXBzID0gdG9rZW5pemUoIHNlbGVjdG9yICk7XG5cblx0XHRcdFx0aWYgKCAob2xkID0gY29udGV4dC5nZXRBdHRyaWJ1dGUoXCJpZFwiKSkgKSB7XG5cdFx0XHRcdFx0bmlkID0gb2xkLnJlcGxhY2UoIHJlc2NhcGUsIFwiXFxcXCQmXCIgKTtcblx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRjb250ZXh0LnNldEF0dHJpYnV0ZSggXCJpZFwiLCBuaWQgKTtcblx0XHRcdFx0fVxuXHRcdFx0XHRuaWQgPSBcIltpZD0nXCIgKyBuaWQgKyBcIiddIFwiO1xuXG5cdFx0XHRcdGkgPSBncm91cHMubGVuZ3RoO1xuXHRcdFx0XHR3aGlsZSAoIGktLSApIHtcblx0XHRcdFx0XHRncm91cHNbaV0gPSBuaWQgKyB0b1NlbGVjdG9yKCBncm91cHNbaV0gKTtcblx0XHRcdFx0fVxuXHRcdFx0XHRuZXdDb250ZXh0ID0gcnNpYmxpbmcudGVzdCggc2VsZWN0b3IgKSAmJiB0ZXN0Q29udGV4dCggY29udGV4dC5wYXJlbnROb2RlICkgfHwgY29udGV4dDtcblx0XHRcdFx0bmV3U2VsZWN0b3IgPSBncm91cHMuam9pbihcIixcIik7XG5cdFx0XHR9XG5cblx0XHRcdGlmICggbmV3U2VsZWN0b3IgKSB7XG5cdFx0XHRcdHRyeSB7XG5cdFx0XHRcdFx0cHVzaC5hcHBseSggcmVzdWx0cyxcblx0XHRcdFx0XHRcdG5ld0NvbnRleHQucXVlcnlTZWxlY3RvckFsbCggbmV3U2VsZWN0b3IgKVxuXHRcdFx0XHRcdCk7XG5cdFx0XHRcdFx0cmV0dXJuIHJlc3VsdHM7XG5cdFx0XHRcdH0gY2F0Y2gocXNhRXJyb3IpIHtcblx0XHRcdFx0fSBmaW5hbGx5IHtcblx0XHRcdFx0XHRpZiAoICFvbGQgKSB7XG5cdFx0XHRcdFx0XHRjb250ZXh0LnJlbW92ZUF0dHJpYnV0ZShcImlkXCIpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH1cblx0fVxuXG5cdC8vIEFsbCBvdGhlcnNcblx0cmV0dXJuIHNlbGVjdCggc2VsZWN0b3IucmVwbGFjZSggcnRyaW0sIFwiJDFcIiApLCBjb250ZXh0LCByZXN1bHRzLCBzZWVkICk7XG59XG5cbi8qKlxuICogQ3JlYXRlIGtleS12YWx1ZSBjYWNoZXMgb2YgbGltaXRlZCBzaXplXG4gKiBAcmV0dXJucyB7RnVuY3Rpb24oc3RyaW5nLCBPYmplY3QpfSBSZXR1cm5zIHRoZSBPYmplY3QgZGF0YSBhZnRlciBzdG9yaW5nIGl0IG9uIGl0c2VsZiB3aXRoXG4gKlx0cHJvcGVydHkgbmFtZSB0aGUgKHNwYWNlLXN1ZmZpeGVkKSBzdHJpbmcgYW5kIChpZiB0aGUgY2FjaGUgaXMgbGFyZ2VyIHRoYW4gRXhwci5jYWNoZUxlbmd0aClcbiAqXHRkZWxldGluZyB0aGUgb2xkZXN0IGVudHJ5XG4gKi9cbmZ1bmN0aW9uIGNyZWF0ZUNhY2hlKCkge1xuXHR2YXIga2V5cyA9IFtdO1xuXG5cdGZ1bmN0aW9uIGNhY2hlKCBrZXksIHZhbHVlICkge1xuXHRcdC8vIFVzZSAoa2V5ICsgXCIgXCIpIHRvIGF2b2lkIGNvbGxpc2lvbiB3aXRoIG5hdGl2ZSBwcm90b3R5cGUgcHJvcGVydGllcyAoc2VlIElzc3VlICMxNTcpXG5cdFx0aWYgKCBrZXlzLnB1c2goIGtleSArIFwiIFwiICkgPiBFeHByLmNhY2hlTGVuZ3RoICkge1xuXHRcdFx0Ly8gT25seSBrZWVwIHRoZSBtb3N0IHJlY2VudCBlbnRyaWVzXG5cdFx0XHRkZWxldGUgY2FjaGVbIGtleXMuc2hpZnQoKSBdO1xuXHRcdH1cblx0XHRyZXR1cm4gKGNhY2hlWyBrZXkgKyBcIiBcIiBdID0gdmFsdWUpO1xuXHR9XG5cdHJldHVybiBjYWNoZTtcbn1cblxuLyoqXG4gKiBNYXJrIGEgZnVuY3Rpb24gZm9yIHNwZWNpYWwgdXNlIGJ5IFNpenpsZVxuICogQHBhcmFtIHtGdW5jdGlvbn0gZm4gVGhlIGZ1bmN0aW9uIHRvIG1hcmtcbiAqL1xuZnVuY3Rpb24gbWFya0Z1bmN0aW9uKCBmbiApIHtcblx0Zm5bIGV4cGFuZG8gXSA9IHRydWU7XG5cdHJldHVybiBmbjtcbn1cblxuLyoqXG4gKiBTdXBwb3J0IHRlc3RpbmcgdXNpbmcgYW4gZWxlbWVudFxuICogQHBhcmFtIHtGdW5jdGlvbn0gZm4gUGFzc2VkIHRoZSBjcmVhdGVkIGRpdiBhbmQgZXhwZWN0cyBhIGJvb2xlYW4gcmVzdWx0XG4gKi9cbmZ1bmN0aW9uIGFzc2VydCggZm4gKSB7XG5cdHZhciBkaXYgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuXG5cdHRyeSB7XG5cdFx0cmV0dXJuICEhZm4oIGRpdiApO1xuXHR9IGNhdGNoIChlKSB7XG5cdFx0cmV0dXJuIGZhbHNlO1xuXHR9IGZpbmFsbHkge1xuXHRcdC8vIFJlbW92ZSBmcm9tIGl0cyBwYXJlbnQgYnkgZGVmYXVsdFxuXHRcdGlmICggZGl2LnBhcmVudE5vZGUgKSB7XG5cdFx0XHRkaXYucGFyZW50Tm9kZS5yZW1vdmVDaGlsZCggZGl2ICk7XG5cdFx0fVxuXHRcdC8vIHJlbGVhc2UgbWVtb3J5IGluIElFXG5cdFx0ZGl2ID0gbnVsbDtcblx0fVxufVxuXG4vKipcbiAqIEFkZHMgdGhlIHNhbWUgaGFuZGxlciBmb3IgYWxsIG9mIHRoZSBzcGVjaWZpZWQgYXR0cnNcbiAqIEBwYXJhbSB7U3RyaW5nfSBhdHRycyBQaXBlLXNlcGFyYXRlZCBsaXN0IG9mIGF0dHJpYnV0ZXNcbiAqIEBwYXJhbSB7RnVuY3Rpb259IGhhbmRsZXIgVGhlIG1ldGhvZCB0aGF0IHdpbGwgYmUgYXBwbGllZFxuICovXG5mdW5jdGlvbiBhZGRIYW5kbGUoIGF0dHJzLCBoYW5kbGVyICkge1xuXHR2YXIgYXJyID0gYXR0cnMuc3BsaXQoXCJ8XCIpLFxuXHRcdGkgPSBhdHRycy5sZW5ndGg7XG5cblx0d2hpbGUgKCBpLS0gKSB7XG5cdFx0RXhwci5hdHRySGFuZGxlWyBhcnJbaV0gXSA9IGhhbmRsZXI7XG5cdH1cbn1cblxuLyoqXG4gKiBDaGVja3MgZG9jdW1lbnQgb3JkZXIgb2YgdHdvIHNpYmxpbmdzXG4gKiBAcGFyYW0ge0VsZW1lbnR9IGFcbiAqIEBwYXJhbSB7RWxlbWVudH0gYlxuICogQHJldHVybnMge051bWJlcn0gUmV0dXJucyBsZXNzIHRoYW4gMCBpZiBhIHByZWNlZGVzIGIsIGdyZWF0ZXIgdGhhbiAwIGlmIGEgZm9sbG93cyBiXG4gKi9cbmZ1bmN0aW9uIHNpYmxpbmdDaGVjayggYSwgYiApIHtcblx0dmFyIGN1ciA9IGIgJiYgYSxcblx0XHRkaWZmID0gY3VyICYmIGEubm9kZVR5cGUgPT09IDEgJiYgYi5ub2RlVHlwZSA9PT0gMSAmJlxuXHRcdFx0KCB+Yi5zb3VyY2VJbmRleCB8fCBNQVhfTkVHQVRJVkUgKSAtXG5cdFx0XHQoIH5hLnNvdXJjZUluZGV4IHx8IE1BWF9ORUdBVElWRSApO1xuXG5cdC8vIFVzZSBJRSBzb3VyY2VJbmRleCBpZiBhdmFpbGFibGUgb24gYm90aCBub2Rlc1xuXHRpZiAoIGRpZmYgKSB7XG5cdFx0cmV0dXJuIGRpZmY7XG5cdH1cblxuXHQvLyBDaGVjayBpZiBiIGZvbGxvd3MgYVxuXHRpZiAoIGN1ciApIHtcblx0XHR3aGlsZSAoIChjdXIgPSBjdXIubmV4dFNpYmxpbmcpICkge1xuXHRcdFx0aWYgKCBjdXIgPT09IGIgKSB7XG5cdFx0XHRcdHJldHVybiAtMTtcblx0XHRcdH1cblx0XHR9XG5cdH1cblxuXHRyZXR1cm4gYSA/IDEgOiAtMTtcbn1cblxuLyoqXG4gKiBSZXR1cm5zIGEgZnVuY3Rpb24gdG8gdXNlIGluIHBzZXVkb3MgZm9yIGlucHV0IHR5cGVzXG4gKiBAcGFyYW0ge1N0cmluZ30gdHlwZVxuICovXG5mdW5jdGlvbiBjcmVhdGVJbnB1dFBzZXVkbyggdHlwZSApIHtcblx0cmV0dXJuIGZ1bmN0aW9uKCBlbGVtICkge1xuXHRcdHZhciBuYW1lID0gZWxlbS5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpO1xuXHRcdHJldHVybiBuYW1lID09PSBcImlucHV0XCIgJiYgZWxlbS50eXBlID09PSB0eXBlO1xuXHR9O1xufVxuXG4vKipcbiAqIFJldHVybnMgYSBmdW5jdGlvbiB0byB1c2UgaW4gcHNldWRvcyBmb3IgYnV0dG9uc1xuICogQHBhcmFtIHtTdHJpbmd9IHR5cGVcbiAqL1xuZnVuY3Rpb24gY3JlYXRlQnV0dG9uUHNldWRvKCB0eXBlICkge1xuXHRyZXR1cm4gZnVuY3Rpb24oIGVsZW0gKSB7XG5cdFx0dmFyIG5hbWUgPSBlbGVtLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCk7XG5cdFx0cmV0dXJuIChuYW1lID09PSBcImlucHV0XCIgfHwgbmFtZSA9PT0gXCJidXR0b25cIikgJiYgZWxlbS50eXBlID09PSB0eXBlO1xuXHR9O1xufVxuXG4vKipcbiAqIFJldHVybnMgYSBmdW5jdGlvbiB0byB1c2UgaW4gcHNldWRvcyBmb3IgcG9zaXRpb25hbHNcbiAqIEBwYXJhbSB7RnVuY3Rpb259IGZuXG4gKi9cbmZ1bmN0aW9uIGNyZWF0ZVBvc2l0aW9uYWxQc2V1ZG8oIGZuICkge1xuXHRyZXR1cm4gbWFya0Z1bmN0aW9uKGZ1bmN0aW9uKCBhcmd1bWVudCApIHtcblx0XHRhcmd1bWVudCA9ICthcmd1bWVudDtcblx0XHRyZXR1cm4gbWFya0Z1bmN0aW9uKGZ1bmN0aW9uKCBzZWVkLCBtYXRjaGVzICkge1xuXHRcdFx0dmFyIGosXG5cdFx0XHRcdG1hdGNoSW5kZXhlcyA9IGZuKCBbXSwgc2VlZC5sZW5ndGgsIGFyZ3VtZW50ICksXG5cdFx0XHRcdGkgPSBtYXRjaEluZGV4ZXMubGVuZ3RoO1xuXG5cdFx0XHQvLyBNYXRjaCBlbGVtZW50cyBmb3VuZCBhdCB0aGUgc3BlY2lmaWVkIGluZGV4ZXNcblx0XHRcdHdoaWxlICggaS0tICkge1xuXHRcdFx0XHRpZiAoIHNlZWRbIChqID0gbWF0Y2hJbmRleGVzW2ldKSBdICkge1xuXHRcdFx0XHRcdHNlZWRbal0gPSAhKG1hdGNoZXNbal0gPSBzZWVkW2pdKTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH0pO1xuXHR9KTtcbn1cblxuLyoqXG4gKiBDaGVja3MgYSBub2RlIGZvciB2YWxpZGl0eSBhcyBhIFNpenpsZSBjb250ZXh0XG4gKiBAcGFyYW0ge0VsZW1lbnR8T2JqZWN0PX0gY29udGV4dFxuICogQHJldHVybnMge0VsZW1lbnR8T2JqZWN0fEJvb2xlYW59IFRoZSBpbnB1dCBub2RlIGlmIGFjY2VwdGFibGUsIG90aGVyd2lzZSBhIGZhbHN5IHZhbHVlXG4gKi9cbmZ1bmN0aW9uIHRlc3RDb250ZXh0KCBjb250ZXh0ICkge1xuXHRyZXR1cm4gY29udGV4dCAmJiB0eXBlb2YgY29udGV4dC5nZXRFbGVtZW50c0J5VGFnTmFtZSAhPT0gXCJ1bmRlZmluZWRcIiAmJiBjb250ZXh0O1xufVxuXG4vLyBFeHBvc2Ugc3VwcG9ydCB2YXJzIGZvciBjb252ZW5pZW5jZVxuc3VwcG9ydCA9IFNpenpsZS5zdXBwb3J0ID0ge307XG5cbi8qKlxuICogRGV0ZWN0cyBYTUwgbm9kZXNcbiAqIEBwYXJhbSB7RWxlbWVudHxPYmplY3R9IGVsZW0gQW4gZWxlbWVudCBvciBhIGRvY3VtZW50XG4gKiBAcmV0dXJucyB7Qm9vbGVhbn0gVHJ1ZSBpZmYgZWxlbSBpcyBhIG5vbi1IVE1MIFhNTCBub2RlXG4gKi9cbmlzWE1MID0gU2l6emxlLmlzWE1MID0gZnVuY3Rpb24oIGVsZW0gKSB7XG5cdC8vIGRvY3VtZW50RWxlbWVudCBpcyB2ZXJpZmllZCBmb3IgY2FzZXMgd2hlcmUgaXQgZG9lc24ndCB5ZXQgZXhpc3Rcblx0Ly8gKHN1Y2ggYXMgbG9hZGluZyBpZnJhbWVzIGluIElFIC0gIzQ4MzMpXG5cdHZhciBkb2N1bWVudEVsZW1lbnQgPSBlbGVtICYmIChlbGVtLm93bmVyRG9jdW1lbnQgfHwgZWxlbSkuZG9jdW1lbnRFbGVtZW50O1xuXHRyZXR1cm4gZG9jdW1lbnRFbGVtZW50ID8gZG9jdW1lbnRFbGVtZW50Lm5vZGVOYW1lICE9PSBcIkhUTUxcIiA6IGZhbHNlO1xufTtcblxuLyoqXG4gKiBTZXRzIGRvY3VtZW50LXJlbGF0ZWQgdmFyaWFibGVzIG9uY2UgYmFzZWQgb24gdGhlIGN1cnJlbnQgZG9jdW1lbnRcbiAqIEBwYXJhbSB7RWxlbWVudHxPYmplY3R9IFtkb2NdIEFuIGVsZW1lbnQgb3IgZG9jdW1lbnQgb2JqZWN0IHRvIHVzZSB0byBzZXQgdGhlIGRvY3VtZW50XG4gKiBAcmV0dXJucyB7T2JqZWN0fSBSZXR1cm5zIHRoZSBjdXJyZW50IGRvY3VtZW50XG4gKi9cbnNldERvY3VtZW50ID0gU2l6emxlLnNldERvY3VtZW50ID0gZnVuY3Rpb24oIG5vZGUgKSB7XG5cdHZhciBoYXNDb21wYXJlLCBwYXJlbnQsXG5cdFx0ZG9jID0gbm9kZSA/IG5vZGUub3duZXJEb2N1bWVudCB8fCBub2RlIDogcHJlZmVycmVkRG9jO1xuXG5cdC8vIElmIG5vIGRvY3VtZW50IGFuZCBkb2N1bWVudEVsZW1lbnQgaXMgYXZhaWxhYmxlLCByZXR1cm5cblx0aWYgKCBkb2MgPT09IGRvY3VtZW50IHx8IGRvYy5ub2RlVHlwZSAhPT0gOSB8fCAhZG9jLmRvY3VtZW50RWxlbWVudCApIHtcblx0XHRyZXR1cm4gZG9jdW1lbnQ7XG5cdH1cblxuXHQvLyBTZXQgb3VyIGRvY3VtZW50XG5cdGRvY3VtZW50ID0gZG9jO1xuXHRkb2NFbGVtID0gZG9jLmRvY3VtZW50RWxlbWVudDtcblx0cGFyZW50ID0gZG9jLmRlZmF1bHRWaWV3O1xuXG5cdC8vIFN1cHBvcnQ6IElFPjhcblx0Ly8gSWYgaWZyYW1lIGRvY3VtZW50IGlzIGFzc2lnbmVkIHRvIFwiZG9jdW1lbnRcIiB2YXJpYWJsZSBhbmQgaWYgaWZyYW1lIGhhcyBiZWVuIHJlbG9hZGVkLFxuXHQvLyBJRSB3aWxsIHRocm93IFwicGVybWlzc2lvbiBkZW5pZWRcIiBlcnJvciB3aGVuIGFjY2Vzc2luZyBcImRvY3VtZW50XCIgdmFyaWFibGUsIHNlZSBqUXVlcnkgIzEzOTM2XG5cdC8vIElFNi04IGRvIG5vdCBzdXBwb3J0IHRoZSBkZWZhdWx0VmlldyBwcm9wZXJ0eSBzbyBwYXJlbnQgd2lsbCBiZSB1bmRlZmluZWRcblx0aWYgKCBwYXJlbnQgJiYgcGFyZW50ICE9PSBwYXJlbnQudG9wICkge1xuXHRcdC8vIElFMTEgZG9lcyBub3QgaGF2ZSBhdHRhY2hFdmVudCwgc28gYWxsIG11c3Qgc3VmZmVyXG5cdFx0aWYgKCBwYXJlbnQuYWRkRXZlbnRMaXN0ZW5lciApIHtcblx0XHRcdHBhcmVudC5hZGRFdmVudExpc3RlbmVyKCBcInVubG9hZFwiLCB1bmxvYWRIYW5kbGVyLCBmYWxzZSApO1xuXHRcdH0gZWxzZSBpZiAoIHBhcmVudC5hdHRhY2hFdmVudCApIHtcblx0XHRcdHBhcmVudC5hdHRhY2hFdmVudCggXCJvbnVubG9hZFwiLCB1bmxvYWRIYW5kbGVyICk7XG5cdFx0fVxuXHR9XG5cblx0LyogU3VwcG9ydCB0ZXN0c1xuXHQtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG5cdGRvY3VtZW50SXNIVE1MID0gIWlzWE1MKCBkb2MgKTtcblxuXHQvKiBBdHRyaWJ1dGVzXG5cdC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cblxuXHQvLyBTdXBwb3J0OiBJRTw4XG5cdC8vIFZlcmlmeSB0aGF0IGdldEF0dHJpYnV0ZSByZWFsbHkgcmV0dXJucyBhdHRyaWJ1dGVzIGFuZCBub3QgcHJvcGVydGllc1xuXHQvLyAoZXhjZXB0aW5nIElFOCBib29sZWFucylcblx0c3VwcG9ydC5hdHRyaWJ1dGVzID0gYXNzZXJ0KGZ1bmN0aW9uKCBkaXYgKSB7XG5cdFx0ZGl2LmNsYXNzTmFtZSA9IFwiaVwiO1xuXHRcdHJldHVybiAhZGl2LmdldEF0dHJpYnV0ZShcImNsYXNzTmFtZVwiKTtcblx0fSk7XG5cblx0LyogZ2V0RWxlbWVudChzKUJ5KlxuXHQtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG5cblx0Ly8gQ2hlY2sgaWYgZ2V0RWxlbWVudHNCeVRhZ05hbWUoXCIqXCIpIHJldHVybnMgb25seSBlbGVtZW50c1xuXHRzdXBwb3J0LmdldEVsZW1lbnRzQnlUYWdOYW1lID0gYXNzZXJ0KGZ1bmN0aW9uKCBkaXYgKSB7XG5cdFx0ZGl2LmFwcGVuZENoaWxkKCBkb2MuY3JlYXRlQ29tbWVudChcIlwiKSApO1xuXHRcdHJldHVybiAhZGl2LmdldEVsZW1lbnRzQnlUYWdOYW1lKFwiKlwiKS5sZW5ndGg7XG5cdH0pO1xuXG5cdC8vIFN1cHBvcnQ6IElFPDlcblx0c3VwcG9ydC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lID0gcm5hdGl2ZS50ZXN0KCBkb2MuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSApO1xuXG5cdC8vIFN1cHBvcnQ6IElFPDEwXG5cdC8vIENoZWNrIGlmIGdldEVsZW1lbnRCeUlkIHJldHVybnMgZWxlbWVudHMgYnkgbmFtZVxuXHQvLyBUaGUgYnJva2VuIGdldEVsZW1lbnRCeUlkIG1ldGhvZHMgZG9uJ3QgcGljayB1cCBwcm9ncmFtYXRpY2FsbHktc2V0IG5hbWVzLFxuXHQvLyBzbyB1c2UgYSByb3VuZGFib3V0IGdldEVsZW1lbnRzQnlOYW1lIHRlc3Rcblx0c3VwcG9ydC5nZXRCeUlkID0gYXNzZXJ0KGZ1bmN0aW9uKCBkaXYgKSB7XG5cdFx0ZG9jRWxlbS5hcHBlbmRDaGlsZCggZGl2ICkuaWQgPSBleHBhbmRvO1xuXHRcdHJldHVybiAhZG9jLmdldEVsZW1lbnRzQnlOYW1lIHx8ICFkb2MuZ2V0RWxlbWVudHNCeU5hbWUoIGV4cGFuZG8gKS5sZW5ndGg7XG5cdH0pO1xuXG5cdC8vIElEIGZpbmQgYW5kIGZpbHRlclxuXHRpZiAoIHN1cHBvcnQuZ2V0QnlJZCApIHtcblx0XHRFeHByLmZpbmRbXCJJRFwiXSA9IGZ1bmN0aW9uKCBpZCwgY29udGV4dCApIHtcblx0XHRcdGlmICggdHlwZW9mIGNvbnRleHQuZ2V0RWxlbWVudEJ5SWQgIT09IFwidW5kZWZpbmVkXCIgJiYgZG9jdW1lbnRJc0hUTUwgKSB7XG5cdFx0XHRcdHZhciBtID0gY29udGV4dC5nZXRFbGVtZW50QnlJZCggaWQgKTtcblx0XHRcdFx0Ly8gQ2hlY2sgcGFyZW50Tm9kZSB0byBjYXRjaCB3aGVuIEJsYWNrYmVycnkgNC42IHJldHVybnNcblx0XHRcdFx0Ly8gbm9kZXMgdGhhdCBhcmUgbm8gbG9uZ2VyIGluIHRoZSBkb2N1bWVudCAjNjk2M1xuXHRcdFx0XHRyZXR1cm4gbSAmJiBtLnBhcmVudE5vZGUgPyBbIG0gXSA6IFtdO1xuXHRcdFx0fVxuXHRcdH07XG5cdFx0RXhwci5maWx0ZXJbXCJJRFwiXSA9IGZ1bmN0aW9uKCBpZCApIHtcblx0XHRcdHZhciBhdHRySWQgPSBpZC5yZXBsYWNlKCBydW5lc2NhcGUsIGZ1bmVzY2FwZSApO1xuXHRcdFx0cmV0dXJuIGZ1bmN0aW9uKCBlbGVtICkge1xuXHRcdFx0XHRyZXR1cm4gZWxlbS5nZXRBdHRyaWJ1dGUoXCJpZFwiKSA9PT0gYXR0cklkO1xuXHRcdFx0fTtcblx0XHR9O1xuXHR9IGVsc2Uge1xuXHRcdC8vIFN1cHBvcnQ6IElFNi83XG5cdFx0Ly8gZ2V0RWxlbWVudEJ5SWQgaXMgbm90IHJlbGlhYmxlIGFzIGEgZmluZCBzaG9ydGN1dFxuXHRcdGRlbGV0ZSBFeHByLmZpbmRbXCJJRFwiXTtcblxuXHRcdEV4cHIuZmlsdGVyW1wiSURcIl0gPSAgZnVuY3Rpb24oIGlkICkge1xuXHRcdFx0dmFyIGF0dHJJZCA9IGlkLnJlcGxhY2UoIHJ1bmVzY2FwZSwgZnVuZXNjYXBlICk7XG5cdFx0XHRyZXR1cm4gZnVuY3Rpb24oIGVsZW0gKSB7XG5cdFx0XHRcdHZhciBub2RlID0gdHlwZW9mIGVsZW0uZ2V0QXR0cmlidXRlTm9kZSAhPT0gXCJ1bmRlZmluZWRcIiAmJiBlbGVtLmdldEF0dHJpYnV0ZU5vZGUoXCJpZFwiKTtcblx0XHRcdFx0cmV0dXJuIG5vZGUgJiYgbm9kZS52YWx1ZSA9PT0gYXR0cklkO1xuXHRcdFx0fTtcblx0XHR9O1xuXHR9XG5cblx0Ly8gVGFnXG5cdEV4cHIuZmluZFtcIlRBR1wiXSA9IHN1cHBvcnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUgP1xuXHRcdGZ1bmN0aW9uKCB0YWcsIGNvbnRleHQgKSB7XG5cdFx0XHRpZiAoIHR5cGVvZiBjb250ZXh0LmdldEVsZW1lbnRzQnlUYWdOYW1lICE9PSBcInVuZGVmaW5lZFwiICkge1xuXHRcdFx0XHRyZXR1cm4gY29udGV4dC5nZXRFbGVtZW50c0J5VGFnTmFtZSggdGFnICk7XG5cblx0XHRcdC8vIERvY3VtZW50RnJhZ21lbnQgbm9kZXMgZG9uJ3QgaGF2ZSBnRUJUTlxuXHRcdFx0fSBlbHNlIGlmICggc3VwcG9ydC5xc2EgKSB7XG5cdFx0XHRcdHJldHVybiBjb250ZXh0LnF1ZXJ5U2VsZWN0b3JBbGwoIHRhZyApO1xuXHRcdFx0fVxuXHRcdH0gOlxuXG5cdFx0ZnVuY3Rpb24oIHRhZywgY29udGV4dCApIHtcblx0XHRcdHZhciBlbGVtLFxuXHRcdFx0XHR0bXAgPSBbXSxcblx0XHRcdFx0aSA9IDAsXG5cdFx0XHRcdC8vIEJ5IGhhcHB5IGNvaW5jaWRlbmNlLCBhIChicm9rZW4pIGdFQlROIGFwcGVhcnMgb24gRG9jdW1lbnRGcmFnbWVudCBub2RlcyB0b29cblx0XHRcdFx0cmVzdWx0cyA9IGNvbnRleHQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoIHRhZyApO1xuXG5cdFx0XHQvLyBGaWx0ZXIgb3V0IHBvc3NpYmxlIGNvbW1lbnRzXG5cdFx0XHRpZiAoIHRhZyA9PT0gXCIqXCIgKSB7XG5cdFx0XHRcdHdoaWxlICggKGVsZW0gPSByZXN1bHRzW2krK10pICkge1xuXHRcdFx0XHRcdGlmICggZWxlbS5ub2RlVHlwZSA9PT0gMSApIHtcblx0XHRcdFx0XHRcdHRtcC5wdXNoKCBlbGVtICk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cblx0XHRcdFx0cmV0dXJuIHRtcDtcblx0XHRcdH1cblx0XHRcdHJldHVybiByZXN1bHRzO1xuXHRcdH07XG5cblx0Ly8gQ2xhc3Ncblx0RXhwci5maW5kW1wiQ0xBU1NcIl0gPSBzdXBwb3J0LmdldEVsZW1lbnRzQnlDbGFzc05hbWUgJiYgZnVuY3Rpb24oIGNsYXNzTmFtZSwgY29udGV4dCApIHtcblx0XHRpZiAoIGRvY3VtZW50SXNIVE1MICkge1xuXHRcdFx0cmV0dXJuIGNvbnRleHQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSggY2xhc3NOYW1lICk7XG5cdFx0fVxuXHR9O1xuXG5cdC8qIFFTQS9tYXRjaGVzU2VsZWN0b3Jcblx0LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuXG5cdC8vIFFTQSBhbmQgbWF0Y2hlc1NlbGVjdG9yIHN1cHBvcnRcblxuXHQvLyBtYXRjaGVzU2VsZWN0b3IoOmFjdGl2ZSkgcmVwb3J0cyBmYWxzZSB3aGVuIHRydWUgKElFOS9PcGVyYSAxMS41KVxuXHRyYnVnZ3lNYXRjaGVzID0gW107XG5cblx0Ly8gcVNhKDpmb2N1cykgcmVwb3J0cyBmYWxzZSB3aGVuIHRydWUgKENocm9tZSAyMSlcblx0Ly8gV2UgYWxsb3cgdGhpcyBiZWNhdXNlIG9mIGEgYnVnIGluIElFOC85IHRoYXQgdGhyb3dzIGFuIGVycm9yXG5cdC8vIHdoZW5ldmVyIGBkb2N1bWVudC5hY3RpdmVFbGVtZW50YCBpcyBhY2Nlc3NlZCBvbiBhbiBpZnJhbWVcblx0Ly8gU28sIHdlIGFsbG93IDpmb2N1cyB0byBwYXNzIHRocm91Z2ggUVNBIGFsbCB0aGUgdGltZSB0byBhdm9pZCB0aGUgSUUgZXJyb3Jcblx0Ly8gU2VlIGh0dHA6Ly9idWdzLmpxdWVyeS5jb20vdGlja2V0LzEzMzc4XG5cdHJidWdneVFTQSA9IFtdO1xuXG5cdGlmICggKHN1cHBvcnQucXNhID0gcm5hdGl2ZS50ZXN0KCBkb2MucXVlcnlTZWxlY3RvckFsbCApKSApIHtcblx0XHQvLyBCdWlsZCBRU0EgcmVnZXhcblx0XHQvLyBSZWdleCBzdHJhdGVneSBhZG9wdGVkIGZyb20gRGllZ28gUGVyaW5pXG5cdFx0YXNzZXJ0KGZ1bmN0aW9uKCBkaXYgKSB7XG5cdFx0XHQvLyBTZWxlY3QgaXMgc2V0IHRvIGVtcHR5IHN0cmluZyBvbiBwdXJwb3NlXG5cdFx0XHQvLyBUaGlzIGlzIHRvIHRlc3QgSUUncyB0cmVhdG1lbnQgb2Ygbm90IGV4cGxpY2l0bHlcblx0XHRcdC8vIHNldHRpbmcgYSBib29sZWFuIGNvbnRlbnQgYXR0cmlidXRlLFxuXHRcdFx0Ly8gc2luY2UgaXRzIHByZXNlbmNlIHNob3VsZCBiZSBlbm91Z2hcblx0XHRcdC8vIGh0dHA6Ly9idWdzLmpxdWVyeS5jb20vdGlja2V0LzEyMzU5XG5cdFx0XHRkb2NFbGVtLmFwcGVuZENoaWxkKCBkaXYgKS5pbm5lckhUTUwgPSBcIjxhIGlkPSdcIiArIGV4cGFuZG8gKyBcIic+PC9hPlwiICtcblx0XHRcdFx0XCI8c2VsZWN0IGlkPSdcIiArIGV4cGFuZG8gKyBcIi1cXGZdJyBtc2FsbG93Y2FwdHVyZT0nJz5cIiArXG5cdFx0XHRcdFwiPG9wdGlvbiBzZWxlY3RlZD0nJz48L29wdGlvbj48L3NlbGVjdD5cIjtcblxuXHRcdFx0Ly8gU3VwcG9ydDogSUU4LCBPcGVyYSAxMS0xMi4xNlxuXHRcdFx0Ly8gTm90aGluZyBzaG91bGQgYmUgc2VsZWN0ZWQgd2hlbiBlbXB0eSBzdHJpbmdzIGZvbGxvdyBePSBvciAkPSBvciAqPVxuXHRcdFx0Ly8gVGhlIHRlc3QgYXR0cmlidXRlIG11c3QgYmUgdW5rbm93biBpbiBPcGVyYSBidXQgXCJzYWZlXCIgZm9yIFdpblJUXG5cdFx0XHQvLyBodHRwOi8vbXNkbi5taWNyb3NvZnQuY29tL2VuLXVzL2xpYnJhcnkvaWUvaGg0NjUzODguYXNweCNhdHRyaWJ1dGVfc2VjdGlvblxuXHRcdFx0aWYgKCBkaXYucXVlcnlTZWxlY3RvckFsbChcIlttc2FsbG93Y2FwdHVyZV49JyddXCIpLmxlbmd0aCApIHtcblx0XHRcdFx0cmJ1Z2d5UVNBLnB1c2goIFwiWypeJF09XCIgKyB3aGl0ZXNwYWNlICsgXCIqKD86Jyd8XFxcIlxcXCIpXCIgKTtcblx0XHRcdH1cblxuXHRcdFx0Ly8gU3VwcG9ydDogSUU4XG5cdFx0XHQvLyBCb29sZWFuIGF0dHJpYnV0ZXMgYW5kIFwidmFsdWVcIiBhcmUgbm90IHRyZWF0ZWQgY29ycmVjdGx5XG5cdFx0XHRpZiAoICFkaXYucXVlcnlTZWxlY3RvckFsbChcIltzZWxlY3RlZF1cIikubGVuZ3RoICkge1xuXHRcdFx0XHRyYnVnZ3lRU0EucHVzaCggXCJcXFxcW1wiICsgd2hpdGVzcGFjZSArIFwiKig/OnZhbHVlfFwiICsgYm9vbGVhbnMgKyBcIilcIiApO1xuXHRcdFx0fVxuXG5cdFx0XHQvLyBTdXBwb3J0OiBDaHJvbWU8MjksIEFuZHJvaWQ8NC4yKywgU2FmYXJpPDcuMCssIGlPUzw3LjArLCBQaGFudG9tSlM8MS45LjcrXG5cdFx0XHRpZiAoICFkaXYucXVlcnlTZWxlY3RvckFsbCggXCJbaWR+PVwiICsgZXhwYW5kbyArIFwiLV1cIiApLmxlbmd0aCApIHtcblx0XHRcdFx0cmJ1Z2d5UVNBLnB1c2goXCJ+PVwiKTtcblx0XHRcdH1cblxuXHRcdFx0Ly8gV2Via2l0L09wZXJhIC0gOmNoZWNrZWQgc2hvdWxkIHJldHVybiBzZWxlY3RlZCBvcHRpb24gZWxlbWVudHNcblx0XHRcdC8vIGh0dHA6Ly93d3cudzMub3JnL1RSLzIwMTEvUkVDLWNzczMtc2VsZWN0b3JzLTIwMTEwOTI5LyNjaGVja2VkXG5cdFx0XHQvLyBJRTggdGhyb3dzIGVycm9yIGhlcmUgYW5kIHdpbGwgbm90IHNlZSBsYXRlciB0ZXN0c1xuXHRcdFx0aWYgKCAhZGl2LnF1ZXJ5U2VsZWN0b3JBbGwoXCI6Y2hlY2tlZFwiKS5sZW5ndGggKSB7XG5cdFx0XHRcdHJidWdneVFTQS5wdXNoKFwiOmNoZWNrZWRcIik7XG5cdFx0XHR9XG5cblx0XHRcdC8vIFN1cHBvcnQ6IFNhZmFyaSA4KywgaU9TIDgrXG5cdFx0XHQvLyBodHRwczovL2J1Z3Mud2Via2l0Lm9yZy9zaG93X2J1Zy5jZ2k/aWQ9MTM2ODUxXG5cdFx0XHQvLyBJbi1wYWdlIGBzZWxlY3RvciNpZCBzaWJpbmctY29tYmluYXRvciBzZWxlY3RvcmAgZmFpbHNcblx0XHRcdGlmICggIWRpdi5xdWVyeVNlbGVjdG9yQWxsKCBcImEjXCIgKyBleHBhbmRvICsgXCIrKlwiICkubGVuZ3RoICkge1xuXHRcdFx0XHRyYnVnZ3lRU0EucHVzaChcIi4jLitbK35dXCIpO1xuXHRcdFx0fVxuXHRcdH0pO1xuXG5cdFx0YXNzZXJ0KGZ1bmN0aW9uKCBkaXYgKSB7XG5cdFx0XHQvLyBTdXBwb3J0OiBXaW5kb3dzIDggTmF0aXZlIEFwcHNcblx0XHRcdC8vIFRoZSB0eXBlIGFuZCBuYW1lIGF0dHJpYnV0ZXMgYXJlIHJlc3RyaWN0ZWQgZHVyaW5nIC5pbm5lckhUTUwgYXNzaWdubWVudFxuXHRcdFx0dmFyIGlucHV0ID0gZG9jLmNyZWF0ZUVsZW1lbnQoXCJpbnB1dFwiKTtcblx0XHRcdGlucHV0LnNldEF0dHJpYnV0ZSggXCJ0eXBlXCIsIFwiaGlkZGVuXCIgKTtcblx0XHRcdGRpdi5hcHBlbmRDaGlsZCggaW5wdXQgKS5zZXRBdHRyaWJ1dGUoIFwibmFtZVwiLCBcIkRcIiApO1xuXG5cdFx0XHQvLyBTdXBwb3J0OiBJRThcblx0XHRcdC8vIEVuZm9yY2UgY2FzZS1zZW5zaXRpdml0eSBvZiBuYW1lIGF0dHJpYnV0ZVxuXHRcdFx0aWYgKCBkaXYucXVlcnlTZWxlY3RvckFsbChcIltuYW1lPWRdXCIpLmxlbmd0aCApIHtcblx0XHRcdFx0cmJ1Z2d5UVNBLnB1c2goIFwibmFtZVwiICsgd2hpdGVzcGFjZSArIFwiKlsqXiR8IX5dPz1cIiApO1xuXHRcdFx0fVxuXG5cdFx0XHQvLyBGRiAzLjUgLSA6ZW5hYmxlZC86ZGlzYWJsZWQgYW5kIGhpZGRlbiBlbGVtZW50cyAoaGlkZGVuIGVsZW1lbnRzIGFyZSBzdGlsbCBlbmFibGVkKVxuXHRcdFx0Ly8gSUU4IHRocm93cyBlcnJvciBoZXJlIGFuZCB3aWxsIG5vdCBzZWUgbGF0ZXIgdGVzdHNcblx0XHRcdGlmICggIWRpdi5xdWVyeVNlbGVjdG9yQWxsKFwiOmVuYWJsZWRcIikubGVuZ3RoICkge1xuXHRcdFx0XHRyYnVnZ3lRU0EucHVzaCggXCI6ZW5hYmxlZFwiLCBcIjpkaXNhYmxlZFwiICk7XG5cdFx0XHR9XG5cblx0XHRcdC8vIE9wZXJhIDEwLTExIGRvZXMgbm90IHRocm93IG9uIHBvc3QtY29tbWEgaW52YWxpZCBwc2V1ZG9zXG5cdFx0XHRkaXYucXVlcnlTZWxlY3RvckFsbChcIiosOnhcIik7XG5cdFx0XHRyYnVnZ3lRU0EucHVzaChcIiwuKjpcIik7XG5cdFx0fSk7XG5cdH1cblxuXHRpZiAoIChzdXBwb3J0Lm1hdGNoZXNTZWxlY3RvciA9IHJuYXRpdmUudGVzdCggKG1hdGNoZXMgPSBkb2NFbGVtLm1hdGNoZXMgfHxcblx0XHRkb2NFbGVtLndlYmtpdE1hdGNoZXNTZWxlY3RvciB8fFxuXHRcdGRvY0VsZW0ubW96TWF0Y2hlc1NlbGVjdG9yIHx8XG5cdFx0ZG9jRWxlbS5vTWF0Y2hlc1NlbGVjdG9yIHx8XG5cdFx0ZG9jRWxlbS5tc01hdGNoZXNTZWxlY3RvcikgKSkgKSB7XG5cblx0XHRhc3NlcnQoZnVuY3Rpb24oIGRpdiApIHtcblx0XHRcdC8vIENoZWNrIHRvIHNlZSBpZiBpdCdzIHBvc3NpYmxlIHRvIGRvIG1hdGNoZXNTZWxlY3RvclxuXHRcdFx0Ly8gb24gYSBkaXNjb25uZWN0ZWQgbm9kZSAoSUUgOSlcblx0XHRcdHN1cHBvcnQuZGlzY29ubmVjdGVkTWF0Y2ggPSBtYXRjaGVzLmNhbGwoIGRpdiwgXCJkaXZcIiApO1xuXG5cdFx0XHQvLyBUaGlzIHNob3VsZCBmYWlsIHdpdGggYW4gZXhjZXB0aW9uXG5cdFx0XHQvLyBHZWNrbyBkb2VzIG5vdCBlcnJvciwgcmV0dXJucyBmYWxzZSBpbnN0ZWFkXG5cdFx0XHRtYXRjaGVzLmNhbGwoIGRpdiwgXCJbcyE9JyddOnhcIiApO1xuXHRcdFx0cmJ1Z2d5TWF0Y2hlcy5wdXNoKCBcIiE9XCIsIHBzZXVkb3MgKTtcblx0XHR9KTtcblx0fVxuXG5cdHJidWdneVFTQSA9IHJidWdneVFTQS5sZW5ndGggJiYgbmV3IFJlZ0V4cCggcmJ1Z2d5UVNBLmpvaW4oXCJ8XCIpICk7XG5cdHJidWdneU1hdGNoZXMgPSByYnVnZ3lNYXRjaGVzLmxlbmd0aCAmJiBuZXcgUmVnRXhwKCByYnVnZ3lNYXRjaGVzLmpvaW4oXCJ8XCIpICk7XG5cblx0LyogQ29udGFpbnNcblx0LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuXHRoYXNDb21wYXJlID0gcm5hdGl2ZS50ZXN0KCBkb2NFbGVtLmNvbXBhcmVEb2N1bWVudFBvc2l0aW9uICk7XG5cblx0Ly8gRWxlbWVudCBjb250YWlucyBhbm90aGVyXG5cdC8vIFB1cnBvc2VmdWxseSBkb2VzIG5vdCBpbXBsZW1lbnQgaW5jbHVzaXZlIGRlc2NlbmRlbnRcblx0Ly8gQXMgaW4sIGFuIGVsZW1lbnQgZG9lcyBub3QgY29udGFpbiBpdHNlbGZcblx0Y29udGFpbnMgPSBoYXNDb21wYXJlIHx8IHJuYXRpdmUudGVzdCggZG9jRWxlbS5jb250YWlucyApID9cblx0XHRmdW5jdGlvbiggYSwgYiApIHtcblx0XHRcdHZhciBhZG93biA9IGEubm9kZVR5cGUgPT09IDkgPyBhLmRvY3VtZW50RWxlbWVudCA6IGEsXG5cdFx0XHRcdGJ1cCA9IGIgJiYgYi5wYXJlbnROb2RlO1xuXHRcdFx0cmV0dXJuIGEgPT09IGJ1cCB8fCAhISggYnVwICYmIGJ1cC5ub2RlVHlwZSA9PT0gMSAmJiAoXG5cdFx0XHRcdGFkb3duLmNvbnRhaW5zID9cblx0XHRcdFx0XHRhZG93bi5jb250YWlucyggYnVwICkgOlxuXHRcdFx0XHRcdGEuY29tcGFyZURvY3VtZW50UG9zaXRpb24gJiYgYS5jb21wYXJlRG9jdW1lbnRQb3NpdGlvbiggYnVwICkgJiAxNlxuXHRcdFx0KSk7XG5cdFx0fSA6XG5cdFx0ZnVuY3Rpb24oIGEsIGIgKSB7XG5cdFx0XHRpZiAoIGIgKSB7XG5cdFx0XHRcdHdoaWxlICggKGIgPSBiLnBhcmVudE5vZGUpICkge1xuXHRcdFx0XHRcdGlmICggYiA9PT0gYSApIHtcblx0XHRcdFx0XHRcdHJldHVybiB0cnVlO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdFx0cmV0dXJuIGZhbHNlO1xuXHRcdH07XG5cblx0LyogU29ydGluZ1xuXHQtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG5cblx0Ly8gRG9jdW1lbnQgb3JkZXIgc29ydGluZ1xuXHRzb3J0T3JkZXIgPSBoYXNDb21wYXJlID9cblx0ZnVuY3Rpb24oIGEsIGIgKSB7XG5cblx0XHQvLyBGbGFnIGZvciBkdXBsaWNhdGUgcmVtb3ZhbFxuXHRcdGlmICggYSA9PT0gYiApIHtcblx0XHRcdGhhc0R1cGxpY2F0ZSA9IHRydWU7XG5cdFx0XHRyZXR1cm4gMDtcblx0XHR9XG5cblx0XHQvLyBTb3J0IG9uIG1ldGhvZCBleGlzdGVuY2UgaWYgb25seSBvbmUgaW5wdXQgaGFzIGNvbXBhcmVEb2N1bWVudFBvc2l0aW9uXG5cdFx0dmFyIGNvbXBhcmUgPSAhYS5jb21wYXJlRG9jdW1lbnRQb3NpdGlvbiAtICFiLmNvbXBhcmVEb2N1bWVudFBvc2l0aW9uO1xuXHRcdGlmICggY29tcGFyZSApIHtcblx0XHRcdHJldHVybiBjb21wYXJlO1xuXHRcdH1cblxuXHRcdC8vIENhbGN1bGF0ZSBwb3NpdGlvbiBpZiBib3RoIGlucHV0cyBiZWxvbmcgdG8gdGhlIHNhbWUgZG9jdW1lbnRcblx0XHRjb21wYXJlID0gKCBhLm93bmVyRG9jdW1lbnQgfHwgYSApID09PSAoIGIub3duZXJEb2N1bWVudCB8fCBiICkgP1xuXHRcdFx0YS5jb21wYXJlRG9jdW1lbnRQb3NpdGlvbiggYiApIDpcblxuXHRcdFx0Ly8gT3RoZXJ3aXNlIHdlIGtub3cgdGhleSBhcmUgZGlzY29ubmVjdGVkXG5cdFx0XHQxO1xuXG5cdFx0Ly8gRGlzY29ubmVjdGVkIG5vZGVzXG5cdFx0aWYgKCBjb21wYXJlICYgMSB8fFxuXHRcdFx0KCFzdXBwb3J0LnNvcnREZXRhY2hlZCAmJiBiLmNvbXBhcmVEb2N1bWVudFBvc2l0aW9uKCBhICkgPT09IGNvbXBhcmUpICkge1xuXG5cdFx0XHQvLyBDaG9vc2UgdGhlIGZpcnN0IGVsZW1lbnQgdGhhdCBpcyByZWxhdGVkIHRvIG91ciBwcmVmZXJyZWQgZG9jdW1lbnRcblx0XHRcdGlmICggYSA9PT0gZG9jIHx8IGEub3duZXJEb2N1bWVudCA9PT0gcHJlZmVycmVkRG9jICYmIGNvbnRhaW5zKHByZWZlcnJlZERvYywgYSkgKSB7XG5cdFx0XHRcdHJldHVybiAtMTtcblx0XHRcdH1cblx0XHRcdGlmICggYiA9PT0gZG9jIHx8IGIub3duZXJEb2N1bWVudCA9PT0gcHJlZmVycmVkRG9jICYmIGNvbnRhaW5zKHByZWZlcnJlZERvYywgYikgKSB7XG5cdFx0XHRcdHJldHVybiAxO1xuXHRcdFx0fVxuXG5cdFx0XHQvLyBNYWludGFpbiBvcmlnaW5hbCBvcmRlclxuXHRcdFx0cmV0dXJuIHNvcnRJbnB1dCA/XG5cdFx0XHRcdCggaW5kZXhPZiggc29ydElucHV0LCBhICkgLSBpbmRleE9mKCBzb3J0SW5wdXQsIGIgKSApIDpcblx0XHRcdFx0MDtcblx0XHR9XG5cblx0XHRyZXR1cm4gY29tcGFyZSAmIDQgPyAtMSA6IDE7XG5cdH0gOlxuXHRmdW5jdGlvbiggYSwgYiApIHtcblx0XHQvLyBFeGl0IGVhcmx5IGlmIHRoZSBub2RlcyBhcmUgaWRlbnRpY2FsXG5cdFx0aWYgKCBhID09PSBiICkge1xuXHRcdFx0aGFzRHVwbGljYXRlID0gdHJ1ZTtcblx0XHRcdHJldHVybiAwO1xuXHRcdH1cblxuXHRcdHZhciBjdXIsXG5cdFx0XHRpID0gMCxcblx0XHRcdGF1cCA9IGEucGFyZW50Tm9kZSxcblx0XHRcdGJ1cCA9IGIucGFyZW50Tm9kZSxcblx0XHRcdGFwID0gWyBhIF0sXG5cdFx0XHRicCA9IFsgYiBdO1xuXG5cdFx0Ly8gUGFyZW50bGVzcyBub2RlcyBhcmUgZWl0aGVyIGRvY3VtZW50cyBvciBkaXNjb25uZWN0ZWRcblx0XHRpZiAoICFhdXAgfHwgIWJ1cCApIHtcblx0XHRcdHJldHVybiBhID09PSBkb2MgPyAtMSA6XG5cdFx0XHRcdGIgPT09IGRvYyA/IDEgOlxuXHRcdFx0XHRhdXAgPyAtMSA6XG5cdFx0XHRcdGJ1cCA/IDEgOlxuXHRcdFx0XHRzb3J0SW5wdXQgP1xuXHRcdFx0XHQoIGluZGV4T2YoIHNvcnRJbnB1dCwgYSApIC0gaW5kZXhPZiggc29ydElucHV0LCBiICkgKSA6XG5cdFx0XHRcdDA7XG5cblx0XHQvLyBJZiB0aGUgbm9kZXMgYXJlIHNpYmxpbmdzLCB3ZSBjYW4gZG8gYSBxdWljayBjaGVja1xuXHRcdH0gZWxzZSBpZiAoIGF1cCA9PT0gYnVwICkge1xuXHRcdFx0cmV0dXJuIHNpYmxpbmdDaGVjayggYSwgYiApO1xuXHRcdH1cblxuXHRcdC8vIE90aGVyd2lzZSB3ZSBuZWVkIGZ1bGwgbGlzdHMgb2YgdGhlaXIgYW5jZXN0b3JzIGZvciBjb21wYXJpc29uXG5cdFx0Y3VyID0gYTtcblx0XHR3aGlsZSAoIChjdXIgPSBjdXIucGFyZW50Tm9kZSkgKSB7XG5cdFx0XHRhcC51bnNoaWZ0KCBjdXIgKTtcblx0XHR9XG5cdFx0Y3VyID0gYjtcblx0XHR3aGlsZSAoIChjdXIgPSBjdXIucGFyZW50Tm9kZSkgKSB7XG5cdFx0XHRicC51bnNoaWZ0KCBjdXIgKTtcblx0XHR9XG5cblx0XHQvLyBXYWxrIGRvd24gdGhlIHRyZWUgbG9va2luZyBmb3IgYSBkaXNjcmVwYW5jeVxuXHRcdHdoaWxlICggYXBbaV0gPT09IGJwW2ldICkge1xuXHRcdFx0aSsrO1xuXHRcdH1cblxuXHRcdHJldHVybiBpID9cblx0XHRcdC8vIERvIGEgc2libGluZyBjaGVjayBpZiB0aGUgbm9kZXMgaGF2ZSBhIGNvbW1vbiBhbmNlc3RvclxuXHRcdFx0c2libGluZ0NoZWNrKCBhcFtpXSwgYnBbaV0gKSA6XG5cblx0XHRcdC8vIE90aGVyd2lzZSBub2RlcyBpbiBvdXIgZG9jdW1lbnQgc29ydCBmaXJzdFxuXHRcdFx0YXBbaV0gPT09IHByZWZlcnJlZERvYyA/IC0xIDpcblx0XHRcdGJwW2ldID09PSBwcmVmZXJyZWREb2MgPyAxIDpcblx0XHRcdDA7XG5cdH07XG5cblx0cmV0dXJuIGRvYztcbn07XG5cblNpenpsZS5tYXRjaGVzID0gZnVuY3Rpb24oIGV4cHIsIGVsZW1lbnRzICkge1xuXHRyZXR1cm4gU2l6emxlKCBleHByLCBudWxsLCBudWxsLCBlbGVtZW50cyApO1xufTtcblxuU2l6emxlLm1hdGNoZXNTZWxlY3RvciA9IGZ1bmN0aW9uKCBlbGVtLCBleHByICkge1xuXHQvLyBTZXQgZG9jdW1lbnQgdmFycyBpZiBuZWVkZWRcblx0aWYgKCAoIGVsZW0ub3duZXJEb2N1bWVudCB8fCBlbGVtICkgIT09IGRvY3VtZW50ICkge1xuXHRcdHNldERvY3VtZW50KCBlbGVtICk7XG5cdH1cblxuXHQvLyBNYWtlIHN1cmUgdGhhdCBhdHRyaWJ1dGUgc2VsZWN0b3JzIGFyZSBxdW90ZWRcblx0ZXhwciA9IGV4cHIucmVwbGFjZSggcmF0dHJpYnV0ZVF1b3RlcywgXCI9JyQxJ11cIiApO1xuXG5cdGlmICggc3VwcG9ydC5tYXRjaGVzU2VsZWN0b3IgJiYgZG9jdW1lbnRJc0hUTUwgJiZcblx0XHQoICFyYnVnZ3lNYXRjaGVzIHx8ICFyYnVnZ3lNYXRjaGVzLnRlc3QoIGV4cHIgKSApICYmXG5cdFx0KCAhcmJ1Z2d5UVNBICAgICB8fCAhcmJ1Z2d5UVNBLnRlc3QoIGV4cHIgKSApICkge1xuXG5cdFx0dHJ5IHtcblx0XHRcdHZhciByZXQgPSBtYXRjaGVzLmNhbGwoIGVsZW0sIGV4cHIgKTtcblxuXHRcdFx0Ly8gSUUgOSdzIG1hdGNoZXNTZWxlY3RvciByZXR1cm5zIGZhbHNlIG9uIGRpc2Nvbm5lY3RlZCBub2Rlc1xuXHRcdFx0aWYgKCByZXQgfHwgc3VwcG9ydC5kaXNjb25uZWN0ZWRNYXRjaCB8fFxuXHRcdFx0XHRcdC8vIEFzIHdlbGwsIGRpc2Nvbm5lY3RlZCBub2RlcyBhcmUgc2FpZCB0byBiZSBpbiBhIGRvY3VtZW50XG5cdFx0XHRcdFx0Ly8gZnJhZ21lbnQgaW4gSUUgOVxuXHRcdFx0XHRcdGVsZW0uZG9jdW1lbnQgJiYgZWxlbS5kb2N1bWVudC5ub2RlVHlwZSAhPT0gMTEgKSB7XG5cdFx0XHRcdHJldHVybiByZXQ7XG5cdFx0XHR9XG5cdFx0fSBjYXRjaCAoZSkge31cblx0fVxuXG5cdHJldHVybiBTaXp6bGUoIGV4cHIsIGRvY3VtZW50LCBudWxsLCBbIGVsZW0gXSApLmxlbmd0aCA+IDA7XG59O1xuXG5TaXp6bGUuY29udGFpbnMgPSBmdW5jdGlvbiggY29udGV4dCwgZWxlbSApIHtcblx0Ly8gU2V0IGRvY3VtZW50IHZhcnMgaWYgbmVlZGVkXG5cdGlmICggKCBjb250ZXh0Lm93bmVyRG9jdW1lbnQgfHwgY29udGV4dCApICE9PSBkb2N1bWVudCApIHtcblx0XHRzZXREb2N1bWVudCggY29udGV4dCApO1xuXHR9XG5cdHJldHVybiBjb250YWlucyggY29udGV4dCwgZWxlbSApO1xufTtcblxuU2l6emxlLmF0dHIgPSBmdW5jdGlvbiggZWxlbSwgbmFtZSApIHtcblx0Ly8gU2V0IGRvY3VtZW50IHZhcnMgaWYgbmVlZGVkXG5cdGlmICggKCBlbGVtLm93bmVyRG9jdW1lbnQgfHwgZWxlbSApICE9PSBkb2N1bWVudCApIHtcblx0XHRzZXREb2N1bWVudCggZWxlbSApO1xuXHR9XG5cblx0dmFyIGZuID0gRXhwci5hdHRySGFuZGxlWyBuYW1lLnRvTG93ZXJDYXNlKCkgXSxcblx0XHQvLyBEb24ndCBnZXQgZm9vbGVkIGJ5IE9iamVjdC5wcm90b3R5cGUgcHJvcGVydGllcyAoalF1ZXJ5ICMxMzgwNylcblx0XHR2YWwgPSBmbiAmJiBoYXNPd24uY2FsbCggRXhwci5hdHRySGFuZGxlLCBuYW1lLnRvTG93ZXJDYXNlKCkgKSA/XG5cdFx0XHRmbiggZWxlbSwgbmFtZSwgIWRvY3VtZW50SXNIVE1MICkgOlxuXHRcdFx0dW5kZWZpbmVkO1xuXG5cdHJldHVybiB2YWwgIT09IHVuZGVmaW5lZCA/XG5cdFx0dmFsIDpcblx0XHRzdXBwb3J0LmF0dHJpYnV0ZXMgfHwgIWRvY3VtZW50SXNIVE1MID9cblx0XHRcdGVsZW0uZ2V0QXR0cmlidXRlKCBuYW1lICkgOlxuXHRcdFx0KHZhbCA9IGVsZW0uZ2V0QXR0cmlidXRlTm9kZShuYW1lKSkgJiYgdmFsLnNwZWNpZmllZCA/XG5cdFx0XHRcdHZhbC52YWx1ZSA6XG5cdFx0XHRcdG51bGw7XG59O1xuXG5TaXp6bGUuZXJyb3IgPSBmdW5jdGlvbiggbXNnICkge1xuXHR0aHJvdyBuZXcgRXJyb3IoIFwiU3ludGF4IGVycm9yLCB1bnJlY29nbml6ZWQgZXhwcmVzc2lvbjogXCIgKyBtc2cgKTtcbn07XG5cbi8qKlxuICogRG9jdW1lbnQgc29ydGluZyBhbmQgcmVtb3ZpbmcgZHVwbGljYXRlc1xuICogQHBhcmFtIHtBcnJheUxpa2V9IHJlc3VsdHNcbiAqL1xuU2l6emxlLnVuaXF1ZVNvcnQgPSBmdW5jdGlvbiggcmVzdWx0cyApIHtcblx0dmFyIGVsZW0sXG5cdFx0ZHVwbGljYXRlcyA9IFtdLFxuXHRcdGogPSAwLFxuXHRcdGkgPSAwO1xuXG5cdC8vIFVubGVzcyB3ZSAqa25vdyogd2UgY2FuIGRldGVjdCBkdXBsaWNhdGVzLCBhc3N1bWUgdGhlaXIgcHJlc2VuY2Vcblx0aGFzRHVwbGljYXRlID0gIXN1cHBvcnQuZGV0ZWN0RHVwbGljYXRlcztcblx0c29ydElucHV0ID0gIXN1cHBvcnQuc29ydFN0YWJsZSAmJiByZXN1bHRzLnNsaWNlKCAwICk7XG5cdHJlc3VsdHMuc29ydCggc29ydE9yZGVyICk7XG5cblx0aWYgKCBoYXNEdXBsaWNhdGUgKSB7XG5cdFx0d2hpbGUgKCAoZWxlbSA9IHJlc3VsdHNbaSsrXSkgKSB7XG5cdFx0XHRpZiAoIGVsZW0gPT09IHJlc3VsdHNbIGkgXSApIHtcblx0XHRcdFx0aiA9IGR1cGxpY2F0ZXMucHVzaCggaSApO1xuXHRcdFx0fVxuXHRcdH1cblx0XHR3aGlsZSAoIGotLSApIHtcblx0XHRcdHJlc3VsdHMuc3BsaWNlKCBkdXBsaWNhdGVzWyBqIF0sIDEgKTtcblx0XHR9XG5cdH1cblxuXHQvLyBDbGVhciBpbnB1dCBhZnRlciBzb3J0aW5nIHRvIHJlbGVhc2Ugb2JqZWN0c1xuXHQvLyBTZWUgaHR0cHM6Ly9naXRodWIuY29tL2pxdWVyeS9zaXp6bGUvcHVsbC8yMjVcblx0c29ydElucHV0ID0gbnVsbDtcblxuXHRyZXR1cm4gcmVzdWx0cztcbn07XG5cbi8qKlxuICogVXRpbGl0eSBmdW5jdGlvbiBmb3IgcmV0cmlldmluZyB0aGUgdGV4dCB2YWx1ZSBvZiBhbiBhcnJheSBvZiBET00gbm9kZXNcbiAqIEBwYXJhbSB7QXJyYXl8RWxlbWVudH0gZWxlbVxuICovXG5nZXRUZXh0ID0gU2l6emxlLmdldFRleHQgPSBmdW5jdGlvbiggZWxlbSApIHtcblx0dmFyIG5vZGUsXG5cdFx0cmV0ID0gXCJcIixcblx0XHRpID0gMCxcblx0XHRub2RlVHlwZSA9IGVsZW0ubm9kZVR5cGU7XG5cblx0aWYgKCAhbm9kZVR5cGUgKSB7XG5cdFx0Ly8gSWYgbm8gbm9kZVR5cGUsIHRoaXMgaXMgZXhwZWN0ZWQgdG8gYmUgYW4gYXJyYXlcblx0XHR3aGlsZSAoIChub2RlID0gZWxlbVtpKytdKSApIHtcblx0XHRcdC8vIERvIG5vdCB0cmF2ZXJzZSBjb21tZW50IG5vZGVzXG5cdFx0XHRyZXQgKz0gZ2V0VGV4dCggbm9kZSApO1xuXHRcdH1cblx0fSBlbHNlIGlmICggbm9kZVR5cGUgPT09IDEgfHwgbm9kZVR5cGUgPT09IDkgfHwgbm9kZVR5cGUgPT09IDExICkge1xuXHRcdC8vIFVzZSB0ZXh0Q29udGVudCBmb3IgZWxlbWVudHNcblx0XHQvLyBpbm5lclRleHQgdXNhZ2UgcmVtb3ZlZCBmb3IgY29uc2lzdGVuY3kgb2YgbmV3IGxpbmVzIChqUXVlcnkgIzExMTUzKVxuXHRcdGlmICggdHlwZW9mIGVsZW0udGV4dENvbnRlbnQgPT09IFwic3RyaW5nXCIgKSB7XG5cdFx0XHRyZXR1cm4gZWxlbS50ZXh0Q29udGVudDtcblx0XHR9IGVsc2Uge1xuXHRcdFx0Ly8gVHJhdmVyc2UgaXRzIGNoaWxkcmVuXG5cdFx0XHRmb3IgKCBlbGVtID0gZWxlbS5maXJzdENoaWxkOyBlbGVtOyBlbGVtID0gZWxlbS5uZXh0U2libGluZyApIHtcblx0XHRcdFx0cmV0ICs9IGdldFRleHQoIGVsZW0gKTtcblx0XHRcdH1cblx0XHR9XG5cdH0gZWxzZSBpZiAoIG5vZGVUeXBlID09PSAzIHx8IG5vZGVUeXBlID09PSA0ICkge1xuXHRcdHJldHVybiBlbGVtLm5vZGVWYWx1ZTtcblx0fVxuXHQvLyBEbyBub3QgaW5jbHVkZSBjb21tZW50IG9yIHByb2Nlc3NpbmcgaW5zdHJ1Y3Rpb24gbm9kZXNcblxuXHRyZXR1cm4gcmV0O1xufTtcblxuRXhwciA9IFNpenpsZS5zZWxlY3RvcnMgPSB7XG5cblx0Ly8gQ2FuIGJlIGFkanVzdGVkIGJ5IHRoZSB1c2VyXG5cdGNhY2hlTGVuZ3RoOiA1MCxcblxuXHRjcmVhdGVQc2V1ZG86IG1hcmtGdW5jdGlvbixcblxuXHRtYXRjaDogbWF0Y2hFeHByLFxuXG5cdGF0dHJIYW5kbGU6IHt9LFxuXG5cdGZpbmQ6IHt9LFxuXG5cdHJlbGF0aXZlOiB7XG5cdFx0XCI+XCI6IHsgZGlyOiBcInBhcmVudE5vZGVcIiwgZmlyc3Q6IHRydWUgfSxcblx0XHRcIiBcIjogeyBkaXI6IFwicGFyZW50Tm9kZVwiIH0sXG5cdFx0XCIrXCI6IHsgZGlyOiBcInByZXZpb3VzU2libGluZ1wiLCBmaXJzdDogdHJ1ZSB9LFxuXHRcdFwiflwiOiB7IGRpcjogXCJwcmV2aW91c1NpYmxpbmdcIiB9XG5cdH0sXG5cblx0cHJlRmlsdGVyOiB7XG5cdFx0XCJBVFRSXCI6IGZ1bmN0aW9uKCBtYXRjaCApIHtcblx0XHRcdG1hdGNoWzFdID0gbWF0Y2hbMV0ucmVwbGFjZSggcnVuZXNjYXBlLCBmdW5lc2NhcGUgKTtcblxuXHRcdFx0Ly8gTW92ZSB0aGUgZ2l2ZW4gdmFsdWUgdG8gbWF0Y2hbM10gd2hldGhlciBxdW90ZWQgb3IgdW5xdW90ZWRcblx0XHRcdG1hdGNoWzNdID0gKCBtYXRjaFszXSB8fCBtYXRjaFs0XSB8fCBtYXRjaFs1XSB8fCBcIlwiICkucmVwbGFjZSggcnVuZXNjYXBlLCBmdW5lc2NhcGUgKTtcblxuXHRcdFx0aWYgKCBtYXRjaFsyXSA9PT0gXCJ+PVwiICkge1xuXHRcdFx0XHRtYXRjaFszXSA9IFwiIFwiICsgbWF0Y2hbM10gKyBcIiBcIjtcblx0XHRcdH1cblxuXHRcdFx0cmV0dXJuIG1hdGNoLnNsaWNlKCAwLCA0ICk7XG5cdFx0fSxcblxuXHRcdFwiQ0hJTERcIjogZnVuY3Rpb24oIG1hdGNoICkge1xuXHRcdFx0LyogbWF0Y2hlcyBmcm9tIG1hdGNoRXhwcltcIkNISUxEXCJdXG5cdFx0XHRcdDEgdHlwZSAob25seXxudGh8Li4uKVxuXHRcdFx0XHQyIHdoYXQgKGNoaWxkfG9mLXR5cGUpXG5cdFx0XHRcdDMgYXJndW1lbnQgKGV2ZW58b2RkfFxcZCp8XFxkKm4oWystXVxcZCspP3wuLi4pXG5cdFx0XHRcdDQgeG4tY29tcG9uZW50IG9mIHhuK3kgYXJndW1lbnQgKFsrLV0/XFxkKm58KVxuXHRcdFx0XHQ1IHNpZ24gb2YgeG4tY29tcG9uZW50XG5cdFx0XHRcdDYgeCBvZiB4bi1jb21wb25lbnRcblx0XHRcdFx0NyBzaWduIG9mIHktY29tcG9uZW50XG5cdFx0XHRcdDggeSBvZiB5LWNvbXBvbmVudFxuXHRcdFx0Ki9cblx0XHRcdG1hdGNoWzFdID0gbWF0Y2hbMV0udG9Mb3dlckNhc2UoKTtcblxuXHRcdFx0aWYgKCBtYXRjaFsxXS5zbGljZSggMCwgMyApID09PSBcIm50aFwiICkge1xuXHRcdFx0XHQvLyBudGgtKiByZXF1aXJlcyBhcmd1bWVudFxuXHRcdFx0XHRpZiAoICFtYXRjaFszXSApIHtcblx0XHRcdFx0XHRTaXp6bGUuZXJyb3IoIG1hdGNoWzBdICk7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHQvLyBudW1lcmljIHggYW5kIHkgcGFyYW1ldGVycyBmb3IgRXhwci5maWx0ZXIuQ0hJTERcblx0XHRcdFx0Ly8gcmVtZW1iZXIgdGhhdCBmYWxzZS90cnVlIGNhc3QgcmVzcGVjdGl2ZWx5IHRvIDAvMVxuXHRcdFx0XHRtYXRjaFs0XSA9ICsoIG1hdGNoWzRdID8gbWF0Y2hbNV0gKyAobWF0Y2hbNl0gfHwgMSkgOiAyICogKCBtYXRjaFszXSA9PT0gXCJldmVuXCIgfHwgbWF0Y2hbM10gPT09IFwib2RkXCIgKSApO1xuXHRcdFx0XHRtYXRjaFs1XSA9ICsoICggbWF0Y2hbN10gKyBtYXRjaFs4XSApIHx8IG1hdGNoWzNdID09PSBcIm9kZFwiICk7XG5cblx0XHRcdC8vIG90aGVyIHR5cGVzIHByb2hpYml0IGFyZ3VtZW50c1xuXHRcdFx0fSBlbHNlIGlmICggbWF0Y2hbM10gKSB7XG5cdFx0XHRcdFNpenpsZS5lcnJvciggbWF0Y2hbMF0gKTtcblx0XHRcdH1cblxuXHRcdFx0cmV0dXJuIG1hdGNoO1xuXHRcdH0sXG5cblx0XHRcIlBTRVVET1wiOiBmdW5jdGlvbiggbWF0Y2ggKSB7XG5cdFx0XHR2YXIgZXhjZXNzLFxuXHRcdFx0XHR1bnF1b3RlZCA9ICFtYXRjaFs2XSAmJiBtYXRjaFsyXTtcblxuXHRcdFx0aWYgKCBtYXRjaEV4cHJbXCJDSElMRFwiXS50ZXN0KCBtYXRjaFswXSApICkge1xuXHRcdFx0XHRyZXR1cm4gbnVsbDtcblx0XHRcdH1cblxuXHRcdFx0Ly8gQWNjZXB0IHF1b3RlZCBhcmd1bWVudHMgYXMtaXNcblx0XHRcdGlmICggbWF0Y2hbM10gKSB7XG5cdFx0XHRcdG1hdGNoWzJdID0gbWF0Y2hbNF0gfHwgbWF0Y2hbNV0gfHwgXCJcIjtcblxuXHRcdFx0Ly8gU3RyaXAgZXhjZXNzIGNoYXJhY3RlcnMgZnJvbSB1bnF1b3RlZCBhcmd1bWVudHNcblx0XHRcdH0gZWxzZSBpZiAoIHVucXVvdGVkICYmIHJwc2V1ZG8udGVzdCggdW5xdW90ZWQgKSAmJlxuXHRcdFx0XHQvLyBHZXQgZXhjZXNzIGZyb20gdG9rZW5pemUgKHJlY3Vyc2l2ZWx5KVxuXHRcdFx0XHQoZXhjZXNzID0gdG9rZW5pemUoIHVucXVvdGVkLCB0cnVlICkpICYmXG5cdFx0XHRcdC8vIGFkdmFuY2UgdG8gdGhlIG5leHQgY2xvc2luZyBwYXJlbnRoZXNpc1xuXHRcdFx0XHQoZXhjZXNzID0gdW5xdW90ZWQuaW5kZXhPZiggXCIpXCIsIHVucXVvdGVkLmxlbmd0aCAtIGV4Y2VzcyApIC0gdW5xdW90ZWQubGVuZ3RoKSApIHtcblxuXHRcdFx0XHQvLyBleGNlc3MgaXMgYSBuZWdhdGl2ZSBpbmRleFxuXHRcdFx0XHRtYXRjaFswXSA9IG1hdGNoWzBdLnNsaWNlKCAwLCBleGNlc3MgKTtcblx0XHRcdFx0bWF0Y2hbMl0gPSB1bnF1b3RlZC5zbGljZSggMCwgZXhjZXNzICk7XG5cdFx0XHR9XG5cblx0XHRcdC8vIFJldHVybiBvbmx5IGNhcHR1cmVzIG5lZWRlZCBieSB0aGUgcHNldWRvIGZpbHRlciBtZXRob2QgKHR5cGUgYW5kIGFyZ3VtZW50KVxuXHRcdFx0cmV0dXJuIG1hdGNoLnNsaWNlKCAwLCAzICk7XG5cdFx0fVxuXHR9LFxuXG5cdGZpbHRlcjoge1xuXG5cdFx0XCJUQUdcIjogZnVuY3Rpb24oIG5vZGVOYW1lU2VsZWN0b3IgKSB7XG5cdFx0XHR2YXIgbm9kZU5hbWUgPSBub2RlTmFtZVNlbGVjdG9yLnJlcGxhY2UoIHJ1bmVzY2FwZSwgZnVuZXNjYXBlICkudG9Mb3dlckNhc2UoKTtcblx0XHRcdHJldHVybiBub2RlTmFtZVNlbGVjdG9yID09PSBcIipcIiA/XG5cdFx0XHRcdGZ1bmN0aW9uKCkgeyByZXR1cm4gdHJ1ZTsgfSA6XG5cdFx0XHRcdGZ1bmN0aW9uKCBlbGVtICkge1xuXHRcdFx0XHRcdHJldHVybiBlbGVtLm5vZGVOYW1lICYmIGVsZW0ubm9kZU5hbWUudG9Mb3dlckNhc2UoKSA9PT0gbm9kZU5hbWU7XG5cdFx0XHRcdH07XG5cdFx0fSxcblxuXHRcdFwiQ0xBU1NcIjogZnVuY3Rpb24oIGNsYXNzTmFtZSApIHtcblx0XHRcdHZhciBwYXR0ZXJuID0gY2xhc3NDYWNoZVsgY2xhc3NOYW1lICsgXCIgXCIgXTtcblxuXHRcdFx0cmV0dXJuIHBhdHRlcm4gfHxcblx0XHRcdFx0KHBhdHRlcm4gPSBuZXcgUmVnRXhwKCBcIihefFwiICsgd2hpdGVzcGFjZSArIFwiKVwiICsgY2xhc3NOYW1lICsgXCIoXCIgKyB3aGl0ZXNwYWNlICsgXCJ8JClcIiApKSAmJlxuXHRcdFx0XHRjbGFzc0NhY2hlKCBjbGFzc05hbWUsIGZ1bmN0aW9uKCBlbGVtICkge1xuXHRcdFx0XHRcdHJldHVybiBwYXR0ZXJuLnRlc3QoIHR5cGVvZiBlbGVtLmNsYXNzTmFtZSA9PT0gXCJzdHJpbmdcIiAmJiBlbGVtLmNsYXNzTmFtZSB8fCB0eXBlb2YgZWxlbS5nZXRBdHRyaWJ1dGUgIT09IFwidW5kZWZpbmVkXCIgJiYgZWxlbS5nZXRBdHRyaWJ1dGUoXCJjbGFzc1wiKSB8fCBcIlwiICk7XG5cdFx0XHRcdH0pO1xuXHRcdH0sXG5cblx0XHRcIkFUVFJcIjogZnVuY3Rpb24oIG5hbWUsIG9wZXJhdG9yLCBjaGVjayApIHtcblx0XHRcdHJldHVybiBmdW5jdGlvbiggZWxlbSApIHtcblx0XHRcdFx0dmFyIHJlc3VsdCA9IFNpenpsZS5hdHRyKCBlbGVtLCBuYW1lICk7XG5cblx0XHRcdFx0aWYgKCByZXN1bHQgPT0gbnVsbCApIHtcblx0XHRcdFx0XHRyZXR1cm4gb3BlcmF0b3IgPT09IFwiIT1cIjtcblx0XHRcdFx0fVxuXHRcdFx0XHRpZiAoICFvcGVyYXRvciApIHtcblx0XHRcdFx0XHRyZXR1cm4gdHJ1ZTtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdHJlc3VsdCArPSBcIlwiO1xuXG5cdFx0XHRcdHJldHVybiBvcGVyYXRvciA9PT0gXCI9XCIgPyByZXN1bHQgPT09IGNoZWNrIDpcblx0XHRcdFx0XHRvcGVyYXRvciA9PT0gXCIhPVwiID8gcmVzdWx0ICE9PSBjaGVjayA6XG5cdFx0XHRcdFx0b3BlcmF0b3IgPT09IFwiXj1cIiA/IGNoZWNrICYmIHJlc3VsdC5pbmRleE9mKCBjaGVjayApID09PSAwIDpcblx0XHRcdFx0XHRvcGVyYXRvciA9PT0gXCIqPVwiID8gY2hlY2sgJiYgcmVzdWx0LmluZGV4T2YoIGNoZWNrICkgPiAtMSA6XG5cdFx0XHRcdFx0b3BlcmF0b3IgPT09IFwiJD1cIiA/IGNoZWNrICYmIHJlc3VsdC5zbGljZSggLWNoZWNrLmxlbmd0aCApID09PSBjaGVjayA6XG5cdFx0XHRcdFx0b3BlcmF0b3IgPT09IFwifj1cIiA/ICggXCIgXCIgKyByZXN1bHQucmVwbGFjZSggcndoaXRlc3BhY2UsIFwiIFwiICkgKyBcIiBcIiApLmluZGV4T2YoIGNoZWNrICkgPiAtMSA6XG5cdFx0XHRcdFx0b3BlcmF0b3IgPT09IFwifD1cIiA/IHJlc3VsdCA9PT0gY2hlY2sgfHwgcmVzdWx0LnNsaWNlKCAwLCBjaGVjay5sZW5ndGggKyAxICkgPT09IGNoZWNrICsgXCItXCIgOlxuXHRcdFx0XHRcdGZhbHNlO1xuXHRcdFx0fTtcblx0XHR9LFxuXG5cdFx0XCJDSElMRFwiOiBmdW5jdGlvbiggdHlwZSwgd2hhdCwgYXJndW1lbnQsIGZpcnN0LCBsYXN0ICkge1xuXHRcdFx0dmFyIHNpbXBsZSA9IHR5cGUuc2xpY2UoIDAsIDMgKSAhPT0gXCJudGhcIixcblx0XHRcdFx0Zm9yd2FyZCA9IHR5cGUuc2xpY2UoIC00ICkgIT09IFwibGFzdFwiLFxuXHRcdFx0XHRvZlR5cGUgPSB3aGF0ID09PSBcIm9mLXR5cGVcIjtcblxuXHRcdFx0cmV0dXJuIGZpcnN0ID09PSAxICYmIGxhc3QgPT09IDAgP1xuXG5cdFx0XHRcdC8vIFNob3J0Y3V0IGZvciA6bnRoLSoobilcblx0XHRcdFx0ZnVuY3Rpb24oIGVsZW0gKSB7XG5cdFx0XHRcdFx0cmV0dXJuICEhZWxlbS5wYXJlbnROb2RlO1xuXHRcdFx0XHR9IDpcblxuXHRcdFx0XHRmdW5jdGlvbiggZWxlbSwgY29udGV4dCwgeG1sICkge1xuXHRcdFx0XHRcdHZhciBjYWNoZSwgb3V0ZXJDYWNoZSwgbm9kZSwgZGlmZiwgbm9kZUluZGV4LCBzdGFydCxcblx0XHRcdFx0XHRcdGRpciA9IHNpbXBsZSAhPT0gZm9yd2FyZCA/IFwibmV4dFNpYmxpbmdcIiA6IFwicHJldmlvdXNTaWJsaW5nXCIsXG5cdFx0XHRcdFx0XHRwYXJlbnQgPSBlbGVtLnBhcmVudE5vZGUsXG5cdFx0XHRcdFx0XHRuYW1lID0gb2ZUeXBlICYmIGVsZW0ubm9kZU5hbWUudG9Mb3dlckNhc2UoKSxcblx0XHRcdFx0XHRcdHVzZUNhY2hlID0gIXhtbCAmJiAhb2ZUeXBlO1xuXG5cdFx0XHRcdFx0aWYgKCBwYXJlbnQgKSB7XG5cblx0XHRcdFx0XHRcdC8vIDooZmlyc3R8bGFzdHxvbmx5KS0oY2hpbGR8b2YtdHlwZSlcblx0XHRcdFx0XHRcdGlmICggc2ltcGxlICkge1xuXHRcdFx0XHRcdFx0XHR3aGlsZSAoIGRpciApIHtcblx0XHRcdFx0XHRcdFx0XHRub2RlID0gZWxlbTtcblx0XHRcdFx0XHRcdFx0XHR3aGlsZSAoIChub2RlID0gbm9kZVsgZGlyIF0pICkge1xuXHRcdFx0XHRcdFx0XHRcdFx0aWYgKCBvZlR5cGUgPyBub2RlLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCkgPT09IG5hbWUgOiBub2RlLm5vZGVUeXBlID09PSAxICkge1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRyZXR1cm4gZmFsc2U7XG5cdFx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHRcdC8vIFJldmVyc2UgZGlyZWN0aW9uIGZvciA6b25seS0qIChpZiB3ZSBoYXZlbid0IHlldCBkb25lIHNvKVxuXHRcdFx0XHRcdFx0XHRcdHN0YXJ0ID0gZGlyID0gdHlwZSA9PT0gXCJvbmx5XCIgJiYgIXN0YXJ0ICYmIFwibmV4dFNpYmxpbmdcIjtcblx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHRyZXR1cm4gdHJ1ZTtcblx0XHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdFx0c3RhcnQgPSBbIGZvcndhcmQgPyBwYXJlbnQuZmlyc3RDaGlsZCA6IHBhcmVudC5sYXN0Q2hpbGQgXTtcblxuXHRcdFx0XHRcdFx0Ly8gbm9uLXhtbCA6bnRoLWNoaWxkKC4uLikgc3RvcmVzIGNhY2hlIGRhdGEgb24gYHBhcmVudGBcblx0XHRcdFx0XHRcdGlmICggZm9yd2FyZCAmJiB1c2VDYWNoZSApIHtcblx0XHRcdFx0XHRcdFx0Ly8gU2VlayBgZWxlbWAgZnJvbSBhIHByZXZpb3VzbHktY2FjaGVkIGluZGV4XG5cdFx0XHRcdFx0XHRcdG91dGVyQ2FjaGUgPSBwYXJlbnRbIGV4cGFuZG8gXSB8fCAocGFyZW50WyBleHBhbmRvIF0gPSB7fSk7XG5cdFx0XHRcdFx0XHRcdGNhY2hlID0gb3V0ZXJDYWNoZVsgdHlwZSBdIHx8IFtdO1xuXHRcdFx0XHRcdFx0XHRub2RlSW5kZXggPSBjYWNoZVswXSA9PT0gZGlycnVucyAmJiBjYWNoZVsxXTtcblx0XHRcdFx0XHRcdFx0ZGlmZiA9IGNhY2hlWzBdID09PSBkaXJydW5zICYmIGNhY2hlWzJdO1xuXHRcdFx0XHRcdFx0XHRub2RlID0gbm9kZUluZGV4ICYmIHBhcmVudC5jaGlsZE5vZGVzWyBub2RlSW5kZXggXTtcblxuXHRcdFx0XHRcdFx0XHR3aGlsZSAoIChub2RlID0gKytub2RlSW5kZXggJiYgbm9kZSAmJiBub2RlWyBkaXIgXSB8fFxuXG5cdFx0XHRcdFx0XHRcdFx0Ly8gRmFsbGJhY2sgdG8gc2Vla2luZyBgZWxlbWAgZnJvbSB0aGUgc3RhcnRcblx0XHRcdFx0XHRcdFx0XHQoZGlmZiA9IG5vZGVJbmRleCA9IDApIHx8IHN0YXJ0LnBvcCgpKSApIHtcblxuXHRcdFx0XHRcdFx0XHRcdC8vIFdoZW4gZm91bmQsIGNhY2hlIGluZGV4ZXMgb24gYHBhcmVudGAgYW5kIGJyZWFrXG5cdFx0XHRcdFx0XHRcdFx0aWYgKCBub2RlLm5vZGVUeXBlID09PSAxICYmICsrZGlmZiAmJiBub2RlID09PSBlbGVtICkge1xuXHRcdFx0XHRcdFx0XHRcdFx0b3V0ZXJDYWNoZVsgdHlwZSBdID0gWyBkaXJydW5zLCBub2RlSW5kZXgsIGRpZmYgXTtcblx0XHRcdFx0XHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0XHQvLyBVc2UgcHJldmlvdXNseS1jYWNoZWQgZWxlbWVudCBpbmRleCBpZiBhdmFpbGFibGVcblx0XHRcdFx0XHRcdH0gZWxzZSBpZiAoIHVzZUNhY2hlICYmIChjYWNoZSA9IChlbGVtWyBleHBhbmRvIF0gfHwgKGVsZW1bIGV4cGFuZG8gXSA9IHt9KSlbIHR5cGUgXSkgJiYgY2FjaGVbMF0gPT09IGRpcnJ1bnMgKSB7XG5cdFx0XHRcdFx0XHRcdGRpZmYgPSBjYWNoZVsxXTtcblxuXHRcdFx0XHRcdFx0Ly8geG1sIDpudGgtY2hpbGQoLi4uKSBvciA6bnRoLWxhc3QtY2hpbGQoLi4uKSBvciA6bnRoKC1sYXN0KT8tb2YtdHlwZSguLi4pXG5cdFx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0XHQvLyBVc2UgdGhlIHNhbWUgbG9vcCBhcyBhYm92ZSB0byBzZWVrIGBlbGVtYCBmcm9tIHRoZSBzdGFydFxuXHRcdFx0XHRcdFx0XHR3aGlsZSAoIChub2RlID0gKytub2RlSW5kZXggJiYgbm9kZSAmJiBub2RlWyBkaXIgXSB8fFxuXHRcdFx0XHRcdFx0XHRcdChkaWZmID0gbm9kZUluZGV4ID0gMCkgfHwgc3RhcnQucG9wKCkpICkge1xuXG5cdFx0XHRcdFx0XHRcdFx0aWYgKCAoIG9mVHlwZSA/IG5vZGUubm9kZU5hbWUudG9Mb3dlckNhc2UoKSA9PT0gbmFtZSA6IG5vZGUubm9kZVR5cGUgPT09IDEgKSAmJiArK2RpZmYgKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHQvLyBDYWNoZSB0aGUgaW5kZXggb2YgZWFjaCBlbmNvdW50ZXJlZCBlbGVtZW50XG5cdFx0XHRcdFx0XHRcdFx0XHRpZiAoIHVzZUNhY2hlICkge1xuXHRcdFx0XHRcdFx0XHRcdFx0XHQobm9kZVsgZXhwYW5kbyBdIHx8IChub2RlWyBleHBhbmRvIF0gPSB7fSkpWyB0eXBlIF0gPSBbIGRpcnJ1bnMsIGRpZmYgXTtcblx0XHRcdFx0XHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdFx0XHRcdFx0aWYgKCBub2RlID09PSBlbGVtICkge1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdFx0Ly8gSW5jb3Jwb3JhdGUgdGhlIG9mZnNldCwgdGhlbiBjaGVjayBhZ2FpbnN0IGN5Y2xlIHNpemVcblx0XHRcdFx0XHRcdGRpZmYgLT0gbGFzdDtcblx0XHRcdFx0XHRcdHJldHVybiBkaWZmID09PSBmaXJzdCB8fCAoIGRpZmYgJSBmaXJzdCA9PT0gMCAmJiBkaWZmIC8gZmlyc3QgPj0gMCApO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fTtcblx0XHR9LFxuXG5cdFx0XCJQU0VVRE9cIjogZnVuY3Rpb24oIHBzZXVkbywgYXJndW1lbnQgKSB7XG5cdFx0XHQvLyBwc2V1ZG8tY2xhc3MgbmFtZXMgYXJlIGNhc2UtaW5zZW5zaXRpdmVcblx0XHRcdC8vIGh0dHA6Ly93d3cudzMub3JnL1RSL3NlbGVjdG9ycy8jcHNldWRvLWNsYXNzZXNcblx0XHRcdC8vIFByaW9yaXRpemUgYnkgY2FzZSBzZW5zaXRpdml0eSBpbiBjYXNlIGN1c3RvbSBwc2V1ZG9zIGFyZSBhZGRlZCB3aXRoIHVwcGVyY2FzZSBsZXR0ZXJzXG5cdFx0XHQvLyBSZW1lbWJlciB0aGF0IHNldEZpbHRlcnMgaW5oZXJpdHMgZnJvbSBwc2V1ZG9zXG5cdFx0XHR2YXIgYXJncyxcblx0XHRcdFx0Zm4gPSBFeHByLnBzZXVkb3NbIHBzZXVkbyBdIHx8IEV4cHIuc2V0RmlsdGVyc1sgcHNldWRvLnRvTG93ZXJDYXNlKCkgXSB8fFxuXHRcdFx0XHRcdFNpenpsZS5lcnJvciggXCJ1bnN1cHBvcnRlZCBwc2V1ZG86IFwiICsgcHNldWRvICk7XG5cblx0XHRcdC8vIFRoZSB1c2VyIG1heSB1c2UgY3JlYXRlUHNldWRvIHRvIGluZGljYXRlIHRoYXRcblx0XHRcdC8vIGFyZ3VtZW50cyBhcmUgbmVlZGVkIHRvIGNyZWF0ZSB0aGUgZmlsdGVyIGZ1bmN0aW9uXG5cdFx0XHQvLyBqdXN0IGFzIFNpenpsZSBkb2VzXG5cdFx0XHRpZiAoIGZuWyBleHBhbmRvIF0gKSB7XG5cdFx0XHRcdHJldHVybiBmbiggYXJndW1lbnQgKTtcblx0XHRcdH1cblxuXHRcdFx0Ly8gQnV0IG1haW50YWluIHN1cHBvcnQgZm9yIG9sZCBzaWduYXR1cmVzXG5cdFx0XHRpZiAoIGZuLmxlbmd0aCA+IDEgKSB7XG5cdFx0XHRcdGFyZ3MgPSBbIHBzZXVkbywgcHNldWRvLCBcIlwiLCBhcmd1bWVudCBdO1xuXHRcdFx0XHRyZXR1cm4gRXhwci5zZXRGaWx0ZXJzLmhhc093blByb3BlcnR5KCBwc2V1ZG8udG9Mb3dlckNhc2UoKSApID9cblx0XHRcdFx0XHRtYXJrRnVuY3Rpb24oZnVuY3Rpb24oIHNlZWQsIG1hdGNoZXMgKSB7XG5cdFx0XHRcdFx0XHR2YXIgaWR4LFxuXHRcdFx0XHRcdFx0XHRtYXRjaGVkID0gZm4oIHNlZWQsIGFyZ3VtZW50ICksXG5cdFx0XHRcdFx0XHRcdGkgPSBtYXRjaGVkLmxlbmd0aDtcblx0XHRcdFx0XHRcdHdoaWxlICggaS0tICkge1xuXHRcdFx0XHRcdFx0XHRpZHggPSBpbmRleE9mKCBzZWVkLCBtYXRjaGVkW2ldICk7XG5cdFx0XHRcdFx0XHRcdHNlZWRbIGlkeCBdID0gISggbWF0Y2hlc1sgaWR4IF0gPSBtYXRjaGVkW2ldICk7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fSkgOlxuXHRcdFx0XHRcdGZ1bmN0aW9uKCBlbGVtICkge1xuXHRcdFx0XHRcdFx0cmV0dXJuIGZuKCBlbGVtLCAwLCBhcmdzICk7XG5cdFx0XHRcdFx0fTtcblx0XHRcdH1cblxuXHRcdFx0cmV0dXJuIGZuO1xuXHRcdH1cblx0fSxcblxuXHRwc2V1ZG9zOiB7XG5cdFx0Ly8gUG90ZW50aWFsbHkgY29tcGxleCBwc2V1ZG9zXG5cdFx0XCJub3RcIjogbWFya0Z1bmN0aW9uKGZ1bmN0aW9uKCBzZWxlY3RvciApIHtcblx0XHRcdC8vIFRyaW0gdGhlIHNlbGVjdG9yIHBhc3NlZCB0byBjb21waWxlXG5cdFx0XHQvLyB0byBhdm9pZCB0cmVhdGluZyBsZWFkaW5nIGFuZCB0cmFpbGluZ1xuXHRcdFx0Ly8gc3BhY2VzIGFzIGNvbWJpbmF0b3JzXG5cdFx0XHR2YXIgaW5wdXQgPSBbXSxcblx0XHRcdFx0cmVzdWx0cyA9IFtdLFxuXHRcdFx0XHRtYXRjaGVyID0gY29tcGlsZSggc2VsZWN0b3IucmVwbGFjZSggcnRyaW0sIFwiJDFcIiApICk7XG5cblx0XHRcdHJldHVybiBtYXRjaGVyWyBleHBhbmRvIF0gP1xuXHRcdFx0XHRtYXJrRnVuY3Rpb24oZnVuY3Rpb24oIHNlZWQsIG1hdGNoZXMsIGNvbnRleHQsIHhtbCApIHtcblx0XHRcdFx0XHR2YXIgZWxlbSxcblx0XHRcdFx0XHRcdHVubWF0Y2hlZCA9IG1hdGNoZXIoIHNlZWQsIG51bGwsIHhtbCwgW10gKSxcblx0XHRcdFx0XHRcdGkgPSBzZWVkLmxlbmd0aDtcblxuXHRcdFx0XHRcdC8vIE1hdGNoIGVsZW1lbnRzIHVubWF0Y2hlZCBieSBgbWF0Y2hlcmBcblx0XHRcdFx0XHR3aGlsZSAoIGktLSApIHtcblx0XHRcdFx0XHRcdGlmICggKGVsZW0gPSB1bm1hdGNoZWRbaV0pICkge1xuXHRcdFx0XHRcdFx0XHRzZWVkW2ldID0gIShtYXRjaGVzW2ldID0gZWxlbSk7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9KSA6XG5cdFx0XHRcdGZ1bmN0aW9uKCBlbGVtLCBjb250ZXh0LCB4bWwgKSB7XG5cdFx0XHRcdFx0aW5wdXRbMF0gPSBlbGVtO1xuXHRcdFx0XHRcdG1hdGNoZXIoIGlucHV0LCBudWxsLCB4bWwsIHJlc3VsdHMgKTtcblx0XHRcdFx0XHQvLyBEb24ndCBrZWVwIHRoZSBlbGVtZW50IChpc3N1ZSAjMjk5KVxuXHRcdFx0XHRcdGlucHV0WzBdID0gbnVsbDtcblx0XHRcdFx0XHRyZXR1cm4gIXJlc3VsdHMucG9wKCk7XG5cdFx0XHRcdH07XG5cdFx0fSksXG5cblx0XHRcImhhc1wiOiBtYXJrRnVuY3Rpb24oZnVuY3Rpb24oIHNlbGVjdG9yICkge1xuXHRcdFx0cmV0dXJuIGZ1bmN0aW9uKCBlbGVtICkge1xuXHRcdFx0XHRyZXR1cm4gU2l6emxlKCBzZWxlY3RvciwgZWxlbSApLmxlbmd0aCA+IDA7XG5cdFx0XHR9O1xuXHRcdH0pLFxuXG5cdFx0XCJjb250YWluc1wiOiBtYXJrRnVuY3Rpb24oZnVuY3Rpb24oIHRleHQgKSB7XG5cdFx0XHR0ZXh0ID0gdGV4dC5yZXBsYWNlKCBydW5lc2NhcGUsIGZ1bmVzY2FwZSApO1xuXHRcdFx0cmV0dXJuIGZ1bmN0aW9uKCBlbGVtICkge1xuXHRcdFx0XHRyZXR1cm4gKCBlbGVtLnRleHRDb250ZW50IHx8IGVsZW0uaW5uZXJUZXh0IHx8IGdldFRleHQoIGVsZW0gKSApLmluZGV4T2YoIHRleHQgKSA+IC0xO1xuXHRcdFx0fTtcblx0XHR9KSxcblxuXHRcdC8vIFwiV2hldGhlciBhbiBlbGVtZW50IGlzIHJlcHJlc2VudGVkIGJ5IGEgOmxhbmcoKSBzZWxlY3RvclxuXHRcdC8vIGlzIGJhc2VkIHNvbGVseSBvbiB0aGUgZWxlbWVudCdzIGxhbmd1YWdlIHZhbHVlXG5cdFx0Ly8gYmVpbmcgZXF1YWwgdG8gdGhlIGlkZW50aWZpZXIgQyxcblx0XHQvLyBvciBiZWdpbm5pbmcgd2l0aCB0aGUgaWRlbnRpZmllciBDIGltbWVkaWF0ZWx5IGZvbGxvd2VkIGJ5IFwiLVwiLlxuXHRcdC8vIFRoZSBtYXRjaGluZyBvZiBDIGFnYWluc3QgdGhlIGVsZW1lbnQncyBsYW5ndWFnZSB2YWx1ZSBpcyBwZXJmb3JtZWQgY2FzZS1pbnNlbnNpdGl2ZWx5LlxuXHRcdC8vIFRoZSBpZGVudGlmaWVyIEMgZG9lcyBub3QgaGF2ZSB0byBiZSBhIHZhbGlkIGxhbmd1YWdlIG5hbWUuXCJcblx0XHQvLyBodHRwOi8vd3d3LnczLm9yZy9UUi9zZWxlY3RvcnMvI2xhbmctcHNldWRvXG5cdFx0XCJsYW5nXCI6IG1hcmtGdW5jdGlvbiggZnVuY3Rpb24oIGxhbmcgKSB7XG5cdFx0XHQvLyBsYW5nIHZhbHVlIG11c3QgYmUgYSB2YWxpZCBpZGVudGlmaWVyXG5cdFx0XHRpZiAoICFyaWRlbnRpZmllci50ZXN0KGxhbmcgfHwgXCJcIikgKSB7XG5cdFx0XHRcdFNpenpsZS5lcnJvciggXCJ1bnN1cHBvcnRlZCBsYW5nOiBcIiArIGxhbmcgKTtcblx0XHRcdH1cblx0XHRcdGxhbmcgPSBsYW5nLnJlcGxhY2UoIHJ1bmVzY2FwZSwgZnVuZXNjYXBlICkudG9Mb3dlckNhc2UoKTtcblx0XHRcdHJldHVybiBmdW5jdGlvbiggZWxlbSApIHtcblx0XHRcdFx0dmFyIGVsZW1MYW5nO1xuXHRcdFx0XHRkbyB7XG5cdFx0XHRcdFx0aWYgKCAoZWxlbUxhbmcgPSBkb2N1bWVudElzSFRNTCA/XG5cdFx0XHRcdFx0XHRlbGVtLmxhbmcgOlxuXHRcdFx0XHRcdFx0ZWxlbS5nZXRBdHRyaWJ1dGUoXCJ4bWw6bGFuZ1wiKSB8fCBlbGVtLmdldEF0dHJpYnV0ZShcImxhbmdcIikpICkge1xuXG5cdFx0XHRcdFx0XHRlbGVtTGFuZyA9IGVsZW1MYW5nLnRvTG93ZXJDYXNlKCk7XG5cdFx0XHRcdFx0XHRyZXR1cm4gZWxlbUxhbmcgPT09IGxhbmcgfHwgZWxlbUxhbmcuaW5kZXhPZiggbGFuZyArIFwiLVwiICkgPT09IDA7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9IHdoaWxlICggKGVsZW0gPSBlbGVtLnBhcmVudE5vZGUpICYmIGVsZW0ubm9kZVR5cGUgPT09IDEgKTtcblx0XHRcdFx0cmV0dXJuIGZhbHNlO1xuXHRcdFx0fTtcblx0XHR9KSxcblxuXHRcdC8vIE1pc2NlbGxhbmVvdXNcblx0XHRcInRhcmdldFwiOiBmdW5jdGlvbiggZWxlbSApIHtcblx0XHRcdHZhciBoYXNoID0gd2luZG93LmxvY2F0aW9uICYmIHdpbmRvdy5sb2NhdGlvbi5oYXNoO1xuXHRcdFx0cmV0dXJuIGhhc2ggJiYgaGFzaC5zbGljZSggMSApID09PSBlbGVtLmlkO1xuXHRcdH0sXG5cblx0XHRcInJvb3RcIjogZnVuY3Rpb24oIGVsZW0gKSB7XG5cdFx0XHRyZXR1cm4gZWxlbSA9PT0gZG9jRWxlbTtcblx0XHR9LFxuXG5cdFx0XCJmb2N1c1wiOiBmdW5jdGlvbiggZWxlbSApIHtcblx0XHRcdHJldHVybiBlbGVtID09PSBkb2N1bWVudC5hY3RpdmVFbGVtZW50ICYmICghZG9jdW1lbnQuaGFzRm9jdXMgfHwgZG9jdW1lbnQuaGFzRm9jdXMoKSkgJiYgISEoZWxlbS50eXBlIHx8IGVsZW0uaHJlZiB8fCB+ZWxlbS50YWJJbmRleCk7XG5cdFx0fSxcblxuXHRcdC8vIEJvb2xlYW4gcHJvcGVydGllc1xuXHRcdFwiZW5hYmxlZFwiOiBmdW5jdGlvbiggZWxlbSApIHtcblx0XHRcdHJldHVybiBlbGVtLmRpc2FibGVkID09PSBmYWxzZTtcblx0XHR9LFxuXG5cdFx0XCJkaXNhYmxlZFwiOiBmdW5jdGlvbiggZWxlbSApIHtcblx0XHRcdHJldHVybiBlbGVtLmRpc2FibGVkID09PSB0cnVlO1xuXHRcdH0sXG5cblx0XHRcImNoZWNrZWRcIjogZnVuY3Rpb24oIGVsZW0gKSB7XG5cdFx0XHQvLyBJbiBDU1MzLCA6Y2hlY2tlZCBzaG91bGQgcmV0dXJuIGJvdGggY2hlY2tlZCBhbmQgc2VsZWN0ZWQgZWxlbWVudHNcblx0XHRcdC8vIGh0dHA6Ly93d3cudzMub3JnL1RSLzIwMTEvUkVDLWNzczMtc2VsZWN0b3JzLTIwMTEwOTI5LyNjaGVja2VkXG5cdFx0XHR2YXIgbm9kZU5hbWUgPSBlbGVtLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCk7XG5cdFx0XHRyZXR1cm4gKG5vZGVOYW1lID09PSBcImlucHV0XCIgJiYgISFlbGVtLmNoZWNrZWQpIHx8IChub2RlTmFtZSA9PT0gXCJvcHRpb25cIiAmJiAhIWVsZW0uc2VsZWN0ZWQpO1xuXHRcdH0sXG5cblx0XHRcInNlbGVjdGVkXCI6IGZ1bmN0aW9uKCBlbGVtICkge1xuXHRcdFx0Ly8gQWNjZXNzaW5nIHRoaXMgcHJvcGVydHkgbWFrZXMgc2VsZWN0ZWQtYnktZGVmYXVsdFxuXHRcdFx0Ly8gb3B0aW9ucyBpbiBTYWZhcmkgd29yayBwcm9wZXJseVxuXHRcdFx0aWYgKCBlbGVtLnBhcmVudE5vZGUgKSB7XG5cdFx0XHRcdGVsZW0ucGFyZW50Tm9kZS5zZWxlY3RlZEluZGV4O1xuXHRcdFx0fVxuXG5cdFx0XHRyZXR1cm4gZWxlbS5zZWxlY3RlZCA9PT0gdHJ1ZTtcblx0XHR9LFxuXG5cdFx0Ly8gQ29udGVudHNcblx0XHRcImVtcHR5XCI6IGZ1bmN0aW9uKCBlbGVtICkge1xuXHRcdFx0Ly8gaHR0cDovL3d3dy53My5vcmcvVFIvc2VsZWN0b3JzLyNlbXB0eS1wc2V1ZG9cblx0XHRcdC8vIDplbXB0eSBpcyBuZWdhdGVkIGJ5IGVsZW1lbnQgKDEpIG9yIGNvbnRlbnQgbm9kZXMgKHRleHQ6IDM7IGNkYXRhOiA0OyBlbnRpdHkgcmVmOiA1KSxcblx0XHRcdC8vICAgYnV0IG5vdCBieSBvdGhlcnMgKGNvbW1lbnQ6IDg7IHByb2Nlc3NpbmcgaW5zdHJ1Y3Rpb246IDc7IGV0Yy4pXG5cdFx0XHQvLyBub2RlVHlwZSA8IDYgd29ya3MgYmVjYXVzZSBhdHRyaWJ1dGVzICgyKSBkbyBub3QgYXBwZWFyIGFzIGNoaWxkcmVuXG5cdFx0XHRmb3IgKCBlbGVtID0gZWxlbS5maXJzdENoaWxkOyBlbGVtOyBlbGVtID0gZWxlbS5uZXh0U2libGluZyApIHtcblx0XHRcdFx0aWYgKCBlbGVtLm5vZGVUeXBlIDwgNiApIHtcblx0XHRcdFx0XHRyZXR1cm4gZmFsc2U7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHRcdHJldHVybiB0cnVlO1xuXHRcdH0sXG5cblx0XHRcInBhcmVudFwiOiBmdW5jdGlvbiggZWxlbSApIHtcblx0XHRcdHJldHVybiAhRXhwci5wc2V1ZG9zW1wiZW1wdHlcIl0oIGVsZW0gKTtcblx0XHR9LFxuXG5cdFx0Ly8gRWxlbWVudC9pbnB1dCB0eXBlc1xuXHRcdFwiaGVhZGVyXCI6IGZ1bmN0aW9uKCBlbGVtICkge1xuXHRcdFx0cmV0dXJuIHJoZWFkZXIudGVzdCggZWxlbS5ub2RlTmFtZSApO1xuXHRcdH0sXG5cblx0XHRcImlucHV0XCI6IGZ1bmN0aW9uKCBlbGVtICkge1xuXHRcdFx0cmV0dXJuIHJpbnB1dHMudGVzdCggZWxlbS5ub2RlTmFtZSApO1xuXHRcdH0sXG5cblx0XHRcImJ1dHRvblwiOiBmdW5jdGlvbiggZWxlbSApIHtcblx0XHRcdHZhciBuYW1lID0gZWxlbS5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpO1xuXHRcdFx0cmV0dXJuIG5hbWUgPT09IFwiaW5wdXRcIiAmJiBlbGVtLnR5cGUgPT09IFwiYnV0dG9uXCIgfHwgbmFtZSA9PT0gXCJidXR0b25cIjtcblx0XHR9LFxuXG5cdFx0XCJ0ZXh0XCI6IGZ1bmN0aW9uKCBlbGVtICkge1xuXHRcdFx0dmFyIGF0dHI7XG5cdFx0XHRyZXR1cm4gZWxlbS5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpID09PSBcImlucHV0XCIgJiZcblx0XHRcdFx0ZWxlbS50eXBlID09PSBcInRleHRcIiAmJlxuXG5cdFx0XHRcdC8vIFN1cHBvcnQ6IElFPDhcblx0XHRcdFx0Ly8gTmV3IEhUTUw1IGF0dHJpYnV0ZSB2YWx1ZXMgKGUuZy4sIFwic2VhcmNoXCIpIGFwcGVhciB3aXRoIGVsZW0udHlwZSA9PT0gXCJ0ZXh0XCJcblx0XHRcdFx0KCAoYXR0ciA9IGVsZW0uZ2V0QXR0cmlidXRlKFwidHlwZVwiKSkgPT0gbnVsbCB8fCBhdHRyLnRvTG93ZXJDYXNlKCkgPT09IFwidGV4dFwiICk7XG5cdFx0fSxcblxuXHRcdC8vIFBvc2l0aW9uLWluLWNvbGxlY3Rpb25cblx0XHRcImZpcnN0XCI6IGNyZWF0ZVBvc2l0aW9uYWxQc2V1ZG8oZnVuY3Rpb24oKSB7XG5cdFx0XHRyZXR1cm4gWyAwIF07XG5cdFx0fSksXG5cblx0XHRcImxhc3RcIjogY3JlYXRlUG9zaXRpb25hbFBzZXVkbyhmdW5jdGlvbiggbWF0Y2hJbmRleGVzLCBsZW5ndGggKSB7XG5cdFx0XHRyZXR1cm4gWyBsZW5ndGggLSAxIF07XG5cdFx0fSksXG5cblx0XHRcImVxXCI6IGNyZWF0ZVBvc2l0aW9uYWxQc2V1ZG8oZnVuY3Rpb24oIG1hdGNoSW5kZXhlcywgbGVuZ3RoLCBhcmd1bWVudCApIHtcblx0XHRcdHJldHVybiBbIGFyZ3VtZW50IDwgMCA/IGFyZ3VtZW50ICsgbGVuZ3RoIDogYXJndW1lbnQgXTtcblx0XHR9KSxcblxuXHRcdFwiZXZlblwiOiBjcmVhdGVQb3NpdGlvbmFsUHNldWRvKGZ1bmN0aW9uKCBtYXRjaEluZGV4ZXMsIGxlbmd0aCApIHtcblx0XHRcdHZhciBpID0gMDtcblx0XHRcdGZvciAoIDsgaSA8IGxlbmd0aDsgaSArPSAyICkge1xuXHRcdFx0XHRtYXRjaEluZGV4ZXMucHVzaCggaSApO1xuXHRcdFx0fVxuXHRcdFx0cmV0dXJuIG1hdGNoSW5kZXhlcztcblx0XHR9KSxcblxuXHRcdFwib2RkXCI6IGNyZWF0ZVBvc2l0aW9uYWxQc2V1ZG8oZnVuY3Rpb24oIG1hdGNoSW5kZXhlcywgbGVuZ3RoICkge1xuXHRcdFx0dmFyIGkgPSAxO1xuXHRcdFx0Zm9yICggOyBpIDwgbGVuZ3RoOyBpICs9IDIgKSB7XG5cdFx0XHRcdG1hdGNoSW5kZXhlcy5wdXNoKCBpICk7XG5cdFx0XHR9XG5cdFx0XHRyZXR1cm4gbWF0Y2hJbmRleGVzO1xuXHRcdH0pLFxuXG5cdFx0XCJsdFwiOiBjcmVhdGVQb3NpdGlvbmFsUHNldWRvKGZ1bmN0aW9uKCBtYXRjaEluZGV4ZXMsIGxlbmd0aCwgYXJndW1lbnQgKSB7XG5cdFx0XHR2YXIgaSA9IGFyZ3VtZW50IDwgMCA/IGFyZ3VtZW50ICsgbGVuZ3RoIDogYXJndW1lbnQ7XG5cdFx0XHRmb3IgKCA7IC0taSA+PSAwOyApIHtcblx0XHRcdFx0bWF0Y2hJbmRleGVzLnB1c2goIGkgKTtcblx0XHRcdH1cblx0XHRcdHJldHVybiBtYXRjaEluZGV4ZXM7XG5cdFx0fSksXG5cblx0XHRcImd0XCI6IGNyZWF0ZVBvc2l0aW9uYWxQc2V1ZG8oZnVuY3Rpb24oIG1hdGNoSW5kZXhlcywgbGVuZ3RoLCBhcmd1bWVudCApIHtcblx0XHRcdHZhciBpID0gYXJndW1lbnQgPCAwID8gYXJndW1lbnQgKyBsZW5ndGggOiBhcmd1bWVudDtcblx0XHRcdGZvciAoIDsgKytpIDwgbGVuZ3RoOyApIHtcblx0XHRcdFx0bWF0Y2hJbmRleGVzLnB1c2goIGkgKTtcblx0XHRcdH1cblx0XHRcdHJldHVybiBtYXRjaEluZGV4ZXM7XG5cdFx0fSlcblx0fVxufTtcblxuRXhwci5wc2V1ZG9zW1wibnRoXCJdID0gRXhwci5wc2V1ZG9zW1wiZXFcIl07XG5cbi8vIEFkZCBidXR0b24vaW5wdXQgdHlwZSBwc2V1ZG9zXG5mb3IgKCBpIGluIHsgcmFkaW86IHRydWUsIGNoZWNrYm94OiB0cnVlLCBmaWxlOiB0cnVlLCBwYXNzd29yZDogdHJ1ZSwgaW1hZ2U6IHRydWUgfSApIHtcblx0RXhwci5wc2V1ZG9zWyBpIF0gPSBjcmVhdGVJbnB1dFBzZXVkbyggaSApO1xufVxuZm9yICggaSBpbiB7IHN1Ym1pdDogdHJ1ZSwgcmVzZXQ6IHRydWUgfSApIHtcblx0RXhwci5wc2V1ZG9zWyBpIF0gPSBjcmVhdGVCdXR0b25Qc2V1ZG8oIGkgKTtcbn1cblxuLy8gRWFzeSBBUEkgZm9yIGNyZWF0aW5nIG5ldyBzZXRGaWx0ZXJzXG5mdW5jdGlvbiBzZXRGaWx0ZXJzKCkge31cbnNldEZpbHRlcnMucHJvdG90eXBlID0gRXhwci5maWx0ZXJzID0gRXhwci5wc2V1ZG9zO1xuRXhwci5zZXRGaWx0ZXJzID0gbmV3IHNldEZpbHRlcnMoKTtcblxudG9rZW5pemUgPSBTaXp6bGUudG9rZW5pemUgPSBmdW5jdGlvbiggc2VsZWN0b3IsIHBhcnNlT25seSApIHtcblx0dmFyIG1hdGNoZWQsIG1hdGNoLCB0b2tlbnMsIHR5cGUsXG5cdFx0c29GYXIsIGdyb3VwcywgcHJlRmlsdGVycyxcblx0XHRjYWNoZWQgPSB0b2tlbkNhY2hlWyBzZWxlY3RvciArIFwiIFwiIF07XG5cblx0aWYgKCBjYWNoZWQgKSB7XG5cdFx0cmV0dXJuIHBhcnNlT25seSA/IDAgOiBjYWNoZWQuc2xpY2UoIDAgKTtcblx0fVxuXG5cdHNvRmFyID0gc2VsZWN0b3I7XG5cdGdyb3VwcyA9IFtdO1xuXHRwcmVGaWx0ZXJzID0gRXhwci5wcmVGaWx0ZXI7XG5cblx0d2hpbGUgKCBzb0ZhciApIHtcblxuXHRcdC8vIENvbW1hIGFuZCBmaXJzdCBydW5cblx0XHRpZiAoICFtYXRjaGVkIHx8IChtYXRjaCA9IHJjb21tYS5leGVjKCBzb0ZhciApKSApIHtcblx0XHRcdGlmICggbWF0Y2ggKSB7XG5cdFx0XHRcdC8vIERvbid0IGNvbnN1bWUgdHJhaWxpbmcgY29tbWFzIGFzIHZhbGlkXG5cdFx0XHRcdHNvRmFyID0gc29GYXIuc2xpY2UoIG1hdGNoWzBdLmxlbmd0aCApIHx8IHNvRmFyO1xuXHRcdFx0fVxuXHRcdFx0Z3JvdXBzLnB1c2goICh0b2tlbnMgPSBbXSkgKTtcblx0XHR9XG5cblx0XHRtYXRjaGVkID0gZmFsc2U7XG5cblx0XHQvLyBDb21iaW5hdG9yc1xuXHRcdGlmICggKG1hdGNoID0gcmNvbWJpbmF0b3JzLmV4ZWMoIHNvRmFyICkpICkge1xuXHRcdFx0bWF0Y2hlZCA9IG1hdGNoLnNoaWZ0KCk7XG5cdFx0XHR0b2tlbnMucHVzaCh7XG5cdFx0XHRcdHZhbHVlOiBtYXRjaGVkLFxuXHRcdFx0XHQvLyBDYXN0IGRlc2NlbmRhbnQgY29tYmluYXRvcnMgdG8gc3BhY2Vcblx0XHRcdFx0dHlwZTogbWF0Y2hbMF0ucmVwbGFjZSggcnRyaW0sIFwiIFwiIClcblx0XHRcdH0pO1xuXHRcdFx0c29GYXIgPSBzb0Zhci5zbGljZSggbWF0Y2hlZC5sZW5ndGggKTtcblx0XHR9XG5cblx0XHQvLyBGaWx0ZXJzXG5cdFx0Zm9yICggdHlwZSBpbiBFeHByLmZpbHRlciApIHtcblx0XHRcdGlmICggKG1hdGNoID0gbWF0Y2hFeHByWyB0eXBlIF0uZXhlYyggc29GYXIgKSkgJiYgKCFwcmVGaWx0ZXJzWyB0eXBlIF0gfHxcblx0XHRcdFx0KG1hdGNoID0gcHJlRmlsdGVyc1sgdHlwZSBdKCBtYXRjaCApKSkgKSB7XG5cdFx0XHRcdG1hdGNoZWQgPSBtYXRjaC5zaGlmdCgpO1xuXHRcdFx0XHR0b2tlbnMucHVzaCh7XG5cdFx0XHRcdFx0dmFsdWU6IG1hdGNoZWQsXG5cdFx0XHRcdFx0dHlwZTogdHlwZSxcblx0XHRcdFx0XHRtYXRjaGVzOiBtYXRjaFxuXHRcdFx0XHR9KTtcblx0XHRcdFx0c29GYXIgPSBzb0Zhci5zbGljZSggbWF0Y2hlZC5sZW5ndGggKTtcblx0XHRcdH1cblx0XHR9XG5cblx0XHRpZiAoICFtYXRjaGVkICkge1xuXHRcdFx0YnJlYWs7XG5cdFx0fVxuXHR9XG5cblx0Ly8gUmV0dXJuIHRoZSBsZW5ndGggb2YgdGhlIGludmFsaWQgZXhjZXNzXG5cdC8vIGlmIHdlJ3JlIGp1c3QgcGFyc2luZ1xuXHQvLyBPdGhlcndpc2UsIHRocm93IGFuIGVycm9yIG9yIHJldHVybiB0b2tlbnNcblx0cmV0dXJuIHBhcnNlT25seSA/XG5cdFx0c29GYXIubGVuZ3RoIDpcblx0XHRzb0ZhciA/XG5cdFx0XHRTaXp6bGUuZXJyb3IoIHNlbGVjdG9yICkgOlxuXHRcdFx0Ly8gQ2FjaGUgdGhlIHRva2Vuc1xuXHRcdFx0dG9rZW5DYWNoZSggc2VsZWN0b3IsIGdyb3VwcyApLnNsaWNlKCAwICk7XG59O1xuXG5mdW5jdGlvbiB0b1NlbGVjdG9yKCB0b2tlbnMgKSB7XG5cdHZhciBpID0gMCxcblx0XHRsZW4gPSB0b2tlbnMubGVuZ3RoLFxuXHRcdHNlbGVjdG9yID0gXCJcIjtcblx0Zm9yICggOyBpIDwgbGVuOyBpKysgKSB7XG5cdFx0c2VsZWN0b3IgKz0gdG9rZW5zW2ldLnZhbHVlO1xuXHR9XG5cdHJldHVybiBzZWxlY3Rvcjtcbn1cblxuZnVuY3Rpb24gYWRkQ29tYmluYXRvciggbWF0Y2hlciwgY29tYmluYXRvciwgYmFzZSApIHtcblx0dmFyIGRpciA9IGNvbWJpbmF0b3IuZGlyLFxuXHRcdGNoZWNrTm9uRWxlbWVudHMgPSBiYXNlICYmIGRpciA9PT0gXCJwYXJlbnROb2RlXCIsXG5cdFx0ZG9uZU5hbWUgPSBkb25lKys7XG5cblx0cmV0dXJuIGNvbWJpbmF0b3IuZmlyc3QgP1xuXHRcdC8vIENoZWNrIGFnYWluc3QgY2xvc2VzdCBhbmNlc3Rvci9wcmVjZWRpbmcgZWxlbWVudFxuXHRcdGZ1bmN0aW9uKCBlbGVtLCBjb250ZXh0LCB4bWwgKSB7XG5cdFx0XHR3aGlsZSAoIChlbGVtID0gZWxlbVsgZGlyIF0pICkge1xuXHRcdFx0XHRpZiAoIGVsZW0ubm9kZVR5cGUgPT09IDEgfHwgY2hlY2tOb25FbGVtZW50cyApIHtcblx0XHRcdFx0XHRyZXR1cm4gbWF0Y2hlciggZWxlbSwgY29udGV4dCwgeG1sICk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9IDpcblxuXHRcdC8vIENoZWNrIGFnYWluc3QgYWxsIGFuY2VzdG9yL3ByZWNlZGluZyBlbGVtZW50c1xuXHRcdGZ1bmN0aW9uKCBlbGVtLCBjb250ZXh0LCB4bWwgKSB7XG5cdFx0XHR2YXIgb2xkQ2FjaGUsIG91dGVyQ2FjaGUsXG5cdFx0XHRcdG5ld0NhY2hlID0gWyBkaXJydW5zLCBkb25lTmFtZSBdO1xuXG5cdFx0XHQvLyBXZSBjYW4ndCBzZXQgYXJiaXRyYXJ5IGRhdGEgb24gWE1MIG5vZGVzLCBzbyB0aGV5IGRvbid0IGJlbmVmaXQgZnJvbSBkaXIgY2FjaGluZ1xuXHRcdFx0aWYgKCB4bWwgKSB7XG5cdFx0XHRcdHdoaWxlICggKGVsZW0gPSBlbGVtWyBkaXIgXSkgKSB7XG5cdFx0XHRcdFx0aWYgKCBlbGVtLm5vZGVUeXBlID09PSAxIHx8IGNoZWNrTm9uRWxlbWVudHMgKSB7XG5cdFx0XHRcdFx0XHRpZiAoIG1hdGNoZXIoIGVsZW0sIGNvbnRleHQsIHhtbCApICkge1xuXHRcdFx0XHRcdFx0XHRyZXR1cm4gdHJ1ZTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdHdoaWxlICggKGVsZW0gPSBlbGVtWyBkaXIgXSkgKSB7XG5cdFx0XHRcdFx0aWYgKCBlbGVtLm5vZGVUeXBlID09PSAxIHx8IGNoZWNrTm9uRWxlbWVudHMgKSB7XG5cdFx0XHRcdFx0XHRvdXRlckNhY2hlID0gZWxlbVsgZXhwYW5kbyBdIHx8IChlbGVtWyBleHBhbmRvIF0gPSB7fSk7XG5cdFx0XHRcdFx0XHRpZiAoIChvbGRDYWNoZSA9IG91dGVyQ2FjaGVbIGRpciBdKSAmJlxuXHRcdFx0XHRcdFx0XHRvbGRDYWNoZVsgMCBdID09PSBkaXJydW5zICYmIG9sZENhY2hlWyAxIF0gPT09IGRvbmVOYW1lICkge1xuXG5cdFx0XHRcdFx0XHRcdC8vIEFzc2lnbiB0byBuZXdDYWNoZSBzbyByZXN1bHRzIGJhY2stcHJvcGFnYXRlIHRvIHByZXZpb3VzIGVsZW1lbnRzXG5cdFx0XHRcdFx0XHRcdHJldHVybiAobmV3Q2FjaGVbIDIgXSA9IG9sZENhY2hlWyAyIF0pO1xuXHRcdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdFx0Ly8gUmV1c2UgbmV3Y2FjaGUgc28gcmVzdWx0cyBiYWNrLXByb3BhZ2F0ZSB0byBwcmV2aW91cyBlbGVtZW50c1xuXHRcdFx0XHRcdFx0XHRvdXRlckNhY2hlWyBkaXIgXSA9IG5ld0NhY2hlO1xuXG5cdFx0XHRcdFx0XHRcdC8vIEEgbWF0Y2ggbWVhbnMgd2UncmUgZG9uZTsgYSBmYWlsIG1lYW5zIHdlIGhhdmUgdG8ga2VlcCBjaGVja2luZ1xuXHRcdFx0XHRcdFx0XHRpZiAoIChuZXdDYWNoZVsgMiBdID0gbWF0Y2hlciggZWxlbSwgY29udGV4dCwgeG1sICkpICkge1xuXHRcdFx0XHRcdFx0XHRcdHJldHVybiB0cnVlO1xuXHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fTtcbn1cblxuZnVuY3Rpb24gZWxlbWVudE1hdGNoZXIoIG1hdGNoZXJzICkge1xuXHRyZXR1cm4gbWF0Y2hlcnMubGVuZ3RoID4gMSA/XG5cdFx0ZnVuY3Rpb24oIGVsZW0sIGNvbnRleHQsIHhtbCApIHtcblx0XHRcdHZhciBpID0gbWF0Y2hlcnMubGVuZ3RoO1xuXHRcdFx0d2hpbGUgKCBpLS0gKSB7XG5cdFx0XHRcdGlmICggIW1hdGNoZXJzW2ldKCBlbGVtLCBjb250ZXh0LCB4bWwgKSApIHtcblx0XHRcdFx0XHRyZXR1cm4gZmFsc2U7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHRcdHJldHVybiB0cnVlO1xuXHRcdH0gOlxuXHRcdG1hdGNoZXJzWzBdO1xufVxuXG5mdW5jdGlvbiBtdWx0aXBsZUNvbnRleHRzKCBzZWxlY3RvciwgY29udGV4dHMsIHJlc3VsdHMgKSB7XG5cdHZhciBpID0gMCxcblx0XHRsZW4gPSBjb250ZXh0cy5sZW5ndGg7XG5cdGZvciAoIDsgaSA8IGxlbjsgaSsrICkge1xuXHRcdFNpenpsZSggc2VsZWN0b3IsIGNvbnRleHRzW2ldLCByZXN1bHRzICk7XG5cdH1cblx0cmV0dXJuIHJlc3VsdHM7XG59XG5cbmZ1bmN0aW9uIGNvbmRlbnNlKCB1bm1hdGNoZWQsIG1hcCwgZmlsdGVyLCBjb250ZXh0LCB4bWwgKSB7XG5cdHZhciBlbGVtLFxuXHRcdG5ld1VubWF0Y2hlZCA9IFtdLFxuXHRcdGkgPSAwLFxuXHRcdGxlbiA9IHVubWF0Y2hlZC5sZW5ndGgsXG5cdFx0bWFwcGVkID0gbWFwICE9IG51bGw7XG5cblx0Zm9yICggOyBpIDwgbGVuOyBpKysgKSB7XG5cdFx0aWYgKCAoZWxlbSA9IHVubWF0Y2hlZFtpXSkgKSB7XG5cdFx0XHRpZiAoICFmaWx0ZXIgfHwgZmlsdGVyKCBlbGVtLCBjb250ZXh0LCB4bWwgKSApIHtcblx0XHRcdFx0bmV3VW5tYXRjaGVkLnB1c2goIGVsZW0gKTtcblx0XHRcdFx0aWYgKCBtYXBwZWQgKSB7XG5cdFx0XHRcdFx0bWFwLnB1c2goIGkgKTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH1cblx0fVxuXG5cdHJldHVybiBuZXdVbm1hdGNoZWQ7XG59XG5cbmZ1bmN0aW9uIHNldE1hdGNoZXIoIHByZUZpbHRlciwgc2VsZWN0b3IsIG1hdGNoZXIsIHBvc3RGaWx0ZXIsIHBvc3RGaW5kZXIsIHBvc3RTZWxlY3RvciApIHtcblx0aWYgKCBwb3N0RmlsdGVyICYmICFwb3N0RmlsdGVyWyBleHBhbmRvIF0gKSB7XG5cdFx0cG9zdEZpbHRlciA9IHNldE1hdGNoZXIoIHBvc3RGaWx0ZXIgKTtcblx0fVxuXHRpZiAoIHBvc3RGaW5kZXIgJiYgIXBvc3RGaW5kZXJbIGV4cGFuZG8gXSApIHtcblx0XHRwb3N0RmluZGVyID0gc2V0TWF0Y2hlciggcG9zdEZpbmRlciwgcG9zdFNlbGVjdG9yICk7XG5cdH1cblx0cmV0dXJuIG1hcmtGdW5jdGlvbihmdW5jdGlvbiggc2VlZCwgcmVzdWx0cywgY29udGV4dCwgeG1sICkge1xuXHRcdHZhciB0ZW1wLCBpLCBlbGVtLFxuXHRcdFx0cHJlTWFwID0gW10sXG5cdFx0XHRwb3N0TWFwID0gW10sXG5cdFx0XHRwcmVleGlzdGluZyA9IHJlc3VsdHMubGVuZ3RoLFxuXG5cdFx0XHQvLyBHZXQgaW5pdGlhbCBlbGVtZW50cyBmcm9tIHNlZWQgb3IgY29udGV4dFxuXHRcdFx0ZWxlbXMgPSBzZWVkIHx8IG11bHRpcGxlQ29udGV4dHMoIHNlbGVjdG9yIHx8IFwiKlwiLCBjb250ZXh0Lm5vZGVUeXBlID8gWyBjb250ZXh0IF0gOiBjb250ZXh0LCBbXSApLFxuXG5cdFx0XHQvLyBQcmVmaWx0ZXIgdG8gZ2V0IG1hdGNoZXIgaW5wdXQsIHByZXNlcnZpbmcgYSBtYXAgZm9yIHNlZWQtcmVzdWx0cyBzeW5jaHJvbml6YXRpb25cblx0XHRcdG1hdGNoZXJJbiA9IHByZUZpbHRlciAmJiAoIHNlZWQgfHwgIXNlbGVjdG9yICkgP1xuXHRcdFx0XHRjb25kZW5zZSggZWxlbXMsIHByZU1hcCwgcHJlRmlsdGVyLCBjb250ZXh0LCB4bWwgKSA6XG5cdFx0XHRcdGVsZW1zLFxuXG5cdFx0XHRtYXRjaGVyT3V0ID0gbWF0Y2hlciA/XG5cdFx0XHRcdC8vIElmIHdlIGhhdmUgYSBwb3N0RmluZGVyLCBvciBmaWx0ZXJlZCBzZWVkLCBvciBub24tc2VlZCBwb3N0RmlsdGVyIG9yIHByZWV4aXN0aW5nIHJlc3VsdHMsXG5cdFx0XHRcdHBvc3RGaW5kZXIgfHwgKCBzZWVkID8gcHJlRmlsdGVyIDogcHJlZXhpc3RpbmcgfHwgcG9zdEZpbHRlciApID9cblxuXHRcdFx0XHRcdC8vIC4uLmludGVybWVkaWF0ZSBwcm9jZXNzaW5nIGlzIG5lY2Vzc2FyeVxuXHRcdFx0XHRcdFtdIDpcblxuXHRcdFx0XHRcdC8vIC4uLm90aGVyd2lzZSB1c2UgcmVzdWx0cyBkaXJlY3RseVxuXHRcdFx0XHRcdHJlc3VsdHMgOlxuXHRcdFx0XHRtYXRjaGVySW47XG5cblx0XHQvLyBGaW5kIHByaW1hcnkgbWF0Y2hlc1xuXHRcdGlmICggbWF0Y2hlciApIHtcblx0XHRcdG1hdGNoZXIoIG1hdGNoZXJJbiwgbWF0Y2hlck91dCwgY29udGV4dCwgeG1sICk7XG5cdFx0fVxuXG5cdFx0Ly8gQXBwbHkgcG9zdEZpbHRlclxuXHRcdGlmICggcG9zdEZpbHRlciApIHtcblx0XHRcdHRlbXAgPSBjb25kZW5zZSggbWF0Y2hlck91dCwgcG9zdE1hcCApO1xuXHRcdFx0cG9zdEZpbHRlciggdGVtcCwgW10sIGNvbnRleHQsIHhtbCApO1xuXG5cdFx0XHQvLyBVbi1tYXRjaCBmYWlsaW5nIGVsZW1lbnRzIGJ5IG1vdmluZyB0aGVtIGJhY2sgdG8gbWF0Y2hlckluXG5cdFx0XHRpID0gdGVtcC5sZW5ndGg7XG5cdFx0XHR3aGlsZSAoIGktLSApIHtcblx0XHRcdFx0aWYgKCAoZWxlbSA9IHRlbXBbaV0pICkge1xuXHRcdFx0XHRcdG1hdGNoZXJPdXRbIHBvc3RNYXBbaV0gXSA9ICEobWF0Y2hlckluWyBwb3N0TWFwW2ldIF0gPSBlbGVtKTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH1cblxuXHRcdGlmICggc2VlZCApIHtcblx0XHRcdGlmICggcG9zdEZpbmRlciB8fCBwcmVGaWx0ZXIgKSB7XG5cdFx0XHRcdGlmICggcG9zdEZpbmRlciApIHtcblx0XHRcdFx0XHQvLyBHZXQgdGhlIGZpbmFsIG1hdGNoZXJPdXQgYnkgY29uZGVuc2luZyB0aGlzIGludGVybWVkaWF0ZSBpbnRvIHBvc3RGaW5kZXIgY29udGV4dHNcblx0XHRcdFx0XHR0ZW1wID0gW107XG5cdFx0XHRcdFx0aSA9IG1hdGNoZXJPdXQubGVuZ3RoO1xuXHRcdFx0XHRcdHdoaWxlICggaS0tICkge1xuXHRcdFx0XHRcdFx0aWYgKCAoZWxlbSA9IG1hdGNoZXJPdXRbaV0pICkge1xuXHRcdFx0XHRcdFx0XHQvLyBSZXN0b3JlIG1hdGNoZXJJbiBzaW5jZSBlbGVtIGlzIG5vdCB5ZXQgYSBmaW5hbCBtYXRjaFxuXHRcdFx0XHRcdFx0XHR0ZW1wLnB1c2goIChtYXRjaGVySW5baV0gPSBlbGVtKSApO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHRwb3N0RmluZGVyKCBudWxsLCAobWF0Y2hlck91dCA9IFtdKSwgdGVtcCwgeG1sICk7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHQvLyBNb3ZlIG1hdGNoZWQgZWxlbWVudHMgZnJvbSBzZWVkIHRvIHJlc3VsdHMgdG8ga2VlcCB0aGVtIHN5bmNocm9uaXplZFxuXHRcdFx0XHRpID0gbWF0Y2hlck91dC5sZW5ndGg7XG5cdFx0XHRcdHdoaWxlICggaS0tICkge1xuXHRcdFx0XHRcdGlmICggKGVsZW0gPSBtYXRjaGVyT3V0W2ldKSAmJlxuXHRcdFx0XHRcdFx0KHRlbXAgPSBwb3N0RmluZGVyID8gaW5kZXhPZiggc2VlZCwgZWxlbSApIDogcHJlTWFwW2ldKSA+IC0xICkge1xuXG5cdFx0XHRcdFx0XHRzZWVkW3RlbXBdID0gIShyZXN1bHRzW3RlbXBdID0gZWxlbSk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cdFx0XHR9XG5cblx0XHQvLyBBZGQgZWxlbWVudHMgdG8gcmVzdWx0cywgdGhyb3VnaCBwb3N0RmluZGVyIGlmIGRlZmluZWRcblx0XHR9IGVsc2Uge1xuXHRcdFx0bWF0Y2hlck91dCA9IGNvbmRlbnNlKFxuXHRcdFx0XHRtYXRjaGVyT3V0ID09PSByZXN1bHRzID9cblx0XHRcdFx0XHRtYXRjaGVyT3V0LnNwbGljZSggcHJlZXhpc3RpbmcsIG1hdGNoZXJPdXQubGVuZ3RoICkgOlxuXHRcdFx0XHRcdG1hdGNoZXJPdXRcblx0XHRcdCk7XG5cdFx0XHRpZiAoIHBvc3RGaW5kZXIgKSB7XG5cdFx0XHRcdHBvc3RGaW5kZXIoIG51bGwsIHJlc3VsdHMsIG1hdGNoZXJPdXQsIHhtbCApO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0cHVzaC5hcHBseSggcmVzdWx0cywgbWF0Y2hlck91dCApO1xuXHRcdFx0fVxuXHRcdH1cblx0fSk7XG59XG5cbmZ1bmN0aW9uIG1hdGNoZXJGcm9tVG9rZW5zKCB0b2tlbnMgKSB7XG5cdHZhciBjaGVja0NvbnRleHQsIG1hdGNoZXIsIGosXG5cdFx0bGVuID0gdG9rZW5zLmxlbmd0aCxcblx0XHRsZWFkaW5nUmVsYXRpdmUgPSBFeHByLnJlbGF0aXZlWyB0b2tlbnNbMF0udHlwZSBdLFxuXHRcdGltcGxpY2l0UmVsYXRpdmUgPSBsZWFkaW5nUmVsYXRpdmUgfHwgRXhwci5yZWxhdGl2ZVtcIiBcIl0sXG5cdFx0aSA9IGxlYWRpbmdSZWxhdGl2ZSA/IDEgOiAwLFxuXG5cdFx0Ly8gVGhlIGZvdW5kYXRpb25hbCBtYXRjaGVyIGVuc3VyZXMgdGhhdCBlbGVtZW50cyBhcmUgcmVhY2hhYmxlIGZyb20gdG9wLWxldmVsIGNvbnRleHQocylcblx0XHRtYXRjaENvbnRleHQgPSBhZGRDb21iaW5hdG9yKCBmdW5jdGlvbiggZWxlbSApIHtcblx0XHRcdHJldHVybiBlbGVtID09PSBjaGVja0NvbnRleHQ7XG5cdFx0fSwgaW1wbGljaXRSZWxhdGl2ZSwgdHJ1ZSApLFxuXHRcdG1hdGNoQW55Q29udGV4dCA9IGFkZENvbWJpbmF0b3IoIGZ1bmN0aW9uKCBlbGVtICkge1xuXHRcdFx0cmV0dXJuIGluZGV4T2YoIGNoZWNrQ29udGV4dCwgZWxlbSApID4gLTE7XG5cdFx0fSwgaW1wbGljaXRSZWxhdGl2ZSwgdHJ1ZSApLFxuXHRcdG1hdGNoZXJzID0gWyBmdW5jdGlvbiggZWxlbSwgY29udGV4dCwgeG1sICkge1xuXHRcdFx0dmFyIHJldCA9ICggIWxlYWRpbmdSZWxhdGl2ZSAmJiAoIHhtbCB8fCBjb250ZXh0ICE9PSBvdXRlcm1vc3RDb250ZXh0ICkgKSB8fCAoXG5cdFx0XHRcdChjaGVja0NvbnRleHQgPSBjb250ZXh0KS5ub2RlVHlwZSA/XG5cdFx0XHRcdFx0bWF0Y2hDb250ZXh0KCBlbGVtLCBjb250ZXh0LCB4bWwgKSA6XG5cdFx0XHRcdFx0bWF0Y2hBbnlDb250ZXh0KCBlbGVtLCBjb250ZXh0LCB4bWwgKSApO1xuXHRcdFx0Ly8gQXZvaWQgaGFuZ2luZyBvbnRvIGVsZW1lbnQgKGlzc3VlICMyOTkpXG5cdFx0XHRjaGVja0NvbnRleHQgPSBudWxsO1xuXHRcdFx0cmV0dXJuIHJldDtcblx0XHR9IF07XG5cblx0Zm9yICggOyBpIDwgbGVuOyBpKysgKSB7XG5cdFx0aWYgKCAobWF0Y2hlciA9IEV4cHIucmVsYXRpdmVbIHRva2Vuc1tpXS50eXBlIF0pICkge1xuXHRcdFx0bWF0Y2hlcnMgPSBbIGFkZENvbWJpbmF0b3IoZWxlbWVudE1hdGNoZXIoIG1hdGNoZXJzICksIG1hdGNoZXIpIF07XG5cdFx0fSBlbHNlIHtcblx0XHRcdG1hdGNoZXIgPSBFeHByLmZpbHRlclsgdG9rZW5zW2ldLnR5cGUgXS5hcHBseSggbnVsbCwgdG9rZW5zW2ldLm1hdGNoZXMgKTtcblxuXHRcdFx0Ly8gUmV0dXJuIHNwZWNpYWwgdXBvbiBzZWVpbmcgYSBwb3NpdGlvbmFsIG1hdGNoZXJcblx0XHRcdGlmICggbWF0Y2hlclsgZXhwYW5kbyBdICkge1xuXHRcdFx0XHQvLyBGaW5kIHRoZSBuZXh0IHJlbGF0aXZlIG9wZXJhdG9yIChpZiBhbnkpIGZvciBwcm9wZXIgaGFuZGxpbmdcblx0XHRcdFx0aiA9ICsraTtcblx0XHRcdFx0Zm9yICggOyBqIDwgbGVuOyBqKysgKSB7XG5cdFx0XHRcdFx0aWYgKCBFeHByLnJlbGF0aXZlWyB0b2tlbnNbal0udHlwZSBdICkge1xuXHRcdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cdFx0XHRcdHJldHVybiBzZXRNYXRjaGVyKFxuXHRcdFx0XHRcdGkgPiAxICYmIGVsZW1lbnRNYXRjaGVyKCBtYXRjaGVycyApLFxuXHRcdFx0XHRcdGkgPiAxICYmIHRvU2VsZWN0b3IoXG5cdFx0XHRcdFx0XHQvLyBJZiB0aGUgcHJlY2VkaW5nIHRva2VuIHdhcyBhIGRlc2NlbmRhbnQgY29tYmluYXRvciwgaW5zZXJ0IGFuIGltcGxpY2l0IGFueS1lbGVtZW50IGAqYFxuXHRcdFx0XHRcdFx0dG9rZW5zLnNsaWNlKCAwLCBpIC0gMSApLmNvbmNhdCh7IHZhbHVlOiB0b2tlbnNbIGkgLSAyIF0udHlwZSA9PT0gXCIgXCIgPyBcIipcIiA6IFwiXCIgfSlcblx0XHRcdFx0XHQpLnJlcGxhY2UoIHJ0cmltLCBcIiQxXCIgKSxcblx0XHRcdFx0XHRtYXRjaGVyLFxuXHRcdFx0XHRcdGkgPCBqICYmIG1hdGNoZXJGcm9tVG9rZW5zKCB0b2tlbnMuc2xpY2UoIGksIGogKSApLFxuXHRcdFx0XHRcdGogPCBsZW4gJiYgbWF0Y2hlckZyb21Ub2tlbnMoICh0b2tlbnMgPSB0b2tlbnMuc2xpY2UoIGogKSkgKSxcblx0XHRcdFx0XHRqIDwgbGVuICYmIHRvU2VsZWN0b3IoIHRva2VucyApXG5cdFx0XHRcdCk7XG5cdFx0XHR9XG5cdFx0XHRtYXRjaGVycy5wdXNoKCBtYXRjaGVyICk7XG5cdFx0fVxuXHR9XG5cblx0cmV0dXJuIGVsZW1lbnRNYXRjaGVyKCBtYXRjaGVycyApO1xufVxuXG5mdW5jdGlvbiBtYXRjaGVyRnJvbUdyb3VwTWF0Y2hlcnMoIGVsZW1lbnRNYXRjaGVycywgc2V0TWF0Y2hlcnMgKSB7XG5cdHZhciBieVNldCA9IHNldE1hdGNoZXJzLmxlbmd0aCA+IDAsXG5cdFx0YnlFbGVtZW50ID0gZWxlbWVudE1hdGNoZXJzLmxlbmd0aCA+IDAsXG5cdFx0c3VwZXJNYXRjaGVyID0gZnVuY3Rpb24oIHNlZWQsIGNvbnRleHQsIHhtbCwgcmVzdWx0cywgb3V0ZXJtb3N0ICkge1xuXHRcdFx0dmFyIGVsZW0sIGosIG1hdGNoZXIsXG5cdFx0XHRcdG1hdGNoZWRDb3VudCA9IDAsXG5cdFx0XHRcdGkgPSBcIjBcIixcblx0XHRcdFx0dW5tYXRjaGVkID0gc2VlZCAmJiBbXSxcblx0XHRcdFx0c2V0TWF0Y2hlZCA9IFtdLFxuXHRcdFx0XHRjb250ZXh0QmFja3VwID0gb3V0ZXJtb3N0Q29udGV4dCxcblx0XHRcdFx0Ly8gV2UgbXVzdCBhbHdheXMgaGF2ZSBlaXRoZXIgc2VlZCBlbGVtZW50cyBvciBvdXRlcm1vc3QgY29udGV4dFxuXHRcdFx0XHRlbGVtcyA9IHNlZWQgfHwgYnlFbGVtZW50ICYmIEV4cHIuZmluZFtcIlRBR1wiXSggXCIqXCIsIG91dGVybW9zdCApLFxuXHRcdFx0XHQvLyBVc2UgaW50ZWdlciBkaXJydW5zIGlmZiB0aGlzIGlzIHRoZSBvdXRlcm1vc3QgbWF0Y2hlclxuXHRcdFx0XHRkaXJydW5zVW5pcXVlID0gKGRpcnJ1bnMgKz0gY29udGV4dEJhY2t1cCA9PSBudWxsID8gMSA6IE1hdGgucmFuZG9tKCkgfHwgMC4xKSxcblx0XHRcdFx0bGVuID0gZWxlbXMubGVuZ3RoO1xuXG5cdFx0XHRpZiAoIG91dGVybW9zdCApIHtcblx0XHRcdFx0b3V0ZXJtb3N0Q29udGV4dCA9IGNvbnRleHQgIT09IGRvY3VtZW50ICYmIGNvbnRleHQ7XG5cdFx0XHR9XG5cblx0XHRcdC8vIEFkZCBlbGVtZW50cyBwYXNzaW5nIGVsZW1lbnRNYXRjaGVycyBkaXJlY3RseSB0byByZXN1bHRzXG5cdFx0XHQvLyBLZWVwIGBpYCBhIHN0cmluZyBpZiB0aGVyZSBhcmUgbm8gZWxlbWVudHMgc28gYG1hdGNoZWRDb3VudGAgd2lsbCBiZSBcIjAwXCIgYmVsb3dcblx0XHRcdC8vIFN1cHBvcnQ6IElFPDksIFNhZmFyaVxuXHRcdFx0Ly8gVG9sZXJhdGUgTm9kZUxpc3QgcHJvcGVydGllcyAoSUU6IFwibGVuZ3RoXCI7IFNhZmFyaTogPG51bWJlcj4pIG1hdGNoaW5nIGVsZW1lbnRzIGJ5IGlkXG5cdFx0XHRmb3IgKCA7IGkgIT09IGxlbiAmJiAoZWxlbSA9IGVsZW1zW2ldKSAhPSBudWxsOyBpKysgKSB7XG5cdFx0XHRcdGlmICggYnlFbGVtZW50ICYmIGVsZW0gKSB7XG5cdFx0XHRcdFx0aiA9IDA7XG5cdFx0XHRcdFx0d2hpbGUgKCAobWF0Y2hlciA9IGVsZW1lbnRNYXRjaGVyc1tqKytdKSApIHtcblx0XHRcdFx0XHRcdGlmICggbWF0Y2hlciggZWxlbSwgY29udGV4dCwgeG1sICkgKSB7XG5cdFx0XHRcdFx0XHRcdHJlc3VsdHMucHVzaCggZWxlbSApO1xuXHRcdFx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0aWYgKCBvdXRlcm1vc3QgKSB7XG5cdFx0XHRcdFx0XHRkaXJydW5zID0gZGlycnVuc1VuaXF1ZTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblxuXHRcdFx0XHQvLyBUcmFjayB1bm1hdGNoZWQgZWxlbWVudHMgZm9yIHNldCBmaWx0ZXJzXG5cdFx0XHRcdGlmICggYnlTZXQgKSB7XG5cdFx0XHRcdFx0Ly8gVGhleSB3aWxsIGhhdmUgZ29uZSB0aHJvdWdoIGFsbCBwb3NzaWJsZSBtYXRjaGVyc1xuXHRcdFx0XHRcdGlmICggKGVsZW0gPSAhbWF0Y2hlciAmJiBlbGVtKSApIHtcblx0XHRcdFx0XHRcdG1hdGNoZWRDb3VudC0tO1xuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdC8vIExlbmd0aGVuIHRoZSBhcnJheSBmb3IgZXZlcnkgZWxlbWVudCwgbWF0Y2hlZCBvciBub3Rcblx0XHRcdFx0XHRpZiAoIHNlZWQgKSB7XG5cdFx0XHRcdFx0XHR1bm1hdGNoZWQucHVzaCggZWxlbSApO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0fVxuXG5cdFx0XHQvLyBBcHBseSBzZXQgZmlsdGVycyB0byB1bm1hdGNoZWQgZWxlbWVudHNcblx0XHRcdG1hdGNoZWRDb3VudCArPSBpO1xuXHRcdFx0aWYgKCBieVNldCAmJiBpICE9PSBtYXRjaGVkQ291bnQgKSB7XG5cdFx0XHRcdGogPSAwO1xuXHRcdFx0XHR3aGlsZSAoIChtYXRjaGVyID0gc2V0TWF0Y2hlcnNbaisrXSkgKSB7XG5cdFx0XHRcdFx0bWF0Y2hlciggdW5tYXRjaGVkLCBzZXRNYXRjaGVkLCBjb250ZXh0LCB4bWwgKTtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdGlmICggc2VlZCApIHtcblx0XHRcdFx0XHQvLyBSZWludGVncmF0ZSBlbGVtZW50IG1hdGNoZXMgdG8gZWxpbWluYXRlIHRoZSBuZWVkIGZvciBzb3J0aW5nXG5cdFx0XHRcdFx0aWYgKCBtYXRjaGVkQ291bnQgPiAwICkge1xuXHRcdFx0XHRcdFx0d2hpbGUgKCBpLS0gKSB7XG5cdFx0XHRcdFx0XHRcdGlmICggISh1bm1hdGNoZWRbaV0gfHwgc2V0TWF0Y2hlZFtpXSkgKSB7XG5cdFx0XHRcdFx0XHRcdFx0c2V0TWF0Y2hlZFtpXSA9IHBvcC5jYWxsKCByZXN1bHRzICk7XG5cdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHQvLyBEaXNjYXJkIGluZGV4IHBsYWNlaG9sZGVyIHZhbHVlcyB0byBnZXQgb25seSBhY3R1YWwgbWF0Y2hlc1xuXHRcdFx0XHRcdHNldE1hdGNoZWQgPSBjb25kZW5zZSggc2V0TWF0Y2hlZCApO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0Ly8gQWRkIG1hdGNoZXMgdG8gcmVzdWx0c1xuXHRcdFx0XHRwdXNoLmFwcGx5KCByZXN1bHRzLCBzZXRNYXRjaGVkICk7XG5cblx0XHRcdFx0Ly8gU2VlZGxlc3Mgc2V0IG1hdGNoZXMgc3VjY2VlZGluZyBtdWx0aXBsZSBzdWNjZXNzZnVsIG1hdGNoZXJzIHN0aXB1bGF0ZSBzb3J0aW5nXG5cdFx0XHRcdGlmICggb3V0ZXJtb3N0ICYmICFzZWVkICYmIHNldE1hdGNoZWQubGVuZ3RoID4gMCAmJlxuXHRcdFx0XHRcdCggbWF0Y2hlZENvdW50ICsgc2V0TWF0Y2hlcnMubGVuZ3RoICkgPiAxICkge1xuXG5cdFx0XHRcdFx0U2l6emxlLnVuaXF1ZVNvcnQoIHJlc3VsdHMgKTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXG5cdFx0XHQvLyBPdmVycmlkZSBtYW5pcHVsYXRpb24gb2YgZ2xvYmFscyBieSBuZXN0ZWQgbWF0Y2hlcnNcblx0XHRcdGlmICggb3V0ZXJtb3N0ICkge1xuXHRcdFx0XHRkaXJydW5zID0gZGlycnVuc1VuaXF1ZTtcblx0XHRcdFx0b3V0ZXJtb3N0Q29udGV4dCA9IGNvbnRleHRCYWNrdXA7XG5cdFx0XHR9XG5cblx0XHRcdHJldHVybiB1bm1hdGNoZWQ7XG5cdFx0fTtcblxuXHRyZXR1cm4gYnlTZXQgP1xuXHRcdG1hcmtGdW5jdGlvbiggc3VwZXJNYXRjaGVyICkgOlxuXHRcdHN1cGVyTWF0Y2hlcjtcbn1cblxuY29tcGlsZSA9IFNpenpsZS5jb21waWxlID0gZnVuY3Rpb24oIHNlbGVjdG9yLCBtYXRjaCAvKiBJbnRlcm5hbCBVc2UgT25seSAqLyApIHtcblx0dmFyIGksXG5cdFx0c2V0TWF0Y2hlcnMgPSBbXSxcblx0XHRlbGVtZW50TWF0Y2hlcnMgPSBbXSxcblx0XHRjYWNoZWQgPSBjb21waWxlckNhY2hlWyBzZWxlY3RvciArIFwiIFwiIF07XG5cblx0aWYgKCAhY2FjaGVkICkge1xuXHRcdC8vIEdlbmVyYXRlIGEgZnVuY3Rpb24gb2YgcmVjdXJzaXZlIGZ1bmN0aW9ucyB0aGF0IGNhbiBiZSB1c2VkIHRvIGNoZWNrIGVhY2ggZWxlbWVudFxuXHRcdGlmICggIW1hdGNoICkge1xuXHRcdFx0bWF0Y2ggPSB0b2tlbml6ZSggc2VsZWN0b3IgKTtcblx0XHR9XG5cdFx0aSA9IG1hdGNoLmxlbmd0aDtcblx0XHR3aGlsZSAoIGktLSApIHtcblx0XHRcdGNhY2hlZCA9IG1hdGNoZXJGcm9tVG9rZW5zKCBtYXRjaFtpXSApO1xuXHRcdFx0aWYgKCBjYWNoZWRbIGV4cGFuZG8gXSApIHtcblx0XHRcdFx0c2V0TWF0Y2hlcnMucHVzaCggY2FjaGVkICk7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRlbGVtZW50TWF0Y2hlcnMucHVzaCggY2FjaGVkICk7XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0Ly8gQ2FjaGUgdGhlIGNvbXBpbGVkIGZ1bmN0aW9uXG5cdFx0Y2FjaGVkID0gY29tcGlsZXJDYWNoZSggc2VsZWN0b3IsIG1hdGNoZXJGcm9tR3JvdXBNYXRjaGVycyggZWxlbWVudE1hdGNoZXJzLCBzZXRNYXRjaGVycyApICk7XG5cblx0XHQvLyBTYXZlIHNlbGVjdG9yIGFuZCB0b2tlbml6YXRpb25cblx0XHRjYWNoZWQuc2VsZWN0b3IgPSBzZWxlY3Rvcjtcblx0fVxuXHRyZXR1cm4gY2FjaGVkO1xufTtcblxuLyoqXG4gKiBBIGxvdy1sZXZlbCBzZWxlY3Rpb24gZnVuY3Rpb24gdGhhdCB3b3JrcyB3aXRoIFNpenpsZSdzIGNvbXBpbGVkXG4gKiAgc2VsZWN0b3IgZnVuY3Rpb25zXG4gKiBAcGFyYW0ge1N0cmluZ3xGdW5jdGlvbn0gc2VsZWN0b3IgQSBzZWxlY3RvciBvciBhIHByZS1jb21waWxlZFxuICogIHNlbGVjdG9yIGZ1bmN0aW9uIGJ1aWx0IHdpdGggU2l6emxlLmNvbXBpbGVcbiAqIEBwYXJhbSB7RWxlbWVudH0gY29udGV4dFxuICogQHBhcmFtIHtBcnJheX0gW3Jlc3VsdHNdXG4gKiBAcGFyYW0ge0FycmF5fSBbc2VlZF0gQSBzZXQgb2YgZWxlbWVudHMgdG8gbWF0Y2ggYWdhaW5zdFxuICovXG5zZWxlY3QgPSBTaXp6bGUuc2VsZWN0ID0gZnVuY3Rpb24oIHNlbGVjdG9yLCBjb250ZXh0LCByZXN1bHRzLCBzZWVkICkge1xuXHR2YXIgaSwgdG9rZW5zLCB0b2tlbiwgdHlwZSwgZmluZCxcblx0XHRjb21waWxlZCA9IHR5cGVvZiBzZWxlY3RvciA9PT0gXCJmdW5jdGlvblwiICYmIHNlbGVjdG9yLFxuXHRcdG1hdGNoID0gIXNlZWQgJiYgdG9rZW5pemUoIChzZWxlY3RvciA9IGNvbXBpbGVkLnNlbGVjdG9yIHx8IHNlbGVjdG9yKSApO1xuXG5cdHJlc3VsdHMgPSByZXN1bHRzIHx8IFtdO1xuXG5cdC8vIFRyeSB0byBtaW5pbWl6ZSBvcGVyYXRpb25zIGlmIHRoZXJlIGlzIG5vIHNlZWQgYW5kIG9ubHkgb25lIGdyb3VwXG5cdGlmICggbWF0Y2gubGVuZ3RoID09PSAxICkge1xuXG5cdFx0Ly8gVGFrZSBhIHNob3J0Y3V0IGFuZCBzZXQgdGhlIGNvbnRleHQgaWYgdGhlIHJvb3Qgc2VsZWN0b3IgaXMgYW4gSURcblx0XHR0b2tlbnMgPSBtYXRjaFswXSA9IG1hdGNoWzBdLnNsaWNlKCAwICk7XG5cdFx0aWYgKCB0b2tlbnMubGVuZ3RoID4gMiAmJiAodG9rZW4gPSB0b2tlbnNbMF0pLnR5cGUgPT09IFwiSURcIiAmJlxuXHRcdFx0XHRzdXBwb3J0LmdldEJ5SWQgJiYgY29udGV4dC5ub2RlVHlwZSA9PT0gOSAmJiBkb2N1bWVudElzSFRNTCAmJlxuXHRcdFx0XHRFeHByLnJlbGF0aXZlWyB0b2tlbnNbMV0udHlwZSBdICkge1xuXG5cdFx0XHRjb250ZXh0ID0gKCBFeHByLmZpbmRbXCJJRFwiXSggdG9rZW4ubWF0Y2hlc1swXS5yZXBsYWNlKHJ1bmVzY2FwZSwgZnVuZXNjYXBlKSwgY29udGV4dCApIHx8IFtdIClbMF07XG5cdFx0XHRpZiAoICFjb250ZXh0ICkge1xuXHRcdFx0XHRyZXR1cm4gcmVzdWx0cztcblxuXHRcdFx0Ly8gUHJlY29tcGlsZWQgbWF0Y2hlcnMgd2lsbCBzdGlsbCB2ZXJpZnkgYW5jZXN0cnksIHNvIHN0ZXAgdXAgYSBsZXZlbFxuXHRcdFx0fSBlbHNlIGlmICggY29tcGlsZWQgKSB7XG5cdFx0XHRcdGNvbnRleHQgPSBjb250ZXh0LnBhcmVudE5vZGU7XG5cdFx0XHR9XG5cblx0XHRcdHNlbGVjdG9yID0gc2VsZWN0b3Iuc2xpY2UoIHRva2Vucy5zaGlmdCgpLnZhbHVlLmxlbmd0aCApO1xuXHRcdH1cblxuXHRcdC8vIEZldGNoIGEgc2VlZCBzZXQgZm9yIHJpZ2h0LXRvLWxlZnQgbWF0Y2hpbmdcblx0XHRpID0gbWF0Y2hFeHByW1wibmVlZHNDb250ZXh0XCJdLnRlc3QoIHNlbGVjdG9yICkgPyAwIDogdG9rZW5zLmxlbmd0aDtcblx0XHR3aGlsZSAoIGktLSApIHtcblx0XHRcdHRva2VuID0gdG9rZW5zW2ldO1xuXG5cdFx0XHQvLyBBYm9ydCBpZiB3ZSBoaXQgYSBjb21iaW5hdG9yXG5cdFx0XHRpZiAoIEV4cHIucmVsYXRpdmVbICh0eXBlID0gdG9rZW4udHlwZSkgXSApIHtcblx0XHRcdFx0YnJlYWs7XG5cdFx0XHR9XG5cdFx0XHRpZiAoIChmaW5kID0gRXhwci5maW5kWyB0eXBlIF0pICkge1xuXHRcdFx0XHQvLyBTZWFyY2gsIGV4cGFuZGluZyBjb250ZXh0IGZvciBsZWFkaW5nIHNpYmxpbmcgY29tYmluYXRvcnNcblx0XHRcdFx0aWYgKCAoc2VlZCA9IGZpbmQoXG5cdFx0XHRcdFx0dG9rZW4ubWF0Y2hlc1swXS5yZXBsYWNlKCBydW5lc2NhcGUsIGZ1bmVzY2FwZSApLFxuXHRcdFx0XHRcdHJzaWJsaW5nLnRlc3QoIHRva2Vuc1swXS50eXBlICkgJiYgdGVzdENvbnRleHQoIGNvbnRleHQucGFyZW50Tm9kZSApIHx8IGNvbnRleHRcblx0XHRcdFx0KSkgKSB7XG5cblx0XHRcdFx0XHQvLyBJZiBzZWVkIGlzIGVtcHR5IG9yIG5vIHRva2VucyByZW1haW4sIHdlIGNhbiByZXR1cm4gZWFybHlcblx0XHRcdFx0XHR0b2tlbnMuc3BsaWNlKCBpLCAxICk7XG5cdFx0XHRcdFx0c2VsZWN0b3IgPSBzZWVkLmxlbmd0aCAmJiB0b1NlbGVjdG9yKCB0b2tlbnMgKTtcblx0XHRcdFx0XHRpZiAoICFzZWxlY3RvciApIHtcblx0XHRcdFx0XHRcdHB1c2guYXBwbHkoIHJlc3VsdHMsIHNlZWQgKTtcblx0XHRcdFx0XHRcdHJldHVybiByZXN1bHRzO1xuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fVxuXHR9XG5cblx0Ly8gQ29tcGlsZSBhbmQgZXhlY3V0ZSBhIGZpbHRlcmluZyBmdW5jdGlvbiBpZiBvbmUgaXMgbm90IHByb3ZpZGVkXG5cdC8vIFByb3ZpZGUgYG1hdGNoYCB0byBhdm9pZCByZXRva2VuaXphdGlvbiBpZiB3ZSBtb2RpZmllZCB0aGUgc2VsZWN0b3IgYWJvdmVcblx0KCBjb21waWxlZCB8fCBjb21waWxlKCBzZWxlY3RvciwgbWF0Y2ggKSApKFxuXHRcdHNlZWQsXG5cdFx0Y29udGV4dCxcblx0XHQhZG9jdW1lbnRJc0hUTUwsXG5cdFx0cmVzdWx0cyxcblx0XHRyc2libGluZy50ZXN0KCBzZWxlY3RvciApICYmIHRlc3RDb250ZXh0KCBjb250ZXh0LnBhcmVudE5vZGUgKSB8fCBjb250ZXh0XG5cdCk7XG5cdHJldHVybiByZXN1bHRzO1xufTtcblxuLy8gT25lLXRpbWUgYXNzaWdubWVudHNcblxuLy8gU29ydCBzdGFiaWxpdHlcbnN1cHBvcnQuc29ydFN0YWJsZSA9IGV4cGFuZG8uc3BsaXQoXCJcIikuc29ydCggc29ydE9yZGVyICkuam9pbihcIlwiKSA9PT0gZXhwYW5kbztcblxuLy8gU3VwcG9ydDogQ2hyb21lIDE0LTM1K1xuLy8gQWx3YXlzIGFzc3VtZSBkdXBsaWNhdGVzIGlmIHRoZXkgYXJlbid0IHBhc3NlZCB0byB0aGUgY29tcGFyaXNvbiBmdW5jdGlvblxuc3VwcG9ydC5kZXRlY3REdXBsaWNhdGVzID0gISFoYXNEdXBsaWNhdGU7XG5cbi8vIEluaXRpYWxpemUgYWdhaW5zdCB0aGUgZGVmYXVsdCBkb2N1bWVudFxuc2V0RG9jdW1lbnQoKTtcblxuLy8gU3VwcG9ydDogV2Via2l0PDUzNy4zMiAtIFNhZmFyaSA2LjAuMy9DaHJvbWUgMjUgKGZpeGVkIGluIENocm9tZSAyNylcbi8vIERldGFjaGVkIG5vZGVzIGNvbmZvdW5kaW5nbHkgZm9sbG93ICplYWNoIG90aGVyKlxuc3VwcG9ydC5zb3J0RGV0YWNoZWQgPSBhc3NlcnQoZnVuY3Rpb24oIGRpdjEgKSB7XG5cdC8vIFNob3VsZCByZXR1cm4gMSwgYnV0IHJldHVybnMgNCAoZm9sbG93aW5nKVxuXHRyZXR1cm4gZGl2MS5jb21wYXJlRG9jdW1lbnRQb3NpdGlvbiggZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKSApICYgMTtcbn0pO1xuXG4vLyBTdXBwb3J0OiBJRTw4XG4vLyBQcmV2ZW50IGF0dHJpYnV0ZS9wcm9wZXJ0eSBcImludGVycG9sYXRpb25cIlxuLy8gaHR0cDovL21zZG4ubWljcm9zb2Z0LmNvbS9lbi11cy9saWJyYXJ5L21zNTM2NDI5JTI4VlMuODUlMjkuYXNweFxuaWYgKCAhYXNzZXJ0KGZ1bmN0aW9uKCBkaXYgKSB7XG5cdGRpdi5pbm5lckhUTUwgPSBcIjxhIGhyZWY9JyMnPjwvYT5cIjtcblx0cmV0dXJuIGRpdi5maXJzdENoaWxkLmdldEF0dHJpYnV0ZShcImhyZWZcIikgPT09IFwiI1wiIDtcbn0pICkge1xuXHRhZGRIYW5kbGUoIFwidHlwZXxocmVmfGhlaWdodHx3aWR0aFwiLCBmdW5jdGlvbiggZWxlbSwgbmFtZSwgaXNYTUwgKSB7XG5cdFx0aWYgKCAhaXNYTUwgKSB7XG5cdFx0XHRyZXR1cm4gZWxlbS5nZXRBdHRyaWJ1dGUoIG5hbWUsIG5hbWUudG9Mb3dlckNhc2UoKSA9PT0gXCJ0eXBlXCIgPyAxIDogMiApO1xuXHRcdH1cblx0fSk7XG59XG5cbi8vIFN1cHBvcnQ6IElFPDlcbi8vIFVzZSBkZWZhdWx0VmFsdWUgaW4gcGxhY2Ugb2YgZ2V0QXR0cmlidXRlKFwidmFsdWVcIilcbmlmICggIXN1cHBvcnQuYXR0cmlidXRlcyB8fCAhYXNzZXJ0KGZ1bmN0aW9uKCBkaXYgKSB7XG5cdGRpdi5pbm5lckhUTUwgPSBcIjxpbnB1dC8+XCI7XG5cdGRpdi5maXJzdENoaWxkLnNldEF0dHJpYnV0ZSggXCJ2YWx1ZVwiLCBcIlwiICk7XG5cdHJldHVybiBkaXYuZmlyc3RDaGlsZC5nZXRBdHRyaWJ1dGUoIFwidmFsdWVcIiApID09PSBcIlwiO1xufSkgKSB7XG5cdGFkZEhhbmRsZSggXCJ2YWx1ZVwiLCBmdW5jdGlvbiggZWxlbSwgbmFtZSwgaXNYTUwgKSB7XG5cdFx0aWYgKCAhaXNYTUwgJiYgZWxlbS5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpID09PSBcImlucHV0XCIgKSB7XG5cdFx0XHRyZXR1cm4gZWxlbS5kZWZhdWx0VmFsdWU7XG5cdFx0fVxuXHR9KTtcbn1cblxuLy8gU3VwcG9ydDogSUU8OVxuLy8gVXNlIGdldEF0dHJpYnV0ZU5vZGUgdG8gZmV0Y2ggYm9vbGVhbnMgd2hlbiBnZXRBdHRyaWJ1dGUgbGllc1xuaWYgKCAhYXNzZXJ0KGZ1bmN0aW9uKCBkaXYgKSB7XG5cdHJldHVybiBkaXYuZ2V0QXR0cmlidXRlKFwiZGlzYWJsZWRcIikgPT0gbnVsbDtcbn0pICkge1xuXHRhZGRIYW5kbGUoIGJvb2xlYW5zLCBmdW5jdGlvbiggZWxlbSwgbmFtZSwgaXNYTUwgKSB7XG5cdFx0dmFyIHZhbDtcblx0XHRpZiAoICFpc1hNTCApIHtcblx0XHRcdHJldHVybiBlbGVtWyBuYW1lIF0gPT09IHRydWUgPyBuYW1lLnRvTG93ZXJDYXNlKCkgOlxuXHRcdFx0XHRcdCh2YWwgPSBlbGVtLmdldEF0dHJpYnV0ZU5vZGUoIG5hbWUgKSkgJiYgdmFsLnNwZWNpZmllZCA/XG5cdFx0XHRcdFx0dmFsLnZhbHVlIDpcblx0XHRcdFx0bnVsbDtcblx0XHR9XG5cdH0pO1xufVxuXG5yZXR1cm4gU2l6emxlO1xuXG59KSggd2luZG93ICk7XG5cblxuXG5qUXVlcnkuZmluZCA9IFNpenpsZTtcbmpRdWVyeS5leHByID0gU2l6emxlLnNlbGVjdG9ycztcbmpRdWVyeS5leHByW1wiOlwiXSA9IGpRdWVyeS5leHByLnBzZXVkb3M7XG5qUXVlcnkudW5pcXVlID0gU2l6emxlLnVuaXF1ZVNvcnQ7XG5qUXVlcnkudGV4dCA9IFNpenpsZS5nZXRUZXh0O1xualF1ZXJ5LmlzWE1MRG9jID0gU2l6emxlLmlzWE1MO1xualF1ZXJ5LmNvbnRhaW5zID0gU2l6emxlLmNvbnRhaW5zO1xuXG5cblxudmFyIHJuZWVkc0NvbnRleHQgPSBqUXVlcnkuZXhwci5tYXRjaC5uZWVkc0NvbnRleHQ7XG5cbnZhciByc2luZ2xlVGFnID0gKC9ePChcXHcrKVxccypcXC8/Pig/OjxcXC9cXDE+fCkkLyk7XG5cblxuXG52YXIgcmlzU2ltcGxlID0gL14uW146I1xcW1xcLixdKiQvO1xuXG4vLyBJbXBsZW1lbnQgdGhlIGlkZW50aWNhbCBmdW5jdGlvbmFsaXR5IGZvciBmaWx0ZXIgYW5kIG5vdFxuZnVuY3Rpb24gd2lubm93KCBlbGVtZW50cywgcXVhbGlmaWVyLCBub3QgKSB7XG5cdGlmICggalF1ZXJ5LmlzRnVuY3Rpb24oIHF1YWxpZmllciApICkge1xuXHRcdHJldHVybiBqUXVlcnkuZ3JlcCggZWxlbWVudHMsIGZ1bmN0aW9uKCBlbGVtLCBpICkge1xuXHRcdFx0LyoganNoaW50IC1XMDE4ICovXG5cdFx0XHRyZXR1cm4gISFxdWFsaWZpZXIuY2FsbCggZWxlbSwgaSwgZWxlbSApICE9PSBub3Q7XG5cdFx0fSk7XG5cblx0fVxuXG5cdGlmICggcXVhbGlmaWVyLm5vZGVUeXBlICkge1xuXHRcdHJldHVybiBqUXVlcnkuZ3JlcCggZWxlbWVudHMsIGZ1bmN0aW9uKCBlbGVtICkge1xuXHRcdFx0cmV0dXJuICggZWxlbSA9PT0gcXVhbGlmaWVyICkgIT09IG5vdDtcblx0XHR9KTtcblxuXHR9XG5cblx0aWYgKCB0eXBlb2YgcXVhbGlmaWVyID09PSBcInN0cmluZ1wiICkge1xuXHRcdGlmICggcmlzU2ltcGxlLnRlc3QoIHF1YWxpZmllciApICkge1xuXHRcdFx0cmV0dXJuIGpRdWVyeS5maWx0ZXIoIHF1YWxpZmllciwgZWxlbWVudHMsIG5vdCApO1xuXHRcdH1cblxuXHRcdHF1YWxpZmllciA9IGpRdWVyeS5maWx0ZXIoIHF1YWxpZmllciwgZWxlbWVudHMgKTtcblx0fVxuXG5cdHJldHVybiBqUXVlcnkuZ3JlcCggZWxlbWVudHMsIGZ1bmN0aW9uKCBlbGVtICkge1xuXHRcdHJldHVybiAoIGluZGV4T2YuY2FsbCggcXVhbGlmaWVyLCBlbGVtICkgPj0gMCApICE9PSBub3Q7XG5cdH0pO1xufVxuXG5qUXVlcnkuZmlsdGVyID0gZnVuY3Rpb24oIGV4cHIsIGVsZW1zLCBub3QgKSB7XG5cdHZhciBlbGVtID0gZWxlbXNbIDAgXTtcblxuXHRpZiAoIG5vdCApIHtcblx0XHRleHByID0gXCI6bm90KFwiICsgZXhwciArIFwiKVwiO1xuXHR9XG5cblx0cmV0dXJuIGVsZW1zLmxlbmd0aCA9PT0gMSAmJiBlbGVtLm5vZGVUeXBlID09PSAxID9cblx0XHRqUXVlcnkuZmluZC5tYXRjaGVzU2VsZWN0b3IoIGVsZW0sIGV4cHIgKSA/IFsgZWxlbSBdIDogW10gOlxuXHRcdGpRdWVyeS5maW5kLm1hdGNoZXMoIGV4cHIsIGpRdWVyeS5ncmVwKCBlbGVtcywgZnVuY3Rpb24oIGVsZW0gKSB7XG5cdFx0XHRyZXR1cm4gZWxlbS5ub2RlVHlwZSA9PT0gMTtcblx0XHR9KSk7XG59O1xuXG5qUXVlcnkuZm4uZXh0ZW5kKHtcblx0ZmluZDogZnVuY3Rpb24oIHNlbGVjdG9yICkge1xuXHRcdHZhciBpLFxuXHRcdFx0bGVuID0gdGhpcy5sZW5ndGgsXG5cdFx0XHRyZXQgPSBbXSxcblx0XHRcdHNlbGYgPSB0aGlzO1xuXG5cdFx0aWYgKCB0eXBlb2Ygc2VsZWN0b3IgIT09IFwic3RyaW5nXCIgKSB7XG5cdFx0XHRyZXR1cm4gdGhpcy5wdXNoU3RhY2soIGpRdWVyeSggc2VsZWN0b3IgKS5maWx0ZXIoZnVuY3Rpb24oKSB7XG5cdFx0XHRcdGZvciAoIGkgPSAwOyBpIDwgbGVuOyBpKysgKSB7XG5cdFx0XHRcdFx0aWYgKCBqUXVlcnkuY29udGFpbnMoIHNlbGZbIGkgXSwgdGhpcyApICkge1xuXHRcdFx0XHRcdFx0cmV0dXJuIHRydWU7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cdFx0XHR9KSApO1xuXHRcdH1cblxuXHRcdGZvciAoIGkgPSAwOyBpIDwgbGVuOyBpKysgKSB7XG5cdFx0XHRqUXVlcnkuZmluZCggc2VsZWN0b3IsIHNlbGZbIGkgXSwgcmV0ICk7XG5cdFx0fVxuXG5cdFx0Ly8gTmVlZGVkIGJlY2F1c2UgJCggc2VsZWN0b3IsIGNvbnRleHQgKSBiZWNvbWVzICQoIGNvbnRleHQgKS5maW5kKCBzZWxlY3RvciApXG5cdFx0cmV0ID0gdGhpcy5wdXNoU3RhY2soIGxlbiA+IDEgPyBqUXVlcnkudW5pcXVlKCByZXQgKSA6IHJldCApO1xuXHRcdHJldC5zZWxlY3RvciA9IHRoaXMuc2VsZWN0b3IgPyB0aGlzLnNlbGVjdG9yICsgXCIgXCIgKyBzZWxlY3RvciA6IHNlbGVjdG9yO1xuXHRcdHJldHVybiByZXQ7XG5cdH0sXG5cdGZpbHRlcjogZnVuY3Rpb24oIHNlbGVjdG9yICkge1xuXHRcdHJldHVybiB0aGlzLnB1c2hTdGFjayggd2lubm93KHRoaXMsIHNlbGVjdG9yIHx8IFtdLCBmYWxzZSkgKTtcblx0fSxcblx0bm90OiBmdW5jdGlvbiggc2VsZWN0b3IgKSB7XG5cdFx0cmV0dXJuIHRoaXMucHVzaFN0YWNrKCB3aW5ub3codGhpcywgc2VsZWN0b3IgfHwgW10sIHRydWUpICk7XG5cdH0sXG5cdGlzOiBmdW5jdGlvbiggc2VsZWN0b3IgKSB7XG5cdFx0cmV0dXJuICEhd2lubm93KFxuXHRcdFx0dGhpcyxcblxuXHRcdFx0Ly8gSWYgdGhpcyBpcyBhIHBvc2l0aW9uYWwvcmVsYXRpdmUgc2VsZWN0b3IsIGNoZWNrIG1lbWJlcnNoaXAgaW4gdGhlIHJldHVybmVkIHNldFxuXHRcdFx0Ly8gc28gJChcInA6Zmlyc3RcIikuaXMoXCJwOmxhc3RcIikgd29uJ3QgcmV0dXJuIHRydWUgZm9yIGEgZG9jIHdpdGggdHdvIFwicFwiLlxuXHRcdFx0dHlwZW9mIHNlbGVjdG9yID09PSBcInN0cmluZ1wiICYmIHJuZWVkc0NvbnRleHQudGVzdCggc2VsZWN0b3IgKSA/XG5cdFx0XHRcdGpRdWVyeSggc2VsZWN0b3IgKSA6XG5cdFx0XHRcdHNlbGVjdG9yIHx8IFtdLFxuXHRcdFx0ZmFsc2Vcblx0XHQpLmxlbmd0aDtcblx0fVxufSk7XG5cblxuLy8gSW5pdGlhbGl6ZSBhIGpRdWVyeSBvYmplY3RcblxuXG4vLyBBIGNlbnRyYWwgcmVmZXJlbmNlIHRvIHRoZSByb290IGpRdWVyeShkb2N1bWVudClcbnZhciByb290alF1ZXJ5LFxuXG5cdC8vIEEgc2ltcGxlIHdheSB0byBjaGVjayBmb3IgSFRNTCBzdHJpbmdzXG5cdC8vIFByaW9yaXRpemUgI2lkIG92ZXIgPHRhZz4gdG8gYXZvaWQgWFNTIHZpYSBsb2NhdGlvbi5oYXNoICgjOTUyMSlcblx0Ly8gU3RyaWN0IEhUTUwgcmVjb2duaXRpb24gKCMxMTI5MDogbXVzdCBzdGFydCB3aXRoIDwpXG5cdHJxdWlja0V4cHIgPSAvXig/OlxccyooPFtcXHdcXFddKz4pW14+XSp8IyhbXFx3LV0qKSkkLyxcblxuXHRpbml0ID0galF1ZXJ5LmZuLmluaXQgPSBmdW5jdGlvbiggc2VsZWN0b3IsIGNvbnRleHQgKSB7XG5cdFx0dmFyIG1hdGNoLCBlbGVtO1xuXG5cdFx0Ly8gSEFORExFOiAkKFwiXCIpLCAkKG51bGwpLCAkKHVuZGVmaW5lZCksICQoZmFsc2UpXG5cdFx0aWYgKCAhc2VsZWN0b3IgKSB7XG5cdFx0XHRyZXR1cm4gdGhpcztcblx0XHR9XG5cblx0XHQvLyBIYW5kbGUgSFRNTCBzdHJpbmdzXG5cdFx0aWYgKCB0eXBlb2Ygc2VsZWN0b3IgPT09IFwic3RyaW5nXCIgKSB7XG5cdFx0XHRpZiAoIHNlbGVjdG9yWzBdID09PSBcIjxcIiAmJiBzZWxlY3Rvclsgc2VsZWN0b3IubGVuZ3RoIC0gMSBdID09PSBcIj5cIiAmJiBzZWxlY3Rvci5sZW5ndGggPj0gMyApIHtcblx0XHRcdFx0Ly8gQXNzdW1lIHRoYXQgc3RyaW5ncyB0aGF0IHN0YXJ0IGFuZCBlbmQgd2l0aCA8PiBhcmUgSFRNTCBhbmQgc2tpcCB0aGUgcmVnZXggY2hlY2tcblx0XHRcdFx0bWF0Y2ggPSBbIG51bGwsIHNlbGVjdG9yLCBudWxsIF07XG5cblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdG1hdGNoID0gcnF1aWNrRXhwci5leGVjKCBzZWxlY3RvciApO1xuXHRcdFx0fVxuXG5cdFx0XHQvLyBNYXRjaCBodG1sIG9yIG1ha2Ugc3VyZSBubyBjb250ZXh0IGlzIHNwZWNpZmllZCBmb3IgI2lkXG5cdFx0XHRpZiAoIG1hdGNoICYmIChtYXRjaFsxXSB8fCAhY29udGV4dCkgKSB7XG5cblx0XHRcdFx0Ly8gSEFORExFOiAkKGh0bWwpIC0+ICQoYXJyYXkpXG5cdFx0XHRcdGlmICggbWF0Y2hbMV0gKSB7XG5cdFx0XHRcdFx0Y29udGV4dCA9IGNvbnRleHQgaW5zdGFuY2VvZiBqUXVlcnkgPyBjb250ZXh0WzBdIDogY29udGV4dDtcblxuXHRcdFx0XHRcdC8vIE9wdGlvbiB0byBydW4gc2NyaXB0cyBpcyB0cnVlIGZvciBiYWNrLWNvbXBhdFxuXHRcdFx0XHRcdC8vIEludGVudGlvbmFsbHkgbGV0IHRoZSBlcnJvciBiZSB0aHJvd24gaWYgcGFyc2VIVE1MIGlzIG5vdCBwcmVzZW50XG5cdFx0XHRcdFx0alF1ZXJ5Lm1lcmdlKCB0aGlzLCBqUXVlcnkucGFyc2VIVE1MKFxuXHRcdFx0XHRcdFx0bWF0Y2hbMV0sXG5cdFx0XHRcdFx0XHRjb250ZXh0ICYmIGNvbnRleHQubm9kZVR5cGUgPyBjb250ZXh0Lm93bmVyRG9jdW1lbnQgfHwgY29udGV4dCA6IGRvY3VtZW50LFxuXHRcdFx0XHRcdFx0dHJ1ZVxuXHRcdFx0XHRcdCkgKTtcblxuXHRcdFx0XHRcdC8vIEhBTkRMRTogJChodG1sLCBwcm9wcylcblx0XHRcdFx0XHRpZiAoIHJzaW5nbGVUYWcudGVzdCggbWF0Y2hbMV0gKSAmJiBqUXVlcnkuaXNQbGFpbk9iamVjdCggY29udGV4dCApICkge1xuXHRcdFx0XHRcdFx0Zm9yICggbWF0Y2ggaW4gY29udGV4dCApIHtcblx0XHRcdFx0XHRcdFx0Ly8gUHJvcGVydGllcyBvZiBjb250ZXh0IGFyZSBjYWxsZWQgYXMgbWV0aG9kcyBpZiBwb3NzaWJsZVxuXHRcdFx0XHRcdFx0XHRpZiAoIGpRdWVyeS5pc0Z1bmN0aW9uKCB0aGlzWyBtYXRjaCBdICkgKSB7XG5cdFx0XHRcdFx0XHRcdFx0dGhpc1sgbWF0Y2ggXSggY29udGV4dFsgbWF0Y2ggXSApO1xuXG5cdFx0XHRcdFx0XHRcdC8vIC4uLmFuZCBvdGhlcndpc2Ugc2V0IGFzIGF0dHJpYnV0ZXNcblx0XHRcdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdFx0XHR0aGlzLmF0dHIoIG1hdGNoLCBjb250ZXh0WyBtYXRjaCBdICk7XG5cdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRyZXR1cm4gdGhpcztcblxuXHRcdFx0XHQvLyBIQU5ETEU6ICQoI2lkKVxuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdGVsZW0gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCggbWF0Y2hbMl0gKTtcblxuXHRcdFx0XHRcdC8vIFN1cHBvcnQ6IEJsYWNrYmVycnkgNC42XG5cdFx0XHRcdFx0Ly8gZ0VCSUQgcmV0dXJucyBub2RlcyBubyBsb25nZXIgaW4gdGhlIGRvY3VtZW50ICgjNjk2Mylcblx0XHRcdFx0XHRpZiAoIGVsZW0gJiYgZWxlbS5wYXJlbnROb2RlICkge1xuXHRcdFx0XHRcdFx0Ly8gSW5qZWN0IHRoZSBlbGVtZW50IGRpcmVjdGx5IGludG8gdGhlIGpRdWVyeSBvYmplY3Rcblx0XHRcdFx0XHRcdHRoaXMubGVuZ3RoID0gMTtcblx0XHRcdFx0XHRcdHRoaXNbMF0gPSBlbGVtO1xuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdHRoaXMuY29udGV4dCA9IGRvY3VtZW50O1xuXHRcdFx0XHRcdHRoaXMuc2VsZWN0b3IgPSBzZWxlY3Rvcjtcblx0XHRcdFx0XHRyZXR1cm4gdGhpcztcblx0XHRcdFx0fVxuXG5cdFx0XHQvLyBIQU5ETEU6ICQoZXhwciwgJCguLi4pKVxuXHRcdFx0fSBlbHNlIGlmICggIWNvbnRleHQgfHwgY29udGV4dC5qcXVlcnkgKSB7XG5cdFx0XHRcdHJldHVybiAoIGNvbnRleHQgfHwgcm9vdGpRdWVyeSApLmZpbmQoIHNlbGVjdG9yICk7XG5cblx0XHRcdC8vIEhBTkRMRTogJChleHByLCBjb250ZXh0KVxuXHRcdFx0Ly8gKHdoaWNoIGlzIGp1c3QgZXF1aXZhbGVudCB0bzogJChjb250ZXh0KS5maW5kKGV4cHIpXG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRyZXR1cm4gdGhpcy5jb25zdHJ1Y3RvciggY29udGV4dCApLmZpbmQoIHNlbGVjdG9yICk7XG5cdFx0XHR9XG5cblx0XHQvLyBIQU5ETEU6ICQoRE9NRWxlbWVudClcblx0XHR9IGVsc2UgaWYgKCBzZWxlY3Rvci5ub2RlVHlwZSApIHtcblx0XHRcdHRoaXMuY29udGV4dCA9IHRoaXNbMF0gPSBzZWxlY3Rvcjtcblx0XHRcdHRoaXMubGVuZ3RoID0gMTtcblx0XHRcdHJldHVybiB0aGlzO1xuXG5cdFx0Ly8gSEFORExFOiAkKGZ1bmN0aW9uKVxuXHRcdC8vIFNob3J0Y3V0IGZvciBkb2N1bWVudCByZWFkeVxuXHRcdH0gZWxzZSBpZiAoIGpRdWVyeS5pc0Z1bmN0aW9uKCBzZWxlY3RvciApICkge1xuXHRcdFx0cmV0dXJuIHR5cGVvZiByb290alF1ZXJ5LnJlYWR5ICE9PSBcInVuZGVmaW5lZFwiID9cblx0XHRcdFx0cm9vdGpRdWVyeS5yZWFkeSggc2VsZWN0b3IgKSA6XG5cdFx0XHRcdC8vIEV4ZWN1dGUgaW1tZWRpYXRlbHkgaWYgcmVhZHkgaXMgbm90IHByZXNlbnRcblx0XHRcdFx0c2VsZWN0b3IoIGpRdWVyeSApO1xuXHRcdH1cblxuXHRcdGlmICggc2VsZWN0b3Iuc2VsZWN0b3IgIT09IHVuZGVmaW5lZCApIHtcblx0XHRcdHRoaXMuc2VsZWN0b3IgPSBzZWxlY3Rvci5zZWxlY3Rvcjtcblx0XHRcdHRoaXMuY29udGV4dCA9IHNlbGVjdG9yLmNvbnRleHQ7XG5cdFx0fVxuXG5cdFx0cmV0dXJuIGpRdWVyeS5tYWtlQXJyYXkoIHNlbGVjdG9yLCB0aGlzICk7XG5cdH07XG5cbi8vIEdpdmUgdGhlIGluaXQgZnVuY3Rpb24gdGhlIGpRdWVyeSBwcm90b3R5cGUgZm9yIGxhdGVyIGluc3RhbnRpYXRpb25cbmluaXQucHJvdG90eXBlID0galF1ZXJ5LmZuO1xuXG4vLyBJbml0aWFsaXplIGNlbnRyYWwgcmVmZXJlbmNlXG5yb290alF1ZXJ5ID0galF1ZXJ5KCBkb2N1bWVudCApO1xuXG5cbnZhciBycGFyZW50c3ByZXYgPSAvXig/OnBhcmVudHN8cHJldig/OlVudGlsfEFsbCkpLyxcblx0Ly8gTWV0aG9kcyBndWFyYW50ZWVkIHRvIHByb2R1Y2UgYSB1bmlxdWUgc2V0IHdoZW4gc3RhcnRpbmcgZnJvbSBhIHVuaXF1ZSBzZXRcblx0Z3VhcmFudGVlZFVuaXF1ZSA9IHtcblx0XHRjaGlsZHJlbjogdHJ1ZSxcblx0XHRjb250ZW50czogdHJ1ZSxcblx0XHRuZXh0OiB0cnVlLFxuXHRcdHByZXY6IHRydWVcblx0fTtcblxualF1ZXJ5LmV4dGVuZCh7XG5cdGRpcjogZnVuY3Rpb24oIGVsZW0sIGRpciwgdW50aWwgKSB7XG5cdFx0dmFyIG1hdGNoZWQgPSBbXSxcblx0XHRcdHRydW5jYXRlID0gdW50aWwgIT09IHVuZGVmaW5lZDtcblxuXHRcdHdoaWxlICggKGVsZW0gPSBlbGVtWyBkaXIgXSkgJiYgZWxlbS5ub2RlVHlwZSAhPT0gOSApIHtcblx0XHRcdGlmICggZWxlbS5ub2RlVHlwZSA9PT0gMSApIHtcblx0XHRcdFx0aWYgKCB0cnVuY2F0ZSAmJiBqUXVlcnkoIGVsZW0gKS5pcyggdW50aWwgKSApIHtcblx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0fVxuXHRcdFx0XHRtYXRjaGVkLnB1c2goIGVsZW0gKTtcblx0XHRcdH1cblx0XHR9XG5cdFx0cmV0dXJuIG1hdGNoZWQ7XG5cdH0sXG5cblx0c2libGluZzogZnVuY3Rpb24oIG4sIGVsZW0gKSB7XG5cdFx0dmFyIG1hdGNoZWQgPSBbXTtcblxuXHRcdGZvciAoIDsgbjsgbiA9IG4ubmV4dFNpYmxpbmcgKSB7XG5cdFx0XHRpZiAoIG4ubm9kZVR5cGUgPT09IDEgJiYgbiAhPT0gZWxlbSApIHtcblx0XHRcdFx0bWF0Y2hlZC5wdXNoKCBuICk7XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0cmV0dXJuIG1hdGNoZWQ7XG5cdH1cbn0pO1xuXG5qUXVlcnkuZm4uZXh0ZW5kKHtcblx0aGFzOiBmdW5jdGlvbiggdGFyZ2V0ICkge1xuXHRcdHZhciB0YXJnZXRzID0galF1ZXJ5KCB0YXJnZXQsIHRoaXMgKSxcblx0XHRcdGwgPSB0YXJnZXRzLmxlbmd0aDtcblxuXHRcdHJldHVybiB0aGlzLmZpbHRlcihmdW5jdGlvbigpIHtcblx0XHRcdHZhciBpID0gMDtcblx0XHRcdGZvciAoIDsgaSA8IGw7IGkrKyApIHtcblx0XHRcdFx0aWYgKCBqUXVlcnkuY29udGFpbnMoIHRoaXMsIHRhcmdldHNbaV0gKSApIHtcblx0XHRcdFx0XHRyZXR1cm4gdHJ1ZTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH0pO1xuXHR9LFxuXG5cdGNsb3Nlc3Q6IGZ1bmN0aW9uKCBzZWxlY3RvcnMsIGNvbnRleHQgKSB7XG5cdFx0dmFyIGN1cixcblx0XHRcdGkgPSAwLFxuXHRcdFx0bCA9IHRoaXMubGVuZ3RoLFxuXHRcdFx0bWF0Y2hlZCA9IFtdLFxuXHRcdFx0cG9zID0gcm5lZWRzQ29udGV4dC50ZXN0KCBzZWxlY3RvcnMgKSB8fCB0eXBlb2Ygc2VsZWN0b3JzICE9PSBcInN0cmluZ1wiID9cblx0XHRcdFx0alF1ZXJ5KCBzZWxlY3RvcnMsIGNvbnRleHQgfHwgdGhpcy5jb250ZXh0ICkgOlxuXHRcdFx0XHQwO1xuXG5cdFx0Zm9yICggOyBpIDwgbDsgaSsrICkge1xuXHRcdFx0Zm9yICggY3VyID0gdGhpc1tpXTsgY3VyICYmIGN1ciAhPT0gY29udGV4dDsgY3VyID0gY3VyLnBhcmVudE5vZGUgKSB7XG5cdFx0XHRcdC8vIEFsd2F5cyBza2lwIGRvY3VtZW50IGZyYWdtZW50c1xuXHRcdFx0XHRpZiAoIGN1ci5ub2RlVHlwZSA8IDExICYmIChwb3MgP1xuXHRcdFx0XHRcdHBvcy5pbmRleChjdXIpID4gLTEgOlxuXG5cdFx0XHRcdFx0Ly8gRG9uJ3QgcGFzcyBub24tZWxlbWVudHMgdG8gU2l6emxlXG5cdFx0XHRcdFx0Y3VyLm5vZGVUeXBlID09PSAxICYmXG5cdFx0XHRcdFx0XHRqUXVlcnkuZmluZC5tYXRjaGVzU2VsZWN0b3IoY3VyLCBzZWxlY3RvcnMpKSApIHtcblxuXHRcdFx0XHRcdG1hdGNoZWQucHVzaCggY3VyICk7XG5cdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9XG5cblx0XHRyZXR1cm4gdGhpcy5wdXNoU3RhY2soIG1hdGNoZWQubGVuZ3RoID4gMSA/IGpRdWVyeS51bmlxdWUoIG1hdGNoZWQgKSA6IG1hdGNoZWQgKTtcblx0fSxcblxuXHQvLyBEZXRlcm1pbmUgdGhlIHBvc2l0aW9uIG9mIGFuIGVsZW1lbnQgd2l0aGluIHRoZSBzZXRcblx0aW5kZXg6IGZ1bmN0aW9uKCBlbGVtICkge1xuXG5cdFx0Ly8gTm8gYXJndW1lbnQsIHJldHVybiBpbmRleCBpbiBwYXJlbnRcblx0XHRpZiAoICFlbGVtICkge1xuXHRcdFx0cmV0dXJuICggdGhpc1sgMCBdICYmIHRoaXNbIDAgXS5wYXJlbnROb2RlICkgPyB0aGlzLmZpcnN0KCkucHJldkFsbCgpLmxlbmd0aCA6IC0xO1xuXHRcdH1cblxuXHRcdC8vIEluZGV4IGluIHNlbGVjdG9yXG5cdFx0aWYgKCB0eXBlb2YgZWxlbSA9PT0gXCJzdHJpbmdcIiApIHtcblx0XHRcdHJldHVybiBpbmRleE9mLmNhbGwoIGpRdWVyeSggZWxlbSApLCB0aGlzWyAwIF0gKTtcblx0XHR9XG5cblx0XHQvLyBMb2NhdGUgdGhlIHBvc2l0aW9uIG9mIHRoZSBkZXNpcmVkIGVsZW1lbnRcblx0XHRyZXR1cm4gaW5kZXhPZi5jYWxsKCB0aGlzLFxuXG5cdFx0XHQvLyBJZiBpdCByZWNlaXZlcyBhIGpRdWVyeSBvYmplY3QsIHRoZSBmaXJzdCBlbGVtZW50IGlzIHVzZWRcblx0XHRcdGVsZW0uanF1ZXJ5ID8gZWxlbVsgMCBdIDogZWxlbVxuXHRcdCk7XG5cdH0sXG5cblx0YWRkOiBmdW5jdGlvbiggc2VsZWN0b3IsIGNvbnRleHQgKSB7XG5cdFx0cmV0dXJuIHRoaXMucHVzaFN0YWNrKFxuXHRcdFx0alF1ZXJ5LnVuaXF1ZShcblx0XHRcdFx0alF1ZXJ5Lm1lcmdlKCB0aGlzLmdldCgpLCBqUXVlcnkoIHNlbGVjdG9yLCBjb250ZXh0ICkgKVxuXHRcdFx0KVxuXHRcdCk7XG5cdH0sXG5cblx0YWRkQmFjazogZnVuY3Rpb24oIHNlbGVjdG9yICkge1xuXHRcdHJldHVybiB0aGlzLmFkZCggc2VsZWN0b3IgPT0gbnVsbCA/XG5cdFx0XHR0aGlzLnByZXZPYmplY3QgOiB0aGlzLnByZXZPYmplY3QuZmlsdGVyKHNlbGVjdG9yKVxuXHRcdCk7XG5cdH1cbn0pO1xuXG5mdW5jdGlvbiBzaWJsaW5nKCBjdXIsIGRpciApIHtcblx0d2hpbGUgKCAoY3VyID0gY3VyW2Rpcl0pICYmIGN1ci5ub2RlVHlwZSAhPT0gMSApIHt9XG5cdHJldHVybiBjdXI7XG59XG5cbmpRdWVyeS5lYWNoKHtcblx0cGFyZW50OiBmdW5jdGlvbiggZWxlbSApIHtcblx0XHR2YXIgcGFyZW50ID0gZWxlbS5wYXJlbnROb2RlO1xuXHRcdHJldHVybiBwYXJlbnQgJiYgcGFyZW50Lm5vZGVUeXBlICE9PSAxMSA/IHBhcmVudCA6IG51bGw7XG5cdH0sXG5cdHBhcmVudHM6IGZ1bmN0aW9uKCBlbGVtICkge1xuXHRcdHJldHVybiBqUXVlcnkuZGlyKCBlbGVtLCBcInBhcmVudE5vZGVcIiApO1xuXHR9LFxuXHRwYXJlbnRzVW50aWw6IGZ1bmN0aW9uKCBlbGVtLCBpLCB1bnRpbCApIHtcblx0XHRyZXR1cm4galF1ZXJ5LmRpciggZWxlbSwgXCJwYXJlbnROb2RlXCIsIHVudGlsICk7XG5cdH0sXG5cdG5leHQ6IGZ1bmN0aW9uKCBlbGVtICkge1xuXHRcdHJldHVybiBzaWJsaW5nKCBlbGVtLCBcIm5leHRTaWJsaW5nXCIgKTtcblx0fSxcblx0cHJldjogZnVuY3Rpb24oIGVsZW0gKSB7XG5cdFx0cmV0dXJuIHNpYmxpbmcoIGVsZW0sIFwicHJldmlvdXNTaWJsaW5nXCIgKTtcblx0fSxcblx0bmV4dEFsbDogZnVuY3Rpb24oIGVsZW0gKSB7XG5cdFx0cmV0dXJuIGpRdWVyeS5kaXIoIGVsZW0sIFwibmV4dFNpYmxpbmdcIiApO1xuXHR9LFxuXHRwcmV2QWxsOiBmdW5jdGlvbiggZWxlbSApIHtcblx0XHRyZXR1cm4galF1ZXJ5LmRpciggZWxlbSwgXCJwcmV2aW91c1NpYmxpbmdcIiApO1xuXHR9LFxuXHRuZXh0VW50aWw6IGZ1bmN0aW9uKCBlbGVtLCBpLCB1bnRpbCApIHtcblx0XHRyZXR1cm4galF1ZXJ5LmRpciggZWxlbSwgXCJuZXh0U2libGluZ1wiLCB1bnRpbCApO1xuXHR9LFxuXHRwcmV2VW50aWw6IGZ1bmN0aW9uKCBlbGVtLCBpLCB1bnRpbCApIHtcblx0XHRyZXR1cm4galF1ZXJ5LmRpciggZWxlbSwgXCJwcmV2aW91c1NpYmxpbmdcIiwgdW50aWwgKTtcblx0fSxcblx0c2libGluZ3M6IGZ1bmN0aW9uKCBlbGVtICkge1xuXHRcdHJldHVybiBqUXVlcnkuc2libGluZyggKCBlbGVtLnBhcmVudE5vZGUgfHwge30gKS5maXJzdENoaWxkLCBlbGVtICk7XG5cdH0sXG5cdGNoaWxkcmVuOiBmdW5jdGlvbiggZWxlbSApIHtcblx0XHRyZXR1cm4galF1ZXJ5LnNpYmxpbmcoIGVsZW0uZmlyc3RDaGlsZCApO1xuXHR9LFxuXHRjb250ZW50czogZnVuY3Rpb24oIGVsZW0gKSB7XG5cdFx0cmV0dXJuIGVsZW0uY29udGVudERvY3VtZW50IHx8IGpRdWVyeS5tZXJnZSggW10sIGVsZW0uY2hpbGROb2RlcyApO1xuXHR9XG59LCBmdW5jdGlvbiggbmFtZSwgZm4gKSB7XG5cdGpRdWVyeS5mblsgbmFtZSBdID0gZnVuY3Rpb24oIHVudGlsLCBzZWxlY3RvciApIHtcblx0XHR2YXIgbWF0Y2hlZCA9IGpRdWVyeS5tYXAoIHRoaXMsIGZuLCB1bnRpbCApO1xuXG5cdFx0aWYgKCBuYW1lLnNsaWNlKCAtNSApICE9PSBcIlVudGlsXCIgKSB7XG5cdFx0XHRzZWxlY3RvciA9IHVudGlsO1xuXHRcdH1cblxuXHRcdGlmICggc2VsZWN0b3IgJiYgdHlwZW9mIHNlbGVjdG9yID09PSBcInN0cmluZ1wiICkge1xuXHRcdFx0bWF0Y2hlZCA9IGpRdWVyeS5maWx0ZXIoIHNlbGVjdG9yLCBtYXRjaGVkICk7XG5cdFx0fVxuXG5cdFx0aWYgKCB0aGlzLmxlbmd0aCA+IDEgKSB7XG5cdFx0XHQvLyBSZW1vdmUgZHVwbGljYXRlc1xuXHRcdFx0aWYgKCAhZ3VhcmFudGVlZFVuaXF1ZVsgbmFtZSBdICkge1xuXHRcdFx0XHRqUXVlcnkudW5pcXVlKCBtYXRjaGVkICk7XG5cdFx0XHR9XG5cblx0XHRcdC8vIFJldmVyc2Ugb3JkZXIgZm9yIHBhcmVudHMqIGFuZCBwcmV2LWRlcml2YXRpdmVzXG5cdFx0XHRpZiAoIHJwYXJlbnRzcHJldi50ZXN0KCBuYW1lICkgKSB7XG5cdFx0XHRcdG1hdGNoZWQucmV2ZXJzZSgpO1xuXHRcdFx0fVxuXHRcdH1cblxuXHRcdHJldHVybiB0aGlzLnB1c2hTdGFjayggbWF0Y2hlZCApO1xuXHR9O1xufSk7XG52YXIgcm5vdHdoaXRlID0gKC9cXFMrL2cpO1xuXG5cblxuLy8gU3RyaW5nIHRvIE9iamVjdCBvcHRpb25zIGZvcm1hdCBjYWNoZVxudmFyIG9wdGlvbnNDYWNoZSA9IHt9O1xuXG4vLyBDb252ZXJ0IFN0cmluZy1mb3JtYXR0ZWQgb3B0aW9ucyBpbnRvIE9iamVjdC1mb3JtYXR0ZWQgb25lcyBhbmQgc3RvcmUgaW4gY2FjaGVcbmZ1bmN0aW9uIGNyZWF0ZU9wdGlvbnMoIG9wdGlvbnMgKSB7XG5cdHZhciBvYmplY3QgPSBvcHRpb25zQ2FjaGVbIG9wdGlvbnMgXSA9IHt9O1xuXHRqUXVlcnkuZWFjaCggb3B0aW9ucy5tYXRjaCggcm5vdHdoaXRlICkgfHwgW10sIGZ1bmN0aW9uKCBfLCBmbGFnICkge1xuXHRcdG9iamVjdFsgZmxhZyBdID0gdHJ1ZTtcblx0fSk7XG5cdHJldHVybiBvYmplY3Q7XG59XG5cbi8qXG4gKiBDcmVhdGUgYSBjYWxsYmFjayBsaXN0IHVzaW5nIHRoZSBmb2xsb3dpbmcgcGFyYW1ldGVyczpcbiAqXG4gKlx0b3B0aW9uczogYW4gb3B0aW9uYWwgbGlzdCBvZiBzcGFjZS1zZXBhcmF0ZWQgb3B0aW9ucyB0aGF0IHdpbGwgY2hhbmdlIGhvd1xuICpcdFx0XHR0aGUgY2FsbGJhY2sgbGlzdCBiZWhhdmVzIG9yIGEgbW9yZSB0cmFkaXRpb25hbCBvcHRpb24gb2JqZWN0XG4gKlxuICogQnkgZGVmYXVsdCBhIGNhbGxiYWNrIGxpc3Qgd2lsbCBhY3QgbGlrZSBhbiBldmVudCBjYWxsYmFjayBsaXN0IGFuZCBjYW4gYmVcbiAqIFwiZmlyZWRcIiBtdWx0aXBsZSB0aW1lcy5cbiAqXG4gKiBQb3NzaWJsZSBvcHRpb25zOlxuICpcbiAqXHRvbmNlOlx0XHRcdHdpbGwgZW5zdXJlIHRoZSBjYWxsYmFjayBsaXN0IGNhbiBvbmx5IGJlIGZpcmVkIG9uY2UgKGxpa2UgYSBEZWZlcnJlZClcbiAqXG4gKlx0bWVtb3J5Olx0XHRcdHdpbGwga2VlcCB0cmFjayBvZiBwcmV2aW91cyB2YWx1ZXMgYW5kIHdpbGwgY2FsbCBhbnkgY2FsbGJhY2sgYWRkZWRcbiAqXHRcdFx0XHRcdGFmdGVyIHRoZSBsaXN0IGhhcyBiZWVuIGZpcmVkIHJpZ2h0IGF3YXkgd2l0aCB0aGUgbGF0ZXN0IFwibWVtb3JpemVkXCJcbiAqXHRcdFx0XHRcdHZhbHVlcyAobGlrZSBhIERlZmVycmVkKVxuICpcbiAqXHR1bmlxdWU6XHRcdFx0d2lsbCBlbnN1cmUgYSBjYWxsYmFjayBjYW4gb25seSBiZSBhZGRlZCBvbmNlIChubyBkdXBsaWNhdGUgaW4gdGhlIGxpc3QpXG4gKlxuICpcdHN0b3BPbkZhbHNlOlx0aW50ZXJydXB0IGNhbGxpbmdzIHdoZW4gYSBjYWxsYmFjayByZXR1cm5zIGZhbHNlXG4gKlxuICovXG5qUXVlcnkuQ2FsbGJhY2tzID0gZnVuY3Rpb24oIG9wdGlvbnMgKSB7XG5cblx0Ly8gQ29udmVydCBvcHRpb25zIGZyb20gU3RyaW5nLWZvcm1hdHRlZCB0byBPYmplY3QtZm9ybWF0dGVkIGlmIG5lZWRlZFxuXHQvLyAod2UgY2hlY2sgaW4gY2FjaGUgZmlyc3QpXG5cdG9wdGlvbnMgPSB0eXBlb2Ygb3B0aW9ucyA9PT0gXCJzdHJpbmdcIiA/XG5cdFx0KCBvcHRpb25zQ2FjaGVbIG9wdGlvbnMgXSB8fCBjcmVhdGVPcHRpb25zKCBvcHRpb25zICkgKSA6XG5cdFx0alF1ZXJ5LmV4dGVuZCgge30sIG9wdGlvbnMgKTtcblxuXHR2YXIgLy8gTGFzdCBmaXJlIHZhbHVlIChmb3Igbm9uLWZvcmdldHRhYmxlIGxpc3RzKVxuXHRcdG1lbW9yeSxcblx0XHQvLyBGbGFnIHRvIGtub3cgaWYgbGlzdCB3YXMgYWxyZWFkeSBmaXJlZFxuXHRcdGZpcmVkLFxuXHRcdC8vIEZsYWcgdG8ga25vdyBpZiBsaXN0IGlzIGN1cnJlbnRseSBmaXJpbmdcblx0XHRmaXJpbmcsXG5cdFx0Ly8gRmlyc3QgY2FsbGJhY2sgdG8gZmlyZSAodXNlZCBpbnRlcm5hbGx5IGJ5IGFkZCBhbmQgZmlyZVdpdGgpXG5cdFx0ZmlyaW5nU3RhcnQsXG5cdFx0Ly8gRW5kIG9mIHRoZSBsb29wIHdoZW4gZmlyaW5nXG5cdFx0ZmlyaW5nTGVuZ3RoLFxuXHRcdC8vIEluZGV4IG9mIGN1cnJlbnRseSBmaXJpbmcgY2FsbGJhY2sgKG1vZGlmaWVkIGJ5IHJlbW92ZSBpZiBuZWVkZWQpXG5cdFx0ZmlyaW5nSW5kZXgsXG5cdFx0Ly8gQWN0dWFsIGNhbGxiYWNrIGxpc3Rcblx0XHRsaXN0ID0gW10sXG5cdFx0Ly8gU3RhY2sgb2YgZmlyZSBjYWxscyBmb3IgcmVwZWF0YWJsZSBsaXN0c1xuXHRcdHN0YWNrID0gIW9wdGlvbnMub25jZSAmJiBbXSxcblx0XHQvLyBGaXJlIGNhbGxiYWNrc1xuXHRcdGZpcmUgPSBmdW5jdGlvbiggZGF0YSApIHtcblx0XHRcdG1lbW9yeSA9IG9wdGlvbnMubWVtb3J5ICYmIGRhdGE7XG5cdFx0XHRmaXJlZCA9IHRydWU7XG5cdFx0XHRmaXJpbmdJbmRleCA9IGZpcmluZ1N0YXJ0IHx8IDA7XG5cdFx0XHRmaXJpbmdTdGFydCA9IDA7XG5cdFx0XHRmaXJpbmdMZW5ndGggPSBsaXN0Lmxlbmd0aDtcblx0XHRcdGZpcmluZyA9IHRydWU7XG5cdFx0XHRmb3IgKCA7IGxpc3QgJiYgZmlyaW5nSW5kZXggPCBmaXJpbmdMZW5ndGg7IGZpcmluZ0luZGV4KysgKSB7XG5cdFx0XHRcdGlmICggbGlzdFsgZmlyaW5nSW5kZXggXS5hcHBseSggZGF0YVsgMCBdLCBkYXRhWyAxIF0gKSA9PT0gZmFsc2UgJiYgb3B0aW9ucy5zdG9wT25GYWxzZSApIHtcblx0XHRcdFx0XHRtZW1vcnkgPSBmYWxzZTsgLy8gVG8gcHJldmVudCBmdXJ0aGVyIGNhbGxzIHVzaW5nIGFkZFxuXHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0XHRmaXJpbmcgPSBmYWxzZTtcblx0XHRcdGlmICggbGlzdCApIHtcblx0XHRcdFx0aWYgKCBzdGFjayApIHtcblx0XHRcdFx0XHRpZiAoIHN0YWNrLmxlbmd0aCApIHtcblx0XHRcdFx0XHRcdGZpcmUoIHN0YWNrLnNoaWZ0KCkgKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH0gZWxzZSBpZiAoIG1lbW9yeSApIHtcblx0XHRcdFx0XHRsaXN0ID0gW107XG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0c2VsZi5kaXNhYmxlKCk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9LFxuXHRcdC8vIEFjdHVhbCBDYWxsYmFja3Mgb2JqZWN0XG5cdFx0c2VsZiA9IHtcblx0XHRcdC8vIEFkZCBhIGNhbGxiYWNrIG9yIGEgY29sbGVjdGlvbiBvZiBjYWxsYmFja3MgdG8gdGhlIGxpc3Rcblx0XHRcdGFkZDogZnVuY3Rpb24oKSB7XG5cdFx0XHRcdGlmICggbGlzdCApIHtcblx0XHRcdFx0XHQvLyBGaXJzdCwgd2Ugc2F2ZSB0aGUgY3VycmVudCBsZW5ndGhcblx0XHRcdFx0XHR2YXIgc3RhcnQgPSBsaXN0Lmxlbmd0aDtcblx0XHRcdFx0XHQoZnVuY3Rpb24gYWRkKCBhcmdzICkge1xuXHRcdFx0XHRcdFx0alF1ZXJ5LmVhY2goIGFyZ3MsIGZ1bmN0aW9uKCBfLCBhcmcgKSB7XG5cdFx0XHRcdFx0XHRcdHZhciB0eXBlID0galF1ZXJ5LnR5cGUoIGFyZyApO1xuXHRcdFx0XHRcdFx0XHRpZiAoIHR5cGUgPT09IFwiZnVuY3Rpb25cIiApIHtcblx0XHRcdFx0XHRcdFx0XHRpZiAoICFvcHRpb25zLnVuaXF1ZSB8fCAhc2VsZi5oYXMoIGFyZyApICkge1xuXHRcdFx0XHRcdFx0XHRcdFx0bGlzdC5wdXNoKCBhcmcgKTtcblx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdH0gZWxzZSBpZiAoIGFyZyAmJiBhcmcubGVuZ3RoICYmIHR5cGUgIT09IFwic3RyaW5nXCIgKSB7XG5cdFx0XHRcdFx0XHRcdFx0Ly8gSW5zcGVjdCByZWN1cnNpdmVseVxuXHRcdFx0XHRcdFx0XHRcdGFkZCggYXJnICk7XG5cdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdH0pO1xuXHRcdFx0XHRcdH0pKCBhcmd1bWVudHMgKTtcblx0XHRcdFx0XHQvLyBEbyB3ZSBuZWVkIHRvIGFkZCB0aGUgY2FsbGJhY2tzIHRvIHRoZVxuXHRcdFx0XHRcdC8vIGN1cnJlbnQgZmlyaW5nIGJhdGNoP1xuXHRcdFx0XHRcdGlmICggZmlyaW5nICkge1xuXHRcdFx0XHRcdFx0ZmlyaW5nTGVuZ3RoID0gbGlzdC5sZW5ndGg7XG5cdFx0XHRcdFx0Ly8gV2l0aCBtZW1vcnksIGlmIHdlJ3JlIG5vdCBmaXJpbmcgdGhlblxuXHRcdFx0XHRcdC8vIHdlIHNob3VsZCBjYWxsIHJpZ2h0IGF3YXlcblx0XHRcdFx0XHR9IGVsc2UgaWYgKCBtZW1vcnkgKSB7XG5cdFx0XHRcdFx0XHRmaXJpbmdTdGFydCA9IHN0YXJ0O1xuXHRcdFx0XHRcdFx0ZmlyZSggbWVtb3J5ICk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cdFx0XHRcdHJldHVybiB0aGlzO1xuXHRcdFx0fSxcblx0XHRcdC8vIFJlbW92ZSBhIGNhbGxiYWNrIGZyb20gdGhlIGxpc3Rcblx0XHRcdHJlbW92ZTogZnVuY3Rpb24oKSB7XG5cdFx0XHRcdGlmICggbGlzdCApIHtcblx0XHRcdFx0XHRqUXVlcnkuZWFjaCggYXJndW1lbnRzLCBmdW5jdGlvbiggXywgYXJnICkge1xuXHRcdFx0XHRcdFx0dmFyIGluZGV4O1xuXHRcdFx0XHRcdFx0d2hpbGUgKCAoIGluZGV4ID0galF1ZXJ5LmluQXJyYXkoIGFyZywgbGlzdCwgaW5kZXggKSApID4gLTEgKSB7XG5cdFx0XHRcdFx0XHRcdGxpc3Quc3BsaWNlKCBpbmRleCwgMSApO1xuXHRcdFx0XHRcdFx0XHQvLyBIYW5kbGUgZmlyaW5nIGluZGV4ZXNcblx0XHRcdFx0XHRcdFx0aWYgKCBmaXJpbmcgKSB7XG5cdFx0XHRcdFx0XHRcdFx0aWYgKCBpbmRleCA8PSBmaXJpbmdMZW5ndGggKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRmaXJpbmdMZW5ndGgtLTtcblx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdFx0aWYgKCBpbmRleCA8PSBmaXJpbmdJbmRleCApIHtcblx0XHRcdFx0XHRcdFx0XHRcdGZpcmluZ0luZGV4LS07XG5cdFx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fSk7XG5cdFx0XHRcdH1cblx0XHRcdFx0cmV0dXJuIHRoaXM7XG5cdFx0XHR9LFxuXHRcdFx0Ly8gQ2hlY2sgaWYgYSBnaXZlbiBjYWxsYmFjayBpcyBpbiB0aGUgbGlzdC5cblx0XHRcdC8vIElmIG5vIGFyZ3VtZW50IGlzIGdpdmVuLCByZXR1cm4gd2hldGhlciBvciBub3QgbGlzdCBoYXMgY2FsbGJhY2tzIGF0dGFjaGVkLlxuXHRcdFx0aGFzOiBmdW5jdGlvbiggZm4gKSB7XG5cdFx0XHRcdHJldHVybiBmbiA/IGpRdWVyeS5pbkFycmF5KCBmbiwgbGlzdCApID4gLTEgOiAhISggbGlzdCAmJiBsaXN0Lmxlbmd0aCApO1xuXHRcdFx0fSxcblx0XHRcdC8vIFJlbW92ZSBhbGwgY2FsbGJhY2tzIGZyb20gdGhlIGxpc3Rcblx0XHRcdGVtcHR5OiBmdW5jdGlvbigpIHtcblx0XHRcdFx0bGlzdCA9IFtdO1xuXHRcdFx0XHRmaXJpbmdMZW5ndGggPSAwO1xuXHRcdFx0XHRyZXR1cm4gdGhpcztcblx0XHRcdH0sXG5cdFx0XHQvLyBIYXZlIHRoZSBsaXN0IGRvIG5vdGhpbmcgYW55bW9yZVxuXHRcdFx0ZGlzYWJsZTogZnVuY3Rpb24oKSB7XG5cdFx0XHRcdGxpc3QgPSBzdGFjayA9IG1lbW9yeSA9IHVuZGVmaW5lZDtcblx0XHRcdFx0cmV0dXJuIHRoaXM7XG5cdFx0XHR9LFxuXHRcdFx0Ly8gSXMgaXQgZGlzYWJsZWQ/XG5cdFx0XHRkaXNhYmxlZDogZnVuY3Rpb24oKSB7XG5cdFx0XHRcdHJldHVybiAhbGlzdDtcblx0XHRcdH0sXG5cdFx0XHQvLyBMb2NrIHRoZSBsaXN0IGluIGl0cyBjdXJyZW50IHN0YXRlXG5cdFx0XHRsb2NrOiBmdW5jdGlvbigpIHtcblx0XHRcdFx0c3RhY2sgPSB1bmRlZmluZWQ7XG5cdFx0XHRcdGlmICggIW1lbW9yeSApIHtcblx0XHRcdFx0XHRzZWxmLmRpc2FibGUoKTtcblx0XHRcdFx0fVxuXHRcdFx0XHRyZXR1cm4gdGhpcztcblx0XHRcdH0sXG5cdFx0XHQvLyBJcyBpdCBsb2NrZWQ/XG5cdFx0XHRsb2NrZWQ6IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRyZXR1cm4gIXN0YWNrO1xuXHRcdFx0fSxcblx0XHRcdC8vIENhbGwgYWxsIGNhbGxiYWNrcyB3aXRoIHRoZSBnaXZlbiBjb250ZXh0IGFuZCBhcmd1bWVudHNcblx0XHRcdGZpcmVXaXRoOiBmdW5jdGlvbiggY29udGV4dCwgYXJncyApIHtcblx0XHRcdFx0aWYgKCBsaXN0ICYmICggIWZpcmVkIHx8IHN0YWNrICkgKSB7XG5cdFx0XHRcdFx0YXJncyA9IGFyZ3MgfHwgW107XG5cdFx0XHRcdFx0YXJncyA9IFsgY29udGV4dCwgYXJncy5zbGljZSA/IGFyZ3Muc2xpY2UoKSA6IGFyZ3MgXTtcblx0XHRcdFx0XHRpZiAoIGZpcmluZyApIHtcblx0XHRcdFx0XHRcdHN0YWNrLnB1c2goIGFyZ3MgKTtcblx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0ZmlyZSggYXJncyApO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0XHRyZXR1cm4gdGhpcztcblx0XHRcdH0sXG5cdFx0XHQvLyBDYWxsIGFsbCB0aGUgY2FsbGJhY2tzIHdpdGggdGhlIGdpdmVuIGFyZ3VtZW50c1xuXHRcdFx0ZmlyZTogZnVuY3Rpb24oKSB7XG5cdFx0XHRcdHNlbGYuZmlyZVdpdGgoIHRoaXMsIGFyZ3VtZW50cyApO1xuXHRcdFx0XHRyZXR1cm4gdGhpcztcblx0XHRcdH0sXG5cdFx0XHQvLyBUbyBrbm93IGlmIHRoZSBjYWxsYmFja3MgaGF2ZSBhbHJlYWR5IGJlZW4gY2FsbGVkIGF0IGxlYXN0IG9uY2Vcblx0XHRcdGZpcmVkOiBmdW5jdGlvbigpIHtcblx0XHRcdFx0cmV0dXJuICEhZmlyZWQ7XG5cdFx0XHR9XG5cdFx0fTtcblxuXHRyZXR1cm4gc2VsZjtcbn07XG5cblxualF1ZXJ5LmV4dGVuZCh7XG5cblx0RGVmZXJyZWQ6IGZ1bmN0aW9uKCBmdW5jICkge1xuXHRcdHZhciB0dXBsZXMgPSBbXG5cdFx0XHRcdC8vIGFjdGlvbiwgYWRkIGxpc3RlbmVyLCBsaXN0ZW5lciBsaXN0LCBmaW5hbCBzdGF0ZVxuXHRcdFx0XHRbIFwicmVzb2x2ZVwiLCBcImRvbmVcIiwgalF1ZXJ5LkNhbGxiYWNrcyhcIm9uY2UgbWVtb3J5XCIpLCBcInJlc29sdmVkXCIgXSxcblx0XHRcdFx0WyBcInJlamVjdFwiLCBcImZhaWxcIiwgalF1ZXJ5LkNhbGxiYWNrcyhcIm9uY2UgbWVtb3J5XCIpLCBcInJlamVjdGVkXCIgXSxcblx0XHRcdFx0WyBcIm5vdGlmeVwiLCBcInByb2dyZXNzXCIsIGpRdWVyeS5DYWxsYmFja3MoXCJtZW1vcnlcIikgXVxuXHRcdFx0XSxcblx0XHRcdHN0YXRlID0gXCJwZW5kaW5nXCIsXG5cdFx0XHRwcm9taXNlID0ge1xuXHRcdFx0XHRzdGF0ZTogZnVuY3Rpb24oKSB7XG5cdFx0XHRcdFx0cmV0dXJuIHN0YXRlO1xuXHRcdFx0XHR9LFxuXHRcdFx0XHRhbHdheXM6IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRcdGRlZmVycmVkLmRvbmUoIGFyZ3VtZW50cyApLmZhaWwoIGFyZ3VtZW50cyApO1xuXHRcdFx0XHRcdHJldHVybiB0aGlzO1xuXHRcdFx0XHR9LFxuXHRcdFx0XHR0aGVuOiBmdW5jdGlvbiggLyogZm5Eb25lLCBmbkZhaWwsIGZuUHJvZ3Jlc3MgKi8gKSB7XG5cdFx0XHRcdFx0dmFyIGZucyA9IGFyZ3VtZW50cztcblx0XHRcdFx0XHRyZXR1cm4galF1ZXJ5LkRlZmVycmVkKGZ1bmN0aW9uKCBuZXdEZWZlciApIHtcblx0XHRcdFx0XHRcdGpRdWVyeS5lYWNoKCB0dXBsZXMsIGZ1bmN0aW9uKCBpLCB0dXBsZSApIHtcblx0XHRcdFx0XHRcdFx0dmFyIGZuID0galF1ZXJ5LmlzRnVuY3Rpb24oIGZuc1sgaSBdICkgJiYgZm5zWyBpIF07XG5cdFx0XHRcdFx0XHRcdC8vIGRlZmVycmVkWyBkb25lIHwgZmFpbCB8IHByb2dyZXNzIF0gZm9yIGZvcndhcmRpbmcgYWN0aW9ucyB0byBuZXdEZWZlclxuXHRcdFx0XHRcdFx0XHRkZWZlcnJlZFsgdHVwbGVbMV0gXShmdW5jdGlvbigpIHtcblx0XHRcdFx0XHRcdFx0XHR2YXIgcmV0dXJuZWQgPSBmbiAmJiBmbi5hcHBseSggdGhpcywgYXJndW1lbnRzICk7XG5cdFx0XHRcdFx0XHRcdFx0aWYgKCByZXR1cm5lZCAmJiBqUXVlcnkuaXNGdW5jdGlvbiggcmV0dXJuZWQucHJvbWlzZSApICkge1xuXHRcdFx0XHRcdFx0XHRcdFx0cmV0dXJuZWQucHJvbWlzZSgpXG5cdFx0XHRcdFx0XHRcdFx0XHRcdC5kb25lKCBuZXdEZWZlci5yZXNvbHZlIClcblx0XHRcdFx0XHRcdFx0XHRcdFx0LmZhaWwoIG5ld0RlZmVyLnJlamVjdCApXG5cdFx0XHRcdFx0XHRcdFx0XHRcdC5wcm9ncmVzcyggbmV3RGVmZXIubm90aWZ5ICk7XG5cdFx0XHRcdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdFx0XHRcdG5ld0RlZmVyWyB0dXBsZVsgMCBdICsgXCJXaXRoXCIgXSggdGhpcyA9PT0gcHJvbWlzZSA/IG5ld0RlZmVyLnByb21pc2UoKSA6IHRoaXMsIGZuID8gWyByZXR1cm5lZCBdIDogYXJndW1lbnRzICk7XG5cdFx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHR9KTtcblx0XHRcdFx0XHRcdH0pO1xuXHRcdFx0XHRcdFx0Zm5zID0gbnVsbDtcblx0XHRcdFx0XHR9KS5wcm9taXNlKCk7XG5cdFx0XHRcdH0sXG5cdFx0XHRcdC8vIEdldCBhIHByb21pc2UgZm9yIHRoaXMgZGVmZXJyZWRcblx0XHRcdFx0Ly8gSWYgb2JqIGlzIHByb3ZpZGVkLCB0aGUgcHJvbWlzZSBhc3BlY3QgaXMgYWRkZWQgdG8gdGhlIG9iamVjdFxuXHRcdFx0XHRwcm9taXNlOiBmdW5jdGlvbiggb2JqICkge1xuXHRcdFx0XHRcdHJldHVybiBvYmogIT0gbnVsbCA/IGpRdWVyeS5leHRlbmQoIG9iaiwgcHJvbWlzZSApIDogcHJvbWlzZTtcblx0XHRcdFx0fVxuXHRcdFx0fSxcblx0XHRcdGRlZmVycmVkID0ge307XG5cblx0XHQvLyBLZWVwIHBpcGUgZm9yIGJhY2stY29tcGF0XG5cdFx0cHJvbWlzZS5waXBlID0gcHJvbWlzZS50aGVuO1xuXG5cdFx0Ly8gQWRkIGxpc3Qtc3BlY2lmaWMgbWV0aG9kc1xuXHRcdGpRdWVyeS5lYWNoKCB0dXBsZXMsIGZ1bmN0aW9uKCBpLCB0dXBsZSApIHtcblx0XHRcdHZhciBsaXN0ID0gdHVwbGVbIDIgXSxcblx0XHRcdFx0c3RhdGVTdHJpbmcgPSB0dXBsZVsgMyBdO1xuXG5cdFx0XHQvLyBwcm9taXNlWyBkb25lIHwgZmFpbCB8IHByb2dyZXNzIF0gPSBsaXN0LmFkZFxuXHRcdFx0cHJvbWlzZVsgdHVwbGVbMV0gXSA9IGxpc3QuYWRkO1xuXG5cdFx0XHQvLyBIYW5kbGUgc3RhdGVcblx0XHRcdGlmICggc3RhdGVTdHJpbmcgKSB7XG5cdFx0XHRcdGxpc3QuYWRkKGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRcdC8vIHN0YXRlID0gWyByZXNvbHZlZCB8IHJlamVjdGVkIF1cblx0XHRcdFx0XHRzdGF0ZSA9IHN0YXRlU3RyaW5nO1xuXG5cdFx0XHRcdC8vIFsgcmVqZWN0X2xpc3QgfCByZXNvbHZlX2xpc3QgXS5kaXNhYmxlOyBwcm9ncmVzc19saXN0LmxvY2tcblx0XHRcdFx0fSwgdHVwbGVzWyBpIF4gMSBdWyAyIF0uZGlzYWJsZSwgdHVwbGVzWyAyIF1bIDIgXS5sb2NrICk7XG5cdFx0XHR9XG5cblx0XHRcdC8vIGRlZmVycmVkWyByZXNvbHZlIHwgcmVqZWN0IHwgbm90aWZ5IF1cblx0XHRcdGRlZmVycmVkWyB0dXBsZVswXSBdID0gZnVuY3Rpb24oKSB7XG5cdFx0XHRcdGRlZmVycmVkWyB0dXBsZVswXSArIFwiV2l0aFwiIF0oIHRoaXMgPT09IGRlZmVycmVkID8gcHJvbWlzZSA6IHRoaXMsIGFyZ3VtZW50cyApO1xuXHRcdFx0XHRyZXR1cm4gdGhpcztcblx0XHRcdH07XG5cdFx0XHRkZWZlcnJlZFsgdHVwbGVbMF0gKyBcIldpdGhcIiBdID0gbGlzdC5maXJlV2l0aDtcblx0XHR9KTtcblxuXHRcdC8vIE1ha2UgdGhlIGRlZmVycmVkIGEgcHJvbWlzZVxuXHRcdHByb21pc2UucHJvbWlzZSggZGVmZXJyZWQgKTtcblxuXHRcdC8vIENhbGwgZ2l2ZW4gZnVuYyBpZiBhbnlcblx0XHRpZiAoIGZ1bmMgKSB7XG5cdFx0XHRmdW5jLmNhbGwoIGRlZmVycmVkLCBkZWZlcnJlZCApO1xuXHRcdH1cblxuXHRcdC8vIEFsbCBkb25lIVxuXHRcdHJldHVybiBkZWZlcnJlZDtcblx0fSxcblxuXHQvLyBEZWZlcnJlZCBoZWxwZXJcblx0d2hlbjogZnVuY3Rpb24oIHN1Ym9yZGluYXRlIC8qICwgLi4uLCBzdWJvcmRpbmF0ZU4gKi8gKSB7XG5cdFx0dmFyIGkgPSAwLFxuXHRcdFx0cmVzb2x2ZVZhbHVlcyA9IHNsaWNlLmNhbGwoIGFyZ3VtZW50cyApLFxuXHRcdFx0bGVuZ3RoID0gcmVzb2x2ZVZhbHVlcy5sZW5ndGgsXG5cblx0XHRcdC8vIHRoZSBjb3VudCBvZiB1bmNvbXBsZXRlZCBzdWJvcmRpbmF0ZXNcblx0XHRcdHJlbWFpbmluZyA9IGxlbmd0aCAhPT0gMSB8fCAoIHN1Ym9yZGluYXRlICYmIGpRdWVyeS5pc0Z1bmN0aW9uKCBzdWJvcmRpbmF0ZS5wcm9taXNlICkgKSA/IGxlbmd0aCA6IDAsXG5cblx0XHRcdC8vIHRoZSBtYXN0ZXIgRGVmZXJyZWQuIElmIHJlc29sdmVWYWx1ZXMgY29uc2lzdCBvZiBvbmx5IGEgc2luZ2xlIERlZmVycmVkLCBqdXN0IHVzZSB0aGF0LlxuXHRcdFx0ZGVmZXJyZWQgPSByZW1haW5pbmcgPT09IDEgPyBzdWJvcmRpbmF0ZSA6IGpRdWVyeS5EZWZlcnJlZCgpLFxuXG5cdFx0XHQvLyBVcGRhdGUgZnVuY3Rpb24gZm9yIGJvdGggcmVzb2x2ZSBhbmQgcHJvZ3Jlc3MgdmFsdWVzXG5cdFx0XHR1cGRhdGVGdW5jID0gZnVuY3Rpb24oIGksIGNvbnRleHRzLCB2YWx1ZXMgKSB7XG5cdFx0XHRcdHJldHVybiBmdW5jdGlvbiggdmFsdWUgKSB7XG5cdFx0XHRcdFx0Y29udGV4dHNbIGkgXSA9IHRoaXM7XG5cdFx0XHRcdFx0dmFsdWVzWyBpIF0gPSBhcmd1bWVudHMubGVuZ3RoID4gMSA/IHNsaWNlLmNhbGwoIGFyZ3VtZW50cyApIDogdmFsdWU7XG5cdFx0XHRcdFx0aWYgKCB2YWx1ZXMgPT09IHByb2dyZXNzVmFsdWVzICkge1xuXHRcdFx0XHRcdFx0ZGVmZXJyZWQubm90aWZ5V2l0aCggY29udGV4dHMsIHZhbHVlcyApO1xuXHRcdFx0XHRcdH0gZWxzZSBpZiAoICEoIC0tcmVtYWluaW5nICkgKSB7XG5cdFx0XHRcdFx0XHRkZWZlcnJlZC5yZXNvbHZlV2l0aCggY29udGV4dHMsIHZhbHVlcyApO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fTtcblx0XHRcdH0sXG5cblx0XHRcdHByb2dyZXNzVmFsdWVzLCBwcm9ncmVzc0NvbnRleHRzLCByZXNvbHZlQ29udGV4dHM7XG5cblx0XHQvLyBBZGQgbGlzdGVuZXJzIHRvIERlZmVycmVkIHN1Ym9yZGluYXRlczsgdHJlYXQgb3RoZXJzIGFzIHJlc29sdmVkXG5cdFx0aWYgKCBsZW5ndGggPiAxICkge1xuXHRcdFx0cHJvZ3Jlc3NWYWx1ZXMgPSBuZXcgQXJyYXkoIGxlbmd0aCApO1xuXHRcdFx0cHJvZ3Jlc3NDb250ZXh0cyA9IG5ldyBBcnJheSggbGVuZ3RoICk7XG5cdFx0XHRyZXNvbHZlQ29udGV4dHMgPSBuZXcgQXJyYXkoIGxlbmd0aCApO1xuXHRcdFx0Zm9yICggOyBpIDwgbGVuZ3RoOyBpKysgKSB7XG5cdFx0XHRcdGlmICggcmVzb2x2ZVZhbHVlc1sgaSBdICYmIGpRdWVyeS5pc0Z1bmN0aW9uKCByZXNvbHZlVmFsdWVzWyBpIF0ucHJvbWlzZSApICkge1xuXHRcdFx0XHRcdHJlc29sdmVWYWx1ZXNbIGkgXS5wcm9taXNlKClcblx0XHRcdFx0XHRcdC5kb25lKCB1cGRhdGVGdW5jKCBpLCByZXNvbHZlQ29udGV4dHMsIHJlc29sdmVWYWx1ZXMgKSApXG5cdFx0XHRcdFx0XHQuZmFpbCggZGVmZXJyZWQucmVqZWN0IClcblx0XHRcdFx0XHRcdC5wcm9ncmVzcyggdXBkYXRlRnVuYyggaSwgcHJvZ3Jlc3NDb250ZXh0cywgcHJvZ3Jlc3NWYWx1ZXMgKSApO1xuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdC0tcmVtYWluaW5nO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0Ly8gSWYgd2UncmUgbm90IHdhaXRpbmcgb24gYW55dGhpbmcsIHJlc29sdmUgdGhlIG1hc3RlclxuXHRcdGlmICggIXJlbWFpbmluZyApIHtcblx0XHRcdGRlZmVycmVkLnJlc29sdmVXaXRoKCByZXNvbHZlQ29udGV4dHMsIHJlc29sdmVWYWx1ZXMgKTtcblx0XHR9XG5cblx0XHRyZXR1cm4gZGVmZXJyZWQucHJvbWlzZSgpO1xuXHR9XG59KTtcblxuXG4vLyBUaGUgZGVmZXJyZWQgdXNlZCBvbiBET00gcmVhZHlcbnZhciByZWFkeUxpc3Q7XG5cbmpRdWVyeS5mbi5yZWFkeSA9IGZ1bmN0aW9uKCBmbiApIHtcblx0Ly8gQWRkIHRoZSBjYWxsYmFja1xuXHRqUXVlcnkucmVhZHkucHJvbWlzZSgpLmRvbmUoIGZuICk7XG5cblx0cmV0dXJuIHRoaXM7XG59O1xuXG5qUXVlcnkuZXh0ZW5kKHtcblx0Ly8gSXMgdGhlIERPTSByZWFkeSB0byBiZSB1c2VkPyBTZXQgdG8gdHJ1ZSBvbmNlIGl0IG9jY3Vycy5cblx0aXNSZWFkeTogZmFsc2UsXG5cblx0Ly8gQSBjb3VudGVyIHRvIHRyYWNrIGhvdyBtYW55IGl0ZW1zIHRvIHdhaXQgZm9yIGJlZm9yZVxuXHQvLyB0aGUgcmVhZHkgZXZlbnQgZmlyZXMuIFNlZSAjNjc4MVxuXHRyZWFkeVdhaXQ6IDEsXG5cblx0Ly8gSG9sZCAob3IgcmVsZWFzZSkgdGhlIHJlYWR5IGV2ZW50XG5cdGhvbGRSZWFkeTogZnVuY3Rpb24oIGhvbGQgKSB7XG5cdFx0aWYgKCBob2xkICkge1xuXHRcdFx0alF1ZXJ5LnJlYWR5V2FpdCsrO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRqUXVlcnkucmVhZHkoIHRydWUgKTtcblx0XHR9XG5cdH0sXG5cblx0Ly8gSGFuZGxlIHdoZW4gdGhlIERPTSBpcyByZWFkeVxuXHRyZWFkeTogZnVuY3Rpb24oIHdhaXQgKSB7XG5cblx0XHQvLyBBYm9ydCBpZiB0aGVyZSBhcmUgcGVuZGluZyBob2xkcyBvciB3ZSdyZSBhbHJlYWR5IHJlYWR5XG5cdFx0aWYgKCB3YWl0ID09PSB0cnVlID8gLS1qUXVlcnkucmVhZHlXYWl0IDogalF1ZXJ5LmlzUmVhZHkgKSB7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXG5cdFx0Ly8gUmVtZW1iZXIgdGhhdCB0aGUgRE9NIGlzIHJlYWR5XG5cdFx0alF1ZXJ5LmlzUmVhZHkgPSB0cnVlO1xuXG5cdFx0Ly8gSWYgYSBub3JtYWwgRE9NIFJlYWR5IGV2ZW50IGZpcmVkLCBkZWNyZW1lbnQsIGFuZCB3YWl0IGlmIG5lZWQgYmVcblx0XHRpZiAoIHdhaXQgIT09IHRydWUgJiYgLS1qUXVlcnkucmVhZHlXYWl0ID4gMCApIHtcblx0XHRcdHJldHVybjtcblx0XHR9XG5cblx0XHQvLyBJZiB0aGVyZSBhcmUgZnVuY3Rpb25zIGJvdW5kLCB0byBleGVjdXRlXG5cdFx0cmVhZHlMaXN0LnJlc29sdmVXaXRoKCBkb2N1bWVudCwgWyBqUXVlcnkgXSApO1xuXG5cdFx0Ly8gVHJpZ2dlciBhbnkgYm91bmQgcmVhZHkgZXZlbnRzXG5cdFx0aWYgKCBqUXVlcnkuZm4udHJpZ2dlckhhbmRsZXIgKSB7XG5cdFx0XHRqUXVlcnkoIGRvY3VtZW50ICkudHJpZ2dlckhhbmRsZXIoIFwicmVhZHlcIiApO1xuXHRcdFx0alF1ZXJ5KCBkb2N1bWVudCApLm9mZiggXCJyZWFkeVwiICk7XG5cdFx0fVxuXHR9XG59KTtcblxuLyoqXG4gKiBUaGUgcmVhZHkgZXZlbnQgaGFuZGxlciBhbmQgc2VsZiBjbGVhbnVwIG1ldGhvZFxuICovXG5mdW5jdGlvbiBjb21wbGV0ZWQoKSB7XG5cdGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoIFwiRE9NQ29udGVudExvYWRlZFwiLCBjb21wbGV0ZWQsIGZhbHNlICk7XG5cdHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKCBcImxvYWRcIiwgY29tcGxldGVkLCBmYWxzZSApO1xuXHRqUXVlcnkucmVhZHkoKTtcbn1cblxualF1ZXJ5LnJlYWR5LnByb21pc2UgPSBmdW5jdGlvbiggb2JqICkge1xuXHRpZiAoICFyZWFkeUxpc3QgKSB7XG5cblx0XHRyZWFkeUxpc3QgPSBqUXVlcnkuRGVmZXJyZWQoKTtcblxuXHRcdC8vIENhdGNoIGNhc2VzIHdoZXJlICQoZG9jdW1lbnQpLnJlYWR5KCkgaXMgY2FsbGVkIGFmdGVyIHRoZSBicm93c2VyIGV2ZW50IGhhcyBhbHJlYWR5IG9jY3VycmVkLlxuXHRcdC8vIFdlIG9uY2UgdHJpZWQgdG8gdXNlIHJlYWR5U3RhdGUgXCJpbnRlcmFjdGl2ZVwiIGhlcmUsIGJ1dCBpdCBjYXVzZWQgaXNzdWVzIGxpa2UgdGhlIG9uZVxuXHRcdC8vIGRpc2NvdmVyZWQgYnkgQ2hyaXNTIGhlcmU6IGh0dHA6Ly9idWdzLmpxdWVyeS5jb20vdGlja2V0LzEyMjgyI2NvbW1lbnQ6MTVcblx0XHRpZiAoIGRvY3VtZW50LnJlYWR5U3RhdGUgPT09IFwiY29tcGxldGVcIiApIHtcblx0XHRcdC8vIEhhbmRsZSBpdCBhc3luY2hyb25vdXNseSB0byBhbGxvdyBzY3JpcHRzIHRoZSBvcHBvcnR1bml0eSB0byBkZWxheSByZWFkeVxuXHRcdFx0c2V0VGltZW91dCggalF1ZXJ5LnJlYWR5ICk7XG5cblx0XHR9IGVsc2Uge1xuXG5cdFx0XHQvLyBVc2UgdGhlIGhhbmR5IGV2ZW50IGNhbGxiYWNrXG5cdFx0XHRkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCBcIkRPTUNvbnRlbnRMb2FkZWRcIiwgY29tcGxldGVkLCBmYWxzZSApO1xuXG5cdFx0XHQvLyBBIGZhbGxiYWNrIHRvIHdpbmRvdy5vbmxvYWQsIHRoYXQgd2lsbCBhbHdheXMgd29ya1xuXHRcdFx0d2luZG93LmFkZEV2ZW50TGlzdGVuZXIoIFwibG9hZFwiLCBjb21wbGV0ZWQsIGZhbHNlICk7XG5cdFx0fVxuXHR9XG5cdHJldHVybiByZWFkeUxpc3QucHJvbWlzZSggb2JqICk7XG59O1xuXG4vLyBLaWNrIG9mZiB0aGUgRE9NIHJlYWR5IGNoZWNrIGV2ZW4gaWYgdGhlIHVzZXIgZG9lcyBub3RcbmpRdWVyeS5yZWFkeS5wcm9taXNlKCk7XG5cblxuXG5cbi8vIE11bHRpZnVuY3Rpb25hbCBtZXRob2QgdG8gZ2V0IGFuZCBzZXQgdmFsdWVzIG9mIGEgY29sbGVjdGlvblxuLy8gVGhlIHZhbHVlL3MgY2FuIG9wdGlvbmFsbHkgYmUgZXhlY3V0ZWQgaWYgaXQncyBhIGZ1bmN0aW9uXG52YXIgYWNjZXNzID0galF1ZXJ5LmFjY2VzcyA9IGZ1bmN0aW9uKCBlbGVtcywgZm4sIGtleSwgdmFsdWUsIGNoYWluYWJsZSwgZW1wdHlHZXQsIHJhdyApIHtcblx0dmFyIGkgPSAwLFxuXHRcdGxlbiA9IGVsZW1zLmxlbmd0aCxcblx0XHRidWxrID0ga2V5ID09IG51bGw7XG5cblx0Ly8gU2V0cyBtYW55IHZhbHVlc1xuXHRpZiAoIGpRdWVyeS50eXBlKCBrZXkgKSA9PT0gXCJvYmplY3RcIiApIHtcblx0XHRjaGFpbmFibGUgPSB0cnVlO1xuXHRcdGZvciAoIGkgaW4ga2V5ICkge1xuXHRcdFx0alF1ZXJ5LmFjY2VzcyggZWxlbXMsIGZuLCBpLCBrZXlbaV0sIHRydWUsIGVtcHR5R2V0LCByYXcgKTtcblx0XHR9XG5cblx0Ly8gU2V0cyBvbmUgdmFsdWVcblx0fSBlbHNlIGlmICggdmFsdWUgIT09IHVuZGVmaW5lZCApIHtcblx0XHRjaGFpbmFibGUgPSB0cnVlO1xuXG5cdFx0aWYgKCAhalF1ZXJ5LmlzRnVuY3Rpb24oIHZhbHVlICkgKSB7XG5cdFx0XHRyYXcgPSB0cnVlO1xuXHRcdH1cblxuXHRcdGlmICggYnVsayApIHtcblx0XHRcdC8vIEJ1bGsgb3BlcmF0aW9ucyBydW4gYWdhaW5zdCB0aGUgZW50aXJlIHNldFxuXHRcdFx0aWYgKCByYXcgKSB7XG5cdFx0XHRcdGZuLmNhbGwoIGVsZW1zLCB2YWx1ZSApO1xuXHRcdFx0XHRmbiA9IG51bGw7XG5cblx0XHRcdC8vIC4uLmV4Y2VwdCB3aGVuIGV4ZWN1dGluZyBmdW5jdGlvbiB2YWx1ZXNcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdGJ1bGsgPSBmbjtcblx0XHRcdFx0Zm4gPSBmdW5jdGlvbiggZWxlbSwga2V5LCB2YWx1ZSApIHtcblx0XHRcdFx0XHRyZXR1cm4gYnVsay5jYWxsKCBqUXVlcnkoIGVsZW0gKSwgdmFsdWUgKTtcblx0XHRcdFx0fTtcblx0XHRcdH1cblx0XHR9XG5cblx0XHRpZiAoIGZuICkge1xuXHRcdFx0Zm9yICggOyBpIDwgbGVuOyBpKysgKSB7XG5cdFx0XHRcdGZuKCBlbGVtc1tpXSwga2V5LCByYXcgPyB2YWx1ZSA6IHZhbHVlLmNhbGwoIGVsZW1zW2ldLCBpLCBmbiggZWxlbXNbaV0sIGtleSApICkgKTtcblx0XHRcdH1cblx0XHR9XG5cdH1cblxuXHRyZXR1cm4gY2hhaW5hYmxlID9cblx0XHRlbGVtcyA6XG5cblx0XHQvLyBHZXRzXG5cdFx0YnVsayA/XG5cdFx0XHRmbi5jYWxsKCBlbGVtcyApIDpcblx0XHRcdGxlbiA/IGZuKCBlbGVtc1swXSwga2V5ICkgOiBlbXB0eUdldDtcbn07XG5cblxuLyoqXG4gKiBEZXRlcm1pbmVzIHdoZXRoZXIgYW4gb2JqZWN0IGNhbiBoYXZlIGRhdGFcbiAqL1xualF1ZXJ5LmFjY2VwdERhdGEgPSBmdW5jdGlvbiggb3duZXIgKSB7XG5cdC8vIEFjY2VwdHMgb25seTpcblx0Ly8gIC0gTm9kZVxuXHQvLyAgICAtIE5vZGUuRUxFTUVOVF9OT0RFXG5cdC8vICAgIC0gTm9kZS5ET0NVTUVOVF9OT0RFXG5cdC8vICAtIE9iamVjdFxuXHQvLyAgICAtIEFueVxuXHQvKiBqc2hpbnQgLVcwMTggKi9cblx0cmV0dXJuIG93bmVyLm5vZGVUeXBlID09PSAxIHx8IG93bmVyLm5vZGVUeXBlID09PSA5IHx8ICEoICtvd25lci5ub2RlVHlwZSApO1xufTtcblxuXG5mdW5jdGlvbiBEYXRhKCkge1xuXHQvLyBTdXBwb3J0OiBBbmRyb2lkPDQsXG5cdC8vIE9sZCBXZWJLaXQgZG9lcyBub3QgaGF2ZSBPYmplY3QucHJldmVudEV4dGVuc2lvbnMvZnJlZXplIG1ldGhvZCxcblx0Ly8gcmV0dXJuIG5ldyBlbXB0eSBvYmplY3QgaW5zdGVhZCB3aXRoIG5vIFtbc2V0XV0gYWNjZXNzb3Jcblx0T2JqZWN0LmRlZmluZVByb3BlcnR5KCB0aGlzLmNhY2hlID0ge30sIDAsIHtcblx0XHRnZXQ6IGZ1bmN0aW9uKCkge1xuXHRcdFx0cmV0dXJuIHt9O1xuXHRcdH1cblx0fSk7XG5cblx0dGhpcy5leHBhbmRvID0galF1ZXJ5LmV4cGFuZG8gKyBEYXRhLnVpZCsrO1xufVxuXG5EYXRhLnVpZCA9IDE7XG5EYXRhLmFjY2VwdHMgPSBqUXVlcnkuYWNjZXB0RGF0YTtcblxuRGF0YS5wcm90b3R5cGUgPSB7XG5cdGtleTogZnVuY3Rpb24oIG93bmVyICkge1xuXHRcdC8vIFdlIGNhbiBhY2NlcHQgZGF0YSBmb3Igbm9uLWVsZW1lbnQgbm9kZXMgaW4gbW9kZXJuIGJyb3dzZXJzLFxuXHRcdC8vIGJ1dCB3ZSBzaG91bGQgbm90LCBzZWUgIzgzMzUuXG5cdFx0Ly8gQWx3YXlzIHJldHVybiB0aGUga2V5IGZvciBhIGZyb3plbiBvYmplY3QuXG5cdFx0aWYgKCAhRGF0YS5hY2NlcHRzKCBvd25lciApICkge1xuXHRcdFx0cmV0dXJuIDA7XG5cdFx0fVxuXG5cdFx0dmFyIGRlc2NyaXB0b3IgPSB7fSxcblx0XHRcdC8vIENoZWNrIGlmIHRoZSBvd25lciBvYmplY3QgYWxyZWFkeSBoYXMgYSBjYWNoZSBrZXlcblx0XHRcdHVubG9jayA9IG93bmVyWyB0aGlzLmV4cGFuZG8gXTtcblxuXHRcdC8vIElmIG5vdCwgY3JlYXRlIG9uZVxuXHRcdGlmICggIXVubG9jayApIHtcblx0XHRcdHVubG9jayA9IERhdGEudWlkKys7XG5cblx0XHRcdC8vIFNlY3VyZSBpdCBpbiBhIG5vbi1lbnVtZXJhYmxlLCBub24td3JpdGFibGUgcHJvcGVydHlcblx0XHRcdHRyeSB7XG5cdFx0XHRcdGRlc2NyaXB0b3JbIHRoaXMuZXhwYW5kbyBdID0geyB2YWx1ZTogdW5sb2NrIH07XG5cdFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKCBvd25lciwgZGVzY3JpcHRvciApO1xuXG5cdFx0XHQvLyBTdXBwb3J0OiBBbmRyb2lkPDRcblx0XHRcdC8vIEZhbGxiYWNrIHRvIGEgbGVzcyBzZWN1cmUgZGVmaW5pdGlvblxuXHRcdFx0fSBjYXRjaCAoIGUgKSB7XG5cdFx0XHRcdGRlc2NyaXB0b3JbIHRoaXMuZXhwYW5kbyBdID0gdW5sb2NrO1xuXHRcdFx0XHRqUXVlcnkuZXh0ZW5kKCBvd25lciwgZGVzY3JpcHRvciApO1xuXHRcdFx0fVxuXHRcdH1cblxuXHRcdC8vIEVuc3VyZSB0aGUgY2FjaGUgb2JqZWN0XG5cdFx0aWYgKCAhdGhpcy5jYWNoZVsgdW5sb2NrIF0gKSB7XG5cdFx0XHR0aGlzLmNhY2hlWyB1bmxvY2sgXSA9IHt9O1xuXHRcdH1cblxuXHRcdHJldHVybiB1bmxvY2s7XG5cdH0sXG5cdHNldDogZnVuY3Rpb24oIG93bmVyLCBkYXRhLCB2YWx1ZSApIHtcblx0XHR2YXIgcHJvcCxcblx0XHRcdC8vIFRoZXJlIG1heSBiZSBhbiB1bmxvY2sgYXNzaWduZWQgdG8gdGhpcyBub2RlLFxuXHRcdFx0Ly8gaWYgdGhlcmUgaXMgbm8gZW50cnkgZm9yIHRoaXMgXCJvd25lclwiLCBjcmVhdGUgb25lIGlubGluZVxuXHRcdFx0Ly8gYW5kIHNldCB0aGUgdW5sb2NrIGFzIHRob3VnaCBhbiBvd25lciBlbnRyeSBoYWQgYWx3YXlzIGV4aXN0ZWRcblx0XHRcdHVubG9jayA9IHRoaXMua2V5KCBvd25lciApLFxuXHRcdFx0Y2FjaGUgPSB0aGlzLmNhY2hlWyB1bmxvY2sgXTtcblxuXHRcdC8vIEhhbmRsZTogWyBvd25lciwga2V5LCB2YWx1ZSBdIGFyZ3Ncblx0XHRpZiAoIHR5cGVvZiBkYXRhID09PSBcInN0cmluZ1wiICkge1xuXHRcdFx0Y2FjaGVbIGRhdGEgXSA9IHZhbHVlO1xuXG5cdFx0Ly8gSGFuZGxlOiBbIG93bmVyLCB7IHByb3BlcnRpZXMgfSBdIGFyZ3Ncblx0XHR9IGVsc2Uge1xuXHRcdFx0Ly8gRnJlc2ggYXNzaWdubWVudHMgYnkgb2JqZWN0IGFyZSBzaGFsbG93IGNvcGllZFxuXHRcdFx0aWYgKCBqUXVlcnkuaXNFbXB0eU9iamVjdCggY2FjaGUgKSApIHtcblx0XHRcdFx0alF1ZXJ5LmV4dGVuZCggdGhpcy5jYWNoZVsgdW5sb2NrIF0sIGRhdGEgKTtcblx0XHRcdC8vIE90aGVyd2lzZSwgY29weSB0aGUgcHJvcGVydGllcyBvbmUtYnktb25lIHRvIHRoZSBjYWNoZSBvYmplY3Rcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdGZvciAoIHByb3AgaW4gZGF0YSApIHtcblx0XHRcdFx0XHRjYWNoZVsgcHJvcCBdID0gZGF0YVsgcHJvcCBdO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fVxuXHRcdHJldHVybiBjYWNoZTtcblx0fSxcblx0Z2V0OiBmdW5jdGlvbiggb3duZXIsIGtleSApIHtcblx0XHQvLyBFaXRoZXIgYSB2YWxpZCBjYWNoZSBpcyBmb3VuZCwgb3Igd2lsbCBiZSBjcmVhdGVkLlxuXHRcdC8vIE5ldyBjYWNoZXMgd2lsbCBiZSBjcmVhdGVkIGFuZCB0aGUgdW5sb2NrIHJldHVybmVkLFxuXHRcdC8vIGFsbG93aW5nIGRpcmVjdCBhY2Nlc3MgdG8gdGhlIG5ld2x5IGNyZWF0ZWRcblx0XHQvLyBlbXB0eSBkYXRhIG9iamVjdC4gQSB2YWxpZCBvd25lciBvYmplY3QgbXVzdCBiZSBwcm92aWRlZC5cblx0XHR2YXIgY2FjaGUgPSB0aGlzLmNhY2hlWyB0aGlzLmtleSggb3duZXIgKSBdO1xuXG5cdFx0cmV0dXJuIGtleSA9PT0gdW5kZWZpbmVkID9cblx0XHRcdGNhY2hlIDogY2FjaGVbIGtleSBdO1xuXHR9LFxuXHRhY2Nlc3M6IGZ1bmN0aW9uKCBvd25lciwga2V5LCB2YWx1ZSApIHtcblx0XHR2YXIgc3RvcmVkO1xuXHRcdC8vIEluIGNhc2VzIHdoZXJlIGVpdGhlcjpcblx0XHQvL1xuXHRcdC8vICAgMS4gTm8ga2V5IHdhcyBzcGVjaWZpZWRcblx0XHQvLyAgIDIuIEEgc3RyaW5nIGtleSB3YXMgc3BlY2lmaWVkLCBidXQgbm8gdmFsdWUgcHJvdmlkZWRcblx0XHQvL1xuXHRcdC8vIFRha2UgdGhlIFwicmVhZFwiIHBhdGggYW5kIGFsbG93IHRoZSBnZXQgbWV0aG9kIHRvIGRldGVybWluZVxuXHRcdC8vIHdoaWNoIHZhbHVlIHRvIHJldHVybiwgcmVzcGVjdGl2ZWx5IGVpdGhlcjpcblx0XHQvL1xuXHRcdC8vICAgMS4gVGhlIGVudGlyZSBjYWNoZSBvYmplY3Rcblx0XHQvLyAgIDIuIFRoZSBkYXRhIHN0b3JlZCBhdCB0aGUga2V5XG5cdFx0Ly9cblx0XHRpZiAoIGtleSA9PT0gdW5kZWZpbmVkIHx8XG5cdFx0XHRcdCgoa2V5ICYmIHR5cGVvZiBrZXkgPT09IFwic3RyaW5nXCIpICYmIHZhbHVlID09PSB1bmRlZmluZWQpICkge1xuXG5cdFx0XHRzdG9yZWQgPSB0aGlzLmdldCggb3duZXIsIGtleSApO1xuXG5cdFx0XHRyZXR1cm4gc3RvcmVkICE9PSB1bmRlZmluZWQgP1xuXHRcdFx0XHRzdG9yZWQgOiB0aGlzLmdldCggb3duZXIsIGpRdWVyeS5jYW1lbENhc2Uoa2V5KSApO1xuXHRcdH1cblxuXHRcdC8vIFsqXVdoZW4gdGhlIGtleSBpcyBub3QgYSBzdHJpbmcsIG9yIGJvdGggYSBrZXkgYW5kIHZhbHVlXG5cdFx0Ly8gYXJlIHNwZWNpZmllZCwgc2V0IG9yIGV4dGVuZCAoZXhpc3Rpbmcgb2JqZWN0cykgd2l0aCBlaXRoZXI6XG5cdFx0Ly9cblx0XHQvLyAgIDEuIEFuIG9iamVjdCBvZiBwcm9wZXJ0aWVzXG5cdFx0Ly8gICAyLiBBIGtleSBhbmQgdmFsdWVcblx0XHQvL1xuXHRcdHRoaXMuc2V0KCBvd25lciwga2V5LCB2YWx1ZSApO1xuXG5cdFx0Ly8gU2luY2UgdGhlIFwic2V0XCIgcGF0aCBjYW4gaGF2ZSB0d28gcG9zc2libGUgZW50cnkgcG9pbnRzXG5cdFx0Ly8gcmV0dXJuIHRoZSBleHBlY3RlZCBkYXRhIGJhc2VkIG9uIHdoaWNoIHBhdGggd2FzIHRha2VuWypdXG5cdFx0cmV0dXJuIHZhbHVlICE9PSB1bmRlZmluZWQgPyB2YWx1ZSA6IGtleTtcblx0fSxcblx0cmVtb3ZlOiBmdW5jdGlvbiggb3duZXIsIGtleSApIHtcblx0XHR2YXIgaSwgbmFtZSwgY2FtZWwsXG5cdFx0XHR1bmxvY2sgPSB0aGlzLmtleSggb3duZXIgKSxcblx0XHRcdGNhY2hlID0gdGhpcy5jYWNoZVsgdW5sb2NrIF07XG5cblx0XHRpZiAoIGtleSA9PT0gdW5kZWZpbmVkICkge1xuXHRcdFx0dGhpcy5jYWNoZVsgdW5sb2NrIF0gPSB7fTtcblxuXHRcdH0gZWxzZSB7XG5cdFx0XHQvLyBTdXBwb3J0IGFycmF5IG9yIHNwYWNlIHNlcGFyYXRlZCBzdHJpbmcgb2Yga2V5c1xuXHRcdFx0aWYgKCBqUXVlcnkuaXNBcnJheSgga2V5ICkgKSB7XG5cdFx0XHRcdC8vIElmIFwibmFtZVwiIGlzIGFuIGFycmF5IG9mIGtleXMuLi5cblx0XHRcdFx0Ly8gV2hlbiBkYXRhIGlzIGluaXRpYWxseSBjcmVhdGVkLCB2aWEgKFwia2V5XCIsIFwidmFsXCIpIHNpZ25hdHVyZSxcblx0XHRcdFx0Ly8ga2V5cyB3aWxsIGJlIGNvbnZlcnRlZCB0byBjYW1lbENhc2UuXG5cdFx0XHRcdC8vIFNpbmNlIHRoZXJlIGlzIG5vIHdheSB0byB0ZWxsIF9ob3dfIGEga2V5IHdhcyBhZGRlZCwgcmVtb3ZlXG5cdFx0XHRcdC8vIGJvdGggcGxhaW4ga2V5IGFuZCBjYW1lbENhc2Uga2V5LiAjMTI3ODZcblx0XHRcdFx0Ly8gVGhpcyB3aWxsIG9ubHkgcGVuYWxpemUgdGhlIGFycmF5IGFyZ3VtZW50IHBhdGguXG5cdFx0XHRcdG5hbWUgPSBrZXkuY29uY2F0KCBrZXkubWFwKCBqUXVlcnkuY2FtZWxDYXNlICkgKTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdGNhbWVsID0galF1ZXJ5LmNhbWVsQ2FzZSgga2V5ICk7XG5cdFx0XHRcdC8vIFRyeSB0aGUgc3RyaW5nIGFzIGEga2V5IGJlZm9yZSBhbnkgbWFuaXB1bGF0aW9uXG5cdFx0XHRcdGlmICgga2V5IGluIGNhY2hlICkge1xuXHRcdFx0XHRcdG5hbWUgPSBbIGtleSwgY2FtZWwgXTtcblx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHQvLyBJZiBhIGtleSB3aXRoIHRoZSBzcGFjZXMgZXhpc3RzLCB1c2UgaXQuXG5cdFx0XHRcdFx0Ly8gT3RoZXJ3aXNlLCBjcmVhdGUgYW4gYXJyYXkgYnkgbWF0Y2hpbmcgbm9uLXdoaXRlc3BhY2Vcblx0XHRcdFx0XHRuYW1lID0gY2FtZWw7XG5cdFx0XHRcdFx0bmFtZSA9IG5hbWUgaW4gY2FjaGUgP1xuXHRcdFx0XHRcdFx0WyBuYW1lIF0gOiAoIG5hbWUubWF0Y2goIHJub3R3aGl0ZSApIHx8IFtdICk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblxuXHRcdFx0aSA9IG5hbWUubGVuZ3RoO1xuXHRcdFx0d2hpbGUgKCBpLS0gKSB7XG5cdFx0XHRcdGRlbGV0ZSBjYWNoZVsgbmFtZVsgaSBdIF07XG5cdFx0XHR9XG5cdFx0fVxuXHR9LFxuXHRoYXNEYXRhOiBmdW5jdGlvbiggb3duZXIgKSB7XG5cdFx0cmV0dXJuICFqUXVlcnkuaXNFbXB0eU9iamVjdChcblx0XHRcdHRoaXMuY2FjaGVbIG93bmVyWyB0aGlzLmV4cGFuZG8gXSBdIHx8IHt9XG5cdFx0KTtcblx0fSxcblx0ZGlzY2FyZDogZnVuY3Rpb24oIG93bmVyICkge1xuXHRcdGlmICggb3duZXJbIHRoaXMuZXhwYW5kbyBdICkge1xuXHRcdFx0ZGVsZXRlIHRoaXMuY2FjaGVbIG93bmVyWyB0aGlzLmV4cGFuZG8gXSBdO1xuXHRcdH1cblx0fVxufTtcbnZhciBkYXRhX3ByaXYgPSBuZXcgRGF0YSgpO1xuXG52YXIgZGF0YV91c2VyID0gbmV3IERhdGEoKTtcblxuXG5cbi8vXHRJbXBsZW1lbnRhdGlvbiBTdW1tYXJ5XG4vL1xuLy9cdDEuIEVuZm9yY2UgQVBJIHN1cmZhY2UgYW5kIHNlbWFudGljIGNvbXBhdGliaWxpdHkgd2l0aCAxLjkueCBicmFuY2hcbi8vXHQyLiBJbXByb3ZlIHRoZSBtb2R1bGUncyBtYWludGFpbmFiaWxpdHkgYnkgcmVkdWNpbmcgdGhlIHN0b3JhZ2Vcbi8vXHRcdHBhdGhzIHRvIGEgc2luZ2xlIG1lY2hhbmlzbS5cbi8vXHQzLiBVc2UgdGhlIHNhbWUgc2luZ2xlIG1lY2hhbmlzbSB0byBzdXBwb3J0IFwicHJpdmF0ZVwiIGFuZCBcInVzZXJcIiBkYXRhLlxuLy9cdDQuIF9OZXZlcl8gZXhwb3NlIFwicHJpdmF0ZVwiIGRhdGEgdG8gdXNlciBjb2RlIChUT0RPOiBEcm9wIF9kYXRhLCBfcmVtb3ZlRGF0YSlcbi8vXHQ1LiBBdm9pZCBleHBvc2luZyBpbXBsZW1lbnRhdGlvbiBkZXRhaWxzIG9uIHVzZXIgb2JqZWN0cyAoZWcuIGV4cGFuZG8gcHJvcGVydGllcylcbi8vXHQ2LiBQcm92aWRlIGEgY2xlYXIgcGF0aCBmb3IgaW1wbGVtZW50YXRpb24gdXBncmFkZSB0byBXZWFrTWFwIGluIDIwMTRcblxudmFyIHJicmFjZSA9IC9eKD86XFx7W1xcd1xcV10qXFx9fFxcW1tcXHdcXFddKlxcXSkkLyxcblx0cm11bHRpRGFzaCA9IC8oW0EtWl0pL2c7XG5cbmZ1bmN0aW9uIGRhdGFBdHRyKCBlbGVtLCBrZXksIGRhdGEgKSB7XG5cdHZhciBuYW1lO1xuXG5cdC8vIElmIG5vdGhpbmcgd2FzIGZvdW5kIGludGVybmFsbHksIHRyeSB0byBmZXRjaCBhbnlcblx0Ly8gZGF0YSBmcm9tIHRoZSBIVE1MNSBkYXRhLSogYXR0cmlidXRlXG5cdGlmICggZGF0YSA9PT0gdW5kZWZpbmVkICYmIGVsZW0ubm9kZVR5cGUgPT09IDEgKSB7XG5cdFx0bmFtZSA9IFwiZGF0YS1cIiArIGtleS5yZXBsYWNlKCBybXVsdGlEYXNoLCBcIi0kMVwiICkudG9Mb3dlckNhc2UoKTtcblx0XHRkYXRhID0gZWxlbS5nZXRBdHRyaWJ1dGUoIG5hbWUgKTtcblxuXHRcdGlmICggdHlwZW9mIGRhdGEgPT09IFwic3RyaW5nXCIgKSB7XG5cdFx0XHR0cnkge1xuXHRcdFx0XHRkYXRhID0gZGF0YSA9PT0gXCJ0cnVlXCIgPyB0cnVlIDpcblx0XHRcdFx0XHRkYXRhID09PSBcImZhbHNlXCIgPyBmYWxzZSA6XG5cdFx0XHRcdFx0ZGF0YSA9PT0gXCJudWxsXCIgPyBudWxsIDpcblx0XHRcdFx0XHQvLyBPbmx5IGNvbnZlcnQgdG8gYSBudW1iZXIgaWYgaXQgZG9lc24ndCBjaGFuZ2UgdGhlIHN0cmluZ1xuXHRcdFx0XHRcdCtkYXRhICsgXCJcIiA9PT0gZGF0YSA/ICtkYXRhIDpcblx0XHRcdFx0XHRyYnJhY2UudGVzdCggZGF0YSApID8galF1ZXJ5LnBhcnNlSlNPTiggZGF0YSApIDpcblx0XHRcdFx0XHRkYXRhO1xuXHRcdFx0fSBjYXRjaCggZSApIHt9XG5cblx0XHRcdC8vIE1ha2Ugc3VyZSB3ZSBzZXQgdGhlIGRhdGEgc28gaXQgaXNuJ3QgY2hhbmdlZCBsYXRlclxuXHRcdFx0ZGF0YV91c2VyLnNldCggZWxlbSwga2V5LCBkYXRhICk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdGRhdGEgPSB1bmRlZmluZWQ7XG5cdFx0fVxuXHR9XG5cdHJldHVybiBkYXRhO1xufVxuXG5qUXVlcnkuZXh0ZW5kKHtcblx0aGFzRGF0YTogZnVuY3Rpb24oIGVsZW0gKSB7XG5cdFx0cmV0dXJuIGRhdGFfdXNlci5oYXNEYXRhKCBlbGVtICkgfHwgZGF0YV9wcml2Lmhhc0RhdGEoIGVsZW0gKTtcblx0fSxcblxuXHRkYXRhOiBmdW5jdGlvbiggZWxlbSwgbmFtZSwgZGF0YSApIHtcblx0XHRyZXR1cm4gZGF0YV91c2VyLmFjY2VzcyggZWxlbSwgbmFtZSwgZGF0YSApO1xuXHR9LFxuXG5cdHJlbW92ZURhdGE6IGZ1bmN0aW9uKCBlbGVtLCBuYW1lICkge1xuXHRcdGRhdGFfdXNlci5yZW1vdmUoIGVsZW0sIG5hbWUgKTtcblx0fSxcblxuXHQvLyBUT0RPOiBOb3cgdGhhdCBhbGwgY2FsbHMgdG8gX2RhdGEgYW5kIF9yZW1vdmVEYXRhIGhhdmUgYmVlbiByZXBsYWNlZFxuXHQvLyB3aXRoIGRpcmVjdCBjYWxscyB0byBkYXRhX3ByaXYgbWV0aG9kcywgdGhlc2UgY2FuIGJlIGRlcHJlY2F0ZWQuXG5cdF9kYXRhOiBmdW5jdGlvbiggZWxlbSwgbmFtZSwgZGF0YSApIHtcblx0XHRyZXR1cm4gZGF0YV9wcml2LmFjY2VzcyggZWxlbSwgbmFtZSwgZGF0YSApO1xuXHR9LFxuXG5cdF9yZW1vdmVEYXRhOiBmdW5jdGlvbiggZWxlbSwgbmFtZSApIHtcblx0XHRkYXRhX3ByaXYucmVtb3ZlKCBlbGVtLCBuYW1lICk7XG5cdH1cbn0pO1xuXG5qUXVlcnkuZm4uZXh0ZW5kKHtcblx0ZGF0YTogZnVuY3Rpb24oIGtleSwgdmFsdWUgKSB7XG5cdFx0dmFyIGksIG5hbWUsIGRhdGEsXG5cdFx0XHRlbGVtID0gdGhpc1sgMCBdLFxuXHRcdFx0YXR0cnMgPSBlbGVtICYmIGVsZW0uYXR0cmlidXRlcztcblxuXHRcdC8vIEdldHMgYWxsIHZhbHVlc1xuXHRcdGlmICgga2V5ID09PSB1bmRlZmluZWQgKSB7XG5cdFx0XHRpZiAoIHRoaXMubGVuZ3RoICkge1xuXHRcdFx0XHRkYXRhID0gZGF0YV91c2VyLmdldCggZWxlbSApO1xuXG5cdFx0XHRcdGlmICggZWxlbS5ub2RlVHlwZSA9PT0gMSAmJiAhZGF0YV9wcml2LmdldCggZWxlbSwgXCJoYXNEYXRhQXR0cnNcIiApICkge1xuXHRcdFx0XHRcdGkgPSBhdHRycy5sZW5ndGg7XG5cdFx0XHRcdFx0d2hpbGUgKCBpLS0gKSB7XG5cblx0XHRcdFx0XHRcdC8vIFN1cHBvcnQ6IElFMTErXG5cdFx0XHRcdFx0XHQvLyBUaGUgYXR0cnMgZWxlbWVudHMgY2FuIGJlIG51bGwgKCMxNDg5NClcblx0XHRcdFx0XHRcdGlmICggYXR0cnNbIGkgXSApIHtcblx0XHRcdFx0XHRcdFx0bmFtZSA9IGF0dHJzWyBpIF0ubmFtZTtcblx0XHRcdFx0XHRcdFx0aWYgKCBuYW1lLmluZGV4T2YoIFwiZGF0YS1cIiApID09PSAwICkge1xuXHRcdFx0XHRcdFx0XHRcdG5hbWUgPSBqUXVlcnkuY2FtZWxDYXNlKCBuYW1lLnNsaWNlKDUpICk7XG5cdFx0XHRcdFx0XHRcdFx0ZGF0YUF0dHIoIGVsZW0sIG5hbWUsIGRhdGFbIG5hbWUgXSApO1xuXHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdGRhdGFfcHJpdi5zZXQoIGVsZW0sIFwiaGFzRGF0YUF0dHJzXCIsIHRydWUgKTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXG5cdFx0XHRyZXR1cm4gZGF0YTtcblx0XHR9XG5cblx0XHQvLyBTZXRzIG11bHRpcGxlIHZhbHVlc1xuXHRcdGlmICggdHlwZW9mIGtleSA9PT0gXCJvYmplY3RcIiApIHtcblx0XHRcdHJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oKSB7XG5cdFx0XHRcdGRhdGFfdXNlci5zZXQoIHRoaXMsIGtleSApO1xuXHRcdFx0fSk7XG5cdFx0fVxuXG5cdFx0cmV0dXJuIGFjY2VzcyggdGhpcywgZnVuY3Rpb24oIHZhbHVlICkge1xuXHRcdFx0dmFyIGRhdGEsXG5cdFx0XHRcdGNhbWVsS2V5ID0galF1ZXJ5LmNhbWVsQ2FzZSgga2V5ICk7XG5cblx0XHRcdC8vIFRoZSBjYWxsaW5nIGpRdWVyeSBvYmplY3QgKGVsZW1lbnQgbWF0Y2hlcykgaXMgbm90IGVtcHR5XG5cdFx0XHQvLyAoYW5kIHRoZXJlZm9yZSBoYXMgYW4gZWxlbWVudCBhcHBlYXJzIGF0IHRoaXNbIDAgXSkgYW5kIHRoZVxuXHRcdFx0Ly8gYHZhbHVlYCBwYXJhbWV0ZXIgd2FzIG5vdCB1bmRlZmluZWQuIEFuIGVtcHR5IGpRdWVyeSBvYmplY3Rcblx0XHRcdC8vIHdpbGwgcmVzdWx0IGluIGB1bmRlZmluZWRgIGZvciBlbGVtID0gdGhpc1sgMCBdIHdoaWNoIHdpbGxcblx0XHRcdC8vIHRocm93IGFuIGV4Y2VwdGlvbiBpZiBhbiBhdHRlbXB0IHRvIHJlYWQgYSBkYXRhIGNhY2hlIGlzIG1hZGUuXG5cdFx0XHRpZiAoIGVsZW0gJiYgdmFsdWUgPT09IHVuZGVmaW5lZCApIHtcblx0XHRcdFx0Ly8gQXR0ZW1wdCB0byBnZXQgZGF0YSBmcm9tIHRoZSBjYWNoZVxuXHRcdFx0XHQvLyB3aXRoIHRoZSBrZXkgYXMtaXNcblx0XHRcdFx0ZGF0YSA9IGRhdGFfdXNlci5nZXQoIGVsZW0sIGtleSApO1xuXHRcdFx0XHRpZiAoIGRhdGEgIT09IHVuZGVmaW5lZCApIHtcblx0XHRcdFx0XHRyZXR1cm4gZGF0YTtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdC8vIEF0dGVtcHQgdG8gZ2V0IGRhdGEgZnJvbSB0aGUgY2FjaGVcblx0XHRcdFx0Ly8gd2l0aCB0aGUga2V5IGNhbWVsaXplZFxuXHRcdFx0XHRkYXRhID0gZGF0YV91c2VyLmdldCggZWxlbSwgY2FtZWxLZXkgKTtcblx0XHRcdFx0aWYgKCBkYXRhICE9PSB1bmRlZmluZWQgKSB7XG5cdFx0XHRcdFx0cmV0dXJuIGRhdGE7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHQvLyBBdHRlbXB0IHRvIFwiZGlzY292ZXJcIiB0aGUgZGF0YSBpblxuXHRcdFx0XHQvLyBIVE1MNSBjdXN0b20gZGF0YS0qIGF0dHJzXG5cdFx0XHRcdGRhdGEgPSBkYXRhQXR0ciggZWxlbSwgY2FtZWxLZXksIHVuZGVmaW5lZCApO1xuXHRcdFx0XHRpZiAoIGRhdGEgIT09IHVuZGVmaW5lZCApIHtcblx0XHRcdFx0XHRyZXR1cm4gZGF0YTtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdC8vIFdlIHRyaWVkIHJlYWxseSBoYXJkLCBidXQgdGhlIGRhdGEgZG9lc24ndCBleGlzdC5cblx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0fVxuXG5cdFx0XHQvLyBTZXQgdGhlIGRhdGEuLi5cblx0XHRcdHRoaXMuZWFjaChmdW5jdGlvbigpIHtcblx0XHRcdFx0Ly8gRmlyc3QsIGF0dGVtcHQgdG8gc3RvcmUgYSBjb3B5IG9yIHJlZmVyZW5jZSBvZiBhbnlcblx0XHRcdFx0Ly8gZGF0YSB0aGF0IG1pZ2h0J3ZlIGJlZW4gc3RvcmUgd2l0aCBhIGNhbWVsQ2FzZWQga2V5LlxuXHRcdFx0XHR2YXIgZGF0YSA9IGRhdGFfdXNlci5nZXQoIHRoaXMsIGNhbWVsS2V5ICk7XG5cblx0XHRcdFx0Ly8gRm9yIEhUTUw1IGRhdGEtKiBhdHRyaWJ1dGUgaW50ZXJvcCwgd2UgaGF2ZSB0b1xuXHRcdFx0XHQvLyBzdG9yZSBwcm9wZXJ0eSBuYW1lcyB3aXRoIGRhc2hlcyBpbiBhIGNhbWVsQ2FzZSBmb3JtLlxuXHRcdFx0XHQvLyBUaGlzIG1pZ2h0IG5vdCBhcHBseSB0byBhbGwgcHJvcGVydGllcy4uLipcblx0XHRcdFx0ZGF0YV91c2VyLnNldCggdGhpcywgY2FtZWxLZXksIHZhbHVlICk7XG5cblx0XHRcdFx0Ly8gKi4uLiBJbiB0aGUgY2FzZSBvZiBwcm9wZXJ0aWVzIHRoYXQgbWlnaHQgX2FjdHVhbGx5X1xuXHRcdFx0XHQvLyBoYXZlIGRhc2hlcywgd2UgbmVlZCB0byBhbHNvIHN0b3JlIGEgY29weSBvZiB0aGF0XG5cdFx0XHRcdC8vIHVuY2hhbmdlZCBwcm9wZXJ0eS5cblx0XHRcdFx0aWYgKCBrZXkuaW5kZXhPZihcIi1cIikgIT09IC0xICYmIGRhdGEgIT09IHVuZGVmaW5lZCApIHtcblx0XHRcdFx0XHRkYXRhX3VzZXIuc2V0KCB0aGlzLCBrZXksIHZhbHVlICk7XG5cdFx0XHRcdH1cblx0XHRcdH0pO1xuXHRcdH0sIG51bGwsIHZhbHVlLCBhcmd1bWVudHMubGVuZ3RoID4gMSwgbnVsbCwgdHJ1ZSApO1xuXHR9LFxuXG5cdHJlbW92ZURhdGE6IGZ1bmN0aW9uKCBrZXkgKSB7XG5cdFx0cmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbigpIHtcblx0XHRcdGRhdGFfdXNlci5yZW1vdmUoIHRoaXMsIGtleSApO1xuXHRcdH0pO1xuXHR9XG59KTtcblxuXG5qUXVlcnkuZXh0ZW5kKHtcblx0cXVldWU6IGZ1bmN0aW9uKCBlbGVtLCB0eXBlLCBkYXRhICkge1xuXHRcdHZhciBxdWV1ZTtcblxuXHRcdGlmICggZWxlbSApIHtcblx0XHRcdHR5cGUgPSAoIHR5cGUgfHwgXCJmeFwiICkgKyBcInF1ZXVlXCI7XG5cdFx0XHRxdWV1ZSA9IGRhdGFfcHJpdi5nZXQoIGVsZW0sIHR5cGUgKTtcblxuXHRcdFx0Ly8gU3BlZWQgdXAgZGVxdWV1ZSBieSBnZXR0aW5nIG91dCBxdWlja2x5IGlmIHRoaXMgaXMganVzdCBhIGxvb2t1cFxuXHRcdFx0aWYgKCBkYXRhICkge1xuXHRcdFx0XHRpZiAoICFxdWV1ZSB8fCBqUXVlcnkuaXNBcnJheSggZGF0YSApICkge1xuXHRcdFx0XHRcdHF1ZXVlID0gZGF0YV9wcml2LmFjY2VzcyggZWxlbSwgdHlwZSwgalF1ZXJ5Lm1ha2VBcnJheShkYXRhKSApO1xuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdHF1ZXVlLnB1c2goIGRhdGEgKTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdFx0cmV0dXJuIHF1ZXVlIHx8IFtdO1xuXHRcdH1cblx0fSxcblxuXHRkZXF1ZXVlOiBmdW5jdGlvbiggZWxlbSwgdHlwZSApIHtcblx0XHR0eXBlID0gdHlwZSB8fCBcImZ4XCI7XG5cblx0XHR2YXIgcXVldWUgPSBqUXVlcnkucXVldWUoIGVsZW0sIHR5cGUgKSxcblx0XHRcdHN0YXJ0TGVuZ3RoID0gcXVldWUubGVuZ3RoLFxuXHRcdFx0Zm4gPSBxdWV1ZS5zaGlmdCgpLFxuXHRcdFx0aG9va3MgPSBqUXVlcnkuX3F1ZXVlSG9va3MoIGVsZW0sIHR5cGUgKSxcblx0XHRcdG5leHQgPSBmdW5jdGlvbigpIHtcblx0XHRcdFx0alF1ZXJ5LmRlcXVldWUoIGVsZW0sIHR5cGUgKTtcblx0XHRcdH07XG5cblx0XHQvLyBJZiB0aGUgZnggcXVldWUgaXMgZGVxdWV1ZWQsIGFsd2F5cyByZW1vdmUgdGhlIHByb2dyZXNzIHNlbnRpbmVsXG5cdFx0aWYgKCBmbiA9PT0gXCJpbnByb2dyZXNzXCIgKSB7XG5cdFx0XHRmbiA9IHF1ZXVlLnNoaWZ0KCk7XG5cdFx0XHRzdGFydExlbmd0aC0tO1xuXHRcdH1cblxuXHRcdGlmICggZm4gKSB7XG5cblx0XHRcdC8vIEFkZCBhIHByb2dyZXNzIHNlbnRpbmVsIHRvIHByZXZlbnQgdGhlIGZ4IHF1ZXVlIGZyb20gYmVpbmdcblx0XHRcdC8vIGF1dG9tYXRpY2FsbHkgZGVxdWV1ZWRcblx0XHRcdGlmICggdHlwZSA9PT0gXCJmeFwiICkge1xuXHRcdFx0XHRxdWV1ZS51bnNoaWZ0KCBcImlucHJvZ3Jlc3NcIiApO1xuXHRcdFx0fVxuXG5cdFx0XHQvLyBDbGVhciB1cCB0aGUgbGFzdCBxdWV1ZSBzdG9wIGZ1bmN0aW9uXG5cdFx0XHRkZWxldGUgaG9va3Muc3RvcDtcblx0XHRcdGZuLmNhbGwoIGVsZW0sIG5leHQsIGhvb2tzICk7XG5cdFx0fVxuXG5cdFx0aWYgKCAhc3RhcnRMZW5ndGggJiYgaG9va3MgKSB7XG5cdFx0XHRob29rcy5lbXB0eS5maXJlKCk7XG5cdFx0fVxuXHR9LFxuXG5cdC8vIE5vdCBwdWJsaWMgLSBnZW5lcmF0ZSBhIHF1ZXVlSG9va3Mgb2JqZWN0LCBvciByZXR1cm4gdGhlIGN1cnJlbnQgb25lXG5cdF9xdWV1ZUhvb2tzOiBmdW5jdGlvbiggZWxlbSwgdHlwZSApIHtcblx0XHR2YXIga2V5ID0gdHlwZSArIFwicXVldWVIb29rc1wiO1xuXHRcdHJldHVybiBkYXRhX3ByaXYuZ2V0KCBlbGVtLCBrZXkgKSB8fCBkYXRhX3ByaXYuYWNjZXNzKCBlbGVtLCBrZXksIHtcblx0XHRcdGVtcHR5OiBqUXVlcnkuQ2FsbGJhY2tzKFwib25jZSBtZW1vcnlcIikuYWRkKGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRkYXRhX3ByaXYucmVtb3ZlKCBlbGVtLCBbIHR5cGUgKyBcInF1ZXVlXCIsIGtleSBdICk7XG5cdFx0XHR9KVxuXHRcdH0pO1xuXHR9XG59KTtcblxualF1ZXJ5LmZuLmV4dGVuZCh7XG5cdHF1ZXVlOiBmdW5jdGlvbiggdHlwZSwgZGF0YSApIHtcblx0XHR2YXIgc2V0dGVyID0gMjtcblxuXHRcdGlmICggdHlwZW9mIHR5cGUgIT09IFwic3RyaW5nXCIgKSB7XG5cdFx0XHRkYXRhID0gdHlwZTtcblx0XHRcdHR5cGUgPSBcImZ4XCI7XG5cdFx0XHRzZXR0ZXItLTtcblx0XHR9XG5cblx0XHRpZiAoIGFyZ3VtZW50cy5sZW5ndGggPCBzZXR0ZXIgKSB7XG5cdFx0XHRyZXR1cm4galF1ZXJ5LnF1ZXVlKCB0aGlzWzBdLCB0eXBlICk7XG5cdFx0fVxuXG5cdFx0cmV0dXJuIGRhdGEgPT09IHVuZGVmaW5lZCA/XG5cdFx0XHR0aGlzIDpcblx0XHRcdHRoaXMuZWFjaChmdW5jdGlvbigpIHtcblx0XHRcdFx0dmFyIHF1ZXVlID0galF1ZXJ5LnF1ZXVlKCB0aGlzLCB0eXBlLCBkYXRhICk7XG5cblx0XHRcdFx0Ly8gRW5zdXJlIGEgaG9va3MgZm9yIHRoaXMgcXVldWVcblx0XHRcdFx0alF1ZXJ5Ll9xdWV1ZUhvb2tzKCB0aGlzLCB0eXBlICk7XG5cblx0XHRcdFx0aWYgKCB0eXBlID09PSBcImZ4XCIgJiYgcXVldWVbMF0gIT09IFwiaW5wcm9ncmVzc1wiICkge1xuXHRcdFx0XHRcdGpRdWVyeS5kZXF1ZXVlKCB0aGlzLCB0eXBlICk7XG5cdFx0XHRcdH1cblx0XHRcdH0pO1xuXHR9LFxuXHRkZXF1ZXVlOiBmdW5jdGlvbiggdHlwZSApIHtcblx0XHRyZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uKCkge1xuXHRcdFx0alF1ZXJ5LmRlcXVldWUoIHRoaXMsIHR5cGUgKTtcblx0XHR9KTtcblx0fSxcblx0Y2xlYXJRdWV1ZTogZnVuY3Rpb24oIHR5cGUgKSB7XG5cdFx0cmV0dXJuIHRoaXMucXVldWUoIHR5cGUgfHwgXCJmeFwiLCBbXSApO1xuXHR9LFxuXHQvLyBHZXQgYSBwcm9taXNlIHJlc29sdmVkIHdoZW4gcXVldWVzIG9mIGEgY2VydGFpbiB0eXBlXG5cdC8vIGFyZSBlbXB0aWVkIChmeCBpcyB0aGUgdHlwZSBieSBkZWZhdWx0KVxuXHRwcm9taXNlOiBmdW5jdGlvbiggdHlwZSwgb2JqICkge1xuXHRcdHZhciB0bXAsXG5cdFx0XHRjb3VudCA9IDEsXG5cdFx0XHRkZWZlciA9IGpRdWVyeS5EZWZlcnJlZCgpLFxuXHRcdFx0ZWxlbWVudHMgPSB0aGlzLFxuXHRcdFx0aSA9IHRoaXMubGVuZ3RoLFxuXHRcdFx0cmVzb2x2ZSA9IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRpZiAoICEoIC0tY291bnQgKSApIHtcblx0XHRcdFx0XHRkZWZlci5yZXNvbHZlV2l0aCggZWxlbWVudHMsIFsgZWxlbWVudHMgXSApO1xuXHRcdFx0XHR9XG5cdFx0XHR9O1xuXG5cdFx0aWYgKCB0eXBlb2YgdHlwZSAhPT0gXCJzdHJpbmdcIiApIHtcblx0XHRcdG9iaiA9IHR5cGU7XG5cdFx0XHR0eXBlID0gdW5kZWZpbmVkO1xuXHRcdH1cblx0XHR0eXBlID0gdHlwZSB8fCBcImZ4XCI7XG5cblx0XHR3aGlsZSAoIGktLSApIHtcblx0XHRcdHRtcCA9IGRhdGFfcHJpdi5nZXQoIGVsZW1lbnRzWyBpIF0sIHR5cGUgKyBcInF1ZXVlSG9va3NcIiApO1xuXHRcdFx0aWYgKCB0bXAgJiYgdG1wLmVtcHR5ICkge1xuXHRcdFx0XHRjb3VudCsrO1xuXHRcdFx0XHR0bXAuZW1wdHkuYWRkKCByZXNvbHZlICk7XG5cdFx0XHR9XG5cdFx0fVxuXHRcdHJlc29sdmUoKTtcblx0XHRyZXR1cm4gZGVmZXIucHJvbWlzZSggb2JqICk7XG5cdH1cbn0pO1xudmFyIHBudW0gPSAoL1srLV0/KD86XFxkKlxcLnwpXFxkKyg/OltlRV1bKy1dP1xcZCt8KS8pLnNvdXJjZTtcblxudmFyIGNzc0V4cGFuZCA9IFsgXCJUb3BcIiwgXCJSaWdodFwiLCBcIkJvdHRvbVwiLCBcIkxlZnRcIiBdO1xuXG52YXIgaXNIaWRkZW4gPSBmdW5jdGlvbiggZWxlbSwgZWwgKSB7XG5cdFx0Ly8gaXNIaWRkZW4gbWlnaHQgYmUgY2FsbGVkIGZyb20galF1ZXJ5I2ZpbHRlciBmdW5jdGlvbjtcblx0XHQvLyBpbiB0aGF0IGNhc2UsIGVsZW1lbnQgd2lsbCBiZSBzZWNvbmQgYXJndW1lbnRcblx0XHRlbGVtID0gZWwgfHwgZWxlbTtcblx0XHRyZXR1cm4galF1ZXJ5LmNzcyggZWxlbSwgXCJkaXNwbGF5XCIgKSA9PT0gXCJub25lXCIgfHwgIWpRdWVyeS5jb250YWlucyggZWxlbS5vd25lckRvY3VtZW50LCBlbGVtICk7XG5cdH07XG5cbnZhciByY2hlY2thYmxlVHlwZSA9ICgvXig/OmNoZWNrYm94fHJhZGlvKSQvaSk7XG5cblxuXG4oZnVuY3Rpb24oKSB7XG5cdHZhciBmcmFnbWVudCA9IGRvY3VtZW50LmNyZWF0ZURvY3VtZW50RnJhZ21lbnQoKSxcblx0XHRkaXYgPSBmcmFnbWVudC5hcHBlbmRDaGlsZCggZG9jdW1lbnQuY3JlYXRlRWxlbWVudCggXCJkaXZcIiApICksXG5cdFx0aW5wdXQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCBcImlucHV0XCIgKTtcblxuXHQvLyBTdXBwb3J0OiBTYWZhcmk8PTUuMVxuXHQvLyBDaGVjayBzdGF0ZSBsb3N0IGlmIHRoZSBuYW1lIGlzIHNldCAoIzExMjE3KVxuXHQvLyBTdXBwb3J0OiBXaW5kb3dzIFdlYiBBcHBzIChXV0EpXG5cdC8vIGBuYW1lYCBhbmQgYHR5cGVgIG11c3QgdXNlIC5zZXRBdHRyaWJ1dGUgZm9yIFdXQSAoIzE0OTAxKVxuXHRpbnB1dC5zZXRBdHRyaWJ1dGUoIFwidHlwZVwiLCBcInJhZGlvXCIgKTtcblx0aW5wdXQuc2V0QXR0cmlidXRlKCBcImNoZWNrZWRcIiwgXCJjaGVja2VkXCIgKTtcblx0aW5wdXQuc2V0QXR0cmlidXRlKCBcIm5hbWVcIiwgXCJ0XCIgKTtcblxuXHRkaXYuYXBwZW5kQ2hpbGQoIGlucHV0ICk7XG5cblx0Ly8gU3VwcG9ydDogU2FmYXJpPD01LjEsIEFuZHJvaWQ8NC4yXG5cdC8vIE9sZGVyIFdlYktpdCBkb2Vzbid0IGNsb25lIGNoZWNrZWQgc3RhdGUgY29ycmVjdGx5IGluIGZyYWdtZW50c1xuXHRzdXBwb3J0LmNoZWNrQ2xvbmUgPSBkaXYuY2xvbmVOb2RlKCB0cnVlICkuY2xvbmVOb2RlKCB0cnVlICkubGFzdENoaWxkLmNoZWNrZWQ7XG5cblx0Ly8gU3VwcG9ydDogSUU8PTExK1xuXHQvLyBNYWtlIHN1cmUgdGV4dGFyZWEgKGFuZCBjaGVja2JveCkgZGVmYXVsdFZhbHVlIGlzIHByb3Blcmx5IGNsb25lZFxuXHRkaXYuaW5uZXJIVE1MID0gXCI8dGV4dGFyZWE+eDwvdGV4dGFyZWE+XCI7XG5cdHN1cHBvcnQubm9DbG9uZUNoZWNrZWQgPSAhIWRpdi5jbG9uZU5vZGUoIHRydWUgKS5sYXN0Q2hpbGQuZGVmYXVsdFZhbHVlO1xufSkoKTtcbnZhciBzdHJ1bmRlZmluZWQgPSB0eXBlb2YgdW5kZWZpbmVkO1xuXG5cblxuc3VwcG9ydC5mb2N1c2luQnViYmxlcyA9IFwib25mb2N1c2luXCIgaW4gd2luZG93O1xuXG5cbnZhclxuXHRya2V5RXZlbnQgPSAvXmtleS8sXG5cdHJtb3VzZUV2ZW50ID0gL14oPzptb3VzZXxwb2ludGVyfGNvbnRleHRtZW51KXxjbGljay8sXG5cdHJmb2N1c01vcnBoID0gL14oPzpmb2N1c2luZm9jdXN8Zm9jdXNvdXRibHVyKSQvLFxuXHRydHlwZW5hbWVzcGFjZSA9IC9eKFteLl0qKSg/OlxcLiguKyl8KSQvO1xuXG5mdW5jdGlvbiByZXR1cm5UcnVlKCkge1xuXHRyZXR1cm4gdHJ1ZTtcbn1cblxuZnVuY3Rpb24gcmV0dXJuRmFsc2UoKSB7XG5cdHJldHVybiBmYWxzZTtcbn1cblxuZnVuY3Rpb24gc2FmZUFjdGl2ZUVsZW1lbnQoKSB7XG5cdHRyeSB7XG5cdFx0cmV0dXJuIGRvY3VtZW50LmFjdGl2ZUVsZW1lbnQ7XG5cdH0gY2F0Y2ggKCBlcnIgKSB7IH1cbn1cblxuLypcbiAqIEhlbHBlciBmdW5jdGlvbnMgZm9yIG1hbmFnaW5nIGV2ZW50cyAtLSBub3QgcGFydCBvZiB0aGUgcHVibGljIGludGVyZmFjZS5cbiAqIFByb3BzIHRvIERlYW4gRWR3YXJkcycgYWRkRXZlbnQgbGlicmFyeSBmb3IgbWFueSBvZiB0aGUgaWRlYXMuXG4gKi9cbmpRdWVyeS5ldmVudCA9IHtcblxuXHRnbG9iYWw6IHt9LFxuXG5cdGFkZDogZnVuY3Rpb24oIGVsZW0sIHR5cGVzLCBoYW5kbGVyLCBkYXRhLCBzZWxlY3RvciApIHtcblxuXHRcdHZhciBoYW5kbGVPYmpJbiwgZXZlbnRIYW5kbGUsIHRtcCxcblx0XHRcdGV2ZW50cywgdCwgaGFuZGxlT2JqLFxuXHRcdFx0c3BlY2lhbCwgaGFuZGxlcnMsIHR5cGUsIG5hbWVzcGFjZXMsIG9yaWdUeXBlLFxuXHRcdFx0ZWxlbURhdGEgPSBkYXRhX3ByaXYuZ2V0KCBlbGVtICk7XG5cblx0XHQvLyBEb24ndCBhdHRhY2ggZXZlbnRzIHRvIG5vRGF0YSBvciB0ZXh0L2NvbW1lbnQgbm9kZXMgKGJ1dCBhbGxvdyBwbGFpbiBvYmplY3RzKVxuXHRcdGlmICggIWVsZW1EYXRhICkge1xuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblxuXHRcdC8vIENhbGxlciBjYW4gcGFzcyBpbiBhbiBvYmplY3Qgb2YgY3VzdG9tIGRhdGEgaW4gbGlldSBvZiB0aGUgaGFuZGxlclxuXHRcdGlmICggaGFuZGxlci5oYW5kbGVyICkge1xuXHRcdFx0aGFuZGxlT2JqSW4gPSBoYW5kbGVyO1xuXHRcdFx0aGFuZGxlciA9IGhhbmRsZU9iakluLmhhbmRsZXI7XG5cdFx0XHRzZWxlY3RvciA9IGhhbmRsZU9iakluLnNlbGVjdG9yO1xuXHRcdH1cblxuXHRcdC8vIE1ha2Ugc3VyZSB0aGF0IHRoZSBoYW5kbGVyIGhhcyBhIHVuaXF1ZSBJRCwgdXNlZCB0byBmaW5kL3JlbW92ZSBpdCBsYXRlclxuXHRcdGlmICggIWhhbmRsZXIuZ3VpZCApIHtcblx0XHRcdGhhbmRsZXIuZ3VpZCA9IGpRdWVyeS5ndWlkKys7XG5cdFx0fVxuXG5cdFx0Ly8gSW5pdCB0aGUgZWxlbWVudCdzIGV2ZW50IHN0cnVjdHVyZSBhbmQgbWFpbiBoYW5kbGVyLCBpZiB0aGlzIGlzIHRoZSBmaXJzdFxuXHRcdGlmICggIShldmVudHMgPSBlbGVtRGF0YS5ldmVudHMpICkge1xuXHRcdFx0ZXZlbnRzID0gZWxlbURhdGEuZXZlbnRzID0ge307XG5cdFx0fVxuXHRcdGlmICggIShldmVudEhhbmRsZSA9IGVsZW1EYXRhLmhhbmRsZSkgKSB7XG5cdFx0XHRldmVudEhhbmRsZSA9IGVsZW1EYXRhLmhhbmRsZSA9IGZ1bmN0aW9uKCBlICkge1xuXHRcdFx0XHQvLyBEaXNjYXJkIHRoZSBzZWNvbmQgZXZlbnQgb2YgYSBqUXVlcnkuZXZlbnQudHJpZ2dlcigpIGFuZFxuXHRcdFx0XHQvLyB3aGVuIGFuIGV2ZW50IGlzIGNhbGxlZCBhZnRlciBhIHBhZ2UgaGFzIHVubG9hZGVkXG5cdFx0XHRcdHJldHVybiB0eXBlb2YgalF1ZXJ5ICE9PSBzdHJ1bmRlZmluZWQgJiYgalF1ZXJ5LmV2ZW50LnRyaWdnZXJlZCAhPT0gZS50eXBlID9cblx0XHRcdFx0XHRqUXVlcnkuZXZlbnQuZGlzcGF0Y2guYXBwbHkoIGVsZW0sIGFyZ3VtZW50cyApIDogdW5kZWZpbmVkO1xuXHRcdFx0fTtcblx0XHR9XG5cblx0XHQvLyBIYW5kbGUgbXVsdGlwbGUgZXZlbnRzIHNlcGFyYXRlZCBieSBhIHNwYWNlXG5cdFx0dHlwZXMgPSAoIHR5cGVzIHx8IFwiXCIgKS5tYXRjaCggcm5vdHdoaXRlICkgfHwgWyBcIlwiIF07XG5cdFx0dCA9IHR5cGVzLmxlbmd0aDtcblx0XHR3aGlsZSAoIHQtLSApIHtcblx0XHRcdHRtcCA9IHJ0eXBlbmFtZXNwYWNlLmV4ZWMoIHR5cGVzW3RdICkgfHwgW107XG5cdFx0XHR0eXBlID0gb3JpZ1R5cGUgPSB0bXBbMV07XG5cdFx0XHRuYW1lc3BhY2VzID0gKCB0bXBbMl0gfHwgXCJcIiApLnNwbGl0KCBcIi5cIiApLnNvcnQoKTtcblxuXHRcdFx0Ly8gVGhlcmUgKm11c3QqIGJlIGEgdHlwZSwgbm8gYXR0YWNoaW5nIG5hbWVzcGFjZS1vbmx5IGhhbmRsZXJzXG5cdFx0XHRpZiAoICF0eXBlICkge1xuXHRcdFx0XHRjb250aW51ZTtcblx0XHRcdH1cblxuXHRcdFx0Ly8gSWYgZXZlbnQgY2hhbmdlcyBpdHMgdHlwZSwgdXNlIHRoZSBzcGVjaWFsIGV2ZW50IGhhbmRsZXJzIGZvciB0aGUgY2hhbmdlZCB0eXBlXG5cdFx0XHRzcGVjaWFsID0galF1ZXJ5LmV2ZW50LnNwZWNpYWxbIHR5cGUgXSB8fCB7fTtcblxuXHRcdFx0Ly8gSWYgc2VsZWN0b3IgZGVmaW5lZCwgZGV0ZXJtaW5lIHNwZWNpYWwgZXZlbnQgYXBpIHR5cGUsIG90aGVyd2lzZSBnaXZlbiB0eXBlXG5cdFx0XHR0eXBlID0gKCBzZWxlY3RvciA/IHNwZWNpYWwuZGVsZWdhdGVUeXBlIDogc3BlY2lhbC5iaW5kVHlwZSApIHx8IHR5cGU7XG5cblx0XHRcdC8vIFVwZGF0ZSBzcGVjaWFsIGJhc2VkIG9uIG5ld2x5IHJlc2V0IHR5cGVcblx0XHRcdHNwZWNpYWwgPSBqUXVlcnkuZXZlbnQuc3BlY2lhbFsgdHlwZSBdIHx8IHt9O1xuXG5cdFx0XHQvLyBoYW5kbGVPYmogaXMgcGFzc2VkIHRvIGFsbCBldmVudCBoYW5kbGVyc1xuXHRcdFx0aGFuZGxlT2JqID0galF1ZXJ5LmV4dGVuZCh7XG5cdFx0XHRcdHR5cGU6IHR5cGUsXG5cdFx0XHRcdG9yaWdUeXBlOiBvcmlnVHlwZSxcblx0XHRcdFx0ZGF0YTogZGF0YSxcblx0XHRcdFx0aGFuZGxlcjogaGFuZGxlcixcblx0XHRcdFx0Z3VpZDogaGFuZGxlci5ndWlkLFxuXHRcdFx0XHRzZWxlY3Rvcjogc2VsZWN0b3IsXG5cdFx0XHRcdG5lZWRzQ29udGV4dDogc2VsZWN0b3IgJiYgalF1ZXJ5LmV4cHIubWF0Y2gubmVlZHNDb250ZXh0LnRlc3QoIHNlbGVjdG9yICksXG5cdFx0XHRcdG5hbWVzcGFjZTogbmFtZXNwYWNlcy5qb2luKFwiLlwiKVxuXHRcdFx0fSwgaGFuZGxlT2JqSW4gKTtcblxuXHRcdFx0Ly8gSW5pdCB0aGUgZXZlbnQgaGFuZGxlciBxdWV1ZSBpZiB3ZSdyZSB0aGUgZmlyc3Rcblx0XHRcdGlmICggIShoYW5kbGVycyA9IGV2ZW50c1sgdHlwZSBdKSApIHtcblx0XHRcdFx0aGFuZGxlcnMgPSBldmVudHNbIHR5cGUgXSA9IFtdO1xuXHRcdFx0XHRoYW5kbGVycy5kZWxlZ2F0ZUNvdW50ID0gMDtcblxuXHRcdFx0XHQvLyBPbmx5IHVzZSBhZGRFdmVudExpc3RlbmVyIGlmIHRoZSBzcGVjaWFsIGV2ZW50cyBoYW5kbGVyIHJldHVybnMgZmFsc2Vcblx0XHRcdFx0aWYgKCAhc3BlY2lhbC5zZXR1cCB8fCBzcGVjaWFsLnNldHVwLmNhbGwoIGVsZW0sIGRhdGEsIG5hbWVzcGFjZXMsIGV2ZW50SGFuZGxlICkgPT09IGZhbHNlICkge1xuXHRcdFx0XHRcdGlmICggZWxlbS5hZGRFdmVudExpc3RlbmVyICkge1xuXHRcdFx0XHRcdFx0ZWxlbS5hZGRFdmVudExpc3RlbmVyKCB0eXBlLCBldmVudEhhbmRsZSwgZmFsc2UgKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdH1cblxuXHRcdFx0aWYgKCBzcGVjaWFsLmFkZCApIHtcblx0XHRcdFx0c3BlY2lhbC5hZGQuY2FsbCggZWxlbSwgaGFuZGxlT2JqICk7XG5cblx0XHRcdFx0aWYgKCAhaGFuZGxlT2JqLmhhbmRsZXIuZ3VpZCApIHtcblx0XHRcdFx0XHRoYW5kbGVPYmouaGFuZGxlci5ndWlkID0gaGFuZGxlci5ndWlkO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cblx0XHRcdC8vIEFkZCB0byB0aGUgZWxlbWVudCdzIGhhbmRsZXIgbGlzdCwgZGVsZWdhdGVzIGluIGZyb250XG5cdFx0XHRpZiAoIHNlbGVjdG9yICkge1xuXHRcdFx0XHRoYW5kbGVycy5zcGxpY2UoIGhhbmRsZXJzLmRlbGVnYXRlQ291bnQrKywgMCwgaGFuZGxlT2JqICk7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRoYW5kbGVycy5wdXNoKCBoYW5kbGVPYmogKTtcblx0XHRcdH1cblxuXHRcdFx0Ly8gS2VlcCB0cmFjayBvZiB3aGljaCBldmVudHMgaGF2ZSBldmVyIGJlZW4gdXNlZCwgZm9yIGV2ZW50IG9wdGltaXphdGlvblxuXHRcdFx0alF1ZXJ5LmV2ZW50Lmdsb2JhbFsgdHlwZSBdID0gdHJ1ZTtcblx0XHR9XG5cblx0fSxcblxuXHQvLyBEZXRhY2ggYW4gZXZlbnQgb3Igc2V0IG9mIGV2ZW50cyBmcm9tIGFuIGVsZW1lbnRcblx0cmVtb3ZlOiBmdW5jdGlvbiggZWxlbSwgdHlwZXMsIGhhbmRsZXIsIHNlbGVjdG9yLCBtYXBwZWRUeXBlcyApIHtcblxuXHRcdHZhciBqLCBvcmlnQ291bnQsIHRtcCxcblx0XHRcdGV2ZW50cywgdCwgaGFuZGxlT2JqLFxuXHRcdFx0c3BlY2lhbCwgaGFuZGxlcnMsIHR5cGUsIG5hbWVzcGFjZXMsIG9yaWdUeXBlLFxuXHRcdFx0ZWxlbURhdGEgPSBkYXRhX3ByaXYuaGFzRGF0YSggZWxlbSApICYmIGRhdGFfcHJpdi5nZXQoIGVsZW0gKTtcblxuXHRcdGlmICggIWVsZW1EYXRhIHx8ICEoZXZlbnRzID0gZWxlbURhdGEuZXZlbnRzKSApIHtcblx0XHRcdHJldHVybjtcblx0XHR9XG5cblx0XHQvLyBPbmNlIGZvciBlYWNoIHR5cGUubmFtZXNwYWNlIGluIHR5cGVzOyB0eXBlIG1heSBiZSBvbWl0dGVkXG5cdFx0dHlwZXMgPSAoIHR5cGVzIHx8IFwiXCIgKS5tYXRjaCggcm5vdHdoaXRlICkgfHwgWyBcIlwiIF07XG5cdFx0dCA9IHR5cGVzLmxlbmd0aDtcblx0XHR3aGlsZSAoIHQtLSApIHtcblx0XHRcdHRtcCA9IHJ0eXBlbmFtZXNwYWNlLmV4ZWMoIHR5cGVzW3RdICkgfHwgW107XG5cdFx0XHR0eXBlID0gb3JpZ1R5cGUgPSB0bXBbMV07XG5cdFx0XHRuYW1lc3BhY2VzID0gKCB0bXBbMl0gfHwgXCJcIiApLnNwbGl0KCBcIi5cIiApLnNvcnQoKTtcblxuXHRcdFx0Ly8gVW5iaW5kIGFsbCBldmVudHMgKG9uIHRoaXMgbmFtZXNwYWNlLCBpZiBwcm92aWRlZCkgZm9yIHRoZSBlbGVtZW50XG5cdFx0XHRpZiAoICF0eXBlICkge1xuXHRcdFx0XHRmb3IgKCB0eXBlIGluIGV2ZW50cyApIHtcblx0XHRcdFx0XHRqUXVlcnkuZXZlbnQucmVtb3ZlKCBlbGVtLCB0eXBlICsgdHlwZXNbIHQgXSwgaGFuZGxlciwgc2VsZWN0b3IsIHRydWUgKTtcblx0XHRcdFx0fVxuXHRcdFx0XHRjb250aW51ZTtcblx0XHRcdH1cblxuXHRcdFx0c3BlY2lhbCA9IGpRdWVyeS5ldmVudC5zcGVjaWFsWyB0eXBlIF0gfHwge307XG5cdFx0XHR0eXBlID0gKCBzZWxlY3RvciA/IHNwZWNpYWwuZGVsZWdhdGVUeXBlIDogc3BlY2lhbC5iaW5kVHlwZSApIHx8IHR5cGU7XG5cdFx0XHRoYW5kbGVycyA9IGV2ZW50c1sgdHlwZSBdIHx8IFtdO1xuXHRcdFx0dG1wID0gdG1wWzJdICYmIG5ldyBSZWdFeHAoIFwiKF58XFxcXC4pXCIgKyBuYW1lc3BhY2VzLmpvaW4oXCJcXFxcLig/Oi4qXFxcXC58KVwiKSArIFwiKFxcXFwufCQpXCIgKTtcblxuXHRcdFx0Ly8gUmVtb3ZlIG1hdGNoaW5nIGV2ZW50c1xuXHRcdFx0b3JpZ0NvdW50ID0gaiA9IGhhbmRsZXJzLmxlbmd0aDtcblx0XHRcdHdoaWxlICggai0tICkge1xuXHRcdFx0XHRoYW5kbGVPYmogPSBoYW5kbGVyc1sgaiBdO1xuXG5cdFx0XHRcdGlmICggKCBtYXBwZWRUeXBlcyB8fCBvcmlnVHlwZSA9PT0gaGFuZGxlT2JqLm9yaWdUeXBlICkgJiZcblx0XHRcdFx0XHQoICFoYW5kbGVyIHx8IGhhbmRsZXIuZ3VpZCA9PT0gaGFuZGxlT2JqLmd1aWQgKSAmJlxuXHRcdFx0XHRcdCggIXRtcCB8fCB0bXAudGVzdCggaGFuZGxlT2JqLm5hbWVzcGFjZSApICkgJiZcblx0XHRcdFx0XHQoICFzZWxlY3RvciB8fCBzZWxlY3RvciA9PT0gaGFuZGxlT2JqLnNlbGVjdG9yIHx8IHNlbGVjdG9yID09PSBcIioqXCIgJiYgaGFuZGxlT2JqLnNlbGVjdG9yICkgKSB7XG5cdFx0XHRcdFx0aGFuZGxlcnMuc3BsaWNlKCBqLCAxICk7XG5cblx0XHRcdFx0XHRpZiAoIGhhbmRsZU9iai5zZWxlY3RvciApIHtcblx0XHRcdFx0XHRcdGhhbmRsZXJzLmRlbGVnYXRlQ291bnQtLTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0aWYgKCBzcGVjaWFsLnJlbW92ZSApIHtcblx0XHRcdFx0XHRcdHNwZWNpYWwucmVtb3ZlLmNhbGwoIGVsZW0sIGhhbmRsZU9iaiApO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0fVxuXG5cdFx0XHQvLyBSZW1vdmUgZ2VuZXJpYyBldmVudCBoYW5kbGVyIGlmIHdlIHJlbW92ZWQgc29tZXRoaW5nIGFuZCBubyBtb3JlIGhhbmRsZXJzIGV4aXN0XG5cdFx0XHQvLyAoYXZvaWRzIHBvdGVudGlhbCBmb3IgZW5kbGVzcyByZWN1cnNpb24gZHVyaW5nIHJlbW92YWwgb2Ygc3BlY2lhbCBldmVudCBoYW5kbGVycylcblx0XHRcdGlmICggb3JpZ0NvdW50ICYmICFoYW5kbGVycy5sZW5ndGggKSB7XG5cdFx0XHRcdGlmICggIXNwZWNpYWwudGVhcmRvd24gfHwgc3BlY2lhbC50ZWFyZG93bi5jYWxsKCBlbGVtLCBuYW1lc3BhY2VzLCBlbGVtRGF0YS5oYW5kbGUgKSA9PT0gZmFsc2UgKSB7XG5cdFx0XHRcdFx0alF1ZXJ5LnJlbW92ZUV2ZW50KCBlbGVtLCB0eXBlLCBlbGVtRGF0YS5oYW5kbGUgKTtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdGRlbGV0ZSBldmVudHNbIHR5cGUgXTtcblx0XHRcdH1cblx0XHR9XG5cblx0XHQvLyBSZW1vdmUgdGhlIGV4cGFuZG8gaWYgaXQncyBubyBsb25nZXIgdXNlZFxuXHRcdGlmICggalF1ZXJ5LmlzRW1wdHlPYmplY3QoIGV2ZW50cyApICkge1xuXHRcdFx0ZGVsZXRlIGVsZW1EYXRhLmhhbmRsZTtcblx0XHRcdGRhdGFfcHJpdi5yZW1vdmUoIGVsZW0sIFwiZXZlbnRzXCIgKTtcblx0XHR9XG5cdH0sXG5cblx0dHJpZ2dlcjogZnVuY3Rpb24oIGV2ZW50LCBkYXRhLCBlbGVtLCBvbmx5SGFuZGxlcnMgKSB7XG5cblx0XHR2YXIgaSwgY3VyLCB0bXAsIGJ1YmJsZVR5cGUsIG9udHlwZSwgaGFuZGxlLCBzcGVjaWFsLFxuXHRcdFx0ZXZlbnRQYXRoID0gWyBlbGVtIHx8IGRvY3VtZW50IF0sXG5cdFx0XHR0eXBlID0gaGFzT3duLmNhbGwoIGV2ZW50LCBcInR5cGVcIiApID8gZXZlbnQudHlwZSA6IGV2ZW50LFxuXHRcdFx0bmFtZXNwYWNlcyA9IGhhc093bi5jYWxsKCBldmVudCwgXCJuYW1lc3BhY2VcIiApID8gZXZlbnQubmFtZXNwYWNlLnNwbGl0KFwiLlwiKSA6IFtdO1xuXG5cdFx0Y3VyID0gdG1wID0gZWxlbSA9IGVsZW0gfHwgZG9jdW1lbnQ7XG5cblx0XHQvLyBEb24ndCBkbyBldmVudHMgb24gdGV4dCBhbmQgY29tbWVudCBub2Rlc1xuXHRcdGlmICggZWxlbS5ub2RlVHlwZSA9PT0gMyB8fCBlbGVtLm5vZGVUeXBlID09PSA4ICkge1xuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblxuXHRcdC8vIGZvY3VzL2JsdXIgbW9ycGhzIHRvIGZvY3VzaW4vb3V0OyBlbnN1cmUgd2UncmUgbm90IGZpcmluZyB0aGVtIHJpZ2h0IG5vd1xuXHRcdGlmICggcmZvY3VzTW9ycGgudGVzdCggdHlwZSArIGpRdWVyeS5ldmVudC50cmlnZ2VyZWQgKSApIHtcblx0XHRcdHJldHVybjtcblx0XHR9XG5cblx0XHRpZiAoIHR5cGUuaW5kZXhPZihcIi5cIikgPj0gMCApIHtcblx0XHRcdC8vIE5hbWVzcGFjZWQgdHJpZ2dlcjsgY3JlYXRlIGEgcmVnZXhwIHRvIG1hdGNoIGV2ZW50IHR5cGUgaW4gaGFuZGxlKClcblx0XHRcdG5hbWVzcGFjZXMgPSB0eXBlLnNwbGl0KFwiLlwiKTtcblx0XHRcdHR5cGUgPSBuYW1lc3BhY2VzLnNoaWZ0KCk7XG5cdFx0XHRuYW1lc3BhY2VzLnNvcnQoKTtcblx0XHR9XG5cdFx0b250eXBlID0gdHlwZS5pbmRleE9mKFwiOlwiKSA8IDAgJiYgXCJvblwiICsgdHlwZTtcblxuXHRcdC8vIENhbGxlciBjYW4gcGFzcyBpbiBhIGpRdWVyeS5FdmVudCBvYmplY3QsIE9iamVjdCwgb3IganVzdCBhbiBldmVudCB0eXBlIHN0cmluZ1xuXHRcdGV2ZW50ID0gZXZlbnRbIGpRdWVyeS5leHBhbmRvIF0gP1xuXHRcdFx0ZXZlbnQgOlxuXHRcdFx0bmV3IGpRdWVyeS5FdmVudCggdHlwZSwgdHlwZW9mIGV2ZW50ID09PSBcIm9iamVjdFwiICYmIGV2ZW50ICk7XG5cblx0XHQvLyBUcmlnZ2VyIGJpdG1hc2s6ICYgMSBmb3IgbmF0aXZlIGhhbmRsZXJzOyAmIDIgZm9yIGpRdWVyeSAoYWx3YXlzIHRydWUpXG5cdFx0ZXZlbnQuaXNUcmlnZ2VyID0gb25seUhhbmRsZXJzID8gMiA6IDM7XG5cdFx0ZXZlbnQubmFtZXNwYWNlID0gbmFtZXNwYWNlcy5qb2luKFwiLlwiKTtcblx0XHRldmVudC5uYW1lc3BhY2VfcmUgPSBldmVudC5uYW1lc3BhY2UgP1xuXHRcdFx0bmV3IFJlZ0V4cCggXCIoXnxcXFxcLilcIiArIG5hbWVzcGFjZXMuam9pbihcIlxcXFwuKD86LipcXFxcLnwpXCIpICsgXCIoXFxcXC58JClcIiApIDpcblx0XHRcdG51bGw7XG5cblx0XHQvLyBDbGVhbiB1cCB0aGUgZXZlbnQgaW4gY2FzZSBpdCBpcyBiZWluZyByZXVzZWRcblx0XHRldmVudC5yZXN1bHQgPSB1bmRlZmluZWQ7XG5cdFx0aWYgKCAhZXZlbnQudGFyZ2V0ICkge1xuXHRcdFx0ZXZlbnQudGFyZ2V0ID0gZWxlbTtcblx0XHR9XG5cblx0XHQvLyBDbG9uZSBhbnkgaW5jb21pbmcgZGF0YSBhbmQgcHJlcGVuZCB0aGUgZXZlbnQsIGNyZWF0aW5nIHRoZSBoYW5kbGVyIGFyZyBsaXN0XG5cdFx0ZGF0YSA9IGRhdGEgPT0gbnVsbCA/XG5cdFx0XHRbIGV2ZW50IF0gOlxuXHRcdFx0alF1ZXJ5Lm1ha2VBcnJheSggZGF0YSwgWyBldmVudCBdICk7XG5cblx0XHQvLyBBbGxvdyBzcGVjaWFsIGV2ZW50cyB0byBkcmF3IG91dHNpZGUgdGhlIGxpbmVzXG5cdFx0c3BlY2lhbCA9IGpRdWVyeS5ldmVudC5zcGVjaWFsWyB0eXBlIF0gfHwge307XG5cdFx0aWYgKCAhb25seUhhbmRsZXJzICYmIHNwZWNpYWwudHJpZ2dlciAmJiBzcGVjaWFsLnRyaWdnZXIuYXBwbHkoIGVsZW0sIGRhdGEgKSA9PT0gZmFsc2UgKSB7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXG5cdFx0Ly8gRGV0ZXJtaW5lIGV2ZW50IHByb3BhZ2F0aW9uIHBhdGggaW4gYWR2YW5jZSwgcGVyIFczQyBldmVudHMgc3BlYyAoIzk5NTEpXG5cdFx0Ly8gQnViYmxlIHVwIHRvIGRvY3VtZW50LCB0aGVuIHRvIHdpbmRvdzsgd2F0Y2ggZm9yIGEgZ2xvYmFsIG93bmVyRG9jdW1lbnQgdmFyICgjOTcyNClcblx0XHRpZiAoICFvbmx5SGFuZGxlcnMgJiYgIXNwZWNpYWwubm9CdWJibGUgJiYgIWpRdWVyeS5pc1dpbmRvdyggZWxlbSApICkge1xuXG5cdFx0XHRidWJibGVUeXBlID0gc3BlY2lhbC5kZWxlZ2F0ZVR5cGUgfHwgdHlwZTtcblx0XHRcdGlmICggIXJmb2N1c01vcnBoLnRlc3QoIGJ1YmJsZVR5cGUgKyB0eXBlICkgKSB7XG5cdFx0XHRcdGN1ciA9IGN1ci5wYXJlbnROb2RlO1xuXHRcdFx0fVxuXHRcdFx0Zm9yICggOyBjdXI7IGN1ciA9IGN1ci5wYXJlbnROb2RlICkge1xuXHRcdFx0XHRldmVudFBhdGgucHVzaCggY3VyICk7XG5cdFx0XHRcdHRtcCA9IGN1cjtcblx0XHRcdH1cblxuXHRcdFx0Ly8gT25seSBhZGQgd2luZG93IGlmIHdlIGdvdCB0byBkb2N1bWVudCAoZS5nLiwgbm90IHBsYWluIG9iaiBvciBkZXRhY2hlZCBET00pXG5cdFx0XHRpZiAoIHRtcCA9PT0gKGVsZW0ub3duZXJEb2N1bWVudCB8fCBkb2N1bWVudCkgKSB7XG5cdFx0XHRcdGV2ZW50UGF0aC5wdXNoKCB0bXAuZGVmYXVsdFZpZXcgfHwgdG1wLnBhcmVudFdpbmRvdyB8fCB3aW5kb3cgKTtcblx0XHRcdH1cblx0XHR9XG5cblx0XHQvLyBGaXJlIGhhbmRsZXJzIG9uIHRoZSBldmVudCBwYXRoXG5cdFx0aSA9IDA7XG5cdFx0d2hpbGUgKCAoY3VyID0gZXZlbnRQYXRoW2krK10pICYmICFldmVudC5pc1Byb3BhZ2F0aW9uU3RvcHBlZCgpICkge1xuXG5cdFx0XHRldmVudC50eXBlID0gaSA+IDEgP1xuXHRcdFx0XHRidWJibGVUeXBlIDpcblx0XHRcdFx0c3BlY2lhbC5iaW5kVHlwZSB8fCB0eXBlO1xuXG5cdFx0XHQvLyBqUXVlcnkgaGFuZGxlclxuXHRcdFx0aGFuZGxlID0gKCBkYXRhX3ByaXYuZ2V0KCBjdXIsIFwiZXZlbnRzXCIgKSB8fCB7fSApWyBldmVudC50eXBlIF0gJiYgZGF0YV9wcml2LmdldCggY3VyLCBcImhhbmRsZVwiICk7XG5cdFx0XHRpZiAoIGhhbmRsZSApIHtcblx0XHRcdFx0aGFuZGxlLmFwcGx5KCBjdXIsIGRhdGEgKTtcblx0XHRcdH1cblxuXHRcdFx0Ly8gTmF0aXZlIGhhbmRsZXJcblx0XHRcdGhhbmRsZSA9IG9udHlwZSAmJiBjdXJbIG9udHlwZSBdO1xuXHRcdFx0aWYgKCBoYW5kbGUgJiYgaGFuZGxlLmFwcGx5ICYmIGpRdWVyeS5hY2NlcHREYXRhKCBjdXIgKSApIHtcblx0XHRcdFx0ZXZlbnQucmVzdWx0ID0gaGFuZGxlLmFwcGx5KCBjdXIsIGRhdGEgKTtcblx0XHRcdFx0aWYgKCBldmVudC5yZXN1bHQgPT09IGZhbHNlICkge1xuXHRcdFx0XHRcdGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9XG5cdFx0ZXZlbnQudHlwZSA9IHR5cGU7XG5cblx0XHQvLyBJZiBub2JvZHkgcHJldmVudGVkIHRoZSBkZWZhdWx0IGFjdGlvbiwgZG8gaXQgbm93XG5cdFx0aWYgKCAhb25seUhhbmRsZXJzICYmICFldmVudC5pc0RlZmF1bHRQcmV2ZW50ZWQoKSApIHtcblxuXHRcdFx0aWYgKCAoIXNwZWNpYWwuX2RlZmF1bHQgfHwgc3BlY2lhbC5fZGVmYXVsdC5hcHBseSggZXZlbnRQYXRoLnBvcCgpLCBkYXRhICkgPT09IGZhbHNlKSAmJlxuXHRcdFx0XHRqUXVlcnkuYWNjZXB0RGF0YSggZWxlbSApICkge1xuXG5cdFx0XHRcdC8vIENhbGwgYSBuYXRpdmUgRE9NIG1ldGhvZCBvbiB0aGUgdGFyZ2V0IHdpdGggdGhlIHNhbWUgbmFtZSBuYW1lIGFzIHRoZSBldmVudC5cblx0XHRcdFx0Ly8gRG9uJ3QgZG8gZGVmYXVsdCBhY3Rpb25zIG9uIHdpbmRvdywgdGhhdCdzIHdoZXJlIGdsb2JhbCB2YXJpYWJsZXMgYmUgKCM2MTcwKVxuXHRcdFx0XHRpZiAoIG9udHlwZSAmJiBqUXVlcnkuaXNGdW5jdGlvbiggZWxlbVsgdHlwZSBdICkgJiYgIWpRdWVyeS5pc1dpbmRvdyggZWxlbSApICkge1xuXG5cdFx0XHRcdFx0Ly8gRG9uJ3QgcmUtdHJpZ2dlciBhbiBvbkZPTyBldmVudCB3aGVuIHdlIGNhbGwgaXRzIEZPTygpIG1ldGhvZFxuXHRcdFx0XHRcdHRtcCA9IGVsZW1bIG9udHlwZSBdO1xuXG5cdFx0XHRcdFx0aWYgKCB0bXAgKSB7XG5cdFx0XHRcdFx0XHRlbGVtWyBvbnR5cGUgXSA9IG51bGw7XG5cdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0Ly8gUHJldmVudCByZS10cmlnZ2VyaW5nIG9mIHRoZSBzYW1lIGV2ZW50LCBzaW5jZSB3ZSBhbHJlYWR5IGJ1YmJsZWQgaXQgYWJvdmVcblx0XHRcdFx0XHRqUXVlcnkuZXZlbnQudHJpZ2dlcmVkID0gdHlwZTtcblx0XHRcdFx0XHRlbGVtWyB0eXBlIF0oKTtcblx0XHRcdFx0XHRqUXVlcnkuZXZlbnQudHJpZ2dlcmVkID0gdW5kZWZpbmVkO1xuXG5cdFx0XHRcdFx0aWYgKCB0bXAgKSB7XG5cdFx0XHRcdFx0XHRlbGVtWyBvbnR5cGUgXSA9IHRtcDtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9XG5cblx0XHRyZXR1cm4gZXZlbnQucmVzdWx0O1xuXHR9LFxuXG5cdGRpc3BhdGNoOiBmdW5jdGlvbiggZXZlbnQgKSB7XG5cblx0XHQvLyBNYWtlIGEgd3JpdGFibGUgalF1ZXJ5LkV2ZW50IGZyb20gdGhlIG5hdGl2ZSBldmVudCBvYmplY3Rcblx0XHRldmVudCA9IGpRdWVyeS5ldmVudC5maXgoIGV2ZW50ICk7XG5cblx0XHR2YXIgaSwgaiwgcmV0LCBtYXRjaGVkLCBoYW5kbGVPYmosXG5cdFx0XHRoYW5kbGVyUXVldWUgPSBbXSxcblx0XHRcdGFyZ3MgPSBzbGljZS5jYWxsKCBhcmd1bWVudHMgKSxcblx0XHRcdGhhbmRsZXJzID0gKCBkYXRhX3ByaXYuZ2V0KCB0aGlzLCBcImV2ZW50c1wiICkgfHwge30gKVsgZXZlbnQudHlwZSBdIHx8IFtdLFxuXHRcdFx0c3BlY2lhbCA9IGpRdWVyeS5ldmVudC5zcGVjaWFsWyBldmVudC50eXBlIF0gfHwge307XG5cblx0XHQvLyBVc2UgdGhlIGZpeC1lZCBqUXVlcnkuRXZlbnQgcmF0aGVyIHRoYW4gdGhlIChyZWFkLW9ubHkpIG5hdGl2ZSBldmVudFxuXHRcdGFyZ3NbMF0gPSBldmVudDtcblx0XHRldmVudC5kZWxlZ2F0ZVRhcmdldCA9IHRoaXM7XG5cblx0XHQvLyBDYWxsIHRoZSBwcmVEaXNwYXRjaCBob29rIGZvciB0aGUgbWFwcGVkIHR5cGUsIGFuZCBsZXQgaXQgYmFpbCBpZiBkZXNpcmVkXG5cdFx0aWYgKCBzcGVjaWFsLnByZURpc3BhdGNoICYmIHNwZWNpYWwucHJlRGlzcGF0Y2guY2FsbCggdGhpcywgZXZlbnQgKSA9PT0gZmFsc2UgKSB7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXG5cdFx0Ly8gRGV0ZXJtaW5lIGhhbmRsZXJzXG5cdFx0aGFuZGxlclF1ZXVlID0galF1ZXJ5LmV2ZW50LmhhbmRsZXJzLmNhbGwoIHRoaXMsIGV2ZW50LCBoYW5kbGVycyApO1xuXG5cdFx0Ly8gUnVuIGRlbGVnYXRlcyBmaXJzdDsgdGhleSBtYXkgd2FudCB0byBzdG9wIHByb3BhZ2F0aW9uIGJlbmVhdGggdXNcblx0XHRpID0gMDtcblx0XHR3aGlsZSAoIChtYXRjaGVkID0gaGFuZGxlclF1ZXVlWyBpKysgXSkgJiYgIWV2ZW50LmlzUHJvcGFnYXRpb25TdG9wcGVkKCkgKSB7XG5cdFx0XHRldmVudC5jdXJyZW50VGFyZ2V0ID0gbWF0Y2hlZC5lbGVtO1xuXG5cdFx0XHRqID0gMDtcblx0XHRcdHdoaWxlICggKGhhbmRsZU9iaiA9IG1hdGNoZWQuaGFuZGxlcnNbIGorKyBdKSAmJiAhZXZlbnQuaXNJbW1lZGlhdGVQcm9wYWdhdGlvblN0b3BwZWQoKSApIHtcblxuXHRcdFx0XHQvLyBUcmlnZ2VyZWQgZXZlbnQgbXVzdCBlaXRoZXIgMSkgaGF2ZSBubyBuYW1lc3BhY2UsIG9yIDIpIGhhdmUgbmFtZXNwYWNlKHMpXG5cdFx0XHRcdC8vIGEgc3Vic2V0IG9yIGVxdWFsIHRvIHRob3NlIGluIHRoZSBib3VuZCBldmVudCAoYm90aCBjYW4gaGF2ZSBubyBuYW1lc3BhY2UpLlxuXHRcdFx0XHRpZiAoICFldmVudC5uYW1lc3BhY2VfcmUgfHwgZXZlbnQubmFtZXNwYWNlX3JlLnRlc3QoIGhhbmRsZU9iai5uYW1lc3BhY2UgKSApIHtcblxuXHRcdFx0XHRcdGV2ZW50LmhhbmRsZU9iaiA9IGhhbmRsZU9iajtcblx0XHRcdFx0XHRldmVudC5kYXRhID0gaGFuZGxlT2JqLmRhdGE7XG5cblx0XHRcdFx0XHRyZXQgPSAoIChqUXVlcnkuZXZlbnQuc3BlY2lhbFsgaGFuZGxlT2JqLm9yaWdUeXBlIF0gfHwge30pLmhhbmRsZSB8fCBoYW5kbGVPYmouaGFuZGxlciApXG5cdFx0XHRcdFx0XHRcdC5hcHBseSggbWF0Y2hlZC5lbGVtLCBhcmdzICk7XG5cblx0XHRcdFx0XHRpZiAoIHJldCAhPT0gdW5kZWZpbmVkICkge1xuXHRcdFx0XHRcdFx0aWYgKCAoZXZlbnQucmVzdWx0ID0gcmV0KSA9PT0gZmFsc2UgKSB7XG5cdFx0XHRcdFx0XHRcdGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG5cdFx0XHRcdFx0XHRcdGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH1cblxuXHRcdC8vIENhbGwgdGhlIHBvc3REaXNwYXRjaCBob29rIGZvciB0aGUgbWFwcGVkIHR5cGVcblx0XHRpZiAoIHNwZWNpYWwucG9zdERpc3BhdGNoICkge1xuXHRcdFx0c3BlY2lhbC5wb3N0RGlzcGF0Y2guY2FsbCggdGhpcywgZXZlbnQgKTtcblx0XHR9XG5cblx0XHRyZXR1cm4gZXZlbnQucmVzdWx0O1xuXHR9LFxuXG5cdGhhbmRsZXJzOiBmdW5jdGlvbiggZXZlbnQsIGhhbmRsZXJzICkge1xuXHRcdHZhciBpLCBtYXRjaGVzLCBzZWwsIGhhbmRsZU9iaixcblx0XHRcdGhhbmRsZXJRdWV1ZSA9IFtdLFxuXHRcdFx0ZGVsZWdhdGVDb3VudCA9IGhhbmRsZXJzLmRlbGVnYXRlQ291bnQsXG5cdFx0XHRjdXIgPSBldmVudC50YXJnZXQ7XG5cblx0XHQvLyBGaW5kIGRlbGVnYXRlIGhhbmRsZXJzXG5cdFx0Ly8gQmxhY2staG9sZSBTVkcgPHVzZT4gaW5zdGFuY2UgdHJlZXMgKCMxMzE4MClcblx0XHQvLyBBdm9pZCBub24tbGVmdC1jbGljayBidWJibGluZyBpbiBGaXJlZm94ICgjMzg2MSlcblx0XHRpZiAoIGRlbGVnYXRlQ291bnQgJiYgY3VyLm5vZGVUeXBlICYmICghZXZlbnQuYnV0dG9uIHx8IGV2ZW50LnR5cGUgIT09IFwiY2xpY2tcIikgKSB7XG5cblx0XHRcdGZvciAoIDsgY3VyICE9PSB0aGlzOyBjdXIgPSBjdXIucGFyZW50Tm9kZSB8fCB0aGlzICkge1xuXG5cdFx0XHRcdC8vIERvbid0IHByb2Nlc3MgY2xpY2tzIG9uIGRpc2FibGVkIGVsZW1lbnRzICgjNjkxMSwgIzgxNjUsICMxMTM4MiwgIzExNzY0KVxuXHRcdFx0XHRpZiAoIGN1ci5kaXNhYmxlZCAhPT0gdHJ1ZSB8fCBldmVudC50eXBlICE9PSBcImNsaWNrXCIgKSB7XG5cdFx0XHRcdFx0bWF0Y2hlcyA9IFtdO1xuXHRcdFx0XHRcdGZvciAoIGkgPSAwOyBpIDwgZGVsZWdhdGVDb3VudDsgaSsrICkge1xuXHRcdFx0XHRcdFx0aGFuZGxlT2JqID0gaGFuZGxlcnNbIGkgXTtcblxuXHRcdFx0XHRcdFx0Ly8gRG9uJ3QgY29uZmxpY3Qgd2l0aCBPYmplY3QucHJvdG90eXBlIHByb3BlcnRpZXMgKCMxMzIwMylcblx0XHRcdFx0XHRcdHNlbCA9IGhhbmRsZU9iai5zZWxlY3RvciArIFwiIFwiO1xuXG5cdFx0XHRcdFx0XHRpZiAoIG1hdGNoZXNbIHNlbCBdID09PSB1bmRlZmluZWQgKSB7XG5cdFx0XHRcdFx0XHRcdG1hdGNoZXNbIHNlbCBdID0gaGFuZGxlT2JqLm5lZWRzQ29udGV4dCA/XG5cdFx0XHRcdFx0XHRcdFx0alF1ZXJ5KCBzZWwsIHRoaXMgKS5pbmRleCggY3VyICkgPj0gMCA6XG5cdFx0XHRcdFx0XHRcdFx0alF1ZXJ5LmZpbmQoIHNlbCwgdGhpcywgbnVsbCwgWyBjdXIgXSApLmxlbmd0aDtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdGlmICggbWF0Y2hlc1sgc2VsIF0gKSB7XG5cdFx0XHRcdFx0XHRcdG1hdGNoZXMucHVzaCggaGFuZGxlT2JqICk7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdGlmICggbWF0Y2hlcy5sZW5ndGggKSB7XG5cdFx0XHRcdFx0XHRoYW5kbGVyUXVldWUucHVzaCh7IGVsZW06IGN1ciwgaGFuZGxlcnM6IG1hdGNoZXMgfSk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0Ly8gQWRkIHRoZSByZW1haW5pbmcgKGRpcmVjdGx5LWJvdW5kKSBoYW5kbGVyc1xuXHRcdGlmICggZGVsZWdhdGVDb3VudCA8IGhhbmRsZXJzLmxlbmd0aCApIHtcblx0XHRcdGhhbmRsZXJRdWV1ZS5wdXNoKHsgZWxlbTogdGhpcywgaGFuZGxlcnM6IGhhbmRsZXJzLnNsaWNlKCBkZWxlZ2F0ZUNvdW50ICkgfSk7XG5cdFx0fVxuXG5cdFx0cmV0dXJuIGhhbmRsZXJRdWV1ZTtcblx0fSxcblxuXHQvLyBJbmNsdWRlcyBzb21lIGV2ZW50IHByb3BzIHNoYXJlZCBieSBLZXlFdmVudCBhbmQgTW91c2VFdmVudFxuXHRwcm9wczogXCJhbHRLZXkgYnViYmxlcyBjYW5jZWxhYmxlIGN0cmxLZXkgY3VycmVudFRhcmdldCBldmVudFBoYXNlIG1ldGFLZXkgcmVsYXRlZFRhcmdldCBzaGlmdEtleSB0YXJnZXQgdGltZVN0YW1wIHZpZXcgd2hpY2hcIi5zcGxpdChcIiBcIiksXG5cblx0Zml4SG9va3M6IHt9LFxuXG5cdGtleUhvb2tzOiB7XG5cdFx0cHJvcHM6IFwiY2hhciBjaGFyQ29kZSBrZXkga2V5Q29kZVwiLnNwbGl0KFwiIFwiKSxcblx0XHRmaWx0ZXI6IGZ1bmN0aW9uKCBldmVudCwgb3JpZ2luYWwgKSB7XG5cblx0XHRcdC8vIEFkZCB3aGljaCBmb3Iga2V5IGV2ZW50c1xuXHRcdFx0aWYgKCBldmVudC53aGljaCA9PSBudWxsICkge1xuXHRcdFx0XHRldmVudC53aGljaCA9IG9yaWdpbmFsLmNoYXJDb2RlICE9IG51bGwgPyBvcmlnaW5hbC5jaGFyQ29kZSA6IG9yaWdpbmFsLmtleUNvZGU7XG5cdFx0XHR9XG5cblx0XHRcdHJldHVybiBldmVudDtcblx0XHR9XG5cdH0sXG5cblx0bW91c2VIb29rczoge1xuXHRcdHByb3BzOiBcImJ1dHRvbiBidXR0b25zIGNsaWVudFggY2xpZW50WSBvZmZzZXRYIG9mZnNldFkgcGFnZVggcGFnZVkgc2NyZWVuWCBzY3JlZW5ZIHRvRWxlbWVudFwiLnNwbGl0KFwiIFwiKSxcblx0XHRmaWx0ZXI6IGZ1bmN0aW9uKCBldmVudCwgb3JpZ2luYWwgKSB7XG5cdFx0XHR2YXIgZXZlbnREb2MsIGRvYywgYm9keSxcblx0XHRcdFx0YnV0dG9uID0gb3JpZ2luYWwuYnV0dG9uO1xuXG5cdFx0XHQvLyBDYWxjdWxhdGUgcGFnZVgvWSBpZiBtaXNzaW5nIGFuZCBjbGllbnRYL1kgYXZhaWxhYmxlXG5cdFx0XHRpZiAoIGV2ZW50LnBhZ2VYID09IG51bGwgJiYgb3JpZ2luYWwuY2xpZW50WCAhPSBudWxsICkge1xuXHRcdFx0XHRldmVudERvYyA9IGV2ZW50LnRhcmdldC5vd25lckRvY3VtZW50IHx8IGRvY3VtZW50O1xuXHRcdFx0XHRkb2MgPSBldmVudERvYy5kb2N1bWVudEVsZW1lbnQ7XG5cdFx0XHRcdGJvZHkgPSBldmVudERvYy5ib2R5O1xuXG5cdFx0XHRcdGV2ZW50LnBhZ2VYID0gb3JpZ2luYWwuY2xpZW50WCArICggZG9jICYmIGRvYy5zY3JvbGxMZWZ0IHx8IGJvZHkgJiYgYm9keS5zY3JvbGxMZWZ0IHx8IDAgKSAtICggZG9jICYmIGRvYy5jbGllbnRMZWZ0IHx8IGJvZHkgJiYgYm9keS5jbGllbnRMZWZ0IHx8IDAgKTtcblx0XHRcdFx0ZXZlbnQucGFnZVkgPSBvcmlnaW5hbC5jbGllbnRZICsgKCBkb2MgJiYgZG9jLnNjcm9sbFRvcCAgfHwgYm9keSAmJiBib2R5LnNjcm9sbFRvcCAgfHwgMCApIC0gKCBkb2MgJiYgZG9jLmNsaWVudFRvcCAgfHwgYm9keSAmJiBib2R5LmNsaWVudFRvcCAgfHwgMCApO1xuXHRcdFx0fVxuXG5cdFx0XHQvLyBBZGQgd2hpY2ggZm9yIGNsaWNrOiAxID09PSBsZWZ0OyAyID09PSBtaWRkbGU7IDMgPT09IHJpZ2h0XG5cdFx0XHQvLyBOb3RlOiBidXR0b24gaXMgbm90IG5vcm1hbGl6ZWQsIHNvIGRvbid0IHVzZSBpdFxuXHRcdFx0aWYgKCAhZXZlbnQud2hpY2ggJiYgYnV0dG9uICE9PSB1bmRlZmluZWQgKSB7XG5cdFx0XHRcdGV2ZW50LndoaWNoID0gKCBidXR0b24gJiAxID8gMSA6ICggYnV0dG9uICYgMiA/IDMgOiAoIGJ1dHRvbiAmIDQgPyAyIDogMCApICkgKTtcblx0XHRcdH1cblxuXHRcdFx0cmV0dXJuIGV2ZW50O1xuXHRcdH1cblx0fSxcblxuXHRmaXg6IGZ1bmN0aW9uKCBldmVudCApIHtcblx0XHRpZiAoIGV2ZW50WyBqUXVlcnkuZXhwYW5kbyBdICkge1xuXHRcdFx0cmV0dXJuIGV2ZW50O1xuXHRcdH1cblxuXHRcdC8vIENyZWF0ZSBhIHdyaXRhYmxlIGNvcHkgb2YgdGhlIGV2ZW50IG9iamVjdCBhbmQgbm9ybWFsaXplIHNvbWUgcHJvcGVydGllc1xuXHRcdHZhciBpLCBwcm9wLCBjb3B5LFxuXHRcdFx0dHlwZSA9IGV2ZW50LnR5cGUsXG5cdFx0XHRvcmlnaW5hbEV2ZW50ID0gZXZlbnQsXG5cdFx0XHRmaXhIb29rID0gdGhpcy5maXhIb29rc1sgdHlwZSBdO1xuXG5cdFx0aWYgKCAhZml4SG9vayApIHtcblx0XHRcdHRoaXMuZml4SG9va3NbIHR5cGUgXSA9IGZpeEhvb2sgPVxuXHRcdFx0XHRybW91c2VFdmVudC50ZXN0KCB0eXBlICkgPyB0aGlzLm1vdXNlSG9va3MgOlxuXHRcdFx0XHRya2V5RXZlbnQudGVzdCggdHlwZSApID8gdGhpcy5rZXlIb29rcyA6XG5cdFx0XHRcdHt9O1xuXHRcdH1cblx0XHRjb3B5ID0gZml4SG9vay5wcm9wcyA/IHRoaXMucHJvcHMuY29uY2F0KCBmaXhIb29rLnByb3BzICkgOiB0aGlzLnByb3BzO1xuXG5cdFx0ZXZlbnQgPSBuZXcgalF1ZXJ5LkV2ZW50KCBvcmlnaW5hbEV2ZW50ICk7XG5cblx0XHRpID0gY29weS5sZW5ndGg7XG5cdFx0d2hpbGUgKCBpLS0gKSB7XG5cdFx0XHRwcm9wID0gY29weVsgaSBdO1xuXHRcdFx0ZXZlbnRbIHByb3AgXSA9IG9yaWdpbmFsRXZlbnRbIHByb3AgXTtcblx0XHR9XG5cblx0XHQvLyBTdXBwb3J0OiBDb3Jkb3ZhIDIuNSAoV2ViS2l0KSAoIzEzMjU1KVxuXHRcdC8vIEFsbCBldmVudHMgc2hvdWxkIGhhdmUgYSB0YXJnZXQ7IENvcmRvdmEgZGV2aWNlcmVhZHkgZG9lc24ndFxuXHRcdGlmICggIWV2ZW50LnRhcmdldCApIHtcblx0XHRcdGV2ZW50LnRhcmdldCA9IGRvY3VtZW50O1xuXHRcdH1cblxuXHRcdC8vIFN1cHBvcnQ6IFNhZmFyaSA2LjArLCBDaHJvbWU8Mjhcblx0XHQvLyBUYXJnZXQgc2hvdWxkIG5vdCBiZSBhIHRleHQgbm9kZSAoIzUwNCwgIzEzMTQzKVxuXHRcdGlmICggZXZlbnQudGFyZ2V0Lm5vZGVUeXBlID09PSAzICkge1xuXHRcdFx0ZXZlbnQudGFyZ2V0ID0gZXZlbnQudGFyZ2V0LnBhcmVudE5vZGU7XG5cdFx0fVxuXG5cdFx0cmV0dXJuIGZpeEhvb2suZmlsdGVyID8gZml4SG9vay5maWx0ZXIoIGV2ZW50LCBvcmlnaW5hbEV2ZW50ICkgOiBldmVudDtcblx0fSxcblxuXHRzcGVjaWFsOiB7XG5cdFx0bG9hZDoge1xuXHRcdFx0Ly8gUHJldmVudCB0cmlnZ2VyZWQgaW1hZ2UubG9hZCBldmVudHMgZnJvbSBidWJibGluZyB0byB3aW5kb3cubG9hZFxuXHRcdFx0bm9CdWJibGU6IHRydWVcblx0XHR9LFxuXHRcdGZvY3VzOiB7XG5cdFx0XHQvLyBGaXJlIG5hdGl2ZSBldmVudCBpZiBwb3NzaWJsZSBzbyBibHVyL2ZvY3VzIHNlcXVlbmNlIGlzIGNvcnJlY3Rcblx0XHRcdHRyaWdnZXI6IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRpZiAoIHRoaXMgIT09IHNhZmVBY3RpdmVFbGVtZW50KCkgJiYgdGhpcy5mb2N1cyApIHtcblx0XHRcdFx0XHR0aGlzLmZvY3VzKCk7XG5cdFx0XHRcdFx0cmV0dXJuIGZhbHNlO1xuXHRcdFx0XHR9XG5cdFx0XHR9LFxuXHRcdFx0ZGVsZWdhdGVUeXBlOiBcImZvY3VzaW5cIlxuXHRcdH0sXG5cdFx0Ymx1cjoge1xuXHRcdFx0dHJpZ2dlcjogZnVuY3Rpb24oKSB7XG5cdFx0XHRcdGlmICggdGhpcyA9PT0gc2FmZUFjdGl2ZUVsZW1lbnQoKSAmJiB0aGlzLmJsdXIgKSB7XG5cdFx0XHRcdFx0dGhpcy5ibHVyKCk7XG5cdFx0XHRcdFx0cmV0dXJuIGZhbHNlO1xuXHRcdFx0XHR9XG5cdFx0XHR9LFxuXHRcdFx0ZGVsZWdhdGVUeXBlOiBcImZvY3Vzb3V0XCJcblx0XHR9LFxuXHRcdGNsaWNrOiB7XG5cdFx0XHQvLyBGb3IgY2hlY2tib3gsIGZpcmUgbmF0aXZlIGV2ZW50IHNvIGNoZWNrZWQgc3RhdGUgd2lsbCBiZSByaWdodFxuXHRcdFx0dHJpZ2dlcjogZnVuY3Rpb24oKSB7XG5cdFx0XHRcdGlmICggdGhpcy50eXBlID09PSBcImNoZWNrYm94XCIgJiYgdGhpcy5jbGljayAmJiBqUXVlcnkubm9kZU5hbWUoIHRoaXMsIFwiaW5wdXRcIiApICkge1xuXHRcdFx0XHRcdHRoaXMuY2xpY2soKTtcblx0XHRcdFx0XHRyZXR1cm4gZmFsc2U7XG5cdFx0XHRcdH1cblx0XHRcdH0sXG5cblx0XHRcdC8vIEZvciBjcm9zcy1icm93c2VyIGNvbnNpc3RlbmN5LCBkb24ndCBmaXJlIG5hdGl2ZSAuY2xpY2soKSBvbiBsaW5rc1xuXHRcdFx0X2RlZmF1bHQ6IGZ1bmN0aW9uKCBldmVudCApIHtcblx0XHRcdFx0cmV0dXJuIGpRdWVyeS5ub2RlTmFtZSggZXZlbnQudGFyZ2V0LCBcImFcIiApO1xuXHRcdFx0fVxuXHRcdH0sXG5cblx0XHRiZWZvcmV1bmxvYWQ6IHtcblx0XHRcdHBvc3REaXNwYXRjaDogZnVuY3Rpb24oIGV2ZW50ICkge1xuXG5cdFx0XHRcdC8vIFN1cHBvcnQ6IEZpcmVmb3ggMjArXG5cdFx0XHRcdC8vIEZpcmVmb3ggZG9lc24ndCBhbGVydCBpZiB0aGUgcmV0dXJuVmFsdWUgZmllbGQgaXMgbm90IHNldC5cblx0XHRcdFx0aWYgKCBldmVudC5yZXN1bHQgIT09IHVuZGVmaW5lZCAmJiBldmVudC5vcmlnaW5hbEV2ZW50ICkge1xuXHRcdFx0XHRcdGV2ZW50Lm9yaWdpbmFsRXZlbnQucmV0dXJuVmFsdWUgPSBldmVudC5yZXN1bHQ7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9XG5cdH0sXG5cblx0c2ltdWxhdGU6IGZ1bmN0aW9uKCB0eXBlLCBlbGVtLCBldmVudCwgYnViYmxlICkge1xuXHRcdC8vIFBpZ2d5YmFjayBvbiBhIGRvbm9yIGV2ZW50IHRvIHNpbXVsYXRlIGEgZGlmZmVyZW50IG9uZS5cblx0XHQvLyBGYWtlIG9yaWdpbmFsRXZlbnQgdG8gYXZvaWQgZG9ub3IncyBzdG9wUHJvcGFnYXRpb24sIGJ1dCBpZiB0aGVcblx0XHQvLyBzaW11bGF0ZWQgZXZlbnQgcHJldmVudHMgZGVmYXVsdCB0aGVuIHdlIGRvIHRoZSBzYW1lIG9uIHRoZSBkb25vci5cblx0XHR2YXIgZSA9IGpRdWVyeS5leHRlbmQoXG5cdFx0XHRuZXcgalF1ZXJ5LkV2ZW50KCksXG5cdFx0XHRldmVudCxcblx0XHRcdHtcblx0XHRcdFx0dHlwZTogdHlwZSxcblx0XHRcdFx0aXNTaW11bGF0ZWQ6IHRydWUsXG5cdFx0XHRcdG9yaWdpbmFsRXZlbnQ6IHt9XG5cdFx0XHR9XG5cdFx0KTtcblx0XHRpZiAoIGJ1YmJsZSApIHtcblx0XHRcdGpRdWVyeS5ldmVudC50cmlnZ2VyKCBlLCBudWxsLCBlbGVtICk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdGpRdWVyeS5ldmVudC5kaXNwYXRjaC5jYWxsKCBlbGVtLCBlICk7XG5cdFx0fVxuXHRcdGlmICggZS5pc0RlZmF1bHRQcmV2ZW50ZWQoKSApIHtcblx0XHRcdGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG5cdFx0fVxuXHR9XG59O1xuXG5qUXVlcnkucmVtb3ZlRXZlbnQgPSBmdW5jdGlvbiggZWxlbSwgdHlwZSwgaGFuZGxlICkge1xuXHRpZiAoIGVsZW0ucmVtb3ZlRXZlbnRMaXN0ZW5lciApIHtcblx0XHRlbGVtLnJlbW92ZUV2ZW50TGlzdGVuZXIoIHR5cGUsIGhhbmRsZSwgZmFsc2UgKTtcblx0fVxufTtcblxualF1ZXJ5LkV2ZW50ID0gZnVuY3Rpb24oIHNyYywgcHJvcHMgKSB7XG5cdC8vIEFsbG93IGluc3RhbnRpYXRpb24gd2l0aG91dCB0aGUgJ25ldycga2V5d29yZFxuXHRpZiAoICEodGhpcyBpbnN0YW5jZW9mIGpRdWVyeS5FdmVudCkgKSB7XG5cdFx0cmV0dXJuIG5ldyBqUXVlcnkuRXZlbnQoIHNyYywgcHJvcHMgKTtcblx0fVxuXG5cdC8vIEV2ZW50IG9iamVjdFxuXHRpZiAoIHNyYyAmJiBzcmMudHlwZSApIHtcblx0XHR0aGlzLm9yaWdpbmFsRXZlbnQgPSBzcmM7XG5cdFx0dGhpcy50eXBlID0gc3JjLnR5cGU7XG5cblx0XHQvLyBFdmVudHMgYnViYmxpbmcgdXAgdGhlIGRvY3VtZW50IG1heSBoYXZlIGJlZW4gbWFya2VkIGFzIHByZXZlbnRlZFxuXHRcdC8vIGJ5IGEgaGFuZGxlciBsb3dlciBkb3duIHRoZSB0cmVlOyByZWZsZWN0IHRoZSBjb3JyZWN0IHZhbHVlLlxuXHRcdHRoaXMuaXNEZWZhdWx0UHJldmVudGVkID0gc3JjLmRlZmF1bHRQcmV2ZW50ZWQgfHxcblx0XHRcdFx0c3JjLmRlZmF1bHRQcmV2ZW50ZWQgPT09IHVuZGVmaW5lZCAmJlxuXHRcdFx0XHQvLyBTdXBwb3J0OiBBbmRyb2lkPDQuMFxuXHRcdFx0XHRzcmMucmV0dXJuVmFsdWUgPT09IGZhbHNlID9cblx0XHRcdHJldHVyblRydWUgOlxuXHRcdFx0cmV0dXJuRmFsc2U7XG5cblx0Ly8gRXZlbnQgdHlwZVxuXHR9IGVsc2Uge1xuXHRcdHRoaXMudHlwZSA9IHNyYztcblx0fVxuXG5cdC8vIFB1dCBleHBsaWNpdGx5IHByb3ZpZGVkIHByb3BlcnRpZXMgb250byB0aGUgZXZlbnQgb2JqZWN0XG5cdGlmICggcHJvcHMgKSB7XG5cdFx0alF1ZXJ5LmV4dGVuZCggdGhpcywgcHJvcHMgKTtcblx0fVxuXG5cdC8vIENyZWF0ZSBhIHRpbWVzdGFtcCBpZiBpbmNvbWluZyBldmVudCBkb2Vzbid0IGhhdmUgb25lXG5cdHRoaXMudGltZVN0YW1wID0gc3JjICYmIHNyYy50aW1lU3RhbXAgfHwgalF1ZXJ5Lm5vdygpO1xuXG5cdC8vIE1hcmsgaXQgYXMgZml4ZWRcblx0dGhpc1sgalF1ZXJ5LmV4cGFuZG8gXSA9IHRydWU7XG59O1xuXG4vLyBqUXVlcnkuRXZlbnQgaXMgYmFzZWQgb24gRE9NMyBFdmVudHMgYXMgc3BlY2lmaWVkIGJ5IHRoZSBFQ01BU2NyaXB0IExhbmd1YWdlIEJpbmRpbmdcbi8vIGh0dHA6Ly93d3cudzMub3JnL1RSLzIwMDMvV0QtRE9NLUxldmVsLTMtRXZlbnRzLTIwMDMwMzMxL2VjbWEtc2NyaXB0LWJpbmRpbmcuaHRtbFxualF1ZXJ5LkV2ZW50LnByb3RvdHlwZSA9IHtcblx0aXNEZWZhdWx0UHJldmVudGVkOiByZXR1cm5GYWxzZSxcblx0aXNQcm9wYWdhdGlvblN0b3BwZWQ6IHJldHVybkZhbHNlLFxuXHRpc0ltbWVkaWF0ZVByb3BhZ2F0aW9uU3RvcHBlZDogcmV0dXJuRmFsc2UsXG5cblx0cHJldmVudERlZmF1bHQ6IGZ1bmN0aW9uKCkge1xuXHRcdHZhciBlID0gdGhpcy5vcmlnaW5hbEV2ZW50O1xuXG5cdFx0dGhpcy5pc0RlZmF1bHRQcmV2ZW50ZWQgPSByZXR1cm5UcnVlO1xuXG5cdFx0aWYgKCBlICYmIGUucHJldmVudERlZmF1bHQgKSB7XG5cdFx0XHRlLnByZXZlbnREZWZhdWx0KCk7XG5cdFx0fVxuXHR9LFxuXHRzdG9wUHJvcGFnYXRpb246IGZ1bmN0aW9uKCkge1xuXHRcdHZhciBlID0gdGhpcy5vcmlnaW5hbEV2ZW50O1xuXG5cdFx0dGhpcy5pc1Byb3BhZ2F0aW9uU3RvcHBlZCA9IHJldHVyblRydWU7XG5cblx0XHRpZiAoIGUgJiYgZS5zdG9wUHJvcGFnYXRpb24gKSB7XG5cdFx0XHRlLnN0b3BQcm9wYWdhdGlvbigpO1xuXHRcdH1cblx0fSxcblx0c3RvcEltbWVkaWF0ZVByb3BhZ2F0aW9uOiBmdW5jdGlvbigpIHtcblx0XHR2YXIgZSA9IHRoaXMub3JpZ2luYWxFdmVudDtcblxuXHRcdHRoaXMuaXNJbW1lZGlhdGVQcm9wYWdhdGlvblN0b3BwZWQgPSByZXR1cm5UcnVlO1xuXG5cdFx0aWYgKCBlICYmIGUuc3RvcEltbWVkaWF0ZVByb3BhZ2F0aW9uICkge1xuXHRcdFx0ZS5zdG9wSW1tZWRpYXRlUHJvcGFnYXRpb24oKTtcblx0XHR9XG5cblx0XHR0aGlzLnN0b3BQcm9wYWdhdGlvbigpO1xuXHR9XG59O1xuXG4vLyBDcmVhdGUgbW91c2VlbnRlci9sZWF2ZSBldmVudHMgdXNpbmcgbW91c2VvdmVyL291dCBhbmQgZXZlbnQtdGltZSBjaGVja3Ncbi8vIFN1cHBvcnQ6IENocm9tZSAxNStcbmpRdWVyeS5lYWNoKHtcblx0bW91c2VlbnRlcjogXCJtb3VzZW92ZXJcIixcblx0bW91c2VsZWF2ZTogXCJtb3VzZW91dFwiLFxuXHRwb2ludGVyZW50ZXI6IFwicG9pbnRlcm92ZXJcIixcblx0cG9pbnRlcmxlYXZlOiBcInBvaW50ZXJvdXRcIlxufSwgZnVuY3Rpb24oIG9yaWcsIGZpeCApIHtcblx0alF1ZXJ5LmV2ZW50LnNwZWNpYWxbIG9yaWcgXSA9IHtcblx0XHRkZWxlZ2F0ZVR5cGU6IGZpeCxcblx0XHRiaW5kVHlwZTogZml4LFxuXG5cdFx0aGFuZGxlOiBmdW5jdGlvbiggZXZlbnQgKSB7XG5cdFx0XHR2YXIgcmV0LFxuXHRcdFx0XHR0YXJnZXQgPSB0aGlzLFxuXHRcdFx0XHRyZWxhdGVkID0gZXZlbnQucmVsYXRlZFRhcmdldCxcblx0XHRcdFx0aGFuZGxlT2JqID0gZXZlbnQuaGFuZGxlT2JqO1xuXG5cdFx0XHQvLyBGb3IgbW91c2VudGVyL2xlYXZlIGNhbGwgdGhlIGhhbmRsZXIgaWYgcmVsYXRlZCBpcyBvdXRzaWRlIHRoZSB0YXJnZXQuXG5cdFx0XHQvLyBOQjogTm8gcmVsYXRlZFRhcmdldCBpZiB0aGUgbW91c2UgbGVmdC9lbnRlcmVkIHRoZSBicm93c2VyIHdpbmRvd1xuXHRcdFx0aWYgKCAhcmVsYXRlZCB8fCAocmVsYXRlZCAhPT0gdGFyZ2V0ICYmICFqUXVlcnkuY29udGFpbnMoIHRhcmdldCwgcmVsYXRlZCApKSApIHtcblx0XHRcdFx0ZXZlbnQudHlwZSA9IGhhbmRsZU9iai5vcmlnVHlwZTtcblx0XHRcdFx0cmV0ID0gaGFuZGxlT2JqLmhhbmRsZXIuYXBwbHkoIHRoaXMsIGFyZ3VtZW50cyApO1xuXHRcdFx0XHRldmVudC50eXBlID0gZml4O1xuXHRcdFx0fVxuXHRcdFx0cmV0dXJuIHJldDtcblx0XHR9XG5cdH07XG59KTtcblxuLy8gU3VwcG9ydDogRmlyZWZveCwgQ2hyb21lLCBTYWZhcmlcbi8vIENyZWF0ZSBcImJ1YmJsaW5nXCIgZm9jdXMgYW5kIGJsdXIgZXZlbnRzXG5pZiAoICFzdXBwb3J0LmZvY3VzaW5CdWJibGVzICkge1xuXHRqUXVlcnkuZWFjaCh7IGZvY3VzOiBcImZvY3VzaW5cIiwgYmx1cjogXCJmb2N1c291dFwiIH0sIGZ1bmN0aW9uKCBvcmlnLCBmaXggKSB7XG5cblx0XHQvLyBBdHRhY2ggYSBzaW5nbGUgY2FwdHVyaW5nIGhhbmRsZXIgb24gdGhlIGRvY3VtZW50IHdoaWxlIHNvbWVvbmUgd2FudHMgZm9jdXNpbi9mb2N1c291dFxuXHRcdHZhciBoYW5kbGVyID0gZnVuY3Rpb24oIGV2ZW50ICkge1xuXHRcdFx0XHRqUXVlcnkuZXZlbnQuc2ltdWxhdGUoIGZpeCwgZXZlbnQudGFyZ2V0LCBqUXVlcnkuZXZlbnQuZml4KCBldmVudCApLCB0cnVlICk7XG5cdFx0XHR9O1xuXG5cdFx0alF1ZXJ5LmV2ZW50LnNwZWNpYWxbIGZpeCBdID0ge1xuXHRcdFx0c2V0dXA6IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHR2YXIgZG9jID0gdGhpcy5vd25lckRvY3VtZW50IHx8IHRoaXMsXG5cdFx0XHRcdFx0YXR0YWNoZXMgPSBkYXRhX3ByaXYuYWNjZXNzKCBkb2MsIGZpeCApO1xuXG5cdFx0XHRcdGlmICggIWF0dGFjaGVzICkge1xuXHRcdFx0XHRcdGRvYy5hZGRFdmVudExpc3RlbmVyKCBvcmlnLCBoYW5kbGVyLCB0cnVlICk7XG5cdFx0XHRcdH1cblx0XHRcdFx0ZGF0YV9wcml2LmFjY2VzcyggZG9jLCBmaXgsICggYXR0YWNoZXMgfHwgMCApICsgMSApO1xuXHRcdFx0fSxcblx0XHRcdHRlYXJkb3duOiBmdW5jdGlvbigpIHtcblx0XHRcdFx0dmFyIGRvYyA9IHRoaXMub3duZXJEb2N1bWVudCB8fCB0aGlzLFxuXHRcdFx0XHRcdGF0dGFjaGVzID0gZGF0YV9wcml2LmFjY2VzcyggZG9jLCBmaXggKSAtIDE7XG5cblx0XHRcdFx0aWYgKCAhYXR0YWNoZXMgKSB7XG5cdFx0XHRcdFx0ZG9jLnJlbW92ZUV2ZW50TGlzdGVuZXIoIG9yaWcsIGhhbmRsZXIsIHRydWUgKTtcblx0XHRcdFx0XHRkYXRhX3ByaXYucmVtb3ZlKCBkb2MsIGZpeCApO1xuXG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0ZGF0YV9wcml2LmFjY2VzcyggZG9jLCBmaXgsIGF0dGFjaGVzICk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9O1xuXHR9KTtcbn1cblxualF1ZXJ5LmZuLmV4dGVuZCh7XG5cblx0b246IGZ1bmN0aW9uKCB0eXBlcywgc2VsZWN0b3IsIGRhdGEsIGZuLCAvKklOVEVSTkFMKi8gb25lICkge1xuXHRcdHZhciBvcmlnRm4sIHR5cGU7XG5cblx0XHQvLyBUeXBlcyBjYW4gYmUgYSBtYXAgb2YgdHlwZXMvaGFuZGxlcnNcblx0XHRpZiAoIHR5cGVvZiB0eXBlcyA9PT0gXCJvYmplY3RcIiApIHtcblx0XHRcdC8vICggdHlwZXMtT2JqZWN0LCBzZWxlY3RvciwgZGF0YSApXG5cdFx0XHRpZiAoIHR5cGVvZiBzZWxlY3RvciAhPT0gXCJzdHJpbmdcIiApIHtcblx0XHRcdFx0Ly8gKCB0eXBlcy1PYmplY3QsIGRhdGEgKVxuXHRcdFx0XHRkYXRhID0gZGF0YSB8fCBzZWxlY3Rvcjtcblx0XHRcdFx0c2VsZWN0b3IgPSB1bmRlZmluZWQ7XG5cdFx0XHR9XG5cdFx0XHRmb3IgKCB0eXBlIGluIHR5cGVzICkge1xuXHRcdFx0XHR0aGlzLm9uKCB0eXBlLCBzZWxlY3RvciwgZGF0YSwgdHlwZXNbIHR5cGUgXSwgb25lICk7XG5cdFx0XHR9XG5cdFx0XHRyZXR1cm4gdGhpcztcblx0XHR9XG5cblx0XHRpZiAoIGRhdGEgPT0gbnVsbCAmJiBmbiA9PSBudWxsICkge1xuXHRcdFx0Ly8gKCB0eXBlcywgZm4gKVxuXHRcdFx0Zm4gPSBzZWxlY3Rvcjtcblx0XHRcdGRhdGEgPSBzZWxlY3RvciA9IHVuZGVmaW5lZDtcblx0XHR9IGVsc2UgaWYgKCBmbiA9PSBudWxsICkge1xuXHRcdFx0aWYgKCB0eXBlb2Ygc2VsZWN0b3IgPT09IFwic3RyaW5nXCIgKSB7XG5cdFx0XHRcdC8vICggdHlwZXMsIHNlbGVjdG9yLCBmbiApXG5cdFx0XHRcdGZuID0gZGF0YTtcblx0XHRcdFx0ZGF0YSA9IHVuZGVmaW5lZDtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdC8vICggdHlwZXMsIGRhdGEsIGZuIClcblx0XHRcdFx0Zm4gPSBkYXRhO1xuXHRcdFx0XHRkYXRhID0gc2VsZWN0b3I7XG5cdFx0XHRcdHNlbGVjdG9yID0gdW5kZWZpbmVkO1xuXHRcdFx0fVxuXHRcdH1cblx0XHRpZiAoIGZuID09PSBmYWxzZSApIHtcblx0XHRcdGZuID0gcmV0dXJuRmFsc2U7XG5cdFx0fSBlbHNlIGlmICggIWZuICkge1xuXHRcdFx0cmV0dXJuIHRoaXM7XG5cdFx0fVxuXG5cdFx0aWYgKCBvbmUgPT09IDEgKSB7XG5cdFx0XHRvcmlnRm4gPSBmbjtcblx0XHRcdGZuID0gZnVuY3Rpb24oIGV2ZW50ICkge1xuXHRcdFx0XHQvLyBDYW4gdXNlIGFuIGVtcHR5IHNldCwgc2luY2UgZXZlbnQgY29udGFpbnMgdGhlIGluZm9cblx0XHRcdFx0alF1ZXJ5KCkub2ZmKCBldmVudCApO1xuXHRcdFx0XHRyZXR1cm4gb3JpZ0ZuLmFwcGx5KCB0aGlzLCBhcmd1bWVudHMgKTtcblx0XHRcdH07XG5cdFx0XHQvLyBVc2Ugc2FtZSBndWlkIHNvIGNhbGxlciBjYW4gcmVtb3ZlIHVzaW5nIG9yaWdGblxuXHRcdFx0Zm4uZ3VpZCA9IG9yaWdGbi5ndWlkIHx8ICggb3JpZ0ZuLmd1aWQgPSBqUXVlcnkuZ3VpZCsrICk7XG5cdFx0fVxuXHRcdHJldHVybiB0aGlzLmVhY2goIGZ1bmN0aW9uKCkge1xuXHRcdFx0alF1ZXJ5LmV2ZW50LmFkZCggdGhpcywgdHlwZXMsIGZuLCBkYXRhLCBzZWxlY3RvciApO1xuXHRcdH0pO1xuXHR9LFxuXHRvbmU6IGZ1bmN0aW9uKCB0eXBlcywgc2VsZWN0b3IsIGRhdGEsIGZuICkge1xuXHRcdHJldHVybiB0aGlzLm9uKCB0eXBlcywgc2VsZWN0b3IsIGRhdGEsIGZuLCAxICk7XG5cdH0sXG5cdG9mZjogZnVuY3Rpb24oIHR5cGVzLCBzZWxlY3RvciwgZm4gKSB7XG5cdFx0dmFyIGhhbmRsZU9iaiwgdHlwZTtcblx0XHRpZiAoIHR5cGVzICYmIHR5cGVzLnByZXZlbnREZWZhdWx0ICYmIHR5cGVzLmhhbmRsZU9iaiApIHtcblx0XHRcdC8vICggZXZlbnQgKSAgZGlzcGF0Y2hlZCBqUXVlcnkuRXZlbnRcblx0XHRcdGhhbmRsZU9iaiA9IHR5cGVzLmhhbmRsZU9iajtcblx0XHRcdGpRdWVyeSggdHlwZXMuZGVsZWdhdGVUYXJnZXQgKS5vZmYoXG5cdFx0XHRcdGhhbmRsZU9iai5uYW1lc3BhY2UgPyBoYW5kbGVPYmoub3JpZ1R5cGUgKyBcIi5cIiArIGhhbmRsZU9iai5uYW1lc3BhY2UgOiBoYW5kbGVPYmoub3JpZ1R5cGUsXG5cdFx0XHRcdGhhbmRsZU9iai5zZWxlY3Rvcixcblx0XHRcdFx0aGFuZGxlT2JqLmhhbmRsZXJcblx0XHRcdCk7XG5cdFx0XHRyZXR1cm4gdGhpcztcblx0XHR9XG5cdFx0aWYgKCB0eXBlb2YgdHlwZXMgPT09IFwib2JqZWN0XCIgKSB7XG5cdFx0XHQvLyAoIHR5cGVzLW9iamVjdCBbLCBzZWxlY3Rvcl0gKVxuXHRcdFx0Zm9yICggdHlwZSBpbiB0eXBlcyApIHtcblx0XHRcdFx0dGhpcy5vZmYoIHR5cGUsIHNlbGVjdG9yLCB0eXBlc1sgdHlwZSBdICk7XG5cdFx0XHR9XG5cdFx0XHRyZXR1cm4gdGhpcztcblx0XHR9XG5cdFx0aWYgKCBzZWxlY3RvciA9PT0gZmFsc2UgfHwgdHlwZW9mIHNlbGVjdG9yID09PSBcImZ1bmN0aW9uXCIgKSB7XG5cdFx0XHQvLyAoIHR5cGVzIFssIGZuXSApXG5cdFx0XHRmbiA9IHNlbGVjdG9yO1xuXHRcdFx0c2VsZWN0b3IgPSB1bmRlZmluZWQ7XG5cdFx0fVxuXHRcdGlmICggZm4gPT09IGZhbHNlICkge1xuXHRcdFx0Zm4gPSByZXR1cm5GYWxzZTtcblx0XHR9XG5cdFx0cmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbigpIHtcblx0XHRcdGpRdWVyeS5ldmVudC5yZW1vdmUoIHRoaXMsIHR5cGVzLCBmbiwgc2VsZWN0b3IgKTtcblx0XHR9KTtcblx0fSxcblxuXHR0cmlnZ2VyOiBmdW5jdGlvbiggdHlwZSwgZGF0YSApIHtcblx0XHRyZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uKCkge1xuXHRcdFx0alF1ZXJ5LmV2ZW50LnRyaWdnZXIoIHR5cGUsIGRhdGEsIHRoaXMgKTtcblx0XHR9KTtcblx0fSxcblx0dHJpZ2dlckhhbmRsZXI6IGZ1bmN0aW9uKCB0eXBlLCBkYXRhICkge1xuXHRcdHZhciBlbGVtID0gdGhpc1swXTtcblx0XHRpZiAoIGVsZW0gKSB7XG5cdFx0XHRyZXR1cm4galF1ZXJ5LmV2ZW50LnRyaWdnZXIoIHR5cGUsIGRhdGEsIGVsZW0sIHRydWUgKTtcblx0XHR9XG5cdH1cbn0pO1xuXG5cbnZhclxuXHRyeGh0bWxUYWcgPSAvPCg/IWFyZWF8YnJ8Y29sfGVtYmVkfGhyfGltZ3xpbnB1dHxsaW5rfG1ldGF8cGFyYW0pKChbXFx3Ol0rKVtePl0qKVxcLz4vZ2ksXG5cdHJ0YWdOYW1lID0gLzwoW1xcdzpdKykvLFxuXHRyaHRtbCA9IC88fCYjP1xcdys7Lyxcblx0cm5vSW5uZXJodG1sID0gLzwoPzpzY3JpcHR8c3R5bGV8bGluaykvaSxcblx0Ly8gY2hlY2tlZD1cImNoZWNrZWRcIiBvciBjaGVja2VkXG5cdHJjaGVja2VkID0gL2NoZWNrZWRcXHMqKD86W149XXw9XFxzKi5jaGVja2VkLikvaSxcblx0cnNjcmlwdFR5cGUgPSAvXiR8XFwvKD86amF2YXxlY21hKXNjcmlwdC9pLFxuXHRyc2NyaXB0VHlwZU1hc2tlZCA9IC9edHJ1ZVxcLyguKikvLFxuXHRyY2xlYW5TY3JpcHQgPSAvXlxccyo8ISg/OlxcW0NEQVRBXFxbfC0tKXwoPzpcXF1cXF18LS0pPlxccyokL2csXG5cblx0Ly8gV2UgaGF2ZSB0byBjbG9zZSB0aGVzZSB0YWdzIHRvIHN1cHBvcnQgWEhUTUwgKCMxMzIwMClcblx0d3JhcE1hcCA9IHtcblxuXHRcdC8vIFN1cHBvcnQ6IElFOVxuXHRcdG9wdGlvbjogWyAxLCBcIjxzZWxlY3QgbXVsdGlwbGU9J211bHRpcGxlJz5cIiwgXCI8L3NlbGVjdD5cIiBdLFxuXG5cdFx0dGhlYWQ6IFsgMSwgXCI8dGFibGU+XCIsIFwiPC90YWJsZT5cIiBdLFxuXHRcdGNvbDogWyAyLCBcIjx0YWJsZT48Y29sZ3JvdXA+XCIsIFwiPC9jb2xncm91cD48L3RhYmxlPlwiIF0sXG5cdFx0dHI6IFsgMiwgXCI8dGFibGU+PHRib2R5PlwiLCBcIjwvdGJvZHk+PC90YWJsZT5cIiBdLFxuXHRcdHRkOiBbIDMsIFwiPHRhYmxlPjx0Ym9keT48dHI+XCIsIFwiPC90cj48L3Rib2R5PjwvdGFibGU+XCIgXSxcblxuXHRcdF9kZWZhdWx0OiBbIDAsIFwiXCIsIFwiXCIgXVxuXHR9O1xuXG4vLyBTdXBwb3J0OiBJRTlcbndyYXBNYXAub3B0Z3JvdXAgPSB3cmFwTWFwLm9wdGlvbjtcblxud3JhcE1hcC50Ym9keSA9IHdyYXBNYXAudGZvb3QgPSB3cmFwTWFwLmNvbGdyb3VwID0gd3JhcE1hcC5jYXB0aW9uID0gd3JhcE1hcC50aGVhZDtcbndyYXBNYXAudGggPSB3cmFwTWFwLnRkO1xuXG4vLyBTdXBwb3J0OiAxLnggY29tcGF0aWJpbGl0eVxuLy8gTWFuaXB1bGF0aW5nIHRhYmxlcyByZXF1aXJlcyBhIHRib2R5XG5mdW5jdGlvbiBtYW5pcHVsYXRpb25UYXJnZXQoIGVsZW0sIGNvbnRlbnQgKSB7XG5cdHJldHVybiBqUXVlcnkubm9kZU5hbWUoIGVsZW0sIFwidGFibGVcIiApICYmXG5cdFx0alF1ZXJ5Lm5vZGVOYW1lKCBjb250ZW50Lm5vZGVUeXBlICE9PSAxMSA/IGNvbnRlbnQgOiBjb250ZW50LmZpcnN0Q2hpbGQsIFwidHJcIiApID9cblxuXHRcdGVsZW0uZ2V0RWxlbWVudHNCeVRhZ05hbWUoXCJ0Ym9keVwiKVswXSB8fFxuXHRcdFx0ZWxlbS5hcHBlbmRDaGlsZCggZWxlbS5vd25lckRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJ0Ym9keVwiKSApIDpcblx0XHRlbGVtO1xufVxuXG4vLyBSZXBsYWNlL3Jlc3RvcmUgdGhlIHR5cGUgYXR0cmlidXRlIG9mIHNjcmlwdCBlbGVtZW50cyBmb3Igc2FmZSBET00gbWFuaXB1bGF0aW9uXG5mdW5jdGlvbiBkaXNhYmxlU2NyaXB0KCBlbGVtICkge1xuXHRlbGVtLnR5cGUgPSAoZWxlbS5nZXRBdHRyaWJ1dGUoXCJ0eXBlXCIpICE9PSBudWxsKSArIFwiL1wiICsgZWxlbS50eXBlO1xuXHRyZXR1cm4gZWxlbTtcbn1cbmZ1bmN0aW9uIHJlc3RvcmVTY3JpcHQoIGVsZW0gKSB7XG5cdHZhciBtYXRjaCA9IHJzY3JpcHRUeXBlTWFza2VkLmV4ZWMoIGVsZW0udHlwZSApO1xuXG5cdGlmICggbWF0Y2ggKSB7XG5cdFx0ZWxlbS50eXBlID0gbWF0Y2hbIDEgXTtcblx0fSBlbHNlIHtcblx0XHRlbGVtLnJlbW92ZUF0dHJpYnV0ZShcInR5cGVcIik7XG5cdH1cblxuXHRyZXR1cm4gZWxlbTtcbn1cblxuLy8gTWFyayBzY3JpcHRzIGFzIGhhdmluZyBhbHJlYWR5IGJlZW4gZXZhbHVhdGVkXG5mdW5jdGlvbiBzZXRHbG9iYWxFdmFsKCBlbGVtcywgcmVmRWxlbWVudHMgKSB7XG5cdHZhciBpID0gMCxcblx0XHRsID0gZWxlbXMubGVuZ3RoO1xuXG5cdGZvciAoIDsgaSA8IGw7IGkrKyApIHtcblx0XHRkYXRhX3ByaXYuc2V0KFxuXHRcdFx0ZWxlbXNbIGkgXSwgXCJnbG9iYWxFdmFsXCIsICFyZWZFbGVtZW50cyB8fCBkYXRhX3ByaXYuZ2V0KCByZWZFbGVtZW50c1sgaSBdLCBcImdsb2JhbEV2YWxcIiApXG5cdFx0KTtcblx0fVxufVxuXG5mdW5jdGlvbiBjbG9uZUNvcHlFdmVudCggc3JjLCBkZXN0ICkge1xuXHR2YXIgaSwgbCwgdHlwZSwgcGRhdGFPbGQsIHBkYXRhQ3VyLCB1ZGF0YU9sZCwgdWRhdGFDdXIsIGV2ZW50cztcblxuXHRpZiAoIGRlc3Qubm9kZVR5cGUgIT09IDEgKSB7XG5cdFx0cmV0dXJuO1xuXHR9XG5cblx0Ly8gMS4gQ29weSBwcml2YXRlIGRhdGE6IGV2ZW50cywgaGFuZGxlcnMsIGV0Yy5cblx0aWYgKCBkYXRhX3ByaXYuaGFzRGF0YSggc3JjICkgKSB7XG5cdFx0cGRhdGFPbGQgPSBkYXRhX3ByaXYuYWNjZXNzKCBzcmMgKTtcblx0XHRwZGF0YUN1ciA9IGRhdGFfcHJpdi5zZXQoIGRlc3QsIHBkYXRhT2xkICk7XG5cdFx0ZXZlbnRzID0gcGRhdGFPbGQuZXZlbnRzO1xuXG5cdFx0aWYgKCBldmVudHMgKSB7XG5cdFx0XHRkZWxldGUgcGRhdGFDdXIuaGFuZGxlO1xuXHRcdFx0cGRhdGFDdXIuZXZlbnRzID0ge307XG5cblx0XHRcdGZvciAoIHR5cGUgaW4gZXZlbnRzICkge1xuXHRcdFx0XHRmb3IgKCBpID0gMCwgbCA9IGV2ZW50c1sgdHlwZSBdLmxlbmd0aDsgaSA8IGw7IGkrKyApIHtcblx0XHRcdFx0XHRqUXVlcnkuZXZlbnQuYWRkKCBkZXN0LCB0eXBlLCBldmVudHNbIHR5cGUgXVsgaSBdICk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9XG5cdH1cblxuXHQvLyAyLiBDb3B5IHVzZXIgZGF0YVxuXHRpZiAoIGRhdGFfdXNlci5oYXNEYXRhKCBzcmMgKSApIHtcblx0XHR1ZGF0YU9sZCA9IGRhdGFfdXNlci5hY2Nlc3MoIHNyYyApO1xuXHRcdHVkYXRhQ3VyID0galF1ZXJ5LmV4dGVuZCgge30sIHVkYXRhT2xkICk7XG5cblx0XHRkYXRhX3VzZXIuc2V0KCBkZXN0LCB1ZGF0YUN1ciApO1xuXHR9XG59XG5cbmZ1bmN0aW9uIGdldEFsbCggY29udGV4dCwgdGFnICkge1xuXHR2YXIgcmV0ID0gY29udGV4dC5nZXRFbGVtZW50c0J5VGFnTmFtZSA/IGNvbnRleHQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoIHRhZyB8fCBcIipcIiApIDpcblx0XHRcdGNvbnRleHQucXVlcnlTZWxlY3RvckFsbCA/IGNvbnRleHQucXVlcnlTZWxlY3RvckFsbCggdGFnIHx8IFwiKlwiICkgOlxuXHRcdFx0W107XG5cblx0cmV0dXJuIHRhZyA9PT0gdW5kZWZpbmVkIHx8IHRhZyAmJiBqUXVlcnkubm9kZU5hbWUoIGNvbnRleHQsIHRhZyApID9cblx0XHRqUXVlcnkubWVyZ2UoIFsgY29udGV4dCBdLCByZXQgKSA6XG5cdFx0cmV0O1xufVxuXG4vLyBGaXggSUUgYnVncywgc2VlIHN1cHBvcnQgdGVzdHNcbmZ1bmN0aW9uIGZpeElucHV0KCBzcmMsIGRlc3QgKSB7XG5cdHZhciBub2RlTmFtZSA9IGRlc3Qubm9kZU5hbWUudG9Mb3dlckNhc2UoKTtcblxuXHQvLyBGYWlscyB0byBwZXJzaXN0IHRoZSBjaGVja2VkIHN0YXRlIG9mIGEgY2xvbmVkIGNoZWNrYm94IG9yIHJhZGlvIGJ1dHRvbi5cblx0aWYgKCBub2RlTmFtZSA9PT0gXCJpbnB1dFwiICYmIHJjaGVja2FibGVUeXBlLnRlc3QoIHNyYy50eXBlICkgKSB7XG5cdFx0ZGVzdC5jaGVja2VkID0gc3JjLmNoZWNrZWQ7XG5cblx0Ly8gRmFpbHMgdG8gcmV0dXJuIHRoZSBzZWxlY3RlZCBvcHRpb24gdG8gdGhlIGRlZmF1bHQgc2VsZWN0ZWQgc3RhdGUgd2hlbiBjbG9uaW5nIG9wdGlvbnNcblx0fSBlbHNlIGlmICggbm9kZU5hbWUgPT09IFwiaW5wdXRcIiB8fCBub2RlTmFtZSA9PT0gXCJ0ZXh0YXJlYVwiICkge1xuXHRcdGRlc3QuZGVmYXVsdFZhbHVlID0gc3JjLmRlZmF1bHRWYWx1ZTtcblx0fVxufVxuXG5qUXVlcnkuZXh0ZW5kKHtcblx0Y2xvbmU6IGZ1bmN0aW9uKCBlbGVtLCBkYXRhQW5kRXZlbnRzLCBkZWVwRGF0YUFuZEV2ZW50cyApIHtcblx0XHR2YXIgaSwgbCwgc3JjRWxlbWVudHMsIGRlc3RFbGVtZW50cyxcblx0XHRcdGNsb25lID0gZWxlbS5jbG9uZU5vZGUoIHRydWUgKSxcblx0XHRcdGluUGFnZSA9IGpRdWVyeS5jb250YWlucyggZWxlbS5vd25lckRvY3VtZW50LCBlbGVtICk7XG5cblx0XHQvLyBGaXggSUUgY2xvbmluZyBpc3N1ZXNcblx0XHRpZiAoICFzdXBwb3J0Lm5vQ2xvbmVDaGVja2VkICYmICggZWxlbS5ub2RlVHlwZSA9PT0gMSB8fCBlbGVtLm5vZGVUeXBlID09PSAxMSApICYmXG5cdFx0XHRcdCFqUXVlcnkuaXNYTUxEb2MoIGVsZW0gKSApIHtcblxuXHRcdFx0Ly8gV2UgZXNjaGV3IFNpenpsZSBoZXJlIGZvciBwZXJmb3JtYW5jZSByZWFzb25zOiBodHRwOi8vanNwZXJmLmNvbS9nZXRhbGwtdnMtc2l6emxlLzJcblx0XHRcdGRlc3RFbGVtZW50cyA9IGdldEFsbCggY2xvbmUgKTtcblx0XHRcdHNyY0VsZW1lbnRzID0gZ2V0QWxsKCBlbGVtICk7XG5cblx0XHRcdGZvciAoIGkgPSAwLCBsID0gc3JjRWxlbWVudHMubGVuZ3RoOyBpIDwgbDsgaSsrICkge1xuXHRcdFx0XHRmaXhJbnB1dCggc3JjRWxlbWVudHNbIGkgXSwgZGVzdEVsZW1lbnRzWyBpIF0gKTtcblx0XHRcdH1cblx0XHR9XG5cblx0XHQvLyBDb3B5IHRoZSBldmVudHMgZnJvbSB0aGUgb3JpZ2luYWwgdG8gdGhlIGNsb25lXG5cdFx0aWYgKCBkYXRhQW5kRXZlbnRzICkge1xuXHRcdFx0aWYgKCBkZWVwRGF0YUFuZEV2ZW50cyApIHtcblx0XHRcdFx0c3JjRWxlbWVudHMgPSBzcmNFbGVtZW50cyB8fCBnZXRBbGwoIGVsZW0gKTtcblx0XHRcdFx0ZGVzdEVsZW1lbnRzID0gZGVzdEVsZW1lbnRzIHx8IGdldEFsbCggY2xvbmUgKTtcblxuXHRcdFx0XHRmb3IgKCBpID0gMCwgbCA9IHNyY0VsZW1lbnRzLmxlbmd0aDsgaSA8IGw7IGkrKyApIHtcblx0XHRcdFx0XHRjbG9uZUNvcHlFdmVudCggc3JjRWxlbWVudHNbIGkgXSwgZGVzdEVsZW1lbnRzWyBpIF0gKTtcblx0XHRcdFx0fVxuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0Y2xvbmVDb3B5RXZlbnQoIGVsZW0sIGNsb25lICk7XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0Ly8gUHJlc2VydmUgc2NyaXB0IGV2YWx1YXRpb24gaGlzdG9yeVxuXHRcdGRlc3RFbGVtZW50cyA9IGdldEFsbCggY2xvbmUsIFwic2NyaXB0XCIgKTtcblx0XHRpZiAoIGRlc3RFbGVtZW50cy5sZW5ndGggPiAwICkge1xuXHRcdFx0c2V0R2xvYmFsRXZhbCggZGVzdEVsZW1lbnRzLCAhaW5QYWdlICYmIGdldEFsbCggZWxlbSwgXCJzY3JpcHRcIiApICk7XG5cdFx0fVxuXG5cdFx0Ly8gUmV0dXJuIHRoZSBjbG9uZWQgc2V0XG5cdFx0cmV0dXJuIGNsb25lO1xuXHR9LFxuXG5cdGJ1aWxkRnJhZ21lbnQ6IGZ1bmN0aW9uKCBlbGVtcywgY29udGV4dCwgc2NyaXB0cywgc2VsZWN0aW9uICkge1xuXHRcdHZhciBlbGVtLCB0bXAsIHRhZywgd3JhcCwgY29udGFpbnMsIGosXG5cdFx0XHRmcmFnbWVudCA9IGNvbnRleHQuY3JlYXRlRG9jdW1lbnRGcmFnbWVudCgpLFxuXHRcdFx0bm9kZXMgPSBbXSxcblx0XHRcdGkgPSAwLFxuXHRcdFx0bCA9IGVsZW1zLmxlbmd0aDtcblxuXHRcdGZvciAoIDsgaSA8IGw7IGkrKyApIHtcblx0XHRcdGVsZW0gPSBlbGVtc1sgaSBdO1xuXG5cdFx0XHRpZiAoIGVsZW0gfHwgZWxlbSA9PT0gMCApIHtcblxuXHRcdFx0XHQvLyBBZGQgbm9kZXMgZGlyZWN0bHlcblx0XHRcdFx0aWYgKCBqUXVlcnkudHlwZSggZWxlbSApID09PSBcIm9iamVjdFwiICkge1xuXHRcdFx0XHRcdC8vIFN1cHBvcnQ6IFF0V2ViS2l0LCBQaGFudG9tSlNcblx0XHRcdFx0XHQvLyBwdXNoLmFwcGx5KF8sIGFycmF5bGlrZSkgdGhyb3dzIG9uIGFuY2llbnQgV2ViS2l0XG5cdFx0XHRcdFx0alF1ZXJ5Lm1lcmdlKCBub2RlcywgZWxlbS5ub2RlVHlwZSA/IFsgZWxlbSBdIDogZWxlbSApO1xuXG5cdFx0XHRcdC8vIENvbnZlcnQgbm9uLWh0bWwgaW50byBhIHRleHQgbm9kZVxuXHRcdFx0XHR9IGVsc2UgaWYgKCAhcmh0bWwudGVzdCggZWxlbSApICkge1xuXHRcdFx0XHRcdG5vZGVzLnB1c2goIGNvbnRleHQuY3JlYXRlVGV4dE5vZGUoIGVsZW0gKSApO1xuXG5cdFx0XHRcdC8vIENvbnZlcnQgaHRtbCBpbnRvIERPTSBub2Rlc1xuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdHRtcCA9IHRtcCB8fCBmcmFnbWVudC5hcHBlbmRDaGlsZCggY29udGV4dC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpICk7XG5cblx0XHRcdFx0XHQvLyBEZXNlcmlhbGl6ZSBhIHN0YW5kYXJkIHJlcHJlc2VudGF0aW9uXG5cdFx0XHRcdFx0dGFnID0gKCBydGFnTmFtZS5leGVjKCBlbGVtICkgfHwgWyBcIlwiLCBcIlwiIF0gKVsgMSBdLnRvTG93ZXJDYXNlKCk7XG5cdFx0XHRcdFx0d3JhcCA9IHdyYXBNYXBbIHRhZyBdIHx8IHdyYXBNYXAuX2RlZmF1bHQ7XG5cdFx0XHRcdFx0dG1wLmlubmVySFRNTCA9IHdyYXBbIDEgXSArIGVsZW0ucmVwbGFjZSggcnhodG1sVGFnLCBcIjwkMT48LyQyPlwiICkgKyB3cmFwWyAyIF07XG5cblx0XHRcdFx0XHQvLyBEZXNjZW5kIHRocm91Z2ggd3JhcHBlcnMgdG8gdGhlIHJpZ2h0IGNvbnRlbnRcblx0XHRcdFx0XHRqID0gd3JhcFsgMCBdO1xuXHRcdFx0XHRcdHdoaWxlICggai0tICkge1xuXHRcdFx0XHRcdFx0dG1wID0gdG1wLmxhc3RDaGlsZDtcblx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHQvLyBTdXBwb3J0OiBRdFdlYktpdCwgUGhhbnRvbUpTXG5cdFx0XHRcdFx0Ly8gcHVzaC5hcHBseShfLCBhcnJheWxpa2UpIHRocm93cyBvbiBhbmNpZW50IFdlYktpdFxuXHRcdFx0XHRcdGpRdWVyeS5tZXJnZSggbm9kZXMsIHRtcC5jaGlsZE5vZGVzICk7XG5cblx0XHRcdFx0XHQvLyBSZW1lbWJlciB0aGUgdG9wLWxldmVsIGNvbnRhaW5lclxuXHRcdFx0XHRcdHRtcCA9IGZyYWdtZW50LmZpcnN0Q2hpbGQ7XG5cblx0XHRcdFx0XHQvLyBFbnN1cmUgdGhlIGNyZWF0ZWQgbm9kZXMgYXJlIG9ycGhhbmVkICgjMTIzOTIpXG5cdFx0XHRcdFx0dG1wLnRleHRDb250ZW50ID0gXCJcIjtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH1cblxuXHRcdC8vIFJlbW92ZSB3cmFwcGVyIGZyb20gZnJhZ21lbnRcblx0XHRmcmFnbWVudC50ZXh0Q29udGVudCA9IFwiXCI7XG5cblx0XHRpID0gMDtcblx0XHR3aGlsZSAoIChlbGVtID0gbm9kZXNbIGkrKyBdKSApIHtcblxuXHRcdFx0Ly8gIzQwODcgLSBJZiBvcmlnaW4gYW5kIGRlc3RpbmF0aW9uIGVsZW1lbnRzIGFyZSB0aGUgc2FtZSwgYW5kIHRoaXMgaXNcblx0XHRcdC8vIHRoYXQgZWxlbWVudCwgZG8gbm90IGRvIGFueXRoaW5nXG5cdFx0XHRpZiAoIHNlbGVjdGlvbiAmJiBqUXVlcnkuaW5BcnJheSggZWxlbSwgc2VsZWN0aW9uICkgIT09IC0xICkge1xuXHRcdFx0XHRjb250aW51ZTtcblx0XHRcdH1cblxuXHRcdFx0Y29udGFpbnMgPSBqUXVlcnkuY29udGFpbnMoIGVsZW0ub3duZXJEb2N1bWVudCwgZWxlbSApO1xuXG5cdFx0XHQvLyBBcHBlbmQgdG8gZnJhZ21lbnRcblx0XHRcdHRtcCA9IGdldEFsbCggZnJhZ21lbnQuYXBwZW5kQ2hpbGQoIGVsZW0gKSwgXCJzY3JpcHRcIiApO1xuXG5cdFx0XHQvLyBQcmVzZXJ2ZSBzY3JpcHQgZXZhbHVhdGlvbiBoaXN0b3J5XG5cdFx0XHRpZiAoIGNvbnRhaW5zICkge1xuXHRcdFx0XHRzZXRHbG9iYWxFdmFsKCB0bXAgKTtcblx0XHRcdH1cblxuXHRcdFx0Ly8gQ2FwdHVyZSBleGVjdXRhYmxlc1xuXHRcdFx0aWYgKCBzY3JpcHRzICkge1xuXHRcdFx0XHRqID0gMDtcblx0XHRcdFx0d2hpbGUgKCAoZWxlbSA9IHRtcFsgaisrIF0pICkge1xuXHRcdFx0XHRcdGlmICggcnNjcmlwdFR5cGUudGVzdCggZWxlbS50eXBlIHx8IFwiXCIgKSApIHtcblx0XHRcdFx0XHRcdHNjcmlwdHMucHVzaCggZWxlbSApO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH1cblxuXHRcdHJldHVybiBmcmFnbWVudDtcblx0fSxcblxuXHRjbGVhbkRhdGE6IGZ1bmN0aW9uKCBlbGVtcyApIHtcblx0XHR2YXIgZGF0YSwgZWxlbSwgdHlwZSwga2V5LFxuXHRcdFx0c3BlY2lhbCA9IGpRdWVyeS5ldmVudC5zcGVjaWFsLFxuXHRcdFx0aSA9IDA7XG5cblx0XHRmb3IgKCA7IChlbGVtID0gZWxlbXNbIGkgXSkgIT09IHVuZGVmaW5lZDsgaSsrICkge1xuXHRcdFx0aWYgKCBqUXVlcnkuYWNjZXB0RGF0YSggZWxlbSApICkge1xuXHRcdFx0XHRrZXkgPSBlbGVtWyBkYXRhX3ByaXYuZXhwYW5kbyBdO1xuXG5cdFx0XHRcdGlmICgga2V5ICYmIChkYXRhID0gZGF0YV9wcml2LmNhY2hlWyBrZXkgXSkgKSB7XG5cdFx0XHRcdFx0aWYgKCBkYXRhLmV2ZW50cyApIHtcblx0XHRcdFx0XHRcdGZvciAoIHR5cGUgaW4gZGF0YS5ldmVudHMgKSB7XG5cdFx0XHRcdFx0XHRcdGlmICggc3BlY2lhbFsgdHlwZSBdICkge1xuXHRcdFx0XHRcdFx0XHRcdGpRdWVyeS5ldmVudC5yZW1vdmUoIGVsZW0sIHR5cGUgKTtcblxuXHRcdFx0XHRcdFx0XHQvLyBUaGlzIGlzIGEgc2hvcnRjdXQgdG8gYXZvaWQgalF1ZXJ5LmV2ZW50LnJlbW92ZSdzIG92ZXJoZWFkXG5cdFx0XHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHRcdFx0alF1ZXJ5LnJlbW92ZUV2ZW50KCBlbGVtLCB0eXBlLCBkYXRhLmhhbmRsZSApO1xuXHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdGlmICggZGF0YV9wcml2LmNhY2hlWyBrZXkgXSApIHtcblx0XHRcdFx0XHRcdC8vIERpc2NhcmQgYW55IHJlbWFpbmluZyBgcHJpdmF0ZWAgZGF0YVxuXHRcdFx0XHRcdFx0ZGVsZXRlIGRhdGFfcHJpdi5jYWNoZVsga2V5IF07XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0XHQvLyBEaXNjYXJkIGFueSByZW1haW5pbmcgYHVzZXJgIGRhdGFcblx0XHRcdGRlbGV0ZSBkYXRhX3VzZXIuY2FjaGVbIGVsZW1bIGRhdGFfdXNlci5leHBhbmRvIF0gXTtcblx0XHR9XG5cdH1cbn0pO1xuXG5qUXVlcnkuZm4uZXh0ZW5kKHtcblx0dGV4dDogZnVuY3Rpb24oIHZhbHVlICkge1xuXHRcdHJldHVybiBhY2Nlc3MoIHRoaXMsIGZ1bmN0aW9uKCB2YWx1ZSApIHtcblx0XHRcdHJldHVybiB2YWx1ZSA9PT0gdW5kZWZpbmVkID9cblx0XHRcdFx0alF1ZXJ5LnRleHQoIHRoaXMgKSA6XG5cdFx0XHRcdHRoaXMuZW1wdHkoKS5lYWNoKGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRcdGlmICggdGhpcy5ub2RlVHlwZSA9PT0gMSB8fCB0aGlzLm5vZGVUeXBlID09PSAxMSB8fCB0aGlzLm5vZGVUeXBlID09PSA5ICkge1xuXHRcdFx0XHRcdFx0dGhpcy50ZXh0Q29udGVudCA9IHZhbHVlO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fSk7XG5cdFx0fSwgbnVsbCwgdmFsdWUsIGFyZ3VtZW50cy5sZW5ndGggKTtcblx0fSxcblxuXHRhcHBlbmQ6IGZ1bmN0aW9uKCkge1xuXHRcdHJldHVybiB0aGlzLmRvbU1hbmlwKCBhcmd1bWVudHMsIGZ1bmN0aW9uKCBlbGVtICkge1xuXHRcdFx0aWYgKCB0aGlzLm5vZGVUeXBlID09PSAxIHx8IHRoaXMubm9kZVR5cGUgPT09IDExIHx8IHRoaXMubm9kZVR5cGUgPT09IDkgKSB7XG5cdFx0XHRcdHZhciB0YXJnZXQgPSBtYW5pcHVsYXRpb25UYXJnZXQoIHRoaXMsIGVsZW0gKTtcblx0XHRcdFx0dGFyZ2V0LmFwcGVuZENoaWxkKCBlbGVtICk7XG5cdFx0XHR9XG5cdFx0fSk7XG5cdH0sXG5cblx0cHJlcGVuZDogZnVuY3Rpb24oKSB7XG5cdFx0cmV0dXJuIHRoaXMuZG9tTWFuaXAoIGFyZ3VtZW50cywgZnVuY3Rpb24oIGVsZW0gKSB7XG5cdFx0XHRpZiAoIHRoaXMubm9kZVR5cGUgPT09IDEgfHwgdGhpcy5ub2RlVHlwZSA9PT0gMTEgfHwgdGhpcy5ub2RlVHlwZSA9PT0gOSApIHtcblx0XHRcdFx0dmFyIHRhcmdldCA9IG1hbmlwdWxhdGlvblRhcmdldCggdGhpcywgZWxlbSApO1xuXHRcdFx0XHR0YXJnZXQuaW5zZXJ0QmVmb3JlKCBlbGVtLCB0YXJnZXQuZmlyc3RDaGlsZCApO1xuXHRcdFx0fVxuXHRcdH0pO1xuXHR9LFxuXG5cdGJlZm9yZTogZnVuY3Rpb24oKSB7XG5cdFx0cmV0dXJuIHRoaXMuZG9tTWFuaXAoIGFyZ3VtZW50cywgZnVuY3Rpb24oIGVsZW0gKSB7XG5cdFx0XHRpZiAoIHRoaXMucGFyZW50Tm9kZSApIHtcblx0XHRcdFx0dGhpcy5wYXJlbnROb2RlLmluc2VydEJlZm9yZSggZWxlbSwgdGhpcyApO1xuXHRcdFx0fVxuXHRcdH0pO1xuXHR9LFxuXG5cdGFmdGVyOiBmdW5jdGlvbigpIHtcblx0XHRyZXR1cm4gdGhpcy5kb21NYW5pcCggYXJndW1lbnRzLCBmdW5jdGlvbiggZWxlbSApIHtcblx0XHRcdGlmICggdGhpcy5wYXJlbnROb2RlICkge1xuXHRcdFx0XHR0aGlzLnBhcmVudE5vZGUuaW5zZXJ0QmVmb3JlKCBlbGVtLCB0aGlzLm5leHRTaWJsaW5nICk7XG5cdFx0XHR9XG5cdFx0fSk7XG5cdH0sXG5cblx0cmVtb3ZlOiBmdW5jdGlvbiggc2VsZWN0b3IsIGtlZXBEYXRhIC8qIEludGVybmFsIFVzZSBPbmx5ICovICkge1xuXHRcdHZhciBlbGVtLFxuXHRcdFx0ZWxlbXMgPSBzZWxlY3RvciA/IGpRdWVyeS5maWx0ZXIoIHNlbGVjdG9yLCB0aGlzICkgOiB0aGlzLFxuXHRcdFx0aSA9IDA7XG5cblx0XHRmb3IgKCA7IChlbGVtID0gZWxlbXNbaV0pICE9IG51bGw7IGkrKyApIHtcblx0XHRcdGlmICggIWtlZXBEYXRhICYmIGVsZW0ubm9kZVR5cGUgPT09IDEgKSB7XG5cdFx0XHRcdGpRdWVyeS5jbGVhbkRhdGEoIGdldEFsbCggZWxlbSApICk7XG5cdFx0XHR9XG5cblx0XHRcdGlmICggZWxlbS5wYXJlbnROb2RlICkge1xuXHRcdFx0XHRpZiAoIGtlZXBEYXRhICYmIGpRdWVyeS5jb250YWlucyggZWxlbS5vd25lckRvY3VtZW50LCBlbGVtICkgKSB7XG5cdFx0XHRcdFx0c2V0R2xvYmFsRXZhbCggZ2V0QWxsKCBlbGVtLCBcInNjcmlwdFwiICkgKTtcblx0XHRcdFx0fVxuXHRcdFx0XHRlbGVtLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQoIGVsZW0gKTtcblx0XHRcdH1cblx0XHR9XG5cblx0XHRyZXR1cm4gdGhpcztcblx0fSxcblxuXHRlbXB0eTogZnVuY3Rpb24oKSB7XG5cdFx0dmFyIGVsZW0sXG5cdFx0XHRpID0gMDtcblxuXHRcdGZvciAoIDsgKGVsZW0gPSB0aGlzW2ldKSAhPSBudWxsOyBpKysgKSB7XG5cdFx0XHRpZiAoIGVsZW0ubm9kZVR5cGUgPT09IDEgKSB7XG5cblx0XHRcdFx0Ly8gUHJldmVudCBtZW1vcnkgbGVha3Ncblx0XHRcdFx0alF1ZXJ5LmNsZWFuRGF0YSggZ2V0QWxsKCBlbGVtLCBmYWxzZSApICk7XG5cblx0XHRcdFx0Ly8gUmVtb3ZlIGFueSByZW1haW5pbmcgbm9kZXNcblx0XHRcdFx0ZWxlbS50ZXh0Q29udGVudCA9IFwiXCI7XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0cmV0dXJuIHRoaXM7XG5cdH0sXG5cblx0Y2xvbmU6IGZ1bmN0aW9uKCBkYXRhQW5kRXZlbnRzLCBkZWVwRGF0YUFuZEV2ZW50cyApIHtcblx0XHRkYXRhQW5kRXZlbnRzID0gZGF0YUFuZEV2ZW50cyA9PSBudWxsID8gZmFsc2UgOiBkYXRhQW5kRXZlbnRzO1xuXHRcdGRlZXBEYXRhQW5kRXZlbnRzID0gZGVlcERhdGFBbmRFdmVudHMgPT0gbnVsbCA/IGRhdGFBbmRFdmVudHMgOiBkZWVwRGF0YUFuZEV2ZW50cztcblxuXHRcdHJldHVybiB0aGlzLm1hcChmdW5jdGlvbigpIHtcblx0XHRcdHJldHVybiBqUXVlcnkuY2xvbmUoIHRoaXMsIGRhdGFBbmRFdmVudHMsIGRlZXBEYXRhQW5kRXZlbnRzICk7XG5cdFx0fSk7XG5cdH0sXG5cblx0aHRtbDogZnVuY3Rpb24oIHZhbHVlICkge1xuXHRcdHJldHVybiBhY2Nlc3MoIHRoaXMsIGZ1bmN0aW9uKCB2YWx1ZSApIHtcblx0XHRcdHZhciBlbGVtID0gdGhpc1sgMCBdIHx8IHt9LFxuXHRcdFx0XHRpID0gMCxcblx0XHRcdFx0bCA9IHRoaXMubGVuZ3RoO1xuXG5cdFx0XHRpZiAoIHZhbHVlID09PSB1bmRlZmluZWQgJiYgZWxlbS5ub2RlVHlwZSA9PT0gMSApIHtcblx0XHRcdFx0cmV0dXJuIGVsZW0uaW5uZXJIVE1MO1xuXHRcdFx0fVxuXG5cdFx0XHQvLyBTZWUgaWYgd2UgY2FuIHRha2UgYSBzaG9ydGN1dCBhbmQganVzdCB1c2UgaW5uZXJIVE1MXG5cdFx0XHRpZiAoIHR5cGVvZiB2YWx1ZSA9PT0gXCJzdHJpbmdcIiAmJiAhcm5vSW5uZXJodG1sLnRlc3QoIHZhbHVlICkgJiZcblx0XHRcdFx0IXdyYXBNYXBbICggcnRhZ05hbWUuZXhlYyggdmFsdWUgKSB8fCBbIFwiXCIsIFwiXCIgXSApWyAxIF0udG9Mb3dlckNhc2UoKSBdICkge1xuXG5cdFx0XHRcdHZhbHVlID0gdmFsdWUucmVwbGFjZSggcnhodG1sVGFnLCBcIjwkMT48LyQyPlwiICk7XG5cblx0XHRcdFx0dHJ5IHtcblx0XHRcdFx0XHRmb3IgKCA7IGkgPCBsOyBpKysgKSB7XG5cdFx0XHRcdFx0XHRlbGVtID0gdGhpc1sgaSBdIHx8IHt9O1xuXG5cdFx0XHRcdFx0XHQvLyBSZW1vdmUgZWxlbWVudCBub2RlcyBhbmQgcHJldmVudCBtZW1vcnkgbGVha3Ncblx0XHRcdFx0XHRcdGlmICggZWxlbS5ub2RlVHlwZSA9PT0gMSApIHtcblx0XHRcdFx0XHRcdFx0alF1ZXJ5LmNsZWFuRGF0YSggZ2V0QWxsKCBlbGVtLCBmYWxzZSApICk7XG5cdFx0XHRcdFx0XHRcdGVsZW0uaW5uZXJIVE1MID0gdmFsdWU7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0ZWxlbSA9IDA7XG5cblx0XHRcdFx0Ly8gSWYgdXNpbmcgaW5uZXJIVE1MIHRocm93cyBhbiBleGNlcHRpb24sIHVzZSB0aGUgZmFsbGJhY2sgbWV0aG9kXG5cdFx0XHRcdH0gY2F0Y2goIGUgKSB7fVxuXHRcdFx0fVxuXG5cdFx0XHRpZiAoIGVsZW0gKSB7XG5cdFx0XHRcdHRoaXMuZW1wdHkoKS5hcHBlbmQoIHZhbHVlICk7XG5cdFx0XHR9XG5cdFx0fSwgbnVsbCwgdmFsdWUsIGFyZ3VtZW50cy5sZW5ndGggKTtcblx0fSxcblxuXHRyZXBsYWNlV2l0aDogZnVuY3Rpb24oKSB7XG5cdFx0dmFyIGFyZyA9IGFyZ3VtZW50c1sgMCBdO1xuXG5cdFx0Ly8gTWFrZSB0aGUgY2hhbmdlcywgcmVwbGFjaW5nIGVhY2ggY29udGV4dCBlbGVtZW50IHdpdGggdGhlIG5ldyBjb250ZW50XG5cdFx0dGhpcy5kb21NYW5pcCggYXJndW1lbnRzLCBmdW5jdGlvbiggZWxlbSApIHtcblx0XHRcdGFyZyA9IHRoaXMucGFyZW50Tm9kZTtcblxuXHRcdFx0alF1ZXJ5LmNsZWFuRGF0YSggZ2V0QWxsKCB0aGlzICkgKTtcblxuXHRcdFx0aWYgKCBhcmcgKSB7XG5cdFx0XHRcdGFyZy5yZXBsYWNlQ2hpbGQoIGVsZW0sIHRoaXMgKTtcblx0XHRcdH1cblx0XHR9KTtcblxuXHRcdC8vIEZvcmNlIHJlbW92YWwgaWYgdGhlcmUgd2FzIG5vIG5ldyBjb250ZW50IChlLmcuLCBmcm9tIGVtcHR5IGFyZ3VtZW50cylcblx0XHRyZXR1cm4gYXJnICYmIChhcmcubGVuZ3RoIHx8IGFyZy5ub2RlVHlwZSkgPyB0aGlzIDogdGhpcy5yZW1vdmUoKTtcblx0fSxcblxuXHRkZXRhY2g6IGZ1bmN0aW9uKCBzZWxlY3RvciApIHtcblx0XHRyZXR1cm4gdGhpcy5yZW1vdmUoIHNlbGVjdG9yLCB0cnVlICk7XG5cdH0sXG5cblx0ZG9tTWFuaXA6IGZ1bmN0aW9uKCBhcmdzLCBjYWxsYmFjayApIHtcblxuXHRcdC8vIEZsYXR0ZW4gYW55IG5lc3RlZCBhcnJheXNcblx0XHRhcmdzID0gY29uY2F0LmFwcGx5KCBbXSwgYXJncyApO1xuXG5cdFx0dmFyIGZyYWdtZW50LCBmaXJzdCwgc2NyaXB0cywgaGFzU2NyaXB0cywgbm9kZSwgZG9jLFxuXHRcdFx0aSA9IDAsXG5cdFx0XHRsID0gdGhpcy5sZW5ndGgsXG5cdFx0XHRzZXQgPSB0aGlzLFxuXHRcdFx0aU5vQ2xvbmUgPSBsIC0gMSxcblx0XHRcdHZhbHVlID0gYXJnc1sgMCBdLFxuXHRcdFx0aXNGdW5jdGlvbiA9IGpRdWVyeS5pc0Z1bmN0aW9uKCB2YWx1ZSApO1xuXG5cdFx0Ly8gV2UgY2FuJ3QgY2xvbmVOb2RlIGZyYWdtZW50cyB0aGF0IGNvbnRhaW4gY2hlY2tlZCwgaW4gV2ViS2l0XG5cdFx0aWYgKCBpc0Z1bmN0aW9uIHx8XG5cdFx0XHRcdCggbCA+IDEgJiYgdHlwZW9mIHZhbHVlID09PSBcInN0cmluZ1wiICYmXG5cdFx0XHRcdFx0IXN1cHBvcnQuY2hlY2tDbG9uZSAmJiByY2hlY2tlZC50ZXN0KCB2YWx1ZSApICkgKSB7XG5cdFx0XHRyZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uKCBpbmRleCApIHtcblx0XHRcdFx0dmFyIHNlbGYgPSBzZXQuZXEoIGluZGV4ICk7XG5cdFx0XHRcdGlmICggaXNGdW5jdGlvbiApIHtcblx0XHRcdFx0XHRhcmdzWyAwIF0gPSB2YWx1ZS5jYWxsKCB0aGlzLCBpbmRleCwgc2VsZi5odG1sKCkgKTtcblx0XHRcdFx0fVxuXHRcdFx0XHRzZWxmLmRvbU1hbmlwKCBhcmdzLCBjYWxsYmFjayApO1xuXHRcdFx0fSk7XG5cdFx0fVxuXG5cdFx0aWYgKCBsICkge1xuXHRcdFx0ZnJhZ21lbnQgPSBqUXVlcnkuYnVpbGRGcmFnbWVudCggYXJncywgdGhpc1sgMCBdLm93bmVyRG9jdW1lbnQsIGZhbHNlLCB0aGlzICk7XG5cdFx0XHRmaXJzdCA9IGZyYWdtZW50LmZpcnN0Q2hpbGQ7XG5cblx0XHRcdGlmICggZnJhZ21lbnQuY2hpbGROb2Rlcy5sZW5ndGggPT09IDEgKSB7XG5cdFx0XHRcdGZyYWdtZW50ID0gZmlyc3Q7XG5cdFx0XHR9XG5cblx0XHRcdGlmICggZmlyc3QgKSB7XG5cdFx0XHRcdHNjcmlwdHMgPSBqUXVlcnkubWFwKCBnZXRBbGwoIGZyYWdtZW50LCBcInNjcmlwdFwiICksIGRpc2FibGVTY3JpcHQgKTtcblx0XHRcdFx0aGFzU2NyaXB0cyA9IHNjcmlwdHMubGVuZ3RoO1xuXG5cdFx0XHRcdC8vIFVzZSB0aGUgb3JpZ2luYWwgZnJhZ21lbnQgZm9yIHRoZSBsYXN0IGl0ZW0gaW5zdGVhZCBvZiB0aGUgZmlyc3QgYmVjYXVzZSBpdCBjYW4gZW5kIHVwXG5cdFx0XHRcdC8vIGJlaW5nIGVtcHRpZWQgaW5jb3JyZWN0bHkgaW4gY2VydGFpbiBzaXR1YXRpb25zICgjODA3MCkuXG5cdFx0XHRcdGZvciAoIDsgaSA8IGw7IGkrKyApIHtcblx0XHRcdFx0XHRub2RlID0gZnJhZ21lbnQ7XG5cblx0XHRcdFx0XHRpZiAoIGkgIT09IGlOb0Nsb25lICkge1xuXHRcdFx0XHRcdFx0bm9kZSA9IGpRdWVyeS5jbG9uZSggbm9kZSwgdHJ1ZSwgdHJ1ZSApO1xuXG5cdFx0XHRcdFx0XHQvLyBLZWVwIHJlZmVyZW5jZXMgdG8gY2xvbmVkIHNjcmlwdHMgZm9yIGxhdGVyIHJlc3RvcmF0aW9uXG5cdFx0XHRcdFx0XHRpZiAoIGhhc1NjcmlwdHMgKSB7XG5cdFx0XHRcdFx0XHRcdC8vIFN1cHBvcnQ6IFF0V2ViS2l0XG5cdFx0XHRcdFx0XHRcdC8vIGpRdWVyeS5tZXJnZSBiZWNhdXNlIHB1c2guYXBwbHkoXywgYXJyYXlsaWtlKSB0aHJvd3Ncblx0XHRcdFx0XHRcdFx0alF1ZXJ5Lm1lcmdlKCBzY3JpcHRzLCBnZXRBbGwoIG5vZGUsIFwic2NyaXB0XCIgKSApO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdGNhbGxiYWNrLmNhbGwoIHRoaXNbIGkgXSwgbm9kZSwgaSApO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0aWYgKCBoYXNTY3JpcHRzICkge1xuXHRcdFx0XHRcdGRvYyA9IHNjcmlwdHNbIHNjcmlwdHMubGVuZ3RoIC0gMSBdLm93bmVyRG9jdW1lbnQ7XG5cblx0XHRcdFx0XHQvLyBSZWVuYWJsZSBzY3JpcHRzXG5cdFx0XHRcdFx0alF1ZXJ5Lm1hcCggc2NyaXB0cywgcmVzdG9yZVNjcmlwdCApO1xuXG5cdFx0XHRcdFx0Ly8gRXZhbHVhdGUgZXhlY3V0YWJsZSBzY3JpcHRzIG9uIGZpcnN0IGRvY3VtZW50IGluc2VydGlvblxuXHRcdFx0XHRcdGZvciAoIGkgPSAwOyBpIDwgaGFzU2NyaXB0czsgaSsrICkge1xuXHRcdFx0XHRcdFx0bm9kZSA9IHNjcmlwdHNbIGkgXTtcblx0XHRcdFx0XHRcdGlmICggcnNjcmlwdFR5cGUudGVzdCggbm9kZS50eXBlIHx8IFwiXCIgKSAmJlxuXHRcdFx0XHRcdFx0XHQhZGF0YV9wcml2LmFjY2Vzcyggbm9kZSwgXCJnbG9iYWxFdmFsXCIgKSAmJiBqUXVlcnkuY29udGFpbnMoIGRvYywgbm9kZSApICkge1xuXG5cdFx0XHRcdFx0XHRcdGlmICggbm9kZS5zcmMgKSB7XG5cdFx0XHRcdFx0XHRcdFx0Ly8gT3B0aW9uYWwgQUpBWCBkZXBlbmRlbmN5LCBidXQgd29uJ3QgcnVuIHNjcmlwdHMgaWYgbm90IHByZXNlbnRcblx0XHRcdFx0XHRcdFx0XHRpZiAoIGpRdWVyeS5fZXZhbFVybCApIHtcblx0XHRcdFx0XHRcdFx0XHRcdGpRdWVyeS5fZXZhbFVybCggbm9kZS5zcmMgKTtcblx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHRcdFx0alF1ZXJ5Lmdsb2JhbEV2YWwoIG5vZGUudGV4dENvbnRlbnQucmVwbGFjZSggcmNsZWFuU2NyaXB0LCBcIlwiICkgKTtcblx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH1cblxuXHRcdHJldHVybiB0aGlzO1xuXHR9XG59KTtcblxualF1ZXJ5LmVhY2goe1xuXHRhcHBlbmRUbzogXCJhcHBlbmRcIixcblx0cHJlcGVuZFRvOiBcInByZXBlbmRcIixcblx0aW5zZXJ0QmVmb3JlOiBcImJlZm9yZVwiLFxuXHRpbnNlcnRBZnRlcjogXCJhZnRlclwiLFxuXHRyZXBsYWNlQWxsOiBcInJlcGxhY2VXaXRoXCJcbn0sIGZ1bmN0aW9uKCBuYW1lLCBvcmlnaW5hbCApIHtcblx0alF1ZXJ5LmZuWyBuYW1lIF0gPSBmdW5jdGlvbiggc2VsZWN0b3IgKSB7XG5cdFx0dmFyIGVsZW1zLFxuXHRcdFx0cmV0ID0gW10sXG5cdFx0XHRpbnNlcnQgPSBqUXVlcnkoIHNlbGVjdG9yICksXG5cdFx0XHRsYXN0ID0gaW5zZXJ0Lmxlbmd0aCAtIDEsXG5cdFx0XHRpID0gMDtcblxuXHRcdGZvciAoIDsgaSA8PSBsYXN0OyBpKysgKSB7XG5cdFx0XHRlbGVtcyA9IGkgPT09IGxhc3QgPyB0aGlzIDogdGhpcy5jbG9uZSggdHJ1ZSApO1xuXHRcdFx0alF1ZXJ5KCBpbnNlcnRbIGkgXSApWyBvcmlnaW5hbCBdKCBlbGVtcyApO1xuXG5cdFx0XHQvLyBTdXBwb3J0OiBRdFdlYktpdFxuXHRcdFx0Ly8gLmdldCgpIGJlY2F1c2UgcHVzaC5hcHBseShfLCBhcnJheWxpa2UpIHRocm93c1xuXHRcdFx0cHVzaC5hcHBseSggcmV0LCBlbGVtcy5nZXQoKSApO1xuXHRcdH1cblxuXHRcdHJldHVybiB0aGlzLnB1c2hTdGFjayggcmV0ICk7XG5cdH07XG59KTtcblxuXG52YXIgaWZyYW1lLFxuXHRlbGVtZGlzcGxheSA9IHt9O1xuXG4vKipcbiAqIFJldHJpZXZlIHRoZSBhY3R1YWwgZGlzcGxheSBvZiBhIGVsZW1lbnRcbiAqIEBwYXJhbSB7U3RyaW5nfSBuYW1lIG5vZGVOYW1lIG9mIHRoZSBlbGVtZW50XG4gKiBAcGFyYW0ge09iamVjdH0gZG9jIERvY3VtZW50IG9iamVjdFxuICovXG4vLyBDYWxsZWQgb25seSBmcm9tIHdpdGhpbiBkZWZhdWx0RGlzcGxheVxuZnVuY3Rpb24gYWN0dWFsRGlzcGxheSggbmFtZSwgZG9jICkge1xuXHR2YXIgc3R5bGUsXG5cdFx0ZWxlbSA9IGpRdWVyeSggZG9jLmNyZWF0ZUVsZW1lbnQoIG5hbWUgKSApLmFwcGVuZFRvKCBkb2MuYm9keSApLFxuXG5cdFx0Ly8gZ2V0RGVmYXVsdENvbXB1dGVkU3R5bGUgbWlnaHQgYmUgcmVsaWFibHkgdXNlZCBvbmx5IG9uIGF0dGFjaGVkIGVsZW1lbnRcblx0XHRkaXNwbGF5ID0gd2luZG93LmdldERlZmF1bHRDb21wdXRlZFN0eWxlICYmICggc3R5bGUgPSB3aW5kb3cuZ2V0RGVmYXVsdENvbXB1dGVkU3R5bGUoIGVsZW1bIDAgXSApICkgP1xuXG5cdFx0XHQvLyBVc2Ugb2YgdGhpcyBtZXRob2QgaXMgYSB0ZW1wb3JhcnkgZml4IChtb3JlIGxpa2Ugb3B0aW1pemF0aW9uKSB1bnRpbCBzb21ldGhpbmcgYmV0dGVyIGNvbWVzIGFsb25nLFxuXHRcdFx0Ly8gc2luY2UgaXQgd2FzIHJlbW92ZWQgZnJvbSBzcGVjaWZpY2F0aW9uIGFuZCBzdXBwb3J0ZWQgb25seSBpbiBGRlxuXHRcdFx0c3R5bGUuZGlzcGxheSA6IGpRdWVyeS5jc3MoIGVsZW1bIDAgXSwgXCJkaXNwbGF5XCIgKTtcblxuXHQvLyBXZSBkb24ndCBoYXZlIGFueSBkYXRhIHN0b3JlZCBvbiB0aGUgZWxlbWVudCxcblx0Ly8gc28gdXNlIFwiZGV0YWNoXCIgbWV0aG9kIGFzIGZhc3Qgd2F5IHRvIGdldCByaWQgb2YgdGhlIGVsZW1lbnRcblx0ZWxlbS5kZXRhY2goKTtcblxuXHRyZXR1cm4gZGlzcGxheTtcbn1cblxuLyoqXG4gKiBUcnkgdG8gZGV0ZXJtaW5lIHRoZSBkZWZhdWx0IGRpc3BsYXkgdmFsdWUgb2YgYW4gZWxlbWVudFxuICogQHBhcmFtIHtTdHJpbmd9IG5vZGVOYW1lXG4gKi9cbmZ1bmN0aW9uIGRlZmF1bHREaXNwbGF5KCBub2RlTmFtZSApIHtcblx0dmFyIGRvYyA9IGRvY3VtZW50LFxuXHRcdGRpc3BsYXkgPSBlbGVtZGlzcGxheVsgbm9kZU5hbWUgXTtcblxuXHRpZiAoICFkaXNwbGF5ICkge1xuXHRcdGRpc3BsYXkgPSBhY3R1YWxEaXNwbGF5KCBub2RlTmFtZSwgZG9jICk7XG5cblx0XHQvLyBJZiB0aGUgc2ltcGxlIHdheSBmYWlscywgcmVhZCBmcm9tIGluc2lkZSBhbiBpZnJhbWVcblx0XHRpZiAoIGRpc3BsYXkgPT09IFwibm9uZVwiIHx8ICFkaXNwbGF5ICkge1xuXG5cdFx0XHQvLyBVc2UgdGhlIGFscmVhZHktY3JlYXRlZCBpZnJhbWUgaWYgcG9zc2libGVcblx0XHRcdGlmcmFtZSA9IChpZnJhbWUgfHwgalF1ZXJ5KCBcIjxpZnJhbWUgZnJhbWVib3JkZXI9JzAnIHdpZHRoPScwJyBoZWlnaHQ9JzAnLz5cIiApKS5hcHBlbmRUbyggZG9jLmRvY3VtZW50RWxlbWVudCApO1xuXG5cdFx0XHQvLyBBbHdheXMgd3JpdGUgYSBuZXcgSFRNTCBza2VsZXRvbiBzbyBXZWJraXQgYW5kIEZpcmVmb3ggZG9uJ3QgY2hva2Ugb24gcmV1c2Vcblx0XHRcdGRvYyA9IGlmcmFtZVsgMCBdLmNvbnRlbnREb2N1bWVudDtcblxuXHRcdFx0Ly8gU3VwcG9ydDogSUVcblx0XHRcdGRvYy53cml0ZSgpO1xuXHRcdFx0ZG9jLmNsb3NlKCk7XG5cblx0XHRcdGRpc3BsYXkgPSBhY3R1YWxEaXNwbGF5KCBub2RlTmFtZSwgZG9jICk7XG5cdFx0XHRpZnJhbWUuZGV0YWNoKCk7XG5cdFx0fVxuXG5cdFx0Ly8gU3RvcmUgdGhlIGNvcnJlY3QgZGVmYXVsdCBkaXNwbGF5XG5cdFx0ZWxlbWRpc3BsYXlbIG5vZGVOYW1lIF0gPSBkaXNwbGF5O1xuXHR9XG5cblx0cmV0dXJuIGRpc3BsYXk7XG59XG52YXIgcm1hcmdpbiA9ICgvXm1hcmdpbi8pO1xuXG52YXIgcm51bW5vbnB4ID0gbmV3IFJlZ0V4cCggXCJeKFwiICsgcG51bSArIFwiKSg/IXB4KVthLXolXSskXCIsIFwiaVwiICk7XG5cbnZhciBnZXRTdHlsZXMgPSBmdW5jdGlvbiggZWxlbSApIHtcblx0XHQvLyBTdXBwb3J0OiBJRTw9MTErLCBGaXJlZm94PD0zMCsgKCMxNTA5OCwgIzE0MTUwKVxuXHRcdC8vIElFIHRocm93cyBvbiBlbGVtZW50cyBjcmVhdGVkIGluIHBvcHVwc1xuXHRcdC8vIEZGIG1lYW53aGlsZSB0aHJvd3Mgb24gZnJhbWUgZWxlbWVudHMgdGhyb3VnaCBcImRlZmF1bHRWaWV3LmdldENvbXB1dGVkU3R5bGVcIlxuXHRcdGlmICggZWxlbS5vd25lckRvY3VtZW50LmRlZmF1bHRWaWV3Lm9wZW5lciApIHtcblx0XHRcdHJldHVybiBlbGVtLm93bmVyRG9jdW1lbnQuZGVmYXVsdFZpZXcuZ2V0Q29tcHV0ZWRTdHlsZSggZWxlbSwgbnVsbCApO1xuXHRcdH1cblxuXHRcdHJldHVybiB3aW5kb3cuZ2V0Q29tcHV0ZWRTdHlsZSggZWxlbSwgbnVsbCApO1xuXHR9O1xuXG5cblxuZnVuY3Rpb24gY3VyQ1NTKCBlbGVtLCBuYW1lLCBjb21wdXRlZCApIHtcblx0dmFyIHdpZHRoLCBtaW5XaWR0aCwgbWF4V2lkdGgsIHJldCxcblx0XHRzdHlsZSA9IGVsZW0uc3R5bGU7XG5cblx0Y29tcHV0ZWQgPSBjb21wdXRlZCB8fCBnZXRTdHlsZXMoIGVsZW0gKTtcblxuXHQvLyBTdXBwb3J0OiBJRTlcblx0Ly8gZ2V0UHJvcGVydHlWYWx1ZSBpcyBvbmx5IG5lZWRlZCBmb3IgLmNzcygnZmlsdGVyJykgKCMxMjUzNylcblx0aWYgKCBjb21wdXRlZCApIHtcblx0XHRyZXQgPSBjb21wdXRlZC5nZXRQcm9wZXJ0eVZhbHVlKCBuYW1lICkgfHwgY29tcHV0ZWRbIG5hbWUgXTtcblx0fVxuXG5cdGlmICggY29tcHV0ZWQgKSB7XG5cblx0XHRpZiAoIHJldCA9PT0gXCJcIiAmJiAhalF1ZXJ5LmNvbnRhaW5zKCBlbGVtLm93bmVyRG9jdW1lbnQsIGVsZW0gKSApIHtcblx0XHRcdHJldCA9IGpRdWVyeS5zdHlsZSggZWxlbSwgbmFtZSApO1xuXHRcdH1cblxuXHRcdC8vIFN1cHBvcnQ6IGlPUyA8IDZcblx0XHQvLyBBIHRyaWJ1dGUgdG8gdGhlIFwiYXdlc29tZSBoYWNrIGJ5IERlYW4gRWR3YXJkc1wiXG5cdFx0Ly8gaU9TIDwgNiAoYXQgbGVhc3QpIHJldHVybnMgcGVyY2VudGFnZSBmb3IgYSBsYXJnZXIgc2V0IG9mIHZhbHVlcywgYnV0IHdpZHRoIHNlZW1zIHRvIGJlIHJlbGlhYmx5IHBpeGVsc1xuXHRcdC8vIHRoaXMgaXMgYWdhaW5zdCB0aGUgQ1NTT00gZHJhZnQgc3BlYzogaHR0cDovL2Rldi53My5vcmcvY3Nzd2cvY3Nzb20vI3Jlc29sdmVkLXZhbHVlc1xuXHRcdGlmICggcm51bW5vbnB4LnRlc3QoIHJldCApICYmIHJtYXJnaW4udGVzdCggbmFtZSApICkge1xuXG5cdFx0XHQvLyBSZW1lbWJlciB0aGUgb3JpZ2luYWwgdmFsdWVzXG5cdFx0XHR3aWR0aCA9IHN0eWxlLndpZHRoO1xuXHRcdFx0bWluV2lkdGggPSBzdHlsZS5taW5XaWR0aDtcblx0XHRcdG1heFdpZHRoID0gc3R5bGUubWF4V2lkdGg7XG5cblx0XHRcdC8vIFB1dCBpbiB0aGUgbmV3IHZhbHVlcyB0byBnZXQgYSBjb21wdXRlZCB2YWx1ZSBvdXRcblx0XHRcdHN0eWxlLm1pbldpZHRoID0gc3R5bGUubWF4V2lkdGggPSBzdHlsZS53aWR0aCA9IHJldDtcblx0XHRcdHJldCA9IGNvbXB1dGVkLndpZHRoO1xuXG5cdFx0XHQvLyBSZXZlcnQgdGhlIGNoYW5nZWQgdmFsdWVzXG5cdFx0XHRzdHlsZS53aWR0aCA9IHdpZHRoO1xuXHRcdFx0c3R5bGUubWluV2lkdGggPSBtaW5XaWR0aDtcblx0XHRcdHN0eWxlLm1heFdpZHRoID0gbWF4V2lkdGg7XG5cdFx0fVxuXHR9XG5cblx0cmV0dXJuIHJldCAhPT0gdW5kZWZpbmVkID9cblx0XHQvLyBTdXBwb3J0OiBJRVxuXHRcdC8vIElFIHJldHVybnMgekluZGV4IHZhbHVlIGFzIGFuIGludGVnZXIuXG5cdFx0cmV0ICsgXCJcIiA6XG5cdFx0cmV0O1xufVxuXG5cbmZ1bmN0aW9uIGFkZEdldEhvb2tJZiggY29uZGl0aW9uRm4sIGhvb2tGbiApIHtcblx0Ly8gRGVmaW5lIHRoZSBob29rLCB3ZSdsbCBjaGVjayBvbiB0aGUgZmlyc3QgcnVuIGlmIGl0J3MgcmVhbGx5IG5lZWRlZC5cblx0cmV0dXJuIHtcblx0XHRnZXQ6IGZ1bmN0aW9uKCkge1xuXHRcdFx0aWYgKCBjb25kaXRpb25GbigpICkge1xuXHRcdFx0XHQvLyBIb29rIG5vdCBuZWVkZWQgKG9yIGl0J3Mgbm90IHBvc3NpYmxlIHRvIHVzZSBpdCBkdWVcblx0XHRcdFx0Ly8gdG8gbWlzc2luZyBkZXBlbmRlbmN5KSwgcmVtb3ZlIGl0LlxuXHRcdFx0XHRkZWxldGUgdGhpcy5nZXQ7XG5cdFx0XHRcdHJldHVybjtcblx0XHRcdH1cblxuXHRcdFx0Ly8gSG9vayBuZWVkZWQ7IHJlZGVmaW5lIGl0IHNvIHRoYXQgdGhlIHN1cHBvcnQgdGVzdCBpcyBub3QgZXhlY3V0ZWQgYWdhaW4uXG5cdFx0XHRyZXR1cm4gKHRoaXMuZ2V0ID0gaG9va0ZuKS5hcHBseSggdGhpcywgYXJndW1lbnRzICk7XG5cdFx0fVxuXHR9O1xufVxuXG5cbihmdW5jdGlvbigpIHtcblx0dmFyIHBpeGVsUG9zaXRpb25WYWwsIGJveFNpemluZ1JlbGlhYmxlVmFsLFxuXHRcdGRvY0VsZW0gPSBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQsXG5cdFx0Y29udGFpbmVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCggXCJkaXZcIiApLFxuXHRcdGRpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoIFwiZGl2XCIgKTtcblxuXHRpZiAoICFkaXYuc3R5bGUgKSB7XG5cdFx0cmV0dXJuO1xuXHR9XG5cblx0Ly8gU3VwcG9ydDogSUU5LTExK1xuXHQvLyBTdHlsZSBvZiBjbG9uZWQgZWxlbWVudCBhZmZlY3RzIHNvdXJjZSBlbGVtZW50IGNsb25lZCAoIzg5MDgpXG5cdGRpdi5zdHlsZS5iYWNrZ3JvdW5kQ2xpcCA9IFwiY29udGVudC1ib3hcIjtcblx0ZGl2LmNsb25lTm9kZSggdHJ1ZSApLnN0eWxlLmJhY2tncm91bmRDbGlwID0gXCJcIjtcblx0c3VwcG9ydC5jbGVhckNsb25lU3R5bGUgPSBkaXYuc3R5bGUuYmFja2dyb3VuZENsaXAgPT09IFwiY29udGVudC1ib3hcIjtcblxuXHRjb250YWluZXIuc3R5bGUuY3NzVGV4dCA9IFwiYm9yZGVyOjA7d2lkdGg6MDtoZWlnaHQ6MDt0b3A6MDtsZWZ0Oi05OTk5cHg7bWFyZ2luLXRvcDoxcHg7XCIgK1xuXHRcdFwicG9zaXRpb246YWJzb2x1dGVcIjtcblx0Y29udGFpbmVyLmFwcGVuZENoaWxkKCBkaXYgKTtcblxuXHQvLyBFeGVjdXRpbmcgYm90aCBwaXhlbFBvc2l0aW9uICYgYm94U2l6aW5nUmVsaWFibGUgdGVzdHMgcmVxdWlyZSBvbmx5IG9uZSBsYXlvdXRcblx0Ly8gc28gdGhleSdyZSBleGVjdXRlZCBhdCB0aGUgc2FtZSB0aW1lIHRvIHNhdmUgdGhlIHNlY29uZCBjb21wdXRhdGlvbi5cblx0ZnVuY3Rpb24gY29tcHV0ZVBpeGVsUG9zaXRpb25BbmRCb3hTaXppbmdSZWxpYWJsZSgpIHtcblx0XHRkaXYuc3R5bGUuY3NzVGV4dCA9XG5cdFx0XHQvLyBTdXBwb3J0OiBGaXJlZm94PDI5LCBBbmRyb2lkIDIuM1xuXHRcdFx0Ly8gVmVuZG9yLXByZWZpeCBib3gtc2l6aW5nXG5cdFx0XHRcIi13ZWJraXQtYm94LXNpemluZzpib3JkZXItYm94Oy1tb3otYm94LXNpemluZzpib3JkZXItYm94O1wiICtcblx0XHRcdFwiYm94LXNpemluZzpib3JkZXItYm94O2Rpc3BsYXk6YmxvY2s7bWFyZ2luLXRvcDoxJTt0b3A6MSU7XCIgK1xuXHRcdFx0XCJib3JkZXI6MXB4O3BhZGRpbmc6MXB4O3dpZHRoOjRweDtwb3NpdGlvbjphYnNvbHV0ZVwiO1xuXHRcdGRpdi5pbm5lckhUTUwgPSBcIlwiO1xuXHRcdGRvY0VsZW0uYXBwZW5kQ2hpbGQoIGNvbnRhaW5lciApO1xuXG5cdFx0dmFyIGRpdlN0eWxlID0gd2luZG93LmdldENvbXB1dGVkU3R5bGUoIGRpdiwgbnVsbCApO1xuXHRcdHBpeGVsUG9zaXRpb25WYWwgPSBkaXZTdHlsZS50b3AgIT09IFwiMSVcIjtcblx0XHRib3hTaXppbmdSZWxpYWJsZVZhbCA9IGRpdlN0eWxlLndpZHRoID09PSBcIjRweFwiO1xuXG5cdFx0ZG9jRWxlbS5yZW1vdmVDaGlsZCggY29udGFpbmVyICk7XG5cdH1cblxuXHQvLyBTdXBwb3J0OiBub2RlLmpzIGpzZG9tXG5cdC8vIERvbid0IGFzc3VtZSB0aGF0IGdldENvbXB1dGVkU3R5bGUgaXMgYSBwcm9wZXJ0eSBvZiB0aGUgZ2xvYmFsIG9iamVjdFxuXHRpZiAoIHdpbmRvdy5nZXRDb21wdXRlZFN0eWxlICkge1xuXHRcdGpRdWVyeS5leHRlbmQoIHN1cHBvcnQsIHtcblx0XHRcdHBpeGVsUG9zaXRpb246IGZ1bmN0aW9uKCkge1xuXG5cdFx0XHRcdC8vIFRoaXMgdGVzdCBpcyBleGVjdXRlZCBvbmx5IG9uY2UgYnV0IHdlIHN0aWxsIGRvIG1lbW9pemluZ1xuXHRcdFx0XHQvLyBzaW5jZSB3ZSBjYW4gdXNlIHRoZSBib3hTaXppbmdSZWxpYWJsZSBwcmUtY29tcHV0aW5nLlxuXHRcdFx0XHQvLyBObyBuZWVkIHRvIGNoZWNrIGlmIHRoZSB0ZXN0IHdhcyBhbHJlYWR5IHBlcmZvcm1lZCwgdGhvdWdoLlxuXHRcdFx0XHRjb21wdXRlUGl4ZWxQb3NpdGlvbkFuZEJveFNpemluZ1JlbGlhYmxlKCk7XG5cdFx0XHRcdHJldHVybiBwaXhlbFBvc2l0aW9uVmFsO1xuXHRcdFx0fSxcblx0XHRcdGJveFNpemluZ1JlbGlhYmxlOiBmdW5jdGlvbigpIHtcblx0XHRcdFx0aWYgKCBib3hTaXppbmdSZWxpYWJsZVZhbCA9PSBudWxsICkge1xuXHRcdFx0XHRcdGNvbXB1dGVQaXhlbFBvc2l0aW9uQW5kQm94U2l6aW5nUmVsaWFibGUoKTtcblx0XHRcdFx0fVxuXHRcdFx0XHRyZXR1cm4gYm94U2l6aW5nUmVsaWFibGVWYWw7XG5cdFx0XHR9LFxuXHRcdFx0cmVsaWFibGVNYXJnaW5SaWdodDogZnVuY3Rpb24oKSB7XG5cblx0XHRcdFx0Ly8gU3VwcG9ydDogQW5kcm9pZCAyLjNcblx0XHRcdFx0Ly8gQ2hlY2sgaWYgZGl2IHdpdGggZXhwbGljaXQgd2lkdGggYW5kIG5vIG1hcmdpbi1yaWdodCBpbmNvcnJlY3RseVxuXHRcdFx0XHQvLyBnZXRzIGNvbXB1dGVkIG1hcmdpbi1yaWdodCBiYXNlZCBvbiB3aWR0aCBvZiBjb250YWluZXIuICgjMzMzMylcblx0XHRcdFx0Ly8gV2ViS2l0IEJ1ZyAxMzM0MyAtIGdldENvbXB1dGVkU3R5bGUgcmV0dXJucyB3cm9uZyB2YWx1ZSBmb3IgbWFyZ2luLXJpZ2h0XG5cdFx0XHRcdC8vIFRoaXMgc3VwcG9ydCBmdW5jdGlvbiBpcyBvbmx5IGV4ZWN1dGVkIG9uY2Ugc28gbm8gbWVtb2l6aW5nIGlzIG5lZWRlZC5cblx0XHRcdFx0dmFyIHJldCxcblx0XHRcdFx0XHRtYXJnaW5EaXYgPSBkaXYuYXBwZW5kQ2hpbGQoIGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoIFwiZGl2XCIgKSApO1xuXG5cdFx0XHRcdC8vIFJlc2V0IENTUzogYm94LXNpemluZzsgZGlzcGxheTsgbWFyZ2luOyBib3JkZXI7IHBhZGRpbmdcblx0XHRcdFx0bWFyZ2luRGl2LnN0eWxlLmNzc1RleHQgPSBkaXYuc3R5bGUuY3NzVGV4dCA9XG5cdFx0XHRcdFx0Ly8gU3VwcG9ydDogRmlyZWZveDwyOSwgQW5kcm9pZCAyLjNcblx0XHRcdFx0XHQvLyBWZW5kb3ItcHJlZml4IGJveC1zaXppbmdcblx0XHRcdFx0XHRcIi13ZWJraXQtYm94LXNpemluZzpjb250ZW50LWJveDstbW96LWJveC1zaXppbmc6Y29udGVudC1ib3g7XCIgK1xuXHRcdFx0XHRcdFwiYm94LXNpemluZzpjb250ZW50LWJveDtkaXNwbGF5OmJsb2NrO21hcmdpbjowO2JvcmRlcjowO3BhZGRpbmc6MFwiO1xuXHRcdFx0XHRtYXJnaW5EaXYuc3R5bGUubWFyZ2luUmlnaHQgPSBtYXJnaW5EaXYuc3R5bGUud2lkdGggPSBcIjBcIjtcblx0XHRcdFx0ZGl2LnN0eWxlLndpZHRoID0gXCIxcHhcIjtcblx0XHRcdFx0ZG9jRWxlbS5hcHBlbmRDaGlsZCggY29udGFpbmVyICk7XG5cblx0XHRcdFx0cmV0ID0gIXBhcnNlRmxvYXQoIHdpbmRvdy5nZXRDb21wdXRlZFN0eWxlKCBtYXJnaW5EaXYsIG51bGwgKS5tYXJnaW5SaWdodCApO1xuXG5cdFx0XHRcdGRvY0VsZW0ucmVtb3ZlQ2hpbGQoIGNvbnRhaW5lciApO1xuXHRcdFx0XHRkaXYucmVtb3ZlQ2hpbGQoIG1hcmdpbkRpdiApO1xuXG5cdFx0XHRcdHJldHVybiByZXQ7XG5cdFx0XHR9XG5cdFx0fSk7XG5cdH1cbn0pKCk7XG5cblxuLy8gQSBtZXRob2QgZm9yIHF1aWNrbHkgc3dhcHBpbmcgaW4vb3V0IENTUyBwcm9wZXJ0aWVzIHRvIGdldCBjb3JyZWN0IGNhbGN1bGF0aW9ucy5cbmpRdWVyeS5zd2FwID0gZnVuY3Rpb24oIGVsZW0sIG9wdGlvbnMsIGNhbGxiYWNrLCBhcmdzICkge1xuXHR2YXIgcmV0LCBuYW1lLFxuXHRcdG9sZCA9IHt9O1xuXG5cdC8vIFJlbWVtYmVyIHRoZSBvbGQgdmFsdWVzLCBhbmQgaW5zZXJ0IHRoZSBuZXcgb25lc1xuXHRmb3IgKCBuYW1lIGluIG9wdGlvbnMgKSB7XG5cdFx0b2xkWyBuYW1lIF0gPSBlbGVtLnN0eWxlWyBuYW1lIF07XG5cdFx0ZWxlbS5zdHlsZVsgbmFtZSBdID0gb3B0aW9uc1sgbmFtZSBdO1xuXHR9XG5cblx0cmV0ID0gY2FsbGJhY2suYXBwbHkoIGVsZW0sIGFyZ3MgfHwgW10gKTtcblxuXHQvLyBSZXZlcnQgdGhlIG9sZCB2YWx1ZXNcblx0Zm9yICggbmFtZSBpbiBvcHRpb25zICkge1xuXHRcdGVsZW0uc3R5bGVbIG5hbWUgXSA9IG9sZFsgbmFtZSBdO1xuXHR9XG5cblx0cmV0dXJuIHJldDtcbn07XG5cblxudmFyXG5cdC8vIFN3YXBwYWJsZSBpZiBkaXNwbGF5IGlzIG5vbmUgb3Igc3RhcnRzIHdpdGggdGFibGUgZXhjZXB0IFwidGFibGVcIiwgXCJ0YWJsZS1jZWxsXCIsIG9yIFwidGFibGUtY2FwdGlvblwiXG5cdC8vIFNlZSBoZXJlIGZvciBkaXNwbGF5IHZhbHVlczogaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZW4tVVMvZG9jcy9DU1MvZGlzcGxheVxuXHRyZGlzcGxheXN3YXAgPSAvXihub25lfHRhYmxlKD8hLWNbZWFdKS4rKS8sXG5cdHJudW1zcGxpdCA9IG5ldyBSZWdFeHAoIFwiXihcIiArIHBudW0gKyBcIikoLiopJFwiLCBcImlcIiApLFxuXHRycmVsTnVtID0gbmV3IFJlZ0V4cCggXCJeKFsrLV0pPShcIiArIHBudW0gKyBcIilcIiwgXCJpXCIgKSxcblxuXHRjc3NTaG93ID0geyBwb3NpdGlvbjogXCJhYnNvbHV0ZVwiLCB2aXNpYmlsaXR5OiBcImhpZGRlblwiLCBkaXNwbGF5OiBcImJsb2NrXCIgfSxcblx0Y3NzTm9ybWFsVHJhbnNmb3JtID0ge1xuXHRcdGxldHRlclNwYWNpbmc6IFwiMFwiLFxuXHRcdGZvbnRXZWlnaHQ6IFwiNDAwXCJcblx0fSxcblxuXHRjc3NQcmVmaXhlcyA9IFsgXCJXZWJraXRcIiwgXCJPXCIsIFwiTW96XCIsIFwibXNcIiBdO1xuXG4vLyBSZXR1cm4gYSBjc3MgcHJvcGVydHkgbWFwcGVkIHRvIGEgcG90ZW50aWFsbHkgdmVuZG9yIHByZWZpeGVkIHByb3BlcnR5XG5mdW5jdGlvbiB2ZW5kb3JQcm9wTmFtZSggc3R5bGUsIG5hbWUgKSB7XG5cblx0Ly8gU2hvcnRjdXQgZm9yIG5hbWVzIHRoYXQgYXJlIG5vdCB2ZW5kb3IgcHJlZml4ZWRcblx0aWYgKCBuYW1lIGluIHN0eWxlICkge1xuXHRcdHJldHVybiBuYW1lO1xuXHR9XG5cblx0Ly8gQ2hlY2sgZm9yIHZlbmRvciBwcmVmaXhlZCBuYW1lc1xuXHR2YXIgY2FwTmFtZSA9IG5hbWVbMF0udG9VcHBlckNhc2UoKSArIG5hbWUuc2xpY2UoMSksXG5cdFx0b3JpZ05hbWUgPSBuYW1lLFxuXHRcdGkgPSBjc3NQcmVmaXhlcy5sZW5ndGg7XG5cblx0d2hpbGUgKCBpLS0gKSB7XG5cdFx0bmFtZSA9IGNzc1ByZWZpeGVzWyBpIF0gKyBjYXBOYW1lO1xuXHRcdGlmICggbmFtZSBpbiBzdHlsZSApIHtcblx0XHRcdHJldHVybiBuYW1lO1xuXHRcdH1cblx0fVxuXG5cdHJldHVybiBvcmlnTmFtZTtcbn1cblxuZnVuY3Rpb24gc2V0UG9zaXRpdmVOdW1iZXIoIGVsZW0sIHZhbHVlLCBzdWJ0cmFjdCApIHtcblx0dmFyIG1hdGNoZXMgPSBybnVtc3BsaXQuZXhlYyggdmFsdWUgKTtcblx0cmV0dXJuIG1hdGNoZXMgP1xuXHRcdC8vIEd1YXJkIGFnYWluc3QgdW5kZWZpbmVkIFwic3VidHJhY3RcIiwgZS5nLiwgd2hlbiB1c2VkIGFzIGluIGNzc0hvb2tzXG5cdFx0TWF0aC5tYXgoIDAsIG1hdGNoZXNbIDEgXSAtICggc3VidHJhY3QgfHwgMCApICkgKyAoIG1hdGNoZXNbIDIgXSB8fCBcInB4XCIgKSA6XG5cdFx0dmFsdWU7XG59XG5cbmZ1bmN0aW9uIGF1Z21lbnRXaWR0aE9ySGVpZ2h0KCBlbGVtLCBuYW1lLCBleHRyYSwgaXNCb3JkZXJCb3gsIHN0eWxlcyApIHtcblx0dmFyIGkgPSBleHRyYSA9PT0gKCBpc0JvcmRlckJveCA/IFwiYm9yZGVyXCIgOiBcImNvbnRlbnRcIiApID9cblx0XHQvLyBJZiB3ZSBhbHJlYWR5IGhhdmUgdGhlIHJpZ2h0IG1lYXN1cmVtZW50LCBhdm9pZCBhdWdtZW50YXRpb25cblx0XHQ0IDpcblx0XHQvLyBPdGhlcndpc2UgaW5pdGlhbGl6ZSBmb3IgaG9yaXpvbnRhbCBvciB2ZXJ0aWNhbCBwcm9wZXJ0aWVzXG5cdFx0bmFtZSA9PT0gXCJ3aWR0aFwiID8gMSA6IDAsXG5cblx0XHR2YWwgPSAwO1xuXG5cdGZvciAoIDsgaSA8IDQ7IGkgKz0gMiApIHtcblx0XHQvLyBCb3RoIGJveCBtb2RlbHMgZXhjbHVkZSBtYXJnaW4sIHNvIGFkZCBpdCBpZiB3ZSB3YW50IGl0XG5cdFx0aWYgKCBleHRyYSA9PT0gXCJtYXJnaW5cIiApIHtcblx0XHRcdHZhbCArPSBqUXVlcnkuY3NzKCBlbGVtLCBleHRyYSArIGNzc0V4cGFuZFsgaSBdLCB0cnVlLCBzdHlsZXMgKTtcblx0XHR9XG5cblx0XHRpZiAoIGlzQm9yZGVyQm94ICkge1xuXHRcdFx0Ly8gYm9yZGVyLWJveCBpbmNsdWRlcyBwYWRkaW5nLCBzbyByZW1vdmUgaXQgaWYgd2Ugd2FudCBjb250ZW50XG5cdFx0XHRpZiAoIGV4dHJhID09PSBcImNvbnRlbnRcIiApIHtcblx0XHRcdFx0dmFsIC09IGpRdWVyeS5jc3MoIGVsZW0sIFwicGFkZGluZ1wiICsgY3NzRXhwYW5kWyBpIF0sIHRydWUsIHN0eWxlcyApO1xuXHRcdFx0fVxuXG5cdFx0XHQvLyBBdCB0aGlzIHBvaW50LCBleHRyYSBpc24ndCBib3JkZXIgbm9yIG1hcmdpbiwgc28gcmVtb3ZlIGJvcmRlclxuXHRcdFx0aWYgKCBleHRyYSAhPT0gXCJtYXJnaW5cIiApIHtcblx0XHRcdFx0dmFsIC09IGpRdWVyeS5jc3MoIGVsZW0sIFwiYm9yZGVyXCIgKyBjc3NFeHBhbmRbIGkgXSArIFwiV2lkdGhcIiwgdHJ1ZSwgc3R5bGVzICk7XG5cdFx0XHR9XG5cdFx0fSBlbHNlIHtcblx0XHRcdC8vIEF0IHRoaXMgcG9pbnQsIGV4dHJhIGlzbid0IGNvbnRlbnQsIHNvIGFkZCBwYWRkaW5nXG5cdFx0XHR2YWwgKz0galF1ZXJ5LmNzcyggZWxlbSwgXCJwYWRkaW5nXCIgKyBjc3NFeHBhbmRbIGkgXSwgdHJ1ZSwgc3R5bGVzICk7XG5cblx0XHRcdC8vIEF0IHRoaXMgcG9pbnQsIGV4dHJhIGlzbid0IGNvbnRlbnQgbm9yIHBhZGRpbmcsIHNvIGFkZCBib3JkZXJcblx0XHRcdGlmICggZXh0cmEgIT09IFwicGFkZGluZ1wiICkge1xuXHRcdFx0XHR2YWwgKz0galF1ZXJ5LmNzcyggZWxlbSwgXCJib3JkZXJcIiArIGNzc0V4cGFuZFsgaSBdICsgXCJXaWR0aFwiLCB0cnVlLCBzdHlsZXMgKTtcblx0XHRcdH1cblx0XHR9XG5cdH1cblxuXHRyZXR1cm4gdmFsO1xufVxuXG5mdW5jdGlvbiBnZXRXaWR0aE9ySGVpZ2h0KCBlbGVtLCBuYW1lLCBleHRyYSApIHtcblxuXHQvLyBTdGFydCB3aXRoIG9mZnNldCBwcm9wZXJ0eSwgd2hpY2ggaXMgZXF1aXZhbGVudCB0byB0aGUgYm9yZGVyLWJveCB2YWx1ZVxuXHR2YXIgdmFsdWVJc0JvcmRlckJveCA9IHRydWUsXG5cdFx0dmFsID0gbmFtZSA9PT0gXCJ3aWR0aFwiID8gZWxlbS5vZmZzZXRXaWR0aCA6IGVsZW0ub2Zmc2V0SGVpZ2h0LFxuXHRcdHN0eWxlcyA9IGdldFN0eWxlcyggZWxlbSApLFxuXHRcdGlzQm9yZGVyQm94ID0galF1ZXJ5LmNzcyggZWxlbSwgXCJib3hTaXppbmdcIiwgZmFsc2UsIHN0eWxlcyApID09PSBcImJvcmRlci1ib3hcIjtcblxuXHQvLyBTb21lIG5vbi1odG1sIGVsZW1lbnRzIHJldHVybiB1bmRlZmluZWQgZm9yIG9mZnNldFdpZHRoLCBzbyBjaGVjayBmb3IgbnVsbC91bmRlZmluZWRcblx0Ly8gc3ZnIC0gaHR0cHM6Ly9idWd6aWxsYS5tb3ppbGxhLm9yZy9zaG93X2J1Zy5jZ2k/aWQ9NjQ5Mjg1XG5cdC8vIE1hdGhNTCAtIGh0dHBzOi8vYnVnemlsbGEubW96aWxsYS5vcmcvc2hvd19idWcuY2dpP2lkPTQ5MTY2OFxuXHRpZiAoIHZhbCA8PSAwIHx8IHZhbCA9PSBudWxsICkge1xuXHRcdC8vIEZhbGwgYmFjayB0byBjb21wdXRlZCB0aGVuIHVuY29tcHV0ZWQgY3NzIGlmIG5lY2Vzc2FyeVxuXHRcdHZhbCA9IGN1ckNTUyggZWxlbSwgbmFtZSwgc3R5bGVzICk7XG5cdFx0aWYgKCB2YWwgPCAwIHx8IHZhbCA9PSBudWxsICkge1xuXHRcdFx0dmFsID0gZWxlbS5zdHlsZVsgbmFtZSBdO1xuXHRcdH1cblxuXHRcdC8vIENvbXB1dGVkIHVuaXQgaXMgbm90IHBpeGVscy4gU3RvcCBoZXJlIGFuZCByZXR1cm4uXG5cdFx0aWYgKCBybnVtbm9ucHgudGVzdCh2YWwpICkge1xuXHRcdFx0cmV0dXJuIHZhbDtcblx0XHR9XG5cblx0XHQvLyBDaGVjayBmb3Igc3R5bGUgaW4gY2FzZSBhIGJyb3dzZXIgd2hpY2ggcmV0dXJucyB1bnJlbGlhYmxlIHZhbHVlc1xuXHRcdC8vIGZvciBnZXRDb21wdXRlZFN0eWxlIHNpbGVudGx5IGZhbGxzIGJhY2sgdG8gdGhlIHJlbGlhYmxlIGVsZW0uc3R5bGVcblx0XHR2YWx1ZUlzQm9yZGVyQm94ID0gaXNCb3JkZXJCb3ggJiZcblx0XHRcdCggc3VwcG9ydC5ib3hTaXppbmdSZWxpYWJsZSgpIHx8IHZhbCA9PT0gZWxlbS5zdHlsZVsgbmFtZSBdICk7XG5cblx0XHQvLyBOb3JtYWxpemUgXCJcIiwgYXV0bywgYW5kIHByZXBhcmUgZm9yIGV4dHJhXG5cdFx0dmFsID0gcGFyc2VGbG9hdCggdmFsICkgfHwgMDtcblx0fVxuXG5cdC8vIFVzZSB0aGUgYWN0aXZlIGJveC1zaXppbmcgbW9kZWwgdG8gYWRkL3N1YnRyYWN0IGlycmVsZXZhbnQgc3R5bGVzXG5cdHJldHVybiAoIHZhbCArXG5cdFx0YXVnbWVudFdpZHRoT3JIZWlnaHQoXG5cdFx0XHRlbGVtLFxuXHRcdFx0bmFtZSxcblx0XHRcdGV4dHJhIHx8ICggaXNCb3JkZXJCb3ggPyBcImJvcmRlclwiIDogXCJjb250ZW50XCIgKSxcblx0XHRcdHZhbHVlSXNCb3JkZXJCb3gsXG5cdFx0XHRzdHlsZXNcblx0XHQpXG5cdCkgKyBcInB4XCI7XG59XG5cbmZ1bmN0aW9uIHNob3dIaWRlKCBlbGVtZW50cywgc2hvdyApIHtcblx0dmFyIGRpc3BsYXksIGVsZW0sIGhpZGRlbixcblx0XHR2YWx1ZXMgPSBbXSxcblx0XHRpbmRleCA9IDAsXG5cdFx0bGVuZ3RoID0gZWxlbWVudHMubGVuZ3RoO1xuXG5cdGZvciAoIDsgaW5kZXggPCBsZW5ndGg7IGluZGV4KysgKSB7XG5cdFx0ZWxlbSA9IGVsZW1lbnRzWyBpbmRleCBdO1xuXHRcdGlmICggIWVsZW0uc3R5bGUgKSB7XG5cdFx0XHRjb250aW51ZTtcblx0XHR9XG5cblx0XHR2YWx1ZXNbIGluZGV4IF0gPSBkYXRhX3ByaXYuZ2V0KCBlbGVtLCBcIm9sZGRpc3BsYXlcIiApO1xuXHRcdGRpc3BsYXkgPSBlbGVtLnN0eWxlLmRpc3BsYXk7XG5cdFx0aWYgKCBzaG93ICkge1xuXHRcdFx0Ly8gUmVzZXQgdGhlIGlubGluZSBkaXNwbGF5IG9mIHRoaXMgZWxlbWVudCB0byBsZWFybiBpZiBpdCBpc1xuXHRcdFx0Ly8gYmVpbmcgaGlkZGVuIGJ5IGNhc2NhZGVkIHJ1bGVzIG9yIG5vdFxuXHRcdFx0aWYgKCAhdmFsdWVzWyBpbmRleCBdICYmIGRpc3BsYXkgPT09IFwibm9uZVwiICkge1xuXHRcdFx0XHRlbGVtLnN0eWxlLmRpc3BsYXkgPSBcIlwiO1xuXHRcdFx0fVxuXG5cdFx0XHQvLyBTZXQgZWxlbWVudHMgd2hpY2ggaGF2ZSBiZWVuIG92ZXJyaWRkZW4gd2l0aCBkaXNwbGF5OiBub25lXG5cdFx0XHQvLyBpbiBhIHN0eWxlc2hlZXQgdG8gd2hhdGV2ZXIgdGhlIGRlZmF1bHQgYnJvd3NlciBzdHlsZSBpc1xuXHRcdFx0Ly8gZm9yIHN1Y2ggYW4gZWxlbWVudFxuXHRcdFx0aWYgKCBlbGVtLnN0eWxlLmRpc3BsYXkgPT09IFwiXCIgJiYgaXNIaWRkZW4oIGVsZW0gKSApIHtcblx0XHRcdFx0dmFsdWVzWyBpbmRleCBdID0gZGF0YV9wcml2LmFjY2VzcyggZWxlbSwgXCJvbGRkaXNwbGF5XCIsIGRlZmF1bHREaXNwbGF5KGVsZW0ubm9kZU5hbWUpICk7XG5cdFx0XHR9XG5cdFx0fSBlbHNlIHtcblx0XHRcdGhpZGRlbiA9IGlzSGlkZGVuKCBlbGVtICk7XG5cblx0XHRcdGlmICggZGlzcGxheSAhPT0gXCJub25lXCIgfHwgIWhpZGRlbiApIHtcblx0XHRcdFx0ZGF0YV9wcml2LnNldCggZWxlbSwgXCJvbGRkaXNwbGF5XCIsIGhpZGRlbiA/IGRpc3BsYXkgOiBqUXVlcnkuY3NzKCBlbGVtLCBcImRpc3BsYXlcIiApICk7XG5cdFx0XHR9XG5cdFx0fVxuXHR9XG5cblx0Ly8gU2V0IHRoZSBkaXNwbGF5IG9mIG1vc3Qgb2YgdGhlIGVsZW1lbnRzIGluIGEgc2Vjb25kIGxvb3Bcblx0Ly8gdG8gYXZvaWQgdGhlIGNvbnN0YW50IHJlZmxvd1xuXHRmb3IgKCBpbmRleCA9IDA7IGluZGV4IDwgbGVuZ3RoOyBpbmRleCsrICkge1xuXHRcdGVsZW0gPSBlbGVtZW50c1sgaW5kZXggXTtcblx0XHRpZiAoICFlbGVtLnN0eWxlICkge1xuXHRcdFx0Y29udGludWU7XG5cdFx0fVxuXHRcdGlmICggIXNob3cgfHwgZWxlbS5zdHlsZS5kaXNwbGF5ID09PSBcIm5vbmVcIiB8fCBlbGVtLnN0eWxlLmRpc3BsYXkgPT09IFwiXCIgKSB7XG5cdFx0XHRlbGVtLnN0eWxlLmRpc3BsYXkgPSBzaG93ID8gdmFsdWVzWyBpbmRleCBdIHx8IFwiXCIgOiBcIm5vbmVcIjtcblx0XHR9XG5cdH1cblxuXHRyZXR1cm4gZWxlbWVudHM7XG59XG5cbmpRdWVyeS5leHRlbmQoe1xuXG5cdC8vIEFkZCBpbiBzdHlsZSBwcm9wZXJ0eSBob29rcyBmb3Igb3ZlcnJpZGluZyB0aGUgZGVmYXVsdFxuXHQvLyBiZWhhdmlvciBvZiBnZXR0aW5nIGFuZCBzZXR0aW5nIGEgc3R5bGUgcHJvcGVydHlcblx0Y3NzSG9va3M6IHtcblx0XHRvcGFjaXR5OiB7XG5cdFx0XHRnZXQ6IGZ1bmN0aW9uKCBlbGVtLCBjb21wdXRlZCApIHtcblx0XHRcdFx0aWYgKCBjb21wdXRlZCApIHtcblxuXHRcdFx0XHRcdC8vIFdlIHNob3VsZCBhbHdheXMgZ2V0IGEgbnVtYmVyIGJhY2sgZnJvbSBvcGFjaXR5XG5cdFx0XHRcdFx0dmFyIHJldCA9IGN1ckNTUyggZWxlbSwgXCJvcGFjaXR5XCIgKTtcblx0XHRcdFx0XHRyZXR1cm4gcmV0ID09PSBcIlwiID8gXCIxXCIgOiByZXQ7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9XG5cdH0sXG5cblx0Ly8gRG9uJ3QgYXV0b21hdGljYWxseSBhZGQgXCJweFwiIHRvIHRoZXNlIHBvc3NpYmx5LXVuaXRsZXNzIHByb3BlcnRpZXNcblx0Y3NzTnVtYmVyOiB7XG5cdFx0XCJjb2x1bW5Db3VudFwiOiB0cnVlLFxuXHRcdFwiZmlsbE9wYWNpdHlcIjogdHJ1ZSxcblx0XHRcImZsZXhHcm93XCI6IHRydWUsXG5cdFx0XCJmbGV4U2hyaW5rXCI6IHRydWUsXG5cdFx0XCJmb250V2VpZ2h0XCI6IHRydWUsXG5cdFx0XCJsaW5lSGVpZ2h0XCI6IHRydWUsXG5cdFx0XCJvcGFjaXR5XCI6IHRydWUsXG5cdFx0XCJvcmRlclwiOiB0cnVlLFxuXHRcdFwib3JwaGFuc1wiOiB0cnVlLFxuXHRcdFwid2lkb3dzXCI6IHRydWUsXG5cdFx0XCJ6SW5kZXhcIjogdHJ1ZSxcblx0XHRcInpvb21cIjogdHJ1ZVxuXHR9LFxuXG5cdC8vIEFkZCBpbiBwcm9wZXJ0aWVzIHdob3NlIG5hbWVzIHlvdSB3aXNoIHRvIGZpeCBiZWZvcmVcblx0Ly8gc2V0dGluZyBvciBnZXR0aW5nIHRoZSB2YWx1ZVxuXHRjc3NQcm9wczoge1xuXHRcdFwiZmxvYXRcIjogXCJjc3NGbG9hdFwiXG5cdH0sXG5cblx0Ly8gR2V0IGFuZCBzZXQgdGhlIHN0eWxlIHByb3BlcnR5IG9uIGEgRE9NIE5vZGVcblx0c3R5bGU6IGZ1bmN0aW9uKCBlbGVtLCBuYW1lLCB2YWx1ZSwgZXh0cmEgKSB7XG5cblx0XHQvLyBEb24ndCBzZXQgc3R5bGVzIG9uIHRleHQgYW5kIGNvbW1lbnQgbm9kZXNcblx0XHRpZiAoICFlbGVtIHx8IGVsZW0ubm9kZVR5cGUgPT09IDMgfHwgZWxlbS5ub2RlVHlwZSA9PT0gOCB8fCAhZWxlbS5zdHlsZSApIHtcblx0XHRcdHJldHVybjtcblx0XHR9XG5cblx0XHQvLyBNYWtlIHN1cmUgdGhhdCB3ZSdyZSB3b3JraW5nIHdpdGggdGhlIHJpZ2h0IG5hbWVcblx0XHR2YXIgcmV0LCB0eXBlLCBob29rcyxcblx0XHRcdG9yaWdOYW1lID0galF1ZXJ5LmNhbWVsQ2FzZSggbmFtZSApLFxuXHRcdFx0c3R5bGUgPSBlbGVtLnN0eWxlO1xuXG5cdFx0bmFtZSA9IGpRdWVyeS5jc3NQcm9wc1sgb3JpZ05hbWUgXSB8fCAoIGpRdWVyeS5jc3NQcm9wc1sgb3JpZ05hbWUgXSA9IHZlbmRvclByb3BOYW1lKCBzdHlsZSwgb3JpZ05hbWUgKSApO1xuXG5cdFx0Ly8gR2V0cyBob29rIGZvciB0aGUgcHJlZml4ZWQgdmVyc2lvbiwgdGhlbiB1bnByZWZpeGVkIHZlcnNpb25cblx0XHRob29rcyA9IGpRdWVyeS5jc3NIb29rc1sgbmFtZSBdIHx8IGpRdWVyeS5jc3NIb29rc1sgb3JpZ05hbWUgXTtcblxuXHRcdC8vIENoZWNrIGlmIHdlJ3JlIHNldHRpbmcgYSB2YWx1ZVxuXHRcdGlmICggdmFsdWUgIT09IHVuZGVmaW5lZCApIHtcblx0XHRcdHR5cGUgPSB0eXBlb2YgdmFsdWU7XG5cblx0XHRcdC8vIENvbnZlcnQgXCIrPVwiIG9yIFwiLT1cIiB0byByZWxhdGl2ZSBudW1iZXJzICgjNzM0NSlcblx0XHRcdGlmICggdHlwZSA9PT0gXCJzdHJpbmdcIiAmJiAocmV0ID0gcnJlbE51bS5leGVjKCB2YWx1ZSApKSApIHtcblx0XHRcdFx0dmFsdWUgPSAoIHJldFsxXSArIDEgKSAqIHJldFsyXSArIHBhcnNlRmxvYXQoIGpRdWVyeS5jc3MoIGVsZW0sIG5hbWUgKSApO1xuXHRcdFx0XHQvLyBGaXhlcyBidWcgIzkyMzdcblx0XHRcdFx0dHlwZSA9IFwibnVtYmVyXCI7XG5cdFx0XHR9XG5cblx0XHRcdC8vIE1ha2Ugc3VyZSB0aGF0IG51bGwgYW5kIE5hTiB2YWx1ZXMgYXJlbid0IHNldCAoIzcxMTYpXG5cdFx0XHRpZiAoIHZhbHVlID09IG51bGwgfHwgdmFsdWUgIT09IHZhbHVlICkge1xuXHRcdFx0XHRyZXR1cm47XG5cdFx0XHR9XG5cblx0XHRcdC8vIElmIGEgbnVtYmVyLCBhZGQgJ3B4JyB0byB0aGUgKGV4Y2VwdCBmb3IgY2VydGFpbiBDU1MgcHJvcGVydGllcylcblx0XHRcdGlmICggdHlwZSA9PT0gXCJudW1iZXJcIiAmJiAhalF1ZXJ5LmNzc051bWJlclsgb3JpZ05hbWUgXSApIHtcblx0XHRcdFx0dmFsdWUgKz0gXCJweFwiO1xuXHRcdFx0fVxuXG5cdFx0XHQvLyBTdXBwb3J0OiBJRTktMTErXG5cdFx0XHQvLyBiYWNrZ3JvdW5kLSogcHJvcHMgYWZmZWN0IG9yaWdpbmFsIGNsb25lJ3MgdmFsdWVzXG5cdFx0XHRpZiAoICFzdXBwb3J0LmNsZWFyQ2xvbmVTdHlsZSAmJiB2YWx1ZSA9PT0gXCJcIiAmJiBuYW1lLmluZGV4T2YoIFwiYmFja2dyb3VuZFwiICkgPT09IDAgKSB7XG5cdFx0XHRcdHN0eWxlWyBuYW1lIF0gPSBcImluaGVyaXRcIjtcblx0XHRcdH1cblxuXHRcdFx0Ly8gSWYgYSBob29rIHdhcyBwcm92aWRlZCwgdXNlIHRoYXQgdmFsdWUsIG90aGVyd2lzZSBqdXN0IHNldCB0aGUgc3BlY2lmaWVkIHZhbHVlXG5cdFx0XHRpZiAoICFob29rcyB8fCAhKFwic2V0XCIgaW4gaG9va3MpIHx8ICh2YWx1ZSA9IGhvb2tzLnNldCggZWxlbSwgdmFsdWUsIGV4dHJhICkpICE9PSB1bmRlZmluZWQgKSB7XG5cdFx0XHRcdHN0eWxlWyBuYW1lIF0gPSB2YWx1ZTtcblx0XHRcdH1cblxuXHRcdH0gZWxzZSB7XG5cdFx0XHQvLyBJZiBhIGhvb2sgd2FzIHByb3ZpZGVkIGdldCB0aGUgbm9uLWNvbXB1dGVkIHZhbHVlIGZyb20gdGhlcmVcblx0XHRcdGlmICggaG9va3MgJiYgXCJnZXRcIiBpbiBob29rcyAmJiAocmV0ID0gaG9va3MuZ2V0KCBlbGVtLCBmYWxzZSwgZXh0cmEgKSkgIT09IHVuZGVmaW5lZCApIHtcblx0XHRcdFx0cmV0dXJuIHJldDtcblx0XHRcdH1cblxuXHRcdFx0Ly8gT3RoZXJ3aXNlIGp1c3QgZ2V0IHRoZSB2YWx1ZSBmcm9tIHRoZSBzdHlsZSBvYmplY3Rcblx0XHRcdHJldHVybiBzdHlsZVsgbmFtZSBdO1xuXHRcdH1cblx0fSxcblxuXHRjc3M6IGZ1bmN0aW9uKCBlbGVtLCBuYW1lLCBleHRyYSwgc3R5bGVzICkge1xuXHRcdHZhciB2YWwsIG51bSwgaG9va3MsXG5cdFx0XHRvcmlnTmFtZSA9IGpRdWVyeS5jYW1lbENhc2UoIG5hbWUgKTtcblxuXHRcdC8vIE1ha2Ugc3VyZSB0aGF0IHdlJ3JlIHdvcmtpbmcgd2l0aCB0aGUgcmlnaHQgbmFtZVxuXHRcdG5hbWUgPSBqUXVlcnkuY3NzUHJvcHNbIG9yaWdOYW1lIF0gfHwgKCBqUXVlcnkuY3NzUHJvcHNbIG9yaWdOYW1lIF0gPSB2ZW5kb3JQcm9wTmFtZSggZWxlbS5zdHlsZSwgb3JpZ05hbWUgKSApO1xuXG5cdFx0Ly8gVHJ5IHByZWZpeGVkIG5hbWUgZm9sbG93ZWQgYnkgdGhlIHVucHJlZml4ZWQgbmFtZVxuXHRcdGhvb2tzID0galF1ZXJ5LmNzc0hvb2tzWyBuYW1lIF0gfHwgalF1ZXJ5LmNzc0hvb2tzWyBvcmlnTmFtZSBdO1xuXG5cdFx0Ly8gSWYgYSBob29rIHdhcyBwcm92aWRlZCBnZXQgdGhlIGNvbXB1dGVkIHZhbHVlIGZyb20gdGhlcmVcblx0XHRpZiAoIGhvb2tzICYmIFwiZ2V0XCIgaW4gaG9va3MgKSB7XG5cdFx0XHR2YWwgPSBob29rcy5nZXQoIGVsZW0sIHRydWUsIGV4dHJhICk7XG5cdFx0fVxuXG5cdFx0Ly8gT3RoZXJ3aXNlLCBpZiBhIHdheSB0byBnZXQgdGhlIGNvbXB1dGVkIHZhbHVlIGV4aXN0cywgdXNlIHRoYXRcblx0XHRpZiAoIHZhbCA9PT0gdW5kZWZpbmVkICkge1xuXHRcdFx0dmFsID0gY3VyQ1NTKCBlbGVtLCBuYW1lLCBzdHlsZXMgKTtcblx0XHR9XG5cblx0XHQvLyBDb252ZXJ0IFwibm9ybWFsXCIgdG8gY29tcHV0ZWQgdmFsdWVcblx0XHRpZiAoIHZhbCA9PT0gXCJub3JtYWxcIiAmJiBuYW1lIGluIGNzc05vcm1hbFRyYW5zZm9ybSApIHtcblx0XHRcdHZhbCA9IGNzc05vcm1hbFRyYW5zZm9ybVsgbmFtZSBdO1xuXHRcdH1cblxuXHRcdC8vIE1ha2UgbnVtZXJpYyBpZiBmb3JjZWQgb3IgYSBxdWFsaWZpZXIgd2FzIHByb3ZpZGVkIGFuZCB2YWwgbG9va3MgbnVtZXJpY1xuXHRcdGlmICggZXh0cmEgPT09IFwiXCIgfHwgZXh0cmEgKSB7XG5cdFx0XHRudW0gPSBwYXJzZUZsb2F0KCB2YWwgKTtcblx0XHRcdHJldHVybiBleHRyYSA9PT0gdHJ1ZSB8fCBqUXVlcnkuaXNOdW1lcmljKCBudW0gKSA/IG51bSB8fCAwIDogdmFsO1xuXHRcdH1cblx0XHRyZXR1cm4gdmFsO1xuXHR9XG59KTtcblxualF1ZXJ5LmVhY2goWyBcImhlaWdodFwiLCBcIndpZHRoXCIgXSwgZnVuY3Rpb24oIGksIG5hbWUgKSB7XG5cdGpRdWVyeS5jc3NIb29rc1sgbmFtZSBdID0ge1xuXHRcdGdldDogZnVuY3Rpb24oIGVsZW0sIGNvbXB1dGVkLCBleHRyYSApIHtcblx0XHRcdGlmICggY29tcHV0ZWQgKSB7XG5cblx0XHRcdFx0Ly8gQ2VydGFpbiBlbGVtZW50cyBjYW4gaGF2ZSBkaW1lbnNpb24gaW5mbyBpZiB3ZSBpbnZpc2libHkgc2hvdyB0aGVtXG5cdFx0XHRcdC8vIGJ1dCBpdCBtdXN0IGhhdmUgYSBjdXJyZW50IGRpc3BsYXkgc3R5bGUgdGhhdCB3b3VsZCBiZW5lZml0XG5cdFx0XHRcdHJldHVybiByZGlzcGxheXN3YXAudGVzdCggalF1ZXJ5LmNzcyggZWxlbSwgXCJkaXNwbGF5XCIgKSApICYmIGVsZW0ub2Zmc2V0V2lkdGggPT09IDAgP1xuXHRcdFx0XHRcdGpRdWVyeS5zd2FwKCBlbGVtLCBjc3NTaG93LCBmdW5jdGlvbigpIHtcblx0XHRcdFx0XHRcdHJldHVybiBnZXRXaWR0aE9ySGVpZ2h0KCBlbGVtLCBuYW1lLCBleHRyYSApO1xuXHRcdFx0XHRcdH0pIDpcblx0XHRcdFx0XHRnZXRXaWR0aE9ySGVpZ2h0KCBlbGVtLCBuYW1lLCBleHRyYSApO1xuXHRcdFx0fVxuXHRcdH0sXG5cblx0XHRzZXQ6IGZ1bmN0aW9uKCBlbGVtLCB2YWx1ZSwgZXh0cmEgKSB7XG5cdFx0XHR2YXIgc3R5bGVzID0gZXh0cmEgJiYgZ2V0U3R5bGVzKCBlbGVtICk7XG5cdFx0XHRyZXR1cm4gc2V0UG9zaXRpdmVOdW1iZXIoIGVsZW0sIHZhbHVlLCBleHRyYSA/XG5cdFx0XHRcdGF1Z21lbnRXaWR0aE9ySGVpZ2h0KFxuXHRcdFx0XHRcdGVsZW0sXG5cdFx0XHRcdFx0bmFtZSxcblx0XHRcdFx0XHRleHRyYSxcblx0XHRcdFx0XHRqUXVlcnkuY3NzKCBlbGVtLCBcImJveFNpemluZ1wiLCBmYWxzZSwgc3R5bGVzICkgPT09IFwiYm9yZGVyLWJveFwiLFxuXHRcdFx0XHRcdHN0eWxlc1xuXHRcdFx0XHQpIDogMFxuXHRcdFx0KTtcblx0XHR9XG5cdH07XG59KTtcblxuLy8gU3VwcG9ydDogQW5kcm9pZCAyLjNcbmpRdWVyeS5jc3NIb29rcy5tYXJnaW5SaWdodCA9IGFkZEdldEhvb2tJZiggc3VwcG9ydC5yZWxpYWJsZU1hcmdpblJpZ2h0LFxuXHRmdW5jdGlvbiggZWxlbSwgY29tcHV0ZWQgKSB7XG5cdFx0aWYgKCBjb21wdXRlZCApIHtcblx0XHRcdHJldHVybiBqUXVlcnkuc3dhcCggZWxlbSwgeyBcImRpc3BsYXlcIjogXCJpbmxpbmUtYmxvY2tcIiB9LFxuXHRcdFx0XHRjdXJDU1MsIFsgZWxlbSwgXCJtYXJnaW5SaWdodFwiIF0gKTtcblx0XHR9XG5cdH1cbik7XG5cbi8vIFRoZXNlIGhvb2tzIGFyZSB1c2VkIGJ5IGFuaW1hdGUgdG8gZXhwYW5kIHByb3BlcnRpZXNcbmpRdWVyeS5lYWNoKHtcblx0bWFyZ2luOiBcIlwiLFxuXHRwYWRkaW5nOiBcIlwiLFxuXHRib3JkZXI6IFwiV2lkdGhcIlxufSwgZnVuY3Rpb24oIHByZWZpeCwgc3VmZml4ICkge1xuXHRqUXVlcnkuY3NzSG9va3NbIHByZWZpeCArIHN1ZmZpeCBdID0ge1xuXHRcdGV4cGFuZDogZnVuY3Rpb24oIHZhbHVlICkge1xuXHRcdFx0dmFyIGkgPSAwLFxuXHRcdFx0XHRleHBhbmRlZCA9IHt9LFxuXG5cdFx0XHRcdC8vIEFzc3VtZXMgYSBzaW5nbGUgbnVtYmVyIGlmIG5vdCBhIHN0cmluZ1xuXHRcdFx0XHRwYXJ0cyA9IHR5cGVvZiB2YWx1ZSA9PT0gXCJzdHJpbmdcIiA/IHZhbHVlLnNwbGl0KFwiIFwiKSA6IFsgdmFsdWUgXTtcblxuXHRcdFx0Zm9yICggOyBpIDwgNDsgaSsrICkge1xuXHRcdFx0XHRleHBhbmRlZFsgcHJlZml4ICsgY3NzRXhwYW5kWyBpIF0gKyBzdWZmaXggXSA9XG5cdFx0XHRcdFx0cGFydHNbIGkgXSB8fCBwYXJ0c1sgaSAtIDIgXSB8fCBwYXJ0c1sgMCBdO1xuXHRcdFx0fVxuXG5cdFx0XHRyZXR1cm4gZXhwYW5kZWQ7XG5cdFx0fVxuXHR9O1xuXG5cdGlmICggIXJtYXJnaW4udGVzdCggcHJlZml4ICkgKSB7XG5cdFx0alF1ZXJ5LmNzc0hvb2tzWyBwcmVmaXggKyBzdWZmaXggXS5zZXQgPSBzZXRQb3NpdGl2ZU51bWJlcjtcblx0fVxufSk7XG5cbmpRdWVyeS5mbi5leHRlbmQoe1xuXHRjc3M6IGZ1bmN0aW9uKCBuYW1lLCB2YWx1ZSApIHtcblx0XHRyZXR1cm4gYWNjZXNzKCB0aGlzLCBmdW5jdGlvbiggZWxlbSwgbmFtZSwgdmFsdWUgKSB7XG5cdFx0XHR2YXIgc3R5bGVzLCBsZW4sXG5cdFx0XHRcdG1hcCA9IHt9LFxuXHRcdFx0XHRpID0gMDtcblxuXHRcdFx0aWYgKCBqUXVlcnkuaXNBcnJheSggbmFtZSApICkge1xuXHRcdFx0XHRzdHlsZXMgPSBnZXRTdHlsZXMoIGVsZW0gKTtcblx0XHRcdFx0bGVuID0gbmFtZS5sZW5ndGg7XG5cblx0XHRcdFx0Zm9yICggOyBpIDwgbGVuOyBpKysgKSB7XG5cdFx0XHRcdFx0bWFwWyBuYW1lWyBpIF0gXSA9IGpRdWVyeS5jc3MoIGVsZW0sIG5hbWVbIGkgXSwgZmFsc2UsIHN0eWxlcyApO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0cmV0dXJuIG1hcDtcblx0XHRcdH1cblxuXHRcdFx0cmV0dXJuIHZhbHVlICE9PSB1bmRlZmluZWQgP1xuXHRcdFx0XHRqUXVlcnkuc3R5bGUoIGVsZW0sIG5hbWUsIHZhbHVlICkgOlxuXHRcdFx0XHRqUXVlcnkuY3NzKCBlbGVtLCBuYW1lICk7XG5cdFx0fSwgbmFtZSwgdmFsdWUsIGFyZ3VtZW50cy5sZW5ndGggPiAxICk7XG5cdH0sXG5cdHNob3c6IGZ1bmN0aW9uKCkge1xuXHRcdHJldHVybiBzaG93SGlkZSggdGhpcywgdHJ1ZSApO1xuXHR9LFxuXHRoaWRlOiBmdW5jdGlvbigpIHtcblx0XHRyZXR1cm4gc2hvd0hpZGUoIHRoaXMgKTtcblx0fSxcblx0dG9nZ2xlOiBmdW5jdGlvbiggc3RhdGUgKSB7XG5cdFx0aWYgKCB0eXBlb2Ygc3RhdGUgPT09IFwiYm9vbGVhblwiICkge1xuXHRcdFx0cmV0dXJuIHN0YXRlID8gdGhpcy5zaG93KCkgOiB0aGlzLmhpZGUoKTtcblx0XHR9XG5cblx0XHRyZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uKCkge1xuXHRcdFx0aWYgKCBpc0hpZGRlbiggdGhpcyApICkge1xuXHRcdFx0XHRqUXVlcnkoIHRoaXMgKS5zaG93KCk7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRqUXVlcnkoIHRoaXMgKS5oaWRlKCk7XG5cdFx0XHR9XG5cdFx0fSk7XG5cdH1cbn0pO1xuXG5cbmZ1bmN0aW9uIFR3ZWVuKCBlbGVtLCBvcHRpb25zLCBwcm9wLCBlbmQsIGVhc2luZyApIHtcblx0cmV0dXJuIG5ldyBUd2Vlbi5wcm90b3R5cGUuaW5pdCggZWxlbSwgb3B0aW9ucywgcHJvcCwgZW5kLCBlYXNpbmcgKTtcbn1cbmpRdWVyeS5Ud2VlbiA9IFR3ZWVuO1xuXG5Ud2Vlbi5wcm90b3R5cGUgPSB7XG5cdGNvbnN0cnVjdG9yOiBUd2Vlbixcblx0aW5pdDogZnVuY3Rpb24oIGVsZW0sIG9wdGlvbnMsIHByb3AsIGVuZCwgZWFzaW5nLCB1bml0ICkge1xuXHRcdHRoaXMuZWxlbSA9IGVsZW07XG5cdFx0dGhpcy5wcm9wID0gcHJvcDtcblx0XHR0aGlzLmVhc2luZyA9IGVhc2luZyB8fCBcInN3aW5nXCI7XG5cdFx0dGhpcy5vcHRpb25zID0gb3B0aW9ucztcblx0XHR0aGlzLnN0YXJ0ID0gdGhpcy5ub3cgPSB0aGlzLmN1cigpO1xuXHRcdHRoaXMuZW5kID0gZW5kO1xuXHRcdHRoaXMudW5pdCA9IHVuaXQgfHwgKCBqUXVlcnkuY3NzTnVtYmVyWyBwcm9wIF0gPyBcIlwiIDogXCJweFwiICk7XG5cdH0sXG5cdGN1cjogZnVuY3Rpb24oKSB7XG5cdFx0dmFyIGhvb2tzID0gVHdlZW4ucHJvcEhvb2tzWyB0aGlzLnByb3AgXTtcblxuXHRcdHJldHVybiBob29rcyAmJiBob29rcy5nZXQgP1xuXHRcdFx0aG9va3MuZ2V0KCB0aGlzICkgOlxuXHRcdFx0VHdlZW4ucHJvcEhvb2tzLl9kZWZhdWx0LmdldCggdGhpcyApO1xuXHR9LFxuXHRydW46IGZ1bmN0aW9uKCBwZXJjZW50ICkge1xuXHRcdHZhciBlYXNlZCxcblx0XHRcdGhvb2tzID0gVHdlZW4ucHJvcEhvb2tzWyB0aGlzLnByb3AgXTtcblxuXHRcdGlmICggdGhpcy5vcHRpb25zLmR1cmF0aW9uICkge1xuXHRcdFx0dGhpcy5wb3MgPSBlYXNlZCA9IGpRdWVyeS5lYXNpbmdbIHRoaXMuZWFzaW5nIF0oXG5cdFx0XHRcdHBlcmNlbnQsIHRoaXMub3B0aW9ucy5kdXJhdGlvbiAqIHBlcmNlbnQsIDAsIDEsIHRoaXMub3B0aW9ucy5kdXJhdGlvblxuXHRcdFx0KTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0dGhpcy5wb3MgPSBlYXNlZCA9IHBlcmNlbnQ7XG5cdFx0fVxuXHRcdHRoaXMubm93ID0gKCB0aGlzLmVuZCAtIHRoaXMuc3RhcnQgKSAqIGVhc2VkICsgdGhpcy5zdGFydDtcblxuXHRcdGlmICggdGhpcy5vcHRpb25zLnN0ZXAgKSB7XG5cdFx0XHR0aGlzLm9wdGlvbnMuc3RlcC5jYWxsKCB0aGlzLmVsZW0sIHRoaXMubm93LCB0aGlzICk7XG5cdFx0fVxuXG5cdFx0aWYgKCBob29rcyAmJiBob29rcy5zZXQgKSB7XG5cdFx0XHRob29rcy5zZXQoIHRoaXMgKTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0VHdlZW4ucHJvcEhvb2tzLl9kZWZhdWx0LnNldCggdGhpcyApO1xuXHRcdH1cblx0XHRyZXR1cm4gdGhpcztcblx0fVxufTtcblxuVHdlZW4ucHJvdG90eXBlLmluaXQucHJvdG90eXBlID0gVHdlZW4ucHJvdG90eXBlO1xuXG5Ud2Vlbi5wcm9wSG9va3MgPSB7XG5cdF9kZWZhdWx0OiB7XG5cdFx0Z2V0OiBmdW5jdGlvbiggdHdlZW4gKSB7XG5cdFx0XHR2YXIgcmVzdWx0O1xuXG5cdFx0XHRpZiAoIHR3ZWVuLmVsZW1bIHR3ZWVuLnByb3AgXSAhPSBudWxsICYmXG5cdFx0XHRcdCghdHdlZW4uZWxlbS5zdHlsZSB8fCB0d2Vlbi5lbGVtLnN0eWxlWyB0d2Vlbi5wcm9wIF0gPT0gbnVsbCkgKSB7XG5cdFx0XHRcdHJldHVybiB0d2Vlbi5lbGVtWyB0d2Vlbi5wcm9wIF07XG5cdFx0XHR9XG5cblx0XHRcdC8vIFBhc3NpbmcgYW4gZW1wdHkgc3RyaW5nIGFzIGEgM3JkIHBhcmFtZXRlciB0byAuY3NzIHdpbGwgYXV0b21hdGljYWxseVxuXHRcdFx0Ly8gYXR0ZW1wdCBhIHBhcnNlRmxvYXQgYW5kIGZhbGxiYWNrIHRvIGEgc3RyaW5nIGlmIHRoZSBwYXJzZSBmYWlscy5cblx0XHRcdC8vIFNpbXBsZSB2YWx1ZXMgc3VjaCBhcyBcIjEwcHhcIiBhcmUgcGFyc2VkIHRvIEZsb2F0O1xuXHRcdFx0Ly8gY29tcGxleCB2YWx1ZXMgc3VjaCBhcyBcInJvdGF0ZSgxcmFkKVwiIGFyZSByZXR1cm5lZCBhcy1pcy5cblx0XHRcdHJlc3VsdCA9IGpRdWVyeS5jc3MoIHR3ZWVuLmVsZW0sIHR3ZWVuLnByb3AsIFwiXCIgKTtcblx0XHRcdC8vIEVtcHR5IHN0cmluZ3MsIG51bGwsIHVuZGVmaW5lZCBhbmQgXCJhdXRvXCIgYXJlIGNvbnZlcnRlZCB0byAwLlxuXHRcdFx0cmV0dXJuICFyZXN1bHQgfHwgcmVzdWx0ID09PSBcImF1dG9cIiA/IDAgOiByZXN1bHQ7XG5cdFx0fSxcblx0XHRzZXQ6IGZ1bmN0aW9uKCB0d2VlbiApIHtcblx0XHRcdC8vIFVzZSBzdGVwIGhvb2sgZm9yIGJhY2sgY29tcGF0LlxuXHRcdFx0Ly8gVXNlIGNzc0hvb2sgaWYgaXRzIHRoZXJlLlxuXHRcdFx0Ly8gVXNlIC5zdHlsZSBpZiBhdmFpbGFibGUgYW5kIHVzZSBwbGFpbiBwcm9wZXJ0aWVzIHdoZXJlIGF2YWlsYWJsZS5cblx0XHRcdGlmICggalF1ZXJ5LmZ4LnN0ZXBbIHR3ZWVuLnByb3AgXSApIHtcblx0XHRcdFx0alF1ZXJ5LmZ4LnN0ZXBbIHR3ZWVuLnByb3AgXSggdHdlZW4gKTtcblx0XHRcdH0gZWxzZSBpZiAoIHR3ZWVuLmVsZW0uc3R5bGUgJiYgKCB0d2Vlbi5lbGVtLnN0eWxlWyBqUXVlcnkuY3NzUHJvcHNbIHR3ZWVuLnByb3AgXSBdICE9IG51bGwgfHwgalF1ZXJ5LmNzc0hvb2tzWyB0d2Vlbi5wcm9wIF0gKSApIHtcblx0XHRcdFx0alF1ZXJ5LnN0eWxlKCB0d2Vlbi5lbGVtLCB0d2Vlbi5wcm9wLCB0d2Vlbi5ub3cgKyB0d2Vlbi51bml0ICk7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHR0d2Vlbi5lbGVtWyB0d2Vlbi5wcm9wIF0gPSB0d2Vlbi5ub3c7XG5cdFx0XHR9XG5cdFx0fVxuXHR9XG59O1xuXG4vLyBTdXBwb3J0OiBJRTlcbi8vIFBhbmljIGJhc2VkIGFwcHJvYWNoIHRvIHNldHRpbmcgdGhpbmdzIG9uIGRpc2Nvbm5lY3RlZCBub2Rlc1xuVHdlZW4ucHJvcEhvb2tzLnNjcm9sbFRvcCA9IFR3ZWVuLnByb3BIb29rcy5zY3JvbGxMZWZ0ID0ge1xuXHRzZXQ6IGZ1bmN0aW9uKCB0d2VlbiApIHtcblx0XHRpZiAoIHR3ZWVuLmVsZW0ubm9kZVR5cGUgJiYgdHdlZW4uZWxlbS5wYXJlbnROb2RlICkge1xuXHRcdFx0dHdlZW4uZWxlbVsgdHdlZW4ucHJvcCBdID0gdHdlZW4ubm93O1xuXHRcdH1cblx0fVxufTtcblxualF1ZXJ5LmVhc2luZyA9IHtcblx0bGluZWFyOiBmdW5jdGlvbiggcCApIHtcblx0XHRyZXR1cm4gcDtcblx0fSxcblx0c3dpbmc6IGZ1bmN0aW9uKCBwICkge1xuXHRcdHJldHVybiAwLjUgLSBNYXRoLmNvcyggcCAqIE1hdGguUEkgKSAvIDI7XG5cdH1cbn07XG5cbmpRdWVyeS5meCA9IFR3ZWVuLnByb3RvdHlwZS5pbml0O1xuXG4vLyBCYWNrIENvbXBhdCA8MS44IGV4dGVuc2lvbiBwb2ludFxualF1ZXJ5LmZ4LnN0ZXAgPSB7fTtcblxuXG5cblxudmFyXG5cdGZ4Tm93LCB0aW1lcklkLFxuXHRyZnh0eXBlcyA9IC9eKD86dG9nZ2xlfHNob3d8aGlkZSkkLyxcblx0cmZ4bnVtID0gbmV3IFJlZ0V4cCggXCJeKD86KFsrLV0pPXwpKFwiICsgcG51bSArIFwiKShbYS16JV0qKSRcIiwgXCJpXCIgKSxcblx0cnJ1biA9IC9xdWV1ZUhvb2tzJC8sXG5cdGFuaW1hdGlvblByZWZpbHRlcnMgPSBbIGRlZmF1bHRQcmVmaWx0ZXIgXSxcblx0dHdlZW5lcnMgPSB7XG5cdFx0XCIqXCI6IFsgZnVuY3Rpb24oIHByb3AsIHZhbHVlICkge1xuXHRcdFx0dmFyIHR3ZWVuID0gdGhpcy5jcmVhdGVUd2VlbiggcHJvcCwgdmFsdWUgKSxcblx0XHRcdFx0dGFyZ2V0ID0gdHdlZW4uY3VyKCksXG5cdFx0XHRcdHBhcnRzID0gcmZ4bnVtLmV4ZWMoIHZhbHVlICksXG5cdFx0XHRcdHVuaXQgPSBwYXJ0cyAmJiBwYXJ0c1sgMyBdIHx8ICggalF1ZXJ5LmNzc051bWJlclsgcHJvcCBdID8gXCJcIiA6IFwicHhcIiApLFxuXG5cdFx0XHRcdC8vIFN0YXJ0aW5nIHZhbHVlIGNvbXB1dGF0aW9uIGlzIHJlcXVpcmVkIGZvciBwb3RlbnRpYWwgdW5pdCBtaXNtYXRjaGVzXG5cdFx0XHRcdHN0YXJ0ID0gKCBqUXVlcnkuY3NzTnVtYmVyWyBwcm9wIF0gfHwgdW5pdCAhPT0gXCJweFwiICYmICt0YXJnZXQgKSAmJlxuXHRcdFx0XHRcdHJmeG51bS5leGVjKCBqUXVlcnkuY3NzKCB0d2Vlbi5lbGVtLCBwcm9wICkgKSxcblx0XHRcdFx0c2NhbGUgPSAxLFxuXHRcdFx0XHRtYXhJdGVyYXRpb25zID0gMjA7XG5cblx0XHRcdGlmICggc3RhcnQgJiYgc3RhcnRbIDMgXSAhPT0gdW5pdCApIHtcblx0XHRcdFx0Ly8gVHJ1c3QgdW5pdHMgcmVwb3J0ZWQgYnkgalF1ZXJ5LmNzc1xuXHRcdFx0XHR1bml0ID0gdW5pdCB8fCBzdGFydFsgMyBdO1xuXG5cdFx0XHRcdC8vIE1ha2Ugc3VyZSB3ZSB1cGRhdGUgdGhlIHR3ZWVuIHByb3BlcnRpZXMgbGF0ZXIgb25cblx0XHRcdFx0cGFydHMgPSBwYXJ0cyB8fCBbXTtcblxuXHRcdFx0XHQvLyBJdGVyYXRpdmVseSBhcHByb3hpbWF0ZSBmcm9tIGEgbm9uemVybyBzdGFydGluZyBwb2ludFxuXHRcdFx0XHRzdGFydCA9ICt0YXJnZXQgfHwgMTtcblxuXHRcdFx0XHRkbyB7XG5cdFx0XHRcdFx0Ly8gSWYgcHJldmlvdXMgaXRlcmF0aW9uIHplcm9lZCBvdXQsIGRvdWJsZSB1bnRpbCB3ZSBnZXQgKnNvbWV0aGluZyouXG5cdFx0XHRcdFx0Ly8gVXNlIHN0cmluZyBmb3IgZG91Ymxpbmcgc28gd2UgZG9uJ3QgYWNjaWRlbnRhbGx5IHNlZSBzY2FsZSBhcyB1bmNoYW5nZWQgYmVsb3dcblx0XHRcdFx0XHRzY2FsZSA9IHNjYWxlIHx8IFwiLjVcIjtcblxuXHRcdFx0XHRcdC8vIEFkanVzdCBhbmQgYXBwbHlcblx0XHRcdFx0XHRzdGFydCA9IHN0YXJ0IC8gc2NhbGU7XG5cdFx0XHRcdFx0alF1ZXJ5LnN0eWxlKCB0d2Vlbi5lbGVtLCBwcm9wLCBzdGFydCArIHVuaXQgKTtcblxuXHRcdFx0XHQvLyBVcGRhdGUgc2NhbGUsIHRvbGVyYXRpbmcgemVybyBvciBOYU4gZnJvbSB0d2Vlbi5jdXIoKSxcblx0XHRcdFx0Ly8gYnJlYWsgdGhlIGxvb3AgaWYgc2NhbGUgaXMgdW5jaGFuZ2VkIG9yIHBlcmZlY3QsIG9yIGlmIHdlJ3ZlIGp1c3QgaGFkIGVub3VnaFxuXHRcdFx0XHR9IHdoaWxlICggc2NhbGUgIT09IChzY2FsZSA9IHR3ZWVuLmN1cigpIC8gdGFyZ2V0KSAmJiBzY2FsZSAhPT0gMSAmJiAtLW1heEl0ZXJhdGlvbnMgKTtcblx0XHRcdH1cblxuXHRcdFx0Ly8gVXBkYXRlIHR3ZWVuIHByb3BlcnRpZXNcblx0XHRcdGlmICggcGFydHMgKSB7XG5cdFx0XHRcdHN0YXJ0ID0gdHdlZW4uc3RhcnQgPSArc3RhcnQgfHwgK3RhcmdldCB8fCAwO1xuXHRcdFx0XHR0d2Vlbi51bml0ID0gdW5pdDtcblx0XHRcdFx0Ly8gSWYgYSArPS8tPSB0b2tlbiB3YXMgcHJvdmlkZWQsIHdlJ3JlIGRvaW5nIGEgcmVsYXRpdmUgYW5pbWF0aW9uXG5cdFx0XHRcdHR3ZWVuLmVuZCA9IHBhcnRzWyAxIF0gP1xuXHRcdFx0XHRcdHN0YXJ0ICsgKCBwYXJ0c1sgMSBdICsgMSApICogcGFydHNbIDIgXSA6XG5cdFx0XHRcdFx0K3BhcnRzWyAyIF07XG5cdFx0XHR9XG5cblx0XHRcdHJldHVybiB0d2Vlbjtcblx0XHR9IF1cblx0fTtcblxuLy8gQW5pbWF0aW9ucyBjcmVhdGVkIHN5bmNocm9ub3VzbHkgd2lsbCBydW4gc3luY2hyb25vdXNseVxuZnVuY3Rpb24gY3JlYXRlRnhOb3coKSB7XG5cdHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XG5cdFx0ZnhOb3cgPSB1bmRlZmluZWQ7XG5cdH0pO1xuXHRyZXR1cm4gKCBmeE5vdyA9IGpRdWVyeS5ub3coKSApO1xufVxuXG4vLyBHZW5lcmF0ZSBwYXJhbWV0ZXJzIHRvIGNyZWF0ZSBhIHN0YW5kYXJkIGFuaW1hdGlvblxuZnVuY3Rpb24gZ2VuRngoIHR5cGUsIGluY2x1ZGVXaWR0aCApIHtcblx0dmFyIHdoaWNoLFxuXHRcdGkgPSAwLFxuXHRcdGF0dHJzID0geyBoZWlnaHQ6IHR5cGUgfTtcblxuXHQvLyBJZiB3ZSBpbmNsdWRlIHdpZHRoLCBzdGVwIHZhbHVlIGlzIDEgdG8gZG8gYWxsIGNzc0V4cGFuZCB2YWx1ZXMsXG5cdC8vIG90aGVyd2lzZSBzdGVwIHZhbHVlIGlzIDIgdG8gc2tpcCBvdmVyIExlZnQgYW5kIFJpZ2h0XG5cdGluY2x1ZGVXaWR0aCA9IGluY2x1ZGVXaWR0aCA/IDEgOiAwO1xuXHRmb3IgKCA7IGkgPCA0IDsgaSArPSAyIC0gaW5jbHVkZVdpZHRoICkge1xuXHRcdHdoaWNoID0gY3NzRXhwYW5kWyBpIF07XG5cdFx0YXR0cnNbIFwibWFyZ2luXCIgKyB3aGljaCBdID0gYXR0cnNbIFwicGFkZGluZ1wiICsgd2hpY2ggXSA9IHR5cGU7XG5cdH1cblxuXHRpZiAoIGluY2x1ZGVXaWR0aCApIHtcblx0XHRhdHRycy5vcGFjaXR5ID0gYXR0cnMud2lkdGggPSB0eXBlO1xuXHR9XG5cblx0cmV0dXJuIGF0dHJzO1xufVxuXG5mdW5jdGlvbiBjcmVhdGVUd2VlbiggdmFsdWUsIHByb3AsIGFuaW1hdGlvbiApIHtcblx0dmFyIHR3ZWVuLFxuXHRcdGNvbGxlY3Rpb24gPSAoIHR3ZWVuZXJzWyBwcm9wIF0gfHwgW10gKS5jb25jYXQoIHR3ZWVuZXJzWyBcIipcIiBdICksXG5cdFx0aW5kZXggPSAwLFxuXHRcdGxlbmd0aCA9IGNvbGxlY3Rpb24ubGVuZ3RoO1xuXHRmb3IgKCA7IGluZGV4IDwgbGVuZ3RoOyBpbmRleCsrICkge1xuXHRcdGlmICggKHR3ZWVuID0gY29sbGVjdGlvblsgaW5kZXggXS5jYWxsKCBhbmltYXRpb24sIHByb3AsIHZhbHVlICkpICkge1xuXG5cdFx0XHQvLyBXZSdyZSBkb25lIHdpdGggdGhpcyBwcm9wZXJ0eVxuXHRcdFx0cmV0dXJuIHR3ZWVuO1xuXHRcdH1cblx0fVxufVxuXG5mdW5jdGlvbiBkZWZhdWx0UHJlZmlsdGVyKCBlbGVtLCBwcm9wcywgb3B0cyApIHtcblx0LyoganNoaW50IHZhbGlkdGhpczogdHJ1ZSAqL1xuXHR2YXIgcHJvcCwgdmFsdWUsIHRvZ2dsZSwgdHdlZW4sIGhvb2tzLCBvbGRmaXJlLCBkaXNwbGF5LCBjaGVja0Rpc3BsYXksXG5cdFx0YW5pbSA9IHRoaXMsXG5cdFx0b3JpZyA9IHt9LFxuXHRcdHN0eWxlID0gZWxlbS5zdHlsZSxcblx0XHRoaWRkZW4gPSBlbGVtLm5vZGVUeXBlICYmIGlzSGlkZGVuKCBlbGVtICksXG5cdFx0ZGF0YVNob3cgPSBkYXRhX3ByaXYuZ2V0KCBlbGVtLCBcImZ4c2hvd1wiICk7XG5cblx0Ly8gSGFuZGxlIHF1ZXVlOiBmYWxzZSBwcm9taXNlc1xuXHRpZiAoICFvcHRzLnF1ZXVlICkge1xuXHRcdGhvb2tzID0galF1ZXJ5Ll9xdWV1ZUhvb2tzKCBlbGVtLCBcImZ4XCIgKTtcblx0XHRpZiAoIGhvb2tzLnVucXVldWVkID09IG51bGwgKSB7XG5cdFx0XHRob29rcy51bnF1ZXVlZCA9IDA7XG5cdFx0XHRvbGRmaXJlID0gaG9va3MuZW1wdHkuZmlyZTtcblx0XHRcdGhvb2tzLmVtcHR5LmZpcmUgPSBmdW5jdGlvbigpIHtcblx0XHRcdFx0aWYgKCAhaG9va3MudW5xdWV1ZWQgKSB7XG5cdFx0XHRcdFx0b2xkZmlyZSgpO1xuXHRcdFx0XHR9XG5cdFx0XHR9O1xuXHRcdH1cblx0XHRob29rcy51bnF1ZXVlZCsrO1xuXG5cdFx0YW5pbS5hbHdheXMoZnVuY3Rpb24oKSB7XG5cdFx0XHQvLyBFbnN1cmUgdGhlIGNvbXBsZXRlIGhhbmRsZXIgaXMgY2FsbGVkIGJlZm9yZSB0aGlzIGNvbXBsZXRlc1xuXHRcdFx0YW5pbS5hbHdheXMoZnVuY3Rpb24oKSB7XG5cdFx0XHRcdGhvb2tzLnVucXVldWVkLS07XG5cdFx0XHRcdGlmICggIWpRdWVyeS5xdWV1ZSggZWxlbSwgXCJmeFwiICkubGVuZ3RoICkge1xuXHRcdFx0XHRcdGhvb2tzLmVtcHR5LmZpcmUoKTtcblx0XHRcdFx0fVxuXHRcdFx0fSk7XG5cdFx0fSk7XG5cdH1cblxuXHQvLyBIZWlnaHQvd2lkdGggb3ZlcmZsb3cgcGFzc1xuXHRpZiAoIGVsZW0ubm9kZVR5cGUgPT09IDEgJiYgKCBcImhlaWdodFwiIGluIHByb3BzIHx8IFwid2lkdGhcIiBpbiBwcm9wcyApICkge1xuXHRcdC8vIE1ha2Ugc3VyZSB0aGF0IG5vdGhpbmcgc25lYWtzIG91dFxuXHRcdC8vIFJlY29yZCBhbGwgMyBvdmVyZmxvdyBhdHRyaWJ1dGVzIGJlY2F1c2UgSUU5LTEwIGRvIG5vdFxuXHRcdC8vIGNoYW5nZSB0aGUgb3ZlcmZsb3cgYXR0cmlidXRlIHdoZW4gb3ZlcmZsb3dYIGFuZFxuXHRcdC8vIG92ZXJmbG93WSBhcmUgc2V0IHRvIHRoZSBzYW1lIHZhbHVlXG5cdFx0b3B0cy5vdmVyZmxvdyA9IFsgc3R5bGUub3ZlcmZsb3csIHN0eWxlLm92ZXJmbG93WCwgc3R5bGUub3ZlcmZsb3dZIF07XG5cblx0XHQvLyBTZXQgZGlzcGxheSBwcm9wZXJ0eSB0byBpbmxpbmUtYmxvY2sgZm9yIGhlaWdodC93aWR0aFxuXHRcdC8vIGFuaW1hdGlvbnMgb24gaW5saW5lIGVsZW1lbnRzIHRoYXQgYXJlIGhhdmluZyB3aWR0aC9oZWlnaHQgYW5pbWF0ZWRcblx0XHRkaXNwbGF5ID0galF1ZXJ5LmNzcyggZWxlbSwgXCJkaXNwbGF5XCIgKTtcblxuXHRcdC8vIFRlc3QgZGVmYXVsdCBkaXNwbGF5IGlmIGRpc3BsYXkgaXMgY3VycmVudGx5IFwibm9uZVwiXG5cdFx0Y2hlY2tEaXNwbGF5ID0gZGlzcGxheSA9PT0gXCJub25lXCIgP1xuXHRcdFx0ZGF0YV9wcml2LmdldCggZWxlbSwgXCJvbGRkaXNwbGF5XCIgKSB8fCBkZWZhdWx0RGlzcGxheSggZWxlbS5ub2RlTmFtZSApIDogZGlzcGxheTtcblxuXHRcdGlmICggY2hlY2tEaXNwbGF5ID09PSBcImlubGluZVwiICYmIGpRdWVyeS5jc3MoIGVsZW0sIFwiZmxvYXRcIiApID09PSBcIm5vbmVcIiApIHtcblx0XHRcdHN0eWxlLmRpc3BsYXkgPSBcImlubGluZS1ibG9ja1wiO1xuXHRcdH1cblx0fVxuXG5cdGlmICggb3B0cy5vdmVyZmxvdyApIHtcblx0XHRzdHlsZS5vdmVyZmxvdyA9IFwiaGlkZGVuXCI7XG5cdFx0YW5pbS5hbHdheXMoZnVuY3Rpb24oKSB7XG5cdFx0XHRzdHlsZS5vdmVyZmxvdyA9IG9wdHMub3ZlcmZsb3dbIDAgXTtcblx0XHRcdHN0eWxlLm92ZXJmbG93WCA9IG9wdHMub3ZlcmZsb3dbIDEgXTtcblx0XHRcdHN0eWxlLm92ZXJmbG93WSA9IG9wdHMub3ZlcmZsb3dbIDIgXTtcblx0XHR9KTtcblx0fVxuXG5cdC8vIHNob3cvaGlkZSBwYXNzXG5cdGZvciAoIHByb3AgaW4gcHJvcHMgKSB7XG5cdFx0dmFsdWUgPSBwcm9wc1sgcHJvcCBdO1xuXHRcdGlmICggcmZ4dHlwZXMuZXhlYyggdmFsdWUgKSApIHtcblx0XHRcdGRlbGV0ZSBwcm9wc1sgcHJvcCBdO1xuXHRcdFx0dG9nZ2xlID0gdG9nZ2xlIHx8IHZhbHVlID09PSBcInRvZ2dsZVwiO1xuXHRcdFx0aWYgKCB2YWx1ZSA9PT0gKCBoaWRkZW4gPyBcImhpZGVcIiA6IFwic2hvd1wiICkgKSB7XG5cblx0XHRcdFx0Ly8gSWYgdGhlcmUgaXMgZGF0YVNob3cgbGVmdCBvdmVyIGZyb20gYSBzdG9wcGVkIGhpZGUgb3Igc2hvdyBhbmQgd2UgYXJlIGdvaW5nIHRvIHByb2NlZWQgd2l0aCBzaG93LCB3ZSBzaG91bGQgcHJldGVuZCB0byBiZSBoaWRkZW5cblx0XHRcdFx0aWYgKCB2YWx1ZSA9PT0gXCJzaG93XCIgJiYgZGF0YVNob3cgJiYgZGF0YVNob3dbIHByb3AgXSAhPT0gdW5kZWZpbmVkICkge1xuXHRcdFx0XHRcdGhpZGRlbiA9IHRydWU7XG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0Y29udGludWU7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHRcdG9yaWdbIHByb3AgXSA9IGRhdGFTaG93ICYmIGRhdGFTaG93WyBwcm9wIF0gfHwgalF1ZXJ5LnN0eWxlKCBlbGVtLCBwcm9wICk7XG5cblx0XHQvLyBBbnkgbm9uLWZ4IHZhbHVlIHN0b3BzIHVzIGZyb20gcmVzdG9yaW5nIHRoZSBvcmlnaW5hbCBkaXNwbGF5IHZhbHVlXG5cdFx0fSBlbHNlIHtcblx0XHRcdGRpc3BsYXkgPSB1bmRlZmluZWQ7XG5cdFx0fVxuXHR9XG5cblx0aWYgKCAhalF1ZXJ5LmlzRW1wdHlPYmplY3QoIG9yaWcgKSApIHtcblx0XHRpZiAoIGRhdGFTaG93ICkge1xuXHRcdFx0aWYgKCBcImhpZGRlblwiIGluIGRhdGFTaG93ICkge1xuXHRcdFx0XHRoaWRkZW4gPSBkYXRhU2hvdy5oaWRkZW47XG5cdFx0XHR9XG5cdFx0fSBlbHNlIHtcblx0XHRcdGRhdGFTaG93ID0gZGF0YV9wcml2LmFjY2VzcyggZWxlbSwgXCJmeHNob3dcIiwge30gKTtcblx0XHR9XG5cblx0XHQvLyBTdG9yZSBzdGF0ZSBpZiBpdHMgdG9nZ2xlIC0gZW5hYmxlcyAuc3RvcCgpLnRvZ2dsZSgpIHRvIFwicmV2ZXJzZVwiXG5cdFx0aWYgKCB0b2dnbGUgKSB7XG5cdFx0XHRkYXRhU2hvdy5oaWRkZW4gPSAhaGlkZGVuO1xuXHRcdH1cblx0XHRpZiAoIGhpZGRlbiApIHtcblx0XHRcdGpRdWVyeSggZWxlbSApLnNob3coKTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0YW5pbS5kb25lKGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRqUXVlcnkoIGVsZW0gKS5oaWRlKCk7XG5cdFx0XHR9KTtcblx0XHR9XG5cdFx0YW5pbS5kb25lKGZ1bmN0aW9uKCkge1xuXHRcdFx0dmFyIHByb3A7XG5cblx0XHRcdGRhdGFfcHJpdi5yZW1vdmUoIGVsZW0sIFwiZnhzaG93XCIgKTtcblx0XHRcdGZvciAoIHByb3AgaW4gb3JpZyApIHtcblx0XHRcdFx0alF1ZXJ5LnN0eWxlKCBlbGVtLCBwcm9wLCBvcmlnWyBwcm9wIF0gKTtcblx0XHRcdH1cblx0XHR9KTtcblx0XHRmb3IgKCBwcm9wIGluIG9yaWcgKSB7XG5cdFx0XHR0d2VlbiA9IGNyZWF0ZVR3ZWVuKCBoaWRkZW4gPyBkYXRhU2hvd1sgcHJvcCBdIDogMCwgcHJvcCwgYW5pbSApO1xuXG5cdFx0XHRpZiAoICEoIHByb3AgaW4gZGF0YVNob3cgKSApIHtcblx0XHRcdFx0ZGF0YVNob3dbIHByb3AgXSA9IHR3ZWVuLnN0YXJ0O1xuXHRcdFx0XHRpZiAoIGhpZGRlbiApIHtcblx0XHRcdFx0XHR0d2Vlbi5lbmQgPSB0d2Vlbi5zdGFydDtcblx0XHRcdFx0XHR0d2Vlbi5zdGFydCA9IHByb3AgPT09IFwid2lkdGhcIiB8fCBwcm9wID09PSBcImhlaWdodFwiID8gMSA6IDA7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9XG5cblx0Ly8gSWYgdGhpcyBpcyBhIG5vb3AgbGlrZSAuaGlkZSgpLmhpZGUoKSwgcmVzdG9yZSBhbiBvdmVyd3JpdHRlbiBkaXNwbGF5IHZhbHVlXG5cdH0gZWxzZSBpZiAoIChkaXNwbGF5ID09PSBcIm5vbmVcIiA/IGRlZmF1bHREaXNwbGF5KCBlbGVtLm5vZGVOYW1lICkgOiBkaXNwbGF5KSA9PT0gXCJpbmxpbmVcIiApIHtcblx0XHRzdHlsZS5kaXNwbGF5ID0gZGlzcGxheTtcblx0fVxufVxuXG5mdW5jdGlvbiBwcm9wRmlsdGVyKCBwcm9wcywgc3BlY2lhbEVhc2luZyApIHtcblx0dmFyIGluZGV4LCBuYW1lLCBlYXNpbmcsIHZhbHVlLCBob29rcztcblxuXHQvLyBjYW1lbENhc2UsIHNwZWNpYWxFYXNpbmcgYW5kIGV4cGFuZCBjc3NIb29rIHBhc3Ncblx0Zm9yICggaW5kZXggaW4gcHJvcHMgKSB7XG5cdFx0bmFtZSA9IGpRdWVyeS5jYW1lbENhc2UoIGluZGV4ICk7XG5cdFx0ZWFzaW5nID0gc3BlY2lhbEVhc2luZ1sgbmFtZSBdO1xuXHRcdHZhbHVlID0gcHJvcHNbIGluZGV4IF07XG5cdFx0aWYgKCBqUXVlcnkuaXNBcnJheSggdmFsdWUgKSApIHtcblx0XHRcdGVhc2luZyA9IHZhbHVlWyAxIF07XG5cdFx0XHR2YWx1ZSA9IHByb3BzWyBpbmRleCBdID0gdmFsdWVbIDAgXTtcblx0XHR9XG5cblx0XHRpZiAoIGluZGV4ICE9PSBuYW1lICkge1xuXHRcdFx0cHJvcHNbIG5hbWUgXSA9IHZhbHVlO1xuXHRcdFx0ZGVsZXRlIHByb3BzWyBpbmRleCBdO1xuXHRcdH1cblxuXHRcdGhvb2tzID0galF1ZXJ5LmNzc0hvb2tzWyBuYW1lIF07XG5cdFx0aWYgKCBob29rcyAmJiBcImV4cGFuZFwiIGluIGhvb2tzICkge1xuXHRcdFx0dmFsdWUgPSBob29rcy5leHBhbmQoIHZhbHVlICk7XG5cdFx0XHRkZWxldGUgcHJvcHNbIG5hbWUgXTtcblxuXHRcdFx0Ly8gTm90IHF1aXRlICQuZXh0ZW5kLCB0aGlzIHdvbid0IG92ZXJ3cml0ZSBleGlzdGluZyBrZXlzLlxuXHRcdFx0Ly8gUmV1c2luZyAnaW5kZXgnIGJlY2F1c2Ugd2UgaGF2ZSB0aGUgY29ycmVjdCBcIm5hbWVcIlxuXHRcdFx0Zm9yICggaW5kZXggaW4gdmFsdWUgKSB7XG5cdFx0XHRcdGlmICggISggaW5kZXggaW4gcHJvcHMgKSApIHtcblx0XHRcdFx0XHRwcm9wc1sgaW5kZXggXSA9IHZhbHVlWyBpbmRleCBdO1xuXHRcdFx0XHRcdHNwZWNpYWxFYXNpbmdbIGluZGV4IF0gPSBlYXNpbmc7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9IGVsc2Uge1xuXHRcdFx0c3BlY2lhbEVhc2luZ1sgbmFtZSBdID0gZWFzaW5nO1xuXHRcdH1cblx0fVxufVxuXG5mdW5jdGlvbiBBbmltYXRpb24oIGVsZW0sIHByb3BlcnRpZXMsIG9wdGlvbnMgKSB7XG5cdHZhciByZXN1bHQsXG5cdFx0c3RvcHBlZCxcblx0XHRpbmRleCA9IDAsXG5cdFx0bGVuZ3RoID0gYW5pbWF0aW9uUHJlZmlsdGVycy5sZW5ndGgsXG5cdFx0ZGVmZXJyZWQgPSBqUXVlcnkuRGVmZXJyZWQoKS5hbHdheXMoIGZ1bmN0aW9uKCkge1xuXHRcdFx0Ly8gRG9uJ3QgbWF0Y2ggZWxlbSBpbiB0aGUgOmFuaW1hdGVkIHNlbGVjdG9yXG5cdFx0XHRkZWxldGUgdGljay5lbGVtO1xuXHRcdH0pLFxuXHRcdHRpY2sgPSBmdW5jdGlvbigpIHtcblx0XHRcdGlmICggc3RvcHBlZCApIHtcblx0XHRcdFx0cmV0dXJuIGZhbHNlO1xuXHRcdFx0fVxuXHRcdFx0dmFyIGN1cnJlbnRUaW1lID0gZnhOb3cgfHwgY3JlYXRlRnhOb3coKSxcblx0XHRcdFx0cmVtYWluaW5nID0gTWF0aC5tYXgoIDAsIGFuaW1hdGlvbi5zdGFydFRpbWUgKyBhbmltYXRpb24uZHVyYXRpb24gLSBjdXJyZW50VGltZSApLFxuXHRcdFx0XHQvLyBTdXBwb3J0OiBBbmRyb2lkIDIuM1xuXHRcdFx0XHQvLyBBcmNoYWljIGNyYXNoIGJ1ZyB3b24ndCBhbGxvdyB1cyB0byB1c2UgYDEgLSAoIDAuNSB8fCAwIClgICgjMTI0OTcpXG5cdFx0XHRcdHRlbXAgPSByZW1haW5pbmcgLyBhbmltYXRpb24uZHVyYXRpb24gfHwgMCxcblx0XHRcdFx0cGVyY2VudCA9IDEgLSB0ZW1wLFxuXHRcdFx0XHRpbmRleCA9IDAsXG5cdFx0XHRcdGxlbmd0aCA9IGFuaW1hdGlvbi50d2VlbnMubGVuZ3RoO1xuXG5cdFx0XHRmb3IgKCA7IGluZGV4IDwgbGVuZ3RoIDsgaW5kZXgrKyApIHtcblx0XHRcdFx0YW5pbWF0aW9uLnR3ZWVuc1sgaW5kZXggXS5ydW4oIHBlcmNlbnQgKTtcblx0XHRcdH1cblxuXHRcdFx0ZGVmZXJyZWQubm90aWZ5V2l0aCggZWxlbSwgWyBhbmltYXRpb24sIHBlcmNlbnQsIHJlbWFpbmluZyBdKTtcblxuXHRcdFx0aWYgKCBwZXJjZW50IDwgMSAmJiBsZW5ndGggKSB7XG5cdFx0XHRcdHJldHVybiByZW1haW5pbmc7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRkZWZlcnJlZC5yZXNvbHZlV2l0aCggZWxlbSwgWyBhbmltYXRpb24gXSApO1xuXHRcdFx0XHRyZXR1cm4gZmFsc2U7XG5cdFx0XHR9XG5cdFx0fSxcblx0XHRhbmltYXRpb24gPSBkZWZlcnJlZC5wcm9taXNlKHtcblx0XHRcdGVsZW06IGVsZW0sXG5cdFx0XHRwcm9wczogalF1ZXJ5LmV4dGVuZCgge30sIHByb3BlcnRpZXMgKSxcblx0XHRcdG9wdHM6IGpRdWVyeS5leHRlbmQoIHRydWUsIHsgc3BlY2lhbEVhc2luZzoge30gfSwgb3B0aW9ucyApLFxuXHRcdFx0b3JpZ2luYWxQcm9wZXJ0aWVzOiBwcm9wZXJ0aWVzLFxuXHRcdFx0b3JpZ2luYWxPcHRpb25zOiBvcHRpb25zLFxuXHRcdFx0c3RhcnRUaW1lOiBmeE5vdyB8fCBjcmVhdGVGeE5vdygpLFxuXHRcdFx0ZHVyYXRpb246IG9wdGlvbnMuZHVyYXRpb24sXG5cdFx0XHR0d2VlbnM6IFtdLFxuXHRcdFx0Y3JlYXRlVHdlZW46IGZ1bmN0aW9uKCBwcm9wLCBlbmQgKSB7XG5cdFx0XHRcdHZhciB0d2VlbiA9IGpRdWVyeS5Ud2VlbiggZWxlbSwgYW5pbWF0aW9uLm9wdHMsIHByb3AsIGVuZCxcblx0XHRcdFx0XHRcdGFuaW1hdGlvbi5vcHRzLnNwZWNpYWxFYXNpbmdbIHByb3AgXSB8fCBhbmltYXRpb24ub3B0cy5lYXNpbmcgKTtcblx0XHRcdFx0YW5pbWF0aW9uLnR3ZWVucy5wdXNoKCB0d2VlbiApO1xuXHRcdFx0XHRyZXR1cm4gdHdlZW47XG5cdFx0XHR9LFxuXHRcdFx0c3RvcDogZnVuY3Rpb24oIGdvdG9FbmQgKSB7XG5cdFx0XHRcdHZhciBpbmRleCA9IDAsXG5cdFx0XHRcdFx0Ly8gSWYgd2UgYXJlIGdvaW5nIHRvIHRoZSBlbmQsIHdlIHdhbnQgdG8gcnVuIGFsbCB0aGUgdHdlZW5zXG5cdFx0XHRcdFx0Ly8gb3RoZXJ3aXNlIHdlIHNraXAgdGhpcyBwYXJ0XG5cdFx0XHRcdFx0bGVuZ3RoID0gZ290b0VuZCA/IGFuaW1hdGlvbi50d2VlbnMubGVuZ3RoIDogMDtcblx0XHRcdFx0aWYgKCBzdG9wcGVkICkge1xuXHRcdFx0XHRcdHJldHVybiB0aGlzO1xuXHRcdFx0XHR9XG5cdFx0XHRcdHN0b3BwZWQgPSB0cnVlO1xuXHRcdFx0XHRmb3IgKCA7IGluZGV4IDwgbGVuZ3RoIDsgaW5kZXgrKyApIHtcblx0XHRcdFx0XHRhbmltYXRpb24udHdlZW5zWyBpbmRleCBdLnJ1biggMSApO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0Ly8gUmVzb2x2ZSB3aGVuIHdlIHBsYXllZCB0aGUgbGFzdCBmcmFtZTsgb3RoZXJ3aXNlLCByZWplY3Rcblx0XHRcdFx0aWYgKCBnb3RvRW5kICkge1xuXHRcdFx0XHRcdGRlZmVycmVkLnJlc29sdmVXaXRoKCBlbGVtLCBbIGFuaW1hdGlvbiwgZ290b0VuZCBdICk7XG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0ZGVmZXJyZWQucmVqZWN0V2l0aCggZWxlbSwgWyBhbmltYXRpb24sIGdvdG9FbmQgXSApO1xuXHRcdFx0XHR9XG5cdFx0XHRcdHJldHVybiB0aGlzO1xuXHRcdFx0fVxuXHRcdH0pLFxuXHRcdHByb3BzID0gYW5pbWF0aW9uLnByb3BzO1xuXG5cdHByb3BGaWx0ZXIoIHByb3BzLCBhbmltYXRpb24ub3B0cy5zcGVjaWFsRWFzaW5nICk7XG5cblx0Zm9yICggOyBpbmRleCA8IGxlbmd0aCA7IGluZGV4KysgKSB7XG5cdFx0cmVzdWx0ID0gYW5pbWF0aW9uUHJlZmlsdGVyc1sgaW5kZXggXS5jYWxsKCBhbmltYXRpb24sIGVsZW0sIHByb3BzLCBhbmltYXRpb24ub3B0cyApO1xuXHRcdGlmICggcmVzdWx0ICkge1xuXHRcdFx0cmV0dXJuIHJlc3VsdDtcblx0XHR9XG5cdH1cblxuXHRqUXVlcnkubWFwKCBwcm9wcywgY3JlYXRlVHdlZW4sIGFuaW1hdGlvbiApO1xuXG5cdGlmICggalF1ZXJ5LmlzRnVuY3Rpb24oIGFuaW1hdGlvbi5vcHRzLnN0YXJ0ICkgKSB7XG5cdFx0YW5pbWF0aW9uLm9wdHMuc3RhcnQuY2FsbCggZWxlbSwgYW5pbWF0aW9uICk7XG5cdH1cblxuXHRqUXVlcnkuZngudGltZXIoXG5cdFx0alF1ZXJ5LmV4dGVuZCggdGljaywge1xuXHRcdFx0ZWxlbTogZWxlbSxcblx0XHRcdGFuaW06IGFuaW1hdGlvbixcblx0XHRcdHF1ZXVlOiBhbmltYXRpb24ub3B0cy5xdWV1ZVxuXHRcdH0pXG5cdCk7XG5cblx0Ly8gYXR0YWNoIGNhbGxiYWNrcyBmcm9tIG9wdGlvbnNcblx0cmV0dXJuIGFuaW1hdGlvbi5wcm9ncmVzcyggYW5pbWF0aW9uLm9wdHMucHJvZ3Jlc3MgKVxuXHRcdC5kb25lKCBhbmltYXRpb24ub3B0cy5kb25lLCBhbmltYXRpb24ub3B0cy5jb21wbGV0ZSApXG5cdFx0LmZhaWwoIGFuaW1hdGlvbi5vcHRzLmZhaWwgKVxuXHRcdC5hbHdheXMoIGFuaW1hdGlvbi5vcHRzLmFsd2F5cyApO1xufVxuXG5qUXVlcnkuQW5pbWF0aW9uID0galF1ZXJ5LmV4dGVuZCggQW5pbWF0aW9uLCB7XG5cblx0dHdlZW5lcjogZnVuY3Rpb24oIHByb3BzLCBjYWxsYmFjayApIHtcblx0XHRpZiAoIGpRdWVyeS5pc0Z1bmN0aW9uKCBwcm9wcyApICkge1xuXHRcdFx0Y2FsbGJhY2sgPSBwcm9wcztcblx0XHRcdHByb3BzID0gWyBcIipcIiBdO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRwcm9wcyA9IHByb3BzLnNwbGl0KFwiIFwiKTtcblx0XHR9XG5cblx0XHR2YXIgcHJvcCxcblx0XHRcdGluZGV4ID0gMCxcblx0XHRcdGxlbmd0aCA9IHByb3BzLmxlbmd0aDtcblxuXHRcdGZvciAoIDsgaW5kZXggPCBsZW5ndGggOyBpbmRleCsrICkge1xuXHRcdFx0cHJvcCA9IHByb3BzWyBpbmRleCBdO1xuXHRcdFx0dHdlZW5lcnNbIHByb3AgXSA9IHR3ZWVuZXJzWyBwcm9wIF0gfHwgW107XG5cdFx0XHR0d2VlbmVyc1sgcHJvcCBdLnVuc2hpZnQoIGNhbGxiYWNrICk7XG5cdFx0fVxuXHR9LFxuXG5cdHByZWZpbHRlcjogZnVuY3Rpb24oIGNhbGxiYWNrLCBwcmVwZW5kICkge1xuXHRcdGlmICggcHJlcGVuZCApIHtcblx0XHRcdGFuaW1hdGlvblByZWZpbHRlcnMudW5zaGlmdCggY2FsbGJhY2sgKTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0YW5pbWF0aW9uUHJlZmlsdGVycy5wdXNoKCBjYWxsYmFjayApO1xuXHRcdH1cblx0fVxufSk7XG5cbmpRdWVyeS5zcGVlZCA9IGZ1bmN0aW9uKCBzcGVlZCwgZWFzaW5nLCBmbiApIHtcblx0dmFyIG9wdCA9IHNwZWVkICYmIHR5cGVvZiBzcGVlZCA9PT0gXCJvYmplY3RcIiA/IGpRdWVyeS5leHRlbmQoIHt9LCBzcGVlZCApIDoge1xuXHRcdGNvbXBsZXRlOiBmbiB8fCAhZm4gJiYgZWFzaW5nIHx8XG5cdFx0XHRqUXVlcnkuaXNGdW5jdGlvbiggc3BlZWQgKSAmJiBzcGVlZCxcblx0XHRkdXJhdGlvbjogc3BlZWQsXG5cdFx0ZWFzaW5nOiBmbiAmJiBlYXNpbmcgfHwgZWFzaW5nICYmICFqUXVlcnkuaXNGdW5jdGlvbiggZWFzaW5nICkgJiYgZWFzaW5nXG5cdH07XG5cblx0b3B0LmR1cmF0aW9uID0galF1ZXJ5LmZ4Lm9mZiA/IDAgOiB0eXBlb2Ygb3B0LmR1cmF0aW9uID09PSBcIm51bWJlclwiID8gb3B0LmR1cmF0aW9uIDpcblx0XHRvcHQuZHVyYXRpb24gaW4galF1ZXJ5LmZ4LnNwZWVkcyA/IGpRdWVyeS5meC5zcGVlZHNbIG9wdC5kdXJhdGlvbiBdIDogalF1ZXJ5LmZ4LnNwZWVkcy5fZGVmYXVsdDtcblxuXHQvLyBOb3JtYWxpemUgb3B0LnF1ZXVlIC0gdHJ1ZS91bmRlZmluZWQvbnVsbCAtPiBcImZ4XCJcblx0aWYgKCBvcHQucXVldWUgPT0gbnVsbCB8fCBvcHQucXVldWUgPT09IHRydWUgKSB7XG5cdFx0b3B0LnF1ZXVlID0gXCJmeFwiO1xuXHR9XG5cblx0Ly8gUXVldWVpbmdcblx0b3B0Lm9sZCA9IG9wdC5jb21wbGV0ZTtcblxuXHRvcHQuY29tcGxldGUgPSBmdW5jdGlvbigpIHtcblx0XHRpZiAoIGpRdWVyeS5pc0Z1bmN0aW9uKCBvcHQub2xkICkgKSB7XG5cdFx0XHRvcHQub2xkLmNhbGwoIHRoaXMgKTtcblx0XHR9XG5cblx0XHRpZiAoIG9wdC5xdWV1ZSApIHtcblx0XHRcdGpRdWVyeS5kZXF1ZXVlKCB0aGlzLCBvcHQucXVldWUgKTtcblx0XHR9XG5cdH07XG5cblx0cmV0dXJuIG9wdDtcbn07XG5cbmpRdWVyeS5mbi5leHRlbmQoe1xuXHRmYWRlVG86IGZ1bmN0aW9uKCBzcGVlZCwgdG8sIGVhc2luZywgY2FsbGJhY2sgKSB7XG5cblx0XHQvLyBTaG93IGFueSBoaWRkZW4gZWxlbWVudHMgYWZ0ZXIgc2V0dGluZyBvcGFjaXR5IHRvIDBcblx0XHRyZXR1cm4gdGhpcy5maWx0ZXIoIGlzSGlkZGVuICkuY3NzKCBcIm9wYWNpdHlcIiwgMCApLnNob3coKVxuXG5cdFx0XHQvLyBBbmltYXRlIHRvIHRoZSB2YWx1ZSBzcGVjaWZpZWRcblx0XHRcdC5lbmQoKS5hbmltYXRlKHsgb3BhY2l0eTogdG8gfSwgc3BlZWQsIGVhc2luZywgY2FsbGJhY2sgKTtcblx0fSxcblx0YW5pbWF0ZTogZnVuY3Rpb24oIHByb3AsIHNwZWVkLCBlYXNpbmcsIGNhbGxiYWNrICkge1xuXHRcdHZhciBlbXB0eSA9IGpRdWVyeS5pc0VtcHR5T2JqZWN0KCBwcm9wICksXG5cdFx0XHRvcHRhbGwgPSBqUXVlcnkuc3BlZWQoIHNwZWVkLCBlYXNpbmcsIGNhbGxiYWNrICksXG5cdFx0XHRkb0FuaW1hdGlvbiA9IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHQvLyBPcGVyYXRlIG9uIGEgY29weSBvZiBwcm9wIHNvIHBlci1wcm9wZXJ0eSBlYXNpbmcgd29uJ3QgYmUgbG9zdFxuXHRcdFx0XHR2YXIgYW5pbSA9IEFuaW1hdGlvbiggdGhpcywgalF1ZXJ5LmV4dGVuZCgge30sIHByb3AgKSwgb3B0YWxsICk7XG5cblx0XHRcdFx0Ly8gRW1wdHkgYW5pbWF0aW9ucywgb3IgZmluaXNoaW5nIHJlc29sdmVzIGltbWVkaWF0ZWx5XG5cdFx0XHRcdGlmICggZW1wdHkgfHwgZGF0YV9wcml2LmdldCggdGhpcywgXCJmaW5pc2hcIiApICkge1xuXHRcdFx0XHRcdGFuaW0uc3RvcCggdHJ1ZSApO1xuXHRcdFx0XHR9XG5cdFx0XHR9O1xuXHRcdFx0ZG9BbmltYXRpb24uZmluaXNoID0gZG9BbmltYXRpb247XG5cblx0XHRyZXR1cm4gZW1wdHkgfHwgb3B0YWxsLnF1ZXVlID09PSBmYWxzZSA/XG5cdFx0XHR0aGlzLmVhY2goIGRvQW5pbWF0aW9uICkgOlxuXHRcdFx0dGhpcy5xdWV1ZSggb3B0YWxsLnF1ZXVlLCBkb0FuaW1hdGlvbiApO1xuXHR9LFxuXHRzdG9wOiBmdW5jdGlvbiggdHlwZSwgY2xlYXJRdWV1ZSwgZ290b0VuZCApIHtcblx0XHR2YXIgc3RvcFF1ZXVlID0gZnVuY3Rpb24oIGhvb2tzICkge1xuXHRcdFx0dmFyIHN0b3AgPSBob29rcy5zdG9wO1xuXHRcdFx0ZGVsZXRlIGhvb2tzLnN0b3A7XG5cdFx0XHRzdG9wKCBnb3RvRW5kICk7XG5cdFx0fTtcblxuXHRcdGlmICggdHlwZW9mIHR5cGUgIT09IFwic3RyaW5nXCIgKSB7XG5cdFx0XHRnb3RvRW5kID0gY2xlYXJRdWV1ZTtcblx0XHRcdGNsZWFyUXVldWUgPSB0eXBlO1xuXHRcdFx0dHlwZSA9IHVuZGVmaW5lZDtcblx0XHR9XG5cdFx0aWYgKCBjbGVhclF1ZXVlICYmIHR5cGUgIT09IGZhbHNlICkge1xuXHRcdFx0dGhpcy5xdWV1ZSggdHlwZSB8fCBcImZ4XCIsIFtdICk7XG5cdFx0fVxuXG5cdFx0cmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbigpIHtcblx0XHRcdHZhciBkZXF1ZXVlID0gdHJ1ZSxcblx0XHRcdFx0aW5kZXggPSB0eXBlICE9IG51bGwgJiYgdHlwZSArIFwicXVldWVIb29rc1wiLFxuXHRcdFx0XHR0aW1lcnMgPSBqUXVlcnkudGltZXJzLFxuXHRcdFx0XHRkYXRhID0gZGF0YV9wcml2LmdldCggdGhpcyApO1xuXG5cdFx0XHRpZiAoIGluZGV4ICkge1xuXHRcdFx0XHRpZiAoIGRhdGFbIGluZGV4IF0gJiYgZGF0YVsgaW5kZXggXS5zdG9wICkge1xuXHRcdFx0XHRcdHN0b3BRdWV1ZSggZGF0YVsgaW5kZXggXSApO1xuXHRcdFx0XHR9XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRmb3IgKCBpbmRleCBpbiBkYXRhICkge1xuXHRcdFx0XHRcdGlmICggZGF0YVsgaW5kZXggXSAmJiBkYXRhWyBpbmRleCBdLnN0b3AgJiYgcnJ1bi50ZXN0KCBpbmRleCApICkge1xuXHRcdFx0XHRcdFx0c3RvcFF1ZXVlKCBkYXRhWyBpbmRleCBdICk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cdFx0XHR9XG5cblx0XHRcdGZvciAoIGluZGV4ID0gdGltZXJzLmxlbmd0aDsgaW5kZXgtLTsgKSB7XG5cdFx0XHRcdGlmICggdGltZXJzWyBpbmRleCBdLmVsZW0gPT09IHRoaXMgJiYgKHR5cGUgPT0gbnVsbCB8fCB0aW1lcnNbIGluZGV4IF0ucXVldWUgPT09IHR5cGUpICkge1xuXHRcdFx0XHRcdHRpbWVyc1sgaW5kZXggXS5hbmltLnN0b3AoIGdvdG9FbmQgKTtcblx0XHRcdFx0XHRkZXF1ZXVlID0gZmFsc2U7XG5cdFx0XHRcdFx0dGltZXJzLnNwbGljZSggaW5kZXgsIDEgKTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXG5cdFx0XHQvLyBTdGFydCB0aGUgbmV4dCBpbiB0aGUgcXVldWUgaWYgdGhlIGxhc3Qgc3RlcCB3YXNuJ3QgZm9yY2VkLlxuXHRcdFx0Ly8gVGltZXJzIGN1cnJlbnRseSB3aWxsIGNhbGwgdGhlaXIgY29tcGxldGUgY2FsbGJhY2tzLCB3aGljaFxuXHRcdFx0Ly8gd2lsbCBkZXF1ZXVlIGJ1dCBvbmx5IGlmIHRoZXkgd2VyZSBnb3RvRW5kLlxuXHRcdFx0aWYgKCBkZXF1ZXVlIHx8ICFnb3RvRW5kICkge1xuXHRcdFx0XHRqUXVlcnkuZGVxdWV1ZSggdGhpcywgdHlwZSApO1xuXHRcdFx0fVxuXHRcdH0pO1xuXHR9LFxuXHRmaW5pc2g6IGZ1bmN0aW9uKCB0eXBlICkge1xuXHRcdGlmICggdHlwZSAhPT0gZmFsc2UgKSB7XG5cdFx0XHR0eXBlID0gdHlwZSB8fCBcImZ4XCI7XG5cdFx0fVxuXHRcdHJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oKSB7XG5cdFx0XHR2YXIgaW5kZXgsXG5cdFx0XHRcdGRhdGEgPSBkYXRhX3ByaXYuZ2V0KCB0aGlzICksXG5cdFx0XHRcdHF1ZXVlID0gZGF0YVsgdHlwZSArIFwicXVldWVcIiBdLFxuXHRcdFx0XHRob29rcyA9IGRhdGFbIHR5cGUgKyBcInF1ZXVlSG9va3NcIiBdLFxuXHRcdFx0XHR0aW1lcnMgPSBqUXVlcnkudGltZXJzLFxuXHRcdFx0XHRsZW5ndGggPSBxdWV1ZSA/IHF1ZXVlLmxlbmd0aCA6IDA7XG5cblx0XHRcdC8vIEVuYWJsZSBmaW5pc2hpbmcgZmxhZyBvbiBwcml2YXRlIGRhdGFcblx0XHRcdGRhdGEuZmluaXNoID0gdHJ1ZTtcblxuXHRcdFx0Ly8gRW1wdHkgdGhlIHF1ZXVlIGZpcnN0XG5cdFx0XHRqUXVlcnkucXVldWUoIHRoaXMsIHR5cGUsIFtdICk7XG5cblx0XHRcdGlmICggaG9va3MgJiYgaG9va3Muc3RvcCApIHtcblx0XHRcdFx0aG9va3Muc3RvcC5jYWxsKCB0aGlzLCB0cnVlICk7XG5cdFx0XHR9XG5cblx0XHRcdC8vIExvb2sgZm9yIGFueSBhY3RpdmUgYW5pbWF0aW9ucywgYW5kIGZpbmlzaCB0aGVtXG5cdFx0XHRmb3IgKCBpbmRleCA9IHRpbWVycy5sZW5ndGg7IGluZGV4LS07ICkge1xuXHRcdFx0XHRpZiAoIHRpbWVyc1sgaW5kZXggXS5lbGVtID09PSB0aGlzICYmIHRpbWVyc1sgaW5kZXggXS5xdWV1ZSA9PT0gdHlwZSApIHtcblx0XHRcdFx0XHR0aW1lcnNbIGluZGV4IF0uYW5pbS5zdG9wKCB0cnVlICk7XG5cdFx0XHRcdFx0dGltZXJzLnNwbGljZSggaW5kZXgsIDEgKTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXG5cdFx0XHQvLyBMb29rIGZvciBhbnkgYW5pbWF0aW9ucyBpbiB0aGUgb2xkIHF1ZXVlIGFuZCBmaW5pc2ggdGhlbVxuXHRcdFx0Zm9yICggaW5kZXggPSAwOyBpbmRleCA8IGxlbmd0aDsgaW5kZXgrKyApIHtcblx0XHRcdFx0aWYgKCBxdWV1ZVsgaW5kZXggXSAmJiBxdWV1ZVsgaW5kZXggXS5maW5pc2ggKSB7XG5cdFx0XHRcdFx0cXVldWVbIGluZGV4IF0uZmluaXNoLmNhbGwoIHRoaXMgKTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXG5cdFx0XHQvLyBUdXJuIG9mZiBmaW5pc2hpbmcgZmxhZ1xuXHRcdFx0ZGVsZXRlIGRhdGEuZmluaXNoO1xuXHRcdH0pO1xuXHR9XG59KTtcblxualF1ZXJ5LmVhY2goWyBcInRvZ2dsZVwiLCBcInNob3dcIiwgXCJoaWRlXCIgXSwgZnVuY3Rpb24oIGksIG5hbWUgKSB7XG5cdHZhciBjc3NGbiA9IGpRdWVyeS5mblsgbmFtZSBdO1xuXHRqUXVlcnkuZm5bIG5hbWUgXSA9IGZ1bmN0aW9uKCBzcGVlZCwgZWFzaW5nLCBjYWxsYmFjayApIHtcblx0XHRyZXR1cm4gc3BlZWQgPT0gbnVsbCB8fCB0eXBlb2Ygc3BlZWQgPT09IFwiYm9vbGVhblwiID9cblx0XHRcdGNzc0ZuLmFwcGx5KCB0aGlzLCBhcmd1bWVudHMgKSA6XG5cdFx0XHR0aGlzLmFuaW1hdGUoIGdlbkZ4KCBuYW1lLCB0cnVlICksIHNwZWVkLCBlYXNpbmcsIGNhbGxiYWNrICk7XG5cdH07XG59KTtcblxuLy8gR2VuZXJhdGUgc2hvcnRjdXRzIGZvciBjdXN0b20gYW5pbWF0aW9uc1xualF1ZXJ5LmVhY2goe1xuXHRzbGlkZURvd246IGdlbkZ4KFwic2hvd1wiKSxcblx0c2xpZGVVcDogZ2VuRngoXCJoaWRlXCIpLFxuXHRzbGlkZVRvZ2dsZTogZ2VuRngoXCJ0b2dnbGVcIiksXG5cdGZhZGVJbjogeyBvcGFjaXR5OiBcInNob3dcIiB9LFxuXHRmYWRlT3V0OiB7IG9wYWNpdHk6IFwiaGlkZVwiIH0sXG5cdGZhZGVUb2dnbGU6IHsgb3BhY2l0eTogXCJ0b2dnbGVcIiB9XG59LCBmdW5jdGlvbiggbmFtZSwgcHJvcHMgKSB7XG5cdGpRdWVyeS5mblsgbmFtZSBdID0gZnVuY3Rpb24oIHNwZWVkLCBlYXNpbmcsIGNhbGxiYWNrICkge1xuXHRcdHJldHVybiB0aGlzLmFuaW1hdGUoIHByb3BzLCBzcGVlZCwgZWFzaW5nLCBjYWxsYmFjayApO1xuXHR9O1xufSk7XG5cbmpRdWVyeS50aW1lcnMgPSBbXTtcbmpRdWVyeS5meC50aWNrID0gZnVuY3Rpb24oKSB7XG5cdHZhciB0aW1lcixcblx0XHRpID0gMCxcblx0XHR0aW1lcnMgPSBqUXVlcnkudGltZXJzO1xuXG5cdGZ4Tm93ID0galF1ZXJ5Lm5vdygpO1xuXG5cdGZvciAoIDsgaSA8IHRpbWVycy5sZW5ndGg7IGkrKyApIHtcblx0XHR0aW1lciA9IHRpbWVyc1sgaSBdO1xuXHRcdC8vIENoZWNrcyB0aGUgdGltZXIgaGFzIG5vdCBhbHJlYWR5IGJlZW4gcmVtb3ZlZFxuXHRcdGlmICggIXRpbWVyKCkgJiYgdGltZXJzWyBpIF0gPT09IHRpbWVyICkge1xuXHRcdFx0dGltZXJzLnNwbGljZSggaS0tLCAxICk7XG5cdFx0fVxuXHR9XG5cblx0aWYgKCAhdGltZXJzLmxlbmd0aCApIHtcblx0XHRqUXVlcnkuZnguc3RvcCgpO1xuXHR9XG5cdGZ4Tm93ID0gdW5kZWZpbmVkO1xufTtcblxualF1ZXJ5LmZ4LnRpbWVyID0gZnVuY3Rpb24oIHRpbWVyICkge1xuXHRqUXVlcnkudGltZXJzLnB1c2goIHRpbWVyICk7XG5cdGlmICggdGltZXIoKSApIHtcblx0XHRqUXVlcnkuZnguc3RhcnQoKTtcblx0fSBlbHNlIHtcblx0XHRqUXVlcnkudGltZXJzLnBvcCgpO1xuXHR9XG59O1xuXG5qUXVlcnkuZnguaW50ZXJ2YWwgPSAxMztcblxualF1ZXJ5LmZ4LnN0YXJ0ID0gZnVuY3Rpb24oKSB7XG5cdGlmICggIXRpbWVySWQgKSB7XG5cdFx0dGltZXJJZCA9IHNldEludGVydmFsKCBqUXVlcnkuZngudGljaywgalF1ZXJ5LmZ4LmludGVydmFsICk7XG5cdH1cbn07XG5cbmpRdWVyeS5meC5zdG9wID0gZnVuY3Rpb24oKSB7XG5cdGNsZWFySW50ZXJ2YWwoIHRpbWVySWQgKTtcblx0dGltZXJJZCA9IG51bGw7XG59O1xuXG5qUXVlcnkuZnguc3BlZWRzID0ge1xuXHRzbG93OiA2MDAsXG5cdGZhc3Q6IDIwMCxcblx0Ly8gRGVmYXVsdCBzcGVlZFxuXHRfZGVmYXVsdDogNDAwXG59O1xuXG5cbi8vIEJhc2VkIG9mZiBvZiB0aGUgcGx1Z2luIGJ5IENsaW50IEhlbGZlcnMsIHdpdGggcGVybWlzc2lvbi5cbi8vIGh0dHA6Ly9ibGluZHNpZ25hbHMuY29tL2luZGV4LnBocC8yMDA5LzA3L2pxdWVyeS1kZWxheS9cbmpRdWVyeS5mbi5kZWxheSA9IGZ1bmN0aW9uKCB0aW1lLCB0eXBlICkge1xuXHR0aW1lID0galF1ZXJ5LmZ4ID8galF1ZXJ5LmZ4LnNwZWVkc1sgdGltZSBdIHx8IHRpbWUgOiB0aW1lO1xuXHR0eXBlID0gdHlwZSB8fCBcImZ4XCI7XG5cblx0cmV0dXJuIHRoaXMucXVldWUoIHR5cGUsIGZ1bmN0aW9uKCBuZXh0LCBob29rcyApIHtcblx0XHR2YXIgdGltZW91dCA9IHNldFRpbWVvdXQoIG5leHQsIHRpbWUgKTtcblx0XHRob29rcy5zdG9wID0gZnVuY3Rpb24oKSB7XG5cdFx0XHRjbGVhclRpbWVvdXQoIHRpbWVvdXQgKTtcblx0XHR9O1xuXHR9KTtcbn07XG5cblxuKGZ1bmN0aW9uKCkge1xuXHR2YXIgaW5wdXQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCBcImlucHV0XCIgKSxcblx0XHRzZWxlY3QgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCBcInNlbGVjdFwiICksXG5cdFx0b3B0ID0gc2VsZWN0LmFwcGVuZENoaWxkKCBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCBcIm9wdGlvblwiICkgKTtcblxuXHRpbnB1dC50eXBlID0gXCJjaGVja2JveFwiO1xuXG5cdC8vIFN1cHBvcnQ6IGlPUzw9NS4xLCBBbmRyb2lkPD00LjIrXG5cdC8vIERlZmF1bHQgdmFsdWUgZm9yIGEgY2hlY2tib3ggc2hvdWxkIGJlIFwib25cIlxuXHRzdXBwb3J0LmNoZWNrT24gPSBpbnB1dC52YWx1ZSAhPT0gXCJcIjtcblxuXHQvLyBTdXBwb3J0OiBJRTw9MTErXG5cdC8vIE11c3QgYWNjZXNzIHNlbGVjdGVkSW5kZXggdG8gbWFrZSBkZWZhdWx0IG9wdGlvbnMgc2VsZWN0XG5cdHN1cHBvcnQub3B0U2VsZWN0ZWQgPSBvcHQuc2VsZWN0ZWQ7XG5cblx0Ly8gU3VwcG9ydDogQW5kcm9pZDw9Mi4zXG5cdC8vIE9wdGlvbnMgaW5zaWRlIGRpc2FibGVkIHNlbGVjdHMgYXJlIGluY29ycmVjdGx5IG1hcmtlZCBhcyBkaXNhYmxlZFxuXHRzZWxlY3QuZGlzYWJsZWQgPSB0cnVlO1xuXHRzdXBwb3J0Lm9wdERpc2FibGVkID0gIW9wdC5kaXNhYmxlZDtcblxuXHQvLyBTdXBwb3J0OiBJRTw9MTErXG5cdC8vIEFuIGlucHV0IGxvc2VzIGl0cyB2YWx1ZSBhZnRlciBiZWNvbWluZyBhIHJhZGlvXG5cdGlucHV0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCggXCJpbnB1dFwiICk7XG5cdGlucHV0LnZhbHVlID0gXCJ0XCI7XG5cdGlucHV0LnR5cGUgPSBcInJhZGlvXCI7XG5cdHN1cHBvcnQucmFkaW9WYWx1ZSA9IGlucHV0LnZhbHVlID09PSBcInRcIjtcbn0pKCk7XG5cblxudmFyIG5vZGVIb29rLCBib29sSG9vayxcblx0YXR0ckhhbmRsZSA9IGpRdWVyeS5leHByLmF0dHJIYW5kbGU7XG5cbmpRdWVyeS5mbi5leHRlbmQoe1xuXHRhdHRyOiBmdW5jdGlvbiggbmFtZSwgdmFsdWUgKSB7XG5cdFx0cmV0dXJuIGFjY2VzcyggdGhpcywgalF1ZXJ5LmF0dHIsIG5hbWUsIHZhbHVlLCBhcmd1bWVudHMubGVuZ3RoID4gMSApO1xuXHR9LFxuXG5cdHJlbW92ZUF0dHI6IGZ1bmN0aW9uKCBuYW1lICkge1xuXHRcdHJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oKSB7XG5cdFx0XHRqUXVlcnkucmVtb3ZlQXR0ciggdGhpcywgbmFtZSApO1xuXHRcdH0pO1xuXHR9XG59KTtcblxualF1ZXJ5LmV4dGVuZCh7XG5cdGF0dHI6IGZ1bmN0aW9uKCBlbGVtLCBuYW1lLCB2YWx1ZSApIHtcblx0XHR2YXIgaG9va3MsIHJldCxcblx0XHRcdG5UeXBlID0gZWxlbS5ub2RlVHlwZTtcblxuXHRcdC8vIGRvbid0IGdldC9zZXQgYXR0cmlidXRlcyBvbiB0ZXh0LCBjb21tZW50IGFuZCBhdHRyaWJ1dGUgbm9kZXNcblx0XHRpZiAoICFlbGVtIHx8IG5UeXBlID09PSAzIHx8IG5UeXBlID09PSA4IHx8IG5UeXBlID09PSAyICkge1xuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblxuXHRcdC8vIEZhbGxiYWNrIHRvIHByb3Agd2hlbiBhdHRyaWJ1dGVzIGFyZSBub3Qgc3VwcG9ydGVkXG5cdFx0aWYgKCB0eXBlb2YgZWxlbS5nZXRBdHRyaWJ1dGUgPT09IHN0cnVuZGVmaW5lZCApIHtcblx0XHRcdHJldHVybiBqUXVlcnkucHJvcCggZWxlbSwgbmFtZSwgdmFsdWUgKTtcblx0XHR9XG5cblx0XHQvLyBBbGwgYXR0cmlidXRlcyBhcmUgbG93ZXJjYXNlXG5cdFx0Ly8gR3JhYiBuZWNlc3NhcnkgaG9vayBpZiBvbmUgaXMgZGVmaW5lZFxuXHRcdGlmICggblR5cGUgIT09IDEgfHwgIWpRdWVyeS5pc1hNTERvYyggZWxlbSApICkge1xuXHRcdFx0bmFtZSA9IG5hbWUudG9Mb3dlckNhc2UoKTtcblx0XHRcdGhvb2tzID0galF1ZXJ5LmF0dHJIb29rc1sgbmFtZSBdIHx8XG5cdFx0XHRcdCggalF1ZXJ5LmV4cHIubWF0Y2guYm9vbC50ZXN0KCBuYW1lICkgPyBib29sSG9vayA6IG5vZGVIb29rICk7XG5cdFx0fVxuXG5cdFx0aWYgKCB2YWx1ZSAhPT0gdW5kZWZpbmVkICkge1xuXG5cdFx0XHRpZiAoIHZhbHVlID09PSBudWxsICkge1xuXHRcdFx0XHRqUXVlcnkucmVtb3ZlQXR0ciggZWxlbSwgbmFtZSApO1xuXG5cdFx0XHR9IGVsc2UgaWYgKCBob29rcyAmJiBcInNldFwiIGluIGhvb2tzICYmIChyZXQgPSBob29rcy5zZXQoIGVsZW0sIHZhbHVlLCBuYW1lICkpICE9PSB1bmRlZmluZWQgKSB7XG5cdFx0XHRcdHJldHVybiByZXQ7XG5cblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdGVsZW0uc2V0QXR0cmlidXRlKCBuYW1lLCB2YWx1ZSArIFwiXCIgKTtcblx0XHRcdFx0cmV0dXJuIHZhbHVlO1xuXHRcdFx0fVxuXG5cdFx0fSBlbHNlIGlmICggaG9va3MgJiYgXCJnZXRcIiBpbiBob29rcyAmJiAocmV0ID0gaG9va3MuZ2V0KCBlbGVtLCBuYW1lICkpICE9PSBudWxsICkge1xuXHRcdFx0cmV0dXJuIHJldDtcblxuXHRcdH0gZWxzZSB7XG5cdFx0XHRyZXQgPSBqUXVlcnkuZmluZC5hdHRyKCBlbGVtLCBuYW1lICk7XG5cblx0XHRcdC8vIE5vbi1leGlzdGVudCBhdHRyaWJ1dGVzIHJldHVybiBudWxsLCB3ZSBub3JtYWxpemUgdG8gdW5kZWZpbmVkXG5cdFx0XHRyZXR1cm4gcmV0ID09IG51bGwgP1xuXHRcdFx0XHR1bmRlZmluZWQgOlxuXHRcdFx0XHRyZXQ7XG5cdFx0fVxuXHR9LFxuXG5cdHJlbW92ZUF0dHI6IGZ1bmN0aW9uKCBlbGVtLCB2YWx1ZSApIHtcblx0XHR2YXIgbmFtZSwgcHJvcE5hbWUsXG5cdFx0XHRpID0gMCxcblx0XHRcdGF0dHJOYW1lcyA9IHZhbHVlICYmIHZhbHVlLm1hdGNoKCBybm90d2hpdGUgKTtcblxuXHRcdGlmICggYXR0ck5hbWVzICYmIGVsZW0ubm9kZVR5cGUgPT09IDEgKSB7XG5cdFx0XHR3aGlsZSAoIChuYW1lID0gYXR0ck5hbWVzW2krK10pICkge1xuXHRcdFx0XHRwcm9wTmFtZSA9IGpRdWVyeS5wcm9wRml4WyBuYW1lIF0gfHwgbmFtZTtcblxuXHRcdFx0XHQvLyBCb29sZWFuIGF0dHJpYnV0ZXMgZ2V0IHNwZWNpYWwgdHJlYXRtZW50ICgjMTA4NzApXG5cdFx0XHRcdGlmICggalF1ZXJ5LmV4cHIubWF0Y2guYm9vbC50ZXN0KCBuYW1lICkgKSB7XG5cdFx0XHRcdFx0Ly8gU2V0IGNvcnJlc3BvbmRpbmcgcHJvcGVydHkgdG8gZmFsc2Vcblx0XHRcdFx0XHRlbGVtWyBwcm9wTmFtZSBdID0gZmFsc2U7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHRlbGVtLnJlbW92ZUF0dHJpYnV0ZSggbmFtZSApO1xuXHRcdFx0fVxuXHRcdH1cblx0fSxcblxuXHRhdHRySG9va3M6IHtcblx0XHR0eXBlOiB7XG5cdFx0XHRzZXQ6IGZ1bmN0aW9uKCBlbGVtLCB2YWx1ZSApIHtcblx0XHRcdFx0aWYgKCAhc3VwcG9ydC5yYWRpb1ZhbHVlICYmIHZhbHVlID09PSBcInJhZGlvXCIgJiZcblx0XHRcdFx0XHRqUXVlcnkubm9kZU5hbWUoIGVsZW0sIFwiaW5wdXRcIiApICkge1xuXHRcdFx0XHRcdHZhciB2YWwgPSBlbGVtLnZhbHVlO1xuXHRcdFx0XHRcdGVsZW0uc2V0QXR0cmlidXRlKCBcInR5cGVcIiwgdmFsdWUgKTtcblx0XHRcdFx0XHRpZiAoIHZhbCApIHtcblx0XHRcdFx0XHRcdGVsZW0udmFsdWUgPSB2YWw7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdHJldHVybiB2YWx1ZTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH1cblx0fVxufSk7XG5cbi8vIEhvb2tzIGZvciBib29sZWFuIGF0dHJpYnV0ZXNcbmJvb2xIb29rID0ge1xuXHRzZXQ6IGZ1bmN0aW9uKCBlbGVtLCB2YWx1ZSwgbmFtZSApIHtcblx0XHRpZiAoIHZhbHVlID09PSBmYWxzZSApIHtcblx0XHRcdC8vIFJlbW92ZSBib29sZWFuIGF0dHJpYnV0ZXMgd2hlbiBzZXQgdG8gZmFsc2Vcblx0XHRcdGpRdWVyeS5yZW1vdmVBdHRyKCBlbGVtLCBuYW1lICk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdGVsZW0uc2V0QXR0cmlidXRlKCBuYW1lLCBuYW1lICk7XG5cdFx0fVxuXHRcdHJldHVybiBuYW1lO1xuXHR9XG59O1xualF1ZXJ5LmVhY2goIGpRdWVyeS5leHByLm1hdGNoLmJvb2wuc291cmNlLm1hdGNoKCAvXFx3Ky9nICksIGZ1bmN0aW9uKCBpLCBuYW1lICkge1xuXHR2YXIgZ2V0dGVyID0gYXR0ckhhbmRsZVsgbmFtZSBdIHx8IGpRdWVyeS5maW5kLmF0dHI7XG5cblx0YXR0ckhhbmRsZVsgbmFtZSBdID0gZnVuY3Rpb24oIGVsZW0sIG5hbWUsIGlzWE1MICkge1xuXHRcdHZhciByZXQsIGhhbmRsZTtcblx0XHRpZiAoICFpc1hNTCApIHtcblx0XHRcdC8vIEF2b2lkIGFuIGluZmluaXRlIGxvb3AgYnkgdGVtcG9yYXJpbHkgcmVtb3ZpbmcgdGhpcyBmdW5jdGlvbiBmcm9tIHRoZSBnZXR0ZXJcblx0XHRcdGhhbmRsZSA9IGF0dHJIYW5kbGVbIG5hbWUgXTtcblx0XHRcdGF0dHJIYW5kbGVbIG5hbWUgXSA9IHJldDtcblx0XHRcdHJldCA9IGdldHRlciggZWxlbSwgbmFtZSwgaXNYTUwgKSAhPSBudWxsID9cblx0XHRcdFx0bmFtZS50b0xvd2VyQ2FzZSgpIDpcblx0XHRcdFx0bnVsbDtcblx0XHRcdGF0dHJIYW5kbGVbIG5hbWUgXSA9IGhhbmRsZTtcblx0XHR9XG5cdFx0cmV0dXJuIHJldDtcblx0fTtcbn0pO1xuXG5cblxuXG52YXIgcmZvY3VzYWJsZSA9IC9eKD86aW5wdXR8c2VsZWN0fHRleHRhcmVhfGJ1dHRvbikkL2k7XG5cbmpRdWVyeS5mbi5leHRlbmQoe1xuXHRwcm9wOiBmdW5jdGlvbiggbmFtZSwgdmFsdWUgKSB7XG5cdFx0cmV0dXJuIGFjY2VzcyggdGhpcywgalF1ZXJ5LnByb3AsIG5hbWUsIHZhbHVlLCBhcmd1bWVudHMubGVuZ3RoID4gMSApO1xuXHR9LFxuXG5cdHJlbW92ZVByb3A6IGZ1bmN0aW9uKCBuYW1lICkge1xuXHRcdHJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oKSB7XG5cdFx0XHRkZWxldGUgdGhpc1sgalF1ZXJ5LnByb3BGaXhbIG5hbWUgXSB8fCBuYW1lIF07XG5cdFx0fSk7XG5cdH1cbn0pO1xuXG5qUXVlcnkuZXh0ZW5kKHtcblx0cHJvcEZpeDoge1xuXHRcdFwiZm9yXCI6IFwiaHRtbEZvclwiLFxuXHRcdFwiY2xhc3NcIjogXCJjbGFzc05hbWVcIlxuXHR9LFxuXG5cdHByb3A6IGZ1bmN0aW9uKCBlbGVtLCBuYW1lLCB2YWx1ZSApIHtcblx0XHR2YXIgcmV0LCBob29rcywgbm90eG1sLFxuXHRcdFx0blR5cGUgPSBlbGVtLm5vZGVUeXBlO1xuXG5cdFx0Ly8gRG9uJ3QgZ2V0L3NldCBwcm9wZXJ0aWVzIG9uIHRleHQsIGNvbW1lbnQgYW5kIGF0dHJpYnV0ZSBub2Rlc1xuXHRcdGlmICggIWVsZW0gfHwgblR5cGUgPT09IDMgfHwgblR5cGUgPT09IDggfHwgblR5cGUgPT09IDIgKSB7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXG5cdFx0bm90eG1sID0gblR5cGUgIT09IDEgfHwgIWpRdWVyeS5pc1hNTERvYyggZWxlbSApO1xuXG5cdFx0aWYgKCBub3R4bWwgKSB7XG5cdFx0XHQvLyBGaXggbmFtZSBhbmQgYXR0YWNoIGhvb2tzXG5cdFx0XHRuYW1lID0galF1ZXJ5LnByb3BGaXhbIG5hbWUgXSB8fCBuYW1lO1xuXHRcdFx0aG9va3MgPSBqUXVlcnkucHJvcEhvb2tzWyBuYW1lIF07XG5cdFx0fVxuXG5cdFx0aWYgKCB2YWx1ZSAhPT0gdW5kZWZpbmVkICkge1xuXHRcdFx0cmV0dXJuIGhvb2tzICYmIFwic2V0XCIgaW4gaG9va3MgJiYgKHJldCA9IGhvb2tzLnNldCggZWxlbSwgdmFsdWUsIG5hbWUgKSkgIT09IHVuZGVmaW5lZCA/XG5cdFx0XHRcdHJldCA6XG5cdFx0XHRcdCggZWxlbVsgbmFtZSBdID0gdmFsdWUgKTtcblxuXHRcdH0gZWxzZSB7XG5cdFx0XHRyZXR1cm4gaG9va3MgJiYgXCJnZXRcIiBpbiBob29rcyAmJiAocmV0ID0gaG9va3MuZ2V0KCBlbGVtLCBuYW1lICkpICE9PSBudWxsID9cblx0XHRcdFx0cmV0IDpcblx0XHRcdFx0ZWxlbVsgbmFtZSBdO1xuXHRcdH1cblx0fSxcblxuXHRwcm9wSG9va3M6IHtcblx0XHR0YWJJbmRleDoge1xuXHRcdFx0Z2V0OiBmdW5jdGlvbiggZWxlbSApIHtcblx0XHRcdFx0cmV0dXJuIGVsZW0uaGFzQXR0cmlidXRlKCBcInRhYmluZGV4XCIgKSB8fCByZm9jdXNhYmxlLnRlc3QoIGVsZW0ubm9kZU5hbWUgKSB8fCBlbGVtLmhyZWYgP1xuXHRcdFx0XHRcdGVsZW0udGFiSW5kZXggOlxuXHRcdFx0XHRcdC0xO1xuXHRcdFx0fVxuXHRcdH1cblx0fVxufSk7XG5cbmlmICggIXN1cHBvcnQub3B0U2VsZWN0ZWQgKSB7XG5cdGpRdWVyeS5wcm9wSG9va3Muc2VsZWN0ZWQgPSB7XG5cdFx0Z2V0OiBmdW5jdGlvbiggZWxlbSApIHtcblx0XHRcdHZhciBwYXJlbnQgPSBlbGVtLnBhcmVudE5vZGU7XG5cdFx0XHRpZiAoIHBhcmVudCAmJiBwYXJlbnQucGFyZW50Tm9kZSApIHtcblx0XHRcdFx0cGFyZW50LnBhcmVudE5vZGUuc2VsZWN0ZWRJbmRleDtcblx0XHRcdH1cblx0XHRcdHJldHVybiBudWxsO1xuXHRcdH1cblx0fTtcbn1cblxualF1ZXJ5LmVhY2goW1xuXHRcInRhYkluZGV4XCIsXG5cdFwicmVhZE9ubHlcIixcblx0XCJtYXhMZW5ndGhcIixcblx0XCJjZWxsU3BhY2luZ1wiLFxuXHRcImNlbGxQYWRkaW5nXCIsXG5cdFwicm93U3BhblwiLFxuXHRcImNvbFNwYW5cIixcblx0XCJ1c2VNYXBcIixcblx0XCJmcmFtZUJvcmRlclwiLFxuXHRcImNvbnRlbnRFZGl0YWJsZVwiXG5dLCBmdW5jdGlvbigpIHtcblx0alF1ZXJ5LnByb3BGaXhbIHRoaXMudG9Mb3dlckNhc2UoKSBdID0gdGhpcztcbn0pO1xuXG5cblxuXG52YXIgcmNsYXNzID0gL1tcXHRcXHJcXG5cXGZdL2c7XG5cbmpRdWVyeS5mbi5leHRlbmQoe1xuXHRhZGRDbGFzczogZnVuY3Rpb24oIHZhbHVlICkge1xuXHRcdHZhciBjbGFzc2VzLCBlbGVtLCBjdXIsIGNsYXp6LCBqLCBmaW5hbFZhbHVlLFxuXHRcdFx0cHJvY2VlZCA9IHR5cGVvZiB2YWx1ZSA9PT0gXCJzdHJpbmdcIiAmJiB2YWx1ZSxcblx0XHRcdGkgPSAwLFxuXHRcdFx0bGVuID0gdGhpcy5sZW5ndGg7XG5cblx0XHRpZiAoIGpRdWVyeS5pc0Z1bmN0aW9uKCB2YWx1ZSApICkge1xuXHRcdFx0cmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbiggaiApIHtcblx0XHRcdFx0alF1ZXJ5KCB0aGlzICkuYWRkQ2xhc3MoIHZhbHVlLmNhbGwoIHRoaXMsIGosIHRoaXMuY2xhc3NOYW1lICkgKTtcblx0XHRcdH0pO1xuXHRcdH1cblxuXHRcdGlmICggcHJvY2VlZCApIHtcblx0XHRcdC8vIFRoZSBkaXNqdW5jdGlvbiBoZXJlIGlzIGZvciBiZXR0ZXIgY29tcHJlc3NpYmlsaXR5IChzZWUgcmVtb3ZlQ2xhc3MpXG5cdFx0XHRjbGFzc2VzID0gKCB2YWx1ZSB8fCBcIlwiICkubWF0Y2goIHJub3R3aGl0ZSApIHx8IFtdO1xuXG5cdFx0XHRmb3IgKCA7IGkgPCBsZW47IGkrKyApIHtcblx0XHRcdFx0ZWxlbSA9IHRoaXNbIGkgXTtcblx0XHRcdFx0Y3VyID0gZWxlbS5ub2RlVHlwZSA9PT0gMSAmJiAoIGVsZW0uY2xhc3NOYW1lID9cblx0XHRcdFx0XHQoIFwiIFwiICsgZWxlbS5jbGFzc05hbWUgKyBcIiBcIiApLnJlcGxhY2UoIHJjbGFzcywgXCIgXCIgKSA6XG5cdFx0XHRcdFx0XCIgXCJcblx0XHRcdFx0KTtcblxuXHRcdFx0XHRpZiAoIGN1ciApIHtcblx0XHRcdFx0XHRqID0gMDtcblx0XHRcdFx0XHR3aGlsZSAoIChjbGF6eiA9IGNsYXNzZXNbaisrXSkgKSB7XG5cdFx0XHRcdFx0XHRpZiAoIGN1ci5pbmRleE9mKCBcIiBcIiArIGNsYXp6ICsgXCIgXCIgKSA8IDAgKSB7XG5cdFx0XHRcdFx0XHRcdGN1ciArPSBjbGF6eiArIFwiIFwiO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdC8vIG9ubHkgYXNzaWduIGlmIGRpZmZlcmVudCB0byBhdm9pZCB1bm5lZWRlZCByZW5kZXJpbmcuXG5cdFx0XHRcdFx0ZmluYWxWYWx1ZSA9IGpRdWVyeS50cmltKCBjdXIgKTtcblx0XHRcdFx0XHRpZiAoIGVsZW0uY2xhc3NOYW1lICE9PSBmaW5hbFZhbHVlICkge1xuXHRcdFx0XHRcdFx0ZWxlbS5jbGFzc05hbWUgPSBmaW5hbFZhbHVlO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH1cblxuXHRcdHJldHVybiB0aGlzO1xuXHR9LFxuXG5cdHJlbW92ZUNsYXNzOiBmdW5jdGlvbiggdmFsdWUgKSB7XG5cdFx0dmFyIGNsYXNzZXMsIGVsZW0sIGN1ciwgY2xhenosIGosIGZpbmFsVmFsdWUsXG5cdFx0XHRwcm9jZWVkID0gYXJndW1lbnRzLmxlbmd0aCA9PT0gMCB8fCB0eXBlb2YgdmFsdWUgPT09IFwic3RyaW5nXCIgJiYgdmFsdWUsXG5cdFx0XHRpID0gMCxcblx0XHRcdGxlbiA9IHRoaXMubGVuZ3RoO1xuXG5cdFx0aWYgKCBqUXVlcnkuaXNGdW5jdGlvbiggdmFsdWUgKSApIHtcblx0XHRcdHJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oIGogKSB7XG5cdFx0XHRcdGpRdWVyeSggdGhpcyApLnJlbW92ZUNsYXNzKCB2YWx1ZS5jYWxsKCB0aGlzLCBqLCB0aGlzLmNsYXNzTmFtZSApICk7XG5cdFx0XHR9KTtcblx0XHR9XG5cdFx0aWYgKCBwcm9jZWVkICkge1xuXHRcdFx0Y2xhc3NlcyA9ICggdmFsdWUgfHwgXCJcIiApLm1hdGNoKCBybm90d2hpdGUgKSB8fCBbXTtcblxuXHRcdFx0Zm9yICggOyBpIDwgbGVuOyBpKysgKSB7XG5cdFx0XHRcdGVsZW0gPSB0aGlzWyBpIF07XG5cdFx0XHRcdC8vIFRoaXMgZXhwcmVzc2lvbiBpcyBoZXJlIGZvciBiZXR0ZXIgY29tcHJlc3NpYmlsaXR5IChzZWUgYWRkQ2xhc3MpXG5cdFx0XHRcdGN1ciA9IGVsZW0ubm9kZVR5cGUgPT09IDEgJiYgKCBlbGVtLmNsYXNzTmFtZSA/XG5cdFx0XHRcdFx0KCBcIiBcIiArIGVsZW0uY2xhc3NOYW1lICsgXCIgXCIgKS5yZXBsYWNlKCByY2xhc3MsIFwiIFwiICkgOlxuXHRcdFx0XHRcdFwiXCJcblx0XHRcdFx0KTtcblxuXHRcdFx0XHRpZiAoIGN1ciApIHtcblx0XHRcdFx0XHRqID0gMDtcblx0XHRcdFx0XHR3aGlsZSAoIChjbGF6eiA9IGNsYXNzZXNbaisrXSkgKSB7XG5cdFx0XHRcdFx0XHQvLyBSZW1vdmUgKmFsbCogaW5zdGFuY2VzXG5cdFx0XHRcdFx0XHR3aGlsZSAoIGN1ci5pbmRleE9mKCBcIiBcIiArIGNsYXp6ICsgXCIgXCIgKSA+PSAwICkge1xuXHRcdFx0XHRcdFx0XHRjdXIgPSBjdXIucmVwbGFjZSggXCIgXCIgKyBjbGF6eiArIFwiIFwiLCBcIiBcIiApO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdC8vIE9ubHkgYXNzaWduIGlmIGRpZmZlcmVudCB0byBhdm9pZCB1bm5lZWRlZCByZW5kZXJpbmcuXG5cdFx0XHRcdFx0ZmluYWxWYWx1ZSA9IHZhbHVlID8galF1ZXJ5LnRyaW0oIGN1ciApIDogXCJcIjtcblx0XHRcdFx0XHRpZiAoIGVsZW0uY2xhc3NOYW1lICE9PSBmaW5hbFZhbHVlICkge1xuXHRcdFx0XHRcdFx0ZWxlbS5jbGFzc05hbWUgPSBmaW5hbFZhbHVlO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH1cblxuXHRcdHJldHVybiB0aGlzO1xuXHR9LFxuXG5cdHRvZ2dsZUNsYXNzOiBmdW5jdGlvbiggdmFsdWUsIHN0YXRlVmFsICkge1xuXHRcdHZhciB0eXBlID0gdHlwZW9mIHZhbHVlO1xuXG5cdFx0aWYgKCB0eXBlb2Ygc3RhdGVWYWwgPT09IFwiYm9vbGVhblwiICYmIHR5cGUgPT09IFwic3RyaW5nXCIgKSB7XG5cdFx0XHRyZXR1cm4gc3RhdGVWYWwgPyB0aGlzLmFkZENsYXNzKCB2YWx1ZSApIDogdGhpcy5yZW1vdmVDbGFzcyggdmFsdWUgKTtcblx0XHR9XG5cblx0XHRpZiAoIGpRdWVyeS5pc0Z1bmN0aW9uKCB2YWx1ZSApICkge1xuXHRcdFx0cmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbiggaSApIHtcblx0XHRcdFx0alF1ZXJ5KCB0aGlzICkudG9nZ2xlQ2xhc3MoIHZhbHVlLmNhbGwodGhpcywgaSwgdGhpcy5jbGFzc05hbWUsIHN0YXRlVmFsKSwgc3RhdGVWYWwgKTtcblx0XHRcdH0pO1xuXHRcdH1cblxuXHRcdHJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oKSB7XG5cdFx0XHRpZiAoIHR5cGUgPT09IFwic3RyaW5nXCIgKSB7XG5cdFx0XHRcdC8vIFRvZ2dsZSBpbmRpdmlkdWFsIGNsYXNzIG5hbWVzXG5cdFx0XHRcdHZhciBjbGFzc05hbWUsXG5cdFx0XHRcdFx0aSA9IDAsXG5cdFx0XHRcdFx0c2VsZiA9IGpRdWVyeSggdGhpcyApLFxuXHRcdFx0XHRcdGNsYXNzTmFtZXMgPSB2YWx1ZS5tYXRjaCggcm5vdHdoaXRlICkgfHwgW107XG5cblx0XHRcdFx0d2hpbGUgKCAoY2xhc3NOYW1lID0gY2xhc3NOYW1lc1sgaSsrIF0pICkge1xuXHRcdFx0XHRcdC8vIENoZWNrIGVhY2ggY2xhc3NOYW1lIGdpdmVuLCBzcGFjZSBzZXBhcmF0ZWQgbGlzdFxuXHRcdFx0XHRcdGlmICggc2VsZi5oYXNDbGFzcyggY2xhc3NOYW1lICkgKSB7XG5cdFx0XHRcdFx0XHRzZWxmLnJlbW92ZUNsYXNzKCBjbGFzc05hbWUgKTtcblx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0c2VsZi5hZGRDbGFzcyggY2xhc3NOYW1lICk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cblx0XHRcdC8vIFRvZ2dsZSB3aG9sZSBjbGFzcyBuYW1lXG5cdFx0XHR9IGVsc2UgaWYgKCB0eXBlID09PSBzdHJ1bmRlZmluZWQgfHwgdHlwZSA9PT0gXCJib29sZWFuXCIgKSB7XG5cdFx0XHRcdGlmICggdGhpcy5jbGFzc05hbWUgKSB7XG5cdFx0XHRcdFx0Ly8gc3RvcmUgY2xhc3NOYW1lIGlmIHNldFxuXHRcdFx0XHRcdGRhdGFfcHJpdi5zZXQoIHRoaXMsIFwiX19jbGFzc05hbWVfX1wiLCB0aGlzLmNsYXNzTmFtZSApO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0Ly8gSWYgdGhlIGVsZW1lbnQgaGFzIGEgY2xhc3MgbmFtZSBvciBpZiB3ZSdyZSBwYXNzZWQgYGZhbHNlYCxcblx0XHRcdFx0Ly8gdGhlbiByZW1vdmUgdGhlIHdob2xlIGNsYXNzbmFtZSAoaWYgdGhlcmUgd2FzIG9uZSwgdGhlIGFib3ZlIHNhdmVkIGl0KS5cblx0XHRcdFx0Ly8gT3RoZXJ3aXNlIGJyaW5nIGJhY2sgd2hhdGV2ZXIgd2FzIHByZXZpb3VzbHkgc2F2ZWQgKGlmIGFueXRoaW5nKSxcblx0XHRcdFx0Ly8gZmFsbGluZyBiYWNrIHRvIHRoZSBlbXB0eSBzdHJpbmcgaWYgbm90aGluZyB3YXMgc3RvcmVkLlxuXHRcdFx0XHR0aGlzLmNsYXNzTmFtZSA9IHRoaXMuY2xhc3NOYW1lIHx8IHZhbHVlID09PSBmYWxzZSA/IFwiXCIgOiBkYXRhX3ByaXYuZ2V0KCB0aGlzLCBcIl9fY2xhc3NOYW1lX19cIiApIHx8IFwiXCI7XG5cdFx0XHR9XG5cdFx0fSk7XG5cdH0sXG5cblx0aGFzQ2xhc3M6IGZ1bmN0aW9uKCBzZWxlY3RvciApIHtcblx0XHR2YXIgY2xhc3NOYW1lID0gXCIgXCIgKyBzZWxlY3RvciArIFwiIFwiLFxuXHRcdFx0aSA9IDAsXG5cdFx0XHRsID0gdGhpcy5sZW5ndGg7XG5cdFx0Zm9yICggOyBpIDwgbDsgaSsrICkge1xuXHRcdFx0aWYgKCB0aGlzW2ldLm5vZGVUeXBlID09PSAxICYmIChcIiBcIiArIHRoaXNbaV0uY2xhc3NOYW1lICsgXCIgXCIpLnJlcGxhY2UocmNsYXNzLCBcIiBcIikuaW5kZXhPZiggY2xhc3NOYW1lICkgPj0gMCApIHtcblx0XHRcdFx0cmV0dXJuIHRydWU7XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0cmV0dXJuIGZhbHNlO1xuXHR9XG59KTtcblxuXG5cblxudmFyIHJyZXR1cm4gPSAvXFxyL2c7XG5cbmpRdWVyeS5mbi5leHRlbmQoe1xuXHR2YWw6IGZ1bmN0aW9uKCB2YWx1ZSApIHtcblx0XHR2YXIgaG9va3MsIHJldCwgaXNGdW5jdGlvbixcblx0XHRcdGVsZW0gPSB0aGlzWzBdO1xuXG5cdFx0aWYgKCAhYXJndW1lbnRzLmxlbmd0aCApIHtcblx0XHRcdGlmICggZWxlbSApIHtcblx0XHRcdFx0aG9va3MgPSBqUXVlcnkudmFsSG9va3NbIGVsZW0udHlwZSBdIHx8IGpRdWVyeS52YWxIb29rc1sgZWxlbS5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpIF07XG5cblx0XHRcdFx0aWYgKCBob29rcyAmJiBcImdldFwiIGluIGhvb2tzICYmIChyZXQgPSBob29rcy5nZXQoIGVsZW0sIFwidmFsdWVcIiApKSAhPT0gdW5kZWZpbmVkICkge1xuXHRcdFx0XHRcdHJldHVybiByZXQ7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHRyZXQgPSBlbGVtLnZhbHVlO1xuXG5cdFx0XHRcdHJldHVybiB0eXBlb2YgcmV0ID09PSBcInN0cmluZ1wiID9cblx0XHRcdFx0XHQvLyBIYW5kbGUgbW9zdCBjb21tb24gc3RyaW5nIGNhc2VzXG5cdFx0XHRcdFx0cmV0LnJlcGxhY2UocnJldHVybiwgXCJcIikgOlxuXHRcdFx0XHRcdC8vIEhhbmRsZSBjYXNlcyB3aGVyZSB2YWx1ZSBpcyBudWxsL3VuZGVmIG9yIG51bWJlclxuXHRcdFx0XHRcdHJldCA9PSBudWxsID8gXCJcIiA6IHJldDtcblx0XHRcdH1cblxuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblxuXHRcdGlzRnVuY3Rpb24gPSBqUXVlcnkuaXNGdW5jdGlvbiggdmFsdWUgKTtcblxuXHRcdHJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oIGkgKSB7XG5cdFx0XHR2YXIgdmFsO1xuXG5cdFx0XHRpZiAoIHRoaXMubm9kZVR5cGUgIT09IDEgKSB7XG5cdFx0XHRcdHJldHVybjtcblx0XHRcdH1cblxuXHRcdFx0aWYgKCBpc0Z1bmN0aW9uICkge1xuXHRcdFx0XHR2YWwgPSB2YWx1ZS5jYWxsKCB0aGlzLCBpLCBqUXVlcnkoIHRoaXMgKS52YWwoKSApO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0dmFsID0gdmFsdWU7XG5cdFx0XHR9XG5cblx0XHRcdC8vIFRyZWF0IG51bGwvdW5kZWZpbmVkIGFzIFwiXCI7IGNvbnZlcnQgbnVtYmVycyB0byBzdHJpbmdcblx0XHRcdGlmICggdmFsID09IG51bGwgKSB7XG5cdFx0XHRcdHZhbCA9IFwiXCI7XG5cblx0XHRcdH0gZWxzZSBpZiAoIHR5cGVvZiB2YWwgPT09IFwibnVtYmVyXCIgKSB7XG5cdFx0XHRcdHZhbCArPSBcIlwiO1xuXG5cdFx0XHR9IGVsc2UgaWYgKCBqUXVlcnkuaXNBcnJheSggdmFsICkgKSB7XG5cdFx0XHRcdHZhbCA9IGpRdWVyeS5tYXAoIHZhbCwgZnVuY3Rpb24oIHZhbHVlICkge1xuXHRcdFx0XHRcdHJldHVybiB2YWx1ZSA9PSBudWxsID8gXCJcIiA6IHZhbHVlICsgXCJcIjtcblx0XHRcdFx0fSk7XG5cdFx0XHR9XG5cblx0XHRcdGhvb2tzID0galF1ZXJ5LnZhbEhvb2tzWyB0aGlzLnR5cGUgXSB8fCBqUXVlcnkudmFsSG9va3NbIHRoaXMubm9kZU5hbWUudG9Mb3dlckNhc2UoKSBdO1xuXG5cdFx0XHQvLyBJZiBzZXQgcmV0dXJucyB1bmRlZmluZWQsIGZhbGwgYmFjayB0byBub3JtYWwgc2V0dGluZ1xuXHRcdFx0aWYgKCAhaG9va3MgfHwgIShcInNldFwiIGluIGhvb2tzKSB8fCBob29rcy5zZXQoIHRoaXMsIHZhbCwgXCJ2YWx1ZVwiICkgPT09IHVuZGVmaW5lZCApIHtcblx0XHRcdFx0dGhpcy52YWx1ZSA9IHZhbDtcblx0XHRcdH1cblx0XHR9KTtcblx0fVxufSk7XG5cbmpRdWVyeS5leHRlbmQoe1xuXHR2YWxIb29rczoge1xuXHRcdG9wdGlvbjoge1xuXHRcdFx0Z2V0OiBmdW5jdGlvbiggZWxlbSApIHtcblx0XHRcdFx0dmFyIHZhbCA9IGpRdWVyeS5maW5kLmF0dHIoIGVsZW0sIFwidmFsdWVcIiApO1xuXHRcdFx0XHRyZXR1cm4gdmFsICE9IG51bGwgP1xuXHRcdFx0XHRcdHZhbCA6XG5cdFx0XHRcdFx0Ly8gU3VwcG9ydDogSUUxMC0xMStcblx0XHRcdFx0XHQvLyBvcHRpb24udGV4dCB0aHJvd3MgZXhjZXB0aW9ucyAoIzE0Njg2LCAjMTQ4NTgpXG5cdFx0XHRcdFx0alF1ZXJ5LnRyaW0oIGpRdWVyeS50ZXh0KCBlbGVtICkgKTtcblx0XHRcdH1cblx0XHR9LFxuXHRcdHNlbGVjdDoge1xuXHRcdFx0Z2V0OiBmdW5jdGlvbiggZWxlbSApIHtcblx0XHRcdFx0dmFyIHZhbHVlLCBvcHRpb24sXG5cdFx0XHRcdFx0b3B0aW9ucyA9IGVsZW0ub3B0aW9ucyxcblx0XHRcdFx0XHRpbmRleCA9IGVsZW0uc2VsZWN0ZWRJbmRleCxcblx0XHRcdFx0XHRvbmUgPSBlbGVtLnR5cGUgPT09IFwic2VsZWN0LW9uZVwiIHx8IGluZGV4IDwgMCxcblx0XHRcdFx0XHR2YWx1ZXMgPSBvbmUgPyBudWxsIDogW10sXG5cdFx0XHRcdFx0bWF4ID0gb25lID8gaW5kZXggKyAxIDogb3B0aW9ucy5sZW5ndGgsXG5cdFx0XHRcdFx0aSA9IGluZGV4IDwgMCA/XG5cdFx0XHRcdFx0XHRtYXggOlxuXHRcdFx0XHRcdFx0b25lID8gaW5kZXggOiAwO1xuXG5cdFx0XHRcdC8vIExvb3AgdGhyb3VnaCBhbGwgdGhlIHNlbGVjdGVkIG9wdGlvbnNcblx0XHRcdFx0Zm9yICggOyBpIDwgbWF4OyBpKysgKSB7XG5cdFx0XHRcdFx0b3B0aW9uID0gb3B0aW9uc1sgaSBdO1xuXG5cdFx0XHRcdFx0Ly8gSUU2LTkgZG9lc24ndCB1cGRhdGUgc2VsZWN0ZWQgYWZ0ZXIgZm9ybSByZXNldCAoIzI1NTEpXG5cdFx0XHRcdFx0aWYgKCAoIG9wdGlvbi5zZWxlY3RlZCB8fCBpID09PSBpbmRleCApICYmXG5cdFx0XHRcdFx0XHRcdC8vIERvbid0IHJldHVybiBvcHRpb25zIHRoYXQgYXJlIGRpc2FibGVkIG9yIGluIGEgZGlzYWJsZWQgb3B0Z3JvdXBcblx0XHRcdFx0XHRcdFx0KCBzdXBwb3J0Lm9wdERpc2FibGVkID8gIW9wdGlvbi5kaXNhYmxlZCA6IG9wdGlvbi5nZXRBdHRyaWJ1dGUoIFwiZGlzYWJsZWRcIiApID09PSBudWxsICkgJiZcblx0XHRcdFx0XHRcdFx0KCAhb3B0aW9uLnBhcmVudE5vZGUuZGlzYWJsZWQgfHwgIWpRdWVyeS5ub2RlTmFtZSggb3B0aW9uLnBhcmVudE5vZGUsIFwib3B0Z3JvdXBcIiApICkgKSB7XG5cblx0XHRcdFx0XHRcdC8vIEdldCB0aGUgc3BlY2lmaWMgdmFsdWUgZm9yIHRoZSBvcHRpb25cblx0XHRcdFx0XHRcdHZhbHVlID0galF1ZXJ5KCBvcHRpb24gKS52YWwoKTtcblxuXHRcdFx0XHRcdFx0Ly8gV2UgZG9uJ3QgbmVlZCBhbiBhcnJheSBmb3Igb25lIHNlbGVjdHNcblx0XHRcdFx0XHRcdGlmICggb25lICkge1xuXHRcdFx0XHRcdFx0XHRyZXR1cm4gdmFsdWU7XG5cdFx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRcdC8vIE11bHRpLVNlbGVjdHMgcmV0dXJuIGFuIGFycmF5XG5cdFx0XHRcdFx0XHR2YWx1ZXMucHVzaCggdmFsdWUgKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblxuXHRcdFx0XHRyZXR1cm4gdmFsdWVzO1xuXHRcdFx0fSxcblxuXHRcdFx0c2V0OiBmdW5jdGlvbiggZWxlbSwgdmFsdWUgKSB7XG5cdFx0XHRcdHZhciBvcHRpb25TZXQsIG9wdGlvbixcblx0XHRcdFx0XHRvcHRpb25zID0gZWxlbS5vcHRpb25zLFxuXHRcdFx0XHRcdHZhbHVlcyA9IGpRdWVyeS5tYWtlQXJyYXkoIHZhbHVlICksXG5cdFx0XHRcdFx0aSA9IG9wdGlvbnMubGVuZ3RoO1xuXG5cdFx0XHRcdHdoaWxlICggaS0tICkge1xuXHRcdFx0XHRcdG9wdGlvbiA9IG9wdGlvbnNbIGkgXTtcblx0XHRcdFx0XHRpZiAoIChvcHRpb24uc2VsZWN0ZWQgPSBqUXVlcnkuaW5BcnJheSggb3B0aW9uLnZhbHVlLCB2YWx1ZXMgKSA+PSAwKSApIHtcblx0XHRcdFx0XHRcdG9wdGlvblNldCA9IHRydWU7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cblx0XHRcdFx0Ly8gRm9yY2UgYnJvd3NlcnMgdG8gYmVoYXZlIGNvbnNpc3RlbnRseSB3aGVuIG5vbi1tYXRjaGluZyB2YWx1ZSBpcyBzZXRcblx0XHRcdFx0aWYgKCAhb3B0aW9uU2V0ICkge1xuXHRcdFx0XHRcdGVsZW0uc2VsZWN0ZWRJbmRleCA9IC0xO1xuXHRcdFx0XHR9XG5cdFx0XHRcdHJldHVybiB2YWx1ZXM7XG5cdFx0XHR9XG5cdFx0fVxuXHR9XG59KTtcblxuLy8gUmFkaW9zIGFuZCBjaGVja2JveGVzIGdldHRlci9zZXR0ZXJcbmpRdWVyeS5lYWNoKFsgXCJyYWRpb1wiLCBcImNoZWNrYm94XCIgXSwgZnVuY3Rpb24oKSB7XG5cdGpRdWVyeS52YWxIb29rc1sgdGhpcyBdID0ge1xuXHRcdHNldDogZnVuY3Rpb24oIGVsZW0sIHZhbHVlICkge1xuXHRcdFx0aWYgKCBqUXVlcnkuaXNBcnJheSggdmFsdWUgKSApIHtcblx0XHRcdFx0cmV0dXJuICggZWxlbS5jaGVja2VkID0galF1ZXJ5LmluQXJyYXkoIGpRdWVyeShlbGVtKS52YWwoKSwgdmFsdWUgKSA+PSAwICk7XG5cdFx0XHR9XG5cdFx0fVxuXHR9O1xuXHRpZiAoICFzdXBwb3J0LmNoZWNrT24gKSB7XG5cdFx0alF1ZXJ5LnZhbEhvb2tzWyB0aGlzIF0uZ2V0ID0gZnVuY3Rpb24oIGVsZW0gKSB7XG5cdFx0XHRyZXR1cm4gZWxlbS5nZXRBdHRyaWJ1dGUoXCJ2YWx1ZVwiKSA9PT0gbnVsbCA/IFwib25cIiA6IGVsZW0udmFsdWU7XG5cdFx0fTtcblx0fVxufSk7XG5cblxuXG5cbi8vIFJldHVybiBqUXVlcnkgZm9yIGF0dHJpYnV0ZXMtb25seSBpbmNsdXNpb25cblxuXG5qUXVlcnkuZWFjaCggKFwiYmx1ciBmb2N1cyBmb2N1c2luIGZvY3Vzb3V0IGxvYWQgcmVzaXplIHNjcm9sbCB1bmxvYWQgY2xpY2sgZGJsY2xpY2sgXCIgK1xuXHRcIm1vdXNlZG93biBtb3VzZXVwIG1vdXNlbW92ZSBtb3VzZW92ZXIgbW91c2VvdXQgbW91c2VlbnRlciBtb3VzZWxlYXZlIFwiICtcblx0XCJjaGFuZ2Ugc2VsZWN0IHN1Ym1pdCBrZXlkb3duIGtleXByZXNzIGtleXVwIGVycm9yIGNvbnRleHRtZW51XCIpLnNwbGl0KFwiIFwiKSwgZnVuY3Rpb24oIGksIG5hbWUgKSB7XG5cblx0Ly8gSGFuZGxlIGV2ZW50IGJpbmRpbmdcblx0alF1ZXJ5LmZuWyBuYW1lIF0gPSBmdW5jdGlvbiggZGF0YSwgZm4gKSB7XG5cdFx0cmV0dXJuIGFyZ3VtZW50cy5sZW5ndGggPiAwID9cblx0XHRcdHRoaXMub24oIG5hbWUsIG51bGwsIGRhdGEsIGZuICkgOlxuXHRcdFx0dGhpcy50cmlnZ2VyKCBuYW1lICk7XG5cdH07XG59KTtcblxualF1ZXJ5LmZuLmV4dGVuZCh7XG5cdGhvdmVyOiBmdW5jdGlvbiggZm5PdmVyLCBmbk91dCApIHtcblx0XHRyZXR1cm4gdGhpcy5tb3VzZWVudGVyKCBmbk92ZXIgKS5tb3VzZWxlYXZlKCBmbk91dCB8fCBmbk92ZXIgKTtcblx0fSxcblxuXHRiaW5kOiBmdW5jdGlvbiggdHlwZXMsIGRhdGEsIGZuICkge1xuXHRcdHJldHVybiB0aGlzLm9uKCB0eXBlcywgbnVsbCwgZGF0YSwgZm4gKTtcblx0fSxcblx0dW5iaW5kOiBmdW5jdGlvbiggdHlwZXMsIGZuICkge1xuXHRcdHJldHVybiB0aGlzLm9mZiggdHlwZXMsIG51bGwsIGZuICk7XG5cdH0sXG5cblx0ZGVsZWdhdGU6IGZ1bmN0aW9uKCBzZWxlY3RvciwgdHlwZXMsIGRhdGEsIGZuICkge1xuXHRcdHJldHVybiB0aGlzLm9uKCB0eXBlcywgc2VsZWN0b3IsIGRhdGEsIGZuICk7XG5cdH0sXG5cdHVuZGVsZWdhdGU6IGZ1bmN0aW9uKCBzZWxlY3RvciwgdHlwZXMsIGZuICkge1xuXHRcdC8vICggbmFtZXNwYWNlICkgb3IgKCBzZWxlY3RvciwgdHlwZXMgWywgZm5dIClcblx0XHRyZXR1cm4gYXJndW1lbnRzLmxlbmd0aCA9PT0gMSA/IHRoaXMub2ZmKCBzZWxlY3RvciwgXCIqKlwiICkgOiB0aGlzLm9mZiggdHlwZXMsIHNlbGVjdG9yIHx8IFwiKipcIiwgZm4gKTtcblx0fVxufSk7XG5cblxudmFyIG5vbmNlID0galF1ZXJ5Lm5vdygpO1xuXG52YXIgcnF1ZXJ5ID0gKC9cXD8vKTtcblxuXG5cbi8vIFN1cHBvcnQ6IEFuZHJvaWQgMi4zXG4vLyBXb3JrYXJvdW5kIGZhaWx1cmUgdG8gc3RyaW5nLWNhc3QgbnVsbCBpbnB1dFxualF1ZXJ5LnBhcnNlSlNPTiA9IGZ1bmN0aW9uKCBkYXRhICkge1xuXHRyZXR1cm4gSlNPTi5wYXJzZSggZGF0YSArIFwiXCIgKTtcbn07XG5cblxuLy8gQ3Jvc3MtYnJvd3NlciB4bWwgcGFyc2luZ1xualF1ZXJ5LnBhcnNlWE1MID0gZnVuY3Rpb24oIGRhdGEgKSB7XG5cdHZhciB4bWwsIHRtcDtcblx0aWYgKCAhZGF0YSB8fCB0eXBlb2YgZGF0YSAhPT0gXCJzdHJpbmdcIiApIHtcblx0XHRyZXR1cm4gbnVsbDtcblx0fVxuXG5cdC8vIFN1cHBvcnQ6IElFOVxuXHR0cnkge1xuXHRcdHRtcCA9IG5ldyBET01QYXJzZXIoKTtcblx0XHR4bWwgPSB0bXAucGFyc2VGcm9tU3RyaW5nKCBkYXRhLCBcInRleHQveG1sXCIgKTtcblx0fSBjYXRjaCAoIGUgKSB7XG5cdFx0eG1sID0gdW5kZWZpbmVkO1xuXHR9XG5cblx0aWYgKCAheG1sIHx8IHhtbC5nZXRFbGVtZW50c0J5VGFnTmFtZSggXCJwYXJzZXJlcnJvclwiICkubGVuZ3RoICkge1xuXHRcdGpRdWVyeS5lcnJvciggXCJJbnZhbGlkIFhNTDogXCIgKyBkYXRhICk7XG5cdH1cblx0cmV0dXJuIHhtbDtcbn07XG5cblxudmFyXG5cdHJoYXNoID0gLyMuKiQvLFxuXHRydHMgPSAvKFs/Jl0pXz1bXiZdKi8sXG5cdHJoZWFkZXJzID0gL14oLio/KTpbIFxcdF0qKFteXFxyXFxuXSopJC9tZyxcblx0Ly8gIzc2NTMsICM4MTI1LCAjODE1MjogbG9jYWwgcHJvdG9jb2wgZGV0ZWN0aW9uXG5cdHJsb2NhbFByb3RvY29sID0gL14oPzphYm91dHxhcHB8YXBwLXN0b3JhZ2V8ListZXh0ZW5zaW9ufGZpbGV8cmVzfHdpZGdldCk6JC8sXG5cdHJub0NvbnRlbnQgPSAvXig/OkdFVHxIRUFEKSQvLFxuXHRycHJvdG9jb2wgPSAvXlxcL1xcLy8sXG5cdHJ1cmwgPSAvXihbXFx3ListXSs6KSg/OlxcL1xcLyg/OlteXFwvPyNdKkB8KShbXlxcLz8jOl0qKSg/OjooXFxkKyl8KXwpLyxcblxuXHQvKiBQcmVmaWx0ZXJzXG5cdCAqIDEpIFRoZXkgYXJlIHVzZWZ1bCB0byBpbnRyb2R1Y2UgY3VzdG9tIGRhdGFUeXBlcyAoc2VlIGFqYXgvanNvbnAuanMgZm9yIGFuIGV4YW1wbGUpXG5cdCAqIDIpIFRoZXNlIGFyZSBjYWxsZWQ6XG5cdCAqICAgIC0gQkVGT1JFIGFza2luZyBmb3IgYSB0cmFuc3BvcnRcblx0ICogICAgLSBBRlRFUiBwYXJhbSBzZXJpYWxpemF0aW9uIChzLmRhdGEgaXMgYSBzdHJpbmcgaWYgcy5wcm9jZXNzRGF0YSBpcyB0cnVlKVxuXHQgKiAzKSBrZXkgaXMgdGhlIGRhdGFUeXBlXG5cdCAqIDQpIHRoZSBjYXRjaGFsbCBzeW1ib2wgXCIqXCIgY2FuIGJlIHVzZWRcblx0ICogNSkgZXhlY3V0aW9uIHdpbGwgc3RhcnQgd2l0aCB0cmFuc3BvcnQgZGF0YVR5cGUgYW5kIFRIRU4gY29udGludWUgZG93biB0byBcIipcIiBpZiBuZWVkZWRcblx0ICovXG5cdHByZWZpbHRlcnMgPSB7fSxcblxuXHQvKiBUcmFuc3BvcnRzIGJpbmRpbmdzXG5cdCAqIDEpIGtleSBpcyB0aGUgZGF0YVR5cGVcblx0ICogMikgdGhlIGNhdGNoYWxsIHN5bWJvbCBcIipcIiBjYW4gYmUgdXNlZFxuXHQgKiAzKSBzZWxlY3Rpb24gd2lsbCBzdGFydCB3aXRoIHRyYW5zcG9ydCBkYXRhVHlwZSBhbmQgVEhFTiBnbyB0byBcIipcIiBpZiBuZWVkZWRcblx0ICovXG5cdHRyYW5zcG9ydHMgPSB7fSxcblxuXHQvLyBBdm9pZCBjb21tZW50LXByb2xvZyBjaGFyIHNlcXVlbmNlICgjMTAwOTgpOyBtdXN0IGFwcGVhc2UgbGludCBhbmQgZXZhZGUgY29tcHJlc3Npb25cblx0YWxsVHlwZXMgPSBcIiovXCIuY29uY2F0KCBcIipcIiApLFxuXG5cdC8vIERvY3VtZW50IGxvY2F0aW9uXG5cdGFqYXhMb2NhdGlvbiA9IHdpbmRvdy5sb2NhdGlvbi5ocmVmLFxuXG5cdC8vIFNlZ21lbnQgbG9jYXRpb24gaW50byBwYXJ0c1xuXHRhamF4TG9jUGFydHMgPSBydXJsLmV4ZWMoIGFqYXhMb2NhdGlvbi50b0xvd2VyQ2FzZSgpICkgfHwgW107XG5cbi8vIEJhc2UgXCJjb25zdHJ1Y3RvclwiIGZvciBqUXVlcnkuYWpheFByZWZpbHRlciBhbmQgalF1ZXJ5LmFqYXhUcmFuc3BvcnRcbmZ1bmN0aW9uIGFkZFRvUHJlZmlsdGVyc09yVHJhbnNwb3J0cyggc3RydWN0dXJlICkge1xuXG5cdC8vIGRhdGFUeXBlRXhwcmVzc2lvbiBpcyBvcHRpb25hbCBhbmQgZGVmYXVsdHMgdG8gXCIqXCJcblx0cmV0dXJuIGZ1bmN0aW9uKCBkYXRhVHlwZUV4cHJlc3Npb24sIGZ1bmMgKSB7XG5cblx0XHRpZiAoIHR5cGVvZiBkYXRhVHlwZUV4cHJlc3Npb24gIT09IFwic3RyaW5nXCIgKSB7XG5cdFx0XHRmdW5jID0gZGF0YVR5cGVFeHByZXNzaW9uO1xuXHRcdFx0ZGF0YVR5cGVFeHByZXNzaW9uID0gXCIqXCI7XG5cdFx0fVxuXG5cdFx0dmFyIGRhdGFUeXBlLFxuXHRcdFx0aSA9IDAsXG5cdFx0XHRkYXRhVHlwZXMgPSBkYXRhVHlwZUV4cHJlc3Npb24udG9Mb3dlckNhc2UoKS5tYXRjaCggcm5vdHdoaXRlICkgfHwgW107XG5cblx0XHRpZiAoIGpRdWVyeS5pc0Z1bmN0aW9uKCBmdW5jICkgKSB7XG5cdFx0XHQvLyBGb3IgZWFjaCBkYXRhVHlwZSBpbiB0aGUgZGF0YVR5cGVFeHByZXNzaW9uXG5cdFx0XHR3aGlsZSAoIChkYXRhVHlwZSA9IGRhdGFUeXBlc1tpKytdKSApIHtcblx0XHRcdFx0Ly8gUHJlcGVuZCBpZiByZXF1ZXN0ZWRcblx0XHRcdFx0aWYgKCBkYXRhVHlwZVswXSA9PT0gXCIrXCIgKSB7XG5cdFx0XHRcdFx0ZGF0YVR5cGUgPSBkYXRhVHlwZS5zbGljZSggMSApIHx8IFwiKlwiO1xuXHRcdFx0XHRcdChzdHJ1Y3R1cmVbIGRhdGFUeXBlIF0gPSBzdHJ1Y3R1cmVbIGRhdGFUeXBlIF0gfHwgW10pLnVuc2hpZnQoIGZ1bmMgKTtcblxuXHRcdFx0XHQvLyBPdGhlcndpc2UgYXBwZW5kXG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0KHN0cnVjdHVyZVsgZGF0YVR5cGUgXSA9IHN0cnVjdHVyZVsgZGF0YVR5cGUgXSB8fCBbXSkucHVzaCggZnVuYyApO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fVxuXHR9O1xufVxuXG4vLyBCYXNlIGluc3BlY3Rpb24gZnVuY3Rpb24gZm9yIHByZWZpbHRlcnMgYW5kIHRyYW5zcG9ydHNcbmZ1bmN0aW9uIGluc3BlY3RQcmVmaWx0ZXJzT3JUcmFuc3BvcnRzKCBzdHJ1Y3R1cmUsIG9wdGlvbnMsIG9yaWdpbmFsT3B0aW9ucywganFYSFIgKSB7XG5cblx0dmFyIGluc3BlY3RlZCA9IHt9LFxuXHRcdHNlZWtpbmdUcmFuc3BvcnQgPSAoIHN0cnVjdHVyZSA9PT0gdHJhbnNwb3J0cyApO1xuXG5cdGZ1bmN0aW9uIGluc3BlY3QoIGRhdGFUeXBlICkge1xuXHRcdHZhciBzZWxlY3RlZDtcblx0XHRpbnNwZWN0ZWRbIGRhdGFUeXBlIF0gPSB0cnVlO1xuXHRcdGpRdWVyeS5lYWNoKCBzdHJ1Y3R1cmVbIGRhdGFUeXBlIF0gfHwgW10sIGZ1bmN0aW9uKCBfLCBwcmVmaWx0ZXJPckZhY3RvcnkgKSB7XG5cdFx0XHR2YXIgZGF0YVR5cGVPclRyYW5zcG9ydCA9IHByZWZpbHRlck9yRmFjdG9yeSggb3B0aW9ucywgb3JpZ2luYWxPcHRpb25zLCBqcVhIUiApO1xuXHRcdFx0aWYgKCB0eXBlb2YgZGF0YVR5cGVPclRyYW5zcG9ydCA9PT0gXCJzdHJpbmdcIiAmJiAhc2Vla2luZ1RyYW5zcG9ydCAmJiAhaW5zcGVjdGVkWyBkYXRhVHlwZU9yVHJhbnNwb3J0IF0gKSB7XG5cdFx0XHRcdG9wdGlvbnMuZGF0YVR5cGVzLnVuc2hpZnQoIGRhdGFUeXBlT3JUcmFuc3BvcnQgKTtcblx0XHRcdFx0aW5zcGVjdCggZGF0YVR5cGVPclRyYW5zcG9ydCApO1xuXHRcdFx0XHRyZXR1cm4gZmFsc2U7XG5cdFx0XHR9IGVsc2UgaWYgKCBzZWVraW5nVHJhbnNwb3J0ICkge1xuXHRcdFx0XHRyZXR1cm4gISggc2VsZWN0ZWQgPSBkYXRhVHlwZU9yVHJhbnNwb3J0ICk7XG5cdFx0XHR9XG5cdFx0fSk7XG5cdFx0cmV0dXJuIHNlbGVjdGVkO1xuXHR9XG5cblx0cmV0dXJuIGluc3BlY3QoIG9wdGlvbnMuZGF0YVR5cGVzWyAwIF0gKSB8fCAhaW5zcGVjdGVkWyBcIipcIiBdICYmIGluc3BlY3QoIFwiKlwiICk7XG59XG5cbi8vIEEgc3BlY2lhbCBleHRlbmQgZm9yIGFqYXggb3B0aW9uc1xuLy8gdGhhdCB0YWtlcyBcImZsYXRcIiBvcHRpb25zIChub3QgdG8gYmUgZGVlcCBleHRlbmRlZClcbi8vIEZpeGVzICM5ODg3XG5mdW5jdGlvbiBhamF4RXh0ZW5kKCB0YXJnZXQsIHNyYyApIHtcblx0dmFyIGtleSwgZGVlcCxcblx0XHRmbGF0T3B0aW9ucyA9IGpRdWVyeS5hamF4U2V0dGluZ3MuZmxhdE9wdGlvbnMgfHwge307XG5cblx0Zm9yICgga2V5IGluIHNyYyApIHtcblx0XHRpZiAoIHNyY1sga2V5IF0gIT09IHVuZGVmaW5lZCApIHtcblx0XHRcdCggZmxhdE9wdGlvbnNbIGtleSBdID8gdGFyZ2V0IDogKCBkZWVwIHx8IChkZWVwID0ge30pICkgKVsga2V5IF0gPSBzcmNbIGtleSBdO1xuXHRcdH1cblx0fVxuXHRpZiAoIGRlZXAgKSB7XG5cdFx0alF1ZXJ5LmV4dGVuZCggdHJ1ZSwgdGFyZ2V0LCBkZWVwICk7XG5cdH1cblxuXHRyZXR1cm4gdGFyZ2V0O1xufVxuXG4vKiBIYW5kbGVzIHJlc3BvbnNlcyB0byBhbiBhamF4IHJlcXVlc3Q6XG4gKiAtIGZpbmRzIHRoZSByaWdodCBkYXRhVHlwZSAobWVkaWF0ZXMgYmV0d2VlbiBjb250ZW50LXR5cGUgYW5kIGV4cGVjdGVkIGRhdGFUeXBlKVxuICogLSByZXR1cm5zIHRoZSBjb3JyZXNwb25kaW5nIHJlc3BvbnNlXG4gKi9cbmZ1bmN0aW9uIGFqYXhIYW5kbGVSZXNwb25zZXMoIHMsIGpxWEhSLCByZXNwb25zZXMgKSB7XG5cblx0dmFyIGN0LCB0eXBlLCBmaW5hbERhdGFUeXBlLCBmaXJzdERhdGFUeXBlLFxuXHRcdGNvbnRlbnRzID0gcy5jb250ZW50cyxcblx0XHRkYXRhVHlwZXMgPSBzLmRhdGFUeXBlcztcblxuXHQvLyBSZW1vdmUgYXV0byBkYXRhVHlwZSBhbmQgZ2V0IGNvbnRlbnQtdHlwZSBpbiB0aGUgcHJvY2Vzc1xuXHR3aGlsZSAoIGRhdGFUeXBlc1sgMCBdID09PSBcIipcIiApIHtcblx0XHRkYXRhVHlwZXMuc2hpZnQoKTtcblx0XHRpZiAoIGN0ID09PSB1bmRlZmluZWQgKSB7XG5cdFx0XHRjdCA9IHMubWltZVR5cGUgfHwganFYSFIuZ2V0UmVzcG9uc2VIZWFkZXIoXCJDb250ZW50LVR5cGVcIik7XG5cdFx0fVxuXHR9XG5cblx0Ly8gQ2hlY2sgaWYgd2UncmUgZGVhbGluZyB3aXRoIGEga25vd24gY29udGVudC10eXBlXG5cdGlmICggY3QgKSB7XG5cdFx0Zm9yICggdHlwZSBpbiBjb250ZW50cyApIHtcblx0XHRcdGlmICggY29udGVudHNbIHR5cGUgXSAmJiBjb250ZW50c1sgdHlwZSBdLnRlc3QoIGN0ICkgKSB7XG5cdFx0XHRcdGRhdGFUeXBlcy51bnNoaWZ0KCB0eXBlICk7XG5cdFx0XHRcdGJyZWFrO1xuXHRcdFx0fVxuXHRcdH1cblx0fVxuXG5cdC8vIENoZWNrIHRvIHNlZSBpZiB3ZSBoYXZlIGEgcmVzcG9uc2UgZm9yIHRoZSBleHBlY3RlZCBkYXRhVHlwZVxuXHRpZiAoIGRhdGFUeXBlc1sgMCBdIGluIHJlc3BvbnNlcyApIHtcblx0XHRmaW5hbERhdGFUeXBlID0gZGF0YVR5cGVzWyAwIF07XG5cdH0gZWxzZSB7XG5cdFx0Ly8gVHJ5IGNvbnZlcnRpYmxlIGRhdGFUeXBlc1xuXHRcdGZvciAoIHR5cGUgaW4gcmVzcG9uc2VzICkge1xuXHRcdFx0aWYgKCAhZGF0YVR5cGVzWyAwIF0gfHwgcy5jb252ZXJ0ZXJzWyB0eXBlICsgXCIgXCIgKyBkYXRhVHlwZXNbMF0gXSApIHtcblx0XHRcdFx0ZmluYWxEYXRhVHlwZSA9IHR5cGU7XG5cdFx0XHRcdGJyZWFrO1xuXHRcdFx0fVxuXHRcdFx0aWYgKCAhZmlyc3REYXRhVHlwZSApIHtcblx0XHRcdFx0Zmlyc3REYXRhVHlwZSA9IHR5cGU7XG5cdFx0XHR9XG5cdFx0fVxuXHRcdC8vIE9yIGp1c3QgdXNlIGZpcnN0IG9uZVxuXHRcdGZpbmFsRGF0YVR5cGUgPSBmaW5hbERhdGFUeXBlIHx8IGZpcnN0RGF0YVR5cGU7XG5cdH1cblxuXHQvLyBJZiB3ZSBmb3VuZCBhIGRhdGFUeXBlXG5cdC8vIFdlIGFkZCB0aGUgZGF0YVR5cGUgdG8gdGhlIGxpc3QgaWYgbmVlZGVkXG5cdC8vIGFuZCByZXR1cm4gdGhlIGNvcnJlc3BvbmRpbmcgcmVzcG9uc2Vcblx0aWYgKCBmaW5hbERhdGFUeXBlICkge1xuXHRcdGlmICggZmluYWxEYXRhVHlwZSAhPT0gZGF0YVR5cGVzWyAwIF0gKSB7XG5cdFx0XHRkYXRhVHlwZXMudW5zaGlmdCggZmluYWxEYXRhVHlwZSApO1xuXHRcdH1cblx0XHRyZXR1cm4gcmVzcG9uc2VzWyBmaW5hbERhdGFUeXBlIF07XG5cdH1cbn1cblxuLyogQ2hhaW4gY29udmVyc2lvbnMgZ2l2ZW4gdGhlIHJlcXVlc3QgYW5kIHRoZSBvcmlnaW5hbCByZXNwb25zZVxuICogQWxzbyBzZXRzIHRoZSByZXNwb25zZVhYWCBmaWVsZHMgb24gdGhlIGpxWEhSIGluc3RhbmNlXG4gKi9cbmZ1bmN0aW9uIGFqYXhDb252ZXJ0KCBzLCByZXNwb25zZSwganFYSFIsIGlzU3VjY2VzcyApIHtcblx0dmFyIGNvbnYyLCBjdXJyZW50LCBjb252LCB0bXAsIHByZXYsXG5cdFx0Y29udmVydGVycyA9IHt9LFxuXHRcdC8vIFdvcmsgd2l0aCBhIGNvcHkgb2YgZGF0YVR5cGVzIGluIGNhc2Ugd2UgbmVlZCB0byBtb2RpZnkgaXQgZm9yIGNvbnZlcnNpb25cblx0XHRkYXRhVHlwZXMgPSBzLmRhdGFUeXBlcy5zbGljZSgpO1xuXG5cdC8vIENyZWF0ZSBjb252ZXJ0ZXJzIG1hcCB3aXRoIGxvd2VyY2FzZWQga2V5c1xuXHRpZiAoIGRhdGFUeXBlc1sgMSBdICkge1xuXHRcdGZvciAoIGNvbnYgaW4gcy5jb252ZXJ0ZXJzICkge1xuXHRcdFx0Y29udmVydGVyc1sgY29udi50b0xvd2VyQ2FzZSgpIF0gPSBzLmNvbnZlcnRlcnNbIGNvbnYgXTtcblx0XHR9XG5cdH1cblxuXHRjdXJyZW50ID0gZGF0YVR5cGVzLnNoaWZ0KCk7XG5cblx0Ly8gQ29udmVydCB0byBlYWNoIHNlcXVlbnRpYWwgZGF0YVR5cGVcblx0d2hpbGUgKCBjdXJyZW50ICkge1xuXG5cdFx0aWYgKCBzLnJlc3BvbnNlRmllbGRzWyBjdXJyZW50IF0gKSB7XG5cdFx0XHRqcVhIUlsgcy5yZXNwb25zZUZpZWxkc1sgY3VycmVudCBdIF0gPSByZXNwb25zZTtcblx0XHR9XG5cblx0XHQvLyBBcHBseSB0aGUgZGF0YUZpbHRlciBpZiBwcm92aWRlZFxuXHRcdGlmICggIXByZXYgJiYgaXNTdWNjZXNzICYmIHMuZGF0YUZpbHRlciApIHtcblx0XHRcdHJlc3BvbnNlID0gcy5kYXRhRmlsdGVyKCByZXNwb25zZSwgcy5kYXRhVHlwZSApO1xuXHRcdH1cblxuXHRcdHByZXYgPSBjdXJyZW50O1xuXHRcdGN1cnJlbnQgPSBkYXRhVHlwZXMuc2hpZnQoKTtcblxuXHRcdGlmICggY3VycmVudCApIHtcblxuXHRcdC8vIFRoZXJlJ3Mgb25seSB3b3JrIHRvIGRvIGlmIGN1cnJlbnQgZGF0YVR5cGUgaXMgbm9uLWF1dG9cblx0XHRcdGlmICggY3VycmVudCA9PT0gXCIqXCIgKSB7XG5cblx0XHRcdFx0Y3VycmVudCA9IHByZXY7XG5cblx0XHRcdC8vIENvbnZlcnQgcmVzcG9uc2UgaWYgcHJldiBkYXRhVHlwZSBpcyBub24tYXV0byBhbmQgZGlmZmVycyBmcm9tIGN1cnJlbnRcblx0XHRcdH0gZWxzZSBpZiAoIHByZXYgIT09IFwiKlwiICYmIHByZXYgIT09IGN1cnJlbnQgKSB7XG5cblx0XHRcdFx0Ly8gU2VlayBhIGRpcmVjdCBjb252ZXJ0ZXJcblx0XHRcdFx0Y29udiA9IGNvbnZlcnRlcnNbIHByZXYgKyBcIiBcIiArIGN1cnJlbnQgXSB8fCBjb252ZXJ0ZXJzWyBcIiogXCIgKyBjdXJyZW50IF07XG5cblx0XHRcdFx0Ly8gSWYgbm9uZSBmb3VuZCwgc2VlayBhIHBhaXJcblx0XHRcdFx0aWYgKCAhY29udiApIHtcblx0XHRcdFx0XHRmb3IgKCBjb252MiBpbiBjb252ZXJ0ZXJzICkge1xuXG5cdFx0XHRcdFx0XHQvLyBJZiBjb252MiBvdXRwdXRzIGN1cnJlbnRcblx0XHRcdFx0XHRcdHRtcCA9IGNvbnYyLnNwbGl0KCBcIiBcIiApO1xuXHRcdFx0XHRcdFx0aWYgKCB0bXBbIDEgXSA9PT0gY3VycmVudCApIHtcblxuXHRcdFx0XHRcdFx0XHQvLyBJZiBwcmV2IGNhbiBiZSBjb252ZXJ0ZWQgdG8gYWNjZXB0ZWQgaW5wdXRcblx0XHRcdFx0XHRcdFx0Y29udiA9IGNvbnZlcnRlcnNbIHByZXYgKyBcIiBcIiArIHRtcFsgMCBdIF0gfHxcblx0XHRcdFx0XHRcdFx0XHRjb252ZXJ0ZXJzWyBcIiogXCIgKyB0bXBbIDAgXSBdO1xuXHRcdFx0XHRcdFx0XHRpZiAoIGNvbnYgKSB7XG5cdFx0XHRcdFx0XHRcdFx0Ly8gQ29uZGVuc2UgZXF1aXZhbGVuY2UgY29udmVydGVyc1xuXHRcdFx0XHRcdFx0XHRcdGlmICggY29udiA9PT0gdHJ1ZSApIHtcblx0XHRcdFx0XHRcdFx0XHRcdGNvbnYgPSBjb252ZXJ0ZXJzWyBjb252MiBdO1xuXG5cdFx0XHRcdFx0XHRcdFx0Ly8gT3RoZXJ3aXNlLCBpbnNlcnQgdGhlIGludGVybWVkaWF0ZSBkYXRhVHlwZVxuXHRcdFx0XHRcdFx0XHRcdH0gZWxzZSBpZiAoIGNvbnZlcnRlcnNbIGNvbnYyIF0gIT09IHRydWUgKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRjdXJyZW50ID0gdG1wWyAwIF07XG5cdFx0XHRcdFx0XHRcdFx0XHRkYXRhVHlwZXMudW5zaGlmdCggdG1wWyAxIF0gKTtcblx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblxuXHRcdFx0XHQvLyBBcHBseSBjb252ZXJ0ZXIgKGlmIG5vdCBhbiBlcXVpdmFsZW5jZSlcblx0XHRcdFx0aWYgKCBjb252ICE9PSB0cnVlICkge1xuXG5cdFx0XHRcdFx0Ly8gVW5sZXNzIGVycm9ycyBhcmUgYWxsb3dlZCB0byBidWJibGUsIGNhdGNoIGFuZCByZXR1cm4gdGhlbVxuXHRcdFx0XHRcdGlmICggY29udiAmJiBzWyBcInRocm93c1wiIF0gKSB7XG5cdFx0XHRcdFx0XHRyZXNwb25zZSA9IGNvbnYoIHJlc3BvbnNlICk7XG5cdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdHRyeSB7XG5cdFx0XHRcdFx0XHRcdHJlc3BvbnNlID0gY29udiggcmVzcG9uc2UgKTtcblx0XHRcdFx0XHRcdH0gY2F0Y2ggKCBlICkge1xuXHRcdFx0XHRcdFx0XHRyZXR1cm4geyBzdGF0ZTogXCJwYXJzZXJlcnJvclwiLCBlcnJvcjogY29udiA/IGUgOiBcIk5vIGNvbnZlcnNpb24gZnJvbSBcIiArIHByZXYgKyBcIiB0byBcIiArIGN1cnJlbnQgfTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9XG5cdH1cblxuXHRyZXR1cm4geyBzdGF0ZTogXCJzdWNjZXNzXCIsIGRhdGE6IHJlc3BvbnNlIH07XG59XG5cbmpRdWVyeS5leHRlbmQoe1xuXG5cdC8vIENvdW50ZXIgZm9yIGhvbGRpbmcgdGhlIG51bWJlciBvZiBhY3RpdmUgcXVlcmllc1xuXHRhY3RpdmU6IDAsXG5cblx0Ly8gTGFzdC1Nb2RpZmllZCBoZWFkZXIgY2FjaGUgZm9yIG5leHQgcmVxdWVzdFxuXHRsYXN0TW9kaWZpZWQ6IHt9LFxuXHRldGFnOiB7fSxcblxuXHRhamF4U2V0dGluZ3M6IHtcblx0XHR1cmw6IGFqYXhMb2NhdGlvbixcblx0XHR0eXBlOiBcIkdFVFwiLFxuXHRcdGlzTG9jYWw6IHJsb2NhbFByb3RvY29sLnRlc3QoIGFqYXhMb2NQYXJ0c1sgMSBdICksXG5cdFx0Z2xvYmFsOiB0cnVlLFxuXHRcdHByb2Nlc3NEYXRhOiB0cnVlLFxuXHRcdGFzeW5jOiB0cnVlLFxuXHRcdGNvbnRlbnRUeXBlOiBcImFwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZDsgY2hhcnNldD1VVEYtOFwiLFxuXHRcdC8qXG5cdFx0dGltZW91dDogMCxcblx0XHRkYXRhOiBudWxsLFxuXHRcdGRhdGFUeXBlOiBudWxsLFxuXHRcdHVzZXJuYW1lOiBudWxsLFxuXHRcdHBhc3N3b3JkOiBudWxsLFxuXHRcdGNhY2hlOiBudWxsLFxuXHRcdHRocm93czogZmFsc2UsXG5cdFx0dHJhZGl0aW9uYWw6IGZhbHNlLFxuXHRcdGhlYWRlcnM6IHt9LFxuXHRcdCovXG5cblx0XHRhY2NlcHRzOiB7XG5cdFx0XHRcIipcIjogYWxsVHlwZXMsXG5cdFx0XHR0ZXh0OiBcInRleHQvcGxhaW5cIixcblx0XHRcdGh0bWw6IFwidGV4dC9odG1sXCIsXG5cdFx0XHR4bWw6IFwiYXBwbGljYXRpb24veG1sLCB0ZXh0L3htbFwiLFxuXHRcdFx0anNvbjogXCJhcHBsaWNhdGlvbi9qc29uLCB0ZXh0L2phdmFzY3JpcHRcIlxuXHRcdH0sXG5cblx0XHRjb250ZW50czoge1xuXHRcdFx0eG1sOiAveG1sLyxcblx0XHRcdGh0bWw6IC9odG1sLyxcblx0XHRcdGpzb246IC9qc29uL1xuXHRcdH0sXG5cblx0XHRyZXNwb25zZUZpZWxkczoge1xuXHRcdFx0eG1sOiBcInJlc3BvbnNlWE1MXCIsXG5cdFx0XHR0ZXh0OiBcInJlc3BvbnNlVGV4dFwiLFxuXHRcdFx0anNvbjogXCJyZXNwb25zZUpTT05cIlxuXHRcdH0sXG5cblx0XHQvLyBEYXRhIGNvbnZlcnRlcnNcblx0XHQvLyBLZXlzIHNlcGFyYXRlIHNvdXJjZSAob3IgY2F0Y2hhbGwgXCIqXCIpIGFuZCBkZXN0aW5hdGlvbiB0eXBlcyB3aXRoIGEgc2luZ2xlIHNwYWNlXG5cdFx0Y29udmVydGVyczoge1xuXG5cdFx0XHQvLyBDb252ZXJ0IGFueXRoaW5nIHRvIHRleHRcblx0XHRcdFwiKiB0ZXh0XCI6IFN0cmluZyxcblxuXHRcdFx0Ly8gVGV4dCB0byBodG1sICh0cnVlID0gbm8gdHJhbnNmb3JtYXRpb24pXG5cdFx0XHRcInRleHQgaHRtbFwiOiB0cnVlLFxuXG5cdFx0XHQvLyBFdmFsdWF0ZSB0ZXh0IGFzIGEganNvbiBleHByZXNzaW9uXG5cdFx0XHRcInRleHQganNvblwiOiBqUXVlcnkucGFyc2VKU09OLFxuXG5cdFx0XHQvLyBQYXJzZSB0ZXh0IGFzIHhtbFxuXHRcdFx0XCJ0ZXh0IHhtbFwiOiBqUXVlcnkucGFyc2VYTUxcblx0XHR9LFxuXG5cdFx0Ly8gRm9yIG9wdGlvbnMgdGhhdCBzaG91bGRuJ3QgYmUgZGVlcCBleHRlbmRlZDpcblx0XHQvLyB5b3UgY2FuIGFkZCB5b3VyIG93biBjdXN0b20gb3B0aW9ucyBoZXJlIGlmXG5cdFx0Ly8gYW5kIHdoZW4geW91IGNyZWF0ZSBvbmUgdGhhdCBzaG91bGRuJ3QgYmVcblx0XHQvLyBkZWVwIGV4dGVuZGVkIChzZWUgYWpheEV4dGVuZClcblx0XHRmbGF0T3B0aW9uczoge1xuXHRcdFx0dXJsOiB0cnVlLFxuXHRcdFx0Y29udGV4dDogdHJ1ZVxuXHRcdH1cblx0fSxcblxuXHQvLyBDcmVhdGVzIGEgZnVsbCBmbGVkZ2VkIHNldHRpbmdzIG9iamVjdCBpbnRvIHRhcmdldFxuXHQvLyB3aXRoIGJvdGggYWpheFNldHRpbmdzIGFuZCBzZXR0aW5ncyBmaWVsZHMuXG5cdC8vIElmIHRhcmdldCBpcyBvbWl0dGVkLCB3cml0ZXMgaW50byBhamF4U2V0dGluZ3MuXG5cdGFqYXhTZXR1cDogZnVuY3Rpb24oIHRhcmdldCwgc2V0dGluZ3MgKSB7XG5cdFx0cmV0dXJuIHNldHRpbmdzID9cblxuXHRcdFx0Ly8gQnVpbGRpbmcgYSBzZXR0aW5ncyBvYmplY3Rcblx0XHRcdGFqYXhFeHRlbmQoIGFqYXhFeHRlbmQoIHRhcmdldCwgalF1ZXJ5LmFqYXhTZXR0aW5ncyApLCBzZXR0aW5ncyApIDpcblxuXHRcdFx0Ly8gRXh0ZW5kaW5nIGFqYXhTZXR0aW5nc1xuXHRcdFx0YWpheEV4dGVuZCggalF1ZXJ5LmFqYXhTZXR0aW5ncywgdGFyZ2V0ICk7XG5cdH0sXG5cblx0YWpheFByZWZpbHRlcjogYWRkVG9QcmVmaWx0ZXJzT3JUcmFuc3BvcnRzKCBwcmVmaWx0ZXJzICksXG5cdGFqYXhUcmFuc3BvcnQ6IGFkZFRvUHJlZmlsdGVyc09yVHJhbnNwb3J0cyggdHJhbnNwb3J0cyApLFxuXG5cdC8vIE1haW4gbWV0aG9kXG5cdGFqYXg6IGZ1bmN0aW9uKCB1cmwsIG9wdGlvbnMgKSB7XG5cblx0XHQvLyBJZiB1cmwgaXMgYW4gb2JqZWN0LCBzaW11bGF0ZSBwcmUtMS41IHNpZ25hdHVyZVxuXHRcdGlmICggdHlwZW9mIHVybCA9PT0gXCJvYmplY3RcIiApIHtcblx0XHRcdG9wdGlvbnMgPSB1cmw7XG5cdFx0XHR1cmwgPSB1bmRlZmluZWQ7XG5cdFx0fVxuXG5cdFx0Ly8gRm9yY2Ugb3B0aW9ucyB0byBiZSBhbiBvYmplY3Rcblx0XHRvcHRpb25zID0gb3B0aW9ucyB8fCB7fTtcblxuXHRcdHZhciB0cmFuc3BvcnQsXG5cdFx0XHQvLyBVUkwgd2l0aG91dCBhbnRpLWNhY2hlIHBhcmFtXG5cdFx0XHRjYWNoZVVSTCxcblx0XHRcdC8vIFJlc3BvbnNlIGhlYWRlcnNcblx0XHRcdHJlc3BvbnNlSGVhZGVyc1N0cmluZyxcblx0XHRcdHJlc3BvbnNlSGVhZGVycyxcblx0XHRcdC8vIHRpbWVvdXQgaGFuZGxlXG5cdFx0XHR0aW1lb3V0VGltZXIsXG5cdFx0XHQvLyBDcm9zcy1kb21haW4gZGV0ZWN0aW9uIHZhcnNcblx0XHRcdHBhcnRzLFxuXHRcdFx0Ly8gVG8ga25vdyBpZiBnbG9iYWwgZXZlbnRzIGFyZSB0byBiZSBkaXNwYXRjaGVkXG5cdFx0XHRmaXJlR2xvYmFscyxcblx0XHRcdC8vIExvb3AgdmFyaWFibGVcblx0XHRcdGksXG5cdFx0XHQvLyBDcmVhdGUgdGhlIGZpbmFsIG9wdGlvbnMgb2JqZWN0XG5cdFx0XHRzID0galF1ZXJ5LmFqYXhTZXR1cCgge30sIG9wdGlvbnMgKSxcblx0XHRcdC8vIENhbGxiYWNrcyBjb250ZXh0XG5cdFx0XHRjYWxsYmFja0NvbnRleHQgPSBzLmNvbnRleHQgfHwgcyxcblx0XHRcdC8vIENvbnRleHQgZm9yIGdsb2JhbCBldmVudHMgaXMgY2FsbGJhY2tDb250ZXh0IGlmIGl0IGlzIGEgRE9NIG5vZGUgb3IgalF1ZXJ5IGNvbGxlY3Rpb25cblx0XHRcdGdsb2JhbEV2ZW50Q29udGV4dCA9IHMuY29udGV4dCAmJiAoIGNhbGxiYWNrQ29udGV4dC5ub2RlVHlwZSB8fCBjYWxsYmFja0NvbnRleHQuanF1ZXJ5ICkgP1xuXHRcdFx0XHRqUXVlcnkoIGNhbGxiYWNrQ29udGV4dCApIDpcblx0XHRcdFx0alF1ZXJ5LmV2ZW50LFxuXHRcdFx0Ly8gRGVmZXJyZWRzXG5cdFx0XHRkZWZlcnJlZCA9IGpRdWVyeS5EZWZlcnJlZCgpLFxuXHRcdFx0Y29tcGxldGVEZWZlcnJlZCA9IGpRdWVyeS5DYWxsYmFja3MoXCJvbmNlIG1lbW9yeVwiKSxcblx0XHRcdC8vIFN0YXR1cy1kZXBlbmRlbnQgY2FsbGJhY2tzXG5cdFx0XHRzdGF0dXNDb2RlID0gcy5zdGF0dXNDb2RlIHx8IHt9LFxuXHRcdFx0Ly8gSGVhZGVycyAodGhleSBhcmUgc2VudCBhbGwgYXQgb25jZSlcblx0XHRcdHJlcXVlc3RIZWFkZXJzID0ge30sXG5cdFx0XHRyZXF1ZXN0SGVhZGVyc05hbWVzID0ge30sXG5cdFx0XHQvLyBUaGUganFYSFIgc3RhdGVcblx0XHRcdHN0YXRlID0gMCxcblx0XHRcdC8vIERlZmF1bHQgYWJvcnQgbWVzc2FnZVxuXHRcdFx0c3RyQWJvcnQgPSBcImNhbmNlbGVkXCIsXG5cdFx0XHQvLyBGYWtlIHhoclxuXHRcdFx0anFYSFIgPSB7XG5cdFx0XHRcdHJlYWR5U3RhdGU6IDAsXG5cblx0XHRcdFx0Ly8gQnVpbGRzIGhlYWRlcnMgaGFzaHRhYmxlIGlmIG5lZWRlZFxuXHRcdFx0XHRnZXRSZXNwb25zZUhlYWRlcjogZnVuY3Rpb24oIGtleSApIHtcblx0XHRcdFx0XHR2YXIgbWF0Y2g7XG5cdFx0XHRcdFx0aWYgKCBzdGF0ZSA9PT0gMiApIHtcblx0XHRcdFx0XHRcdGlmICggIXJlc3BvbnNlSGVhZGVycyApIHtcblx0XHRcdFx0XHRcdFx0cmVzcG9uc2VIZWFkZXJzID0ge307XG5cdFx0XHRcdFx0XHRcdHdoaWxlICggKG1hdGNoID0gcmhlYWRlcnMuZXhlYyggcmVzcG9uc2VIZWFkZXJzU3RyaW5nICkpICkge1xuXHRcdFx0XHRcdFx0XHRcdHJlc3BvbnNlSGVhZGVyc1sgbWF0Y2hbMV0udG9Mb3dlckNhc2UoKSBdID0gbWF0Y2hbIDIgXTtcblx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0bWF0Y2ggPSByZXNwb25zZUhlYWRlcnNbIGtleS50b0xvd2VyQ2FzZSgpIF07XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdHJldHVybiBtYXRjaCA9PSBudWxsID8gbnVsbCA6IG1hdGNoO1xuXHRcdFx0XHR9LFxuXG5cdFx0XHRcdC8vIFJhdyBzdHJpbmdcblx0XHRcdFx0Z2V0QWxsUmVzcG9uc2VIZWFkZXJzOiBmdW5jdGlvbigpIHtcblx0XHRcdFx0XHRyZXR1cm4gc3RhdGUgPT09IDIgPyByZXNwb25zZUhlYWRlcnNTdHJpbmcgOiBudWxsO1xuXHRcdFx0XHR9LFxuXG5cdFx0XHRcdC8vIENhY2hlcyB0aGUgaGVhZGVyXG5cdFx0XHRcdHNldFJlcXVlc3RIZWFkZXI6IGZ1bmN0aW9uKCBuYW1lLCB2YWx1ZSApIHtcblx0XHRcdFx0XHR2YXIgbG5hbWUgPSBuYW1lLnRvTG93ZXJDYXNlKCk7XG5cdFx0XHRcdFx0aWYgKCAhc3RhdGUgKSB7XG5cdFx0XHRcdFx0XHRuYW1lID0gcmVxdWVzdEhlYWRlcnNOYW1lc1sgbG5hbWUgXSA9IHJlcXVlc3RIZWFkZXJzTmFtZXNbIGxuYW1lIF0gfHwgbmFtZTtcblx0XHRcdFx0XHRcdHJlcXVlc3RIZWFkZXJzWyBuYW1lIF0gPSB2YWx1ZTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0cmV0dXJuIHRoaXM7XG5cdFx0XHRcdH0sXG5cblx0XHRcdFx0Ly8gT3ZlcnJpZGVzIHJlc3BvbnNlIGNvbnRlbnQtdHlwZSBoZWFkZXJcblx0XHRcdFx0b3ZlcnJpZGVNaW1lVHlwZTogZnVuY3Rpb24oIHR5cGUgKSB7XG5cdFx0XHRcdFx0aWYgKCAhc3RhdGUgKSB7XG5cdFx0XHRcdFx0XHRzLm1pbWVUeXBlID0gdHlwZTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0cmV0dXJuIHRoaXM7XG5cdFx0XHRcdH0sXG5cblx0XHRcdFx0Ly8gU3RhdHVzLWRlcGVuZGVudCBjYWxsYmFja3Ncblx0XHRcdFx0c3RhdHVzQ29kZTogZnVuY3Rpb24oIG1hcCApIHtcblx0XHRcdFx0XHR2YXIgY29kZTtcblx0XHRcdFx0XHRpZiAoIG1hcCApIHtcblx0XHRcdFx0XHRcdGlmICggc3RhdGUgPCAyICkge1xuXHRcdFx0XHRcdFx0XHRmb3IgKCBjb2RlIGluIG1hcCApIHtcblx0XHRcdFx0XHRcdFx0XHQvLyBMYXp5LWFkZCB0aGUgbmV3IGNhbGxiYWNrIGluIGEgd2F5IHRoYXQgcHJlc2VydmVzIG9sZCBvbmVzXG5cdFx0XHRcdFx0XHRcdFx0c3RhdHVzQ29kZVsgY29kZSBdID0gWyBzdGF0dXNDb2RlWyBjb2RlIF0sIG1hcFsgY29kZSBdIF07XG5cdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHRcdC8vIEV4ZWN1dGUgdGhlIGFwcHJvcHJpYXRlIGNhbGxiYWNrc1xuXHRcdFx0XHRcdFx0XHRqcVhIUi5hbHdheXMoIG1hcFsganFYSFIuc3RhdHVzIF0gKTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0cmV0dXJuIHRoaXM7XG5cdFx0XHRcdH0sXG5cblx0XHRcdFx0Ly8gQ2FuY2VsIHRoZSByZXF1ZXN0XG5cdFx0XHRcdGFib3J0OiBmdW5jdGlvbiggc3RhdHVzVGV4dCApIHtcblx0XHRcdFx0XHR2YXIgZmluYWxUZXh0ID0gc3RhdHVzVGV4dCB8fCBzdHJBYm9ydDtcblx0XHRcdFx0XHRpZiAoIHRyYW5zcG9ydCApIHtcblx0XHRcdFx0XHRcdHRyYW5zcG9ydC5hYm9ydCggZmluYWxUZXh0ICk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdGRvbmUoIDAsIGZpbmFsVGV4dCApO1xuXHRcdFx0XHRcdHJldHVybiB0aGlzO1xuXHRcdFx0XHR9XG5cdFx0XHR9O1xuXG5cdFx0Ly8gQXR0YWNoIGRlZmVycmVkc1xuXHRcdGRlZmVycmVkLnByb21pc2UoIGpxWEhSICkuY29tcGxldGUgPSBjb21wbGV0ZURlZmVycmVkLmFkZDtcblx0XHRqcVhIUi5zdWNjZXNzID0ganFYSFIuZG9uZTtcblx0XHRqcVhIUi5lcnJvciA9IGpxWEhSLmZhaWw7XG5cblx0XHQvLyBSZW1vdmUgaGFzaCBjaGFyYWN0ZXIgKCM3NTMxOiBhbmQgc3RyaW5nIHByb21vdGlvbilcblx0XHQvLyBBZGQgcHJvdG9jb2wgaWYgbm90IHByb3ZpZGVkIChwcmVmaWx0ZXJzIG1pZ2h0IGV4cGVjdCBpdClcblx0XHQvLyBIYW5kbGUgZmFsc3kgdXJsIGluIHRoZSBzZXR0aW5ncyBvYmplY3QgKCMxMDA5MzogY29uc2lzdGVuY3kgd2l0aCBvbGQgc2lnbmF0dXJlKVxuXHRcdC8vIFdlIGFsc28gdXNlIHRoZSB1cmwgcGFyYW1ldGVyIGlmIGF2YWlsYWJsZVxuXHRcdHMudXJsID0gKCAoIHVybCB8fCBzLnVybCB8fCBhamF4TG9jYXRpb24gKSArIFwiXCIgKS5yZXBsYWNlKCByaGFzaCwgXCJcIiApXG5cdFx0XHQucmVwbGFjZSggcnByb3RvY29sLCBhamF4TG9jUGFydHNbIDEgXSArIFwiLy9cIiApO1xuXG5cdFx0Ly8gQWxpYXMgbWV0aG9kIG9wdGlvbiB0byB0eXBlIGFzIHBlciB0aWNrZXQgIzEyMDA0XG5cdFx0cy50eXBlID0gb3B0aW9ucy5tZXRob2QgfHwgb3B0aW9ucy50eXBlIHx8IHMubWV0aG9kIHx8IHMudHlwZTtcblxuXHRcdC8vIEV4dHJhY3QgZGF0YVR5cGVzIGxpc3Rcblx0XHRzLmRhdGFUeXBlcyA9IGpRdWVyeS50cmltKCBzLmRhdGFUeXBlIHx8IFwiKlwiICkudG9Mb3dlckNhc2UoKS5tYXRjaCggcm5vdHdoaXRlICkgfHwgWyBcIlwiIF07XG5cblx0XHQvLyBBIGNyb3NzLWRvbWFpbiByZXF1ZXN0IGlzIGluIG9yZGVyIHdoZW4gd2UgaGF2ZSBhIHByb3RvY29sOmhvc3Q6cG9ydCBtaXNtYXRjaFxuXHRcdGlmICggcy5jcm9zc0RvbWFpbiA9PSBudWxsICkge1xuXHRcdFx0cGFydHMgPSBydXJsLmV4ZWMoIHMudXJsLnRvTG93ZXJDYXNlKCkgKTtcblx0XHRcdHMuY3Jvc3NEb21haW4gPSAhISggcGFydHMgJiZcblx0XHRcdFx0KCBwYXJ0c1sgMSBdICE9PSBhamF4TG9jUGFydHNbIDEgXSB8fCBwYXJ0c1sgMiBdICE9PSBhamF4TG9jUGFydHNbIDIgXSB8fFxuXHRcdFx0XHRcdCggcGFydHNbIDMgXSB8fCAoIHBhcnRzWyAxIF0gPT09IFwiaHR0cDpcIiA/IFwiODBcIiA6IFwiNDQzXCIgKSApICE9PVxuXHRcdFx0XHRcdFx0KCBhamF4TG9jUGFydHNbIDMgXSB8fCAoIGFqYXhMb2NQYXJ0c1sgMSBdID09PSBcImh0dHA6XCIgPyBcIjgwXCIgOiBcIjQ0M1wiICkgKSApXG5cdFx0XHQpO1xuXHRcdH1cblxuXHRcdC8vIENvbnZlcnQgZGF0YSBpZiBub3QgYWxyZWFkeSBhIHN0cmluZ1xuXHRcdGlmICggcy5kYXRhICYmIHMucHJvY2Vzc0RhdGEgJiYgdHlwZW9mIHMuZGF0YSAhPT0gXCJzdHJpbmdcIiApIHtcblx0XHRcdHMuZGF0YSA9IGpRdWVyeS5wYXJhbSggcy5kYXRhLCBzLnRyYWRpdGlvbmFsICk7XG5cdFx0fVxuXG5cdFx0Ly8gQXBwbHkgcHJlZmlsdGVyc1xuXHRcdGluc3BlY3RQcmVmaWx0ZXJzT3JUcmFuc3BvcnRzKCBwcmVmaWx0ZXJzLCBzLCBvcHRpb25zLCBqcVhIUiApO1xuXG5cdFx0Ly8gSWYgcmVxdWVzdCB3YXMgYWJvcnRlZCBpbnNpZGUgYSBwcmVmaWx0ZXIsIHN0b3AgdGhlcmVcblx0XHRpZiAoIHN0YXRlID09PSAyICkge1xuXHRcdFx0cmV0dXJuIGpxWEhSO1xuXHRcdH1cblxuXHRcdC8vIFdlIGNhbiBmaXJlIGdsb2JhbCBldmVudHMgYXMgb2Ygbm93IGlmIGFza2VkIHRvXG5cdFx0Ly8gRG9uJ3QgZmlyZSBldmVudHMgaWYgalF1ZXJ5LmV2ZW50IGlzIHVuZGVmaW5lZCBpbiBhbiBBTUQtdXNhZ2Ugc2NlbmFyaW8gKCMxNTExOClcblx0XHRmaXJlR2xvYmFscyA9IGpRdWVyeS5ldmVudCAmJiBzLmdsb2JhbDtcblxuXHRcdC8vIFdhdGNoIGZvciBhIG5ldyBzZXQgb2YgcmVxdWVzdHNcblx0XHRpZiAoIGZpcmVHbG9iYWxzICYmIGpRdWVyeS5hY3RpdmUrKyA9PT0gMCApIHtcblx0XHRcdGpRdWVyeS5ldmVudC50cmlnZ2VyKFwiYWpheFN0YXJ0XCIpO1xuXHRcdH1cblxuXHRcdC8vIFVwcGVyY2FzZSB0aGUgdHlwZVxuXHRcdHMudHlwZSA9IHMudHlwZS50b1VwcGVyQ2FzZSgpO1xuXG5cdFx0Ly8gRGV0ZXJtaW5lIGlmIHJlcXVlc3QgaGFzIGNvbnRlbnRcblx0XHRzLmhhc0NvbnRlbnQgPSAhcm5vQ29udGVudC50ZXN0KCBzLnR5cGUgKTtcblxuXHRcdC8vIFNhdmUgdGhlIFVSTCBpbiBjYXNlIHdlJ3JlIHRveWluZyB3aXRoIHRoZSBJZi1Nb2RpZmllZC1TaW5jZVxuXHRcdC8vIGFuZC9vciBJZi1Ob25lLU1hdGNoIGhlYWRlciBsYXRlciBvblxuXHRcdGNhY2hlVVJMID0gcy51cmw7XG5cblx0XHQvLyBNb3JlIG9wdGlvbnMgaGFuZGxpbmcgZm9yIHJlcXVlc3RzIHdpdGggbm8gY29udGVudFxuXHRcdGlmICggIXMuaGFzQ29udGVudCApIHtcblxuXHRcdFx0Ly8gSWYgZGF0YSBpcyBhdmFpbGFibGUsIGFwcGVuZCBkYXRhIHRvIHVybFxuXHRcdFx0aWYgKCBzLmRhdGEgKSB7XG5cdFx0XHRcdGNhY2hlVVJMID0gKCBzLnVybCArPSAoIHJxdWVyeS50ZXN0KCBjYWNoZVVSTCApID8gXCImXCIgOiBcIj9cIiApICsgcy5kYXRhICk7XG5cdFx0XHRcdC8vICM5NjgyOiByZW1vdmUgZGF0YSBzbyB0aGF0IGl0J3Mgbm90IHVzZWQgaW4gYW4gZXZlbnR1YWwgcmV0cnlcblx0XHRcdFx0ZGVsZXRlIHMuZGF0YTtcblx0XHRcdH1cblxuXHRcdFx0Ly8gQWRkIGFudGktY2FjaGUgaW4gdXJsIGlmIG5lZWRlZFxuXHRcdFx0aWYgKCBzLmNhY2hlID09PSBmYWxzZSApIHtcblx0XHRcdFx0cy51cmwgPSBydHMudGVzdCggY2FjaGVVUkwgKSA/XG5cblx0XHRcdFx0XHQvLyBJZiB0aGVyZSBpcyBhbHJlYWR5IGEgJ18nIHBhcmFtZXRlciwgc2V0IGl0cyB2YWx1ZVxuXHRcdFx0XHRcdGNhY2hlVVJMLnJlcGxhY2UoIHJ0cywgXCIkMV89XCIgKyBub25jZSsrICkgOlxuXG5cdFx0XHRcdFx0Ly8gT3RoZXJ3aXNlIGFkZCBvbmUgdG8gdGhlIGVuZFxuXHRcdFx0XHRcdGNhY2hlVVJMICsgKCBycXVlcnkudGVzdCggY2FjaGVVUkwgKSA/IFwiJlwiIDogXCI/XCIgKSArIFwiXz1cIiArIG5vbmNlKys7XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0Ly8gU2V0IHRoZSBJZi1Nb2RpZmllZC1TaW5jZSBhbmQvb3IgSWYtTm9uZS1NYXRjaCBoZWFkZXIsIGlmIGluIGlmTW9kaWZpZWQgbW9kZS5cblx0XHRpZiAoIHMuaWZNb2RpZmllZCApIHtcblx0XHRcdGlmICggalF1ZXJ5Lmxhc3RNb2RpZmllZFsgY2FjaGVVUkwgXSApIHtcblx0XHRcdFx0anFYSFIuc2V0UmVxdWVzdEhlYWRlciggXCJJZi1Nb2RpZmllZC1TaW5jZVwiLCBqUXVlcnkubGFzdE1vZGlmaWVkWyBjYWNoZVVSTCBdICk7XG5cdFx0XHR9XG5cdFx0XHRpZiAoIGpRdWVyeS5ldGFnWyBjYWNoZVVSTCBdICkge1xuXHRcdFx0XHRqcVhIUi5zZXRSZXF1ZXN0SGVhZGVyKCBcIklmLU5vbmUtTWF0Y2hcIiwgalF1ZXJ5LmV0YWdbIGNhY2hlVVJMIF0gKTtcblx0XHRcdH1cblx0XHR9XG5cblx0XHQvLyBTZXQgdGhlIGNvcnJlY3QgaGVhZGVyLCBpZiBkYXRhIGlzIGJlaW5nIHNlbnRcblx0XHRpZiAoIHMuZGF0YSAmJiBzLmhhc0NvbnRlbnQgJiYgcy5jb250ZW50VHlwZSAhPT0gZmFsc2UgfHwgb3B0aW9ucy5jb250ZW50VHlwZSApIHtcblx0XHRcdGpxWEhSLnNldFJlcXVlc3RIZWFkZXIoIFwiQ29udGVudC1UeXBlXCIsIHMuY29udGVudFR5cGUgKTtcblx0XHR9XG5cblx0XHQvLyBTZXQgdGhlIEFjY2VwdHMgaGVhZGVyIGZvciB0aGUgc2VydmVyLCBkZXBlbmRpbmcgb24gdGhlIGRhdGFUeXBlXG5cdFx0anFYSFIuc2V0UmVxdWVzdEhlYWRlcihcblx0XHRcdFwiQWNjZXB0XCIsXG5cdFx0XHRzLmRhdGFUeXBlc1sgMCBdICYmIHMuYWNjZXB0c1sgcy5kYXRhVHlwZXNbMF0gXSA/XG5cdFx0XHRcdHMuYWNjZXB0c1sgcy5kYXRhVHlwZXNbMF0gXSArICggcy5kYXRhVHlwZXNbIDAgXSAhPT0gXCIqXCIgPyBcIiwgXCIgKyBhbGxUeXBlcyArIFwiOyBxPTAuMDFcIiA6IFwiXCIgKSA6XG5cdFx0XHRcdHMuYWNjZXB0c1sgXCIqXCIgXVxuXHRcdCk7XG5cblx0XHQvLyBDaGVjayBmb3IgaGVhZGVycyBvcHRpb25cblx0XHRmb3IgKCBpIGluIHMuaGVhZGVycyApIHtcblx0XHRcdGpxWEhSLnNldFJlcXVlc3RIZWFkZXIoIGksIHMuaGVhZGVyc1sgaSBdICk7XG5cdFx0fVxuXG5cdFx0Ly8gQWxsb3cgY3VzdG9tIGhlYWRlcnMvbWltZXR5cGVzIGFuZCBlYXJseSBhYm9ydFxuXHRcdGlmICggcy5iZWZvcmVTZW5kICYmICggcy5iZWZvcmVTZW5kLmNhbGwoIGNhbGxiYWNrQ29udGV4dCwganFYSFIsIHMgKSA9PT0gZmFsc2UgfHwgc3RhdGUgPT09IDIgKSApIHtcblx0XHRcdC8vIEFib3J0IGlmIG5vdCBkb25lIGFscmVhZHkgYW5kIHJldHVyblxuXHRcdFx0cmV0dXJuIGpxWEhSLmFib3J0KCk7XG5cdFx0fVxuXG5cdFx0Ly8gQWJvcnRpbmcgaXMgbm8gbG9uZ2VyIGEgY2FuY2VsbGF0aW9uXG5cdFx0c3RyQWJvcnQgPSBcImFib3J0XCI7XG5cblx0XHQvLyBJbnN0YWxsIGNhbGxiYWNrcyBvbiBkZWZlcnJlZHNcblx0XHRmb3IgKCBpIGluIHsgc3VjY2VzczogMSwgZXJyb3I6IDEsIGNvbXBsZXRlOiAxIH0gKSB7XG5cdFx0XHRqcVhIUlsgaSBdKCBzWyBpIF0gKTtcblx0XHR9XG5cblx0XHQvLyBHZXQgdHJhbnNwb3J0XG5cdFx0dHJhbnNwb3J0ID0gaW5zcGVjdFByZWZpbHRlcnNPclRyYW5zcG9ydHMoIHRyYW5zcG9ydHMsIHMsIG9wdGlvbnMsIGpxWEhSICk7XG5cblx0XHQvLyBJZiBubyB0cmFuc3BvcnQsIHdlIGF1dG8tYWJvcnRcblx0XHRpZiAoICF0cmFuc3BvcnQgKSB7XG5cdFx0XHRkb25lKCAtMSwgXCJObyBUcmFuc3BvcnRcIiApO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRqcVhIUi5yZWFkeVN0YXRlID0gMTtcblxuXHRcdFx0Ly8gU2VuZCBnbG9iYWwgZXZlbnRcblx0XHRcdGlmICggZmlyZUdsb2JhbHMgKSB7XG5cdFx0XHRcdGdsb2JhbEV2ZW50Q29udGV4dC50cmlnZ2VyKCBcImFqYXhTZW5kXCIsIFsganFYSFIsIHMgXSApO1xuXHRcdFx0fVxuXHRcdFx0Ly8gVGltZW91dFxuXHRcdFx0aWYgKCBzLmFzeW5jICYmIHMudGltZW91dCA+IDAgKSB7XG5cdFx0XHRcdHRpbWVvdXRUaW1lciA9IHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XG5cdFx0XHRcdFx0anFYSFIuYWJvcnQoXCJ0aW1lb3V0XCIpO1xuXHRcdFx0XHR9LCBzLnRpbWVvdXQgKTtcblx0XHRcdH1cblxuXHRcdFx0dHJ5IHtcblx0XHRcdFx0c3RhdGUgPSAxO1xuXHRcdFx0XHR0cmFuc3BvcnQuc2VuZCggcmVxdWVzdEhlYWRlcnMsIGRvbmUgKTtcblx0XHRcdH0gY2F0Y2ggKCBlICkge1xuXHRcdFx0XHQvLyBQcm9wYWdhdGUgZXhjZXB0aW9uIGFzIGVycm9yIGlmIG5vdCBkb25lXG5cdFx0XHRcdGlmICggc3RhdGUgPCAyICkge1xuXHRcdFx0XHRcdGRvbmUoIC0xLCBlICk7XG5cdFx0XHRcdC8vIFNpbXBseSByZXRocm93IG90aGVyd2lzZVxuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdHRocm93IGU7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9XG5cblx0XHQvLyBDYWxsYmFjayBmb3Igd2hlbiBldmVyeXRoaW5nIGlzIGRvbmVcblx0XHRmdW5jdGlvbiBkb25lKCBzdGF0dXMsIG5hdGl2ZVN0YXR1c1RleHQsIHJlc3BvbnNlcywgaGVhZGVycyApIHtcblx0XHRcdHZhciBpc1N1Y2Nlc3MsIHN1Y2Nlc3MsIGVycm9yLCByZXNwb25zZSwgbW9kaWZpZWQsXG5cdFx0XHRcdHN0YXR1c1RleHQgPSBuYXRpdmVTdGF0dXNUZXh0O1xuXG5cdFx0XHQvLyBDYWxsZWQgb25jZVxuXHRcdFx0aWYgKCBzdGF0ZSA9PT0gMiApIHtcblx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0fVxuXG5cdFx0XHQvLyBTdGF0ZSBpcyBcImRvbmVcIiBub3dcblx0XHRcdHN0YXRlID0gMjtcblxuXHRcdFx0Ly8gQ2xlYXIgdGltZW91dCBpZiBpdCBleGlzdHNcblx0XHRcdGlmICggdGltZW91dFRpbWVyICkge1xuXHRcdFx0XHRjbGVhclRpbWVvdXQoIHRpbWVvdXRUaW1lciApO1xuXHRcdFx0fVxuXG5cdFx0XHQvLyBEZXJlZmVyZW5jZSB0cmFuc3BvcnQgZm9yIGVhcmx5IGdhcmJhZ2UgY29sbGVjdGlvblxuXHRcdFx0Ly8gKG5vIG1hdHRlciBob3cgbG9uZyB0aGUganFYSFIgb2JqZWN0IHdpbGwgYmUgdXNlZClcblx0XHRcdHRyYW5zcG9ydCA9IHVuZGVmaW5lZDtcblxuXHRcdFx0Ly8gQ2FjaGUgcmVzcG9uc2UgaGVhZGVyc1xuXHRcdFx0cmVzcG9uc2VIZWFkZXJzU3RyaW5nID0gaGVhZGVycyB8fCBcIlwiO1xuXG5cdFx0XHQvLyBTZXQgcmVhZHlTdGF0ZVxuXHRcdFx0anFYSFIucmVhZHlTdGF0ZSA9IHN0YXR1cyA+IDAgPyA0IDogMDtcblxuXHRcdFx0Ly8gRGV0ZXJtaW5lIGlmIHN1Y2Nlc3NmdWxcblx0XHRcdGlzU3VjY2VzcyA9IHN0YXR1cyA+PSAyMDAgJiYgc3RhdHVzIDwgMzAwIHx8IHN0YXR1cyA9PT0gMzA0O1xuXG5cdFx0XHQvLyBHZXQgcmVzcG9uc2UgZGF0YVxuXHRcdFx0aWYgKCByZXNwb25zZXMgKSB7XG5cdFx0XHRcdHJlc3BvbnNlID0gYWpheEhhbmRsZVJlc3BvbnNlcyggcywganFYSFIsIHJlc3BvbnNlcyApO1xuXHRcdFx0fVxuXG5cdFx0XHQvLyBDb252ZXJ0IG5vIG1hdHRlciB3aGF0ICh0aGF0IHdheSByZXNwb25zZVhYWCBmaWVsZHMgYXJlIGFsd2F5cyBzZXQpXG5cdFx0XHRyZXNwb25zZSA9IGFqYXhDb252ZXJ0KCBzLCByZXNwb25zZSwganFYSFIsIGlzU3VjY2VzcyApO1xuXG5cdFx0XHQvLyBJZiBzdWNjZXNzZnVsLCBoYW5kbGUgdHlwZSBjaGFpbmluZ1xuXHRcdFx0aWYgKCBpc1N1Y2Nlc3MgKSB7XG5cblx0XHRcdFx0Ly8gU2V0IHRoZSBJZi1Nb2RpZmllZC1TaW5jZSBhbmQvb3IgSWYtTm9uZS1NYXRjaCBoZWFkZXIsIGlmIGluIGlmTW9kaWZpZWQgbW9kZS5cblx0XHRcdFx0aWYgKCBzLmlmTW9kaWZpZWQgKSB7XG5cdFx0XHRcdFx0bW9kaWZpZWQgPSBqcVhIUi5nZXRSZXNwb25zZUhlYWRlcihcIkxhc3QtTW9kaWZpZWRcIik7XG5cdFx0XHRcdFx0aWYgKCBtb2RpZmllZCApIHtcblx0XHRcdFx0XHRcdGpRdWVyeS5sYXN0TW9kaWZpZWRbIGNhY2hlVVJMIF0gPSBtb2RpZmllZDtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0bW9kaWZpZWQgPSBqcVhIUi5nZXRSZXNwb25zZUhlYWRlcihcImV0YWdcIik7XG5cdFx0XHRcdFx0aWYgKCBtb2RpZmllZCApIHtcblx0XHRcdFx0XHRcdGpRdWVyeS5ldGFnWyBjYWNoZVVSTCBdID0gbW9kaWZpZWQ7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cblx0XHRcdFx0Ly8gaWYgbm8gY29udGVudFxuXHRcdFx0XHRpZiAoIHN0YXR1cyA9PT0gMjA0IHx8IHMudHlwZSA9PT0gXCJIRUFEXCIgKSB7XG5cdFx0XHRcdFx0c3RhdHVzVGV4dCA9IFwibm9jb250ZW50XCI7XG5cblx0XHRcdFx0Ly8gaWYgbm90IG1vZGlmaWVkXG5cdFx0XHRcdH0gZWxzZSBpZiAoIHN0YXR1cyA9PT0gMzA0ICkge1xuXHRcdFx0XHRcdHN0YXR1c1RleHQgPSBcIm5vdG1vZGlmaWVkXCI7XG5cblx0XHRcdFx0Ly8gSWYgd2UgaGF2ZSBkYXRhLCBsZXQncyBjb252ZXJ0IGl0XG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0c3RhdHVzVGV4dCA9IHJlc3BvbnNlLnN0YXRlO1xuXHRcdFx0XHRcdHN1Y2Nlc3MgPSByZXNwb25zZS5kYXRhO1xuXHRcdFx0XHRcdGVycm9yID0gcmVzcG9uc2UuZXJyb3I7XG5cdFx0XHRcdFx0aXNTdWNjZXNzID0gIWVycm9yO1xuXHRcdFx0XHR9XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHQvLyBFeHRyYWN0IGVycm9yIGZyb20gc3RhdHVzVGV4dCBhbmQgbm9ybWFsaXplIGZvciBub24tYWJvcnRzXG5cdFx0XHRcdGVycm9yID0gc3RhdHVzVGV4dDtcblx0XHRcdFx0aWYgKCBzdGF0dXMgfHwgIXN0YXR1c1RleHQgKSB7XG5cdFx0XHRcdFx0c3RhdHVzVGV4dCA9IFwiZXJyb3JcIjtcblx0XHRcdFx0XHRpZiAoIHN0YXR1cyA8IDAgKSB7XG5cdFx0XHRcdFx0XHRzdGF0dXMgPSAwO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0fVxuXG5cdFx0XHQvLyBTZXQgZGF0YSBmb3IgdGhlIGZha2UgeGhyIG9iamVjdFxuXHRcdFx0anFYSFIuc3RhdHVzID0gc3RhdHVzO1xuXHRcdFx0anFYSFIuc3RhdHVzVGV4dCA9ICggbmF0aXZlU3RhdHVzVGV4dCB8fCBzdGF0dXNUZXh0ICkgKyBcIlwiO1xuXG5cdFx0XHQvLyBTdWNjZXNzL0Vycm9yXG5cdFx0XHRpZiAoIGlzU3VjY2VzcyApIHtcblx0XHRcdFx0ZGVmZXJyZWQucmVzb2x2ZVdpdGgoIGNhbGxiYWNrQ29udGV4dCwgWyBzdWNjZXNzLCBzdGF0dXNUZXh0LCBqcVhIUiBdICk7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRkZWZlcnJlZC5yZWplY3RXaXRoKCBjYWxsYmFja0NvbnRleHQsIFsganFYSFIsIHN0YXR1c1RleHQsIGVycm9yIF0gKTtcblx0XHRcdH1cblxuXHRcdFx0Ly8gU3RhdHVzLWRlcGVuZGVudCBjYWxsYmFja3Ncblx0XHRcdGpxWEhSLnN0YXR1c0NvZGUoIHN0YXR1c0NvZGUgKTtcblx0XHRcdHN0YXR1c0NvZGUgPSB1bmRlZmluZWQ7XG5cblx0XHRcdGlmICggZmlyZUdsb2JhbHMgKSB7XG5cdFx0XHRcdGdsb2JhbEV2ZW50Q29udGV4dC50cmlnZ2VyKCBpc1N1Y2Nlc3MgPyBcImFqYXhTdWNjZXNzXCIgOiBcImFqYXhFcnJvclwiLFxuXHRcdFx0XHRcdFsganFYSFIsIHMsIGlzU3VjY2VzcyA/IHN1Y2Nlc3MgOiBlcnJvciBdICk7XG5cdFx0XHR9XG5cblx0XHRcdC8vIENvbXBsZXRlXG5cdFx0XHRjb21wbGV0ZURlZmVycmVkLmZpcmVXaXRoKCBjYWxsYmFja0NvbnRleHQsIFsganFYSFIsIHN0YXR1c1RleHQgXSApO1xuXG5cdFx0XHRpZiAoIGZpcmVHbG9iYWxzICkge1xuXHRcdFx0XHRnbG9iYWxFdmVudENvbnRleHQudHJpZ2dlciggXCJhamF4Q29tcGxldGVcIiwgWyBqcVhIUiwgcyBdICk7XG5cdFx0XHRcdC8vIEhhbmRsZSB0aGUgZ2xvYmFsIEFKQVggY291bnRlclxuXHRcdFx0XHRpZiAoICEoIC0talF1ZXJ5LmFjdGl2ZSApICkge1xuXHRcdFx0XHRcdGpRdWVyeS5ldmVudC50cmlnZ2VyKFwiYWpheFN0b3BcIik7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9XG5cblx0XHRyZXR1cm4ganFYSFI7XG5cdH0sXG5cblx0Z2V0SlNPTjogZnVuY3Rpb24oIHVybCwgZGF0YSwgY2FsbGJhY2sgKSB7XG5cdFx0cmV0dXJuIGpRdWVyeS5nZXQoIHVybCwgZGF0YSwgY2FsbGJhY2ssIFwianNvblwiICk7XG5cdH0sXG5cblx0Z2V0U2NyaXB0OiBmdW5jdGlvbiggdXJsLCBjYWxsYmFjayApIHtcblx0XHRyZXR1cm4galF1ZXJ5LmdldCggdXJsLCB1bmRlZmluZWQsIGNhbGxiYWNrLCBcInNjcmlwdFwiICk7XG5cdH1cbn0pO1xuXG5qUXVlcnkuZWFjaCggWyBcImdldFwiLCBcInBvc3RcIiBdLCBmdW5jdGlvbiggaSwgbWV0aG9kICkge1xuXHRqUXVlcnlbIG1ldGhvZCBdID0gZnVuY3Rpb24oIHVybCwgZGF0YSwgY2FsbGJhY2ssIHR5cGUgKSB7XG5cdFx0Ly8gU2hpZnQgYXJndW1lbnRzIGlmIGRhdGEgYXJndW1lbnQgd2FzIG9taXR0ZWRcblx0XHRpZiAoIGpRdWVyeS5pc0Z1bmN0aW9uKCBkYXRhICkgKSB7XG5cdFx0XHR0eXBlID0gdHlwZSB8fCBjYWxsYmFjaztcblx0XHRcdGNhbGxiYWNrID0gZGF0YTtcblx0XHRcdGRhdGEgPSB1bmRlZmluZWQ7XG5cdFx0fVxuXG5cdFx0cmV0dXJuIGpRdWVyeS5hamF4KHtcblx0XHRcdHVybDogdXJsLFxuXHRcdFx0dHlwZTogbWV0aG9kLFxuXHRcdFx0ZGF0YVR5cGU6IHR5cGUsXG5cdFx0XHRkYXRhOiBkYXRhLFxuXHRcdFx0c3VjY2VzczogY2FsbGJhY2tcblx0XHR9KTtcblx0fTtcbn0pO1xuXG5cbmpRdWVyeS5fZXZhbFVybCA9IGZ1bmN0aW9uKCB1cmwgKSB7XG5cdHJldHVybiBqUXVlcnkuYWpheCh7XG5cdFx0dXJsOiB1cmwsXG5cdFx0dHlwZTogXCJHRVRcIixcblx0XHRkYXRhVHlwZTogXCJzY3JpcHRcIixcblx0XHRhc3luYzogZmFsc2UsXG5cdFx0Z2xvYmFsOiBmYWxzZSxcblx0XHRcInRocm93c1wiOiB0cnVlXG5cdH0pO1xufTtcblxuXG5qUXVlcnkuZm4uZXh0ZW5kKHtcblx0d3JhcEFsbDogZnVuY3Rpb24oIGh0bWwgKSB7XG5cdFx0dmFyIHdyYXA7XG5cblx0XHRpZiAoIGpRdWVyeS5pc0Z1bmN0aW9uKCBodG1sICkgKSB7XG5cdFx0XHRyZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uKCBpICkge1xuXHRcdFx0XHRqUXVlcnkoIHRoaXMgKS53cmFwQWxsKCBodG1sLmNhbGwodGhpcywgaSkgKTtcblx0XHRcdH0pO1xuXHRcdH1cblxuXHRcdGlmICggdGhpc1sgMCBdICkge1xuXG5cdFx0XHQvLyBUaGUgZWxlbWVudHMgdG8gd3JhcCB0aGUgdGFyZ2V0IGFyb3VuZFxuXHRcdFx0d3JhcCA9IGpRdWVyeSggaHRtbCwgdGhpc1sgMCBdLm93bmVyRG9jdW1lbnQgKS5lcSggMCApLmNsb25lKCB0cnVlICk7XG5cblx0XHRcdGlmICggdGhpc1sgMCBdLnBhcmVudE5vZGUgKSB7XG5cdFx0XHRcdHdyYXAuaW5zZXJ0QmVmb3JlKCB0aGlzWyAwIF0gKTtcblx0XHRcdH1cblxuXHRcdFx0d3JhcC5tYXAoZnVuY3Rpb24oKSB7XG5cdFx0XHRcdHZhciBlbGVtID0gdGhpcztcblxuXHRcdFx0XHR3aGlsZSAoIGVsZW0uZmlyc3RFbGVtZW50Q2hpbGQgKSB7XG5cdFx0XHRcdFx0ZWxlbSA9IGVsZW0uZmlyc3RFbGVtZW50Q2hpbGQ7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHRyZXR1cm4gZWxlbTtcblx0XHRcdH0pLmFwcGVuZCggdGhpcyApO1xuXHRcdH1cblxuXHRcdHJldHVybiB0aGlzO1xuXHR9LFxuXG5cdHdyYXBJbm5lcjogZnVuY3Rpb24oIGh0bWwgKSB7XG5cdFx0aWYgKCBqUXVlcnkuaXNGdW5jdGlvbiggaHRtbCApICkge1xuXHRcdFx0cmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbiggaSApIHtcblx0XHRcdFx0alF1ZXJ5KCB0aGlzICkud3JhcElubmVyKCBodG1sLmNhbGwodGhpcywgaSkgKTtcblx0XHRcdH0pO1xuXHRcdH1cblxuXHRcdHJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oKSB7XG5cdFx0XHR2YXIgc2VsZiA9IGpRdWVyeSggdGhpcyApLFxuXHRcdFx0XHRjb250ZW50cyA9IHNlbGYuY29udGVudHMoKTtcblxuXHRcdFx0aWYgKCBjb250ZW50cy5sZW5ndGggKSB7XG5cdFx0XHRcdGNvbnRlbnRzLndyYXBBbGwoIGh0bWwgKTtcblxuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0c2VsZi5hcHBlbmQoIGh0bWwgKTtcblx0XHRcdH1cblx0XHR9KTtcblx0fSxcblxuXHR3cmFwOiBmdW5jdGlvbiggaHRtbCApIHtcblx0XHR2YXIgaXNGdW5jdGlvbiA9IGpRdWVyeS5pc0Z1bmN0aW9uKCBodG1sICk7XG5cblx0XHRyZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uKCBpICkge1xuXHRcdFx0alF1ZXJ5KCB0aGlzICkud3JhcEFsbCggaXNGdW5jdGlvbiA/IGh0bWwuY2FsbCh0aGlzLCBpKSA6IGh0bWwgKTtcblx0XHR9KTtcblx0fSxcblxuXHR1bndyYXA6IGZ1bmN0aW9uKCkge1xuXHRcdHJldHVybiB0aGlzLnBhcmVudCgpLmVhY2goZnVuY3Rpb24oKSB7XG5cdFx0XHRpZiAoICFqUXVlcnkubm9kZU5hbWUoIHRoaXMsIFwiYm9keVwiICkgKSB7XG5cdFx0XHRcdGpRdWVyeSggdGhpcyApLnJlcGxhY2VXaXRoKCB0aGlzLmNoaWxkTm9kZXMgKTtcblx0XHRcdH1cblx0XHR9KS5lbmQoKTtcblx0fVxufSk7XG5cblxualF1ZXJ5LmV4cHIuZmlsdGVycy5oaWRkZW4gPSBmdW5jdGlvbiggZWxlbSApIHtcblx0Ly8gU3VwcG9ydDogT3BlcmEgPD0gMTIuMTJcblx0Ly8gT3BlcmEgcmVwb3J0cyBvZmZzZXRXaWR0aHMgYW5kIG9mZnNldEhlaWdodHMgbGVzcyB0aGFuIHplcm8gb24gc29tZSBlbGVtZW50c1xuXHRyZXR1cm4gZWxlbS5vZmZzZXRXaWR0aCA8PSAwICYmIGVsZW0ub2Zmc2V0SGVpZ2h0IDw9IDA7XG59O1xualF1ZXJ5LmV4cHIuZmlsdGVycy52aXNpYmxlID0gZnVuY3Rpb24oIGVsZW0gKSB7XG5cdHJldHVybiAhalF1ZXJ5LmV4cHIuZmlsdGVycy5oaWRkZW4oIGVsZW0gKTtcbn07XG5cblxuXG5cbnZhciByMjAgPSAvJTIwL2csXG5cdHJicmFja2V0ID0gL1xcW1xcXSQvLFxuXHRyQ1JMRiA9IC9cXHI/XFxuL2csXG5cdHJzdWJtaXR0ZXJUeXBlcyA9IC9eKD86c3VibWl0fGJ1dHRvbnxpbWFnZXxyZXNldHxmaWxlKSQvaSxcblx0cnN1Ym1pdHRhYmxlID0gL14oPzppbnB1dHxzZWxlY3R8dGV4dGFyZWF8a2V5Z2VuKS9pO1xuXG5mdW5jdGlvbiBidWlsZFBhcmFtcyggcHJlZml4LCBvYmosIHRyYWRpdGlvbmFsLCBhZGQgKSB7XG5cdHZhciBuYW1lO1xuXG5cdGlmICggalF1ZXJ5LmlzQXJyYXkoIG9iaiApICkge1xuXHRcdC8vIFNlcmlhbGl6ZSBhcnJheSBpdGVtLlxuXHRcdGpRdWVyeS5lYWNoKCBvYmosIGZ1bmN0aW9uKCBpLCB2ICkge1xuXHRcdFx0aWYgKCB0cmFkaXRpb25hbCB8fCByYnJhY2tldC50ZXN0KCBwcmVmaXggKSApIHtcblx0XHRcdFx0Ly8gVHJlYXQgZWFjaCBhcnJheSBpdGVtIGFzIGEgc2NhbGFyLlxuXHRcdFx0XHRhZGQoIHByZWZpeCwgdiApO1xuXG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHQvLyBJdGVtIGlzIG5vbi1zY2FsYXIgKGFycmF5IG9yIG9iamVjdCksIGVuY29kZSBpdHMgbnVtZXJpYyBpbmRleC5cblx0XHRcdFx0YnVpbGRQYXJhbXMoIHByZWZpeCArIFwiW1wiICsgKCB0eXBlb2YgdiA9PT0gXCJvYmplY3RcIiA/IGkgOiBcIlwiICkgKyBcIl1cIiwgdiwgdHJhZGl0aW9uYWwsIGFkZCApO1xuXHRcdFx0fVxuXHRcdH0pO1xuXG5cdH0gZWxzZSBpZiAoICF0cmFkaXRpb25hbCAmJiBqUXVlcnkudHlwZSggb2JqICkgPT09IFwib2JqZWN0XCIgKSB7XG5cdFx0Ly8gU2VyaWFsaXplIG9iamVjdCBpdGVtLlxuXHRcdGZvciAoIG5hbWUgaW4gb2JqICkge1xuXHRcdFx0YnVpbGRQYXJhbXMoIHByZWZpeCArIFwiW1wiICsgbmFtZSArIFwiXVwiLCBvYmpbIG5hbWUgXSwgdHJhZGl0aW9uYWwsIGFkZCApO1xuXHRcdH1cblxuXHR9IGVsc2Uge1xuXHRcdC8vIFNlcmlhbGl6ZSBzY2FsYXIgaXRlbS5cblx0XHRhZGQoIHByZWZpeCwgb2JqICk7XG5cdH1cbn1cblxuLy8gU2VyaWFsaXplIGFuIGFycmF5IG9mIGZvcm0gZWxlbWVudHMgb3IgYSBzZXQgb2Zcbi8vIGtleS92YWx1ZXMgaW50byBhIHF1ZXJ5IHN0cmluZ1xualF1ZXJ5LnBhcmFtID0gZnVuY3Rpb24oIGEsIHRyYWRpdGlvbmFsICkge1xuXHR2YXIgcHJlZml4LFxuXHRcdHMgPSBbXSxcblx0XHRhZGQgPSBmdW5jdGlvbigga2V5LCB2YWx1ZSApIHtcblx0XHRcdC8vIElmIHZhbHVlIGlzIGEgZnVuY3Rpb24sIGludm9rZSBpdCBhbmQgcmV0dXJuIGl0cyB2YWx1ZVxuXHRcdFx0dmFsdWUgPSBqUXVlcnkuaXNGdW5jdGlvbiggdmFsdWUgKSA/IHZhbHVlKCkgOiAoIHZhbHVlID09IG51bGwgPyBcIlwiIDogdmFsdWUgKTtcblx0XHRcdHNbIHMubGVuZ3RoIF0gPSBlbmNvZGVVUklDb21wb25lbnQoIGtleSApICsgXCI9XCIgKyBlbmNvZGVVUklDb21wb25lbnQoIHZhbHVlICk7XG5cdFx0fTtcblxuXHQvLyBTZXQgdHJhZGl0aW9uYWwgdG8gdHJ1ZSBmb3IgalF1ZXJ5IDw9IDEuMy4yIGJlaGF2aW9yLlxuXHRpZiAoIHRyYWRpdGlvbmFsID09PSB1bmRlZmluZWQgKSB7XG5cdFx0dHJhZGl0aW9uYWwgPSBqUXVlcnkuYWpheFNldHRpbmdzICYmIGpRdWVyeS5hamF4U2V0dGluZ3MudHJhZGl0aW9uYWw7XG5cdH1cblxuXHQvLyBJZiBhbiBhcnJheSB3YXMgcGFzc2VkIGluLCBhc3N1bWUgdGhhdCBpdCBpcyBhbiBhcnJheSBvZiBmb3JtIGVsZW1lbnRzLlxuXHRpZiAoIGpRdWVyeS5pc0FycmF5KCBhICkgfHwgKCBhLmpxdWVyeSAmJiAhalF1ZXJ5LmlzUGxhaW5PYmplY3QoIGEgKSApICkge1xuXHRcdC8vIFNlcmlhbGl6ZSB0aGUgZm9ybSBlbGVtZW50c1xuXHRcdGpRdWVyeS5lYWNoKCBhLCBmdW5jdGlvbigpIHtcblx0XHRcdGFkZCggdGhpcy5uYW1lLCB0aGlzLnZhbHVlICk7XG5cdFx0fSk7XG5cblx0fSBlbHNlIHtcblx0XHQvLyBJZiB0cmFkaXRpb25hbCwgZW5jb2RlIHRoZSBcIm9sZFwiIHdheSAodGhlIHdheSAxLjMuMiBvciBvbGRlclxuXHRcdC8vIGRpZCBpdCksIG90aGVyd2lzZSBlbmNvZGUgcGFyYW1zIHJlY3Vyc2l2ZWx5LlxuXHRcdGZvciAoIHByZWZpeCBpbiBhICkge1xuXHRcdFx0YnVpbGRQYXJhbXMoIHByZWZpeCwgYVsgcHJlZml4IF0sIHRyYWRpdGlvbmFsLCBhZGQgKTtcblx0XHR9XG5cdH1cblxuXHQvLyBSZXR1cm4gdGhlIHJlc3VsdGluZyBzZXJpYWxpemF0aW9uXG5cdHJldHVybiBzLmpvaW4oIFwiJlwiICkucmVwbGFjZSggcjIwLCBcIitcIiApO1xufTtcblxualF1ZXJ5LmZuLmV4dGVuZCh7XG5cdHNlcmlhbGl6ZTogZnVuY3Rpb24oKSB7XG5cdFx0cmV0dXJuIGpRdWVyeS5wYXJhbSggdGhpcy5zZXJpYWxpemVBcnJheSgpICk7XG5cdH0sXG5cdHNlcmlhbGl6ZUFycmF5OiBmdW5jdGlvbigpIHtcblx0XHRyZXR1cm4gdGhpcy5tYXAoZnVuY3Rpb24oKSB7XG5cdFx0XHQvLyBDYW4gYWRkIHByb3BIb29rIGZvciBcImVsZW1lbnRzXCIgdG8gZmlsdGVyIG9yIGFkZCBmb3JtIGVsZW1lbnRzXG5cdFx0XHR2YXIgZWxlbWVudHMgPSBqUXVlcnkucHJvcCggdGhpcywgXCJlbGVtZW50c1wiICk7XG5cdFx0XHRyZXR1cm4gZWxlbWVudHMgPyBqUXVlcnkubWFrZUFycmF5KCBlbGVtZW50cyApIDogdGhpcztcblx0XHR9KVxuXHRcdC5maWx0ZXIoZnVuY3Rpb24oKSB7XG5cdFx0XHR2YXIgdHlwZSA9IHRoaXMudHlwZTtcblxuXHRcdFx0Ly8gVXNlIC5pcyggXCI6ZGlzYWJsZWRcIiApIHNvIHRoYXQgZmllbGRzZXRbZGlzYWJsZWRdIHdvcmtzXG5cdFx0XHRyZXR1cm4gdGhpcy5uYW1lICYmICFqUXVlcnkoIHRoaXMgKS5pcyggXCI6ZGlzYWJsZWRcIiApICYmXG5cdFx0XHRcdHJzdWJtaXR0YWJsZS50ZXN0KCB0aGlzLm5vZGVOYW1lICkgJiYgIXJzdWJtaXR0ZXJUeXBlcy50ZXN0KCB0eXBlICkgJiZcblx0XHRcdFx0KCB0aGlzLmNoZWNrZWQgfHwgIXJjaGVja2FibGVUeXBlLnRlc3QoIHR5cGUgKSApO1xuXHRcdH0pXG5cdFx0Lm1hcChmdW5jdGlvbiggaSwgZWxlbSApIHtcblx0XHRcdHZhciB2YWwgPSBqUXVlcnkoIHRoaXMgKS52YWwoKTtcblxuXHRcdFx0cmV0dXJuIHZhbCA9PSBudWxsID9cblx0XHRcdFx0bnVsbCA6XG5cdFx0XHRcdGpRdWVyeS5pc0FycmF5KCB2YWwgKSA/XG5cdFx0XHRcdFx0alF1ZXJ5Lm1hcCggdmFsLCBmdW5jdGlvbiggdmFsICkge1xuXHRcdFx0XHRcdFx0cmV0dXJuIHsgbmFtZTogZWxlbS5uYW1lLCB2YWx1ZTogdmFsLnJlcGxhY2UoIHJDUkxGLCBcIlxcclxcblwiICkgfTtcblx0XHRcdFx0XHR9KSA6XG5cdFx0XHRcdFx0eyBuYW1lOiBlbGVtLm5hbWUsIHZhbHVlOiB2YWwucmVwbGFjZSggckNSTEYsIFwiXFxyXFxuXCIgKSB9O1xuXHRcdH0pLmdldCgpO1xuXHR9XG59KTtcblxuXG5qUXVlcnkuYWpheFNldHRpbmdzLnhociA9IGZ1bmN0aW9uKCkge1xuXHR0cnkge1xuXHRcdHJldHVybiBuZXcgWE1MSHR0cFJlcXVlc3QoKTtcblx0fSBjYXRjaCggZSApIHt9XG59O1xuXG52YXIgeGhySWQgPSAwLFxuXHR4aHJDYWxsYmFja3MgPSB7fSxcblx0eGhyU3VjY2Vzc1N0YXR1cyA9IHtcblx0XHQvLyBmaWxlIHByb3RvY29sIGFsd2F5cyB5aWVsZHMgc3RhdHVzIGNvZGUgMCwgYXNzdW1lIDIwMFxuXHRcdDA6IDIwMCxcblx0XHQvLyBTdXBwb3J0OiBJRTlcblx0XHQvLyAjMTQ1MDogc29tZXRpbWVzIElFIHJldHVybnMgMTIyMyB3aGVuIGl0IHNob3VsZCBiZSAyMDRcblx0XHQxMjIzOiAyMDRcblx0fSxcblx0eGhyU3VwcG9ydGVkID0galF1ZXJ5LmFqYXhTZXR0aW5ncy54aHIoKTtcblxuLy8gU3VwcG9ydDogSUU5XG4vLyBPcGVuIHJlcXVlc3RzIG11c3QgYmUgbWFudWFsbHkgYWJvcnRlZCBvbiB1bmxvYWQgKCM1MjgwKVxuLy8gU2VlIGh0dHBzOi8vc3VwcG9ydC5taWNyb3NvZnQuY29tL2tiLzI4NTY3NDYgZm9yIG1vcmUgaW5mb1xuaWYgKCB3aW5kb3cuYXR0YWNoRXZlbnQgKSB7XG5cdHdpbmRvdy5hdHRhY2hFdmVudCggXCJvbnVubG9hZFwiLCBmdW5jdGlvbigpIHtcblx0XHRmb3IgKCB2YXIga2V5IGluIHhockNhbGxiYWNrcyApIHtcblx0XHRcdHhockNhbGxiYWNrc1sga2V5IF0oKTtcblx0XHR9XG5cdH0pO1xufVxuXG5zdXBwb3J0LmNvcnMgPSAhIXhoclN1cHBvcnRlZCAmJiAoIFwid2l0aENyZWRlbnRpYWxzXCIgaW4geGhyU3VwcG9ydGVkICk7XG5zdXBwb3J0LmFqYXggPSB4aHJTdXBwb3J0ZWQgPSAhIXhoclN1cHBvcnRlZDtcblxualF1ZXJ5LmFqYXhUcmFuc3BvcnQoZnVuY3Rpb24oIG9wdGlvbnMgKSB7XG5cdHZhciBjYWxsYmFjaztcblxuXHQvLyBDcm9zcyBkb21haW4gb25seSBhbGxvd2VkIGlmIHN1cHBvcnRlZCB0aHJvdWdoIFhNTEh0dHBSZXF1ZXN0XG5cdGlmICggc3VwcG9ydC5jb3JzIHx8IHhoclN1cHBvcnRlZCAmJiAhb3B0aW9ucy5jcm9zc0RvbWFpbiApIHtcblx0XHRyZXR1cm4ge1xuXHRcdFx0c2VuZDogZnVuY3Rpb24oIGhlYWRlcnMsIGNvbXBsZXRlICkge1xuXHRcdFx0XHR2YXIgaSxcblx0XHRcdFx0XHR4aHIgPSBvcHRpb25zLnhocigpLFxuXHRcdFx0XHRcdGlkID0gKyt4aHJJZDtcblxuXHRcdFx0XHR4aHIub3Blbiggb3B0aW9ucy50eXBlLCBvcHRpb25zLnVybCwgb3B0aW9ucy5hc3luYywgb3B0aW9ucy51c2VybmFtZSwgb3B0aW9ucy5wYXNzd29yZCApO1xuXG5cdFx0XHRcdC8vIEFwcGx5IGN1c3RvbSBmaWVsZHMgaWYgcHJvdmlkZWRcblx0XHRcdFx0aWYgKCBvcHRpb25zLnhockZpZWxkcyApIHtcblx0XHRcdFx0XHRmb3IgKCBpIGluIG9wdGlvbnMueGhyRmllbGRzICkge1xuXHRcdFx0XHRcdFx0eGhyWyBpIF0gPSBvcHRpb25zLnhockZpZWxkc1sgaSBdO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXG5cdFx0XHRcdC8vIE92ZXJyaWRlIG1pbWUgdHlwZSBpZiBuZWVkZWRcblx0XHRcdFx0aWYgKCBvcHRpb25zLm1pbWVUeXBlICYmIHhoci5vdmVycmlkZU1pbWVUeXBlICkge1xuXHRcdFx0XHRcdHhoci5vdmVycmlkZU1pbWVUeXBlKCBvcHRpb25zLm1pbWVUeXBlICk7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHQvLyBYLVJlcXVlc3RlZC1XaXRoIGhlYWRlclxuXHRcdFx0XHQvLyBGb3IgY3Jvc3MtZG9tYWluIHJlcXVlc3RzLCBzZWVpbmcgYXMgY29uZGl0aW9ucyBmb3IgYSBwcmVmbGlnaHQgYXJlXG5cdFx0XHRcdC8vIGFraW4gdG8gYSBqaWdzYXcgcHV6emxlLCB3ZSBzaW1wbHkgbmV2ZXIgc2V0IGl0IHRvIGJlIHN1cmUuXG5cdFx0XHRcdC8vIChpdCBjYW4gYWx3YXlzIGJlIHNldCBvbiBhIHBlci1yZXF1ZXN0IGJhc2lzIG9yIGV2ZW4gdXNpbmcgYWpheFNldHVwKVxuXHRcdFx0XHQvLyBGb3Igc2FtZS1kb21haW4gcmVxdWVzdHMsIHdvbid0IGNoYW5nZSBoZWFkZXIgaWYgYWxyZWFkeSBwcm92aWRlZC5cblx0XHRcdFx0aWYgKCAhb3B0aW9ucy5jcm9zc0RvbWFpbiAmJiAhaGVhZGVyc1tcIlgtUmVxdWVzdGVkLVdpdGhcIl0gKSB7XG5cdFx0XHRcdFx0aGVhZGVyc1tcIlgtUmVxdWVzdGVkLVdpdGhcIl0gPSBcIlhNTEh0dHBSZXF1ZXN0XCI7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHQvLyBTZXQgaGVhZGVyc1xuXHRcdFx0XHRmb3IgKCBpIGluIGhlYWRlcnMgKSB7XG5cdFx0XHRcdFx0eGhyLnNldFJlcXVlc3RIZWFkZXIoIGksIGhlYWRlcnNbIGkgXSApO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0Ly8gQ2FsbGJhY2tcblx0XHRcdFx0Y2FsbGJhY2sgPSBmdW5jdGlvbiggdHlwZSApIHtcblx0XHRcdFx0XHRyZXR1cm4gZnVuY3Rpb24oKSB7XG5cdFx0XHRcdFx0XHRpZiAoIGNhbGxiYWNrICkge1xuXHRcdFx0XHRcdFx0XHRkZWxldGUgeGhyQ2FsbGJhY2tzWyBpZCBdO1xuXHRcdFx0XHRcdFx0XHRjYWxsYmFjayA9IHhoci5vbmxvYWQgPSB4aHIub25lcnJvciA9IG51bGw7XG5cblx0XHRcdFx0XHRcdFx0aWYgKCB0eXBlID09PSBcImFib3J0XCIgKSB7XG5cdFx0XHRcdFx0XHRcdFx0eGhyLmFib3J0KCk7XG5cdFx0XHRcdFx0XHRcdH0gZWxzZSBpZiAoIHR5cGUgPT09IFwiZXJyb3JcIiApIHtcblx0XHRcdFx0XHRcdFx0XHRjb21wbGV0ZShcblx0XHRcdFx0XHRcdFx0XHRcdC8vIGZpbGU6IHByb3RvY29sIGFsd2F5cyB5aWVsZHMgc3RhdHVzIDA7IHNlZSAjODYwNSwgIzE0MjA3XG5cdFx0XHRcdFx0XHRcdFx0XHR4aHIuc3RhdHVzLFxuXHRcdFx0XHRcdFx0XHRcdFx0eGhyLnN0YXR1c1RleHRcblx0XHRcdFx0XHRcdFx0XHQpO1xuXHRcdFx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0XHRcdGNvbXBsZXRlKFxuXHRcdFx0XHRcdFx0XHRcdFx0eGhyU3VjY2Vzc1N0YXR1c1sgeGhyLnN0YXR1cyBdIHx8IHhoci5zdGF0dXMsXG5cdFx0XHRcdFx0XHRcdFx0XHR4aHIuc3RhdHVzVGV4dCxcblx0XHRcdFx0XHRcdFx0XHRcdC8vIFN1cHBvcnQ6IElFOVxuXHRcdFx0XHRcdFx0XHRcdFx0Ly8gQWNjZXNzaW5nIGJpbmFyeS1kYXRhIHJlc3BvbnNlVGV4dCB0aHJvd3MgYW4gZXhjZXB0aW9uXG5cdFx0XHRcdFx0XHRcdFx0XHQvLyAoIzExNDI2KVxuXHRcdFx0XHRcdFx0XHRcdFx0dHlwZW9mIHhoci5yZXNwb25zZVRleHQgPT09IFwic3RyaW5nXCIgPyB7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdHRleHQ6IHhoci5yZXNwb25zZVRleHRcblx0XHRcdFx0XHRcdFx0XHRcdH0gOiB1bmRlZmluZWQsXG5cdFx0XHRcdFx0XHRcdFx0XHR4aHIuZ2V0QWxsUmVzcG9uc2VIZWFkZXJzKClcblx0XHRcdFx0XHRcdFx0XHQpO1xuXHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fTtcblx0XHRcdFx0fTtcblxuXHRcdFx0XHQvLyBMaXN0ZW4gdG8gZXZlbnRzXG5cdFx0XHRcdHhoci5vbmxvYWQgPSBjYWxsYmFjaygpO1xuXHRcdFx0XHR4aHIub25lcnJvciA9IGNhbGxiYWNrKFwiZXJyb3JcIik7XG5cblx0XHRcdFx0Ly8gQ3JlYXRlIHRoZSBhYm9ydCBjYWxsYmFja1xuXHRcdFx0XHRjYWxsYmFjayA9IHhockNhbGxiYWNrc1sgaWQgXSA9IGNhbGxiYWNrKFwiYWJvcnRcIik7XG5cblx0XHRcdFx0dHJ5IHtcblx0XHRcdFx0XHQvLyBEbyBzZW5kIHRoZSByZXF1ZXN0ICh0aGlzIG1heSByYWlzZSBhbiBleGNlcHRpb24pXG5cdFx0XHRcdFx0eGhyLnNlbmQoIG9wdGlvbnMuaGFzQ29udGVudCAmJiBvcHRpb25zLmRhdGEgfHwgbnVsbCApO1xuXHRcdFx0XHR9IGNhdGNoICggZSApIHtcblx0XHRcdFx0XHQvLyAjMTQ2ODM6IE9ubHkgcmV0aHJvdyBpZiB0aGlzIGhhc24ndCBiZWVuIG5vdGlmaWVkIGFzIGFuIGVycm9yIHlldFxuXHRcdFx0XHRcdGlmICggY2FsbGJhY2sgKSB7XG5cdFx0XHRcdFx0XHR0aHJvdyBlO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0fSxcblxuXHRcdFx0YWJvcnQ6IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRpZiAoIGNhbGxiYWNrICkge1xuXHRcdFx0XHRcdGNhbGxiYWNrKCk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9O1xuXHR9XG59KTtcblxuXG5cblxuLy8gSW5zdGFsbCBzY3JpcHQgZGF0YVR5cGVcbmpRdWVyeS5hamF4U2V0dXAoe1xuXHRhY2NlcHRzOiB7XG5cdFx0c2NyaXB0OiBcInRleHQvamF2YXNjcmlwdCwgYXBwbGljYXRpb24vamF2YXNjcmlwdCwgYXBwbGljYXRpb24vZWNtYXNjcmlwdCwgYXBwbGljYXRpb24veC1lY21hc2NyaXB0XCJcblx0fSxcblx0Y29udGVudHM6IHtcblx0XHRzY3JpcHQ6IC8oPzpqYXZhfGVjbWEpc2NyaXB0L1xuXHR9LFxuXHRjb252ZXJ0ZXJzOiB7XG5cdFx0XCJ0ZXh0IHNjcmlwdFwiOiBmdW5jdGlvbiggdGV4dCApIHtcblx0XHRcdGpRdWVyeS5nbG9iYWxFdmFsKCB0ZXh0ICk7XG5cdFx0XHRyZXR1cm4gdGV4dDtcblx0XHR9XG5cdH1cbn0pO1xuXG4vLyBIYW5kbGUgY2FjaGUncyBzcGVjaWFsIGNhc2UgYW5kIGNyb3NzRG9tYWluXG5qUXVlcnkuYWpheFByZWZpbHRlciggXCJzY3JpcHRcIiwgZnVuY3Rpb24oIHMgKSB7XG5cdGlmICggcy5jYWNoZSA9PT0gdW5kZWZpbmVkICkge1xuXHRcdHMuY2FjaGUgPSBmYWxzZTtcblx0fVxuXHRpZiAoIHMuY3Jvc3NEb21haW4gKSB7XG5cdFx0cy50eXBlID0gXCJHRVRcIjtcblx0fVxufSk7XG5cbi8vIEJpbmQgc2NyaXB0IHRhZyBoYWNrIHRyYW5zcG9ydFxualF1ZXJ5LmFqYXhUcmFuc3BvcnQoIFwic2NyaXB0XCIsIGZ1bmN0aW9uKCBzICkge1xuXHQvLyBUaGlzIHRyYW5zcG9ydCBvbmx5IGRlYWxzIHdpdGggY3Jvc3MgZG9tYWluIHJlcXVlc3RzXG5cdGlmICggcy5jcm9zc0RvbWFpbiApIHtcblx0XHR2YXIgc2NyaXB0LCBjYWxsYmFjaztcblx0XHRyZXR1cm4ge1xuXHRcdFx0c2VuZDogZnVuY3Rpb24oIF8sIGNvbXBsZXRlICkge1xuXHRcdFx0XHRzY3JpcHQgPSBqUXVlcnkoXCI8c2NyaXB0PlwiKS5wcm9wKHtcblx0XHRcdFx0XHRhc3luYzogdHJ1ZSxcblx0XHRcdFx0XHRjaGFyc2V0OiBzLnNjcmlwdENoYXJzZXQsXG5cdFx0XHRcdFx0c3JjOiBzLnVybFxuXHRcdFx0XHR9KS5vbihcblx0XHRcdFx0XHRcImxvYWQgZXJyb3JcIixcblx0XHRcdFx0XHRjYWxsYmFjayA9IGZ1bmN0aW9uKCBldnQgKSB7XG5cdFx0XHRcdFx0XHRzY3JpcHQucmVtb3ZlKCk7XG5cdFx0XHRcdFx0XHRjYWxsYmFjayA9IG51bGw7XG5cdFx0XHRcdFx0XHRpZiAoIGV2dCApIHtcblx0XHRcdFx0XHRcdFx0Y29tcGxldGUoIGV2dC50eXBlID09PSBcImVycm9yXCIgPyA0MDQgOiAyMDAsIGV2dC50eXBlICk7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHQpO1xuXHRcdFx0XHRkb2N1bWVudC5oZWFkLmFwcGVuZENoaWxkKCBzY3JpcHRbIDAgXSApO1xuXHRcdFx0fSxcblx0XHRcdGFib3J0OiBmdW5jdGlvbigpIHtcblx0XHRcdFx0aWYgKCBjYWxsYmFjayApIHtcblx0XHRcdFx0XHRjYWxsYmFjaygpO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fTtcblx0fVxufSk7XG5cblxuXG5cbnZhciBvbGRDYWxsYmFja3MgPSBbXSxcblx0cmpzb25wID0gLyg9KVxcPyg/PSZ8JCl8XFw/XFw/LztcblxuLy8gRGVmYXVsdCBqc29ucCBzZXR0aW5nc1xualF1ZXJ5LmFqYXhTZXR1cCh7XG5cdGpzb25wOiBcImNhbGxiYWNrXCIsXG5cdGpzb25wQ2FsbGJhY2s6IGZ1bmN0aW9uKCkge1xuXHRcdHZhciBjYWxsYmFjayA9IG9sZENhbGxiYWNrcy5wb3AoKSB8fCAoIGpRdWVyeS5leHBhbmRvICsgXCJfXCIgKyAoIG5vbmNlKysgKSApO1xuXHRcdHRoaXNbIGNhbGxiYWNrIF0gPSB0cnVlO1xuXHRcdHJldHVybiBjYWxsYmFjaztcblx0fVxufSk7XG5cbi8vIERldGVjdCwgbm9ybWFsaXplIG9wdGlvbnMgYW5kIGluc3RhbGwgY2FsbGJhY2tzIGZvciBqc29ucCByZXF1ZXN0c1xualF1ZXJ5LmFqYXhQcmVmaWx0ZXIoIFwianNvbiBqc29ucFwiLCBmdW5jdGlvbiggcywgb3JpZ2luYWxTZXR0aW5ncywganFYSFIgKSB7XG5cblx0dmFyIGNhbGxiYWNrTmFtZSwgb3ZlcndyaXR0ZW4sIHJlc3BvbnNlQ29udGFpbmVyLFxuXHRcdGpzb25Qcm9wID0gcy5qc29ucCAhPT0gZmFsc2UgJiYgKCByanNvbnAudGVzdCggcy51cmwgKSA/XG5cdFx0XHRcInVybFwiIDpcblx0XHRcdHR5cGVvZiBzLmRhdGEgPT09IFwic3RyaW5nXCIgJiYgISggcy5jb250ZW50VHlwZSB8fCBcIlwiICkuaW5kZXhPZihcImFwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZFwiKSAmJiByanNvbnAudGVzdCggcy5kYXRhICkgJiYgXCJkYXRhXCJcblx0XHQpO1xuXG5cdC8vIEhhbmRsZSBpZmYgdGhlIGV4cGVjdGVkIGRhdGEgdHlwZSBpcyBcImpzb25wXCIgb3Igd2UgaGF2ZSBhIHBhcmFtZXRlciB0byBzZXRcblx0aWYgKCBqc29uUHJvcCB8fCBzLmRhdGFUeXBlc1sgMCBdID09PSBcImpzb25wXCIgKSB7XG5cblx0XHQvLyBHZXQgY2FsbGJhY2sgbmFtZSwgcmVtZW1iZXJpbmcgcHJlZXhpc3RpbmcgdmFsdWUgYXNzb2NpYXRlZCB3aXRoIGl0XG5cdFx0Y2FsbGJhY2tOYW1lID0gcy5qc29ucENhbGxiYWNrID0galF1ZXJ5LmlzRnVuY3Rpb24oIHMuanNvbnBDYWxsYmFjayApID9cblx0XHRcdHMuanNvbnBDYWxsYmFjaygpIDpcblx0XHRcdHMuanNvbnBDYWxsYmFjaztcblxuXHRcdC8vIEluc2VydCBjYWxsYmFjayBpbnRvIHVybCBvciBmb3JtIGRhdGFcblx0XHRpZiAoIGpzb25Qcm9wICkge1xuXHRcdFx0c1sganNvblByb3AgXSA9IHNbIGpzb25Qcm9wIF0ucmVwbGFjZSggcmpzb25wLCBcIiQxXCIgKyBjYWxsYmFja05hbWUgKTtcblx0XHR9IGVsc2UgaWYgKCBzLmpzb25wICE9PSBmYWxzZSApIHtcblx0XHRcdHMudXJsICs9ICggcnF1ZXJ5LnRlc3QoIHMudXJsICkgPyBcIiZcIiA6IFwiP1wiICkgKyBzLmpzb25wICsgXCI9XCIgKyBjYWxsYmFja05hbWU7XG5cdFx0fVxuXG5cdFx0Ly8gVXNlIGRhdGEgY29udmVydGVyIHRvIHJldHJpZXZlIGpzb24gYWZ0ZXIgc2NyaXB0IGV4ZWN1dGlvblxuXHRcdHMuY29udmVydGVyc1tcInNjcmlwdCBqc29uXCJdID0gZnVuY3Rpb24oKSB7XG5cdFx0XHRpZiAoICFyZXNwb25zZUNvbnRhaW5lciApIHtcblx0XHRcdFx0alF1ZXJ5LmVycm9yKCBjYWxsYmFja05hbWUgKyBcIiB3YXMgbm90IGNhbGxlZFwiICk7XG5cdFx0XHR9XG5cdFx0XHRyZXR1cm4gcmVzcG9uc2VDb250YWluZXJbIDAgXTtcblx0XHR9O1xuXG5cdFx0Ly8gZm9yY2UganNvbiBkYXRhVHlwZVxuXHRcdHMuZGF0YVR5cGVzWyAwIF0gPSBcImpzb25cIjtcblxuXHRcdC8vIEluc3RhbGwgY2FsbGJhY2tcblx0XHRvdmVyd3JpdHRlbiA9IHdpbmRvd1sgY2FsbGJhY2tOYW1lIF07XG5cdFx0d2luZG93WyBjYWxsYmFja05hbWUgXSA9IGZ1bmN0aW9uKCkge1xuXHRcdFx0cmVzcG9uc2VDb250YWluZXIgPSBhcmd1bWVudHM7XG5cdFx0fTtcblxuXHRcdC8vIENsZWFuLXVwIGZ1bmN0aW9uIChmaXJlcyBhZnRlciBjb252ZXJ0ZXJzKVxuXHRcdGpxWEhSLmFsd2F5cyhmdW5jdGlvbigpIHtcblx0XHRcdC8vIFJlc3RvcmUgcHJlZXhpc3RpbmcgdmFsdWVcblx0XHRcdHdpbmRvd1sgY2FsbGJhY2tOYW1lIF0gPSBvdmVyd3JpdHRlbjtcblxuXHRcdFx0Ly8gU2F2ZSBiYWNrIGFzIGZyZWVcblx0XHRcdGlmICggc1sgY2FsbGJhY2tOYW1lIF0gKSB7XG5cdFx0XHRcdC8vIG1ha2Ugc3VyZSB0aGF0IHJlLXVzaW5nIHRoZSBvcHRpb25zIGRvZXNuJ3Qgc2NyZXcgdGhpbmdzIGFyb3VuZFxuXHRcdFx0XHRzLmpzb25wQ2FsbGJhY2sgPSBvcmlnaW5hbFNldHRpbmdzLmpzb25wQ2FsbGJhY2s7XG5cblx0XHRcdFx0Ly8gc2F2ZSB0aGUgY2FsbGJhY2sgbmFtZSBmb3IgZnV0dXJlIHVzZVxuXHRcdFx0XHRvbGRDYWxsYmFja3MucHVzaCggY2FsbGJhY2tOYW1lICk7XG5cdFx0XHR9XG5cblx0XHRcdC8vIENhbGwgaWYgaXQgd2FzIGEgZnVuY3Rpb24gYW5kIHdlIGhhdmUgYSByZXNwb25zZVxuXHRcdFx0aWYgKCByZXNwb25zZUNvbnRhaW5lciAmJiBqUXVlcnkuaXNGdW5jdGlvbiggb3ZlcndyaXR0ZW4gKSApIHtcblx0XHRcdFx0b3ZlcndyaXR0ZW4oIHJlc3BvbnNlQ29udGFpbmVyWyAwIF0gKTtcblx0XHRcdH1cblxuXHRcdFx0cmVzcG9uc2VDb250YWluZXIgPSBvdmVyd3JpdHRlbiA9IHVuZGVmaW5lZDtcblx0XHR9KTtcblxuXHRcdC8vIERlbGVnYXRlIHRvIHNjcmlwdFxuXHRcdHJldHVybiBcInNjcmlwdFwiO1xuXHR9XG59KTtcblxuXG5cblxuLy8gZGF0YTogc3RyaW5nIG9mIGh0bWxcbi8vIGNvbnRleHQgKG9wdGlvbmFsKTogSWYgc3BlY2lmaWVkLCB0aGUgZnJhZ21lbnQgd2lsbCBiZSBjcmVhdGVkIGluIHRoaXMgY29udGV4dCwgZGVmYXVsdHMgdG8gZG9jdW1lbnRcbi8vIGtlZXBTY3JpcHRzIChvcHRpb25hbCk6IElmIHRydWUsIHdpbGwgaW5jbHVkZSBzY3JpcHRzIHBhc3NlZCBpbiB0aGUgaHRtbCBzdHJpbmdcbmpRdWVyeS5wYXJzZUhUTUwgPSBmdW5jdGlvbiggZGF0YSwgY29udGV4dCwga2VlcFNjcmlwdHMgKSB7XG5cdGlmICggIWRhdGEgfHwgdHlwZW9mIGRhdGEgIT09IFwic3RyaW5nXCIgKSB7XG5cdFx0cmV0dXJuIG51bGw7XG5cdH1cblx0aWYgKCB0eXBlb2YgY29udGV4dCA9PT0gXCJib29sZWFuXCIgKSB7XG5cdFx0a2VlcFNjcmlwdHMgPSBjb250ZXh0O1xuXHRcdGNvbnRleHQgPSBmYWxzZTtcblx0fVxuXHRjb250ZXh0ID0gY29udGV4dCB8fCBkb2N1bWVudDtcblxuXHR2YXIgcGFyc2VkID0gcnNpbmdsZVRhZy5leGVjKCBkYXRhICksXG5cdFx0c2NyaXB0cyA9ICFrZWVwU2NyaXB0cyAmJiBbXTtcblxuXHQvLyBTaW5nbGUgdGFnXG5cdGlmICggcGFyc2VkICkge1xuXHRcdHJldHVybiBbIGNvbnRleHQuY3JlYXRlRWxlbWVudCggcGFyc2VkWzFdICkgXTtcblx0fVxuXG5cdHBhcnNlZCA9IGpRdWVyeS5idWlsZEZyYWdtZW50KCBbIGRhdGEgXSwgY29udGV4dCwgc2NyaXB0cyApO1xuXG5cdGlmICggc2NyaXB0cyAmJiBzY3JpcHRzLmxlbmd0aCApIHtcblx0XHRqUXVlcnkoIHNjcmlwdHMgKS5yZW1vdmUoKTtcblx0fVxuXG5cdHJldHVybiBqUXVlcnkubWVyZ2UoIFtdLCBwYXJzZWQuY2hpbGROb2RlcyApO1xufTtcblxuXG4vLyBLZWVwIGEgY29weSBvZiB0aGUgb2xkIGxvYWQgbWV0aG9kXG52YXIgX2xvYWQgPSBqUXVlcnkuZm4ubG9hZDtcblxuLyoqXG4gKiBMb2FkIGEgdXJsIGludG8gYSBwYWdlXG4gKi9cbmpRdWVyeS5mbi5sb2FkID0gZnVuY3Rpb24oIHVybCwgcGFyYW1zLCBjYWxsYmFjayApIHtcblx0aWYgKCB0eXBlb2YgdXJsICE9PSBcInN0cmluZ1wiICYmIF9sb2FkICkge1xuXHRcdHJldHVybiBfbG9hZC5hcHBseSggdGhpcywgYXJndW1lbnRzICk7XG5cdH1cblxuXHR2YXIgc2VsZWN0b3IsIHR5cGUsIHJlc3BvbnNlLFxuXHRcdHNlbGYgPSB0aGlzLFxuXHRcdG9mZiA9IHVybC5pbmRleE9mKFwiIFwiKTtcblxuXHRpZiAoIG9mZiA+PSAwICkge1xuXHRcdHNlbGVjdG9yID0galF1ZXJ5LnRyaW0oIHVybC5zbGljZSggb2ZmICkgKTtcblx0XHR1cmwgPSB1cmwuc2xpY2UoIDAsIG9mZiApO1xuXHR9XG5cblx0Ly8gSWYgaXQncyBhIGZ1bmN0aW9uXG5cdGlmICggalF1ZXJ5LmlzRnVuY3Rpb24oIHBhcmFtcyApICkge1xuXG5cdFx0Ly8gV2UgYXNzdW1lIHRoYXQgaXQncyB0aGUgY2FsbGJhY2tcblx0XHRjYWxsYmFjayA9IHBhcmFtcztcblx0XHRwYXJhbXMgPSB1bmRlZmluZWQ7XG5cblx0Ly8gT3RoZXJ3aXNlLCBidWlsZCBhIHBhcmFtIHN0cmluZ1xuXHR9IGVsc2UgaWYgKCBwYXJhbXMgJiYgdHlwZW9mIHBhcmFtcyA9PT0gXCJvYmplY3RcIiApIHtcblx0XHR0eXBlID0gXCJQT1NUXCI7XG5cdH1cblxuXHQvLyBJZiB3ZSBoYXZlIGVsZW1lbnRzIHRvIG1vZGlmeSwgbWFrZSB0aGUgcmVxdWVzdFxuXHRpZiAoIHNlbGYubGVuZ3RoID4gMCApIHtcblx0XHRqUXVlcnkuYWpheCh7XG5cdFx0XHR1cmw6IHVybCxcblxuXHRcdFx0Ly8gaWYgXCJ0eXBlXCIgdmFyaWFibGUgaXMgdW5kZWZpbmVkLCB0aGVuIFwiR0VUXCIgbWV0aG9kIHdpbGwgYmUgdXNlZFxuXHRcdFx0dHlwZTogdHlwZSxcblx0XHRcdGRhdGFUeXBlOiBcImh0bWxcIixcblx0XHRcdGRhdGE6IHBhcmFtc1xuXHRcdH0pLmRvbmUoZnVuY3Rpb24oIHJlc3BvbnNlVGV4dCApIHtcblxuXHRcdFx0Ly8gU2F2ZSByZXNwb25zZSBmb3IgdXNlIGluIGNvbXBsZXRlIGNhbGxiYWNrXG5cdFx0XHRyZXNwb25zZSA9IGFyZ3VtZW50cztcblxuXHRcdFx0c2VsZi5odG1sKCBzZWxlY3RvciA/XG5cblx0XHRcdFx0Ly8gSWYgYSBzZWxlY3RvciB3YXMgc3BlY2lmaWVkLCBsb2NhdGUgdGhlIHJpZ2h0IGVsZW1lbnRzIGluIGEgZHVtbXkgZGl2XG5cdFx0XHRcdC8vIEV4Y2x1ZGUgc2NyaXB0cyB0byBhdm9pZCBJRSAnUGVybWlzc2lvbiBEZW5pZWQnIGVycm9yc1xuXHRcdFx0XHRqUXVlcnkoXCI8ZGl2PlwiKS5hcHBlbmQoIGpRdWVyeS5wYXJzZUhUTUwoIHJlc3BvbnNlVGV4dCApICkuZmluZCggc2VsZWN0b3IgKSA6XG5cblx0XHRcdFx0Ly8gT3RoZXJ3aXNlIHVzZSB0aGUgZnVsbCByZXN1bHRcblx0XHRcdFx0cmVzcG9uc2VUZXh0ICk7XG5cblx0XHR9KS5jb21wbGV0ZSggY2FsbGJhY2sgJiYgZnVuY3Rpb24oIGpxWEhSLCBzdGF0dXMgKSB7XG5cdFx0XHRzZWxmLmVhY2goIGNhbGxiYWNrLCByZXNwb25zZSB8fCBbIGpxWEhSLnJlc3BvbnNlVGV4dCwgc3RhdHVzLCBqcVhIUiBdICk7XG5cdFx0fSk7XG5cdH1cblxuXHRyZXR1cm4gdGhpcztcbn07XG5cblxuXG5cbi8vIEF0dGFjaCBhIGJ1bmNoIG9mIGZ1bmN0aW9ucyBmb3IgaGFuZGxpbmcgY29tbW9uIEFKQVggZXZlbnRzXG5qUXVlcnkuZWFjaCggWyBcImFqYXhTdGFydFwiLCBcImFqYXhTdG9wXCIsIFwiYWpheENvbXBsZXRlXCIsIFwiYWpheEVycm9yXCIsIFwiYWpheFN1Y2Nlc3NcIiwgXCJhamF4U2VuZFwiIF0sIGZ1bmN0aW9uKCBpLCB0eXBlICkge1xuXHRqUXVlcnkuZm5bIHR5cGUgXSA9IGZ1bmN0aW9uKCBmbiApIHtcblx0XHRyZXR1cm4gdGhpcy5vbiggdHlwZSwgZm4gKTtcblx0fTtcbn0pO1xuXG5cblxuXG5qUXVlcnkuZXhwci5maWx0ZXJzLmFuaW1hdGVkID0gZnVuY3Rpb24oIGVsZW0gKSB7XG5cdHJldHVybiBqUXVlcnkuZ3JlcChqUXVlcnkudGltZXJzLCBmdW5jdGlvbiggZm4gKSB7XG5cdFx0cmV0dXJuIGVsZW0gPT09IGZuLmVsZW07XG5cdH0pLmxlbmd0aDtcbn07XG5cblxuXG5cbnZhciBkb2NFbGVtID0gd2luZG93LmRvY3VtZW50LmRvY3VtZW50RWxlbWVudDtcblxuLyoqXG4gKiBHZXRzIGEgd2luZG93IGZyb20gYW4gZWxlbWVudFxuICovXG5mdW5jdGlvbiBnZXRXaW5kb3coIGVsZW0gKSB7XG5cdHJldHVybiBqUXVlcnkuaXNXaW5kb3coIGVsZW0gKSA/IGVsZW0gOiBlbGVtLm5vZGVUeXBlID09PSA5ICYmIGVsZW0uZGVmYXVsdFZpZXc7XG59XG5cbmpRdWVyeS5vZmZzZXQgPSB7XG5cdHNldE9mZnNldDogZnVuY3Rpb24oIGVsZW0sIG9wdGlvbnMsIGkgKSB7XG5cdFx0dmFyIGN1clBvc2l0aW9uLCBjdXJMZWZ0LCBjdXJDU1NUb3AsIGN1clRvcCwgY3VyT2Zmc2V0LCBjdXJDU1NMZWZ0LCBjYWxjdWxhdGVQb3NpdGlvbixcblx0XHRcdHBvc2l0aW9uID0galF1ZXJ5LmNzcyggZWxlbSwgXCJwb3NpdGlvblwiICksXG5cdFx0XHRjdXJFbGVtID0galF1ZXJ5KCBlbGVtICksXG5cdFx0XHRwcm9wcyA9IHt9O1xuXG5cdFx0Ly8gU2V0IHBvc2l0aW9uIGZpcnN0LCBpbi1jYXNlIHRvcC9sZWZ0IGFyZSBzZXQgZXZlbiBvbiBzdGF0aWMgZWxlbVxuXHRcdGlmICggcG9zaXRpb24gPT09IFwic3RhdGljXCIgKSB7XG5cdFx0XHRlbGVtLnN0eWxlLnBvc2l0aW9uID0gXCJyZWxhdGl2ZVwiO1xuXHRcdH1cblxuXHRcdGN1ck9mZnNldCA9IGN1ckVsZW0ub2Zmc2V0KCk7XG5cdFx0Y3VyQ1NTVG9wID0galF1ZXJ5LmNzcyggZWxlbSwgXCJ0b3BcIiApO1xuXHRcdGN1ckNTU0xlZnQgPSBqUXVlcnkuY3NzKCBlbGVtLCBcImxlZnRcIiApO1xuXHRcdGNhbGN1bGF0ZVBvc2l0aW9uID0gKCBwb3NpdGlvbiA9PT0gXCJhYnNvbHV0ZVwiIHx8IHBvc2l0aW9uID09PSBcImZpeGVkXCIgKSAmJlxuXHRcdFx0KCBjdXJDU1NUb3AgKyBjdXJDU1NMZWZ0ICkuaW5kZXhPZihcImF1dG9cIikgPiAtMTtcblxuXHRcdC8vIE5lZWQgdG8gYmUgYWJsZSB0byBjYWxjdWxhdGUgcG9zaXRpb24gaWYgZWl0aGVyXG5cdFx0Ly8gdG9wIG9yIGxlZnQgaXMgYXV0byBhbmQgcG9zaXRpb24gaXMgZWl0aGVyIGFic29sdXRlIG9yIGZpeGVkXG5cdFx0aWYgKCBjYWxjdWxhdGVQb3NpdGlvbiApIHtcblx0XHRcdGN1clBvc2l0aW9uID0gY3VyRWxlbS5wb3NpdGlvbigpO1xuXHRcdFx0Y3VyVG9wID0gY3VyUG9zaXRpb24udG9wO1xuXHRcdFx0Y3VyTGVmdCA9IGN1clBvc2l0aW9uLmxlZnQ7XG5cblx0XHR9IGVsc2Uge1xuXHRcdFx0Y3VyVG9wID0gcGFyc2VGbG9hdCggY3VyQ1NTVG9wICkgfHwgMDtcblx0XHRcdGN1ckxlZnQgPSBwYXJzZUZsb2F0KCBjdXJDU1NMZWZ0ICkgfHwgMDtcblx0XHR9XG5cblx0XHRpZiAoIGpRdWVyeS5pc0Z1bmN0aW9uKCBvcHRpb25zICkgKSB7XG5cdFx0XHRvcHRpb25zID0gb3B0aW9ucy5jYWxsKCBlbGVtLCBpLCBjdXJPZmZzZXQgKTtcblx0XHR9XG5cblx0XHRpZiAoIG9wdGlvbnMudG9wICE9IG51bGwgKSB7XG5cdFx0XHRwcm9wcy50b3AgPSAoIG9wdGlvbnMudG9wIC0gY3VyT2Zmc2V0LnRvcCApICsgY3VyVG9wO1xuXHRcdH1cblx0XHRpZiAoIG9wdGlvbnMubGVmdCAhPSBudWxsICkge1xuXHRcdFx0cHJvcHMubGVmdCA9ICggb3B0aW9ucy5sZWZ0IC0gY3VyT2Zmc2V0LmxlZnQgKSArIGN1ckxlZnQ7XG5cdFx0fVxuXG5cdFx0aWYgKCBcInVzaW5nXCIgaW4gb3B0aW9ucyApIHtcblx0XHRcdG9wdGlvbnMudXNpbmcuY2FsbCggZWxlbSwgcHJvcHMgKTtcblxuXHRcdH0gZWxzZSB7XG5cdFx0XHRjdXJFbGVtLmNzcyggcHJvcHMgKTtcblx0XHR9XG5cdH1cbn07XG5cbmpRdWVyeS5mbi5leHRlbmQoe1xuXHRvZmZzZXQ6IGZ1bmN0aW9uKCBvcHRpb25zICkge1xuXHRcdGlmICggYXJndW1lbnRzLmxlbmd0aCApIHtcblx0XHRcdHJldHVybiBvcHRpb25zID09PSB1bmRlZmluZWQgP1xuXHRcdFx0XHR0aGlzIDpcblx0XHRcdFx0dGhpcy5lYWNoKGZ1bmN0aW9uKCBpICkge1xuXHRcdFx0XHRcdGpRdWVyeS5vZmZzZXQuc2V0T2Zmc2V0KCB0aGlzLCBvcHRpb25zLCBpICk7XG5cdFx0XHRcdH0pO1xuXHRcdH1cblxuXHRcdHZhciBkb2NFbGVtLCB3aW4sXG5cdFx0XHRlbGVtID0gdGhpc1sgMCBdLFxuXHRcdFx0Ym94ID0geyB0b3A6IDAsIGxlZnQ6IDAgfSxcblx0XHRcdGRvYyA9IGVsZW0gJiYgZWxlbS5vd25lckRvY3VtZW50O1xuXG5cdFx0aWYgKCAhZG9jICkge1xuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblxuXHRcdGRvY0VsZW0gPSBkb2MuZG9jdW1lbnRFbGVtZW50O1xuXG5cdFx0Ly8gTWFrZSBzdXJlIGl0J3Mgbm90IGEgZGlzY29ubmVjdGVkIERPTSBub2RlXG5cdFx0aWYgKCAhalF1ZXJ5LmNvbnRhaW5zKCBkb2NFbGVtLCBlbGVtICkgKSB7XG5cdFx0XHRyZXR1cm4gYm94O1xuXHRcdH1cblxuXHRcdC8vIFN1cHBvcnQ6IEJsYWNrQmVycnkgNSwgaU9TIDMgKG9yaWdpbmFsIGlQaG9uZSlcblx0XHQvLyBJZiB3ZSBkb24ndCBoYXZlIGdCQ1IsIGp1c3QgdXNlIDAsMCByYXRoZXIgdGhhbiBlcnJvclxuXHRcdGlmICggdHlwZW9mIGVsZW0uZ2V0Qm91bmRpbmdDbGllbnRSZWN0ICE9PSBzdHJ1bmRlZmluZWQgKSB7XG5cdFx0XHRib3ggPSBlbGVtLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xuXHRcdH1cblx0XHR3aW4gPSBnZXRXaW5kb3coIGRvYyApO1xuXHRcdHJldHVybiB7XG5cdFx0XHR0b3A6IGJveC50b3AgKyB3aW4ucGFnZVlPZmZzZXQgLSBkb2NFbGVtLmNsaWVudFRvcCxcblx0XHRcdGxlZnQ6IGJveC5sZWZ0ICsgd2luLnBhZ2VYT2Zmc2V0IC0gZG9jRWxlbS5jbGllbnRMZWZ0XG5cdFx0fTtcblx0fSxcblxuXHRwb3NpdGlvbjogZnVuY3Rpb24oKSB7XG5cdFx0aWYgKCAhdGhpc1sgMCBdICkge1xuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblxuXHRcdHZhciBvZmZzZXRQYXJlbnQsIG9mZnNldCxcblx0XHRcdGVsZW0gPSB0aGlzWyAwIF0sXG5cdFx0XHRwYXJlbnRPZmZzZXQgPSB7IHRvcDogMCwgbGVmdDogMCB9O1xuXG5cdFx0Ly8gRml4ZWQgZWxlbWVudHMgYXJlIG9mZnNldCBmcm9tIHdpbmRvdyAocGFyZW50T2Zmc2V0ID0ge3RvcDowLCBsZWZ0OiAwfSwgYmVjYXVzZSBpdCBpcyBpdHMgb25seSBvZmZzZXQgcGFyZW50XG5cdFx0aWYgKCBqUXVlcnkuY3NzKCBlbGVtLCBcInBvc2l0aW9uXCIgKSA9PT0gXCJmaXhlZFwiICkge1xuXHRcdFx0Ly8gQXNzdW1lIGdldEJvdW5kaW5nQ2xpZW50UmVjdCBpcyB0aGVyZSB3aGVuIGNvbXB1dGVkIHBvc2l0aW9uIGlzIGZpeGVkXG5cdFx0XHRvZmZzZXQgPSBlbGVtLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xuXG5cdFx0fSBlbHNlIHtcblx0XHRcdC8vIEdldCAqcmVhbCogb2Zmc2V0UGFyZW50XG5cdFx0XHRvZmZzZXRQYXJlbnQgPSB0aGlzLm9mZnNldFBhcmVudCgpO1xuXG5cdFx0XHQvLyBHZXQgY29ycmVjdCBvZmZzZXRzXG5cdFx0XHRvZmZzZXQgPSB0aGlzLm9mZnNldCgpO1xuXHRcdFx0aWYgKCAhalF1ZXJ5Lm5vZGVOYW1lKCBvZmZzZXRQYXJlbnRbIDAgXSwgXCJodG1sXCIgKSApIHtcblx0XHRcdFx0cGFyZW50T2Zmc2V0ID0gb2Zmc2V0UGFyZW50Lm9mZnNldCgpO1xuXHRcdFx0fVxuXG5cdFx0XHQvLyBBZGQgb2Zmc2V0UGFyZW50IGJvcmRlcnNcblx0XHRcdHBhcmVudE9mZnNldC50b3AgKz0galF1ZXJ5LmNzcyggb2Zmc2V0UGFyZW50WyAwIF0sIFwiYm9yZGVyVG9wV2lkdGhcIiwgdHJ1ZSApO1xuXHRcdFx0cGFyZW50T2Zmc2V0LmxlZnQgKz0galF1ZXJ5LmNzcyggb2Zmc2V0UGFyZW50WyAwIF0sIFwiYm9yZGVyTGVmdFdpZHRoXCIsIHRydWUgKTtcblx0XHR9XG5cblx0XHQvLyBTdWJ0cmFjdCBwYXJlbnQgb2Zmc2V0cyBhbmQgZWxlbWVudCBtYXJnaW5zXG5cdFx0cmV0dXJuIHtcblx0XHRcdHRvcDogb2Zmc2V0LnRvcCAtIHBhcmVudE9mZnNldC50b3AgLSBqUXVlcnkuY3NzKCBlbGVtLCBcIm1hcmdpblRvcFwiLCB0cnVlICksXG5cdFx0XHRsZWZ0OiBvZmZzZXQubGVmdCAtIHBhcmVudE9mZnNldC5sZWZ0IC0galF1ZXJ5LmNzcyggZWxlbSwgXCJtYXJnaW5MZWZ0XCIsIHRydWUgKVxuXHRcdH07XG5cdH0sXG5cblx0b2Zmc2V0UGFyZW50OiBmdW5jdGlvbigpIHtcblx0XHRyZXR1cm4gdGhpcy5tYXAoZnVuY3Rpb24oKSB7XG5cdFx0XHR2YXIgb2Zmc2V0UGFyZW50ID0gdGhpcy5vZmZzZXRQYXJlbnQgfHwgZG9jRWxlbTtcblxuXHRcdFx0d2hpbGUgKCBvZmZzZXRQYXJlbnQgJiYgKCAhalF1ZXJ5Lm5vZGVOYW1lKCBvZmZzZXRQYXJlbnQsIFwiaHRtbFwiICkgJiYgalF1ZXJ5LmNzcyggb2Zmc2V0UGFyZW50LCBcInBvc2l0aW9uXCIgKSA9PT0gXCJzdGF0aWNcIiApICkge1xuXHRcdFx0XHRvZmZzZXRQYXJlbnQgPSBvZmZzZXRQYXJlbnQub2Zmc2V0UGFyZW50O1xuXHRcdFx0fVxuXG5cdFx0XHRyZXR1cm4gb2Zmc2V0UGFyZW50IHx8IGRvY0VsZW07XG5cdFx0fSk7XG5cdH1cbn0pO1xuXG4vLyBDcmVhdGUgc2Nyb2xsTGVmdCBhbmQgc2Nyb2xsVG9wIG1ldGhvZHNcbmpRdWVyeS5lYWNoKCB7IHNjcm9sbExlZnQ6IFwicGFnZVhPZmZzZXRcIiwgc2Nyb2xsVG9wOiBcInBhZ2VZT2Zmc2V0XCIgfSwgZnVuY3Rpb24oIG1ldGhvZCwgcHJvcCApIHtcblx0dmFyIHRvcCA9IFwicGFnZVlPZmZzZXRcIiA9PT0gcHJvcDtcblxuXHRqUXVlcnkuZm5bIG1ldGhvZCBdID0gZnVuY3Rpb24oIHZhbCApIHtcblx0XHRyZXR1cm4gYWNjZXNzKCB0aGlzLCBmdW5jdGlvbiggZWxlbSwgbWV0aG9kLCB2YWwgKSB7XG5cdFx0XHR2YXIgd2luID0gZ2V0V2luZG93KCBlbGVtICk7XG5cblx0XHRcdGlmICggdmFsID09PSB1bmRlZmluZWQgKSB7XG5cdFx0XHRcdHJldHVybiB3aW4gPyB3aW5bIHByb3AgXSA6IGVsZW1bIG1ldGhvZCBdO1xuXHRcdFx0fVxuXG5cdFx0XHRpZiAoIHdpbiApIHtcblx0XHRcdFx0d2luLnNjcm9sbFRvKFxuXHRcdFx0XHRcdCF0b3AgPyB2YWwgOiB3aW5kb3cucGFnZVhPZmZzZXQsXG5cdFx0XHRcdFx0dG9wID8gdmFsIDogd2luZG93LnBhZ2VZT2Zmc2V0XG5cdFx0XHRcdCk7XG5cblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdGVsZW1bIG1ldGhvZCBdID0gdmFsO1xuXHRcdFx0fVxuXHRcdH0sIG1ldGhvZCwgdmFsLCBhcmd1bWVudHMubGVuZ3RoLCBudWxsICk7XG5cdH07XG59KTtcblxuLy8gU3VwcG9ydDogU2FmYXJpPDcrLCBDaHJvbWU8MzcrXG4vLyBBZGQgdGhlIHRvcC9sZWZ0IGNzc0hvb2tzIHVzaW5nIGpRdWVyeS5mbi5wb3NpdGlvblxuLy8gV2Via2l0IGJ1ZzogaHR0cHM6Ly9idWdzLndlYmtpdC5vcmcvc2hvd19idWcuY2dpP2lkPTI5MDg0XG4vLyBCbGluayBidWc6IGh0dHBzOi8vY29kZS5nb29nbGUuY29tL3AvY2hyb21pdW0vaXNzdWVzL2RldGFpbD9pZD0yMjkyODBcbi8vIGdldENvbXB1dGVkU3R5bGUgcmV0dXJucyBwZXJjZW50IHdoZW4gc3BlY2lmaWVkIGZvciB0b3AvbGVmdC9ib3R0b20vcmlnaHQ7XG4vLyByYXRoZXIgdGhhbiBtYWtlIHRoZSBjc3MgbW9kdWxlIGRlcGVuZCBvbiB0aGUgb2Zmc2V0IG1vZHVsZSwganVzdCBjaGVjayBmb3IgaXQgaGVyZVxualF1ZXJ5LmVhY2goIFsgXCJ0b3BcIiwgXCJsZWZ0XCIgXSwgZnVuY3Rpb24oIGksIHByb3AgKSB7XG5cdGpRdWVyeS5jc3NIb29rc1sgcHJvcCBdID0gYWRkR2V0SG9va0lmKCBzdXBwb3J0LnBpeGVsUG9zaXRpb24sXG5cdFx0ZnVuY3Rpb24oIGVsZW0sIGNvbXB1dGVkICkge1xuXHRcdFx0aWYgKCBjb21wdXRlZCApIHtcblx0XHRcdFx0Y29tcHV0ZWQgPSBjdXJDU1MoIGVsZW0sIHByb3AgKTtcblx0XHRcdFx0Ly8gSWYgY3VyQ1NTIHJldHVybnMgcGVyY2VudGFnZSwgZmFsbGJhY2sgdG8gb2Zmc2V0XG5cdFx0XHRcdHJldHVybiBybnVtbm9ucHgudGVzdCggY29tcHV0ZWQgKSA/XG5cdFx0XHRcdFx0alF1ZXJ5KCBlbGVtICkucG9zaXRpb24oKVsgcHJvcCBdICsgXCJweFwiIDpcblx0XHRcdFx0XHRjb21wdXRlZDtcblx0XHRcdH1cblx0XHR9XG5cdCk7XG59KTtcblxuXG4vLyBDcmVhdGUgaW5uZXJIZWlnaHQsIGlubmVyV2lkdGgsIGhlaWdodCwgd2lkdGgsIG91dGVySGVpZ2h0IGFuZCBvdXRlcldpZHRoIG1ldGhvZHNcbmpRdWVyeS5lYWNoKCB7IEhlaWdodDogXCJoZWlnaHRcIiwgV2lkdGg6IFwid2lkdGhcIiB9LCBmdW5jdGlvbiggbmFtZSwgdHlwZSApIHtcblx0alF1ZXJ5LmVhY2goIHsgcGFkZGluZzogXCJpbm5lclwiICsgbmFtZSwgY29udGVudDogdHlwZSwgXCJcIjogXCJvdXRlclwiICsgbmFtZSB9LCBmdW5jdGlvbiggZGVmYXVsdEV4dHJhLCBmdW5jTmFtZSApIHtcblx0XHQvLyBNYXJnaW4gaXMgb25seSBmb3Igb3V0ZXJIZWlnaHQsIG91dGVyV2lkdGhcblx0XHRqUXVlcnkuZm5bIGZ1bmNOYW1lIF0gPSBmdW5jdGlvbiggbWFyZ2luLCB2YWx1ZSApIHtcblx0XHRcdHZhciBjaGFpbmFibGUgPSBhcmd1bWVudHMubGVuZ3RoICYmICggZGVmYXVsdEV4dHJhIHx8IHR5cGVvZiBtYXJnaW4gIT09IFwiYm9vbGVhblwiICksXG5cdFx0XHRcdGV4dHJhID0gZGVmYXVsdEV4dHJhIHx8ICggbWFyZ2luID09PSB0cnVlIHx8IHZhbHVlID09PSB0cnVlID8gXCJtYXJnaW5cIiA6IFwiYm9yZGVyXCIgKTtcblxuXHRcdFx0cmV0dXJuIGFjY2VzcyggdGhpcywgZnVuY3Rpb24oIGVsZW0sIHR5cGUsIHZhbHVlICkge1xuXHRcdFx0XHR2YXIgZG9jO1xuXG5cdFx0XHRcdGlmICggalF1ZXJ5LmlzV2luZG93KCBlbGVtICkgKSB7XG5cdFx0XHRcdFx0Ly8gQXMgb2YgNS84LzIwMTIgdGhpcyB3aWxsIHlpZWxkIGluY29ycmVjdCByZXN1bHRzIGZvciBNb2JpbGUgU2FmYXJpLCBidXQgdGhlcmVcblx0XHRcdFx0XHQvLyBpc24ndCBhIHdob2xlIGxvdCB3ZSBjYW4gZG8uIFNlZSBwdWxsIHJlcXVlc3QgYXQgdGhpcyBVUkwgZm9yIGRpc2N1c3Npb246XG5cdFx0XHRcdFx0Ly8gaHR0cHM6Ly9naXRodWIuY29tL2pxdWVyeS9qcXVlcnkvcHVsbC83NjRcblx0XHRcdFx0XHRyZXR1cm4gZWxlbS5kb2N1bWVudC5kb2N1bWVudEVsZW1lbnRbIFwiY2xpZW50XCIgKyBuYW1lIF07XG5cdFx0XHRcdH1cblxuXHRcdFx0XHQvLyBHZXQgZG9jdW1lbnQgd2lkdGggb3IgaGVpZ2h0XG5cdFx0XHRcdGlmICggZWxlbS5ub2RlVHlwZSA9PT0gOSApIHtcblx0XHRcdFx0XHRkb2MgPSBlbGVtLmRvY3VtZW50RWxlbWVudDtcblxuXHRcdFx0XHRcdC8vIEVpdGhlciBzY3JvbGxbV2lkdGgvSGVpZ2h0XSBvciBvZmZzZXRbV2lkdGgvSGVpZ2h0XSBvciBjbGllbnRbV2lkdGgvSGVpZ2h0XSxcblx0XHRcdFx0XHQvLyB3aGljaGV2ZXIgaXMgZ3JlYXRlc3Rcblx0XHRcdFx0XHRyZXR1cm4gTWF0aC5tYXgoXG5cdFx0XHRcdFx0XHRlbGVtLmJvZHlbIFwic2Nyb2xsXCIgKyBuYW1lIF0sIGRvY1sgXCJzY3JvbGxcIiArIG5hbWUgXSxcblx0XHRcdFx0XHRcdGVsZW0uYm9keVsgXCJvZmZzZXRcIiArIG5hbWUgXSwgZG9jWyBcIm9mZnNldFwiICsgbmFtZSBdLFxuXHRcdFx0XHRcdFx0ZG9jWyBcImNsaWVudFwiICsgbmFtZSBdXG5cdFx0XHRcdFx0KTtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdHJldHVybiB2YWx1ZSA9PT0gdW5kZWZpbmVkID9cblx0XHRcdFx0XHQvLyBHZXQgd2lkdGggb3IgaGVpZ2h0IG9uIHRoZSBlbGVtZW50LCByZXF1ZXN0aW5nIGJ1dCBub3QgZm9yY2luZyBwYXJzZUZsb2F0XG5cdFx0XHRcdFx0alF1ZXJ5LmNzcyggZWxlbSwgdHlwZSwgZXh0cmEgKSA6XG5cblx0XHRcdFx0XHQvLyBTZXQgd2lkdGggb3IgaGVpZ2h0IG9uIHRoZSBlbGVtZW50XG5cdFx0XHRcdFx0alF1ZXJ5LnN0eWxlKCBlbGVtLCB0eXBlLCB2YWx1ZSwgZXh0cmEgKTtcblx0XHRcdH0sIHR5cGUsIGNoYWluYWJsZSA/IG1hcmdpbiA6IHVuZGVmaW5lZCwgY2hhaW5hYmxlLCBudWxsICk7XG5cdFx0fTtcblx0fSk7XG59KTtcblxuXG4vLyBUaGUgbnVtYmVyIG9mIGVsZW1lbnRzIGNvbnRhaW5lZCBpbiB0aGUgbWF0Y2hlZCBlbGVtZW50IHNldFxualF1ZXJ5LmZuLnNpemUgPSBmdW5jdGlvbigpIHtcblx0cmV0dXJuIHRoaXMubGVuZ3RoO1xufTtcblxualF1ZXJ5LmZuLmFuZFNlbGYgPSBqUXVlcnkuZm4uYWRkQmFjaztcblxuXG5cblxuLy8gUmVnaXN0ZXIgYXMgYSBuYW1lZCBBTUQgbW9kdWxlLCBzaW5jZSBqUXVlcnkgY2FuIGJlIGNvbmNhdGVuYXRlZCB3aXRoIG90aGVyXG4vLyBmaWxlcyB0aGF0IG1heSB1c2UgZGVmaW5lLCBidXQgbm90IHZpYSBhIHByb3BlciBjb25jYXRlbmF0aW9uIHNjcmlwdCB0aGF0XG4vLyB1bmRlcnN0YW5kcyBhbm9ueW1vdXMgQU1EIG1vZHVsZXMuIEEgbmFtZWQgQU1EIGlzIHNhZmVzdCBhbmQgbW9zdCByb2J1c3Rcbi8vIHdheSB0byByZWdpc3Rlci4gTG93ZXJjYXNlIGpxdWVyeSBpcyB1c2VkIGJlY2F1c2UgQU1EIG1vZHVsZSBuYW1lcyBhcmVcbi8vIGRlcml2ZWQgZnJvbSBmaWxlIG5hbWVzLCBhbmQgalF1ZXJ5IGlzIG5vcm1hbGx5IGRlbGl2ZXJlZCBpbiBhIGxvd2VyY2FzZVxuLy8gZmlsZSBuYW1lLiBEbyB0aGlzIGFmdGVyIGNyZWF0aW5nIHRoZSBnbG9iYWwgc28gdGhhdCBpZiBhbiBBTUQgbW9kdWxlIHdhbnRzXG4vLyB0byBjYWxsIG5vQ29uZmxpY3QgdG8gaGlkZSB0aGlzIHZlcnNpb24gb2YgalF1ZXJ5LCBpdCB3aWxsIHdvcmsuXG5cbi8vIE5vdGUgdGhhdCBmb3IgbWF4aW11bSBwb3J0YWJpbGl0eSwgbGlicmFyaWVzIHRoYXQgYXJlIG5vdCBqUXVlcnkgc2hvdWxkXG4vLyBkZWNsYXJlIHRoZW1zZWx2ZXMgYXMgYW5vbnltb3VzIG1vZHVsZXMsIGFuZCBhdm9pZCBzZXR0aW5nIGEgZ2xvYmFsIGlmIGFuXG4vLyBBTUQgbG9hZGVyIGlzIHByZXNlbnQuIGpRdWVyeSBpcyBhIHNwZWNpYWwgY2FzZS4gRm9yIG1vcmUgaW5mb3JtYXRpb24sIHNlZVxuLy8gaHR0cHM6Ly9naXRodWIuY29tL2pyYnVya2UvcmVxdWlyZWpzL3dpa2kvVXBkYXRpbmctZXhpc3RpbmctbGlicmFyaWVzI3dpa2ktYW5vblxuXG5pZiAoIHR5cGVvZiBkZWZpbmUgPT09IFwiZnVuY3Rpb25cIiAmJiBkZWZpbmUuYW1kICkge1xuXHRkZWZpbmUoIFwianF1ZXJ5XCIsIFtdLCBmdW5jdGlvbigpIHtcblx0XHRyZXR1cm4galF1ZXJ5O1xuXHR9KTtcbn1cblxuXG5cblxudmFyXG5cdC8vIE1hcCBvdmVyIGpRdWVyeSBpbiBjYXNlIG9mIG92ZXJ3cml0ZVxuXHRfalF1ZXJ5ID0gd2luZG93LmpRdWVyeSxcblxuXHQvLyBNYXAgb3ZlciB0aGUgJCBpbiBjYXNlIG9mIG92ZXJ3cml0ZVxuXHRfJCA9IHdpbmRvdy4kO1xuXG5qUXVlcnkubm9Db25mbGljdCA9IGZ1bmN0aW9uKCBkZWVwICkge1xuXHRpZiAoIHdpbmRvdy4kID09PSBqUXVlcnkgKSB7XG5cdFx0d2luZG93LiQgPSBfJDtcblx0fVxuXG5cdGlmICggZGVlcCAmJiB3aW5kb3cualF1ZXJ5ID09PSBqUXVlcnkgKSB7XG5cdFx0d2luZG93LmpRdWVyeSA9IF9qUXVlcnk7XG5cdH1cblxuXHRyZXR1cm4galF1ZXJ5O1xufTtcblxuLy8gRXhwb3NlIGpRdWVyeSBhbmQgJCBpZGVudGlmaWVycywgZXZlbiBpbiBBTURcbi8vICgjNzEwMiNjb21tZW50OjEwLCBodHRwczovL2dpdGh1Yi5jb20vanF1ZXJ5L2pxdWVyeS9wdWxsLzU1Nylcbi8vIGFuZCBDb21tb25KUyBmb3IgYnJvd3NlciBlbXVsYXRvcnMgKCMxMzU2NilcbmlmICggdHlwZW9mIG5vR2xvYmFsID09PSBzdHJ1bmRlZmluZWQgKSB7XG5cdHdpbmRvdy5qUXVlcnkgPSB3aW5kb3cuJCA9IGpRdWVyeTtcbn1cblxuXG5cblxucmV0dXJuIGpRdWVyeTtcblxufSkpO1xuIiwiLy8gaHR0cDovL3N0YWNrb3ZlcmZsb3cuY29tL3F1ZXN0aW9ucy84Mzk4OTkvaG93LWRvLWktY2FsY3VsYXRlLWEtcG9pbnQtb24tYS1jaXJjbGVzLWNpcmN1bWZlcmVuY2Vcbi8vIHJhZGlhbnMgPSBkZWdyZWVzICogKHBpLzE4MClcbi8vIGh0dHBzOi8vZ2l0aHViLmNvbS9iam9ybmhhcnJ0ZWxsL2pzdHMvYmxvYi9tYXN0ZXIvZXhhbXBsZXMvYnVmZmVyLmh0bWxcblxudmFyIGZlYXR1cmVjb2xsZWN0aW9uID0gcmVxdWlyZSgndHVyZi1mZWF0dXJlY29sbGVjdGlvbicpO1xudmFyIGpzdHMgPSByZXF1aXJlKCdqc3RzJyk7XG52YXIgbm9ybWFsaXplID0gcmVxdWlyZSgnZ2VvanNvbi1ub3JtYWxpemUnKTtcblxuLyoqXG4qIENhbGN1bGF0ZXMgYSBidWZmZXIgZm9yIGlucHV0IGZlYXR1cmVzIGZvciBhIGdpdmVuIHJhZGl1cy4gVW5pdHMgc3VwcG9ydGVkIGFyZSBtaWxlcywga2lsb21ldGVycywgYW5kIGRlZ3JlZXMuXG4qXG4qIEBtb2R1bGUgdHVyZi9idWZmZXJcbiogQGNhdGVnb3J5IHRyYW5zZm9ybWF0aW9uXG4qIEBwYXJhbSB7KEZlYXR1cmV8RmVhdHVyZUNvbGxlY3Rpb24pfSBmZWF0dXJlIGlucHV0IHRvIGJlIGJ1ZmZlcmVkXG4qIEBwYXJhbSB7TnVtYmVyfSBkaXN0YW5jZSBkaXN0YW5jZSB0byBkcmF3IHRoZSBidWZmZXJcbiogQHBhcmFtIHtTdHJpbmd9IHVuaXQgJ21pbGVzJywgJ2ZlZXQnLCAna2lsb21ldGVycycsICdtZXRlcnMnLCBvciAnZGVncmVlcydcbiogQHJldHVybiB7RmVhdHVyZUNvbGxlY3Rpb248UG9seWdvbj58RmVhdHVyZUNvbGxlY3Rpb248TXVsdGlQb2x5Z29uPnxQb2x5Z29ufE11bHRpUG9seWdvbn0gYnVmZmVyZWQgZmVhdHVyZXNcbipcbiogQGV4YW1wbGVcbiogdmFyIHB0ID0ge1xuKiAgIFwidHlwZVwiOiBcIkZlYXR1cmVcIixcbiogICBcInByb3BlcnRpZXNcIjoge30sXG4qICAgXCJnZW9tZXRyeVwiOiB7XG4qICAgICBcInR5cGVcIjogXCJQb2ludFwiLFxuKiAgICAgXCJjb29yZGluYXRlc1wiOiBbLTkwLjU0ODYzMCwgMTQuNjE2NTk5XVxuKiAgIH1cbiogfTtcbiogdmFyIHVuaXQgPSAnbWlsZXMnO1xuKlxuKiB2YXIgYnVmZmVyZWQgPSB0dXJmLmJ1ZmZlcihwdCwgNTAwLCB1bml0KTtcbiogdmFyIHJlc3VsdCA9IHR1cmYuZmVhdHVyZWNvbGxlY3Rpb24oW2J1ZmZlcmVkLCBwdF0pO1xuKlxuKiAvLz1yZXN1bHRcbiovXG5cbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oZmVhdHVyZSwgcmFkaXVzLCB1bml0cykge1xuXG4gIHN3aXRjaCAodW5pdHMpIHtcbiAgICBjYXNlICdtaWxlcyc6XG4gICAgICByYWRpdXMgPSByYWRpdXMgLyA2OS4wNDc7XG4gICAgYnJlYWs7XG4gICAgY2FzZSAnZmVldCc6XG4gICAgICByYWRpdXMgPSByYWRpdXMgLyAzNjQ1NjguMDtcbiAgICBicmVhaztcbiAgICBjYXNlICdraWxvbWV0ZXJzJzpcbiAgICAgIHJhZGl1cyA9IHJhZGl1cyAvIDExMS4xMjtcbiAgICBicmVhaztcbiAgICBjYXNlICdtZXRlcnMnOlxuICAgICAgcmFkaXVzID0gcmFkaXVzIC8gMTExMTIwLjA7XG4gICAgYnJlYWs7XG4gICAgY2FzZSAnZGVncmVlcyc6XG4gICAgYnJlYWs7XG4gIH1cblxuICB2YXIgZmMgPSBub3JtYWxpemUoZmVhdHVyZSk7XG4gIHZhciBidWZmZXJlZCA9IG5vcm1hbGl6ZShmZWF0dXJlY29sbGVjdGlvbihmYy5mZWF0dXJlcy5tYXAoZnVuY3Rpb24oZikge1xuICAgIHJldHVybiBidWZmZXJPcChmLCByYWRpdXMpO1xuICB9KSkpO1xuXG4gIGlmKGJ1ZmZlcmVkLmZlYXR1cmVzLmxlbmd0aCA+IDEpIHJldHVybiBidWZmZXJlZDtcbiAgZWxzZSBpZihidWZmZXJlZC5mZWF0dXJlcy5sZW5ndGggPT09IDEpIHJldHVybiBidWZmZXJlZC5mZWF0dXJlc1swXTtcbn07XG5cbnZhciBidWZmZXJPcCA9IGZ1bmN0aW9uKGZlYXR1cmUsIHJhZGl1cykge1xuICB2YXIgcmVhZGVyID0gbmV3IGpzdHMuaW8uR2VvSlNPTlJlYWRlcigpO1xuICB2YXIgZ2VvbSA9IHJlYWRlci5yZWFkKEpTT04uc3RyaW5naWZ5KGZlYXR1cmUuZ2VvbWV0cnkpKTtcbiAgdmFyIGJ1ZmZlcmVkID0gZ2VvbS5idWZmZXIocmFkaXVzKTtcbiAgdmFyIHBhcnNlciA9IG5ldyBqc3RzLmlvLkdlb0pTT05QYXJzZXIoKTtcbiAgYnVmZmVyZWQgPSBwYXJzZXIud3JpdGUoYnVmZmVyZWQpO1xuXG4gIHJldHVybiB7XG4gICAgdHlwZTogJ0ZlYXR1cmUnLFxuICAgIGdlb21ldHJ5OiBidWZmZXJlZCxcbiAgICBwcm9wZXJ0aWVzOiB7fVxuICB9O1xufTtcbiIsIm1vZHVsZS5leHBvcnRzID0gbm9ybWFsaXplO1xuXG52YXIgdHlwZXMgPSB7XG4gICAgUG9pbnQ6ICdnZW9tZXRyeScsXG4gICAgTXVsdGlQb2ludDogJ2dlb21ldHJ5JyxcbiAgICBMaW5lU3RyaW5nOiAnZ2VvbWV0cnknLFxuICAgIE11bHRpTGluZVN0cmluZzogJ2dlb21ldHJ5JyxcbiAgICBQb2x5Z29uOiAnZ2VvbWV0cnknLFxuICAgIE11bHRpUG9seWdvbjogJ2dlb21ldHJ5JyxcbiAgICBHZW9tZXRyeUNvbGxlY3Rpb246ICdnZW9tZXRyeScsXG4gICAgRmVhdHVyZTogJ2ZlYXR1cmUnLFxuICAgIEZlYXR1cmVDb2xsZWN0aW9uOiAnZmVhdHVyZWNvbGxlY3Rpb24nXG59O1xuXG4vKipcbiAqIE5vcm1hbGl6ZSBhIEdlb0pTT04gZmVhdHVyZSBpbnRvIGEgRmVhdHVyZUNvbGxlY3Rpb24uXG4gKlxuICogQHBhcmFtIHtvYmplY3R9IGdqIGdlb2pzb24gZGF0YVxuICogQHJldHVybnMge29iamVjdH0gbm9ybWFsaXplZCBnZW9qc29uIGRhdGFcbiAqL1xuZnVuY3Rpb24gbm9ybWFsaXplKGdqKSB7XG4gICAgaWYgKCFnaiB8fCAhZ2oudHlwZSkgcmV0dXJuIG51bGw7XG4gICAgdmFyIHR5cGUgPSB0eXBlc1tnai50eXBlXTtcbiAgICBpZiAoIXR5cGUpIHJldHVybiBudWxsO1xuXG4gICAgaWYgKHR5cGUgPT09ICdnZW9tZXRyeScpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHR5cGU6ICdGZWF0dXJlQ29sbGVjdGlvbicsXG4gICAgICAgICAgICBmZWF0dXJlczogW3tcbiAgICAgICAgICAgICAgICB0eXBlOiAnRmVhdHVyZScsXG4gICAgICAgICAgICAgICAgcHJvcGVydGllczoge30sXG4gICAgICAgICAgICAgICAgZ2VvbWV0cnk6IGdqXG4gICAgICAgICAgICB9XVxuICAgICAgICB9O1xuICAgIH0gZWxzZSBpZiAodHlwZSA9PT0gJ2ZlYXR1cmUnKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICB0eXBlOiAnRmVhdHVyZUNvbGxlY3Rpb24nLFxuICAgICAgICAgICAgZmVhdHVyZXM6IFtnal1cbiAgICAgICAgfTtcbiAgICB9IGVsc2UgaWYgKHR5cGUgPT09ICdmZWF0dXJlY29sbGVjdGlvbicpIHtcbiAgICAgICAgcmV0dXJuIGdqO1xuICAgIH1cbn1cbiIsInJlcXVpcmUoJ2phdmFzY3JpcHQudXRpbCcpO1xudmFyIGpzdHMgPSByZXF1aXJlKCcuL2xpYi9qc3RzJyk7XG5tb2R1bGUuZXhwb3J0cyA9IGpzdHNcbiIsIi8qIFRoZSBKU1RTIFRvcG9sb2d5IFN1aXRlIGlzIGEgY29sbGVjdGlvbiBvZiBKYXZhU2NyaXB0IGNsYXNzZXMgdGhhdFxuaW1wbGVtZW50IHRoZSBmdW5kYW1lbnRhbCBvcGVyYXRpb25zIHJlcXVpcmVkIHRvIHZhbGlkYXRlIGEgZ2l2ZW5cbmdlby1zcGF0aWFsIGRhdGEgc2V0IHRvIGEga25vd24gdG9wb2xvZ2ljYWwgc3BlY2lmaWNhdGlvbi5cblxuQ29weXJpZ2h0IChDKSAyMDExIFRoZSBBdXRob3JzXG5cblRoaXMgbGlicmFyeSBpcyBmcmVlIHNvZnR3YXJlOyB5b3UgY2FuIHJlZGlzdHJpYnV0ZSBpdCBhbmQvb3Jcbm1vZGlmeSBpdCB1bmRlciB0aGUgdGVybXMgb2YgdGhlIEdOVSBMZXNzZXIgR2VuZXJhbCBQdWJsaWNcbkxpY2Vuc2UgYXMgcHVibGlzaGVkIGJ5IHRoZSBGcmVlIFNvZnR3YXJlIEZvdW5kYXRpb247IGVpdGhlclxudmVyc2lvbiAyLjEgb2YgdGhlIExpY2Vuc2UsIG9yIChhdCB5b3VyIG9wdGlvbikgYW55IGxhdGVyIHZlcnNpb24uXG5cblRoaXMgbGlicmFyeSBpcyBkaXN0cmlidXRlZCBpbiB0aGUgaG9wZSB0aGF0IGl0IHdpbGwgYmUgdXNlZnVsLFxuYnV0IFdJVEhPVVQgQU5ZIFdBUlJBTlRZOyB3aXRob3V0IGV2ZW4gdGhlIGltcGxpZWQgd2FycmFudHkgb2Zcbk1FUkNIQU5UQUJJTElUWSBvciBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRS4gIFNlZSB0aGUgR05VXG5MZXNzZXIgR2VuZXJhbCBQdWJsaWMgTGljZW5zZSBmb3IgbW9yZSBkZXRhaWxzLlxuXG5Zb3Ugc2hvdWxkIGhhdmUgcmVjZWl2ZWQgYSBjb3B5IG9mIHRoZSBHTlUgTGVzc2VyIEdlbmVyYWwgUHVibGljXG5MaWNlbnNlIGFsb25nIHdpdGggdGhpcyBsaWJyYXJ5OyBpZiBub3QsIHdyaXRlIHRvIHRoZSBGcmVlIFNvZnR3YXJlXG5Gb3VuZGF0aW9uLCBJbmMuLCA1OSBUZW1wbGUgUGxhY2UsIFN1aXRlIDMzMCwgQm9zdG9uLCBNQSAgMDIxMTEtMTMwNyAgVVNBICovXG5qc3RzPXt2ZXJzaW9uOicwLjE1LjAnLGFsZ29yaXRobTp7ZGlzdGFuY2U6e30sbG9jYXRlOnt9fSxlcnJvcjp7fSxnZW9tOnt1dGlsOnt9fSxnZW9tZ3JhcGg6e2luZGV4Ont9fSxpbmRleDp7YmludHJlZTp7fSxjaGFpbjp7fSxrZHRyZWU6e30scXVhZHRyZWU6e30sc3RydHJlZTp7fX0saW86e30sbm9kaW5nOntzbmFwcm91bmQ6e319LG9wZXJhdGlvbjp7YnVmZmVyOnt9LGRpc3RhbmNlOnt9LG92ZXJsYXk6e3NuYXA6e319LHBvbHlnb25pemU6e30scHJlZGljYXRlOnt9LHJlbGF0ZTp7fSx1bmlvbjp7fSx2YWxpZDp7fX0scGxhbmFyZ3JhcGg6e30sc2ltcGxpZnk6e30sdHJpYW5ndWxhdGU6e3F1YWRlZGdlOnt9fSx1dGlsOnt9fTtpZih0eXBlb2YgU3RyaW5nLnByb3RvdHlwZS50cmltIT09J2Z1bmN0aW9uJyl7U3RyaW5nLnByb3RvdHlwZS50cmltPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMucmVwbGFjZSgvXlxccyt8XFxzKyQvZywnJyk7fTt9XG5qc3RzLmFic3RyYWN0RnVuYz1mdW5jdGlvbigpe3Rocm93IG5ldyBqc3RzLmVycm9yLkFic3RyYWN0TWV0aG9kSW52b2NhdGlvbkVycm9yKCk7fTtqc3RzLmVycm9yPXt9O2pzdHMuZXJyb3IuSWxsZWdhbEFyZ3VtZW50RXJyb3I9ZnVuY3Rpb24obWVzc2FnZSl7dGhpcy5uYW1lPSdJbGxlZ2FsQXJndW1lbnRFcnJvcic7dGhpcy5tZXNzYWdlPW1lc3NhZ2U7fTtqc3RzLmVycm9yLklsbGVnYWxBcmd1bWVudEVycm9yLnByb3RvdHlwZT1uZXcgRXJyb3IoKTtqc3RzLmVycm9yLlRvcG9sb2d5RXJyb3I9ZnVuY3Rpb24obWVzc2FnZSxwdCl7dGhpcy5uYW1lPSdUb3BvbG9neUVycm9yJzt0aGlzLm1lc3NhZ2U9cHQ/bWVzc2FnZSsnIFsgJytwdCsnIF0nOm1lc3NhZ2U7fTtqc3RzLmVycm9yLlRvcG9sb2d5RXJyb3IucHJvdG90eXBlPW5ldyBFcnJvcigpO2pzdHMuZXJyb3IuQWJzdHJhY3RNZXRob2RJbnZvY2F0aW9uRXJyb3I9ZnVuY3Rpb24oKXt0aGlzLm5hbWU9J0Fic3RyYWN0TWV0aG9kSW52b2NhdGlvbkVycm9yJzt0aGlzLm1lc3NhZ2U9J0Fic3RyYWN0IG1ldGhvZCBjYWxsZWQsIHNob3VsZCBiZSBpbXBsZW1lbnRlZCBpbiBzdWJjbGFzcy4nO307anN0cy5lcnJvci5BYnN0cmFjdE1ldGhvZEludm9jYXRpb25FcnJvci5wcm90b3R5cGU9bmV3IEVycm9yKCk7anN0cy5lcnJvci5Ob3RJbXBsZW1lbnRlZEVycm9yPWZ1bmN0aW9uKCl7dGhpcy5uYW1lPSdOb3RJbXBsZW1lbnRlZEVycm9yJzt0aGlzLm1lc3NhZ2U9J1RoaXMgbWV0aG9kIGhhcyBub3QgeWV0IGJlZW4gaW1wbGVtZW50ZWQuJzt9O2pzdHMuZXJyb3IuTm90SW1wbGVtZW50ZWRFcnJvci5wcm90b3R5cGU9bmV3IEVycm9yKCk7anN0cy5lcnJvci5Ob3RSZXByZXNlbnRhYmxlRXJyb3I9ZnVuY3Rpb24obWVzc2FnZSl7dGhpcy5uYW1lPSdOb3RSZXByZXNlbnRhYmxlRXJyb3InO3RoaXMubWVzc2FnZT1tZXNzYWdlO307anN0cy5lcnJvci5Ob3RSZXByZXNlbnRhYmxlRXJyb3IucHJvdG90eXBlPW5ldyBFcnJvcigpO2pzdHMuZXJyb3IuTG9jYXRlRmFpbHVyZUVycm9yPWZ1bmN0aW9uKG1lc3NhZ2Upe3RoaXMubmFtZT0nTG9jYXRlRmFpbHVyZUVycm9yJzt0aGlzLm1lc3NhZ2U9bWVzc2FnZTt9O2pzdHMuZXJyb3IuTG9jYXRlRmFpbHVyZUVycm9yLnByb3RvdHlwZT1uZXcgRXJyb3IoKTtpZih0eXBlb2YgbW9kdWxlIT09XCJ1bmRlZmluZWRcIiltb2R1bGUuZXhwb3J0cz1qc3RzO2pzdHMuZ2VvbS5HZW9tZXRyeUZpbHRlcj1mdW5jdGlvbigpe307anN0cy5nZW9tLkdlb21ldHJ5RmlsdGVyLnByb3RvdHlwZS5maWx0ZXI9ZnVuY3Rpb24oZ2VvbSl7dGhyb3cgbmV3IGpzdHMuZXJyb3IuQWJzdHJhY3RNZXRob2RJbnZvY2F0aW9uRXJyb3IoKTt9O2pzdHMuZ2VvbS51dGlsLlBvbHlnb25FeHRyYWN0ZXI9ZnVuY3Rpb24oY29tcHMpe3RoaXMuY29tcHM9Y29tcHM7fTtqc3RzLmdlb20udXRpbC5Qb2x5Z29uRXh0cmFjdGVyLnByb3RvdHlwZT1uZXcganN0cy5nZW9tLkdlb21ldHJ5RmlsdGVyKCk7anN0cy5nZW9tLnV0aWwuUG9seWdvbkV4dHJhY3Rlci5wcm90b3R5cGUuY29tcHM9bnVsbDtqc3RzLmdlb20udXRpbC5Qb2x5Z29uRXh0cmFjdGVyLmdldFBvbHlnb25zPWZ1bmN0aW9uKGdlb20sbGlzdCl7aWYobGlzdD09PXVuZGVmaW5lZCl7bGlzdD1bXTt9XG5pZihnZW9tIGluc3RhbmNlb2YganN0cy5nZW9tLlBvbHlnb24pe2xpc3QucHVzaChnZW9tKTt9ZWxzZSBpZihnZW9tIGluc3RhbmNlb2YganN0cy5nZW9tLkdlb21ldHJ5Q29sbGVjdGlvbil7Z2VvbS5hcHBseShuZXcganN0cy5nZW9tLnV0aWwuUG9seWdvbkV4dHJhY3RlcihsaXN0KSk7fVxucmV0dXJuIGxpc3Q7fTtqc3RzLmdlb20udXRpbC5Qb2x5Z29uRXh0cmFjdGVyLnByb3RvdHlwZS5maWx0ZXI9ZnVuY3Rpb24oZ2VvbSl7aWYoZ2VvbSBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5Qb2x5Z29uKVxudGhpcy5jb21wcy5wdXNoKGdlb20pO307anN0cy5pby5XS1RQYXJzZXI9ZnVuY3Rpb24oZ2VvbWV0cnlGYWN0b3J5KXt0aGlzLmdlb21ldHJ5RmFjdG9yeT1nZW9tZXRyeUZhY3Rvcnl8fG5ldyBqc3RzLmdlb20uR2VvbWV0cnlGYWN0b3J5KCk7dGhpcy5yZWdFeGVzPXsndHlwZVN0cic6L15cXHMqKFxcdyspXFxzKlxcKFxccyooLiopXFxzKlxcKVxccyokLywnZW1wdHlUeXBlU3RyJzovXlxccyooXFx3KylcXHMqRU1QVFlcXHMqJC8sJ3NwYWNlcyc6L1xccysvLCdwYXJlbkNvbW1hJzovXFwpXFxzKixcXHMqXFwoLywnZG91YmxlUGFyZW5Db21tYSc6L1xcKVxccypcXClcXHMqLFxccypcXChcXHMqXFwoLywndHJpbVBhcmVucyc6L15cXHMqXFwoPyguKj8pXFwpP1xccyokL307fTtqc3RzLmlvLldLVFBhcnNlci5wcm90b3R5cGUucmVhZD1mdW5jdGlvbih3a3Qpe3ZhciBnZW9tZXRyeSx0eXBlLHN0cjt3a3Q9d2t0LnJlcGxhY2UoL1tcXG5cXHJdL2csJyAnKTt2YXIgbWF0Y2hlcz10aGlzLnJlZ0V4ZXMudHlwZVN0ci5leGVjKHdrdCk7aWYod2t0LnNlYXJjaCgnRU1QVFknKSE9PS0xKXttYXRjaGVzPXRoaXMucmVnRXhlcy5lbXB0eVR5cGVTdHIuZXhlYyh3a3QpO21hdGNoZXNbMl09dW5kZWZpbmVkO31cbmlmKG1hdGNoZXMpe3R5cGU9bWF0Y2hlc1sxXS50b0xvd2VyQ2FzZSgpO3N0cj1tYXRjaGVzWzJdO2lmKHRoaXMucGFyc2VbdHlwZV0pe2dlb21ldHJ5PXRoaXMucGFyc2VbdHlwZV0uYXBwbHkodGhpcyxbc3RyXSk7fX1cbmlmKGdlb21ldHJ5PT09dW5kZWZpbmVkKVxudGhyb3cgbmV3IEVycm9yKCdDb3VsZCBub3QgcGFyc2UgV0tUICcrd2t0KTtyZXR1cm4gZ2VvbWV0cnk7fTtqc3RzLmlvLldLVFBhcnNlci5wcm90b3R5cGUud3JpdGU9ZnVuY3Rpb24oZ2VvbWV0cnkpe3JldHVybiB0aGlzLmV4dHJhY3RHZW9tZXRyeShnZW9tZXRyeSk7fTtqc3RzLmlvLldLVFBhcnNlci5wcm90b3R5cGUuZXh0cmFjdEdlb21ldHJ5PWZ1bmN0aW9uKGdlb21ldHJ5KXt2YXIgdHlwZT1nZW9tZXRyeS5DTEFTU19OQU1FLnNwbGl0KCcuJylbMl0udG9Mb3dlckNhc2UoKTtpZighdGhpcy5leHRyYWN0W3R5cGVdKXtyZXR1cm4gbnVsbDt9XG52YXIgd2t0VHlwZT10eXBlLnRvVXBwZXJDYXNlKCk7dmFyIGRhdGE7aWYoZ2VvbWV0cnkuaXNFbXB0eSgpKXtkYXRhPXdrdFR5cGUrJyBFTVBUWSc7fWVsc2V7ZGF0YT13a3RUeXBlKycoJyt0aGlzLmV4dHJhY3RbdHlwZV0uYXBwbHkodGhpcyxbZ2VvbWV0cnldKSsnKSc7fVxucmV0dXJuIGRhdGE7fTtqc3RzLmlvLldLVFBhcnNlci5wcm90b3R5cGUuZXh0cmFjdD17J2Nvb3JkaW5hdGUnOmZ1bmN0aW9uKGNvb3JkaW5hdGUpe3JldHVybiBjb29yZGluYXRlLngrJyAnK2Nvb3JkaW5hdGUueTt9LCdwb2ludCc6ZnVuY3Rpb24ocG9pbnQpe3JldHVybiBwb2ludC5jb29yZGluYXRlLngrJyAnK3BvaW50LmNvb3JkaW5hdGUueTt9LCdtdWx0aXBvaW50JzpmdW5jdGlvbihtdWx0aXBvaW50KXt2YXIgYXJyYXk9W107Zm9yKHZhciBpPTAsbGVuPW11bHRpcG9pbnQuZ2VvbWV0cmllcy5sZW5ndGg7aTxsZW47KytpKXthcnJheS5wdXNoKCcoJytcbnRoaXMuZXh0cmFjdC5wb2ludC5hcHBseSh0aGlzLFttdWx0aXBvaW50Lmdlb21ldHJpZXNbaV1dKSsnKScpO31cbnJldHVybiBhcnJheS5qb2luKCcsJyk7fSwnbGluZXN0cmluZyc6ZnVuY3Rpb24obGluZXN0cmluZyl7dmFyIGFycmF5PVtdO2Zvcih2YXIgaT0wLGxlbj1saW5lc3RyaW5nLnBvaW50cy5sZW5ndGg7aTxsZW47KytpKXthcnJheS5wdXNoKHRoaXMuZXh0cmFjdC5jb29yZGluYXRlLmFwcGx5KHRoaXMsW2xpbmVzdHJpbmcucG9pbnRzW2ldXSkpO31cbnJldHVybiBhcnJheS5qb2luKCcsJyk7fSwnbXVsdGlsaW5lc3RyaW5nJzpmdW5jdGlvbihtdWx0aWxpbmVzdHJpbmcpe3ZhciBhcnJheT1bXTtmb3IodmFyIGk9MCxsZW49bXVsdGlsaW5lc3RyaW5nLmdlb21ldHJpZXMubGVuZ3RoO2k8bGVuOysraSl7YXJyYXkucHVzaCgnKCcrXG50aGlzLmV4dHJhY3QubGluZXN0cmluZy5hcHBseSh0aGlzLFttdWx0aWxpbmVzdHJpbmcuZ2VvbWV0cmllc1tpXV0pKycpJyk7fVxucmV0dXJuIGFycmF5LmpvaW4oJywnKTt9LCdwb2x5Z29uJzpmdW5jdGlvbihwb2x5Z29uKXt2YXIgYXJyYXk9W107YXJyYXkucHVzaCgnKCcrdGhpcy5leHRyYWN0LmxpbmVzdHJpbmcuYXBwbHkodGhpcyxbcG9seWdvbi5zaGVsbF0pKycpJyk7Zm9yKHZhciBpPTAsbGVuPXBvbHlnb24uaG9sZXMubGVuZ3RoO2k8bGVuOysraSl7YXJyYXkucHVzaCgnKCcrdGhpcy5leHRyYWN0LmxpbmVzdHJpbmcuYXBwbHkodGhpcyxbcG9seWdvbi5ob2xlc1tpXV0pKycpJyk7fVxucmV0dXJuIGFycmF5LmpvaW4oJywnKTt9LCdtdWx0aXBvbHlnb24nOmZ1bmN0aW9uKG11bHRpcG9seWdvbil7dmFyIGFycmF5PVtdO2Zvcih2YXIgaT0wLGxlbj1tdWx0aXBvbHlnb24uZ2VvbWV0cmllcy5sZW5ndGg7aTxsZW47KytpKXthcnJheS5wdXNoKCcoJyt0aGlzLmV4dHJhY3QucG9seWdvbi5hcHBseSh0aGlzLFttdWx0aXBvbHlnb24uZ2VvbWV0cmllc1tpXV0pKycpJyk7fVxucmV0dXJuIGFycmF5LmpvaW4oJywnKTt9LCdnZW9tZXRyeWNvbGxlY3Rpb24nOmZ1bmN0aW9uKGNvbGxlY3Rpb24pe3ZhciBhcnJheT1bXTtmb3IodmFyIGk9MCxsZW49Y29sbGVjdGlvbi5nZW9tZXRyaWVzLmxlbmd0aDtpPGxlbjsrK2kpe2FycmF5LnB1c2godGhpcy5leHRyYWN0R2VvbWV0cnkuYXBwbHkodGhpcyxbY29sbGVjdGlvbi5nZW9tZXRyaWVzW2ldXSkpO31cbnJldHVybiBhcnJheS5qb2luKCcsJyk7fX07anN0cy5pby5XS1RQYXJzZXIucHJvdG90eXBlLnBhcnNlPXsncG9pbnQnOmZ1bmN0aW9uKHN0cil7aWYoc3RyPT09dW5kZWZpbmVkKXtyZXR1cm4gdGhpcy5nZW9tZXRyeUZhY3RvcnkuY3JlYXRlUG9pbnQobnVsbCk7fVxudmFyIGNvb3Jkcz1zdHIudHJpbSgpLnNwbGl0KHRoaXMucmVnRXhlcy5zcGFjZXMpO3JldHVybiB0aGlzLmdlb21ldHJ5RmFjdG9yeS5jcmVhdGVQb2ludChuZXcganN0cy5nZW9tLkNvb3JkaW5hdGUoY29vcmRzWzBdLGNvb3Jkc1sxXSkpO30sJ211bHRpcG9pbnQnOmZ1bmN0aW9uKHN0cil7aWYoc3RyPT09dW5kZWZpbmVkKXtyZXR1cm4gdGhpcy5nZW9tZXRyeUZhY3RvcnkuY3JlYXRlTXVsdGlQb2ludChudWxsKTt9XG52YXIgcG9pbnQ7dmFyIHBvaW50cz1zdHIudHJpbSgpLnNwbGl0KCcsJyk7dmFyIGNvbXBvbmVudHM9W107Zm9yKHZhciBpPTAsbGVuPXBvaW50cy5sZW5ndGg7aTxsZW47KytpKXtwb2ludD1wb2ludHNbaV0ucmVwbGFjZSh0aGlzLnJlZ0V4ZXMudHJpbVBhcmVucywnJDEnKTtjb21wb25lbnRzLnB1c2godGhpcy5wYXJzZS5wb2ludC5hcHBseSh0aGlzLFtwb2ludF0pKTt9XG5yZXR1cm4gdGhpcy5nZW9tZXRyeUZhY3RvcnkuY3JlYXRlTXVsdGlQb2ludChjb21wb25lbnRzKTt9LCdsaW5lc3RyaW5nJzpmdW5jdGlvbihzdHIpe2lmKHN0cj09PXVuZGVmaW5lZCl7cmV0dXJuIHRoaXMuZ2VvbWV0cnlGYWN0b3J5LmNyZWF0ZUxpbmVTdHJpbmcobnVsbCk7fVxudmFyIHBvaW50cz1zdHIudHJpbSgpLnNwbGl0KCcsJyk7dmFyIGNvbXBvbmVudHM9W107dmFyIGNvb3Jkcztmb3IodmFyIGk9MCxsZW49cG9pbnRzLmxlbmd0aDtpPGxlbjsrK2kpe2Nvb3Jkcz1wb2ludHNbaV0udHJpbSgpLnNwbGl0KHRoaXMucmVnRXhlcy5zcGFjZXMpO2NvbXBvbmVudHMucHVzaChuZXcganN0cy5nZW9tLkNvb3JkaW5hdGUoY29vcmRzWzBdLGNvb3Jkc1sxXSkpO31cbnJldHVybiB0aGlzLmdlb21ldHJ5RmFjdG9yeS5jcmVhdGVMaW5lU3RyaW5nKGNvbXBvbmVudHMpO30sJ2xpbmVhcnJpbmcnOmZ1bmN0aW9uKHN0cil7aWYoc3RyPT09dW5kZWZpbmVkKXtyZXR1cm4gdGhpcy5nZW9tZXRyeUZhY3RvcnkuY3JlYXRlTGluZWFyUmluZyhudWxsKTt9XG52YXIgcG9pbnRzPXN0ci50cmltKCkuc3BsaXQoJywnKTt2YXIgY29tcG9uZW50cz1bXTt2YXIgY29vcmRzO2Zvcih2YXIgaT0wLGxlbj1wb2ludHMubGVuZ3RoO2k8bGVuOysraSl7Y29vcmRzPXBvaW50c1tpXS50cmltKCkuc3BsaXQodGhpcy5yZWdFeGVzLnNwYWNlcyk7Y29tcG9uZW50cy5wdXNoKG5ldyBqc3RzLmdlb20uQ29vcmRpbmF0ZShjb29yZHNbMF0sY29vcmRzWzFdKSk7fVxucmV0dXJuIHRoaXMuZ2VvbWV0cnlGYWN0b3J5LmNyZWF0ZUxpbmVhclJpbmcoY29tcG9uZW50cyk7fSwnbXVsdGlsaW5lc3RyaW5nJzpmdW5jdGlvbihzdHIpe2lmKHN0cj09PXVuZGVmaW5lZCl7cmV0dXJuIHRoaXMuZ2VvbWV0cnlGYWN0b3J5LmNyZWF0ZU11bHRpTGluZVN0cmluZyhudWxsKTt9XG52YXIgbGluZTt2YXIgbGluZXM9c3RyLnRyaW0oKS5zcGxpdCh0aGlzLnJlZ0V4ZXMucGFyZW5Db21tYSk7dmFyIGNvbXBvbmVudHM9W107Zm9yKHZhciBpPTAsbGVuPWxpbmVzLmxlbmd0aDtpPGxlbjsrK2kpe2xpbmU9bGluZXNbaV0ucmVwbGFjZSh0aGlzLnJlZ0V4ZXMudHJpbVBhcmVucywnJDEnKTtjb21wb25lbnRzLnB1c2godGhpcy5wYXJzZS5saW5lc3RyaW5nLmFwcGx5KHRoaXMsW2xpbmVdKSk7fVxucmV0dXJuIHRoaXMuZ2VvbWV0cnlGYWN0b3J5LmNyZWF0ZU11bHRpTGluZVN0cmluZyhjb21wb25lbnRzKTt9LCdwb2x5Z29uJzpmdW5jdGlvbihzdHIpe2lmKHN0cj09PXVuZGVmaW5lZCl7cmV0dXJuIHRoaXMuZ2VvbWV0cnlGYWN0b3J5LmNyZWF0ZVBvbHlnb24obnVsbCk7fVxudmFyIHJpbmcsbGluZXN0cmluZyxsaW5lYXJyaW5nO3ZhciByaW5ncz1zdHIudHJpbSgpLnNwbGl0KHRoaXMucmVnRXhlcy5wYXJlbkNvbW1hKTt2YXIgc2hlbGw7dmFyIGhvbGVzPVtdO2Zvcih2YXIgaT0wLGxlbj1yaW5ncy5sZW5ndGg7aTxsZW47KytpKXtyaW5nPXJpbmdzW2ldLnJlcGxhY2UodGhpcy5yZWdFeGVzLnRyaW1QYXJlbnMsJyQxJyk7bGluZXN0cmluZz10aGlzLnBhcnNlLmxpbmVzdHJpbmcuYXBwbHkodGhpcyxbcmluZ10pO2xpbmVhcnJpbmc9dGhpcy5nZW9tZXRyeUZhY3RvcnkuY3JlYXRlTGluZWFyUmluZyhsaW5lc3RyaW5nLnBvaW50cyk7aWYoaT09PTApe3NoZWxsPWxpbmVhcnJpbmc7fWVsc2V7aG9sZXMucHVzaChsaW5lYXJyaW5nKTt9fVxucmV0dXJuIHRoaXMuZ2VvbWV0cnlGYWN0b3J5LmNyZWF0ZVBvbHlnb24oc2hlbGwsaG9sZXMpO30sJ211bHRpcG9seWdvbic6ZnVuY3Rpb24oc3RyKXtpZihzdHI9PT11bmRlZmluZWQpe3JldHVybiB0aGlzLmdlb21ldHJ5RmFjdG9yeS5jcmVhdGVNdWx0aVBvbHlnb24obnVsbCk7fVxudmFyIHBvbHlnb247dmFyIHBvbHlnb25zPXN0ci50cmltKCkuc3BsaXQodGhpcy5yZWdFeGVzLmRvdWJsZVBhcmVuQ29tbWEpO3ZhciBjb21wb25lbnRzPVtdO2Zvcih2YXIgaT0wLGxlbj1wb2x5Z29ucy5sZW5ndGg7aTxsZW47KytpKXtwb2x5Z29uPXBvbHlnb25zW2ldLnJlcGxhY2UodGhpcy5yZWdFeGVzLnRyaW1QYXJlbnMsJyQxJyk7Y29tcG9uZW50cy5wdXNoKHRoaXMucGFyc2UucG9seWdvbi5hcHBseSh0aGlzLFtwb2x5Z29uXSkpO31cbnJldHVybiB0aGlzLmdlb21ldHJ5RmFjdG9yeS5jcmVhdGVNdWx0aVBvbHlnb24oY29tcG9uZW50cyk7fSwnZ2VvbWV0cnljb2xsZWN0aW9uJzpmdW5jdGlvbihzdHIpe2lmKHN0cj09PXVuZGVmaW5lZCl7cmV0dXJuIHRoaXMuZ2VvbWV0cnlGYWN0b3J5LmNyZWF0ZUdlb21ldHJ5Q29sbGVjdGlvbihudWxsKTt9XG5zdHI9c3RyLnJlcGxhY2UoLyxcXHMqKFtBLVphLXpdKS9nLCd8JDEnKTt2YXIgd2t0QXJyYXk9c3RyLnRyaW0oKS5zcGxpdCgnfCcpO3ZhciBjb21wb25lbnRzPVtdO2Zvcih2YXIgaT0wLGxlbj13a3RBcnJheS5sZW5ndGg7aTxsZW47KytpKXtjb21wb25lbnRzLnB1c2goanN0cy5pby5XS1RQYXJzZXIucHJvdG90eXBlLnJlYWQuYXBwbHkodGhpcyxbd2t0QXJyYXlbaV1dKSk7fVxucmV0dXJuIHRoaXMuZ2VvbWV0cnlGYWN0b3J5LmNyZWF0ZUdlb21ldHJ5Q29sbGVjdGlvbihjb21wb25lbnRzKTt9fTtqc3RzLmluZGV4Lkl0ZW1WaXNpdG9yPWZ1bmN0aW9uKCl7fTtqc3RzLmluZGV4Lkl0ZW1WaXNpdG9yLnByb3RvdHlwZS52aXNpdEl0ZW09ZnVuY3Rpb24oKXt0aHJvdyBuZXcganN0cy5lcnJvci5BYnN0cmFjdE1ldGhvZEludm9jYXRpb25FcnJvcigpO307anN0cy5hbGdvcml0aG0uQ0dBbGdvcml0aG1zPWZ1bmN0aW9uKCl7fTtqc3RzLmFsZ29yaXRobS5DR0FsZ29yaXRobXMuQ0xPQ0tXSVNFPS0xO2pzdHMuYWxnb3JpdGhtLkNHQWxnb3JpdGhtcy5SSUdIVD1qc3RzLmFsZ29yaXRobS5DR0FsZ29yaXRobXMuQ0xPQ0tXSVNFO2pzdHMuYWxnb3JpdGhtLkNHQWxnb3JpdGhtcy5DT1VOVEVSQ0xPQ0tXSVNFPTE7anN0cy5hbGdvcml0aG0uQ0dBbGdvcml0aG1zLkxFRlQ9anN0cy5hbGdvcml0aG0uQ0dBbGdvcml0aG1zLkNPVU5URVJDTE9DS1dJU0U7anN0cy5hbGdvcml0aG0uQ0dBbGdvcml0aG1zLkNPTExJTkVBUj0wO2pzdHMuYWxnb3JpdGhtLkNHQWxnb3JpdGhtcy5TVFJBSUdIVD1qc3RzLmFsZ29yaXRobS5DR0FsZ29yaXRobXMuQ09MTElORUFSO2pzdHMuYWxnb3JpdGhtLkNHQWxnb3JpdGhtcy5vcmllbnRhdGlvbkluZGV4PWZ1bmN0aW9uKHAxLHAyLHEpe3ZhciBkeDEsZHkxLGR4MixkeTI7ZHgxPXAyLngtcDEueDtkeTE9cDIueS1wMS55O2R4Mj1xLngtcDIueDtkeTI9cS55LXAyLnk7cmV0dXJuIGpzdHMuYWxnb3JpdGhtLlJvYnVzdERldGVybWluYW50LnNpZ25PZkRldDJ4MihkeDEsZHkxLGR4MixkeTIpO307anN0cy5hbGdvcml0aG0uQ0dBbGdvcml0aG1zLmlzUG9pbnRJblJpbmc9ZnVuY3Rpb24ocCxyaW5nKXtyZXR1cm4ganN0cy5hbGdvcml0aG0uQ0dBbGdvcml0aG1zLmxvY2F0ZVBvaW50SW5SaW5nKHAscmluZykhPT1qc3RzLmdlb20uTG9jYXRpb24uRVhURVJJT1I7fTtqc3RzLmFsZ29yaXRobS5DR0FsZ29yaXRobXMubG9jYXRlUG9pbnRJblJpbmc9ZnVuY3Rpb24ocCxyaW5nKXtyZXR1cm4ganN0cy5hbGdvcml0aG0uUmF5Q3Jvc3NpbmdDb3VudGVyLmxvY2F0ZVBvaW50SW5SaW5nKHAscmluZyk7fTtqc3RzLmFsZ29yaXRobS5DR0FsZ29yaXRobXMuaXNPbkxpbmU9ZnVuY3Rpb24ocCxwdCl7dmFyIGxpbmVJbnRlcnNlY3RvcixpLGlsLHAwLHAxO2xpbmVJbnRlcnNlY3Rvcj1uZXcganN0cy5hbGdvcml0aG0uUm9idXN0TGluZUludGVyc2VjdG9yKCk7Zm9yKGk9MSxpbD1wdC5sZW5ndGg7aTxpbDtpKyspe3AwPXB0W2ktMV07cDE9cHRbaV07bGluZUludGVyc2VjdG9yLmNvbXB1dGVJbnRlcnNlY3Rpb24ocCxwMCxwMSk7aWYobGluZUludGVyc2VjdG9yLmhhc0ludGVyc2VjdGlvbigpKXtyZXR1cm4gdHJ1ZTt9fVxucmV0dXJuIGZhbHNlO307anN0cy5hbGdvcml0aG0uQ0dBbGdvcml0aG1zLmlzQ0NXPWZ1bmN0aW9uKHJpbmcpe3ZhciBuUHRzLGhpUHQsaGlJbmRleCxwLGlQcmV2LGlOZXh0LHByZXYsbmV4dCxpLGRpc2MsaXNDQ1c7blB0cz1yaW5nLmxlbmd0aC0xO2lmKG5QdHM8Myl7dGhyb3cgbmV3IGpzdHMuSWxsZWdhbEFyZ3VtZW50RXJyb3IoJ1JpbmcgaGFzIGZld2VyIHRoYW4gMyBwb2ludHMsIHNvIG9yaWVudGF0aW9uIGNhbm5vdCBiZSBkZXRlcm1pbmVkJyk7fVxuaGlQdD1yaW5nWzBdO2hpSW5kZXg9MDtpPTE7Zm9yKGk7aTw9blB0cztpKyspe3A9cmluZ1tpXTtpZihwLnk+aGlQdC55KXtoaVB0PXA7aGlJbmRleD1pO319XG5pUHJldj1oaUluZGV4O2Rve2lQcmV2PWlQcmV2LTE7aWYoaVByZXY8MCl7aVByZXY9blB0czt9fXdoaWxlKHJpbmdbaVByZXZdLmVxdWFsczJEKGhpUHQpJiZpUHJldiE9PWhpSW5kZXgpO2lOZXh0PWhpSW5kZXg7ZG97aU5leHQ9KGlOZXh0KzEpJW5QdHM7fXdoaWxlKHJpbmdbaU5leHRdLmVxdWFsczJEKGhpUHQpJiZpTmV4dCE9PWhpSW5kZXgpO3ByZXY9cmluZ1tpUHJldl07bmV4dD1yaW5nW2lOZXh0XTtpZihwcmV2LmVxdWFsczJEKGhpUHQpfHxuZXh0LmVxdWFsczJEKGhpUHQpfHxwcmV2LmVxdWFsczJEKG5leHQpKXtyZXR1cm4gZmFsc2U7fVxuZGlzYz1qc3RzLmFsZ29yaXRobS5DR0FsZ29yaXRobXMuY29tcHV0ZU9yaWVudGF0aW9uKHByZXYsaGlQdCxuZXh0KTtpc0NDVz1mYWxzZTtpZihkaXNjPT09MCl7aXNDQ1c9KHByZXYueD5uZXh0LngpO31lbHNle2lzQ0NXPShkaXNjPjApO31cbnJldHVybiBpc0NDVzt9O2pzdHMuYWxnb3JpdGhtLkNHQWxnb3JpdGhtcy5jb21wdXRlT3JpZW50YXRpb249ZnVuY3Rpb24ocDEscDIscSl7cmV0dXJuIGpzdHMuYWxnb3JpdGhtLkNHQWxnb3JpdGhtcy5vcmllbnRhdGlvbkluZGV4KHAxLHAyLHEpO307anN0cy5hbGdvcml0aG0uQ0dBbGdvcml0aG1zLmRpc3RhbmNlUG9pbnRMaW5lPWZ1bmN0aW9uKHAsQSxCKXtpZighKEEgaW5zdGFuY2VvZiBqc3RzLmdlb20uQ29vcmRpbmF0ZSkpe2pzdHMuYWxnb3JpdGhtLkNHQWxnb3JpdGhtcy5kaXN0YW5jZVBvaW50TGluZTIuYXBwbHkodGhpcyxhcmd1bWVudHMpO31cbmlmKEEueD09PUIueCYmQS55PT09Qi55KXtyZXR1cm4gcC5kaXN0YW5jZShBKTt9XG52YXIgcixzO3I9KChwLngtQS54KSooQi54LUEueCkrKHAueS1BLnkpKihCLnktQS55KSkvKChCLngtQS54KSooQi54LUEueCkrKEIueS1BLnkpKihCLnktQS55KSk7aWYocjw9MC4wKXtyZXR1cm4gcC5kaXN0YW5jZShBKTt9XG5pZihyPj0xLjApe3JldHVybiBwLmRpc3RhbmNlKEIpO31cbnM9KChBLnktcC55KSooQi54LUEueCktKEEueC1wLngpKihCLnktQS55KSkvKChCLngtQS54KSooQi54LUEueCkrKEIueS1BLnkpKihCLnktQS55KSk7cmV0dXJuIE1hdGguYWJzKHMpKk1hdGguc3FydCgoKEIueC1BLngpKihCLngtQS54KSsoQi55LUEueSkqKEIueS1BLnkpKSk7fTtqc3RzLmFsZ29yaXRobS5DR0FsZ29yaXRobXMuZGlzdGFuY2VQb2ludExpbmVQZXJwZW5kaWN1bGFyPWZ1bmN0aW9uKHAsQSxCKXt2YXIgcz0oKEEueS1wLnkpKihCLngtQS54KS0oQS54LXAueCkqKEIueS1BLnkpKS8oKEIueC1BLngpKihCLngtQS54KSsoQi55LUEueSkqKEIueS1BLnkpKTtyZXR1cm4gTWF0aC5hYnMocykqTWF0aC5zcXJ0KCgoQi54LUEueCkqKEIueC1BLngpKyhCLnktQS55KSooQi55LUEueSkpKTt9O2pzdHMuYWxnb3JpdGhtLkNHQWxnb3JpdGhtcy5kaXN0YW5jZVBvaW50TGluZTI9ZnVuY3Rpb24ocCxsaW5lKXt2YXIgbWluRGlzdGFuY2UsaSxpbCxkaXN0O2lmKGxpbmUubGVuZ3RoPT09MCl7dGhyb3cgbmV3IGpzdHMuZXJyb3IuSWxsZWdhbEFyZ3VtZW50RXJyb3IoJ0xpbmUgYXJyYXkgbXVzdCBjb250YWluIGF0IGxlYXN0IG9uZSB2ZXJ0ZXgnKTt9XG5taW5EaXN0YW5jZT1wLmRpc3RhbmNlKGxpbmVbMF0pO2ZvcihpPTAsaWw9bGluZS5sZW5ndGgtMTtpPGlsO2krKyl7ZGlzdD1qc3RzLmFsZ29yaXRobS5DR0FsZ29yaXRobXMuZGlzdGFuY2VQb2ludExpbmUocCxsaW5lW2ldLGxpbmVbaSsxXSk7aWYoZGlzdDxtaW5EaXN0YW5jZSl7bWluRGlzdGFuY2U9ZGlzdDt9fVxucmV0dXJuIG1pbkRpc3RhbmNlO307anN0cy5hbGdvcml0aG0uQ0dBbGdvcml0aG1zLmRpc3RhbmNlTGluZUxpbmU9ZnVuY3Rpb24oQSxCLEMsRCl7aWYoQS5lcXVhbHMoQikpe3JldHVybiBqc3RzLmFsZ29yaXRobS5DR0FsZ29yaXRobXMuZGlzdGFuY2VQb2ludExpbmUoQSxDLEQpO31cbmlmKEMuZXF1YWxzKEQpKXtyZXR1cm4ganN0cy5hbGdvcml0aG0uQ0dBbGdvcml0aG1zLmRpc3RhbmNlUG9pbnRMaW5lKEQsQSxCKTt9XG52YXIgcl90b3Ascl9ib3Qsc190b3Asc19ib3QscyxyO3JfdG9wPShBLnktQy55KSooRC54LUMueCktKEEueC1DLngpKihELnktQy55KTtyX2JvdD0oQi54LUEueCkqKEQueS1DLnkpLShCLnktQS55KSooRC54LUMueCk7c190b3A9KEEueS1DLnkpKihCLngtQS54KS0oQS54LUMueCkqKEIueS1BLnkpO3NfYm90PShCLngtQS54KSooRC55LUMueSktKEIueS1BLnkpKihELngtQy54KTtpZigocl9ib3Q9PT0wKXx8KHNfYm90PT09MCkpe3JldHVybiBNYXRoLm1pbihqc3RzLmFsZ29yaXRobS5DR0FsZ29yaXRobXMuZGlzdGFuY2VQb2ludExpbmUoQSxDLEQpLE1hdGgubWluKGpzdHMuYWxnb3JpdGhtLkNHQWxnb3JpdGhtcy5kaXN0YW5jZVBvaW50TGluZShCLEMsRCksTWF0aC5taW4oanN0cy5hbGdvcml0aG0uQ0dBbGdvcml0aG1zLmRpc3RhbmNlUG9pbnRMaW5lKEMsQSxCKSxqc3RzLmFsZ29yaXRobS5DR0FsZ29yaXRobXMuZGlzdGFuY2VQb2ludExpbmUoRCxBLEIpKSkpO31cbnM9c190b3Avc19ib3Q7cj1yX3RvcC9yX2JvdDtpZigocjwwKXx8KHI+MSl8fChzPDApfHwocz4xKSl7cmV0dXJuIE1hdGgubWluKGpzdHMuYWxnb3JpdGhtLkNHQWxnb3JpdGhtcy5kaXN0YW5jZVBvaW50TGluZShBLEMsRCksTWF0aC5taW4oanN0cy5hbGdvcml0aG0uQ0dBbGdvcml0aG1zLmRpc3RhbmNlUG9pbnRMaW5lKEIsQyxEKSxNYXRoLm1pbihqc3RzLmFsZ29yaXRobS5DR0FsZ29yaXRobXMuZGlzdGFuY2VQb2ludExpbmUoQyxBLEIpLGpzdHMuYWxnb3JpdGhtLkNHQWxnb3JpdGhtcy5kaXN0YW5jZVBvaW50TGluZShELEEsQikpKSk7fVxucmV0dXJuIDAuMDt9O2pzdHMuYWxnb3JpdGhtLkNHQWxnb3JpdGhtcy5zaWduZWRBcmVhPWZ1bmN0aW9uKHJpbmcpe2lmKHJpbmcubGVuZ3RoPDMpe3JldHVybiAwLjA7fVxudmFyIHN1bSxpLGlsLGJ4LGJ5LGN4LGN5O3N1bT0wLjA7Zm9yKGk9MCxpbD1yaW5nLmxlbmd0aC0xO2k8aWw7aSsrKXtieD1yaW5nW2ldLng7Ynk9cmluZ1tpXS55O2N4PXJpbmdbaSsxXS54O2N5PXJpbmdbaSsxXS55O3N1bSs9KGJ4K2N4KSooY3ktYnkpO31cbnJldHVybi1zdW0vMi4wO307anN0cy5hbGdvcml0aG0uQ0dBbGdvcml0aG1zLnNpZ25lZEFyZWE9ZnVuY3Rpb24ocmluZyl7dmFyIG4sc3VtLHAsYngsYnksaSxjeCxjeTtuPXJpbmcubGVuZ3RoO2lmKG48Myl7cmV0dXJuIDAuMDt9XG5zdW09MC4wO3A9cmluZ1swXTtieD1wLng7Ynk9cC55O2ZvcihpPTE7aTxuO2krKyl7cD1yaW5nW2ldO2N4PXAueDtjeT1wLnk7c3VtKz0oYngrY3gpKihjeS1ieSk7Yng9Y3g7Ynk9Y3k7fVxucmV0dXJuLXN1bS8yLjA7fTtqc3RzLmFsZ29yaXRobS5DR0FsZ29yaXRobXMuY29tcHV0ZUxlbmd0aD1mdW5jdGlvbihwdHMpe3ZhciBuPXB0cy5sZW5ndGgsbGVuLHgwLHkwLHgxLHkxLGR4LGR5LHAsaSxpbDtpZihuPD0xKXtyZXR1cm4gMC4wO31cbmxlbj0wLjA7cD1wdHNbMF07eDA9cC54O3kwPXAueTtpPTEsaWw9bjtmb3IoaTtpPG47aSsrKXtwPXB0c1tpXTt4MT1wLng7eTE9cC55O2R4PXgxLXgwO2R5PXkxLXkwO2xlbis9TWF0aC5zcXJ0KGR4KmR4K2R5KmR5KTt4MD14MTt5MD15MTt9XG5yZXR1cm4gbGVuO307anN0cy5hbGdvcml0aG0uQ0dBbGdvcml0aG1zLmxlbmd0aD1mdW5jdGlvbigpe307anN0cy5hbGdvcml0aG0uQW5nbGU9ZnVuY3Rpb24oKXt9O2pzdHMuYWxnb3JpdGhtLkFuZ2xlLlBJX1RJTUVTXzI9Mi4wKk1hdGguUEk7anN0cy5hbGdvcml0aG0uQW5nbGUuUElfT1ZFUl8yPU1hdGguUEkvMi4wO2pzdHMuYWxnb3JpdGhtLkFuZ2xlLlBJX09WRVJfND1NYXRoLlBJLzQuMDtqc3RzLmFsZ29yaXRobS5BbmdsZS5DT1VOVEVSQ0xPQ0tXSVNFPWpzdHMuYWxnb3JpdGhtLkNHQWxnb3JpdGhtcy5DT1VOVEVSQ0xPQ0tXSVNFO2pzdHMuYWxnb3JpdGhtLkFuZ2xlLkNMT0NLV0lTRT1qc3RzLmFsZ29yaXRobS5DR0FsZ29yaXRobXMuQ0xPQ0tXSVNFO2pzdHMuYWxnb3JpdGhtLkFuZ2xlLk5PTkU9anN0cy5hbGdvcml0aG0uQ0dBbGdvcml0aG1zLkNPTExJTkVBUjtqc3RzLmFsZ29yaXRobS5BbmdsZS50b0RlZ3JlZXM9ZnVuY3Rpb24ocmFkaWFucyl7cmV0dXJuKHJhZGlhbnMqMTgwKS9NYXRoLlBJO307anN0cy5hbGdvcml0aG0uQW5nbGUudG9SYWRpYW5zPWZ1bmN0aW9uKGFuZ2xlRGVncmVlcyl7cmV0dXJuKGFuZ2xlRGVncmVlcypNYXRoLlBJKS8xODAuMDt9O2pzdHMuYWxnb3JpdGhtLkFuZ2xlLmFuZ2xlPWZ1bmN0aW9uKCl7aWYoYXJndW1lbnRzLmxlbmd0aD09PTEpe3JldHVybiBqc3RzLmFsZ29yaXRobS5BbmdsZS5hbmdsZUZyb21Pcmlnbyhhcmd1bWVudHNbMF0pO31lbHNle3JldHVybiBqc3RzLmFsZ29yaXRobS5BbmdsZS5hbmdsZUJldHdlZW5Db29yZHMoYXJndW1lbnRzWzBdLGFyZ3VtZW50c1sxXSk7fX07anN0cy5hbGdvcml0aG0uQW5nbGUuYW5nbGVCZXR3ZWVuQ29vcmRzPWZ1bmN0aW9uKHAwLHAxKXt2YXIgZHgsZHk7ZHg9cDEueC1wMC54O2R5PXAxLnktcDAueTtyZXR1cm4gTWF0aC5hdGFuMihkeSxkeCk7fTtqc3RzLmFsZ29yaXRobS5BbmdsZS5hbmdsZUZyb21Pcmlnbz1mdW5jdGlvbihwKXtyZXR1cm4gTWF0aC5hdGFuMihwLnkscC54KTt9O2pzdHMuYWxnb3JpdGhtLkFuZ2xlLmlzQWN1dGU9ZnVuY3Rpb24ocDAscDEscDIpe3ZhciBkeDAsZHkwLGR4MSxkeTEsZG90cHJvZDtkeDA9cDAueC1wMS54O2R5MD1wMC55LXAxLnk7ZHgxPXAyLngtcDEueDtkeTE9cDIueS1wMS55O2RvdHByb2Q9ZHgwKmR4MStkeTAqZHkxO3JldHVybiBkb3Rwcm9kPjA7fTtqc3RzLmFsZ29yaXRobS5BbmdsZS5pc09idHVzZT1mdW5jdGlvbihwMCxwMSxwMil7dmFyIGR4MCxkeTAsZHgxLGR5MSxkb3Rwcm9kO2R4MD1wMC54LXAxLng7ZHkwPXAwLnktcDEueTtkeDE9cDIueC1wMS54O2R5MT1wMi55LXAxLnk7ZG90cHJvZD1keDAqZHgxK2R5MCpkeTE7cmV0dXJuIGRvdHByb2Q8MDt9O2pzdHMuYWxnb3JpdGhtLkFuZ2xlLmFuZ2xlQmV0d2Vlbj1mdW5jdGlvbih0aXAxLHRhaWwsdGlwMil7dmFyIGExLGEyO2ExPWpzdHMuYWxnb3JpdGhtLkFuZ2xlLmFuZ2xlKHRhaWwsdGlwMSk7YTI9anN0cy5hbGdvcml0aG0uQW5nbGUuYW5nbGUodGFpbCx0aXAyKTtyZXR1cm4ganN0cy5hbGdvcml0aG0uQW5nbGUuZGlmZihhMSxhMik7fTtqc3RzLmFsZ29yaXRobS5BbmdsZS5hbmdsZUJldHdlZW5PcmllbnRlZD1mdW5jdGlvbih0aXAxLHRhaWwsdGlwMil7dmFyIGExLGEyLGFuZ0RlbDthMT1qc3RzLmFsZ29yaXRobS5BbmdsZS5hbmdsZSh0YWlsLHRpcDEpO2EyPWpzdHMuYWxnb3JpdGhtLkFuZ2xlLmFuZ2xlKHRhaWwsdGlwMik7YW5nRGVsPWEyLWExO2lmKGFuZ0RlbDw9LU1hdGguUEkpe3JldHVybiBhbmdEZWwranN0cy5hbGdvcml0aG0uQW5nbGUuUElfVElNRVNfMjt9XG5pZihhbmdEZWw+TWF0aC5QSSl7cmV0dXJuIGFuZ0RlbC1qc3RzLmFsZ29yaXRobS5BbmdsZS5QSV9USU1FU18yO31cbnJldHVybiBhbmdEZWw7fTtqc3RzLmFsZ29yaXRobS5BbmdsZS5pbnRlcmlvckFuZ2xlPWZ1bmN0aW9uKHAwLHAxLHAyKXt2YXIgYW5nbGVQcmV2LGFuZ2xlTmV4dDthbmdsZVByZXY9anN0cy5hbGdvcml0aG0uQW5nbGUuYW5nbGUocDEscDApO2FuZ2xlTmV4dD1qc3RzLmFsZ29yaXRobS5BbmdsZS5hbmdsZShwMSxwMik7cmV0dXJuIE1hdGguYWJzKGFuZ2xlTmV4dC1hbmdsZVByZXYpO307anN0cy5hbGdvcml0aG0uQW5nbGUuZ2V0VHVybj1mdW5jdGlvbihhbmcxLGFuZzIpe3ZhciBjcm9zc3Byb2R1Y3Q9TWF0aC5zaW4oYW5nMi1hbmcxKTtpZihjcm9zc3Byb2R1Y3Q+MCl7cmV0dXJuIGpzdHMuYWxnb3JpdGhtLkFuZ2xlLkNPVU5URVJDTE9DS1dJU0U7fVxuaWYoY3Jvc3Nwcm9kdWN0PDApe3JldHVybiBqc3RzLmFsZ29yaXRobS5BbmdsZS5DTE9DS1dJU0U7fVxucmV0dXJuIGpzdHMuYWxnb3JpdGhtLkFuZ2xlLk5PTkU7fTtqc3RzLmFsZ29yaXRobS5BbmdsZS5ub3JtYWxpemU9ZnVuY3Rpb24oYW5nbGUpe3doaWxlKGFuZ2xlPk1hdGguUEkpe2FuZ2xlLT1qc3RzLmFsZ29yaXRobS5BbmdsZS5QSV9USU1FU18yO31cbndoaWxlKGFuZ2xlPD0tTWF0aC5QSSl7YW5nbGUrPWpzdHMuYWxnb3JpdGhtLkFuZ2xlLlBJX1RJTUVTXzI7fVxucmV0dXJuIGFuZ2xlO307anN0cy5hbGdvcml0aG0uQW5nbGUubm9ybWFsaXplUG9zaXRpdmU9ZnVuY3Rpb24oYW5nbGUpe2lmKGFuZ2xlPDAuMCl7d2hpbGUoYW5nbGU8MC4wKXthbmdsZSs9anN0cy5hbGdvcml0aG0uQW5nbGUuUElfVElNRVNfMjt9XG5pZihhbmdsZT49anN0cy5hbGdvcml0aG0uQW5nbGUuUElfVElNRVNfMil7YW5nbGU9MC4wO319XG5lbHNle3doaWxlKGFuZ2xlPj1qc3RzLmFsZ29yaXRobS5BbmdsZS5QSV9USU1FU18yKXthbmdsZS09anN0cy5hbGdvcml0aG0uQW5nbGUuUElfVElNRVNfMjt9XG5pZihhbmdsZTwwLjApe2FuZ2xlPTAuMDt9fVxucmV0dXJuIGFuZ2xlO307anN0cy5hbGdvcml0aG0uQW5nbGUuZGlmZj1mdW5jdGlvbihhbmcxLGFuZzIpe3ZhciBkZWxBbmdsZTtpZihhbmcxPGFuZzIpe2RlbEFuZ2xlPWFuZzItYW5nMTt9ZWxzZXtkZWxBbmdsZT1hbmcxLWFuZzI7fVxuaWYoZGVsQW5nbGU+TWF0aC5QSSl7ZGVsQW5nbGU9KDIqTWF0aC5QSSktZGVsQW5nbGU7fVxucmV0dXJuIGRlbEFuZ2xlO307anN0cy5nZW9tLkdlb21ldHJ5Q29tcG9uZW50RmlsdGVyPWZ1bmN0aW9uKCl7fTtqc3RzLmdlb20uR2VvbWV0cnlDb21wb25lbnRGaWx0ZXIucHJvdG90eXBlLmZpbHRlcj1mdW5jdGlvbihnZW9tKXt0aHJvdyBuZXcganN0cy5lcnJvci5BYnN0cmFjdE1ldGhvZEludm9jYXRpb25FcnJvcigpO307anN0cy5nZW9tLnV0aWwuTGluZWFyQ29tcG9uZW50RXh0cmFjdGVyPWZ1bmN0aW9uKGxpbmVzLGlzRm9yY2VkVG9MaW5lU3RyaW5nKXt0aGlzLmxpbmVzPWxpbmVzO3RoaXMuaXNGb3JjZWRUb0xpbmVTdHJpbmc9aXNGb3JjZWRUb0xpbmVTdHJpbmc7fTtqc3RzLmdlb20udXRpbC5MaW5lYXJDb21wb25lbnRFeHRyYWN0ZXIucHJvdG90eXBlPW5ldyBqc3RzLmdlb20uR2VvbWV0cnlDb21wb25lbnRGaWx0ZXIoKTtqc3RzLmdlb20udXRpbC5MaW5lYXJDb21wb25lbnRFeHRyYWN0ZXIucHJvdG90eXBlLmxpbmVzPW51bGw7anN0cy5nZW9tLnV0aWwuTGluZWFyQ29tcG9uZW50RXh0cmFjdGVyLnByb3RvdHlwZS5pc0ZvcmNlZFRvTGluZVN0cmluZz1mYWxzZTtqc3RzLmdlb20udXRpbC5MaW5lYXJDb21wb25lbnRFeHRyYWN0ZXIuZ2V0TGluZXM9ZnVuY3Rpb24oZ2VvbXMsbGluZXMpe2lmKGFyZ3VtZW50cy5sZW5ndGg9PTEpe3JldHVybiBqc3RzLmdlb20udXRpbC5MaW5lYXJDb21wb25lbnRFeHRyYWN0ZXIuZ2V0TGluZXM1LmFwcGx5KHRoaXMsYXJndW1lbnRzKTt9XG5lbHNlIGlmKGFyZ3VtZW50cy5sZW5ndGg9PTImJnR5cGVvZiBsaW5lcz09PSdib29sZWFuJyl7cmV0dXJuIGpzdHMuZ2VvbS51dGlsLkxpbmVhckNvbXBvbmVudEV4dHJhY3Rlci5nZXRMaW5lczYuYXBwbHkodGhpcyxhcmd1bWVudHMpO31cbmVsc2UgaWYoYXJndW1lbnRzLmxlbmd0aD09MiYmZ2VvbXMgaW5zdGFuY2VvZiBqc3RzLmdlb20uR2VvbWV0cnkpe3JldHVybiBqc3RzLmdlb20udXRpbC5MaW5lYXJDb21wb25lbnRFeHRyYWN0ZXIuZ2V0TGluZXMzLmFwcGx5KHRoaXMsYXJndW1lbnRzKTt9XG5lbHNlIGlmKGFyZ3VtZW50cy5sZW5ndGg9PTMmJmdlb21zIGluc3RhbmNlb2YganN0cy5nZW9tLkdlb21ldHJ5KXtyZXR1cm4ganN0cy5nZW9tLnV0aWwuTGluZWFyQ29tcG9uZW50RXh0cmFjdGVyLmdldExpbmVzNC5hcHBseSh0aGlzLGFyZ3VtZW50cyk7fVxuZWxzZSBpZihhcmd1bWVudHMubGVuZ3RoPT0zKXtyZXR1cm4ganN0cy5nZW9tLnV0aWwuTGluZWFyQ29tcG9uZW50RXh0cmFjdGVyLmdldExpbmVzMi5hcHBseSh0aGlzLGFyZ3VtZW50cyk7fVxuZm9yKHZhciBpPTA7aTxnZW9tcy5sZW5ndGg7aSsrKXt2YXIgZz1nZW9tc1tpXTtqc3RzLmdlb20udXRpbC5MaW5lYXJDb21wb25lbnRFeHRyYWN0ZXIuZ2V0TGluZXMzKGcsbGluZXMpO31cbnJldHVybiBsaW5lczt9O2pzdHMuZ2VvbS51dGlsLkxpbmVhckNvbXBvbmVudEV4dHJhY3Rlci5nZXRMaW5lczI9ZnVuY3Rpb24oZ2VvbXMsbGluZXMsZm9yY2VUb0xpbmVTdHJpbmcpe2Zvcih2YXIgaT0wO2k8Z2VvbXMubGVuZ3RoO2krKyl7dmFyIGc9Z2VvbXNbaV07anN0cy5nZW9tLnV0aWwuTGluZWFyQ29tcG9uZW50RXh0cmFjdGVyLmdldExpbmVzNChnLGxpbmVzLGZvcmNlVG9MaW5lU3RyaW5nKTt9XG5yZXR1cm4gbGluZXM7fTtqc3RzLmdlb20udXRpbC5MaW5lYXJDb21wb25lbnRFeHRyYWN0ZXIuZ2V0TGluZXMzPWZ1bmN0aW9uKGdlb20sbGluZXMpe2lmKGdlb20gaW5zdGFuY2VvZiBMaW5lU3RyaW5nKXtsaW5lcy5hZGQoZ2VvbSk7fWVsc2V7Z2VvbS5hcHBseShuZXcganN0cy5nZW9tLnV0aWwuTGluZWFyQ29tcG9uZW50RXh0cmFjdGVyKGxpbmVzKSk7fVxucmV0dXJuIGxpbmVzO307anN0cy5nZW9tLnV0aWwuTGluZWFyQ29tcG9uZW50RXh0cmFjdGVyLmdldExpbmVzND1mdW5jdGlvbihnZW9tLGxpbmVzLGZvcmNlVG9MaW5lU3RyaW5nKXtnZW9tLmFwcGx5KG5ldyBqc3RzLmdlb20udXRpbC5MaW5lYXJDb21wb25lbnRFeHRyYWN0ZXIobGluZXMsZm9yY2VUb0xpbmVTdHJpbmcpKTtyZXR1cm4gbGluZXM7fTtqc3RzLmdlb20udXRpbC5MaW5lYXJDb21wb25lbnRFeHRyYWN0ZXIuZ2V0TGluZXM1PWZ1bmN0aW9uKGdlb20pe3JldHVybiBqc3RzLmdlb20udXRpbC5MaW5lYXJDb21wb25lbnRFeHRyYWN0ZXIuZ2V0TGluZXM2KGdlb20sZmFsc2UpO307anN0cy5nZW9tLnV0aWwuTGluZWFyQ29tcG9uZW50RXh0cmFjdGVyLmdldExpbmVzNj1mdW5jdGlvbihnZW9tLGZvcmNlVG9MaW5lU3RyaW5nKXt2YXIgbGluZXM9W107Z2VvbS5hcHBseShuZXcganN0cy5nZW9tLnV0aWwuTGluZWFyQ29tcG9uZW50RXh0cmFjdGVyKGxpbmVzLGZvcmNlVG9MaW5lU3RyaW5nKSk7cmV0dXJuIGxpbmVzO307anN0cy5nZW9tLnV0aWwuTGluZWFyQ29tcG9uZW50RXh0cmFjdGVyLnByb3RvdHlwZS5zZXRGb3JjZVRvTGluZVN0cmluZz1mdW5jdGlvbihpc0ZvcmNlZFRvTGluZVN0cmluZyl7dGhpcy5pc0ZvcmNlZFRvTGluZVN0cmluZz1pc0ZvcmNlZFRvTGluZVN0cmluZzt9O2pzdHMuZ2VvbS51dGlsLkxpbmVhckNvbXBvbmVudEV4dHJhY3Rlci5wcm90b3R5cGUuZmlsdGVyPWZ1bmN0aW9uKGdlb20pe2lmKHRoaXMuaXNGb3JjZWRUb0xpbmVTdHJpbmcmJmdlb20gaW5zdGFuY2VvZiBqc3RzLmdlb20uTGluZWFyUmluZyl7dmFyIGxpbmU9Z2VvbS5nZXRGYWN0b3J5KCkuY3JlYXRlTGluZVN0cmluZyhnZW9tLmdldENvb3JkaW5hdGVTZXF1ZW5jZSgpKTt0aGlzLmxpbmVzLnB1c2gobGluZSk7cmV0dXJuO31cbmlmKGdlb20gaW5zdGFuY2VvZiBqc3RzLmdlb20uTGluZVN0cmluZ3x8Z2VvbSBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5MaW5lYXJSaW5nKVxudGhpcy5saW5lcy5wdXNoKGdlb20pO307anN0cy5nZW9tLkxvY2F0aW9uPWZ1bmN0aW9uKCl7fTtqc3RzLmdlb20uTG9jYXRpb24uSU5URVJJT1I9MDtqc3RzLmdlb20uTG9jYXRpb24uQk9VTkRBUlk9MTtqc3RzLmdlb20uTG9jYXRpb24uRVhURVJJT1I9Mjtqc3RzLmdlb20uTG9jYXRpb24uTk9ORT0tMTtqc3RzLmdlb20uTG9jYXRpb24udG9Mb2NhdGlvblN5bWJvbD1mdW5jdGlvbihsb2NhdGlvblZhbHVlKXtzd2l0Y2gobG9jYXRpb25WYWx1ZSl7Y2FzZSBqc3RzLmdlb20uTG9jYXRpb24uRVhURVJJT1I6cmV0dXJuJ2UnO2Nhc2UganN0cy5nZW9tLkxvY2F0aW9uLkJPVU5EQVJZOnJldHVybidiJztjYXNlIGpzdHMuZ2VvbS5Mb2NhdGlvbi5JTlRFUklPUjpyZXR1cm4naSc7Y2FzZSBqc3RzLmdlb20uTG9jYXRpb24uTk9ORTpyZXR1cm4nLSc7fVxudGhyb3cgbmV3IGpzdHMuSWxsZWdhbEFyZ3VtZW50RXJyb3IoJ1Vua25vd24gbG9jYXRpb24gdmFsdWU6ICcrXG5sb2NhdGlvblZhbHVlKTt9OyhmdW5jdGlvbigpe2pzdHMuaW8uR2VvSlNPTlJlYWRlcj1mdW5jdGlvbihnZW9tZXRyeUZhY3Rvcnkpe3RoaXMuZ2VvbWV0cnlGYWN0b3J5PWdlb21ldHJ5RmFjdG9yeXx8bmV3IGpzdHMuZ2VvbS5HZW9tZXRyeUZhY3RvcnkoKTt0aGlzLnByZWNpc2lvbk1vZGVsPXRoaXMuZ2VvbWV0cnlGYWN0b3J5LmdldFByZWNpc2lvbk1vZGVsKCk7dGhpcy5wYXJzZXI9bmV3IGpzdHMuaW8uR2VvSlNPTlBhcnNlcih0aGlzLmdlb21ldHJ5RmFjdG9yeSk7fTtqc3RzLmlvLkdlb0pTT05SZWFkZXIucHJvdG90eXBlLnJlYWQ9ZnVuY3Rpb24oZ2VvSnNvbil7dmFyIGdlb21ldHJ5PXRoaXMucGFyc2VyLnJlYWQoZ2VvSnNvbik7aWYodGhpcy5wcmVjaXNpb25Nb2RlbC5nZXRUeXBlKCk9PT1qc3RzLmdlb20uUHJlY2lzaW9uTW9kZWwuRklYRUQpe3RoaXMucmVkdWNlUHJlY2lzaW9uKGdlb21ldHJ5KTt9XG5yZXR1cm4gZ2VvbWV0cnk7fTtqc3RzLmlvLkdlb0pTT05SZWFkZXIucHJvdG90eXBlLnJlZHVjZVByZWNpc2lvbj1mdW5jdGlvbihnZW9tZXRyeSl7dmFyIGksbGVuO2lmKGdlb21ldHJ5LmNvb3JkaW5hdGUpe3RoaXMucHJlY2lzaW9uTW9kZWwubWFrZVByZWNpc2UoZ2VvbWV0cnkuY29vcmRpbmF0ZSk7fWVsc2UgaWYoZ2VvbWV0cnkucG9pbnRzKXtmb3IoaT0wLGxlbj1nZW9tZXRyeS5wb2ludHMubGVuZ3RoO2k8bGVuO2krKyl7dGhpcy5wcmVjaXNpb25Nb2RlbC5tYWtlUHJlY2lzZShnZW9tZXRyeS5wb2ludHNbaV0pO319ZWxzZSBpZihnZW9tZXRyeS5nZW9tZXRyaWVzKXtmb3IoaT0wLGxlbj1nZW9tZXRyeS5nZW9tZXRyaWVzLmxlbmd0aDtpPGxlbjtpKyspe3RoaXMucmVkdWNlUHJlY2lzaW9uKGdlb21ldHJ5Lmdlb21ldHJpZXNbaV0pO319fTt9KSgpO2pzdHMuZ2VvbS5HZW9tZXRyeT1mdW5jdGlvbihmYWN0b3J5KXt0aGlzLmZhY3Rvcnk9ZmFjdG9yeTt9O2pzdHMuZ2VvbS5HZW9tZXRyeS5wcm90b3R5cGUuZW52ZWxvcGU9bnVsbDtqc3RzLmdlb20uR2VvbWV0cnkucHJvdG90eXBlLmZhY3Rvcnk9bnVsbDtqc3RzLmdlb20uR2VvbWV0cnkucHJvdG90eXBlLmdldEdlb21ldHJ5VHlwZT1mdW5jdGlvbigpe3JldHVybidHZW9tZXRyeSc7fTtqc3RzLmdlb20uR2VvbWV0cnkuaGFzTm9uRW1wdHlFbGVtZW50cz1mdW5jdGlvbihnZW9tZXRyaWVzKXt2YXIgaTtmb3IoaT0wO2k8Z2VvbWV0cmllcy5sZW5ndGg7aSsrKXtpZighZ2VvbWV0cmllc1tpXS5pc0VtcHR5KCkpe3JldHVybiB0cnVlO319XG5yZXR1cm4gZmFsc2U7fTtqc3RzLmdlb20uR2VvbWV0cnkuaGFzTnVsbEVsZW1lbnRzPWZ1bmN0aW9uKGFycmF5KXt2YXIgaTtmb3IoaT0wO2k8YXJyYXkubGVuZ3RoO2krKyl7aWYoYXJyYXlbaV09PT1udWxsKXtyZXR1cm4gdHJ1ZTt9fVxucmV0dXJuIGZhbHNlO307anN0cy5nZW9tLkdlb21ldHJ5LnByb3RvdHlwZS5nZXRGYWN0b3J5PWZ1bmN0aW9uKCl7aWYodGhpcy5mYWN0b3J5PT09bnVsbHx8dGhpcy5mYWN0b3J5PT09dW5kZWZpbmVkKXt0aGlzLmZhY3Rvcnk9bmV3IGpzdHMuZ2VvbS5HZW9tZXRyeUZhY3RvcnkoKTt9XG5yZXR1cm4gdGhpcy5mYWN0b3J5O307anN0cy5nZW9tLkdlb21ldHJ5LnByb3RvdHlwZS5nZXROdW1HZW9tZXRyaWVzPWZ1bmN0aW9uKCl7cmV0dXJuIDE7fTtqc3RzLmdlb20uR2VvbWV0cnkucHJvdG90eXBlLmdldEdlb21ldHJ5Tj1mdW5jdGlvbihuKXtyZXR1cm4gdGhpczt9O2pzdHMuZ2VvbS5HZW9tZXRyeS5wcm90b3R5cGUuZ2V0UHJlY2lzaW9uTW9kZWw9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5nZXRGYWN0b3J5KCkuZ2V0UHJlY2lzaW9uTW9kZWwoKTt9O2pzdHMuZ2VvbS5HZW9tZXRyeS5wcm90b3R5cGUuZ2V0Q29vcmRpbmF0ZT1mdW5jdGlvbigpe3Rocm93IG5ldyBqc3RzLmVycm9yLkFic3RyYWN0TWV0aG9kSW52b2NhdGlvbkVycm9yKCk7fTtqc3RzLmdlb20uR2VvbWV0cnkucHJvdG90eXBlLmdldENvb3JkaW5hdGVzPWZ1bmN0aW9uKCl7dGhyb3cgbmV3IGpzdHMuZXJyb3IuQWJzdHJhY3RNZXRob2RJbnZvY2F0aW9uRXJyb3IoKTt9O2pzdHMuZ2VvbS5HZW9tZXRyeS5wcm90b3R5cGUuZ2V0TnVtUG9pbnRzPWZ1bmN0aW9uKCl7dGhyb3cgbmV3IGpzdHMuZXJyb3IuQWJzdHJhY3RNZXRob2RJbnZvY2F0aW9uRXJyb3IoKTt9O2pzdHMuZ2VvbS5HZW9tZXRyeS5wcm90b3R5cGUuaXNTaW1wbGU9ZnVuY3Rpb24oKXt0aGlzLmNoZWNrTm90R2VvbWV0cnlDb2xsZWN0aW9uKHRoaXMpO3ZhciBvcD1uZXcganN0cy5vcGVyYXRpb24uSXNTaW1wbGVPcCh0aGlzKTtyZXR1cm4gb3AuaXNTaW1wbGUoKTt9O2pzdHMuZ2VvbS5HZW9tZXRyeS5wcm90b3R5cGUuaXNWYWxpZD1mdW5jdGlvbigpe3ZhciBpc1ZhbGlkT3A9bmV3IGpzdHMub3BlcmF0aW9uLnZhbGlkLklzVmFsaWRPcCh0aGlzKTtyZXR1cm4gaXNWYWxpZE9wLmlzVmFsaWQoKTt9O2pzdHMuZ2VvbS5HZW9tZXRyeS5wcm90b3R5cGUuaXNFbXB0eT1mdW5jdGlvbigpe3Rocm93IG5ldyBqc3RzLmVycm9yLkFic3RyYWN0TWV0aG9kSW52b2NhdGlvbkVycm9yKCk7fTtqc3RzLmdlb20uR2VvbWV0cnkucHJvdG90eXBlLmRpc3RhbmNlPWZ1bmN0aW9uKGcpe3JldHVybiBqc3RzLm9wZXJhdGlvbi5kaXN0YW5jZS5EaXN0YW5jZU9wLmRpc3RhbmNlKHRoaXMsZyk7fTtqc3RzLmdlb20uR2VvbWV0cnkucHJvdG90eXBlLmlzV2l0aGluRGlzdGFuY2U9ZnVuY3Rpb24oZ2VvbSxkaXN0YW5jZSl7dmFyIGVudkRpc3Q9dGhpcy5nZXRFbnZlbG9wZUludGVybmFsKCkuZGlzdGFuY2UoZ2VvbS5nZXRFbnZlbG9wZUludGVybmFsKCkpO2lmKGVudkRpc3Q+ZGlzdGFuY2Upe3JldHVybiBmYWxzZTt9XG5yZXR1cm4gRGlzdGFuY2VPcC5pc1dpdGhpbkRpc3RhbmNlKHRoaXMsZ2VvbSxkaXN0YW5jZSk7fTtqc3RzLmdlb20uR2VvbWV0cnkucHJvdG90eXBlLmlzUmVjdGFuZ2xlPWZ1bmN0aW9uKCl7cmV0dXJuIGZhbHNlO307anN0cy5nZW9tLkdlb21ldHJ5LnByb3RvdHlwZS5nZXRBcmVhPWZ1bmN0aW9uKCl7cmV0dXJuIDAuMDt9O2pzdHMuZ2VvbS5HZW9tZXRyeS5wcm90b3R5cGUuZ2V0TGVuZ3RoPWZ1bmN0aW9uKCl7cmV0dXJuIDAuMDt9O2pzdHMuZ2VvbS5HZW9tZXRyeS5wcm90b3R5cGUuZ2V0Q2VudHJvaWQ9ZnVuY3Rpb24oKXtpZih0aGlzLmlzRW1wdHkoKSl7cmV0dXJuIG51bGw7fVxudmFyIGNlbnQ7dmFyIGNlbnRQdD1udWxsO3ZhciBkaW09dGhpcy5nZXREaW1lbnNpb24oKTtpZihkaW09PT0wKXtjZW50PW5ldyBqc3RzLmFsZ29yaXRobS5DZW50cm9pZFBvaW50KCk7Y2VudC5hZGQodGhpcyk7Y2VudFB0PWNlbnQuZ2V0Q2VudHJvaWQoKTt9ZWxzZSBpZihkaW09PT0xKXtjZW50PW5ldyBqc3RzLmFsZ29yaXRobS5DZW50cm9pZExpbmUoKTtjZW50LmFkZCh0aGlzKTtjZW50UHQ9Y2VudC5nZXRDZW50cm9pZCgpO31lbHNle2NlbnQ9bmV3IGpzdHMuYWxnb3JpdGhtLkNlbnRyb2lkQXJlYSgpO2NlbnQuYWRkKHRoaXMpO2NlbnRQdD1jZW50LmdldENlbnRyb2lkKCk7fVxucmV0dXJuIHRoaXMuY3JlYXRlUG9pbnRGcm9tSW50ZXJuYWxDb29yZChjZW50UHQsdGhpcyk7fTtqc3RzLmdlb20uR2VvbWV0cnkucHJvdG90eXBlLmdldEludGVyaW9yUG9pbnQ9ZnVuY3Rpb24oKXt2YXIgaW50UHQ7dmFyIGludGVyaW9yUHQ9bnVsbDt2YXIgZGltPXRoaXMuZ2V0RGltZW5zaW9uKCk7aWYoZGltPT09MCl7aW50UHQ9bmV3IGpzdHMuYWxnb3JpdGhtLkludGVyaW9yUG9pbnRQb2ludCh0aGlzKTtpbnRlcmlvclB0PWludFB0LmdldEludGVyaW9yUG9pbnQoKTt9ZWxzZSBpZihkaW09PT0xKXtpbnRQdD1uZXcganN0cy5hbGdvcml0aG0uSW50ZXJpb3JQb2ludExpbmUodGhpcyk7aW50ZXJpb3JQdD1pbnRQdC5nZXRJbnRlcmlvclBvaW50KCk7fWVsc2V7aW50UHQ9bmV3IGpzdHMuYWxnb3JpdGhtLkludGVyaW9yUG9pbnRBcmVhKHRoaXMpO2ludGVyaW9yUHQ9aW50UHQuZ2V0SW50ZXJpb3JQb2ludCgpO31cbnJldHVybiB0aGlzLmNyZWF0ZVBvaW50RnJvbUludGVybmFsQ29vcmQoaW50ZXJpb3JQdCx0aGlzKTt9O2pzdHMuZ2VvbS5HZW9tZXRyeS5wcm90b3R5cGUuZ2V0RGltZW5zaW9uPWZ1bmN0aW9uKCl7dGhyb3cgbmV3IGpzdHMuZXJyb3IuQWJzdHJhY3RNZXRob2RJbnZvY2F0aW9uRXJyb3IoKTt9O2pzdHMuZ2VvbS5HZW9tZXRyeS5wcm90b3R5cGUuZ2V0Qm91bmRhcnk9ZnVuY3Rpb24oKXt0aHJvdyBuZXcganN0cy5lcnJvci5BYnN0cmFjdE1ldGhvZEludm9jYXRpb25FcnJvcigpO307anN0cy5nZW9tLkdlb21ldHJ5LnByb3RvdHlwZS5nZXRCb3VuZGFyeURpbWVuc2lvbj1mdW5jdGlvbigpe3Rocm93IG5ldyBqc3RzLmVycm9yLkFic3RyYWN0TWV0aG9kSW52b2NhdGlvbkVycm9yKCk7fTtqc3RzLmdlb20uR2VvbWV0cnkucHJvdG90eXBlLmdldEVudmVsb3BlPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZ2V0RmFjdG9yeSgpLnRvR2VvbWV0cnkodGhpcy5nZXRFbnZlbG9wZUludGVybmFsKCkpO307anN0cy5nZW9tLkdlb21ldHJ5LnByb3RvdHlwZS5nZXRFbnZlbG9wZUludGVybmFsPWZ1bmN0aW9uKCl7aWYodGhpcy5lbnZlbG9wZT09PW51bGwpe3RoaXMuZW52ZWxvcGU9dGhpcy5jb21wdXRlRW52ZWxvcGVJbnRlcm5hbCgpO31cbnJldHVybiB0aGlzLmVudmVsb3BlO307anN0cy5nZW9tLkdlb21ldHJ5LnByb3RvdHlwZS5kaXNqb2ludD1mdW5jdGlvbihnKXtyZXR1cm4hdGhpcy5pbnRlcnNlY3RzKGcpO307anN0cy5nZW9tLkdlb21ldHJ5LnByb3RvdHlwZS50b3VjaGVzPWZ1bmN0aW9uKGcpe2lmKCF0aGlzLmdldEVudmVsb3BlSW50ZXJuYWwoKS5pbnRlcnNlY3RzKGcuZ2V0RW52ZWxvcGVJbnRlcm5hbCgpKSl7cmV0dXJuIGZhbHNlO31cbnJldHVybiB0aGlzLnJlbGF0ZShnKS5pc1RvdWNoZXModGhpcy5nZXREaW1lbnNpb24oKSxnLmdldERpbWVuc2lvbigpKTt9O2pzdHMuZ2VvbS5HZW9tZXRyeS5wcm90b3R5cGUuaW50ZXJzZWN0cz1mdW5jdGlvbihnKXtpZighdGhpcy5nZXRFbnZlbG9wZUludGVybmFsKCkuaW50ZXJzZWN0cyhnLmdldEVudmVsb3BlSW50ZXJuYWwoKSkpe3JldHVybiBmYWxzZTt9XG5pZih0aGlzLmlzUmVjdGFuZ2xlKCkpe3JldHVybiBqc3RzLm9wZXJhdGlvbi5wcmVkaWNhdGUuUmVjdGFuZ2xlSW50ZXJzZWN0cy5pbnRlcnNlY3RzKHRoaXMsZyk7fVxuaWYoZy5pc1JlY3RhbmdsZSgpKXtyZXR1cm4ganN0cy5vcGVyYXRpb24ucHJlZGljYXRlLlJlY3RhbmdsZUludGVyc2VjdHMuaW50ZXJzZWN0cyhnLHRoaXMpO31cbnJldHVybiB0aGlzLnJlbGF0ZShnKS5pc0ludGVyc2VjdHMoKTt9O2pzdHMuZ2VvbS5HZW9tZXRyeS5wcm90b3R5cGUuY3Jvc3Nlcz1mdW5jdGlvbihnKXtpZighdGhpcy5nZXRFbnZlbG9wZUludGVybmFsKCkuaW50ZXJzZWN0cyhnLmdldEVudmVsb3BlSW50ZXJuYWwoKSkpe3JldHVybiBmYWxzZTt9XG5yZXR1cm4gdGhpcy5yZWxhdGUoZykuaXNDcm9zc2VzKHRoaXMuZ2V0RGltZW5zaW9uKCksZy5nZXREaW1lbnNpb24oKSk7fTtqc3RzLmdlb20uR2VvbWV0cnkucHJvdG90eXBlLndpdGhpbj1mdW5jdGlvbihnKXtyZXR1cm4gZy5jb250YWlucyh0aGlzKTt9O2pzdHMuZ2VvbS5HZW9tZXRyeS5wcm90b3R5cGUuY29udGFpbnM9ZnVuY3Rpb24oZyl7aWYoIXRoaXMuZ2V0RW52ZWxvcGVJbnRlcm5hbCgpLmNvbnRhaW5zKGcuZ2V0RW52ZWxvcGVJbnRlcm5hbCgpKSl7cmV0dXJuIGZhbHNlO31cbmlmKHRoaXMuaXNSZWN0YW5nbGUoKSl7cmV0dXJuIGpzdHMub3BlcmF0aW9uLnByZWRpY2F0ZS5SZWN0YW5nbGVDb250YWlucy5jb250YWlucyh0aGlzLGcpO31cbnJldHVybiB0aGlzLnJlbGF0ZShnKS5pc0NvbnRhaW5zKCk7fTtqc3RzLmdlb20uR2VvbWV0cnkucHJvdG90eXBlLm92ZXJsYXBzPWZ1bmN0aW9uKGcpe2lmKCF0aGlzLmdldEVudmVsb3BlSW50ZXJuYWwoKS5pbnRlcnNlY3RzKGcuZ2V0RW52ZWxvcGVJbnRlcm5hbCgpKSl7cmV0dXJuIGZhbHNlO31cbnJldHVybiB0aGlzLnJlbGF0ZShnKS5pc092ZXJsYXBzKHRoaXMuZ2V0RGltZW5zaW9uKCksZy5nZXREaW1lbnNpb24oKSk7fTtqc3RzLmdlb20uR2VvbWV0cnkucHJvdG90eXBlLmNvdmVycz1mdW5jdGlvbihnKXtpZighdGhpcy5nZXRFbnZlbG9wZUludGVybmFsKCkuY292ZXJzKGcuZ2V0RW52ZWxvcGVJbnRlcm5hbCgpKSl7cmV0dXJuIGZhbHNlO31cbmlmKHRoaXMuaXNSZWN0YW5nbGUoKSl7cmV0dXJuIHRydWU7fVxucmV0dXJuIHRoaXMucmVsYXRlKGcpLmlzQ292ZXJzKCk7fTtqc3RzLmdlb20uR2VvbWV0cnkucHJvdG90eXBlLmNvdmVyZWRCeT1mdW5jdGlvbihnKXtyZXR1cm4gZy5jb3ZlcnModGhpcyk7fTtqc3RzLmdlb20uR2VvbWV0cnkucHJvdG90eXBlLnJlbGF0ZT1mdW5jdGlvbihnLGludGVyc2VjdGlvblBhdHRlcm4pe2lmKGFyZ3VtZW50cy5sZW5ndGg9PT0xKXtyZXR1cm4gdGhpcy5yZWxhdGUyLmFwcGx5KHRoaXMsYXJndW1lbnRzKTt9XG5yZXR1cm4gdGhpcy5yZWxhdGUyKGcpLm1hdGNoZXMoaW50ZXJzZWN0aW9uUGF0dGVybik7fTtqc3RzLmdlb20uR2VvbWV0cnkucHJvdG90eXBlLnJlbGF0ZTI9ZnVuY3Rpb24oZyl7dGhpcy5jaGVja05vdEdlb21ldHJ5Q29sbGVjdGlvbih0aGlzKTt0aGlzLmNoZWNrTm90R2VvbWV0cnlDb2xsZWN0aW9uKGcpO3JldHVybiBqc3RzLm9wZXJhdGlvbi5yZWxhdGUuUmVsYXRlT3AucmVsYXRlKHRoaXMsZyk7fTtqc3RzLmdlb20uR2VvbWV0cnkucHJvdG90eXBlLmVxdWFsc1RvcG89ZnVuY3Rpb24oZyl7aWYoIXRoaXMuZ2V0RW52ZWxvcGVJbnRlcm5hbCgpLmVxdWFscyhnLmdldEVudmVsb3BlSW50ZXJuYWwoKSkpe3JldHVybiBmYWxzZTt9XG5yZXR1cm4gdGhpcy5yZWxhdGUoZykuaXNFcXVhbHModGhpcy5nZXREaW1lbnNpb24oKSxnLmdldERpbWVuc2lvbigpKTt9O2pzdHMuZ2VvbS5HZW9tZXRyeS5wcm90b3R5cGUuZXF1YWxzPWZ1bmN0aW9uKG8pe2lmKG8gaW5zdGFuY2VvZiBqc3RzLmdlb20uR2VvbWV0cnl8fG8gaW5zdGFuY2VvZiBqc3RzLmdlb20uTGluZWFyUmluZ3x8byBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5Qb2x5Z29ufHxvIGluc3RhbmNlb2YganN0cy5nZW9tLkdlb21ldHJ5Q29sbGVjdGlvbnx8byBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5NdWx0aVBvaW50fHxvIGluc3RhbmNlb2YganN0cy5nZW9tLk11bHRpTGluZVN0cmluZ3x8byBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5NdWx0aVBvbHlnb24pe3JldHVybiB0aGlzLmVxdWFsc0V4YWN0KG8pO31cbnJldHVybiBmYWxzZTt9O2pzdHMuZ2VvbS5HZW9tZXRyeS5wcm90b3R5cGUuYnVmZmVyPWZ1bmN0aW9uKGRpc3RhbmNlLHF1YWRyYW50U2VnbWVudHMsZW5kQ2FwU3R5bGUpe3ZhciBwYXJhbXM9bmV3IGpzdHMub3BlcmF0aW9uLmJ1ZmZlci5CdWZmZXJQYXJhbWV0ZXJzKHF1YWRyYW50U2VnbWVudHMsZW5kQ2FwU3R5bGUpXG5yZXR1cm4ganN0cy5vcGVyYXRpb24uYnVmZmVyLkJ1ZmZlck9wLmJ1ZmZlck9wMih0aGlzLGRpc3RhbmNlLHBhcmFtcyk7fTtqc3RzLmdlb20uR2VvbWV0cnkucHJvdG90eXBlLmNvbnZleEh1bGw9ZnVuY3Rpb24oKXtyZXR1cm4gbmV3IGpzdHMuYWxnb3JpdGhtLkNvbnZleEh1bGwodGhpcykuZ2V0Q29udmV4SHVsbCgpO307anN0cy5nZW9tLkdlb21ldHJ5LnByb3RvdHlwZS5pbnRlcnNlY3Rpb249ZnVuY3Rpb24ob3RoZXIpe2lmKHRoaXMuaXNFbXB0eSgpKXtyZXR1cm4gdGhpcy5nZXRGYWN0b3J5KCkuY3JlYXRlR2VvbWV0cnlDb2xsZWN0aW9uKG51bGwpO31cbmlmKG90aGVyLmlzRW1wdHkoKSl7cmV0dXJuIHRoaXMuZ2V0RmFjdG9yeSgpLmNyZWF0ZUdlb21ldHJ5Q29sbGVjdGlvbihudWxsKTt9XG5pZih0aGlzLmlzR2VvbWV0cnlDb2xsZWN0aW9uKHRoaXMpKXt2YXIgZzI9b3RoZXI7fVxudGhpcy5jaGVja05vdEdlb21ldHJ5Q29sbGVjdGlvbih0aGlzKTt0aGlzLmNoZWNrTm90R2VvbWV0cnlDb2xsZWN0aW9uKG90aGVyKTtyZXR1cm4ganN0cy5vcGVyYXRpb24ub3ZlcmxheS5zbmFwLlNuYXBJZk5lZWRlZE92ZXJsYXlPcC5vdmVybGF5T3AodGhpcyxvdGhlcixqc3RzLm9wZXJhdGlvbi5vdmVybGF5Lk92ZXJsYXlPcC5JTlRFUlNFQ1RJT04pO307anN0cy5nZW9tLkdlb21ldHJ5LnByb3RvdHlwZS51bmlvbj1mdW5jdGlvbihvdGhlcil7aWYoYXJndW1lbnRzLmxlbmd0aD09PTApe3JldHVybiBqc3RzLm9wZXJhdGlvbi51bmlvbi5VbmFyeVVuaW9uT3AudW5pb24odGhpcyk7fVxuaWYodGhpcy5pc0VtcHR5KCkpe3JldHVybiBvdGhlci5jbG9uZSgpO31cbmlmKG90aGVyLmlzRW1wdHkoKSl7cmV0dXJuIHRoaXMuY2xvbmUoKTt9XG50aGlzLmNoZWNrTm90R2VvbWV0cnlDb2xsZWN0aW9uKHRoaXMpO3RoaXMuY2hlY2tOb3RHZW9tZXRyeUNvbGxlY3Rpb24ob3RoZXIpO3JldHVybiBqc3RzLm9wZXJhdGlvbi5vdmVybGF5LnNuYXAuU25hcElmTmVlZGVkT3ZlcmxheU9wLm92ZXJsYXlPcCh0aGlzLG90aGVyLGpzdHMub3BlcmF0aW9uLm92ZXJsYXkuT3ZlcmxheU9wLlVOSU9OKTt9O2pzdHMuZ2VvbS5HZW9tZXRyeS5wcm90b3R5cGUuZGlmZmVyZW5jZT1mdW5jdGlvbihvdGhlcil7aWYodGhpcy5pc0VtcHR5KCkpe3JldHVybiB0aGlzLmdldEZhY3RvcnkoKS5jcmVhdGVHZW9tZXRyeUNvbGxlY3Rpb24obnVsbCk7fVxuaWYob3RoZXIuaXNFbXB0eSgpKXtyZXR1cm4gdGhpcy5jbG9uZSgpO31cbnRoaXMuY2hlY2tOb3RHZW9tZXRyeUNvbGxlY3Rpb24odGhpcyk7dGhpcy5jaGVja05vdEdlb21ldHJ5Q29sbGVjdGlvbihvdGhlcik7cmV0dXJuIGpzdHMub3BlcmF0aW9uLm92ZXJsYXkuc25hcC5TbmFwSWZOZWVkZWRPdmVybGF5T3Aub3ZlcmxheU9wKHRoaXMsb3RoZXIsanN0cy5vcGVyYXRpb24ub3ZlcmxheS5PdmVybGF5T3AuRElGRkVSRU5DRSk7fTtqc3RzLmdlb20uR2VvbWV0cnkucHJvdG90eXBlLnN5bURpZmZlcmVuY2U9ZnVuY3Rpb24ob3RoZXIpe2lmKHRoaXMuaXNFbXB0eSgpKXtyZXR1cm4gb3RoZXIuY2xvbmUoKTt9XG5pZihvdGhlci5pc0VtcHR5KCkpe3JldHVybiB0aGlzLmNsb25lKCk7fVxudGhpcy5jaGVja05vdEdlb21ldHJ5Q29sbGVjdGlvbih0aGlzKTt0aGlzLmNoZWNrTm90R2VvbWV0cnlDb2xsZWN0aW9uKG90aGVyKTtyZXR1cm4ganN0cy5vcGVyYXRpb24ub3ZlcmxheS5zbmFwLlNuYXBJZk5lZWRlZE92ZXJsYXlPcC5vdmVybGF5T3AodGhpcyxvdGhlcixqc3RzLm9wZXJhdGlvbi5vdmVybGF5Lk92ZXJsYXlPcC5TWU1ESUZGRVJFTkNFKTt9O2pzdHMuZ2VvbS5HZW9tZXRyeS5wcm90b3R5cGUuZXF1YWxzRXhhY3Q9ZnVuY3Rpb24ob3RoZXIsdG9sZXJhbmNlKXt0aHJvdyBuZXcganN0cy5lcnJvci5BYnN0cmFjdE1ldGhvZEludm9jYXRpb25FcnJvcigpO307anN0cy5nZW9tLkdlb21ldHJ5LnByb3RvdHlwZS5lcXVhbHNOb3JtPWZ1bmN0aW9uKGcpe2lmKGc9PT1udWxsfHxnPT09dW5kZWZpbmVkKVxucmV0dXJuIGZhbHNlO3JldHVybiB0aGlzLm5vcm0oKS5lcXVhbHNFeGFjdChnLm5vcm0oKSk7fTtqc3RzLmdlb20uR2VvbWV0cnkucHJvdG90eXBlLmFwcGx5PWZ1bmN0aW9uKGZpbHRlcil7dGhyb3cgbmV3IGpzdHMuZXJyb3IuQWJzdHJhY3RNZXRob2RJbnZvY2F0aW9uRXJyb3IoKTt9O2pzdHMuZ2VvbS5HZW9tZXRyeS5wcm90b3R5cGUuY2xvbmU9ZnVuY3Rpb24oKXt0aHJvdyBuZXcganN0cy5lcnJvci5BYnN0cmFjdE1ldGhvZEludm9jYXRpb25FcnJvcigpO307anN0cy5nZW9tLkdlb21ldHJ5LnByb3RvdHlwZS5ub3JtYWxpemU9ZnVuY3Rpb24oKXt0aHJvdyBuZXcganN0cy5lcnJvci5BYnN0cmFjdE1ldGhvZEludm9jYXRpb25FcnJvcigpO307anN0cy5nZW9tLkdlb21ldHJ5LnByb3RvdHlwZS5ub3JtPWZ1bmN0aW9uKCl7dmFyIGNvcHk9dGhpcy5jbG9uZSgpO2NvcHkubm9ybWFsaXplKCk7cmV0dXJuIGNvcHk7fTtqc3RzLmdlb20uR2VvbWV0cnkucHJvdG90eXBlLmNvbXBhcmVUbz1mdW5jdGlvbihvKXt2YXIgb3RoZXI9bztpZih0aGlzLmdldENsYXNzU29ydEluZGV4KCkhPT1vdGhlci5nZXRDbGFzc1NvcnRJbmRleCgpKXtyZXR1cm4gdGhpcy5nZXRDbGFzc1NvcnRJbmRleCgpLW90aGVyLmdldENsYXNzU29ydEluZGV4KCk7fVxuaWYodGhpcy5pc0VtcHR5KCkmJm90aGVyLmlzRW1wdHkoKSl7cmV0dXJuIDA7fVxuaWYodGhpcy5pc0VtcHR5KCkpe3JldHVybi0xO31cbmlmKG90aGVyLmlzRW1wdHkoKSl7cmV0dXJuIDE7fVxucmV0dXJuIHRoaXMuY29tcGFyZVRvU2FtZUNsYXNzKG8pO307anN0cy5nZW9tLkdlb21ldHJ5LnByb3RvdHlwZS5pc0VxdWl2YWxlbnRDbGFzcz1mdW5jdGlvbihvdGhlcil7aWYodGhpcyBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5Qb2ludCYmb3RoZXIgaW5zdGFuY2VvZiBqc3RzLmdlb20uUG9pbnQpe3JldHVybiB0cnVlO31lbHNlIGlmKHRoaXMgaW5zdGFuY2VvZiBqc3RzLmdlb20uTGluZVN0cmluZyYmKG90aGVyIGluc3RhbmNlb2YganN0cy5nZW9tLkxpbmVTdHJpbmd8b3RoZXIgaW5zdGFuY2VvZiBqc3RzLmdlb20uTGluZWFyUmluZykpe3JldHVybiB0cnVlO31lbHNlIGlmKHRoaXMgaW5zdGFuY2VvZiBqc3RzLmdlb20uTGluZWFyUmluZyYmKG90aGVyIGluc3RhbmNlb2YganN0cy5nZW9tLkxpbmVTdHJpbmd8b3RoZXIgaW5zdGFuY2VvZiBqc3RzLmdlb20uTGluZWFyUmluZykpe3JldHVybiB0cnVlO31lbHNlIGlmKHRoaXMgaW5zdGFuY2VvZiBqc3RzLmdlb20uUG9seWdvbiYmKG90aGVyIGluc3RhbmNlb2YganN0cy5nZW9tLlBvbHlnb24pKXtyZXR1cm4gdHJ1ZTt9ZWxzZSBpZih0aGlzIGluc3RhbmNlb2YganN0cy5nZW9tLk11bHRpUG9pbnQmJihvdGhlciBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5NdWx0aVBvaW50KSl7cmV0dXJuIHRydWU7fWVsc2UgaWYodGhpcyBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5NdWx0aUxpbmVTdHJpbmcmJihvdGhlciBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5NdWx0aUxpbmVTdHJpbmcpKXtyZXR1cm4gdHJ1ZTt9ZWxzZSBpZih0aGlzIGluc3RhbmNlb2YganN0cy5nZW9tLk11bHRpUG9seWdvbiYmKG90aGVyIGluc3RhbmNlb2YganN0cy5nZW9tLk11bHRpUG9seWdvbikpe3JldHVybiB0cnVlO31lbHNlIGlmKHRoaXMgaW5zdGFuY2VvZiBqc3RzLmdlb20uR2VvbWV0cnlDb2xsZWN0aW9uJiYob3RoZXIgaW5zdGFuY2VvZiBqc3RzLmdlb20uR2VvbWV0cnlDb2xsZWN0aW9uKSl7cmV0dXJuIHRydWU7fVxucmV0dXJuIGZhbHNlO307anN0cy5nZW9tLkdlb21ldHJ5LnByb3RvdHlwZS5jaGVja05vdEdlb21ldHJ5Q29sbGVjdGlvbj1mdW5jdGlvbihnKXtpZihnLmlzR2VvbWV0cnlDb2xsZWN0aW9uQmFzZSgpKXt0aHJvdyBuZXcganN0cy5lcnJvci5JbGxlZ2FsQXJndW1lbnRFcnJvcignVGhpcyBtZXRob2QgZG9lcyBub3Qgc3VwcG9ydCBHZW9tZXRyeUNvbGxlY3Rpb24nKTt9fTtqc3RzLmdlb20uR2VvbWV0cnkucHJvdG90eXBlLmlzR2VvbWV0cnlDb2xsZWN0aW9uPWZ1bmN0aW9uKCl7cmV0dXJuKHRoaXMgaW5zdGFuY2VvZiBqc3RzLmdlb20uR2VvbWV0cnlDb2xsZWN0aW9uKTt9O2pzdHMuZ2VvbS5HZW9tZXRyeS5wcm90b3R5cGUuaXNHZW9tZXRyeUNvbGxlY3Rpb25CYXNlPWZ1bmN0aW9uKCl7cmV0dXJuKHRoaXMuQ0xBU1NfTkFNRT09PSdqc3RzLmdlb20uR2VvbWV0cnlDb2xsZWN0aW9uJyk7fTtqc3RzLmdlb20uR2VvbWV0cnkucHJvdG90eXBlLmNvbXB1dGVFbnZlbG9wZUludGVybmFsPWZ1bmN0aW9uKCl7dGhyb3cgbmV3IGpzdHMuZXJyb3IuQWJzdHJhY3RNZXRob2RJbnZvY2F0aW9uRXJyb3IoKTt9O2pzdHMuZ2VvbS5HZW9tZXRyeS5wcm90b3R5cGUuY29tcGFyZVRvU2FtZUNsYXNzPWZ1bmN0aW9uKG8pe3Rocm93IG5ldyBqc3RzLmVycm9yLkFic3RyYWN0TWV0aG9kSW52b2NhdGlvbkVycm9yKCk7fTtqc3RzLmdlb20uR2VvbWV0cnkucHJvdG90eXBlLmNvbXBhcmU9ZnVuY3Rpb24oYSxiKXt2YXIgaT1hLml0ZXJhdG9yKCk7dmFyIGo9Yi5pdGVyYXRvcigpO3doaWxlKGkuaGFzTmV4dCgpJiZqLmhhc05leHQoKSl7dmFyIGFFbGVtZW50PWkubmV4dCgpO3ZhciBiRWxlbWVudD1qLm5leHQoKTt2YXIgY29tcGFyaXNvbj1hRWxlbWVudC5jb21wYXJlVG8oYkVsZW1lbnQpO2lmKGNvbXBhcmlzb24hPT0wKXtyZXR1cm4gY29tcGFyaXNvbjt9fVxuaWYoaS5oYXNOZXh0KCkpe3JldHVybiAxO31cbmlmKGouaGFzTmV4dCgpKXtyZXR1cm4tMTt9XG5yZXR1cm4gMDt9O2pzdHMuZ2VvbS5HZW9tZXRyeS5wcm90b3R5cGUuZXF1YWw9ZnVuY3Rpb24oYSxiLHRvbGVyYW5jZSl7aWYodG9sZXJhbmNlPT09dW5kZWZpbmVkfHx0b2xlcmFuY2U9PT1udWxsfHx0b2xlcmFuY2U9PT0wKXtyZXR1cm4gYS5lcXVhbHMoYik7fVxucmV0dXJuIGEuZGlzdGFuY2UoYik8PXRvbGVyYW5jZTt9O2pzdHMuZ2VvbS5HZW9tZXRyeS5wcm90b3R5cGUuZ2V0Q2xhc3NTb3J0SW5kZXg9ZnVuY3Rpb24oKXt2YXIgc29ydGVkQ2xhc3Nlcz1banN0cy5nZW9tLlBvaW50LGpzdHMuZ2VvbS5NdWx0aVBvaW50LGpzdHMuZ2VvbS5MaW5lU3RyaW5nLGpzdHMuZ2VvbS5MaW5lYXJSaW5nLGpzdHMuZ2VvbS5NdWx0aUxpbmVTdHJpbmcsanN0cy5nZW9tLlBvbHlnb24sanN0cy5nZW9tLk11bHRpUG9seWdvbixqc3RzLmdlb20uR2VvbWV0cnlDb2xsZWN0aW9uXTtmb3IodmFyIGk9MDtpPHNvcnRlZENsYXNzZXMubGVuZ3RoO2krKyl7aWYodGhpcyBpbnN0YW5jZW9mIHNvcnRlZENsYXNzZXNbaV0pXG5yZXR1cm4gaTt9XG5qc3RzLnV0aWwuQXNzZXJ0LnNob3VsZE5ldmVyUmVhY2hIZXJlKCdDbGFzcyBub3Qgc3VwcG9ydGVkOiAnK3RoaXMpO3JldHVybi0xO307anN0cy5nZW9tLkdlb21ldHJ5LnByb3RvdHlwZS50b1N0cmluZz1mdW5jdGlvbigpe3JldHVybiBuZXcganN0cy5pby5XS1RXcml0ZXIoKS53cml0ZSh0aGlzKTt9O2pzdHMuZ2VvbS5HZW9tZXRyeS5wcm90b3R5cGUuY3JlYXRlUG9pbnRGcm9tSW50ZXJuYWxDb29yZD1mdW5jdGlvbihjb29yZCxleGVtcGxhcil7ZXhlbXBsYXIuZ2V0UHJlY2lzaW9uTW9kZWwoKS5tYWtlUHJlY2lzZShjb29yZCk7cmV0dXJuIGV4ZW1wbGFyLmdldEZhY3RvcnkoKS5jcmVhdGVQb2ludChjb29yZCk7fTsoZnVuY3Rpb24oKXtqc3RzLmdlb20uQ29vcmRpbmF0ZT1mdW5jdGlvbih4LHkpe2lmKHR5cGVvZiB4PT09J251bWJlcicpe3RoaXMueD14O3RoaXMueT15O31lbHNlIGlmKHggaW5zdGFuY2VvZiBqc3RzLmdlb20uQ29vcmRpbmF0ZSl7dGhpcy54PXBhcnNlRmxvYXQoeC54KTt0aGlzLnk9cGFyc2VGbG9hdCh4LnkpO31lbHNlIGlmKHg9PT11bmRlZmluZWR8fHg9PT1udWxsKXt0aGlzLng9MDt0aGlzLnk9MDt9ZWxzZSBpZih0eXBlb2YgeD09PSdzdHJpbmcnKXt0aGlzLng9cGFyc2VGbG9hdCh4KTt0aGlzLnk9cGFyc2VGbG9hdCh5KTt9fTtqc3RzLmdlb20uQ29vcmRpbmF0ZS5wcm90b3R5cGUuc2V0Q29vcmRpbmF0ZT1mdW5jdGlvbihvdGhlcil7dGhpcy54PW90aGVyLng7dGhpcy55PW90aGVyLnk7fTtqc3RzLmdlb20uQ29vcmRpbmF0ZS5wcm90b3R5cGUuY2xvbmU9ZnVuY3Rpb24oKXtyZXR1cm4gbmV3IGpzdHMuZ2VvbS5Db29yZGluYXRlKHRoaXMueCx0aGlzLnkpO307anN0cy5nZW9tLkNvb3JkaW5hdGUucHJvdG90eXBlLmRpc3RhbmNlPWZ1bmN0aW9uKHApe3ZhciBkeD10aGlzLngtcC54O3ZhciBkeT10aGlzLnktcC55O3JldHVybiBNYXRoLnNxcnQoZHgqZHgrZHkqZHkpO307anN0cy5nZW9tLkNvb3JkaW5hdGUucHJvdG90eXBlLmVxdWFsczJEPWZ1bmN0aW9uKG90aGVyKXtpZih0aGlzLnghPT1vdGhlci54KXtyZXR1cm4gZmFsc2U7fVxuaWYodGhpcy55IT09b3RoZXIueSl7cmV0dXJuIGZhbHNlO31cbnJldHVybiB0cnVlO307anN0cy5nZW9tLkNvb3JkaW5hdGUucHJvdG90eXBlLmVxdWFscz1mdW5jdGlvbihvdGhlcil7aWYoIW90aGVyIGluc3RhbmNlb2YganN0cy5nZW9tLkNvb3JkaW5hdGV8fG90aGVyPT09dW5kZWZpbmVkKXtyZXR1cm4gZmFsc2U7fVxucmV0dXJuIHRoaXMuZXF1YWxzMkQob3RoZXIpO307anN0cy5nZW9tLkNvb3JkaW5hdGUucHJvdG90eXBlLmNvbXBhcmVUbz1mdW5jdGlvbihvdGhlcil7aWYodGhpcy54PG90aGVyLngpe3JldHVybi0xO31cbmlmKHRoaXMueD5vdGhlci54KXtyZXR1cm4gMTt9XG5pZih0aGlzLnk8b3RoZXIueSl7cmV0dXJuLTE7fVxuaWYodGhpcy55Pm90aGVyLnkpe3JldHVybiAxO31cbnJldHVybiAwO307anN0cy5nZW9tLkNvb3JkaW5hdGUucHJvdG90eXBlLnRvU3RyaW5nPWZ1bmN0aW9uKCl7cmV0dXJuJygnK3RoaXMueCsnLCAnK3RoaXMueSsnKSc7fTt9KSgpO2pzdHMuZ2VvbS5FbnZlbG9wZT1mdW5jdGlvbigpe2pzdHMuZ2VvbS5FbnZlbG9wZS5wcm90b3R5cGUuaW5pdC5hcHBseSh0aGlzLGFyZ3VtZW50cyk7fTtqc3RzLmdlb20uRW52ZWxvcGUucHJvdG90eXBlLm1pbng9bnVsbDtqc3RzLmdlb20uRW52ZWxvcGUucHJvdG90eXBlLm1heHg9bnVsbDtqc3RzLmdlb20uRW52ZWxvcGUucHJvdG90eXBlLm1pbnk9bnVsbDtqc3RzLmdlb20uRW52ZWxvcGUucHJvdG90eXBlLm1heHk9bnVsbDtqc3RzLmdlb20uRW52ZWxvcGUucHJvdG90eXBlLmluaXQ9ZnVuY3Rpb24oKXtpZih0eXBlb2YgYXJndW1lbnRzWzBdPT09J251bWJlcicmJmFyZ3VtZW50cy5sZW5ndGg9PT00KXt0aGlzLmluaXRGcm9tVmFsdWVzKGFyZ3VtZW50c1swXSxhcmd1bWVudHNbMV0sYXJndW1lbnRzWzJdLGFyZ3VtZW50c1szXSk7fWVsc2UgaWYoYXJndW1lbnRzWzBdaW5zdGFuY2VvZiBqc3RzLmdlb20uQ29vcmRpbmF0ZSYmYXJndW1lbnRzLmxlbmd0aD09PTEpe3RoaXMuaW5pdEZyb21Db29yZGluYXRlKGFyZ3VtZW50c1swXSk7fWVsc2UgaWYoYXJndW1lbnRzWzBdaW5zdGFuY2VvZiBqc3RzLmdlb20uQ29vcmRpbmF0ZSYmYXJndW1lbnRzLmxlbmd0aD09PTIpe3RoaXMuaW5pdEZyb21Db29yZGluYXRlcyhhcmd1bWVudHNbMF0sYXJndW1lbnRzWzFdKTt9ZWxzZSBpZihhcmd1bWVudHNbMF1pbnN0YW5jZW9mIGpzdHMuZ2VvbS5FbnZlbG9wZSYmYXJndW1lbnRzLmxlbmd0aD09PTEpe3RoaXMuaW5pdEZyb21FbnZlbG9wZShhcmd1bWVudHNbMF0pO31lbHNle3RoaXMuc2V0VG9OdWxsKCk7fX07anN0cy5nZW9tLkVudmVsb3BlLnByb3RvdHlwZS5pbml0RnJvbVZhbHVlcz1mdW5jdGlvbih4MSx4Mix5MSx5Mil7aWYoeDE8eDIpe3RoaXMubWlueD14MTt0aGlzLm1heHg9eDI7fWVsc2V7dGhpcy5taW54PXgyO3RoaXMubWF4eD14MTt9XG5pZih5MTx5Mil7dGhpcy5taW55PXkxO3RoaXMubWF4eT15Mjt9ZWxzZXt0aGlzLm1pbnk9eTI7dGhpcy5tYXh5PXkxO319O2pzdHMuZ2VvbS5FbnZlbG9wZS5wcm90b3R5cGUuaW5pdEZyb21Db29yZGluYXRlcz1mdW5jdGlvbihwMSxwMil7dGhpcy5pbml0RnJvbVZhbHVlcyhwMS54LHAyLngscDEueSxwMi55KTt9O2pzdHMuZ2VvbS5FbnZlbG9wZS5wcm90b3R5cGUuaW5pdEZyb21Db29yZGluYXRlPWZ1bmN0aW9uKHApe3RoaXMuaW5pdEZyb21WYWx1ZXMocC54LHAueCxwLnkscC55KTt9O2pzdHMuZ2VvbS5FbnZlbG9wZS5wcm90b3R5cGUuaW5pdEZyb21FbnZlbG9wZT1mdW5jdGlvbihlbnYpe3RoaXMubWlueD1lbnYubWlueDt0aGlzLm1heHg9ZW52Lm1heHg7dGhpcy5taW55PWVudi5taW55O3RoaXMubWF4eT1lbnYubWF4eTt9O2pzdHMuZ2VvbS5FbnZlbG9wZS5wcm90b3R5cGUuc2V0VG9OdWxsPWZ1bmN0aW9uKCl7dGhpcy5taW54PTA7dGhpcy5tYXh4PS0xO3RoaXMubWlueT0wO3RoaXMubWF4eT0tMTt9O2pzdHMuZ2VvbS5FbnZlbG9wZS5wcm90b3R5cGUuaXNOdWxsPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMubWF4eDx0aGlzLm1pbng7fTtqc3RzLmdlb20uRW52ZWxvcGUucHJvdG90eXBlLmdldEhlaWdodD1mdW5jdGlvbigpe2lmKHRoaXMuaXNOdWxsKCkpe3JldHVybiAwO31cbnJldHVybiB0aGlzLm1heHktdGhpcy5taW55O307anN0cy5nZW9tLkVudmVsb3BlLnByb3RvdHlwZS5nZXRXaWR0aD1mdW5jdGlvbigpe2lmKHRoaXMuaXNOdWxsKCkpe3JldHVybiAwO31cbnJldHVybiB0aGlzLm1heHgtdGhpcy5taW54O307anN0cy5nZW9tLkVudmVsb3BlLnByb3RvdHlwZS5nZXRNaW5YPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMubWlueDt9O2pzdHMuZ2VvbS5FbnZlbG9wZS5wcm90b3R5cGUuZ2V0TWF4WD1mdW5jdGlvbigpe3JldHVybiB0aGlzLm1heHg7fTtqc3RzLmdlb20uRW52ZWxvcGUucHJvdG90eXBlLmdldE1pblk9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5taW55O307anN0cy5nZW9tLkVudmVsb3BlLnByb3RvdHlwZS5nZXRNYXhZPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMubWF4eTt9O2pzdHMuZ2VvbS5FbnZlbG9wZS5wcm90b3R5cGUuZ2V0QXJlYT1mdW5jdGlvbigpe3JldHVybiB0aGlzLmdldFdpZHRoKCkqdGhpcy5nZXRIZWlnaHQoKTt9O2pzdHMuZ2VvbS5FbnZlbG9wZS5wcm90b3R5cGUuZXhwYW5kVG9JbmNsdWRlPWZ1bmN0aW9uKCl7aWYoYXJndW1lbnRzWzBdaW5zdGFuY2VvZiBqc3RzLmdlb20uQ29vcmRpbmF0ZSl7dGhpcy5leHBhbmRUb0luY2x1ZGVDb29yZGluYXRlKGFyZ3VtZW50c1swXSk7fWVsc2UgaWYoYXJndW1lbnRzWzBdaW5zdGFuY2VvZiBqc3RzLmdlb20uRW52ZWxvcGUpe3RoaXMuZXhwYW5kVG9JbmNsdWRlRW52ZWxvcGUoYXJndW1lbnRzWzBdKTt9ZWxzZXt0aGlzLmV4cGFuZFRvSW5jbHVkZVZhbHVlcyhhcmd1bWVudHNbMF0sYXJndW1lbnRzWzFdKTt9fTtqc3RzLmdlb20uRW52ZWxvcGUucHJvdG90eXBlLmV4cGFuZFRvSW5jbHVkZUNvb3JkaW5hdGU9ZnVuY3Rpb24ocCl7dGhpcy5leHBhbmRUb0luY2x1ZGVWYWx1ZXMocC54LHAueSk7fTtqc3RzLmdlb20uRW52ZWxvcGUucHJvdG90eXBlLmV4cGFuZFRvSW5jbHVkZVZhbHVlcz1mdW5jdGlvbih4LHkpe2lmKHRoaXMuaXNOdWxsKCkpe3RoaXMubWlueD14O3RoaXMubWF4eD14O3RoaXMubWlueT15O3RoaXMubWF4eT15O31lbHNle2lmKHg8dGhpcy5taW54KXt0aGlzLm1pbng9eDt9XG5pZih4PnRoaXMubWF4eCl7dGhpcy5tYXh4PXg7fVxuaWYoeTx0aGlzLm1pbnkpe3RoaXMubWlueT15O31cbmlmKHk+dGhpcy5tYXh5KXt0aGlzLm1heHk9eTt9fX07anN0cy5nZW9tLkVudmVsb3BlLnByb3RvdHlwZS5leHBhbmRUb0luY2x1ZGVFbnZlbG9wZT1mdW5jdGlvbihvdGhlcil7aWYob3RoZXIuaXNOdWxsKCkpe3JldHVybjt9XG5pZih0aGlzLmlzTnVsbCgpKXt0aGlzLm1pbng9b3RoZXIuZ2V0TWluWCgpO3RoaXMubWF4eD1vdGhlci5nZXRNYXhYKCk7dGhpcy5taW55PW90aGVyLmdldE1pblkoKTt0aGlzLm1heHk9b3RoZXIuZ2V0TWF4WSgpO31lbHNle2lmKG90aGVyLm1pbng8dGhpcy5taW54KXt0aGlzLm1pbng9b3RoZXIubWlueDt9XG5pZihvdGhlci5tYXh4PnRoaXMubWF4eCl7dGhpcy5tYXh4PW90aGVyLm1heHg7fVxuaWYob3RoZXIubWlueTx0aGlzLm1pbnkpe3RoaXMubWlueT1vdGhlci5taW55O31cbmlmKG90aGVyLm1heHk+dGhpcy5tYXh5KXt0aGlzLm1heHk9b3RoZXIubWF4eTt9fX07anN0cy5nZW9tLkVudmVsb3BlLnByb3RvdHlwZS5leHBhbmRCeT1mdW5jdGlvbigpe2lmKGFyZ3VtZW50cy5sZW5ndGg9PT0xKXt0aGlzLmV4cGFuZEJ5RGlzdGFuY2UoYXJndW1lbnRzWzBdKTt9ZWxzZXt0aGlzLmV4cGFuZEJ5RGlzdGFuY2VzKGFyZ3VtZW50c1swXSxhcmd1bWVudHNbMV0pO319O2pzdHMuZ2VvbS5FbnZlbG9wZS5wcm90b3R5cGUuZXhwYW5kQnlEaXN0YW5jZT1mdW5jdGlvbihkaXN0YW5jZSl7dGhpcy5leHBhbmRCeURpc3RhbmNlcyhkaXN0YW5jZSxkaXN0YW5jZSk7fTtqc3RzLmdlb20uRW52ZWxvcGUucHJvdG90eXBlLmV4cGFuZEJ5RGlzdGFuY2VzPWZ1bmN0aW9uKGRlbHRhWCxkZWx0YVkpe2lmKHRoaXMuaXNOdWxsKCkpe3JldHVybjt9XG50aGlzLm1pbngtPWRlbHRhWDt0aGlzLm1heHgrPWRlbHRhWDt0aGlzLm1pbnktPWRlbHRhWTt0aGlzLm1heHkrPWRlbHRhWTtpZih0aGlzLm1pbng+dGhpcy5tYXh4fHx0aGlzLm1pbnk+dGhpcy5tYXh5KXt0aGlzLnNldFRvTnVsbCgpO319O2pzdHMuZ2VvbS5FbnZlbG9wZS5wcm90b3R5cGUudHJhbnNsYXRlPWZ1bmN0aW9uKHRyYW5zWCx0cmFuc1kpe2lmKHRoaXMuaXNOdWxsKCkpe3JldHVybjt9XG50aGlzLmluaXQodGhpcy5taW54K3RyYW5zWCx0aGlzLm1heHgrdHJhbnNYLHRoaXMubWlueSt0cmFuc1ksdGhpcy5tYXh5K3RyYW5zWSk7fTtqc3RzLmdlb20uRW52ZWxvcGUucHJvdG90eXBlLmNlbnRyZT1mdW5jdGlvbigpe2lmKHRoaXMuaXNOdWxsKCkpe3JldHVybiBudWxsO31cbnJldHVybiBuZXcganN0cy5nZW9tLkNvb3JkaW5hdGUoKHRoaXMubWlueCt0aGlzLm1heHgpLzIuMCwodGhpcy5taW55K3RoaXMubWF4eSkvMi4wKTt9O2pzdHMuZ2VvbS5FbnZlbG9wZS5wcm90b3R5cGUuaW50ZXJzZWN0aW9uPWZ1bmN0aW9uKGVudil7aWYodGhpcy5pc051bGwoKXx8ZW52LmlzTnVsbCgpfHwhdGhpcy5pbnRlcnNlY3RzKGVudikpe3JldHVybiBuZXcganN0cy5nZW9tLkVudmVsb3BlKCk7fVxudmFyIGludE1pblg9dGhpcy5taW54PmVudi5taW54P3RoaXMubWlueDplbnYubWlueDt2YXIgaW50TWluWT10aGlzLm1pbnk+ZW52Lm1pbnk/dGhpcy5taW55OmVudi5taW55O3ZhciBpbnRNYXhYPXRoaXMubWF4eDxlbnYubWF4eD90aGlzLm1heHg6ZW52Lm1heHg7dmFyIGludE1heFk9dGhpcy5tYXh5PGVudi5tYXh5P3RoaXMubWF4eTplbnYubWF4eTtyZXR1cm4gbmV3IGpzdHMuZ2VvbS5FbnZlbG9wZShpbnRNaW5YLGludE1heFgsaW50TWluWSxpbnRNYXhZKTt9O2pzdHMuZ2VvbS5FbnZlbG9wZS5wcm90b3R5cGUuaW50ZXJzZWN0cz1mdW5jdGlvbigpe2lmKGFyZ3VtZW50c1swXWluc3RhbmNlb2YganN0cy5nZW9tLkVudmVsb3BlKXtyZXR1cm4gdGhpcy5pbnRlcnNlY3RzRW52ZWxvcGUoYXJndW1lbnRzWzBdKTt9ZWxzZSBpZihhcmd1bWVudHNbMF1pbnN0YW5jZW9mIGpzdHMuZ2VvbS5Db29yZGluYXRlKXtyZXR1cm4gdGhpcy5pbnRlcnNlY3RzQ29vcmRpbmF0ZShhcmd1bWVudHNbMF0pO31lbHNle3JldHVybiB0aGlzLmludGVyc2VjdHNWYWx1ZXMoYXJndW1lbnRzWzBdLGFyZ3VtZW50c1sxXSk7fX07anN0cy5nZW9tLkVudmVsb3BlLnByb3RvdHlwZS5pbnRlcnNlY3RzRW52ZWxvcGU9ZnVuY3Rpb24ob3RoZXIpe2lmKHRoaXMuaXNOdWxsKCl8fG90aGVyLmlzTnVsbCgpKXtyZXR1cm4gZmFsc2U7fVxudmFyIHJlc3VsdD0hKG90aGVyLm1pbng+dGhpcy5tYXh4fHxvdGhlci5tYXh4PHRoaXMubWlueHx8b3RoZXIubWlueT50aGlzLm1heHl8fG90aGVyLm1heHk8dGhpcy5taW55KTtyZXR1cm4gcmVzdWx0O307anN0cy5nZW9tLkVudmVsb3BlLnByb3RvdHlwZS5pbnRlcnNlY3RzQ29vcmRpbmF0ZT1mdW5jdGlvbihwKXtyZXR1cm4gdGhpcy5pbnRlcnNlY3RzVmFsdWVzKHAueCxwLnkpO307anN0cy5nZW9tLkVudmVsb3BlLnByb3RvdHlwZS5pbnRlcnNlY3RzVmFsdWVzPWZ1bmN0aW9uKHgseSl7aWYodGhpcy5pc051bGwoKSl7cmV0dXJuIGZhbHNlO31cbnJldHVybiEoeD50aGlzLm1heHh8fHg8dGhpcy5taW54fHx5PnRoaXMubWF4eXx8eTx0aGlzLm1pbnkpO307anN0cy5nZW9tLkVudmVsb3BlLnByb3RvdHlwZS5jb250YWlucz1mdW5jdGlvbigpe2lmKGFyZ3VtZW50c1swXWluc3RhbmNlb2YganN0cy5nZW9tLkVudmVsb3BlKXtyZXR1cm4gdGhpcy5jb250YWluc0VudmVsb3BlKGFyZ3VtZW50c1swXSk7fWVsc2UgaWYoYXJndW1lbnRzWzBdaW5zdGFuY2VvZiBqc3RzLmdlb20uQ29vcmRpbmF0ZSl7cmV0dXJuIHRoaXMuY29udGFpbnNDb29yZGluYXRlKGFyZ3VtZW50c1swXSk7fWVsc2V7cmV0dXJuIHRoaXMuY29udGFpbnNWYWx1ZXMoYXJndW1lbnRzWzBdLGFyZ3VtZW50c1sxXSk7fX07anN0cy5nZW9tLkVudmVsb3BlLnByb3RvdHlwZS5jb250YWluc0VudmVsb3BlPWZ1bmN0aW9uKG90aGVyKXtyZXR1cm4gdGhpcy5jb3ZlcnNFbnZlbG9wZShvdGhlcik7fTtqc3RzLmdlb20uRW52ZWxvcGUucHJvdG90eXBlLmNvbnRhaW5zQ29vcmRpbmF0ZT1mdW5jdGlvbihwKXtyZXR1cm4gdGhpcy5jb3ZlcnNDb29yZGluYXRlKHApO307anN0cy5nZW9tLkVudmVsb3BlLnByb3RvdHlwZS5jb250YWluc1ZhbHVlcz1mdW5jdGlvbih4LHkpe3JldHVybiB0aGlzLmNvdmVyc1ZhbHVlcyh4LHkpO307anN0cy5nZW9tLkVudmVsb3BlLnByb3RvdHlwZS5jb3ZlcnM9ZnVuY3Rpb24oKXtpZihhcmd1bWVudHNbMF1pbnN0YW5jZW9mIGpzdHMuZ2VvbS5FbnZlbG9wZSl7cmV0dXJuIHRoaXMuY292ZXJzRW52ZWxvcGUoYXJndW1lbnRzWzBdKTt9ZWxzZSBpZihhcmd1bWVudHNbMF1pbnN0YW5jZW9mIGpzdHMuZ2VvbS5Db29yZGluYXRlKXtyZXR1cm4gdGhpcy5jb3ZlcnNDb29yZGluYXRlKGFyZ3VtZW50c1swXSk7fWVsc2V7cmV0dXJuIHRoaXMuY292ZXJzVmFsdWVzKGFyZ3VtZW50c1swXSxhcmd1bWVudHNbMV0pO319O2pzdHMuZ2VvbS5FbnZlbG9wZS5wcm90b3R5cGUuY292ZXJzVmFsdWVzPWZ1bmN0aW9uKHgseSl7aWYodGhpcy5pc051bGwoKSl7cmV0dXJuIGZhbHNlO31cbnJldHVybiB4Pj10aGlzLm1pbngmJng8PXRoaXMubWF4eCYmeT49dGhpcy5taW55JiZ5PD10aGlzLm1heHk7fTtqc3RzLmdlb20uRW52ZWxvcGUucHJvdG90eXBlLmNvdmVyc0Nvb3JkaW5hdGU9ZnVuY3Rpb24ocCl7cmV0dXJuIHRoaXMuY292ZXJzVmFsdWVzKHAueCxwLnkpO307anN0cy5nZW9tLkVudmVsb3BlLnByb3RvdHlwZS5jb3ZlcnNFbnZlbG9wZT1mdW5jdGlvbihvdGhlcil7aWYodGhpcy5pc051bGwoKXx8b3RoZXIuaXNOdWxsKCkpe3JldHVybiBmYWxzZTt9XG5yZXR1cm4gb3RoZXIubWlueD49dGhpcy5taW54JiZvdGhlci5tYXh4PD10aGlzLm1heHgmJm90aGVyLm1pbnk+PXRoaXMubWlueSYmb3RoZXIubWF4eTw9dGhpcy5tYXh5O307anN0cy5nZW9tLkVudmVsb3BlLnByb3RvdHlwZS5kaXN0YW5jZT1mdW5jdGlvbihlbnYpe2lmKHRoaXMuaW50ZXJzZWN0cyhlbnYpKXtyZXR1cm4gMDt9XG52YXIgZHg9MC4wO2lmKHRoaXMubWF4eDxlbnYubWlueCl7ZHg9ZW52Lm1pbngtdGhpcy5tYXh4O31cbmlmKHRoaXMubWlueD5lbnYubWF4eCl7ZHg9dGhpcy5taW54LWVudi5tYXh4O31cbnZhciBkeT0wLjA7aWYodGhpcy5tYXh5PGVudi5taW55KXtkeT1lbnYubWlueS10aGlzLm1heHk7fVxuaWYodGhpcy5taW55PmVudi5tYXh5KXtkeT10aGlzLm1pbnktZW52Lm1heHk7fVxuaWYoZHg9PT0wLjApe3JldHVybiBkeTt9XG5pZihkeT09PTAuMCl7cmV0dXJuIGR4O31cbnJldHVybiBNYXRoLnNxcnQoZHgqZHgrZHkqZHkpO307anN0cy5nZW9tLkVudmVsb3BlLnByb3RvdHlwZS5lcXVhbHM9ZnVuY3Rpb24ob3RoZXIpe2lmKHRoaXMuaXNOdWxsKCkpe3JldHVybiBvdGhlci5pc051bGwoKTt9XG5yZXR1cm4gdGhpcy5tYXh4PT09b3RoZXIubWF4eCYmdGhpcy5tYXh5PT09b3RoZXIubWF4eSYmdGhpcy5taW54PT09b3RoZXIubWlueCYmdGhpcy5taW55PT09b3RoZXIubWlueTt9O2pzdHMuZ2VvbS5FbnZlbG9wZS5wcm90b3R5cGUudG9TdHJpbmc9ZnVuY3Rpb24oKXtyZXR1cm4nRW52WycrdGhpcy5taW54KycgOiAnK3RoaXMubWF4eCsnLCAnK3RoaXMubWlueSsnIDogJytcbnRoaXMubWF4eSsnXSc7fTtqc3RzLmdlb20uRW52ZWxvcGUuaW50ZXJzZWN0cz1mdW5jdGlvbihwMSxwMixxKXtpZihhcmd1bWVudHMubGVuZ3RoPT09NCl7cmV0dXJuIGpzdHMuZ2VvbS5FbnZlbG9wZS5pbnRlcnNlY3RzRW52ZWxvcGUoYXJndW1lbnRzWzBdLGFyZ3VtZW50c1sxXSxhcmd1bWVudHNbMl0sYXJndW1lbnRzWzNdKTt9XG52YXIgeGMxPXAxLng8cDIueD9wMS54OnAyLng7dmFyIHhjMj1wMS54PnAyLng/cDEueDpwMi54O3ZhciB5YzE9cDEueTxwMi55P3AxLnk6cDIueTt2YXIgeWMyPXAxLnk+cDIueT9wMS55OnAyLnk7aWYoKChxLng+PXhjMSkmJihxLng8PXhjMikpJiYoKHEueT49eWMxKSYmKHEueTw9eWMyKSkpe3JldHVybiB0cnVlO31cbnJldHVybiBmYWxzZTt9O2pzdHMuZ2VvbS5FbnZlbG9wZS5pbnRlcnNlY3RzRW52ZWxvcGU9ZnVuY3Rpb24ocDEscDIscTEscTIpe3ZhciBtaW5xPU1hdGgubWluKHExLngscTIueCk7dmFyIG1heHE9TWF0aC5tYXgocTEueCxxMi54KTt2YXIgbWlucD1NYXRoLm1pbihwMS54LHAyLngpO3ZhciBtYXhwPU1hdGgubWF4KHAxLngscDIueCk7aWYobWlucD5tYXhxKXtyZXR1cm4gZmFsc2U7fVxuaWYobWF4cDxtaW5xKXtyZXR1cm4gZmFsc2U7fVxubWlucT1NYXRoLm1pbihxMS55LHEyLnkpO21heHE9TWF0aC5tYXgocTEueSxxMi55KTttaW5wPU1hdGgubWluKHAxLnkscDIueSk7bWF4cD1NYXRoLm1heChwMS55LHAyLnkpO2lmKG1pbnA+bWF4cSl7cmV0dXJuIGZhbHNlO31cbmlmKG1heHA8bWlucSl7cmV0dXJuIGZhbHNlO31cbnJldHVybiB0cnVlO307anN0cy5nZW9tLkVudmVsb3BlLnByb3RvdHlwZS5jbG9uZT1mdW5jdGlvbigpe3JldHVybiBuZXcganN0cy5nZW9tLkVudmVsb3BlKHRoaXMubWlueCx0aGlzLm1heHgsdGhpcy5taW55LHRoaXMubWF4eSk7fTtqc3RzLmdlb20udXRpbC5HZW9tZXRyeUNvbWJpbmVyPWZ1bmN0aW9uKGdlb21zKXt0aGlzLmdlb21GYWN0b3J5PWpzdHMuZ2VvbS51dGlsLkdlb21ldHJ5Q29tYmluZXIuZXh0cmFjdEZhY3RvcnkoZ2VvbXMpO3RoaXMuaW5wdXRHZW9tcz1nZW9tczt9O2pzdHMuZ2VvbS51dGlsLkdlb21ldHJ5Q29tYmluZXIuY29tYmluZT1mdW5jdGlvbihnZW9tcyl7aWYoYXJndW1lbnRzLmxlbmd0aD4xKXJldHVybiB0aGlzLmNvbWJpbmUyLmFwcGx5KHRoaXMsYXJndW1lbnRzKTt2YXIgY29tYmluZXI9bmV3IGpzdHMuZ2VvbS51dGlsLkdlb21ldHJ5Q29tYmluZXIoZ2VvbXMpO3JldHVybiBjb21iaW5lci5jb21iaW5lKCk7fTtqc3RzLmdlb20udXRpbC5HZW9tZXRyeUNvbWJpbmVyLmNvbWJpbmUyPWZ1bmN0aW9uKCl7dmFyIGFycmF5TGlzdD1uZXcgamF2YXNjcmlwdC51dGlsLkFycmF5TGlzdCgpO0FycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cykuZm9yRWFjaChmdW5jdGlvbihhKXthcnJheUxpc3QuYWRkKGEpO30pO3ZhciBjb21iaW5lcj1uZXcganN0cy5nZW9tLnV0aWwuR2VvbWV0cnlDb21iaW5lcihhcnJheUxpc3QpO3JldHVybiBjb21iaW5lci5jb21iaW5lKCk7fTtqc3RzLmdlb20udXRpbC5HZW9tZXRyeUNvbWJpbmVyLnByb3RvdHlwZS5nZW9tRmFjdG9yeT1udWxsO2pzdHMuZ2VvbS51dGlsLkdlb21ldHJ5Q29tYmluZXIucHJvdG90eXBlLnNraXBFbXB0eT1mYWxzZTtqc3RzLmdlb20udXRpbC5HZW9tZXRyeUNvbWJpbmVyLnByb3RvdHlwZS5pbnB1dEdlb21zO2pzdHMuZ2VvbS51dGlsLkdlb21ldHJ5Q29tYmluZXIuZXh0cmFjdEZhY3Rvcnk9ZnVuY3Rpb24oZ2VvbXMpe2lmKGdlb21zLmlzRW1wdHkoKSlyZXR1cm4gbnVsbDtyZXR1cm4gZ2VvbXMuaXRlcmF0b3IoKS5uZXh0KCkuZ2V0RmFjdG9yeSgpO307anN0cy5nZW9tLnV0aWwuR2VvbWV0cnlDb21iaW5lci5wcm90b3R5cGUuY29tYmluZT1mdW5jdGlvbigpe3ZhciBlbGVtcz1uZXcgamF2YXNjcmlwdC51dGlsLkFycmF5TGlzdCgpLGk7Zm9yKGk9dGhpcy5pbnB1dEdlb21zLml0ZXJhdG9yKCk7aS5oYXNOZXh0KCk7KXt2YXIgZz1pLm5leHQoKTt0aGlzLmV4dHJhY3RFbGVtZW50cyhnLGVsZW1zKTt9XG5pZihlbGVtcy5zaXplKCk9PT0wKXtpZih0aGlzLmdlb21GYWN0b3J5IT09bnVsbCl7cmV0dXJuIHRoaXMuZ2VvbUZhY3RvcnkuY3JlYXRlR2VvbWV0cnlDb2xsZWN0aW9uKG51bGwpO31cbnJldHVybiBudWxsO31cbnJldHVybiB0aGlzLmdlb21GYWN0b3J5LmJ1aWxkR2VvbWV0cnkoZWxlbXMpO307anN0cy5nZW9tLnV0aWwuR2VvbWV0cnlDb21iaW5lci5wcm90b3R5cGUuZXh0cmFjdEVsZW1lbnRzPWZ1bmN0aW9uKGdlb20sZWxlbXMpe2lmKGdlb209PT1udWxsKXtyZXR1cm47fVxuZm9yKHZhciBpPTA7aTxnZW9tLmdldE51bUdlb21ldHJpZXMoKTtpKyspe3ZhciBlbGVtR2VvbT1nZW9tLmdldEdlb21ldHJ5TihpKTtpZih0aGlzLnNraXBFbXB0eSYmZWxlbUdlb20uaXNFbXB0eSgpKXtjb250aW51ZTt9XG5lbGVtcy5hZGQoZWxlbUdlb20pO319O2pzdHMuZ2VvbS5QcmVjaXNpb25Nb2RlbD1mdW5jdGlvbihtb2RlbFR5cGUpe2lmKHR5cGVvZiBtb2RlbFR5cGU9PT0nbnVtYmVyJyl7dGhpcy5tb2RlbFR5cGU9anN0cy5nZW9tLlByZWNpc2lvbk1vZGVsLkZJWEVEO3RoaXMuc2NhbGU9bW9kZWxUeXBlO3JldHVybjt9XG50aGlzLm1vZGVsVHlwZT1tb2RlbFR5cGV8fGpzdHMuZ2VvbS5QcmVjaXNpb25Nb2RlbC5GTE9BVElORztpZih0aGlzLm1vZGVsVHlwZT09PWpzdHMuZ2VvbS5QcmVjaXNpb25Nb2RlbC5GSVhFRCl7dGhpcy5zY2FsZT0xLjA7fX07anN0cy5nZW9tLlByZWNpc2lvbk1vZGVsLkZMT0FUSU5HPSdGTE9BVElORyc7anN0cy5nZW9tLlByZWNpc2lvbk1vZGVsLkZJWEVEPSdGSVhFRCc7anN0cy5nZW9tLlByZWNpc2lvbk1vZGVsLkZMT0FUSU5HX1NJTkdMRT0nRkxPQVRJTkdfU0lOR0xFJztqc3RzLmdlb20uUHJlY2lzaW9uTW9kZWwucHJvdG90eXBlLnNjYWxlPW51bGw7anN0cy5nZW9tLlByZWNpc2lvbk1vZGVsLnByb3RvdHlwZS5tb2RlbFR5cGU9bnVsbDtqc3RzLmdlb20uUHJlY2lzaW9uTW9kZWwucHJvdG90eXBlLmlzRmxvYXRpbmc9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5tb2RlbFR5cGU9PT1qc3RzLmdlb20uUHJlY2lzaW9uTW9kZWwuRkxPQVRJTkd8fHRoaXMubW9kZWxUeXBlPT09anN0cy5nZW9tLlByZWNpc2lvbk1vZGVsLkZMT0FUSU5HX1NJTkxHRTt9O2pzdHMuZ2VvbS5QcmVjaXNpb25Nb2RlbC5wcm90b3R5cGUuZ2V0U2NhbGU9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5zY2FsZTt9O2pzdHMuZ2VvbS5QcmVjaXNpb25Nb2RlbC5wcm90b3R5cGUuZ2V0VHlwZT1mdW5jdGlvbigpe3JldHVybiB0aGlzLm1vZGVsVHlwZTt9O2pzdHMuZ2VvbS5QcmVjaXNpb25Nb2RlbC5wcm90b3R5cGUuZXF1YWxzPWZ1bmN0aW9uKG90aGVyKXtyZXR1cm4gdHJ1ZTtpZighKG90aGVyIGluc3RhbmNlb2YganN0cy5nZW9tLlByZWNpc2lvbk1vZGVsKSl7cmV0dXJuIGZhbHNlO31cbnZhciBvdGhlclByZWNpc2lvbk1vZGVsPW90aGVyO3JldHVybiB0aGlzLm1vZGVsVHlwZT09PW90aGVyUHJlY2lzaW9uTW9kZWwubW9kZWxUeXBlJiZ0aGlzLnNjYWxlPT09b3RoZXJQcmVjaXNpb25Nb2RlbC5zY2FsZTt9O2pzdHMuZ2VvbS5QcmVjaXNpb25Nb2RlbC5wcm90b3R5cGUubWFrZVByZWNpc2U9ZnVuY3Rpb24odmFsKXtpZih2YWwgaW5zdGFuY2VvZiBqc3RzLmdlb20uQ29vcmRpbmF0ZSl7dGhpcy5tYWtlUHJlY2lzZTIodmFsKTtyZXR1cm47fVxuaWYoaXNOYU4odmFsKSlcbnJldHVybiB2YWw7aWYodGhpcy5tb2RlbFR5cGU9PT1qc3RzLmdlb20uUHJlY2lzaW9uTW9kZWwuRklYRUQpe3JldHVybiBNYXRoLnJvdW5kKHZhbCp0aGlzLnNjYWxlKS90aGlzLnNjYWxlO31cbnJldHVybiB2YWw7fTtqc3RzLmdlb20uUHJlY2lzaW9uTW9kZWwucHJvdG90eXBlLm1ha2VQcmVjaXNlMj1mdW5jdGlvbihjb29yZCl7aWYodGhpcy5tb2RlbFR5cGU9PT1qc3RzLmdlb20uUHJlY2lzaW9uTW9kZWwuRkxPQVRJTkcpXG5yZXR1cm47Y29vcmQueD10aGlzLm1ha2VQcmVjaXNlKGNvb3JkLngpO2Nvb3JkLnk9dGhpcy5tYWtlUHJlY2lzZShjb29yZC55KTt9O2pzdHMuZ2VvbS5QcmVjaXNpb25Nb2RlbC5wcm90b3R5cGUuY29tcGFyZVRvPWZ1bmN0aW9uKG8pe3ZhciBvdGhlcj1vO3JldHVybiAwO307anN0cy5nZW9tLkNvb3JkaW5hdGVGaWx0ZXI9ZnVuY3Rpb24oKXt9O2pzdHMuZ2VvbS5Db29yZGluYXRlRmlsdGVyLnByb3RvdHlwZS5maWx0ZXI9ZnVuY3Rpb24oY29vcmQpe3Rocm93IG5ldyBqc3RzLmVycm9yLkFic3RyYWN0TWV0aG9kSW52b2NhdGlvbkVycm9yKCk7fTtqc3RzLnNpbXBsaWZ5LkRvdWdsYXNQZXVja2VyTGluZVNpbXBsaWZpZXI9ZnVuY3Rpb24ocHRzKXt0aGlzLnB0cz1wdHM7dGhpcy5zZWc9bmV3IGpzdHMuZ2VvbS5MaW5lU2VnbWVudCgpO307anN0cy5zaW1wbGlmeS5Eb3VnbGFzUGV1Y2tlckxpbmVTaW1wbGlmaWVyLnByb3RvdHlwZS5wdHM9bnVsbDtqc3RzLnNpbXBsaWZ5LkRvdWdsYXNQZXVja2VyTGluZVNpbXBsaWZpZXIucHJvdG90eXBlLnVzZVB0PW51bGw7anN0cy5zaW1wbGlmeS5Eb3VnbGFzUGV1Y2tlckxpbmVTaW1wbGlmaWVyLnByb3RvdHlwZS5kaXN0YW5jZVRvbGVyYW5jZT1udWxsO2pzdHMuc2ltcGxpZnkuRG91Z2xhc1BldWNrZXJMaW5lU2ltcGxpZmllci5zaW1wbGlmeT1mdW5jdGlvbihwdHMsZGlzdGFuY2VUb2xlcmFuY2Upe3ZhciBzaW1wPW5ldyBqc3RzLnNpbXBsaWZ5LkRvdWdsYXNQZXVja2VyTGluZVNpbXBsaWZpZXIocHRzKTtzaW1wLnNldERpc3RhbmNlVG9sZXJhbmNlKGRpc3RhbmNlVG9sZXJhbmNlKTtyZXR1cm4gc2ltcC5zaW1wbGlmeSgpO307anN0cy5zaW1wbGlmeS5Eb3VnbGFzUGV1Y2tlckxpbmVTaW1wbGlmaWVyLnByb3RvdHlwZS5zZXREaXN0YW5jZVRvbGVyYW5jZT1mdW5jdGlvbihkaXN0YW5jZVRvbGVyYW5jZSl7dGhpcy5kaXN0YW5jZVRvbGVyYW5jZT1kaXN0YW5jZVRvbGVyYW5jZTt9O2pzdHMuc2ltcGxpZnkuRG91Z2xhc1BldWNrZXJMaW5lU2ltcGxpZmllci5wcm90b3R5cGUuc2ltcGxpZnk9ZnVuY3Rpb24oKXt0aGlzLnVzZVB0PVtdO2Zvcih2YXIgaT0wO2k8dGhpcy5wdHMubGVuZ3RoO2krKyl7dGhpcy51c2VQdFtpXT10cnVlO31cbnRoaXMuc2ltcGxpZnlTZWN0aW9uKDAsdGhpcy5wdHMubGVuZ3RoLTEpO3ZhciBjb29yZExpc3Q9bmV3IGpzdHMuZ2VvbS5Db29yZGluYXRlTGlzdCgpO2Zvcih2YXIgaj0wO2o8dGhpcy5wdHMubGVuZ3RoO2orKyl7aWYodGhpcy51c2VQdFtqXSl7Y29vcmRMaXN0LmFkZChuZXcganN0cy5nZW9tLkNvb3JkaW5hdGUodGhpcy5wdHNbal0pKTt9fVxucmV0dXJuIGNvb3JkTGlzdC50b0Nvb3JkaW5hdGVBcnJheSgpO307anN0cy5zaW1wbGlmeS5Eb3VnbGFzUGV1Y2tlckxpbmVTaW1wbGlmaWVyLnByb3RvdHlwZS5zZWc9bnVsbDtqc3RzLnNpbXBsaWZ5LkRvdWdsYXNQZXVja2VyTGluZVNpbXBsaWZpZXIucHJvdG90eXBlLnNpbXBsaWZ5U2VjdGlvbj1mdW5jdGlvbihpLGope2lmKGkrMT09ail7cmV0dXJuO31cbnRoaXMuc2VnLnAwPXRoaXMucHRzW2ldO3RoaXMuc2VnLnAxPXRoaXMucHRzW2pdO3ZhciBtYXhEaXN0YW5jZT0tMS4wO3ZhciBtYXhJbmRleD1pO2Zvcih2YXIgaz1pKzE7azxqO2srKyl7dmFyIGRpc3RhbmNlPXRoaXMuc2VnLmRpc3RhbmNlKHRoaXMucHRzW2tdKTtpZihkaXN0YW5jZT5tYXhEaXN0YW5jZSl7bWF4RGlzdGFuY2U9ZGlzdGFuY2U7bWF4SW5kZXg9azt9fVxuaWYobWF4RGlzdGFuY2U8PXRoaXMuZGlzdGFuY2VUb2xlcmFuY2Upe2Zvcih2YXIgbD1pKzE7bDxqO2wrKyl7dGhpcy51c2VQdFtsXT1mYWxzZTt9fWVsc2V7dGhpcy5zaW1wbGlmeVNlY3Rpb24oaSxtYXhJbmRleCk7dGhpcy5zaW1wbGlmeVNlY3Rpb24obWF4SW5kZXgsaik7fX07anN0cy5nZW9tZ3JhcGguRWRnZUludGVyc2VjdGlvbj1mdW5jdGlvbihjb29yZCxzZWdtZW50SW5kZXgsZGlzdCl7dGhpcy5jb29yZD1uZXcganN0cy5nZW9tLkNvb3JkaW5hdGUoY29vcmQpO3RoaXMuc2VnbWVudEluZGV4PXNlZ21lbnRJbmRleDt0aGlzLmRpc3Q9ZGlzdDt9O2pzdHMuZ2VvbWdyYXBoLkVkZ2VJbnRlcnNlY3Rpb24ucHJvdG90eXBlLmNvb3JkPW51bGw7anN0cy5nZW9tZ3JhcGguRWRnZUludGVyc2VjdGlvbi5wcm90b3R5cGUuc2VnbWVudEluZGV4PW51bGw7anN0cy5nZW9tZ3JhcGguRWRnZUludGVyc2VjdGlvbi5wcm90b3R5cGUuZGlzdD1udWxsO2pzdHMuZ2VvbWdyYXBoLkVkZ2VJbnRlcnNlY3Rpb24ucHJvdG90eXBlLmdldENvb3JkaW5hdGU9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5jb29yZDt9O2pzdHMuZ2VvbWdyYXBoLkVkZ2VJbnRlcnNlY3Rpb24ucHJvdG90eXBlLmdldFNlZ21lbnRJbmRleD1mdW5jdGlvbigpe3JldHVybiB0aGlzLnNlZ21lbnRJbmRleDt9O2pzdHMuZ2VvbWdyYXBoLkVkZ2VJbnRlcnNlY3Rpb24ucHJvdG90eXBlLmdldERpc3RhbmNlPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZGlzdDt9O2pzdHMuZ2VvbWdyYXBoLkVkZ2VJbnRlcnNlY3Rpb24ucHJvdG90eXBlLmNvbXBhcmVUbz1mdW5jdGlvbihvdGhlcil7cmV0dXJuIHRoaXMuY29tcGFyZShvdGhlci5zZWdtZW50SW5kZXgsb3RoZXIuZGlzdCk7fTtqc3RzLmdlb21ncmFwaC5FZGdlSW50ZXJzZWN0aW9uLnByb3RvdHlwZS5jb21wYXJlPWZ1bmN0aW9uKHNlZ21lbnRJbmRleCxkaXN0KXtpZih0aGlzLnNlZ21lbnRJbmRleDxzZWdtZW50SW5kZXgpXG5yZXR1cm4tMTtpZih0aGlzLnNlZ21lbnRJbmRleD5zZWdtZW50SW5kZXgpXG5yZXR1cm4gMTtpZih0aGlzLmRpc3Q8ZGlzdClcbnJldHVybi0xO2lmKHRoaXMuZGlzdD5kaXN0KVxucmV0dXJuIDE7cmV0dXJuIDA7fTtqc3RzLmdlb21ncmFwaC5FZGdlSW50ZXJzZWN0aW9uLnByb3RvdHlwZS5pc0VuZFBvaW50PWZ1bmN0aW9uKG1heFNlZ21lbnRJbmRleCl7aWYodGhpcy5zZWdtZW50SW5kZXg9PT0wJiZ0aGlzLmRpc3Q9PT0wLjApXG5yZXR1cm4gdHJ1ZTtpZih0aGlzLnNlZ21lbnRJbmRleD09PW1heFNlZ21lbnRJbmRleClcbnJldHVybiB0cnVlO3JldHVybiBmYWxzZTt9O2pzdHMuZ2VvbWdyYXBoLkVkZ2VJbnRlcnNlY3Rpb24ucHJvdG90eXBlLnRvU3RyaW5nPWZ1bmN0aW9uKCl7cmV0dXJuJycrdGhpcy5zZWdtZW50SW5kZXgrdGhpcy5kaXN0O307KGZ1bmN0aW9uKCl7dmFyIEVkZ2VJbnRlcnNlY3Rpb249anN0cy5nZW9tZ3JhcGguRWRnZUludGVyc2VjdGlvbjt2YXIgVHJlZU1hcD1qYXZhc2NyaXB0LnV0aWwuVHJlZU1hcDtqc3RzLmdlb21ncmFwaC5FZGdlSW50ZXJzZWN0aW9uTGlzdD1mdW5jdGlvbihlZGdlKXt0aGlzLm5vZGVNYXA9bmV3IFRyZWVNYXAoKTt0aGlzLmVkZ2U9ZWRnZTt9O2pzdHMuZ2VvbWdyYXBoLkVkZ2VJbnRlcnNlY3Rpb25MaXN0LnByb3RvdHlwZS5ub2RlTWFwPW51bGw7anN0cy5nZW9tZ3JhcGguRWRnZUludGVyc2VjdGlvbkxpc3QucHJvdG90eXBlLmVkZ2U9bnVsbDtqc3RzLmdlb21ncmFwaC5FZGdlSW50ZXJzZWN0aW9uTGlzdC5wcm90b3R5cGUuaXNJbnRlcnNlY3Rpb249ZnVuY3Rpb24ocHQpe2Zvcih2YXIgaXQ9dGhpcy5pdGVyYXRvcigpO2l0Lmhhc05leHQoKTspe3ZhciBlaT1pdC5uZXh0KCk7aWYoZWkuY29vcmQuZXF1YWxzKHB0KSl7cmV0dXJuIHRydWU7fX1cbnJldHVybiBmYWxzZTt9O2pzdHMuZ2VvbWdyYXBoLkVkZ2VJbnRlcnNlY3Rpb25MaXN0LnByb3RvdHlwZS5hZGQ9ZnVuY3Rpb24oaW50UHQsc2VnbWVudEluZGV4LGRpc3Qpe3ZhciBlaU5ldz1uZXcgRWRnZUludGVyc2VjdGlvbihpbnRQdCxzZWdtZW50SW5kZXgsZGlzdCk7dmFyIGVpPXRoaXMubm9kZU1hcC5nZXQoZWlOZXcpO2lmKGVpIT09bnVsbCl7cmV0dXJuIGVpO31cbnRoaXMubm9kZU1hcC5wdXQoZWlOZXcsZWlOZXcpO3JldHVybiBlaU5ldzt9O2pzdHMuZ2VvbWdyYXBoLkVkZ2VJbnRlcnNlY3Rpb25MaXN0LnByb3RvdHlwZS5pdGVyYXRvcj1mdW5jdGlvbigpe3JldHVybiB0aGlzLm5vZGVNYXAudmFsdWVzKCkuaXRlcmF0b3IoKTt9O2pzdHMuZ2VvbWdyYXBoLkVkZ2VJbnRlcnNlY3Rpb25MaXN0LnByb3RvdHlwZS5hZGRFbmRwb2ludHM9ZnVuY3Rpb24oKXt2YXIgbWF4U2VnSW5kZXg9dGhpcy5lZGdlLnB0cy5sZW5ndGgtMTt0aGlzLmFkZCh0aGlzLmVkZ2UucHRzWzBdLDAsMC4wKTt0aGlzLmFkZCh0aGlzLmVkZ2UucHRzW21heFNlZ0luZGV4XSxtYXhTZWdJbmRleCwwLjApO307anN0cy5nZW9tZ3JhcGguRWRnZUludGVyc2VjdGlvbkxpc3QucHJvdG90eXBlLmFkZFNwbGl0RWRnZXM9ZnVuY3Rpb24oZWRnZUxpc3QpXG57dGhpcy5hZGRFbmRwb2ludHMoKTt2YXIgaXQ9dGhpcy5pdGVyYXRvcigpO3ZhciBlaVByZXY9aXQubmV4dCgpO3doaWxlKGl0Lmhhc05leHQoKSl7dmFyIGVpPWl0Lm5leHQoKTt2YXIgbmV3RWRnZT10aGlzLmNyZWF0ZVNwbGl0RWRnZShlaVByZXYsZWkpO2VkZ2VMaXN0LmFkZChuZXdFZGdlKTtlaVByZXY9ZWk7fX07anN0cy5nZW9tZ3JhcGguRWRnZUludGVyc2VjdGlvbkxpc3QucHJvdG90eXBlLmNyZWF0ZVNwbGl0RWRnZT1mdW5jdGlvbihlaTAsZWkxKXt2YXIgbnB0cz1laTEuc2VnbWVudEluZGV4LWVpMC5zZWdtZW50SW5kZXgrMjt2YXIgbGFzdFNlZ1N0YXJ0UHQ9dGhpcy5lZGdlLnB0c1tlaTEuc2VnbWVudEluZGV4XTt2YXIgdXNlSW50UHQxPWVpMS5kaXN0PjAuMHx8IWVpMS5jb29yZC5lcXVhbHMyRChsYXN0U2VnU3RhcnRQdCk7aWYoIXVzZUludFB0MSl7bnB0cy0tO31cbnZhciBwdHM9W107dmFyIGlwdD0wO3B0c1tpcHQrK109bmV3IGpzdHMuZ2VvbS5Db29yZGluYXRlKGVpMC5jb29yZCk7Zm9yKHZhciBpPWVpMC5zZWdtZW50SW5kZXgrMTtpPD1laTEuc2VnbWVudEluZGV4O2krKyl7cHRzW2lwdCsrXT10aGlzLmVkZ2UucHRzW2ldO31cbmlmKHVzZUludFB0MSlwdHNbaXB0XT1laTEuY29vcmQ7cmV0dXJuIG5ldyBqc3RzLmdlb21ncmFwaC5FZGdlKHB0cyxuZXcganN0cy5nZW9tZ3JhcGguTGFiZWwodGhpcy5lZGdlLmxhYmVsKSk7fTt9KSgpOyhmdW5jdGlvbigpe3ZhciBBc3NlcnRpb25GYWlsZWRFeGNlcHRpb249ZnVuY3Rpb24obWVzc2FnZSl7dGhpcy5tZXNzYWdlPW1lc3NhZ2U7fTtBc3NlcnRpb25GYWlsZWRFeGNlcHRpb24ucHJvdG90eXBlPW5ldyBFcnJvcigpO0Fzc2VydGlvbkZhaWxlZEV4Y2VwdGlvbi5wcm90b3R5cGUubmFtZT0nQXNzZXJ0aW9uRmFpbGVkRXhjZXB0aW9uJztqc3RzLnV0aWwuQXNzZXJ0aW9uRmFpbGVkRXhjZXB0aW9uPUFzc2VydGlvbkZhaWxlZEV4Y2VwdGlvbjt9KSgpOyhmdW5jdGlvbigpe3ZhciBBc3NlcnRpb25GYWlsZWRFeGNlcHRpb249anN0cy51dGlsLkFzc2VydGlvbkZhaWxlZEV4Y2VwdGlvbjtqc3RzLnV0aWwuQXNzZXJ0PWZ1bmN0aW9uKCl7fTtqc3RzLnV0aWwuQXNzZXJ0LmlzVHJ1ZT1mdW5jdGlvbihhc3NlcnRpb24sbWVzc2FnZSl7aWYoIWFzc2VydGlvbil7aWYobWVzc2FnZT09PW51bGwpe3Rocm93IG5ldyBBc3NlcnRpb25GYWlsZWRFeGNlcHRpb24oKTt9ZWxzZXt0aHJvdyBuZXcgQXNzZXJ0aW9uRmFpbGVkRXhjZXB0aW9uKG1lc3NhZ2UpO319fTtqc3RzLnV0aWwuQXNzZXJ0LmVxdWFscz1mdW5jdGlvbihleHBlY3RlZFZhbHVlLGFjdHVhbFZhbHVlLG1lc3NhZ2Upe2lmKCFhY3R1YWxWYWx1ZS5lcXVhbHMoZXhwZWN0ZWRWYWx1ZSkpe3Rocm93IG5ldyBBc3NlcnRpb25GYWlsZWRFeGNlcHRpb24oJ0V4cGVjdGVkICcrZXhwZWN0ZWRWYWx1ZSsnIGJ1dCBlbmNvdW50ZXJlZCAnK2FjdHVhbFZhbHVlK1xuKG1lc3NhZ2UhPW51bGw/JzogJyttZXNzYWdlOicnKSk7fX07anN0cy51dGlsLkFzc2VydC5zaG91bGROZXZlclJlYWNoSGVyZT1mdW5jdGlvbihtZXNzYWdlKXt0aHJvdyBuZXcgQXNzZXJ0aW9uRmFpbGVkRXhjZXB0aW9uKCdTaG91bGQgbmV2ZXIgcmVhY2ggaGVyZScrXG4obWVzc2FnZSE9bnVsbD8nOiAnK21lc3NhZ2U6JycpKTt9O30pKCk7KGZ1bmN0aW9uKCl7dmFyIExvY2F0aW9uPWpzdHMuZ2VvbS5Mb2NhdGlvbjt2YXIgQXNzZXJ0PWpzdHMudXRpbC5Bc3NlcnQ7dmFyIEFycmF5TGlzdD1qYXZhc2NyaXB0LnV0aWwuQXJyYXlMaXN0O2pzdHMub3BlcmF0aW9uLnJlbGF0ZS5SZWxhdGVDb21wdXRlcj1mdW5jdGlvbihhcmcpe3RoaXMubGk9bmV3IGpzdHMuYWxnb3JpdGhtLlJvYnVzdExpbmVJbnRlcnNlY3RvcigpO3RoaXMucHRMb2NhdG9yPW5ldyBqc3RzLmFsZ29yaXRobS5Qb2ludExvY2F0b3IoKTt0aGlzLm5vZGVzPW5ldyBqc3RzLmdlb21ncmFwaC5Ob2RlTWFwKG5ldyBqc3RzLm9wZXJhdGlvbi5yZWxhdGUuUmVsYXRlTm9kZUZhY3RvcnkoKSk7dGhpcy5pc29sYXRlZEVkZ2VzPW5ldyBBcnJheUxpc3QoKTt0aGlzLmFyZz1hcmc7fTtqc3RzLm9wZXJhdGlvbi5yZWxhdGUuUmVsYXRlQ29tcHV0ZXIucHJvdG90eXBlLmxpPW51bGw7anN0cy5vcGVyYXRpb24ucmVsYXRlLlJlbGF0ZUNvbXB1dGVyLnByb3RvdHlwZS5wdExvY2F0b3I9bnVsbDtqc3RzLm9wZXJhdGlvbi5yZWxhdGUuUmVsYXRlQ29tcHV0ZXIucHJvdG90eXBlLmFyZz1udWxsO2pzdHMub3BlcmF0aW9uLnJlbGF0ZS5SZWxhdGVDb21wdXRlci5wcm90b3R5cGUubm9kZXM9bnVsbDtqc3RzLm9wZXJhdGlvbi5yZWxhdGUuUmVsYXRlQ29tcHV0ZXIucHJvdG90eXBlLmltPW51bGw7anN0cy5vcGVyYXRpb24ucmVsYXRlLlJlbGF0ZUNvbXB1dGVyLnByb3RvdHlwZS5pc29sYXRlZEVkZ2VzPW51bGw7anN0cy5vcGVyYXRpb24ucmVsYXRlLlJlbGF0ZUNvbXB1dGVyLnByb3RvdHlwZS5pbnZhbGlkUG9pbnQ9bnVsbDtqc3RzLm9wZXJhdGlvbi5yZWxhdGUuUmVsYXRlQ29tcHV0ZXIucHJvdG90eXBlLmNvbXB1dGVJTT1mdW5jdGlvbigpe3ZhciBpbT1uZXcganN0cy5nZW9tLkludGVyc2VjdGlvbk1hdHJpeCgpO2ltLnNldChMb2NhdGlvbi5FWFRFUklPUixMb2NhdGlvbi5FWFRFUklPUiwyKTtpZighdGhpcy5hcmdbMF0uZ2V0R2VvbWV0cnkoKS5nZXRFbnZlbG9wZUludGVybmFsKCkuaW50ZXJzZWN0cyh0aGlzLmFyZ1sxXS5nZXRHZW9tZXRyeSgpLmdldEVudmVsb3BlSW50ZXJuYWwoKSkpe3RoaXMuY29tcHV0ZURpc2pvaW50SU0oaW0pO3JldHVybiBpbTt9XG50aGlzLmFyZ1swXS5jb21wdXRlU2VsZk5vZGVzKHRoaXMubGksZmFsc2UpO3RoaXMuYXJnWzFdLmNvbXB1dGVTZWxmTm9kZXModGhpcy5saSxmYWxzZSk7dmFyIGludGVyc2VjdG9yPXRoaXMuYXJnWzBdLmNvbXB1dGVFZGdlSW50ZXJzZWN0aW9ucyh0aGlzLmFyZ1sxXSx0aGlzLmxpLGZhbHNlKTt0aGlzLmNvbXB1dGVJbnRlcnNlY3Rpb25Ob2RlcygwKTt0aGlzLmNvbXB1dGVJbnRlcnNlY3Rpb25Ob2RlcygxKTt0aGlzLmNvcHlOb2Rlc0FuZExhYmVscygwKTt0aGlzLmNvcHlOb2Rlc0FuZExhYmVscygxKTt0aGlzLmxhYmVsSXNvbGF0ZWROb2RlcygpO3RoaXMuY29tcHV0ZVByb3BlckludGVyc2VjdGlvbklNKGludGVyc2VjdG9yLGltKTt2YXIgZWVCdWlsZGVyPW5ldyBqc3RzLm9wZXJhdGlvbi5yZWxhdGUuRWRnZUVuZEJ1aWxkZXIoKTt2YXIgZWUwPWVlQnVpbGRlci5jb21wdXRlRWRnZUVuZHModGhpcy5hcmdbMF0uZ2V0RWRnZUl0ZXJhdG9yKCkpO3RoaXMuaW5zZXJ0RWRnZUVuZHMoZWUwKTt2YXIgZWUxPWVlQnVpbGRlci5jb21wdXRlRWRnZUVuZHModGhpcy5hcmdbMV0uZ2V0RWRnZUl0ZXJhdG9yKCkpO3RoaXMuaW5zZXJ0RWRnZUVuZHMoZWUxKTt0aGlzLmxhYmVsTm9kZUVkZ2VzKCk7dGhpcy5sYWJlbElzb2xhdGVkRWRnZXMoMCwxKTt0aGlzLmxhYmVsSXNvbGF0ZWRFZGdlcygxLDApO3RoaXMudXBkYXRlSU0oaW0pO3JldHVybiBpbTt9O2pzdHMub3BlcmF0aW9uLnJlbGF0ZS5SZWxhdGVDb21wdXRlci5wcm90b3R5cGUuaW5zZXJ0RWRnZUVuZHM9ZnVuY3Rpb24oZWUpe2Zvcih2YXIgaT1lZS5pdGVyYXRvcigpO2kuaGFzTmV4dCgpOyl7dmFyIGU9aS5uZXh0KCk7dGhpcy5ub2Rlcy5hZGQoZSk7fX07anN0cy5vcGVyYXRpb24ucmVsYXRlLlJlbGF0ZUNvbXB1dGVyLnByb3RvdHlwZS5jb21wdXRlUHJvcGVySW50ZXJzZWN0aW9uSU09ZnVuY3Rpb24oaW50ZXJzZWN0b3IsaW0pe3ZhciBkaW1BPXRoaXMuYXJnWzBdLmdldEdlb21ldHJ5KCkuZ2V0RGltZW5zaW9uKCk7dmFyIGRpbUI9dGhpcy5hcmdbMV0uZ2V0R2VvbWV0cnkoKS5nZXREaW1lbnNpb24oKTt2YXIgaGFzUHJvcGVyPWludGVyc2VjdG9yLmhhc1Byb3BlckludGVyc2VjdGlvbigpO3ZhciBoYXNQcm9wZXJJbnRlcmlvcj1pbnRlcnNlY3Rvci5oYXNQcm9wZXJJbnRlcmlvckludGVyc2VjdGlvbigpO2lmKGRpbUE9PT0yJiZkaW1CPT09Mil7aWYoaGFzUHJvcGVyKVxuaW0uc2V0QXRMZWFzdCgnMjEyMTAxMjEyJyk7fVxuZWxzZSBpZihkaW1BPT09MiYmZGltQj09PTEpe2lmKGhhc1Byb3BlcilcbmltLnNldEF0TGVhc3QoJ0ZGRjBGRkZGMicpO2lmKGhhc1Byb3BlckludGVyaW9yKVxuaW0uc2V0QXRMZWFzdCgnMUZGRkZGMUZGJyk7fWVsc2UgaWYoZGltQT09PTEmJmRpbUI9PT0yKXtpZihoYXNQcm9wZXIpXG5pbS5zZXRBdExlYXN0KCdGMEZGRkZGRjInKTtpZihoYXNQcm9wZXJJbnRlcmlvcilcbmltLnNldEF0TGVhc3QoJzFGMUZGRkZGRicpO31cbmVsc2UgaWYoZGltQT09PTEmJmRpbUI9PT0xKXtpZihoYXNQcm9wZXJJbnRlcmlvcilcbmltLnNldEF0TGVhc3QoJzBGRkZGRkZGRicpO319O2pzdHMub3BlcmF0aW9uLnJlbGF0ZS5SZWxhdGVDb21wdXRlci5wcm90b3R5cGUuY29weU5vZGVzQW5kTGFiZWxzPWZ1bmN0aW9uKGFyZ0luZGV4KXtmb3IodmFyIGk9dGhpcy5hcmdbYXJnSW5kZXhdLmdldE5vZGVJdGVyYXRvcigpO2kuaGFzTmV4dCgpOyl7dmFyIGdyYXBoTm9kZT1pLm5leHQoKTt2YXIgbmV3Tm9kZT10aGlzLm5vZGVzLmFkZE5vZGUoZ3JhcGhOb2RlLmdldENvb3JkaW5hdGUoKSk7bmV3Tm9kZS5zZXRMYWJlbChhcmdJbmRleCxncmFwaE5vZGUuZ2V0TGFiZWwoKS5nZXRMb2NhdGlvbihhcmdJbmRleCkpO319O2pzdHMub3BlcmF0aW9uLnJlbGF0ZS5SZWxhdGVDb21wdXRlci5wcm90b3R5cGUuY29tcHV0ZUludGVyc2VjdGlvbk5vZGVzPWZ1bmN0aW9uKGFyZ0luZGV4KXtmb3IodmFyIGk9dGhpcy5hcmdbYXJnSW5kZXhdLmdldEVkZ2VJdGVyYXRvcigpO2kuaGFzTmV4dCgpOyl7dmFyIGU9aS5uZXh0KCk7dmFyIGVMb2M9ZS5nZXRMYWJlbCgpLmdldExvY2F0aW9uKGFyZ0luZGV4KTtmb3IodmFyIGVpSXQ9ZS5nZXRFZGdlSW50ZXJzZWN0aW9uTGlzdCgpLml0ZXJhdG9yKCk7ZWlJdC5oYXNOZXh0KCk7KXt2YXIgZWk9ZWlJdC5uZXh0KCk7dmFyIG49dGhpcy5ub2Rlcy5hZGROb2RlKGVpLmNvb3JkKTtpZihlTG9jPT09TG9jYXRpb24uQk9VTkRBUlkpXG5uLnNldExhYmVsQm91bmRhcnkoYXJnSW5kZXgpO2Vsc2V7aWYobi5nZXRMYWJlbCgpLmlzTnVsbChhcmdJbmRleCkpXG5uLnNldExhYmVsKGFyZ0luZGV4LExvY2F0aW9uLklOVEVSSU9SKTt9fX19O2pzdHMub3BlcmF0aW9uLnJlbGF0ZS5SZWxhdGVDb21wdXRlci5wcm90b3R5cGUubGFiZWxJbnRlcnNlY3Rpb25Ob2Rlcz1mdW5jdGlvbihhcmdJbmRleCl7Zm9yKHZhciBpPXRoaXMuYXJnW2FyZ0luZGV4XS5nZXRFZGdlSXRlcmF0b3IoKTtpLmhhc05leHQoKTspe3ZhciBlPWkubmV4dCgpO3ZhciBlTG9jPWUuZ2V0TGFiZWwoKS5nZXRMb2NhdGlvbihhcmdJbmRleCk7Zm9yKHZhciBlaUl0PWUuZ2V0RWRnZUludGVyc2VjdGlvbkxpc3QoKS5pdGVyYXRvcigpO2VpSXQuaGFzTmV4dCgpOyl7dmFyIGVpPWVpSXQubmV4dCgpO3ZhciBuPXRoaXMubm9kZXMuZmluZChlaS5jb29yZCk7aWYobi5nZXRMYWJlbCgpLmlzTnVsbChhcmdJbmRleCkpe2lmKGVMb2M9PT1Mb2NhdGlvbi5CT1VOREFSWSlcbm4uc2V0TGFiZWxCb3VuZGFyeShhcmdJbmRleCk7ZWxzZVxubi5zZXRMYWJlbChhcmdJbmRleCxMb2NhdGlvbi5JTlRFUklPUik7fX19fTtqc3RzLm9wZXJhdGlvbi5yZWxhdGUuUmVsYXRlQ29tcHV0ZXIucHJvdG90eXBlLmNvbXB1dGVEaXNqb2ludElNPWZ1bmN0aW9uKGltKXt2YXIgZ2E9dGhpcy5hcmdbMF0uZ2V0R2VvbWV0cnkoKTtpZighZ2EuaXNFbXB0eSgpKXtpbS5zZXQoTG9jYXRpb24uSU5URVJJT1IsTG9jYXRpb24uRVhURVJJT1IsZ2EuZ2V0RGltZW5zaW9uKCkpO2ltLnNldChMb2NhdGlvbi5CT1VOREFSWSxMb2NhdGlvbi5FWFRFUklPUixnYS5nZXRCb3VuZGFyeURpbWVuc2lvbigpKTt9XG52YXIgZ2I9dGhpcy5hcmdbMV0uZ2V0R2VvbWV0cnkoKTtpZighZ2IuaXNFbXB0eSgpKXtpbS5zZXQoTG9jYXRpb24uRVhURVJJT1IsTG9jYXRpb24uSU5URVJJT1IsZ2IuZ2V0RGltZW5zaW9uKCkpO2ltLnNldChMb2NhdGlvbi5FWFRFUklPUixMb2NhdGlvbi5CT1VOREFSWSxnYi5nZXRCb3VuZGFyeURpbWVuc2lvbigpKTt9fTtqc3RzLm9wZXJhdGlvbi5yZWxhdGUuUmVsYXRlQ29tcHV0ZXIucHJvdG90eXBlLmxhYmVsTm9kZUVkZ2VzPWZ1bmN0aW9uKCl7Zm9yKHZhciBuaT10aGlzLm5vZGVzLml0ZXJhdG9yKCk7bmkuaGFzTmV4dCgpOyl7dmFyIG5vZGU9bmkubmV4dCgpO25vZGUuZ2V0RWRnZXMoKS5jb21wdXRlTGFiZWxsaW5nKHRoaXMuYXJnKTt9fTtqc3RzLm9wZXJhdGlvbi5yZWxhdGUuUmVsYXRlQ29tcHV0ZXIucHJvdG90eXBlLnVwZGF0ZUlNPWZ1bmN0aW9uKGltKXtmb3IodmFyIGVpPXRoaXMuaXNvbGF0ZWRFZGdlcy5pdGVyYXRvcigpO2VpLmhhc05leHQoKTspe3ZhciBlPWVpLm5leHQoKTtlLnVwZGF0ZUlNKGltKTt9XG5mb3IodmFyIG5pPXRoaXMubm9kZXMuaXRlcmF0b3IoKTtuaS5oYXNOZXh0KCk7KXt2YXIgbm9kZT1uaS5uZXh0KCk7bm9kZS51cGRhdGVJTShpbSk7bm9kZS51cGRhdGVJTUZyb21FZGdlcyhpbSk7fX07anN0cy5vcGVyYXRpb24ucmVsYXRlLlJlbGF0ZUNvbXB1dGVyLnByb3RvdHlwZS5sYWJlbElzb2xhdGVkRWRnZXM9ZnVuY3Rpb24odGhpc0luZGV4LHRhcmdldEluZGV4KXtmb3IodmFyIGVpPXRoaXMuYXJnW3RoaXNJbmRleF0uZ2V0RWRnZUl0ZXJhdG9yKCk7ZWkuaGFzTmV4dCgpOyl7dmFyIGU9ZWkubmV4dCgpO2lmKGUuaXNJc29sYXRlZCgpKXt0aGlzLmxhYmVsSXNvbGF0ZWRFZGdlKGUsdGFyZ2V0SW5kZXgsdGhpcy5hcmdbdGFyZ2V0SW5kZXhdLmdldEdlb21ldHJ5KCkpO3RoaXMuaXNvbGF0ZWRFZGdlcy5hZGQoZSk7fX19O2pzdHMub3BlcmF0aW9uLnJlbGF0ZS5SZWxhdGVDb21wdXRlci5wcm90b3R5cGUubGFiZWxJc29sYXRlZEVkZ2U9ZnVuY3Rpb24oZSx0YXJnZXRJbmRleCx0YXJnZXQpe2lmKHRhcmdldC5nZXREaW1lbnNpb24oKT4wKXt2YXIgbG9jPXRoaXMucHRMb2NhdG9yLmxvY2F0ZShlLmdldENvb3JkaW5hdGUoKSx0YXJnZXQpO2UuZ2V0TGFiZWwoKS5zZXRBbGxMb2NhdGlvbnModGFyZ2V0SW5kZXgsbG9jKTt9ZWxzZXtlLmdldExhYmVsKCkuc2V0QWxsTG9jYXRpb25zKHRhcmdldEluZGV4LExvY2F0aW9uLkVYVEVSSU9SKTt9fTtqc3RzLm9wZXJhdGlvbi5yZWxhdGUuUmVsYXRlQ29tcHV0ZXIucHJvdG90eXBlLmxhYmVsSXNvbGF0ZWROb2Rlcz1mdW5jdGlvbigpe2Zvcih2YXIgbmk9dGhpcy5ub2Rlcy5pdGVyYXRvcigpO25pLmhhc05leHQoKTspe3ZhciBuPW5pLm5leHQoKTt2YXIgbGFiZWw9bi5nZXRMYWJlbCgpO0Fzc2VydC5pc1RydWUobGFiZWwuZ2V0R2VvbWV0cnlDb3VudCgpPjAsJ25vZGUgd2l0aCBlbXB0eSBsYWJlbCBmb3VuZCcpO2lmKG4uaXNJc29sYXRlZCgpKXtpZihsYWJlbC5pc051bGwoMCkpXG50aGlzLmxhYmVsSXNvbGF0ZWROb2RlKG4sMCk7ZWxzZVxudGhpcy5sYWJlbElzb2xhdGVkTm9kZShuLDEpO319fTtqc3RzLm9wZXJhdGlvbi5yZWxhdGUuUmVsYXRlQ29tcHV0ZXIucHJvdG90eXBlLmxhYmVsSXNvbGF0ZWROb2RlPWZ1bmN0aW9uKG4sdGFyZ2V0SW5kZXgpe3ZhciBsb2M9dGhpcy5wdExvY2F0b3IubG9jYXRlKG4uZ2V0Q29vcmRpbmF0ZSgpLHRoaXMuYXJnW3RhcmdldEluZGV4XS5nZXRHZW9tZXRyeSgpKTtuLmdldExhYmVsKCkuc2V0QWxsTG9jYXRpb25zKHRhcmdldEluZGV4LGxvYyk7fTt9KSgpOyhmdW5jdGlvbigpe3ZhciBBc3NlcnQ9anN0cy51dGlsLkFzc2VydDtqc3RzLmdlb21ncmFwaC5HcmFwaENvbXBvbmVudD1mdW5jdGlvbihsYWJlbCl7dGhpcy5sYWJlbD1sYWJlbDt9O2pzdHMuZ2VvbWdyYXBoLkdyYXBoQ29tcG9uZW50LnByb3RvdHlwZS5sYWJlbD1udWxsO2pzdHMuZ2VvbWdyYXBoLkdyYXBoQ29tcG9uZW50LnByb3RvdHlwZS5faXNJblJlc3VsdD1mYWxzZTtqc3RzLmdlb21ncmFwaC5HcmFwaENvbXBvbmVudC5wcm90b3R5cGUuX2lzQ292ZXJlZD1mYWxzZTtqc3RzLmdlb21ncmFwaC5HcmFwaENvbXBvbmVudC5wcm90b3R5cGUuX2lzQ292ZXJlZFNldD1mYWxzZTtqc3RzLmdlb21ncmFwaC5HcmFwaENvbXBvbmVudC5wcm90b3R5cGUuX2lzVmlzaXRlZD1mYWxzZTtqc3RzLmdlb21ncmFwaC5HcmFwaENvbXBvbmVudC5wcm90b3R5cGUuZ2V0TGFiZWw9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5sYWJlbDt9O2pzdHMuZ2VvbWdyYXBoLkdyYXBoQ29tcG9uZW50LnByb3RvdHlwZS5zZXRMYWJlbD1mdW5jdGlvbihsYWJlbCl7aWYoYXJndW1lbnRzLmxlbmd0aD09PTIpe3RoaXMuc2V0TGFiZWwyLmFwcGx5KHRoaXMsYXJndW1lbnRzKTtyZXR1cm47fVxudGhpcy5sYWJlbD1sYWJlbDt9O2pzdHMuZ2VvbWdyYXBoLkdyYXBoQ29tcG9uZW50LnByb3RvdHlwZS5zZXRJblJlc3VsdD1mdW5jdGlvbihpc0luUmVzdWx0KXt0aGlzLl9pc0luUmVzdWx0PWlzSW5SZXN1bHQ7fTtqc3RzLmdlb21ncmFwaC5HcmFwaENvbXBvbmVudC5wcm90b3R5cGUuaXNJblJlc3VsdD1mdW5jdGlvbigpe3JldHVybiB0aGlzLl9pc0luUmVzdWx0O307anN0cy5nZW9tZ3JhcGguR3JhcGhDb21wb25lbnQucHJvdG90eXBlLnNldENvdmVyZWQ9ZnVuY3Rpb24oaXNDb3ZlcmVkKXt0aGlzLl9pc0NvdmVyZWQ9aXNDb3ZlcmVkO3RoaXMuX2lzQ292ZXJlZFNldD10cnVlO307anN0cy5nZW9tZ3JhcGguR3JhcGhDb21wb25lbnQucHJvdG90eXBlLmlzQ292ZXJlZD1mdW5jdGlvbigpe3JldHVybiB0aGlzLl9pc0NvdmVyZWQ7fTtqc3RzLmdlb21ncmFwaC5HcmFwaENvbXBvbmVudC5wcm90b3R5cGUuaXNDb3ZlcmVkU2V0PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2lzQ292ZXJlZFNldDt9O2pzdHMuZ2VvbWdyYXBoLkdyYXBoQ29tcG9uZW50LnByb3RvdHlwZS5pc1Zpc2l0ZWQ9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5faXNWaXNpdGVkO307anN0cy5nZW9tZ3JhcGguR3JhcGhDb21wb25lbnQucHJvdG90eXBlLnNldFZpc2l0ZWQ9ZnVuY3Rpb24oaXNWaXNpdGVkKXt0aGlzLl9pc1Zpc2l0ZWQ9aXNWaXNpdGVkO307anN0cy5nZW9tZ3JhcGguR3JhcGhDb21wb25lbnQucHJvdG90eXBlLmdldENvb3JkaW5hdGU9ZnVuY3Rpb24oKXt0aHJvdyBuZXcganN0cy5lcnJvci5BYnN0cmFjdE1ldGhvZEludm9jYXRpb25FcnJvcigpO307anN0cy5nZW9tZ3JhcGguR3JhcGhDb21wb25lbnQucHJvdG90eXBlLmNvbXB1dGVJTT1mdW5jdGlvbihpbSl7dGhyb3cgbmV3IGpzdHMuZXJyb3IuQWJzdHJhY3RNZXRob2RJbnZvY2F0aW9uRXJyb3IoKTt9O2pzdHMuZ2VvbWdyYXBoLkdyYXBoQ29tcG9uZW50LnByb3RvdHlwZS5pc0lzb2xhdGVkPWZ1bmN0aW9uKCl7dGhyb3cgbmV3IGpzdHMuZXJyb3IuQWJzdHJhY3RNZXRob2RJbnZvY2F0aW9uRXJyb3IoKTt9O2pzdHMuZ2VvbWdyYXBoLkdyYXBoQ29tcG9uZW50LnByb3RvdHlwZS51cGRhdGVJTT1mdW5jdGlvbihpbSl7QXNzZXJ0LmlzVHJ1ZSh0aGlzLmxhYmVsLmdldEdlb21ldHJ5Q291bnQoKT49MiwnZm91bmQgcGFydGlhbCBsYWJlbCcpO3RoaXMuY29tcHV0ZUlNKGltKTt9O30pKCk7anN0cy5nZW9tZ3JhcGguTm9kZT1mdW5jdGlvbihjb29yZCxlZGdlcyl7dGhpcy5jb29yZD1jb29yZDt0aGlzLmVkZ2VzPWVkZ2VzO3RoaXMubGFiZWw9bmV3IGpzdHMuZ2VvbWdyYXBoLkxhYmVsKDAsanN0cy5nZW9tLkxvY2F0aW9uLk5PTkUpO307anN0cy5nZW9tZ3JhcGguTm9kZS5wcm90b3R5cGU9bmV3IGpzdHMuZ2VvbWdyYXBoLkdyYXBoQ29tcG9uZW50KCk7anN0cy5nZW9tZ3JhcGguTm9kZS5wcm90b3R5cGUuY29vcmQ9bnVsbDtqc3RzLmdlb21ncmFwaC5Ob2RlLnByb3RvdHlwZS5lZGdlcz1udWxsO2pzdHMuZ2VvbWdyYXBoLk5vZGUucHJvdG90eXBlLmlzSXNvbGF0ZWQ9ZnVuY3Rpb24oKXtyZXR1cm4odGhpcy5sYWJlbC5nZXRHZW9tZXRyeUNvdW50KCk9PTEpO307anN0cy5nZW9tZ3JhcGguTm9kZS5wcm90b3R5cGUuc2V0TGFiZWwyPWZ1bmN0aW9uKGFyZ0luZGV4LG9uTG9jYXRpb24pe2lmKHRoaXMubGFiZWw9PT1udWxsKXt0aGlzLmxhYmVsPW5ldyBqc3RzLmdlb21ncmFwaC5MYWJlbChhcmdJbmRleCxvbkxvY2F0aW9uKTt9ZWxzZVxudGhpcy5sYWJlbC5zZXRMb2NhdGlvbihhcmdJbmRleCxvbkxvY2F0aW9uKTt9O2pzdHMuZ2VvbWdyYXBoLk5vZGUucHJvdG90eXBlLnNldExhYmVsQm91bmRhcnk9ZnVuY3Rpb24oYXJnSW5kZXgpe3ZhciBsb2M9anN0cy5nZW9tLkxvY2F0aW9uLk5PTkU7aWYodGhpcy5sYWJlbCE9PW51bGwpXG5sb2M9dGhpcy5sYWJlbC5nZXRMb2NhdGlvbihhcmdJbmRleCk7dmFyIG5ld0xvYztzd2l0Y2gobG9jKXtjYXNlIGpzdHMuZ2VvbS5Mb2NhdGlvbi5CT1VOREFSWTpuZXdMb2M9anN0cy5nZW9tLkxvY2F0aW9uLklOVEVSSU9SO2JyZWFrO2Nhc2UganN0cy5nZW9tLkxvY2F0aW9uLklOVEVSSU9SOm5ld0xvYz1qc3RzLmdlb20uTG9jYXRpb24uQk9VTkRBUlk7YnJlYWs7ZGVmYXVsdDpuZXdMb2M9anN0cy5nZW9tLkxvY2F0aW9uLkJPVU5EQVJZO2JyZWFrO31cbnRoaXMubGFiZWwuc2V0TG9jYXRpb24oYXJnSW5kZXgsbmV3TG9jKTt9O2pzdHMuZ2VvbWdyYXBoLk5vZGUucHJvdG90eXBlLmFkZD1mdW5jdGlvbihlKXt0aGlzLmVkZ2VzLmluc2VydChlKTtlLnNldE5vZGUodGhpcyk7fTtqc3RzLmdlb21ncmFwaC5Ob2RlLnByb3RvdHlwZS5nZXRDb29yZGluYXRlPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuY29vcmQ7fTtqc3RzLmdlb21ncmFwaC5Ob2RlLnByb3RvdHlwZS5nZXRFZGdlcz1mdW5jdGlvbigpe3JldHVybiB0aGlzLmVkZ2VzO307anN0cy5nZW9tZ3JhcGguTm9kZS5wcm90b3R5cGUuaXNJbmNpZGVudEVkZ2VJblJlc3VsdD1mdW5jdGlvbigpe2Zvcih2YXIgaXQ9dGhpcy5nZXRFZGdlcygpLmdldEVkZ2VzKCkuaXRlcmF0b3IoKTtpdC5oYXNOZXh0KCk7KXt2YXIgZGU9aXQubmV4dCgpO2lmKGRlLmdldEVkZ2UoKS5pc0luUmVzdWx0KCkpXG5yZXR1cm4gdHJ1ZTt9XG5yZXR1cm4gZmFsc2U7fTtqc3RzLmdlb20uUG9pbnQ9ZnVuY3Rpb24oY29vcmRpbmF0ZSxmYWN0b3J5KXt0aGlzLmZhY3Rvcnk9ZmFjdG9yeTtpZihjb29yZGluYXRlPT09dW5kZWZpbmVkKVxucmV0dXJuO3RoaXMuY29vcmRpbmF0ZT1jb29yZGluYXRlO307anN0cy5nZW9tLlBvaW50LnByb3RvdHlwZT1uZXcganN0cy5nZW9tLkdlb21ldHJ5KCk7anN0cy5nZW9tLlBvaW50LmNvbnN0cnVjdG9yPWpzdHMuZ2VvbS5Qb2ludDtqc3RzLmdlb20uUG9pbnQuQ0xBU1NfTkFNRT0nanN0cy5nZW9tLlBvaW50Jztqc3RzLmdlb20uUG9pbnQucHJvdG90eXBlLmNvb3JkaW5hdGU9bnVsbDtqc3RzLmdlb20uUG9pbnQucHJvdG90eXBlLmdldFg9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5jb29yZGluYXRlLng7fTtqc3RzLmdlb20uUG9pbnQucHJvdG90eXBlLmdldFk9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5jb29yZGluYXRlLnk7fTtqc3RzLmdlb20uUG9pbnQucHJvdG90eXBlLmdldENvb3JkaW5hdGU9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5jb29yZGluYXRlO307anN0cy5nZW9tLlBvaW50LnByb3RvdHlwZS5nZXRDb29yZGluYXRlcz1mdW5jdGlvbigpe3JldHVybiB0aGlzLmlzRW1wdHkoKT9bXTpbdGhpcy5jb29yZGluYXRlXTt9O2pzdHMuZ2VvbS5Qb2ludC5wcm90b3R5cGUuZ2V0Q29vcmRpbmF0ZVNlcXVlbmNlPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuaXNFbXB0eSgpP1tdOlt0aGlzLmNvb3JkaW5hdGVdO307anN0cy5nZW9tLlBvaW50LnByb3RvdHlwZS5pc0VtcHR5PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuY29vcmRpbmF0ZT09PW51bGw7fTtqc3RzLmdlb20uUG9pbnQucHJvdG90eXBlLmVxdWFsc0V4YWN0PWZ1bmN0aW9uKG90aGVyLHRvbGVyYW5jZSl7aWYoIXRoaXMuaXNFcXVpdmFsZW50Q2xhc3Mob3RoZXIpKXtyZXR1cm4gZmFsc2U7fVxuaWYodGhpcy5pc0VtcHR5KCkmJm90aGVyLmlzRW1wdHkoKSl7cmV0dXJuIHRydWU7fVxucmV0dXJuIHRoaXMuZXF1YWwob3RoZXIuZ2V0Q29vcmRpbmF0ZSgpLHRoaXMuZ2V0Q29vcmRpbmF0ZSgpLHRvbGVyYW5jZSk7fTtqc3RzLmdlb20uUG9pbnQucHJvdG90eXBlLmdldE51bVBvaW50cz1mdW5jdGlvbigpe3JldHVybiB0aGlzLmlzRW1wdHkoKT8wOjE7fTtqc3RzLmdlb20uUG9pbnQucHJvdG90eXBlLmlzU2ltcGxlPWZ1bmN0aW9uKCl7cmV0dXJuIHRydWU7fTtqc3RzLmdlb20uUG9pbnQucHJvdG90eXBlLmdldEJvdW5kYXJ5PWZ1bmN0aW9uKCl7cmV0dXJuIG5ldyBqc3RzLmdlb20uR2VvbWV0cnlDb2xsZWN0aW9uKG51bGwpO307anN0cy5nZW9tLlBvaW50LnByb3RvdHlwZS5jb21wdXRlRW52ZWxvcGVJbnRlcm5hbD1mdW5jdGlvbigpe2lmKHRoaXMuaXNFbXB0eSgpKXtyZXR1cm4gbmV3IGpzdHMuZ2VvbS5FbnZlbG9wZSgpO31cbnJldHVybiBuZXcganN0cy5nZW9tLkVudmVsb3BlKHRoaXMuY29vcmRpbmF0ZSk7fTtqc3RzLmdlb20uUG9pbnQucHJvdG90eXBlLmFwcGx5PWZ1bmN0aW9uKGZpbHRlcil7aWYoZmlsdGVyIGluc3RhbmNlb2YganN0cy5nZW9tLkdlb21ldHJ5RmlsdGVyfHxmaWx0ZXIgaW5zdGFuY2VvZiBqc3RzLmdlb20uR2VvbWV0cnlDb21wb25lbnRGaWx0ZXIpe2ZpbHRlci5maWx0ZXIodGhpcyk7fWVsc2UgaWYoZmlsdGVyIGluc3RhbmNlb2YganN0cy5nZW9tLkNvb3JkaW5hdGVGaWx0ZXIpe2lmKHRoaXMuaXNFbXB0eSgpKXtyZXR1cm47fVxuZmlsdGVyLmZpbHRlcih0aGlzLmdldENvb3JkaW5hdGUoKSk7fX07anN0cy5nZW9tLlBvaW50LnByb3RvdHlwZS5jbG9uZT1mdW5jdGlvbigpe3JldHVybiBuZXcganN0cy5nZW9tLlBvaW50KHRoaXMuY29vcmRpbmF0ZS5jbG9uZSgpLHRoaXMuZmFjdG9yeSk7fTtqc3RzLmdlb20uUG9pbnQucHJvdG90eXBlLmdldERpbWVuc2lvbj1mdW5jdGlvbigpe3JldHVybiAwO307anN0cy5nZW9tLlBvaW50LnByb3RvdHlwZS5nZXRCb3VuZGFyeURpbWVuc2lvbj1mdW5jdGlvbigpe3JldHVybiBqc3RzLmdlb20uRGltZW5zaW9uLkZBTFNFO307anN0cy5nZW9tLlBvaW50LnByb3RvdHlwZS5yZXZlcnNlPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuY2xvbmUoKTt9O2pzdHMuZ2VvbS5Qb2ludC5wcm90b3R5cGUuaXNWYWxpZD1mdW5jdGlvbigpe2lmKCFqc3RzLm9wZXJhdGlvbi52YWxpZC5Jc1ZhbGlkT3AuaXNWYWxpZCh0aGlzLmdldENvb3JkaW5hdGUoKSkpe3JldHVybiBmYWxzZTt9XG5yZXR1cm4gdHJ1ZTt9O2pzdHMuZ2VvbS5Qb2ludC5wcm90b3R5cGUubm9ybWFsaXplPWZ1bmN0aW9uKCl7fTtqc3RzLmdlb20uUG9pbnQucHJvdG90eXBlLmNvbXBhcmVUb1NhbWVDbGFzcz1mdW5jdGlvbihvdGhlcil7dmFyIHBvaW50PW90aGVyO3JldHVybiB0aGlzLmdldENvb3JkaW5hdGUoKS5jb21wYXJlVG8ocG9pbnQuZ2V0Q29vcmRpbmF0ZSgpKTt9O2pzdHMuZ2VvbS5Qb2ludC5wcm90b3R5cGUuZ2V0R2VvbWV0cnlUeXBlPWZ1bmN0aW9uKCl7cmV0dXJuJ1BvaW50Jzt9O2pzdHMuZ2VvbS5Qb2ludC5wcm90b3R5cGUuaGFzaENvZGU9ZnVuY3Rpb24oKXtyZXR1cm4nUG9pbnRfJyt0aGlzLmNvb3JkaW5hdGUuaGFzaENvZGUoKTt9O2pzdHMuZ2VvbS5Qb2ludC5wcm90b3R5cGUuQ0xBU1NfTkFNRT0nanN0cy5nZW9tLlBvaW50Jztqc3RzLmdlb20uRGltZW5zaW9uPWZ1bmN0aW9uKCl7fTtqc3RzLmdlb20uRGltZW5zaW9uLlA9MDtqc3RzLmdlb20uRGltZW5zaW9uLkw9MTtqc3RzLmdlb20uRGltZW5zaW9uLkE9Mjtqc3RzLmdlb20uRGltZW5zaW9uLkZBTFNFPS0xO2pzdHMuZ2VvbS5EaW1lbnNpb24uVFJVRT0tMjtqc3RzLmdlb20uRGltZW5zaW9uLkRPTlRDQVJFPS0zO2pzdHMuZ2VvbS5EaW1lbnNpb24udG9EaW1lbnNpb25TeW1ib2w9ZnVuY3Rpb24oZGltZW5zaW9uVmFsdWUpe3N3aXRjaChkaW1lbnNpb25WYWx1ZSl7Y2FzZSBqc3RzLmdlb20uRGltZW5zaW9uLkZBTFNFOnJldHVybidGJztjYXNlIGpzdHMuZ2VvbS5EaW1lbnNpb24uVFJVRTpyZXR1cm4nVCc7Y2FzZSBqc3RzLmdlb20uRGltZW5zaW9uLkRPTlRDQVJFOnJldHVybicqJztjYXNlIGpzdHMuZ2VvbS5EaW1lbnNpb24uUDpyZXR1cm4nMCc7Y2FzZSBqc3RzLmdlb20uRGltZW5zaW9uLkw6cmV0dXJuJzEnO2Nhc2UganN0cy5nZW9tLkRpbWVuc2lvbi5BOnJldHVybicyJzt9XG50aHJvdyBuZXcganN0cy5JbGxlZ2FsQXJndW1lbnRFcnJvcignVW5rbm93biBkaW1lbnNpb24gdmFsdWU6ICcrXG5kaW1lbnNpb25WYWx1ZSk7fTtqc3RzLmdlb20uRGltZW5zaW9uLnRvRGltZW5zaW9uVmFsdWU9ZnVuY3Rpb24oZGltZW5zaW9uU3ltYm9sKXtzd2l0Y2goZGltZW5zaW9uU3ltYm9sLnRvVXBwZXJDYXNlKCkpe2Nhc2UnRic6cmV0dXJuIGpzdHMuZ2VvbS5EaW1lbnNpb24uRkFMU0U7Y2FzZSdUJzpyZXR1cm4ganN0cy5nZW9tLkRpbWVuc2lvbi5UUlVFO2Nhc2UnKic6cmV0dXJuIGpzdHMuZ2VvbS5EaW1lbnNpb24uRE9OVENBUkU7Y2FzZScwJzpyZXR1cm4ganN0cy5nZW9tLkRpbWVuc2lvbi5QO2Nhc2UnMSc6cmV0dXJuIGpzdHMuZ2VvbS5EaW1lbnNpb24uTDtjYXNlJzInOnJldHVybiBqc3RzLmdlb20uRGltZW5zaW9uLkE7fVxudGhyb3cgbmV3IGpzdHMuZXJyb3IuSWxsZWdhbEFyZ3VtZW50RXJyb3IoJ1Vua25vd24gZGltZW5zaW9uIHN5bWJvbDogJytcbmRpbWVuc2lvblN5bWJvbCk7fTsoZnVuY3Rpb24oKXt2YXIgRGltZW5zaW9uPWpzdHMuZ2VvbS5EaW1lbnNpb247anN0cy5nZW9tLkxpbmVTdHJpbmc9ZnVuY3Rpb24ocG9pbnRzLGZhY3Rvcnkpe3RoaXMuZmFjdG9yeT1mYWN0b3J5O3RoaXMucG9pbnRzPXBvaW50c3x8W107fTtqc3RzLmdlb20uTGluZVN0cmluZy5wcm90b3R5cGU9bmV3IGpzdHMuZ2VvbS5HZW9tZXRyeSgpO2pzdHMuZ2VvbS5MaW5lU3RyaW5nLmNvbnN0cnVjdG9yPWpzdHMuZ2VvbS5MaW5lU3RyaW5nO2pzdHMuZ2VvbS5MaW5lU3RyaW5nLnByb3RvdHlwZS5wb2ludHM9bnVsbDtqc3RzLmdlb20uTGluZVN0cmluZy5wcm90b3R5cGUuZ2V0Q29vcmRpbmF0ZXM9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5wb2ludHM7fTtqc3RzLmdlb20uTGluZVN0cmluZy5wcm90b3R5cGUuZ2V0Q29vcmRpbmF0ZVNlcXVlbmNlPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMucG9pbnRzO307anN0cy5nZW9tLkxpbmVTdHJpbmcucHJvdG90eXBlLmdldENvb3JkaW5hdGVOPWZ1bmN0aW9uKG4pe3JldHVybiB0aGlzLnBvaW50c1tuXTt9O2pzdHMuZ2VvbS5MaW5lU3RyaW5nLnByb3RvdHlwZS5nZXRDb29yZGluYXRlPWZ1bmN0aW9uKCl7aWYodGhpcy5pc0VtcHR5KCkpe3JldHVybiBudWxsO31cbnJldHVybiB0aGlzLmdldENvb3JkaW5hdGVOKDApO307anN0cy5nZW9tLkxpbmVTdHJpbmcucHJvdG90eXBlLmdldERpbWVuc2lvbj1mdW5jdGlvbigpe3JldHVybiAxO307anN0cy5nZW9tLkxpbmVTdHJpbmcucHJvdG90eXBlLmdldEJvdW5kYXJ5RGltZW5zaW9uPWZ1bmN0aW9uKCl7aWYodGhpcy5pc0Nsb3NlZCgpKXtyZXR1cm4gRGltZW5zaW9uLkZBTFNFO31cbnJldHVybiAwO307anN0cy5nZW9tLkxpbmVTdHJpbmcucHJvdG90eXBlLmlzRW1wdHk9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5wb2ludHMubGVuZ3RoPT09MDt9O2pzdHMuZ2VvbS5MaW5lU3RyaW5nLnByb3RvdHlwZS5nZXROdW1Qb2ludHM9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5wb2ludHMubGVuZ3RoO307anN0cy5nZW9tLkxpbmVTdHJpbmcucHJvdG90eXBlLmdldFBvaW50Tj1mdW5jdGlvbihuKXtyZXR1cm4gdGhpcy5nZXRGYWN0b3J5KCkuY3JlYXRlUG9pbnQodGhpcy5wb2ludHNbbl0pO307anN0cy5nZW9tLkxpbmVTdHJpbmcucHJvdG90eXBlLmdldFN0YXJ0UG9pbnQ9ZnVuY3Rpb24oKXtpZih0aGlzLmlzRW1wdHkoKSl7cmV0dXJuIG51bGw7fVxucmV0dXJuIHRoaXMuZ2V0UG9pbnROKDApO307anN0cy5nZW9tLkxpbmVTdHJpbmcucHJvdG90eXBlLmdldEVuZFBvaW50PWZ1bmN0aW9uKCl7aWYodGhpcy5pc0VtcHR5KCkpe3JldHVybiBudWxsO31cbnJldHVybiB0aGlzLmdldFBvaW50Tih0aGlzLmdldE51bVBvaW50cygpLTEpO307anN0cy5nZW9tLkxpbmVTdHJpbmcucHJvdG90eXBlLmlzQ2xvc2VkPWZ1bmN0aW9uKCl7aWYodGhpcy5pc0VtcHR5KCkpe3JldHVybiBmYWxzZTt9XG5yZXR1cm4gdGhpcy5nZXRDb29yZGluYXRlTigwKS5lcXVhbHMyRCh0aGlzLmdldENvb3JkaW5hdGVOKHRoaXMucG9pbnRzLmxlbmd0aC0xKSk7fTtqc3RzLmdlb20uTGluZVN0cmluZy5wcm90b3R5cGUuaXNSaW5nPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuaXNDbG9zZWQoKSYmdGhpcy5pc1NpbXBsZSgpO307anN0cy5nZW9tLkxpbmVTdHJpbmcucHJvdG90eXBlLmdldEdlb21ldHJ5VHlwZT1mdW5jdGlvbigpe3JldHVybidMaW5lU3RyaW5nJzt9O2pzdHMuZ2VvbS5MaW5lU3RyaW5nLnByb3RvdHlwZS5nZXRMZW5ndGg9ZnVuY3Rpb24oKXtyZXR1cm4ganN0cy5hbGdvcml0aG0uQ0dBbGdvcml0aG1zLmNvbXB1dGVMZW5ndGgodGhpcy5wb2ludHMpO307anN0cy5nZW9tLkxpbmVTdHJpbmcucHJvdG90eXBlLmdldEJvdW5kYXJ5PWZ1bmN0aW9uKCl7cmV0dXJuKG5ldyBqc3RzLm9wZXJhdGlvbi5Cb3VuZGFyeU9wKHRoaXMpKS5nZXRCb3VuZGFyeSgpO307anN0cy5nZW9tLkxpbmVTdHJpbmcucHJvdG90eXBlLmNvbXB1dGVFbnZlbG9wZUludGVybmFsPWZ1bmN0aW9uKCl7aWYodGhpcy5pc0VtcHR5KCkpe3JldHVybiBuZXcganN0cy5nZW9tLkVudmVsb3BlKCk7fVxudmFyIGVudj1uZXcganN0cy5nZW9tLkVudmVsb3BlKCk7dGhpcy5wb2ludHMuZm9yRWFjaChmdW5jdGlvbihjb21wb25lbnQpe2Vudi5leHBhbmRUb0luY2x1ZGUoY29tcG9uZW50KTt9KTtyZXR1cm4gZW52O307anN0cy5nZW9tLkxpbmVTdHJpbmcucHJvdG90eXBlLmVxdWFsc0V4YWN0PWZ1bmN0aW9uKG90aGVyLHRvbGVyYW5jZSl7aWYoIXRoaXMuaXNFcXVpdmFsZW50Q2xhc3Mob3RoZXIpKXtyZXR1cm4gZmFsc2U7fVxuaWYodGhpcy5wb2ludHMubGVuZ3RoIT09b3RoZXIucG9pbnRzLmxlbmd0aCl7cmV0dXJuIGZhbHNlO31cbmlmKHRoaXMuaXNFbXB0eSgpJiZvdGhlci5pc0VtcHR5KCkpe3JldHVybiB0cnVlO31cbnJldHVybiB0aGlzLnBvaW50cy5yZWR1Y2UoZnVuY3Rpb24oZXF1YWwscG9pbnQsaSl7cmV0dXJuIGVxdWFsJiZqc3RzLmdlb20uR2VvbWV0cnkucHJvdG90eXBlLmVxdWFsKHBvaW50LG90aGVyLnBvaW50c1tpXSx0b2xlcmFuY2UpO30pO307anN0cy5nZW9tLkxpbmVTdHJpbmcucHJvdG90eXBlLmlzRXF1aXZhbGVudENsYXNzPWZ1bmN0aW9uKG90aGVyKXtyZXR1cm4gb3RoZXIgaW5zdGFuY2VvZiBqc3RzLmdlb20uTGluZVN0cmluZzt9O2pzdHMuZ2VvbS5MaW5lU3RyaW5nLnByb3RvdHlwZS5jb21wYXJlVG9TYW1lQ2xhc3M9ZnVuY3Rpb24obyl7dmFyIGxpbmU9bzt2YXIgaT0wLGlsPXRoaXMucG9pbnRzLmxlbmd0aDt2YXIgaj0wLGpsPWxpbmUucG9pbnRzLmxlbmd0aDt3aGlsZShpPGlsJiZqPGpsKXt2YXIgY29tcGFyaXNvbj10aGlzLnBvaW50c1tpXS5jb21wYXJlVG8obGluZS5wb2ludHNbal0pO2lmKGNvbXBhcmlzb24hPT0wKXtyZXR1cm4gY29tcGFyaXNvbjt9XG5pKys7aisrO31cbmlmKGk8aWwpe3JldHVybiAxO31cbmlmKGo8amwpe3JldHVybi0xO31cbnJldHVybiAwO307anN0cy5nZW9tLkxpbmVTdHJpbmcucHJvdG90eXBlLmFwcGx5PWZ1bmN0aW9uKGZpbHRlcil7aWYoZmlsdGVyIGluc3RhbmNlb2YganN0cy5nZW9tLkdlb21ldHJ5RmlsdGVyfHxmaWx0ZXIgaW5zdGFuY2VvZiBqc3RzLmdlb20uR2VvbWV0cnlDb21wb25lbnRGaWx0ZXIpe2ZpbHRlci5maWx0ZXIodGhpcyk7fWVsc2UgaWYoZmlsdGVyIGluc3RhbmNlb2YganN0cy5nZW9tLkNvb3JkaW5hdGVGaWx0ZXIpe2Zvcih2YXIgaT0wLGxlbj10aGlzLnBvaW50cy5sZW5ndGg7aTxsZW47aSsrKXtmaWx0ZXIuZmlsdGVyKHRoaXMucG9pbnRzW2ldKTt9fWVsc2UgaWYoZmlsdGVyIGluc3RhbmNlb2YganN0cy5nZW9tLkNvb3JkaW5hdGVTZXF1ZW5jZUZpbHRlcil7dGhpcy5hcHBseTIuYXBwbHkodGhpcyxhcmd1bWVudHMpO319O2pzdHMuZ2VvbS5MaW5lU3RyaW5nLnByb3RvdHlwZS5hcHBseTI9ZnVuY3Rpb24oZmlsdGVyKXtpZih0aGlzLnBvaW50cy5sZW5ndGg9PT0wKVxucmV0dXJuO2Zvcih2YXIgaT0wO2k8dGhpcy5wb2ludHMubGVuZ3RoO2krKyl7ZmlsdGVyLmZpbHRlcih0aGlzLnBvaW50cyxpKTtpZihmaWx0ZXIuaXNEb25lKCkpXG5icmVhazt9XG5pZihmaWx0ZXIuaXNHZW9tZXRyeUNoYW5nZWQoKSl7fX07anN0cy5nZW9tLkxpbmVTdHJpbmcucHJvdG90eXBlLmNsb25lPWZ1bmN0aW9uKCl7dmFyIHBvaW50cz1bXTtmb3IodmFyIGk9MCxsZW49dGhpcy5wb2ludHMubGVuZ3RoO2k8bGVuO2krKyl7cG9pbnRzLnB1c2godGhpcy5wb2ludHNbaV0uY2xvbmUoKSk7fVxucmV0dXJuIHRoaXMuZmFjdG9yeS5jcmVhdGVMaW5lU3RyaW5nKHBvaW50cyk7fTtqc3RzLmdlb20uTGluZVN0cmluZy5wcm90b3R5cGUubm9ybWFsaXplPWZ1bmN0aW9uKCl7dmFyIGksaWwsaixjaSxjaixsZW47bGVuPXRoaXMucG9pbnRzLmxlbmd0aDtpbD1wYXJzZUludChsZW4vMik7Zm9yKGk9MDtpPGlsO2krKyl7aj1sZW4tMS1pO2NpPXRoaXMucG9pbnRzW2ldO2NqPXRoaXMucG9pbnRzW2pdO2lmKCFjaS5lcXVhbHMoY2opKXtpZihjaS5jb21wYXJlVG8oY2opPjApe3RoaXMucG9pbnRzLnJldmVyc2UoKTt9XG5yZXR1cm47fX19O2pzdHMuZ2VvbS5MaW5lU3RyaW5nLnByb3RvdHlwZS5DTEFTU19OQU1FPSdqc3RzLmdlb20uTGluZVN0cmluZyc7fSkoKTsoZnVuY3Rpb24oKXtqc3RzLmdlb20uUG9seWdvbj1mdW5jdGlvbihzaGVsbCxob2xlcyxmYWN0b3J5KXt0aGlzLnNoZWxsPXNoZWxsfHxmYWN0b3J5LmNyZWF0ZUxpbmVhclJpbmcobnVsbCk7dGhpcy5ob2xlcz1ob2xlc3x8W107dGhpcy5mYWN0b3J5PWZhY3Rvcnk7fTtqc3RzLmdlb20uUG9seWdvbi5wcm90b3R5cGU9bmV3IGpzdHMuZ2VvbS5HZW9tZXRyeSgpO2pzdHMuZ2VvbS5Qb2x5Z29uLmNvbnN0cnVjdG9yPWpzdHMuZ2VvbS5Qb2x5Z29uO2pzdHMuZ2VvbS5Qb2x5Z29uLnByb3RvdHlwZS5nZXRDb29yZGluYXRlPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuc2hlbGwuZ2V0Q29vcmRpbmF0ZSgpO307anN0cy5nZW9tLlBvbHlnb24ucHJvdG90eXBlLmdldENvb3JkaW5hdGVzPWZ1bmN0aW9uKCl7aWYodGhpcy5pc0VtcHR5KCkpe3JldHVybltdO31cbnZhciBjb29yZGluYXRlcz1bXTt2YXIgaz0tMTt2YXIgc2hlbGxDb29yZGluYXRlcz10aGlzLnNoZWxsLmdldENvb3JkaW5hdGVzKCk7Zm9yKHZhciB4PTA7eDxzaGVsbENvb3JkaW5hdGVzLmxlbmd0aDt4Kyspe2srKztjb29yZGluYXRlc1trXT1zaGVsbENvb3JkaW5hdGVzW3hdO31cbmZvcih2YXIgaT0wO2k8dGhpcy5ob2xlcy5sZW5ndGg7aSsrKXt2YXIgY2hpbGRDb29yZGluYXRlcz10aGlzLmhvbGVzW2ldLmdldENvb3JkaW5hdGVzKCk7Zm9yKHZhciBqPTA7ajxjaGlsZENvb3JkaW5hdGVzLmxlbmd0aDtqKyspe2srKztjb29yZGluYXRlc1trXT1jaGlsZENvb3JkaW5hdGVzW2pdO319XG5yZXR1cm4gY29vcmRpbmF0ZXM7fTtqc3RzLmdlb20uUG9seWdvbi5wcm90b3R5cGUuZ2V0TnVtUG9pbnRzPWZ1bmN0aW9uKCl7dmFyIG51bVBvaW50cz10aGlzLnNoZWxsLmdldE51bVBvaW50cygpO2Zvcih2YXIgaT0wO2k8dGhpcy5ob2xlcy5sZW5ndGg7aSsrKXtudW1Qb2ludHMrPXRoaXMuaG9sZXNbaV0uZ2V0TnVtUG9pbnRzKCk7fVxucmV0dXJuIG51bVBvaW50czt9O2pzdHMuZ2VvbS5Qb2x5Z29uLnByb3RvdHlwZS5pc0VtcHR5PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuc2hlbGwuaXNFbXB0eSgpO307anN0cy5nZW9tLlBvbHlnb24ucHJvdG90eXBlLmlzUmVjdGFuZ2xlPWZ1bmN0aW9uKCl7aWYodGhpcy5nZXROdW1JbnRlcmlvclJpbmcoKSE9MClyZXR1cm4gZmFsc2U7aWYodGhpcy5zaGVsbD09bnVsbClyZXR1cm4gZmFsc2U7aWYodGhpcy5zaGVsbC5nZXROdW1Qb2ludHMoKSE9NSlyZXR1cm4gZmFsc2U7dmFyIHNlcT10aGlzLnNoZWxsLmdldENvb3JkaW5hdGVTZXF1ZW5jZSgpO3ZhciBlbnY9dGhpcy5nZXRFbnZlbG9wZUludGVybmFsKCk7Zm9yKHZhciBpPTA7aTw1O2krKyl7dmFyIHg9c2VxW2ldLng7aWYoISh4PT1lbnYuZ2V0TWluWCgpfHx4PT1lbnYuZ2V0TWF4WCgpKSlyZXR1cm4gZmFsc2U7dmFyIHk9c2VxW2ldLnk7aWYoISh5PT1lbnYuZ2V0TWluWSgpfHx5PT1lbnYuZ2V0TWF4WSgpKSlyZXR1cm4gZmFsc2U7fVxudmFyIHByZXZYPXNlcVswXS54O3ZhciBwcmV2WT1zZXFbMF0ueTtmb3IodmFyIGk9MTtpPD00O2krKyl7dmFyIHg9c2VxW2ldLng7dmFyIHk9c2VxW2ldLnk7dmFyIHhDaGFuZ2VkPXghPXByZXZYO3ZhciB5Q2hhbmdlZD15IT1wcmV2WTtpZih4Q2hhbmdlZD09eUNoYW5nZWQpXG5yZXR1cm4gZmFsc2U7cHJldlg9eDtwcmV2WT15O31cbnJldHVybiB0cnVlO307anN0cy5nZW9tLlBvbHlnb24ucHJvdG90eXBlLmdldEV4dGVyaW9yUmluZz1mdW5jdGlvbigpe3JldHVybiB0aGlzLnNoZWxsO307anN0cy5nZW9tLlBvbHlnb24ucHJvdG90eXBlLmdldEludGVyaW9yUmluZ049ZnVuY3Rpb24obil7cmV0dXJuIHRoaXMuaG9sZXNbbl07fTtqc3RzLmdlb20uUG9seWdvbi5wcm90b3R5cGUuZ2V0TnVtSW50ZXJpb3JSaW5nPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuaG9sZXMubGVuZ3RoO307anN0cy5nZW9tLlBvbHlnb24ucHJvdG90eXBlLmdldEFyZWE9ZnVuY3Rpb24oKXt2YXIgYXJlYT0wLjA7YXJlYSs9TWF0aC5hYnMoanN0cy5hbGdvcml0aG0uQ0dBbGdvcml0aG1zLnNpZ25lZEFyZWEodGhpcy5zaGVsbC5nZXRDb29yZGluYXRlU2VxdWVuY2UoKSkpO2Zvcih2YXIgaT0wO2k8dGhpcy5ob2xlcy5sZW5ndGg7aSsrKXthcmVhLT1NYXRoLmFicyhqc3RzLmFsZ29yaXRobS5DR0FsZ29yaXRobXMuc2lnbmVkQXJlYSh0aGlzLmhvbGVzW2ldLmdldENvb3JkaW5hdGVTZXF1ZW5jZSgpKSk7fVxucmV0dXJuIGFyZWE7fTtqc3RzLmdlb20uUG9seWdvbi5wcm90b3R5cGUuZ2V0TGVuZ3RoPWZ1bmN0aW9uKCl7dmFyIGxlbj0wLjA7bGVuKz10aGlzLnNoZWxsLmdldExlbmd0aCgpO2Zvcih2YXIgaT0wO2k8dGhpcy5ob2xlcy5sZW5ndGg7aSsrKXtsZW4rPXRoaXMuaG9sZXNbaV0uZ2V0TGVuZ3RoKCk7fVxucmV0dXJuIGxlbjt9O2pzdHMuZ2VvbS5Qb2x5Z29uLnByb3RvdHlwZS5nZXRCb3VuZGFyeT1mdW5jdGlvbigpe2lmKHRoaXMuaXNFbXB0eSgpKXtyZXR1cm4gdGhpcy5nZXRGYWN0b3J5KCkuY3JlYXRlTXVsdGlMaW5lU3RyaW5nKG51bGwpO31cbnZhciByaW5ncz1bXTtyaW5nc1swXT10aGlzLnNoZWxsLmNsb25lKCk7Zm9yKHZhciBpPTAsbGVuPXRoaXMuaG9sZXMubGVuZ3RoO2k8bGVuO2krKyl7cmluZ3NbaSsxXT10aGlzLmhvbGVzW2ldLmNsb25lKCk7fVxuaWYocmluZ3MubGVuZ3RoPD0xKVxucmV0dXJuIHJpbmdzWzBdO3JldHVybiB0aGlzLmdldEZhY3RvcnkoKS5jcmVhdGVNdWx0aUxpbmVTdHJpbmcocmluZ3MpO307anN0cy5nZW9tLlBvbHlnb24ucHJvdG90eXBlLmNvbXB1dGVFbnZlbG9wZUludGVybmFsPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuc2hlbGwuZ2V0RW52ZWxvcGVJbnRlcm5hbCgpO307anN0cy5nZW9tLlBvbHlnb24ucHJvdG90eXBlLmdldERpbWVuc2lvbj1mdW5jdGlvbigpe3JldHVybiAyO307anN0cy5nZW9tLlBvbHlnb24ucHJvdG90eXBlLmdldEJvdW5kYXJ5RGltZW5zaW9uPWZ1bmN0aW9uKCl7cmV0dXJuIDE7fTtqc3RzLmdlb20uUG9seWdvbi5wcm90b3R5cGUuZXF1YWxzRXhhY3Q9ZnVuY3Rpb24ob3RoZXIsdG9sZXJhbmNlKXtpZighdGhpcy5pc0VxdWl2YWxlbnRDbGFzcyhvdGhlcikpe3JldHVybiBmYWxzZTt9XG5pZih0aGlzLmlzRW1wdHkoKSYmb3RoZXIuaXNFbXB0eSgpKXtyZXR1cm4gdHJ1ZTt9XG5pZih0aGlzLmlzRW1wdHkoKSE9PW90aGVyLmlzRW1wdHkoKSl7cmV0dXJuIGZhbHNlO31cbmlmKCF0aGlzLnNoZWxsLmVxdWFsc0V4YWN0KG90aGVyLnNoZWxsLHRvbGVyYW5jZSkpe3JldHVybiBmYWxzZTt9XG5pZih0aGlzLmhvbGVzLmxlbmd0aCE9PW90aGVyLmhvbGVzLmxlbmd0aCl7cmV0dXJuIGZhbHNlO31cbmlmKHRoaXMuaG9sZXMubGVuZ3RoIT09b3RoZXIuaG9sZXMubGVuZ3RoKXtyZXR1cm4gZmFsc2U7fVxuZm9yKHZhciBpPTA7aTx0aGlzLmhvbGVzLmxlbmd0aDtpKyspe2lmKCEodGhpcy5ob2xlc1tpXSkuZXF1YWxzRXhhY3Qob3RoZXIuaG9sZXNbaV0sdG9sZXJhbmNlKSl7cmV0dXJuIGZhbHNlO319XG5yZXR1cm4gdHJ1ZTt9O2pzdHMuZ2VvbS5Qb2x5Z29uLnByb3RvdHlwZS5jb21wYXJlVG9TYW1lQ2xhc3M9ZnVuY3Rpb24obyl7cmV0dXJuIHRoaXMuc2hlbGwuY29tcGFyZVRvU2FtZUNsYXNzKG8uc2hlbGwpO307anN0cy5nZW9tLlBvbHlnb24ucHJvdG90eXBlLmFwcGx5PWZ1bmN0aW9uKGZpbHRlcil7aWYoZmlsdGVyIGluc3RhbmNlb2YganN0cy5nZW9tLkdlb21ldHJ5Q29tcG9uZW50RmlsdGVyKXtmaWx0ZXIuZmlsdGVyKHRoaXMpO3RoaXMuc2hlbGwuYXBwbHkoZmlsdGVyKTtmb3IodmFyIGk9MCxsZW49dGhpcy5ob2xlcy5sZW5ndGg7aTxsZW47aSsrKXt0aGlzLmhvbGVzW2ldLmFwcGx5KGZpbHRlcik7fX1lbHNlIGlmKGZpbHRlciBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5HZW9tZXRyeUZpbHRlcil7ZmlsdGVyLmZpbHRlcih0aGlzKTt9ZWxzZSBpZihmaWx0ZXIgaW5zdGFuY2VvZiBqc3RzLmdlb20uQ29vcmRpbmF0ZUZpbHRlcil7dGhpcy5zaGVsbC5hcHBseShmaWx0ZXIpO2Zvcih2YXIgaT0wLGxlbj10aGlzLmhvbGVzLmxlbmd0aDtpPGxlbjtpKyspe3RoaXMuaG9sZXNbaV0uYXBwbHkoZmlsdGVyKTt9fWVsc2UgaWYoZmlsdGVyIGluc3RhbmNlb2YganN0cy5nZW9tLkNvb3JkaW5hdGVTZXF1ZW5jZUZpbHRlcil7dGhpcy5hcHBseTIuYXBwbHkodGhpcyxhcmd1bWVudHMpO319O2pzdHMuZ2VvbS5Qb2x5Z29uLnByb3RvdHlwZS5hcHBseTI9ZnVuY3Rpb24oZmlsdGVyKXt0aGlzLnNoZWxsLmFwcGx5KGZpbHRlcik7aWYoIWZpbHRlci5pc0RvbmUoKSl7Zm9yKHZhciBpPTA7aTx0aGlzLmhvbGVzLmxlbmd0aDtpKyspe3RoaXMuaG9sZXNbaV0uYXBwbHkoZmlsdGVyKTtpZihmaWx0ZXIuaXNEb25lKCkpXG5icmVhazt9fVxuaWYoZmlsdGVyLmlzR2VvbWV0cnlDaGFuZ2VkKCkpe319O2pzdHMuZ2VvbS5Qb2x5Z29uLnByb3RvdHlwZS5jbG9uZT1mdW5jdGlvbigpe3ZhciBob2xlcz1bXTtmb3IodmFyIGk9MCxsZW49dGhpcy5ob2xlcy5sZW5ndGg7aTxsZW47aSsrKXtob2xlcy5wdXNoKHRoaXMuaG9sZXNbaV0uY2xvbmUoKSk7fVxucmV0dXJuIHRoaXMuZmFjdG9yeS5jcmVhdGVQb2x5Z29uKHRoaXMuc2hlbGwuY2xvbmUoKSxob2xlcyk7fTtqc3RzLmdlb20uUG9seWdvbi5wcm90b3R5cGUubm9ybWFsaXplPWZ1bmN0aW9uKCl7dGhpcy5ub3JtYWxpemUyKHRoaXMuc2hlbGwsdHJ1ZSk7Zm9yKHZhciBpPTAsbGVuPXRoaXMuaG9sZXMubGVuZ3RoO2k8bGVuO2krKyl7dGhpcy5ub3JtYWxpemUyKHRoaXMuaG9sZXNbaV0sZmFsc2UpO31cbnRoaXMuaG9sZXMuc29ydCgpO307anN0cy5nZW9tLlBvbHlnb24ucHJvdG90eXBlLm5vcm1hbGl6ZTI9ZnVuY3Rpb24ocmluZyxjbG9ja3dpc2Upe2lmKHJpbmcuaXNFbXB0eSgpKXtyZXR1cm47fVxudmFyIHVuaXF1ZUNvb3JkaW5hdGVzPXJpbmcucG9pbnRzLnNsaWNlKDAscmluZy5wb2ludHMubGVuZ3RoLTEpO3ZhciBtaW5Db29yZGluYXRlPWpzdHMuZ2VvbS5Db29yZGluYXRlQXJyYXlzLm1pbkNvb3JkaW5hdGUocmluZy5wb2ludHMpO2pzdHMuZ2VvbS5Db29yZGluYXRlQXJyYXlzLnNjcm9sbCh1bmlxdWVDb29yZGluYXRlcyxtaW5Db29yZGluYXRlKTtyaW5nLnBvaW50cz11bmlxdWVDb29yZGluYXRlcy5jb25jYXQoKTtyaW5nLnBvaW50c1t1bmlxdWVDb29yZGluYXRlcy5sZW5ndGhdPXVuaXF1ZUNvb3JkaW5hdGVzWzBdO2lmKGpzdHMuYWxnb3JpdGhtLkNHQWxnb3JpdGhtcy5pc0NDVyhyaW5nLnBvaW50cyk9PT1jbG9ja3dpc2Upe3JpbmcucG9pbnRzLnJldmVyc2UoKTt9fTtqc3RzLmdlb20uUG9seWdvbi5wcm90b3R5cGUuZ2V0R2VvbWV0cnlUeXBlPWZ1bmN0aW9uKCl7cmV0dXJuJ1BvbHlnb24nO307anN0cy5nZW9tLlBvbHlnb24ucHJvdG90eXBlLkNMQVNTX05BTUU9J2pzdHMuZ2VvbS5Qb2x5Z29uJzt9KSgpOyhmdW5jdGlvbigpe3ZhciBHZW9tZXRyeT1qc3RzLmdlb20uR2VvbWV0cnk7dmFyIFRyZWVTZXQ9amF2YXNjcmlwdC51dGlsLlRyZWVTZXQ7dmFyIEFycmF5cz1qYXZhc2NyaXB0LnV0aWwuQXJyYXlzO2pzdHMuZ2VvbS5HZW9tZXRyeUNvbGxlY3Rpb249ZnVuY3Rpb24oZ2VvbWV0cmllcyxmYWN0b3J5KXt0aGlzLmdlb21ldHJpZXM9Z2VvbWV0cmllc3x8W107dGhpcy5mYWN0b3J5PWZhY3Rvcnk7fTtqc3RzLmdlb20uR2VvbWV0cnlDb2xsZWN0aW9uLnByb3RvdHlwZT1uZXcgR2VvbWV0cnkoKTtqc3RzLmdlb20uR2VvbWV0cnlDb2xsZWN0aW9uLmNvbnN0cnVjdG9yPWpzdHMuZ2VvbS5HZW9tZXRyeUNvbGxlY3Rpb247anN0cy5nZW9tLkdlb21ldHJ5Q29sbGVjdGlvbi5wcm90b3R5cGUuaXNFbXB0eT1mdW5jdGlvbigpe2Zvcih2YXIgaT0wLGxlbj10aGlzLmdlb21ldHJpZXMubGVuZ3RoO2k8bGVuO2krKyl7dmFyIGdlb21ldHJ5PXRoaXMuZ2V0R2VvbWV0cnlOKGkpO2lmKCFnZW9tZXRyeS5pc0VtcHR5KCkpe3JldHVybiBmYWxzZTt9fVxucmV0dXJuIHRydWU7fTtqc3RzLmdlb20uR2VvbWV0cnlDb2xsZWN0aW9uLnByb3RvdHlwZS5nZXRBcmVhPWZ1bmN0aW9uKCl7dmFyIGFyZWE9MC4wO2Zvcih2YXIgaT0wLGxlbj10aGlzLmdlb21ldHJpZXMubGVuZ3RoO2k8bGVuO2krKyl7YXJlYSs9dGhpcy5nZXRHZW9tZXRyeU4oaSkuZ2V0QXJlYSgpO31cbnJldHVybiBhcmVhO307anN0cy5nZW9tLkdlb21ldHJ5Q29sbGVjdGlvbi5wcm90b3R5cGUuZ2V0TGVuZ3RoPWZ1bmN0aW9uKCl7dmFyIGxlbmd0aD0wLjA7Zm9yKHZhciBpPTAsbGVuPXRoaXMuZ2VvbWV0cmllcy5sZW5ndGg7aTxsZW47aSsrKXtsZW5ndGgrPXRoaXMuZ2V0R2VvbWV0cnlOKGkpLmdldExlbmd0aCgpO31cbnJldHVybiBsZW5ndGg7fTtqc3RzLmdlb20uR2VvbWV0cnlDb2xsZWN0aW9uLnByb3RvdHlwZS5nZXRDb29yZGluYXRlPWZ1bmN0aW9uKCl7aWYodGhpcy5pc0VtcHR5KCkpXG5yZXR1cm4gbnVsbDtyZXR1cm4gdGhpcy5nZXRHZW9tZXRyeU4oMCkuZ2V0Q29vcmRpbmF0ZSgpO307anN0cy5nZW9tLkdlb21ldHJ5Q29sbGVjdGlvbi5wcm90b3R5cGUuZ2V0Q29vcmRpbmF0ZXM9ZnVuY3Rpb24oKXt2YXIgY29vcmRpbmF0ZXM9W107dmFyIGs9LTE7Zm9yKHZhciBpPTAsbGVuPXRoaXMuZ2VvbWV0cmllcy5sZW5ndGg7aTxsZW47aSsrKXt2YXIgZ2VvbWV0cnk9dGhpcy5nZXRHZW9tZXRyeU4oaSk7dmFyIGNoaWxkQ29vcmRpbmF0ZXM9Z2VvbWV0cnkuZ2V0Q29vcmRpbmF0ZXMoKTtmb3IodmFyIGo9MDtqPGNoaWxkQ29vcmRpbmF0ZXMubGVuZ3RoO2orKyl7aysrO2Nvb3JkaW5hdGVzW2tdPWNoaWxkQ29vcmRpbmF0ZXNbal07fX1cbnJldHVybiBjb29yZGluYXRlczt9O2pzdHMuZ2VvbS5HZW9tZXRyeUNvbGxlY3Rpb24ucHJvdG90eXBlLmdldE51bUdlb21ldHJpZXM9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5nZW9tZXRyaWVzLmxlbmd0aDt9O2pzdHMuZ2VvbS5HZW9tZXRyeUNvbGxlY3Rpb24ucHJvdG90eXBlLmdldEdlb21ldHJ5Tj1mdW5jdGlvbihuKXt2YXIgZ2VvbWV0cnk9dGhpcy5nZW9tZXRyaWVzW25dO2lmKGdlb21ldHJ5IGluc3RhbmNlb2YganN0cy5nZW9tLkNvb3JkaW5hdGUpe2dlb21ldHJ5PW5ldyBqc3RzLmdlb20uUG9pbnQoZ2VvbWV0cnkpO31cbnJldHVybiBnZW9tZXRyeTt9O2pzdHMuZ2VvbS5HZW9tZXRyeUNvbGxlY3Rpb24ucHJvdG90eXBlLmdldE51bVBvaW50cz1mdW5jdGlvbihuKXt2YXIgbnVtUG9pbnRzPTA7Zm9yKHZhciBpPTA7aTx0aGlzLmdlb21ldHJpZXMubGVuZ3RoO2krKyl7bnVtUG9pbnRzKz10aGlzLmdlb21ldHJpZXNbaV0uZ2V0TnVtUG9pbnRzKCk7fVxucmV0dXJuIG51bVBvaW50czt9XG5qc3RzLmdlb20uR2VvbWV0cnlDb2xsZWN0aW9uLnByb3RvdHlwZS5lcXVhbHNFeGFjdD1mdW5jdGlvbihvdGhlcix0b2xlcmFuY2Upe2lmKCF0aGlzLmlzRXF1aXZhbGVudENsYXNzKG90aGVyKSl7cmV0dXJuIGZhbHNlO31cbmlmKHRoaXMuZ2VvbWV0cmllcy5sZW5ndGghPT1vdGhlci5nZW9tZXRyaWVzLmxlbmd0aCl7cmV0dXJuIGZhbHNlO31cbmZvcih2YXIgaT0wLGxlbj10aGlzLmdlb21ldHJpZXMubGVuZ3RoO2k8bGVuO2krKyl7dmFyIGdlb21ldHJ5PXRoaXMuZ2V0R2VvbWV0cnlOKGkpO2lmKCFnZW9tZXRyeS5lcXVhbHNFeGFjdChvdGhlci5nZXRHZW9tZXRyeU4oaSksdG9sZXJhbmNlKSl7cmV0dXJuIGZhbHNlO319XG5yZXR1cm4gdHJ1ZTt9O2pzdHMuZ2VvbS5HZW9tZXRyeUNvbGxlY3Rpb24ucHJvdG90eXBlLmNsb25lPWZ1bmN0aW9uKCl7dmFyIGdlb21ldHJpZXM9W107Zm9yKHZhciBpPTAsbGVuPXRoaXMuZ2VvbWV0cmllcy5sZW5ndGg7aTxsZW47aSsrKXtnZW9tZXRyaWVzLnB1c2godGhpcy5nZW9tZXRyaWVzW2ldLmNsb25lKCkpO31cbnJldHVybiB0aGlzLmZhY3RvcnkuY3JlYXRlR2VvbWV0cnlDb2xsZWN0aW9uKGdlb21ldHJpZXMpO307anN0cy5nZW9tLkdlb21ldHJ5Q29sbGVjdGlvbi5wcm90b3R5cGUubm9ybWFsaXplPWZ1bmN0aW9uKCl7Zm9yKHZhciBpPTAsbGVuPXRoaXMuZ2VvbWV0cmllcy5sZW5ndGg7aTxsZW47aSsrKXt0aGlzLmdldEdlb21ldHJ5TihpKS5ub3JtYWxpemUoKTt9XG50aGlzLmdlb21ldHJpZXMuc29ydCgpO307anN0cy5nZW9tLkdlb21ldHJ5Q29sbGVjdGlvbi5wcm90b3R5cGUuY29tcGFyZVRvU2FtZUNsYXNzPWZ1bmN0aW9uKG8pe3ZhciB0aGVzZUVsZW1lbnRzPW5ldyBUcmVlU2V0KEFycmF5cy5hc0xpc3QodGhpcy5nZW9tZXRyaWVzKSk7dmFyIG90aGVyRWxlbWVudHM9bmV3IFRyZWVTZXQoQXJyYXlzLmFzTGlzdChvLmdlb21ldHJpZXMpKTtyZXR1cm4gdGhpcy5jb21wYXJlKHRoZXNlRWxlbWVudHMsb3RoZXJFbGVtZW50cyk7fTtqc3RzLmdlb20uR2VvbWV0cnlDb2xsZWN0aW9uLnByb3RvdHlwZS5hcHBseT1mdW5jdGlvbihmaWx0ZXIpe2lmKGZpbHRlciBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5HZW9tZXRyeUZpbHRlcnx8ZmlsdGVyIGluc3RhbmNlb2YganN0cy5nZW9tLkdlb21ldHJ5Q29tcG9uZW50RmlsdGVyKXtmaWx0ZXIuZmlsdGVyKHRoaXMpO2Zvcih2YXIgaT0wLGxlbj10aGlzLmdlb21ldHJpZXMubGVuZ3RoO2k8bGVuO2krKyl7dGhpcy5nZXRHZW9tZXRyeU4oaSkuYXBwbHkoZmlsdGVyKTt9fWVsc2UgaWYoZmlsdGVyIGluc3RhbmNlb2YganN0cy5nZW9tLkNvb3JkaW5hdGVGaWx0ZXIpe2Zvcih2YXIgaT0wLGxlbj10aGlzLmdlb21ldHJpZXMubGVuZ3RoO2k8bGVuO2krKyl7dGhpcy5nZXRHZW9tZXRyeU4oaSkuYXBwbHkoZmlsdGVyKTt9fWVsc2UgaWYoZmlsdGVyIGluc3RhbmNlb2YganN0cy5nZW9tLkNvb3JkaW5hdGVTZXF1ZW5jZUZpbHRlcil7dGhpcy5hcHBseTIuYXBwbHkodGhpcyxhcmd1bWVudHMpO319O2pzdHMuZ2VvbS5HZW9tZXRyeUNvbGxlY3Rpb24ucHJvdG90eXBlLmFwcGx5Mj1mdW5jdGlvbihmaWx0ZXIpe2lmKHRoaXMuZ2VvbWV0cmllcy5sZW5ndGg9PTApXG5yZXR1cm47Zm9yKHZhciBpPTA7aTx0aGlzLmdlb21ldHJpZXMubGVuZ3RoO2krKyl7dGhpcy5nZW9tZXRyaWVzW2ldLmFwcGx5KGZpbHRlcik7aWYoZmlsdGVyLmlzRG9uZSgpKXticmVhazt9fVxuaWYoZmlsdGVyLmlzR2VvbWV0cnlDaGFuZ2VkKCkpe319O2pzdHMuZ2VvbS5HZW9tZXRyeUNvbGxlY3Rpb24ucHJvdG90eXBlLmdldERpbWVuc2lvbj1mdW5jdGlvbigpe3ZhciBkaW1lbnNpb249anN0cy5nZW9tLkRpbWVuc2lvbi5GQUxTRTtmb3IodmFyIGk9MCxsZW49dGhpcy5nZW9tZXRyaWVzLmxlbmd0aDtpPGxlbjtpKyspe3ZhciBnZW9tZXRyeT10aGlzLmdldEdlb21ldHJ5TihpKTtkaW1lbnNpb249TWF0aC5tYXgoZGltZW5zaW9uLGdlb21ldHJ5LmdldERpbWVuc2lvbigpKTt9XG5yZXR1cm4gZGltZW5zaW9uO307anN0cy5nZW9tLkdlb21ldHJ5Q29sbGVjdGlvbi5wcm90b3R5cGUuY29tcHV0ZUVudmVsb3BlSW50ZXJuYWw9ZnVuY3Rpb24oKXt2YXIgZW52ZWxvcGU9bmV3IGpzdHMuZ2VvbS5FbnZlbG9wZSgpO2Zvcih2YXIgaT0wLGxlbj10aGlzLmdlb21ldHJpZXMubGVuZ3RoO2k8bGVuO2krKyl7dmFyIGdlb21ldHJ5PXRoaXMuZ2V0R2VvbWV0cnlOKGkpO2VudmVsb3BlLmV4cGFuZFRvSW5jbHVkZShnZW9tZXRyeS5nZXRFbnZlbG9wZUludGVybmFsKCkpO31cbnJldHVybiBlbnZlbG9wZTt9O2pzdHMuZ2VvbS5HZW9tZXRyeUNvbGxlY3Rpb24ucHJvdG90eXBlLkNMQVNTX05BTUU9J2pzdHMuZ2VvbS5HZW9tZXRyeUNvbGxlY3Rpb24nO30pKCk7anN0cy5hbGdvcml0aG0uQ2VudHJvaWQ9ZnVuY3Rpb24oZ2VvbWV0cnkpe3RoaXMuYXJlYUJhc2VQdD1udWxsO3RoaXMudHJpYW5nbGVDZW50Mz1uZXcganN0cy5nZW9tLkNvb3JkaW5hdGUoKTt0aGlzLmFyZWFzdW0yPTA7dGhpcy5jZzM9bmV3IGpzdHMuZ2VvbS5Db29yZGluYXRlKCk7dGhpcy5saW5lQ2VudFN1bT1uZXcganN0cy5nZW9tLkNvb3JkaW5hdGUoKTt0aGlzLnRvdGFsTGVuZ3RoPTA7dGhpcy5wdENvdW50PTA7dGhpcy5wdENlbnRTdW09bmV3IGpzdHMuZ2VvbS5Db29yZGluYXRlKCk7dGhpcy5hZGQoZ2VvbWV0cnkpO307anN0cy5hbGdvcml0aG0uQ2VudHJvaWQuZ2V0Q2VudHJvaWQ9ZnVuY3Rpb24oZ2VvbWV0cnkpe3ZhciBjZW50PW5ldyBqc3RzLmFsZ29yaXRobS5DZW50cm9pZChnZW9tZXRyeSk7cmV0dXJuIGNlbnQuZ2V0Q2VudHJvaWQoKTt9O2pzdHMuYWxnb3JpdGhtLkNlbnRyb2lkLmNlbnRyb2lkMz1mdW5jdGlvbihwMSxwMixwMyxjKXtjLng9cDEueCtwMi54K3AzLng7Yy55PXAxLnkrcDIueStwMy55O307anN0cy5hbGdvcml0aG0uQ2VudHJvaWQuYXJlYTI9ZnVuY3Rpb24ocDEscDIscDMpe3JldHVybihwMi54LXAxLngpKihwMy55LXAxLnkpLShwMy54LXAxLngpKihwMi55LXAxLnkpO307anN0cy5hbGdvcml0aG0uQ2VudHJvaWQucHJvdG90eXBlLmFkZD1mdW5jdGlvbihnZW9tKXtpZihnZW9tLmlzRW1wdHkoKSl7cmV0dXJuO31cbmlmKGdlb20gaW5zdGFuY2VvZiBqc3RzLmdlb20uUG9pbnQpe3RoaXMuYWRkUG9pbnQoZ2VvbS5nZXRDb29yZGluYXRlKCkpO31lbHNlIGlmKGdlb20gaW5zdGFuY2VvZiBqc3RzLmdlb20uTGluZVN0cmluZyl7dGhpcy5hZGRMaW5lU2VnbWVudHMoZ2VvbS5nZXRDb29yZGluYXRlcygpKTt9ZWxzZSBpZihnZW9tIGluc3RhbmNlb2YganN0cy5nZW9tLlBvbHlnb24pe3RoaXMuYWRkUG9seWdvbihnZW9tKTt9ZWxzZSBpZihnZW9tIGluc3RhbmNlb2YganN0cy5nZW9tLkdlb21ldHJ5Q29sbGVjdGlvbil7Zm9yKHZhciBpPTA7aTxnZW9tLmdldE51bUdlb21ldHJpZXMoKTtpKyspe3RoaXMuYWRkKGdlb20uZ2V0R2VvbWV0cnlOKGkpKTt9fX07anN0cy5hbGdvcml0aG0uQ2VudHJvaWQucHJvdG90eXBlLmdldENlbnRyb2lkPWZ1bmN0aW9uKCl7dmFyIGNlbnQ9bmV3IGpzdHMuZ2VvbS5Db29yZGluYXRlKCk7aWYoTWF0aC5hYnModGhpcy5hcmVhc3VtMik+MCl7Y2VudC54PXRoaXMuY2czLngvMy90aGlzLmFyZWFzdW0yO2NlbnQueT10aGlzLmNnMy55LzMvdGhpcy5hcmVhc3VtMjt9ZWxzZSBpZih0aGlzLnRvdGFsTGVuZ3RoPjApe2NlbnQueD10aGlzLmxpbmVDZW50U3VtLngvdGhpcy50b3RhbExlbmd0aDtjZW50Lnk9dGhpcy5saW5lQ2VudFN1bS55L3RoaXMudG90YWxMZW5ndGg7fWVsc2UgaWYodGhpcy5wdENvdW50PjApe2NlbnQueD10aGlzLnB0Q2VudFN1bS54L3RoaXMucHRDb3VudDtjZW50Lnk9dGhpcy5wdENlbnRTdW0ueS90aGlzLnB0Q291bnQ7fWVsc2V7cmV0dXJuIG51bGw7fVxucmV0dXJuIGNlbnQ7fTtqc3RzLmFsZ29yaXRobS5DZW50cm9pZC5wcm90b3R5cGUuc2V0QmFzZVBvaW50PWZ1bmN0aW9uKGJhc2VQdCl7aWYodGhpcy5hcmVhQmFzZVB0PT09bnVsbCl7dGhpcy5hcmVhQmFzZVB0PWJhc2VQdDt9fTtqc3RzLmFsZ29yaXRobS5DZW50cm9pZC5wcm90b3R5cGUuYWRkUG9seWdvbj1mdW5jdGlvbihwb2x5KXt0aGlzLmFkZFNoZWxsKHBvbHkuZ2V0RXh0ZXJpb3JSaW5nKCkuZ2V0Q29vcmRpbmF0ZXMoKSk7Zm9yKHZhciBpPTA7aTxwb2x5LmdldE51bUludGVyaW9yUmluZygpO2krKyl7dGhpcy5hZGRIb2xlKHBvbHkuZ2V0SW50ZXJpb3JSaW5nTihpKS5nZXRDb29yZGluYXRlcygpKTt9fTtqc3RzLmFsZ29yaXRobS5DZW50cm9pZC5wcm90b3R5cGUuYWRkU2hlbGw9ZnVuY3Rpb24ocHRzKXtpZihwdHMubGVuZ3RoPjApe3RoaXMuc2V0QmFzZVBvaW50KHB0c1swXSk7fVxudmFyIGlzUG9zaXRpdmVBcmVhPSFqc3RzLmFsZ29yaXRobS5DR0FsZ29yaXRobXMuaXNDQ1cocHRzKTtmb3IodmFyIGk9MDtpPHB0cy5sZW5ndGgtMTtpKyspe3RoaXMuYWRkVHJpYW5nbGUodGhpcy5hcmVhQmFzZVB0LHB0c1tpXSxwdHNbaSsxXSxpc1Bvc2l0aXZlQXJlYSk7fVxudGhpcy5hZGRMaW5lU2VnbWVudHMocHRzKTt9O2pzdHMuYWxnb3JpdGhtLkNlbnRyb2lkLnByb3RvdHlwZS5hZGRIb2xlPWZ1bmN0aW9uKHB0cyl7dmFyIGlzUG9zaXRpdmVBcmVhPWpzdHMuYWxnb3JpdGhtLkNHQWxnb3JpdGhtcy5pc0NDVyhwdHMpO2Zvcih2YXIgaT0wO2k8cHRzLmxlbmd0aC0xO2krKyl7dGhpcy5hZGRUcmlhbmdsZSh0aGlzLmFyZWFCYXNlUHQscHRzW2ldLHB0c1tpKzFdLGlzUG9zaXRpdmVBcmVhKTt9XG50aGlzLmFkZExpbmVTZWdtZW50cyhwdHMpO307anN0cy5hbGdvcml0aG0uQ2VudHJvaWQucHJvdG90eXBlLmFkZFRyaWFuZ2xlPWZ1bmN0aW9uKHAwLHAxLHAyLGlzUG9zaXRpdmVBcmVhKXt2YXIgc2lnbj0oaXNQb3NpdGl2ZUFyZWEpPzE6LTE7anN0cy5hbGdvcml0aG0uQ2VudHJvaWQuY2VudHJvaWQzKHAwLHAxLHAyLHRoaXMudHJpYW5nbGVDZW50Myk7dmFyIGFyZWEyPWpzdHMuYWxnb3JpdGhtLkNlbnRyb2lkLmFyZWEyKHAwLHAxLHAyKTt0aGlzLmNnMy54Kz1zaWduKmFyZWEyKnRoaXMudHJpYW5nbGVDZW50My54O3RoaXMuY2czLnkrPXNpZ24qYXJlYTIqdGhpcy50cmlhbmdsZUNlbnQzLnk7dGhpcy5hcmVhc3VtMis9c2lnbiphcmVhMjt9O2pzdHMuYWxnb3JpdGhtLkNlbnRyb2lkLnByb3RvdHlwZS5hZGRMaW5lU2VnbWVudHM9ZnVuY3Rpb24ocHRzKXt2YXIgbGluZUxlbj0wO2Zvcih2YXIgaT0wO2k8cHRzLmxlbmd0aC0xO2krKyl7dmFyIHNlZ21lbnRMZW49cHRzW2ldLmRpc3RhbmNlKHB0c1tpKzFdKTtpZihzZWdtZW50TGVuPT09MCl7Y29udGludWU7fVxubGluZUxlbis9c2VnbWVudExlbjt2YXIgbWlkeD0ocHRzW2ldLngrcHRzW2krMV0ueCkvMjt0aGlzLmxpbmVDZW50U3VtLngrPXNlZ21lbnRMZW4qbWlkeDt2YXIgbWlkeT0ocHRzW2ldLnkrcHRzW2krMV0ueSkvMjt0aGlzLmxpbmVDZW50U3VtLnkrPXNlZ21lbnRMZW4qbWlkeTt9XG50aGlzLnRvdGFsTGVuZ3RoKz1saW5lTGVuO2lmKGxpbmVMZW49PT0wJiZwdHMubGVuZ3RoPjApe3RoaXMuYWRkUG9pbnQocHRzWzBdKTt9fTtqc3RzLmFsZ29yaXRobS5DZW50cm9pZC5wcm90b3R5cGUuYWRkUG9pbnQ9ZnVuY3Rpb24ocHQpe3RoaXMucHRDb3VudCs9MTt0aGlzLnB0Q2VudFN1bS54Kz1wdC54O3RoaXMucHRDZW50U3VtLnkrPXB0Lnk7fTsoZnVuY3Rpb24oKXt2YXIgRWRnZVJpbmc9ZnVuY3Rpb24oZmFjdG9yeSl7dGhpcy5kZUxpc3Q9bmV3IGphdmFzY3JpcHQudXRpbC5BcnJheUxpc3QoKTt0aGlzLmZhY3Rvcnk9ZmFjdG9yeTt9O0VkZ2VSaW5nLmZpbmRFZGdlUmluZ0NvbnRhaW5pbmc9ZnVuY3Rpb24odGVzdEVyLHNoZWxsTGlzdCl7dmFyIHRlc3RSaW5nPXRlc3RFci5nZXRSaW5nKCk7dmFyIHRlc3RFbnY9dGVzdFJpbmcuZ2V0RW52ZWxvcGVJbnRlcm5hbCgpO3ZhciB0ZXN0UHQ9dGVzdFJpbmcuZ2V0Q29vcmRpbmF0ZU4oMCk7dmFyIG1pblNoZWxsPW51bGw7dmFyIG1pbkVudj1udWxsO2Zvcih2YXIgaXQ9c2hlbGxMaXN0Lml0ZXJhdG9yKCk7aXQuaGFzTmV4dCgpOyl7dmFyIHRyeVNoZWxsPWl0Lm5leHQoKTt2YXIgdHJ5UmluZz10cnlTaGVsbC5nZXRSaW5nKCk7dmFyIHRyeUVudj10cnlSaW5nLmdldEVudmVsb3BlSW50ZXJuYWwoKTtpZihtaW5TaGVsbCE9bnVsbClcbm1pbkVudj1taW5TaGVsbC5nZXRSaW5nKCkuZ2V0RW52ZWxvcGVJbnRlcm5hbCgpO3ZhciBpc0NvbnRhaW5lZD1mYWxzZTtpZih0cnlFbnYuZXF1YWxzKHRlc3RFbnYpKVxuY29udGludWU7dGVzdFB0PWpzdHMuZ2VvbS5Db29yZGluYXRlQXJyYXlzLnB0Tm90SW5MaXN0KHRlc3RSaW5nLmdldENvb3JkaW5hdGVzKCksdHJ5UmluZy5nZXRDb29yZGluYXRlcygpKTtpZih0cnlFbnYuY29udGFpbnModGVzdEVudikmJmpzdHMuYWxnb3JpdGhtLkNHQWxnb3JpdGhtcy5pc1BvaW50SW5SaW5nKHRlc3RQdCx0cnlSaW5nLmdldENvb3JkaW5hdGVzKCkpKVxuaXNDb250YWluZWQ9dHJ1ZTtpZihpc0NvbnRhaW5lZCl7aWYobWluU2hlbGw9PW51bGx8fG1pbkVudi5jb250YWlucyh0cnlFbnYpKXttaW5TaGVsbD10cnlTaGVsbDt9fX1cbnJldHVybiBtaW5TaGVsbDt9O0VkZ2VSaW5nLnB0Tm90SW5MaXN0PWZ1bmN0aW9uKHRlc3RQdHMscHRzKXtmb3IodmFyIGk9MDtpPHRlc3RQdHMubGVuZ3RoO2krKyl7dmFyIHRlc3RQdD10ZXN0UHRzW2ldO2lmKCFpc0luTGlzdCh0ZXN0UHQscHRzKSlcbnJldHVybiB0ZXN0UHQ7fVxucmV0dXJuIG51bGw7fTtFZGdlUmluZy5pc0luTGlzdD1mdW5jdGlvbihwdCxwdHMpe2Zvcih2YXIgaT0wO2k8cHRzLmxlbmd0aDtpKyspe2lmKHB0LmVxdWFscyhwdHNbaV0pKVxucmV0dXJuIHRydWU7fVxucmV0dXJuIGZhbHNlO31cbkVkZ2VSaW5nLnByb3RvdHlwZS5mYWN0b3J5PW51bGw7RWRnZVJpbmcucHJvdG90eXBlLmRlTGlzdD1udWxsO0VkZ2VSaW5nLnByb3RvdHlwZS5yaW5nPW51bGw7RWRnZVJpbmcucHJvdG90eXBlLnJpbmdQdHM9bnVsbDtFZGdlUmluZy5wcm90b3R5cGUuaG9sZXM9bnVsbDtFZGdlUmluZy5wcm90b3R5cGUuYWRkPWZ1bmN0aW9uKGRlKXt0aGlzLmRlTGlzdC5hZGQoZGUpO307RWRnZVJpbmcucHJvdG90eXBlLmlzSG9sZT1mdW5jdGlvbigpe3ZhciByaW5nPXRoaXMuZ2V0UmluZygpO3JldHVybiBqc3RzLmFsZ29yaXRobS5DR0FsZ29yaXRobXMuaXNDQ1cocmluZy5nZXRDb29yZGluYXRlcygpKTt9O0VkZ2VSaW5nLnByb3RvdHlwZS5hZGRIb2xlPWZ1bmN0aW9uKGhvbGUpe2lmKHRoaXMuaG9sZXM9PW51bGwpXG50aGlzLmhvbGVzPW5ldyBqYXZhc2NyaXB0LnV0aWwuQXJyYXlMaXN0KCk7dGhpcy5ob2xlcy5hZGQoaG9sZSk7fTtFZGdlUmluZy5wcm90b3R5cGUuZ2V0UG9seWdvbj1mdW5jdGlvbigpe3ZhciBob2xlTFI9bnVsbDtpZih0aGlzLmhvbGVzIT1udWxsKXtob2xlTFI9W107Zm9yKHZhciBpPTA7aTx0aGlzLmhvbGVzLnNpemUoKTtpKyspe2hvbGVMUltpXT10aGlzLmhvbGVzLmdldChpKTt9fVxudmFyIHBvbHk9dGhpcy5mYWN0b3J5LmNyZWF0ZVBvbHlnb24odGhpcy5yaW5nLGhvbGVMUik7cmV0dXJuIHBvbHk7fTtFZGdlUmluZy5wcm90b3R5cGUuaXNWYWxpZD1mdW5jdGlvbigpe3RoaXMuZ2V0Q29vcmRpbmF0ZXMoKTtpZih0aGlzLnJpbmdQdHMubGVuZ3RoPD0zKVxucmV0dXJuIGZhbHNlO3RoaXMuZ2V0UmluZygpO3JldHVybiB0aGlzLnJpbmcuaXNWYWxpZCgpO307RWRnZVJpbmcucHJvdG90eXBlLmdldENvb3JkaW5hdGVzPWZ1bmN0aW9uKCl7aWYodGhpcy5yaW5nUHRzPT1udWxsKXt2YXIgY29vcmRMaXN0PW5ldyBqc3RzLmdlb20uQ29vcmRpbmF0ZUxpc3QoKTtmb3IodmFyIGk9dGhpcy5kZUxpc3QuaXRlcmF0b3IoKTtpLmhhc05leHQoKTspe3ZhciBkZT1pLm5leHQoKTt2YXIgZWRnZT1kZS5nZXRFZGdlKCk7RWRnZVJpbmcuYWRkRWRnZShlZGdlLmdldExpbmUoKS5nZXRDb29yZGluYXRlcygpLGRlLmdldEVkZ2VEaXJlY3Rpb24oKSxjb29yZExpc3QpO31cbnRoaXMucmluZ1B0cz1jb29yZExpc3QudG9Db29yZGluYXRlQXJyYXkoKTt9XG5yZXR1cm4gdGhpcy5yaW5nUHRzO307RWRnZVJpbmcucHJvdG90eXBlLmdldExpbmVTdHJpbmc9ZnVuY3Rpb24oKXt0aGlzLmdldENvb3JkaW5hdGVzKCk7cmV0dXJuIHRoaXMuZmFjdG9yeS5jcmVhdGVMaW5lU3RyaW5nKHRoaXMucmluZ1B0cyk7fTtFZGdlUmluZy5wcm90b3R5cGUuZ2V0UmluZz1mdW5jdGlvbigpe2lmKHRoaXMucmluZyE9bnVsbClcbnJldHVybiB0aGlzLnJpbmc7dGhpcy5nZXRDb29yZGluYXRlcygpO2lmKHRoaXMucmluZ1B0cy5sZW5ndGg8MylcbmNvbnNvbGUubG9nKHRoaXMucmluZ1B0cyk7dHJ5e3RoaXMucmluZz10aGlzLmZhY3RvcnkuY3JlYXRlTGluZWFyUmluZyh0aGlzLnJpbmdQdHMpO31jYXRjaChleCl7Y29uc29sZS5sb2codGhpcy5yaW5nUHRzKTt9XG5yZXR1cm4gdGhpcy5yaW5nO307RWRnZVJpbmcuYWRkRWRnZT1mdW5jdGlvbihjb29yZHMsaXNGb3J3YXJkLGNvb3JkTGlzdCl7aWYoaXNGb3J3YXJkKXtmb3IodmFyIGk9MDtpPGNvb3Jkcy5sZW5ndGg7aSsrKXtjb29yZExpc3QuYWRkKGNvb3Jkc1tpXSxmYWxzZSk7fX1lbHNle2Zvcih2YXIgaT1jb29yZHMubGVuZ3RoLTE7aT49MDtpLS0pe2Nvb3JkTGlzdC5hZGQoY29vcmRzW2ldLGZhbHNlKTt9fX07anN0cy5vcGVyYXRpb24ucG9seWdvbml6ZS5FZGdlUmluZz1FZGdlUmluZzt9KSgpOyhmdW5jdGlvbigpe3ZhciBHcmFwaENvbXBvbmVudD1mdW5jdGlvbigpe307R3JhcGhDb21wb25lbnQuc2V0VmlzaXRlZD1mdW5jdGlvbihpLHZpc2l0ZWQpe3doaWxlKGkuaGFzTmV4dCgpKXt2YXIgY29tcD1pLm5leHQoKTtjb21wLnNldFZpc2l0ZWQodmlzaXRlZCk7fX07R3JhcGhDb21wb25lbnQuc2V0TWFya2VkPWZ1bmN0aW9uKGksbWFya2VkKXt3aGlsZShpLmhhc05leHQoKSl7dmFyIGNvbXA9aS5uZXh0KCk7Y29tcC5zZXRNYXJrZWQobWFya2VkKTt9fTtHcmFwaENvbXBvbmVudC5nZXRDb21wb25lbnRXaXRoVmlzaXRlZFN0YXRlPWZ1bmN0aW9uKGksdmlzaXRlZFN0YXRlKXt3aGlsZShpLmhhc05leHQoKSl7dmFyIGNvbXA9aS5uZXh0KCk7aWYoY29tcC5pc1Zpc2l0ZWQoKT09dmlzaXRlZFN0YXRlKVxucmV0dXJuIGNvbXA7fVxucmV0dXJuIG51bGw7fTtHcmFwaENvbXBvbmVudC5wcm90b3R5cGUuX2lzTWFya2VkPWZhbHNlO0dyYXBoQ29tcG9uZW50LnByb3RvdHlwZS5faXNWaXNpdGVkPWZhbHNlO0dyYXBoQ29tcG9uZW50LnByb3RvdHlwZS5kYXRhO0dyYXBoQ29tcG9uZW50LnByb3RvdHlwZS5pc1Zpc2l0ZWQ9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5faXNWaXNpdGVkO307R3JhcGhDb21wb25lbnQucHJvdG90eXBlLnNldFZpc2l0ZWQ9ZnVuY3Rpb24oaXNWaXNpdGVkKXt0aGlzLl9pc1Zpc2l0ZWQ9aXNWaXNpdGVkO307R3JhcGhDb21wb25lbnQucHJvdG90eXBlLmlzTWFya2VkPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2lzTWFya2VkO307R3JhcGhDb21wb25lbnQucHJvdG90eXBlLnNldE1hcmtlZD1mdW5jdGlvbihpc01hcmtlZCl7dGhpcy5faXNNYXJrZWQ9aXNNYXJrZWQ7fTtHcmFwaENvbXBvbmVudC5wcm90b3R5cGUuc2V0Q29udGV4dD1mdW5jdGlvbihkYXRhKXt0aGlzLmRhdGE9ZGF0YTt9O0dyYXBoQ29tcG9uZW50LnByb3RvdHlwZS5nZXRDb250ZXh0PWZ1bmN0aW9uKCl7cmV0dXJuIGRhdGE7fTtHcmFwaENvbXBvbmVudC5wcm90b3R5cGUuc2V0RGF0YT1mdW5jdGlvbihkYXRhKXt0aGlzLmRhdGE9ZGF0YTt9O0dyYXBoQ29tcG9uZW50LnByb3RvdHlwZS5nZXREYXRhPWZ1bmN0aW9uKCl7cmV0dXJuIGRhdGE7fTtHcmFwaENvbXBvbmVudC5wcm90b3R5cGUuaXNSZW1vdmVkPWZ1bmN0aW9uKCl7dGhyb3cgbmV3IGpzdHMuZXJyb3IuQWJzdHJhY3RNZXRob2RJbnZvY2F0aW9uRXJyb3IoKTt9O2pzdHMucGxhbmFyZ3JhcGguR3JhcGhDb21wb25lbnQ9R3JhcGhDb21wb25lbnQ7fSkoKTsoZnVuY3Rpb24oKXt2YXIgR3JhcGhDb21wb25lbnQ9anN0cy5wbGFuYXJncmFwaC5HcmFwaENvbXBvbmVudDt2YXIgRWRnZT1mdW5jdGlvbihkZTAsZGUxKXtpZihkZTA9PT11bmRlZmluZWQpe3JldHVybjt9XG50aGlzLnNldERpcmVjdGVkRWRnZXMoZGUwLGRlMSk7fTtFZGdlLnByb3RvdHlwZT1uZXcgR3JhcGhDb21wb25lbnQoKTtFZGdlLnByb3RvdHlwZS5kaXJFZGdlPW51bGw7RWRnZS5wcm90b3R5cGUuc2V0RGlyZWN0ZWRFZGdlcz1mdW5jdGlvbihkZTAsZGUxKXt0aGlzLmRpckVkZ2U9W2RlMCxkZTFdO2RlMC5zZXRFZGdlKHRoaXMpO2RlMS5zZXRFZGdlKHRoaXMpO2RlMC5zZXRTeW0oZGUxKTtkZTEuc2V0U3ltKGRlMCk7ZGUwLmdldEZyb21Ob2RlKCkuYWRkT3V0RWRnZShkZTApO2RlMS5nZXRGcm9tTm9kZSgpLmFkZE91dEVkZ2UoZGUxKTt9O0VkZ2UucHJvdG90eXBlLmdldERpckVkZ2U9ZnVuY3Rpb24oaSl7aWYoaSBpbnN0YW5jZW9mIGpzdHMucGxhbmFyZ3JhcGguTm9kZSl7dGhpcy5nZXREaXJFZGdlMihpKTt9XG5yZXR1cm4gdGhpcy5kaXJFZGdlW2ldO307RWRnZS5wcm90b3R5cGUuZ2V0RGlyRWRnZTI9ZnVuY3Rpb24oZnJvbU5vZGUpe2lmKHRoaXMuZGlyRWRnZVswXS5nZXRGcm9tTm9kZSgpPT1mcm9tTm9kZSlcbnJldHVybiB0aGlzLmRpckVkZ2VbMF07aWYodGhpcy5kaXJFZGdlWzFdLmdldEZyb21Ob2RlKCk9PWZyb21Ob2RlKVxucmV0dXJuIHRoaXMuZGlyRWRnZVsxXTtyZXR1cm4gbnVsbDt9O0VkZ2UucHJvdG90eXBlLmdldE9wcG9zaXRlTm9kZT1mdW5jdGlvbihub2RlKXtpZih0aGlzLmRpckVkZ2VbMF0uZ2V0RnJvbU5vZGUoKT09bm9kZSlcbnJldHVybiB0aGlzLmRpckVkZ2VbMF0uZ2V0VG9Ob2RlKCk7aWYodGhpcy5kaXJFZGdlWzFdLmdldEZyb21Ob2RlKCk9PW5vZGUpXG5yZXR1cm4gdGhpcy5kaXJFZGdlWzFdLmdldFRvTm9kZSgpO3JldHVybiBudWxsO307RWRnZS5wcm90b3R5cGUucmVtb3ZlPWZ1bmN0aW9uKCl7dGhpcy5kaXJFZGdlPW51bGw7fTtFZGdlLnByb3RvdHlwZS5pc1JlbW92ZWQ9ZnVuY3Rpb24oKXtyZXR1cm4gZGlyRWRnZT09bnVsbDt9O2pzdHMucGxhbmFyZ3JhcGguRWRnZT1FZGdlO30pKCk7anN0cy5vcGVyYXRpb24ucG9seWdvbml6ZS5Qb2x5Z29uaXplRWRnZT1mdW5jdGlvbihsaW5lKXt0aGlzLmxpbmU9bGluZTt9O2pzdHMub3BlcmF0aW9uLnBvbHlnb25pemUuUG9seWdvbml6ZUVkZ2UucHJvdG90eXBlPW5ldyBqc3RzLnBsYW5hcmdyYXBoLkVkZ2UoKTtqc3RzLm9wZXJhdGlvbi5wb2x5Z29uaXplLlBvbHlnb25pemVFZGdlLnByb3RvdHlwZS5saW5lPW51bGw7anN0cy5vcGVyYXRpb24ucG9seWdvbml6ZS5Qb2x5Z29uaXplRWRnZS5wcm90b3R5cGUuZ2V0TGluZT1mdW5jdGlvbigpe3JldHVybiB0aGlzLmxpbmU7fTsoZnVuY3Rpb24oKXt2YXIgQXJyYXlMaXN0PWphdmFzY3JpcHQudXRpbC5BcnJheUxpc3Q7dmFyIEdyYXBoQ29tcG9uZW50PWpzdHMucGxhbmFyZ3JhcGguR3JhcGhDb21wb25lbnQ7dmFyIERpcmVjdGVkRWRnZT1mdW5jdGlvbihmcm9tLHRvLGRpcmVjdGlvblB0LGVkZ2VEaXJlY3Rpb24pe2lmKGZyb209PT11bmRlZmluZWQpe3JldHVybjt9XG50aGlzLmZyb209ZnJvbTt0aGlzLnRvPXRvO3RoaXMuZWRnZURpcmVjdGlvbj1lZGdlRGlyZWN0aW9uO3RoaXMucDA9ZnJvbS5nZXRDb29yZGluYXRlKCk7dGhpcy5wMT1kaXJlY3Rpb25QdDt2YXIgZHg9dGhpcy5wMS54LXRoaXMucDAueDt2YXIgZHk9dGhpcy5wMS55LXRoaXMucDAueTt0aGlzLnF1YWRyYW50PWpzdHMuZ2VvbWdyYXBoLlF1YWRyYW50LnF1YWRyYW50KGR4LGR5KTt0aGlzLmFuZ2xlPU1hdGguYXRhbjIoZHksZHgpO307RGlyZWN0ZWRFZGdlLnByb3RvdHlwZT1uZXcgR3JhcGhDb21wb25lbnQoKTtEaXJlY3RlZEVkZ2UudG9FZGdlcz1mdW5jdGlvbihkaXJFZGdlcyl7dmFyIGVkZ2VzPW5ldyBBcnJheUxpc3QoKTtmb3IodmFyIGk9ZGlyRWRnZXMuaXRlcmF0b3IoKTtpLmhhc05leHQoKTspe2VkZ2VzLmFkZCgoaS5uZXh0KCkpLnBhcmVudEVkZ2UpO31cbnJldHVybiBlZGdlczt9O0RpcmVjdGVkRWRnZS5wcm90b3R5cGUucGFyZW50RWRnZT1udWxsO0RpcmVjdGVkRWRnZS5wcm90b3R5cGUuZnJvbT1udWxsO0RpcmVjdGVkRWRnZS5wcm90b3R5cGUudG89bnVsbDtEaXJlY3RlZEVkZ2UucHJvdG90eXBlLnAwPW51bGw7RGlyZWN0ZWRFZGdlLnByb3RvdHlwZS5wMT1udWxsO0RpcmVjdGVkRWRnZS5wcm90b3R5cGUuc3ltPW51bGw7RGlyZWN0ZWRFZGdlLnByb3RvdHlwZS5lZGdlRGlyZWN0aW9uPW51bGw7RGlyZWN0ZWRFZGdlLnByb3RvdHlwZS5xdWFkcmFudD1udWxsO0RpcmVjdGVkRWRnZS5wcm90b3R5cGUuYW5nbGU9bnVsbDtEaXJlY3RlZEVkZ2UucHJvdG90eXBlLmdldEVkZ2U9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5wYXJlbnRFZGdlO307RGlyZWN0ZWRFZGdlLnByb3RvdHlwZS5zZXRFZGdlPWZ1bmN0aW9uKHBhcmVudEVkZ2Upe3RoaXMucGFyZW50RWRnZT1wYXJlbnRFZGdlO307RGlyZWN0ZWRFZGdlLnByb3RvdHlwZS5nZXRRdWFkcmFudD1mdW5jdGlvbigpe3JldHVybiB0aGlzLnF1YWRyYW50O307RGlyZWN0ZWRFZGdlLnByb3RvdHlwZS5nZXREaXJlY3Rpb25QdD1mdW5jdGlvbigpe3JldHVybiB0aGlzLnAxO307RGlyZWN0ZWRFZGdlLnByb3RvdHlwZS5nZXRFZGdlRGlyZWN0aW9uPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZWRnZURpcmVjdGlvbjt9O0RpcmVjdGVkRWRnZS5wcm90b3R5cGUuZ2V0RnJvbU5vZGU9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5mcm9tO307RGlyZWN0ZWRFZGdlLnByb3RvdHlwZS5nZXRUb05vZGU9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy50bzt9O0RpcmVjdGVkRWRnZS5wcm90b3R5cGUuZ2V0Q29vcmRpbmF0ZT1mdW5jdGlvbigpe3JldHVybiB0aGlzLmZyb20uZ2V0Q29vcmRpbmF0ZSgpO307RGlyZWN0ZWRFZGdlLnByb3RvdHlwZS5nZXRBbmdsZT1mdW5jdGlvbigpe3JldHVybiB0aGlzLmFuZ2xlO307RGlyZWN0ZWRFZGdlLnByb3RvdHlwZS5nZXRTeW09ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5zeW07fTtEaXJlY3RlZEVkZ2UucHJvdG90eXBlLnNldFN5bT1mdW5jdGlvbihzeW0pe3RoaXMuc3ltPXN5bTt9O0RpcmVjdGVkRWRnZS5wcm90b3R5cGUucmVtb3ZlPWZ1bmN0aW9uKCl7dGhpcy5zeW09bnVsbDt0aGlzLnBhcmVudEVkZ2U9bnVsbDt9O0RpcmVjdGVkRWRnZS5wcm90b3R5cGUuaXNSZW1vdmVkPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMucGFyZW50RWRnZT09bnVsbDt9O0RpcmVjdGVkRWRnZS5wcm90b3R5cGUuY29tcGFyZVRvPWZ1bmN0aW9uKG9iail7dmFyIGRlPW9iajtyZXR1cm4gdGhpcy5jb21wYXJlRGlyZWN0aW9uKGRlKTt9O0RpcmVjdGVkRWRnZS5wcm90b3R5cGUuY29tcGFyZURpcmVjdGlvbj1mdW5jdGlvbihlKXtpZih0aGlzLnF1YWRyYW50PmUucXVhZHJhbnQpXG5yZXR1cm4gMTtpZih0aGlzLnF1YWRyYW50PGUucXVhZHJhbnQpXG5yZXR1cm4tMTtyZXR1cm4ganN0cy5hbGdvcml0aG0uQ0dBbGdvcml0aG1zLmNvbXB1dGVPcmllbnRhdGlvbihlLnAwLGUucDEsdGhpcy5wMSk7fTtqc3RzLnBsYW5hcmdyYXBoLkRpcmVjdGVkRWRnZT1EaXJlY3RlZEVkZ2U7fSkoKTsoZnVuY3Rpb24oKXt2YXIgRGlyZWN0ZWRFZGdlPWpzdHMucGxhbmFyZ3JhcGguRGlyZWN0ZWRFZGdlO3ZhciBQb2x5Z29uaXplRGlyZWN0ZWRFZGdlPWZ1bmN0aW9uKGZyb20sdG8sZGlyZWN0aW9uUHQsZWRnZURpcmVjdGlvbil7RGlyZWN0ZWRFZGdlLmFwcGx5KHRoaXMsYXJndW1lbnRzKTt9O1BvbHlnb25pemVEaXJlY3RlZEVkZ2UucHJvdG90eXBlPW5ldyBEaXJlY3RlZEVkZ2UoKTtQb2x5Z29uaXplRGlyZWN0ZWRFZGdlLnByb3RvdHlwZS5lZGdlUmluZz1udWxsO1BvbHlnb25pemVEaXJlY3RlZEVkZ2UucHJvdG90eXBlLm5leHQ9bnVsbDtQb2x5Z29uaXplRGlyZWN0ZWRFZGdlLnByb3RvdHlwZS5sYWJlbD0tMTtQb2x5Z29uaXplRGlyZWN0ZWRFZGdlLnByb3RvdHlwZS5nZXRMYWJlbD1mdW5jdGlvbigpe3JldHVybiB0aGlzLmxhYmVsO307UG9seWdvbml6ZURpcmVjdGVkRWRnZS5wcm90b3R5cGUuc2V0TGFiZWw9ZnVuY3Rpb24obGFiZWwpe3RoaXMubGFiZWw9bGFiZWw7fTtQb2x5Z29uaXplRGlyZWN0ZWRFZGdlLnByb3RvdHlwZS5nZXROZXh0PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMubmV4dDt9O1BvbHlnb25pemVEaXJlY3RlZEVkZ2UucHJvdG90eXBlLnNldE5leHQ9ZnVuY3Rpb24obmV4dCl7dGhpcy5uZXh0PW5leHQ7fTtQb2x5Z29uaXplRGlyZWN0ZWRFZGdlLnByb3RvdHlwZS5pc0luUmluZz1mdW5jdGlvbigpe3JldHVybiB0aGlzLmVkZ2VSaW5nIT1udWxsO307UG9seWdvbml6ZURpcmVjdGVkRWRnZS5wcm90b3R5cGUuc2V0UmluZz1mdW5jdGlvbihlZGdlUmluZyl7dGhpcy5lZGdlUmluZz1lZGdlUmluZzt9O2pzdHMub3BlcmF0aW9uLnBvbHlnb25pemUuUG9seWdvbml6ZURpcmVjdGVkRWRnZT1Qb2x5Z29uaXplRGlyZWN0ZWRFZGdlO30pKCk7KGZ1bmN0aW9uKCl7dmFyIEFycmF5TGlzdD1qYXZhc2NyaXB0LnV0aWwuQXJyYXlMaXN0O3ZhciBEaXJlY3RlZEVkZ2VTdGFyPWZ1bmN0aW9uKCl7dGhpcy5vdXRFZGdlcz1uZXcgQXJyYXlMaXN0KCk7fTtEaXJlY3RlZEVkZ2VTdGFyLnByb3RvdHlwZS5vdXRFZGdlcz1udWxsO0RpcmVjdGVkRWRnZVN0YXIucHJvdG90eXBlLnNvcnRlZD1mYWxzZTtEaXJlY3RlZEVkZ2VTdGFyLnByb3RvdHlwZS5hZGQ9ZnVuY3Rpb24oZGUpe3RoaXMub3V0RWRnZXMuYWRkKGRlKTt0aGlzLnNvcnRlZD1mYWxzZTt9O0RpcmVjdGVkRWRnZVN0YXIucHJvdG90eXBlLnJlbW92ZT1mdW5jdGlvbihkZSl7dGhpcy5vdXRFZGdlcy5yZW1vdmUoZGUpO307RGlyZWN0ZWRFZGdlU3Rhci5wcm90b3R5cGUuaXRlcmF0b3I9ZnVuY3Rpb24oKXt0aGlzLnNvcnRFZGdlcygpO3JldHVybiB0aGlzLm91dEVkZ2VzLml0ZXJhdG9yKCk7fTtEaXJlY3RlZEVkZ2VTdGFyLnByb3RvdHlwZS5nZXREZWdyZWU9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5vdXRFZGdlcy5zaXplKCk7fTtEaXJlY3RlZEVkZ2VTdGFyLnByb3RvdHlwZS5nZXRDb29yZGluYXRlPWZ1bmN0aW9uKCl7dmFyIGl0PWl0ZXJhdG9yKCk7aWYoIWl0Lmhhc05leHQoKSlcbnJldHVybiBudWxsO3ZhciBlPWl0Lm5leHQoKTtyZXR1cm4gZS5nZXRDb29yZGluYXRlKCk7fTtEaXJlY3RlZEVkZ2VTdGFyLnByb3RvdHlwZS5nZXRFZGdlcz1mdW5jdGlvbigpe3RoaXMuc29ydEVkZ2VzKCk7cmV0dXJuIHRoaXMub3V0RWRnZXM7fTtEaXJlY3RlZEVkZ2VTdGFyLnByb3RvdHlwZS5zb3J0RWRnZXM9ZnVuY3Rpb24oKXtpZighdGhpcy5zb3J0ZWQpe3ZhciBhcnJheT10aGlzLm91dEVkZ2VzLnRvQXJyYXkoKTthcnJheS5zb3J0KGZ1bmN0aW9uKGEsYil7cmV0dXJuIGEuY29tcGFyZVRvKGIpO30pO3RoaXMub3V0RWRnZXM9amF2YXNjcmlwdC51dGlsLkFycmF5cy5hc0xpc3QoYXJyYXkpO3RoaXMuc29ydGVkPXRydWU7fX07RGlyZWN0ZWRFZGdlU3Rhci5wcm90b3R5cGUuZ2V0SW5kZXg9ZnVuY3Rpb24oZWRnZSl7aWYoZWRnZSBpbnN0YW5jZW9mIGpzdHMucGxhbmFyZ3JhcGguRGlyZWN0ZWRFZGdlKXtyZXR1cm4gdGhpcy5nZXRJbmRleDIoZWRnZSk7fWVsc2UgaWYodHlwZW9mKGVkZ2UpPT09J251bWJlcicpe3JldHVybiB0aGlzLmdldEluZGV4MyhlZGdlKTt9XG50aGlzLnNvcnRFZGdlcygpO2Zvcih2YXIgaT0wO2k8dGhpcy5vdXRFZGdlcy5zaXplKCk7aSsrKXt2YXIgZGU9dGhpcy5vdXRFZGdlcy5nZXQoaSk7aWYoZGUuZ2V0RWRnZSgpPT1lZGdlKVxucmV0dXJuIGk7fVxucmV0dXJuLTE7fTtEaXJlY3RlZEVkZ2VTdGFyLnByb3RvdHlwZS5nZXRJbmRleDI9ZnVuY3Rpb24oZGlyRWRnZSl7dGhpcy5zb3J0RWRnZXMoKTtmb3IodmFyIGk9MDtpPHRoaXMub3V0RWRnZXMuc2l6ZSgpO2krKyl7dmFyIGRlPXRoaXMub3V0RWRnZXMuZ2V0KGkpO2lmKGRlPT1kaXJFZGdlKVxucmV0dXJuIGk7fVxucmV0dXJuLTE7fTtEaXJlY3RlZEVkZ2VTdGFyLnByb3RvdHlwZS5nZXRJbmRleDM9ZnVuY3Rpb24oaSl7dmFyIG1vZGk9dG9JbnQoaSV0aGlzLm91dEVkZ2VzLnNpemUoKSk7aWYobW9kaTwwKVxubW9kaSs9dGhpcy5vdXRFZGdlcy5zaXplKCk7cmV0dXJuIG1vZGk7fTtEaXJlY3RlZEVkZ2VTdGFyLnByb3RvdHlwZS5nZXROZXh0RWRnZT1mdW5jdGlvbihkaXJFZGdlKXt2YXIgaT10aGlzLmdldEluZGV4KGRpckVkZ2UpO3JldHVybiB0aGlzLm91dEVkZ2VzLmdldChnZXRJbmRleChpKzEpKTt9O0RpcmVjdGVkRWRnZVN0YXIucHJvdG90eXBlLmdldE5leHRDV0VkZ2U9ZnVuY3Rpb24oZGlyRWRnZSl7dmFyIGk9dGhpcy5nZXRJbmRleChkaXJFZGdlKTtyZXR1cm4gdGhpcy5vdXRFZGdlcy5nZXQoZ2V0SW5kZXgoaS0xKSk7fTtqc3RzLnBsYW5hcmdyYXBoLkRpcmVjdGVkRWRnZVN0YXI9RGlyZWN0ZWRFZGdlU3Rhcjt9KSgpOyhmdW5jdGlvbigpe3ZhciBHcmFwaENvbXBvbmVudD1qc3RzLnBsYW5hcmdyYXBoLkdyYXBoQ29tcG9uZW50O3ZhciBEaXJlY3RlZEVkZ2VTdGFyPWpzdHMucGxhbmFyZ3JhcGguRGlyZWN0ZWRFZGdlU3Rhcjt2YXIgTm9kZT1mdW5jdGlvbihwdCxkZVN0YXIpe3RoaXMucHQ9cHQ7dGhpcy5kZVN0YXI9ZGVTdGFyfHxuZXcgRGlyZWN0ZWRFZGdlU3RhcigpO307Tm9kZS5wcm90b3R5cGU9bmV3IEdyYXBoQ29tcG9uZW50KCk7Tm9kZS5nZXRFZGdlc0JldHdlZW49ZnVuY3Rpb24obm9kZTAsbm9kZTEpe3ZhciBlZGdlczA9RGlyZWN0ZWRFZGdlLnRvRWRnZXMobm9kZTAuZ2V0T3V0RWRnZXMoKS5nZXRFZGdlcygpKTt2YXIgY29tbW9uRWRnZXM9bmV3IGphdmFzY3JpcHQudXRpbC5IYXNoU2V0KGVkZ2VzMCk7dmFyIGVkZ2VzMT1EaXJlY3RlZEVkZ2UudG9FZGdlcyhub2RlMS5nZXRPdXRFZGdlcygpLmdldEVkZ2VzKCkpO2NvbW1vbkVkZ2VzLnJldGFpbkFsbChlZGdlczEpO3JldHVybiBjb21tb25FZGdlczt9O05vZGUucHJvdG90eXBlLnB0PW51bGw7Tm9kZS5wcm90b3R5cGUuZGVTdGFyPW51bGw7Tm9kZS5wcm90b3R5cGUuZ2V0Q29vcmRpbmF0ZT1mdW5jdGlvbigpe3JldHVybiB0aGlzLnB0O307Tm9kZS5wcm90b3R5cGUuYWRkT3V0RWRnZT1mdW5jdGlvbihkZSl7dGhpcy5kZVN0YXIuYWRkKGRlKTt9O05vZGUucHJvdG90eXBlLmdldE91dEVkZ2VzPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZGVTdGFyO307Tm9kZS5wcm90b3R5cGUuZ2V0RGVncmVlPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZGVTdGFyLmdldERlZ3JlZSgpO307Tm9kZS5wcm90b3R5cGUuZ2V0SW5kZXg9ZnVuY3Rpb24oZWRnZSl7cmV0dXJuIHRoaXMuZGVTdGFyLmdldEluZGV4KGVkZ2UpO307Tm9kZS5wcm90b3R5cGUucmVtb3ZlPWZ1bmN0aW9uKGRlKXtpZihkZT09PXVuZGVmaW5lZCl7cmV0dXJuIHRoaXMucmVtb3ZlMigpO31cbnRoaXMuZGVTdGFyLnJlbW92ZShkZSk7fTtOb2RlLnByb3RvdHlwZS5yZW1vdmUyPWZ1bmN0aW9uKCl7dGhpcy5wdD1udWxsO307Tm9kZS5wcm90b3R5cGUuaXNSZW1vdmVkPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMucHQ9PW51bGw7fTtqc3RzLnBsYW5hcmdyYXBoLk5vZGU9Tm9kZTt9KSgpOyhmdW5jdGlvbigpe3ZhciBOb2RlTWFwPWZ1bmN0aW9uKCl7dGhpcy5ub2RlTWFwPW5ldyBqYXZhc2NyaXB0LnV0aWwuVHJlZU1hcCgpO307Tm9kZU1hcC5wcm90b3R5cGUubm9kZU1hcD1udWxsO05vZGVNYXAucHJvdG90eXBlLmFkZD1mdW5jdGlvbihuKXt0aGlzLm5vZGVNYXAucHV0KG4uZ2V0Q29vcmRpbmF0ZSgpLG4pO3JldHVybiBuO307Tm9kZU1hcC5wcm90b3R5cGUucmVtb3ZlPWZ1bmN0aW9uKHB0KXtyZXR1cm4gdGhpcy5ub2RlTWFwLnJlbW92ZShwdCk7fTtOb2RlTWFwLnByb3RvdHlwZS5maW5kPWZ1bmN0aW9uKGNvb3JkKXtyZXR1cm4gdGhpcy5ub2RlTWFwLmdldChjb29yZCk7fTtOb2RlTWFwLnByb3RvdHlwZS5pdGVyYXRvcj1mdW5jdGlvbigpe3JldHVybiB0aGlzLm5vZGVNYXAudmFsdWVzKCkuaXRlcmF0b3IoKTt9O05vZGVNYXAucHJvdG90eXBlLnZhbHVlcz1mdW5jdGlvbigpe3JldHVybiB0aGlzLm5vZGVNYXAudmFsdWVzKCk7fTtqc3RzLnBsYW5hcmdyYXBoLk5vZGVNYXA9Tm9kZU1hcDt9KSgpOyhmdW5jdGlvbigpe3ZhciBBcnJheUxpc3Q9amF2YXNjcmlwdC51dGlsLkFycmF5TGlzdDt2YXIgUGxhbmFyR3JhcGg9ZnVuY3Rpb24oKXt0aGlzLmVkZ2VzPW5ldyBqYXZhc2NyaXB0LnV0aWwuSGFzaFNldCgpO3RoaXMuZGlyRWRnZXM9bmV3IGphdmFzY3JpcHQudXRpbC5IYXNoU2V0KCk7dGhpcy5ub2RlTWFwPW5ldyBqc3RzLnBsYW5hcmdyYXBoLk5vZGVNYXAoKTt9O1BsYW5hckdyYXBoLnByb3RvdHlwZS5lZGdlcz1udWxsO1BsYW5hckdyYXBoLnByb3RvdHlwZS5kaXJFZGdlcz1udWxsO1BsYW5hckdyYXBoLnByb3RvdHlwZS5ub2RlTWFwPW51bGw7UGxhbmFyR3JhcGgucHJvdG90eXBlLmZpbmROb2RlPWZ1bmN0aW9uKHB0KXtyZXR1cm4gdGhpcy5ub2RlTWFwLmZpbmQocHQpO307UGxhbmFyR3JhcGgucHJvdG90eXBlLmFkZD1mdW5jdGlvbihub2RlKXtpZihub2RlIGluc3RhbmNlb2YganN0cy5wbGFuYXJncmFwaC5FZGdlKXtyZXR1cm4gdGhpcy5hZGQyKG5vZGUpO31lbHNlIGlmKG5vZGUgaW5zdGFuY2VvZiBqc3RzLnBsYW5hcmdyYXBoLkRpcmVjdGVkRWRnZSl7cmV0dXJuIHRoaXMuYWRkMyhub2RlKTt9XG50aGlzLm5vZGVNYXAuYWRkKG5vZGUpO307UGxhbmFyR3JhcGgucHJvdG90eXBlLmFkZDI9ZnVuY3Rpb24oZWRnZSl7dGhpcy5lZGdlcy5hZGQoZWRnZSk7dGhpcy5hZGQoZWRnZS5nZXREaXJFZGdlKDApKTt0aGlzLmFkZChlZGdlLmdldERpckVkZ2UoMSkpO307UGxhbmFyR3JhcGgucHJvdG90eXBlLmFkZDM9ZnVuY3Rpb24oZGlyRWRnZSl7dGhpcy5kaXJFZGdlcy5hZGQoZGlyRWRnZSk7fTtQbGFuYXJHcmFwaC5wcm90b3R5cGUubm9kZUl0ZXJhdG9yPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMubm9kZU1hcC5pdGVyYXRvcigpO307UGxhbmFyR3JhcGgucHJvdG90eXBlLmNvbnRhaW5zPWZ1bmN0aW9uKGUpe2lmKGUgaW5zdGFuY2VvZiBqc3RzLnBsYW5hcmdyYXBoLkRpcmVjdGVkRWRnZSl7cmV0dXJuIHRoaXMuY29udGFpbnMyKGUpO31cbnJldHVybiB0aGlzLmVkZ2VzLmNvbnRhaW5zKGUpO307UGxhbmFyR3JhcGgucHJvdG90eXBlLmNvbnRhaW5zMj1mdW5jdGlvbihkZSl7cmV0dXJuIHRoaXMuZGlyRWRnZXMuY29udGFpbnMoZGUpO307UGxhbmFyR3JhcGgucHJvdG90eXBlLmdldE5vZGVzPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMubm9kZU1hcC52YWx1ZXMoKTt9O1BsYW5hckdyYXBoLnByb3RvdHlwZS5kaXJFZGdlSXRlcmF0b3I9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5kaXJFZGdlcy5pdGVyYXRvcigpO307UGxhbmFyR3JhcGgucHJvdG90eXBlLmVkZ2VJdGVyYXRvcj1mdW5jdGlvbigpe3JldHVybiB0aGlzLmVkZ2VzLml0ZXJhdG9yKCk7fTtQbGFuYXJHcmFwaC5wcm90b3R5cGUuZ2V0RWRnZXM9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5lZGdlczt9O1BsYW5hckdyYXBoLnByb3RvdHlwZS5yZW1vdmU9ZnVuY3Rpb24oZWRnZSl7aWYoZWRnZSBpbnN0YW5jZW9mIGpzdHMucGxhbmFyZ3JhcGguRGlyZWN0ZWRFZGdlKXtyZXR1cm4gdGhpcy5yZW1vdmUyKGVkZ2UpO31cbnRoaXMucmVtb3ZlKGVkZ2UuZ2V0RGlyRWRnZSgwKSk7dGhpcy5yZW1vdmUoZWRnZS5nZXREaXJFZGdlKDEpKTt0aGlzLmVkZ2VzLnJlbW92ZShlZGdlKTt0aGlzLmVkZ2UucmVtb3ZlKCk7fTtQbGFuYXJHcmFwaC5wcm90b3R5cGUucmVtb3ZlMj1mdW5jdGlvbihkZSl7aWYoZGUgaW5zdGFuY2VvZiBqc3RzLnBsYW5hcmdyYXBoLk5vZGUpe3JldHVybiB0aGlzLnJlbW92ZTMoZGUpO31cbnZhciBzeW09ZGUuZ2V0U3ltKCk7aWYoc3ltIT1udWxsKVxuc3ltLnNldFN5bShudWxsKTtkZS5nZXRGcm9tTm9kZSgpLnJlbW92ZShkZSk7ZGUucmVtb3ZlKCk7dGhpcy5kaXJFZGdlcy5yZW1vdmUoZGUpO307UGxhbmFyR3JhcGgucHJvdG90eXBlLnJlbW92ZTM9ZnVuY3Rpb24obm9kZSl7dmFyIG91dEVkZ2VzPW5vZGUuZ2V0T3V0RWRnZXMoKS5nZXRFZGdlcygpO2Zvcih2YXIgaT1vdXRFZGdlcy5pdGVyYXRvcigpO2kuaGFzTmV4dCgpOyl7dmFyIGRlPWkubmV4dCgpO3ZhciBzeW09ZGUuZ2V0U3ltKCk7aWYoc3ltIT1udWxsKVxudGhpcy5yZW1vdmUoc3ltKTt0aGlzLmRpckVkZ2VzLnJlbW92ZShkZSk7dmFyIGVkZ2U9ZGUuZ2V0RWRnZSgpO2lmKGVkZ2UhPW51bGwpe3RoaXMuZWRnZXMucmVtb3ZlKGVkZ2UpO319XG50aGlzLm5vZGVNYXAucmVtb3ZlKG5vZGUuZ2V0Q29vcmRpbmF0ZSgpKTtub2RlLnJlbW92ZSgpO307UGxhbmFyR3JhcGgucHJvdG90eXBlLmZpbmROb2Rlc09mRGVncmVlPWZ1bmN0aW9uKGRlZ3JlZSl7dmFyIG5vZGVzRm91bmQ9bmV3IEFycmF5TGlzdCgpO2Zvcih2YXIgaT10aGlzLm5vZGVJdGVyYXRvcigpO2kuaGFzTmV4dCgpOyl7dmFyIG5vZGU9aS5uZXh0KCk7aWYobm9kZS5nZXREZWdyZWUoKT09ZGVncmVlKVxubm9kZXNGb3VuZC5hZGQobm9kZSk7fVxucmV0dXJuIG5vZGVzRm91bmQ7fTtqc3RzLnBsYW5hcmdyYXBoLlBsYW5hckdyYXBoPVBsYW5hckdyYXBoO30pKCk7KGZ1bmN0aW9uKCl7dmFyIEFycmF5TGlzdD1qYXZhc2NyaXB0LnV0aWwuQXJyYXlMaXN0O3ZhciBTdGFjaz1qYXZhc2NyaXB0LnV0aWwuU3RhY2s7dmFyIEhhc2hTZXQ9amF2YXNjcmlwdC51dGlsLkhhc2hTZXQ7dmFyIEFzc2VydD1qc3RzLnV0aWwuQXNzZXJ0O3ZhciBFZGdlUmluZz1qc3RzLm9wZXJhdGlvbi5wb2x5Z29uaXplLkVkZ2VSaW5nO3ZhciBQb2x5Z29uaXplRWRnZT1qc3RzLm9wZXJhdGlvbi5wb2x5Z29uaXplLlBvbHlnb25pemVFZGdlO3ZhciBQb2x5Z29uaXplRGlyZWN0ZWRFZGdlPWpzdHMub3BlcmF0aW9uLnBvbHlnb25pemUuUG9seWdvbml6ZURpcmVjdGVkRWRnZTt2YXIgUGxhbmFyR3JhcGg9anN0cy5wbGFuYXJncmFwaC5QbGFuYXJHcmFwaDt2YXIgTm9kZT1qc3RzLnBsYW5hcmdyYXBoLk5vZGU7dmFyIFBvbHlnb25pemVHcmFwaD1mdW5jdGlvbihmYWN0b3J5KXtQbGFuYXJHcmFwaC5hcHBseSh0aGlzKTt0aGlzLmZhY3Rvcnk9ZmFjdG9yeTt9O1BvbHlnb25pemVHcmFwaC5wcm90b3R5cGU9bmV3IFBsYW5hckdyYXBoKCk7UG9seWdvbml6ZUdyYXBoLmdldERlZ3JlZU5vbkRlbGV0ZWQ9ZnVuY3Rpb24obm9kZSl7dmFyIGVkZ2VzPW5vZGUuZ2V0T3V0RWRnZXMoKS5nZXRFZGdlcygpO3ZhciBkZWdyZWU9MDtmb3IodmFyIGk9ZWRnZXMuaXRlcmF0b3IoKTtpLmhhc05leHQoKTspe3ZhciBkZT1pLm5leHQoKTtpZighZGUuaXNNYXJrZWQoKSlcbmRlZ3JlZSsrO31cbnJldHVybiBkZWdyZWU7fTtQb2x5Z29uaXplR3JhcGguZ2V0RGVncmVlPWZ1bmN0aW9uKG5vZGUsbGFiZWwpe3ZhciBlZGdlcz1ub2RlLmdldE91dEVkZ2VzKCkuZ2V0RWRnZXMoKTt2YXIgZGVncmVlPTA7Zm9yKHZhciBpPWVkZ2VzLml0ZXJhdG9yKCk7aS5oYXNOZXh0KCk7KXt2YXIgZGU9aS5uZXh0KCk7aWYoZGUuZ2V0TGFiZWwoKT09bGFiZWwpXG5kZWdyZWUrKzt9XG5yZXR1cm4gZGVncmVlO307UG9seWdvbml6ZUdyYXBoLmRlbGV0ZUFsbEVkZ2VzPWZ1bmN0aW9uKG5vZGUpe3ZhciBlZGdlcz1ub2RlLmdldE91dEVkZ2VzKCkuZ2V0RWRnZXMoKTtmb3IodmFyIGk9ZWRnZXMuaXRlcmF0b3IoKTtpLmhhc05leHQoKTspe3ZhciBkZT1pLm5leHQoKTtkZS5zZXRNYXJrZWQodHJ1ZSk7dmFyIHN5bT1kZS5nZXRTeW0oKTtpZihzeW0hPW51bGwpXG5zeW0uc2V0TWFya2VkKHRydWUpO319O1BvbHlnb25pemVHcmFwaC5wcm90b3R5cGUuZmFjdG9yeT1udWxsO1BvbHlnb25pemVHcmFwaC5wcm90b3R5cGUuYWRkRWRnZT1mdW5jdGlvbihsaW5lKXtpZihsaW5lLmlzRW1wdHkoKSl7cmV0dXJuO31cbnZhciBsaW5lUHRzPWpzdHMuZ2VvbS5Db29yZGluYXRlQXJyYXlzLnJlbW92ZVJlcGVhdGVkUG9pbnRzKGxpbmUuZ2V0Q29vcmRpbmF0ZXMoKSk7aWYobGluZVB0cy5sZW5ndGg8Mil7cmV0dXJuO31cbnZhciBzdGFydFB0PWxpbmVQdHNbMF07dmFyIGVuZFB0PWxpbmVQdHNbbGluZVB0cy5sZW5ndGgtMV07dmFyIG5TdGFydD10aGlzLmdldE5vZGUoc3RhcnRQdCk7dmFyIG5FbmQ9dGhpcy5nZXROb2RlKGVuZFB0KTt2YXIgZGUwPW5ldyBQb2x5Z29uaXplRGlyZWN0ZWRFZGdlKG5TdGFydCxuRW5kLGxpbmVQdHNbMV0sdHJ1ZSk7dmFyIGRlMT1uZXcgUG9seWdvbml6ZURpcmVjdGVkRWRnZShuRW5kLG5TdGFydCxsaW5lUHRzW2xpbmVQdHMubGVuZ3RoLTJdLGZhbHNlKTt2YXIgZWRnZT1uZXcgUG9seWdvbml6ZUVkZ2UobGluZSk7ZWRnZS5zZXREaXJlY3RlZEVkZ2VzKGRlMCxkZTEpO3RoaXMuYWRkKGVkZ2UpO307UG9seWdvbml6ZUdyYXBoLnByb3RvdHlwZS5nZXROb2RlPWZ1bmN0aW9uKHB0KXt2YXIgbm9kZT10aGlzLmZpbmROb2RlKHB0KTtpZihub2RlPT1udWxsKXtub2RlPW5ldyBOb2RlKHB0KTt0aGlzLmFkZChub2RlKTt9XG5yZXR1cm4gbm9kZTt9O1BvbHlnb25pemVHcmFwaC5wcm90b3R5cGUuY29tcHV0ZU5leHRDV0VkZ2VzPWZ1bmN0aW9uKCl7Zm9yKHZhciBpTm9kZT10aGlzLm5vZGVJdGVyYXRvcigpO2lOb2RlLmhhc05leHQoKTspe3ZhciBub2RlPWlOb2RlLm5leHQoKTtQb2x5Z29uaXplR3JhcGguY29tcHV0ZU5leHRDV0VkZ2VzKG5vZGUpO319O1BvbHlnb25pemVHcmFwaC5wcm90b3R5cGUuY29udmVydE1heGltYWxUb01pbmltYWxFZGdlUmluZ3M9ZnVuY3Rpb24ocmluZ0VkZ2VzKXtmb3IodmFyIGk9cmluZ0VkZ2VzLml0ZXJhdG9yKCk7aS5oYXNOZXh0KCk7KXt2YXIgZGU9aS5uZXh0KCk7dmFyIGxhYmVsPWRlLmdldExhYmVsKCk7dmFyIGludE5vZGVzPVBvbHlnb25pemVHcmFwaC5maW5kSW50ZXJzZWN0aW9uTm9kZXMoZGUsbGFiZWwpO2lmKGludE5vZGVzPT1udWxsKVxuY29udGludWU7Zm9yKHZhciBpTm9kZT1pbnROb2Rlcy5pdGVyYXRvcigpO2lOb2RlLmhhc05leHQoKTspe3ZhciBub2RlPWlOb2RlLm5leHQoKTtQb2x5Z29uaXplR3JhcGguY29tcHV0ZU5leHRDQ1dFZGdlcyhub2RlLGxhYmVsKTt9fX07UG9seWdvbml6ZUdyYXBoLmZpbmRJbnRlcnNlY3Rpb25Ob2Rlcz1mdW5jdGlvbihzdGFydERFLGxhYmVsKXt2YXIgZGU9c3RhcnRERTt2YXIgaW50Tm9kZXM9bnVsbDtkb3t2YXIgbm9kZT1kZS5nZXRGcm9tTm9kZSgpO2lmKFBvbHlnb25pemVHcmFwaC5nZXREZWdyZWUobm9kZSxsYWJlbCk+MSl7aWYoaW50Tm9kZXM9PW51bGwpXG5pbnROb2Rlcz1uZXcgQXJyYXlMaXN0KCk7aW50Tm9kZXMuYWRkKG5vZGUpO31cbmRlPWRlLmdldE5leHQoKTtBc3NlcnQuaXNUcnVlKGRlIT1udWxsLCdmb3VuZCBudWxsIERFIGluIHJpbmcnKTtBc3NlcnQuaXNUcnVlKGRlPT1zdGFydERFfHwhZGUuaXNJblJpbmcoKSwnZm91bmQgREUgYWxyZWFkeSBpbiByaW5nJyk7fXdoaWxlKGRlIT1zdGFydERFKTtyZXR1cm4gaW50Tm9kZXM7fTtQb2x5Z29uaXplR3JhcGgucHJvdG90eXBlLmdldEVkZ2VSaW5ncz1mdW5jdGlvbigpe3RoaXMuY29tcHV0ZU5leHRDV0VkZ2VzKCk7UG9seWdvbml6ZUdyYXBoLmxhYmVsKHRoaXMuZGlyRWRnZXMsLTEpO3ZhciBtYXhpbWFsUmluZ3M9UG9seWdvbml6ZUdyYXBoLmZpbmRMYWJlbGVkRWRnZVJpbmdzKHRoaXMuZGlyRWRnZXMpO3RoaXMuY29udmVydE1heGltYWxUb01pbmltYWxFZGdlUmluZ3MobWF4aW1hbFJpbmdzKTt2YXIgZWRnZVJpbmdMaXN0PW5ldyBBcnJheUxpc3QoKTtmb3IodmFyIGk9dGhpcy5kaXJFZGdlcy5pdGVyYXRvcigpO2kuaGFzTmV4dCgpOyl7dmFyIGRlPWkubmV4dCgpO2lmKGRlLmlzTWFya2VkKCkpXG5jb250aW51ZTtpZihkZS5pc0luUmluZygpKVxuY29udGludWU7dmFyIGVyPXRoaXMuZmluZEVkZ2VSaW5nKGRlKTtlZGdlUmluZ0xpc3QuYWRkKGVyKTt9XG5yZXR1cm4gZWRnZVJpbmdMaXN0O307UG9seWdvbml6ZUdyYXBoLmZpbmRMYWJlbGVkRWRnZVJpbmdzPWZ1bmN0aW9uKGRpckVkZ2VzKXt2YXIgZWRnZVJpbmdTdGFydHM9bmV3IEFycmF5TGlzdCgpO3ZhciBjdXJyTGFiZWw9MTtmb3IodmFyIGk9ZGlyRWRnZXMuaXRlcmF0b3IoKTtpLmhhc05leHQoKTspe3ZhciBkZT1pLm5leHQoKTtpZihkZS5pc01hcmtlZCgpKVxuY29udGludWU7aWYoZGUuZ2V0TGFiZWwoKT49MClcbmNvbnRpbnVlO2VkZ2VSaW5nU3RhcnRzLmFkZChkZSk7dmFyIGVkZ2VzPVBvbHlnb25pemVHcmFwaC5maW5kRGlyRWRnZXNJblJpbmcoZGUpO1BvbHlnb25pemVHcmFwaC5sYWJlbChlZGdlcyxjdXJyTGFiZWwpO2N1cnJMYWJlbCsrO31cbnJldHVybiBlZGdlUmluZ1N0YXJ0czt9O1BvbHlnb25pemVHcmFwaC5wcm90b3R5cGUuZGVsZXRlQ3V0RWRnZXM9ZnVuY3Rpb24oKXt0aGlzLmNvbXB1dGVOZXh0Q1dFZGdlcygpO1BvbHlnb25pemVHcmFwaC5maW5kTGFiZWxlZEVkZ2VSaW5ncyh0aGlzLmRpckVkZ2VzKTt2YXIgY3V0TGluZXM9bmV3IEFycmF5TGlzdCgpO2Zvcih2YXIgaT10aGlzLmRpckVkZ2VzLml0ZXJhdG9yKCk7aS5oYXNOZXh0KCk7KXt2YXIgZGU9aS5uZXh0KCk7aWYoZGUuaXNNYXJrZWQoKSlcbmNvbnRpbnVlO3ZhciBzeW09ZGUuZ2V0U3ltKCk7aWYoZGUuZ2V0TGFiZWwoKT09c3ltLmdldExhYmVsKCkpe2RlLnNldE1hcmtlZCh0cnVlKTtzeW0uc2V0TWFya2VkKHRydWUpO3ZhciBlPWRlLmdldEVkZ2UoKTtjdXRMaW5lcy5hZGQoZS5nZXRMaW5lKCkpO319XG5yZXR1cm4gY3V0TGluZXM7fTtQb2x5Z29uaXplR3JhcGgubGFiZWw9ZnVuY3Rpb24oZGlyRWRnZXMsbGFiZWwpe2Zvcih2YXIgaT1kaXJFZGdlcy5pdGVyYXRvcigpO2kuaGFzTmV4dCgpOyl7dmFyIGRlPWkubmV4dCgpO2RlLnNldExhYmVsKGxhYmVsKTt9fTtQb2x5Z29uaXplR3JhcGguY29tcHV0ZU5leHRDV0VkZ2VzPWZ1bmN0aW9uKG5vZGUpe3ZhciBkZVN0YXI9bm9kZS5nZXRPdXRFZGdlcygpO3ZhciBzdGFydERFPW51bGw7dmFyIHByZXZERT1udWxsO2Zvcih2YXIgaT1kZVN0YXIuZ2V0RWRnZXMoKS5pdGVyYXRvcigpO2kuaGFzTmV4dCgpOyl7dmFyIG91dERFPWkubmV4dCgpO2lmKG91dERFLmlzTWFya2VkKCkpXG5jb250aW51ZTtpZihzdGFydERFPT1udWxsKVxuc3RhcnRERT1vdXRERTtpZihwcmV2REUhPW51bGwpe3ZhciBzeW09cHJldkRFLmdldFN5bSgpO3N5bS5zZXROZXh0KG91dERFKTt9XG5wcmV2REU9b3V0REU7fVxuaWYocHJldkRFIT1udWxsKXt2YXIgc3ltPXByZXZERS5nZXRTeW0oKTtzeW0uc2V0TmV4dChzdGFydERFKTt9fTtQb2x5Z29uaXplR3JhcGguY29tcHV0ZU5leHRDQ1dFZGdlcz1mdW5jdGlvbihub2RlLGxhYmVsKXt2YXIgZGVTdGFyPW5vZGUuZ2V0T3V0RWRnZXMoKTt2YXIgZmlyc3RPdXRERT1udWxsO3ZhciBwcmV2SW5ERT1udWxsO3ZhciBlZGdlcz1kZVN0YXIuZ2V0RWRnZXMoKTtmb3IodmFyIGk9ZWRnZXMuc2l6ZSgpLTE7aT49MDtpLS0pe3ZhciBkZT1lZGdlcy5nZXQoaSk7dmFyIHN5bT1kZS5nZXRTeW0oKTt2YXIgb3V0REU9bnVsbDtpZihkZS5nZXRMYWJlbCgpPT1sYWJlbClcbm91dERFPWRlO3ZhciBpbkRFPW51bGw7aWYoc3ltLmdldExhYmVsKCk9PWxhYmVsKVxuaW5ERT1zeW07aWYob3V0REU9PW51bGwmJmluREU9PW51bGwpXG5jb250aW51ZTtpZihpbkRFIT1udWxsKXtwcmV2SW5ERT1pbkRFO31cbmlmKG91dERFIT1udWxsKXtpZihwcmV2SW5ERSE9bnVsbCl7cHJldkluREUuc2V0TmV4dChvdXRERSk7cHJldkluREU9bnVsbDt9XG5pZihmaXJzdE91dERFPT1udWxsKVxuZmlyc3RPdXRERT1vdXRERTt9fVxuaWYocHJldkluREUhPW51bGwpe0Fzc2VydC5pc1RydWUoZmlyc3RPdXRERSE9bnVsbCk7cHJldkluREUuc2V0TmV4dChmaXJzdE91dERFKTt9fTtQb2x5Z29uaXplR3JhcGguZmluZERpckVkZ2VzSW5SaW5nPWZ1bmN0aW9uKHN0YXJ0REUpe3ZhciBkZT1zdGFydERFO3ZhciBlZGdlcz1uZXcgQXJyYXlMaXN0KCk7ZG97ZWRnZXMuYWRkKGRlKTtkZT1kZS5nZXROZXh0KCk7QXNzZXJ0LmlzVHJ1ZShkZSE9bnVsbCwnZm91bmQgbnVsbCBERSBpbiByaW5nJyk7QXNzZXJ0LmlzVHJ1ZShkZT09c3RhcnRERXx8IWRlLmlzSW5SaW5nKCksJ2ZvdW5kIERFIGFscmVhZHkgaW4gcmluZycpO313aGlsZShkZSE9c3RhcnRERSk7cmV0dXJuIGVkZ2VzO307UG9seWdvbml6ZUdyYXBoLnByb3RvdHlwZS5maW5kRWRnZVJpbmc9ZnVuY3Rpb24oc3RhcnRERSl7dmFyIGRlPXN0YXJ0REU7dmFyIGVyPW5ldyBFZGdlUmluZyh0aGlzLmZhY3RvcnkpO2Rve2VyLmFkZChkZSk7ZGUuc2V0UmluZyhlcik7ZGU9ZGUuZ2V0TmV4dCgpO0Fzc2VydC5pc1RydWUoZGUhPW51bGwsJ2ZvdW5kIG51bGwgREUgaW4gcmluZycpO0Fzc2VydC5pc1RydWUoZGU9PXN0YXJ0REV8fCFkZS5pc0luUmluZygpLCdmb3VuZCBERSBhbHJlYWR5IGluIHJpbmcnKTt9d2hpbGUoZGUhPXN0YXJ0REUpO3JldHVybiBlcjt9O1BvbHlnb25pemVHcmFwaC5wcm90b3R5cGUuZGVsZXRlRGFuZ2xlcz1mdW5jdGlvbigpe3ZhciBub2Rlc1RvUmVtb3ZlPXRoaXMuZmluZE5vZGVzT2ZEZWdyZWUoMSk7dmFyIGRhbmdsZUxpbmVzPW5ldyBIYXNoU2V0KCk7dmFyIG5vZGVTdGFjaz1uZXcgU3RhY2soKTtmb3IodmFyIGk9bm9kZXNUb1JlbW92ZS5pdGVyYXRvcigpO2kuaGFzTmV4dCgpOyl7bm9kZVN0YWNrLnB1c2goaS5uZXh0KCkpO31cbndoaWxlKCFub2RlU3RhY2suaXNFbXB0eSgpKXt2YXIgbm9kZT1ub2RlU3RhY2sucG9wKCk7UG9seWdvbml6ZUdyYXBoLmRlbGV0ZUFsbEVkZ2VzKG5vZGUpO3ZhciBub2RlT3V0RWRnZXM9bm9kZS5nZXRPdXRFZGdlcygpLmdldEVkZ2VzKCk7Zm9yKHZhciBpPW5vZGVPdXRFZGdlcy5pdGVyYXRvcigpO2kuaGFzTmV4dCgpOyl7dmFyIGRlPWkubmV4dCgpO2RlLnNldE1hcmtlZCh0cnVlKTt2YXIgc3ltPWRlLmdldFN5bSgpO2lmKHN5bSE9bnVsbClcbnN5bS5zZXRNYXJrZWQodHJ1ZSk7dmFyIGU9ZGUuZ2V0RWRnZSgpO2RhbmdsZUxpbmVzLmFkZChlLmdldExpbmUoKSk7dmFyIHRvTm9kZT1kZS5nZXRUb05vZGUoKTtpZihQb2x5Z29uaXplR3JhcGguZ2V0RGVncmVlTm9uRGVsZXRlZCh0b05vZGUpPT0xKVxubm9kZVN0YWNrLnB1c2godG9Ob2RlKTt9fVxucmV0dXJuIGRhbmdsZUxpbmVzO307UG9seWdvbml6ZUdyYXBoLnByb3RvdHlwZS5jb21wdXRlRGVwdGhQYXJpdHk9ZnVuY3Rpb24oKXt3aGlsZSh0cnVlKXt2YXIgZGU9bnVsbDtpZihkZT09bnVsbClcbnJldHVybjt0aGlzLmNvbXB1dGVEZXB0aFBhcml0eShkZSk7fX07UG9seWdvbml6ZUdyYXBoLnByb3RvdHlwZS5jb21wdXRlRGVwdGhQYXJpdHk9ZnVuY3Rpb24oZGUpe307anN0cy5vcGVyYXRpb24ucG9seWdvbml6ZS5Qb2x5Z29uaXplR3JhcGg9UG9seWdvbml6ZUdyYXBoO30pKCk7anN0cy5pbmRleC5zdHJ0cmVlLkludGVydmFsPWZ1bmN0aW9uKCl7dmFyIG90aGVyO2lmKGFyZ3VtZW50cy5sZW5ndGg9PT0xKXtvdGhlcj1hcmd1bWVudHNbMF07cmV0dXJuIGpzdHMuaW5kZXguc3RydHJlZS5JbnRlcnZhbChvdGhlci5taW4sb3RoZXIubWF4KTt9ZWxzZSBpZihhcmd1bWVudHMubGVuZ3RoPT09Mil7anN0cy51dGlsLkFzc2VydC5pc1RydWUodGhpcy5taW48PXRoaXMubWF4KTt0aGlzLm1pbj1hcmd1bWVudHNbMF07dGhpcy5tYXg9YXJndW1lbnRzWzFdO319O2pzdHMuaW5kZXguc3RydHJlZS5JbnRlcnZhbC5wcm90b3R5cGUubWluPW51bGw7anN0cy5pbmRleC5zdHJ0cmVlLkludGVydmFsLnByb3RvdHlwZS5tYXg9bnVsbDtqc3RzLmluZGV4LnN0cnRyZWUuSW50ZXJ2YWwucHJvdG90eXBlLmdldENlbnRyZT1mdW5jdGlvbigpe3JldHVybih0aGlzLm1pbit0aGlzLm1heCkvMjt9O2pzdHMuaW5kZXguc3RydHJlZS5JbnRlcnZhbC5wcm90b3R5cGUuZXhwYW5kVG9JbmNsdWRlPWZ1bmN0aW9uKG90aGVyKXt0aGlzLm1heD1NYXRoLm1heCh0aGlzLm1heCxvdGhlci5tYXgpO3RoaXMubWluPU1hdGgubWluKHRoaXMubWluLG90aGVyLm1pbik7cmV0dXJuIHRoaXM7fTtqc3RzLmluZGV4LnN0cnRyZWUuSW50ZXJ2YWwucHJvdG90eXBlLmludGVyc2VjdHM9ZnVuY3Rpb24ob3RoZXIpe3JldHVybiEob3RoZXIubWluPnRoaXMubWF4fHxvdGhlci5tYXg8dGhpcy5taW4pO307anN0cy5pbmRleC5zdHJ0cmVlLkludGVydmFsLnByb3RvdHlwZS5lcXVhbHM9ZnVuY3Rpb24obyl7aWYoIShvIGluc3RhbmNlb2YganN0cy5pbmRleC5zdHJ0cmVlLkludGVydmFsKSl7cmV0dXJuIGZhbHNlO31cbm90aGVyPW87cmV0dXJuIHRoaXMubWluPT09b3RoZXIubWluJiZ0aGlzLm1heD09PW90aGVyLm1heDt9O2pzdHMuZ2VvbS5HZW9tZXRyeUZhY3Rvcnk9ZnVuY3Rpb24ocHJlY2lzaW9uTW9kZWwpe3RoaXMucHJlY2lzaW9uTW9kZWw9cHJlY2lzaW9uTW9kZWx8fG5ldyBqc3RzLmdlb20uUHJlY2lzaW9uTW9kZWwoKTt9O2pzdHMuZ2VvbS5HZW9tZXRyeUZhY3RvcnkucHJvdG90eXBlLnByZWNpc2lvbk1vZGVsPW51bGw7anN0cy5nZW9tLkdlb21ldHJ5RmFjdG9yeS5wcm90b3R5cGUuZ2V0UHJlY2lzaW9uTW9kZWw9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5wcmVjaXNpb25Nb2RlbDt9O2pzdHMuZ2VvbS5HZW9tZXRyeUZhY3RvcnkucHJvdG90eXBlLmNyZWF0ZVBvaW50PWZ1bmN0aW9uKGNvb3JkaW5hdGUpe3ZhciBwb2ludD1uZXcganN0cy5nZW9tLlBvaW50KGNvb3JkaW5hdGUsdGhpcyk7cmV0dXJuIHBvaW50O307anN0cy5nZW9tLkdlb21ldHJ5RmFjdG9yeS5wcm90b3R5cGUuY3JlYXRlTGluZVN0cmluZz1mdW5jdGlvbihjb29yZGluYXRlcyl7dmFyIGxpbmVTdHJpbmc9bmV3IGpzdHMuZ2VvbS5MaW5lU3RyaW5nKGNvb3JkaW5hdGVzLHRoaXMpO3JldHVybiBsaW5lU3RyaW5nO307anN0cy5nZW9tLkdlb21ldHJ5RmFjdG9yeS5wcm90b3R5cGUuY3JlYXRlTGluZWFyUmluZz1mdW5jdGlvbihjb29yZGluYXRlcyl7dmFyIGxpbmVhclJpbmc9bmV3IGpzdHMuZ2VvbS5MaW5lYXJSaW5nKGNvb3JkaW5hdGVzLHRoaXMpO3JldHVybiBsaW5lYXJSaW5nO307anN0cy5nZW9tLkdlb21ldHJ5RmFjdG9yeS5wcm90b3R5cGUuY3JlYXRlUG9seWdvbj1mdW5jdGlvbihzaGVsbCxob2xlcyl7dmFyIHBvbHlnb249bmV3IGpzdHMuZ2VvbS5Qb2x5Z29uKHNoZWxsLGhvbGVzLHRoaXMpO3JldHVybiBwb2x5Z29uO307anN0cy5nZW9tLkdlb21ldHJ5RmFjdG9yeS5wcm90b3R5cGUuY3JlYXRlTXVsdGlQb2ludD1mdW5jdGlvbihwb2ludHMpe2lmKHBvaW50cyYmcG9pbnRzWzBdaW5zdGFuY2VvZiBqc3RzLmdlb20uQ29vcmRpbmF0ZSl7dmFyIGNvbnZlcnRlZD1bXTt2YXIgaTtmb3IoaT0wO2k8cG9pbnRzLmxlbmd0aDtpKyspe2NvbnZlcnRlZC5wdXNoKHRoaXMuY3JlYXRlUG9pbnQocG9pbnRzW2ldKSk7fVxucG9pbnRzPWNvbnZlcnRlZDt9XG5yZXR1cm4gbmV3IGpzdHMuZ2VvbS5NdWx0aVBvaW50KHBvaW50cyx0aGlzKTt9O2pzdHMuZ2VvbS5HZW9tZXRyeUZhY3RvcnkucHJvdG90eXBlLmNyZWF0ZU11bHRpTGluZVN0cmluZz1mdW5jdGlvbihsaW5lU3RyaW5ncyl7cmV0dXJuIG5ldyBqc3RzLmdlb20uTXVsdGlMaW5lU3RyaW5nKGxpbmVTdHJpbmdzLHRoaXMpO307anN0cy5nZW9tLkdlb21ldHJ5RmFjdG9yeS5wcm90b3R5cGUuY3JlYXRlTXVsdGlQb2x5Z29uPWZ1bmN0aW9uKHBvbHlnb25zKXtyZXR1cm4gbmV3IGpzdHMuZ2VvbS5NdWx0aVBvbHlnb24ocG9seWdvbnMsdGhpcyk7fTtqc3RzLmdlb20uR2VvbWV0cnlGYWN0b3J5LnByb3RvdHlwZS5idWlsZEdlb21ldHJ5PWZ1bmN0aW9uKGdlb21MaXN0KXt2YXIgZ2VvbUNsYXNzPW51bGw7dmFyIGlzSGV0ZXJvZ2VuZW91cz1mYWxzZTt2YXIgaGFzR2VvbWV0cnlDb2xsZWN0aW9uPWZhbHNlO2Zvcih2YXIgaT1nZW9tTGlzdC5pdGVyYXRvcigpO2kuaGFzTmV4dCgpOyl7dmFyIGdlb209aS5uZXh0KCk7dmFyIHBhcnRDbGFzcz1nZW9tLkNMQVNTX05BTUU7aWYoZ2VvbUNsYXNzPT09bnVsbCl7Z2VvbUNsYXNzPXBhcnRDbGFzczt9XG5pZighKHBhcnRDbGFzcz09PWdlb21DbGFzcykpe2lzSGV0ZXJvZ2VuZW91cz10cnVlO31cbmlmKGdlb20uaXNHZW9tZXRyeUNvbGxlY3Rpb25CYXNlKCkpXG5oYXNHZW9tZXRyeUNvbGxlY3Rpb249dHJ1ZTt9XG5pZihnZW9tQ2xhc3M9PT1udWxsKXtyZXR1cm4gdGhpcy5jcmVhdGVHZW9tZXRyeUNvbGxlY3Rpb24obnVsbCk7fVxuaWYoaXNIZXRlcm9nZW5lb3VzfHxoYXNHZW9tZXRyeUNvbGxlY3Rpb24pe3JldHVybiB0aGlzLmNyZWF0ZUdlb21ldHJ5Q29sbGVjdGlvbihnZW9tTGlzdC50b0FycmF5KCkpO31cbnZhciBnZW9tMD1nZW9tTGlzdC5nZXQoMCk7dmFyIGlzQ29sbGVjdGlvbj1nZW9tTGlzdC5zaXplKCk+MTtpZihpc0NvbGxlY3Rpb24pe2lmKGdlb20wIGluc3RhbmNlb2YganN0cy5nZW9tLlBvbHlnb24pe3JldHVybiB0aGlzLmNyZWF0ZU11bHRpUG9seWdvbihnZW9tTGlzdC50b0FycmF5KCkpO31lbHNlIGlmKGdlb20wIGluc3RhbmNlb2YganN0cy5nZW9tLkxpbmVTdHJpbmcpe3JldHVybiB0aGlzLmNyZWF0ZU11bHRpTGluZVN0cmluZyhnZW9tTGlzdC50b0FycmF5KCkpO31lbHNlIGlmKGdlb20wIGluc3RhbmNlb2YganN0cy5nZW9tLlBvaW50KXtyZXR1cm4gdGhpcy5jcmVhdGVNdWx0aVBvaW50KGdlb21MaXN0LnRvQXJyYXkoKSk7fVxuanN0cy51dGlsLkFzc2VydC5zaG91bGROZXZlclJlYWNoSGVyZSgnVW5oYW5kbGVkIGNsYXNzOiAnK2dlb20wKTt9XG5yZXR1cm4gZ2VvbTA7fTtqc3RzLmdlb20uR2VvbWV0cnlGYWN0b3J5LnByb3RvdHlwZS5jcmVhdGVHZW9tZXRyeUNvbGxlY3Rpb249ZnVuY3Rpb24oZ2VvbWV0cmllcyl7cmV0dXJuIG5ldyBqc3RzLmdlb20uR2VvbWV0cnlDb2xsZWN0aW9uKGdlb21ldHJpZXMsdGhpcyk7fTtqc3RzLmdlb20uR2VvbWV0cnlGYWN0b3J5LnByb3RvdHlwZS50b0dlb21ldHJ5PWZ1bmN0aW9uKGVudmVsb3BlKXtpZihlbnZlbG9wZS5pc051bGwoKSl7cmV0dXJuIHRoaXMuY3JlYXRlUG9pbnQobnVsbCk7fVxuaWYoZW52ZWxvcGUuZ2V0TWluWCgpPT09ZW52ZWxvcGUuZ2V0TWF4WCgpJiZlbnZlbG9wZS5nZXRNaW5ZKCk9PT1lbnZlbG9wZS5nZXRNYXhZKCkpe3JldHVybiB0aGlzLmNyZWF0ZVBvaW50KG5ldyBqc3RzLmdlb20uQ29vcmRpbmF0ZShlbnZlbG9wZS5nZXRNaW5YKCksZW52ZWxvcGUuZ2V0TWluWSgpKSk7fVxuaWYoZW52ZWxvcGUuZ2V0TWluWCgpPT09ZW52ZWxvcGUuZ2V0TWF4WCgpfHxlbnZlbG9wZS5nZXRNaW5ZKCk9PT1lbnZlbG9wZS5nZXRNYXhZKCkpe3JldHVybiB0aGlzLmNyZWF0ZUxpbmVTdHJpbmcoW25ldyBqc3RzLmdlb20uQ29vcmRpbmF0ZShlbnZlbG9wZS5nZXRNaW5YKCksZW52ZWxvcGUuZ2V0TWluWSgpKSxuZXcganN0cy5nZW9tLkNvb3JkaW5hdGUoZW52ZWxvcGUuZ2V0TWF4WCgpLGVudmVsb3BlLmdldE1heFkoKSldKTt9XG5yZXR1cm4gdGhpcy5jcmVhdGVQb2x5Z29uKHRoaXMuY3JlYXRlTGluZWFyUmluZyhbbmV3IGpzdHMuZ2VvbS5Db29yZGluYXRlKGVudmVsb3BlLmdldE1pblgoKSxlbnZlbG9wZS5nZXRNaW5ZKCkpLG5ldyBqc3RzLmdlb20uQ29vcmRpbmF0ZShlbnZlbG9wZS5nZXRNaW5YKCksZW52ZWxvcGUuZ2V0TWF4WSgpKSxuZXcganN0cy5nZW9tLkNvb3JkaW5hdGUoZW52ZWxvcGUuZ2V0TWF4WCgpLGVudmVsb3BlLmdldE1heFkoKSksbmV3IGpzdHMuZ2VvbS5Db29yZGluYXRlKGVudmVsb3BlLmdldE1heFgoKSxlbnZlbG9wZS5nZXRNaW5ZKCkpLG5ldyBqc3RzLmdlb20uQ29vcmRpbmF0ZShlbnZlbG9wZS5nZXRNaW5YKCksZW52ZWxvcGUuZ2V0TWluWSgpKV0pLG51bGwpO307anN0cy5nZW9tZ3JhcGguTm9kZUZhY3Rvcnk9ZnVuY3Rpb24oKXt9O2pzdHMuZ2VvbWdyYXBoLk5vZGVGYWN0b3J5LnByb3RvdHlwZS5jcmVhdGVOb2RlPWZ1bmN0aW9uKGNvb3JkKXtyZXR1cm4gbmV3IGpzdHMuZ2VvbWdyYXBoLk5vZGUoY29vcmQsbnVsbCk7fTsoZnVuY3Rpb24oKXtqc3RzLmdlb21ncmFwaC5Qb3NpdGlvbj1mdW5jdGlvbigpe307anN0cy5nZW9tZ3JhcGguUG9zaXRpb24uT049MDtqc3RzLmdlb21ncmFwaC5Qb3NpdGlvbi5MRUZUPTE7anN0cy5nZW9tZ3JhcGguUG9zaXRpb24uUklHSFQ9Mjtqc3RzLmdlb21ncmFwaC5Qb3NpdGlvbi5vcHBvc2l0ZT1mdW5jdGlvbihwb3NpdGlvbil7aWYocG9zaXRpb249PT1qc3RzLmdlb21ncmFwaC5Qb3NpdGlvbi5MRUZUKXtyZXR1cm4ganN0cy5nZW9tZ3JhcGguUG9zaXRpb24uUklHSFQ7fVxuaWYocG9zaXRpb249PT1qc3RzLmdlb21ncmFwaC5Qb3NpdGlvbi5SSUdIVCl7cmV0dXJuIGpzdHMuZ2VvbWdyYXBoLlBvc2l0aW9uLkxFRlQ7fVxucmV0dXJuIHBvc2l0aW9uO307fSkoKTtqc3RzLmdlb21ncmFwaC5Ub3BvbG9neUxvY2F0aW9uPWZ1bmN0aW9uKCl7dGhpcy5sb2NhdGlvbj1bXTtpZihhcmd1bWVudHMubGVuZ3RoPT09Myl7dmFyIG9uPWFyZ3VtZW50c1swXTt2YXIgbGVmdD1hcmd1bWVudHNbMV07dmFyIHJpZ2h0PWFyZ3VtZW50c1syXTt0aGlzLmluaXQoMyk7dGhpcy5sb2NhdGlvbltqc3RzLmdlb21ncmFwaC5Qb3NpdGlvbi5PTl09b247dGhpcy5sb2NhdGlvbltqc3RzLmdlb21ncmFwaC5Qb3NpdGlvbi5MRUZUXT1sZWZ0O3RoaXMubG9jYXRpb25banN0cy5nZW9tZ3JhcGguUG9zaXRpb24uUklHSFRdPXJpZ2h0O31lbHNlIGlmKGFyZ3VtZW50c1swXWluc3RhbmNlb2YganN0cy5nZW9tZ3JhcGguVG9wb2xvZ3lMb2NhdGlvbil7dmFyIGdsPWFyZ3VtZW50c1swXTt0aGlzLmluaXQoZ2wubG9jYXRpb24ubGVuZ3RoKTtpZihnbCE9bnVsbCl7Zm9yKHZhciBpPTA7aTx0aGlzLmxvY2F0aW9uLmxlbmd0aDtpKyspe3RoaXMubG9jYXRpb25baV09Z2wubG9jYXRpb25baV07fX19ZWxzZSBpZih0eXBlb2YgYXJndW1lbnRzWzBdPT09J251bWJlcicpe3ZhciBvbj1hcmd1bWVudHNbMF07dGhpcy5pbml0KDEpO3RoaXMubG9jYXRpb25banN0cy5nZW9tZ3JhcGguUG9zaXRpb24uT05dPW9uO31lbHNlIGlmKGFyZ3VtZW50c1swXWluc3RhbmNlb2YgQXJyYXkpe3ZhciBsb2NhdGlvbj1hcmd1bWVudHNbMF07dGhpcy5pbml0KGxvY2F0aW9uLmxlbmd0aCk7fX07anN0cy5nZW9tZ3JhcGguVG9wb2xvZ3lMb2NhdGlvbi5wcm90b3R5cGUubG9jYXRpb249bnVsbDtqc3RzLmdlb21ncmFwaC5Ub3BvbG9neUxvY2F0aW9uLnByb3RvdHlwZS5pbml0PWZ1bmN0aW9uKHNpemUpe3RoaXMubG9jYXRpb25bc2l6ZS0xXT1udWxsO3RoaXMuc2V0QWxsTG9jYXRpb25zKGpzdHMuZ2VvbS5Mb2NhdGlvbi5OT05FKTt9O2pzdHMuZ2VvbWdyYXBoLlRvcG9sb2d5TG9jYXRpb24ucHJvdG90eXBlLmdldD1mdW5jdGlvbihwb3NJbmRleCl7aWYocG9zSW5kZXg8dGhpcy5sb2NhdGlvbi5sZW5ndGgpXG5yZXR1cm4gdGhpcy5sb2NhdGlvbltwb3NJbmRleF07cmV0dXJuIGpzdHMuZ2VvbS5Mb2NhdGlvbi5OT05FO307anN0cy5nZW9tZ3JhcGguVG9wb2xvZ3lMb2NhdGlvbi5wcm90b3R5cGUuaXNOdWxsPWZ1bmN0aW9uKCl7Zm9yKHZhciBpPTA7aTx0aGlzLmxvY2F0aW9uLmxlbmd0aDtpKyspe2lmKHRoaXMubG9jYXRpb25baV0hPT1qc3RzLmdlb20uTG9jYXRpb24uTk9ORSlcbnJldHVybiBmYWxzZTt9XG5yZXR1cm4gdHJ1ZTt9O2pzdHMuZ2VvbWdyYXBoLlRvcG9sb2d5TG9jYXRpb24ucHJvdG90eXBlLmlzQW55TnVsbD1mdW5jdGlvbigpe2Zvcih2YXIgaT0wO2k8dGhpcy5sb2NhdGlvbi5sZW5ndGg7aSsrKXtpZih0aGlzLmxvY2F0aW9uW2ldPT09anN0cy5nZW9tLkxvY2F0aW9uLk5PTkUpXG5yZXR1cm4gdHJ1ZTt9XG5yZXR1cm4gZmFsc2U7fTtqc3RzLmdlb21ncmFwaC5Ub3BvbG9neUxvY2F0aW9uLnByb3RvdHlwZS5pc0VxdWFsT25TaWRlPWZ1bmN0aW9uKGxlLGxvY0luZGV4KXtyZXR1cm4gdGhpcy5sb2NhdGlvbltsb2NJbmRleF09PWxlLmxvY2F0aW9uW2xvY0luZGV4XTt9O2pzdHMuZ2VvbWdyYXBoLlRvcG9sb2d5TG9jYXRpb24ucHJvdG90eXBlLmlzQXJlYT1mdW5jdGlvbigpe3JldHVybiB0aGlzLmxvY2F0aW9uLmxlbmd0aD4xO307anN0cy5nZW9tZ3JhcGguVG9wb2xvZ3lMb2NhdGlvbi5wcm90b3R5cGUuaXNMaW5lPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMubG9jYXRpb24ubGVuZ3RoPT09MTt9O2pzdHMuZ2VvbWdyYXBoLlRvcG9sb2d5TG9jYXRpb24ucHJvdG90eXBlLmZsaXA9ZnVuY3Rpb24oKXtpZih0aGlzLmxvY2F0aW9uLmxlbmd0aDw9MSlcbnJldHVybjt2YXIgdGVtcD10aGlzLmxvY2F0aW9uW2pzdHMuZ2VvbWdyYXBoLlBvc2l0aW9uLkxFRlRdO3RoaXMubG9jYXRpb25banN0cy5nZW9tZ3JhcGguUG9zaXRpb24uTEVGVF09dGhpcy5sb2NhdGlvbltqc3RzLmdlb21ncmFwaC5Qb3NpdGlvbi5SSUdIVF07dGhpcy5sb2NhdGlvbltqc3RzLmdlb21ncmFwaC5Qb3NpdGlvbi5SSUdIVF09dGVtcDt9O2pzdHMuZ2VvbWdyYXBoLlRvcG9sb2d5TG9jYXRpb24ucHJvdG90eXBlLnNldEFsbExvY2F0aW9ucz1mdW5jdGlvbihsb2NWYWx1ZSl7Zm9yKHZhciBpPTA7aTx0aGlzLmxvY2F0aW9uLmxlbmd0aDtpKyspe3RoaXMubG9jYXRpb25baV09bG9jVmFsdWU7fX07anN0cy5nZW9tZ3JhcGguVG9wb2xvZ3lMb2NhdGlvbi5wcm90b3R5cGUuc2V0QWxsTG9jYXRpb25zSWZOdWxsPWZ1bmN0aW9uKGxvY1ZhbHVlKXtmb3IodmFyIGk9MDtpPHRoaXMubG9jYXRpb24ubGVuZ3RoO2krKyl7aWYodGhpcy5sb2NhdGlvbltpXT09PWpzdHMuZ2VvbS5Mb2NhdGlvbi5OT05FKVxudGhpcy5sb2NhdGlvbltpXT1sb2NWYWx1ZTt9fTtqc3RzLmdlb21ncmFwaC5Ub3BvbG9neUxvY2F0aW9uLnByb3RvdHlwZS5zZXRMb2NhdGlvbj1mdW5jdGlvbihsb2NJbmRleCxsb2NWYWx1ZSl7aWYobG9jVmFsdWUhPT11bmRlZmluZWQpe3RoaXMubG9jYXRpb25bbG9jSW5kZXhdPWxvY1ZhbHVlO31lbHNle3RoaXMuc2V0TG9jYXRpb24oanN0cy5nZW9tZ3JhcGguUG9zaXRpb24uT04sbG9jSW5kZXgpO319O2pzdHMuZ2VvbWdyYXBoLlRvcG9sb2d5TG9jYXRpb24ucHJvdG90eXBlLmdldExvY2F0aW9ucz1mdW5jdGlvbigpe3JldHVybiBsb2NhdGlvbjt9O2pzdHMuZ2VvbWdyYXBoLlRvcG9sb2d5TG9jYXRpb24ucHJvdG90eXBlLnNldExvY2F0aW9ucz1mdW5jdGlvbihvbixsZWZ0LHJpZ2h0KXt0aGlzLmxvY2F0aW9uW2pzdHMuZ2VvbWdyYXBoLlBvc2l0aW9uLk9OXT1vbjt0aGlzLmxvY2F0aW9uW2pzdHMuZ2VvbWdyYXBoLlBvc2l0aW9uLkxFRlRdPWxlZnQ7dGhpcy5sb2NhdGlvbltqc3RzLmdlb21ncmFwaC5Qb3NpdGlvbi5SSUdIVF09cmlnaHQ7fTtqc3RzLmdlb21ncmFwaC5Ub3BvbG9neUxvY2F0aW9uLnByb3RvdHlwZS5hbGxQb3NpdGlvbnNFcXVhbD1mdW5jdGlvbihsb2Mpe2Zvcih2YXIgaT0wO2k8dGhpcy5sb2NhdGlvbi5sZW5ndGg7aSsrKXtpZih0aGlzLmxvY2F0aW9uW2ldIT09bG9jKVxucmV0dXJuIGZhbHNlO31cbnJldHVybiB0cnVlO307anN0cy5nZW9tZ3JhcGguVG9wb2xvZ3lMb2NhdGlvbi5wcm90b3R5cGUubWVyZ2U9ZnVuY3Rpb24oZ2wpe2lmKGdsLmxvY2F0aW9uLmxlbmd0aD50aGlzLmxvY2F0aW9uLmxlbmd0aCl7dmFyIG5ld0xvYz1bXTtuZXdMb2NbanN0cy5nZW9tZ3JhcGguUG9zaXRpb24uT05dPXRoaXMubG9jYXRpb25banN0cy5nZW9tZ3JhcGguUG9zaXRpb24uT05dO25ld0xvY1tqc3RzLmdlb21ncmFwaC5Qb3NpdGlvbi5MRUZUXT1qc3RzLmdlb20uTG9jYXRpb24uTk9ORTtuZXdMb2NbanN0cy5nZW9tZ3JhcGguUG9zaXRpb24uUklHSFRdPWpzdHMuZ2VvbS5Mb2NhdGlvbi5OT05FO3RoaXMubG9jYXRpb249bmV3TG9jO31cbmZvcih2YXIgaT0wO2k8dGhpcy5sb2NhdGlvbi5sZW5ndGg7aSsrKXtpZih0aGlzLmxvY2F0aW9uW2ldPT09anN0cy5nZW9tLkxvY2F0aW9uLk5PTkUmJmk8Z2wubG9jYXRpb24ubGVuZ3RoKVxudGhpcy5sb2NhdGlvbltpXT1nbC5sb2NhdGlvbltpXTt9fTtqc3RzLmdlb21ncmFwaC5MYWJlbD1mdW5jdGlvbigpe3RoaXMuZWx0PVtdO3ZhciBnZW9tSW5kZXgsb25Mb2MsbGVmdExvYyxsYmwscmlnaHRMb2M7aWYoYXJndW1lbnRzLmxlbmd0aD09PTQpe2dlb21JbmRleD1hcmd1bWVudHNbMF07b25Mb2M9YXJndW1lbnRzWzFdO2xlZnRMb2M9YXJndW1lbnRzWzJdO3JpZ2h0TG9jPWFyZ3VtZW50c1szXTt0aGlzLmVsdFswXT1uZXcganN0cy5nZW9tZ3JhcGguVG9wb2xvZ3lMb2NhdGlvbihqc3RzLmdlb20uTG9jYXRpb24uTk9ORSxqc3RzLmdlb20uTG9jYXRpb24uTk9ORSxqc3RzLmdlb20uTG9jYXRpb24uTk9ORSk7dGhpcy5lbHRbMV09bmV3IGpzdHMuZ2VvbWdyYXBoLlRvcG9sb2d5TG9jYXRpb24oanN0cy5nZW9tLkxvY2F0aW9uLk5PTkUsanN0cy5nZW9tLkxvY2F0aW9uLk5PTkUsanN0cy5nZW9tLkxvY2F0aW9uLk5PTkUpO3RoaXMuZWx0W2dlb21JbmRleF0uc2V0TG9jYXRpb25zKG9uTG9jLGxlZnRMb2MscmlnaHRMb2MpO31lbHNlIGlmKGFyZ3VtZW50cy5sZW5ndGg9PT0zKXtvbkxvYz1hcmd1bWVudHNbMF07bGVmdExvYz1hcmd1bWVudHNbMV07cmlnaHRMb2M9YXJndW1lbnRzWzJdO3RoaXMuZWx0WzBdPW5ldyBqc3RzLmdlb21ncmFwaC5Ub3BvbG9neUxvY2F0aW9uKG9uTG9jLGxlZnRMb2MscmlnaHRMb2MpO3RoaXMuZWx0WzFdPW5ldyBqc3RzLmdlb21ncmFwaC5Ub3BvbG9neUxvY2F0aW9uKG9uTG9jLGxlZnRMb2MscmlnaHRMb2MpO31lbHNlIGlmKGFyZ3VtZW50cy5sZW5ndGg9PT0yKXtnZW9tSW5kZXg9YXJndW1lbnRzWzBdO29uTG9jPWFyZ3VtZW50c1sxXTt0aGlzLmVsdFswXT1uZXcganN0cy5nZW9tZ3JhcGguVG9wb2xvZ3lMb2NhdGlvbihqc3RzLmdlb20uTG9jYXRpb24uTk9ORSk7dGhpcy5lbHRbMV09bmV3IGpzdHMuZ2VvbWdyYXBoLlRvcG9sb2d5TG9jYXRpb24oanN0cy5nZW9tLkxvY2F0aW9uLk5PTkUpO3RoaXMuZWx0W2dlb21JbmRleF0uc2V0TG9jYXRpb24ob25Mb2MpO31lbHNlIGlmKGFyZ3VtZW50c1swXWluc3RhbmNlb2YganN0cy5nZW9tZ3JhcGguTGFiZWwpe2xibD1hcmd1bWVudHNbMF07dGhpcy5lbHRbMF09bmV3IGpzdHMuZ2VvbWdyYXBoLlRvcG9sb2d5TG9jYXRpb24obGJsLmVsdFswXSk7dGhpcy5lbHRbMV09bmV3IGpzdHMuZ2VvbWdyYXBoLlRvcG9sb2d5TG9jYXRpb24obGJsLmVsdFsxXSk7fWVsc2UgaWYodHlwZW9mIGFyZ3VtZW50c1swXT09PSdudW1iZXInKXtvbkxvYz1hcmd1bWVudHNbMF07dGhpcy5lbHRbMF09bmV3IGpzdHMuZ2VvbWdyYXBoLlRvcG9sb2d5TG9jYXRpb24ob25Mb2MpO3RoaXMuZWx0WzFdPW5ldyBqc3RzLmdlb21ncmFwaC5Ub3BvbG9neUxvY2F0aW9uKG9uTG9jKTt9fTtqc3RzLmdlb21ncmFwaC5MYWJlbC50b0xpbmVMYWJlbD1mdW5jdGlvbihsYWJlbCl7dmFyIGksbGluZUxhYmVsPW5ldyBqc3RzLmdlb21ncmFwaC5MYWJlbChqc3RzLmdlb20uTG9jYXRpb24uTk9ORSk7Zm9yKGk9MDtpPDI7aSsrKXtsaW5lTGFiZWwuc2V0TG9jYXRpb24oaSxsYWJlbC5nZXRMb2NhdGlvbihpKSk7fVxucmV0dXJuIGxpbmVMYWJlbDt9O2pzdHMuZ2VvbWdyYXBoLkxhYmVsLnByb3RvdHlwZS5lbHQ9bnVsbDtqc3RzLmdlb21ncmFwaC5MYWJlbC5wcm90b3R5cGUuZmxpcD1mdW5jdGlvbigpe3RoaXMuZWx0WzBdLmZsaXAoKTt0aGlzLmVsdFsxXS5mbGlwKCk7fTtqc3RzLmdlb21ncmFwaC5MYWJlbC5wcm90b3R5cGUuZ2V0TG9jYXRpb249ZnVuY3Rpb24oZ2VvbUluZGV4LHBvc0luZGV4KXtpZihhcmd1bWVudHMubGVuZ3RoPT0xKXtyZXR1cm4gdGhpcy5nZXRMb2NhdGlvbjIuYXBwbHkodGhpcyxhcmd1bWVudHMpO31cbnJldHVybiB0aGlzLmVsdFtnZW9tSW5kZXhdLmdldChwb3NJbmRleCk7fTtqc3RzLmdlb21ncmFwaC5MYWJlbC5wcm90b3R5cGUuZ2V0TG9jYXRpb24yPWZ1bmN0aW9uKGdlb21JbmRleCl7cmV0dXJuIHRoaXMuZWx0W2dlb21JbmRleF0uZ2V0KGpzdHMuZ2VvbWdyYXBoLlBvc2l0aW9uLk9OKTt9O2pzdHMuZ2VvbWdyYXBoLkxhYmVsLnByb3RvdHlwZS5zZXRMb2NhdGlvbj1mdW5jdGlvbihnZW9tSW5kZXgscG9zSW5kZXgsbG9jYXRpb24pe2lmKGFyZ3VtZW50cy5sZW5ndGg9PTIpe3RoaXMuc2V0TG9jYXRpb24yLmFwcGx5KHRoaXMsYXJndW1lbnRzKTtyZXR1cm47fVxudGhpcy5lbHRbZ2VvbUluZGV4XS5zZXRMb2NhdGlvbihwb3NJbmRleCxsb2NhdGlvbik7fTtqc3RzLmdlb21ncmFwaC5MYWJlbC5wcm90b3R5cGUuc2V0TG9jYXRpb24yPWZ1bmN0aW9uKGdlb21JbmRleCxsb2NhdGlvbil7dGhpcy5lbHRbZ2VvbUluZGV4XS5zZXRMb2NhdGlvbihqc3RzLmdlb21ncmFwaC5Qb3NpdGlvbi5PTixsb2NhdGlvbik7fTtqc3RzLmdlb21ncmFwaC5MYWJlbC5wcm90b3R5cGUuc2V0QWxsTG9jYXRpb25zPWZ1bmN0aW9uKGdlb21JbmRleCxsb2NhdGlvbil7dGhpcy5lbHRbZ2VvbUluZGV4XS5zZXRBbGxMb2NhdGlvbnMobG9jYXRpb24pO307anN0cy5nZW9tZ3JhcGguTGFiZWwucHJvdG90eXBlLnNldEFsbExvY2F0aW9uc0lmTnVsbD1mdW5jdGlvbihnZW9tSW5kZXgsbG9jYXRpb24pe2lmKGFyZ3VtZW50cy5sZW5ndGg9PTEpe3RoaXMuc2V0QWxsTG9jYXRpb25zSWZOdWxsMi5hcHBseSh0aGlzLGFyZ3VtZW50cyk7cmV0dXJuO31cbnRoaXMuZWx0W2dlb21JbmRleF0uc2V0QWxsTG9jYXRpb25zSWZOdWxsKGxvY2F0aW9uKTt9O2pzdHMuZ2VvbWdyYXBoLkxhYmVsLnByb3RvdHlwZS5zZXRBbGxMb2NhdGlvbnNJZk51bGwyPWZ1bmN0aW9uKGxvY2F0aW9uKXt0aGlzLnNldEFsbExvY2F0aW9uc0lmTnVsbCgwLGxvY2F0aW9uKTt0aGlzLnNldEFsbExvY2F0aW9uc0lmTnVsbCgxLGxvY2F0aW9uKTt9O2pzdHMuZ2VvbWdyYXBoLkxhYmVsLnByb3RvdHlwZS5tZXJnZT1mdW5jdGlvbihsYmwpe3ZhciBpO2ZvcihpPTA7aTwyO2krKyl7aWYodGhpcy5lbHRbaV09PT1udWxsJiZsYmwuZWx0W2ldIT09bnVsbCl7dGhpcy5lbHRbaV09bmV3IGpzdHMuZ2VvbWdyYXBoLlRvcG9sb2d5TG9jYXRpb24obGJsLmVsdFtpXSk7fWVsc2V7dGhpcy5lbHRbaV0ubWVyZ2UobGJsLmVsdFtpXSk7fX19O2pzdHMuZ2VvbWdyYXBoLkxhYmVsLnByb3RvdHlwZS5nZXRHZW9tZXRyeUNvdW50PWZ1bmN0aW9uKCl7dmFyIGNvdW50PTA7aWYoIXRoaXMuZWx0WzBdLmlzTnVsbCgpKXtjb3VudCsrO31cbmlmKCF0aGlzLmVsdFsxXS5pc051bGwoKSl7Y291bnQrKzt9XG5yZXR1cm4gY291bnQ7fTtqc3RzLmdlb21ncmFwaC5MYWJlbC5wcm90b3R5cGUuaXNOdWxsPWZ1bmN0aW9uKGdlb21JbmRleCl7cmV0dXJuIHRoaXMuZWx0W2dlb21JbmRleF0uaXNOdWxsKCk7fTtqc3RzLmdlb21ncmFwaC5MYWJlbC5wcm90b3R5cGUuaXNBbnlOdWxsPWZ1bmN0aW9uKGdlb21JbmRleCl7cmV0dXJuIHRoaXMuZWx0W2dlb21JbmRleF0uaXNBbnlOdWxsKCk7fTtqc3RzLmdlb21ncmFwaC5MYWJlbC5wcm90b3R5cGUuaXNBcmVhPWZ1bmN0aW9uKCl7aWYoYXJndW1lbnRzLmxlbmd0aD09MSl7cmV0dXJuIHRoaXMuaXNBcmVhMihhcmd1bWVudHNbMF0pO31cbnJldHVybiB0aGlzLmVsdFswXS5pc0FyZWEoKXx8dGhpcy5lbHRbMV0uaXNBcmVhKCk7fTtqc3RzLmdlb21ncmFwaC5MYWJlbC5wcm90b3R5cGUuaXNBcmVhMj1mdW5jdGlvbihnZW9tSW5kZXgpe3JldHVybiB0aGlzLmVsdFtnZW9tSW5kZXhdLmlzQXJlYSgpO307anN0cy5nZW9tZ3JhcGguTGFiZWwucHJvdG90eXBlLmlzTGluZT1mdW5jdGlvbihnZW9tSW5kZXgpe3JldHVybiB0aGlzLmVsdFtnZW9tSW5kZXhdLmlzTGluZSgpO307anN0cy5nZW9tZ3JhcGguTGFiZWwucHJvdG90eXBlLmlzRXF1YWxPblNpZGU9ZnVuY3Rpb24obGJsLHNpZGUpe3JldHVybiB0aGlzLmVsdFswXS5pc0VxdWFsT25TaWRlKGxibC5lbHRbMF0sc2lkZSkmJnRoaXMuZWx0WzFdLmlzRXF1YWxPblNpZGUobGJsLmVsdFsxXSxzaWRlKTt9O2pzdHMuZ2VvbWdyYXBoLkxhYmVsLnByb3RvdHlwZS5hbGxQb3NpdGlvbnNFcXVhbD1mdW5jdGlvbihnZW9tSW5kZXgsbG9jKXtyZXR1cm4gdGhpcy5lbHRbZ2VvbUluZGV4XS5hbGxQb3NpdGlvbnNFcXVhbChsb2MpO307anN0cy5nZW9tZ3JhcGguTGFiZWwucHJvdG90eXBlLnRvTGluZT1mdW5jdGlvbihnZW9tSW5kZXgpe2lmKHRoaXMuZWx0W2dlb21JbmRleF0uaXNBcmVhKCkpe3RoaXMuZWx0W2dlb21JbmRleF09bmV3IGpzdHMuZ2VvbWdyYXBoLlRvcG9sb2d5TG9jYXRpb24odGhpcy5lbHRbZ2VvbUluZGV4XS5sb2NhdGlvblswXSk7fX07anN0cy5nZW9tZ3JhcGguRWRnZVJpbmc9ZnVuY3Rpb24oc3RhcnQsZ2VvbWV0cnlGYWN0b3J5KXt0aGlzLmVkZ2VzPVtdO3RoaXMucHRzPVtdO3RoaXMuaG9sZXM9W107dGhpcy5sYWJlbD1uZXcganN0cy5nZW9tZ3JhcGguTGFiZWwoanN0cy5nZW9tLkxvY2F0aW9uLk5PTkUpO3RoaXMuZ2VvbWV0cnlGYWN0b3J5PWdlb21ldHJ5RmFjdG9yeTtpZihzdGFydCl7dGhpcy5jb21wdXRlUG9pbnRzKHN0YXJ0KTt0aGlzLmNvbXB1dGVSaW5nKCk7fX07anN0cy5nZW9tZ3JhcGguRWRnZVJpbmcucHJvdG90eXBlLnN0YXJ0RGU9bnVsbDtqc3RzLmdlb21ncmFwaC5FZGdlUmluZy5wcm90b3R5cGUubWF4Tm9kZURlZ3JlZT0tMTtqc3RzLmdlb21ncmFwaC5FZGdlUmluZy5wcm90b3R5cGUuZWRnZXM9bnVsbDtqc3RzLmdlb21ncmFwaC5FZGdlUmluZy5wcm90b3R5cGUucHRzPW51bGw7anN0cy5nZW9tZ3JhcGguRWRnZVJpbmcucHJvdG90eXBlLmxhYmVsPW51bGw7anN0cy5nZW9tZ3JhcGguRWRnZVJpbmcucHJvdG90eXBlLnJpbmc9bnVsbDtqc3RzLmdlb21ncmFwaC5FZGdlUmluZy5wcm90b3R5cGUuX2lzSG9sZT1udWxsO2pzdHMuZ2VvbWdyYXBoLkVkZ2VSaW5nLnByb3RvdHlwZS5zaGVsbD1udWxsO2pzdHMuZ2VvbWdyYXBoLkVkZ2VSaW5nLnByb3RvdHlwZS5ob2xlcz1udWxsO2pzdHMuZ2VvbWdyYXBoLkVkZ2VSaW5nLnByb3RvdHlwZS5nZW9tZXRyeUZhY3Rvcnk9bnVsbDtqc3RzLmdlb21ncmFwaC5FZGdlUmluZy5wcm90b3R5cGUuaXNJc29sYXRlZD1mdW5jdGlvbigpe3JldHVybih0aGlzLmxhYmVsLmdldEdlb21ldHJ5Q291bnQoKT09MSk7fTtqc3RzLmdlb21ncmFwaC5FZGdlUmluZy5wcm90b3R5cGUuaXNIb2xlPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2lzSG9sZTt9O2pzdHMuZ2VvbWdyYXBoLkVkZ2VSaW5nLnByb3RvdHlwZS5nZXRDb29yZGluYXRlPWZ1bmN0aW9uKGkpe3JldHVybiB0aGlzLnB0c1tpXTt9O2pzdHMuZ2VvbWdyYXBoLkVkZ2VSaW5nLnByb3RvdHlwZS5nZXRMaW5lYXJSaW5nPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMucmluZzt9O2pzdHMuZ2VvbWdyYXBoLkVkZ2VSaW5nLnByb3RvdHlwZS5nZXRMYWJlbD1mdW5jdGlvbigpe3JldHVybiB0aGlzLmxhYmVsO307anN0cy5nZW9tZ3JhcGguRWRnZVJpbmcucHJvdG90eXBlLmlzU2hlbGw9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5zaGVsbD09PW51bGw7fTtqc3RzLmdlb21ncmFwaC5FZGdlUmluZy5wcm90b3R5cGUuZ2V0U2hlbGw9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5zaGVsbDt9O2pzdHMuZ2VvbWdyYXBoLkVkZ2VSaW5nLnByb3RvdHlwZS5zZXRTaGVsbD1mdW5jdGlvbihzaGVsbCl7dGhpcy5zaGVsbD1zaGVsbDtpZihzaGVsbCE9PW51bGwpXG5zaGVsbC5hZGRIb2xlKHRoaXMpO307anN0cy5nZW9tZ3JhcGguRWRnZVJpbmcucHJvdG90eXBlLmFkZEhvbGU9ZnVuY3Rpb24ocmluZyl7dGhpcy5ob2xlcy5wdXNoKHJpbmcpO307anN0cy5nZW9tZ3JhcGguRWRnZVJpbmcucHJvdG90eXBlLnRvUG9seWdvbj1mdW5jdGlvbihnZW9tZXRyeUZhY3Rvcnkpe3ZhciBob2xlTFI9W107Zm9yKHZhciBpPTA7aTx0aGlzLmhvbGVzLmxlbmd0aDtpKyspe2hvbGVMUltpXT10aGlzLmhvbGVzW2ldLmdldExpbmVhclJpbmcoKTt9XG52YXIgcG9seT10aGlzLmdlb21ldHJ5RmFjdG9yeS5jcmVhdGVQb2x5Z29uKHRoaXMuZ2V0TGluZWFyUmluZygpLGhvbGVMUik7cmV0dXJuIHBvbHk7fTtqc3RzLmdlb21ncmFwaC5FZGdlUmluZy5wcm90b3R5cGUuY29tcHV0ZVJpbmc9ZnVuY3Rpb24oKXtpZih0aGlzLnJpbmchPT1udWxsKVxucmV0dXJuO3ZhciBjb29yZD1bXTtmb3IodmFyIGk9MDtpPHRoaXMucHRzLmxlbmd0aDtpKyspe2Nvb3JkW2ldPXRoaXMucHRzW2ldO31cbnRoaXMucmluZz10aGlzLmdlb21ldHJ5RmFjdG9yeS5jcmVhdGVMaW5lYXJSaW5nKGNvb3JkKTt0aGlzLl9pc0hvbGU9anN0cy5hbGdvcml0aG0uQ0dBbGdvcml0aG1zLmlzQ0NXKHRoaXMucmluZy5nZXRDb29yZGluYXRlcygpKTt9O2pzdHMuZ2VvbWdyYXBoLkVkZ2VSaW5nLnByb3RvdHlwZS5nZXROZXh0PWZ1bmN0aW9uKGRlKXt0aHJvdyBuZXcganN0cy5lcnJvci5BYnN0cmFjdEludm9jYXRpb25FcnJvcigpO307anN0cy5nZW9tZ3JhcGguRWRnZVJpbmcucHJvdG90eXBlLnNldEVkZ2VSaW5nPWZ1bmN0aW9uKGRlLGVyKXt0aHJvdyBuZXcganN0cy5lcnJvci5BYnN0cmFjdEludm9jYXRpb25FcnJvcigpO307anN0cy5nZW9tZ3JhcGguRWRnZVJpbmcucHJvdG90eXBlLmdldEVkZ2VzPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZWRnZXM7fTtqc3RzLmdlb21ncmFwaC5FZGdlUmluZy5wcm90b3R5cGUuY29tcHV0ZVBvaW50cz1mdW5jdGlvbihzdGFydCl7dGhpcy5zdGFydERlPXN0YXJ0O3ZhciBkZT1zdGFydDt2YXIgaXNGaXJzdEVkZ2U9dHJ1ZTtkb3tpZihkZT09PW51bGwpXG50aHJvdyBuZXcganN0cy5lcnJvci5Ub3BvbG9neUVycm9yKCdGb3VuZCBudWxsIERpcmVjdGVkRWRnZScpO2lmKGRlLmdldEVkZ2VSaW5nKCk9PT10aGlzKVxudGhyb3cgbmV3IGpzdHMuZXJyb3IuVG9wb2xvZ3lFcnJvcignRGlyZWN0ZWQgRWRnZSB2aXNpdGVkIHR3aWNlIGR1cmluZyByaW5nLWJ1aWxkaW5nIGF0ICcrXG5kZS5nZXRDb29yZGluYXRlKCkpO3RoaXMuZWRnZXMucHVzaChkZSk7dmFyIGxhYmVsPWRlLmdldExhYmVsKCk7anN0cy51dGlsLkFzc2VydC5pc1RydWUobGFiZWwuaXNBcmVhKCkpO3RoaXMubWVyZ2VMYWJlbChsYWJlbCk7dGhpcy5hZGRQb2ludHMoZGUuZ2V0RWRnZSgpLGRlLmlzRm9yd2FyZCgpLGlzRmlyc3RFZGdlKTtpc0ZpcnN0RWRnZT1mYWxzZTt0aGlzLnNldEVkZ2VSaW5nKGRlLHRoaXMpO2RlPXRoaXMuZ2V0TmV4dChkZSk7fXdoaWxlKGRlIT09dGhpcy5zdGFydERlKTt9O2pzdHMuZ2VvbWdyYXBoLkVkZ2VSaW5nLnByb3RvdHlwZS5nZXRNYXhOb2RlRGVncmVlPWZ1bmN0aW9uKCl7aWYodGhpcy5tYXhOb2RlRGVncmVlPDApXG50aGlzLmNvbXB1dGVNYXhOb2RlRGVncmVlKCk7cmV0dXJuIHRoaXMubWF4Tm9kZURlZ3JlZTt9O2pzdHMuZ2VvbWdyYXBoLkVkZ2VSaW5nLnByb3RvdHlwZS5jb21wdXRlTWF4Tm9kZURlZ3JlZT1mdW5jdGlvbigpe3RoaXMubWF4Tm9kZURlZ3JlZT0wO3ZhciBkZT10aGlzLnN0YXJ0RGU7ZG97dmFyIG5vZGU9ZGUuZ2V0Tm9kZSgpO3ZhciBkZWdyZWU9bm9kZS5nZXRFZGdlcygpLmdldE91dGdvaW5nRGVncmVlKHRoaXMpO2lmKGRlZ3JlZT50aGlzLm1heE5vZGVEZWdyZWUpXG50aGlzLm1heE5vZGVEZWdyZWU9ZGVncmVlO2RlPXRoaXMuZ2V0TmV4dChkZSk7fXdoaWxlKGRlIT09dGhpcy5zdGFydERlKTt0aGlzLm1heE5vZGVEZWdyZWUqPTI7fTtqc3RzLmdlb21ncmFwaC5FZGdlUmluZy5wcm90b3R5cGUuc2V0SW5SZXN1bHQ9ZnVuY3Rpb24oKXt2YXIgZGU9dGhpcy5zdGFydERlO2Rve2RlLmdldEVkZ2UoKS5zZXRJblJlc3VsdCh0cnVlKTtkZT1kZS5nZXROZXh0KCk7fXdoaWxlKGRlIT10aGlzLnN0YXJ0RGUpO307anN0cy5nZW9tZ3JhcGguRWRnZVJpbmcucHJvdG90eXBlLm1lcmdlTGFiZWw9ZnVuY3Rpb24oZGVMYWJlbCl7dGhpcy5tZXJnZUxhYmVsMihkZUxhYmVsLDApO3RoaXMubWVyZ2VMYWJlbDIoZGVMYWJlbCwxKTt9O2pzdHMuZ2VvbWdyYXBoLkVkZ2VSaW5nLnByb3RvdHlwZS5tZXJnZUxhYmVsMj1mdW5jdGlvbihkZUxhYmVsLGdlb21JbmRleCl7dmFyIGxvYz1kZUxhYmVsLmdldExvY2F0aW9uKGdlb21JbmRleCxqc3RzLmdlb21ncmFwaC5Qb3NpdGlvbi5SSUdIVCk7aWYobG9jPT1qc3RzLmdlb20uTG9jYXRpb24uTk9ORSlcbnJldHVybjtpZih0aGlzLmxhYmVsLmdldExvY2F0aW9uKGdlb21JbmRleCk9PT1qc3RzLmdlb20uTG9jYXRpb24uTk9ORSl7dGhpcy5sYWJlbC5zZXRMb2NhdGlvbihnZW9tSW5kZXgsbG9jKTtyZXR1cm47fX07anN0cy5nZW9tZ3JhcGguRWRnZVJpbmcucHJvdG90eXBlLmFkZFBvaW50cz1mdW5jdGlvbihlZGdlLGlzRm9yd2FyZCxpc0ZpcnN0RWRnZSl7dmFyIGVkZ2VQdHM9ZWRnZS5nZXRDb29yZGluYXRlcygpO2lmKGlzRm9yd2FyZCl7dmFyIHN0YXJ0SW5kZXg9MTtpZihpc0ZpcnN0RWRnZSlcbnN0YXJ0SW5kZXg9MDtmb3IodmFyIGk9c3RhcnRJbmRleDtpPGVkZ2VQdHMubGVuZ3RoO2krKyl7dGhpcy5wdHMucHVzaChlZGdlUHRzW2ldKTt9fWVsc2V7dmFyIHN0YXJ0SW5kZXg9ZWRnZVB0cy5sZW5ndGgtMjtpZihpc0ZpcnN0RWRnZSlcbnN0YXJ0SW5kZXg9ZWRnZVB0cy5sZW5ndGgtMTtmb3IodmFyIGk9c3RhcnRJbmRleDtpPj0wO2ktLSl7dGhpcy5wdHMucHVzaChlZGdlUHRzW2ldKTt9fX07anN0cy5nZW9tZ3JhcGguRWRnZVJpbmcucHJvdG90eXBlLmNvbnRhaW5zUG9pbnQ9ZnVuY3Rpb24ocCl7dmFyIHNoZWxsPXRoaXMuZ2V0TGluZWFyUmluZygpO3ZhciBlbnY9c2hlbGwuZ2V0RW52ZWxvcGVJbnRlcm5hbCgpO2lmKCFlbnYuY29udGFpbnMocCkpXG5yZXR1cm4gZmFsc2U7aWYoIWpzdHMuYWxnb3JpdGhtLkNHQWxnb3JpdGhtcy5pc1BvaW50SW5SaW5nKHAsc2hlbGwuZ2V0Q29vcmRpbmF0ZXMoKSkpXG5yZXR1cm4gZmFsc2U7Zm9yKHZhciBpPTA7aTx0aGlzLmhvbGVzLmxlbmd0aDtpKyspe3ZhciBob2xlPXRoaXMuaG9sZXNbaV07aWYoaG9sZS5jb250YWluc1BvaW50KHApKVxucmV0dXJuIGZhbHNlO31cbnJldHVybiB0cnVlO307KGZ1bmN0aW9uKCl7anN0cy5nZW9tLkxpbmVhclJpbmc9ZnVuY3Rpb24ocG9pbnRzLGZhY3Rvcnkpe2pzdHMuZ2VvbS5MaW5lU3RyaW5nLmFwcGx5KHRoaXMsYXJndW1lbnRzKTt9O2pzdHMuZ2VvbS5MaW5lYXJSaW5nLnByb3RvdHlwZT1uZXcganN0cy5nZW9tLkxpbmVTdHJpbmcoKTtqc3RzLmdlb20uTGluZWFyUmluZy5jb25zdHJ1Y3Rvcj1qc3RzLmdlb20uTGluZWFyUmluZztqc3RzLmdlb20uTGluZWFyUmluZy5wcm90b3R5cGUuZ2V0Qm91bmRhcnlEaW1lbnNpb249ZnVuY3Rpb24oKXtyZXR1cm4ganN0cy5nZW9tLkRpbWVuc2lvbi5GQUxTRTt9O2pzdHMuZ2VvbS5MaW5lYXJSaW5nLnByb3RvdHlwZS5pc1NpbXBsZT1mdW5jdGlvbigpe3JldHVybiB0cnVlO307anN0cy5nZW9tLkxpbmVhclJpbmcucHJvdG90eXBlLmdldEdlb21ldHJ5VHlwZT1mdW5jdGlvbigpe3JldHVybidMaW5lYXJSaW5nJzt9O2pzdHMuZ2VvbS5MaW5lYXJSaW5nLk1JTklNVU1fVkFMSURfU0laRT00O2pzdHMuZ2VvbS5MaW5lYXJSaW5nLnByb3RvdHlwZS5DTEFTU19OQU1FPSdqc3RzLmdlb20uTGluZWFyUmluZyc7fSkoKTtqc3RzLmluZGV4LnN0cnRyZWUuQm91bmRhYmxlPWZ1bmN0aW9uKCl7fTtqc3RzLmluZGV4LnN0cnRyZWUuQm91bmRhYmxlLnByb3RvdHlwZS5nZXRCb3VuZHM9ZnVuY3Rpb24oKXt0aHJvdyBuZXcganN0cy5lcnJvci5BYnN0cmFjdE1ldGhvZEludm9jYXRpb25FcnJvcigpO307anN0cy5pbmRleC5zdHJ0cmVlLkFic3RyYWN0Tm9kZT1mdW5jdGlvbihsZXZlbCl7dGhpcy5sZXZlbD1sZXZlbDt0aGlzLmNoaWxkQm91bmRhYmxlcz1bXTt9O2pzdHMuaW5kZXguc3RydHJlZS5BYnN0cmFjdE5vZGUucHJvdG90eXBlPW5ldyBqc3RzLmluZGV4LnN0cnRyZWUuQm91bmRhYmxlKCk7anN0cy5pbmRleC5zdHJ0cmVlLkFic3RyYWN0Tm9kZS5jb25zdHJ1Y3Rvcj1qc3RzLmluZGV4LnN0cnRyZWUuQWJzdHJhY3ROb2RlO2pzdHMuaW5kZXguc3RydHJlZS5BYnN0cmFjdE5vZGUucHJvdG90eXBlLmNoaWxkQm91bmRhYmxlcz1udWxsO2pzdHMuaW5kZXguc3RydHJlZS5BYnN0cmFjdE5vZGUucHJvdG90eXBlLmJvdW5kcz1udWxsO2pzdHMuaW5kZXguc3RydHJlZS5BYnN0cmFjdE5vZGUucHJvdG90eXBlLmxldmVsPW51bGw7anN0cy5pbmRleC5zdHJ0cmVlLkFic3RyYWN0Tm9kZS5wcm90b3R5cGUuZ2V0Q2hpbGRCb3VuZGFibGVzPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuY2hpbGRCb3VuZGFibGVzO307anN0cy5pbmRleC5zdHJ0cmVlLkFic3RyYWN0Tm9kZS5wcm90b3R5cGUuY29tcHV0ZUJvdW5kcz1mdW5jdGlvbigpe3Rocm93IG5ldyBqc3RzLmVycm9yLkFic3RyYWN0TWV0aG9kSW52b2NhdGlvbkVycm9yKCk7fTtqc3RzLmluZGV4LnN0cnRyZWUuQWJzdHJhY3ROb2RlLnByb3RvdHlwZS5nZXRCb3VuZHM9ZnVuY3Rpb24oKXtpZih0aGlzLmJvdW5kcz09PW51bGwpe3RoaXMuYm91bmRzPXRoaXMuY29tcHV0ZUJvdW5kcygpO31cbnJldHVybiB0aGlzLmJvdW5kczt9O2pzdHMuaW5kZXguc3RydHJlZS5BYnN0cmFjdE5vZGUucHJvdG90eXBlLmdldExldmVsPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMubGV2ZWw7fTtqc3RzLmluZGV4LnN0cnRyZWUuQWJzdHJhY3ROb2RlLnByb3RvdHlwZS5hZGRDaGlsZEJvdW5kYWJsZT1mdW5jdGlvbihjaGlsZEJvdW5kYWJsZSl7dGhpcy5jaGlsZEJvdW5kYWJsZXMucHVzaChjaGlsZEJvdW5kYWJsZSk7fTsoZnVuY3Rpb24oKXtqc3RzLm5vZGluZy5Ob2Rlcj1mdW5jdGlvbigpe307anN0cy5ub2RpbmcuTm9kZXIucHJvdG90eXBlLmNvbXB1dGVOb2Rlcz1qc3RzLmFic3RyYWN0RnVuYztqc3RzLm5vZGluZy5Ob2Rlci5wcm90b3R5cGUuZ2V0Tm9kZWRTdWJzdHJpbmdzPWpzdHMuYWJzdHJhY3RGdW5jO30pKCk7KGZ1bmN0aW9uKCl7dmFyIE5vZGVyPWpzdHMubm9kaW5nLk5vZGVyO2pzdHMubm9kaW5nLlNpbmdsZVBhc3NOb2Rlcj1mdW5jdGlvbigpe307anN0cy5ub2RpbmcuU2luZ2xlUGFzc05vZGVyLnByb3RvdHlwZT1uZXcgTm9kZXIoKTtqc3RzLm5vZGluZy5TaW5nbGVQYXNzTm9kZXIuY29uc3RydWN0b3I9anN0cy5ub2RpbmcuU2luZ2xlUGFzc05vZGVyO2pzdHMubm9kaW5nLlNpbmdsZVBhc3NOb2Rlci5wcm90b3R5cGUuc2VnSW50PW51bGw7anN0cy5ub2RpbmcuU2luZ2xlUGFzc05vZGVyLnByb3RvdHlwZS5zZXRTZWdtZW50SW50ZXJzZWN0b3I9ZnVuY3Rpb24oc2VnSW50KXt0aGlzLnNlZ0ludD1zZWdJbnQ7fTt9KSgpO2pzdHMuaW5kZXguU3BhdGlhbEluZGV4PWZ1bmN0aW9uKCl7fTtqc3RzLmluZGV4LlNwYXRpYWxJbmRleC5wcm90b3R5cGUuaW5zZXJ0PWZ1bmN0aW9uKGl0ZW1FbnYsaXRlbSl7dGhyb3cgbmV3IGpzdHMuZXJyb3IuQWJzdHJhY3RNZXRob2RJbnZvY2F0aW9uRXJyb3IoKTt9O2pzdHMuaW5kZXguU3BhdGlhbEluZGV4LnByb3RvdHlwZS5xdWVyeT1mdW5jdGlvbihzZWFyY2hFbnYsdmlzaXRvcil7dGhyb3cgbmV3IGpzdHMuZXJyb3IuQWJzdHJhY3RNZXRob2RJbnZvY2F0aW9uRXJyb3IoKTt9O2pzdHMuaW5kZXguU3BhdGlhbEluZGV4LnByb3RvdHlwZS5yZW1vdmU9ZnVuY3Rpb24oaXRlbUVudixpdGVtKXt0aHJvdyBuZXcganN0cy5lcnJvci5BYnN0cmFjdE1ldGhvZEludm9jYXRpb25FcnJvcigpO307anN0cy5pbmRleC5zdHJ0cmVlLkFic3RyYWN0U1RSdHJlZT1mdW5jdGlvbihub2RlQ2FwYWNpdHkpe2lmKG5vZGVDYXBhY2l0eT09PXVuZGVmaW5lZClcbnJldHVybjt0aGlzLml0ZW1Cb3VuZGFibGVzPVtdO2pzdHMudXRpbC5Bc3NlcnQuaXNUcnVlKG5vZGVDYXBhY2l0eT4xLCdOb2RlIGNhcGFjaXR5IG11c3QgYmUgZ3JlYXRlciB0aGFuIDEnKTt0aGlzLm5vZGVDYXBhY2l0eT1ub2RlQ2FwYWNpdHk7fTtqc3RzLmluZGV4LnN0cnRyZWUuQWJzdHJhY3RTVFJ0cmVlLkludGVyc2VjdHNPcD1mdW5jdGlvbigpe307anN0cy5pbmRleC5zdHJ0cmVlLkFic3RyYWN0U1RSdHJlZS5JbnRlcnNlY3RzT3AucHJvdG90eXBlLmludGVyc2VjdHM9ZnVuY3Rpb24oYUJvdW5kcyxiQm91bmRzKXt0aHJvdyBuZXcganN0cy5lcnJvci5BYnN0cmFjdE1ldGhvZEludm9jYXRpb25FcnJvcigpO307anN0cy5pbmRleC5zdHJ0cmVlLkFic3RyYWN0U1RSdHJlZS5wcm90b3R5cGUucm9vdD1udWxsO2pzdHMuaW5kZXguc3RydHJlZS5BYnN0cmFjdFNUUnRyZWUucHJvdG90eXBlLmJ1aWx0PWZhbHNlO2pzdHMuaW5kZXguc3RydHJlZS5BYnN0cmFjdFNUUnRyZWUucHJvdG90eXBlLml0ZW1Cb3VuZGFibGVzPW51bGw7anN0cy5pbmRleC5zdHJ0cmVlLkFic3RyYWN0U1RSdHJlZS5wcm90b3R5cGUubm9kZUNhcGFjaXR5PW51bGw7anN0cy5pbmRleC5zdHJ0cmVlLkFic3RyYWN0U1RSdHJlZS5wcm90b3R5cGUuYnVpbGQ9ZnVuY3Rpb24oKXtqc3RzLnV0aWwuQXNzZXJ0LmlzVHJ1ZSghdGhpcy5idWlsdCk7dGhpcy5yb290PXRoaXMuaXRlbUJvdW5kYWJsZXMubGVuZ3RoPT09MD90aGlzLmNyZWF0ZU5vZGUoMCk6dGhpcy5jcmVhdGVIaWdoZXJMZXZlbHModGhpcy5pdGVtQm91bmRhYmxlcywtMSk7dGhpcy5idWlsdD10cnVlO307anN0cy5pbmRleC5zdHJ0cmVlLkFic3RyYWN0U1RSdHJlZS5wcm90b3R5cGUuY3JlYXRlTm9kZT1mdW5jdGlvbihsZXZlbCl7dGhyb3cgbmV3IGpzdHMuZXJyb3IuQWJzdHJhY3RNZXRob2RJbnZvY2F0aW9uRXJyb3IoKTt9O2pzdHMuaW5kZXguc3RydHJlZS5BYnN0cmFjdFNUUnRyZWUucHJvdG90eXBlLmNyZWF0ZVBhcmVudEJvdW5kYWJsZXM9ZnVuY3Rpb24oY2hpbGRCb3VuZGFibGVzLG5ld0xldmVsKXtqc3RzLnV0aWwuQXNzZXJ0LmlzVHJ1ZSghKGNoaWxkQm91bmRhYmxlcy5sZW5ndGg9PT0wKSk7dmFyIHBhcmVudEJvdW5kYWJsZXM9W107cGFyZW50Qm91bmRhYmxlcy5wdXNoKHRoaXMuY3JlYXRlTm9kZShuZXdMZXZlbCkpO3ZhciBzb3J0ZWRDaGlsZEJvdW5kYWJsZXM9W107Zm9yKHZhciBpPTA7aTxjaGlsZEJvdW5kYWJsZXMubGVuZ3RoO2krKyl7c29ydGVkQ2hpbGRCb3VuZGFibGVzLnB1c2goY2hpbGRCb3VuZGFibGVzW2ldKTt9XG5zb3J0ZWRDaGlsZEJvdW5kYWJsZXMuc29ydCh0aGlzLmdldENvbXBhcmF0b3IoKSk7Zm9yKHZhciBpPTA7aTxzb3J0ZWRDaGlsZEJvdW5kYWJsZXMubGVuZ3RoO2krKyl7dmFyIGNoaWxkQm91bmRhYmxlPXNvcnRlZENoaWxkQm91bmRhYmxlc1tpXTtpZih0aGlzLmxhc3ROb2RlKHBhcmVudEJvdW5kYWJsZXMpLmdldENoaWxkQm91bmRhYmxlcygpLmxlbmd0aD09PXRoaXMuZ2V0Tm9kZUNhcGFjaXR5KCkpe3BhcmVudEJvdW5kYWJsZXMucHVzaCh0aGlzLmNyZWF0ZU5vZGUobmV3TGV2ZWwpKTt9XG50aGlzLmxhc3ROb2RlKHBhcmVudEJvdW5kYWJsZXMpLmFkZENoaWxkQm91bmRhYmxlKGNoaWxkQm91bmRhYmxlKTt9XG5yZXR1cm4gcGFyZW50Qm91bmRhYmxlczt9O2pzdHMuaW5kZXguc3RydHJlZS5BYnN0cmFjdFNUUnRyZWUucHJvdG90eXBlLmxhc3ROb2RlPWZ1bmN0aW9uKG5vZGVzKXtyZXR1cm4gbm9kZXNbbm9kZXMubGVuZ3RoLTFdO307anN0cy5pbmRleC5zdHJ0cmVlLkFic3RyYWN0U1RSdHJlZS5wcm90b3R5cGUuY29tcGFyZURvdWJsZXM9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gYT5iPzE6YTxiPy0xOjA7fTtqc3RzLmluZGV4LnN0cnRyZWUuQWJzdHJhY3RTVFJ0cmVlLnByb3RvdHlwZS5jcmVhdGVIaWdoZXJMZXZlbHM9ZnVuY3Rpb24oYm91bmRhYmxlc09mQUxldmVsLGxldmVsKXtqc3RzLnV0aWwuQXNzZXJ0LmlzVHJ1ZSghKGJvdW5kYWJsZXNPZkFMZXZlbC5sZW5ndGg9PT0wKSk7dmFyIHBhcmVudEJvdW5kYWJsZXM9dGhpcy5jcmVhdGVQYXJlbnRCb3VuZGFibGVzKGJvdW5kYWJsZXNPZkFMZXZlbCxsZXZlbCsxKTtpZihwYXJlbnRCb3VuZGFibGVzLmxlbmd0aD09PTEpe3JldHVybiBwYXJlbnRCb3VuZGFibGVzWzBdO31cbnJldHVybiB0aGlzLmNyZWF0ZUhpZ2hlckxldmVscyhwYXJlbnRCb3VuZGFibGVzLGxldmVsKzEpO307anN0cy5pbmRleC5zdHJ0cmVlLkFic3RyYWN0U1RSdHJlZS5wcm90b3R5cGUuZ2V0Um9vdD1mdW5jdGlvbigpe2lmKCF0aGlzLmJ1aWx0KVxudGhpcy5idWlsZCgpO3JldHVybiB0aGlzLnJvb3Q7fTtqc3RzLmluZGV4LnN0cnRyZWUuQWJzdHJhY3RTVFJ0cmVlLnByb3RvdHlwZS5nZXROb2RlQ2FwYWNpdHk9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5ub2RlQ2FwYWNpdHk7fTtqc3RzLmluZGV4LnN0cnRyZWUuQWJzdHJhY3RTVFJ0cmVlLnByb3RvdHlwZS5zaXplPWZ1bmN0aW9uKCl7aWYoYXJndW1lbnRzLmxlbmd0aD09PTEpe3JldHVybiB0aGlzLnNpemUyKGFyZ3VtZW50c1swXSk7fVxuaWYoIXRoaXMuYnVpbHQpe3RoaXMuYnVpbGQoKTt9XG5pZih0aGlzLml0ZW1Cb3VuZGFibGVzLmxlbmd0aD09PTApe3JldHVybiAwO31cbnJldHVybiB0aGlzLnNpemUyKHJvb3QpO307anN0cy5pbmRleC5zdHJ0cmVlLkFic3RyYWN0U1RSdHJlZS5wcm90b3R5cGUuc2l6ZTI9ZnVuY3Rpb24obm9kZSl7dmFyIHNpemU9MDt2YXIgY2hpbGRCb3VuZGFibGVzPW5vZGUuZ2V0Q2hpbGRCb3VuZGFibGVzKCk7Zm9yKHZhciBpPTA7aTxjaGlsZEJvdW5kYWJsZXMubGVuZ3RoO2krKyl7dmFyIGNoaWxkQm91bmRhYmxlPWNoaWxkQm91bmRhYmxlc1tpXTtpZihjaGlsZEJvdW5kYWJsZSBpbnN0YW5jZW9mIGpzdHMuaW5kZXguc3RydHJlZS5BYnN0cmFjdE5vZGUpe3NpemUrPXRoaXMuc2l6ZShjaGlsZEJvdW5kYWJsZSk7fWVsc2UgaWYoY2hpbGRCb3VuZGFibGUgaW5zdGFuY2VvZiBqc3RzLmluZGV4LnN0cnRyZWUuSXRlbUJvdW5kYWJsZSl7c2l6ZSs9MTt9fVxucmV0dXJuIHNpemU7fTtqc3RzLmluZGV4LnN0cnRyZWUuQWJzdHJhY3RTVFJ0cmVlLnByb3RvdHlwZS5kZXB0aD1mdW5jdGlvbigpe2lmKGFyZ3VtZW50cy5sZW5ndGg9PT0xKXtyZXR1cm4gdGhpcy5kZXB0aDIoYXJndW1lbnRzWzBdKTt9XG5pZighdGhpcy5idWlsdCl7dGhpcy5idWlsZCgpO31cbmlmKHRoaXMuaXRlbUJvdW5kYWJsZXMubGVuZ3RoPT09MCl7cmV0dXJuIDA7fVxucmV0dXJuIHRoaXMuZGVwdGgyKHJvb3QpO307anN0cy5pbmRleC5zdHJ0cmVlLkFic3RyYWN0U1RSdHJlZS5wcm90b3R5cGUuZGVwdGgyPWZ1bmN0aW9uKCl7dmFyIG1heENoaWxkRGVwdGg9MDt2YXIgY2hpbGRCb3VuZGFibGVzPW5vZGUuZ2V0Q2hpbGRCb3VuZGFibGVzKCk7Zm9yKHZhciBpPTA7aTxjaGlsZEJvdW5kYWJsZXMubGVuZ3RoO2krKyl7dmFyIGNoaWxkQm91bmRhYmxlPWNoaWxkQm91bmRhYmxlc1tpXTtpZihjaGlsZEJvdW5kYWJsZSBpbnN0YW5jZW9mIGpzdHMuaW5kZXguc3RydHJlZS5BYnN0cmFjdE5vZGUpe3ZhciBjaGlsZERlcHRoPXRoaXMuZGVwdGgoY2hpbGRCb3VuZGFibGUpO2lmKGNoaWxkRGVwdGg+bWF4Q2hpbGREZXB0aClcbm1heENoaWxkRGVwdGg9Y2hpbGREZXB0aDt9fVxucmV0dXJuIG1heENoaWxkRGVwdGgrMTt9O2pzdHMuaW5kZXguc3RydHJlZS5BYnN0cmFjdFNUUnRyZWUucHJvdG90eXBlLmluc2VydD1mdW5jdGlvbihib3VuZHMsaXRlbSl7anN0cy51dGlsLkFzc2VydC5pc1RydWUoIXRoaXMuYnVpbHQsJ0Nhbm5vdCBpbnNlcnQgaXRlbXMgaW50byBhbiBTVFIgcGFja2VkIFItdHJlZSBhZnRlciBpdCBoYXMgYmVlbiBidWlsdC4nKTt0aGlzLml0ZW1Cb3VuZGFibGVzLnB1c2gobmV3IGpzdHMuaW5kZXguc3RydHJlZS5JdGVtQm91bmRhYmxlKGJvdW5kcyxpdGVtKSk7fTtqc3RzLmluZGV4LnN0cnRyZWUuQWJzdHJhY3RTVFJ0cmVlLnByb3RvdHlwZS5xdWVyeT1mdW5jdGlvbihzZWFyY2hCb3VuZHMpe2lmKGFyZ3VtZW50cy5sZW5ndGg+MSl7dGhpcy5xdWVyeTIuYXBwbHkodGhpcyxhcmd1bWVudHMpO31cbmlmKCF0aGlzLmJ1aWx0KXt0aGlzLmJ1aWxkKCk7fVxudmFyIG1hdGNoZXM9W107aWYodGhpcy5pdGVtQm91bmRhYmxlcy5sZW5ndGg9PT0wKXtqc3RzLnV0aWwuQXNzZXJ0LmlzVHJ1ZSh0aGlzLnJvb3QuZ2V0Qm91bmRzKCk9PT1udWxsKTtyZXR1cm4gbWF0Y2hlczt9XG5pZih0aGlzLmdldEludGVyc2VjdHNPcCgpLmludGVyc2VjdHModGhpcy5yb290LmdldEJvdW5kcygpLHNlYXJjaEJvdW5kcykpe3RoaXMucXVlcnkzKHNlYXJjaEJvdW5kcyx0aGlzLnJvb3QsbWF0Y2hlcyk7fVxucmV0dXJuIG1hdGNoZXM7fTtqc3RzLmluZGV4LnN0cnRyZWUuQWJzdHJhY3RTVFJ0cmVlLnByb3RvdHlwZS5xdWVyeTI9ZnVuY3Rpb24oc2VhcmNoQm91bmRzLHZpc2l0b3Ipe2lmKGFyZ3VtZW50cy5sZW5ndGg+Mil7dGhpcy5xdWVyeTMuYXBwbHkodGhpcyxhcmd1bWVudHMpO31cbmlmKCF0aGlzLmJ1aWx0KXt0aGlzLmJ1aWxkKCk7fVxuaWYodGhpcy5pdGVtQm91bmRhYmxlcy5sZW5ndGg9PT0wKXtqc3RzLnV0aWwuQXNzZXJ0LmlzVHJ1ZSh0aGlzLnJvb3QuZ2V0Qm91bmRzKCk9PT1udWxsKTt9XG5pZih0aGlzLmdldEludGVyc2VjdHNPcCgpLmludGVyc2VjdHModGhpcy5yb290LmdldEJvdW5kcygpLHNlYXJjaEJvdW5kcykpe3RoaXMucXVlcnk0KHNlYXJjaEJvdW5kcyx0aGlzLnJvb3QsdmlzaXRvcik7fX07anN0cy5pbmRleC5zdHJ0cmVlLkFic3RyYWN0U1RSdHJlZS5wcm90b3R5cGUucXVlcnkzPWZ1bmN0aW9uKHNlYXJjaEJvdW5kcyxub2RlLG1hdGNoZXMpe2lmKCEoYXJndW1lbnRzWzJdaW5zdGFuY2VvZiBBcnJheSkpe3RoaXMucXVlcnk0LmFwcGx5KHRoaXMsYXJndW1lbnRzKTt9XG52YXIgY2hpbGRCb3VuZGFibGVzPW5vZGUuZ2V0Q2hpbGRCb3VuZGFibGVzKCk7Zm9yKHZhciBpPTA7aTxjaGlsZEJvdW5kYWJsZXMubGVuZ3RoO2krKyl7dmFyIGNoaWxkQm91bmRhYmxlPWNoaWxkQm91bmRhYmxlc1tpXTtpZighdGhpcy5nZXRJbnRlcnNlY3RzT3AoKS5pbnRlcnNlY3RzKGNoaWxkQm91bmRhYmxlLmdldEJvdW5kcygpLHNlYXJjaEJvdW5kcykpe2NvbnRpbnVlO31cbmlmKGNoaWxkQm91bmRhYmxlIGluc3RhbmNlb2YganN0cy5pbmRleC5zdHJ0cmVlLkFic3RyYWN0Tm9kZSl7dGhpcy5xdWVyeTMoc2VhcmNoQm91bmRzLGNoaWxkQm91bmRhYmxlLG1hdGNoZXMpO31lbHNlIGlmKGNoaWxkQm91bmRhYmxlIGluc3RhbmNlb2YganN0cy5pbmRleC5zdHJ0cmVlLkl0ZW1Cb3VuZGFibGUpe21hdGNoZXMucHVzaChjaGlsZEJvdW5kYWJsZS5nZXRJdGVtKCkpO31lbHNle2pzdHMudXRpbC5Bc3NlcnQuc2hvdWxkTmV2ZXJSZWFjaEhlcmUoKTt9fX07anN0cy5pbmRleC5zdHJ0cmVlLkFic3RyYWN0U1RSdHJlZS5wcm90b3R5cGUucXVlcnk0PWZ1bmN0aW9uKHNlYXJjaEJvdW5kcyxub2RlLHZpc2l0b3Ipe3ZhciBjaGlsZEJvdW5kYWJsZXM9bm9kZS5nZXRDaGlsZEJvdW5kYWJsZXMoKTtmb3IodmFyIGk9MDtpPGNoaWxkQm91bmRhYmxlcy5sZW5ndGg7aSsrKXt2YXIgY2hpbGRCb3VuZGFibGU9Y2hpbGRCb3VuZGFibGVzW2ldO2lmKCF0aGlzLmdldEludGVyc2VjdHNPcCgpLmludGVyc2VjdHMoY2hpbGRCb3VuZGFibGUuZ2V0Qm91bmRzKCksc2VhcmNoQm91bmRzKSl7Y29udGludWU7fVxuaWYoY2hpbGRCb3VuZGFibGUgaW5zdGFuY2VvZiBqc3RzLmluZGV4LnN0cnRyZWUuQWJzdHJhY3ROb2RlKXt0aGlzLnF1ZXJ5NChzZWFyY2hCb3VuZHMsY2hpbGRCb3VuZGFibGUsdmlzaXRvcik7fWVsc2UgaWYoY2hpbGRCb3VuZGFibGUgaW5zdGFuY2VvZiBqc3RzLmluZGV4LnN0cnRyZWUuSXRlbUJvdW5kYWJsZSl7dmlzaXRvci52aXNpdEl0ZW0oY2hpbGRCb3VuZGFibGUuZ2V0SXRlbSgpKTt9ZWxzZXtqc3RzLnV0aWwuQXNzZXJ0LnNob3VsZE5ldmVyUmVhY2hIZXJlKCk7fX19O2pzdHMuaW5kZXguc3RydHJlZS5BYnN0cmFjdFNUUnRyZWUucHJvdG90eXBlLmdldEludGVyc2VjdHNPcD1mdW5jdGlvbigpe3Rocm93IG5ldyBqc3RzLmVycm9yLkFic3RyYWN0TWV0aG9kSW52b2NhdGlvbkVycm9yKCk7fTtqc3RzLmluZGV4LnN0cnRyZWUuQWJzdHJhY3RTVFJ0cmVlLnByb3RvdHlwZS5pdGVtc1RyZWU9ZnVuY3Rpb24oKXtpZihhcmd1bWVudHMubGVuZ3RoPT09MSl7cmV0dXJuIHRoaXMuaXRlbXNUcmVlMi5hcHBseSh0aGlzLGFyZ3VtZW50cyk7fVxuaWYoIXRoaXMuYnVpbHQpe3RoaXMuYnVpbGQoKTt9XG52YXIgdmFsdWVzVHJlZT10aGlzLml0ZW1zVHJlZTIodGhpcy5yb290KTtpZih2YWx1ZXNUcmVlPT09bnVsbClcbnJldHVybltdO3JldHVybiB2YWx1ZXNUcmVlO307anN0cy5pbmRleC5zdHJ0cmVlLkFic3RyYWN0U1RSdHJlZS5wcm90b3R5cGUuaXRlbXNUcmVlMj1mdW5jdGlvbihub2RlKXt2YXIgdmFsdWVzVHJlZUZvck5vZGU9W107dmFyIGNoaWxkQm91bmRhYmxlcz1ub2RlLmdldENoaWxkQm91bmRhYmxlcygpO2Zvcih2YXIgaT0wO2k8Y2hpbGRCb3VuZGFibGVzLmxlbmd0aDtpKyspe3ZhciBjaGlsZEJvdW5kYWJsZT1jaGlsZEJvdW5kYWJsZXNbaV07aWYoY2hpbGRCb3VuZGFibGUgaW5zdGFuY2VvZiBqc3RzLmluZGV4LnN0cnRyZWUuQWJzdHJhY3ROb2RlKXt2YXIgdmFsdWVzVHJlZUZvckNoaWxkPXRoaXMuaXRlbXNUcmVlKGNoaWxkQm91bmRhYmxlKTtpZih2YWx1ZXNUcmVlRm9yQ2hpbGQhPW51bGwpXG52YWx1ZXNUcmVlRm9yTm9kZS5wdXNoKHZhbHVlc1RyZWVGb3JDaGlsZCk7fWVsc2UgaWYoY2hpbGRCb3VuZGFibGUgaW5zdGFuY2VvZiBqc3RzLmluZGV4LnN0cnRyZWUuSXRlbUJvdW5kYWJsZSl7dmFsdWVzVHJlZUZvck5vZGUucHVzaChjaGlsZEJvdW5kYWJsZS5nZXRJdGVtKCkpO31lbHNle2pzdHMudXRpbC5Bc3NlcnQuc2hvdWxkTmV2ZXJSZWFjaEhlcmUoKTt9fVxuaWYodmFsdWVzVHJlZUZvck5vZGUubGVuZ3RoPD0wKVxucmV0dXJuIG51bGw7cmV0dXJuIHZhbHVlc1RyZWVGb3JOb2RlO307anN0cy5pbmRleC5zdHJ0cmVlLkFic3RyYWN0U1RSdHJlZS5wcm90b3R5cGUucmVtb3ZlPWZ1bmN0aW9uKHNlYXJjaEJvdW5kcyxpdGVtKXtpZighdGhpcy5idWlsdCl7dGhpcy5idWlsZCgpO31cbmlmKHRoaXMuaXRlbUJvdW5kYWJsZXMubGVuZ3RoPT09MCl7anN0cy51dGlsLkFzc2VydC5pc1RydWUodGhpcy5yb290LmdldEJvdW5kcygpPT1udWxsKTt9XG5pZih0aGlzLmdldEludGVyc2VjdHNPcCgpLmludGVyc2VjdHModGhpcy5yb290LmdldEJvdW5kcygpLHNlYXJjaEJvdW5kcykpe3JldHVybiB0aGlzLnJlbW92ZTIoc2VhcmNoQm91bmRzLHRoaXMucm9vdCxpdGVtKTt9XG5yZXR1cm4gZmFsc2U7fTtqc3RzLmluZGV4LnN0cnRyZWUuQWJzdHJhY3RTVFJ0cmVlLnByb3RvdHlwZS5yZW1vdmUyPWZ1bmN0aW9uKHNlYXJjaEJvdW5kcyxub2RlLGl0ZW0pe3ZhciBmb3VuZD10aGlzLnJlbW92ZUl0ZW0obm9kZSxpdGVtKTtpZihmb3VuZClcbnJldHVybiB0cnVlO3ZhciBjaGlsZFRvUHJ1bmU9bnVsbDt2YXIgY2hpbGRCb3VuZGFibGVzPW5vZGUuZ2V0Q2hpbGRCb3VuZGFibGVzKCk7Zm9yKHZhciBpPTA7aTxjaGlsZEJvdW5kYWJsZXMubGVuZ3RoO2krKyl7dmFyIGNoaWxkQm91bmRhYmxlPWNoaWxkQm91bmRhYmxlc1tpXTtpZighdGhpcy5nZXRJbnRlcnNlY3RzT3AoKS5pbnRlcnNlY3RzKGNoaWxkQm91bmRhYmxlLmdldEJvdW5kcygpLHNlYXJjaEJvdW5kcykpe2NvbnRpbnVlO31cbmlmKGNoaWxkQm91bmRhYmxlIGluc3RhbmNlb2YganN0cy5pbmRleC5zdHJ0cmVlLkFic3RyYWN0Tm9kZSl7Zm91bmQ9dGhpcy5yZW1vdmUoc2VhcmNoQm91bmRzLGNoaWxkQm91bmRhYmxlLGl0ZW0pO2lmKGZvdW5kKXtjaGlsZFRvUHJ1bmU9Y2hpbGRCb3VuZGFibGU7YnJlYWs7fX19XG5pZihjaGlsZFRvUHJ1bmUhPW51bGwpe2lmKGNoaWxkVG9QcnVuZS5nZXRDaGlsZEJvdW5kYWJsZXMoKS5sZW5ndGg9PT0wKXtjaGlsZEJvdW5kYWJsZXMuc3BsaWNlKGNoaWxkQm91bmRhYmxlcy5pbmRleE9mKGNoaWxkVG9QcnVuZSksMSk7fX1cbnJldHVybiBmb3VuZDt9O2pzdHMuaW5kZXguc3RydHJlZS5BYnN0cmFjdFNUUnRyZWUucHJvdG90eXBlLnJlbW92ZUl0ZW09ZnVuY3Rpb24obm9kZSxpdGVtKXt2YXIgY2hpbGRUb1JlbW92ZT1udWxsO3ZhciBjaGlsZEJvdW5kYWJsZXM9bm9kZS5nZXRDaGlsZEJvdW5kYWJsZXMoKTtmb3IodmFyIGk9MDtpPGNoaWxkQm91bmRhYmxlcy5sZW5ndGg7aSsrKXt2YXIgY2hpbGRCb3VuZGFibGU9Y2hpbGRCb3VuZGFibGVzW2ldO2lmKGNoaWxkQm91bmRhYmxlIGluc3RhbmNlb2YganN0cy5pbmRleC5zdHJ0cmVlLkl0ZW1Cb3VuZGFibGUpe2lmKGNoaWxkQm91bmRhYmxlLmdldEl0ZW0oKT09PWl0ZW0pXG5jaGlsZFRvUmVtb3ZlPWNoaWxkQm91bmRhYmxlO319XG5pZihjaGlsZFRvUmVtb3ZlIT09bnVsbCl7Y2hpbGRCb3VuZGFibGVzLnNwbGljZShjaGlsZEJvdW5kYWJsZXMuaW5kZXhPZihjaGlsZFRvUmVtb3ZlKSwxKTtyZXR1cm4gdHJ1ZTt9XG5yZXR1cm4gZmFsc2U7fTtqc3RzLmluZGV4LnN0cnRyZWUuQWJzdHJhY3RTVFJ0cmVlLnByb3RvdHlwZS5ib3VuZGFibGVzQXRMZXZlbD1mdW5jdGlvbihsZXZlbCl7aWYoYXJndW1lbnRzLmxlbmd0aD4xKXt0aGlzLmJvdW5kYWJsZXNBdExldmVsMi5hcHBseSh0aGlzLGFyZ3VtZW50cyk7cmV0dXJuO31cbnZhciBib3VuZGFibGVzPVtdO3RoaXMuYm91bmRhYmxlc0F0TGV2ZWwyKGxldmVsLHRoaXMucm9vdCxib3VuZGFibGVzKTtyZXR1cm4gYm91bmRhYmxlczt9O2pzdHMuaW5kZXguc3RydHJlZS5BYnN0cmFjdFNUUnRyZWUucHJvdG90eXBlLmJvdW5kYWJsZXNBdExldmVsMj1mdW5jdGlvbihsZXZlbCx0b3AsYm91bmRhYmxlcyl7anN0cy51dGlsLkFzc2VydC5pc1RydWUobGV2ZWw+LTIpO2lmKHRvcC5nZXRMZXZlbCgpPT09bGV2ZWwpe2JvdW5kYWJsZXMuYWRkKHRvcCk7cmV0dXJuO31cbnZhciBjaGlsZEJvdW5kYWJsZXM9bm9kZS5nZXRDaGlsZEJvdW5kYWJsZXMoKTtmb3IodmFyIGk9MDtpPGNoaWxkQm91bmRhYmxlcy5sZW5ndGg7aSsrKXt2YXIgYm91bmRhYmxlPWNoaWxkQm91bmRhYmxlc1tpXTtpZihib3VuZGFibGUgaW5zdGFuY2VvZiBqc3RzLmluZGV4LnN0cnRyZWUuQWJzdHJhY3ROb2RlKXt0aGlzLmJvdW5kYWJsZXNBdExldmVsKGxldmVsLGJvdW5kYWJsZSxib3VuZGFibGVzKTt9ZWxzZXtqc3RzLnV0aWwuQXNzZXJ0LmlzVHJ1ZShib3VuZGFibGUgaW5zdGFuY2VvZiBqc3RzLmluZGV4LnN0cnRyZWUuSXRlbUJvdW5kYWJsZSk7aWYobGV2ZWw9PT0tMSl7Ym91bmRhYmxlcy5hZGQoYm91bmRhYmxlKTt9fX1cbnJldHVybjt9O2pzdHMuaW5kZXguc3RydHJlZS5BYnN0cmFjdFNUUnRyZWUucHJvdG90eXBlLmdldENvbXBhcmF0b3I9ZnVuY3Rpb24oKXt0aHJvdyBuZXcganN0cy5lcnJvci5BYnN0cmFjdE1ldGhvZEludm9jYXRpb25FcnJvcigpO307anN0cy5pbmRleC5zdHJ0cmVlLlNUUnRyZWU9ZnVuY3Rpb24obm9kZUNhcGFjaXR5KXtub2RlQ2FwYWNpdHk9bm9kZUNhcGFjaXR5fHxqc3RzLmluZGV4LnN0cnRyZWUuU1RSdHJlZS5ERUZBVUxUX05PREVfQ0FQQUNJVFk7anN0cy5pbmRleC5zdHJ0cmVlLkFic3RyYWN0U1RSdHJlZS5jYWxsKHRoaXMsbm9kZUNhcGFjaXR5KTt9O2pzdHMuaW5kZXguc3RydHJlZS5TVFJ0cmVlLnByb3RvdHlwZT1uZXcganN0cy5pbmRleC5zdHJ0cmVlLkFic3RyYWN0U1RSdHJlZSgpO2pzdHMuaW5kZXguc3RydHJlZS5TVFJ0cmVlLmNvbnN0cnVjdG9yPWpzdHMuaW5kZXguc3RydHJlZS5TVFJ0cmVlO2pzdHMuaW5kZXguc3RydHJlZS5TVFJ0cmVlLnByb3RvdHlwZS54Q29tcGFyYXRvcj1mdW5jdGlvbihvMSxvMil7cmV0dXJuIGpzdHMuaW5kZXguc3RydHJlZS5BYnN0cmFjdFNUUnRyZWUucHJvdG90eXBlLmNvbXBhcmVEb3VibGVzKGpzdHMuaW5kZXguc3RydHJlZS5TVFJ0cmVlLnByb3RvdHlwZS5jZW50cmVYKG8xLmdldEJvdW5kcygpKSxqc3RzLmluZGV4LnN0cnRyZWUuU1RSdHJlZS5wcm90b3R5cGUuY2VudHJlWChvMi5nZXRCb3VuZHMoKSkpO307anN0cy5pbmRleC5zdHJ0cmVlLlNUUnRyZWUucHJvdG90eXBlLnlDb21wYXJhdG9yPWZ1bmN0aW9uKG8xLG8yKXtyZXR1cm4ganN0cy5pbmRleC5zdHJ0cmVlLkFic3RyYWN0U1RSdHJlZS5wcm90b3R5cGUuY29tcGFyZURvdWJsZXMoanN0cy5pbmRleC5zdHJ0cmVlLlNUUnRyZWUucHJvdG90eXBlLmNlbnRyZVkobzEuZ2V0Qm91bmRzKCkpLGpzdHMuaW5kZXguc3RydHJlZS5TVFJ0cmVlLnByb3RvdHlwZS5jZW50cmVZKG8yLmdldEJvdW5kcygpKSk7fTtqc3RzLmluZGV4LnN0cnRyZWUuU1RSdHJlZS5wcm90b3R5cGUuY2VudHJlWD1mdW5jdGlvbihlKXtyZXR1cm4ganN0cy5pbmRleC5zdHJ0cmVlLlNUUnRyZWUucHJvdG90eXBlLmF2ZyhlLmdldE1pblgoKSxlLmdldE1heFgoKSk7fTtqc3RzLmluZGV4LnN0cnRyZWUuU1RSdHJlZS5wcm90b3R5cGUuY2VudHJlWT1mdW5jdGlvbihlKXtyZXR1cm4ganN0cy5pbmRleC5zdHJ0cmVlLlNUUnRyZWUucHJvdG90eXBlLmF2ZyhlLmdldE1pblkoKSxlLmdldE1heFkoKSk7fTtqc3RzLmluZGV4LnN0cnRyZWUuU1RSdHJlZS5wcm90b3R5cGUuYXZnPWZ1bmN0aW9uKGEsYil7cmV0dXJuKGErYikvMi4wO307anN0cy5pbmRleC5zdHJ0cmVlLlNUUnRyZWUucHJvdG90eXBlLmludGVyc2VjdHNPcD17aW50ZXJzZWN0czpmdW5jdGlvbihhQm91bmRzLGJCb3VuZHMpe3JldHVybiBhQm91bmRzLmludGVyc2VjdHMoYkJvdW5kcyk7fX07anN0cy5pbmRleC5zdHJ0cmVlLlNUUnRyZWUucHJvdG90eXBlLmNyZWF0ZVBhcmVudEJvdW5kYWJsZXM9ZnVuY3Rpb24oY2hpbGRCb3VuZGFibGVzLG5ld0xldmVsKXtqc3RzLnV0aWwuQXNzZXJ0LmlzVHJ1ZSghKGNoaWxkQm91bmRhYmxlcy5sZW5ndGg9PT0wKSk7dmFyIG1pbkxlYWZDb3VudD1NYXRoLmNlaWwoY2hpbGRCb3VuZGFibGVzLmxlbmd0aC90aGlzLmdldE5vZGVDYXBhY2l0eSgpKTt2YXIgc29ydGVkQ2hpbGRCb3VuZGFibGVzPVtdO2Zvcih2YXIgaT0wO2k8Y2hpbGRCb3VuZGFibGVzLmxlbmd0aDtpKyspe3NvcnRlZENoaWxkQm91bmRhYmxlcy5wdXNoKGNoaWxkQm91bmRhYmxlc1tpXSk7fVxuc29ydGVkQ2hpbGRCb3VuZGFibGVzLnNvcnQodGhpcy54Q29tcGFyYXRvcik7dmFyIHZlcnRpY2FsU2xpY2VzPXRoaXMudmVydGljYWxTbGljZXMoc29ydGVkQ2hpbGRCb3VuZGFibGVzLE1hdGguY2VpbChNYXRoLnNxcnQobWluTGVhZkNvdW50KSkpO3JldHVybiB0aGlzLmNyZWF0ZVBhcmVudEJvdW5kYWJsZXNGcm9tVmVydGljYWxTbGljZXModmVydGljYWxTbGljZXMsbmV3TGV2ZWwpO307anN0cy5pbmRleC5zdHJ0cmVlLlNUUnRyZWUucHJvdG90eXBlLmNyZWF0ZVBhcmVudEJvdW5kYWJsZXNGcm9tVmVydGljYWxTbGljZXM9ZnVuY3Rpb24odmVydGljYWxTbGljZXMsbmV3TGV2ZWwpe2pzdHMudXRpbC5Bc3NlcnQuaXNUcnVlKHZlcnRpY2FsU2xpY2VzLmxlbmd0aD4wKTt2YXIgcGFyZW50Qm91bmRhYmxlcz1bXTtmb3IodmFyIGk9MDtpPHZlcnRpY2FsU2xpY2VzLmxlbmd0aDtpKyspe3BhcmVudEJvdW5kYWJsZXM9cGFyZW50Qm91bmRhYmxlcy5jb25jYXQodGhpcy5jcmVhdGVQYXJlbnRCb3VuZGFibGVzRnJvbVZlcnRpY2FsU2xpY2UodmVydGljYWxTbGljZXNbaV0sbmV3TGV2ZWwpKTt9XG5yZXR1cm4gcGFyZW50Qm91bmRhYmxlczt9O2pzdHMuaW5kZXguc3RydHJlZS5TVFJ0cmVlLnByb3RvdHlwZS5jcmVhdGVQYXJlbnRCb3VuZGFibGVzRnJvbVZlcnRpY2FsU2xpY2U9ZnVuY3Rpb24oY2hpbGRCb3VuZGFibGVzLG5ld0xldmVsKXtyZXR1cm4ganN0cy5pbmRleC5zdHJ0cmVlLkFic3RyYWN0U1RSdHJlZS5wcm90b3R5cGUuY3JlYXRlUGFyZW50Qm91bmRhYmxlcy5jYWxsKHRoaXMsY2hpbGRCb3VuZGFibGVzLG5ld0xldmVsKTt9O2pzdHMuaW5kZXguc3RydHJlZS5TVFJ0cmVlLnByb3RvdHlwZS52ZXJ0aWNhbFNsaWNlcz1mdW5jdGlvbihjaGlsZEJvdW5kYWJsZXMsc2xpY2VDb3VudCl7dmFyIHNsaWNlQ2FwYWNpdHk9TWF0aC5jZWlsKGNoaWxkQm91bmRhYmxlcy5sZW5ndGgvc2xpY2VDb3VudCk7dmFyIHNsaWNlcz1bXTt2YXIgaT0wLGJvdW5kYWJsZXNBZGRlZFRvU2xpY2UsY2hpbGRCb3VuZGFibGU7Zm9yKHZhciBqPTA7ajxzbGljZUNvdW50O2orKyl7c2xpY2VzW2pdPVtdO2JvdW5kYWJsZXNBZGRlZFRvU2xpY2U9MDt3aGlsZShpPGNoaWxkQm91bmRhYmxlcy5sZW5ndGgmJmJvdW5kYWJsZXNBZGRlZFRvU2xpY2U8c2xpY2VDYXBhY2l0eSl7Y2hpbGRCb3VuZGFibGU9Y2hpbGRCb3VuZGFibGVzW2krK107c2xpY2VzW2pdLnB1c2goY2hpbGRCb3VuZGFibGUpO2JvdW5kYWJsZXNBZGRlZFRvU2xpY2UrKzt9fVxucmV0dXJuIHNsaWNlczt9O2pzdHMuaW5kZXguc3RydHJlZS5TVFJ0cmVlLkRFRkFVTFRfTk9ERV9DQVBBQ0lUWT0xMDtqc3RzLmluZGV4LnN0cnRyZWUuU1RSdHJlZS5wcm90b3R5cGUuY3JlYXRlTm9kZT1mdW5jdGlvbihsZXZlbCl7dmFyIGFic3RyYWN0Tm9kZT1uZXcganN0cy5pbmRleC5zdHJ0cmVlLkFic3RyYWN0Tm9kZShsZXZlbCk7YWJzdHJhY3ROb2RlLmNvbXB1dGVCb3VuZHM9ZnVuY3Rpb24oKXt2YXIgYm91bmRzPW51bGw7dmFyIGNoaWxkQm91bmRhYmxlcz10aGlzLmdldENoaWxkQm91bmRhYmxlcygpO2Zvcih2YXIgaT0wO2k8Y2hpbGRCb3VuZGFibGVzLmxlbmd0aDtpKyspe3ZhciBjaGlsZEJvdW5kYWJsZT1jaGlsZEJvdW5kYWJsZXNbaV07aWYoYm91bmRzPT09bnVsbCl7Ym91bmRzPW5ldyBqc3RzLmdlb20uRW52ZWxvcGUoY2hpbGRCb3VuZGFibGUuZ2V0Qm91bmRzKCkpO31lbHNle2JvdW5kcy5leHBhbmRUb0luY2x1ZGUoY2hpbGRCb3VuZGFibGUuZ2V0Qm91bmRzKCkpO319XG5yZXR1cm4gYm91bmRzO307cmV0dXJuIGFic3RyYWN0Tm9kZTt9O2pzdHMuaW5kZXguc3RydHJlZS5TVFJ0cmVlLnByb3RvdHlwZS5nZXRJbnRlcnNlY3RzT3A9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5pbnRlcnNlY3RzT3A7fTtqc3RzLmluZGV4LnN0cnRyZWUuU1RSdHJlZS5wcm90b3R5cGUuaW5zZXJ0PWZ1bmN0aW9uKGl0ZW1FbnYsaXRlbSl7aWYoaXRlbUVudi5pc051bGwoKSl7cmV0dXJuO31cbmpzdHMuaW5kZXguc3RydHJlZS5BYnN0cmFjdFNUUnRyZWUucHJvdG90eXBlLmluc2VydC5jYWxsKHRoaXMsaXRlbUVudixpdGVtKTt9O2pzdHMuaW5kZXguc3RydHJlZS5TVFJ0cmVlLnByb3RvdHlwZS5xdWVyeT1mdW5jdGlvbihzZWFyY2hFbnYsdmlzaXRvcil7cmV0dXJuIGpzdHMuaW5kZXguc3RydHJlZS5BYnN0cmFjdFNUUnRyZWUucHJvdG90eXBlLnF1ZXJ5LmFwcGx5KHRoaXMsYXJndW1lbnRzKTt9O2pzdHMuaW5kZXguc3RydHJlZS5TVFJ0cmVlLnByb3RvdHlwZS5yZW1vdmU9ZnVuY3Rpb24oaXRlbUVudixpdGVtKXtyZXR1cm4ganN0cy5pbmRleC5zdHJ0cmVlLkFic3RyYWN0U1RSdHJlZS5wcm90b3R5cGUucmVtb3ZlLmNhbGwodGhpcyxpdGVtRW52LGl0ZW0pO307anN0cy5pbmRleC5zdHJ0cmVlLlNUUnRyZWUucHJvdG90eXBlLnNpemU9ZnVuY3Rpb24oKXtyZXR1cm4ganN0cy5pbmRleC5zdHJ0cmVlLkFic3RyYWN0U1RSdHJlZS5wcm90b3R5cGUuc2l6ZS5jYWxsKHRoaXMpO307anN0cy5pbmRleC5zdHJ0cmVlLlNUUnRyZWUucHJvdG90eXBlLmRlcHRoPWZ1bmN0aW9uKCl7cmV0dXJuIGpzdHMuaW5kZXguc3RydHJlZS5BYnN0cmFjdFNUUnRyZWUucHJvdG90eXBlLmRlcHRoLmNhbGwodGhpcyk7fTtqc3RzLmluZGV4LnN0cnRyZWUuU1RSdHJlZS5wcm90b3R5cGUuZ2V0Q29tcGFyYXRvcj1mdW5jdGlvbigpe3JldHVybiB0aGlzLnlDb21wYXJhdG9yO307anN0cy5pbmRleC5zdHJ0cmVlLlNUUnRyZWUucHJvdG90eXBlLm5lYXJlc3ROZWlnaGJvdXI9ZnVuY3Rpb24oaXRlbURpc3Qpe3ZhciBicD1uZXcganN0cy5pbmRleC5zdHJ0cmVlLkJvdW5kYWJsZVBhaXIodGhpcy5nZXRSb290KCksdGhpcy5nZXRSb290KCksaXRlbURpc3QpO3JldHVybiB0aGlzLm5lYXJlc3ROZWlnaGJvdXI0KGJwKTt9O2pzdHMuaW5kZXguc3RydHJlZS5TVFJ0cmVlLnByb3RvdHlwZS5uZWFyZXN0TmVpZ2hib3VyMj1mdW5jdGlvbihlbnYsaXRlbSxpdGVtRGlzdCl7dmFyIGJuZD1uZXcganN0cy5pbmRleC5zdHJ0cmVlLkl0ZW1Cb3VuZGFibGUoZW52LGl0ZW0pO3ZhciBicD1uZXcganN0cy5pbmRleC5zdHJ0cmVlLkJvdW5kYWJsZVBhaXIodGhpcy5nZXRSb290KCksYm5kLGl0ZW1EaXN0KTtyZXR1cm4gdGhpcy5uZWFyZXN0TmVpZ2hib3VyNChicClbMF07fTtqc3RzLmluZGV4LnN0cnRyZWUuU1RSdHJlZS5wcm90b3R5cGUubmVhcmVzdE5laWdoYm91cjM9ZnVuY3Rpb24odHJlZSxpdGVtRGlzdCl7dmFyIGJwPW5ldyBqc3RzLmluZGV4LnN0cnRyZWUuQm91bmRhYmxlUGFpcih0aGlzLmdldFJvb3QoKSx0cmVlLmdldFJvb3QoKSxpdGVtRGlzdCk7cmV0dXJuIHRoaXMubmVhcmVzdE5laWdoYm91cjQoYnApO307anN0cy5pbmRleC5zdHJ0cmVlLlNUUnRyZWUucHJvdG90eXBlLm5lYXJlc3ROZWlnaGJvdXI0PWZ1bmN0aW9uKGluaXRCbmRQYWlyKXtyZXR1cm4gdGhpcy5uZWFyZXN0TmVpZ2hib3VyNShpbml0Qm5kUGFpcixEb3VibGUuUE9TSVRJVkVfSU5GSU5JVFkpO307anN0cy5pbmRleC5zdHJ0cmVlLlNUUnRyZWUucHJvdG90eXBlLm5lYXJlc3ROZWlnaGJvdXI1PWZ1bmN0aW9uKGluaXRCbmRQYWlyLG1heERpc3RhbmNlKXt2YXIgZGlzdGFuY2VMb3dlckJvdW5kPW1heERpc3RhbmNlO3ZhciBtaW5QYWlyPW51bGw7dmFyIHByaVE9W107cHJpUS5wdXNoKGluaXRCbmRQYWlyKTt3aGlsZSghcHJpUS5pc0VtcHR5KCkmJmRpc3RhbmNlTG93ZXJCb3VuZD4wLjApe3ZhciBibmRQYWlyPXByaVEucG9wKCk7dmFyIGN1cnJlbnREaXN0YW5jZT1ibmRQYWlyLmdldERpc3RhbmNlKCk7aWYoY3VycmVudERpc3RhbmNlPj1kaXN0YW5jZUxvd2VyQm91bmQpXG5icmVhaztpZihibmRQYWlyLmlzTGVhdmVzKCkpe2Rpc3RhbmNlTG93ZXJCb3VuZD1jdXJyZW50RGlzdGFuY2U7bWluUGFpcj1ibmRQYWlyO31lbHNle2JuZFBhaXIuZXhwYW5kVG9RdWV1ZShwcmlRLGRpc3RhbmNlTG93ZXJCb3VuZCk7fX1cbnJldHVyblttaW5QYWlyLmdldEJvdW5kYWJsZSgwKS5nZXRJdGVtKCksbWluUGFpci5nZXRCb3VuZGFibGUoMSkuZ2V0SXRlbSgpXTt9O2pzdHMubm9kaW5nLlNlZ21lbnRTdHJpbmc9ZnVuY3Rpb24oKXt9O2pzdHMubm9kaW5nLlNlZ21lbnRTdHJpbmcucHJvdG90eXBlLmdldERhdGE9anN0cy5hYnN0cmFjdEZ1bmM7anN0cy5ub2RpbmcuU2VnbWVudFN0cmluZy5wcm90b3R5cGUuc2V0RGF0YT1qc3RzLmFic3RyYWN0RnVuYztqc3RzLm5vZGluZy5TZWdtZW50U3RyaW5nLnByb3RvdHlwZS5zaXplPWpzdHMuYWJzdHJhY3RGdW5jO2pzdHMubm9kaW5nLlNlZ21lbnRTdHJpbmcucHJvdG90eXBlLmdldENvb3JkaW5hdGU9anN0cy5hYnN0cmFjdEZ1bmM7anN0cy5ub2RpbmcuU2VnbWVudFN0cmluZy5wcm90b3R5cGUuZ2V0Q29vcmRpbmF0ZXM9anN0cy5hYnN0cmFjdEZ1bmM7anN0cy5ub2RpbmcuU2VnbWVudFN0cmluZy5wcm90b3R5cGUuaXNDbG9zZWQ9anN0cy5hYnN0cmFjdEZ1bmM7anN0cy5ub2RpbmcuTm9kYWJsZVNlZ21lbnRTdHJpbmc9ZnVuY3Rpb24oKXt9O2pzdHMubm9kaW5nLk5vZGFibGVTZWdtZW50U3RyaW5nLnByb3RvdHlwZT1uZXcganN0cy5ub2RpbmcuU2VnbWVudFN0cmluZygpO2pzdHMubm9kaW5nLk5vZGFibGVTZWdtZW50U3RyaW5nLnByb3RvdHlwZS5hZGRJbnRlcnNlY3Rpb249anN0cy5hYnN0cmFjdEZ1bmM7anN0cy5ub2RpbmcuTm9kZWRTZWdtZW50U3RyaW5nPWZ1bmN0aW9uKHB0cyxkYXRhKXt0aGlzLm5vZGVMaXN0PW5ldyBqc3RzLm5vZGluZy5TZWdtZW50Tm9kZUxpc3QodGhpcyk7dGhpcy5wdHM9cHRzO3RoaXMuZGF0YT1kYXRhO307anN0cy5ub2RpbmcuTm9kZWRTZWdtZW50U3RyaW5nLnByb3RvdHlwZT1uZXcganN0cy5ub2RpbmcuTm9kYWJsZVNlZ21lbnRTdHJpbmcoKTtqc3RzLm5vZGluZy5Ob2RlZFNlZ21lbnRTdHJpbmcuY29uc3RydWN0b3I9anN0cy5ub2RpbmcuTm9kZWRTZWdtZW50U3RyaW5nO2pzdHMubm9kaW5nLk5vZGVkU2VnbWVudFN0cmluZy5nZXROb2RlZFN1YnN0cmluZ3M9ZnVuY3Rpb24oc2VnU3RyaW5ncyl7aWYoYXJndW1lbnRzLmxlbmd0aD09PTIpe2pzdHMubm9kaW5nLk5vZGVkU2VnbWVudFN0cmluZy5nZXROb2RlZFN1YnN0cmluZ3MyLmFwcGx5KHRoaXMsYXJndW1lbnRzKTtyZXR1cm47fVxudmFyIHJlc3VsdEVkZ2VsaXN0PW5ldyBqYXZhc2NyaXB0LnV0aWwuQXJyYXlMaXN0KCk7anN0cy5ub2RpbmcuTm9kZWRTZWdtZW50U3RyaW5nLmdldE5vZGVkU3Vic3RyaW5nczIoc2VnU3RyaW5ncyxyZXN1bHRFZGdlbGlzdCk7cmV0dXJuIHJlc3VsdEVkZ2VsaXN0O307anN0cy5ub2RpbmcuTm9kZWRTZWdtZW50U3RyaW5nLmdldE5vZGVkU3Vic3RyaW5nczI9ZnVuY3Rpb24oc2VnU3RyaW5ncyxyZXN1bHRFZGdlbGlzdCl7Zm9yKHZhciBpPXNlZ1N0cmluZ3MuaXRlcmF0b3IoKTtpLmhhc05leHQoKTspe3ZhciBzcz1pLm5leHQoKTtzcy5nZXROb2RlTGlzdCgpLmFkZFNwbGl0RWRnZXMocmVzdWx0RWRnZWxpc3QpO319O2pzdHMubm9kaW5nLk5vZGVkU2VnbWVudFN0cmluZy5wcm90b3R5cGUubm9kZUxpc3Q9bnVsbDtqc3RzLm5vZGluZy5Ob2RlZFNlZ21lbnRTdHJpbmcucHJvdG90eXBlLnB0cz1udWxsO2pzdHMubm9kaW5nLk5vZGVkU2VnbWVudFN0cmluZy5wcm90b3R5cGUuZGF0YT1udWxsO2pzdHMubm9kaW5nLk5vZGVkU2VnbWVudFN0cmluZy5wcm90b3R5cGUuZ2V0RGF0YT1mdW5jdGlvbigpe3JldHVybiB0aGlzLmRhdGE7fTtqc3RzLm5vZGluZy5Ob2RlZFNlZ21lbnRTdHJpbmcucHJvdG90eXBlLnNldERhdGE9ZnVuY3Rpb24oZGF0YSl7dGhpcy5kYXRhPWRhdGE7fTtqc3RzLm5vZGluZy5Ob2RlZFNlZ21lbnRTdHJpbmcucHJvdG90eXBlLmdldE5vZGVMaXN0PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMubm9kZUxpc3Q7fTtqc3RzLm5vZGluZy5Ob2RlZFNlZ21lbnRTdHJpbmcucHJvdG90eXBlLnNpemU9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5wdHMubGVuZ3RoO307anN0cy5ub2RpbmcuTm9kZWRTZWdtZW50U3RyaW5nLnByb3RvdHlwZS5nZXRDb29yZGluYXRlPWZ1bmN0aW9uKGkpe3JldHVybiB0aGlzLnB0c1tpXTt9O2pzdHMubm9kaW5nLk5vZGVkU2VnbWVudFN0cmluZy5wcm90b3R5cGUuZ2V0Q29vcmRpbmF0ZXM9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5wdHM7fTtqc3RzLm5vZGluZy5Ob2RlZFNlZ21lbnRTdHJpbmcucHJvdG90eXBlLmlzQ2xvc2VkPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMucHRzWzBdLmVxdWFscyh0aGlzLnB0c1t0aGlzLnB0cy5sZW5ndGgtMV0pO307anN0cy5ub2RpbmcuTm9kZWRTZWdtZW50U3RyaW5nLnByb3RvdHlwZS5nZXRTZWdtZW50T2N0YW50PWZ1bmN0aW9uKGluZGV4KXtpZihpbmRleD09PXRoaXMucHRzLmxlbmd0aC0xKVxucmV0dXJuLTE7cmV0dXJuIHRoaXMuc2FmZU9jdGFudCh0aGlzLmdldENvb3JkaW5hdGUoaW5kZXgpLHRoaXMuZ2V0Q29vcmRpbmF0ZShpbmRleCsxKSk7fTtqc3RzLm5vZGluZy5Ob2RlZFNlZ21lbnRTdHJpbmcucHJvdG90eXBlLnNhZmVPY3RhbnQ9ZnVuY3Rpb24ocDAscDEpe2lmKHAwLmVxdWFsczJEKHAxKSlcbnJldHVybiAwO3JldHVybiBqc3RzLm5vZGluZy5PY3RhbnQub2N0YW50KHAwLHAxKTt9O2pzdHMubm9kaW5nLk5vZGVkU2VnbWVudFN0cmluZy5wcm90b3R5cGUuYWRkSW50ZXJzZWN0aW9ucz1mdW5jdGlvbihsaSxzZWdtZW50SW5kZXgsZ2VvbUluZGV4KXtmb3IodmFyIGk9MDtpPGxpLmdldEludGVyc2VjdGlvbk51bSgpO2krKyl7dGhpcy5hZGRJbnRlcnNlY3Rpb24obGksc2VnbWVudEluZGV4LGdlb21JbmRleCxpKTt9fTtqc3RzLm5vZGluZy5Ob2RlZFNlZ21lbnRTdHJpbmcucHJvdG90eXBlLmFkZEludGVyc2VjdGlvbj1mdW5jdGlvbihsaSxzZWdtZW50SW5kZXgsZ2VvbUluZGV4LGludEluZGV4KXtpZihsaSBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5Db29yZGluYXRlKXt0aGlzLmFkZEludGVyc2VjdGlvbjIuYXBwbHkodGhpcyxhcmd1bWVudHMpO3JldHVybjt9XG52YXIgaW50UHQ9bmV3IGpzdHMuZ2VvbS5Db29yZGluYXRlKGxpLmdldEludGVyc2VjdGlvbihpbnRJbmRleCkpO3RoaXMuYWRkSW50ZXJzZWN0aW9uMihpbnRQdCxzZWdtZW50SW5kZXgpO307anN0cy5ub2RpbmcuTm9kZWRTZWdtZW50U3RyaW5nLnByb3RvdHlwZS5hZGRJbnRlcnNlY3Rpb24yPWZ1bmN0aW9uKGludFB0LHNlZ21lbnRJbmRleCl7dGhpcy5hZGRJbnRlcnNlY3Rpb25Ob2RlKGludFB0LHNlZ21lbnRJbmRleCk7fTtqc3RzLm5vZGluZy5Ob2RlZFNlZ21lbnRTdHJpbmcucHJvdG90eXBlLmFkZEludGVyc2VjdGlvbk5vZGU9ZnVuY3Rpb24oaW50UHQsc2VnbWVudEluZGV4KXt2YXIgbm9ybWFsaXplZFNlZ21lbnRJbmRleD1zZWdtZW50SW5kZXg7dmFyIG5leHRTZWdJbmRleD1ub3JtYWxpemVkU2VnbWVudEluZGV4KzE7aWYobmV4dFNlZ0luZGV4PHRoaXMucHRzLmxlbmd0aCl7dmFyIG5leHRQdD10aGlzLnB0c1tuZXh0U2VnSW5kZXhdO2lmKGludFB0LmVxdWFsczJEKG5leHRQdCkpe25vcm1hbGl6ZWRTZWdtZW50SW5kZXg9bmV4dFNlZ0luZGV4O319XG52YXIgZWk9dGhpcy5ub2RlTGlzdC5hZGQoaW50UHQsbm9ybWFsaXplZFNlZ21lbnRJbmRleCk7cmV0dXJuIGVpO307anN0cy5ub2RpbmcuTm9kZWRTZWdtZW50U3RyaW5nLnByb3RvdHlwZS50b1N0cmluZz1mdW5jdGlvbigpe3ZhciBnZW9tZXRyeUZhY3Rvcnk9bmV3IGpzdHMuZ2VvbS5HZW9tZXRyeUZhY3RvcnkoKTtyZXR1cm4gbmV3IGpzdHMuaW8uV0tUV3JpdGVyKCkud3JpdGUoZ2VvbWV0cnlGYWN0b3J5LmNyZWF0ZUxpbmVTdHJpbmcodGhpcy5wdHMpKTt9O2pzdHMuaW5kZXguY2hhaW4uTW9ub3RvbmVDaGFpbkJ1aWxkZXI9ZnVuY3Rpb24oKXt9O2pzdHMuaW5kZXguY2hhaW4uTW9ub3RvbmVDaGFpbkJ1aWxkZXIudG9JbnRBcnJheT1mdW5jdGlvbihsaXN0KXt2YXIgYXJyYXk9W107Zm9yKHZhciBpPTA7aTxsaXN0Lmxlbmd0aDtpKyspe2FycmF5W2ldPWxpc3RbaV07fVxucmV0dXJuIGFycmF5O307anN0cy5pbmRleC5jaGFpbi5Nb25vdG9uZUNoYWluQnVpbGRlci5nZXRDaGFpbnM9ZnVuY3Rpb24ocHRzKXtpZihhcmd1bWVudHMubGVuZ3RoPT09Mil7cmV0dXJuIGpzdHMuaW5kZXguY2hhaW4uTW9ub3RvbmVDaGFpbkJ1aWxkZXIuZ2V0Q2hhaW5zMi5hcHBseSh0aGlzLGFyZ3VtZW50cyk7fVxucmV0dXJuIGpzdHMuaW5kZXguY2hhaW4uTW9ub3RvbmVDaGFpbkJ1aWxkZXIuZ2V0Q2hhaW5zMihwdHMsbnVsbCk7fTtqc3RzLmluZGV4LmNoYWluLk1vbm90b25lQ2hhaW5CdWlsZGVyLmdldENoYWluczI9ZnVuY3Rpb24ocHRzLGNvbnRleHQpe3ZhciBtY0xpc3Q9W107dmFyIHN0YXJ0SW5kZXg9anN0cy5pbmRleC5jaGFpbi5Nb25vdG9uZUNoYWluQnVpbGRlci5nZXRDaGFpblN0YXJ0SW5kaWNlcyhwdHMpO2Zvcih2YXIgaT0wO2k8c3RhcnRJbmRleC5sZW5ndGgtMTtpKyspe3ZhciBtYz1uZXcganN0cy5pbmRleC5jaGFpbi5Nb25vdG9uZUNoYWluKHB0cyxzdGFydEluZGV4W2ldLHN0YXJ0SW5kZXhbaSsxXSxjb250ZXh0KTttY0xpc3QucHVzaChtYyk7fVxucmV0dXJuIG1jTGlzdDt9O2pzdHMuaW5kZXguY2hhaW4uTW9ub3RvbmVDaGFpbkJ1aWxkZXIuZ2V0Q2hhaW5TdGFydEluZGljZXM9ZnVuY3Rpb24ocHRzKXt2YXIgc3RhcnQ9MDt2YXIgc3RhcnRJbmRleExpc3Q9W107c3RhcnRJbmRleExpc3QucHVzaChzdGFydCk7ZG97dmFyIGxhc3Q9anN0cy5pbmRleC5jaGFpbi5Nb25vdG9uZUNoYWluQnVpbGRlci5maW5kQ2hhaW5FbmQocHRzLHN0YXJ0KTtzdGFydEluZGV4TGlzdC5wdXNoKGxhc3QpO3N0YXJ0PWxhc3Q7fXdoaWxlKHN0YXJ0PHB0cy5sZW5ndGgtMSk7dmFyIHN0YXJ0SW5kZXg9anN0cy5pbmRleC5jaGFpbi5Nb25vdG9uZUNoYWluQnVpbGRlci50b0ludEFycmF5KHN0YXJ0SW5kZXhMaXN0KTtyZXR1cm4gc3RhcnRJbmRleDt9O2pzdHMuaW5kZXguY2hhaW4uTW9ub3RvbmVDaGFpbkJ1aWxkZXIuZmluZENoYWluRW5kPWZ1bmN0aW9uKHB0cyxzdGFydCl7dmFyIHNhZmVTdGFydD1zdGFydDt3aGlsZShzYWZlU3RhcnQ8cHRzLmxlbmd0aC0xJiZwdHNbc2FmZVN0YXJ0XS5lcXVhbHMyRChwdHNbc2FmZVN0YXJ0KzFdKSl7c2FmZVN0YXJ0Kys7fVxuaWYoc2FmZVN0YXJ0Pj1wdHMubGVuZ3RoLTEpe3JldHVybiBwdHMubGVuZ3RoLTE7fVxudmFyIGNoYWluUXVhZD1qc3RzLmdlb21ncmFwaC5RdWFkcmFudC5xdWFkcmFudChwdHNbc2FmZVN0YXJ0XSxwdHNbc2FmZVN0YXJ0KzFdKTt2YXIgbGFzdD1zdGFydCsxO3doaWxlKGxhc3Q8cHRzLmxlbmd0aCl7aWYoIXB0c1tsYXN0LTFdLmVxdWFsczJEKHB0c1tsYXN0XSkpe3ZhciBxdWFkPWpzdHMuZ2VvbWdyYXBoLlF1YWRyYW50LnF1YWRyYW50KHB0c1tsYXN0LTFdLHB0c1tsYXN0XSk7aWYocXVhZCE9PWNoYWluUXVhZClcbmJyZWFrO31cbmxhc3QrKzt9XG5yZXR1cm4gbGFzdC0xO307anN0cy5hbGdvcml0aG0uTGluZUludGVyc2VjdG9yPWZ1bmN0aW9uKCl7dGhpcy5pbnB1dExpbmVzPVtbXSxbXV07dGhpcy5pbnRQdD1bbnVsbCxudWxsXTt0aGlzLnBhPXRoaXMuaW50UHRbMF07dGhpcy5wYj10aGlzLmludFB0WzFdO3RoaXMucmVzdWx0PWpzdHMuYWxnb3JpdGhtLkxpbmVJbnRlcnNlY3Rvci5OT19JTlRFUlNFQ1RJT047fTtqc3RzLmFsZ29yaXRobS5MaW5lSW50ZXJzZWN0b3IuTk9fSU5URVJTRUNUSU9OPTA7anN0cy5hbGdvcml0aG0uTGluZUludGVyc2VjdG9yLlBPSU5UX0lOVEVSU0VDVElPTj0xO2pzdHMuYWxnb3JpdGhtLkxpbmVJbnRlcnNlY3Rvci5DT0xMSU5FQVJfSU5URVJTRUNUSU9OPTI7anN0cy5hbGdvcml0aG0uTGluZUludGVyc2VjdG9yLnByb3RvdHlwZS5zZXRQcmVjaXNpb25Nb2RlbD1mdW5jdGlvbihwcmVjaXNpb25Nb2RlbCl7dGhpcy5wcmVjaXNpb25Nb2RlbD1wcmVjaXNpb25Nb2RlbDt9O2pzdHMuYWxnb3JpdGhtLkxpbmVJbnRlcnNlY3Rvci5wcm90b3R5cGUuZ2V0RW5kcG9pbnQ9ZnVuY3Rpb24oc2VnbWVudEluZGV4LHB0SW5kZXgpe3JldHVybiB0aGlzLmlucHV0TGluZXNbc2VnbWVudEluZGV4XVtwdEluZGV4XTt9O2pzdHMuYWxnb3JpdGhtLkxpbmVJbnRlcnNlY3Rvci5jb21wdXRlRWRnZURpc3RhbmNlPWZ1bmN0aW9uKHAscDAscDEpe3ZhciBkeD1NYXRoLmFicyhwMS54LXAwLngpO3ZhciBkeT1NYXRoLmFicyhwMS55LXAwLnkpO3ZhciBkaXN0PS0xLjA7aWYocC5lcXVhbHMocDApKXtkaXN0PTAuMDt9ZWxzZSBpZihwLmVxdWFscyhwMSkpe2lmKGR4PmR5KXtkaXN0PWR4O31lbHNle2Rpc3Q9ZHk7fX1lbHNle3ZhciBwZHg9TWF0aC5hYnMocC54LXAwLngpO3ZhciBwZHk9TWF0aC5hYnMocC55LXAwLnkpO2lmKGR4PmR5KXtkaXN0PXBkeDt9ZWxzZXtkaXN0PXBkeTt9XG5pZihkaXN0PT09MC4wJiYhcC5lcXVhbHMocDApKXtkaXN0PU1hdGgubWF4KHBkeCxwZHkpO319XG5pZihkaXN0PT09MC4wJiYhcC5lcXVhbHMocDApKXt0aHJvdyBuZXcganN0cy5lcnJvci5JbGxlZ2FsQXJndW1lbnRFcnJvcignQmFkIGRpc3RhbmNlIGNhbGN1bGF0aW9uJyk7fVxucmV0dXJuIGRpc3Q7fTtqc3RzLmFsZ29yaXRobS5MaW5lSW50ZXJzZWN0b3Iubm9uUm9idXN0Q29tcHV0ZUVkZ2VEaXN0YW5jZT1mdW5jdGlvbihwLHAxLHAyKXt2YXIgZHg9cC54LXAxLng7dmFyIGR5PXAueS1wMS55O3ZhciBkaXN0PU1hdGguc3FydChkeCpkeCtkeSpkeSk7aWYoIShkaXN0PT09MC4wJiYhcC5lcXVhbHMocDEpKSl7dGhyb3cgbmV3IGpzdHMuZXJyb3IuSWxsZWdhbEFyZ3VtZW50RXJyb3IoJ0ludmFsaWQgZGlzdGFuY2UgY2FsY3VsYXRpb24nKTt9XG5yZXR1cm4gZGlzdDt9O2pzdHMuYWxnb3JpdGhtLkxpbmVJbnRlcnNlY3Rvci5wcm90b3R5cGUucmVzdWx0PW51bGw7anN0cy5hbGdvcml0aG0uTGluZUludGVyc2VjdG9yLnByb3RvdHlwZS5pbnB1dExpbmVzPW51bGw7anN0cy5hbGdvcml0aG0uTGluZUludGVyc2VjdG9yLnByb3RvdHlwZS5pbnRQdD1udWxsO2pzdHMuYWxnb3JpdGhtLkxpbmVJbnRlcnNlY3Rvci5wcm90b3R5cGUuaW50TGluZUluZGV4PW51bGw7anN0cy5hbGdvcml0aG0uTGluZUludGVyc2VjdG9yLnByb3RvdHlwZS5faXNQcm9wZXI9bnVsbDtqc3RzLmFsZ29yaXRobS5MaW5lSW50ZXJzZWN0b3IucHJvdG90eXBlLnBhPW51bGw7anN0cy5hbGdvcml0aG0uTGluZUludGVyc2VjdG9yLnByb3RvdHlwZS5wYj1udWxsO2pzdHMuYWxnb3JpdGhtLkxpbmVJbnRlcnNlY3Rvci5wcm90b3R5cGUucHJlY2lzaW9uTW9kZWw9bnVsbDtqc3RzLmFsZ29yaXRobS5MaW5lSW50ZXJzZWN0b3IucHJvdG90eXBlLmNvbXB1dGVJbnRlcnNlY3Rpb249ZnVuY3Rpb24ocCxwMSxwMil7dGhyb3cgbmV3IGpzdHMuZXJyb3IuQWJzdHJhY3RNZXRob2RJbnZvY2F0aW9uRXJyb3IoKTt9O2pzdHMuYWxnb3JpdGhtLkxpbmVJbnRlcnNlY3Rvci5wcm90b3R5cGUuaXNDb2xsaW5lYXI9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5yZXN1bHQ9PT1qc3RzLmFsZ29yaXRobS5MaW5lSW50ZXJzZWN0b3IuQ09MTElORUFSX0lOVEVSU0VDVElPTjt9O2pzdHMuYWxnb3JpdGhtLkxpbmVJbnRlcnNlY3Rvci5wcm90b3R5cGUuY29tcHV0ZUludGVyc2VjdGlvbj1mdW5jdGlvbihwMSxwMixwMyxwNCl7dGhpcy5pbnB1dExpbmVzWzBdWzBdPXAxO3RoaXMuaW5wdXRMaW5lc1swXVsxXT1wMjt0aGlzLmlucHV0TGluZXNbMV1bMF09cDM7dGhpcy5pbnB1dExpbmVzWzFdWzFdPXA0O3RoaXMucmVzdWx0PXRoaXMuY29tcHV0ZUludGVyc2VjdChwMSxwMixwMyxwNCk7fTtqc3RzLmFsZ29yaXRobS5MaW5lSW50ZXJzZWN0b3IucHJvdG90eXBlLmNvbXB1dGVJbnRlcnNlY3Q9ZnVuY3Rpb24ocDEscDIscTEscTIpe3Rocm93IG5ldyBqc3RzLmVycm9yLkFic3RyYWN0TWV0aG9kSW52b2NhdGlvbkVycm9yKCk7fTtqc3RzLmFsZ29yaXRobS5MaW5lSW50ZXJzZWN0b3IucHJvdG90eXBlLmlzRW5kUG9pbnQ9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5oYXNJbnRlcnNlY3Rpb24oKSYmIXRoaXMuX2lzUHJvcGVyO307anN0cy5hbGdvcml0aG0uTGluZUludGVyc2VjdG9yLnByb3RvdHlwZS5oYXNJbnRlcnNlY3Rpb249ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5yZXN1bHQhPT1qc3RzLmFsZ29yaXRobS5MaW5lSW50ZXJzZWN0b3IuTk9fSU5URVJTRUNUSU9OO307anN0cy5hbGdvcml0aG0uTGluZUludGVyc2VjdG9yLnByb3RvdHlwZS5nZXRJbnRlcnNlY3Rpb25OdW09ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5yZXN1bHQ7fTtqc3RzLmFsZ29yaXRobS5MaW5lSW50ZXJzZWN0b3IucHJvdG90eXBlLmdldEludGVyc2VjdGlvbj1mdW5jdGlvbihpbnRJbmRleCl7cmV0dXJuIHRoaXMuaW50UHRbaW50SW5kZXhdO307anN0cy5hbGdvcml0aG0uTGluZUludGVyc2VjdG9yLnByb3RvdHlwZS5jb21wdXRlSW50TGluZUluZGV4PWZ1bmN0aW9uKCl7aWYodGhpcy5pbnRMaW5lSW5kZXg9PT1udWxsKXt0aGlzLmludExpbmVJbmRleD1bW10sW11dO3RoaXMuY29tcHV0ZUludExpbmVJbmRleCgwKTt0aGlzLmNvbXB1dGVJbnRMaW5lSW5kZXgoMSk7fX07anN0cy5hbGdvcml0aG0uTGluZUludGVyc2VjdG9yLnByb3RvdHlwZS5pc0ludGVyc2VjdGlvbj1mdW5jdGlvbihwdCl7dmFyIGk7Zm9yKGk9MDtpPHRoaXMucmVzdWx0O2krKyl7aWYodGhpcy5pbnRQdFtpXS5lcXVhbHMyRChwdCkpe3JldHVybiB0cnVlO319XG5yZXR1cm4gZmFsc2U7fTtqc3RzLmFsZ29yaXRobS5MaW5lSW50ZXJzZWN0b3IucHJvdG90eXBlLmlzSW50ZXJpb3JJbnRlcnNlY3Rpb249ZnVuY3Rpb24oKXtpZihhcmd1bWVudHMubGVuZ3RoPT09MSl7cmV0dXJuIHRoaXMuaXNJbnRlcmlvckludGVyc2VjdGlvbjIuYXBwbHkodGhpcyxhcmd1bWVudHMpO31cbmlmKHRoaXMuaXNJbnRlcmlvckludGVyc2VjdGlvbigwKSl7cmV0dXJuIHRydWU7fVxuaWYodGhpcy5pc0ludGVyaW9ySW50ZXJzZWN0aW9uKDEpKXtyZXR1cm4gdHJ1ZTt9XG5yZXR1cm4gZmFsc2U7fTtqc3RzLmFsZ29yaXRobS5MaW5lSW50ZXJzZWN0b3IucHJvdG90eXBlLmlzSW50ZXJpb3JJbnRlcnNlY3Rpb24yPWZ1bmN0aW9uKGlucHV0TGluZUluZGV4KXt2YXIgaTtmb3IoaT0wO2k8dGhpcy5yZXN1bHQ7aSsrKXtpZighKHRoaXMuaW50UHRbaV0uZXF1YWxzMkQodGhpcy5pbnB1dExpbmVzW2lucHV0TGluZUluZGV4XVswXSl8fHRoaXMuaW50UHRbaV0uZXF1YWxzMkQodGhpcy5pbnB1dExpbmVzW2lucHV0TGluZUluZGV4XVsxXSkpKXtyZXR1cm4gdHJ1ZTt9fVxucmV0dXJuIGZhbHNlO307anN0cy5hbGdvcml0aG0uTGluZUludGVyc2VjdG9yLnByb3RvdHlwZS5pc1Byb3Blcj1mdW5jdGlvbigpe3JldHVybiB0aGlzLmhhc0ludGVyc2VjdGlvbigpJiZ0aGlzLl9pc1Byb3Blcjt9O2pzdHMuYWxnb3JpdGhtLkxpbmVJbnRlcnNlY3Rvci5wcm90b3R5cGUuZ2V0SW50ZXJzZWN0aW9uQWxvbmdTZWdtZW50PWZ1bmN0aW9uKHNlZ21lbnRJbmRleCxpbnRJbmRleCl7dGhpcy5jb21wdXRlSW50TGluZUluZGV4KCk7cmV0dXJuIHRoaXMuaW50UHRbaW50TGluZUluZGV4W3NlZ21lbnRJbmRleF1baW50SW5kZXhdXTt9O2pzdHMuYWxnb3JpdGhtLkxpbmVJbnRlcnNlY3Rvci5wcm90b3R5cGUuZ2V0SW5kZXhBbG9uZ1NlZ21lbnQ9ZnVuY3Rpb24oc2VnbWVudEluZGV4LGludEluZGV4KXt0aGlzLmNvbXB1dGVJbnRMaW5lSW5kZXgoKTtyZXR1cm4gdGhpcy5pbnRMaW5lSW5kZXhbc2VnbWVudEluZGV4XVtpbnRJbmRleF07fTtqc3RzLmFsZ29yaXRobS5MaW5lSW50ZXJzZWN0b3IucHJvdG90eXBlLmNvbXB1dGVJbnRMaW5lSW5kZXg9ZnVuY3Rpb24oc2VnbWVudEluZGV4KXt2YXIgZGlzdDA9dGhpcy5nZXRFZGdlRGlzdGFuY2Uoc2VnbWVudEluZGV4LDApO3ZhciBkaXN0MT10aGlzLmdldEVkZ2VEaXN0YW5jZShzZWdtZW50SW5kZXgsMSk7aWYoZGlzdDA+ZGlzdDEpe3RoaXMuaW50TGluZUluZGV4W3NlZ21lbnRJbmRleF1bMF09MDt0aGlzLmludExpbmVJbmRleFtzZWdtZW50SW5kZXhdWzFdPTE7fWVsc2V7dGhpcy5pbnRMaW5lSW5kZXhbc2VnbWVudEluZGV4XVswXT0xO3RoaXMuaW50TGluZUluZGV4W3NlZ21lbnRJbmRleF1bMV09MDt9fTtqc3RzLmFsZ29yaXRobS5MaW5lSW50ZXJzZWN0b3IucHJvdG90eXBlLmdldEVkZ2VEaXN0YW5jZT1mdW5jdGlvbihzZWdtZW50SW5kZXgsaW50SW5kZXgpe3ZhciBkaXN0PWpzdHMuYWxnb3JpdGhtLkxpbmVJbnRlcnNlY3Rvci5jb21wdXRlRWRnZURpc3RhbmNlKHRoaXMuaW50UHRbaW50SW5kZXhdLHRoaXMuaW5wdXRMaW5lc1tzZWdtZW50SW5kZXhdWzBdLHRoaXMuaW5wdXRMaW5lc1tzZWdtZW50SW5kZXhdWzFdKTtyZXR1cm4gZGlzdDt9O2pzdHMuYWxnb3JpdGhtLlJvYnVzdExpbmVJbnRlcnNlY3Rvcj1mdW5jdGlvbigpe2pzdHMuYWxnb3JpdGhtLlJvYnVzdExpbmVJbnRlcnNlY3Rvci5wcm90b3R5cGUuY29uc3RydWN0b3IuY2FsbCh0aGlzKTt9O2pzdHMuYWxnb3JpdGhtLlJvYnVzdExpbmVJbnRlcnNlY3Rvci5wcm90b3R5cGU9bmV3IGpzdHMuYWxnb3JpdGhtLkxpbmVJbnRlcnNlY3RvcigpO2pzdHMuYWxnb3JpdGhtLlJvYnVzdExpbmVJbnRlcnNlY3Rvci5wcm90b3R5cGUuY29tcHV0ZUludGVyc2VjdGlvbj1mdW5jdGlvbihwLHAxLHAyKXtpZihhcmd1bWVudHMubGVuZ3RoPT09NCl7anN0cy5hbGdvcml0aG0uTGluZUludGVyc2VjdG9yLnByb3RvdHlwZS5jb21wdXRlSW50ZXJzZWN0aW9uLmFwcGx5KHRoaXMsYXJndW1lbnRzKTtyZXR1cm47fVxudGhpcy5faXNQcm9wZXI9ZmFsc2U7aWYoanN0cy5nZW9tLkVudmVsb3BlLmludGVyc2VjdHMocDEscDIscCkpe2lmKChqc3RzLmFsZ29yaXRobS5DR0FsZ29yaXRobXMub3JpZW50YXRpb25JbmRleChwMSxwMixwKT09PTApJiYoanN0cy5hbGdvcml0aG0uQ0dBbGdvcml0aG1zLm9yaWVudGF0aW9uSW5kZXgocDIscDEscCk9PT0wKSl7dGhpcy5faXNQcm9wZXI9dHJ1ZTtpZihwLmVxdWFscyhwMSl8fHAuZXF1YWxzKHAyKSl7dGhpcy5faXNQcm9wZXI9ZmFsc2U7fVxudGhpcy5yZXN1bHQ9anN0cy5hbGdvcml0aG0uTGluZUludGVyc2VjdG9yLlBPSU5UX0lOVEVSU0VDVElPTjtyZXR1cm47fX1cbnRoaXMucmVzdWx0PWpzdHMuYWxnb3JpdGhtLkxpbmVJbnRlcnNlY3Rvci5OT19JTlRFUlNFQ1RJT047fTtqc3RzLmFsZ29yaXRobS5Sb2J1c3RMaW5lSW50ZXJzZWN0b3IucHJvdG90eXBlLmNvbXB1dGVJbnRlcnNlY3Q9ZnVuY3Rpb24ocDEscDIscTEscTIpe3RoaXMuX2lzUHJvcGVyPWZhbHNlO2lmKCFqc3RzLmdlb20uRW52ZWxvcGUuaW50ZXJzZWN0cyhwMSxwMixxMSxxMikpe3JldHVybiBqc3RzLmFsZ29yaXRobS5MaW5lSW50ZXJzZWN0b3IuTk9fSU5URVJTRUNUSU9OO31cbnZhciBQcTE9anN0cy5hbGdvcml0aG0uQ0dBbGdvcml0aG1zLm9yaWVudGF0aW9uSW5kZXgocDEscDIscTEpO3ZhciBQcTI9anN0cy5hbGdvcml0aG0uQ0dBbGdvcml0aG1zLm9yaWVudGF0aW9uSW5kZXgocDEscDIscTIpO2lmKChQcTE+MCYmUHEyPjApfHwoUHExPDAmJlBxMjwwKSl7cmV0dXJuIGpzdHMuYWxnb3JpdGhtLkxpbmVJbnRlcnNlY3Rvci5OT19JTlRFUlNFQ1RJT047fVxudmFyIFFwMT1qc3RzLmFsZ29yaXRobS5DR0FsZ29yaXRobXMub3JpZW50YXRpb25JbmRleChxMSxxMixwMSk7dmFyIFFwMj1qc3RzLmFsZ29yaXRobS5DR0FsZ29yaXRobXMub3JpZW50YXRpb25JbmRleChxMSxxMixwMik7aWYoKFFwMT4wJiZRcDI+MCl8fChRcDE8MCYmUXAyPDApKXtyZXR1cm4ganN0cy5hbGdvcml0aG0uTGluZUludGVyc2VjdG9yLk5PX0lOVEVSU0VDVElPTjt9XG52YXIgY29sbGluZWFyPVBxMT09PTAmJlBxMj09PTAmJlFwMT09PTAmJlFwMj09PTA7aWYoY29sbGluZWFyKXtyZXR1cm4gdGhpcy5jb21wdXRlQ29sbGluZWFySW50ZXJzZWN0aW9uKHAxLHAyLHExLHEyKTt9XG5pZihQcTE9PT0wfHxQcTI9PT0wfHxRcDE9PT0wfHxRcDI9PT0wKXt0aGlzLl9pc1Byb3Blcj1mYWxzZTtpZihwMS5lcXVhbHMyRChxMSl8fHAxLmVxdWFsczJEKHEyKSl7dGhpcy5pbnRQdFswXT1wMTt9ZWxzZSBpZihwMi5lcXVhbHMyRChxMSl8fHAyLmVxdWFsczJEKHEyKSl7dGhpcy5pbnRQdFswXT1wMjt9XG5lbHNlIGlmKFBxMT09PTApe3RoaXMuaW50UHRbMF09bmV3IGpzdHMuZ2VvbS5Db29yZGluYXRlKHExKTt9ZWxzZSBpZihQcTI9PT0wKXt0aGlzLmludFB0WzBdPW5ldyBqc3RzLmdlb20uQ29vcmRpbmF0ZShxMik7fWVsc2UgaWYoUXAxPT09MCl7dGhpcy5pbnRQdFswXT1uZXcganN0cy5nZW9tLkNvb3JkaW5hdGUocDEpO31lbHNlIGlmKFFwMj09PTApe3RoaXMuaW50UHRbMF09bmV3IGpzdHMuZ2VvbS5Db29yZGluYXRlKHAyKTt9fWVsc2V7dGhpcy5faXNQcm9wZXI9dHJ1ZTt0aGlzLmludFB0WzBdPXRoaXMuaW50ZXJzZWN0aW9uKHAxLHAyLHExLHEyKTt9XG5yZXR1cm4ganN0cy5hbGdvcml0aG0uTGluZUludGVyc2VjdG9yLlBPSU5UX0lOVEVSU0VDVElPTjt9O2pzdHMuYWxnb3JpdGhtLlJvYnVzdExpbmVJbnRlcnNlY3Rvci5wcm90b3R5cGUuY29tcHV0ZUNvbGxpbmVhckludGVyc2VjdGlvbj1mdW5jdGlvbihwMSxwMixxMSxxMil7dmFyIHAxcTFwMj1qc3RzLmdlb20uRW52ZWxvcGUuaW50ZXJzZWN0cyhwMSxwMixxMSk7dmFyIHAxcTJwMj1qc3RzLmdlb20uRW52ZWxvcGUuaW50ZXJzZWN0cyhwMSxwMixxMik7dmFyIHExcDFxMj1qc3RzLmdlb20uRW52ZWxvcGUuaW50ZXJzZWN0cyhxMSxxMixwMSk7dmFyIHExcDJxMj1qc3RzLmdlb20uRW52ZWxvcGUuaW50ZXJzZWN0cyhxMSxxMixwMik7aWYocDFxMXAyJiZwMXEycDIpe3RoaXMuaW50UHRbMF09cTE7dGhpcy5pbnRQdFsxXT1xMjtyZXR1cm4ganN0cy5hbGdvcml0aG0uTGluZUludGVyc2VjdG9yLkNPTExJTkVBUl9JTlRFUlNFQ1RJT047fVxuaWYocTFwMXEyJiZxMXAycTIpe3RoaXMuaW50UHRbMF09cDE7dGhpcy5pbnRQdFsxXT1wMjtyZXR1cm4ganN0cy5hbGdvcml0aG0uTGluZUludGVyc2VjdG9yLkNPTExJTkVBUl9JTlRFUlNFQ1RJT047fVxuaWYocDFxMXAyJiZxMXAxcTIpe3RoaXMuaW50UHRbMF09cTE7dGhpcy5pbnRQdFsxXT1wMTtyZXR1cm4gcTEuZXF1YWxzKHAxKSYmIXAxcTJwMiYmIXExcDJxMj9qc3RzLmFsZ29yaXRobS5MaW5lSW50ZXJzZWN0b3IuUE9JTlRfSU5URVJTRUNUSU9OOmpzdHMuYWxnb3JpdGhtLkxpbmVJbnRlcnNlY3Rvci5DT0xMSU5FQVJfSU5URVJTRUNUSU9OO31cbmlmKHAxcTFwMiYmcTFwMnEyKXt0aGlzLmludFB0WzBdPXExO3RoaXMuaW50UHRbMV09cDI7cmV0dXJuIHExLmVxdWFscyhwMikmJiFwMXEycDImJiFxMXAxcTI/anN0cy5hbGdvcml0aG0uTGluZUludGVyc2VjdG9yLlBPSU5UX0lOVEVSU0VDVElPTjpqc3RzLmFsZ29yaXRobS5MaW5lSW50ZXJzZWN0b3IuQ09MTElORUFSX0lOVEVSU0VDVElPTjt9XG5pZihwMXEycDImJnExcDFxMil7dGhpcy5pbnRQdFswXT1xMjt0aGlzLmludFB0WzFdPXAxO3JldHVybiBxMi5lcXVhbHMocDEpJiYhcDFxMXAyJiYhcTFwMnEyP2pzdHMuYWxnb3JpdGhtLkxpbmVJbnRlcnNlY3Rvci5QT0lOVF9JTlRFUlNFQ1RJT046anN0cy5hbGdvcml0aG0uTGluZUludGVyc2VjdG9yLkNPTExJTkVBUl9JTlRFUlNFQ1RJT047fVxuaWYocDFxMnAyJiZxMXAycTIpe3RoaXMuaW50UHRbMF09cTI7dGhpcy5pbnRQdFsxXT1wMjtyZXR1cm4gcTIuZXF1YWxzKHAyKSYmIXAxcTFwMiYmIXExcDFxMj9qc3RzLmFsZ29yaXRobS5MaW5lSW50ZXJzZWN0b3IuUE9JTlRfSU5URVJTRUNUSU9OOmpzdHMuYWxnb3JpdGhtLkxpbmVJbnRlcnNlY3Rvci5DT0xMSU5FQVJfSU5URVJTRUNUSU9OO31cbnJldHVybiBqc3RzLmFsZ29yaXRobS5MaW5lSW50ZXJzZWN0b3IuTk9fSU5URVJTRUNUSU9OO307anN0cy5hbGdvcml0aG0uUm9idXN0TGluZUludGVyc2VjdG9yLnByb3RvdHlwZS5pbnRlcnNlY3Rpb249ZnVuY3Rpb24ocDEscDIscTEscTIpe3ZhciBpbnRQdD10aGlzLmludGVyc2VjdGlvbldpdGhOb3JtYWxpemF0aW9uKHAxLHAyLHExLHEyKTtpZighdGhpcy5pc0luU2VnbWVudEVudmVsb3BlcyhpbnRQdCkpe2ludFB0PWpzdHMuYWxnb3JpdGhtLkNlbnRyYWxFbmRwb2ludEludGVyc2VjdG9yLmdldEludGVyc2VjdGlvbihwMSxwMixxMSxxMik7fVxuaWYodGhpcy5wcmVjaXNpb25Nb2RlbCE9PW51bGwpe3RoaXMucHJlY2lzaW9uTW9kZWwubWFrZVByZWNpc2UoaW50UHQpO31cbnJldHVybiBpbnRQdDt9O2pzdHMuYWxnb3JpdGhtLlJvYnVzdExpbmVJbnRlcnNlY3Rvci5wcm90b3R5cGUuaW50ZXJzZWN0aW9uV2l0aE5vcm1hbGl6YXRpb249ZnVuY3Rpb24ocDEscDIscTEscTIpe3ZhciBuMT1uZXcganN0cy5nZW9tLkNvb3JkaW5hdGUocDEpO3ZhciBuMj1uZXcganN0cy5nZW9tLkNvb3JkaW5hdGUocDIpO3ZhciBuMz1uZXcganN0cy5nZW9tLkNvb3JkaW5hdGUocTEpO3ZhciBuND1uZXcganN0cy5nZW9tLkNvb3JkaW5hdGUocTIpO3ZhciBub3JtUHQ9bmV3IGpzdHMuZ2VvbS5Db29yZGluYXRlKCk7dGhpcy5ub3JtYWxpemVUb0VudkNlbnRyZShuMSxuMixuMyxuNCxub3JtUHQpO3ZhciBpbnRQdD10aGlzLnNhZmVIQ29vcmRpbmF0ZUludGVyc2VjdGlvbihuMSxuMixuMyxuNCk7aW50UHQueCs9bm9ybVB0Lng7aW50UHQueSs9bm9ybVB0Lnk7cmV0dXJuIGludFB0O307anN0cy5hbGdvcml0aG0uUm9idXN0TGluZUludGVyc2VjdG9yLnByb3RvdHlwZS5zYWZlSENvb3JkaW5hdGVJbnRlcnNlY3Rpb249ZnVuY3Rpb24ocDEscDIscTEscTIpe3ZhciBpbnRQdD1udWxsO3RyeXtpbnRQdD1qc3RzLmFsZ29yaXRobS5IQ29vcmRpbmF0ZS5pbnRlcnNlY3Rpb24ocDEscDIscTEscTIpO31jYXRjaChlKXtpZihlIGluc3RhbmNlb2YganN0cy5lcnJvci5Ob3RSZXByZXNlbnRhYmxlRXJyb3Ipe2ludFB0PWpzdHMuYWxnb3JpdGhtLkNlbnRyYWxFbmRwb2ludEludGVyc2VjdG9yLmdldEludGVyc2VjdGlvbihwMSxwMixxMSxxMik7fWVsc2V7dGhyb3cgZTt9fVxucmV0dXJuIGludFB0O307anN0cy5hbGdvcml0aG0uUm9idXN0TGluZUludGVyc2VjdG9yLnByb3RvdHlwZS5ub3JtYWxpemVUb01pbmltdW09ZnVuY3Rpb24objEsbjIsbjMsbjQsbm9ybVB0KXtub3JtUHQueD10aGlzLnNtYWxsZXN0SW5BYnNWYWx1ZShuMS54LG4yLngsbjMueCxuNC54KTtub3JtUHQueT10aGlzLnNtYWxsZXN0SW5BYnNWYWx1ZShuMS55LG4yLnksbjMueSxuNC55KTtuMS54LT1ub3JtUHQueDtuMS55LT1ub3JtUHQueTtuMi54LT1ub3JtUHQueDtuMi55LT1ub3JtUHQueTtuMy54LT1ub3JtUHQueDtuMy55LT1ub3JtUHQueTtuNC54LT1ub3JtUHQueDtuNC55LT1ub3JtUHQueTt9O2pzdHMuYWxnb3JpdGhtLlJvYnVzdExpbmVJbnRlcnNlY3Rvci5wcm90b3R5cGUubm9ybWFsaXplVG9FbnZDZW50cmU9ZnVuY3Rpb24objAwLG4wMSxuMTAsbjExLG5vcm1QdCl7dmFyIG1pblgwPW4wMC54PG4wMS54P24wMC54Om4wMS54O3ZhciBtaW5ZMD1uMDAueTxuMDEueT9uMDAueTpuMDEueTt2YXIgbWF4WDA9bjAwLng+bjAxLng/bjAwLng6bjAxLng7dmFyIG1heFkwPW4wMC55Pm4wMS55P24wMC55Om4wMS55O3ZhciBtaW5YMT1uMTAueDxuMTEueD9uMTAueDpuMTEueDt2YXIgbWluWTE9bjEwLnk8bjExLnk/bjEwLnk6bjExLnk7dmFyIG1heFgxPW4xMC54Pm4xMS54P24xMC54Om4xMS54O3ZhciBtYXhZMT1uMTAueT5uMTEueT9uMTAueTpuMTEueTt2YXIgaW50TWluWD1taW5YMD5taW5YMT9taW5YMDptaW5YMTt2YXIgaW50TWF4WD1tYXhYMDxtYXhYMT9tYXhYMDptYXhYMTt2YXIgaW50TWluWT1taW5ZMD5taW5ZMT9taW5ZMDptaW5ZMTt2YXIgaW50TWF4WT1tYXhZMDxtYXhZMT9tYXhZMDptYXhZMTt2YXIgaW50TWlkWD0oaW50TWluWCtpbnRNYXhYKS8yLjA7dmFyIGludE1pZFk9KGludE1pblkraW50TWF4WSkvMi4wO25vcm1QdC54PWludE1pZFg7bm9ybVB0Lnk9aW50TWlkWTtuMDAueC09bm9ybVB0Lng7bjAwLnktPW5vcm1QdC55O24wMS54LT1ub3JtUHQueDtuMDEueS09bm9ybVB0Lnk7bjEwLngtPW5vcm1QdC54O24xMC55LT1ub3JtUHQueTtuMTEueC09bm9ybVB0Lng7bjExLnktPW5vcm1QdC55O307anN0cy5hbGdvcml0aG0uUm9idXN0TGluZUludGVyc2VjdG9yLnByb3RvdHlwZS5zbWFsbGVzdEluQWJzVmFsdWU9ZnVuY3Rpb24oeDEseDIseDMseDQpe3ZhciB4PXgxO3ZhciB4YWJzPU1hdGguYWJzKHgpO2lmKE1hdGguYWJzKHgyKTx4YWJzKXt4PXgyO3hhYnM9TWF0aC5hYnMoeDIpO31cbmlmKE1hdGguYWJzKHgzKTx4YWJzKXt4PXgzO3hhYnM9TWF0aC5hYnMoeDMpO31cbmlmKE1hdGguYWJzKHg0KTx4YWJzKXt4PXg0O31cbnJldHVybiB4O307anN0cy5hbGdvcml0aG0uUm9idXN0TGluZUludGVyc2VjdG9yLnByb3RvdHlwZS5pc0luU2VnbWVudEVudmVsb3Blcz1mdW5jdGlvbihpbnRQdCl7dmFyIGVudjA9bmV3IGpzdHMuZ2VvbS5FbnZlbG9wZSh0aGlzLmlucHV0TGluZXNbMF1bMF0sdGhpcy5pbnB1dExpbmVzWzBdWzFdKTt2YXIgZW52MT1uZXcganN0cy5nZW9tLkVudmVsb3BlKHRoaXMuaW5wdXRMaW5lc1sxXVswXSx0aGlzLmlucHV0TGluZXNbMV1bMV0pO3JldHVybiBlbnYwLmNvbnRhaW5zKGludFB0KSYmZW52MS5jb250YWlucyhpbnRQdCk7fTtqc3RzLmFsZ29yaXRobS5IQ29vcmRpbmF0ZT1mdW5jdGlvbigpe3RoaXMueD0wLjA7dGhpcy55PTAuMDt0aGlzLnc9MS4wO2lmKGFyZ3VtZW50cy5sZW5ndGg9PT0xKXt0aGlzLmluaXRGcm9tMUNvb3JkaW5hdGUoYXJndW1lbnRzWzBdKTt9ZWxzZSBpZihhcmd1bWVudHMubGVuZ3RoPT09MiYmYXJndW1lbnRzWzBdaW5zdGFuY2VvZiBqc3RzLmdlb20uQ29vcmRpbmF0ZSl7dGhpcy5pbml0RnJvbTJDb29yZGluYXRlcyhhcmd1bWVudHNbMF0sYXJndW1lbnRzWzFdKTt9ZWxzZSBpZihhcmd1bWVudHMubGVuZ3RoPT09MiYmYXJndW1lbnRzWzBdaW5zdGFuY2VvZiBqc3RzLmFsZ29yaXRobS5IQ29vcmRpbmF0ZSl7dGhpcy5pbml0RnJvbTJIQ29vcmRpbmF0ZXMoYXJndW1lbnRzWzBdLGFyZ3VtZW50c1sxXSk7fWVsc2UgaWYoYXJndW1lbnRzLmxlbmd0aD09PTIpe3RoaXMuaW5pdEZyb21YWShhcmd1bWVudHNbMF0sYXJndW1lbnRzWzFdKTt9ZWxzZSBpZihhcmd1bWVudHMubGVuZ3RoPT09Myl7dGhpcy5pbml0RnJvbVhZVyhhcmd1bWVudHNbMF0sYXJndW1lbnRzWzFdLGFyZ3VtZW50c1syXSk7fWVsc2UgaWYoYXJndW1lbnRzLmxlbmd0aD09PTQpe3RoaXMuaW5pdEZyb21YWVcoYXJndW1lbnRzWzBdLGFyZ3VtZW50c1sxXSxhcmd1bWVudHNbMl0sYXJndW1lbnRzWzNdKTt9fTtqc3RzLmFsZ29yaXRobS5IQ29vcmRpbmF0ZS5pbnRlcnNlY3Rpb249ZnVuY3Rpb24ocDEscDIscTEscTIpe3ZhciBweCxweSxwdyxxeCxxeSxxdyx4LHksdyx4SW50LHlJbnQ7cHg9cDEueS1wMi55O3B5PXAyLngtcDEueDtwdz1wMS54KnAyLnktcDIueCpwMS55O3F4PXExLnktcTIueTtxeT1xMi54LXExLng7cXc9cTEueCpxMi55LXEyLngqcTEueTt4PXB5KnF3LXF5KnB3O3k9cXgqcHctcHgqcXc7dz1weCpxeS1xeCpweTt4SW50PXgvdzt5SW50PXkvdztpZighaXNGaW5pdGUoeEludCl8fCFpc0Zpbml0ZSh5SW50KSl7dGhyb3cgbmV3IGpzdHMuZXJyb3IuTm90UmVwcmVzZW50YWJsZUVycm9yKCk7fVxucmV0dXJuIG5ldyBqc3RzLmdlb20uQ29vcmRpbmF0ZSh4SW50LHlJbnQpO307anN0cy5hbGdvcml0aG0uSENvb3JkaW5hdGUucHJvdG90eXBlLmluaXRGcm9tMUNvb3JkaW5hdGU9ZnVuY3Rpb24ocCl7dGhpcy54PXAueDt0aGlzLnk9cC55O3RoaXMudz0xLjA7fTtqc3RzLmFsZ29yaXRobS5IQ29vcmRpbmF0ZS5wcm90b3R5cGUuaW5pdEZyb20yQ29vcmRpbmF0ZXM9ZnVuY3Rpb24ocDEscDIpe3RoaXMueD1wMS55LXAyLnk7dGhpcy55PXAyLngtcDEueDt0aGlzLnc9cDEueCpwMi55LXAyLngqcDEueTt9O2pzdHMuYWxnb3JpdGhtLkhDb29yZGluYXRlLnByb3RvdHlwZS5pbml0RnJvbTJIQ29vcmRpbmF0ZXM9ZnVuY3Rpb24ocDEscDIpe3RoaXMueD1wMS55KnAyLnctcDIueSpwMS53O3RoaXMueT1wMi54KnAxLnctcDEueCpwMi53O3RoaXMudz1wMS54KnAyLnktcDIueCpwMS55O307anN0cy5hbGdvcml0aG0uSENvb3JkaW5hdGUucHJvdG90eXBlLmluaXRGcm9tWFlXPWZ1bmN0aW9uKHgseSx3KXt0aGlzLng9eDt0aGlzLnk9eTt0aGlzLnc9dzt9O2pzdHMuYWxnb3JpdGhtLkhDb29yZGluYXRlLnByb3RvdHlwZS5pbml0RnJvbVhZPWZ1bmN0aW9uKHgseSl7dGhpcy54PXg7dGhpcy55PXk7dGhpcy53PTEuMDt9O2pzdHMuYWxnb3JpdGhtLkhDb29yZGluYXRlLnByb3RvdHlwZS5pbml0RnJvbTRDb29yZGluYXRlcz1mdW5jdGlvbihwMSxwMixxMSxxMil7dmFyIHB4LHB5LHB3LHF4LHF5LHF3O3B4PXAxLnktcDIueTtweT1wMi54LXAxLng7cHc9cDEueCpwMi55LXAyLngqcDEueTtxeD1xMS55LXEyLnk7cXk9cTIueC1xMS54O3F3PXExLngqcTIueS1xMi54KnExLnk7dGhpcy54PXB5KnF3LXF5KnB3O3RoaXMueT1xeCpwdy1weCpxdzt0aGlzLnc9cHgqcXktcXgqcHk7fTtqc3RzLmFsZ29yaXRobS5IQ29vcmRpbmF0ZS5wcm90b3R5cGUuZ2V0WD1mdW5jdGlvbigpe3ZhciBhPXRoaXMueC90aGlzLnc7aWYoIWlzRmluaXRlKGEpKXt0aHJvdyBuZXcganN0cy5lcnJvci5Ob3RSZXByZXNlbnRhYmxlRXJyb3IoKTt9XG5yZXR1cm4gYTt9O2pzdHMuYWxnb3JpdGhtLkhDb29yZGluYXRlLnByb3RvdHlwZS5nZXRZPWZ1bmN0aW9uKCl7dmFyIGE9dGhpcy55L3RoaXMudztpZighaXNGaW5pdGUoYSkpe3Rocm93IG5ldyBqc3RzLmVycm9yLk5vdFJlcHJlc2VudGFibGVFcnJvcigpO31cbnJldHVybiBhO307anN0cy5hbGdvcml0aG0uSENvb3JkaW5hdGUucHJvdG90eXBlLmdldENvb3JkaW5hdGU9ZnVuY3Rpb24oKXt2YXIgcD1uZXcganN0cy5nZW9tLkNvb3JkaW5hdGUoKTtwLng9dGhpcy5nZXRYKCk7cC55PXRoaXMuZ2V0WSgpO3JldHVybiBwO307anN0cy5nZW9tLkxpbmVTZWdtZW50PWZ1bmN0aW9uKCl7aWYoYXJndW1lbnRzLmxlbmd0aD09PTApe3RoaXMucDA9bmV3IGpzdHMuZ2VvbS5Db29yZGluYXRlKCk7dGhpcy5wMT1uZXcganN0cy5nZW9tLkNvb3JkaW5hdGUoKTt9ZWxzZSBpZihhcmd1bWVudHMubGVuZ3RoPT09MSl7dGhpcy5wMD1hcmd1bWVudHNbMF0ucDA7dGhpcy5wMT1hcmd1bWVudHNbMF0ucDE7fWVsc2UgaWYoYXJndW1lbnRzLmxlbmd0aD09PTIpe3RoaXMucDA9YXJndW1lbnRzWzBdO3RoaXMucDE9YXJndW1lbnRzWzFdO31lbHNlIGlmKGFyZ3VtZW50cy5sZW5ndGg9PT00KXt0aGlzLnAwPW5ldyBqc3RzLmdlb20uQ29vcmRpbmF0ZShhcmd1bWVudHNbMF0sYXJndW1lbnRzWzFdKTt0aGlzLnAxPW5ldyBqc3RzLmdlb20uQ29vcmRpbmF0ZShhcmd1bWVudHNbMl0sYXJndW1lbnRzWzNdKTt9fTtqc3RzLmdlb20uTGluZVNlZ21lbnQucHJvdG90eXBlLnAwPW51bGw7anN0cy5nZW9tLkxpbmVTZWdtZW50LnByb3RvdHlwZS5wMT1udWxsO2pzdHMuZ2VvbS5MaW5lU2VnbWVudC5taWRQb2ludD1mdW5jdGlvbihwMCxwMSl7cmV0dXJuIG5ldyBqc3RzLmdlb20uQ29vcmRpbmF0ZSgocDAueCtwMS54KS8yLChwMC55K3AxLnkpLzIpO307anN0cy5nZW9tLkxpbmVTZWdtZW50LnByb3RvdHlwZS5nZXRDb29yZGluYXRlPWZ1bmN0aW9uKGkpe2lmKGk9PT0wKXJldHVybiB0aGlzLnAwO3JldHVybiB0aGlzLnAxO307anN0cy5nZW9tLkxpbmVTZWdtZW50LnByb3RvdHlwZS5nZXRMZW5ndGg9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5wMC5kaXN0YW5jZSh0aGlzLnAxKTt9O2pzdHMuZ2VvbS5MaW5lU2VnbWVudC5wcm90b3R5cGUuaXNIb3Jpem9udGFsPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMucDAueT09PXRoaXMucDEueTt9O2pzdHMuZ2VvbS5MaW5lU2VnbWVudC5wcm90b3R5cGUuaXNWZXJ0aWNhbD1mdW5jdGlvbigpe3JldHVybiB0aGlzLnAwLng9PT10aGlzLnAxLng7fTtqc3RzLmdlb20uTGluZVNlZ21lbnQucHJvdG90eXBlLm9yaWVudGF0aW9uSW5kZXg9ZnVuY3Rpb24oYXJnKXtpZihhcmcgaW5zdGFuY2VvZiBqc3RzLmdlb20uTGluZVNlZ21lbnQpe3JldHVybiB0aGlzLm9yaWVudGF0aW9uSW5kZXgxKGFyZyk7fWVsc2UgaWYoYXJnIGluc3RhbmNlb2YganN0cy5nZW9tLkNvb3JkaW5hdGUpe3JldHVybiB0aGlzLm9yaWVudGF0aW9uSW5kZXgyKGFyZyk7fX07anN0cy5nZW9tLkxpbmVTZWdtZW50LnByb3RvdHlwZS5vcmllbnRhdGlvbkluZGV4MT1mdW5jdGlvbihzZWcpe3ZhciBvcmllbnQwPWpzdHMuYWxnb3JpdGhtLkNHQWxnb3JpdGhtcy5vcmllbnRhdGlvbkluZGV4KHRoaXMucDAsdGhpcy5wMSxzZWcucDApO3ZhciBvcmllbnQxPWpzdHMuYWxnb3JpdGhtLkNHQWxnb3JpdGhtcy5vcmllbnRhdGlvbkluZGV4KHRoaXMucDAsdGhpcy5wMSxzZWcucDEpO2lmKG9yaWVudDA+PTAmJm9yaWVudDE+PTApe3JldHVybiBNYXRoLm1heChvcmllbnQwLG9yaWVudDEpO31cbmlmKG9yaWVudDA8PTAmJm9yaWVudDE8PTApe3JldHVybiBNYXRoLm1heChvcmllbnQwLG9yaWVudDEpO31cbnJldHVybiAwO307anN0cy5nZW9tLkxpbmVTZWdtZW50LnByb3RvdHlwZS5vcmllbnRhdGlvbkluZGV4Mj1mdW5jdGlvbihwKXtyZXR1cm4ganN0cy5hbGdvcml0aG0uQ0dBbGdvcml0aG1zLm9yaWVudGF0aW9uSW5kZXgodGhpcy5wMCx0aGlzLnAxLHApO307anN0cy5nZW9tLkxpbmVTZWdtZW50LnByb3RvdHlwZS5yZXZlcnNlPWZ1bmN0aW9uKCl7dmFyIHRlbXA9dGhpcy5wMDt0aGlzLnAwPXRoaXMucDE7dGhpcy5wMT10ZW1wO307anN0cy5nZW9tLkxpbmVTZWdtZW50LnByb3RvdHlwZS5ub3JtYWxpemU9ZnVuY3Rpb24oKXtpZih0aGlzLnAxLmNvbXBhcmVUbyh0aGlzLnAwKTwwKXRoaXMucmV2ZXJzZSgpO307anN0cy5nZW9tLkxpbmVTZWdtZW50LnByb3RvdHlwZS5hbmdsZT1mdW5jdGlvbigpe3JldHVybiBNYXRoLmF0YW4yKHRoaXMucDEueS10aGlzLnAwLnksdGhpcy5wMS54LXRoaXMucDAueCk7fTtqc3RzLmdlb20uTGluZVNlZ21lbnQucHJvdG90eXBlLm1pZFBvaW50PWZ1bmN0aW9uKCl7cmV0dXJuIGpzdHMuZ2VvbS5MaW5lU2VnbWVudC5taWRQb2ludCh0aGlzLnAwLHRoaXMucDEpO307anN0cy5nZW9tLkxpbmVTZWdtZW50LnByb3RvdHlwZS5kaXN0YW5jZT1mdW5jdGlvbihhcmcpe2lmKGFyZyBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5MaW5lU2VnbWVudCl7cmV0dXJuIHRoaXMuZGlzdGFuY2UxKGFyZyk7fWVsc2UgaWYoYXJnIGluc3RhbmNlb2YganN0cy5nZW9tLkNvb3JkaW5hdGUpe3JldHVybiB0aGlzLmRpc3RhbmNlMihhcmcpO319O2pzdHMuZ2VvbS5MaW5lU2VnbWVudC5wcm90b3R5cGUuZGlzdGFuY2UxPWZ1bmN0aW9uKGxzKXtyZXR1cm4ganN0cy5hbGdvcml0aG0uQ0dBbGdvcml0aG1zLmRpc3RhbmNlTGluZUxpbmUodGhpcy5wMCx0aGlzLnAxLGxzLnAwLGxzLnAxKTt9O2pzdHMuZ2VvbS5MaW5lU2VnbWVudC5wcm90b3R5cGUuZGlzdGFuY2UyPWZ1bmN0aW9uKHApe3JldHVybiBqc3RzLmFsZ29yaXRobS5DR0FsZ29yaXRobXMuZGlzdGFuY2VQb2ludExpbmUocCx0aGlzLnAwLHRoaXMucDEpO307anN0cy5nZW9tLkxpbmVTZWdtZW50LnByb3RvdHlwZS5wb2ludEFsb25nPWZ1bmN0aW9uKHNlZ21lbnRMZW5ndGhGcmFjdGlvbil7dmFyIGNvb3JkPW5ldyBqc3RzLmdlb20uQ29vcmRpbmF0ZSgpO2Nvb3JkLng9dGhpcy5wMC54K3NlZ21lbnRMZW5ndGhGcmFjdGlvbioodGhpcy5wMS54LXRoaXMucDAueCk7Y29vcmQueT10aGlzLnAwLnkrc2VnbWVudExlbmd0aEZyYWN0aW9uKih0aGlzLnAxLnktdGhpcy5wMC55KTtyZXR1cm4gY29vcmQ7fTtqc3RzLmdlb20uTGluZVNlZ21lbnQucHJvdG90eXBlLnBvaW50QWxvbmdPZmZzZXQ9ZnVuY3Rpb24oc2VnbWVudExlbmd0aEZyYWN0aW9uLG9mZnNldERpc3RhbmNlKXt2YXIgc2VneD10aGlzLnAwLngrc2VnbWVudExlbmd0aEZyYWN0aW9uKih0aGlzLnAxLngtdGhpcy5wMC54KTt2YXIgc2VneT10aGlzLnAwLnkrc2VnbWVudExlbmd0aEZyYWN0aW9uKih0aGlzLnAxLnktdGhpcy5wMC55KTt2YXIgZHg9dGhpcy5wMS54LXRoaXMucDAueDt2YXIgZHk9dGhpcy5wMS55LXRoaXMucDAueTt2YXIgbGVuPU1hdGguc3FydChkeCpkeCtkeSpkeSk7dmFyIHV4PTA7dmFyIHV5PTA7aWYob2Zmc2V0RGlzdGFuY2UhPT0wKXtpZihsZW48PTApe3Rocm93XCJDYW5ub3QgY29tcHV0ZSBvZmZzZXQgZnJvbSB6ZXJvLWxlbmd0aCBsaW5lIHNlZ21lbnRcIjt9XG51eD1vZmZzZXREaXN0YW5jZSpkeC9sZW47dXk9b2Zmc2V0RGlzdGFuY2UqZHkvbGVuO31cbnZhciBvZmZzZXR4PXNlZ3gtdXk7dmFyIG9mZnNldHk9c2VneSt1eDt2YXIgY29vcmQ9bmV3IGpzdHMuZ2VvbS5Db29yZGluYXRlKG9mZnNldHgsb2Zmc2V0eSk7cmV0dXJuIGNvb3JkO307anN0cy5nZW9tLkxpbmVTZWdtZW50LnByb3RvdHlwZS5wcm9qZWN0aW9uRmFjdG9yPWZ1bmN0aW9uKHApe2lmKHAuZXF1YWxzKHRoaXMucDApKVxucmV0dXJuIDAuMDtpZihwLmVxdWFscyh0aGlzLnAxKSlcbnJldHVybiAxLjA7dmFyIGR4PXRoaXMucDEueC10aGlzLnAwLng7dmFyIGR5PXRoaXMucDEueS10aGlzLnAwLnk7dmFyIGxlbjI9ZHgqZHgrZHkqZHk7dmFyIHI9KChwLngtdGhpcy5wMC54KSpkeCsocC55LXRoaXMucDAueSkqZHkpL2xlbjI7cmV0dXJuIHI7fTtqc3RzLmdlb20uTGluZVNlZ21lbnQucHJvdG90eXBlLnNlZ21lbnRGcmFjdGlvbj1mdW5jdGlvbihpbnB1dFB0KXt2YXIgc2VnRnJhYz10aGlzLnByb2plY3Rpb25GYWN0b3IoaW5wdXRQdCk7aWYoc2VnRnJhYzwwKXtzZWdGcmFjPTA7fWVsc2UgaWYoc2VnRnJhYz4xfHxpc05hTihzZWdGcmFjKSl7c2VnRnJhYz0xO31cbnJldHVybiBzZWdGcmFjO307anN0cy5nZW9tLkxpbmVTZWdtZW50LnByb3RvdHlwZS5wcm9qZWN0PWZ1bmN0aW9uKGFyZyl7aWYoYXJnIGluc3RhbmNlb2YganN0cy5nZW9tLkNvb3JkaW5hdGUpe3JldHVybiB0aGlzLnByb2plY3QxKGFyZyk7fWVsc2UgaWYoYXJnIGluc3RhbmNlb2YganN0cy5nZW9tLkxpbmVTZWdtZW50KXtyZXR1cm4gdGhpcy5wcm9qZWN0MihhcmcpO319O2pzdHMuZ2VvbS5MaW5lU2VnbWVudC5wcm90b3R5cGUucHJvamVjdDE9ZnVuY3Rpb24ocCl7aWYocC5lcXVhbHModGhpcy5wMCl8fHAuZXF1YWxzKHRoaXMucDEpKXtyZXR1cm4gbmV3IGpzdHMuZ2VvbS5Db29yZGluYXRlKHApO31cbnZhciByPXRoaXMucHJvamVjdGlvbkZhY3RvcihwKTt2YXIgY29vcmQ9bmV3IGpzdHMuZ2VvbS5Db29yZGluYXRlKCk7Y29vcmQueD10aGlzLnAwLngrcioodGhpcy5wMS54LXRoaXMucDAueCk7Y29vcmQueT10aGlzLnAwLnkrcioodGhpcy5wMS55LXRoaXMucDAueSk7cmV0dXJuIGNvb3JkO307anN0cy5nZW9tLkxpbmVTZWdtZW50LnByb3RvdHlwZS5wcm9qZWN0Mj1mdW5jdGlvbihzZWcpe3ZhciBwZjA9dGhpcy5wcm9qZWN0aW9uRmFjdG9yKHNlZy5wMCk7dmFyIHBmMT10aGlzLnByb2plY3Rpb25GYWN0b3Ioc2VnLnAxKTtpZihwZjA+PTEmJnBmMT49MSlyZXR1cm4gbnVsbDtpZihwZjA8PTAmJnBmMTw9MClyZXR1cm4gbnVsbDt2YXIgbmV3cDA9dGhpcy5wcm9qZWN0KHNlZy5wMCk7aWYocGYwPDApbmV3cDA9cDA7aWYocGYwPjEpbmV3cDA9cDE7dmFyIG5ld3AxPXRoaXMucHJvamVjdChzZWcucDEpO2lmKHBmMTwwLjApbmV3cDE9cDA7aWYocGYxPjEuMCluZXdwMT1wMTtyZXR1cm4gbmV3IGpzdHMuZ2VvbS5MaW5lU2VnbWVudChuZXdwMCxuZXdwMSk7fTtqc3RzLmdlb20uTGluZVNlZ21lbnQucHJvdG90eXBlLmNsb3Nlc3RQb2ludD1mdW5jdGlvbihwKXt2YXIgZmFjdG9yPXRoaXMucHJvamVjdGlvbkZhY3RvcihwKTtpZihmYWN0b3I+MCYmZmFjdG9yPDEpe3JldHVybiB0aGlzLnByb2plY3QocCk7fVxudmFyIGRpc3QwPXRoaXMucDAuZGlzdGFuY2UocCk7dmFyIGRpc3QxPXRoaXMucDEuZGlzdGFuY2UocCk7aWYoZGlzdDA8ZGlzdDEpXG5yZXR1cm4gdGhpcy5wMDtyZXR1cm4gdGhpcy5wMTt9O2pzdHMuZ2VvbS5MaW5lU2VnbWVudC5wcm90b3R5cGUuY2xvc2VzdFBvaW50cz1mdW5jdGlvbihsaW5lKXt2YXIgaW50UHQ9dGhpcy5pbnRlcnNlY3Rpb24obGluZSk7aWYoaW50UHQhPT1udWxsKXtyZXR1cm5baW50UHQsaW50UHRdO31cbnZhciBjbG9zZXN0UHQ9W107dmFyIG1pbkRpc3RhbmNlPU51bWJlci5NQVhfVkFMVUU7dmFyIGRpc3Q7dmFyIGNsb3NlMDA9dGhpcy5jbG9zZXN0UG9pbnQobGluZS5wMCk7bWluRGlzdGFuY2U9Y2xvc2UwMC5kaXN0YW5jZShsaW5lLnAwKTtjbG9zZXN0UHRbMF09Y2xvc2UwMDtjbG9zZXN0UHRbMV09bGluZS5wMDt2YXIgY2xvc2UwMT10aGlzLmNsb3Nlc3RQb2ludChsaW5lLnAxKTtkaXN0PWNsb3NlMDEuZGlzdGFuY2UobGluZS5wMSk7aWYoZGlzdDxtaW5EaXN0YW5jZSl7bWluRGlzdGFuY2U9ZGlzdDtjbG9zZXN0UHRbMF09Y2xvc2UwMTtjbG9zZXN0UHRbMV09bGluZS5wMTt9XG52YXIgY2xvc2UxMD1saW5lLmNsb3Nlc3RQb2ludCh0aGlzLnAwKTtkaXN0PWNsb3NlMTAuZGlzdGFuY2UodGhpcy5wMCk7aWYoZGlzdDxtaW5EaXN0YW5jZSl7bWluRGlzdGFuY2U9ZGlzdDtjbG9zZXN0UHRbMF09dGhpcy5wMDtjbG9zZXN0UHRbMV09Y2xvc2UxMDt9XG52YXIgY2xvc2UxMT1saW5lLmNsb3Nlc3RQb2ludCh0aGlzLnAxKTtkaXN0PWNsb3NlMTEuZGlzdGFuY2UodGhpcy5wMSk7aWYoZGlzdDxtaW5EaXN0YW5jZSl7bWluRGlzdGFuY2U9ZGlzdDtjbG9zZXN0UHRbMF09dGhpcy5wMTtjbG9zZXN0UHRbMV09Y2xvc2UxMTt9XG5yZXR1cm4gY2xvc2VzdFB0O307anN0cy5nZW9tLkxpbmVTZWdtZW50LnByb3RvdHlwZS5pbnRlcnNlY3Rpb249ZnVuY3Rpb24obGluZSl7dmFyIGxpPW5ldyBqc3RzLmFsZ29yaXRobS5Sb2J1c3RMaW5lSW50ZXJzZWN0b3IoKTtsaS5jb21wdXRlSW50ZXJzZWN0aW9uKHRoaXMucDAsdGhpcy5wMSxsaW5lLnAwLGxpbmUucDEpO2lmKGxpLmhhc0ludGVyc2VjdGlvbigpKVxucmV0dXJuIGxpLmdldEludGVyc2VjdGlvbigwKTtyZXR1cm4gbnVsbDt9O2pzdHMuZ2VvbS5MaW5lU2VnbWVudC5wcm90b3R5cGUuc2V0Q29vcmRpbmF0ZXM9ZnVuY3Rpb24obHMpe2lmKGxzIGluc3RhbmNlb2YganN0cy5nZW9tLkNvb3JkaW5hdGUpe3RoaXMuc2V0Q29vcmRpbmF0ZXMyLmFwcGx5KHRoaXMsYXJndW1lbnRzKTtyZXR1cm47fVxudGhpcy5zZXRDb29yZGluYXRlczIobHMucDAsbHMucDEpO307anN0cy5nZW9tLkxpbmVTZWdtZW50LnByb3RvdHlwZS5zZXRDb29yZGluYXRlczI9ZnVuY3Rpb24ocDAscDEpe3RoaXMucDAueD1wMC54O3RoaXMucDAueT1wMC55O3RoaXMucDEueD1wMS54O3RoaXMucDEueT1wMS55O307anN0cy5nZW9tLkxpbmVTZWdtZW50LnByb3RvdHlwZS5kaXN0YW5jZVBlcnBlbmRpY3VsYXI9ZnVuY3Rpb24ocCl7cmV0dXJuIGpzdHMuYWxnb3JpdGhtLkNHQWxnb3JpdGhtcy5kaXN0YW5jZVBvaW50TGluZVBlcnBlbmRpY3VsYXIocCx0aGlzLnAwLHRoaXMucDEpO307anN0cy5nZW9tLkxpbmVTZWdtZW50LnByb3RvdHlwZS5saW5lSW50ZXJzZWN0aW9uPWZ1bmN0aW9uKGxpbmUpe3RyeXt2YXIgaW50UHQ9anN0cy5hbGdvcml0aG0uSENvb3JkaW5hdGUuaW50ZXJzZWN0aW9uKHRoaXMucDAsdGhpcy5wMSxsaW5lLnAwLGxpbmUucDEpO3JldHVybiBpbnRQdDt9Y2F0Y2goZXgpe31cbnJldHVybiBudWxsO307anN0cy5nZW9tLkxpbmVTZWdtZW50LnByb3RvdHlwZS50b0dlb21ldHJ5PWZ1bmN0aW9uKGdlb21GYWN0b3J5KXtyZXR1cm4gZ2VvbUZhY3RvcnkuY3JlYXRlTGluZVN0cmluZyhbdGhpcy5wMCx0aGlzLnAxXSk7fTtqc3RzLmdlb20uTGluZVNlZ21lbnQucHJvdG90eXBlLmVxdWFscz1mdW5jdGlvbihvKXtpZighKG8gaW5zdGFuY2VvZiBqc3RzLmdlb20uTGluZVNlZ21lbnQpKXtyZXR1cm4gZmFsc2U7fVxucmV0dXJuIHRoaXMucDAuZXF1YWxzKG8ucDApJiZ0aGlzLnAxLmVxdWFscyhvLnAxKTt9O2pzdHMuZ2VvbS5MaW5lU2VnbWVudC5wcm90b3R5cGUuY29tcGFyZVRvPWZ1bmN0aW9uKG8pe3ZhciBjb21wMD10aGlzLnAwLmNvbXBhcmVUbyhvLnAwKTtpZihjb21wMCE9PTApcmV0dXJuIGNvbXAwO3JldHVybiB0aGlzLnAxLmNvbXBhcmVUbyhvLnAxKTt9O2pzdHMuZ2VvbS5MaW5lU2VnbWVudC5wcm90b3R5cGUuZXF1YWxzVG9wbz1mdW5jdGlvbihvdGhlcil7cmV0dXJuIHRoaXMucDAuZXF1YWxzKG90aGVyLnAwKSYmdGhpcy5wMS5lcXVhbHMob3RoZXIucDEpfHx0aGlzLnAwLmVxdWFscyhvdGhlci5wMSkmJnRoaXMucDEuZXF1YWxzKG90aGVyLnAwKTt9O2pzdHMuZ2VvbS5MaW5lU2VnbWVudC5wcm90b3R5cGUudG9TdHJpbmc9ZnVuY3Rpb24oKXtyZXR1cm5cIkxJTkVTVFJJTkcoXCIrXG50aGlzLnAwLngrXCIgXCIrdGhpcy5wMC55XG4rXCIsIFwiK1xudGhpcy5wMS54K1wiIFwiK3RoaXMucDEueStcIilcIjt9O2pzdHMuaW5kZXguY2hhaW4uTW9ub3RvbmVDaGFpbk92ZXJsYXBBY3Rpb249ZnVuY3Rpb24oKXt0aGlzLnRlbXBFbnYxPW5ldyBqc3RzLmdlb20uRW52ZWxvcGUoKTt0aGlzLnRlbXBFbnYyPW5ldyBqc3RzLmdlb20uRW52ZWxvcGUoKTt0aGlzLm92ZXJsYXBTZWcxPW5ldyBqc3RzLmdlb20uTGluZVNlZ21lbnQoKTt0aGlzLm92ZXJsYXBTZWcyPW5ldyBqc3RzLmdlb20uTGluZVNlZ21lbnQoKTt9O2pzdHMuaW5kZXguY2hhaW4uTW9ub3RvbmVDaGFpbk92ZXJsYXBBY3Rpb24ucHJvdG90eXBlLnRlbXBFbnYxPW51bGw7anN0cy5pbmRleC5jaGFpbi5Nb25vdG9uZUNoYWluT3ZlcmxhcEFjdGlvbi5wcm90b3R5cGUudGVtcEVudjI9bnVsbDtqc3RzLmluZGV4LmNoYWluLk1vbm90b25lQ2hhaW5PdmVybGFwQWN0aW9uLnByb3RvdHlwZS5vdmVybGFwU2VnMT1udWxsO2pzdHMuaW5kZXguY2hhaW4uTW9ub3RvbmVDaGFpbk92ZXJsYXBBY3Rpb24ucHJvdG90eXBlLm92ZXJsYXBTZWcyPW51bGw7anN0cy5pbmRleC5jaGFpbi5Nb25vdG9uZUNoYWluT3ZlcmxhcEFjdGlvbi5wcm90b3R5cGUub3ZlcmxhcD1mdW5jdGlvbihtYzEsc3RhcnQxLG1jMixzdGFydDIpe3RoaXMubWMxLmdldExpbmVTZWdtZW50KHN0YXJ0MSx0aGlzLm92ZXJsYXBTZWcxKTt0aGlzLm1jMi5nZXRMaW5lU2VnbWVudChzdGFydDIsdGhpcy5vdmVybGFwU2VnMik7dGhpcy5vdmVybGFwMih0aGlzLm92ZXJsYXBTZWcxLHRoaXMub3ZlcmxhcFNlZzIpO307anN0cy5pbmRleC5jaGFpbi5Nb25vdG9uZUNoYWluT3ZlcmxhcEFjdGlvbi5wcm90b3R5cGUub3ZlcmxhcDI9ZnVuY3Rpb24oc2VnMSxzZWcyKXt9OyhmdW5jdGlvbigpe3ZhciBNb25vdG9uZUNoYWluT3ZlcmxhcEFjdGlvbj1qc3RzLmluZGV4LmNoYWluLk1vbm90b25lQ2hhaW5PdmVybGFwQWN0aW9uO3ZhciBTaW5nbGVQYXNzTm9kZXI9anN0cy5ub2RpbmcuU2luZ2xlUGFzc05vZGVyO3ZhciBTVFJ0cmVlPWpzdHMuaW5kZXguc3RydHJlZS5TVFJ0cmVlO3ZhciBOb2RlZFNlZ21lbnRTdHJpbmc9anN0cy5ub2RpbmcuTm9kZWRTZWdtZW50U3RyaW5nO3ZhciBNb25vdG9uZUNoYWluQnVpbGRlcj1qc3RzLmluZGV4LmNoYWluLk1vbm90b25lQ2hhaW5CdWlsZGVyO3ZhciBTZWdtZW50T3ZlcmxhcEFjdGlvbj1mdW5jdGlvbihzaSl7dGhpcy5zaT1zaTt9O1NlZ21lbnRPdmVybGFwQWN0aW9uLnByb3RvdHlwZT1uZXcgTW9ub3RvbmVDaGFpbk92ZXJsYXBBY3Rpb24oKTtTZWdtZW50T3ZlcmxhcEFjdGlvbi5jb25zdHJ1Y3Rvcj1TZWdtZW50T3ZlcmxhcEFjdGlvbjtTZWdtZW50T3ZlcmxhcEFjdGlvbi5wcm90b3R5cGUuc2k9bnVsbDtTZWdtZW50T3ZlcmxhcEFjdGlvbi5wcm90b3R5cGUub3ZlcmxhcD1mdW5jdGlvbihtYzEsc3RhcnQxLG1jMixzdGFydDIpe3ZhciBzczE9bWMxLmdldENvbnRleHQoKTt2YXIgc3MyPW1jMi5nZXRDb250ZXh0KCk7dGhpcy5zaS5wcm9jZXNzSW50ZXJzZWN0aW9ucyhzczEsc3RhcnQxLHNzMixzdGFydDIpO307anN0cy5ub2RpbmcuTUNJbmRleE5vZGVyPWZ1bmN0aW9uKCl7dGhpcy5tb25vQ2hhaW5zPVtdO3RoaXMuaW5kZXg9bmV3IFNUUnRyZWUoKTt9O2pzdHMubm9kaW5nLk1DSW5kZXhOb2Rlci5wcm90b3R5cGU9bmV3IFNpbmdsZVBhc3NOb2RlcigpO2pzdHMubm9kaW5nLk1DSW5kZXhOb2Rlci5jb25zdHJ1Y3Rvcj1qc3RzLm5vZGluZy5NQ0luZGV4Tm9kZXI7anN0cy5ub2RpbmcuTUNJbmRleE5vZGVyLnByb3RvdHlwZS5tb25vQ2hhaW5zPW51bGw7anN0cy5ub2RpbmcuTUNJbmRleE5vZGVyLnByb3RvdHlwZS5pbmRleD1udWxsO2pzdHMubm9kaW5nLk1DSW5kZXhOb2Rlci5wcm90b3R5cGUuaWRDb3VudGVyPTA7anN0cy5ub2RpbmcuTUNJbmRleE5vZGVyLnByb3RvdHlwZS5ub2RlZFNlZ1N0cmluZ3M9bnVsbDtqc3RzLm5vZGluZy5NQ0luZGV4Tm9kZXIucHJvdG90eXBlLm5PdmVybGFwcz0wO2pzdHMubm9kaW5nLk1DSW5kZXhOb2Rlci5wcm90b3R5cGUuZ2V0TW9ub3RvbmVDaGFpbnM9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5tb25vQ2hhaW5zO307anN0cy5ub2RpbmcuTUNJbmRleE5vZGVyLnByb3RvdHlwZS5nZXRJbmRleD1mdW5jdGlvbigpe3JldHVybiB0aGlzLmluZGV4O307anN0cy5ub2RpbmcuTUNJbmRleE5vZGVyLnByb3RvdHlwZS5nZXROb2RlZFN1YnN0cmluZ3M9ZnVuY3Rpb24oKXtyZXR1cm4gTm9kZWRTZWdtZW50U3RyaW5nLmdldE5vZGVkU3Vic3RyaW5ncyh0aGlzLm5vZGVkU2VnU3RyaW5ncyk7fTtqc3RzLm5vZGluZy5NQ0luZGV4Tm9kZXIucHJvdG90eXBlLmNvbXB1dGVOb2Rlcz1mdW5jdGlvbihpbnB1dFNlZ1N0cmluZ3Mpe3RoaXMubm9kZWRTZWdTdHJpbmdzPWlucHV0U2VnU3RyaW5ncztmb3IodmFyIGk9aW5wdXRTZWdTdHJpbmdzLml0ZXJhdG9yKCk7aS5oYXNOZXh0KCk7KXt0aGlzLmFkZChpLm5leHQoKSk7fVxudGhpcy5pbnRlcnNlY3RDaGFpbnMoKTt9O2pzdHMubm9kaW5nLk1DSW5kZXhOb2Rlci5wcm90b3R5cGUuaW50ZXJzZWN0Q2hhaW5zPWZ1bmN0aW9uKCl7dmFyIG92ZXJsYXBBY3Rpb249bmV3IFNlZ21lbnRPdmVybGFwQWN0aW9uKHRoaXMuc2VnSW50KTtmb3IodmFyIGk9MDtpPHRoaXMubW9ub0NoYWlucy5sZW5ndGg7aSsrKXt2YXIgcXVlcnlDaGFpbj10aGlzLm1vbm9DaGFpbnNbaV07dmFyIG92ZXJsYXBDaGFpbnM9dGhpcy5pbmRleC5xdWVyeShxdWVyeUNoYWluLmdldEVudmVsb3BlKCkpO2Zvcih2YXIgaj0wO2o8b3ZlcmxhcENoYWlucy5sZW5ndGg7aisrKXt2YXIgdGVzdENoYWluPW92ZXJsYXBDaGFpbnNbal07aWYodGVzdENoYWluLmdldElkKCk+cXVlcnlDaGFpbi5nZXRJZCgpKXtxdWVyeUNoYWluLmNvbXB1dGVPdmVybGFwcyh0ZXN0Q2hhaW4sb3ZlcmxhcEFjdGlvbik7dGhpcy5uT3ZlcmxhcHMrKzt9XG5pZih0aGlzLnNlZ0ludC5pc0RvbmUoKSlcbnJldHVybjt9fX07anN0cy5ub2RpbmcuTUNJbmRleE5vZGVyLnByb3RvdHlwZS5hZGQ9ZnVuY3Rpb24oc2VnU3RyKXt2YXIgc2VnQ2hhaW5zPU1vbm90b25lQ2hhaW5CdWlsZGVyLmdldENoYWlucyhzZWdTdHIuZ2V0Q29vcmRpbmF0ZXMoKSxzZWdTdHIpO2Zvcih2YXIgaT0wO2k8c2VnQ2hhaW5zLmxlbmd0aDtpKyspe3ZhciBtYz1zZWdDaGFpbnNbaV07bWMuc2V0SWQodGhpcy5pZENvdW50ZXIrKyk7dGhpcy5pbmRleC5pbnNlcnQobWMuZ2V0RW52ZWxvcGUoKSxtYyk7dGhpcy5tb25vQ2hhaW5zLnB1c2gobWMpO319O30pKCk7anN0cy5zaW1wbGlmeS5MaW5lU2VnbWVudEluZGV4PWZ1bmN0aW9uKCl7dGhpcy5pbmRleD1uZXcganN0cy5pbmRleC5xdWFkdHJlZS5RdWFkdHJlZSgpO307anN0cy5zaW1wbGlmeS5MaW5lU2VnbWVudEluZGV4LnByb3RvdHlwZS5pbmRleD1udWxsO2pzdHMuc2ltcGxpZnkuTGluZVNlZ21lbnRJbmRleC5wcm90b3R5cGUuYWRkPWZ1bmN0aW9uKGxpbmUpe2lmKGxpbmUgaW5zdGFuY2VvZiBqc3RzLmdlb20uTGluZVNlZ21lbnQpe3RoaXMuYWRkMihsaW5lKTtyZXR1cm47fVxudmFyIHNlZ3M9bGluZS5nZXRTZWdtZW50cygpO2Zvcih2YXIgaT0wO2k8c2Vncy5sZW5ndGg7aSsrKXt2YXIgc2VnPXNlZ3NbaV07dGhpcy5hZGQyKHNlZyk7fX07anN0cy5zaW1wbGlmeS5MaW5lU2VnbWVudEluZGV4LnByb3RvdHlwZS5hZGQyPWZ1bmN0aW9uKHNlZyl7dGhpcy5pbmRleC5pbnNlcnQobmV3IGpzdHMuZ2VvbS5FbnZlbG9wZShzZWcucDAsc2VnLnAxKSxzZWcpO307anN0cy5zaW1wbGlmeS5MaW5lU2VnbWVudEluZGV4LnByb3RvdHlwZS5yZW1vdmU9ZnVuY3Rpb24oc2VnKXt0aGlzLmluZGV4LnJlbW92ZShuZXcganN0cy5nZW9tLkVudmVsb3BlKHNlZy5wMCxzZWcucDEpLHNlZyk7fTtqc3RzLnNpbXBsaWZ5LkxpbmVTZWdtZW50SW5kZXgucHJvdG90eXBlLnF1ZXJ5PWZ1bmN0aW9uKHF1ZXJ5U2VnKXt2YXIgZW52PW5ldyBqc3RzLmdlb20uRW52ZWxvcGUocXVlcnlTZWcucDAscXVlcnlTZWcucDEpO3ZhciB2aXNpdG9yPW5ldyBqc3RzLnNpbXBsaWZ5LkxpbmVTZWdtZW50SW5kZXguTGluZVNlZ21lbnRWaXNpdG9yKHF1ZXJ5U2VnKTt0aGlzLmluZGV4LnF1ZXJ5KGVudix2aXNpdG9yKTt2YXIgaXRlbXNGb3VuZD12aXNpdG9yLmdldEl0ZW1zKCk7cmV0dXJuIGl0ZW1zRm91bmQ7fTtqc3RzLnNpbXBsaWZ5LkxpbmVTZWdtZW50SW5kZXguTGluZVNlZ21lbnRWaXNpdG9yPWZ1bmN0aW9uKHF1ZXJ5U2VnKXt0aGlzLml0ZW1zPVtdO3RoaXMucXVlcnlTZWc9cXVlcnlTZWc7fTtqc3RzLnNpbXBsaWZ5LkxpbmVTZWdtZW50SW5kZXguTGluZVNlZ21lbnRWaXNpdG9yLnByb3RvdHlwZT1uZXcganN0cy5pbmRleC5JdGVtVmlzaXRvcigpO2pzdHMuc2ltcGxpZnkuTGluZVNlZ21lbnRJbmRleC5MaW5lU2VnbWVudFZpc2l0b3IucHJvdG90eXBlLnF1ZXJ5U2VnPW51bGw7anN0cy5zaW1wbGlmeS5MaW5lU2VnbWVudEluZGV4LkxpbmVTZWdtZW50VmlzaXRvci5wcm90b3R5cGUuaXRlbXM9bnVsbDtqc3RzLnNpbXBsaWZ5LkxpbmVTZWdtZW50SW5kZXguTGluZVNlZ21lbnRWaXNpdG9yLnByb3RvdHlwZS52aXNpdEl0ZW09ZnVuY3Rpb24oaXRlbSl7dmFyIHNlZz1pdGVtO2lmKGpzdHMuZ2VvbS5FbnZlbG9wZS5pbnRlcnNlY3RzKHNlZy5wMCxzZWcucDEsdGhpcy5xdWVyeVNlZy5wMCx0aGlzLnF1ZXJ5U2VnLnAxKSlcbnRoaXMuaXRlbXMucHVzaChpdGVtKTt9O2pzdHMuc2ltcGxpZnkuTGluZVNlZ21lbnRJbmRleC5MaW5lU2VnbWVudFZpc2l0b3IucHJvdG90eXBlLmdldEl0ZW1zPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuaXRlbXM7fTtqc3RzLmdlb21ncmFwaC5FZGdlRW5kU3Rhcj1mdW5jdGlvbigpe3RoaXMuZWRnZU1hcD1uZXcgamF2YXNjcmlwdC51dGlsLlRyZWVNYXAoKTt0aGlzLmVkZ2VMaXN0PW51bGw7dGhpcy5wdEluQXJlYUxvY2F0aW9uPVtqc3RzLmdlb20uTG9jYXRpb24uTk9ORSxqc3RzLmdlb20uTG9jYXRpb24uTk9ORV07fTtqc3RzLmdlb21ncmFwaC5FZGdlRW5kU3Rhci5wcm90b3R5cGUuZWRnZU1hcD1udWxsO2pzdHMuZ2VvbWdyYXBoLkVkZ2VFbmRTdGFyLnByb3RvdHlwZS5lZGdlTGlzdD1udWxsO2pzdHMuZ2VvbWdyYXBoLkVkZ2VFbmRTdGFyLnByb3RvdHlwZS5wdEluQXJlYUxvY2F0aW9uPW51bGw7anN0cy5nZW9tZ3JhcGguRWRnZUVuZFN0YXIucHJvdG90eXBlLmluc2VydD1mdW5jdGlvbihlKXt0aHJvdyBuZXcganN0cy5lcnJvci5BYnN0cmFjdE1ldGhvZEludm9jYXRpb25FcnJvcigpO307anN0cy5nZW9tZ3JhcGguRWRnZUVuZFN0YXIucHJvdG90eXBlLmluc2VydEVkZ2VFbmQ9ZnVuY3Rpb24oZSxvYmope3RoaXMuZWRnZU1hcC5wdXQoZSxvYmopO3RoaXMuZWRnZUxpc3Q9bnVsbDt9O2pzdHMuZ2VvbWdyYXBoLkVkZ2VFbmRTdGFyLnByb3RvdHlwZS5nZXRDb29yZGluYXRlPWZ1bmN0aW9uKCl7dmFyIGl0PXRoaXMuaXRlcmF0b3IoKTtpZighaXQuaGFzTmV4dCgpKVxucmV0dXJuIG51bGw7dmFyIGU9aXQubmV4dCgpO3JldHVybiBlLmdldENvb3JkaW5hdGUoKTt9O2pzdHMuZ2VvbWdyYXBoLkVkZ2VFbmRTdGFyLnByb3RvdHlwZS5nZXREZWdyZWU9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5lZGdlTWFwLnNpemUoKTt9O2pzdHMuZ2VvbWdyYXBoLkVkZ2VFbmRTdGFyLnByb3RvdHlwZS5pdGVyYXRvcj1mdW5jdGlvbigpe3JldHVybiB0aGlzLmdldEVkZ2VzKCkuaXRlcmF0b3IoKTt9O2pzdHMuZ2VvbWdyYXBoLkVkZ2VFbmRTdGFyLnByb3RvdHlwZS5nZXRFZGdlcz1mdW5jdGlvbigpe2lmKHRoaXMuZWRnZUxpc3Q9PT1udWxsKXt0aGlzLmVkZ2VMaXN0PW5ldyBqYXZhc2NyaXB0LnV0aWwuQXJyYXlMaXN0KHRoaXMuZWRnZU1hcC52YWx1ZXMoKSk7fVxucmV0dXJuIHRoaXMuZWRnZUxpc3Q7fTtqc3RzLmdlb21ncmFwaC5FZGdlRW5kU3Rhci5wcm90b3R5cGUuZ2V0TmV4dENXPWZ1bmN0aW9uKGVlKXt0aGlzLmdldEVkZ2VzKCk7dmFyIGk9dGhpcy5lZGdlTGlzdC5pbmRleE9mKGVlKTt2YXIgaU5leHRDVz1pLTE7aWYoaT09PTApXG5pTmV4dENXPXRoaXMuZWRnZUxpc3QubGVuZ3RoLTE7cmV0dXJuIHRoaXMuZWRnZUxpc3RbaU5leHRDV107fTtqc3RzLmdlb21ncmFwaC5FZGdlRW5kU3Rhci5wcm90b3R5cGUuY29tcHV0ZUxhYmVsbGluZz1mdW5jdGlvbihnZW9tR3JhcGgpe3RoaXMuY29tcHV0ZUVkZ2VFbmRMYWJlbHMoZ2VvbUdyYXBoWzBdLmdldEJvdW5kYXJ5Tm9kZVJ1bGUoKSk7dGhpcy5wcm9wYWdhdGVTaWRlTGFiZWxzKDApO3RoaXMucHJvcGFnYXRlU2lkZUxhYmVscygxKTt2YXIgaGFzRGltZW5zaW9uYWxDb2xsYXBzZUVkZ2U9W2ZhbHNlLGZhbHNlXTtmb3IodmFyIGl0PXRoaXMuaXRlcmF0b3IoKTtpdC5oYXNOZXh0KCk7KXt2YXIgZT1pdC5uZXh0KCk7dmFyIGxhYmVsPWUuZ2V0TGFiZWwoKTtmb3IodmFyIGdlb21pPTA7Z2VvbWk8MjtnZW9taSsrKXtpZihsYWJlbC5pc0xpbmUoZ2VvbWkpJiZsYWJlbC5nZXRMb2NhdGlvbihnZW9taSk9PT1qc3RzLmdlb20uTG9jYXRpb24uQk9VTkRBUlkpXG5oYXNEaW1lbnNpb25hbENvbGxhcHNlRWRnZVtnZW9taV09dHJ1ZTt9fVxuZm9yKHZhciBpdD10aGlzLml0ZXJhdG9yKCk7aXQuaGFzTmV4dCgpOyl7dmFyIGU9aXQubmV4dCgpO3ZhciBsYWJlbD1lLmdldExhYmVsKCk7Zm9yKHZhciBnZW9taT0wO2dlb21pPDI7Z2VvbWkrKyl7aWYobGFiZWwuaXNBbnlOdWxsKGdlb21pKSl7dmFyIGxvYz1qc3RzLmdlb20uTG9jYXRpb24uTk9ORTtpZihoYXNEaW1lbnNpb25hbENvbGxhcHNlRWRnZVtnZW9taV0pe2xvYz1qc3RzLmdlb20uTG9jYXRpb24uRVhURVJJT1I7fWVsc2V7dmFyIHA9ZS5nZXRDb29yZGluYXRlKCk7bG9jPXRoaXMuZ2V0TG9jYXRpb24oZ2VvbWkscCxnZW9tR3JhcGgpO31cbmxhYmVsLnNldEFsbExvY2F0aW9uc0lmTnVsbChnZW9taSxsb2MpO319fX07anN0cy5nZW9tZ3JhcGguRWRnZUVuZFN0YXIucHJvdG90eXBlLmNvbXB1dGVFZGdlRW5kTGFiZWxzPWZ1bmN0aW9uKGJvdW5kYXJ5Tm9kZVJ1bGUpe2Zvcih2YXIgaXQ9dGhpcy5pdGVyYXRvcigpO2l0Lmhhc05leHQoKTspe3ZhciBlZT1pdC5uZXh0KCk7ZWUuY29tcHV0ZUxhYmVsKGJvdW5kYXJ5Tm9kZVJ1bGUpO319O2pzdHMuZ2VvbWdyYXBoLkVkZ2VFbmRTdGFyLnByb3RvdHlwZS5nZXRMb2NhdGlvbj1mdW5jdGlvbihnZW9tSW5kZXgscCxnZW9tKXtpZih0aGlzLnB0SW5BcmVhTG9jYXRpb25bZ2VvbUluZGV4XT09PWpzdHMuZ2VvbS5Mb2NhdGlvbi5OT05FKXt0aGlzLnB0SW5BcmVhTG9jYXRpb25bZ2VvbUluZGV4XT1qc3RzLmFsZ29yaXRobS5sb2NhdGUuU2ltcGxlUG9pbnRJbkFyZWFMb2NhdG9yLmxvY2F0ZShwLGdlb21bZ2VvbUluZGV4XS5nZXRHZW9tZXRyeSgpKTt9XG5yZXR1cm4gdGhpcy5wdEluQXJlYUxvY2F0aW9uW2dlb21JbmRleF07fTtqc3RzLmdlb21ncmFwaC5FZGdlRW5kU3Rhci5wcm90b3R5cGUuaXNBcmVhTGFiZWxzQ29uc2lzdGVudD1mdW5jdGlvbihnZW9tR3JhcGgpe3RoaXMuY29tcHV0ZUVkZ2VFbmRMYWJlbHMoZ2VvbUdyYXBoLmdldEJvdW5kYXJ5Tm9kZVJ1bGUoKSk7cmV0dXJuIHRoaXMuY2hlY2tBcmVhTGFiZWxzQ29uc2lzdGVudCgwKTt9O2pzdHMuZ2VvbWdyYXBoLkVkZ2VFbmRTdGFyLnByb3RvdHlwZS5jaGVja0FyZWFMYWJlbHNDb25zaXN0ZW50PWZ1bmN0aW9uKGdlb21JbmRleCl7dmFyIGVkZ2VzPXRoaXMuZ2V0RWRnZXMoKTtpZihlZGdlcy5zaXplKCk8PTApXG5yZXR1cm4gdHJ1ZTt2YXIgbGFzdEVkZ2VJbmRleD1lZGdlcy5zaXplKCktMTt2YXIgc3RhcnRMYWJlbD1lZGdlcy5nZXQobGFzdEVkZ2VJbmRleCkuZ2V0TGFiZWwoKTt2YXIgc3RhcnRMb2M9c3RhcnRMYWJlbC5nZXRMb2NhdGlvbihnZW9tSW5kZXgsanN0cy5nZW9tZ3JhcGguUG9zaXRpb24uTEVGVCk7anN0cy51dGlsLkFzc2VydC5pc1RydWUoc3RhcnRMb2MhPWpzdHMuZ2VvbS5Mb2NhdGlvbi5OT05FLCdGb3VuZCB1bmxhYmVsbGVkIGFyZWEgZWRnZScpO3ZhciBjdXJyTG9jPXN0YXJ0TG9jO2Zvcih2YXIgaXQ9dGhpcy5pdGVyYXRvcigpO2l0Lmhhc05leHQoKTspe3ZhciBlPWl0Lm5leHQoKTt2YXIgbGFiZWw9ZS5nZXRMYWJlbCgpO2pzdHMudXRpbC5Bc3NlcnQuaXNUcnVlKGxhYmVsLmlzQXJlYShnZW9tSW5kZXgpLCdGb3VuZCBub24tYXJlYSBlZGdlJyk7dmFyIGxlZnRMb2M9bGFiZWwuZ2V0TG9jYXRpb24oZ2VvbUluZGV4LGpzdHMuZ2VvbWdyYXBoLlBvc2l0aW9uLkxFRlQpO3ZhciByaWdodExvYz1sYWJlbC5nZXRMb2NhdGlvbihnZW9tSW5kZXgsanN0cy5nZW9tZ3JhcGguUG9zaXRpb24uUklHSFQpO2lmKGxlZnRMb2M9PT1yaWdodExvYyl7cmV0dXJuIGZhbHNlO31cbmlmKHJpZ2h0TG9jIT09Y3VyckxvYyl7cmV0dXJuIGZhbHNlO31cbmN1cnJMb2M9bGVmdExvYzt9XG5yZXR1cm4gdHJ1ZTt9O2pzdHMuZ2VvbWdyYXBoLkVkZ2VFbmRTdGFyLnByb3RvdHlwZS5wcm9wYWdhdGVTaWRlTGFiZWxzPWZ1bmN0aW9uKGdlb21JbmRleCl7dmFyIHN0YXJ0TG9jPWpzdHMuZ2VvbS5Mb2NhdGlvbi5OT05FO2Zvcih2YXIgaXQ9dGhpcy5pdGVyYXRvcigpO2l0Lmhhc05leHQoKTspe3ZhciBlPWl0Lm5leHQoKTt2YXIgbGFiZWw9ZS5nZXRMYWJlbCgpO2lmKGxhYmVsLmlzQXJlYShnZW9tSW5kZXgpJiZsYWJlbC5nZXRMb2NhdGlvbihnZW9tSW5kZXgsanN0cy5nZW9tZ3JhcGguUG9zaXRpb24uTEVGVCkhPT1qc3RzLmdlb20uTG9jYXRpb24uTk9ORSlcbnN0YXJ0TG9jPWxhYmVsLmdldExvY2F0aW9uKGdlb21JbmRleCxqc3RzLmdlb21ncmFwaC5Qb3NpdGlvbi5MRUZUKTt9XG5pZihzdGFydExvYz09PWpzdHMuZ2VvbS5Mb2NhdGlvbi5OT05FKVxucmV0dXJuO3ZhciBjdXJyTG9jPXN0YXJ0TG9jO2Zvcih2YXIgaXQ9dGhpcy5pdGVyYXRvcigpO2l0Lmhhc05leHQoKTspe3ZhciBlPWl0Lm5leHQoKTt2YXIgbGFiZWw9ZS5nZXRMYWJlbCgpO2lmKGxhYmVsLmdldExvY2F0aW9uKGdlb21JbmRleCxqc3RzLmdlb21ncmFwaC5Qb3NpdGlvbi5PTik9PT1qc3RzLmdlb20uTG9jYXRpb24uTk9ORSlcbmxhYmVsLnNldExvY2F0aW9uKGdlb21JbmRleCxqc3RzLmdlb21ncmFwaC5Qb3NpdGlvbi5PTixjdXJyTG9jKTtpZihsYWJlbC5pc0FyZWEoZ2VvbUluZGV4KSl7dmFyIGxlZnRMb2M9bGFiZWwuZ2V0TG9jYXRpb24oZ2VvbUluZGV4LGpzdHMuZ2VvbWdyYXBoLlBvc2l0aW9uLkxFRlQpO3ZhciByaWdodExvYz1sYWJlbC5nZXRMb2NhdGlvbihnZW9tSW5kZXgsanN0cy5nZW9tZ3JhcGguUG9zaXRpb24uUklHSFQpO2lmKHJpZ2h0TG9jIT09anN0cy5nZW9tLkxvY2F0aW9uLk5PTkUpe2lmKHJpZ2h0TG9jIT09Y3VyckxvYylcbnRocm93IG5ldyBqc3RzLmVycm9yLlRvcG9sb2d5RXJyb3IoJ3NpZGUgbG9jYXRpb24gY29uZmxpY3QnLGUuZ2V0Q29vcmRpbmF0ZSgpKTtpZihsZWZ0TG9jPT09anN0cy5nZW9tLkxvY2F0aW9uLk5PTkUpe2pzdHMudXRpbC5Bc3NlcnQuc2hvdWxkTmV2ZXJSZWFjaEhlcmUoJ2ZvdW5kIHNpbmdsZSBudWxsIHNpZGUgKGF0ICcrXG5lLmdldENvb3JkaW5hdGUoKSsnKScpO31cbmN1cnJMb2M9bGVmdExvYzt9ZWxzZXtqc3RzLnV0aWwuQXNzZXJ0LmlzVHJ1ZShsYWJlbC5nZXRMb2NhdGlvbihnZW9tSW5kZXgsanN0cy5nZW9tZ3JhcGguUG9zaXRpb24uTEVGVCk9PT1qc3RzLmdlb20uTG9jYXRpb24uTk9ORSwnZm91bmQgc2luZ2xlIG51bGwgc2lkZScpO2xhYmVsLnNldExvY2F0aW9uKGdlb21JbmRleCxqc3RzLmdlb21ncmFwaC5Qb3NpdGlvbi5SSUdIVCxjdXJyTG9jKTtsYWJlbC5zZXRMb2NhdGlvbihnZW9tSW5kZXgsanN0cy5nZW9tZ3JhcGguUG9zaXRpb24uTEVGVCxjdXJyTG9jKTt9fX19O2pzdHMuZ2VvbWdyYXBoLkVkZ2VFbmRTdGFyLnByb3RvdHlwZS5maW5kSW5kZXg9ZnVuY3Rpb24oZVNlYXJjaCl7dGhpcy5pdGVyYXRvcigpO2Zvcih2YXIgaT0wO2k8dGhpcy5lZGdlTGlzdC5zaXplKCk7aSsrKXt2YXIgZT10aGlzLmVkZ2VMaXN0LmdldChpKTtpZihlPT09ZVNlYXJjaClcbnJldHVybiBpO31cbnJldHVybi0xO307anN0cy5vcGVyYXRpb24ucmVsYXRlLkVkZ2VFbmRCdW5kbGVTdGFyPWZ1bmN0aW9uKCl7anN0cy5nZW9tZ3JhcGguRWRnZUVuZFN0YXIuYXBwbHkodGhpcyxhcmd1bWVudHMpO307anN0cy5vcGVyYXRpb24ucmVsYXRlLkVkZ2VFbmRCdW5kbGVTdGFyLnByb3RvdHlwZT1uZXcganN0cy5nZW9tZ3JhcGguRWRnZUVuZFN0YXIoKTtqc3RzLm9wZXJhdGlvbi5yZWxhdGUuRWRnZUVuZEJ1bmRsZVN0YXIucHJvdG90eXBlLmluc2VydD1mdW5jdGlvbihlKXt2YXIgZWI9dGhpcy5lZGdlTWFwLmdldChlKTtpZihlYj09PW51bGwpe2ViPW5ldyBqc3RzLm9wZXJhdGlvbi5yZWxhdGUuRWRnZUVuZEJ1bmRsZShlKTt0aGlzLmluc2VydEVkZ2VFbmQoZSxlYik7fVxuZWxzZXtlYi5pbnNlcnQoZSk7fX07anN0cy5vcGVyYXRpb24ucmVsYXRlLkVkZ2VFbmRCdW5kbGVTdGFyLnByb3RvdHlwZS51cGRhdGVJTT1mdW5jdGlvbihpbSl7Zm9yKHZhciBpdD10aGlzLml0ZXJhdG9yKCk7aXQuaGFzTmV4dCgpOyl7dmFyIGVzYj1pdC5uZXh0KCk7ZXNiLnVwZGF0ZUlNKGltKTt9fTtqc3RzLmluZGV4LkFycmF5TGlzdFZpc2l0b3I9ZnVuY3Rpb24oKXt0aGlzLml0ZW1zPVtdO307anN0cy5pbmRleC5BcnJheUxpc3RWaXNpdG9yLnByb3RvdHlwZS52aXNpdEl0ZW09ZnVuY3Rpb24oaXRlbSl7dGhpcy5pdGVtcy5wdXNoKGl0ZW0pO307anN0cy5pbmRleC5BcnJheUxpc3RWaXNpdG9yLnByb3RvdHlwZS5nZXRJdGVtcz1mdW5jdGlvbigpe3JldHVybiB0aGlzLml0ZW1zO307anN0cy5hbGdvcml0aG0uZGlzdGFuY2UuRGlzdGFuY2VUb1BvaW50PWZ1bmN0aW9uKCl7fTtqc3RzLmFsZ29yaXRobS5kaXN0YW5jZS5EaXN0YW5jZVRvUG9pbnQuY29tcHV0ZURpc3RhbmNlPWZ1bmN0aW9uKGdlb20scHQscHREaXN0KXtpZihnZW9tIGluc3RhbmNlb2YganN0cy5nZW9tLkxpbmVTdHJpbmcpe2pzdHMuYWxnb3JpdGhtLmRpc3RhbmNlLkRpc3RhbmNlVG9Qb2ludC5jb21wdXRlRGlzdGFuY2UyKGdlb20scHQscHREaXN0KTt9ZWxzZSBpZihnZW9tIGluc3RhbmNlb2YganN0cy5nZW9tLlBvbHlnb24pe2pzdHMuYWxnb3JpdGhtLmRpc3RhbmNlLkRpc3RhbmNlVG9Qb2ludC5jb21wdXRlRGlzdGFuY2U0KGdlb20scHQscHREaXN0KTt9ZWxzZSBpZihnZW9tIGluc3RhbmNlb2YganN0cy5nZW9tLkdlb21ldHJ5Q29sbGVjdGlvbil7dmFyIGdjPWdlb207Zm9yKHZhciBpPTA7aTxnYy5nZXROdW1HZW9tZXRyaWVzKCk7aSsrKXt2YXIgZz1nYy5nZXRHZW9tZXRyeU4oaSk7anN0cy5hbGdvcml0aG0uZGlzdGFuY2UuRGlzdGFuY2VUb1BvaW50LmNvbXB1dGVEaXN0YW5jZShnLHB0LHB0RGlzdCk7fX1lbHNle3B0RGlzdC5zZXRNaW5pbXVtKGdlb20uZ2V0Q29vcmRpbmF0ZSgpLHB0KTt9fTtqc3RzLmFsZ29yaXRobS5kaXN0YW5jZS5EaXN0YW5jZVRvUG9pbnQuY29tcHV0ZURpc3RhbmNlMj1mdW5jdGlvbihsaW5lLHB0LHB0RGlzdCl7dmFyIHRlbXBTZWdtZW50PW5ldyBqc3RzLmdlb20uTGluZVNlZ21lbnQoKTt2YXIgY29vcmRzPWxpbmUuZ2V0Q29vcmRpbmF0ZXMoKTtmb3IodmFyIGk9MDtpPGNvb3Jkcy5sZW5ndGgtMTtpKyspe3RlbXBTZWdtZW50LnNldENvb3JkaW5hdGVzKGNvb3Jkc1tpXSxjb29yZHNbaSsxXSk7dmFyIGNsb3Nlc3RQdD10ZW1wU2VnbWVudC5jbG9zZXN0UG9pbnQocHQpO3B0RGlzdC5zZXRNaW5pbXVtKGNsb3Nlc3RQdCxwdCk7fX07anN0cy5hbGdvcml0aG0uZGlzdGFuY2UuRGlzdGFuY2VUb1BvaW50LmNvbXB1dGVEaXN0YW5jZTM9ZnVuY3Rpb24oc2VnbWVudCxwdCxwdERpc3Qpe3ZhciBjbG9zZXN0UHQ9c2VnbWVudC5jbG9zZXN0UG9pbnQocHQpO3B0RGlzdC5zZXRNaW5pbXVtKGNsb3Nlc3RQdCxwdCk7fTtqc3RzLmFsZ29yaXRobS5kaXN0YW5jZS5EaXN0YW5jZVRvUG9pbnQuY29tcHV0ZURpc3RhbmNlND1mdW5jdGlvbihwb2x5LHB0LHB0RGlzdCl7anN0cy5hbGdvcml0aG0uZGlzdGFuY2UuRGlzdGFuY2VUb1BvaW50LmNvbXB1dGVEaXN0YW5jZTIocG9seS5nZXRFeHRlcmlvclJpbmcoKSxwdCxwdERpc3QpO2Zvcih2YXIgaT0wO2k8cG9seS5nZXROdW1JbnRlcmlvclJpbmcoKTtpKyspe2pzdHMuYWxnb3JpdGhtLmRpc3RhbmNlLkRpc3RhbmNlVG9Qb2ludC5jb21wdXRlRGlzdGFuY2UyKHBvbHkuZ2V0SW50ZXJpb3JSaW5nTihpKSxwdCxwdERpc3QpO319O2pzdHMuaW5kZXguc3RydHJlZS5JdGVtQm91bmRhYmxlPWZ1bmN0aW9uKGJvdW5kcyxpdGVtKXt0aGlzLmJvdW5kcz1ib3VuZHM7dGhpcy5pdGVtPWl0ZW07fTtqc3RzLmluZGV4LnN0cnRyZWUuSXRlbUJvdW5kYWJsZS5wcm90b3R5cGU9bmV3IGpzdHMuaW5kZXguc3RydHJlZS5Cb3VuZGFibGUoKTtqc3RzLmluZGV4LnN0cnRyZWUuSXRlbUJvdW5kYWJsZS5jb25zdHJ1Y3Rvcj1qc3RzLmluZGV4LnN0cnRyZWUuSXRlbUJvdW5kYWJsZTtqc3RzLmluZGV4LnN0cnRyZWUuSXRlbUJvdW5kYWJsZS5wcm90b3R5cGUuYm91bmRzPW51bGw7anN0cy5pbmRleC5zdHJ0cmVlLkl0ZW1Cb3VuZGFibGUucHJvdG90eXBlLml0ZW09bnVsbDtqc3RzLmluZGV4LnN0cnRyZWUuSXRlbUJvdW5kYWJsZS5wcm90b3R5cGUuZ2V0Qm91bmRzPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuYm91bmRzO307anN0cy5pbmRleC5zdHJ0cmVlLkl0ZW1Cb3VuZGFibGUucHJvdG90eXBlLmdldEl0ZW09ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5pdGVtO307KGZ1bmN0aW9uKCl7dmFyIEFycmF5TGlzdD1qYXZhc2NyaXB0LnV0aWwuQXJyYXlMaXN0O3ZhciBUcmVlTWFwPWphdmFzY3JpcHQudXRpbC5UcmVlTWFwO2pzdHMuZ2VvbWdyYXBoLkVkZ2VMaXN0PWZ1bmN0aW9uKCl7dGhpcy5lZGdlcz1uZXcgQXJyYXlMaXN0KCk7dGhpcy5vY2FNYXA9bmV3IFRyZWVNYXAoKTt9O2pzdHMuZ2VvbWdyYXBoLkVkZ2VMaXN0LnByb3RvdHlwZS5lZGdlcz1udWxsO2pzdHMuZ2VvbWdyYXBoLkVkZ2VMaXN0LnByb3RvdHlwZS5vY2FNYXA9bnVsbDtqc3RzLmdlb21ncmFwaC5FZGdlTGlzdC5wcm90b3R5cGUuYWRkPWZ1bmN0aW9uKGUpe3RoaXMuZWRnZXMuYWRkKGUpO3ZhciBvY2E9bmV3IGpzdHMubm9kaW5nLk9yaWVudGVkQ29vcmRpbmF0ZUFycmF5KGUuZ2V0Q29vcmRpbmF0ZXMoKSk7dGhpcy5vY2FNYXAucHV0KG9jYSxlKTt9O2pzdHMuZ2VvbWdyYXBoLkVkZ2VMaXN0LnByb3RvdHlwZS5hZGRBbGw9ZnVuY3Rpb24oZWRnZUNvbGwpe2Zvcih2YXIgaT1lZGdlQ29sbC5pdGVyYXRvcigpO2kuaGFzTmV4dCgpOyl7dGhpcy5hZGQoaS5uZXh0KCkpO319O2pzdHMuZ2VvbWdyYXBoLkVkZ2VMaXN0LnByb3RvdHlwZS5nZXRFZGdlcz1mdW5jdGlvbigpe3JldHVybiB0aGlzLmVkZ2VzO307anN0cy5nZW9tZ3JhcGguRWRnZUxpc3QucHJvdG90eXBlLmZpbmRFcXVhbEVkZ2U9ZnVuY3Rpb24oZSl7dmFyIG9jYT1uZXcganN0cy5ub2RpbmcuT3JpZW50ZWRDb29yZGluYXRlQXJyYXkoZS5nZXRDb29yZGluYXRlcygpKTt2YXIgbWF0Y2hFZGdlPXRoaXMub2NhTWFwLmdldChvY2EpO3JldHVybiBtYXRjaEVkZ2U7fTtqc3RzLmdlb21ncmFwaC5FZGdlTGlzdC5wcm90b3R5cGUuZ2V0RWRnZXM9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5lZGdlczt9O2pzdHMuZ2VvbWdyYXBoLkVkZ2VMaXN0LnByb3RvdHlwZS5pdGVyYXRvcj1mdW5jdGlvbigpe3JldHVybiB0aGlzLmVkZ2VzLml0ZXJhdG9yKCk7fTtqc3RzLmdlb21ncmFwaC5FZGdlTGlzdC5wcm90b3R5cGUuZ2V0PWZ1bmN0aW9uKGkpe3JldHVybiB0aGlzLmVkZ2VzLmdldChpKTt9O2pzdHMuZ2VvbWdyYXBoLkVkZ2VMaXN0LnByb3RvdHlwZS5maW5kRWRnZUluZGV4PWZ1bmN0aW9uKGUpe2Zvcih2YXIgaT0wO2k8dGhpcy5lZGdlcy5zaXplKCk7aSsrKXtpZih0aGlzLmVkZ2VzLmdldChpKS5lcXVhbHMoZSkpXG5yZXR1cm4gaTt9XG5yZXR1cm4tMTt9O30pKCk7anN0cy5vcGVyYXRpb24uSXNTaW1wbGVPcD1mdW5jdGlvbihnZW9tKXt0aGlzLmdlb209Z2VvbTt9O2pzdHMub3BlcmF0aW9uLklzU2ltcGxlT3AucHJvdG90eXBlLmdlb209bnVsbDtqc3RzLm9wZXJhdGlvbi5Jc1NpbXBsZU9wLnByb3RvdHlwZS5pc0Nsb3NlZEVuZHBvaW50c0luSW50ZXJpb3I9dHJ1ZTtqc3RzLm9wZXJhdGlvbi5Jc1NpbXBsZU9wLnByb3RvdHlwZS5ub25TaW1wbGVMb2NhdGlvbj1udWxsO2pzdHMub3BlcmF0aW9uLklzU2ltcGxlT3AucHJvdG90eXBlLklzU2ltcGxlT3A9ZnVuY3Rpb24oZ2VvbSl7dGhpcy5nZW9tPWdlb207fTtqc3RzLm9wZXJhdGlvbi5Jc1NpbXBsZU9wLnByb3RvdHlwZS5pc1NpbXBsZT1mdW5jdGlvbigpe3RoaXMubm9uU2ltcGxlTG9jYXRpb249bnVsbDtpZih0aGlzLmdlb20gaW5zdGFuY2VvZiBqc3RzLmdlb20uTGluZVN0cmluZyl7cmV0dXJuIHRoaXMuaXNTaW1wbGVMaW5lYXJHZW9tZXRyeSh0aGlzLmdlb20pO31cbmlmKHRoaXMuZ2VvbSBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5NdWx0aUxpbmVTdHJpbmcpe3JldHVybiB0aGlzLmlzU2ltcGxlTGluZWFyR2VvbWV0cnkodGhpcy5nZW9tKTt9XG5pZih0aGlzLmdlb20gaW5zdGFuY2VvZiBqc3RzLmdlb20uTXVsdGlQb2ludCl7cmV0dXJuIHRoaXMuaXNTaW1wbGVNdWx0aVBvaW50KHRoaXMuZ2VvbSk7fVxucmV0dXJuIHRydWU7fTtqc3RzLm9wZXJhdGlvbi5Jc1NpbXBsZU9wLnByb3RvdHlwZS5pc1NpbXBsZU11bHRpUG9pbnQ9ZnVuY3Rpb24obXApe2lmKG1wLmlzRW1wdHkoKSlcbnJldHVybiB0cnVlO3ZhciBwb2ludHM9W107Zm9yKHZhciBpPTA7aTxtcC5nZXROdW1HZW9tZXRyaWVzKCk7aSsrKXt2YXIgcHQ9bXAuZ2V0R2VvbWV0cnlOKGkpO3ZhciBwPXB0LmdldENvb3JkaW5hdGUoKTtmb3IodmFyIGo9MDtqPHBvaW50cy5sZW5ndGg7aisrKXt2YXIgcG9pbnQ9cG9pbnRzW2pdO2lmKHAuZXF1YWxzMkQocG9pbnQpKXt0aGlzLm5vblNpbXBsZUxvY2F0aW9uPXA7cmV0dXJuIGZhbHNlO319XG5wb2ludHMucHVzaChwKTt9XG5yZXR1cm4gdHJ1ZTt9O2pzdHMub3BlcmF0aW9uLklzU2ltcGxlT3AucHJvdG90eXBlLmlzU2ltcGxlTGluZWFyR2VvbWV0cnk9ZnVuY3Rpb24oZ2VvbSl7aWYoZ2VvbS5pc0VtcHR5KCkpXG5yZXR1cm4gdHJ1ZTt2YXIgZ3JhcGg9bmV3IGpzdHMuZ2VvbWdyYXBoLkdlb21ldHJ5R3JhcGgoMCxnZW9tKTt2YXIgbGk9bmV3IGpzdHMuYWxnb3JpdGhtLlJvYnVzdExpbmVJbnRlcnNlY3RvcigpO3ZhciBzaT1ncmFwaC5jb21wdXRlU2VsZk5vZGVzKGxpLHRydWUpO2lmKCFzaS5oYXNJbnRlcnNlY3Rpb24oKSlcbnJldHVybiB0cnVlO2lmKHNpLmhhc1Byb3BlckludGVyc2VjdGlvbigpKXt0aGlzLm5vblNpbXBsZUxvY2F0aW9uPXNpLmdldFByb3BlckludGVyc2VjdGlvblBvaW50KCk7cmV0dXJuIGZhbHNlO31cbmlmKHRoaXMuaGFzTm9uRW5kcG9pbnRJbnRlcnNlY3Rpb24oZ3JhcGgpKVxucmV0dXJuIGZhbHNlO2lmKHRoaXMuaXNDbG9zZWRFbmRwb2ludHNJbkludGVyaW9yKXtpZih0aGlzLmhhc0Nsb3NlZEVuZHBvaW50SW50ZXJzZWN0aW9uKGdyYXBoKSlcbnJldHVybiBmYWxzZTt9XG5yZXR1cm4gdHJ1ZTt9O2pzdHMub3BlcmF0aW9uLklzU2ltcGxlT3AucHJvdG90eXBlLmhhc05vbkVuZHBvaW50SW50ZXJzZWN0aW9uPWZ1bmN0aW9uKGdyYXBoKXtmb3IodmFyIGk9Z3JhcGguZ2V0RWRnZUl0ZXJhdG9yKCk7aS5oYXNOZXh0KCk7KXt2YXIgZT1pLm5leHQoKTt2YXIgbWF4U2VnbWVudEluZGV4PWUuZ2V0TWF4aW11bVNlZ21lbnRJbmRleCgpO2Zvcih2YXIgZWlJdD1lLmdldEVkZ2VJbnRlcnNlY3Rpb25MaXN0KCkuaXRlcmF0b3IoKTtlaUl0Lmhhc05leHQoKTspe3ZhciBlaT1laUl0Lm5leHQoKTtpZighZWkuaXNFbmRQb2ludChtYXhTZWdtZW50SW5kZXgpKXt0aGlzLm5vblNpbXBsZUxvY2F0aW9uPWVpLmdldENvb3JkaW5hdGUoKTtyZXR1cm4gdHJ1ZTt9fX1cbnJldHVybiBmYWxzZTt9O2pzdHMub3BlcmF0aW9uLklzU2ltcGxlT3AucHJvdG90eXBlLmhhc0Nsb3NlZEVuZHBvaW50SW50ZXJzZWN0aW9uPWZ1bmN0aW9uKGdyYXBoKXt2YXIgZW5kUG9pbnRzPW5ldyBqYXZhc2NyaXB0LnV0aWwuVHJlZU1hcCgpO2Zvcih2YXIgaT1ncmFwaC5nZXRFZGdlSXRlcmF0b3IoKTtpLmhhc05leHQoKTspe3ZhciBlPWkubmV4dCgpO3ZhciBtYXhTZWdtZW50SW5kZXg9ZS5nZXRNYXhpbXVtU2VnbWVudEluZGV4KCk7dmFyIGlzQ2xvc2VkPWUuaXNDbG9zZWQoKTt2YXIgcDA9ZS5nZXRDb29yZGluYXRlKDApO3RoaXMuYWRkRW5kcG9pbnQoZW5kUG9pbnRzLHAwLGlzQ2xvc2VkKTt2YXIgcDE9ZS5nZXRDb29yZGluYXRlKGUuZ2V0TnVtUG9pbnRzKCktMSk7dGhpcy5hZGRFbmRwb2ludChlbmRQb2ludHMscDEsaXNDbG9zZWQpO31cbmZvcih2YXIgaT1lbmRQb2ludHMudmFsdWVzKCkuaXRlcmF0b3IoKTtpLmhhc05leHQoKTspe3ZhciBlaUluZm89aS5uZXh0KCk7aWYoZWlJbmZvLmlzQ2xvc2VkJiZlaUluZm8uZGVncmVlIT0yKXt0aGlzLm5vblNpbXBsZUxvY2F0aW9uPWVpSW5mby5nZXRDb29yZGluYXRlKCk7cmV0dXJuIHRydWU7fX1cbnJldHVybiBmYWxzZTt9O2pzdHMub3BlcmF0aW9uLklzU2ltcGxlT3AuRW5kcG9pbnRJbmZvPWZ1bmN0aW9uKHB0KXt0aGlzLnB0PXB0O3RoaXMuaXNDbG9zZWQ9ZmFsc2U7dGhpcy5kZWdyZWU9MDt9O2pzdHMub3BlcmF0aW9uLklzU2ltcGxlT3AuRW5kcG9pbnRJbmZvLnByb3RvdHlwZS5wdD1udWxsO2pzdHMub3BlcmF0aW9uLklzU2ltcGxlT3AuRW5kcG9pbnRJbmZvLnByb3RvdHlwZS5pc0Nsb3NlZD1udWxsO2pzdHMub3BlcmF0aW9uLklzU2ltcGxlT3AuRW5kcG9pbnRJbmZvLnByb3RvdHlwZS5kZWdyZWU9bnVsbDtqc3RzLm9wZXJhdGlvbi5Jc1NpbXBsZU9wLkVuZHBvaW50SW5mby5wcm90b3R5cGUuZ2V0Q29vcmRpbmF0ZT1mdW5jdGlvbigpe3JldHVybiB0aGlzLnB0O307anN0cy5vcGVyYXRpb24uSXNTaW1wbGVPcC5FbmRwb2ludEluZm8ucHJvdG90eXBlLmFkZEVuZHBvaW50PWZ1bmN0aW9uKGlzQ2xvc2VkKXt0aGlzLmRlZ3JlZSsrO3RoaXMuaXNDbG9zZWQ9dGhpcy5pc0Nsb3NlZHx8aXNDbG9zZWQ7fTtqc3RzLm9wZXJhdGlvbi5Jc1NpbXBsZU9wLnByb3RvdHlwZS5hZGRFbmRwb2ludD1mdW5jdGlvbihlbmRQb2ludHMscCxpc0Nsb3NlZCl7dmFyIGVpSW5mbz1lbmRQb2ludHMuZ2V0KHApO2lmKGVpSW5mbz09PW51bGwpe2VpSW5mbz1uZXcganN0cy5vcGVyYXRpb24uSXNTaW1wbGVPcC5FbmRwb2ludEluZm8ocCk7ZW5kUG9pbnRzLnB1dChwLGVpSW5mbyk7fVxuZWlJbmZvLmFkZEVuZHBvaW50KGlzQ2xvc2VkKTt9OyhmdW5jdGlvbigpe3ZhciBMaW5lU3RyaW5nU25hcHBlcj1mdW5jdGlvbigpe3RoaXMuc25hcFRvbGVyYW5jZT0wLjA7dGhpcy5zZWc9bmV3IGpzdHMuZ2VvbS5MaW5lU2VnbWVudCgpO3RoaXMuYWxsb3dTbmFwcGluZ1RvU291cmNlVmVydGljZXM9ZmFsc2U7dGhpcy5pc0Nsb3NlZD1mYWxzZTt0aGlzLnNyY1B0cz1bXTtpZihhcmd1bWVudHNbMF1pbnN0YW5jZW9mIGpzdHMuZ2VvbS5MaW5lU3RyaW5nKXt0aGlzLmluaXRGcm9tTGluZS5hcHBseSh0aGlzLGFyZ3VtZW50cyk7fWVsc2V7dGhpcy5pbml0RnJvbVBvaW50cy5hcHBseSh0aGlzLGFyZ3VtZW50cyk7fX07TGluZVN0cmluZ1NuYXBwZXIucHJvdG90eXBlLmluaXRGcm9tTGluZT1mdW5jdGlvbihzcmNMaW5lLHNuYXBUb2xlcmFuY2Upe3RoaXMuaW5pdEZyb21Qb2ludHMoc3JjTGluZS5nZXRDb29yZGluYXRlcygpLHNuYXBUb2xlcmFuY2UpO307TGluZVN0cmluZ1NuYXBwZXIucHJvdG90eXBlLmluaXRGcm9tUG9pbnRzPWZ1bmN0aW9uKHNyY1B0cyxzbmFwVG9sZXJhbmNlKXt0aGlzLnNyY1B0cz1zcmNQdHM7dGhpcy5pc0Nsb3NlZD10aGlzLmNhbGNJc0Nsb3NlZChzcmNQdHMpO3RoaXMuc25hcFRvbGVyYW5jZT1zbmFwVG9sZXJhbmNlO307TGluZVN0cmluZ1NuYXBwZXIucHJvdG90eXBlLnNldEFsbG93U25hcHBpbmdUb1NvdXJjZVZlcnRpY2VzPWZ1bmN0aW9uKGFsbG93U25hcHBpbmdUb1NvdXJjZVZlcnRpY2VzKXt0aGlzLmFsbG93U25hcHBpbmdUb1NvdXJjZVZlcnRpY2VzPWFsbG93U25hcHBpbmdUb1NvdXJjZVZlcnRpY2VzO307TGluZVN0cmluZ1NuYXBwZXIucHJvdG90eXBlLmNhbGNJc0Nsb3NlZD1mdW5jdGlvbihwdHMpe2lmKHB0cy5sZW5ndGg8PTEpe3JldHVybiBmYWxzZTt9XG5yZXR1cm4gcHRzWzBdLmVxdWFscyhwdHNbcHRzLmxlbmd0aC0xXSk7fTtMaW5lU3RyaW5nU25hcHBlci5wcm90b3R5cGUuc25hcFRvPWZ1bmN0aW9uKHNuYXBQdHMpe3ZhciBjb29yZExpc3Q9bmV3IGpzdHMuZ2VvbS5Db29yZGluYXRlTGlzdCh0aGlzLnNyY1B0cyk7dGhpcy5zbmFwVmVydGljZXMoY29vcmRMaXN0LHNuYXBQdHMpO3RoaXMuc25hcFNlZ21lbnRzKGNvb3JkTGlzdCxzbmFwUHRzKTtyZXR1cm4gY29vcmRMaXN0LnRvQ29vcmRpbmF0ZUFycmF5KCk7fTtMaW5lU3RyaW5nU25hcHBlci5wcm90b3R5cGUuc25hcFZlcnRpY2VzPWZ1bmN0aW9uKHNyY0Nvb3JkcyxzbmFwUHRzKXt2YXIgZW5kPXRoaXMuaXNDbG9zZWQ/c3JjQ29vcmRzLnNpemUoKS0xOnNyY0Nvb3Jkcy5zaXplKCksaT0wLHNyY1B0LHNuYXBWZXJ0O2ZvcihpO2k8ZW5kO2krKyl7c3JjUHQ9c3JjQ29vcmRzLmdldChpKTtzbmFwVmVydD10aGlzLmZpbmRTbmFwRm9yVmVydGV4KHNyY1B0LHNuYXBQdHMpO2lmKHNuYXBWZXJ0IT09bnVsbCl7c3JjQ29vcmRzLnNldChpLG5ldyBqc3RzLmdlb20uQ29vcmRpbmF0ZShzbmFwVmVydCkpO2lmKGk9PT0wJiZ0aGlzLmlzQ2xvc2VkKVxuc3JjQ29vcmRzLnNldChzcmNDb29yZHMuc2l6ZSgpLTEsbmV3IGpzdHMuZ2VvbS5Db29yZGluYXRlKHNuYXBWZXJ0KSk7fX19O0xpbmVTdHJpbmdTbmFwcGVyLnByb3RvdHlwZS5maW5kU25hcEZvclZlcnRleD1mdW5jdGlvbihwdCxzbmFwUHRzKXt2YXIgaT0wLGlsPXNuYXBQdHMubGVuZ3RoO2ZvcihpPTA7aTxpbDtpKyspe2lmKHB0LmVxdWFscyhzbmFwUHRzW2ldKSl7cmV0dXJuIG51bGw7fVxuaWYocHQuZGlzdGFuY2Uoc25hcFB0c1tpXSk8dGhpcy5zbmFwVG9sZXJhbmNlKXtyZXR1cm4gc25hcFB0c1tpXTt9fVxucmV0dXJuIG51bGw7fTtMaW5lU3RyaW5nU25hcHBlci5wcm90b3R5cGUuc25hcFNlZ21lbnRzPWZ1bmN0aW9uKHNyY0Nvb3JkcyxzbmFwUHRzKXtpZihzbmFwUHRzLmxlbmd0aD09PTApe3JldHVybjt9XG52YXIgZGlzdGluY3RQdENvdW50PXNuYXBQdHMubGVuZ3RoLGksc25hcFB0LGluZGV4O2lmKHNuYXBQdHMubGVuZ3RoPjEmJnNuYXBQdHNbMF0uZXF1YWxzMkQoc25hcFB0c1tzbmFwUHRzLmxlbmd0aC0xXSkpe2Rpc3RpbmN0UHRDb3VudD1zbmFwUHRzLmxlbmd0aC0xO31cbmk9MDtmb3IoaTtpPGRpc3RpbmN0UHRDb3VudDtpKyspe3NuYXBQdD1zbmFwUHRzW2ldO2luZGV4PXRoaXMuZmluZFNlZ21lbnRJbmRleFRvU25hcChzbmFwUHQsc3JjQ29vcmRzKTtpZihpbmRleD49MCl7c3JjQ29vcmRzLmFkZChpbmRleCsxLG5ldyBqc3RzLmdlb20uQ29vcmRpbmF0ZShzbmFwUHQpLGZhbHNlKTt9fX07TGluZVN0cmluZ1NuYXBwZXIucHJvdG90eXBlLmZpbmRTZWdtZW50SW5kZXhUb1NuYXA9ZnVuY3Rpb24oc25hcFB0LHNyY0Nvb3Jkcyl7dmFyIG1pbkRpc3Q9TnVtYmVyLk1BWF9WQUxVRSxzbmFwSW5kZXg9LTEsaT0wLGRpc3Q7Zm9yKGk7aTxzcmNDb29yZHMuc2l6ZSgpLTE7aSsrKXt0aGlzLnNlZy5wMD1zcmNDb29yZHMuZ2V0KGkpO3RoaXMuc2VnLnAxPXNyY0Nvb3Jkcy5nZXQoaSsxKTtpZih0aGlzLnNlZy5wMC5lcXVhbHMoc25hcFB0KXx8dGhpcy5zZWcucDEuZXF1YWxzKHNuYXBQdCkpe2lmKHRoaXMuYWxsb3dTbmFwcGluZ1RvU291cmNlVmVydGljZXMpe2NvbnRpbnVlO31lbHNle3JldHVybi0xO319XG5kaXN0PXRoaXMuc2VnLmRpc3RhbmNlKHNuYXBQdCk7aWYoZGlzdDx0aGlzLnNuYXBUb2xlcmFuY2UmJmRpc3Q8bWluRGlzdCl7bWluRGlzdD1kaXN0O3NuYXBJbmRleD1pO319XG5yZXR1cm4gc25hcEluZGV4O307anN0cy5vcGVyYXRpb24ub3ZlcmxheS5zbmFwLkxpbmVTdHJpbmdTbmFwcGVyPUxpbmVTdHJpbmdTbmFwcGVyO30pKCk7KGZ1bmN0aW9uKCl7dmFyIEFycmF5TGlzdD1qYXZhc2NyaXB0LnV0aWwuQXJyYXlMaXN0O3ZhciBHZW9tZXRyeUNvbXBvbmVudEZpbHRlcj1qc3RzLmdlb20uR2VvbWV0cnlDb21wb25lbnRGaWx0ZXI7dmFyIExpbmVTdHJpbmc9anN0cy5nZW9tLkxpbmVTdHJpbmc7dmFyIEVkZ2VSaW5nPWpzdHMub3BlcmF0aW9uLnBvbHlnb25pemUuRWRnZVJpbmc7dmFyIFBvbHlnb25pemVHcmFwaD1qc3RzLm9wZXJhdGlvbi5wb2x5Z29uaXplLlBvbHlnb25pemVHcmFwaDt2YXIgUG9seWdvbml6ZXI9ZnVuY3Rpb24oKXt2YXIgdGhhdD10aGlzO3ZhciBMaW5lU3RyaW5nQWRkZXI9ZnVuY3Rpb24oKXt9O0xpbmVTdHJpbmdBZGRlci5wcm90b3R5cGU9bmV3IEdlb21ldHJ5Q29tcG9uZW50RmlsdGVyKCk7TGluZVN0cmluZ0FkZGVyLnByb3RvdHlwZS5maWx0ZXI9ZnVuY3Rpb24oZyl7aWYoZyBpbnN0YW5jZW9mIExpbmVTdHJpbmcpXG50aGF0LmFkZChnKTt9O3RoaXMubGluZVN0cmluZ0FkZGVyPW5ldyBMaW5lU3RyaW5nQWRkZXIoKTt0aGlzLmRhbmdsZXM9bmV3IEFycmF5TGlzdCgpO3RoaXMuY3V0RWRnZXM9bmV3IEFycmF5TGlzdCgpO3RoaXMuaW52YWxpZFJpbmdMaW5lcz1uZXcgQXJyYXlMaXN0KCk7fTtQb2x5Z29uaXplci5wcm90b3R5cGUubGluZVN0cmluZ0FkZGVyPW51bGw7UG9seWdvbml6ZXIucHJvdG90eXBlLmdyYXBoPW51bGw7UG9seWdvbml6ZXIucHJvdG90eXBlLmRhbmdsZXM9bnVsbDtQb2x5Z29uaXplci5wcm90b3R5cGUuY3V0RWRnZXM9bnVsbDtQb2x5Z29uaXplci5wcm90b3R5cGUuaW52YWxpZFJpbmdMaW5lcz1udWxsO1BvbHlnb25pemVyLnByb3RvdHlwZS5ob2xlTGlzdD1udWxsO1BvbHlnb25pemVyLnByb3RvdHlwZS5zaGVsbExpc3Q9bnVsbDtQb2x5Z29uaXplci5wcm90b3R5cGUucG9seUxpc3Q9bnVsbDtQb2x5Z29uaXplci5wcm90b3R5cGUuYWRkPWZ1bmN0aW9uKGdlb21MaXN0KXtpZihnZW9tTGlzdCBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5MaW5lU3RyaW5nKXtyZXR1cm4gdGhpcy5hZGQzKGdlb21MaXN0KTt9ZWxzZSBpZihnZW9tTGlzdCBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5HZW9tZXRyeSl7cmV0dXJuIHRoaXMuYWRkMihnZW9tTGlzdCk7fVxuZm9yKHZhciBpPWdlb21MaXN0Lml0ZXJhdG9yKCk7aS5oYXNOZXh0KCk7KXt2YXIgZ2VvbWV0cnk9aS5uZXh0KCk7dGhpcy5hZGQyKGdlb21ldHJ5KTt9fTtQb2x5Z29uaXplci5wcm90b3R5cGUuYWRkMj1mdW5jdGlvbihnKXtnLmFwcGx5KHRoaXMubGluZVN0cmluZ0FkZGVyKTt9O1BvbHlnb25pemVyLnByb3RvdHlwZS5hZGQzPWZ1bmN0aW9uKGxpbmUpe2lmKHRoaXMuZ3JhcGg9PW51bGwpXG50aGlzLmdyYXBoPW5ldyBQb2x5Z29uaXplR3JhcGgobGluZS5nZXRGYWN0b3J5KCkpO3RoaXMuZ3JhcGguYWRkRWRnZShsaW5lKTt9O1BvbHlnb25pemVyLnByb3RvdHlwZS5nZXRQb2x5Z29ucz1mdW5jdGlvbigpe3RoaXMucG9seWdvbml6ZSgpO3JldHVybiB0aGlzLnBvbHlMaXN0O307UG9seWdvbml6ZXIucHJvdG90eXBlLmdldERhbmdsZXM9ZnVuY3Rpb24oKXt0aGlzLnBvbHlnb25pemUoKTtyZXR1cm4gdGhpcy5kYW5nbGVzO307UG9seWdvbml6ZXIucHJvdG90eXBlLmdldEN1dEVkZ2VzPWZ1bmN0aW9uKCl7dGhpcy5wb2x5Z29uaXplKCk7cmV0dXJuIHRoaXMuY3V0RWRnZXM7fTtQb2x5Z29uaXplci5wcm90b3R5cGUuZ2V0SW52YWxpZFJpbmdMaW5lcz1mdW5jdGlvbigpe3RoaXMucG9seWdvbml6ZSgpO3JldHVybiB0aGlzLmludmFsaWRSaW5nTGluZXM7fTtQb2x5Z29uaXplci5wcm90b3R5cGUucG9seWdvbml6ZT1mdW5jdGlvbigpe2lmKHRoaXMucG9seUxpc3QhPW51bGwpXG5yZXR1cm47dGhpcy5wb2x5TGlzdD1uZXcgQXJyYXlMaXN0KCk7aWYodGhpcy5ncmFwaD09bnVsbClcbnJldHVybjt0aGlzLmRhbmdsZXM9dGhpcy5ncmFwaC5kZWxldGVEYW5nbGVzKCk7dGhpcy5jdXRFZGdlcz10aGlzLmdyYXBoLmRlbGV0ZUN1dEVkZ2VzKCk7dmFyIGVkZ2VSaW5nTGlzdD10aGlzLmdyYXBoLmdldEVkZ2VSaW5ncygpO3ZhciB2YWxpZEVkZ2VSaW5nTGlzdD1uZXcgQXJyYXlMaXN0KCk7dGhpcy5pbnZhbGlkUmluZ0xpbmVzPW5ldyBBcnJheUxpc3QoKTt0aGlzLmZpbmRWYWxpZFJpbmdzKGVkZ2VSaW5nTGlzdCx2YWxpZEVkZ2VSaW5nTGlzdCx0aGlzLmludmFsaWRSaW5nTGluZXMpO3RoaXMuZmluZFNoZWxsc0FuZEhvbGVzKHZhbGlkRWRnZVJpbmdMaXN0KTtQb2x5Z29uaXplci5hc3NpZ25Ib2xlc1RvU2hlbGxzKHRoaXMuaG9sZUxpc3QsdGhpcy5zaGVsbExpc3QpO3RoaXMucG9seUxpc3Q9bmV3IEFycmF5TGlzdCgpO2Zvcih2YXIgaT10aGlzLnNoZWxsTGlzdC5pdGVyYXRvcigpO2kuaGFzTmV4dCgpOyl7dmFyIGVyPWkubmV4dCgpO3RoaXMucG9seUxpc3QuYWRkKGVyLmdldFBvbHlnb24oKSk7fX07UG9seWdvbml6ZXIucHJvdG90eXBlLmZpbmRWYWxpZFJpbmdzPWZ1bmN0aW9uKGVkZ2VSaW5nTGlzdCx2YWxpZEVkZ2VSaW5nTGlzdCxpbnZhbGlkUmluZ0xpc3Qpe2Zvcih2YXIgaT1lZGdlUmluZ0xpc3QuaXRlcmF0b3IoKTtpLmhhc05leHQoKTspe3ZhciBlcj1pLm5leHQoKTtpZihlci5pc1ZhbGlkKCkpXG52YWxpZEVkZ2VSaW5nTGlzdC5hZGQoZXIpO2Vsc2VcbmludmFsaWRSaW5nTGlzdC5hZGQoZXIuZ2V0TGluZVN0cmluZygpKTt9fTtQb2x5Z29uaXplci5wcm90b3R5cGUuZmluZFNoZWxsc0FuZEhvbGVzPWZ1bmN0aW9uKGVkZ2VSaW5nTGlzdCl7dGhpcy5ob2xlTGlzdD1uZXcgQXJyYXlMaXN0KCk7dGhpcy5zaGVsbExpc3Q9bmV3IEFycmF5TGlzdCgpO2Zvcih2YXIgaT1lZGdlUmluZ0xpc3QuaXRlcmF0b3IoKTtpLmhhc05leHQoKTspe3ZhciBlcj1pLm5leHQoKTtpZihlci5pc0hvbGUoKSlcbnRoaXMuaG9sZUxpc3QuYWRkKGVyKTtlbHNlXG50aGlzLnNoZWxsTGlzdC5hZGQoZXIpO319O1BvbHlnb25pemVyLmFzc2lnbkhvbGVzVG9TaGVsbHM9ZnVuY3Rpb24oaG9sZUxpc3Qsc2hlbGxMaXN0KXtmb3IodmFyIGk9aG9sZUxpc3QuaXRlcmF0b3IoKTtpLmhhc05leHQoKTspe3ZhciBob2xlRVI9aS5uZXh0KCk7UG9seWdvbml6ZXIuYXNzaWduSG9sZVRvU2hlbGwoaG9sZUVSLHNoZWxsTGlzdCk7fX07UG9seWdvbml6ZXIuYXNzaWduSG9sZVRvU2hlbGw9ZnVuY3Rpb24oaG9sZUVSLHNoZWxsTGlzdCl7dmFyIHNoZWxsPUVkZ2VSaW5nLmZpbmRFZGdlUmluZ0NvbnRhaW5pbmcoaG9sZUVSLHNoZWxsTGlzdCk7aWYoc2hlbGwhPW51bGwpXG5zaGVsbC5hZGRIb2xlKGhvbGVFUi5nZXRSaW5nKCkpO307anN0cy5vcGVyYXRpb24ucG9seWdvbml6ZS5Qb2x5Z29uaXplcj1Qb2x5Z29uaXplcjt9KSgpOyhmdW5jdGlvbigpe3ZhciBBcnJheUxpc3Q9amF2YXNjcmlwdC51dGlsLkFycmF5TGlzdDt2YXIgR2VvbWV0cnlUcmFuc2Zvcm1lcj1mdW5jdGlvbigpe307R2VvbWV0cnlUcmFuc2Zvcm1lci5wcm90b3R5cGUuaW5wdXRHZW9tPW51bGw7R2VvbWV0cnlUcmFuc2Zvcm1lci5wcm90b3R5cGUuZmFjdG9yeT1udWxsO0dlb21ldHJ5VHJhbnNmb3JtZXIucHJvdG90eXBlLnBydW5lRW1wdHlHZW9tZXRyeT10cnVlO0dlb21ldHJ5VHJhbnNmb3JtZXIucHJvdG90eXBlLnByZXNlcnZlR2VvbWV0cnlDb2xsZWN0aW9uVHlwZT10cnVlO0dlb21ldHJ5VHJhbnNmb3JtZXIucHJvdG90eXBlLnByZXNlcnZlQ29sbGVjdGlvbnM9ZmFsc2U7R2VvbWV0cnlUcmFuc2Zvcm1lci5wcm90b3R5cGUucmVzZXJ2ZVR5cGU9ZmFsc2U7R2VvbWV0cnlUcmFuc2Zvcm1lci5wcm90b3R5cGUuZ2V0SW5wdXRHZW9tZXRyeT1mdW5jdGlvbigpe3JldHVybiB0aGlzLmlucHV0R2VvbTt9O0dlb21ldHJ5VHJhbnNmb3JtZXIucHJvdG90eXBlLnRyYW5zZm9ybT1mdW5jdGlvbihpbnB1dEdlb20pe3RoaXMuaW5wdXRHZW9tPWlucHV0R2VvbTt0aGlzLmZhY3Rvcnk9aW5wdXRHZW9tLmdldEZhY3RvcnkoKTtpZihpbnB1dEdlb20gaW5zdGFuY2VvZiBqc3RzLmdlb20uUG9pbnQpXG5yZXR1cm4gdGhpcy50cmFuc2Zvcm1Qb2ludChpbnB1dEdlb20sbnVsbCk7aWYoaW5wdXRHZW9tIGluc3RhbmNlb2YganN0cy5nZW9tLk11bHRpUG9pbnQpXG5yZXR1cm4gdGhpcy50cmFuc2Zvcm1NdWx0aVBvaW50KGlucHV0R2VvbSxudWxsKTtpZihpbnB1dEdlb20gaW5zdGFuY2VvZiBqc3RzLmdlb20uTGluZWFyUmluZylcbnJldHVybiB0aGlzLnRyYW5zZm9ybUxpbmVhclJpbmcoaW5wdXRHZW9tLG51bGwpO2lmKGlucHV0R2VvbSBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5MaW5lU3RyaW5nKVxucmV0dXJuIHRoaXMudHJhbnNmb3JtTGluZVN0cmluZyhpbnB1dEdlb20sbnVsbCk7aWYoaW5wdXRHZW9tIGluc3RhbmNlb2YganN0cy5nZW9tLk11bHRpTGluZVN0cmluZylcbnJldHVybiB0aGlzLnRyYW5zZm9ybU11bHRpTGluZVN0cmluZyhpbnB1dEdlb20sbnVsbCk7aWYoaW5wdXRHZW9tIGluc3RhbmNlb2YganN0cy5nZW9tLlBvbHlnb24pXG5yZXR1cm4gdGhpcy50cmFuc2Zvcm1Qb2x5Z29uKGlucHV0R2VvbSxudWxsKTtpZihpbnB1dEdlb20gaW5zdGFuY2VvZiBqc3RzLmdlb20uTXVsdGlQb2x5Z29uKVxucmV0dXJuIHRoaXMudHJhbnNmb3JtTXVsdGlQb2x5Z29uKGlucHV0R2VvbSxudWxsKTtpZihpbnB1dEdlb20gaW5zdGFuY2VvZiBqc3RzLmdlb20uR2VvbWV0cnlDb2xsZWN0aW9uKVxucmV0dXJuIHRoaXMudHJhbnNmb3JtR2VvbWV0cnlDb2xsZWN0aW9uKGlucHV0R2VvbSxudWxsKTt0aHJvdyBuZXcganN0cy5lcnJvci5JbGxlZ2FsQXJndW1lbnRFeGNlcHRpb24oJ1Vua25vd24gR2VvbWV0cnkgc3VidHlwZTogJytcbmlucHV0R2VvbS5nZXRDbGFzcygpLmdldE5hbWUoKSk7fTtHZW9tZXRyeVRyYW5zZm9ybWVyLnByb3RvdHlwZS5jcmVhdGVDb29yZGluYXRlU2VxdWVuY2U9ZnVuY3Rpb24oY29vcmRzKXtyZXR1cm4gdGhpcy5mYWN0b3J5LmdldENvb3JkaW5hdGVTZXF1ZW5jZUZhY3RvcnkoKS5jcmVhdGUoY29vcmRzKTt9O0dlb21ldHJ5VHJhbnNmb3JtZXIucHJvdG90eXBlLmNvcHk9ZnVuY3Rpb24oc2VxKXtyZXR1cm4gc2VxLmNsb25lKCk7fTtHZW9tZXRyeVRyYW5zZm9ybWVyLnByb3RvdHlwZS50cmFuc2Zvcm1Db29yZGluYXRlcz1mdW5jdGlvbihjb29yZHMscGFyZW50KXtyZXR1cm4gdGhpcy5jb3B5KGNvb3Jkcyk7fTtHZW9tZXRyeVRyYW5zZm9ybWVyLnByb3RvdHlwZS50cmFuc2Zvcm1Qb2ludD1mdW5jdGlvbihnZW9tLHBhcmVudCl7cmV0dXJuIHRoaXMuZmFjdG9yeS5jcmVhdGVQb2ludCh0aGlzLnRyYW5zZm9ybUNvb3JkaW5hdGVzKGdlb20uZ2V0Q29vcmRpbmF0ZVNlcXVlbmNlKCksZ2VvbSkpO307R2VvbWV0cnlUcmFuc2Zvcm1lci5wcm90b3R5cGUudHJhbnNmb3JtTXVsdGlQb2ludD1mdW5jdGlvbihnZW9tLHBhcmVudCl7dmFyIHRyYW5zR2VvbUxpc3Q9bmV3IEFycmF5TGlzdCgpO2Zvcih2YXIgaT0wO2k8Z2VvbS5nZXROdW1HZW9tZXRyaWVzKCk7aSsrKXt2YXIgdHJhbnNmb3JtR2VvbT10aGlzLnRyYW5zZm9ybVBvaW50KGdlb20uZ2V0R2VvbWV0cnlOKGkpLGdlb20pO2lmKHRyYW5zZm9ybUdlb209PW51bGwpXG5jb250aW51ZTtpZih0cmFuc2Zvcm1HZW9tLmlzRW1wdHkoKSlcbmNvbnRpbnVlO3RyYW5zR2VvbUxpc3QuYWRkKHRyYW5zZm9ybUdlb20pO31cbnJldHVybiB0aGlzLmZhY3RvcnkuYnVpbGRHZW9tZXRyeSh0cmFuc0dlb21MaXN0KTt9O0dlb21ldHJ5VHJhbnNmb3JtZXIucHJvdG90eXBlLnRyYW5zZm9ybUxpbmVhclJpbmc9ZnVuY3Rpb24oZ2VvbSxwYXJlbnQpe3ZhciBzZXE9dGhpcy50cmFuc2Zvcm1Db29yZGluYXRlcyhnZW9tLmdldENvb3JkaW5hdGVTZXF1ZW5jZSgpLGdlb20pO3ZhciBzZXFTaXplPXNlcS5sZW5ndGg7aWYoc2VxU2l6ZT4wJiZzZXFTaXplPDQmJiF0aGlzLnByZXNlcnZlVHlwZSlcbnJldHVybiB0aGlzLmZhY3RvcnkuY3JlYXRlTGluZVN0cmluZyhzZXEpO3JldHVybiB0aGlzLmZhY3RvcnkuY3JlYXRlTGluZWFyUmluZyhzZXEpO307R2VvbWV0cnlUcmFuc2Zvcm1lci5wcm90b3R5cGUudHJhbnNmb3JtTGluZVN0cmluZz1mdW5jdGlvbihnZW9tLHBhcmVudCl7cmV0dXJuIHRoaXMuZmFjdG9yeS5jcmVhdGVMaW5lU3RyaW5nKHRoaXMudHJhbnNmb3JtQ29vcmRpbmF0ZXMoZ2VvbS5nZXRDb29yZGluYXRlU2VxdWVuY2UoKSxnZW9tKSk7fTtHZW9tZXRyeVRyYW5zZm9ybWVyLnByb3RvdHlwZS50cmFuc2Zvcm1NdWx0aUxpbmVTdHJpbmc9ZnVuY3Rpb24oZ2VvbSxwYXJlbnQpe3ZhciB0cmFuc0dlb21MaXN0PW5ldyBBcnJheUxpc3QoKTtmb3IodmFyIGk9MDtpPGdlb20uZ2V0TnVtR2VvbWV0cmllcygpO2krKyl7dmFyIHRyYW5zZm9ybUdlb209dGhpcy50cmFuc2Zvcm1MaW5lU3RyaW5nKGdlb20uZ2V0R2VvbWV0cnlOKGkpLGdlb20pO2lmKHRyYW5zZm9ybUdlb209PW51bGwpXG5jb250aW51ZTtpZih0cmFuc2Zvcm1HZW9tLmlzRW1wdHkoKSlcbmNvbnRpbnVlO3RyYW5zR2VvbUxpc3QuYWRkKHRyYW5zZm9ybUdlb20pO31cbnJldHVybiB0aGlzLmZhY3RvcnkuYnVpbGRHZW9tZXRyeSh0cmFuc0dlb21MaXN0KTt9O0dlb21ldHJ5VHJhbnNmb3JtZXIucHJvdG90eXBlLnRyYW5zZm9ybVBvbHlnb249ZnVuY3Rpb24oZ2VvbSxwYXJlbnQpe3ZhciBpc0FsbFZhbGlkTGluZWFyUmluZ3M9dHJ1ZTt2YXIgc2hlbGw9dGhpcy50cmFuc2Zvcm1MaW5lYXJSaW5nKGdlb20uZ2V0RXh0ZXJpb3JSaW5nKCksZ2VvbSk7aWYoc2hlbGw9PW51bGx8fCEoc2hlbGwgaW5zdGFuY2VvZiBqc3RzLmdlb20uTGluZWFyUmluZyl8fHNoZWxsLmlzRW1wdHkoKSlcbmlzQWxsVmFsaWRMaW5lYXJSaW5ncz1mYWxzZTt2YXIgaG9sZXM9bmV3IEFycmF5TGlzdCgpO2Zvcih2YXIgaT0wO2k8Z2VvbS5nZXROdW1JbnRlcmlvclJpbmcoKTtpKyspe3ZhciBob2xlPXRoaXMudHJhbnNmb3JtTGluZWFyUmluZyhnZW9tLmdldEludGVyaW9yUmluZ04oaSksZ2VvbSk7aWYoaG9sZT09bnVsbHx8aG9sZS5pc0VtcHR5KCkpe2NvbnRpbnVlO31cbmlmKCEoaG9sZSBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5MaW5lYXJSaW5nKSlcbmlzQWxsVmFsaWRMaW5lYXJSaW5ncz1mYWxzZTtob2xlcy5hZGQoaG9sZSk7fVxuaWYoaXNBbGxWYWxpZExpbmVhclJpbmdzKVxucmV0dXJuIHRoaXMuZmFjdG9yeS5jcmVhdGVQb2x5Z29uKHNoZWxsLGhvbGVzLnRvQXJyYXkoKSk7ZWxzZXt2YXIgY29tcG9uZW50cz1uZXcgQXJyYXlMaXN0KCk7aWYoc2hlbGwhPW51bGwpXG5jb21wb25lbnRzLmFkZChzaGVsbCk7Y29tcG9uZW50cy5hZGRBbGwoaG9sZXMpO3JldHVybiB0aGlzLmZhY3RvcnkuYnVpbGRHZW9tZXRyeShjb21wb25lbnRzKTt9fTtHZW9tZXRyeVRyYW5zZm9ybWVyLnByb3RvdHlwZS50cmFuc2Zvcm1NdWx0aVBvbHlnb249ZnVuY3Rpb24oZ2VvbSxwYXJlbnQpe3ZhciB0cmFuc0dlb21MaXN0PW5ldyBBcnJheUxpc3QoKTtmb3IodmFyIGk9MDtpPGdlb20uZ2V0TnVtR2VvbWV0cmllcygpO2krKyl7dmFyIHRyYW5zZm9ybUdlb209dGhpcy50cmFuc2Zvcm1Qb2x5Z29uKGdlb20uZ2V0R2VvbWV0cnlOKGkpLGdlb20pO2lmKHRyYW5zZm9ybUdlb209PW51bGwpXG5jb250aW51ZTtpZih0cmFuc2Zvcm1HZW9tLmlzRW1wdHkoKSlcbmNvbnRpbnVlO3RyYW5zR2VvbUxpc3QuYWRkKHRyYW5zZm9ybUdlb20pO31cbnJldHVybiB0aGlzLmZhY3RvcnkuYnVpbGRHZW9tZXRyeSh0cmFuc0dlb21MaXN0KTt9O0dlb21ldHJ5VHJhbnNmb3JtZXIucHJvdG90eXBlLnRyYW5zZm9ybUdlb21ldHJ5Q29sbGVjdGlvbj1mdW5jdGlvbihnZW9tLHBhcmVudCl7dmFyIHRyYW5zR2VvbUxpc3Q9bmV3IEFycmF5TGlzdCgpO2Zvcih2YXIgaT0wO2k8Z2VvbS5nZXROdW1HZW9tZXRyaWVzKCk7aSsrKXt2YXIgdHJhbnNmb3JtR2VvbT10aGlzLnRyYW5zZm9ybShnZW9tLmdldEdlb21ldHJ5TihpKSk7aWYodHJhbnNmb3JtR2VvbT09bnVsbClcbmNvbnRpbnVlO2lmKHRoaXMucHJ1bmVFbXB0eUdlb21ldHJ5JiZ0cmFuc2Zvcm1HZW9tLmlzRW1wdHkoKSlcbmNvbnRpbnVlO3RyYW5zR2VvbUxpc3QuYWRkKHRyYW5zZm9ybUdlb20pO31cbmlmKHRoaXMucHJlc2VydmVHZW9tZXRyeUNvbGxlY3Rpb25UeXBlKVxucmV0dXJuIHRoaXMuZmFjdG9yeS5jcmVhdGVHZW9tZXRyeUNvbGxlY3Rpb24oR2VvbWV0cnlGYWN0b3J5LnRvR2VvbWV0cnlBcnJheSh0cmFuc0dlb21MaXN0KSk7cmV0dXJuIHRoaXMuZmFjdG9yeS5idWlsZEdlb21ldHJ5KHRyYW5zR2VvbUxpc3QpO307anN0cy5nZW9tLnV0aWwuR2VvbWV0cnlUcmFuc2Zvcm1lcj1HZW9tZXRyeVRyYW5zZm9ybWVyO30pKCk7KGZ1bmN0aW9uKCl7dmFyIExpbmVTdHJpbmdTbmFwcGVyPWpzdHMub3BlcmF0aW9uLm92ZXJsYXkuc25hcC5MaW5lU3RyaW5nU25hcHBlcjt2YXIgUHJlY2lzaW9uTW9kZWw9anN0cy5nZW9tLlByZWNpc2lvbk1vZGVsO3ZhciBUcmVlU2V0PWphdmFzY3JpcHQudXRpbC5UcmVlU2V0O3ZhciBTbmFwVHJhbnNmb3JtZXI9ZnVuY3Rpb24oc25hcFRvbGVyYW5jZSxzbmFwUHRzLGlzU2VsZlNuYXApe3RoaXMuc25hcFRvbGVyYW5jZT1zbmFwVG9sZXJhbmNlO3RoaXMuc25hcFB0cz1zbmFwUHRzO3RoaXMuaXNTZWxmU25hcD1pc1NlbGZTbmFwfHxmYWxzZTt9O1NuYXBUcmFuc2Zvcm1lci5wcm90b3R5cGU9bmV3IGpzdHMuZ2VvbS51dGlsLkdlb21ldHJ5VHJhbnNmb3JtZXIoKTtTbmFwVHJhbnNmb3JtZXIucHJvdG90eXBlLnNuYXBUb2xlcmFuY2U9bnVsbDtTbmFwVHJhbnNmb3JtZXIucHJvdG90eXBlLnNuYXBQdHM9bnVsbDtTbmFwVHJhbnNmb3JtZXIucHJvdG90eXBlLmlzU2VsZlNuYXA9ZmFsc2U7U25hcFRyYW5zZm9ybWVyLnByb3RvdHlwZS50cmFuc2Zvcm1Db29yZGluYXRlcz1mdW5jdGlvbihjb29yZHMscGFyZW50KXt2YXIgc3JjUHRzPWNvb3Jkczt2YXIgbmV3UHRzPXRoaXMuc25hcExpbmUoc3JjUHRzLHRoaXMuc25hcFB0cyk7cmV0dXJuIG5ld1B0czt9O1NuYXBUcmFuc2Zvcm1lci5wcm90b3R5cGUuc25hcExpbmU9ZnVuY3Rpb24oc3JjUHRzLHNuYXBQdHMpe3ZhciBzbmFwcGVyPW5ldyBMaW5lU3RyaW5nU25hcHBlcihzcmNQdHMsdGhpcy5zbmFwVG9sZXJhbmNlKTtzbmFwcGVyLnNldEFsbG93U25hcHBpbmdUb1NvdXJjZVZlcnRpY2VzKHRoaXMuaXNTZWxmU25hcCk7cmV0dXJuIHNuYXBwZXIuc25hcFRvKHNuYXBQdHMpO307dmFyIEdlb21ldHJ5U25hcHBlcj1mdW5jdGlvbihzcmNHZW9tKXt0aGlzLnNyY0dlb209c3JjR2VvbTt9O0dlb21ldHJ5U25hcHBlci5TTkFQX1BSRUNJU0lPTl9GQUNUT1I9MWUtOTtHZW9tZXRyeVNuYXBwZXIuY29tcHV0ZU92ZXJsYXlTbmFwVG9sZXJhbmNlPWZ1bmN0aW9uKGcpe2lmKGFyZ3VtZW50cy5sZW5ndGg9PT0yKXtyZXR1cm4gR2VvbWV0cnlTbmFwcGVyLmNvbXB1dGVPdmVybGF5U25hcFRvbGVyYW5jZTIuYXBwbHkodGhpcyxhcmd1bWVudHMpO31cbnZhciBzbmFwVG9sZXJhbmNlPXRoaXMuY29tcHV0ZVNpemVCYXNlZFNuYXBUb2xlcmFuY2UoZyk7dmFyIHBtPWcuZ2V0UHJlY2lzaW9uTW9kZWwoKTtpZihwbS5nZXRUeXBlKCk9PVByZWNpc2lvbk1vZGVsLkZJWEVEKXt2YXIgZml4ZWRTbmFwVG9sPSgxL3BtLmdldFNjYWxlKCkpKjIvMS40MTU7aWYoZml4ZWRTbmFwVG9sPnNuYXBUb2xlcmFuY2UpXG5zbmFwVG9sZXJhbmNlPWZpeGVkU25hcFRvbDt9XG5yZXR1cm4gc25hcFRvbGVyYW5jZTt9O0dlb21ldHJ5U25hcHBlci5jb21wdXRlU2l6ZUJhc2VkU25hcFRvbGVyYW5jZT1mdW5jdGlvbihnKXt2YXIgZW52PWcuZ2V0RW52ZWxvcGVJbnRlcm5hbCgpO3ZhciBtaW5EaW1lbnNpb249TWF0aC5taW4oZW52LmdldEhlaWdodCgpLGVudi5nZXRXaWR0aCgpKTt2YXIgc25hcFRvbD1taW5EaW1lbnNpb24qR2VvbWV0cnlTbmFwcGVyLlNOQVBfUFJFQ0lTSU9OX0ZBQ1RPUjtyZXR1cm4gc25hcFRvbDt9O0dlb21ldHJ5U25hcHBlci5jb21wdXRlT3ZlcmxheVNuYXBUb2xlcmFuY2UyPWZ1bmN0aW9uKGcwLGcxKXtyZXR1cm4gTWF0aC5taW4odGhpcy5jb21wdXRlT3ZlcmxheVNuYXBUb2xlcmFuY2UoZzApLHRoaXMuY29tcHV0ZU92ZXJsYXlTbmFwVG9sZXJhbmNlKGcxKSk7fTtHZW9tZXRyeVNuYXBwZXIuc25hcD1mdW5jdGlvbihnMCxnMSxzbmFwVG9sZXJhbmNlKXt2YXIgc25hcEdlb209W107dmFyIHNuYXBwZXIwPW5ldyBHZW9tZXRyeVNuYXBwZXIoZzApO3NuYXBHZW9tWzBdPXNuYXBwZXIwLnNuYXBUbyhnMSxzbmFwVG9sZXJhbmNlKTt2YXIgc25hcHBlcjE9bmV3IEdlb21ldHJ5U25hcHBlcihnMSk7c25hcEdlb21bMV09c25hcHBlcjEuc25hcFRvKHNuYXBHZW9tWzBdLHNuYXBUb2xlcmFuY2UpO3JldHVybiBzbmFwR2VvbTt9O0dlb21ldHJ5U25hcHBlci5zbmFwVG9TZWxmPWZ1bmN0aW9uKGcwLHNuYXBUb2xlcmFuY2UsY2xlYW5SZXN1bHQpe3ZhciBzbmFwcGVyMD1uZXcgR2VvbWV0cnlTbmFwcGVyKGcwKTtyZXR1cm4gc25hcHBlcjAuc25hcFRvU2VsZihzbmFwVG9sZXJhbmNlLGNsZWFuUmVzdWx0KTt9O0dlb21ldHJ5U25hcHBlci5wcm90b3R5cGUuc3JjR2VvbT1udWxsO0dlb21ldHJ5U25hcHBlci5wcm90b3R5cGUuc25hcFRvPWZ1bmN0aW9uKHNuYXBHZW9tLHNuYXBUb2xlcmFuY2Upe3ZhciBzbmFwUHRzPXRoaXMuZXh0cmFjdFRhcmdldENvb3JkaW5hdGVzKHNuYXBHZW9tKTt2YXIgc25hcFRyYW5zPW5ldyBTbmFwVHJhbnNmb3JtZXIoc25hcFRvbGVyYW5jZSxzbmFwUHRzKTtyZXR1cm4gc25hcFRyYW5zLnRyYW5zZm9ybSh0aGlzLnNyY0dlb20pO307R2VvbWV0cnlTbmFwcGVyLnByb3RvdHlwZS5zbmFwVG9TZWxmPWZ1bmN0aW9uKHNuYXBUb2xlcmFuY2UsY2xlYW5SZXN1bHQpe3ZhciBzbmFwUHRzPXRoaXMuZXh0cmFjdFRhcmdldENvb3JkaW5hdGVzKHNyY0dlb20pO3ZhciBzbmFwVHJhbnM9bmV3IFNuYXBUcmFuc2Zvcm1lcihzbmFwVG9sZXJhbmNlLHNuYXBQdHMsdHJ1ZSk7dmFyIHNuYXBwZWRHZW9tPXNuYXBUcmFucy50cmFuc2Zvcm0oc3JjR2VvbSk7dmFyIHJlc3VsdD1zbmFwcGVkR2VvbTtpZihjbGVhblJlc3VsdCYmcmVzdWx0IGluc3RhbmNlb2YgUG9seWdvbmFsKXtyZXN1bHQ9c25hcHBlZEdlb20uYnVmZmVyKDApO31cbnJldHVybiByZXN1bHQ7fTtHZW9tZXRyeVNuYXBwZXIucHJvdG90eXBlLmV4dHJhY3RUYXJnZXRDb29yZGluYXRlcz1mdW5jdGlvbihnKXt2YXIgcHRTZXQ9bmV3IFRyZWVTZXQoKTt2YXIgcHRzPWcuZ2V0Q29vcmRpbmF0ZXMoKTtmb3IodmFyIGk9MDtpPHB0cy5sZW5ndGg7aSsrKXtwdFNldC5hZGQocHRzW2ldKTt9XG5yZXR1cm4gcHRTZXQudG9BcnJheSgpO307R2VvbWV0cnlTbmFwcGVyLnByb3RvdHlwZS5jb21wdXRlU25hcFRvbGVyYW5jZT1mdW5jdGlvbihyaW5nUHRzKXt2YXIgbWluU2VnTGVuPXRoaXMuY29tcHV0ZU1pbmltdW1TZWdtZW50TGVuZ3RoKHJpbmdQdHMpO3ZhciBzbmFwVG9sPW1pblNlZ0xlbi8xMDtyZXR1cm4gc25hcFRvbDt9O0dlb21ldHJ5U25hcHBlci5wcm90b3R5cGUuY29tcHV0ZU1pbmltdW1TZWdtZW50TGVuZ3RoPWZ1bmN0aW9uKHB0cyl7dmFyIG1pblNlZ0xlbj1OdW1iZXIuTUFYX1ZBTFVFO2Zvcih2YXIgaT0wO2k8cHRzLmxlbmd0aC0xO2krKyl7dmFyIHNlZ0xlbj1wdHNbaV0uZGlzdGFuY2UocHRzW2krMV0pO2lmKHNlZ0xlbjxtaW5TZWdMZW4pXG5taW5TZWdMZW49c2VnTGVuO31cbnJldHVybiBtaW5TZWdMZW47fTtqc3RzLm9wZXJhdGlvbi5vdmVybGF5LnNuYXAuR2VvbWV0cnlTbmFwcGVyPUdlb21ldHJ5U25hcHBlcjt9KSgpO2pzdHMuYWxnb3JpdGhtLlBvaW50TG9jYXRvcj1mdW5jdGlvbihib3VuZGFyeVJ1bGUpe3RoaXMuYm91bmRhcnlSdWxlPWJvdW5kYXJ5UnVsZT9ib3VuZGFyeVJ1bGU6anN0cy5hbGdvcml0aG0uQm91bmRhcnlOb2RlUnVsZS5PR0NfU0ZTX0JPVU5EQVJZX1JVTEU7fTtqc3RzLmFsZ29yaXRobS5Qb2ludExvY2F0b3IucHJvdG90eXBlLmJvdW5kYXJ5UnVsZT1udWxsO2pzdHMuYWxnb3JpdGhtLlBvaW50TG9jYXRvci5wcm90b3R5cGUuaXNJbj1udWxsO2pzdHMuYWxnb3JpdGhtLlBvaW50TG9jYXRvci5wcm90b3R5cGUubnVtQm91bmRhcmllcz1udWxsO2pzdHMuYWxnb3JpdGhtLlBvaW50TG9jYXRvci5wcm90b3R5cGUuaW50ZXJzZWN0cz1mdW5jdGlvbihwLGdlb20pe3JldHVybiB0aGlzLmxvY2F0ZShwLGdlb20pIT09anN0cy5nZW9tLkxvY2F0aW9uLkVYVEVSSU9SO307anN0cy5hbGdvcml0aG0uUG9pbnRMb2NhdG9yLnByb3RvdHlwZS5sb2NhdGU9ZnVuY3Rpb24ocCxnZW9tKXtpZihnZW9tLmlzRW1wdHkoKSlcbnJldHVybiBqc3RzLmdlb20uTG9jYXRpb24uRVhURVJJT1I7aWYoZ2VvbSBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5Qb2ludCl7cmV0dXJuIHRoaXMubG9jYXRlMihwLGdlb20pO31lbHNlIGlmKGdlb20gaW5zdGFuY2VvZiBqc3RzLmdlb20uTGluZVN0cmluZyl7cmV0dXJuIHRoaXMubG9jYXRlMyhwLGdlb20pO31lbHNlIGlmKGdlb20gaW5zdGFuY2VvZiBqc3RzLmdlb20uUG9seWdvbil7cmV0dXJuIHRoaXMubG9jYXRlNChwLGdlb20pO31cbnRoaXMuaXNJbj1mYWxzZTt0aGlzLm51bUJvdW5kYXJpZXM9MDt0aGlzLmNvbXB1dGVMb2NhdGlvbihwLGdlb20pO2lmKHRoaXMuYm91bmRhcnlSdWxlLmlzSW5Cb3VuZGFyeSh0aGlzLm51bUJvdW5kYXJpZXMpKVxucmV0dXJuIGpzdHMuZ2VvbS5Mb2NhdGlvbi5CT1VOREFSWTtpZih0aGlzLm51bUJvdW5kYXJpZXM+MHx8dGhpcy5pc0luKVxucmV0dXJuIGpzdHMuZ2VvbS5Mb2NhdGlvbi5JTlRFUklPUjtyZXR1cm4ganN0cy5nZW9tLkxvY2F0aW9uLkVYVEVSSU9SO307anN0cy5hbGdvcml0aG0uUG9pbnRMb2NhdG9yLnByb3RvdHlwZS5jb21wdXRlTG9jYXRpb249ZnVuY3Rpb24ocCxnZW9tKXtpZihnZW9tIGluc3RhbmNlb2YganN0cy5nZW9tLlBvaW50fHxnZW9tIGluc3RhbmNlb2YganN0cy5nZW9tLkxpbmVTdHJpbmd8fGdlb20gaW5zdGFuY2VvZiBqc3RzLmdlb20uUG9seWdvbil7dGhpcy51cGRhdGVMb2NhdGlvbkluZm8odGhpcy5sb2NhdGUocCxnZW9tKSk7fWVsc2UgaWYoZ2VvbSBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5NdWx0aUxpbmVTdHJpbmcpe3ZhciBtbD1nZW9tO2Zvcih2YXIgaT0wO2k8bWwuZ2V0TnVtR2VvbWV0cmllcygpO2krKyl7dmFyIGw9bWwuZ2V0R2VvbWV0cnlOKGkpO3RoaXMudXBkYXRlTG9jYXRpb25JbmZvKHRoaXMubG9jYXRlKHAsbCkpO319ZWxzZSBpZihnZW9tIGluc3RhbmNlb2YganN0cy5nZW9tLk11bHRpUG9seWdvbil7dmFyIG1wb2x5PWdlb207Zm9yKHZhciBpPTA7aTxtcG9seS5nZXROdW1HZW9tZXRyaWVzKCk7aSsrKXt2YXIgcG9seT1tcG9seS5nZXRHZW9tZXRyeU4oaSk7dGhpcy51cGRhdGVMb2NhdGlvbkluZm8odGhpcy5sb2NhdGUocCxwb2x5KSk7fX1lbHNlIGlmKGdlb20gaW5zdGFuY2VvZiBqc3RzLmdlb20uTXVsdGlQb2ludHx8Z2VvbSBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5HZW9tZXRyeUNvbGxlY3Rpb24pe2Zvcih2YXIgaT0wO2k8Z2VvbS5nZXROdW1HZW9tZXRyaWVzKCk7aSsrKXt2YXIgcGFydD1nZW9tLmdldEdlb21ldHJ5TihpKTtpZihwYXJ0IT09Z2VvbSl7dGhpcy5jb21wdXRlTG9jYXRpb24ocCxwYXJ0KTt9fX19O2pzdHMuYWxnb3JpdGhtLlBvaW50TG9jYXRvci5wcm90b3R5cGUudXBkYXRlTG9jYXRpb25JbmZvPWZ1bmN0aW9uKGxvYyl7aWYobG9jPT09anN0cy5nZW9tLkxvY2F0aW9uLklOVEVSSU9SKVxudGhpcy5pc0luPXRydWU7aWYobG9jPT09anN0cy5nZW9tLkxvY2F0aW9uLkJPVU5EQVJZKVxudGhpcy5udW1Cb3VuZGFyaWVzKys7fTtqc3RzLmFsZ29yaXRobS5Qb2ludExvY2F0b3IucHJvdG90eXBlLmxvY2F0ZTI9ZnVuY3Rpb24ocCxwdCl7dmFyIHB0Q29vcmQ9cHQuZ2V0Q29vcmRpbmF0ZSgpO2lmKHB0Q29vcmQuZXF1YWxzMkQocCkpXG5yZXR1cm4ganN0cy5nZW9tLkxvY2F0aW9uLklOVEVSSU9SO3JldHVybiBqc3RzLmdlb20uTG9jYXRpb24uRVhURVJJT1I7fTtqc3RzLmFsZ29yaXRobS5Qb2ludExvY2F0b3IucHJvdG90eXBlLmxvY2F0ZTM9ZnVuY3Rpb24ocCxsKXtpZighbC5nZXRFbnZlbG9wZUludGVybmFsKCkuaW50ZXJzZWN0cyhwKSlcbnJldHVybiBqc3RzLmdlb20uTG9jYXRpb24uRVhURVJJT1I7dmFyIHB0PWwuZ2V0Q29vcmRpbmF0ZXMoKTtpZighbC5pc0Nsb3NlZCgpKXtpZihwLmVxdWFscyhwdFswXSl8fHAuZXF1YWxzKHB0W3B0Lmxlbmd0aC0xXSkpe3JldHVybiBqc3RzLmdlb20uTG9jYXRpb24uQk9VTkRBUlk7fX1cbmlmKGpzdHMuYWxnb3JpdGhtLkNHQWxnb3JpdGhtcy5pc09uTGluZShwLHB0KSlcbnJldHVybiBqc3RzLmdlb20uTG9jYXRpb24uSU5URVJJT1I7cmV0dXJuIGpzdHMuZ2VvbS5Mb2NhdGlvbi5FWFRFUklPUjt9O2pzdHMuYWxnb3JpdGhtLlBvaW50TG9jYXRvci5wcm90b3R5cGUubG9jYXRlSW5Qb2x5Z29uUmluZz1mdW5jdGlvbihwLHJpbmcpe2lmKCFyaW5nLmdldEVudmVsb3BlSW50ZXJuYWwoKS5pbnRlcnNlY3RzKHApKVxucmV0dXJuIGpzdHMuZ2VvbS5Mb2NhdGlvbi5FWFRFUklPUjtyZXR1cm4ganN0cy5hbGdvcml0aG0uQ0dBbGdvcml0aG1zLmxvY2F0ZVBvaW50SW5SaW5nKHAscmluZy5nZXRDb29yZGluYXRlcygpKTt9O2pzdHMuYWxnb3JpdGhtLlBvaW50TG9jYXRvci5wcm90b3R5cGUubG9jYXRlND1mdW5jdGlvbihwLHBvbHkpe2lmKHBvbHkuaXNFbXB0eSgpKVxucmV0dXJuIGpzdHMuZ2VvbS5Mb2NhdGlvbi5FWFRFUklPUjt2YXIgc2hlbGw9cG9seS5nZXRFeHRlcmlvclJpbmcoKTt2YXIgc2hlbGxMb2M9dGhpcy5sb2NhdGVJblBvbHlnb25SaW5nKHAsc2hlbGwpO2lmKHNoZWxsTG9jPT09anN0cy5nZW9tLkxvY2F0aW9uLkVYVEVSSU9SKVxucmV0dXJuIGpzdHMuZ2VvbS5Mb2NhdGlvbi5FWFRFUklPUjtpZihzaGVsbExvYz09PWpzdHMuZ2VvbS5Mb2NhdGlvbi5CT1VOREFSWSlcbnJldHVybiBqc3RzLmdlb20uTG9jYXRpb24uQk9VTkRBUlk7Zm9yKHZhciBpPTA7aTxwb2x5LmdldE51bUludGVyaW9yUmluZygpO2krKyl7dmFyIGhvbGU9cG9seS5nZXRJbnRlcmlvclJpbmdOKGkpO3ZhciBob2xlTG9jPXRoaXMubG9jYXRlSW5Qb2x5Z29uUmluZyhwLGhvbGUpO2lmKGhvbGVMb2M9PT1qc3RzLmdlb20uTG9jYXRpb24uSU5URVJJT1IpXG5yZXR1cm4ganN0cy5nZW9tLkxvY2F0aW9uLkVYVEVSSU9SO2lmKGhvbGVMb2M9PT1qc3RzLmdlb20uTG9jYXRpb24uQk9VTkRBUlkpXG5yZXR1cm4ganN0cy5nZW9tLkxvY2F0aW9uLkJPVU5EQVJZO31cbnJldHVybiBqc3RzLmdlb20uTG9jYXRpb24uSU5URVJJT1I7fTsoZnVuY3Rpb24oKXt2YXIgTG9jYXRpb249anN0cy5nZW9tLkxvY2F0aW9uO3ZhciBBcnJheUxpc3Q9amF2YXNjcmlwdC51dGlsLkFycmF5TGlzdDt2YXIgVHJlZU1hcD1qYXZhc2NyaXB0LnV0aWwuVHJlZU1hcDtqc3RzLmdlb21ncmFwaC5Ob2RlTWFwPWZ1bmN0aW9uKG5vZGVGYWN0b3J5KXt0aGlzLm5vZGVNYXA9bmV3IFRyZWVNYXAoKTt0aGlzLm5vZGVGYWN0PW5vZGVGYWN0b3J5O307anN0cy5nZW9tZ3JhcGguTm9kZU1hcC5wcm90b3R5cGUubm9kZU1hcD1udWxsO2pzdHMuZ2VvbWdyYXBoLk5vZGVNYXAucHJvdG90eXBlLm5vZGVGYWN0PW51bGw7anN0cy5nZW9tZ3JhcGguTm9kZU1hcC5wcm90b3R5cGUuYWRkTm9kZT1mdW5jdGlvbihhcmcpe3ZhciBub2RlLGNvb3JkO2lmKGFyZyBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5Db29yZGluYXRlKXtjb29yZD1hcmc7bm9kZT10aGlzLm5vZGVNYXAuZ2V0KGNvb3JkKTtpZihub2RlPT09bnVsbCl7bm9kZT10aGlzLm5vZGVGYWN0LmNyZWF0ZU5vZGUoY29vcmQpO3RoaXMubm9kZU1hcC5wdXQoY29vcmQsbm9kZSk7fVxucmV0dXJuIG5vZGU7fWVsc2UgaWYoYXJnIGluc3RhbmNlb2YganN0cy5nZW9tZ3JhcGguTm9kZSl7dmFyIG49YXJnO2Nvb3JkPW4uZ2V0Q29vcmRpbmF0ZSgpO25vZGU9dGhpcy5ub2RlTWFwLmdldChjb29yZCk7aWYobm9kZT09PW51bGwpe3RoaXMubm9kZU1hcC5wdXQoY29vcmQsbik7cmV0dXJuIG47fVxubm9kZS5tZXJnZUxhYmVsKG4pO3JldHVybiBub2RlO319O2pzdHMuZ2VvbWdyYXBoLk5vZGVNYXAucHJvdG90eXBlLmFkZD1mdW5jdGlvbihlKXt2YXIgcD1lLmdldENvb3JkaW5hdGUoKTt2YXIgbj10aGlzLmFkZE5vZGUocCk7bi5hZGQoZSk7fTtqc3RzLmdlb21ncmFwaC5Ob2RlTWFwLnByb3RvdHlwZS5maW5kPWZ1bmN0aW9uKGNvb3JkKXtyZXR1cm4gdGhpcy5ub2RlTWFwLmdldChjb29yZCk7fTtqc3RzLmdlb21ncmFwaC5Ob2RlTWFwLnByb3RvdHlwZS52YWx1ZXM9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5ub2RlTWFwLnZhbHVlcygpO307anN0cy5nZW9tZ3JhcGguTm9kZU1hcC5wcm90b3R5cGUuaXRlcmF0b3I9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy52YWx1ZXMoKS5pdGVyYXRvcigpO307anN0cy5nZW9tZ3JhcGguTm9kZU1hcC5wcm90b3R5cGUuZ2V0Qm91bmRhcnlOb2Rlcz1mdW5jdGlvbihnZW9tSW5kZXgpe3ZhciBiZHlOb2Rlcz1uZXcgQXJyYXlMaXN0KCk7Zm9yKHZhciBpPXRoaXMuaXRlcmF0b3IoKTtpLmhhc05leHQoKTspe3ZhciBub2RlPWkubmV4dCgpO2lmKG5vZGUuZ2V0TGFiZWwoKS5nZXRMb2NhdGlvbihnZW9tSW5kZXgpPT09TG9jYXRpb24uQk9VTkRBUlkpe2JkeU5vZGVzLmFkZChub2RlKTt9fVxucmV0dXJuIGJkeU5vZGVzO307fSkoKTsoZnVuY3Rpb24oKXt2YXIgQXJyYXlMaXN0PWphdmFzY3JpcHQudXRpbC5BcnJheUxpc3Q7anN0cy5nZW9tZ3JhcGguUGxhbmFyR3JhcGg9ZnVuY3Rpb24obm9kZUZhY3Rvcnkpe3RoaXMuZWRnZXM9bmV3IEFycmF5TGlzdCgpO3RoaXMuZWRnZUVuZExpc3Q9bmV3IEFycmF5TGlzdCgpO3RoaXMubm9kZXM9bmV3IGpzdHMuZ2VvbWdyYXBoLk5vZGVNYXAobm9kZUZhY3Rvcnl8fG5ldyBqc3RzLmdlb21ncmFwaC5Ob2RlRmFjdG9yeSgpKTt9O2pzdHMuZ2VvbWdyYXBoLlBsYW5hckdyYXBoLnByb3RvdHlwZS5lZGdlcz1udWxsO2pzdHMuZ2VvbWdyYXBoLlBsYW5hckdyYXBoLnByb3RvdHlwZS5ub2Rlcz1udWxsO2pzdHMuZ2VvbWdyYXBoLlBsYW5hckdyYXBoLnByb3RvdHlwZS5lZGdlRW5kTGlzdD1udWxsO2pzdHMuZ2VvbWdyYXBoLlBsYW5hckdyYXBoLmxpbmtSZXN1bHREaXJlY3RlZEVkZ2VzPWZ1bmN0aW9uKG5vZGVzKXtmb3IodmFyIG5vZGVpdD1ub2Rlcy5pdGVyYXRvcigpO25vZGVpdC5oYXNOZXh0KCk7KXt2YXIgbm9kZT1ub2RlaXQubmV4dCgpO25vZGUuZ2V0RWRnZXMoKS5saW5rUmVzdWx0RGlyZWN0ZWRFZGdlcygpO319O2pzdHMuZ2VvbWdyYXBoLlBsYW5hckdyYXBoLnByb3RvdHlwZS5nZXRFZGdlSXRlcmF0b3I9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5lZGdlcy5pdGVyYXRvcigpO307anN0cy5nZW9tZ3JhcGguUGxhbmFyR3JhcGgucHJvdG90eXBlLmdldEVkZ2VFbmRzPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZWRnZUVuZExpc3Q7fTtqc3RzLmdlb21ncmFwaC5QbGFuYXJHcmFwaC5wcm90b3R5cGUuaXNCb3VuZGFyeU5vZGU9ZnVuY3Rpb24oZ2VvbUluZGV4LGNvb3JkKXt2YXIgbm9kZT10aGlzLm5vZGVzLmZpbmQoY29vcmQpO2lmKG5vZGU9PT1udWxsKVxucmV0dXJuIGZhbHNlO3ZhciBsYWJlbD1ub2RlLmdldExhYmVsKCk7aWYobGFiZWwhPT1udWxsJiZsYWJlbC5nZXRMb2NhdGlvbihnZW9tSW5kZXgpPT09anN0cy5nZW9tLkxvY2F0aW9uLkJPVU5EQVJZKVxucmV0dXJuIHRydWU7cmV0dXJuIGZhbHNlO307anN0cy5nZW9tZ3JhcGguUGxhbmFyR3JhcGgucHJvdG90eXBlLmluc2VydEVkZ2U9ZnVuY3Rpb24oZSl7dGhpcy5lZGdlcy5hZGQoZSk7fTtqc3RzLmdlb21ncmFwaC5QbGFuYXJHcmFwaC5wcm90b3R5cGUuYWRkPWZ1bmN0aW9uKGUpe3RoaXMubm9kZXMuYWRkKGUpO3RoaXMuZWRnZUVuZExpc3QuYWRkKGUpO307anN0cy5nZW9tZ3JhcGguUGxhbmFyR3JhcGgucHJvdG90eXBlLmdldE5vZGVJdGVyYXRvcj1mdW5jdGlvbigpe3JldHVybiB0aGlzLm5vZGVzLml0ZXJhdG9yKCk7fTtqc3RzLmdlb21ncmFwaC5QbGFuYXJHcmFwaC5wcm90b3R5cGUuZ2V0Tm9kZXM9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5ub2Rlcy52YWx1ZXMoKTt9O2pzdHMuZ2VvbWdyYXBoLlBsYW5hckdyYXBoLnByb3RvdHlwZS5hZGROb2RlPWZ1bmN0aW9uKG5vZGUpe3JldHVybiB0aGlzLm5vZGVzLmFkZE5vZGUobm9kZSk7fTtqc3RzLmdlb21ncmFwaC5QbGFuYXJHcmFwaC5wcm90b3R5cGUuYWRkRWRnZXM9ZnVuY3Rpb24oZWRnZXNUb0FkZCl7Zm9yKHZhciBpdD1lZGdlc1RvQWRkLml0ZXJhdG9yKCk7aXQuaGFzTmV4dCgpOyl7dmFyIGU9aXQubmV4dCgpO3RoaXMuZWRnZXMuYWRkKGUpO3ZhciBkZTE9bmV3IGpzdHMuZ2VvbWdyYXBoLkRpcmVjdGVkRWRnZShlLHRydWUpO3ZhciBkZTI9bmV3IGpzdHMuZ2VvbWdyYXBoLkRpcmVjdGVkRWRnZShlLGZhbHNlKTtkZTEuc2V0U3ltKGRlMik7ZGUyLnNldFN5bShkZTEpO3RoaXMuYWRkKGRlMSk7dGhpcy5hZGQoZGUyKTt9fTtqc3RzLmdlb21ncmFwaC5QbGFuYXJHcmFwaC5wcm90b3R5cGUubGlua1Jlc3VsdERpcmVjdGVkRWRnZXM9ZnVuY3Rpb24oKXtmb3IodmFyIG5vZGVpdD10aGlzLm5vZGVzLml0ZXJhdG9yKCk7bm9kZWl0Lmhhc05leHQoKTspe3ZhciBub2RlPW5vZGVpdC5uZXh0KCk7bm9kZS5nZXRFZGdlcygpLmxpbmtSZXN1bHREaXJlY3RlZEVkZ2VzKCk7fX07anN0cy5nZW9tZ3JhcGguUGxhbmFyR3JhcGgucHJvdG90eXBlLmZpbmRFZGdlSW5TYW1lRGlyZWN0aW9uPWZ1bmN0aW9uKHAwLHAxKXt2YXIgaT0wLGlsPXRoaXMuZWRnZXMuc2l6ZSgpLGUsZUNvb3JkO2ZvcihpO2k8aWw7aSsrKXtlPXRoaXMuZWRnZXMuZ2V0KGkpO2VDb29yZD1lLmdldENvb3JkaW5hdGVzKCk7aWYodGhpcy5tYXRjaEluU2FtZURpcmVjdGlvbihwMCxwMSxlQ29vcmRbMF0sZUNvb3JkWzFdKSl7cmV0dXJuIGU7fVxuaWYodGhpcy5tYXRjaEluU2FtZURpcmVjdGlvbihwMCxwMSxlQ29vcmRbZUNvb3JkLmxlbmd0aC0xXSxlQ29vcmRbZUNvb3JkLmxlbmd0aC0yXSkpe3JldHVybiBlO319XG5yZXR1cm4gbnVsbDt9O2pzdHMuZ2VvbWdyYXBoLlBsYW5hckdyYXBoLnByb3RvdHlwZS5tYXRjaEluU2FtZURpcmVjdGlvbj1mdW5jdGlvbihwMCxwMSxlcDAsZXAxKXtpZighcDAuZXF1YWxzKGVwMCkpe3JldHVybiBmYWxzZTt9XG5pZihqc3RzLmFsZ29yaXRobS5DR0FsZ29yaXRobXMuY29tcHV0ZU9yaWVudGF0aW9uKHAwLHAxLGVwMSk9PT1qc3RzLmFsZ29yaXRobS5DR0FsZ29yaXRobXMuQ09MTElORUFSJiZqc3RzLmdlb21ncmFwaC5RdWFkcmFudC5xdWFkcmFudChwMCxwMSk9PT1qc3RzLmdlb21ncmFwaC5RdWFkcmFudC5xdWFkcmFudChlcDAsZXAxKSl7cmV0dXJuIHRydWU7fVxucmV0dXJuIGZhbHNlO307anN0cy5nZW9tZ3JhcGguUGxhbmFyR3JhcGgucHJvdG90eXBlLmZpbmRFZGdlRW5kPWZ1bmN0aW9uKGUpe2Zvcih2YXIgaT10aGlzLmdldEVkZ2VFbmRzKCkuaXRlcmF0b3IoKTtpLmhhc05leHQoKTspe3ZhciBlZT1pLm5leHQoKTtpZihlZS5nZXRFZGdlKCk9PT1lKXtyZXR1cm4gZWU7fX1cbnJldHVybiBudWxsO307fSkoKTtqc3RzLm5vZGluZy5TZWdtZW50SW50ZXJzZWN0b3I9ZnVuY3Rpb24oKXt9O2pzdHMubm9kaW5nLlNlZ21lbnRJbnRlcnNlY3Rvci5wcm90b3R5cGUucHJvY2Vzc0ludGVyc2VjdGlvbnM9anN0cy5hYnN0cmFjdEZ1bmM7anN0cy5ub2RpbmcuU2VnbWVudEludGVyc2VjdG9yLnByb3RvdHlwZS5pc0RvbmU9anN0cy5hYnN0cmFjdEZ1bmM7KGZ1bmN0aW9uKCl7dmFyIFNlZ21lbnRJbnRlcnNlY3Rvcj1qc3RzLm5vZGluZy5TZWdtZW50SW50ZXJzZWN0b3I7dmFyIEFycmF5TGlzdD1qYXZhc2NyaXB0LnV0aWwuQXJyYXlMaXN0O2pzdHMubm9kaW5nLkludGVyaW9ySW50ZXJzZWN0aW9uRmluZGVyPWZ1bmN0aW9uKGxpKXt0aGlzLmxpPWxpO3RoaXMuaW50ZXJzZWN0aW9ucz1uZXcgQXJyYXlMaXN0KCk7dGhpcy5pbnRlcmlvckludGVyc2VjdGlvbj1udWxsO307anN0cy5ub2RpbmcuSW50ZXJpb3JJbnRlcnNlY3Rpb25GaW5kZXIucHJvdG90eXBlPW5ldyBTZWdtZW50SW50ZXJzZWN0b3IoKTtqc3RzLm5vZGluZy5JbnRlcmlvckludGVyc2VjdGlvbkZpbmRlci5jb25zdHJ1Y3Rvcj1qc3RzLm5vZGluZy5JbnRlcmlvckludGVyc2VjdGlvbkZpbmRlcjtqc3RzLm5vZGluZy5JbnRlcmlvckludGVyc2VjdGlvbkZpbmRlci5wcm90b3R5cGUuZmluZEFsbEludGVyc2VjdGlvbnM9ZmFsc2U7anN0cy5ub2RpbmcuSW50ZXJpb3JJbnRlcnNlY3Rpb25GaW5kZXIucHJvdG90eXBlLmlzQ2hlY2tFbmRTZWdtZW50c09ubHk9ZmFsc2U7anN0cy5ub2RpbmcuSW50ZXJpb3JJbnRlcnNlY3Rpb25GaW5kZXIucHJvdG90eXBlLmxpPW51bGw7anN0cy5ub2RpbmcuSW50ZXJpb3JJbnRlcnNlY3Rpb25GaW5kZXIucHJvdG90eXBlLmludGVyaW9ySW50ZXJzZWN0aW9uPW51bGw7anN0cy5ub2RpbmcuSW50ZXJpb3JJbnRlcnNlY3Rpb25GaW5kZXIucHJvdG90eXBlLmludFNlZ21lbnRzPW51bGw7anN0cy5ub2RpbmcuSW50ZXJpb3JJbnRlcnNlY3Rpb25GaW5kZXIucHJvdG90eXBlLmludGVyc2VjdGlvbnM9bnVsbDtqc3RzLm5vZGluZy5JbnRlcmlvckludGVyc2VjdGlvbkZpbmRlci5wcm90b3R5cGUuc2V0RmluZEFsbEludGVyc2VjdGlvbnM9ZnVuY3Rpb24oZmluZEFsbEludGVyc2VjdGlvbnMpe3RoaXMuZmluZEFsbEludGVyc2VjdGlvbnM9ZmluZEFsbEludGVyc2VjdGlvbnM7fTtqc3RzLm5vZGluZy5JbnRlcmlvckludGVyc2VjdGlvbkZpbmRlci5wcm90b3R5cGUuZ2V0SW50ZXJzZWN0aW9ucz1mdW5jdGlvbigpe3JldHVybiBpbnRlcnNlY3Rpb25zO307anN0cy5ub2RpbmcuSW50ZXJpb3JJbnRlcnNlY3Rpb25GaW5kZXIucHJvdG90eXBlLnNldENoZWNrRW5kU2VnbWVudHNPbmx5PWZ1bmN0aW9uKGlzQ2hlY2tFbmRTZWdtZW50c09ubHkpe3RoaXMuaXNDaGVja0VuZFNlZ21lbnRzT25seT1pc0NoZWNrRW5kU2VnbWVudHNPbmx5O31cbmpzdHMubm9kaW5nLkludGVyaW9ySW50ZXJzZWN0aW9uRmluZGVyLnByb3RvdHlwZS5oYXNJbnRlcnNlY3Rpb249ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5pbnRlcmlvckludGVyc2VjdGlvbiE9bnVsbDt9O2pzdHMubm9kaW5nLkludGVyaW9ySW50ZXJzZWN0aW9uRmluZGVyLnByb3RvdHlwZS5nZXRJbnRlcmlvckludGVyc2VjdGlvbj1mdW5jdGlvbigpe3JldHVybiB0aGlzLmludGVyaW9ySW50ZXJzZWN0aW9uO307anN0cy5ub2RpbmcuSW50ZXJpb3JJbnRlcnNlY3Rpb25GaW5kZXIucHJvdG90eXBlLmdldEludGVyc2VjdGlvblNlZ21lbnRzPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuaW50U2VnbWVudHM7fTtqc3RzLm5vZGluZy5JbnRlcmlvckludGVyc2VjdGlvbkZpbmRlci5wcm90b3R5cGUucHJvY2Vzc0ludGVyc2VjdGlvbnM9ZnVuY3Rpb24oZTAsc2VnSW5kZXgwLGUxLHNlZ0luZGV4MSl7aWYodGhpcy5oYXNJbnRlcnNlY3Rpb24oKSlcbnJldHVybjtpZihlMD09ZTEmJnNlZ0luZGV4MD09c2VnSW5kZXgxKVxucmV0dXJuO2lmKHRoaXMuaXNDaGVja0VuZFNlZ21lbnRzT25seSl7dmFyIGlzRW5kU2VnUHJlc2VudD10aGlzLmlzRW5kU2VnbWVudChlMCxzZWdJbmRleDApfHxpc0VuZFNlZ21lbnQoZTEsc2VnSW5kZXgxKTtpZighaXNFbmRTZWdQcmVzZW50KVxucmV0dXJuO31cbnZhciBwMDA9ZTAuZ2V0Q29vcmRpbmF0ZXMoKVtzZWdJbmRleDBdO3ZhciBwMDE9ZTAuZ2V0Q29vcmRpbmF0ZXMoKVtzZWdJbmRleDArMV07dmFyIHAxMD1lMS5nZXRDb29yZGluYXRlcygpW3NlZ0luZGV4MV07dmFyIHAxMT1lMS5nZXRDb29yZGluYXRlcygpW3NlZ0luZGV4MSsxXTt0aGlzLmxpLmNvbXB1dGVJbnRlcnNlY3Rpb24ocDAwLHAwMSxwMTAscDExKTtpZih0aGlzLmxpLmhhc0ludGVyc2VjdGlvbigpKXtpZih0aGlzLmxpLmlzSW50ZXJpb3JJbnRlcnNlY3Rpb24oKSl7dGhpcy5pbnRTZWdtZW50cz1bXTt0aGlzLmludFNlZ21lbnRzWzBdPXAwMDt0aGlzLmludFNlZ21lbnRzWzFdPXAwMTt0aGlzLmludFNlZ21lbnRzWzJdPXAxMDt0aGlzLmludFNlZ21lbnRzWzNdPXAxMTt0aGlzLmludGVyaW9ySW50ZXJzZWN0aW9uPXRoaXMubGkuZ2V0SW50ZXJzZWN0aW9uKDApO3RoaXMuaW50ZXJzZWN0aW9ucy5hZGQodGhpcy5pbnRlcmlvckludGVyc2VjdGlvbik7fX19O2pzdHMubm9kaW5nLkludGVyaW9ySW50ZXJzZWN0aW9uRmluZGVyLnByb3RvdHlwZS5pc0VuZFNlZ21lbnQ9ZnVuY3Rpb24oc2VnU3RyLGluZGV4KXtpZihpbmRleD09MClcbnJldHVybiB0cnVlO2lmKGluZGV4Pj1zZWdTdHIuc2l6ZSgpLTIpXG5yZXR1cm4gdHJ1ZTtyZXR1cm4gZmFsc2U7fTtqc3RzLm5vZGluZy5JbnRlcmlvckludGVyc2VjdGlvbkZpbmRlci5wcm90b3R5cGUuaXNEb25lPWZ1bmN0aW9uKCl7aWYodGhpcy5maW5kQWxsSW50ZXJzZWN0aW9ucylcbnJldHVybiBmYWxzZTtyZXR1cm4gdGhpcy5pbnRlcmlvckludGVyc2VjdGlvbiE9bnVsbDt9O30pKCk7KGZ1bmN0aW9uKCl7dmFyIFJvYnVzdExpbmVJbnRlcnNlY3Rvcj1qc3RzLmFsZ29yaXRobS5Sb2J1c3RMaW5lSW50ZXJzZWN0b3I7dmFyIEludGVyaW9ySW50ZXJzZWN0aW9uRmluZGVyPWpzdHMubm9kaW5nLkludGVyaW9ySW50ZXJzZWN0aW9uRmluZGVyO3ZhciBNQ0luZGV4Tm9kZXI9anN0cy5ub2RpbmcuTUNJbmRleE5vZGVyO2pzdHMubm9kaW5nLkZhc3ROb2RpbmdWYWxpZGF0b3I9ZnVuY3Rpb24oc2VnU3RyaW5ncyl7dGhpcy5saT1uZXcgUm9idXN0TGluZUludGVyc2VjdG9yKCk7dGhpcy5zZWdTdHJpbmdzPXNlZ1N0cmluZ3M7fTtqc3RzLm5vZGluZy5GYXN0Tm9kaW5nVmFsaWRhdG9yLnByb3RvdHlwZS5saT1udWxsO2pzdHMubm9kaW5nLkZhc3ROb2RpbmdWYWxpZGF0b3IucHJvdG90eXBlLnNlZ1N0cmluZ3M9bnVsbDtqc3RzLm5vZGluZy5GYXN0Tm9kaW5nVmFsaWRhdG9yLnByb3RvdHlwZS5maW5kQWxsSW50ZXJzZWN0aW9ucz1mYWxzZTtqc3RzLm5vZGluZy5GYXN0Tm9kaW5nVmFsaWRhdG9yLnByb3RvdHlwZS5zZWdJbnQ9bnVsbDtqc3RzLm5vZGluZy5GYXN0Tm9kaW5nVmFsaWRhdG9yLnByb3RvdHlwZS5faXNWYWxpZD10cnVlO2pzdHMubm9kaW5nLkZhc3ROb2RpbmdWYWxpZGF0b3IucHJvdG90eXBlLnNldEZpbmRBbGxJbnRlcnNlY3Rpb25zPWZ1bmN0aW9uKGZpbmRBbGxJbnRlcnNlY3Rpb25zKXt0aGlzLmZpbmRBbGxJbnRlcnNlY3Rpb25zPWZpbmRBbGxJbnRlcnNlY3Rpb25zO307anN0cy5ub2RpbmcuRmFzdE5vZGluZ1ZhbGlkYXRvci5wcm90b3R5cGUuZ2V0SW50ZXJzZWN0aW9ucz1mdW5jdGlvbigpe3JldHVybiBzZWdJbnQuZ2V0SW50ZXJzZWN0aW9ucygpO307anN0cy5ub2RpbmcuRmFzdE5vZGluZ1ZhbGlkYXRvci5wcm90b3R5cGUuaXNWYWxpZD1mdW5jdGlvbigpe3RoaXMuZXhlY3V0ZSgpO3JldHVybiB0aGlzLl9pc1ZhbGlkO307anN0cy5ub2RpbmcuRmFzdE5vZGluZ1ZhbGlkYXRvci5wcm90b3R5cGUuZ2V0RXJyb3JNZXNzYWdlPWZ1bmN0aW9uKCl7aWYodGhpcy5faXNWYWxpZClcbnJldHVybidubyBpbnRlcnNlY3Rpb25zIGZvdW5kJzt2YXIgaW50U2Vncz10aGlzLnNlZ0ludC5nZXRJbnRlcnNlY3Rpb25TZWdtZW50cygpO3JldHVybidmb3VuZCBub24tbm9kZWQgaW50ZXJzZWN0aW9uIGJldHdlZW4gJytcbmpzdHMuaW8uV0tUV3JpdGVyLnRvTGluZVN0cmluZyhpbnRTZWdzWzBdLGludFNlZ3NbMV0pKycgYW5kICcrXG5qc3RzLmlvLldLVFdyaXRlci50b0xpbmVTdHJpbmcoaW50U2Vnc1syXSxpbnRTZWdzWzNdKTt9O2pzdHMubm9kaW5nLkZhc3ROb2RpbmdWYWxpZGF0b3IucHJvdG90eXBlLmNoZWNrVmFsaWQ9ZnVuY3Rpb24oKXt0aGlzLmV4ZWN1dGUoKTtpZighdGhpcy5faXNWYWxpZClcbnRocm93IG5ldyBqc3RzLmVycm9yLlRvcG9sb2d5RXJyb3IodGhpcy5nZXRFcnJvck1lc3NhZ2UoKSx0aGlzLnNlZ0ludC5nZXRJbnRlcmlvckludGVyc2VjdGlvbigpKTt9O2pzdHMubm9kaW5nLkZhc3ROb2RpbmdWYWxpZGF0b3IucHJvdG90eXBlLmV4ZWN1dGU9ZnVuY3Rpb24oKXtpZih0aGlzLnNlZ0ludCE9bnVsbClcbnJldHVybjt0aGlzLmNoZWNrSW50ZXJpb3JJbnRlcnNlY3Rpb25zKCk7fTtqc3RzLm5vZGluZy5GYXN0Tm9kaW5nVmFsaWRhdG9yLnByb3RvdHlwZS5jaGVja0ludGVyaW9ySW50ZXJzZWN0aW9ucz1mdW5jdGlvbigpe3RoaXMuX2lzVmFsaWQ9dHJ1ZTt0aGlzLnNlZ0ludD1uZXcgSW50ZXJpb3JJbnRlcnNlY3Rpb25GaW5kZXIodGhpcy5saSk7dGhpcy5zZWdJbnQuc2V0RmluZEFsbEludGVyc2VjdGlvbnModGhpcy5maW5kQWxsSW50ZXJzZWN0aW9ucyk7dmFyIG5vZGVyPW5ldyBNQ0luZGV4Tm9kZXIoKTtub2Rlci5zZXRTZWdtZW50SW50ZXJzZWN0b3IodGhpcy5zZWdJbnQpO25vZGVyLmNvbXB1dGVOb2Rlcyh0aGlzLnNlZ1N0cmluZ3MpO2lmKHRoaXMuc2VnSW50Lmhhc0ludGVyc2VjdGlvbigpKXt0aGlzLl9pc1ZhbGlkPWZhbHNlO3JldHVybjt9fTt9KSgpOyhmdW5jdGlvbigpe2pzdHMubm9kaW5nLkJhc2ljU2VnbWVudFN0cmluZz1mdW5jdGlvbihwdHMsZGF0YSl7dGhpcy5wdHM9cHRzO3RoaXMuZGF0YT1kYXRhO307anN0cy5ub2RpbmcuQmFzaWNTZWdtZW50U3RyaW5nLnByb3RvdHlwZT1uZXcganN0cy5ub2RpbmcuU2VnbWVudFN0cmluZygpO2pzdHMubm9kaW5nLkJhc2ljU2VnbWVudFN0cmluZy5wcm90b3R5cGUucHRzPW51bGw7anN0cy5ub2RpbmcuQmFzaWNTZWdtZW50U3RyaW5nLnByb3RvdHlwZS5kYXRhPW51bGw7anN0cy5ub2RpbmcuQmFzaWNTZWdtZW50U3RyaW5nLnByb3RvdHlwZS5nZXREYXRhPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZGF0YTt9XG5qc3RzLm5vZGluZy5CYXNpY1NlZ21lbnRTdHJpbmcucHJvdG90eXBlLnNldERhdGE9ZnVuY3Rpb24oZGF0YSl7dGhpcy5kYXRhPWRhdGE7fTtqc3RzLm5vZGluZy5CYXNpY1NlZ21lbnRTdHJpbmcucHJvdG90eXBlLnNpemU9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5wdHMubGVuZ3RoO307anN0cy5ub2RpbmcuQmFzaWNTZWdtZW50U3RyaW5nLnByb3RvdHlwZS5nZXRDb29yZGluYXRlPWZ1bmN0aW9uKGkpe3JldHVybiB0aGlzLnB0c1tpXTt9O2pzdHMubm9kaW5nLkJhc2ljU2VnbWVudFN0cmluZy5wcm90b3R5cGUuZ2V0Q29vcmRpbmF0ZXM9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5wdHM7fTtqc3RzLm5vZGluZy5CYXNpY1NlZ21lbnRTdHJpbmcucHJvdG90eXBlLmlzQ2xvc2VkPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMucHRzWzBdLmVxdWFscyh0aGlzLnB0c1t0aGlzLnB0cy5sZW5ndGgtMV0pO307anN0cy5ub2RpbmcuQmFzaWNTZWdtZW50U3RyaW5nLnByb3RvdHlwZS5nZXRTZWdtZW50T2N0YW50PWZ1bmN0aW9uKGluZGV4KXtpZihpbmRleD09dGhpcy5wdHMubGVuZ3RoLTEpXG5yZXR1cm4tMTtyZXR1cm4ganN0cy5ub2RpbmcuT2N0YW50Lm9jdGFudCh0aGlzLmdldENvb3JkaW5hdGUoaW5kZXgpLHRoaXMuZ2V0Q29vcmRpbmF0ZShpbmRleCsxKSk7fTt9KSgpOyhmdW5jdGlvbigpe3ZhciBGYXN0Tm9kaW5nVmFsaWRhdG9yPWpzdHMubm9kaW5nLkZhc3ROb2RpbmdWYWxpZGF0b3I7dmFyIEJhc2ljU2VnbWVudFN0cmluZz1qc3RzLm5vZGluZy5CYXNpY1NlZ21lbnRTdHJpbmc7dmFyIEFycmF5TGlzdD1qYXZhc2NyaXB0LnV0aWwuQXJyYXlMaXN0O2pzdHMuZ2VvbWdyYXBoLkVkZ2VOb2RpbmdWYWxpZGF0b3I9ZnVuY3Rpb24oZWRnZXMpe3RoaXMubnY9bmV3IEZhc3ROb2RpbmdWYWxpZGF0b3IoanN0cy5nZW9tZ3JhcGguRWRnZU5vZGluZ1ZhbGlkYXRvci50b1NlZ21lbnRTdHJpbmdzKGVkZ2VzKSk7fTtqc3RzLmdlb21ncmFwaC5FZGdlTm9kaW5nVmFsaWRhdG9yLmNoZWNrVmFsaWQ9ZnVuY3Rpb24oZWRnZXMpe3ZhciB2YWxpZGF0b3I9bmV3IGpzdHMuZ2VvbWdyYXBoLkVkZ2VOb2RpbmdWYWxpZGF0b3IoZWRnZXMpO3ZhbGlkYXRvci5jaGVja1ZhbGlkKCk7fTtqc3RzLmdlb21ncmFwaC5FZGdlTm9kaW5nVmFsaWRhdG9yLnRvU2VnbWVudFN0cmluZ3M9ZnVuY3Rpb24oZWRnZXMpe3ZhciBzZWdTdHJpbmdzPW5ldyBBcnJheUxpc3QoKTtmb3IodmFyIGk9ZWRnZXMuaXRlcmF0b3IoKTtpLmhhc05leHQoKTspe3ZhciBlPWkubmV4dCgpO3NlZ1N0cmluZ3MuYWRkKG5ldyBCYXNpY1NlZ21lbnRTdHJpbmcoZS5nZXRDb29yZGluYXRlcygpLGUpKTt9XG5yZXR1cm4gc2VnU3RyaW5nczt9O2pzdHMuZ2VvbWdyYXBoLkVkZ2VOb2RpbmdWYWxpZGF0b3IucHJvdG90eXBlLm52PW51bGw7anN0cy5nZW9tZ3JhcGguRWRnZU5vZGluZ1ZhbGlkYXRvci5wcm90b3R5cGUuY2hlY2tWYWxpZD1mdW5jdGlvbigpe3RoaXMubnYuY2hlY2tWYWxpZCgpO307fSkoKTtqc3RzLm9wZXJhdGlvbi5HZW9tZXRyeUdyYXBoT3BlcmF0aW9uPWZ1bmN0aW9uKGcwLGcxLGJvdW5kYXJ5Tm9kZVJ1bGUpe3RoaXMubGk9bmV3IGpzdHMuYWxnb3JpdGhtLlJvYnVzdExpbmVJbnRlcnNlY3RvcigpO3RoaXMuYXJnPVtdO2lmKGcwPT09dW5kZWZpbmVkKXtyZXR1cm47fVxuaWYoZzE9PT11bmRlZmluZWQpe3RoaXMuc2V0Q29tcHV0YXRpb25QcmVjaXNpb24oZzAuZ2V0UHJlY2lzaW9uTW9kZWwoKSk7dGhpcy5hcmdbMF09bmV3IGpzdHMuZ2VvbWdyYXBoLkdlb21ldHJ5R3JhcGgoMCxnMCk7cmV0dXJuO31cbmJvdW5kYXJ5Tm9kZVJ1bGU9Ym91bmRhcnlOb2RlUnVsZXx8anN0cy5hbGdvcml0aG0uQm91bmRhcnlOb2RlUnVsZS5PR0NfU0ZTX0JPVU5EQVJZX1JVTEU7aWYoZzAuZ2V0UHJlY2lzaW9uTW9kZWwoKS5jb21wYXJlVG8oZzEuZ2V0UHJlY2lzaW9uTW9kZWwoKSk+PTApXG50aGlzLnNldENvbXB1dGF0aW9uUHJlY2lzaW9uKGcwLmdldFByZWNpc2lvbk1vZGVsKCkpO2Vsc2VcbnRoaXMuc2V0Q29tcHV0YXRpb25QcmVjaXNpb24oZzEuZ2V0UHJlY2lzaW9uTW9kZWwoKSk7dGhpcy5hcmdbMF09bmV3IGpzdHMuZ2VvbWdyYXBoLkdlb21ldHJ5R3JhcGgoMCxnMCxib3VuZGFyeU5vZGVSdWxlKTt0aGlzLmFyZ1sxXT1uZXcganN0cy5nZW9tZ3JhcGguR2VvbWV0cnlHcmFwaCgxLGcxLGJvdW5kYXJ5Tm9kZVJ1bGUpO307anN0cy5vcGVyYXRpb24uR2VvbWV0cnlHcmFwaE9wZXJhdGlvbi5wcm90b3R5cGUubGk9bnVsbDtqc3RzLm9wZXJhdGlvbi5HZW9tZXRyeUdyYXBoT3BlcmF0aW9uLnByb3RvdHlwZS5yZXN1bHRQcmVjaXNpb25Nb2RlbD1udWxsO2pzdHMub3BlcmF0aW9uLkdlb21ldHJ5R3JhcGhPcGVyYXRpb24ucHJvdG90eXBlLmFyZz1udWxsO2pzdHMub3BlcmF0aW9uLkdlb21ldHJ5R3JhcGhPcGVyYXRpb24ucHJvdG90eXBlLmdldEFyZ0dlb21ldHJ5PWZ1bmN0aW9uKGkpe3JldHVybiBhcmdbaV0uZ2V0R2VvbWV0cnkoKTt9O2pzdHMub3BlcmF0aW9uLkdlb21ldHJ5R3JhcGhPcGVyYXRpb24ucHJvdG90eXBlLnNldENvbXB1dGF0aW9uUHJlY2lzaW9uPWZ1bmN0aW9uKHBtKXt0aGlzLnJlc3VsdFByZWNpc2lvbk1vZGVsPXBtO3RoaXMubGkuc2V0UHJlY2lzaW9uTW9kZWwodGhpcy5yZXN1bHRQcmVjaXNpb25Nb2RlbCk7fTtqc3RzLm9wZXJhdGlvbi5vdmVybGF5Lk92ZXJsYXlOb2RlRmFjdG9yeT1mdW5jdGlvbigpe307anN0cy5vcGVyYXRpb24ub3ZlcmxheS5PdmVybGF5Tm9kZUZhY3RvcnkucHJvdG90eXBlPW5ldyBqc3RzLmdlb21ncmFwaC5Ob2RlRmFjdG9yeSgpO2pzdHMub3BlcmF0aW9uLm92ZXJsYXkuT3ZlcmxheU5vZGVGYWN0b3J5LmNvbnN0cnVjdG9yPWpzdHMub3BlcmF0aW9uLm92ZXJsYXkuT3ZlcmxheU5vZGVGYWN0b3J5O2pzdHMub3BlcmF0aW9uLm92ZXJsYXkuT3ZlcmxheU5vZGVGYWN0b3J5LnByb3RvdHlwZS5jcmVhdGVOb2RlPWZ1bmN0aW9uKGNvb3JkKXtyZXR1cm4gbmV3IGpzdHMuZ2VvbWdyYXBoLk5vZGUoY29vcmQsbmV3IGpzdHMuZ2VvbWdyYXBoLkRpcmVjdGVkRWRnZVN0YXIoKSk7fTtqc3RzLm9wZXJhdGlvbi5vdmVybGF5LlBvbHlnb25CdWlsZGVyPWZ1bmN0aW9uKGdlb21ldHJ5RmFjdG9yeSl7dGhpcy5zaGVsbExpc3Q9W107dGhpcy5nZW9tZXRyeUZhY3Rvcnk9Z2VvbWV0cnlGYWN0b3J5O307anN0cy5vcGVyYXRpb24ub3ZlcmxheS5Qb2x5Z29uQnVpbGRlci5wcm90b3R5cGUuZ2VvbWV0cnlGYWN0b3J5PW51bGw7anN0cy5vcGVyYXRpb24ub3ZlcmxheS5Qb2x5Z29uQnVpbGRlci5wcm90b3R5cGUuc2hlbGxMaXN0PW51bGw7anN0cy5vcGVyYXRpb24ub3ZlcmxheS5Qb2x5Z29uQnVpbGRlci5wcm90b3R5cGUuYWRkPWZ1bmN0aW9uKGdyYXBoKXtpZihhcmd1bWVudHMubGVuZ3RoPT09Mil7dGhpcy5hZGQyLmFwcGx5KHRoaXMsYXJndW1lbnRzKTtyZXR1cm47fVxudGhpcy5hZGQyKGdyYXBoLmdldEVkZ2VFbmRzKCksZ3JhcGguZ2V0Tm9kZXMoKSk7fTtqc3RzLm9wZXJhdGlvbi5vdmVybGF5LlBvbHlnb25CdWlsZGVyLnByb3RvdHlwZS5hZGQyPWZ1bmN0aW9uKGRpckVkZ2VzLG5vZGVzKXtqc3RzLmdlb21ncmFwaC5QbGFuYXJHcmFwaC5saW5rUmVzdWx0RGlyZWN0ZWRFZGdlcyhub2Rlcyk7dmFyIG1heEVkZ2VSaW5ncz10aGlzLmJ1aWxkTWF4aW1hbEVkZ2VSaW5ncyhkaXJFZGdlcyk7dmFyIGZyZWVIb2xlTGlzdD1bXTt2YXIgZWRnZVJpbmdzPXRoaXMuYnVpbGRNaW5pbWFsRWRnZVJpbmdzKG1heEVkZ2VSaW5ncyx0aGlzLnNoZWxsTGlzdCxmcmVlSG9sZUxpc3QpO3RoaXMuc29ydFNoZWxsc0FuZEhvbGVzKGVkZ2VSaW5ncyx0aGlzLnNoZWxsTGlzdCxmcmVlSG9sZUxpc3QpO3RoaXMucGxhY2VGcmVlSG9sZXModGhpcy5zaGVsbExpc3QsZnJlZUhvbGVMaXN0KTt9O2pzdHMub3BlcmF0aW9uLm92ZXJsYXkuUG9seWdvbkJ1aWxkZXIucHJvdG90eXBlLmdldFBvbHlnb25zPWZ1bmN0aW9uKCl7dmFyIHJlc3VsdFBvbHlMaXN0PXRoaXMuY29tcHV0ZVBvbHlnb25zKHRoaXMuc2hlbGxMaXN0KTtyZXR1cm4gcmVzdWx0UG9seUxpc3Q7fTtqc3RzLm9wZXJhdGlvbi5vdmVybGF5LlBvbHlnb25CdWlsZGVyLnByb3RvdHlwZS5idWlsZE1heGltYWxFZGdlUmluZ3M9ZnVuY3Rpb24oZGlyRWRnZXMpe3ZhciBtYXhFZGdlUmluZ3M9W107Zm9yKHZhciBpdD1kaXJFZGdlcy5pdGVyYXRvcigpO2l0Lmhhc05leHQoKTspe3ZhciBkZT1pdC5uZXh0KCk7aWYoZGUuaXNJblJlc3VsdCgpJiZkZS5nZXRMYWJlbCgpLmlzQXJlYSgpKXtpZihkZS5nZXRFZGdlUmluZygpPT1udWxsKXt2YXIgZXI9bmV3IGpzdHMub3BlcmF0aW9uLm92ZXJsYXkuTWF4aW1hbEVkZ2VSaW5nKGRlLHRoaXMuZ2VvbWV0cnlGYWN0b3J5KTttYXhFZGdlUmluZ3MucHVzaChlcik7ZXIuc2V0SW5SZXN1bHQoKTt9fX1cbnJldHVybiBtYXhFZGdlUmluZ3M7fTtqc3RzLm9wZXJhdGlvbi5vdmVybGF5LlBvbHlnb25CdWlsZGVyLnByb3RvdHlwZS5idWlsZE1pbmltYWxFZGdlUmluZ3M9ZnVuY3Rpb24obWF4RWRnZVJpbmdzLHNoZWxsTGlzdCxmcmVlSG9sZUxpc3Qpe3ZhciBlZGdlUmluZ3M9W107Zm9yKHZhciBpPTA7aTxtYXhFZGdlUmluZ3MubGVuZ3RoO2krKyl7dmFyIGVyPW1heEVkZ2VSaW5nc1tpXTtpZihlci5nZXRNYXhOb2RlRGVncmVlKCk+Mil7ZXIubGlua0RpcmVjdGVkRWRnZXNGb3JNaW5pbWFsRWRnZVJpbmdzKCk7dmFyIG1pbkVkZ2VSaW5ncz1lci5idWlsZE1pbmltYWxSaW5ncygpO3ZhciBzaGVsbD10aGlzLmZpbmRTaGVsbChtaW5FZGdlUmluZ3MpO2lmKHNoZWxsIT09bnVsbCl7dGhpcy5wbGFjZVBvbHlnb25Ib2xlcyhzaGVsbCxtaW5FZGdlUmluZ3MpO3NoZWxsTGlzdC5wdXNoKHNoZWxsKTt9ZWxzZXtmcmVlSG9sZUxpc3Q9ZnJlZUhvbGVMaXN0LmNvbmNhdChtaW5FZGdlUmluZ3MpO319ZWxzZXtlZGdlUmluZ3MucHVzaChlcik7fX1cbnJldHVybiBlZGdlUmluZ3M7fTtqc3RzLm9wZXJhdGlvbi5vdmVybGF5LlBvbHlnb25CdWlsZGVyLnByb3RvdHlwZS5maW5kU2hlbGw9ZnVuY3Rpb24obWluRWRnZVJpbmdzKXt2YXIgc2hlbGxDb3VudD0wO3ZhciBzaGVsbD1udWxsO2Zvcih2YXIgaT0wO2k8bWluRWRnZVJpbmdzLmxlbmd0aDtpKyspe3ZhciBlcj1taW5FZGdlUmluZ3NbaV07aWYoIWVyLmlzSG9sZSgpKXtzaGVsbD1lcjtzaGVsbENvdW50Kys7fX1cbmpzdHMudXRpbC5Bc3NlcnQuaXNUcnVlKHNoZWxsQ291bnQ8PTEsJ2ZvdW5kIHR3byBzaGVsbHMgaW4gTWluaW1hbEVkZ2VSaW5nIGxpc3QnKTtyZXR1cm4gc2hlbGw7fTtqc3RzLm9wZXJhdGlvbi5vdmVybGF5LlBvbHlnb25CdWlsZGVyLnByb3RvdHlwZS5wbGFjZVBvbHlnb25Ib2xlcz1mdW5jdGlvbihzaGVsbCxtaW5FZGdlUmluZ3Mpe2Zvcih2YXIgaT0wO2k8bWluRWRnZVJpbmdzLmxlbmd0aDtpKyspe3ZhciBlcj1taW5FZGdlUmluZ3NbaV07aWYoZXIuaXNIb2xlKCkpe2VyLnNldFNoZWxsKHNoZWxsKTt9fX07anN0cy5vcGVyYXRpb24ub3ZlcmxheS5Qb2x5Z29uQnVpbGRlci5wcm90b3R5cGUuc29ydFNoZWxsc0FuZEhvbGVzPWZ1bmN0aW9uKGVkZ2VSaW5ncyxzaGVsbExpc3QsZnJlZUhvbGVMaXN0KXtmb3IodmFyIGk9MDtpPGVkZ2VSaW5ncy5sZW5ndGg7aSsrKXt2YXIgZXI9ZWRnZVJpbmdzW2ldO2lmKGVyLmlzSG9sZSgpKXtmcmVlSG9sZUxpc3QucHVzaChlcik7fWVsc2V7c2hlbGxMaXN0LnB1c2goZXIpO319fTtqc3RzLm9wZXJhdGlvbi5vdmVybGF5LlBvbHlnb25CdWlsZGVyLnByb3RvdHlwZS5wbGFjZUZyZWVIb2xlcz1mdW5jdGlvbihzaGVsbExpc3QsZnJlZUhvbGVMaXN0KXtmb3IodmFyIGk9MDtpPGZyZWVIb2xlTGlzdC5sZW5ndGg7aSsrKXt2YXIgaG9sZT1mcmVlSG9sZUxpc3RbaV07aWYoaG9sZS5nZXRTaGVsbCgpPT1udWxsKXt2YXIgc2hlbGw9dGhpcy5maW5kRWRnZVJpbmdDb250YWluaW5nKGhvbGUsc2hlbGxMaXN0KTtpZihzaGVsbD09PW51bGwpXG50aHJvdyBuZXcganN0cy5lcnJvci5Ub3BvbG9neUVycm9yKCd1bmFibGUgdG8gYXNzaWduIGhvbGUgdG8gYSBzaGVsbCcsaG9sZS5nZXRDb29yZGluYXRlKDApKTtob2xlLnNldFNoZWxsKHNoZWxsKTt9fX07anN0cy5vcGVyYXRpb24ub3ZlcmxheS5Qb2x5Z29uQnVpbGRlci5wcm90b3R5cGUuZmluZEVkZ2VSaW5nQ29udGFpbmluZz1mdW5jdGlvbih0ZXN0RXIsc2hlbGxMaXN0KXt2YXIgdGVzdFJpbmc9dGVzdEVyLmdldExpbmVhclJpbmcoKTt2YXIgdGVzdEVudj10ZXN0UmluZy5nZXRFbnZlbG9wZUludGVybmFsKCk7dmFyIHRlc3RQdD10ZXN0UmluZy5nZXRDb29yZGluYXRlTigwKTt2YXIgbWluU2hlbGw9bnVsbDt2YXIgbWluRW52PW51bGw7Zm9yKHZhciBpPTA7aTxzaGVsbExpc3QubGVuZ3RoO2krKyl7dmFyIHRyeVNoZWxsPXNoZWxsTGlzdFtpXTt2YXIgdHJ5UmluZz10cnlTaGVsbC5nZXRMaW5lYXJSaW5nKCk7dmFyIHRyeUVudj10cnlSaW5nLmdldEVudmVsb3BlSW50ZXJuYWwoKTtpZihtaW5TaGVsbCE9PW51bGwpXG5taW5FbnY9bWluU2hlbGwuZ2V0TGluZWFyUmluZygpLmdldEVudmVsb3BlSW50ZXJuYWwoKTt2YXIgaXNDb250YWluZWQ9ZmFsc2U7aWYodHJ5RW52LmNvbnRhaW5zKHRlc3RFbnYpJiZqc3RzLmFsZ29yaXRobS5DR0FsZ29yaXRobXMuaXNQb2ludEluUmluZyh0ZXN0UHQsdHJ5UmluZy5nZXRDb29yZGluYXRlcygpKSlcbmlzQ29udGFpbmVkPXRydWU7aWYoaXNDb250YWluZWQpe2lmKG1pblNoZWxsPT1udWxsfHxtaW5FbnYuY29udGFpbnModHJ5RW52KSl7bWluU2hlbGw9dHJ5U2hlbGw7fX19XG5yZXR1cm4gbWluU2hlbGw7fTtqc3RzLm9wZXJhdGlvbi5vdmVybGF5LlBvbHlnb25CdWlsZGVyLnByb3RvdHlwZS5jb21wdXRlUG9seWdvbnM9ZnVuY3Rpb24oc2hlbGxMaXN0KXt2YXIgcmVzdWx0UG9seUxpc3Q9bmV3IGphdmFzY3JpcHQudXRpbC5BcnJheUxpc3QoKTtmb3IodmFyIGk9MDtpPHNoZWxsTGlzdC5sZW5ndGg7aSsrKXt2YXIgZXI9c2hlbGxMaXN0W2ldO3ZhciBwb2x5PWVyLnRvUG9seWdvbih0aGlzLmdlb21ldHJ5RmFjdG9yeSk7cmVzdWx0UG9seUxpc3QuYWRkKHBvbHkpO31cbnJldHVybiByZXN1bHRQb2x5TGlzdDt9O2pzdHMub3BlcmF0aW9uLm92ZXJsYXkuUG9seWdvbkJ1aWxkZXIucHJvdG90eXBlLmNvbnRhaW5zUG9pbnQ9ZnVuY3Rpb24ocCl7Zm9yKHZhciBpPTA7aTx0aGlzLnNoZWxsTGlzdC5sZW5ndGg7aSsrKXt2YXIgZXI9dGhpcy5zaGVsbExpc3RbaV07aWYoZXIuY29udGFpbnNQb2ludChwKSlcbnJldHVybiB0cnVlO31cbnJldHVybiBmYWxzZTt9OyhmdW5jdGlvbigpe3ZhciBBc3NlcnQ9anN0cy51dGlsLkFzc2VydDt2YXIgQXJyYXlMaXN0PWphdmFzY3JpcHQudXRpbC5BcnJheUxpc3Q7dmFyIExpbmVCdWlsZGVyPWZ1bmN0aW9uKG9wLGdlb21ldHJ5RmFjdG9yeSxwdExvY2F0b3Ipe3RoaXMubGluZUVkZ2VzTGlzdD1uZXcgQXJyYXlMaXN0KCk7dGhpcy5yZXN1bHRMaW5lTGlzdD1uZXcgQXJyYXlMaXN0KCk7dGhpcy5vcD1vcDt0aGlzLmdlb21ldHJ5RmFjdG9yeT1nZW9tZXRyeUZhY3Rvcnk7dGhpcy5wdExvY2F0b3I9cHRMb2NhdG9yO307TGluZUJ1aWxkZXIucHJvdG90eXBlLm9wPW51bGw7TGluZUJ1aWxkZXIucHJvdG90eXBlLmdlb21ldHJ5RmFjdG9yeT1udWxsO0xpbmVCdWlsZGVyLnByb3RvdHlwZS5wdExvY2F0b3I9bnVsbDtMaW5lQnVpbGRlci5wcm90b3R5cGUubGluZUVkZ2VzTGlzdD1udWxsO0xpbmVCdWlsZGVyLnByb3RvdHlwZS5yZXN1bHRMaW5lTGlzdD1udWxsO0xpbmVCdWlsZGVyLnByb3RvdHlwZS5idWlsZD1mdW5jdGlvbihvcENvZGUpe3RoaXMuZmluZENvdmVyZWRMaW5lRWRnZXMoKTt0aGlzLmNvbGxlY3RMaW5lcyhvcENvZGUpO3RoaXMuYnVpbGRMaW5lcyhvcENvZGUpO3JldHVybiB0aGlzLnJlc3VsdExpbmVMaXN0O307TGluZUJ1aWxkZXIucHJvdG90eXBlLmZpbmRDb3ZlcmVkTGluZUVkZ2VzPWZ1bmN0aW9uKCl7Zm9yKHZhciBub2RlaXQ9dGhpcy5vcC5nZXRHcmFwaCgpLmdldE5vZGVzKCkuaXRlcmF0b3IoKTtub2RlaXQuaGFzTmV4dCgpOyl7dmFyIG5vZGU9bm9kZWl0Lm5leHQoKTtub2RlLmdldEVkZ2VzKCkuZmluZENvdmVyZWRMaW5lRWRnZXMoKTt9XG5mb3IodmFyIGl0PXRoaXMub3AuZ2V0R3JhcGgoKS5nZXRFZGdlRW5kcygpLml0ZXJhdG9yKCk7aXQuaGFzTmV4dCgpOyl7dmFyIGRlPWl0Lm5leHQoKTt2YXIgZT1kZS5nZXRFZGdlKCk7aWYoZGUuaXNMaW5lRWRnZSgpJiYhZS5pc0NvdmVyZWRTZXQoKSl7dmFyIGlzQ292ZXJlZD10aGlzLm9wLmlzQ292ZXJlZEJ5QShkZS5nZXRDb29yZGluYXRlKCkpO2Uuc2V0Q292ZXJlZChpc0NvdmVyZWQpO319fTtMaW5lQnVpbGRlci5wcm90b3R5cGUuY29sbGVjdExpbmVzPWZ1bmN0aW9uKG9wQ29kZSl7Zm9yKHZhciBpdD10aGlzLm9wLmdldEdyYXBoKCkuZ2V0RWRnZUVuZHMoKS5pdGVyYXRvcigpO2l0Lmhhc05leHQoKTspe3ZhciBkZT1pdC5uZXh0KCk7dGhpcy5jb2xsZWN0TGluZUVkZ2UoZGUsb3BDb2RlLHRoaXMubGluZUVkZ2VzTGlzdCk7dGhpcy5jb2xsZWN0Qm91bmRhcnlUb3VjaEVkZ2UoZGUsb3BDb2RlLHRoaXMubGluZUVkZ2VzTGlzdCk7fX07TGluZUJ1aWxkZXIucHJvdG90eXBlLmNvbGxlY3RMaW5lRWRnZT1mdW5jdGlvbihkZSxvcENvZGUsZWRnZXMpe3ZhciBsYWJlbD1kZS5nZXRMYWJlbCgpO3ZhciBlPWRlLmdldEVkZ2UoKTtpZihkZS5pc0xpbmVFZGdlKCkpe2lmKCFkZS5pc1Zpc2l0ZWQoKSYmanN0cy5vcGVyYXRpb24ub3ZlcmxheS5PdmVybGF5T3AuaXNSZXN1bHRPZk9wKGxhYmVsLG9wQ29kZSkmJiFlLmlzQ292ZXJlZCgpKXtlZGdlcy5hZGQoZSk7ZGUuc2V0VmlzaXRlZEVkZ2UodHJ1ZSk7fX19O0xpbmVCdWlsZGVyLnByb3RvdHlwZS5jb2xsZWN0Qm91bmRhcnlUb3VjaEVkZ2U9ZnVuY3Rpb24oZGUsb3BDb2RlLGVkZ2VzKXt2YXIgbGFiZWw9ZGUuZ2V0TGFiZWwoKTtpZihkZS5pc0xpbmVFZGdlKCkpXG5yZXR1cm47aWYoZGUuaXNWaXNpdGVkKCkpXG5yZXR1cm47aWYoZGUuaXNJbnRlcmlvckFyZWFFZGdlKCkpXG5yZXR1cm47aWYoZGUuZ2V0RWRnZSgpLmlzSW5SZXN1bHQoKSlcbnJldHVybjtBc3NlcnQuaXNUcnVlKCEoZGUuaXNJblJlc3VsdCgpfHxkZS5nZXRTeW0oKS5pc0luUmVzdWx0KCkpfHwhZGUuZ2V0RWRnZSgpLmlzSW5SZXN1bHQoKSk7aWYoanN0cy5vcGVyYXRpb24ub3ZlcmxheS5PdmVybGF5T3AuaXNSZXN1bHRPZk9wKGxhYmVsLG9wQ29kZSkmJm9wQ29kZT09PWpzdHMub3BlcmF0aW9uLm92ZXJsYXkuT3ZlcmxheU9wLklOVEVSU0VDVElPTil7ZWRnZXMuYWRkKGRlLmdldEVkZ2UoKSk7ZGUuc2V0VmlzaXRlZEVkZ2UodHJ1ZSk7fX07TGluZUJ1aWxkZXIucHJvdG90eXBlLmJ1aWxkTGluZXM9ZnVuY3Rpb24ob3BDb2RlKXtmb3IodmFyIGl0PXRoaXMubGluZUVkZ2VzTGlzdC5pdGVyYXRvcigpO2l0Lmhhc05leHQoKTspe3ZhciBlPWl0Lm5leHQoKTt2YXIgbGFiZWw9ZS5nZXRMYWJlbCgpO3ZhciBsaW5lPXRoaXMuZ2VvbWV0cnlGYWN0b3J5LmNyZWF0ZUxpbmVTdHJpbmcoZS5nZXRDb29yZGluYXRlcygpKTt0aGlzLnJlc3VsdExpbmVMaXN0LmFkZChsaW5lKTtlLnNldEluUmVzdWx0KHRydWUpO319O0xpbmVCdWlsZGVyLnByb3RvdHlwZS5sYWJlbElzb2xhdGVkTGluZXM9ZnVuY3Rpb24oZWRnZXNMaXN0KXtmb3IodmFyIGl0PWVkZ2VzTGlzdC5pdGVyYXRvcigpO2l0Lmhhc05leHQoKTspe3ZhciBlPWl0Lm5leHQoKTt2YXIgbGFiZWw9ZS5nZXRMYWJlbCgpO2lmKGUuaXNJc29sYXRlZCgpKXtpZihsYWJlbC5pc051bGwoMCkpXG50aGlzLmxhYmVsSXNvbGF0ZWRMaW5lKGUsMCk7ZWxzZVxudGhpcy5sYWJlbElzb2xhdGVkTGluZShlLDEpO319fTtMaW5lQnVpbGRlci5wcm90b3R5cGUubGFiZWxJc29sYXRlZExpbmU9ZnVuY3Rpb24oZSx0YXJnZXRJbmRleCl7dmFyIGxvYz1wdExvY2F0b3IubG9jYXRlKGUuZ2V0Q29vcmRpbmF0ZSgpLG9wLmdldEFyZ0dlb21ldHJ5KHRhcmdldEluZGV4KSk7ZS5nZXRMYWJlbCgpLnNldExvY2F0aW9uKHRhcmdldEluZGV4LGxvYyk7fTtqc3RzLm9wZXJhdGlvbi5vdmVybGF5LkxpbmVCdWlsZGVyPUxpbmVCdWlsZGVyO30pKCk7KGZ1bmN0aW9uKCl7dmFyIEFycmF5TGlzdD1qYXZhc2NyaXB0LnV0aWwuQXJyYXlMaXN0O3ZhciBQb2ludEJ1aWxkZXI9ZnVuY3Rpb24ob3AsZ2VvbWV0cnlGYWN0b3J5LHB0TG9jYXRvcil7dGhpcy5yZXN1bHRQb2ludExpc3Q9bmV3IEFycmF5TGlzdCgpO3RoaXMub3A9b3A7dGhpcy5nZW9tZXRyeUZhY3Rvcnk9Z2VvbWV0cnlGYWN0b3J5O307UG9pbnRCdWlsZGVyLnByb3RvdHlwZS5vcD1udWxsO1BvaW50QnVpbGRlci5wcm90b3R5cGUuZ2VvbWV0cnlGYWN0b3J5PW51bGw7UG9pbnRCdWlsZGVyLnByb3RvdHlwZS5yZXN1bHRQb2ludExpc3Q9bnVsbDtQb2ludEJ1aWxkZXIucHJvdG90eXBlLmJ1aWxkPWZ1bmN0aW9uKG9wQ29kZSl7dGhpcy5leHRyYWN0Tm9uQ292ZXJlZFJlc3VsdE5vZGVzKG9wQ29kZSk7cmV0dXJuIHRoaXMucmVzdWx0UG9pbnRMaXN0O307UG9pbnRCdWlsZGVyLnByb3RvdHlwZS5leHRyYWN0Tm9uQ292ZXJlZFJlc3VsdE5vZGVzPWZ1bmN0aW9uKG9wQ29kZSl7Zm9yKHZhciBub2RlaXQ9dGhpcy5vcC5nZXRHcmFwaCgpLmdldE5vZGVzKCkuaXRlcmF0b3IoKTtub2RlaXQuaGFzTmV4dCgpOyl7dmFyIG49bm9kZWl0Lm5leHQoKTtpZihuLmlzSW5SZXN1bHQoKSlcbmNvbnRpbnVlO2lmKG4uaXNJbmNpZGVudEVkZ2VJblJlc3VsdCgpKVxuY29udGludWU7aWYobi5nZXRFZGdlcygpLmdldERlZ3JlZSgpPT09MHx8b3BDb2RlPT09anN0cy5vcGVyYXRpb24ub3ZlcmxheS5PdmVybGF5T3AuSU5URVJTRUNUSU9OKXt2YXIgbGFiZWw9bi5nZXRMYWJlbCgpO2lmKGpzdHMub3BlcmF0aW9uLm92ZXJsYXkuT3ZlcmxheU9wLmlzUmVzdWx0T2ZPcChsYWJlbCxvcENvZGUpKXt0aGlzLmZpbHRlckNvdmVyZWROb2RlVG9Qb2ludChuKTt9fX19O1BvaW50QnVpbGRlci5wcm90b3R5cGUuZmlsdGVyQ292ZXJlZE5vZGVUb1BvaW50PWZ1bmN0aW9uKG4pe3ZhciBjb29yZD1uLmdldENvb3JkaW5hdGUoKTtpZighdGhpcy5vcC5pc0NvdmVyZWRCeUxBKGNvb3JkKSl7dmFyIHB0PXRoaXMuZ2VvbWV0cnlGYWN0b3J5LmNyZWF0ZVBvaW50KGNvb3JkKTt0aGlzLnJlc3VsdFBvaW50TGlzdC5hZGQocHQpO319O2pzdHMub3BlcmF0aW9uLm92ZXJsYXkuUG9pbnRCdWlsZGVyPVBvaW50QnVpbGRlcjt9KSgpOyhmdW5jdGlvbigpe3ZhciBQb2ludExvY2F0b3I9anN0cy5hbGdvcml0aG0uUG9pbnRMb2NhdG9yO3ZhciBMb2NhdGlvbj1qc3RzLmdlb20uTG9jYXRpb247dmFyIEVkZ2VMaXN0PWpzdHMuZ2VvbWdyYXBoLkVkZ2VMaXN0O3ZhciBMYWJlbD1qc3RzLmdlb21ncmFwaC5MYWJlbDt2YXIgUGxhbmFyR3JhcGg9anN0cy5nZW9tZ3JhcGguUGxhbmFyR3JhcGg7dmFyIFBvc2l0aW9uPWpzdHMuZ2VvbWdyYXBoLlBvc2l0aW9uO3ZhciBFZGdlTm9kaW5nVmFsaWRhdG9yPWpzdHMuZ2VvbWdyYXBoLkVkZ2VOb2RpbmdWYWxpZGF0b3I7dmFyIEdlb21ldHJ5R3JhcGhPcGVyYXRpb249anN0cy5vcGVyYXRpb24uR2VvbWV0cnlHcmFwaE9wZXJhdGlvbjt2YXIgT3ZlcmxheU5vZGVGYWN0b3J5PWpzdHMub3BlcmF0aW9uLm92ZXJsYXkuT3ZlcmxheU5vZGVGYWN0b3J5O3ZhciBQb2x5Z29uQnVpbGRlcj1qc3RzLm9wZXJhdGlvbi5vdmVybGF5LlBvbHlnb25CdWlsZGVyO3ZhciBMaW5lQnVpbGRlcj1qc3RzLm9wZXJhdGlvbi5vdmVybGF5LkxpbmVCdWlsZGVyO3ZhciBQb2ludEJ1aWxkZXI9anN0cy5vcGVyYXRpb24ub3ZlcmxheS5Qb2ludEJ1aWxkZXI7dmFyIEFzc2VydD1qc3RzLnV0aWwuQXNzZXJ0O3ZhciBBcnJheUxpc3Q9amF2YXNjcmlwdC51dGlsLkFycmF5TGlzdDtqc3RzLm9wZXJhdGlvbi5vdmVybGF5Lk92ZXJsYXlPcD1mdW5jdGlvbihnMCxnMSl7dGhpcy5wdExvY2F0b3I9bmV3IFBvaW50TG9jYXRvcigpO3RoaXMuZWRnZUxpc3Q9bmV3IEVkZ2VMaXN0KCk7dGhpcy5yZXN1bHRQb2x5TGlzdD1uZXcgQXJyYXlMaXN0KCk7dGhpcy5yZXN1bHRMaW5lTGlzdD1uZXcgQXJyYXlMaXN0KCk7dGhpcy5yZXN1bHRQb2ludExpc3Q9bmV3IEFycmF5TGlzdCgpO0dlb21ldHJ5R3JhcGhPcGVyYXRpb24uY2FsbCh0aGlzLGcwLGcxKTt0aGlzLmdyYXBoPW5ldyBQbGFuYXJHcmFwaChuZXcgT3ZlcmxheU5vZGVGYWN0b3J5KCkpO3RoaXMuZ2VvbUZhY3Q9ZzAuZ2V0RmFjdG9yeSgpO307anN0cy5vcGVyYXRpb24ub3ZlcmxheS5PdmVybGF5T3AucHJvdG90eXBlPW5ldyBHZW9tZXRyeUdyYXBoT3BlcmF0aW9uKCk7anN0cy5vcGVyYXRpb24ub3ZlcmxheS5PdmVybGF5T3AuY29uc3RydWN0b3I9anN0cy5vcGVyYXRpb24ub3ZlcmxheS5PdmVybGF5T3A7anN0cy5vcGVyYXRpb24ub3ZlcmxheS5PdmVybGF5T3AuSU5URVJTRUNUSU9OPTE7anN0cy5vcGVyYXRpb24ub3ZlcmxheS5PdmVybGF5T3AuVU5JT049Mjtqc3RzLm9wZXJhdGlvbi5vdmVybGF5Lk92ZXJsYXlPcC5ESUZGRVJFTkNFPTM7anN0cy5vcGVyYXRpb24ub3ZlcmxheS5PdmVybGF5T3AuU1lNRElGRkVSRU5DRT00O2pzdHMub3BlcmF0aW9uLm92ZXJsYXkuT3ZlcmxheU9wLm92ZXJsYXlPcD1mdW5jdGlvbihnZW9tMCxnZW9tMSxvcENvZGUpe3ZhciBnb3Y9bmV3IGpzdHMub3BlcmF0aW9uLm92ZXJsYXkuT3ZlcmxheU9wKGdlb20wLGdlb20xKTt2YXIgZ2VvbU92PWdvdi5nZXRSZXN1bHRHZW9tZXRyeShvcENvZGUpO3JldHVybiBnZW9tT3Y7fVxuanN0cy5vcGVyYXRpb24ub3ZlcmxheS5PdmVybGF5T3AuaXNSZXN1bHRPZk9wPWZ1bmN0aW9uKGxhYmVsLG9wQ29kZSl7aWYoYXJndW1lbnRzLmxlbmd0aD09PTMpe3JldHVybiBqc3RzLm9wZXJhdGlvbi5vdmVybGF5Lk92ZXJsYXlPcC5pc1Jlc3VsdE9mT3AyLmFwcGx5KHRoaXMsYXJndW1lbnRzKTt9XG52YXIgbG9jMD1sYWJlbC5nZXRMb2NhdGlvbigwKTt2YXIgbG9jMT1sYWJlbC5nZXRMb2NhdGlvbigxKTtyZXR1cm4ganN0cy5vcGVyYXRpb24ub3ZlcmxheS5PdmVybGF5T3AuaXNSZXN1bHRPZk9wMihsb2MwLGxvYzEsb3BDb2RlKTt9XG5qc3RzLm9wZXJhdGlvbi5vdmVybGF5Lk92ZXJsYXlPcC5pc1Jlc3VsdE9mT3AyPWZ1bmN0aW9uKGxvYzAsbG9jMSxvcENvZGUpe2lmKGxvYzA9PUxvY2F0aW9uLkJPVU5EQVJZKVxubG9jMD1Mb2NhdGlvbi5JTlRFUklPUjtpZihsb2MxPT1Mb2NhdGlvbi5CT1VOREFSWSlcbmxvYzE9TG9jYXRpb24uSU5URVJJT1I7c3dpdGNoKG9wQ29kZSl7Y2FzZSBqc3RzLm9wZXJhdGlvbi5vdmVybGF5Lk92ZXJsYXlPcC5JTlRFUlNFQ1RJT046cmV0dXJuIGxvYzA9PUxvY2F0aW9uLklOVEVSSU9SJiZsb2MxPT1Mb2NhdGlvbi5JTlRFUklPUjtjYXNlIGpzdHMub3BlcmF0aW9uLm92ZXJsYXkuT3ZlcmxheU9wLlVOSU9OOnJldHVybiBsb2MwPT1Mb2NhdGlvbi5JTlRFUklPUnx8bG9jMT09TG9jYXRpb24uSU5URVJJT1I7Y2FzZSBqc3RzLm9wZXJhdGlvbi5vdmVybGF5Lk92ZXJsYXlPcC5ESUZGRVJFTkNFOnJldHVybiBsb2MwPT1Mb2NhdGlvbi5JTlRFUklPUiYmbG9jMSE9TG9jYXRpb24uSU5URVJJT1I7Y2FzZSBqc3RzLm9wZXJhdGlvbi5vdmVybGF5Lk92ZXJsYXlPcC5TWU1ESUZGRVJFTkNFOnJldHVybihsb2MwPT1Mb2NhdGlvbi5JTlRFUklPUiYmbG9jMSE9TG9jYXRpb24uSU5URVJJT1IpfHwobG9jMCE9TG9jYXRpb24uSU5URVJJT1ImJmxvYzE9PUxvY2F0aW9uLklOVEVSSU9SKTt9XG5yZXR1cm4gZmFsc2U7fVxuanN0cy5vcGVyYXRpb24ub3ZlcmxheS5PdmVybGF5T3AucHJvdG90eXBlLnB0TG9jYXRvcj1udWxsO2pzdHMub3BlcmF0aW9uLm92ZXJsYXkuT3ZlcmxheU9wLnByb3RvdHlwZS5nZW9tRmFjdD1udWxsO2pzdHMub3BlcmF0aW9uLm92ZXJsYXkuT3ZlcmxheU9wLnByb3RvdHlwZS5yZXN1bHRHZW9tPW51bGw7anN0cy5vcGVyYXRpb24ub3ZlcmxheS5PdmVybGF5T3AucHJvdG90eXBlLmdyYXBoPW51bGw7anN0cy5vcGVyYXRpb24ub3ZlcmxheS5PdmVybGF5T3AucHJvdG90eXBlLmVkZ2VMaXN0PW51bGw7anN0cy5vcGVyYXRpb24ub3ZlcmxheS5PdmVybGF5T3AucHJvdG90eXBlLnJlc3VsdFBvbHlMaXN0PW51bGw7anN0cy5vcGVyYXRpb24ub3ZlcmxheS5PdmVybGF5T3AucHJvdG90eXBlLnJlc3VsdExpbmVMaXN0PW51bGw7anN0cy5vcGVyYXRpb24ub3ZlcmxheS5PdmVybGF5T3AucHJvdG90eXBlLnJlc3VsdFBvaW50TGlzdD1udWxsO2pzdHMub3BlcmF0aW9uLm92ZXJsYXkuT3ZlcmxheU9wLnByb3RvdHlwZS5nZXRSZXN1bHRHZW9tZXRyeT1mdW5jdGlvbihmdW5jQ29kZSl7dGhpcy5jb21wdXRlT3ZlcmxheShmdW5jQ29kZSk7cmV0dXJuIHRoaXMucmVzdWx0R2VvbTt9XG5qc3RzLm9wZXJhdGlvbi5vdmVybGF5Lk92ZXJsYXlPcC5wcm90b3R5cGUuZ2V0R3JhcGg9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5ncmFwaDt9XG5qc3RzLm9wZXJhdGlvbi5vdmVybGF5Lk92ZXJsYXlPcC5wcm90b3R5cGUuY29tcHV0ZU92ZXJsYXk9ZnVuY3Rpb24ob3BDb2RlKXt0aGlzLmNvcHlQb2ludHMoMCk7dGhpcy5jb3B5UG9pbnRzKDEpO3RoaXMuYXJnWzBdLmNvbXB1dGVTZWxmTm9kZXModGhpcy5saSxmYWxzZSk7dGhpcy5hcmdbMV0uY29tcHV0ZVNlbGZOb2Rlcyh0aGlzLmxpLGZhbHNlKTt0aGlzLmFyZ1swXS5jb21wdXRlRWRnZUludGVyc2VjdGlvbnModGhpcy5hcmdbMV0sdGhpcy5saSx0cnVlKTt2YXIgYmFzZVNwbGl0RWRnZXM9bmV3IEFycmF5TGlzdCgpO3RoaXMuYXJnWzBdLmNvbXB1dGVTcGxpdEVkZ2VzKGJhc2VTcGxpdEVkZ2VzKTt0aGlzLmFyZ1sxXS5jb21wdXRlU3BsaXRFZGdlcyhiYXNlU3BsaXRFZGdlcyk7dmFyIHNwbGl0RWRnZXM9YmFzZVNwbGl0RWRnZXM7dGhpcy5pbnNlcnRVbmlxdWVFZGdlcyhiYXNlU3BsaXRFZGdlcyk7dGhpcy5jb21wdXRlTGFiZWxzRnJvbURlcHRocygpO3RoaXMucmVwbGFjZUNvbGxhcHNlZEVkZ2VzKCk7RWRnZU5vZGluZ1ZhbGlkYXRvci5jaGVja1ZhbGlkKHRoaXMuZWRnZUxpc3QuZ2V0RWRnZXMoKSk7dGhpcy5ncmFwaC5hZGRFZGdlcyh0aGlzLmVkZ2VMaXN0LmdldEVkZ2VzKCkpO3RoaXMuY29tcHV0ZUxhYmVsbGluZygpO3RoaXMubGFiZWxJbmNvbXBsZXRlTm9kZXMoKTt0aGlzLmZpbmRSZXN1bHRBcmVhRWRnZXMob3BDb2RlKTt0aGlzLmNhbmNlbER1cGxpY2F0ZVJlc3VsdEVkZ2VzKCk7dmFyIHBvbHlCdWlsZGVyPW5ldyBQb2x5Z29uQnVpbGRlcih0aGlzLmdlb21GYWN0KTtwb2x5QnVpbGRlci5hZGQodGhpcy5ncmFwaCk7dGhpcy5yZXN1bHRQb2x5TGlzdD1wb2x5QnVpbGRlci5nZXRQb2x5Z29ucygpO3ZhciBsaW5lQnVpbGRlcj1uZXcgTGluZUJ1aWxkZXIodGhpcyx0aGlzLmdlb21GYWN0LHRoaXMucHRMb2NhdG9yKTt0aGlzLnJlc3VsdExpbmVMaXN0PWxpbmVCdWlsZGVyLmJ1aWxkKG9wQ29kZSk7dmFyIHBvaW50QnVpbGRlcj1uZXcgUG9pbnRCdWlsZGVyKHRoaXMsdGhpcy5nZW9tRmFjdCx0aGlzLnB0TG9jYXRvcik7dGhpcy5yZXN1bHRQb2ludExpc3Q9cG9pbnRCdWlsZGVyLmJ1aWxkKG9wQ29kZSk7dGhpcy5yZXN1bHRHZW9tPXRoaXMuY29tcHV0ZUdlb21ldHJ5KHRoaXMucmVzdWx0UG9pbnRMaXN0LHRoaXMucmVzdWx0TGluZUxpc3QsdGhpcy5yZXN1bHRQb2x5TGlzdCxvcENvZGUpO31cbmpzdHMub3BlcmF0aW9uLm92ZXJsYXkuT3ZlcmxheU9wLnByb3RvdHlwZS5pbnNlcnRVbmlxdWVFZGdlcz1mdW5jdGlvbihlZGdlcyl7Zm9yKHZhciBpPWVkZ2VzLml0ZXJhdG9yKCk7aS5oYXNOZXh0KCk7KXt2YXIgZT1pLm5leHQoKTt0aGlzLmluc2VydFVuaXF1ZUVkZ2UoZSk7fX1cbmpzdHMub3BlcmF0aW9uLm92ZXJsYXkuT3ZlcmxheU9wLnByb3RvdHlwZS5pbnNlcnRVbmlxdWVFZGdlPWZ1bmN0aW9uKGUpe3ZhciBleGlzdGluZ0VkZ2U9dGhpcy5lZGdlTGlzdC5maW5kRXF1YWxFZGdlKGUpO2lmKGV4aXN0aW5nRWRnZSE9PW51bGwpe3ZhciBleGlzdGluZ0xhYmVsPWV4aXN0aW5nRWRnZS5nZXRMYWJlbCgpO3ZhciBsYWJlbFRvTWVyZ2U9ZS5nZXRMYWJlbCgpO2lmKCFleGlzdGluZ0VkZ2UuaXNQb2ludHdpc2VFcXVhbChlKSl7bGFiZWxUb01lcmdlPW5ldyBMYWJlbChlLmdldExhYmVsKCkpO2xhYmVsVG9NZXJnZS5mbGlwKCk7fVxudmFyIGRlcHRoPWV4aXN0aW5nRWRnZS5nZXREZXB0aCgpO2lmKGRlcHRoLmlzTnVsbCgpKXtkZXB0aC5hZGQoZXhpc3RpbmdMYWJlbCk7fVxuZGVwdGguYWRkKGxhYmVsVG9NZXJnZSk7ZXhpc3RpbmdMYWJlbC5tZXJnZShsYWJlbFRvTWVyZ2UpO31lbHNle3RoaXMuZWRnZUxpc3QuYWRkKGUpO319O2pzdHMub3BlcmF0aW9uLm92ZXJsYXkuT3ZlcmxheU9wLnByb3RvdHlwZS5jb21wdXRlTGFiZWxzRnJvbURlcHRocz1mdW5jdGlvbigpe2Zvcih2YXIgaXQ9dGhpcy5lZGdlTGlzdC5pdGVyYXRvcigpO2l0Lmhhc05leHQoKTspe3ZhciBlPWl0Lm5leHQoKTt2YXIgbGJsPWUuZ2V0TGFiZWwoKTt2YXIgZGVwdGg9ZS5nZXREZXB0aCgpO2lmKCFkZXB0aC5pc051bGwoKSl7ZGVwdGgubm9ybWFsaXplKCk7Zm9yKHZhciBpPTA7aTwyO2krKyl7aWYoIWxibC5pc051bGwoaSkmJmxibC5pc0FyZWEoKSYmIWRlcHRoLmlzTnVsbChpKSl7aWYoZGVwdGguZ2V0RGVsdGEoaSk9PTApe2xibC50b0xpbmUoaSk7fWVsc2V7QXNzZXJ0LmlzVHJ1ZSghZGVwdGguaXNOdWxsKGksUG9zaXRpb24uTEVGVCksJ2RlcHRoIG9mIExFRlQgc2lkZSBoYXMgbm90IGJlZW4gaW5pdGlhbGl6ZWQnKTtsYmwuc2V0TG9jYXRpb24oaSxQb3NpdGlvbi5MRUZULGRlcHRoLmdldExvY2F0aW9uKGksUG9zaXRpb24uTEVGVCkpO0Fzc2VydC5pc1RydWUoIWRlcHRoLmlzTnVsbChpLFBvc2l0aW9uLlJJR0hUKSwnZGVwdGggb2YgUklHSFQgc2lkZSBoYXMgbm90IGJlZW4gaW5pdGlhbGl6ZWQnKTtsYmwuc2V0TG9jYXRpb24oaSxQb3NpdGlvbi5SSUdIVCxkZXB0aC5nZXRMb2NhdGlvbihpLFBvc2l0aW9uLlJJR0hUKSk7fX19fX19XG5qc3RzLm9wZXJhdGlvbi5vdmVybGF5Lk92ZXJsYXlPcC5wcm90b3R5cGUucmVwbGFjZUNvbGxhcHNlZEVkZ2VzPWZ1bmN0aW9uKCl7dmFyIG5ld0VkZ2VzPW5ldyBBcnJheUxpc3QoKTtmb3IodmFyIGl0PXRoaXMuZWRnZUxpc3QuaXRlcmF0b3IoKTtpdC5oYXNOZXh0KCk7KXt2YXIgZT1pdC5uZXh0KCk7aWYoZS5pc0NvbGxhcHNlZCgpKXtpdC5yZW1vdmUoKTtuZXdFZGdlcy5hZGQoZS5nZXRDb2xsYXBzZWRFZGdlKCkpO319XG50aGlzLmVkZ2VMaXN0LmFkZEFsbChuZXdFZGdlcyk7fVxuanN0cy5vcGVyYXRpb24ub3ZlcmxheS5PdmVybGF5T3AucHJvdG90eXBlLmNvcHlQb2ludHM9ZnVuY3Rpb24oYXJnSW5kZXgpe2Zvcih2YXIgaT10aGlzLmFyZ1thcmdJbmRleF0uZ2V0Tm9kZUl0ZXJhdG9yKCk7aS5oYXNOZXh0KCk7KXt2YXIgZ3JhcGhOb2RlPWkubmV4dCgpO3ZhciBuZXdOb2RlPXRoaXMuZ3JhcGguYWRkTm9kZShncmFwaE5vZGUuZ2V0Q29vcmRpbmF0ZSgpKTtuZXdOb2RlLnNldExhYmVsKGFyZ0luZGV4LGdyYXBoTm9kZS5nZXRMYWJlbCgpLmdldExvY2F0aW9uKGFyZ0luZGV4KSk7fX1cbmpzdHMub3BlcmF0aW9uLm92ZXJsYXkuT3ZlcmxheU9wLnByb3RvdHlwZS5jb21wdXRlTGFiZWxsaW5nPWZ1bmN0aW9uKCl7Zm9yKHZhciBub2RlaXQ9dGhpcy5ncmFwaC5nZXROb2RlcygpLml0ZXJhdG9yKCk7bm9kZWl0Lmhhc05leHQoKTspe3ZhciBub2RlPW5vZGVpdC5uZXh0KCk7bm9kZS5nZXRFZGdlcygpLmNvbXB1dGVMYWJlbGxpbmcodGhpcy5hcmcpO31cbnRoaXMubWVyZ2VTeW1MYWJlbHMoKTt0aGlzLnVwZGF0ZU5vZGVMYWJlbGxpbmcoKTt9XG5qc3RzLm9wZXJhdGlvbi5vdmVybGF5Lk92ZXJsYXlPcC5wcm90b3R5cGUubWVyZ2VTeW1MYWJlbHM9ZnVuY3Rpb24oKXtmb3IodmFyIG5vZGVpdD10aGlzLmdyYXBoLmdldE5vZGVzKCkuaXRlcmF0b3IoKTtub2RlaXQuaGFzTmV4dCgpOyl7dmFyIG5vZGU9bm9kZWl0Lm5leHQoKTtub2RlLmdldEVkZ2VzKCkubWVyZ2VTeW1MYWJlbHMoKTt9fVxuanN0cy5vcGVyYXRpb24ub3ZlcmxheS5PdmVybGF5T3AucHJvdG90eXBlLnVwZGF0ZU5vZGVMYWJlbGxpbmc9ZnVuY3Rpb24oKXtmb3IodmFyIG5vZGVpdD10aGlzLmdyYXBoLmdldE5vZGVzKCkuaXRlcmF0b3IoKTtub2RlaXQuaGFzTmV4dCgpOyl7dmFyIG5vZGU9bm9kZWl0Lm5leHQoKTt2YXIgbGJsPW5vZGUuZ2V0RWRnZXMoKS5nZXRMYWJlbCgpO25vZGUuZ2V0TGFiZWwoKS5tZXJnZShsYmwpO319XG5qc3RzLm9wZXJhdGlvbi5vdmVybGF5Lk92ZXJsYXlPcC5wcm90b3R5cGUubGFiZWxJbmNvbXBsZXRlTm9kZXM9ZnVuY3Rpb24oKXt2YXIgbm9kZUNvdW50PTA7Zm9yKHZhciBuaT10aGlzLmdyYXBoLmdldE5vZGVzKCkuaXRlcmF0b3IoKTtuaS5oYXNOZXh0KCk7KXt2YXIgbj1uaS5uZXh0KCk7dmFyIGxhYmVsPW4uZ2V0TGFiZWwoKTtpZihuLmlzSXNvbGF0ZWQoKSl7bm9kZUNvdW50Kys7aWYobGFiZWwuaXNOdWxsKDApKVxudGhpcy5sYWJlbEluY29tcGxldGVOb2RlKG4sMCk7ZWxzZVxudGhpcy5sYWJlbEluY29tcGxldGVOb2RlKG4sMSk7fVxubi5nZXRFZGdlcygpLnVwZGF0ZUxhYmVsbGluZyhsYWJlbCk7fX07anN0cy5vcGVyYXRpb24ub3ZlcmxheS5PdmVybGF5T3AucHJvdG90eXBlLmxhYmVsSW5jb21wbGV0ZU5vZGU9ZnVuY3Rpb24obix0YXJnZXRJbmRleCl7dmFyIGxvYz10aGlzLnB0TG9jYXRvci5sb2NhdGUobi5nZXRDb29yZGluYXRlKCksdGhpcy5hcmdbdGFyZ2V0SW5kZXhdLmdldEdlb21ldHJ5KCkpO24uZ2V0TGFiZWwoKS5zZXRMb2NhdGlvbih0YXJnZXRJbmRleCxsb2MpO307anN0cy5vcGVyYXRpb24ub3ZlcmxheS5PdmVybGF5T3AucHJvdG90eXBlLmZpbmRSZXN1bHRBcmVhRWRnZXM9ZnVuY3Rpb24ob3BDb2RlKXtmb3IodmFyIGl0PXRoaXMuZ3JhcGguZ2V0RWRnZUVuZHMoKS5pdGVyYXRvcigpO2l0Lmhhc05leHQoKTspe3ZhciBkZT1pdC5uZXh0KCk7dmFyIGxhYmVsPWRlLmdldExhYmVsKCk7aWYobGFiZWwuaXNBcmVhKCkmJiFkZS5pc0ludGVyaW9yQXJlYUVkZ2UoKSYmanN0cy5vcGVyYXRpb24ub3ZlcmxheS5PdmVybGF5T3AuaXNSZXN1bHRPZk9wKGxhYmVsLmdldExvY2F0aW9uKDAsUG9zaXRpb24uUklHSFQpLGxhYmVsLmdldExvY2F0aW9uKDEsUG9zaXRpb24uUklHSFQpLG9wQ29kZSkpe2RlLnNldEluUmVzdWx0KHRydWUpO319fTtqc3RzLm9wZXJhdGlvbi5vdmVybGF5Lk92ZXJsYXlPcC5wcm90b3R5cGUuY2FuY2VsRHVwbGljYXRlUmVzdWx0RWRnZXM9ZnVuY3Rpb24oKXtmb3IodmFyIGl0PXRoaXMuZ3JhcGguZ2V0RWRnZUVuZHMoKS5pdGVyYXRvcigpO2l0Lmhhc05leHQoKTspe3ZhciBkZT1pdC5uZXh0KCk7dmFyIHN5bT1kZS5nZXRTeW0oKTtpZihkZS5pc0luUmVzdWx0KCkmJnN5bS5pc0luUmVzdWx0KCkpe2RlLnNldEluUmVzdWx0KGZhbHNlKTtzeW0uc2V0SW5SZXN1bHQoZmFsc2UpO319fTtqc3RzLm9wZXJhdGlvbi5vdmVybGF5Lk92ZXJsYXlPcC5wcm90b3R5cGUuaXNDb3ZlcmVkQnlMQT1mdW5jdGlvbihjb29yZCl7aWYodGhpcy5pc0NvdmVyZWQoY29vcmQsdGhpcy5yZXN1bHRMaW5lTGlzdCkpXG5yZXR1cm4gdHJ1ZTtpZih0aGlzLmlzQ292ZXJlZChjb29yZCx0aGlzLnJlc3VsdFBvbHlMaXN0KSlcbnJldHVybiB0cnVlO3JldHVybiBmYWxzZTt9O2pzdHMub3BlcmF0aW9uLm92ZXJsYXkuT3ZlcmxheU9wLnByb3RvdHlwZS5pc0NvdmVyZWRCeUE9ZnVuY3Rpb24oY29vcmQpe2lmKHRoaXMuaXNDb3ZlcmVkKGNvb3JkLHRoaXMucmVzdWx0UG9seUxpc3QpKVxucmV0dXJuIHRydWU7cmV0dXJuIGZhbHNlO307anN0cy5vcGVyYXRpb24ub3ZlcmxheS5PdmVybGF5T3AucHJvdG90eXBlLmlzQ292ZXJlZD1mdW5jdGlvbihjb29yZCxnZW9tTGlzdCl7Zm9yKHZhciBpdD1nZW9tTGlzdC5pdGVyYXRvcigpO2l0Lmhhc05leHQoKTspe3ZhciBnZW9tPWl0Lm5leHQoKTt2YXIgbG9jPXRoaXMucHRMb2NhdG9yLmxvY2F0ZShjb29yZCxnZW9tKTtpZihsb2MhPUxvY2F0aW9uLkVYVEVSSU9SKVxucmV0dXJuIHRydWU7fVxucmV0dXJuIGZhbHNlO307anN0cy5vcGVyYXRpb24ub3ZlcmxheS5PdmVybGF5T3AucHJvdG90eXBlLmNvbXB1dGVHZW9tZXRyeT1mdW5jdGlvbihyZXN1bHRQb2ludExpc3QscmVzdWx0TGluZUxpc3QscmVzdWx0UG9seUxpc3Qsb3Bjb2RlKXt2YXIgZ2VvbUxpc3Q9bmV3IEFycmF5TGlzdCgpO2dlb21MaXN0LmFkZEFsbChyZXN1bHRQb2ludExpc3QpO2dlb21MaXN0LmFkZEFsbChyZXN1bHRMaW5lTGlzdCk7Z2VvbUxpc3QuYWRkQWxsKHJlc3VsdFBvbHlMaXN0KTtyZXR1cm4gdGhpcy5nZW9tRmFjdC5idWlsZEdlb21ldHJ5KGdlb21MaXN0KTt9O2pzdHMub3BlcmF0aW9uLm92ZXJsYXkuT3ZlcmxheU9wLnByb3RvdHlwZS5jcmVhdGVFbXB0eVJlc3VsdD1mdW5jdGlvbihvcENvZGUpe3ZhciByZXN1bHQ9bnVsbDtzd2l0Y2gocmVzdWx0RGltZW5zaW9uKG9wQ29kZSx0aGlzLmFyZ1swXS5nZXRHZW9tZXRyeSgpLHRoaXMuYXJnWzFdLmdldEdlb21ldHJ5KCkpKXtjYXNlLTE6cmVzdWx0PWdlb21GYWN0LmNyZWF0ZUdlb21ldHJ5Q29sbGVjdGlvbigpO2JyZWFrO2Nhc2UgMDpyZXN1bHQ9Z2VvbUZhY3QuY3JlYXRlUG9pbnQobnVsbCk7YnJlYWs7Y2FzZSAxOnJlc3VsdD1nZW9tRmFjdC5jcmVhdGVMaW5lU3RyaW5nKG51bGwpO2JyZWFrO2Nhc2UgMjpyZXN1bHQ9Z2VvbUZhY3QuY3JlYXRlUG9seWdvbihudWxsLG51bGwpO2JyZWFrO31cbnJldHVybiByZXN1bHQ7fTtqc3RzLm9wZXJhdGlvbi5vdmVybGF5Lk92ZXJsYXlPcC5wcm90b3R5cGUucmVzdWx0RGltZW5zaW9uPWZ1bmN0aW9uKG9wQ29kZSxnMCxnMSl7dmFyIGRpbTA9ZzAuZ2V0RGltZW5zaW9uKCk7dmFyIGRpbTE9ZzEuZ2V0RGltZW5zaW9uKCk7dmFyIHJlc3VsdERpbWVuc2lvbj0tMTtzd2l0Y2gob3BDb2RlKXtjYXNlIGpzdHMub3BlcmF0aW9uLm92ZXJsYXkuT3ZlcmxheU9wLklOVEVSU0VDVElPTjpyZXN1bHREaW1lbnNpb249TWF0aC5taW4oZGltMCxkaW0xKTticmVhaztjYXNlIGpzdHMub3BlcmF0aW9uLm92ZXJsYXkuT3ZlcmxheU9wLlVOSU9OOnJlc3VsdERpbWVuc2lvbj1NYXRoLm1heChkaW0wLGRpbTEpO2JyZWFrO2Nhc2UganN0cy5vcGVyYXRpb24ub3ZlcmxheS5PdmVybGF5T3AuRElGRkVSRU5DRTpyZXN1bHREaW1lbnNpb249ZGltMDticmVhaztjYXNlIGpzdHMub3BlcmF0aW9uLm92ZXJsYXkuT3ZlcmxheU9wLlNZTURJRkZFUkVOQ0U6cmVzdWx0RGltZW5zaW9uPU1hdGgubWF4KGRpbTAsZGltMSk7YnJlYWs7fVxucmV0dXJuIHJlc3VsdERpbWVuc2lvbjt9O30pKCk7KGZ1bmN0aW9uKCl7dmFyIE92ZXJsYXlPcD1qc3RzLm9wZXJhdGlvbi5vdmVybGF5Lk92ZXJsYXlPcDt2YXIgR2VvbWV0cnlTbmFwcGVyPWpzdHMub3BlcmF0aW9uLm92ZXJsYXkuc25hcC5HZW9tZXRyeVNuYXBwZXI7dmFyIFNuYXBPdmVybGF5T3A9ZnVuY3Rpb24oZzEsZzIpe3RoaXMuZ2VvbT1bXTt0aGlzLmdlb21bMF09ZzE7dGhpcy5nZW9tWzFdPWcyO3RoaXMuY29tcHV0ZVNuYXBUb2xlcmFuY2UoKTt9O1NuYXBPdmVybGF5T3Aub3ZlcmxheU9wPWZ1bmN0aW9uKGcwLGcxLG9wQ29kZSl7dmFyIG9wPW5ldyBTbmFwT3ZlcmxheU9wKGcwLGcxKTtyZXR1cm4gb3AuZ2V0UmVzdWx0R2VvbWV0cnkob3BDb2RlKTt9O1NuYXBPdmVybGF5T3AuaW50ZXJzZWN0aW9uPWZ1bmN0aW9uKGcwLGcxKXtyZXR1cm4gdGhpcy5vdmVybGF5T3AoZzAsZzEsT3ZlcmxheU9wLklOVEVSU0VDVElPTik7fTtTbmFwT3ZlcmxheU9wLnVuaW9uPWZ1bmN0aW9uKGcwLGcxKXtyZXR1cm4gdGhpcy5vdmVybGF5T3AoZzAsZzEsT3ZlcmxheU9wLlVOSU9OKTt9O1NuYXBPdmVybGF5T3AuZGlmZmVyZW5jZT1mdW5jdGlvbihnMCxnMSl7cmV0dXJuIG92ZXJsYXlPcChnMCxnMSxPdmVybGF5T3AuRElGRkVSRU5DRSk7fTtTbmFwT3ZlcmxheU9wLnN5bURpZmZlcmVuY2U9ZnVuY3Rpb24oZzAsZzEpe3JldHVybiBvdmVybGF5T3AoZzAsZzEsT3ZlcmxheU9wLlNZTURJRkZFUkVOQ0UpO307U25hcE92ZXJsYXlPcC5wcm90b3R5cGUuZ2VvbT1udWxsO1NuYXBPdmVybGF5T3AucHJvdG90eXBlLnNuYXBUb2xlcmFuY2U9bnVsbDtTbmFwT3ZlcmxheU9wLnByb3RvdHlwZS5jb21wdXRlU25hcFRvbGVyYW5jZT1mdW5jdGlvbigpe3RoaXMuc25hcFRvbGVyYW5jZT1HZW9tZXRyeVNuYXBwZXIuY29tcHV0ZU92ZXJsYXlTbmFwVG9sZXJhbmNlKHRoaXMuZ2VvbVswXSx0aGlzLmdlb21bMV0pO307U25hcE92ZXJsYXlPcC5wcm90b3R5cGUuZ2V0UmVzdWx0R2VvbWV0cnk9ZnVuY3Rpb24ob3BDb2RlKXt2YXIgcHJlcEdlb209dGhpcy5zbmFwKHRoaXMuZ2VvbSk7dmFyIHJlc3VsdD1PdmVybGF5T3Aub3ZlcmxheU9wKHByZXBHZW9tWzBdLHByZXBHZW9tWzFdLG9wQ29kZSk7cmV0dXJuIHRoaXMucHJlcGFyZVJlc3VsdChyZXN1bHQpO307U25hcE92ZXJsYXlPcC5wcm90b3R5cGUuc2VsZlNuYXA9ZnVuY3Rpb24oZ2VvbSl7dmFyIHNuYXBwZXIwPW5ldyBHZW9tZXRyeVNuYXBwZXIoZ2VvbSk7dmFyIHNuYXBHZW9tPXNuYXBwZXIwLnNuYXBUbyhnZW9tLHRoaXMuc25hcFRvbGVyYW5jZSk7cmV0dXJuIHNuYXBHZW9tO307U25hcE92ZXJsYXlPcC5wcm90b3R5cGUuc25hcD1mdW5jdGlvbihnZW9tKXt2YXIgcmVtR2VvbT1nZW9tO3ZhciBzbmFwR2VvbT1HZW9tZXRyeVNuYXBwZXIuc25hcChyZW1HZW9tWzBdLHJlbUdlb21bMV0sdGhpcy5zbmFwVG9sZXJhbmNlKTtyZXR1cm4gc25hcEdlb207fTtTbmFwT3ZlcmxheU9wLnByb3RvdHlwZS5wcmVwYXJlUmVzdWx0PWZ1bmN0aW9uKGdlb20pe3JldHVybiBnZW9tO307U25hcE92ZXJsYXlPcC5wcm90b3R5cGUuY2JyPW51bGw7U25hcE92ZXJsYXlPcC5wcm90b3R5cGUucmVtb3ZlQ29tbW9uQml0cz1mdW5jdGlvbihnZW9tKXt0aGlzLmNicj1uZXcganN0cy5wcmVjaXNpb24uQ29tbW9uQml0c1JlbW92ZXIoKTt0aGlzLmNici5hZGQodGhpcy5nZW9tWzBdKTt0aGlzLmNici5hZGQodGhpcy5nZW9tWzFdKTt2YXIgcmVtR2VvbT1bXTtyZW1HZW9tWzBdPWNici5yZW1vdmVDb21tb25CaXRzKHRoaXMuZ2VvbVswXS5jbG9uZSgpKTtyZW1HZW9tWzFdPWNici5yZW1vdmVDb21tb25CaXRzKHRoaXMuZ2VvbVsxXS5jbG9uZSgpKTtyZXR1cm4gcmVtR2VvbTt9O2pzdHMub3BlcmF0aW9uLm92ZXJsYXkuc25hcC5TbmFwT3ZlcmxheU9wPVNuYXBPdmVybGF5T3A7fSkoKTtqc3RzLmdlb21ncmFwaC5pbmRleC5FZGdlU2V0SW50ZXJzZWN0b3I9ZnVuY3Rpb24oKXt9O2pzdHMuZ2VvbWdyYXBoLmluZGV4LkVkZ2VTZXRJbnRlcnNlY3Rvci5wcm90b3R5cGUuY29tcHV0ZUludGVyc2VjdGlvbnM9ZnVuY3Rpb24oZWRnZXMsc2ksdGVzdEFsbFNlZ21lbnRzKXt0aHJvdyBuZXcganN0cy5lcnJvci5BYnN0cmFjdE1ldGhvZEludm9jYXRpb25FcnJvcigpO307anN0cy5nZW9tZ3JhcGguaW5kZXguRWRnZVNldEludGVyc2VjdG9yLnByb3RvdHlwZS5jb21wdXRlSW50ZXJzZWN0aW9uczI9ZnVuY3Rpb24oZWRnZXMwLGVkZ2VzMSxzaSl7dGhyb3cgbmV3IGpzdHMuZXJyb3IuQWJzdHJhY3RNZXRob2RJbnZvY2F0aW9uRXJyb3IoKTt9O2pzdHMuZ2VvbWdyYXBoLmluZGV4LlNpbXBsZU1DU3dlZXBMaW5lSW50ZXJzZWN0b3I9ZnVuY3Rpb24oKXt0aGlzLmV2ZW50cz1bXTt9O2pzdHMuZ2VvbWdyYXBoLmluZGV4LlNpbXBsZU1DU3dlZXBMaW5lSW50ZXJzZWN0b3IucHJvdG90eXBlPW5ldyBqc3RzLmdlb21ncmFwaC5pbmRleC5FZGdlU2V0SW50ZXJzZWN0b3IoKTtqc3RzLmdlb21ncmFwaC5pbmRleC5TaW1wbGVNQ1N3ZWVwTGluZUludGVyc2VjdG9yLnByb3RvdHlwZS5ldmVudHM9bnVsbDtqc3RzLmdlb21ncmFwaC5pbmRleC5TaW1wbGVNQ1N3ZWVwTGluZUludGVyc2VjdG9yLnByb3RvdHlwZS5uT3ZlcmxhcHM9MDtqc3RzLmdlb21ncmFwaC5pbmRleC5TaW1wbGVNQ1N3ZWVwTGluZUludGVyc2VjdG9yLnByb3RvdHlwZS5jb21wdXRlSW50ZXJzZWN0aW9ucz1mdW5jdGlvbihlZGdlcyxzaSx0ZXN0QWxsU2VnbWVudHMpe2lmKHNpIGluc3RhbmNlb2YgamF2YXNjcmlwdC51dGlsLkxpc3Qpe3RoaXMuY29tcHV0ZUludGVyc2VjdGlvbnMyLmFwcGx5KHRoaXMsYXJndW1lbnRzKTtyZXR1cm47fVxuaWYodGVzdEFsbFNlZ21lbnRzKXt0aGlzLmFkZExpc3QyKGVkZ2VzLG51bGwpO31lbHNle3RoaXMuYWRkTGlzdChlZGdlcyk7fVxudGhpcy5jb21wdXRlSW50ZXJzZWN0aW9uczMoc2kpO307anN0cy5nZW9tZ3JhcGguaW5kZXguU2ltcGxlTUNTd2VlcExpbmVJbnRlcnNlY3Rvci5wcm90b3R5cGUuY29tcHV0ZUludGVyc2VjdGlvbnMyPWZ1bmN0aW9uKGVkZ2VzMCxlZGdlczEsc2kpe3RoaXMuYWRkTGlzdDIoZWRnZXMwLGVkZ2VzMCk7dGhpcy5hZGRMaXN0MihlZGdlczEsZWRnZXMxKTt0aGlzLmNvbXB1dGVJbnRlcnNlY3Rpb25zMyhzaSk7fTtqc3RzLmdlb21ncmFwaC5pbmRleC5TaW1wbGVNQ1N3ZWVwTGluZUludGVyc2VjdG9yLnByb3RvdHlwZS5hZGQ9ZnVuY3Rpb24oZWRnZSxlZGdlU2V0KXtpZihlZGdlIGluc3RhbmNlb2YgamF2YXNjcmlwdC51dGlsLkxpc3Qpe3RoaXMuYWRkTGlzdC5hcHBseSh0aGlzLGFyZ3VtZW50cyk7cmV0dXJuO31cbnZhciBtY2U9ZWRnZS5nZXRNb25vdG9uZUNoYWluRWRnZSgpO3ZhciBzdGFydEluZGV4PW1jZS5nZXRTdGFydEluZGV4ZXMoKTtmb3IodmFyIGk9MDtpPHN0YXJ0SW5kZXgubGVuZ3RoLTE7aSsrKXt2YXIgbWM9bmV3IGpzdHMuZ2VvbWdyYXBoLmluZGV4Lk1vbm90b25lQ2hhaW4obWNlLGkpO3ZhciBpbnNlcnRFdmVudD1uZXcganN0cy5nZW9tZ3JhcGguaW5kZXguU3dlZXBMaW5lRXZlbnQobWNlLmdldE1pblgoaSksbWMsZWRnZVNldCk7dGhpcy5ldmVudHMucHVzaChpbnNlcnRFdmVudCk7dGhpcy5ldmVudHMucHVzaChuZXcganN0cy5nZW9tZ3JhcGguaW5kZXguU3dlZXBMaW5lRXZlbnQobWNlLmdldE1heFgoaSksaW5zZXJ0RXZlbnQpKTt9fTtqc3RzLmdlb21ncmFwaC5pbmRleC5TaW1wbGVNQ1N3ZWVwTGluZUludGVyc2VjdG9yLnByb3RvdHlwZS5hZGRMaXN0PWZ1bmN0aW9uKGVkZ2VzKXtmb3IodmFyIGk9ZWRnZXMuaXRlcmF0b3IoKTtpLmhhc05leHQoKTspe3ZhciBlZGdlPWkubmV4dCgpO3RoaXMuYWRkKGVkZ2UsZWRnZSk7fX07anN0cy5nZW9tZ3JhcGguaW5kZXguU2ltcGxlTUNTd2VlcExpbmVJbnRlcnNlY3Rvci5wcm90b3R5cGUuYWRkTGlzdDI9ZnVuY3Rpb24oZWRnZXMsZWRnZVNldCl7Zm9yKHZhciBpPWVkZ2VzLml0ZXJhdG9yKCk7aS5oYXNOZXh0KCk7KXt2YXIgZWRnZT1pLm5leHQoKTt0aGlzLmFkZChlZGdlLGVkZ2VTZXQpO319O2pzdHMuZ2VvbWdyYXBoLmluZGV4LlNpbXBsZU1DU3dlZXBMaW5lSW50ZXJzZWN0b3IucHJvdG90eXBlLnByZXBhcmVFdmVudHM9ZnVuY3Rpb24oKXt0aGlzLmV2ZW50cy5zb3J0KGZ1bmN0aW9uKGEsYil7cmV0dXJuIGEuY29tcGFyZVRvKGIpO30pO2Zvcih2YXIgaT0wO2k8dGhpcy5ldmVudHMubGVuZ3RoO2krKyl7dmFyIGV2PXRoaXMuZXZlbnRzW2ldO2lmKGV2LmlzRGVsZXRlKCkpe2V2LmdldEluc2VydEV2ZW50KCkuc2V0RGVsZXRlRXZlbnRJbmRleChpKTt9fX07anN0cy5nZW9tZ3JhcGguaW5kZXguU2ltcGxlTUNTd2VlcExpbmVJbnRlcnNlY3Rvci5wcm90b3R5cGUuY29tcHV0ZUludGVyc2VjdGlvbnMzPWZ1bmN0aW9uKHNpKXt0aGlzLm5PdmVybGFwcz0wO3RoaXMucHJlcGFyZUV2ZW50cygpO2Zvcih2YXIgaT0wO2k8dGhpcy5ldmVudHMubGVuZ3RoO2krKyl7dmFyIGV2PXRoaXMuZXZlbnRzW2ldO2lmKGV2LmlzSW5zZXJ0KCkpe3RoaXMucHJvY2Vzc092ZXJsYXBzKGksZXYuZ2V0RGVsZXRlRXZlbnRJbmRleCgpLGV2LHNpKTt9fX07anN0cy5nZW9tZ3JhcGguaW5kZXguU2ltcGxlTUNTd2VlcExpbmVJbnRlcnNlY3Rvci5wcm90b3R5cGUucHJvY2Vzc092ZXJsYXBzPWZ1bmN0aW9uKHN0YXJ0LGVuZCxldjAsc2kpe3ZhciBtYzA9ZXYwLmdldE9iamVjdCgpO2Zvcih2YXIgaT1zdGFydDtpPGVuZDtpKyspe3ZhciBldjE9dGhpcy5ldmVudHNbaV07aWYoZXYxLmlzSW5zZXJ0KCkpe3ZhciBtYzE9ZXYxLmdldE9iamVjdCgpO2lmKCFldjAuaXNTYW1lTGFiZWwoZXYxKSl7bWMwLmNvbXB1dGVJbnRlcnNlY3Rpb25zKG1jMSxzaSk7dGhpcy5uT3ZlcmxhcHMrKzt9fX19O2pzdHMuYWxnb3JpdGhtLmxvY2F0ZS5TaW1wbGVQb2ludEluQXJlYUxvY2F0b3I9ZnVuY3Rpb24oZ2VvbSl7dGhpcy5nZW9tPWdlb207fTtqc3RzLmFsZ29yaXRobS5sb2NhdGUuU2ltcGxlUG9pbnRJbkFyZWFMb2NhdG9yLmxvY2F0ZT1mdW5jdGlvbihwLGdlb20pe2lmKGdlb20uaXNFbXB0eSgpKVxucmV0dXJuIGpzdHMuZ2VvbS5Mb2NhdGlvbi5FWFRFUklPUjtpZihqc3RzLmFsZ29yaXRobS5sb2NhdGUuU2ltcGxlUG9pbnRJbkFyZWFMb2NhdG9yLmNvbnRhaW5zUG9pbnQocCxnZW9tKSlcbnJldHVybiBqc3RzLmdlb20uTG9jYXRpb24uSU5URVJJT1I7cmV0dXJuIGpzdHMuZ2VvbS5Mb2NhdGlvbi5FWFRFUklPUjt9O2pzdHMuYWxnb3JpdGhtLmxvY2F0ZS5TaW1wbGVQb2ludEluQXJlYUxvY2F0b3IuY29udGFpbnNQb2ludD1mdW5jdGlvbihwLGdlb20pe2lmKGdlb20gaW5zdGFuY2VvZiBqc3RzLmdlb20uUG9seWdvbil7cmV0dXJuIGpzdHMuYWxnb3JpdGhtLmxvY2F0ZS5TaW1wbGVQb2ludEluQXJlYUxvY2F0b3IuY29udGFpbnNQb2ludEluUG9seWdvbihwLGdlb20pO31lbHNlIGlmKGdlb20gaW5zdGFuY2VvZiBqc3RzLmdlb20uR2VvbWV0cnlDb2xsZWN0aW9ufHxnZW9tIGluc3RhbmNlb2YganN0cy5nZW9tLk11bHRpUG9pbnR8fGdlb20gaW5zdGFuY2VvZiBqc3RzLmdlb20uTXVsdGlMaW5lU3RyaW5nfHxnZW9tIGluc3RhbmNlb2YganN0cy5nZW9tLk11bHRpUG9seWdvbil7Zm9yKHZhciBpPTA7aTxnZW9tLmdlb21ldHJpZXMubGVuZ3RoO2krKyl7dmFyIGcyPWdlb20uZ2VvbWV0cmllc1tpXTtpZihnMiE9PWdlb20pXG5pZihqc3RzLmFsZ29yaXRobS5sb2NhdGUuU2ltcGxlUG9pbnRJbkFyZWFMb2NhdG9yLmNvbnRhaW5zUG9pbnQocCxnMikpXG5yZXR1cm4gdHJ1ZTt9fVxucmV0dXJuIGZhbHNlO307anN0cy5hbGdvcml0aG0ubG9jYXRlLlNpbXBsZVBvaW50SW5BcmVhTG9jYXRvci5jb250YWluc1BvaW50SW5Qb2x5Z29uPWZ1bmN0aW9uKHAscG9seSl7aWYocG9seS5pc0VtcHR5KCkpXG5yZXR1cm4gZmFsc2U7dmFyIHNoZWxsPXBvbHkuZ2V0RXh0ZXJpb3JSaW5nKCk7aWYoIWpzdHMuYWxnb3JpdGhtLmxvY2F0ZS5TaW1wbGVQb2ludEluQXJlYUxvY2F0b3IuaXNQb2ludEluUmluZyhwLHNoZWxsKSlcbnJldHVybiBmYWxzZTtmb3IodmFyIGk9MDtpPHBvbHkuZ2V0TnVtSW50ZXJpb3JSaW5nKCk7aSsrKXt2YXIgaG9sZT1wb2x5LmdldEludGVyaW9yUmluZ04oaSk7aWYoanN0cy5hbGdvcml0aG0ubG9jYXRlLlNpbXBsZVBvaW50SW5BcmVhTG9jYXRvci5pc1BvaW50SW5SaW5nKHAsaG9sZSkpXG5yZXR1cm4gZmFsc2U7fVxucmV0dXJuIHRydWU7fTtqc3RzLmFsZ29yaXRobS5sb2NhdGUuU2ltcGxlUG9pbnRJbkFyZWFMb2NhdG9yLmlzUG9pbnRJblJpbmc9ZnVuY3Rpb24ocCxyaW5nKXtpZighcmluZy5nZXRFbnZlbG9wZUludGVybmFsKCkuaW50ZXJzZWN0cyhwKSlcbnJldHVybiBmYWxzZTtyZXR1cm4ganN0cy5hbGdvcml0aG0uQ0dBbGdvcml0aG1zLmlzUG9pbnRJblJpbmcocCxyaW5nLmdldENvb3JkaW5hdGVzKCkpO307anN0cy5hbGdvcml0aG0ubG9jYXRlLlNpbXBsZVBvaW50SW5BcmVhTG9jYXRvci5wcm90b3R5cGUuZ2VvbT1udWxsO2pzdHMuYWxnb3JpdGhtLmxvY2F0ZS5TaW1wbGVQb2ludEluQXJlYUxvY2F0b3IucHJvdG90eXBlLmxvY2F0ZT1mdW5jdGlvbihwKXtyZXR1cm4ganN0cy5hbGdvcml0aG0ubG9jYXRlLlNpbXBsZVBvaW50SW5BcmVhTG9jYXRvci5sb2NhdGUocCxnZW9tKTt9OyhmdW5jdGlvbigpe3ZhciBMb2NhdGlvbj1qc3RzLmdlb20uTG9jYXRpb247dmFyIFBvc2l0aW9uPWpzdHMuZ2VvbWdyYXBoLlBvc2l0aW9uO3ZhciBFZGdlRW5kU3Rhcj1qc3RzLmdlb21ncmFwaC5FZGdlRW5kU3Rhcjt2YXIgQXNzZXJ0PWpzdHMudXRpbC5Bc3NlcnQ7anN0cy5nZW9tZ3JhcGguRGlyZWN0ZWRFZGdlU3Rhcj1mdW5jdGlvbigpe2pzdHMuZ2VvbWdyYXBoLkVkZ2VFbmRTdGFyLmNhbGwodGhpcyk7fTtqc3RzLmdlb21ncmFwaC5EaXJlY3RlZEVkZ2VTdGFyLnByb3RvdHlwZT1uZXcgRWRnZUVuZFN0YXIoKTtqc3RzLmdlb21ncmFwaC5EaXJlY3RlZEVkZ2VTdGFyLmNvbnN0cnVjdG9yPWpzdHMuZ2VvbWdyYXBoLkRpcmVjdGVkRWRnZVN0YXI7anN0cy5nZW9tZ3JhcGguRGlyZWN0ZWRFZGdlU3Rhci5wcm90b3R5cGUucmVzdWx0QXJlYUVkZ2VMaXN0PW51bGw7anN0cy5nZW9tZ3JhcGguRGlyZWN0ZWRFZGdlU3Rhci5wcm90b3R5cGUubGFiZWw9bnVsbDtqc3RzLmdlb21ncmFwaC5EaXJlY3RlZEVkZ2VTdGFyLnByb3RvdHlwZS5pbnNlcnQ9ZnVuY3Rpb24oZWUpe3ZhciBkZT1lZTt0aGlzLmluc2VydEVkZ2VFbmQoZGUsZGUpO307anN0cy5nZW9tZ3JhcGguRGlyZWN0ZWRFZGdlU3Rhci5wcm90b3R5cGUuZ2V0TGFiZWw9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5sYWJlbDt9O2pzdHMuZ2VvbWdyYXBoLkRpcmVjdGVkRWRnZVN0YXIucHJvdG90eXBlLmdldE91dGdvaW5nRGVncmVlPWZ1bmN0aW9uKCl7dmFyIGRlZ3JlZT0wO2Zvcih2YXIgaXQ9dGhpcy5pdGVyYXRvcigpO2l0Lmhhc05leHQoKTspe3ZhciBkZT1pdC5uZXh0KCk7aWYoZGUuaXNJblJlc3VsdCgpKVxuZGVncmVlKys7fVxucmV0dXJuIGRlZ3JlZTt9O2pzdHMuZ2VvbWdyYXBoLkRpcmVjdGVkRWRnZVN0YXIucHJvdG90eXBlLmdldE91dGdvaW5nRGVncmVlPWZ1bmN0aW9uKGVyKXt2YXIgZGVncmVlPTA7Zm9yKHZhciBpdD10aGlzLml0ZXJhdG9yKCk7aXQuaGFzTmV4dCgpOyl7dmFyIGRlPWl0Lm5leHQoKTtpZihkZS5nZXRFZGdlUmluZygpPT09ZXIpXG5kZWdyZWUrKzt9XG5yZXR1cm4gZGVncmVlO307anN0cy5nZW9tZ3JhcGguRGlyZWN0ZWRFZGdlU3Rhci5wcm90b3R5cGUuZ2V0UmlnaHRtb3N0RWRnZT1mdW5jdGlvbigpe3ZhciBlZGdlcz10aGlzLmdldEVkZ2VzKCk7dmFyIHNpemU9ZWRnZXMuc2l6ZSgpO2lmKHNpemU8MSlcbnJldHVybiBudWxsO3ZhciBkZTA9ZWRnZXMuZ2V0KDApO2lmKHNpemU9PTEpXG5yZXR1cm4gZGUwO3ZhciBkZUxhc3Q9ZWRnZXMuZ2V0KHNpemUtMSk7dmFyIHF1YWQwPWRlMC5nZXRRdWFkcmFudCgpO3ZhciBxdWFkMT1kZUxhc3QuZ2V0UXVhZHJhbnQoKTtpZihqc3RzLmdlb21ncmFwaC5RdWFkcmFudC5pc05vcnRoZXJuKHF1YWQwKSYmanN0cy5nZW9tZ3JhcGguUXVhZHJhbnQuaXNOb3J0aGVybihxdWFkMSkpXG5yZXR1cm4gZGUwO2Vsc2UgaWYoIWpzdHMuZ2VvbWdyYXBoLlF1YWRyYW50LmlzTm9ydGhlcm4ocXVhZDApJiYhanN0cy5nZW9tZ3JhcGguUXVhZHJhbnQuaXNOb3J0aGVybihxdWFkMSkpXG5yZXR1cm4gZGVMYXN0O2Vsc2V7dmFyIG5vbkhvcml6b250YWxFZGdlPW51bGw7aWYoZGUwLmdldER5KCkhPTApXG5yZXR1cm4gZGUwO2Vsc2UgaWYoZGVMYXN0LmdldER5KCkhPTApXG5yZXR1cm4gZGVMYXN0O31cbkFzc2VydC5zaG91bGROZXZlclJlYWNoSGVyZSgnZm91bmQgdHdvIGhvcml6b250YWwgZWRnZXMgaW5jaWRlbnQgb24gbm9kZScpO3JldHVybiBudWxsO307anN0cy5nZW9tZ3JhcGguRGlyZWN0ZWRFZGdlU3Rhci5wcm90b3R5cGUuY29tcHV0ZUxhYmVsbGluZz1mdW5jdGlvbihnZW9tKXtFZGdlRW5kU3Rhci5wcm90b3R5cGUuY29tcHV0ZUxhYmVsbGluZy5jYWxsKHRoaXMsZ2VvbSk7dGhpcy5sYWJlbD1uZXcganN0cy5nZW9tZ3JhcGguTGFiZWwoTG9jYXRpb24uTk9ORSk7Zm9yKHZhciBpdD10aGlzLml0ZXJhdG9yKCk7aXQuaGFzTmV4dCgpOyl7dmFyIGVlPWl0Lm5leHQoKTt2YXIgZT1lZS5nZXRFZGdlKCk7dmFyIGVMYWJlbD1lLmdldExhYmVsKCk7Zm9yKHZhciBpPTA7aTwyO2krKyl7dmFyIGVMb2M9ZUxhYmVsLmdldExvY2F0aW9uKGkpO2lmKGVMb2M9PT1Mb2NhdGlvbi5JTlRFUklPUnx8ZUxvYz09PUxvY2F0aW9uLkJPVU5EQVJZKVxudGhpcy5sYWJlbC5zZXRMb2NhdGlvbihpLExvY2F0aW9uLklOVEVSSU9SKTt9fX07anN0cy5nZW9tZ3JhcGguRGlyZWN0ZWRFZGdlU3Rhci5wcm90b3R5cGUubWVyZ2VTeW1MYWJlbHM9ZnVuY3Rpb24oKXtmb3IodmFyIGl0PXRoaXMuaXRlcmF0b3IoKTtpdC5oYXNOZXh0KCk7KXt2YXIgZGU9aXQubmV4dCgpO3ZhciBsYWJlbD1kZS5nZXRMYWJlbCgpO2xhYmVsLm1lcmdlKGRlLmdldFN5bSgpLmdldExhYmVsKCkpO319O2pzdHMuZ2VvbWdyYXBoLkRpcmVjdGVkRWRnZVN0YXIucHJvdG90eXBlLnVwZGF0ZUxhYmVsbGluZz1mdW5jdGlvbihub2RlTGFiZWwpe2Zvcih2YXIgaXQ9dGhpcy5pdGVyYXRvcigpO2l0Lmhhc05leHQoKTspe3ZhciBkZT1pdC5uZXh0KCk7dmFyIGxhYmVsPWRlLmdldExhYmVsKCk7bGFiZWwuc2V0QWxsTG9jYXRpb25zSWZOdWxsKDAsbm9kZUxhYmVsLmdldExvY2F0aW9uKDApKTtsYWJlbC5zZXRBbGxMb2NhdGlvbnNJZk51bGwoMSxub2RlTGFiZWwuZ2V0TG9jYXRpb24oMSkpO319O2pzdHMuZ2VvbWdyYXBoLkRpcmVjdGVkRWRnZVN0YXIucHJvdG90eXBlLmdldFJlc3VsdEFyZWFFZGdlcz1mdW5jdGlvbigpe2lmKHRoaXMucmVzdWx0QXJlYUVkZ2VMaXN0IT09bnVsbClcbnJldHVybiB0aGlzLnJlc3VsdEFyZWFFZGdlTGlzdDt0aGlzLnJlc3VsdEFyZWFFZGdlTGlzdD1uZXcgamF2YXNjcmlwdC51dGlsLkFycmF5TGlzdCgpO2Zvcih2YXIgaXQ9dGhpcy5pdGVyYXRvcigpO2l0Lmhhc05leHQoKTspe3ZhciBkZT1pdC5uZXh0KCk7aWYoZGUuaXNJblJlc3VsdCgpfHxkZS5nZXRTeW0oKS5pc0luUmVzdWx0KCkpXG50aGlzLnJlc3VsdEFyZWFFZGdlTGlzdC5hZGQoZGUpO31cbnJldHVybiB0aGlzLnJlc3VsdEFyZWFFZGdlTGlzdDt9O2pzdHMuZ2VvbWdyYXBoLkRpcmVjdGVkRWRnZVN0YXIucHJvdG90eXBlLlNDQU5OSU5HX0ZPUl9JTkNPTUlORz0xO2pzdHMuZ2VvbWdyYXBoLkRpcmVjdGVkRWRnZVN0YXIucHJvdG90eXBlLkxJTktJTkdfVE9fT1VUR09JTkc9Mjtqc3RzLmdlb21ncmFwaC5EaXJlY3RlZEVkZ2VTdGFyLnByb3RvdHlwZS5saW5rUmVzdWx0RGlyZWN0ZWRFZGdlcz1mdW5jdGlvbigpe3RoaXMuZ2V0UmVzdWx0QXJlYUVkZ2VzKCk7dmFyIGZpcnN0T3V0PW51bGw7dmFyIGluY29taW5nPW51bGw7dmFyIHN0YXRlPXRoaXMuU0NBTk5JTkdfRk9SX0lOQ09NSU5HO2Zvcih2YXIgaT0wO2k8dGhpcy5yZXN1bHRBcmVhRWRnZUxpc3Quc2l6ZSgpO2krKyl7dmFyIG5leHRPdXQ9dGhpcy5yZXN1bHRBcmVhRWRnZUxpc3QuZ2V0KGkpO3ZhciBuZXh0SW49bmV4dE91dC5nZXRTeW0oKTtpZighbmV4dE91dC5nZXRMYWJlbCgpLmlzQXJlYSgpKVxuY29udGludWU7aWYoZmlyc3RPdXQ9PT1udWxsJiZuZXh0T3V0LmlzSW5SZXN1bHQoKSlcbmZpcnN0T3V0PW5leHRPdXQ7c3dpdGNoKHN0YXRlKXtjYXNlIHRoaXMuU0NBTk5JTkdfRk9SX0lOQ09NSU5HOmlmKCFuZXh0SW4uaXNJblJlc3VsdCgpKVxuY29udGludWU7aW5jb21pbmc9bmV4dEluO3N0YXRlPXRoaXMuTElOS0lOR19UT19PVVRHT0lORzticmVhaztjYXNlIHRoaXMuTElOS0lOR19UT19PVVRHT0lORzppZighbmV4dE91dC5pc0luUmVzdWx0KCkpXG5jb250aW51ZTtpbmNvbWluZy5zZXROZXh0KG5leHRPdXQpO3N0YXRlPXRoaXMuU0NBTk5JTkdfRk9SX0lOQ09NSU5HO2JyZWFrO319XG5pZihzdGF0ZT09PXRoaXMuTElOS0lOR19UT19PVVRHT0lORyl7aWYoZmlyc3RPdXQ9PT1udWxsKVxudGhyb3cgbmV3IGpzdHMuZXJyb3IuVG9wb2xvZ3lFcnJvcignbm8gb3V0Z29pbmcgZGlyRWRnZSBmb3VuZCcsdGhpcy5nZXRDb29yZGluYXRlKCkpO0Fzc2VydC5pc1RydWUoZmlyc3RPdXQuaXNJblJlc3VsdCgpLCd1bmFibGUgdG8gbGluayBsYXN0IGluY29taW5nIGRpckVkZ2UnKTtpbmNvbWluZy5zZXROZXh0KGZpcnN0T3V0KTt9fTtqc3RzLmdlb21ncmFwaC5EaXJlY3RlZEVkZ2VTdGFyLnByb3RvdHlwZS5saW5rTWluaW1hbERpcmVjdGVkRWRnZXM9ZnVuY3Rpb24oZXIpe3ZhciBmaXJzdE91dD1udWxsO3ZhciBpbmNvbWluZz1udWxsO3ZhciBzdGF0ZT10aGlzLlNDQU5OSU5HX0ZPUl9JTkNPTUlORztmb3IodmFyIGk9dGhpcy5yZXN1bHRBcmVhRWRnZUxpc3Quc2l6ZSgpLTE7aT49MDtpLS0pe3ZhciBuZXh0T3V0PXRoaXMucmVzdWx0QXJlYUVkZ2VMaXN0LmdldChpKTt2YXIgbmV4dEluPW5leHRPdXQuZ2V0U3ltKCk7aWYoZmlyc3RPdXQ9PT1udWxsJiZuZXh0T3V0LmdldEVkZ2VSaW5nKCk9PT1lcilcbmZpcnN0T3V0PW5leHRPdXQ7c3dpdGNoKHN0YXRlKXtjYXNlIHRoaXMuU0NBTk5JTkdfRk9SX0lOQ09NSU5HOmlmKG5leHRJbi5nZXRFZGdlUmluZygpIT1lcilcbmNvbnRpbnVlO2luY29taW5nPW5leHRJbjtzdGF0ZT10aGlzLkxJTktJTkdfVE9fT1VUR09JTkc7YnJlYWs7Y2FzZSB0aGlzLkxJTktJTkdfVE9fT1VUR09JTkc6aWYobmV4dE91dC5nZXRFZGdlUmluZygpIT09ZXIpXG5jb250aW51ZTtpbmNvbWluZy5zZXROZXh0TWluKG5leHRPdXQpO3N0YXRlPXRoaXMuU0NBTk5JTkdfRk9SX0lOQ09NSU5HO2JyZWFrO319XG5pZihzdGF0ZT09PXRoaXMuTElOS0lOR19UT19PVVRHT0lORyl7QXNzZXJ0LmlzVHJ1ZShmaXJzdE91dCE9PW51bGwsJ2ZvdW5kIG51bGwgZm9yIGZpcnN0IG91dGdvaW5nIGRpckVkZ2UnKTtBc3NlcnQuaXNUcnVlKGZpcnN0T3V0LmdldEVkZ2VSaW5nKCk9PT1lciwndW5hYmxlIHRvIGxpbmsgbGFzdCBpbmNvbWluZyBkaXJFZGdlJyk7aW5jb21pbmcuc2V0TmV4dE1pbihmaXJzdE91dCk7fX07anN0cy5nZW9tZ3JhcGguRGlyZWN0ZWRFZGdlU3Rhci5wcm90b3R5cGUubGlua0FsbERpcmVjdGVkRWRnZXM9ZnVuY3Rpb24oKXt0aGlzLmdldEVkZ2VzKCk7dmFyIHByZXZPdXQ9bnVsbDt2YXIgZmlyc3RJbj1udWxsO2Zvcih2YXIgaT10aGlzLmVkZ2VMaXN0LnNpemUoKS0xO2k+PTA7aS0tKXt2YXIgbmV4dE91dD10aGlzLmVkZ2VMaXN0LmdldChpKTt2YXIgbmV4dEluPW5leHRPdXQuZ2V0U3ltKCk7aWYoZmlyc3RJbj09PW51bGwpXG5maXJzdEluPW5leHRJbjtpZihwcmV2T3V0IT09bnVsbClcbm5leHRJbi5zZXROZXh0KHByZXZPdXQpO3ByZXZPdXQ9bmV4dE91dDt9XG5maXJzdEluLnNldE5leHQocHJldk91dCk7fTtqc3RzLmdlb21ncmFwaC5EaXJlY3RlZEVkZ2VTdGFyLnByb3RvdHlwZS5maW5kQ292ZXJlZExpbmVFZGdlcz1mdW5jdGlvbigpe3ZhciBzdGFydExvYz1Mb2NhdGlvbi5OT05FO2Zvcih2YXIgaXQ9dGhpcy5pdGVyYXRvcigpO2l0Lmhhc05leHQoKTspe3ZhciBuZXh0T3V0PWl0Lm5leHQoKTt2YXIgbmV4dEluPW5leHRPdXQuZ2V0U3ltKCk7aWYoIW5leHRPdXQuaXNMaW5lRWRnZSgpKXtpZihuZXh0T3V0LmlzSW5SZXN1bHQoKSl7c3RhcnRMb2M9TG9jYXRpb24uSU5URVJJT1I7YnJlYWs7fVxuaWYobmV4dEluLmlzSW5SZXN1bHQoKSl7c3RhcnRMb2M9TG9jYXRpb24uRVhURVJJT1I7YnJlYWs7fX19XG5pZihzdGFydExvYz09PUxvY2F0aW9uLk5PTkUpXG5yZXR1cm47dmFyIGN1cnJMb2M9c3RhcnRMb2M7Zm9yKHZhciBpdD10aGlzLml0ZXJhdG9yKCk7aXQuaGFzTmV4dCgpOyl7dmFyIG5leHRPdXQ9aXQubmV4dCgpO3ZhciBuZXh0SW49bmV4dE91dC5nZXRTeW0oKTtpZihuZXh0T3V0LmlzTGluZUVkZ2UoKSl7bmV4dE91dC5nZXRFZGdlKCkuc2V0Q292ZXJlZChjdXJyTG9jPT09TG9jYXRpb24uSU5URVJJT1IpO31lbHNle2lmKG5leHRPdXQuaXNJblJlc3VsdCgpKVxuY3VyckxvYz1Mb2NhdGlvbi5FWFRFUklPUjtpZihuZXh0SW4uaXNJblJlc3VsdCgpKVxuY3VyckxvYz1Mb2NhdGlvbi5JTlRFUklPUjt9fX07anN0cy5nZW9tZ3JhcGguRGlyZWN0ZWRFZGdlU3Rhci5wcm90b3R5cGUuY29tcHV0ZURlcHRocz1mdW5jdGlvbihkZSl7aWYoYXJndW1lbnRzLmxlbmd0aD09PTIpe3RoaXMuY29tcHV0ZURlcHRoczIuYXBwbHkodGhpcyxhcmd1bWVudHMpO3JldHVybjt9XG52YXIgZWRnZUluZGV4PXRoaXMuZmluZEluZGV4KGRlKTt2YXIgbGFiZWw9ZGUuZ2V0TGFiZWwoKTt2YXIgc3RhcnREZXB0aD1kZS5nZXREZXB0aChQb3NpdGlvbi5MRUZUKTt2YXIgdGFyZ2V0TGFzdERlcHRoPWRlLmdldERlcHRoKFBvc2l0aW9uLlJJR0hUKTt2YXIgbmV4dERlcHRoPXRoaXMuY29tcHV0ZURlcHRoczIoZWRnZUluZGV4KzEsdGhpcy5lZGdlTGlzdC5zaXplKCksc3RhcnREZXB0aCk7dmFyIGxhc3REZXB0aD10aGlzLmNvbXB1dGVEZXB0aHMyKDAsZWRnZUluZGV4LG5leHREZXB0aCk7aWYobGFzdERlcHRoIT10YXJnZXRMYXN0RGVwdGgpXG50aHJvdyBuZXcganN0cy5lcnJvci5Ub3BvbG9neUVycm9yKCdkZXB0aCBtaXNtYXRjaCBhdCAnK1xuZGUuZ2V0Q29vcmRpbmF0ZSgpKTt9O2pzdHMuZ2VvbWdyYXBoLkRpcmVjdGVkRWRnZVN0YXIucHJvdG90eXBlLmNvbXB1dGVEZXB0aHMyPWZ1bmN0aW9uKHN0YXJ0SW5kZXgsZW5kSW5kZXgsc3RhcnREZXB0aCl7dmFyIGN1cnJEZXB0aD1zdGFydERlcHRoO2Zvcih2YXIgaT1zdGFydEluZGV4O2k8ZW5kSW5kZXg7aSsrKXt2YXIgbmV4dERlPXRoaXMuZWRnZUxpc3QuZ2V0KGkpO3ZhciBsYWJlbD1uZXh0RGUuZ2V0TGFiZWwoKTtuZXh0RGUuc2V0RWRnZURlcHRocyhQb3NpdGlvbi5SSUdIVCxjdXJyRGVwdGgpO2N1cnJEZXB0aD1uZXh0RGUuZ2V0RGVwdGgoUG9zaXRpb24uTEVGVCk7fVxucmV0dXJuIGN1cnJEZXB0aDt9O30pKCk7anN0cy5hbGdvcml0aG0uQ2VudHJvaWRMaW5lPWZ1bmN0aW9uKCl7dGhpcy5jZW50U3VtPW5ldyBqc3RzLmdlb20uQ29vcmRpbmF0ZSgpO307anN0cy5hbGdvcml0aG0uQ2VudHJvaWRMaW5lLnByb3RvdHlwZS5jZW50U3VtPW51bGw7anN0cy5hbGdvcml0aG0uQ2VudHJvaWRMaW5lLnByb3RvdHlwZS50b3RhbExlbmd0aD0wLjA7anN0cy5hbGdvcml0aG0uQ2VudHJvaWRMaW5lLnByb3RvdHlwZS5hZGQ9ZnVuY3Rpb24oZ2VvbSl7aWYoZ2VvbSBpbnN0YW5jZW9mIEFycmF5KXt0aGlzLmFkZDIuYXBwbHkodGhpcyxhcmd1bWVudHMpO3JldHVybjt9XG5pZihnZW9tIGluc3RhbmNlb2YganN0cy5nZW9tLkxpbmVTdHJpbmcpe3RoaXMuYWRkKGdlb20uZ2V0Q29vcmRpbmF0ZXMoKSk7fWVsc2UgaWYoZ2VvbSBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5Qb2x5Z29uKXt2YXIgcG9seT1nZW9tO3RoaXMuYWRkKHBvbHkuZ2V0RXh0ZXJpb3JSaW5nKCkuZ2V0Q29vcmRpbmF0ZXMoKSk7Zm9yKHZhciBpPTA7aTxwb2x5LmdldE51bUludGVyaW9yUmluZygpO2krKyl7dGhpcy5hZGQocG9seS5nZXRJbnRlcmlvclJpbmdOKGkpLmdldENvb3JkaW5hdGVzKCkpO319ZWxzZSBpZihnZW9tIGluc3RhbmNlb2YganN0cy5nZW9tLkdlb21ldHJ5Q29sbGVjdGlvbnx8Z2VvbSBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5NdWx0aVBvaW50fHxnZW9tIGluc3RhbmNlb2YganN0cy5nZW9tLk11bHRpTGluZVN0cmluZ3x8Z2VvbSBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5NdWx0aVBvbHlnb24pe3ZhciBnYz1nZW9tO2Zvcih2YXIgaT0wO2k8Z2MuZ2V0TnVtR2VvbWV0cmllcygpO2krKyl7dGhpcy5hZGQoZ2MuZ2V0R2VvbWV0cnlOKGkpKTt9fX07anN0cy5hbGdvcml0aG0uQ2VudHJvaWRMaW5lLnByb3RvdHlwZS5nZXRDZW50cm9pZD1mdW5jdGlvbigpe3ZhciBjZW50PW5ldyBqc3RzLmdlb20uQ29vcmRpbmF0ZSgpO2NlbnQueD10aGlzLmNlbnRTdW0ueC90aGlzLnRvdGFsTGVuZ3RoO2NlbnQueT10aGlzLmNlbnRTdW0ueS90aGlzLnRvdGFsTGVuZ3RoO3JldHVybiBjZW50O307anN0cy5hbGdvcml0aG0uQ2VudHJvaWRMaW5lLnByb3RvdHlwZS5hZGQyPWZ1bmN0aW9uKHB0cyl7Zm9yKHZhciBpPTA7aTxwdHMubGVuZ3RoLTE7aSsrKXt2YXIgc2VnbWVudExlbj1wdHNbaV0uZGlzdGFuY2UocHRzW2krMV0pO3RoaXMudG90YWxMZW5ndGgrPXNlZ21lbnRMZW47dmFyIG1pZHg9KHB0c1tpXS54K3B0c1tpKzFdLngpLzI7dGhpcy5jZW50U3VtLngrPXNlZ21lbnRMZW4qbWlkeDt2YXIgbWlkeT0ocHRzW2ldLnkrcHRzW2krMV0ueSkvMjt0aGlzLmNlbnRTdW0ueSs9c2VnbWVudExlbiptaWR5O319O2pzdHMuaW5kZXguSW50ZXJ2YWxTaXplPWZ1bmN0aW9uKCl7fTtqc3RzLmluZGV4LkludGVydmFsU2l6ZS5NSU5fQklOQVJZX0VYUE9ORU5UPS01MDtqc3RzLmluZGV4LkludGVydmFsU2l6ZS5pc1plcm9XaWR0aD1mdW5jdGlvbihtaW4sbWF4KXt2YXIgd2lkdGg9bWF4LW1pbjtpZih3aWR0aD09PTAuMCl7cmV0dXJuIHRydWU7fVxudmFyIG1heEFicyxzY2FsZWRJbnRlcnZhbCxsZXZlbDttYXhBYnM9TWF0aC5tYXgoTWF0aC5hYnMobWluKSxNYXRoLmFicyhtYXgpKTtzY2FsZWRJbnRlcnZhbD13aWR0aC9tYXhBYnM7bGV2ZWw9anN0cy5pbmRleC5Eb3VibGVCaXRzLmV4cG9uZW50KHNjYWxlZEludGVydmFsKTtyZXR1cm4gbGV2ZWw8PWpzdHMuaW5kZXguSW50ZXJ2YWxTaXplLk1JTl9CSU5BUllfRVhQT05FTlQ7fTtqc3RzLmdlb21ncmFwaC5pbmRleC5TaW1wbGVFZGdlU2V0SW50ZXJzZWN0b3I9ZnVuY3Rpb24oKXt9O2pzdHMuZ2VvbWdyYXBoLmluZGV4LlNpbXBsZUVkZ2VTZXRJbnRlcnNlY3Rvci5wcm90b3R5cGU9bmV3IGpzdHMuZ2VvbWdyYXBoLmluZGV4LkVkZ2VTZXRJbnRlcnNlY3RvcigpO2pzdHMuZ2VvbWdyYXBoLmluZGV4LlNpbXBsZUVkZ2VTZXRJbnRlcnNlY3Rvci5wcm90b3R5cGUubk92ZXJsYXBzPTA7anN0cy5nZW9tZ3JhcGguaW5kZXguU2ltcGxlRWRnZVNldEludGVyc2VjdG9yLnByb3RvdHlwZS5jb21wdXRlSW50ZXJzZWN0aW9ucz1mdW5jdGlvbihlZGdlcyxzaSx0ZXN0QWxsU2VnbWVudHMpe2lmKHNpIGluc3RhbmNlb2YgamF2YXNjcmlwdC51dGlsLkxpc3Qpe3RoaXMuY29tcHV0ZUludGVyc2VjdGlvbnMyLmFwcGx5KHRoaXMsYXJndW1lbnRzKTtyZXR1cm47fVxudGhpcy5uT3ZlcmxhcHM9MDtmb3IodmFyIGkwPWVkZ2VzLml0ZXJhdG9yKCk7aTAuaGFzTmV4dCgpOyl7dmFyIGVkZ2UwPWkwLm5leHQoKTtmb3IodmFyIGkxPWVkZ2VzLml0ZXJhdG9yKCk7aTEuaGFzTmV4dCgpOyl7dmFyIGVkZ2UxPWkxLm5leHQoKTtpZih0ZXN0QWxsU2VnbWVudHN8fGVkZ2UwIT1lZGdlMSlcbnRoaXMuY29tcHV0ZUludGVyc2VjdHMoZWRnZTAsZWRnZTEsc2kpO319fTtqc3RzLmdlb21ncmFwaC5pbmRleC5TaW1wbGVFZGdlU2V0SW50ZXJzZWN0b3IucHJvdG90eXBlLmNvbXB1dGVJbnRlcnNlY3Rpb25zMj1mdW5jdGlvbihlZGdlczAsZWRnZXMxLHNpKXt0aGlzLm5PdmVybGFwcz0wO2Zvcih2YXIgaTA9ZWRnZXMwLml0ZXJhdG9yKCk7aTAuaGFzTmV4dCgpOyl7dmFyIGVkZ2UwPWkwLm5leHQoKTtmb3IodmFyIGkxPWVkZ2VzMS5pdGVyYXRvcigpO2kxLmhhc05leHQoKTspe3ZhciBlZGdlMT1pMS5uZXh0KCk7dGhpcy5jb21wdXRlSW50ZXJzZWN0cyhlZGdlMCxlZGdlMSxzaSk7fX19O2pzdHMuZ2VvbWdyYXBoLmluZGV4LlNpbXBsZUVkZ2VTZXRJbnRlcnNlY3Rvci5wcm90b3R5cGUuY29tcHV0ZUludGVyc2VjdHM9ZnVuY3Rpb24oZTAsZTEsc2kpe3ZhciBwdHMwPWUwLmdldENvb3JkaW5hdGVzKCk7dmFyIHB0czE9ZTEuZ2V0Q29vcmRpbmF0ZXMoKTt2YXIgaTAsaTE7Zm9yKGkwPTA7aTA8cHRzMC5sZW5ndGgtMTtpMCsrKXtmb3IoaTE9MDtpMTxwdHMxLmxlbmd0aC0xO2kxKyspe3NpLmFkZEludGVyc2VjdGlvbnMoZTAsaTAsZTEsaTEpO319fTtqc3RzLmdlb21ncmFwaC5FZGdlPWZ1bmN0aW9uKHB0cyxsYWJlbCl7dGhpcy5wdHM9cHRzO3RoaXMubGFiZWw9bGFiZWw7dGhpcy5laUxpc3Q9bmV3IGpzdHMuZ2VvbWdyYXBoLkVkZ2VJbnRlcnNlY3Rpb25MaXN0KHRoaXMpO3RoaXMuZGVwdGg9bmV3IGpzdHMuZ2VvbWdyYXBoLkRlcHRoKCk7fTtqc3RzLmdlb21ncmFwaC5FZGdlLnByb3RvdHlwZT1uZXcganN0cy5nZW9tZ3JhcGguR3JhcGhDb21wb25lbnQoKTtqc3RzLmdlb21ncmFwaC5FZGdlLmNvbnN0cnVjdG9yPWpzdHMuZ2VvbWdyYXBoLkVkZ2U7anN0cy5nZW9tZ3JhcGguRWRnZS51cGRhdGVJTT1mdW5jdGlvbihsYWJlbCxpbSl7aW0uc2V0QXRMZWFzdElmVmFsaWQobGFiZWwuZ2V0TG9jYXRpb24oMCxqc3RzLmdlb21ncmFwaC5Qb3NpdGlvbi5PTiksbGFiZWwuZ2V0TG9jYXRpb24oMSxqc3RzLmdlb21ncmFwaC5Qb3NpdGlvbi5PTiksMSk7aWYobGFiZWwuaXNBcmVhKCkpe2ltLnNldEF0TGVhc3RJZlZhbGlkKGxhYmVsLmdldExvY2F0aW9uKDAsanN0cy5nZW9tZ3JhcGguUG9zaXRpb24uTEVGVCksbGFiZWwuZ2V0TG9jYXRpb24oMSxqc3RzLmdlb21ncmFwaC5Qb3NpdGlvbi5MRUZUKSwyKTtpbS5zZXRBdExlYXN0SWZWYWxpZChsYWJlbC5nZXRMb2NhdGlvbigwLGpzdHMuZ2VvbWdyYXBoLlBvc2l0aW9uLlJJR0hUKSxsYWJlbC5nZXRMb2NhdGlvbigxLGpzdHMuZ2VvbWdyYXBoLlBvc2l0aW9uLlJJR0hUKSwyKTt9fTtqc3RzLmdlb21ncmFwaC5FZGdlLnByb3RvdHlwZS5wdHM9bnVsbDtqc3RzLmdlb21ncmFwaC5FZGdlLnByb3RvdHlwZS5lbnY9bnVsbDtqc3RzLmdlb21ncmFwaC5FZGdlLnByb3RvdHlwZS5uYW1lPW51bGw7anN0cy5nZW9tZ3JhcGguRWRnZS5wcm90b3R5cGUubWNlPW51bGw7anN0cy5nZW9tZ3JhcGguRWRnZS5wcm90b3R5cGUuX2lzSXNvbGF0ZWQ9dHJ1ZTtqc3RzLmdlb21ncmFwaC5FZGdlLnByb3RvdHlwZS5kZXB0aD1udWxsO2pzdHMuZ2VvbWdyYXBoLkVkZ2UucHJvdG90eXBlLmRlcHRoRGVsdGE9MDtqc3RzLmdlb21ncmFwaC5FZGdlLnByb3RvdHlwZS5laUxpc3Q9bnVsbDtqc3RzLmdlb21ncmFwaC5FZGdlLnByb3RvdHlwZS5nZXROdW1Qb2ludHM9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5wdHMubGVuZ3RoO307anN0cy5nZW9tZ3JhcGguRWRnZS5wcm90b3R5cGUuZ2V0RW52ZWxvcGU9ZnVuY3Rpb24oKXtpZih0aGlzLmVudj09PW51bGwpe3RoaXMuZW52PW5ldyBqc3RzLmdlb20uRW52ZWxvcGUoKTtmb3IodmFyIGk9MDtpPHRoaXMucHRzLmxlbmd0aDtpKyspe3RoaXMuZW52LmV4cGFuZFRvSW5jbHVkZShwdHNbaV0pO319XG5yZXR1cm4gZW52O307anN0cy5nZW9tZ3JhcGguRWRnZS5wcm90b3R5cGUuZ2V0RGVwdGg9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5kZXB0aDt9O2pzdHMuZ2VvbWdyYXBoLkVkZ2UucHJvdG90eXBlLmdldERlcHRoRGVsdGE9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5kZXB0aERlbHRhO307anN0cy5nZW9tZ3JhcGguRWRnZS5wcm90b3R5cGUuc2V0RGVwdGhEZWx0YT1mdW5jdGlvbihkZXB0aERlbHRhKXt0aGlzLmRlcHRoRGVsdGE9ZGVwdGhEZWx0YTt9O2pzdHMuZ2VvbWdyYXBoLkVkZ2UucHJvdG90eXBlLmdldENvb3JkaW5hdGVzPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMucHRzO307anN0cy5nZW9tZ3JhcGguRWRnZS5wcm90b3R5cGUuZ2V0Q29vcmRpbmF0ZT1mdW5jdGlvbihpKXtpZihpPT09dW5kZWZpbmVkKXtpZih0aGlzLnB0cy5sZW5ndGg+MCl7cmV0dXJuIHRoaXMucHRzWzBdO31lbHNle3JldHVybiBudWxsO319XG5yZXR1cm4gdGhpcy5wdHNbaV07fTtqc3RzLmdlb21ncmFwaC5FZGdlLnByb3RvdHlwZS5pc0Nsb3NlZD1mdW5jdGlvbigpe3JldHVybiB0aGlzLnB0c1swXS5lcXVhbHModGhpcy5wdHNbdGhpcy5wdHMubGVuZ3RoLTFdKTt9O2pzdHMuZ2VvbWdyYXBoLkVkZ2UucHJvdG90eXBlLnNldElzb2xhdGVkPWZ1bmN0aW9uKGlzSXNvbGF0ZWQpe3RoaXMuX2lzSXNvbGF0ZWQ9aXNJc29sYXRlZDt9O2pzdHMuZ2VvbWdyYXBoLkVkZ2UucHJvdG90eXBlLmlzSXNvbGF0ZWQ9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5faXNJc29sYXRlZDt9O2pzdHMuZ2VvbWdyYXBoLkVkZ2UucHJvdG90eXBlLmFkZEludGVyc2VjdGlvbnM9ZnVuY3Rpb24obGksc2VnbWVudEluZGV4LGdlb21JbmRleCl7Zm9yKHZhciBpPTA7aTxsaS5nZXRJbnRlcnNlY3Rpb25OdW0oKTtpKyspe3RoaXMuYWRkSW50ZXJzZWN0aW9uKGxpLHNlZ21lbnRJbmRleCxnZW9tSW5kZXgsaSk7fX07anN0cy5nZW9tZ3JhcGguRWRnZS5wcm90b3R5cGUuYWRkSW50ZXJzZWN0aW9uPWZ1bmN0aW9uKGxpLHNlZ21lbnRJbmRleCxnZW9tSW5kZXgsaW50SW5kZXgpe3ZhciBpbnRQdD1uZXcganN0cy5nZW9tLkNvb3JkaW5hdGUobGkuZ2V0SW50ZXJzZWN0aW9uKGludEluZGV4KSk7dmFyIG5vcm1hbGl6ZWRTZWdtZW50SW5kZXg9c2VnbWVudEluZGV4O3ZhciBkaXN0PWxpLmdldEVkZ2VEaXN0YW5jZShnZW9tSW5kZXgsaW50SW5kZXgpO3ZhciBuZXh0U2VnSW5kZXg9bm9ybWFsaXplZFNlZ21lbnRJbmRleCsxO2lmKG5leHRTZWdJbmRleDx0aGlzLnB0cy5sZW5ndGgpe3ZhciBuZXh0UHQ9dGhpcy5wdHNbbmV4dFNlZ0luZGV4XTtpZihpbnRQdC5lcXVhbHMyRChuZXh0UHQpKXtub3JtYWxpemVkU2VnbWVudEluZGV4PW5leHRTZWdJbmRleDtkaXN0PTAuMDt9fVxudmFyIGVpPXRoaXMuZWlMaXN0LmFkZChpbnRQdCxub3JtYWxpemVkU2VnbWVudEluZGV4LGRpc3QpO307anN0cy5nZW9tZ3JhcGguRWRnZS5wcm90b3R5cGUuZ2V0TWF4aW11bVNlZ21lbnRJbmRleD1mdW5jdGlvbigpe3JldHVybiB0aGlzLnB0cy5sZW5ndGgtMTt9O2pzdHMuZ2VvbWdyYXBoLkVkZ2UucHJvdG90eXBlLmdldEVkZ2VJbnRlcnNlY3Rpb25MaXN0PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZWlMaXN0O307anN0cy5nZW9tZ3JhcGguRWRnZS5wcm90b3R5cGUuZ2V0TW9ub3RvbmVDaGFpbkVkZ2U9ZnVuY3Rpb24oKXtpZih0aGlzLm1jZT09bnVsbCl7dGhpcy5tY2U9bmV3IGpzdHMuZ2VvbWdyYXBoLmluZGV4Lk1vbm90b25lQ2hhaW5FZGdlKHRoaXMpO31cbnJldHVybiB0aGlzLm1jZTt9O2pzdHMuZ2VvbWdyYXBoLkVkZ2UucHJvdG90eXBlLmlzQ2xvc2VkPWZ1bmN0aW9uKClcbntyZXR1cm4gdGhpcy5wdHNbMF0uZXF1YWxzKHRoaXMucHRzW3RoaXMucHRzLmxlbmd0aC0xXSk7fTtqc3RzLmdlb21ncmFwaC5FZGdlLnByb3RvdHlwZS5pc0NvbGxhcHNlZD1mdW5jdGlvbigpXG57aWYoIXRoaXMubGFiZWwuaXNBcmVhKCkpcmV0dXJuIGZhbHNlO2lmKHRoaXMucHRzLmxlbmd0aCE9MylyZXR1cm4gZmFsc2U7aWYodGhpcy5wdHNbMF0uZXF1YWxzKHRoaXMucHRzWzJdKSlyZXR1cm4gdHJ1ZTtyZXR1cm4gZmFsc2U7fTtqc3RzLmdlb21ncmFwaC5FZGdlLnByb3RvdHlwZS5nZXRDb2xsYXBzZWRFZGdlPWZ1bmN0aW9uKClcbnt2YXIgbmV3UHRzPVtdO25ld1B0c1swXT10aGlzLnB0c1swXTtuZXdQdHNbMV09dGhpcy5wdHNbMV07dmFyIG5ld2U9bmV3IGpzdHMuZ2VvbWdyYXBoLkVkZ2UobmV3UHRzLGpzdHMuZ2VvbWdyYXBoLkxhYmVsLnRvTGluZUxhYmVsKHRoaXMubGFiZWwpKTtyZXR1cm4gbmV3ZTt9O2pzdHMuZ2VvbWdyYXBoLkVkZ2UucHJvdG90eXBlLmNvbXB1dGVJTT1mdW5jdGlvbihpbSl7anN0cy5nZW9tZ3JhcGguRWRnZS51cGRhdGVJTSh0aGlzLmxhYmVsLGltKTt9O2pzdHMuZ2VvbWdyYXBoLkVkZ2UucHJvdG90eXBlLmlzUG9pbnR3aXNlRXF1YWw9ZnVuY3Rpb24oZSlcbntpZih0aGlzLnB0cy5sZW5ndGghPWUucHRzLmxlbmd0aClyZXR1cm4gZmFsc2U7Zm9yKHZhciBpPTA7aTx0aGlzLnB0cy5sZW5ndGg7aSsrKXtpZighdGhpcy5wdHNbaV0uZXF1YWxzMkQoZS5wdHNbaV0pKXtyZXR1cm4gZmFsc2U7fX1cbnJldHVybiB0cnVlO307anN0cy5ub2RpbmcuT2N0YW50PWZ1bmN0aW9uKCl7dGhyb3cganN0cy5lcnJvci5BYnN0cmFjdE1ldGhvZEludm9jYXRpb25FcnJvcigpO307anN0cy5ub2RpbmcuT2N0YW50Lm9jdGFudD1mdW5jdGlvbihkeCxkeSl7aWYoZHggaW5zdGFuY2VvZiBqc3RzLmdlb20uQ29vcmRpbmF0ZSl7cmV0dXJuIGpzdHMubm9kaW5nLk9jdGFudC5vY3RhbnQyLmFwcGx5KHRoaXMsYXJndW1lbnRzKTt9XG5pZihkeD09PTAuMCYmZHk9PT0wLjApXG50aHJvdyBuZXcganN0cy5lcnJvci5JbGxlZ2FsQXJndW1lbnRFcnJvcignQ2Fubm90IGNvbXB1dGUgdGhlIG9jdGFudCBmb3IgcG9pbnQgKCAnK2R4KycsICcrZHkrJyApJyk7dmFyIGFkeD1NYXRoLmFicyhkeCk7dmFyIGFkeT1NYXRoLmFicyhkeSk7aWYoZHg+PTApe2lmKGR5Pj0wKXtpZihhZHg+PWFkeSlcbnJldHVybiAwO2Vsc2VcbnJldHVybiAxO31cbmVsc2V7aWYoYWR4Pj1hZHkpXG5yZXR1cm4gNztlbHNlXG5yZXR1cm4gNjt9fVxuZWxzZXtpZihkeT49MCl7aWYoYWR4Pj1hZHkpXG5yZXR1cm4gMztlbHNlXG5yZXR1cm4gMjt9XG5lbHNle2lmKGFkeD49YWR5KVxucmV0dXJuIDQ7ZWxzZVxucmV0dXJuIDU7fX19O2pzdHMubm9kaW5nLk9jdGFudC5vY3RhbnQyPWZ1bmN0aW9uKHAwLHAxKXt2YXIgZHg9cDEueC1wMC54O3ZhciBkeT1wMS55LXAwLnk7aWYoZHg9PT0wLjAmJmR5PT09MC4wKVxudGhyb3cgbmV3IGpzdHMuZXJyb3IuSWxsZWdhbEFyZ3VtZW50RXJyb3IoJ0Nhbm5vdCBjb21wdXRlIHRoZSBvY3RhbnQgZm9yIHR3byBpZGVudGljYWwgcG9pbnRzICcrcDApO3JldHVybiBqc3RzLm5vZGluZy5PY3RhbnQub2N0YW50KGR4LGR5KTt9O2pzdHMub3BlcmF0aW9uLnVuaW9uLlVuaW9uSW50ZXJhY3Rpbmc9ZnVuY3Rpb24oZzAsZzEpe3RoaXMuZzA9ZzA7dGhpcy5nMT1nMTt0aGlzLmdlb21GYWN0b3J5PWcwLmdldEZhY3RvcnkoKTt0aGlzLmludGVyYWN0czA9W107dGhpcy5pbnRlcmFjdHMxPVtdO307anN0cy5vcGVyYXRpb24udW5pb24uVW5pb25JbnRlcmFjdGluZy51bmlvbj1mdW5jdGlvbihnMCxnMSl7dmFyIHV1ZT1uZXcganN0cy5vcGVyYXRpb24udW5pb24uVW5pb25JbnRlcmFjdGluZyhnMCxnMSk7cmV0dXJuIHV1ZS51bmlvbigpO307anN0cy5vcGVyYXRpb24udW5pb24uVW5pb25JbnRlcmFjdGluZy5wcm90b3R5cGUuZ2VvbUZhY3Rvcnk9bnVsbDtqc3RzLm9wZXJhdGlvbi51bmlvbi5VbmlvbkludGVyYWN0aW5nLnByb3RvdHlwZS5nMD1udWxsO2pzdHMub3BlcmF0aW9uLnVuaW9uLlVuaW9uSW50ZXJhY3RpbmcucHJvdG90eXBlLmcxPW51bGw7anN0cy5vcGVyYXRpb24udW5pb24uVW5pb25JbnRlcmFjdGluZy5wcm90b3R5cGUuaW50ZXJhY3RzMD1udWxsO2pzdHMub3BlcmF0aW9uLnVuaW9uLlVuaW9uSW50ZXJhY3RpbmcucHJvdG90eXBlLmludGVyYWN0czE9bnVsbDtqc3RzLm9wZXJhdGlvbi51bmlvbi5VbmlvbkludGVyYWN0aW5nLnByb3RvdHlwZS51bmlvbj1mdW5jdGlvbigpe3RoaXMuY29tcHV0ZUludGVyYWN0aW5nKCk7dmFyIGludDA9dGhpcy5leHRyYWN0RWxlbWVudHModGhpcy5nMCx0aGlzLmludGVyYWN0czAsdHJ1ZSk7dmFyIGludDE9dGhpcy5leHRyYWN0RWxlbWVudHModGhpcy5nMSx0aGlzLmludGVyYWN0czEsdHJ1ZSk7aWYoaW50MC5pc0VtcHR5KCl8fGludDEuaXNFbXB0eSgpKXt9XG52YXIgdW5pb249aW4wLnVuaW9uKGludDEpO3ZhciBkaXNqb2ludDA9dGhpcy5leHRyYWN0RWxlbWVudHModGhpcy5nMCx0aGlzLmludGVyYWN0czAsZmFsc2UpO3ZhciBkaXNqb2ludDE9dGhpcy5leHRyYWN0RWxlbWVudHModGhpcy5nMSx0aGlzLmludGVyYWN0czEsZmFsc2UpO3ZhciBvdmVyYWxsVW5pb249anN0cy5nZW9tLnV0aWwuR2VvbWV0cnlDb21iaW5lci5jb21iaW5lKHVuaW9uLGRpc2pvaW50MCxkaXNqb2ludDEpO3JldHVybiBvdmVyYWxsVW5pb247fTtqc3RzLm9wZXJhdGlvbi51bmlvbi5VbmlvbkludGVyYWN0aW5nLnByb3RvdHlwZS5idWZmZXJVbmlvbj1mdW5jdGlvbihnMCxnMSl7dmFyIGZhY3Rvcnk9ZzAuZ2V0RmFjdG9yeSgpO3ZhciBnQ29sbD1mYWN0b3J5LmNyZWF0ZUdlb21ldHJ5Q29sbGVjdGlvbihbZzAsZzFdKTt2YXIgdW5pb25BbGw9Z0NvbGwuYnVmZmVyKDAuMCk7cmV0dXJuIHVuaW9uQWxsO307anN0cy5vcGVyYXRpb24udW5pb24uVW5pb25JbnRlcmFjdGluZy5wcm90b3R5cGUuY29tcHV0ZUludGVyYWN0aW5nPWZ1bmN0aW9uKGVsZW0wKXtpZighZWxlbTApe2Zvcih2YXIgaT0wLGw9dGhpcy5nMC5nZXROdW1HZW9tZXRyaWVzKCk7aTxsO2krKyl7dmFyIGVsZW09dGhpcy5nMC5nZXRHZW9tZXRyeU4oaSk7dGhpcy5pbnRlcmFjdHMwW2ldPXRoaXMuY29tcHV0ZUludGVyYWN0aW5nKGVsZW0pO319XG5lbHNle3ZhciBpbnRlcmFjdHNXaXRoQW55PWZhbHNlO2Zvcih2YXIgaT0wLGw9ZzEuZ2V0TnVtR2VvbWV0cmllcygpO2k8bDtpKyspe3ZhciBlbGVtMT10aGlzLmcxLmdldEdlb21ldHJ5TihpKTt2YXIgaW50ZXJhY3RzPWVsZW0xLmdldEVudmVsb3BlSW50ZXJuYWwoKS5pbnRlcnNlY3RzKGVsZW0wLmdldEVudmVsb3BlSW50ZXJuYWwoKSk7aWYoaW50ZXJhY3RzKXt0aGlzLmludGVyYWN0czFbaV09dHJ1ZTtpbnRlcmFjdHNXaXRoQW55PXRydWU7fX1cbnJldHVybiBpbnRlcmFjdHNXaXRoQW55O319O2pzdHMub3BlcmF0aW9uLnVuaW9uLlVuaW9uSW50ZXJhY3RpbmcucHJvdG90eXBlLmV4dHJhY3RFbGVtZW50cz1mdW5jdGlvbihnZW9tLGludGVyYWN0cyxpc0ludGVyYWN0aW5nKXt2YXIgZXh0cmFjdGVkR2VvbXM9W107Zm9yKHZhciBpPTAsbD1nZW9tLmdldE51bUdlb21ldHJpZXMoKTtpPGw7aSsrKXt2YXIgZWxlbT1nZW9tLmdldEdlb21ldHJ5TihpKTtpZihpbnRlcmFjdHNbaV09PT1pc0ludGVyYWN0aW5nKXtleHRyYWN0ZWRHZW9tcy5wdXNoKGVsZW0pO319XG5yZXR1cm4gdGhpcy5nZW9tRmFjdG9yeS5idWlsZEdlb21ldHJ5KGV4dHJhY3RlZEdlb21zKTt9O2pzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuVHJpYW5nbGVQcmVkaWNhdGU9ZnVuY3Rpb24oKXt9O2pzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuVHJpYW5nbGVQcmVkaWNhdGUuaXNJbkNpcmNsZU5vblJvYnVzdD1mdW5jdGlvbihhLGIsYyxwKXt2YXIgaXNJbkNpcmNsZT0oYS54KmEueCthLnkqYS55KSpqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlRyaWFuZ2xlUHJlZGljYXRlLnRyaUFyZWEoYixjLHApLVxuKGIueCpiLngrYi55KmIueSkqanN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5UcmlhbmdsZVByZWRpY2F0ZS50cmlBcmVhKGEsYyxwKStcbihjLngqYy54K2MueSpjLnkpKmpzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuVHJpYW5nbGVQcmVkaWNhdGUudHJpQXJlYShhLGIscCktXG4ocC54KnAueCtwLnkqcC55KSpqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlRyaWFuZ2xlUHJlZGljYXRlLnRyaUFyZWEoYSxiLGMpPjA7cmV0dXJuIGlzSW5DaXJjbGU7fTtqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlRyaWFuZ2xlUHJlZGljYXRlLmlzSW5DaXJjbGVOb3JtYWxpemVkPWZ1bmN0aW9uKGEsYixjLHApe3ZhciBhZHgsYWR5LGJkeCxiZHksY2R4LGNkeSxhYmRldCxiY2RldCxjYWRldCxhbGlmdCxibGlmdCxjbGlmdCxkaXNjO2FkeD1hLngtcC54O2FkeT1hLnktcC55O2JkeD1iLngtcC54O2JkeT1iLnktcC55O2NkeD1jLngtcC54O2NkeT1jLnktcC55O2FiZGV0PWFkeCpiZHktYmR4KmFkeTtiY2RldD1iZHgqY2R5LWNkeCpiZHk7Y2FkZXQ9Y2R4KmFkeS1hZHgqY2R5O2FsaWZ0PWFkeCphZHgrYWR5KmFkeTtibGlmdD1iZHgqYmR4K2JkeSpiZHk7Y2xpZnQ9Y2R4KmNkeCtjZHkqY2R5O2Rpc2M9YWxpZnQqYmNkZXQrYmxpZnQqY2FkZXQrY2xpZnQqYWJkZXQ7cmV0dXJuIGRpc2M+MDt9O2pzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuVHJpYW5nbGVQcmVkaWNhdGUudHJpQXJlYT1mdW5jdGlvbihhLGIsYyl7cmV0dXJuKGIueC1hLngpKihjLnktYS55KS0oYi55LWEueSkqKGMueC1hLngpO307anN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5UcmlhbmdsZVByZWRpY2F0ZS5pc0luQ2lyY2xlUm9idXN0PWZ1bmN0aW9uKGEsYixjLHApe3JldHVybiBqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlRyaWFuZ2xlUHJlZGljYXRlLmlzSW5DaXJjbGVOb3JtYWxpemVkKGEsYixjLHApO307anN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5UcmlhbmdsZVByZWRpY2F0ZS5pc0luQ2lyY2xlRERTbG93PWZ1bmN0aW9uKGEsYixjLHApe3ZhciBweCxweSxheCxheSxieCxieSxjeCxjeSxhVGVybSxiVGVybSxjVGVybSxwVGVybSxzdW0saXNJbkNpcmNsZTtweD1qc3RzLm1hdGguREQudmFsdWVPZihwLngpO3B5PWpzdHMubWF0aC5ERC52YWx1ZU9mKHAueSk7YXg9anN0cy5tYXRoLkRELnZhbHVlT2YoYS54KTtheT1qc3RzLm1hdGguREQudmFsdWVPZihhLnkpO2J4PWpzdHMubWF0aC5ERC52YWx1ZU9mKGIueCk7Ynk9anN0cy5tYXRoLkRELnZhbHVlT2YoYi55KTtjeD1qc3RzLm1hdGguREQudmFsdWVPZihjLngpO2N5PWpzdHMubWF0aC5ERC52YWx1ZU9mKGMueSk7YVRlcm09KGF4Lm11bHRpcGx5KGF4KS5hZGQoYXkubXVsdGlwbHkoYXkpKSkubXVsdGlwbHkoanN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5UcmlhbmdsZVByZWRpY2F0ZS50cmlBcmVhRERTbG93KGJ4LGJ5LGN4LGN5LHB4LHB5KSk7YlRlcm09KGJ4Lm11bHRpcGx5KGJ4KS5hZGQoYnkubXVsdGlwbHkoYnkpKSkubXVsdGlwbHkoanN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5UcmlhbmdsZVByZWRpY2F0ZS50cmlBcmVhRERTbG93KGF4LGF5LGN4LGN5LHB4LHB5KSk7Y1Rlcm09KGN4Lm11bHRpcGx5KGN4KS5hZGQoY3kubXVsdGlwbHkoY3kpKSkubXVsdGlwbHkoanN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5UcmlhbmdsZVByZWRpY2F0ZS50cmlBcmVhRERTbG93KGF4LGF5LGJ4LGJ5LHB4LHB5KSk7cFRlcm09KHB4Lm11bHRpcGx5KHB4KS5hZGQocHkubXVsdGlwbHkocHkpKSkubXVsdGlwbHkoanN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5UcmlhbmdsZVByZWRpY2F0ZS50cmlBcmVhRERTbG93KGF4LGF5LGJ4LGJ5LGN4LGN5KSk7c3VtPWFUZXJtLnN1YnRyYWN0KGJUZXJtKS5hZGQoY1Rlcm0pLnN1YnRyYWN0KHBUZXJtKTtpc0luQ2lyY2xlPXN1bS5kb3VibGVWYWx1ZSgpPjA7cmV0dXJuIGlzSW5DaXJjbGU7fTtqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlRyaWFuZ2xlUHJlZGljYXRlLnRyaUFyZWFERFNsb3c9ZnVuY3Rpb24oYXgsYXksYngsYnksY3gsY3kpe3JldHVybihieC5zdWJ0cmFjdChheCkubXVsdGlwbHkoY3kuc3VidHJhY3QoYXkpKS5zdWJ0cmFjdChieS5zdWJ0cmFjdChheSkubXVsdGlwbHkoY3guc3VidHJhY3QoYXgpKSkpO307anN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5UcmlhbmdsZVByZWRpY2F0ZS5pc0luQ2lyY2xlRERGYXN0PWZ1bmN0aW9uKGEsYixjLHApe3ZhciBhVGVybSxiVGVybSxjVGVybSxwVGVybSxzdW0saXNJbkNpcmNsZTthVGVybT0oanN0cy5tYXRoLkRELnNxcihhLngpLnNlbGZBZGQoanN0cy5tYXRoLkRELnNxcihhLnkpKSkuc2VsZk11bHRpcGx5KGpzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuVHJpYW5nbGVQcmVkaWNhdGUudHJpQXJlYURERmFzdChiLGMscCkpO2JUZXJtPShqc3RzLm1hdGguREQuc3FyKGIueCkuc2VsZkFkZChqc3RzLm1hdGguREQuc3FyKGIueSkpKS5zZWxmTXVsdGlwbHkoanN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5UcmlhbmdsZVByZWRpY2F0ZS50cmlBcmVhRERGYXN0KGEsYyxwKSk7Y1Rlcm09KGpzdHMubWF0aC5ERC5zcXIoYy54KS5zZWxmQWRkKGpzdHMubWF0aC5ERC5zcXIoYy55KSkpLnNlbGZNdWx0aXBseShqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlRyaWFuZ2xlUHJlZGljYXRlLnRyaUFyZWFEREZhc3QoYSxiLHApKTtwVGVybT0oanN0cy5tYXRoLkRELnNxcihwLngpLnNlbGZBZGQoanN0cy5tYXRoLkRELnNxcihwLnkpKSkuc2VsZk11bHRpcGx5KGpzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuVHJpYW5nbGVQcmVkaWNhdGUudHJpQXJlYURERmFzdChhLGIsYykpO3N1bT1hVGVybS5zZWxmU3VidHJhY3QoYlRlcm0pLnNlbGZBZGQoY1Rlcm0pLnNlbGZTdWJ0cmFjdChwVGVybSk7aXNJbkNpcmNsZT1zdW0uZG91YmxlVmFsdWUoKT4wO3JldHVybiBpc0luQ2lyY2xlO307anN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5UcmlhbmdsZVByZWRpY2F0ZS50cmlBcmVhRERGYXN0PWZ1bmN0aW9uKGEsYixjKXt2YXIgdDEsdDI7dDE9anN0cy5tYXRoLkRELnZhbHVlT2YoYi54KS5zZWxmU3VidHJhY3QoYS54KS5zZWxmTXVsdGlwbHkoanN0cy5tYXRoLkRELnZhbHVlT2YoYy55KS5zZWxmU3VidHJhY3QoYS55KSk7dDI9anN0cy5tYXRoLkRELnZhbHVlT2YoYi55KS5zZWxTdWJ0cmFjdChhLnkpLnNlbGZNdWx0aXBseShqc3RzLm1hdGguREQudmFsdWVPZihjLngpLnNlbGZTdWJ0cmFjdChhLngpKTtyZXR1cm4gdDEuc2VsZlN1YnRyYWN0KHQyKTt9O2pzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuVHJpYW5nbGVQcmVkaWNhdGUuaXNJbkNpcmNsZURETm9ybWFsaXplZD1mdW5jdGlvbihhLGIsYyxwKXt2YXIgYWR4LGFkeSxiZHgsYmR5LGNkeCxjZHksYWJkZXQsYmNkZXQsY2FkZXQsYWxpZnQsYmxpZnQsY2xpZnQsc3VtLGlzSW5DaXJjbGU7YWR4PWpzdHMubWF0aC5ERC52YWx1ZU9mKGEueCkuc2VsZlN1YnRyYWN0KHAueCk7YWR5PWpzdHMubWF0aC5ERC52YWx1ZU9mKGEueSkuc2VsZlN1YnRyYWN0KHAueSk7YmR4PWpzdHMubWF0aC5ERC52YWx1ZU9mKGIueCkuc2VsZlN1YnRyYWN0KHAueCk7YmR4PWpzdHMubWF0aC5ERC52YWx1ZU9mKGIueSkuc2VsZlN1YnRyYWN0KHAueSk7Y2R4PWpzdHMubWF0aC5ERC52YWx1ZU9mKGMueCkuc2VsZlN1YnRyYWN0KHAueCk7Y2R4PWpzdHMubWF0aC5ERC52YWx1ZU9mKGMueSkuc2VsZlN1YnRyYWN0KHAueSk7YWJkZXQ9YWR4Lm11bHRpcGx5KGJkeSkuc2VsZlN1YnRyYWN0KGJkeC5tdWx0aXBseShhZHkpKTtiY2RldD1iZHgubXVsdGlwbHkoY2R5KS5zZWxmU3VidHJhY3QoY2R4Lm11bHRpcGx5KGJkeSkpO2NhZGV0PWNkeC5tdWx0aXBseShhZHkpLnNlbGZTdWJ0cmFjdChhZHgubXVsdGlwbHkoY2R5KSk7YWxpZnQ9YWR4Lm11bHRpcGx5KGFkeCkuc2VsZkFkZChhZHkubXVsdGlwbHkoYWR5KSk7YmxpZnQ9YmR4Lm11bHRpcGx5KGJkeCkuc2VsZkFkZChiZHkubXVsdGlwbHkoYmR5KSk7Y2xpZnQ9Y2R4Lm11bHRpcGx5KGNkeCkuc2VsZkFkZChjZHkubXVsdGlwbHkoY2R5KSk7c3VtPWFsaWZ0LnNlbGZNdWx0aXBseShiY2RldCkuc2VsZkFkZChibGlmdC5zZWxmTXVsdGlwbHkoY2FkZXQpKS5zZWxmQWRkKGNsaWZ0LnNlbGZNdWx0aXBseShhYmRldCkpO2lzSW5DaXJjbGU9c3VtLmRvdWJsZVZhbHVlKCk+MDtyZXR1cm4gaXNJbkNpcmNsZTt9O2pzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuVHJpYW5nbGVQcmVkaWNhdGUuaXNJbkNpcmNsZUNDPWZ1bmN0aW9uKGEsYixjLHApe3ZhciBjYyxjY1JhZGl1cyxwUmFkaXVzRGlmZjtjYz1qc3RzLmdlb20uVHJpYW5nbGUuY2lyY3VtY2VudHJlKGEsYixjKTtjY1JhZGl1cz1hLmRpc3RhbmNlKGNjKTtwUmFkaXVzRGlmZj1wLmRpc3RhbmNlKGNjKS1jY1JhZGl1cztyZXR1cm4gcFJhZGl1c0RpZmY8PTA7fTtqc3RzLm9wZXJhdGlvbi51bmlvbi5Qb2ludEdlb21ldHJ5VW5pb249ZnVuY3Rpb24ocG9pbnRHZW9tLG90aGVyR2VvbSl7dGhpcy5wb2ludEdlb209cG9pbnRHZW9tO3RoaXMub3RoZXJHZW9tPW90aGVyR2VvbTt0aGlzLmdlb21GYWN0PW90aGVyR2VvbS5nZXRGYWN0b3J5KCk7fTtqc3RzLm9wZXJhdGlvbi51bmlvbi5Qb2ludEdlb21ldHJ5VW5pb24udW5pb249ZnVuY3Rpb24ocG9pbnRHZW9tLG90aGVyR2VvbSl7dmFyIHVuaW9uZXI9bmV3IGpzdHMub3BlcmF0aW9uLnVuaW9uLlBvaW50R2VvbWV0cnlVbmlvbihwb2ludEdlb20sb3RoZXJHZW9tKTtyZXR1cm4gdW5pb25lci51bmlvbigpO307anN0cy5vcGVyYXRpb24udW5pb24uUG9pbnRHZW9tZXRyeVVuaW9uLnByb3RvdHlwZS5wb2ludEdlb209bnVsbDtqc3RzLm9wZXJhdGlvbi51bmlvbi5Qb2ludEdlb21ldHJ5VW5pb24ucHJvdG90eXBlLm90aGVyR2VvbT1udWxsO2pzdHMub3BlcmF0aW9uLnVuaW9uLlBvaW50R2VvbWV0cnlVbmlvbi5wcm90b3R5cGUuZ2VvbUZhY3Q9bnVsbDtqc3RzLm9wZXJhdGlvbi51bmlvbi5Qb2ludEdlb21ldHJ5VW5pb24ucHJvdG90eXBlLnVuaW9uPWZ1bmN0aW9uKCl7dmFyIGxvY2F0b3I9bmV3IGpzdHMuYWxnb3JpdGhtLlBvaW50TG9jYXRvcigpO3ZhciBleHRlcmlvckNvb3Jkcz1bXTtmb3IodmFyIGk9MCxsPXRoaXMucG9pbnRHZW9tLmdldE51bUdlb21ldHJpZXMoKTtpPGw7aSsrKXt2YXIgcG9pbnQ9dGhpcy5wb2ludEdlb20uZ2V0R2VvbWV0cnlOKGkpO3ZhciBjb29yZD1wb2ludC5nZXRDb29yZGluYXRlKCk7dmFyIGxvYz1sb2NhdG9yLmxvY2F0ZShjb29yZCx0aGlzLm90aGVyR2VvbSk7aWYobG9jPT09anN0cy5nZW9tLkxvY2F0aW9uLkVYVEVSSU9SKXt2YXIgaW5jbHVkZT10cnVlO2Zvcih2YXIgaj1leHRlcmlvckNvb3Jkcy5sZW5ndGg7aS0tOyl7aWYoZXh0ZXJpb3JDb29yZHNbal0uZXF1YWxzKGNvb3JkKSl7aW5jbHVkZT1mYWxzZTticmVhazt9fVxuaWYoaW5jbHVkZSl7ZXh0ZXJpb3JDb29yZHMucHVzaChjb29yZCk7fX19XG5leHRlcmlvckNvb3Jkcy5zb3J0KGZ1bmN0aW9uKHgseSl7cmV0dXJuIHguY29tcGFyZVRvKHkpO30pO2lmKGV4dGVyaW9yQ29vcmRzLmxlbmd0aD09PTApe3JldHVybiB0aGlzLm90aGVyR2VvbTt9XG52YXIgcHRDb21wPW51bGw7dmFyIGNvb3Jkcz1qc3RzLmdlb20uQ29vcmRpbmF0ZUFycmF5cy50b0Nvb3JkaW5hdGVBcnJheShleHRlcmlvckNvb3Jkcyk7aWYoY29vcmRzLmxlbmd0aD09PTEpe3B0Q29tcD10aGlzLmdlb21GYWN0LmNyZWF0ZVBvaW50KGNvb3Jkc1swXSk7fVxuZWxzZXtwdENvbXA9dGhpcy5nZW9tRmFjdC5jcmVhdGVNdWx0aVBvaW50KGNvb3Jkcyk7fVxucmV0dXJuIGpzdHMuZ2VvbS51dGlsLkdlb21ldHJ5Q29tYmluZXIuY29tYmluZShwdENvbXAsdGhpcy5vdGhlckdlb20pO307anN0cy5ub2RpbmcuSW50ZXJzZWN0aW9uRmluZGVyQWRkZXI9ZnVuY3Rpb24obGkpe3RoaXMubGk9bGk7dGhpcy5pbnRlcmlvckludGVyc2VjdGlvbnM9bmV3IGphdmFzY3JpcHQudXRpbC5BcnJheUxpc3QoKTt9O2pzdHMubm9kaW5nLkludGVyc2VjdGlvbkZpbmRlckFkZGVyLnByb3RvdHlwZT1uZXcganN0cy5ub2RpbmcuU2VnbWVudEludGVyc2VjdG9yKCk7anN0cy5ub2RpbmcuSW50ZXJzZWN0aW9uRmluZGVyQWRkZXIuY29uc3RydWN0b3I9anN0cy5ub2RpbmcuSW50ZXJzZWN0aW9uRmluZGVyQWRkZXI7anN0cy5ub2RpbmcuSW50ZXJzZWN0aW9uRmluZGVyQWRkZXIucHJvdG90eXBlLmxpPW51bGw7anN0cy5ub2RpbmcuSW50ZXJzZWN0aW9uRmluZGVyQWRkZXIucHJvdG90eXBlLmludGVyaW9ySW50ZXJzZWN0aW9ucz1udWxsO2pzdHMubm9kaW5nLkludGVyc2VjdGlvbkZpbmRlckFkZGVyLnByb3RvdHlwZS5nZXRJbnRlcmlvckludGVyc2VjdGlvbnM9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5pbnRlcmlvckludGVyc2VjdGlvbnM7fTtqc3RzLm5vZGluZy5JbnRlcnNlY3Rpb25GaW5kZXJBZGRlci5wcm90b3R5cGUucHJvY2Vzc0ludGVyc2VjdGlvbnM9ZnVuY3Rpb24oZTAsc2VnSW5kZXgwLGUxLHNlZ0luZGV4MSl7aWYoZTA9PT1lMSYmc2VnSW5kZXgwPT09c2VnSW5kZXgxKVxucmV0dXJuO3ZhciBwMDA9ZTAuZ2V0Q29vcmRpbmF0ZXMoKVtzZWdJbmRleDBdO3ZhciBwMDE9ZTAuZ2V0Q29vcmRpbmF0ZXMoKVtzZWdJbmRleDArMV07dmFyIHAxMD1lMS5nZXRDb29yZGluYXRlcygpW3NlZ0luZGV4MV07dmFyIHAxMT1lMS5nZXRDb29yZGluYXRlcygpW3NlZ0luZGV4MSsxXTt0aGlzLmxpLmNvbXB1dGVJbnRlcnNlY3Rpb24ocDAwLHAwMSxwMTAscDExKTtpZih0aGlzLmxpLmhhc0ludGVyc2VjdGlvbigpKXtpZih0aGlzLmxpLmlzSW50ZXJpb3JJbnRlcnNlY3Rpb24oKSl7Zm9yKHZhciBpbnRJbmRleD0wO2ludEluZGV4PHRoaXMubGkuZ2V0SW50ZXJzZWN0aW9uTnVtKCk7aW50SW5kZXgrKyl7dGhpcy5pbnRlcmlvckludGVyc2VjdGlvbnMuYWRkKHRoaXMubGkuZ2V0SW50ZXJzZWN0aW9uKGludEluZGV4KSk7fVxuZTAuYWRkSW50ZXJzZWN0aW9ucyh0aGlzLmxpLHNlZ0luZGV4MCwwKTtlMS5hZGRJbnRlcnNlY3Rpb25zKHRoaXMubGksc2VnSW5kZXgxLDEpO319fTtqc3RzLm5vZGluZy5JbnRlcnNlY3Rpb25GaW5kZXJBZGRlci5wcm90b3R5cGUuaXNEb25lPWZ1bmN0aW9uKCl7cmV0dXJuIGZhbHNlO307anN0cy5ub2Rpbmcuc25hcHJvdW5kLk1DSW5kZXhTbmFwUm91bmRlcj1mdW5jdGlvbihwbSl7dGhpcy5wbT1wbTt0aGlzLmxpPW5ldyBqc3RzLmFsZ29yaXRobS5Sb2J1c3RMaW5lSW50ZXJzZWN0b3IoKTt0aGlzLmxpLnNldFByZWNpc2lvbk1vZGVsKHBtKTt0aGlzLnNjYWxlRmFjdG9yPXBtLmdldFNjYWxlKCk7fTtqc3RzLm5vZGluZy5zbmFwcm91bmQuTUNJbmRleFNuYXBSb3VuZGVyLnByb3RvdHlwZT1uZXcganN0cy5ub2RpbmcuTm9kZXIoKTtqc3RzLm5vZGluZy5zbmFwcm91bmQuTUNJbmRleFNuYXBSb3VuZGVyLmNvbnN0cnVjdG9yPWpzdHMubm9kaW5nLnNuYXByb3VuZC5NQ0luZGV4U25hcFJvdW5kZXI7anN0cy5ub2Rpbmcuc25hcHJvdW5kLk1DSW5kZXhTbmFwUm91bmRlci5wcm90b3R5cGUucG09bnVsbDtqc3RzLm5vZGluZy5zbmFwcm91bmQuTUNJbmRleFNuYXBSb3VuZGVyLnByb3RvdHlwZS5saT1udWxsO2pzdHMubm9kaW5nLnNuYXByb3VuZC5NQ0luZGV4U25hcFJvdW5kZXIucHJvdG90eXBlLnNjYWxlRmFjdG9yPW51bGw7anN0cy5ub2Rpbmcuc25hcHJvdW5kLk1DSW5kZXhTbmFwUm91bmRlci5wcm90b3R5cGUubm9kZXI9bnVsbDtqc3RzLm5vZGluZy5zbmFwcm91bmQuTUNJbmRleFNuYXBSb3VuZGVyLnByb3RvdHlwZS5wb2ludFNuYXBwZXI9bnVsbDtqc3RzLm5vZGluZy5zbmFwcm91bmQuTUNJbmRleFNuYXBSb3VuZGVyLnByb3RvdHlwZS5ub2RlZFNlZ1N0cmluZ3M9bnVsbDtqc3RzLm5vZGluZy5zbmFwcm91bmQuTUNJbmRleFNuYXBSb3VuZGVyLnByb3RvdHlwZS5nZXROb2RlZFN1YnN0cmluZ3M9ZnVuY3Rpb24oKXtyZXR1cm4ganN0cy5ub2RpbmcuTm9kZWRTZWdtZW50U3RyaW5nLmdldE5vZGVkU3Vic3RyaW5ncyh0aGlzLm5vZGVkU2VnU3RyaW5ncyk7fTtqc3RzLm5vZGluZy5zbmFwcm91bmQuTUNJbmRleFNuYXBSb3VuZGVyLnByb3RvdHlwZS5jb21wdXRlTm9kZXM9ZnVuY3Rpb24oaW5wdXRTZWdtZW50U3RyaW5ncyl7dGhpcy5ub2RlZFNlZ1N0cmluZ3M9aW5wdXRTZWdtZW50U3RyaW5nczt0aGlzLm5vZGVyPW5ldyBqc3RzLm5vZGluZy5NQ0luZGV4Tm9kZXIoKTt0aGlzLnBvaW50U25hcHBlcj1uZXcganN0cy5ub2Rpbmcuc25hcHJvdW5kLk1DSW5kZXhQb2ludFNuYXBwZXIodGhpcy5ub2Rlci5nZXRJbmRleCgpKTt0aGlzLnNuYXBSb3VuZChpbnB1dFNlZ21lbnRTdHJpbmdzLHRoaXMubGkpO307anN0cy5ub2Rpbmcuc25hcHJvdW5kLk1DSW5kZXhTbmFwUm91bmRlci5wcm90b3R5cGUuc25hcFJvdW5kPWZ1bmN0aW9uKHNlZ1N0cmluZ3MsbGkpe3ZhciBpbnRlcnNlY3Rpb25zPXRoaXMuZmluZEludGVyaW9ySW50ZXJzZWN0aW9ucyhzZWdTdHJpbmdzLGxpKTt0aGlzLmNvbXB1dGVJbnRlcnNlY3Rpb25TbmFwcyhpbnRlcnNlY3Rpb25zKTt0aGlzLmNvbXB1dGVWZXJ0ZXhTbmFwcyhzZWdTdHJpbmdzKTt9O2pzdHMubm9kaW5nLnNuYXByb3VuZC5NQ0luZGV4U25hcFJvdW5kZXIucHJvdG90eXBlLmZpbmRJbnRlcmlvckludGVyc2VjdGlvbnM9ZnVuY3Rpb24oc2VnU3RyaW5ncyxsaSl7dmFyIGludEZpbmRlckFkZGVyPW5ldyBqc3RzLm5vZGluZy5JbnRlcnNlY3Rpb25GaW5kZXJBZGRlcihsaSk7dGhpcy5ub2Rlci5zZXRTZWdtZW50SW50ZXJzZWN0b3IoaW50RmluZGVyQWRkZXIpO3RoaXMubm9kZXIuY29tcHV0ZU5vZGVzKHNlZ1N0cmluZ3MpO3JldHVybiBpbnRGaW5kZXJBZGRlci5nZXRJbnRlcmlvckludGVyc2VjdGlvbnMoKTt9O2pzdHMubm9kaW5nLnNuYXByb3VuZC5NQ0luZGV4U25hcFJvdW5kZXIucHJvdG90eXBlLmNvbXB1dGVJbnRlcnNlY3Rpb25TbmFwcz1mdW5jdGlvbihzbmFwUHRzKXtmb3IodmFyIGl0PXNuYXBQdHMuaXRlcmF0b3IoKTtpdC5oYXNOZXh0KCk7KXt2YXIgc25hcFB0PWl0Lm5leHQoKTt2YXIgaG90UGl4ZWw9bmV3IGpzdHMubm9kaW5nLnNuYXByb3VuZC5Ib3RQaXhlbChzbmFwUHQsdGhpcy5zY2FsZUZhY3Rvcix0aGlzLmxpKTt0aGlzLnBvaW50U25hcHBlci5zbmFwKGhvdFBpeGVsKTt9fTtqc3RzLm5vZGluZy5zbmFwcm91bmQuTUNJbmRleFNuYXBSb3VuZGVyLnByb3RvdHlwZS5jb21wdXRlVmVydGV4U25hcHM9ZnVuY3Rpb24oZWRnZXMpe2lmKGVkZ2VzIGluc3RhbmNlb2YganN0cy5ub2RpbmcuTm9kZWRTZWdtZW50U3RyaW5nKXt0aGlzLmNvbXB1dGVWZXJ0ZXhTbmFwczIuYXBwbHkodGhpcyxhcmd1bWVudHMpO3JldHVybjt9XG5mb3IodmFyIGkwPWVkZ2VzLml0ZXJhdG9yKCk7aTAuaGFzTmV4dCgpOyl7dmFyIGVkZ2UwPWkwLm5leHQoKTt0aGlzLmNvbXB1dGVWZXJ0ZXhTbmFwcyhlZGdlMCk7fX07anN0cy5ub2Rpbmcuc25hcHJvdW5kLk1DSW5kZXhTbmFwUm91bmRlci5wcm90b3R5cGUuY29tcHV0ZVZlcnRleFNuYXBzMj1mdW5jdGlvbihlKXt2YXIgcHRzMD1lLmdldENvb3JkaW5hdGVzKCk7Zm9yKHZhciBpPTA7aTxwdHMwLmxlbmd0aC0xO2krKyl7dmFyIGhvdFBpeGVsPW5ldyBqc3RzLm5vZGluZy5zbmFwcm91bmQuSG90UGl4ZWwocHRzMFtpXSx0aGlzLnNjYWxlRmFjdG9yLHRoaXMubGkpO3ZhciBpc05vZGVBZGRlZD10aGlzLnBvaW50U25hcHBlci5zbmFwKGhvdFBpeGVsLGUsaSk7aWYoaXNOb2RlQWRkZWQpe2UuYWRkSW50ZXJzZWN0aW9uKHB0czBbaV0saSk7fX19O2pzdHMub3BlcmF0aW9uLnZhbGlkLkNvbm5lY3RlZEludGVyaW9yVGVzdGVyPWZ1bmN0aW9uKGdlb21HcmFwaCl7dGhpcy5nZW9tR3JhcGg9Z2VvbUdyYXBoO3RoaXMuZ2VvbWV0cnlGYWN0b3J5PW5ldyBqc3RzLmdlb20uR2VvbWV0cnlGYWN0b3J5KCk7dGhpcy5kaXNjb25uZWN0ZWRSaW5nY29vcmQ9bnVsbDt9O2pzdHMub3BlcmF0aW9uLnZhbGlkLkNvbm5lY3RlZEludGVyaW9yVGVzdGVyLmZpbmREaWZmZXJlbnRQb2ludD1mdW5jdGlvbihjb29yZCxwdCl7dmFyIGk9MCxpbD1jb29yZC5sZW5ndGg7Zm9yKGk7aTxpbDtpKyspe2lmKCFjb29yZFtpXS5lcXVhbHMocHQpKVxucmV0dXJuIGNvb3JkW2ldO31cbnJldHVybiBudWxsO307anN0cy5vcGVyYXRpb24udmFsaWQuQ29ubmVjdGVkSW50ZXJpb3JUZXN0ZXIucHJvdG90eXBlLmdldENvb3JkaW5hdGU9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5kaXNjb25uZWN0ZWRSaW5nY29vcmQ7fTtqc3RzLm9wZXJhdGlvbi52YWxpZC5Db25uZWN0ZWRJbnRlcmlvclRlc3Rlci5wcm90b3R5cGUuaXNJbnRlcmlvcnNDb25uZWN0ZWQ9ZnVuY3Rpb24oKXt2YXIgc3BsaXRFZGdlcz1uZXcgamF2YXNjcmlwdC51dGlsLkFycmF5TGlzdCgpO3RoaXMuZ2VvbUdyYXBoLmNvbXB1dGVTcGxpdEVkZ2VzKHNwbGl0RWRnZXMpO3ZhciBncmFwaD1uZXcganN0cy5nZW9tZ3JhcGguUGxhbmFyR3JhcGgobmV3IGpzdHMub3BlcmF0aW9uLm92ZXJsYXkuT3ZlcmxheU5vZGVGYWN0b3J5KCkpO2dyYXBoLmFkZEVkZ2VzKHNwbGl0RWRnZXMpO3RoaXMuc2V0SW50ZXJpb3JFZGdlc0luUmVzdWx0KGdyYXBoKTtncmFwaC5saW5rUmVzdWx0RGlyZWN0ZWRFZGdlcygpO3ZhciBlZGdlUmluZ3M9dGhpcy5idWlsZEVkZ2VSaW5ncyhncmFwaC5nZXRFZGdlRW5kcygpKTt0aGlzLnZpc2l0U2hlbGxJbnRlcmlvcnModGhpcy5nZW9tR3JhcGguZ2V0R2VvbWV0cnkoKSxncmFwaCk7cmV0dXJuIXRoaXMuaGFzVW52aXNpdGVkU2hlbGxFZGdlKGVkZ2VSaW5ncyk7fTtqc3RzLm9wZXJhdGlvbi52YWxpZC5Db25uZWN0ZWRJbnRlcmlvclRlc3Rlci5wcm90b3R5cGUuc2V0SW50ZXJpb3JFZGdlc0luUmVzdWx0PWZ1bmN0aW9uKGdyYXBoKXt2YXIgaXQ9Z3JhcGguZ2V0RWRnZUVuZHMoKS5pdGVyYXRvcigpLGRlO3doaWxlKGl0Lmhhc05leHQoKSl7ZGU9aXQubmV4dCgpO2lmKGRlLmdldExhYmVsKCkuZ2V0TG9jYXRpb24oMCxqc3RzLmdlb21ncmFwaC5Qb3NpdGlvbi5SSUdIVCk9PWpzdHMuZ2VvbS5Mb2NhdGlvbi5JTlRFUklPUil7ZGUuc2V0SW5SZXN1bHQodHJ1ZSk7fX19O2pzdHMub3BlcmF0aW9uLnZhbGlkLkNvbm5lY3RlZEludGVyaW9yVGVzdGVyLnByb3RvdHlwZS5idWlsZEVkZ2VSaW5ncz1mdW5jdGlvbihkaXJFZGdlcyl7dmFyIGVkZ2VSaW5ncz1uZXcgamF2YXNjcmlwdC51dGlsLkFycmF5TGlzdCgpO2Zvcih2YXIgaXQ9ZGlyRWRnZXMuaXRlcmF0b3IoKTtpdC5oYXNOZXh0KCk7KXt2YXIgZGU9aXQubmV4dCgpO2lmKGRlLmlzSW5SZXN1bHQoKSYmZGUuZ2V0RWRnZVJpbmcoKT09bnVsbCl7dmFyIGVyPW5ldyBqc3RzLm9wZXJhdGlvbi5vdmVybGF5Lk1heGltYWxFZGdlUmluZyhkZSx0aGlzLmdlb21ldHJ5RmFjdG9yeSk7ZXIubGlua0RpcmVjdGVkRWRnZXNGb3JNaW5pbWFsRWRnZVJpbmdzKCk7dmFyIG1pbkVkZ2VSaW5ncz1lci5idWlsZE1pbmltYWxSaW5ncygpO3ZhciBpPTAsaWw9bWluRWRnZVJpbmdzLmxlbmd0aDtmb3IoaTtpPGlsO2krKyl7ZWRnZVJpbmdzLmFkZChtaW5FZGdlUmluZ3NbaV0pO319fVxucmV0dXJuIGVkZ2VSaW5nczt9O2pzdHMub3BlcmF0aW9uLnZhbGlkLkNvbm5lY3RlZEludGVyaW9yVGVzdGVyLnByb3RvdHlwZS52aXNpdFNoZWxsSW50ZXJpb3JzPWZ1bmN0aW9uKGcsZ3JhcGgpe2lmKGcgaW5zdGFuY2VvZiBqc3RzLmdlb20uUG9seWdvbil7dmFyIHA9Zzt0aGlzLnZpc2l0SW50ZXJpb3JSaW5nKHAuZ2V0RXh0ZXJpb3JSaW5nKCksZ3JhcGgpO31cbmlmKGcgaW5zdGFuY2VvZiBqc3RzLmdlb20uTXVsdGlQb2x5Z29uKXt2YXIgbXA9Zztmb3IodmFyIGk9MDtpPG1wLmdldE51bUdlb21ldHJpZXMoKTtpKyspe3ZhciBwPW1wLmdldEdlb21ldHJ5TihpKTt0aGlzLnZpc2l0SW50ZXJpb3JSaW5nKHAuZ2V0RXh0ZXJpb3JSaW5nKCksZ3JhcGgpO319fTtqc3RzLm9wZXJhdGlvbi52YWxpZC5Db25uZWN0ZWRJbnRlcmlvclRlc3Rlci5wcm90b3R5cGUudmlzaXRJbnRlcmlvclJpbmc9ZnVuY3Rpb24ocmluZyxncmFwaCl7dmFyIHB0cz1yaW5nLmdldENvb3JkaW5hdGVzKCk7dmFyIHB0MD1wdHNbMF07dmFyIHB0MT1qc3RzLm9wZXJhdGlvbi52YWxpZC5Db25uZWN0ZWRJbnRlcmlvclRlc3Rlci5maW5kRGlmZmVyZW50UG9pbnQocHRzLHB0MCk7dmFyIGU9Z3JhcGguZmluZEVkZ2VJblNhbWVEaXJlY3Rpb24ocHQwLHB0MSk7dmFyIGRlPWdyYXBoLmZpbmRFZGdlRW5kKGUpO3ZhciBpbnREZT1udWxsO2lmKGRlLmdldExhYmVsKCkuZ2V0TG9jYXRpb24oMCxqc3RzLmdlb21ncmFwaC5Qb3NpdGlvbi5SSUdIVCk9PWpzdHMuZ2VvbS5Mb2NhdGlvbi5JTlRFUklPUil7aW50RGU9ZGU7fWVsc2UgaWYoZGUuZ2V0U3ltKCkuZ2V0TGFiZWwoKS5nZXRMb2NhdGlvbigwLGpzdHMuZ2VvbWdyYXBoLlBvc2l0aW9uLlJJR0hUKT09anN0cy5nZW9tLkxvY2F0aW9uLklOVEVSSU9SKXtpbnREZT1kZS5nZXRTeW0oKTt9XG50aGlzLnZpc2l0TGlua2VkRGlyZWN0ZWRFZGdlcyhpbnREZSk7fTtqc3RzLm9wZXJhdGlvbi52YWxpZC5Db25uZWN0ZWRJbnRlcmlvclRlc3Rlci5wcm90b3R5cGUudmlzaXRMaW5rZWREaXJlY3RlZEVkZ2VzPWZ1bmN0aW9uKHN0YXJ0KXt2YXIgc3RhcnREZT1zdGFydDt2YXIgZGU9c3RhcnQ7ZG97ZGUuc2V0VmlzaXRlZCh0cnVlKTtkZT1kZS5nZXROZXh0KCk7fXdoaWxlKGRlIT1zdGFydERlKTt9O2pzdHMub3BlcmF0aW9uLnZhbGlkLkNvbm5lY3RlZEludGVyaW9yVGVzdGVyLnByb3RvdHlwZS5oYXNVbnZpc2l0ZWRTaGVsbEVkZ2U9ZnVuY3Rpb24oZWRnZVJpbmdzKXtmb3IodmFyIGk9MDtpPGVkZ2VSaW5ncy5zaXplKCk7aSsrKXt2YXIgZXI9ZWRnZVJpbmdzLmdldChpKTtpZihlci5pc0hvbGUoKSl7Y29udGludWU7fVxudmFyIGVkZ2VzPWVyLmdldEVkZ2VzKCk7dmFyIGRlPWVkZ2VzWzBdO2lmKGRlLmdldExhYmVsKCkuZ2V0TG9jYXRpb24oMCxqc3RzLmdlb21ncmFwaC5Qb3NpdGlvbi5SSUdIVCkhPWpzdHMuZ2VvbS5Mb2NhdGlvbi5JTlRFUklPUil7Y29udGludWU7fVxuZm9yKHZhciBqPTA7ajxlZGdlcy5sZW5ndGg7aisrKXtkZT1lZGdlc1tqXTtpZighZGUuaXNWaXNpdGVkKCkpe2Rpc2Nvbm5lY3RlZFJpbmdjb29yZD1kZS5nZXRDb29yZGluYXRlKCk7cmV0dXJuIHRydWU7fX19XG5yZXR1cm4gZmFsc2U7fTtqc3RzLmFsZ29yaXRobS5JbnRlcmlvclBvaW50TGluZT1mdW5jdGlvbihnZW9tZXRyeSl7dGhpcy5jZW50cm9pZDt0aGlzLm1pbkRpc3RhbmNlPU51bWJlci5NQVhfVkFMVUU7dGhpcy5pbnRlcmlvclBvaW50PW51bGw7dGhpcy5jZW50cm9pZD1nZW9tZXRyeS5nZXRDZW50cm9pZCgpLmdldENvb3JkaW5hdGUoKTt0aGlzLmFkZEludGVyaW9yKGdlb21ldHJ5KTtpZih0aGlzLmludGVyaW9yUG9pbnQ9PW51bGwpe3RoaXMuYWRkRW5kcG9pbnRzKGdlb21ldHJ5KTt9fTtqc3RzLmFsZ29yaXRobS5JbnRlcmlvclBvaW50TGluZS5wcm90b3R5cGUuZ2V0SW50ZXJpb3JQb2ludD1mdW5jdGlvbigpe3JldHVybiB0aGlzLmludGVyaW9yUG9pbnQ7fTtqc3RzLmFsZ29yaXRobS5JbnRlcmlvclBvaW50TGluZS5wcm90b3R5cGUuYWRkSW50ZXJpb3I9ZnVuY3Rpb24oZ2VvbWV0cnkpe2lmKGdlb21ldHJ5IGluc3RhbmNlb2YganN0cy5nZW9tLkxpbmVTdHJpbmcpe3RoaXMuYWRkSW50ZXJpb3JDb29yZChnZW9tZXRyeS5nZXRDb29yZGluYXRlcygpKTt9ZWxzZSBpZihnZW9tZXRyeSBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5HZW9tZXRyeUNvbGxlY3Rpb24pe2Zvcih2YXIgaT0wO2k8Z2VvbWV0cnkuZ2V0TnVtR2VvbWV0cmllcygpO2krKyl7dGhpcy5hZGRJbnRlcmlvcihnZW9tZXRyeS5nZXRHZW9tZXRyeU4oaSkpO319fTtqc3RzLmFsZ29yaXRobS5JbnRlcmlvclBvaW50TGluZS5wcm90b3R5cGUuYWRkSW50ZXJpb3JDb29yZD1mdW5jdGlvbihwdHMpe2Zvcih2YXIgaT0xO2k8cHRzLmxlbmd0aC0xO2krKyl7dGhpcy5hZGQocHRzW2ldKTt9fTtqc3RzLmFsZ29yaXRobS5JbnRlcmlvclBvaW50TGluZS5wcm90b3R5cGUuYWRkRW5kcG9pbnRzPWZ1bmN0aW9uKGdlb21ldHJ5KXtpZihnZW9tZXRyeSBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5MaW5lU3RyaW5nKXt0aGlzLmFkZEVuZHBvaW50c0Nvb3JkKGdlb21ldHJ5LmdldENvb3JkaW5hdGVzKCkpO31lbHNlIGlmKGdlb21ldHJ5IGluc3RhbmNlb2YganN0cy5nZW9tLkdlb21ldHJ5Q29sbGVjdGlvbil7Zm9yKHZhciBpPTA7aTxnZW9tZXRyeS5nZXROdW1HZW9tZXRyaWVzKCk7aSsrKXt0aGlzLmFkZEVuZHBvaW50cyhnZW9tZXRyeS5nZXRHZW9tZXRyeU4oaSkpO319fTtqc3RzLmFsZ29yaXRobS5JbnRlcmlvclBvaW50TGluZS5wcm90b3R5cGUuYWRkRW5kcG9pbnRzQ29vcmQ9ZnVuY3Rpb24ocHRzKXt0aGlzLmFkZChwdHNbMF0pO3RoaXMuYWRkKHB0c1twdHMubGVuZ3RoLTFdKTt9O2pzdHMuYWxnb3JpdGhtLkludGVyaW9yUG9pbnRMaW5lLnByb3RvdHlwZS5hZGQ9ZnVuY3Rpb24ocG9pbnQpe3ZhciBkaXN0PXBvaW50LmRpc3RhbmNlKHRoaXMuY2VudHJvaWQpO2lmKGRpc3Q8dGhpcy5taW5EaXN0YW5jZSl7dGhpcy5pbnRlcmlvclBvaW50PW5ldyBqc3RzLmdlb20uQ29vcmRpbmF0ZShwb2ludCk7dGhpcy5taW5EaXN0YW5jZT1kaXN0O319O2pzdHMuaW5kZXguY2hhaW4uTW9ub3RvbmVDaGFpblNlbGVjdEFjdGlvbj1mdW5jdGlvbigpe3RoaXMudGVtcEVudjE9bmV3IGpzdHMuZ2VvbS5FbnZlbG9wZSgpO3RoaXMuc2VsZWN0ZWRTZWdtZW50PW5ldyBqc3RzLmdlb20uTGluZVNlZ21lbnQoKTt9O2pzdHMuaW5kZXguY2hhaW4uTW9ub3RvbmVDaGFpblNlbGVjdEFjdGlvbi5wcm90b3R5cGUudGVtcEVudjE9bnVsbDtqc3RzLmluZGV4LmNoYWluLk1vbm90b25lQ2hhaW5TZWxlY3RBY3Rpb24ucHJvdG90eXBlLnNlbGVjdGVkU2VnbWVudD1udWxsO2pzdHMuaW5kZXguY2hhaW4uTW9ub3RvbmVDaGFpblNlbGVjdEFjdGlvbi5wcm90b3R5cGUuc2VsZWN0PWZ1bmN0aW9uKG1jLHN0YXJ0KXttYy5nZXRMaW5lU2VnbWVudChzdGFydCx0aGlzLnNlbGVjdGVkU2VnbWVudCk7dGhpcy5zZWxlY3QyKHRoaXMuc2VsZWN0ZWRTZWdtZW50KTt9O2pzdHMuaW5kZXguY2hhaW4uTW9ub3RvbmVDaGFpblNlbGVjdEFjdGlvbi5wcm90b3R5cGUuc2VsZWN0Mj1mdW5jdGlvbihzZWcpe307anN0cy5hbGdvcml0aG0uTUNQb2ludEluUmluZz1mdW5jdGlvbihyaW5nKXt0aGlzLnJpbmc9cmluZzt0aGlzLnRyZWU9bnVsbDt0aGlzLmNyb3NzaW5ncz0wO3RoaXMuaW50ZXJ2YWw9bmV3IGpzdHMuaW5kZXguYmludHJlZS5JbnRlcnZhbCgpO3RoaXMuYnVpbGRJbmRleCgpO307anN0cy5hbGdvcml0aG0uTUNQb2ludEluUmluZy5NQ1NlbGVjdGVyPWZ1bmN0aW9uKHAscGFyZW50KXt0aGlzLnBhcmVudD1wYXJlbnQ7dGhpcy5wPXA7fTtqc3RzLmFsZ29yaXRobS5NQ1BvaW50SW5SaW5nLk1DU2VsZWN0ZXIucHJvdG90eXBlPW5ldyBqc3RzLmluZGV4LmNoYWluLk1vbm90b25lQ2hhaW5TZWxlY3RBY3Rpb247anN0cy5hbGdvcml0aG0uTUNQb2ludEluUmluZy5NQ1NlbGVjdGVyLnByb3RvdHlwZS5jb25zdHJ1Y3Rvcj1qc3RzLmFsZ29yaXRobS5NQ1BvaW50SW5SaW5nLk1DU2VsZWN0ZXI7anN0cy5hbGdvcml0aG0uTUNQb2ludEluUmluZy5NQ1NlbGVjdGVyLnByb3RvdHlwZS5zZWxlY3QyPWZ1bmN0aW9uKGxzKXt0aGlzLnBhcmVudC50ZXN0TGluZVNlZ21lbnQuYXBwbHkodGhpcy5wYXJlbnQsW3RoaXMucCxsc10pO307anN0cy5hbGdvcml0aG0uTUNQb2ludEluUmluZy5wcm90b3R5cGUuYnVpbGRJbmRleD1mdW5jdGlvbigpe3RoaXMudHJlZT1uZXcganN0cy5pbmRleC5iaW50cmVlLkJpbnRyZWUoKTt2YXIgcHRzPWpzdHMuZ2VvbS5Db29yZGluYXRlQXJyYXlzLnJlbW92ZVJlcGVhdGVkUG9pbnRzKHRoaXMucmluZy5nZXRDb29yZGluYXRlcygpKTt2YXIgbWNMaXN0PWpzdHMuaW5kZXguY2hhaW4uTW9ub3RvbmVDaGFpbkJ1aWxkZXIuZ2V0Q2hhaW5zKHB0cyk7Zm9yKHZhciBpPTA7aTxtY0xpc3QubGVuZ3RoO2krKyl7dmFyIG1jPW1jTGlzdFtpXTt2YXIgbWNFbnY9bWMuZ2V0RW52ZWxvcGUoKTt0aGlzLmludGVydmFsLm1pbj1tY0Vudi5nZXRNaW5ZKCk7dGhpcy5pbnRlcnZhbC5tYXg9bWNFbnYuZ2V0TWF4WSgpO3RoaXMudHJlZS5pbnNlcnQodGhpcy5pbnRlcnZhbCxtYyk7fX07anN0cy5hbGdvcml0aG0uTUNQb2ludEluUmluZy5wcm90b3R5cGUuaXNJbnNpZGU9ZnVuY3Rpb24ocHQpe3RoaXMuY3Jvc3NpbmdzPTA7dmFyIHJheUVudj1uZXcganN0cy5nZW9tLkVudmVsb3BlKC1OdW1iZXIuTUFYX1ZBTFVFLE51bWJlci5NQVhfVkFMVUUscHQueSxwdC55KTt0aGlzLmludGVydmFsLm1pbj1wdC55O3RoaXMuaW50ZXJ2YWwubWF4PXB0Lnk7dmFyIHNlZ3M9dGhpcy50cmVlLnF1ZXJ5KHRoaXMuaW50ZXJ2YWwpO3ZhciBtY1NlbGVjdGVyPW5ldyBqc3RzLmFsZ29yaXRobS5NQ1BvaW50SW5SaW5nLk1DU2VsZWN0ZXIocHQsdGhpcyk7Zm9yKHZhciBpPXNlZ3MuaXRlcmF0b3IoKTtpLmhhc05leHQoKTspe3ZhciBtYz1pLm5leHQoKTt0aGlzLnRlc3RNb25vdG9uZUNoYWluKHJheUVudixtY1NlbGVjdGVyLG1jKTt9XG5pZigodGhpcy5jcm9zc2luZ3MlMik9PTEpe3JldHVybiB0cnVlO31cbnJldHVybiBmYWxzZTt9O2pzdHMuYWxnb3JpdGhtLk1DUG9pbnRJblJpbmcucHJvdG90eXBlLnRlc3RNb25vdG9uZUNoYWluPWZ1bmN0aW9uKHJheUVudixtY1NlbGVjdGVyLG1jKXttYy5zZWxlY3QocmF5RW52LG1jU2VsZWN0ZXIpO307anN0cy5hbGdvcml0aG0uTUNQb2ludEluUmluZy5wcm90b3R5cGUudGVzdExpbmVTZWdtZW50PWZ1bmN0aW9uKHAsc2VnKXt2YXIgeEludCx4MSx5MSx4Mix5MixwMSxwMjtwMT1zZWcucDA7cDI9c2VnLnAxO3gxPXAxLngtcC54O3kxPXAxLnktcC55O3gyPXAyLngtcC54O3kyPXAyLnktcC55O2lmKCgoeTE+MCkmJih5Mjw9MCkpfHwoKHkyPjApJiYoeTE8PTApKSl7eEludD1qc3RzLmFsZ29yaXRobS5Sb2J1c3REZXRlcm1pbmFudC5zaWduT2ZEZXQyeDIoeDEseTEseDIseTIpLyh5Mi15MSk7aWYoMC4wPHhJbnQpe3RoaXMuY3Jvc3NpbmdzKys7fX19O2pzdHMub3BlcmF0aW9uLnZhbGlkLlRvcG9sb2d5VmFsaWRhdGlvbkVycm9yPWZ1bmN0aW9uKGVycm9yVHlwZSxwdCl7dGhpcy5lcnJvclR5cGU9ZXJyb3JUeXBlO3RoaXMucHQ9bnVsbDtpZihwdCE9bnVsbCl7dGhpcy5wdD1wdC5jbG9uZSgpO319O2pzdHMub3BlcmF0aW9uLnZhbGlkLlRvcG9sb2d5VmFsaWRhdGlvbkVycm9yLkhPTEVfT1VUU0lERV9TSEVMTD0yO2pzdHMub3BlcmF0aW9uLnZhbGlkLlRvcG9sb2d5VmFsaWRhdGlvbkVycm9yLk5FU1RFRF9IT0xFUz0zO2pzdHMub3BlcmF0aW9uLnZhbGlkLlRvcG9sb2d5VmFsaWRhdGlvbkVycm9yLkRJU0NPTk5FQ1RFRF9JTlRFUklPUj00O2pzdHMub3BlcmF0aW9uLnZhbGlkLlRvcG9sb2d5VmFsaWRhdGlvbkVycm9yLlNFTEZfSU5URVJTRUNUSU9OPTU7anN0cy5vcGVyYXRpb24udmFsaWQuVG9wb2xvZ3lWYWxpZGF0aW9uRXJyb3IuUklOR19TRUxGX0lOVEVSU0VDVElPTj02O2pzdHMub3BlcmF0aW9uLnZhbGlkLlRvcG9sb2d5VmFsaWRhdGlvbkVycm9yLk5FU1RFRF9TSEVMTFM9Nztqc3RzLm9wZXJhdGlvbi52YWxpZC5Ub3BvbG9neVZhbGlkYXRpb25FcnJvci5EVVBMSUNBVEVfUklOR1M9ODtqc3RzLm9wZXJhdGlvbi52YWxpZC5Ub3BvbG9neVZhbGlkYXRpb25FcnJvci5UT09fRkVXX1BPSU5UUz05O2pzdHMub3BlcmF0aW9uLnZhbGlkLlRvcG9sb2d5VmFsaWRhdGlvbkVycm9yLklOVkFMSURfQ09PUkRJTkFURT0xMDtqc3RzLm9wZXJhdGlvbi52YWxpZC5Ub3BvbG9neVZhbGlkYXRpb25FcnJvci5SSU5HX05PVF9DTE9TRUQ9MTE7anN0cy5vcGVyYXRpb24udmFsaWQuVG9wb2xvZ3lWYWxpZGF0aW9uRXJyb3IucHJvdG90eXBlLmVyck1zZz1bJ1RvcG9sb2d5IFZhbGlkYXRpb24gRXJyb3InLCdSZXBlYXRlZCBQb2ludCcsJ0hvbGUgbGllcyBvdXRzaWRlIHNoZWxsJywnSG9sZXMgYXJlIG5lc3RlZCcsJ0ludGVyaW9yIGlzIGRpc2Nvbm5lY3RlZCcsJ1NlbGYtaW50ZXJzZWN0aW9uJywnUmluZyBTZWxmLWludGVyc2VjdGlvbicsJ05lc3RlZCBzaGVsbHMnLCdEdXBsaWNhdGUgUmluZ3MnLCdUb28gZmV3IGRpc3RpbmN0IHBvaW50cyBpbiBnZW9tZXRyeSBjb21wb25lbnQnLCdJbnZhbGlkIENvb3JkaW5hdGUnLCdSaW5nIGlzIG5vdCBjbG9zZWQnXTtqc3RzLm9wZXJhdGlvbi52YWxpZC5Ub3BvbG9neVZhbGlkYXRpb25FcnJvci5wcm90b3R5cGUuZ2V0Q29vcmRpbmF0ZT1mdW5jdGlvbigpe3JldHVybiB0aGlzLnB0O307anN0cy5vcGVyYXRpb24udmFsaWQuVG9wb2xvZ3lWYWxpZGF0aW9uRXJyb3IucHJvdG90eXBlLmdldEVycm9yVHlwZT1mdW5jdGlvbigpe3JldHVybiB0aGlzLmVycm9yVHlwZTt9O2pzdHMub3BlcmF0aW9uLnZhbGlkLlRvcG9sb2d5VmFsaWRhdGlvbkVycm9yLnByb3RvdHlwZS5nZXRNZXNzYWdlPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZXJyTXNnW3RoaXMuZXJyb3JUeXBlXTt9O2pzdHMub3BlcmF0aW9uLnZhbGlkLlRvcG9sb2d5VmFsaWRhdGlvbkVycm9yLnByb3RvdHlwZS50b1N0cmluZz1mdW5jdGlvbigpe3ZhciBsb2NTdHI9Jyc7aWYodGhpcy5wdCE9bnVsbCl7bG9jU3RyPScgYXQgb3IgbmVhciBwb2ludCAnK3RoaXMucHQ7cmV0dXJuIHRoaXMuZ2V0TWVzc2FnZSgpK2xvY1N0cjt9XG5yZXR1cm4gbG9jU3RyO307KGZ1bmN0aW9uKCl7anN0cy5nZW9tLk11bHRpUG9seWdvbj1mdW5jdGlvbihnZW9tZXRyaWVzLGZhY3Rvcnkpe3RoaXMuZ2VvbWV0cmllcz1nZW9tZXRyaWVzfHxbXTt0aGlzLmZhY3Rvcnk9ZmFjdG9yeTt9O2pzdHMuZ2VvbS5NdWx0aVBvbHlnb24ucHJvdG90eXBlPW5ldyBqc3RzLmdlb20uR2VvbWV0cnlDb2xsZWN0aW9uKCk7anN0cy5nZW9tLk11bHRpUG9seWdvbi5jb25zdHJ1Y3Rvcj1qc3RzLmdlb20uTXVsdGlQb2x5Z29uO2pzdHMuZ2VvbS5NdWx0aVBvbHlnb24ucHJvdG90eXBlLmdldEJvdW5kYXJ5PWZ1bmN0aW9uKCl7aWYodGhpcy5pc0VtcHR5KCkpe3JldHVybiB0aGlzLmdldEZhY3RvcnkoKS5jcmVhdGVNdWx0aUxpbmVTdHJpbmcobnVsbCk7fVxudmFyIGFsbFJpbmdzPVtdO2Zvcih2YXIgaT0wO2k8dGhpcy5nZW9tZXRyaWVzLmxlbmd0aDtpKyspe3ZhciBwb2x5Z29uPXRoaXMuZ2VvbWV0cmllc1tpXTt2YXIgcmluZ3M9cG9seWdvbi5nZXRCb3VuZGFyeSgpO2Zvcih2YXIgaj0wO2o8cmluZ3MuZ2V0TnVtR2VvbWV0cmllcygpO2orKyl7YWxsUmluZ3MucHVzaChyaW5ncy5nZXRHZW9tZXRyeU4oaikpO319XG5yZXR1cm4gdGhpcy5nZXRGYWN0b3J5KCkuY3JlYXRlTXVsdGlMaW5lU3RyaW5nKGFsbFJpbmdzKTt9O2pzdHMuZ2VvbS5NdWx0aVBvbHlnb24ucHJvdG90eXBlLmVxdWFsc0V4YWN0PWZ1bmN0aW9uKG90aGVyLHRvbGVyYW5jZSl7aWYoIXRoaXMuaXNFcXVpdmFsZW50Q2xhc3Mob3RoZXIpKXtyZXR1cm4gZmFsc2U7fVxucmV0dXJuIGpzdHMuZ2VvbS5HZW9tZXRyeUNvbGxlY3Rpb24ucHJvdG90eXBlLmVxdWFsc0V4YWN0LmNhbGwodGhpcyxvdGhlcix0b2xlcmFuY2UpO307anN0cy5nZW9tLk11bHRpUG9seWdvbi5wcm90b3R5cGUuQ0xBU1NfTkFNRT0nanN0cy5nZW9tLk11bHRpUG9seWdvbic7fSkoKTtqc3RzLmdlb20uQ29vcmRpbmF0ZVNlcXVlbmNlRmlsdGVyPWZ1bmN0aW9uKCl7fTtqc3RzLmdlb20uQ29vcmRpbmF0ZVNlcXVlbmNlRmlsdGVyLnByb3RvdHlwZS5maWx0ZXI9anN0cy5hYnN0cmFjdEZ1bmM7anN0cy5nZW9tLkNvb3JkaW5hdGVTZXF1ZW5jZUZpbHRlci5wcm90b3R5cGUuaXNEb25lPWpzdHMuYWJzdHJhY3RGdW5jO2pzdHMuZ2VvbS5Db29yZGluYXRlU2VxdWVuY2VGaWx0ZXIucHJvdG90eXBlLmlzR2VvbWV0cnlDaGFuZ2VkPWpzdHMuYWJzdHJhY3RGdW5jOyhmdW5jdGlvbigpe3ZhciBJbnRlcnZhbD1mdW5jdGlvbigpe3RoaXMubWluPTAuMDt0aGlzLm1heD0wLjA7aWYoYXJndW1lbnRzLmxlbmd0aD09PTEpe3ZhciBpbnRlcnZhbD1hcmd1bWVudHNbMF07dGhpcy5pbml0KGludGVydmFsLm1pbixpbnRlcnZhbC5tYXgpO31lbHNlIGlmKGFyZ3VtZW50cy5sZW5ndGg9PT0yKXt0aGlzLmluaXQoYXJndW1lbnRzWzBdLGFyZ3VtZW50c1sxXSk7fX07SW50ZXJ2YWwucHJvdG90eXBlLmluaXQ9ZnVuY3Rpb24obWluLG1heCl7dGhpcy5taW49bWluO3RoaXMubWF4PW1heDtpZihtaW4+bWF4KXt0aGlzLm1pbj1tYXg7dGhpcy5tYXg9bWluO319O0ludGVydmFsLnByb3RvdHlwZS5nZXRNaW49ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5taW47fTtJbnRlcnZhbC5wcm90b3R5cGUuZ2V0TWF4PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMubWF4O307SW50ZXJ2YWwucHJvdG90eXBlLmdldFdpZHRoPWZ1bmN0aW9uKCl7cmV0dXJuKHRoaXMubWF4LXRoaXMubWluKTt9O0ludGVydmFsLnByb3RvdHlwZS5leHBhbmRUb0luY2x1ZGU9ZnVuY3Rpb24oaW50ZXJ2YWwpe2lmKGludGVydmFsLm1heD50aGlzLm1heCl7dGhpcy5tYXg9aW50ZXJ2YWwubWF4O31cbmlmKGludGVydmFsLm1pbjx0aGlzLm1pbil7dGhpcy5taW49aW50ZXJ2YWwubWluO319O0ludGVydmFsLnByb3RvdHlwZS5vdmVybGFwcz1mdW5jdGlvbigpe2lmKGFyZ3VtZW50cy5sZW5ndGg9PT0xKXtyZXR1cm4gdGhpcy5vdmVybGFwc0ludGVydmFsLmFwcGx5KHRoaXMsYXJndW1lbnRzKTt9ZWxzZXtyZXR1cm4gdGhpcy5vdmVybGFwc01pbk1heC5hcHBseSh0aGlzLGFyZ3VtZW50cyk7fX07SW50ZXJ2YWwucHJvdG90eXBlLm92ZXJsYXBzSW50ZXJ2YWw9ZnVuY3Rpb24oaW50ZXJ2YWwpe3JldHVybiB0aGlzLm92ZXJsYXBzKGludGVydmFsLm1pbixpbnRlcnZhbC5tYXgpO307SW50ZXJ2YWwucHJvdG90eXBlLm92ZXJsYXBzTWluTWF4PWZ1bmN0aW9uKG1pbixtYXgpe2lmKHRoaXMubWluPm1heHx8dGhpcy5tYXg8bWluKXtyZXR1cm4gZmFsc2U7fVxucmV0dXJuIHRydWU7fTtJbnRlcnZhbC5wcm90b3R5cGUuY29udGFpbnM9ZnVuY3Rpb24oKXt2YXIgaW50ZXJ2YWw7aWYoYXJndW1lbnRzWzBdaW5zdGFuY2VvZiBqc3RzLmluZGV4LmJpbnRyZWUuSW50ZXJ2YWwpe2ludGVydmFsPWFyZ3VtZW50c1swXTtyZXR1cm4gdGhpcy5jb250YWluc01pbk1heChpbnRlcnZhbC5taW4saW50ZXJ2YWwubWF4KTt9ZWxzZSBpZihhcmd1bWVudHMubGVuZ3RoPT09MSl7cmV0dXJuIHRoaXMuY29udGFpbnNQb2ludChhcmd1bWVudHNbMF0pO31lbHNle3JldHVybiB0aGlzLmNvbnRhaW5zTWluTWF4KGFyZ3VtZW50c1swXSxhcmd1bWVudHNbMV0pO319O0ludGVydmFsLnByb3RvdHlwZS5jb250YWluc01pbk1heD1mdW5jdGlvbihtaW4sbWF4KXtyZXR1cm4obWluPj10aGlzLm1pbiYmbWF4PD10aGlzLm1heCk7fTtJbnRlcnZhbC5wcm90b3R5cGUuY29udGFpbnNQb2ludD1mdW5jdGlvbihwKXtyZXR1cm4ocD49dGhpcy5taW4mJnA8PXRoaXMubWF4KTt9O2pzdHMuaW5kZXguYmludHJlZS5JbnRlcnZhbD1JbnRlcnZhbDt9KSgpO2pzdHMuaW5kZXguRG91YmxlQml0cz1mdW5jdGlvbigpe307anN0cy5pbmRleC5Eb3VibGVCaXRzLnBvd2VyT2YyPWZ1bmN0aW9uKGV4cCl7cmV0dXJuIE1hdGgucG93KDIsZXhwKTt9O2pzdHMuaW5kZXguRG91YmxlQml0cy5leHBvbmVudD1mdW5jdGlvbihkKXtyZXR1cm4ganN0cy5pbmRleC5Eb3VibGVCaXRzLkNWVEZXRCg2NCxkKS0xMDIzO307anN0cy5pbmRleC5Eb3VibGVCaXRzLkNWVEZXRD1mdW5jdGlvbihOdW1XLFF0eSl7dmFyIFNpZ24sRXhwbyxNYW50LEJpbixuYjAxPScnO3ZhciBJbmY9ezMyOntkOjB4N0YsYzoweDgwLGI6MCxhOjB9LDY0OntkOjB4N0ZGMCxjOjAsYjowLGE6MH19O3ZhciBFeFc9ezMyOjgsNjQ6MTF9W051bVddLE10Vz1OdW1XLUV4Vy0xO2lmKCFCaW4pe1NpZ249UXR5PDB8fDEvUXR5PDA7aWYoIWlzRmluaXRlKFF0eSkpe0Jpbj1JbmZbTnVtV107aWYoU2lnbil7QmluLmQrPTE8PChOdW1XLzQtMSk7fVxuRXhwbz1NYXRoLnBvdygyLEV4VyktMTtNYW50PTA7fX1cbmlmKCFCaW4pe0V4cG89ezMyOjEyNyw2NDoxMDIzfVtOdW1XXTtNYW50PU1hdGguYWJzKFF0eSk7d2hpbGUoTWFudD49Mil7RXhwbysrO01hbnQvPTI7fVxud2hpbGUoTWFudDwxJiZFeHBvPjApe0V4cG8tLTtNYW50Kj0yO31cbmlmKEV4cG88PTApe01hbnQvPTI7bmIwMT0nWmVybyBvciBEZW5vcm1hbCc7fVxuaWYoTnVtVz09PTMyJiZFeHBvPjI1NCl7bmIwMT0nVG9vIGJpZyBmb3IgU2luZ2xlJztCaW49e2Q6U2lnbj8weEZGOjB4N0YsYzoweDgwLGI6MCxhOjB9O0V4cG89TWF0aC5wb3coMixFeFcpLTE7TWFudD0wO319XG5yZXR1cm4gRXhwbzt9OyhmdW5jdGlvbigpe3ZhciBEb3VibGVCaXRzPWpzdHMuaW5kZXguRG91YmxlQml0czt2YXIgSW50ZXJ2YWw9anN0cy5pbmRleC5iaW50cmVlLkludGVydmFsO3ZhciBLZXk9ZnVuY3Rpb24oaW50ZXJ2YWwpe3RoaXMucHQ9MC4wO3RoaXMubGV2ZWw9MDt0aGlzLmNvbXB1dGVLZXkoaW50ZXJ2YWwpO307S2V5LmNvbXB1dGVMZXZlbD1mdW5jdGlvbihpbnRlcnZhbCl7dmFyIGR4PWludGVydmFsLmdldFdpZHRoKCksbGV2ZWw7bGV2ZWw9RG91YmxlQml0cy5leHBvbmVudChkeCkrMTtyZXR1cm4gbGV2ZWw7fTtLZXkucHJvdG90eXBlLmdldFBvaW50PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMucHQ7fTtLZXkucHJvdG90eXBlLmdldExldmVsPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMubGV2ZWw7fTtLZXkucHJvdG90eXBlLmdldEludGVydmFsPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuaW50ZXJ2YWw7fTtLZXkucHJvdG90eXBlLmNvbXB1dGVLZXk9ZnVuY3Rpb24oaXRlbUludGVydmFsKXt0aGlzLmxldmVsPUtleS5jb21wdXRlTGV2ZWwoaXRlbUludGVydmFsKTt0aGlzLmludGVydmFsPW5ldyBJbnRlcnZhbCgpO3RoaXMuY29tcHV0ZUludGVydmFsKHRoaXMubGV2ZWwsaXRlbUludGVydmFsKTt3aGlsZSghdGhpcy5pbnRlcnZhbC5jb250YWlucyhpdGVtSW50ZXJ2YWwpKXt0aGlzLmxldmVsKz0xO3RoaXMuY29tcHV0ZUludGVydmFsKHRoaXMubGV2ZWwsaXRlbUludGVydmFsKTt9fTtLZXkucHJvdG90eXBlLmNvbXB1dGVJbnRlcnZhbD1mdW5jdGlvbihsZXZlbCxpdGVtSW50ZXJ2YWwpe3ZhciBzaXplPURvdWJsZUJpdHMucG93ZXJPZjIobGV2ZWwpO3RoaXMucHQ9TWF0aC5mbG9vcihpdGVtSW50ZXJ2YWwuZ2V0TWluKCkvc2l6ZSkqc2l6ZTt0aGlzLmludGVydmFsLmluaXQodGhpcy5wdCx0aGlzLnB0K3NpemUpO307anN0cy5pbmRleC5iaW50cmVlLktleT1LZXk7fSkoKTtqc3RzLm9wZXJhdGlvbi5idWZmZXIuU3ViZ3JhcGhEZXB0aExvY2F0ZXI9ZnVuY3Rpb24oc3ViZ3JhcGhzKXt0aGlzLnN1YmdyYXBocz1bXTt0aGlzLnNlZz1uZXcganN0cy5nZW9tLkxpbmVTZWdtZW50KCk7dGhpcy5zdWJncmFwaHM9c3ViZ3JhcGhzO307anN0cy5vcGVyYXRpb24uYnVmZmVyLlN1YmdyYXBoRGVwdGhMb2NhdGVyLnByb3RvdHlwZS5zdWJncmFwaHM9bnVsbDtqc3RzLm9wZXJhdGlvbi5idWZmZXIuU3ViZ3JhcGhEZXB0aExvY2F0ZXIucHJvdG90eXBlLnNlZz1udWxsO2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5TdWJncmFwaERlcHRoTG9jYXRlci5wcm90b3R5cGUuZ2V0RGVwdGg9ZnVuY3Rpb24ocCl7dmFyIHN0YWJiZWRTZWdtZW50cz10aGlzLmZpbmRTdGFiYmVkU2VnbWVudHMocCk7aWYoc3RhYmJlZFNlZ21lbnRzLmxlbmd0aD09PTApXG5yZXR1cm4gMDtzdGFiYmVkU2VnbWVudHMuc29ydCgpO3ZhciBkcz1zdGFiYmVkU2VnbWVudHNbMF07cmV0dXJuIGRzLmxlZnREZXB0aDt9O2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5TdWJncmFwaERlcHRoTG9jYXRlci5wcm90b3R5cGUuZmluZFN0YWJiZWRTZWdtZW50cz1mdW5jdGlvbihzdGFiYmluZ1JheUxlZnRQdCl7aWYoYXJndW1lbnRzLmxlbmd0aD09PTMpe3RoaXMuZmluZFN0YWJiZWRTZWdtZW50czIuYXBwbHkodGhpcyxhcmd1bWVudHMpO3JldHVybjt9XG52YXIgc3RhYmJlZFNlZ21lbnRzPVtdO2Zvcih2YXIgaT0wO2k8dGhpcy5zdWJncmFwaHMubGVuZ3RoO2krKyl7dmFyIGJzZz10aGlzLnN1YmdyYXBoc1tpXTt2YXIgZW52PWJzZy5nZXRFbnZlbG9wZSgpO2lmKHN0YWJiaW5nUmF5TGVmdFB0Lnk8ZW52LmdldE1pblkoKXx8c3RhYmJpbmdSYXlMZWZ0UHQueT5lbnYuZ2V0TWF4WSgpKVxuY29udGludWU7dGhpcy5maW5kU3RhYmJlZFNlZ21lbnRzMihzdGFiYmluZ1JheUxlZnRQdCxic2cuZ2V0RGlyZWN0ZWRFZGdlcygpLHN0YWJiZWRTZWdtZW50cyk7fVxucmV0dXJuIHN0YWJiZWRTZWdtZW50czt9O2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5TdWJncmFwaERlcHRoTG9jYXRlci5wcm90b3R5cGUuZmluZFN0YWJiZWRTZWdtZW50czI9ZnVuY3Rpb24oc3RhYmJpbmdSYXlMZWZ0UHQsZGlyRWRnZXMsc3RhYmJlZFNlZ21lbnRzKXtpZihhcmd1bWVudHNbMV1pbnN0YW5jZW9mIGpzdHMuZ2VvbWdyYXBoLkRpcmVjdGVkRWRnZSl7dGhpcy5maW5kU3RhYmJlZFNlZ21lbnRzMyhzdGFiYmluZ1JheUxlZnRQdCxkaXJFZGdlcyxzdGFiYmVkU2VnbWVudHMpO3JldHVybjt9XG5mb3IodmFyIGk9ZGlyRWRnZXMuaXRlcmF0b3IoKTtpLmhhc05leHQoKTspe3ZhciBkZT1pLm5leHQoKTtpZighZGUuaXNGb3J3YXJkKCkpXG5jb250aW51ZTt0aGlzLmZpbmRTdGFiYmVkU2VnbWVudHMzKHN0YWJiaW5nUmF5TGVmdFB0LGRlLHN0YWJiZWRTZWdtZW50cyk7fX07anN0cy5vcGVyYXRpb24uYnVmZmVyLlN1YmdyYXBoRGVwdGhMb2NhdGVyLnByb3RvdHlwZS5maW5kU3RhYmJlZFNlZ21lbnRzMz1mdW5jdGlvbihzdGFiYmluZ1JheUxlZnRQdCxkaXJFZGdlLHN0YWJiZWRTZWdtZW50cyl7dmFyIHB0cz1kaXJFZGdlLmdldEVkZ2UoKS5nZXRDb29yZGluYXRlcygpO2Zvcih2YXIgaT0wO2k8cHRzLmxlbmd0aC0xO2krKyl7dGhpcy5zZWcucDA9cHRzW2ldO3RoaXMuc2VnLnAxPXB0c1tpKzFdO2lmKHRoaXMuc2VnLnAwLnk+dGhpcy5zZWcucDEueSlcbnRoaXMuc2VnLnJldmVyc2UoKTt2YXIgbWF4eD1NYXRoLm1heCh0aGlzLnNlZy5wMC54LHRoaXMuc2VnLnAxLngpO2lmKG1heHg8c3RhYmJpbmdSYXlMZWZ0UHQueClcbmNvbnRpbnVlO2lmKHRoaXMuc2VnLmlzSG9yaXpvbnRhbCgpKVxuY29udGludWU7aWYoc3RhYmJpbmdSYXlMZWZ0UHQueTx0aGlzLnNlZy5wMC55fHxzdGFiYmluZ1JheUxlZnRQdC55PnRoaXMuc2VnLnAxLnkpXG5jb250aW51ZTtpZihqc3RzLmFsZ29yaXRobS5DR0FsZ29yaXRobXMuY29tcHV0ZU9yaWVudGF0aW9uKHRoaXMuc2VnLnAwLHRoaXMuc2VnLnAxLHN0YWJiaW5nUmF5TGVmdFB0KT09PWpzdHMuYWxnb3JpdGhtLkNHQWxnb3JpdGhtcy5SSUdIVClcbmNvbnRpbnVlO3ZhciBkZXB0aD1kaXJFZGdlLmdldERlcHRoKGpzdHMuZ2VvbWdyYXBoLlBvc2l0aW9uLkxFRlQpO2lmKCF0aGlzLnNlZy5wMC5lcXVhbHMocHRzW2ldKSlcbmRlcHRoPWRpckVkZ2UuZ2V0RGVwdGgoanN0cy5nZW9tZ3JhcGguUG9zaXRpb24uUklHSFQpO3ZhciBkcz1uZXcganN0cy5vcGVyYXRpb24uYnVmZmVyLlN1YmdyYXBoRGVwdGhMb2NhdGVyLkRlcHRoU2VnbWVudCh0aGlzLnNlZyxkZXB0aCk7c3RhYmJlZFNlZ21lbnRzLnB1c2goZHMpO319O2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5TdWJncmFwaERlcHRoTG9jYXRlci5EZXB0aFNlZ21lbnQ9ZnVuY3Rpb24oc2VnLGRlcHRoKXt0aGlzLnVwd2FyZFNlZz1uZXcganN0cy5nZW9tLkxpbmVTZWdtZW50KHNlZyk7dGhpcy5sZWZ0RGVwdGg9ZGVwdGg7fTtqc3RzLm9wZXJhdGlvbi5idWZmZXIuU3ViZ3JhcGhEZXB0aExvY2F0ZXIuRGVwdGhTZWdtZW50LnByb3RvdHlwZS51cHdhcmRTZWc9bnVsbDtqc3RzLm9wZXJhdGlvbi5idWZmZXIuU3ViZ3JhcGhEZXB0aExvY2F0ZXIuRGVwdGhTZWdtZW50LnByb3RvdHlwZS5sZWZ0RGVwdGg9bnVsbDtqc3RzLm9wZXJhdGlvbi5idWZmZXIuU3ViZ3JhcGhEZXB0aExvY2F0ZXIuRGVwdGhTZWdtZW50LnByb3RvdHlwZS5jb21wYXJlVG89ZnVuY3Rpb24ob2JqKXt2YXIgb3RoZXI9b2JqO3ZhciBvcmllbnRJbmRleD10aGlzLnVwd2FyZFNlZy5vcmllbnRhdGlvbkluZGV4KG90aGVyLnVwd2FyZFNlZyk7aWYob3JpZW50SW5kZXg9PT0wKVxub3JpZW50SW5kZXg9LTEqb3RoZXIudXB3YXJkU2VnLm9yaWVudGF0aW9uSW5kZXgodXB3YXJkU2VnKTtpZihvcmllbnRJbmRleCE9PTApXG5yZXR1cm4gb3JpZW50SW5kZXg7cmV0dXJuIHRoaXMuY29tcGFyZVgodGhpcy51cHdhcmRTZWcsb3RoZXIudXB3YXJkU2VnKTt9O2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5TdWJncmFwaERlcHRoTG9jYXRlci5EZXB0aFNlZ21lbnQucHJvdG90eXBlLmNvbXBhcmVYPWZ1bmN0aW9uKHNlZzAsc2VnMSl7dmFyIGNvbXBhcmUwPXNlZzAucDAuY29tcGFyZVRvKHNlZzEucDApO2lmKGNvbXBhcmUwIT09MClcbnJldHVybiBjb21wYXJlMDtyZXR1cm4gc2VnMC5wMS5jb21wYXJlVG8oc2VnMS5wMSk7fTtqc3RzLm5vZGluZy5zbmFwcm91bmQuSG90UGl4ZWw9ZnVuY3Rpb24ocHQsc2NhbGVGYWN0b3IsbGkpe3RoaXMuY29ybmVyPVtdO3RoaXMub3JpZ2luYWxQdD1wdDt0aGlzLnB0PXB0O3RoaXMuc2NhbGVGYWN0b3I9c2NhbGVGYWN0b3I7dGhpcy5saT1saTtpZih0aGlzLnNjYWxlRmFjdG9yIT09MS4wKXt0aGlzLnB0PW5ldyBqc3RzLmdlb20uQ29vcmRpbmF0ZSh0aGlzLnNjYWxlKHB0LngpLHRoaXMuc2NhbGUocHQueSkpO3RoaXMucDBTY2FsZWQ9bmV3IGpzdHMuZ2VvbS5Db29yZGluYXRlKCk7dGhpcy5wMVNjYWxlZD1uZXcganN0cy5nZW9tLkNvb3JkaW5hdGUoKTt9XG50aGlzLmluaXRDb3JuZXJzKHRoaXMucHQpO307anN0cy5ub2Rpbmcuc25hcHJvdW5kLkhvdFBpeGVsLnByb3RvdHlwZS5saT1udWxsO2pzdHMubm9kaW5nLnNuYXByb3VuZC5Ib3RQaXhlbC5wcm90b3R5cGUucHQ9bnVsbDtqc3RzLm5vZGluZy5zbmFwcm91bmQuSG90UGl4ZWwucHJvdG90eXBlLm9yaWdpbmFsUHQ9bnVsbDtqc3RzLm5vZGluZy5zbmFwcm91bmQuSG90UGl4ZWwucHJvdG90eXBlLnB0U2NhbGVkPW51bGw7anN0cy5ub2Rpbmcuc25hcHJvdW5kLkhvdFBpeGVsLnByb3RvdHlwZS5wMFNjYWxlZD1udWxsO2pzdHMubm9kaW5nLnNuYXByb3VuZC5Ib3RQaXhlbC5wcm90b3R5cGUucDFTY2FsZWQ9bnVsbDtqc3RzLm5vZGluZy5zbmFwcm91bmQuSG90UGl4ZWwucHJvdG90eXBlLnNjYWxlRmFjdG9yPXVuZGVmaW5lZDtqc3RzLm5vZGluZy5zbmFwcm91bmQuSG90UGl4ZWwucHJvdG90eXBlLm1pbng9dW5kZWZpbmVkO2pzdHMubm9kaW5nLnNuYXByb3VuZC5Ib3RQaXhlbC5wcm90b3R5cGUubWF4eD11bmRlZmluZWQ7anN0cy5ub2Rpbmcuc25hcHJvdW5kLkhvdFBpeGVsLnByb3RvdHlwZS5taW55PXVuZGVmaW5lZDtqc3RzLm5vZGluZy5zbmFwcm91bmQuSG90UGl4ZWwucHJvdG90eXBlLm1heHk9dW5kZWZpbmVkO2pzdHMubm9kaW5nLnNuYXByb3VuZC5Ib3RQaXhlbC5wcm90b3R5cGUuY29ybmVyPW51bGw7anN0cy5ub2Rpbmcuc25hcHJvdW5kLkhvdFBpeGVsLnByb3RvdHlwZS5zYWZlRW52PW51bGw7anN0cy5ub2Rpbmcuc25hcHJvdW5kLkhvdFBpeGVsLnByb3RvdHlwZS5nZXRDb29yZGluYXRlPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMub3JpZ2luYWxQdDt9O2pzdHMubm9kaW5nLnNuYXByb3VuZC5Ib3RQaXhlbC5TQUZFX0VOVl9FWFBBTlNJT05fRkFDVE9SPTAuNzU7anN0cy5ub2Rpbmcuc25hcHJvdW5kLkhvdFBpeGVsLnByb3RvdHlwZS5nZXRTYWZlRW52ZWxvcGU9ZnVuY3Rpb24oKXtpZih0aGlzLnNhZmVFbnY9PT1udWxsKXt2YXIgc2FmZVRvbGVyYW5jZT1qc3RzLm5vZGluZy5zbmFwcm91bmQuSG90UGl4ZWwuU0FGRV9FTlZfRVhQQU5TSU9OX0ZBQ1RPUi90aGlzLnNjYWxlRmFjdG9yO3RoaXMuc2FmZUVudj1uZXcganN0cy5nZW9tLkVudmVsb3BlKHRoaXMub3JpZ2luYWxQdC54LXNhZmVUb2xlcmFuY2UsdGhpcy5vcmlnaW5hbFB0Lngrc2FmZVRvbGVyYW5jZSx0aGlzLm9yaWdpbmFsUHQueS1zYWZlVG9sZXJhbmNlLHRoaXMub3JpZ2luYWxQdC55K3NhZmVUb2xlcmFuY2UpO31cbnJldHVybiB0aGlzLnNhZmVFbnY7fTtqc3RzLm5vZGluZy5zbmFwcm91bmQuSG90UGl4ZWwucHJvdG90eXBlLmluaXRDb3JuZXJzPWZ1bmN0aW9uKHB0KXt2YXIgdG9sZXJhbmNlPTAuNTt0aGlzLm1pbng9cHQueC10b2xlcmFuY2U7dGhpcy5tYXh4PXB0LngrdG9sZXJhbmNlO3RoaXMubWlueT1wdC55LXRvbGVyYW5jZTt0aGlzLm1heHk9cHQueSt0b2xlcmFuY2U7dGhpcy5jb3JuZXJbMF09bmV3IGpzdHMuZ2VvbS5Db29yZGluYXRlKHRoaXMubWF4eCx0aGlzLm1heHkpO3RoaXMuY29ybmVyWzFdPW5ldyBqc3RzLmdlb20uQ29vcmRpbmF0ZSh0aGlzLm1pbngsdGhpcy5tYXh5KTt0aGlzLmNvcm5lclsyXT1uZXcganN0cy5nZW9tLkNvb3JkaW5hdGUodGhpcy5taW54LHRoaXMubWlueSk7dGhpcy5jb3JuZXJbM109bmV3IGpzdHMuZ2VvbS5Db29yZGluYXRlKHRoaXMubWF4eCx0aGlzLm1pbnkpO307anN0cy5ub2Rpbmcuc25hcHJvdW5kLkhvdFBpeGVsLnByb3RvdHlwZS5zY2FsZT1mdW5jdGlvbih2YWwpe3JldHVybiBNYXRoLnJvdW5kKHZhbCp0aGlzLnNjYWxlRmFjdG9yKTt9O2pzdHMubm9kaW5nLnNuYXByb3VuZC5Ib3RQaXhlbC5wcm90b3R5cGUuaW50ZXJzZWN0cz1mdW5jdGlvbihwMCxwMSl7aWYodGhpcy5zY2FsZUZhY3Rvcj09PTEuMClcbnJldHVybiB0aGlzLmludGVyc2VjdHNTY2FsZWQocDAscDEpO3RoaXMuY29weVNjYWxlZChwMCx0aGlzLnAwU2NhbGVkKTt0aGlzLmNvcHlTY2FsZWQocDEsdGhpcy5wMVNjYWxlZCk7cmV0dXJuIHRoaXMuaW50ZXJzZWN0c1NjYWxlZCh0aGlzLnAwU2NhbGVkLHRoaXMucDFTY2FsZWQpO307anN0cy5ub2Rpbmcuc25hcHJvdW5kLkhvdFBpeGVsLnByb3RvdHlwZS5jb3B5U2NhbGVkPWZ1bmN0aW9uKHAscFNjYWxlZCl7cFNjYWxlZC54PXRoaXMuc2NhbGUocC54KTtwU2NhbGVkLnk9dGhpcy5zY2FsZShwLnkpO307anN0cy5ub2Rpbmcuc25hcHJvdW5kLkhvdFBpeGVsLnByb3RvdHlwZS5pbnRlcnNlY3RzU2NhbGVkPWZ1bmN0aW9uKHAwLHAxKXt2YXIgc2VnTWlueD1NYXRoLm1pbihwMC54LHAxLngpO3ZhciBzZWdNYXh4PU1hdGgubWF4KHAwLngscDEueCk7dmFyIHNlZ01pbnk9TWF0aC5taW4ocDAueSxwMS55KTt2YXIgc2VnTWF4eT1NYXRoLm1heChwMC55LHAxLnkpO3ZhciBpc091dHNpZGVQaXhlbEVudj10aGlzLm1heHg8c2VnTWlueHx8dGhpcy5taW54PnNlZ01heHh8fHRoaXMubWF4eTxzZWdNaW55fHx0aGlzLm1pbnk+c2VnTWF4eTtpZihpc091dHNpZGVQaXhlbEVudilcbnJldHVybiBmYWxzZTt2YXIgaW50ZXJzZWN0cz10aGlzLmludGVyc2VjdHNUb2xlcmFuY2VTcXVhcmUocDAscDEpO2pzdHMudXRpbC5Bc3NlcnQuaXNUcnVlKCEoaXNPdXRzaWRlUGl4ZWxFbnYmJmludGVyc2VjdHMpLCdGb3VuZCBiYWQgZW52ZWxvcGUgdGVzdCcpO3JldHVybiBpbnRlcnNlY3RzO307anN0cy5ub2Rpbmcuc25hcHJvdW5kLkhvdFBpeGVsLnByb3RvdHlwZS5pbnRlcnNlY3RzVG9sZXJhbmNlU3F1YXJlPWZ1bmN0aW9uKHAwLHAxKXt2YXIgaW50ZXJzZWN0c0xlZnQ9ZmFsc2U7dmFyIGludGVyc2VjdHNCb3R0b209ZmFsc2U7dGhpcy5saS5jb21wdXRlSW50ZXJzZWN0aW9uKHAwLHAxLHRoaXMuY29ybmVyWzBdLHRoaXMuY29ybmVyWzFdKTtpZih0aGlzLmxpLmlzUHJvcGVyKCkpXG5yZXR1cm4gdHJ1ZTt0aGlzLmxpLmNvbXB1dGVJbnRlcnNlY3Rpb24ocDAscDEsdGhpcy5jb3JuZXJbMV0sdGhpcy5jb3JuZXJbMl0pO2lmKHRoaXMubGkuaXNQcm9wZXIoKSlcbnJldHVybiB0cnVlO2lmKHRoaXMubGkuaGFzSW50ZXJzZWN0aW9uKCkpXG5pbnRlcnNlY3RzTGVmdD10cnVlO3RoaXMubGkuY29tcHV0ZUludGVyc2VjdGlvbihwMCxwMSx0aGlzLmNvcm5lclsyXSx0aGlzLmNvcm5lclszXSk7aWYodGhpcy5saS5pc1Byb3BlcigpKVxucmV0dXJuIHRydWU7aWYodGhpcy5saS5oYXNJbnRlcnNlY3Rpb24oKSlcbmludGVyc2VjdHNCb3R0b209dHJ1ZTt0aGlzLmxpLmNvbXB1dGVJbnRlcnNlY3Rpb24ocDAscDEsdGhpcy5jb3JuZXJbM10sdGhpcy5jb3JuZXJbMF0pO2lmKHRoaXMubGkuaXNQcm9wZXIoKSlcbnJldHVybiB0cnVlO2lmKGludGVyc2VjdHNMZWZ0JiZpbnRlcnNlY3RzQm90dG9tKVxucmV0dXJuIHRydWU7aWYocDAuZXF1YWxzKHRoaXMucHQpKVxucmV0dXJuIHRydWU7aWYocDEuZXF1YWxzKHRoaXMucHQpKVxucmV0dXJuIHRydWU7cmV0dXJuIGZhbHNlO307anN0cy5ub2Rpbmcuc25hcHJvdW5kLkhvdFBpeGVsLnByb3RvdHlwZS5pbnRlcnNlY3RzUGl4ZWxDbG9zdXJlPWZ1bmN0aW9uKHAwLHAxKXt0aGlzLmxpLmNvbXB1dGVJbnRlcnNlY3Rpb24ocDAscDEsdGhpcy5jb3JuZXJbMF0sdGhpcy5jb3JuZXJbMV0pO2lmKHRoaXMubGkuaGFzSW50ZXJzZWN0aW9uKCkpXG5yZXR1cm4gdHJ1ZTt0aGlzLmxpLmNvbXB1dGVJbnRlcnNlY3Rpb24ocDAscDEsdGhpcy5jb3JuZXJbMV0sdGhpcy5jb3JuZXJbMl0pO2lmKHRoaXMubGkuaGFzSW50ZXJzZWN0aW9uKCkpXG5yZXR1cm4gdHJ1ZTt0aGlzLmxpLmNvbXB1dGVJbnRlcnNlY3Rpb24ocDAscDEsdGhpcy5jb3JuZXJbMl0sdGhpcy5jb3JuZXJbM10pO2lmKHRoaXMubGkuaGFzSW50ZXJzZWN0aW9uKCkpXG5yZXR1cm4gdHJ1ZTt0aGlzLmxpLmNvbXB1dGVJbnRlcnNlY3Rpb24ocDAscDEsdGhpcy5jb3JuZXJbM10sdGhpcy5jb3JuZXJbMF0pO2lmKHRoaXMubGkuaGFzSW50ZXJzZWN0aW9uKCkpXG5yZXR1cm4gdHJ1ZTtyZXR1cm4gZmFsc2U7fTtqc3RzLm5vZGluZy5zbmFwcm91bmQuSG90UGl4ZWwucHJvdG90eXBlLmFkZFNuYXBwZWROb2RlPWZ1bmN0aW9uKHNlZ1N0cixzZWdJbmRleCl7dmFyIHAwPXNlZ1N0ci5nZXRDb29yZGluYXRlKHNlZ0luZGV4KTt2YXIgcDE9c2VnU3RyLmdldENvb3JkaW5hdGUoc2VnSW5kZXgrMSk7aWYodGhpcy5pbnRlcnNlY3RzKHAwLHAxKSl7c2VnU3RyLmFkZEludGVyc2VjdGlvbih0aGlzLmdldENvb3JkaW5hdGUoKSxzZWdJbmRleCk7cmV0dXJuIHRydWU7fVxucmV0dXJuIGZhbHNlO307anN0cy5vcGVyYXRpb24uYnVmZmVyLkJ1ZmZlcklucHV0TGluZVNpbXBsaWZpZXI9ZnVuY3Rpb24oaW5wdXRMaW5lKXt0aGlzLmlucHV0TGluZT1pbnB1dExpbmU7fTtqc3RzLm9wZXJhdGlvbi5idWZmZXIuQnVmZmVySW5wdXRMaW5lU2ltcGxpZmllci5zaW1wbGlmeT1mdW5jdGlvbihpbnB1dExpbmUsZGlzdGFuY2VUb2wpe3ZhciBzaW1wPW5ldyBqc3RzLm9wZXJhdGlvbi5idWZmZXIuQnVmZmVySW5wdXRMaW5lU2ltcGxpZmllcihpbnB1dExpbmUpO3JldHVybiBzaW1wLnNpbXBsaWZ5KGRpc3RhbmNlVG9sKTt9O2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5CdWZmZXJJbnB1dExpbmVTaW1wbGlmaWVyLklOSVQ9MDtqc3RzLm9wZXJhdGlvbi5idWZmZXIuQnVmZmVySW5wdXRMaW5lU2ltcGxpZmllci5ERUxFVEU9MTtqc3RzLm9wZXJhdGlvbi5idWZmZXIuQnVmZmVySW5wdXRMaW5lU2ltcGxpZmllci5LRUVQPTE7anN0cy5vcGVyYXRpb24uYnVmZmVyLkJ1ZmZlcklucHV0TGluZVNpbXBsaWZpZXIucHJvdG90eXBlLmlucHV0TGluZT1udWxsO2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5CdWZmZXJJbnB1dExpbmVTaW1wbGlmaWVyLnByb3RvdHlwZS5kaXN0YW5jZVRvbD1udWxsO2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5CdWZmZXJJbnB1dExpbmVTaW1wbGlmaWVyLnByb3RvdHlwZS5pc0RlbGV0ZWQ9bnVsbDtqc3RzLm9wZXJhdGlvbi5idWZmZXIuQnVmZmVySW5wdXRMaW5lU2ltcGxpZmllci5wcm90b3R5cGUuYW5nbGVPcmllbnRhdGlvbj1qc3RzLmFsZ29yaXRobS5DR0FsZ29yaXRobXMuQ09VTlRFUkNMT0NLV0lTRTtqc3RzLm9wZXJhdGlvbi5idWZmZXIuQnVmZmVySW5wdXRMaW5lU2ltcGxpZmllci5wcm90b3R5cGUuc2ltcGxpZnk9ZnVuY3Rpb24oZGlzdGFuY2VUb2wpe3RoaXMuZGlzdGFuY2VUb2w9TWF0aC5hYnMoZGlzdGFuY2VUb2wpO2lmKGRpc3RhbmNlVG9sPDApXG50aGlzLmFuZ2xlT3JpZW50YXRpb249anN0cy5hbGdvcml0aG0uQ0dBbGdvcml0aG1zLkNMT0NLV0lTRTt0aGlzLmlzRGVsZXRlZD1bXTt0aGlzLmlzRGVsZXRlZC5sZW5ndGg9dGhpcy5pbnB1dExpbmUubGVuZ3RoO3ZhciBpc0NoYW5nZWQ9ZmFsc2U7ZG97aXNDaGFuZ2VkPXRoaXMuZGVsZXRlU2hhbGxvd0NvbmNhdml0aWVzKCk7fXdoaWxlKGlzQ2hhbmdlZCk7cmV0dXJuIHRoaXMuY29sbGFwc2VMaW5lKCk7fTtqc3RzLm9wZXJhdGlvbi5idWZmZXIuQnVmZmVySW5wdXRMaW5lU2ltcGxpZmllci5wcm90b3R5cGUuZGVsZXRlU2hhbGxvd0NvbmNhdml0aWVzPWZ1bmN0aW9uKCl7dmFyIGluZGV4PTE7dmFyIG1heEluZGV4PXRoaXMuaW5wdXRMaW5lLmxlbmd0aC0xO3ZhciBtaWRJbmRleD10aGlzLmZpbmROZXh0Tm9uRGVsZXRlZEluZGV4KGluZGV4KTt2YXIgbGFzdEluZGV4PXRoaXMuZmluZE5leHROb25EZWxldGVkSW5kZXgobWlkSW5kZXgpO3ZhciBpc0NoYW5nZWQ9ZmFsc2U7d2hpbGUobGFzdEluZGV4PHRoaXMuaW5wdXRMaW5lLmxlbmd0aCl7dmFyIGlzTWlkZGxlVmVydGV4RGVsZXRlZD1mYWxzZTtpZih0aGlzLmlzRGVsZXRhYmxlKGluZGV4LG1pZEluZGV4LGxhc3RJbmRleCx0aGlzLmRpc3RhbmNlVG9sKSl7dGhpcy5pc0RlbGV0ZWRbbWlkSW5kZXhdPWpzdHMub3BlcmF0aW9uLmJ1ZmZlci5CdWZmZXJJbnB1dExpbmVTaW1wbGlmaWVyLkRFTEVURTtpc01pZGRsZVZlcnRleERlbGV0ZWQ9dHJ1ZTtpc0NoYW5nZWQ9dHJ1ZTt9XG5pZihpc01pZGRsZVZlcnRleERlbGV0ZWQpXG5pbmRleD1sYXN0SW5kZXg7ZWxzZVxuaW5kZXg9bWlkSW5kZXg7bWlkSW5kZXg9dGhpcy5maW5kTmV4dE5vbkRlbGV0ZWRJbmRleChpbmRleCk7bGFzdEluZGV4PXRoaXMuZmluZE5leHROb25EZWxldGVkSW5kZXgobWlkSW5kZXgpO31cbnJldHVybiBpc0NoYW5nZWQ7fTtqc3RzLm9wZXJhdGlvbi5idWZmZXIuQnVmZmVySW5wdXRMaW5lU2ltcGxpZmllci5wcm90b3R5cGUuZmluZE5leHROb25EZWxldGVkSW5kZXg9ZnVuY3Rpb24oaW5kZXgpe3ZhciBuZXh0PWluZGV4KzE7d2hpbGUobmV4dDx0aGlzLmlucHV0TGluZS5sZW5ndGgmJnRoaXMuaXNEZWxldGVkW25leHRdPT09anN0cy5vcGVyYXRpb24uYnVmZmVyLkJ1ZmZlcklucHV0TGluZVNpbXBsaWZpZXIuREVMRVRFKVxubmV4dCsrO3JldHVybiBuZXh0O307anN0cy5vcGVyYXRpb24uYnVmZmVyLkJ1ZmZlcklucHV0TGluZVNpbXBsaWZpZXIucHJvdG90eXBlLmNvbGxhcHNlTGluZT1mdW5jdGlvbigpe3ZhciBjb29yZExpc3Q9W107Zm9yKHZhciBpPTA7aTx0aGlzLmlucHV0TGluZS5sZW5ndGg7aSsrKXtpZih0aGlzLmlzRGVsZXRlZFtpXSE9PWpzdHMub3BlcmF0aW9uLmJ1ZmZlci5CdWZmZXJJbnB1dExpbmVTaW1wbGlmaWVyLkRFTEVURSlcbmNvb3JkTGlzdC5wdXNoKHRoaXMuaW5wdXRMaW5lW2ldKTt9XG5yZXR1cm4gY29vcmRMaXN0O307anN0cy5vcGVyYXRpb24uYnVmZmVyLkJ1ZmZlcklucHV0TGluZVNpbXBsaWZpZXIucHJvdG90eXBlLmlzRGVsZXRhYmxlPWZ1bmN0aW9uKGkwLGkxLGkyLGRpc3RhbmNlVG9sKXt2YXIgcDA9dGhpcy5pbnB1dExpbmVbaTBdO3ZhciBwMT10aGlzLmlucHV0TGluZVtpMV07dmFyIHAyPXRoaXMuaW5wdXRMaW5lW2kyXTtpZighdGhpcy5pc0NvbmNhdmUocDAscDEscDIpKVxucmV0dXJuIGZhbHNlO2lmKCF0aGlzLmlzU2hhbGxvdyhwMCxwMSxwMixkaXN0YW5jZVRvbCkpXG5yZXR1cm4gZmFsc2U7cmV0dXJuIHRoaXMuaXNTaGFsbG93U2FtcGxlZChwMCxwMSxpMCxpMixkaXN0YW5jZVRvbCk7fTtqc3RzLm9wZXJhdGlvbi5idWZmZXIuQnVmZmVySW5wdXRMaW5lU2ltcGxpZmllci5wcm90b3R5cGUuaXNTaGFsbG93Q29uY2F2aXR5PWZ1bmN0aW9uKHAwLHAxLHAyLGRpc3RhbmNlVG9sKXt2YXIgb3JpZW50YXRpb249anN0cy5hbGdvcml0aG0uQ0dBbGdvcml0aG1zLmNvbXB1dGVPcmllbnRhdGlvbihwMCxwMSxwMik7dmFyIGlzQW5nbGVUb1NpbXBsaWZ5PShvcmllbnRhdGlvbj09PXRoaXMuYW5nbGVPcmllbnRhdGlvbik7aWYoIWlzQW5nbGVUb1NpbXBsaWZ5KVxucmV0dXJuIGZhbHNlO3ZhciBkaXN0PWpzdHMuYWxnb3JpdGhtLkNHQWxnb3JpdGhtcy5kaXN0YW5jZVBvaW50TGluZShwMSxwMCxwMik7cmV0dXJuIGRpc3Q8ZGlzdGFuY2VUb2w7fTtqc3RzLm9wZXJhdGlvbi5idWZmZXIuQnVmZmVySW5wdXRMaW5lU2ltcGxpZmllci5OVU1fUFRTX1RPX0NIRUNLPTEwO2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5CdWZmZXJJbnB1dExpbmVTaW1wbGlmaWVyLnByb3RvdHlwZS5pc1NoYWxsb3dTYW1wbGVkPWZ1bmN0aW9uKHAwLHAyLGkwLGkyLGRpc3RhbmNlVG9sKXt2YXIgaW5jPXBhcnNlSW50KChpMi1pMCkvanN0cy5vcGVyYXRpb24uYnVmZmVyLkJ1ZmZlcklucHV0TGluZVNpbXBsaWZpZXIuTlVNX1BUU19UT19DSEVDSyk7aWYoaW5jPD0wKVxuaW5jPTE7Zm9yKHZhciBpPWkwO2k8aTI7aSs9aW5jKXtpZighdGhpcy5pc1NoYWxsb3cocDAscDIsdGhpcy5pbnB1dExpbmVbaV0sZGlzdGFuY2VUb2wpKVxucmV0dXJuIGZhbHNlO31cbnJldHVybiB0cnVlO307anN0cy5vcGVyYXRpb24uYnVmZmVyLkJ1ZmZlcklucHV0TGluZVNpbXBsaWZpZXIucHJvdG90eXBlLmlzU2hhbGxvdz1mdW5jdGlvbihwMCxwMSxwMixkaXN0YW5jZVRvbCl7dmFyIGRpc3Q9anN0cy5hbGdvcml0aG0uQ0dBbGdvcml0aG1zLmRpc3RhbmNlUG9pbnRMaW5lKHAxLHAwLHAyKTtyZXR1cm4gZGlzdDxkaXN0YW5jZVRvbDt9O2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5CdWZmZXJJbnB1dExpbmVTaW1wbGlmaWVyLnByb3RvdHlwZS5pc0NvbmNhdmU9ZnVuY3Rpb24ocDAscDEscDIpe3ZhciBvcmllbnRhdGlvbj1qc3RzLmFsZ29yaXRobS5DR0FsZ29yaXRobXMuY29tcHV0ZU9yaWVudGF0aW9uKHAwLHAxLHAyKTt2YXIgaXNDb25jYXZlPShvcmllbnRhdGlvbj09PXRoaXMuYW5nbGVPcmllbnRhdGlvbik7cmV0dXJuIGlzQ29uY2F2ZTt9O2pzdHMuZ2VvbWdyYXBoLmluZGV4LlN3ZWVwTGluZUV2ZW50PWZ1bmN0aW9uKHgsb2JqLGxhYmVsKXtpZighKG9iaiBpbnN0YW5jZW9mIGpzdHMuZ2VvbWdyYXBoLmluZGV4LlN3ZWVwTGluZUV2ZW50KSl7dGhpcy5ldmVudFR5cGU9anN0cy5nZW9tZ3JhcGguaW5kZXguU3dlZXBMaW5lRXZlbnQuSU5TRVJUO3RoaXMubGFiZWw9bGFiZWw7dGhpcy54VmFsdWU9eDt0aGlzLm9iaj1vYmo7cmV0dXJuO31cbnRoaXMuZXZlbnRUeXBlPWpzdHMuZ2VvbWdyYXBoLmluZGV4LlN3ZWVwTGluZUV2ZW50LkRFTEVURTt0aGlzLnhWYWx1ZT14O3RoaXMuaW5zZXJ0RXZlbnQ9b2JqO307anN0cy5nZW9tZ3JhcGguaW5kZXguU3dlZXBMaW5lRXZlbnQuSU5TRVJUPTE7anN0cy5nZW9tZ3JhcGguaW5kZXguU3dlZXBMaW5lRXZlbnQuREVMRVRFPTI7anN0cy5nZW9tZ3JhcGguaW5kZXguU3dlZXBMaW5lRXZlbnQucHJvdG90eXBlLmxhYmVsPW51bGw7anN0cy5nZW9tZ3JhcGguaW5kZXguU3dlZXBMaW5lRXZlbnQucHJvdG90eXBlLnhWYWx1ZT1udWxsO2pzdHMuZ2VvbWdyYXBoLmluZGV4LlN3ZWVwTGluZUV2ZW50LnByb3RvdHlwZS5ldmVudFR5cGU9bnVsbDtqc3RzLmdlb21ncmFwaC5pbmRleC5Td2VlcExpbmVFdmVudC5wcm90b3R5cGUuaW5zZXJ0RXZlbnQ9bnVsbDtqc3RzLmdlb21ncmFwaC5pbmRleC5Td2VlcExpbmVFdmVudC5wcm90b3R5cGUuZGVsZXRlRXZlbnRJbmRleD1udWxsO2pzdHMuZ2VvbWdyYXBoLmluZGV4LlN3ZWVwTGluZUV2ZW50LnByb3RvdHlwZS5vYmo9bnVsbDtqc3RzLmdlb21ncmFwaC5pbmRleC5Td2VlcExpbmVFdmVudC5wcm90b3R5cGUuaXNJbnNlcnQ9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5ldmVudFR5cGU9PWpzdHMuZ2VvbWdyYXBoLmluZGV4LlN3ZWVwTGluZUV2ZW50LklOU0VSVDt9O2pzdHMuZ2VvbWdyYXBoLmluZGV4LlN3ZWVwTGluZUV2ZW50LnByb3RvdHlwZS5pc0RlbGV0ZT1mdW5jdGlvbigpe3JldHVybiB0aGlzLmV2ZW50VHlwZT09anN0cy5nZW9tZ3JhcGguaW5kZXguU3dlZXBMaW5lRXZlbnQuREVMRVRFO307anN0cy5nZW9tZ3JhcGguaW5kZXguU3dlZXBMaW5lRXZlbnQucHJvdG90eXBlLmdldEluc2VydEV2ZW50PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuaW5zZXJ0RXZlbnQ7fTtqc3RzLmdlb21ncmFwaC5pbmRleC5Td2VlcExpbmVFdmVudC5wcm90b3R5cGUuZ2V0RGVsZXRlRXZlbnRJbmRleD1mdW5jdGlvbigpe3JldHVybiB0aGlzLmRlbGV0ZUV2ZW50SW5kZXg7fTtqc3RzLmdlb21ncmFwaC5pbmRleC5Td2VlcExpbmVFdmVudC5wcm90b3R5cGUuc2V0RGVsZXRlRXZlbnRJbmRleD1mdW5jdGlvbihkZWxldGVFdmVudEluZGV4KXt0aGlzLmRlbGV0ZUV2ZW50SW5kZXg9ZGVsZXRlRXZlbnRJbmRleDt9O2pzdHMuZ2VvbWdyYXBoLmluZGV4LlN3ZWVwTGluZUV2ZW50LnByb3RvdHlwZS5nZXRPYmplY3Q9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5vYmo7fTtqc3RzLmdlb21ncmFwaC5pbmRleC5Td2VlcExpbmVFdmVudC5wcm90b3R5cGUuaXNTYW1lTGFiZWw9ZnVuY3Rpb24oZXYpe2lmKHRoaXMubGFiZWw9PW51bGwpe3JldHVybiBmYWxzZTt9XG5yZXR1cm4gdGhpcy5sYWJlbD09ZXYubGFiZWw7fTtqc3RzLmdlb21ncmFwaC5pbmRleC5Td2VlcExpbmVFdmVudC5wcm90b3R5cGUuY29tcGFyZVRvPWZ1bmN0aW9uKHBlKXtpZih0aGlzLnhWYWx1ZTxwZS54VmFsdWUpe3JldHVybi0xO31cbmlmKHRoaXMueFZhbHVlPnBlLnhWYWx1ZSl7cmV0dXJuIDE7fVxuaWYodGhpcy5ldmVudFR5cGU8cGUuZXZlbnRUeXBlKXtyZXR1cm4tMTt9XG5pZih0aGlzLmV2ZW50VHlwZT5wZS5ldmVudFR5cGUpe3JldHVybiAxO31cbnJldHVybiAwO307anN0cy5nZW9tLkNvb3JkaW5hdGVMaXN0PWZ1bmN0aW9uKGNvb3JkLGFsbG93UmVwZWF0ZWQpe3RoaXMuYXJyYXk9W107YWxsb3dSZXBlYXRlZD0oYWxsb3dSZXBlYXRlZD09PXVuZGVmaW5lZCk/dHJ1ZTphbGxvd1JlcGVhdGVkO2lmKGNvb3JkIT09dW5kZWZpbmVkKXt0aGlzLmFkZChjb29yZCxhbGxvd1JlcGVhdGVkKTt9fTtqc3RzLmdlb20uQ29vcmRpbmF0ZUxpc3QucHJvdG90eXBlPW5ldyBqYXZhc2NyaXB0LnV0aWwuQXJyYXlMaXN0KCk7anN0cy5nZW9tLkNvb3JkaW5hdGVMaXN0LnByb3RvdHlwZS5pdGVyYXRvcj1udWxsO2pzdHMuZ2VvbS5Db29yZGluYXRlTGlzdC5wcm90b3R5cGUucmVtb3ZlPW51bGw7anN0cy5nZW9tLkNvb3JkaW5hdGVMaXN0LnByb3RvdHlwZS5nZXQ9ZnVuY3Rpb24oaSl7cmV0dXJuIHRoaXMuYXJyYXlbaV07fTtqc3RzLmdlb20uQ29vcmRpbmF0ZUxpc3QucHJvdG90eXBlLnNldD1mdW5jdGlvbihpLGUpe3ZhciBvPXRoaXMuYXJyYXlbaV07dGhpcy5hcnJheVtpXT1lO3JldHVybiBvO307anN0cy5nZW9tLkNvb3JkaW5hdGVMaXN0LnByb3RvdHlwZS5zaXplPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuYXJyYXkubGVuZ3RoO307anN0cy5nZW9tLkNvb3JkaW5hdGVMaXN0LnByb3RvdHlwZS5hZGQ9ZnVuY3Rpb24oKXtpZihhcmd1bWVudHMubGVuZ3RoPjEpe3JldHVybiB0aGlzLmFkZENvb3JkaW5hdGVzLmFwcGx5KHRoaXMsYXJndW1lbnRzKTt9ZWxzZXtyZXR1cm4gdGhpcy5hcnJheS5wdXNoKGFyZ3VtZW50c1swXSk7fX07anN0cy5nZW9tLkNvb3JkaW5hdGVMaXN0LnByb3RvdHlwZS5hZGRDb29yZGluYXRlcz1mdW5jdGlvbihjb29yZCxhbGxvd1JlcGVhdGVkLGRpcmVjdGlvbil7aWYoY29vcmQgaW5zdGFuY2VvZiBqc3RzLmdlb20uQ29vcmRpbmF0ZSl7cmV0dXJuIHRoaXMuYWRkQ29vcmRpbmF0ZS5hcHBseSh0aGlzLGFyZ3VtZW50cyk7fWVsc2UgaWYodHlwZW9mIGNvb3JkPT09J251bWJlcicpe3JldHVybiB0aGlzLmluc2VydENvb3JkaW5hdGUuYXBwbHkodGhpcyxhcmd1bWVudHMpO31cbmRpcmVjdGlvbj1kaXJlY3Rpb258fHRydWU7aWYoZGlyZWN0aW9uKXtmb3IodmFyIGk9MDtpPGNvb3JkLmxlbmd0aDtpKyspe3RoaXMuYWRkQ29vcmRpbmF0ZShjb29yZFtpXSxhbGxvd1JlcGVhdGVkKTt9fWVsc2V7Zm9yKHZhciBpPWNvb3JkLmxlbmd0aC0xO2k+PTA7aS0tKXt0aGlzLmFkZENvb3JkaW5hdGUoY29vcmRbaV0sYWxsb3dSZXBlYXRlZCk7fX1cbnJldHVybiB0cnVlO307anN0cy5nZW9tLkNvb3JkaW5hdGVMaXN0LnByb3RvdHlwZS5hZGRDb29yZGluYXRlPWZ1bmN0aW9uKGNvb3JkLGFsbG93UmVwZWF0ZWQpe2lmKCFhbGxvd1JlcGVhdGVkKXtpZih0aGlzLnNpemUoKT49MSl7dmFyIGxhc3Q9dGhpcy5nZXQodGhpcy5zaXplKCktMSk7aWYobGFzdC5lcXVhbHMyRChjb29yZCkpcmV0dXJuO319XG50aGlzLmFkZChjb29yZCk7fTtqc3RzLmdlb20uQ29vcmRpbmF0ZUxpc3QucHJvdG90eXBlLmluc2VydENvb3JkaW5hdGU9ZnVuY3Rpb24oaW5kZXgsY29vcmQsYWxsb3dSZXBlYXRlZCl7aWYoIWFsbG93UmVwZWF0ZWQpe3ZhciBiZWZvcmU9aW5kZXg+MD9pbmRleC0xOi0xO2lmKGJlZm9yZSE9PS0xJiZ0aGlzLmdldChiZWZvcmUpLmVxdWFsczJEKGNvb3JkKSl7cmV0dXJuO31cbnZhciBhZnRlcj1pbmRleDx0aGlzLnNpemUoKS0xP2luZGV4KzE6LTE7aWYoYWZ0ZXIhPT0tMSYmdGhpcy5nZXQoYWZ0ZXIpLmVxdWFsczJEKGNvb3JkKSl7cmV0dXJuO319XG50aGlzLmFycmF5LnNwbGljZShpbmRleCwwLGNvb3JkKTt9O2pzdHMuZ2VvbS5Db29yZGluYXRlTGlzdC5wcm90b3R5cGUuY2xvc2VSaW5nPWZ1bmN0aW9uKCl7aWYodGhpcy5zaXplKCk+MCl7dGhpcy5hZGRDb29yZGluYXRlKG5ldyBqc3RzLmdlb20uQ29vcmRpbmF0ZSh0aGlzLmdldCgwKSksZmFsc2UpO319O2pzdHMuZ2VvbS5Db29yZGluYXRlTGlzdC5wcm90b3R5cGUudG9BcnJheT1mdW5jdGlvbigpe3JldHVybiB0aGlzLmFycmF5O307anN0cy5nZW9tLkNvb3JkaW5hdGVMaXN0LnByb3RvdHlwZS50b0Nvb3JkaW5hdGVBcnJheT1mdW5jdGlvbigpe3JldHVybiB0aGlzLmFycmF5O307anN0cy5vcGVyYXRpb24uYnVmZmVyLk9mZnNldFNlZ21lbnRHZW5lcmF0b3I9ZnVuY3Rpb24ocHJlY2lzaW9uTW9kZWwsYnVmUGFyYW1zLGRpc3RhbmNlKXt0aGlzLnNlZzA9bmV3IGpzdHMuZ2VvbS5MaW5lU2VnbWVudCgpO3RoaXMuc2VnMT1uZXcganN0cy5nZW9tLkxpbmVTZWdtZW50KCk7dGhpcy5vZmZzZXQwPW5ldyBqc3RzLmdlb20uTGluZVNlZ21lbnQoKTt0aGlzLm9mZnNldDE9bmV3IGpzdHMuZ2VvbS5MaW5lU2VnbWVudCgpO3RoaXMucHJlY2lzaW9uTW9kZWw9cHJlY2lzaW9uTW9kZWw7dGhpcy5idWZQYXJhbXM9YnVmUGFyYW1zO3RoaXMubGk9bmV3IGpzdHMuYWxnb3JpdGhtLlJvYnVzdExpbmVJbnRlcnNlY3RvcigpO3RoaXMuZmlsbGV0QW5nbGVRdWFudHVtPU1hdGguUEkvMi4wL2J1ZlBhcmFtcy5nZXRRdWFkcmFudFNlZ21lbnRzKCk7aWYodGhpcy5idWZQYXJhbXMuZ2V0UXVhZHJhbnRTZWdtZW50cygpPj04JiZ0aGlzLmJ1ZlBhcmFtcy5nZXRKb2luU3R5bGUoKT09PWpzdHMub3BlcmF0aW9uLmJ1ZmZlci5CdWZmZXJQYXJhbWV0ZXJzLkpPSU5fUk9VTkQpe3RoaXMuY2xvc2luZ1NlZ0xlbmd0aEZhY3Rvcj1qc3RzLm9wZXJhdGlvbi5idWZmZXIuT2Zmc2V0U2VnbWVudEdlbmVyYXRvci5NQVhfQ0xPU0lOR19TRUdfTEVOX0ZBQ1RPUjt9XG50aGlzLmluaXQoZGlzdGFuY2UpO307anN0cy5vcGVyYXRpb24uYnVmZmVyLk9mZnNldFNlZ21lbnRHZW5lcmF0b3IuT0ZGU0VUX1NFR01FTlRfU0VQQVJBVElPTl9GQUNUT1I9MS4wRS0zO2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5PZmZzZXRTZWdtZW50R2VuZXJhdG9yLklOU0lERV9UVVJOX1ZFUlRFWF9TTkFQX0RJU1RBTkNFX0ZBQ1RPUj0xLjBFLTM7anN0cy5vcGVyYXRpb24uYnVmZmVyLk9mZnNldFNlZ21lbnRHZW5lcmF0b3IuQ1VSVkVfVkVSVEVYX1NOQVBfRElTVEFOQ0VfRkFDVE9SPTEuMEUtNjtqc3RzLm9wZXJhdGlvbi5idWZmZXIuT2Zmc2V0U2VnbWVudEdlbmVyYXRvci5NQVhfQ0xPU0lOR19TRUdfTEVOX0ZBQ1RPUj04MDtqc3RzLm9wZXJhdGlvbi5idWZmZXIuT2Zmc2V0U2VnbWVudEdlbmVyYXRvci5wcm90b3R5cGUubWF4Q3VydmVTZWdtZW50RXJyb3I9MC4wO2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5PZmZzZXRTZWdtZW50R2VuZXJhdG9yLnByb3RvdHlwZS5maWxsZXRBbmdsZVF1YW50dW09bnVsbDtqc3RzLm9wZXJhdGlvbi5idWZmZXIuT2Zmc2V0U2VnbWVudEdlbmVyYXRvci5wcm90b3R5cGUuY2xvc2luZ1NlZ0xlbmd0aEZhY3Rvcj0xO2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5PZmZzZXRTZWdtZW50R2VuZXJhdG9yLnByb3RvdHlwZS5zZWdMaXN0PW51bGw7anN0cy5vcGVyYXRpb24uYnVmZmVyLk9mZnNldFNlZ21lbnRHZW5lcmF0b3IucHJvdG90eXBlLmRpc3RhbmNlPTAuMDtqc3RzLm9wZXJhdGlvbi5idWZmZXIuT2Zmc2V0U2VnbWVudEdlbmVyYXRvci5wcm90b3R5cGUucHJlY2lzaW9uTW9kZWw9bnVsbDtqc3RzLm9wZXJhdGlvbi5idWZmZXIuT2Zmc2V0U2VnbWVudEdlbmVyYXRvci5wcm90b3R5cGUuYnVmUGFyYW1zPW51bGw7anN0cy5vcGVyYXRpb24uYnVmZmVyLk9mZnNldFNlZ21lbnRHZW5lcmF0b3IucHJvdG90eXBlLmxpPW51bGw7anN0cy5vcGVyYXRpb24uYnVmZmVyLk9mZnNldFNlZ21lbnRHZW5lcmF0b3IucHJvdG90eXBlLnMwPW51bGw7anN0cy5vcGVyYXRpb24uYnVmZmVyLk9mZnNldFNlZ21lbnRHZW5lcmF0b3IucHJvdG90eXBlLnMxPW51bGw7anN0cy5vcGVyYXRpb24uYnVmZmVyLk9mZnNldFNlZ21lbnRHZW5lcmF0b3IucHJvdG90eXBlLnMyPW51bGw7anN0cy5vcGVyYXRpb24uYnVmZmVyLk9mZnNldFNlZ21lbnRHZW5lcmF0b3IucHJvdG90eXBlLnNlZzA9bnVsbDtqc3RzLm9wZXJhdGlvbi5idWZmZXIuT2Zmc2V0U2VnbWVudEdlbmVyYXRvci5wcm90b3R5cGUuc2VnMT1udWxsO2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5PZmZzZXRTZWdtZW50R2VuZXJhdG9yLnByb3RvdHlwZS5vZmZzZXQwPW51bGw7anN0cy5vcGVyYXRpb24uYnVmZmVyLk9mZnNldFNlZ21lbnRHZW5lcmF0b3IucHJvdG90eXBlLm9mZnNldDE9bnVsbDtqc3RzLm9wZXJhdGlvbi5idWZmZXIuT2Zmc2V0U2VnbWVudEdlbmVyYXRvci5wcm90b3R5cGUuc2lkZT0wO2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5PZmZzZXRTZWdtZW50R2VuZXJhdG9yLnByb3RvdHlwZS5oYXNOYXJyb3dDb25jYXZlQW5nbGU9ZmFsc2U7anN0cy5vcGVyYXRpb24uYnVmZmVyLk9mZnNldFNlZ21lbnRHZW5lcmF0b3IucHJvdG90eXBlLmhhc05hcnJvd0NvbmNhdmVBbmdsZT1mdW5jdGlvbigpe3JldHVybiB0aGlzLmhhc05hcnJvd0NvbmNhdmVBbmdsZTt9O2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5PZmZzZXRTZWdtZW50R2VuZXJhdG9yLnByb3RvdHlwZS5pbml0PWZ1bmN0aW9uKGRpc3RhbmNlKXt0aGlzLmRpc3RhbmNlPWRpc3RhbmNlO3RoaXMubWF4Q3VydmVTZWdtZW50RXJyb3I9dGhpcy5kaXN0YW5jZSooMS1NYXRoLmNvcyh0aGlzLmZpbGxldEFuZ2xlUXVhbnR1bS8yLjApKTt0aGlzLnNlZ0xpc3Q9bmV3IGpzdHMub3BlcmF0aW9uLmJ1ZmZlci5PZmZzZXRTZWdtZW50U3RyaW5nKCk7dGhpcy5zZWdMaXN0LnNldFByZWNpc2lvbk1vZGVsKHRoaXMucHJlY2lzaW9uTW9kZWwpO3RoaXMuc2VnTGlzdC5zZXRNaW5pbXVtVmVydGV4RGlzdGFuY2UodGhpcy5kaXN0YW5jZSpqc3RzLm9wZXJhdGlvbi5idWZmZXIuT2Zmc2V0U2VnbWVudEdlbmVyYXRvci5DVVJWRV9WRVJURVhfU05BUF9ESVNUQU5DRV9GQUNUT1IpO307anN0cy5vcGVyYXRpb24uYnVmZmVyLk9mZnNldFNlZ21lbnRHZW5lcmF0b3IucHJvdG90eXBlLmluaXRTaWRlU2VnbWVudHM9ZnVuY3Rpb24oczEsczIsc2lkZSl7dGhpcy5zMT1zMTt0aGlzLnMyPXMyO3RoaXMuc2lkZT1zaWRlO3RoaXMuc2VnMS5zZXRDb29yZGluYXRlcyh0aGlzLnMxLHRoaXMuczIpO3RoaXMuY29tcHV0ZU9mZnNldFNlZ21lbnQodGhpcy5zZWcxLHRoaXMuc2lkZSx0aGlzLmRpc3RhbmNlLHRoaXMub2Zmc2V0MSk7fTtqc3RzLm9wZXJhdGlvbi5idWZmZXIuT2Zmc2V0U2VnbWVudEdlbmVyYXRvci5wcm90b3R5cGUuZ2V0Q29vcmRpbmF0ZXM9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5zZWdMaXN0LmdldENvb3JkaW5hdGVzKCk7fTtqc3RzLm9wZXJhdGlvbi5idWZmZXIuT2Zmc2V0U2VnbWVudEdlbmVyYXRvci5wcm90b3R5cGUuY2xvc2VSaW5nPWZ1bmN0aW9uKCl7dGhpcy5zZWdMaXN0LmNsb3NlUmluZygpO307anN0cy5vcGVyYXRpb24uYnVmZmVyLk9mZnNldFNlZ21lbnRHZW5lcmF0b3IucHJvdG90eXBlLmFkZFNlZ21lbnRzPWZ1bmN0aW9uKHB0LGlzRm9yd2FyZCl7dGhpcy5zZWdMaXN0LmFkZFB0cyhwdCxpc0ZvcndhcmQpO307anN0cy5vcGVyYXRpb24uYnVmZmVyLk9mZnNldFNlZ21lbnRHZW5lcmF0b3IucHJvdG90eXBlLmFkZEZpcnN0U2VnbWVudD1mdW5jdGlvbigpe3RoaXMuc2VnTGlzdC5hZGRQdCh0aGlzLm9mZnNldDEucDApO307anN0cy5vcGVyYXRpb24uYnVmZmVyLk9mZnNldFNlZ21lbnRHZW5lcmF0b3IucHJvdG90eXBlLmFkZExhc3RTZWdtZW50PWZ1bmN0aW9uKCl7dGhpcy5zZWdMaXN0LmFkZFB0KHRoaXMub2Zmc2V0MS5wMSk7fTtqc3RzLm9wZXJhdGlvbi5idWZmZXIuT2Zmc2V0U2VnbWVudEdlbmVyYXRvci5wcm90b3R5cGUuYWRkTmV4dFNlZ21lbnQ9ZnVuY3Rpb24ocCxhZGRTdGFydFBvaW50KXt0aGlzLnMwPXRoaXMuczE7dGhpcy5zMT10aGlzLnMyO3RoaXMuczI9cDt0aGlzLnNlZzAuc2V0Q29vcmRpbmF0ZXModGhpcy5zMCx0aGlzLnMxKTt0aGlzLmNvbXB1dGVPZmZzZXRTZWdtZW50KHRoaXMuc2VnMCx0aGlzLnNpZGUsdGhpcy5kaXN0YW5jZSx0aGlzLm9mZnNldDApO3RoaXMuc2VnMS5zZXRDb29yZGluYXRlcyh0aGlzLnMxLHRoaXMuczIpO3RoaXMuY29tcHV0ZU9mZnNldFNlZ21lbnQodGhpcy5zZWcxLHRoaXMuc2lkZSx0aGlzLmRpc3RhbmNlLHRoaXMub2Zmc2V0MSk7aWYodGhpcy5zMS5lcXVhbHModGhpcy5zMikpXG5yZXR1cm47dmFyIG9yaWVudGF0aW9uPWpzdHMuYWxnb3JpdGhtLkNHQWxnb3JpdGhtcy5jb21wdXRlT3JpZW50YXRpb24odGhpcy5zMCx0aGlzLnMxLHRoaXMuczIpO3ZhciBvdXRzaWRlVHVybj0ob3JpZW50YXRpb249PT1qc3RzLmFsZ29yaXRobS5DR0FsZ29yaXRobXMuQ0xPQ0tXSVNFJiZ0aGlzLnNpZGU9PT1qc3RzLmdlb21ncmFwaC5Qb3NpdGlvbi5MRUZUKXx8KG9yaWVudGF0aW9uPT09anN0cy5hbGdvcml0aG0uQ0dBbGdvcml0aG1zLkNPVU5URVJDTE9DS1dJU0UmJnRoaXMuc2lkZT09PWpzdHMuZ2VvbWdyYXBoLlBvc2l0aW9uLlJJR0hUKTtpZihvcmllbnRhdGlvbj09MCl7dGhpcy5hZGRDb2xsaW5lYXIoYWRkU3RhcnRQb2ludCk7fWVsc2UgaWYob3V0c2lkZVR1cm4pe3RoaXMuYWRkT3V0c2lkZVR1cm4ob3JpZW50YXRpb24sYWRkU3RhcnRQb2ludCk7fWVsc2V7dGhpcy5hZGRJbnNpZGVUdXJuKG9yaWVudGF0aW9uLGFkZFN0YXJ0UG9pbnQpO319O2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5PZmZzZXRTZWdtZW50R2VuZXJhdG9yLnByb3RvdHlwZS5hZGRDb2xsaW5lYXI9ZnVuY3Rpb24oYWRkU3RhcnRQb2ludCl7dGhpcy5saS5jb21wdXRlSW50ZXJzZWN0aW9uKHRoaXMuczAsdGhpcy5zMSx0aGlzLnMxLHRoaXMuczIpO3ZhciBudW1JbnQ9dGhpcy5saS5nZXRJbnRlcnNlY3Rpb25OdW0oKTtpZihudW1JbnQ+PTIpe2lmKHRoaXMuYnVmUGFyYW1zLmdldEpvaW5TdHlsZSgpPT09anN0cy5vcGVyYXRpb24uYnVmZmVyLkJ1ZmZlclBhcmFtZXRlcnMuSk9JTl9CRVZFTHx8dGhpcy5idWZQYXJhbXMuZ2V0Sm9pblN0eWxlKCk9PT1qc3RzLm9wZXJhdGlvbi5idWZmZXIuQnVmZmVyUGFyYW1ldGVycy5KT0lOX01JVFJFKXtpZihhZGRTdGFydFBvaW50KVxudGhpcy5zZWdMaXN0LmFkZFB0KHRoaXMub2Zmc2V0MC5wMSk7dGhpcy5zZWdMaXN0LmFkZFB0KHRoaXMub2Zmc2V0MS5wMCk7fWVsc2V7dGhpcy5hZGRGaWxsZXQodGhpcy5zMSx0aGlzLm9mZnNldDAucDEsdGhpcy5vZmZzZXQxLnAwLGpzdHMuYWxnb3JpdGhtLkNHQWxnb3JpdGhtcy5DTE9DS1dJU0UsdGhpcy5kaXN0YW5jZSk7fX19O2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5PZmZzZXRTZWdtZW50R2VuZXJhdG9yLnByb3RvdHlwZS5hZGRPdXRzaWRlVHVybj1mdW5jdGlvbihvcmllbnRhdGlvbixhZGRTdGFydFBvaW50KXtpZih0aGlzLm9mZnNldDAucDEuZGlzdGFuY2UodGhpcy5vZmZzZXQxLnAwKTx0aGlzLmRpc3RhbmNlKmpzdHMub3BlcmF0aW9uLmJ1ZmZlci5PZmZzZXRTZWdtZW50R2VuZXJhdG9yLk9GRlNFVF9TRUdNRU5UX1NFUEFSQVRJT05fRkFDVE9SKXt0aGlzLnNlZ0xpc3QuYWRkUHQodGhpcy5vZmZzZXQwLnAxKTtyZXR1cm47fVxuaWYodGhpcy5idWZQYXJhbXMuZ2V0Sm9pblN0eWxlKCk9PT1qc3RzLm9wZXJhdGlvbi5idWZmZXIuQnVmZmVyUGFyYW1ldGVycy5KT0lOX01JVFJFKXt0aGlzLmFkZE1pdHJlSm9pbih0aGlzLnMxLHRoaXMub2Zmc2V0MCx0aGlzLm9mZnNldDEsdGhpcy5kaXN0YW5jZSk7fWVsc2UgaWYodGhpcy5idWZQYXJhbXMuZ2V0Sm9pblN0eWxlKCk9PT1qc3RzLm9wZXJhdGlvbi5idWZmZXIuQnVmZmVyUGFyYW1ldGVycy5KT0lOX0JFVkVMKXt0aGlzLmFkZEJldmVsSm9pbih0aGlzLm9mZnNldDAsdGhpcy5vZmZzZXQxKTt9ZWxzZXtpZihhZGRTdGFydFBvaW50KVxudGhpcy5zZWdMaXN0LmFkZFB0KHRoaXMub2Zmc2V0MC5wMSk7dGhpcy5hZGRGaWxsZXQodGhpcy5zMSx0aGlzLm9mZnNldDAucDEsdGhpcy5vZmZzZXQxLnAwLG9yaWVudGF0aW9uLHRoaXMuZGlzdGFuY2UpO3RoaXMuc2VnTGlzdC5hZGRQdCh0aGlzLm9mZnNldDEucDApO319O2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5PZmZzZXRTZWdtZW50R2VuZXJhdG9yLnByb3RvdHlwZS5hZGRJbnNpZGVUdXJuPWZ1bmN0aW9uKG9yaWVudGF0aW9uLGFkZFN0YXJ0UG9pbnQpe3RoaXMubGkuY29tcHV0ZUludGVyc2VjdGlvbih0aGlzLm9mZnNldDAucDAsdGhpcy5vZmZzZXQwLnAxLHRoaXMub2Zmc2V0MS5wMCx0aGlzLm9mZnNldDEucDEpO2lmKHRoaXMubGkuaGFzSW50ZXJzZWN0aW9uKCkpe3RoaXMuc2VnTGlzdC5hZGRQdCh0aGlzLmxpLmdldEludGVyc2VjdGlvbigwKSk7fWVsc2V7dGhpcy5oYXNOYXJyb3dDb25jYXZlQW5nbGU9dHJ1ZTtpZih0aGlzLm9mZnNldDAucDEuZGlzdGFuY2UodGhpcy5vZmZzZXQxLnAwKTx0aGlzLmRpc3RhbmNlKmpzdHMub3BlcmF0aW9uLmJ1ZmZlci5PZmZzZXRTZWdtZW50R2VuZXJhdG9yLklOU0lERV9UVVJOX1ZFUlRFWF9TTkFQX0RJU1RBTkNFX0ZBQ1RPUil7dGhpcy5zZWdMaXN0LmFkZFB0KHRoaXMub2Zmc2V0MC5wMSk7fWVsc2V7dGhpcy5zZWdMaXN0LmFkZFB0KHRoaXMub2Zmc2V0MC5wMSk7aWYodGhpcy5jbG9zaW5nU2VnTGVuZ3RoRmFjdG9yPjApe3ZhciBtaWQwPW5ldyBqc3RzLmdlb20uQ29vcmRpbmF0ZSgodGhpcy5jbG9zaW5nU2VnTGVuZ3RoRmFjdG9yKnRoaXMub2Zmc2V0MC5wMS54K3RoaXMuczEueCkvKHRoaXMuY2xvc2luZ1NlZ0xlbmd0aEZhY3RvcisxKSwodGhpcy5jbG9zaW5nU2VnTGVuZ3RoRmFjdG9yKnRoaXMub2Zmc2V0MC5wMS55K3RoaXMuczEueSkvKHRoaXMuY2xvc2luZ1NlZ0xlbmd0aEZhY3RvcisxKSk7dGhpcy5zZWdMaXN0LmFkZFB0KG1pZDApO3ZhciBtaWQxPW5ldyBqc3RzLmdlb20uQ29vcmRpbmF0ZSgodGhpcy5jbG9zaW5nU2VnTGVuZ3RoRmFjdG9yKnRoaXMub2Zmc2V0MS5wMC54K3RoaXMuczEueCkvKHRoaXMuY2xvc2luZ1NlZ0xlbmd0aEZhY3RvcisxKSwodGhpcy5jbG9zaW5nU2VnTGVuZ3RoRmFjdG9yKnRoaXMub2Zmc2V0MS5wMC55K3RoaXMuczEueSkvKHRoaXMuY2xvc2luZ1NlZ0xlbmd0aEZhY3RvcisxKSk7dGhpcy5zZWdMaXN0LmFkZFB0KG1pZDEpO31lbHNle3RoaXMuc2VnTGlzdC5hZGRQdCh0aGlzLnMxKTt9XG50aGlzLnNlZ0xpc3QuYWRkUHQodGhpcy5vZmZzZXQxLnAwKTt9fX07anN0cy5vcGVyYXRpb24uYnVmZmVyLk9mZnNldFNlZ21lbnRHZW5lcmF0b3IucHJvdG90eXBlLmNvbXB1dGVPZmZzZXRTZWdtZW50PWZ1bmN0aW9uKHNlZyxzaWRlLGRpc3RhbmNlLG9mZnNldCl7dmFyIHNpZGVTaWduPXNpZGU9PT1qc3RzLmdlb21ncmFwaC5Qb3NpdGlvbi5MRUZUPzE6LTE7dmFyIGR4PXNlZy5wMS54LXNlZy5wMC54O3ZhciBkeT1zZWcucDEueS1zZWcucDAueTt2YXIgbGVuPU1hdGguc3FydChkeCpkeCtkeSpkeSk7dmFyIHV4PXNpZGVTaWduKmRpc3RhbmNlKmR4L2xlbjt2YXIgdXk9c2lkZVNpZ24qZGlzdGFuY2UqZHkvbGVuO29mZnNldC5wMC54PXNlZy5wMC54LXV5O29mZnNldC5wMC55PXNlZy5wMC55K3V4O29mZnNldC5wMS54PXNlZy5wMS54LXV5O29mZnNldC5wMS55PXNlZy5wMS55K3V4O307anN0cy5vcGVyYXRpb24uYnVmZmVyLk9mZnNldFNlZ21lbnRHZW5lcmF0b3IucHJvdG90eXBlLmFkZExpbmVFbmRDYXA9ZnVuY3Rpb24ocDAscDEpe3ZhciBzZWc9bmV3IGpzdHMuZ2VvbS5MaW5lU2VnbWVudChwMCxwMSk7dmFyIG9mZnNldEw9bmV3IGpzdHMuZ2VvbS5MaW5lU2VnbWVudCgpO3RoaXMuY29tcHV0ZU9mZnNldFNlZ21lbnQoc2VnLGpzdHMuZ2VvbWdyYXBoLlBvc2l0aW9uLkxFRlQsdGhpcy5kaXN0YW5jZSxvZmZzZXRMKTt2YXIgb2Zmc2V0Uj1uZXcganN0cy5nZW9tLkxpbmVTZWdtZW50KCk7dGhpcy5jb21wdXRlT2Zmc2V0U2VnbWVudChzZWcsanN0cy5nZW9tZ3JhcGguUG9zaXRpb24uUklHSFQsdGhpcy5kaXN0YW5jZSxvZmZzZXRSKTt2YXIgZHg9cDEueC1wMC54O3ZhciBkeT1wMS55LXAwLnk7dmFyIGFuZ2xlPU1hdGguYXRhbjIoZHksZHgpO3N3aXRjaCh0aGlzLmJ1ZlBhcmFtcy5nZXRFbmRDYXBTdHlsZSgpKXtjYXNlIGpzdHMub3BlcmF0aW9uLmJ1ZmZlci5CdWZmZXJQYXJhbWV0ZXJzLkNBUF9ST1VORDp0aGlzLnNlZ0xpc3QuYWRkUHQob2Zmc2V0TC5wMSk7dGhpcy5hZGRGaWxsZXQocDEsYW5nbGUrTWF0aC5QSS8yLGFuZ2xlLU1hdGguUEkvMixqc3RzLmFsZ29yaXRobS5DR0FsZ29yaXRobXMuQ0xPQ0tXSVNFLHRoaXMuZGlzdGFuY2UpO3RoaXMuc2VnTGlzdC5hZGRQdChvZmZzZXRSLnAxKTticmVhaztjYXNlIGpzdHMub3BlcmF0aW9uLmJ1ZmZlci5CdWZmZXJQYXJhbWV0ZXJzLkNBUF9GTEFUOnRoaXMuc2VnTGlzdC5hZGRQdChvZmZzZXRMLnAxKTt0aGlzLnNlZ0xpc3QuYWRkUHQob2Zmc2V0Ui5wMSk7YnJlYWs7Y2FzZSBqc3RzLm9wZXJhdGlvbi5idWZmZXIuQnVmZmVyUGFyYW1ldGVycy5DQVBfU1FVQVJFOnZhciBzcXVhcmVDYXBTaWRlT2Zmc2V0PW5ldyBqc3RzLmdlb20uQ29vcmRpbmF0ZSgpO3NxdWFyZUNhcFNpZGVPZmZzZXQueD1NYXRoLmFicyh0aGlzLmRpc3RhbmNlKSpNYXRoLmNvcyhhbmdsZSk7c3F1YXJlQ2FwU2lkZU9mZnNldC55PU1hdGguYWJzKHRoaXMuZGlzdGFuY2UpKk1hdGguc2luKGFuZ2xlKTt2YXIgc3F1YXJlQ2FwTE9mZnNldD1uZXcganN0cy5nZW9tLkNvb3JkaW5hdGUob2Zmc2V0TC5wMS54K1xuc3F1YXJlQ2FwU2lkZU9mZnNldC54LG9mZnNldEwucDEueStzcXVhcmVDYXBTaWRlT2Zmc2V0LnkpO3ZhciBzcXVhcmVDYXBST2Zmc2V0PW5ldyBqc3RzLmdlb20uQ29vcmRpbmF0ZShvZmZzZXRSLnAxLngrXG5zcXVhcmVDYXBTaWRlT2Zmc2V0Lngsb2Zmc2V0Ui5wMS55K3NxdWFyZUNhcFNpZGVPZmZzZXQueSk7dGhpcy5zZWdMaXN0LmFkZFB0KHNxdWFyZUNhcExPZmZzZXQpO3RoaXMuc2VnTGlzdC5hZGRQdChzcXVhcmVDYXBST2Zmc2V0KTticmVhazt9fTtqc3RzLm9wZXJhdGlvbi5idWZmZXIuT2Zmc2V0U2VnbWVudEdlbmVyYXRvci5wcm90b3R5cGUuYWRkTWl0cmVKb2luPWZ1bmN0aW9uKHAsb2Zmc2V0MCxvZmZzZXQxLGRpc3RhbmNlKXt2YXIgaXNNaXRyZVdpdGhpbkxpbWl0PXRydWU7dmFyIGludFB0PW51bGw7dHJ5e2ludFB0PWpzdHMuYWxnb3JpdGhtLkhDb29yZGluYXRlLmludGVyc2VjdGlvbihvZmZzZXQwLnAwLG9mZnNldDAucDEsb2Zmc2V0MS5wMCxvZmZzZXQxLnAxKTt2YXIgbWl0cmVSYXRpbz1kaXN0YW5jZTw9MC4wPzEuMDppbnRQdC5kaXN0YW5jZShwKS9NYXRoLmFicyhkaXN0YW5jZSk7aWYobWl0cmVSYXRpbz50aGlzLmJ1ZlBhcmFtcy5nZXRNaXRyZUxpbWl0KCkpXG50aGlzLmlzTWl0cmVXaXRoaW5MaW1pdD1mYWxzZTt9Y2F0Y2goZSl7aWYoZSBpbnN0YW5jZW9mIGpzdHMuZXJyb3IuTm90UmVwcmVzZW50YWJsZUVycm9yKXtpbnRQdD1uZXcganN0cy5nZW9tLkNvb3JkaW5hdGUoMCwwKTt0aGlzLmlzTWl0cmVXaXRoaW5MaW1pdD1mYWxzZTt9fVxuaWYoaXNNaXRyZVdpdGhpbkxpbWl0KXt0aGlzLnNlZ0xpc3QuYWRkUHQoaW50UHQpO31lbHNle3RoaXMuYWRkTGltaXRlZE1pdHJlSm9pbihvZmZzZXQwLG9mZnNldDEsZGlzdGFuY2UsYnVmUGFyYW1zLmdldE1pdHJlTGltaXQoKSk7fX07anN0cy5vcGVyYXRpb24uYnVmZmVyLk9mZnNldFNlZ21lbnRHZW5lcmF0b3IucHJvdG90eXBlLmFkZExpbWl0ZWRNaXRyZUpvaW49ZnVuY3Rpb24ob2Zmc2V0MCxvZmZzZXQxLGRpc3RhbmNlLG1pdHJlTGltaXQpe3ZhciBiYXNlUHQ9dGhpcy5zZWcwLnAxO3ZhciBhbmcwPWpzdHMuYWxnb3JpdGhtLkFuZ2xlLmFuZ2xlKGJhc2VQdCx0aGlzLnNlZzAucDApO3ZhciBhbmcxPWpzdHMuYWxnb3JpdGhtLkFuZ2xlLmFuZ2xlKGJhc2VQdCx0aGlzLnNlZzEucDEpO3ZhciBhbmdEaWZmPWpzdHMuYWxnb3JpdGhtLkFuZ2xlLmFuZ2xlQmV0d2Vlbk9yaWVudGVkKHRoaXMuc2VnMC5wMCxiYXNlUHQsdGhpcy5zZWcxLnAxKTt2YXIgYW5nRGlmZkhhbGY9YW5nRGlmZi8yO3ZhciBtaWRBbmc9anN0cy5hbGdvcml0aG0uQW5nbGUubm9ybWFsaXplKGFuZzArYW5nRGlmZkhhbGYpO3ZhciBtaXRyZU1pZEFuZz1qc3RzLmFsZ29yaXRobS5BbmdsZS5ub3JtYWxpemUobWlkQW5nK01hdGguUEkpO3ZhciBtaXRyZURpc3Q9bWl0cmVMaW1pdCpkaXN0YW5jZTt2YXIgYmV2ZWxEZWx0YT1taXRyZURpc3QqTWF0aC5hYnMoTWF0aC5zaW4oYW5nRGlmZkhhbGYpKTt2YXIgYmV2ZWxIYWxmTGVuPWRpc3RhbmNlLWJldmVsRGVsdGE7dmFyIGJldmVsTWlkWD1iYXNlUHQueCttaXRyZURpc3QqTWF0aC5jb3MobWl0cmVNaWRBbmcpO3ZhciBiZXZlbE1pZFk9YmFzZVB0LnkrbWl0cmVEaXN0Kk1hdGguc2luKG1pdHJlTWlkQW5nKTt2YXIgYmV2ZWxNaWRQdD1uZXcganN0cy5nZW9tLkNvb3JkaW5hdGUoYmV2ZWxNaWRYLGJldmVsTWlkWSk7dmFyIG1pdHJlTWlkTGluZT1uZXcganN0cy5nZW9tLkxpbmVTZWdtZW50KGJhc2VQdCxiZXZlbE1pZFB0KTt2YXIgYmV2ZWxFbmRMZWZ0PW1pdHJlTWlkTGluZS5wb2ludEFsb25nT2Zmc2V0KDEuMCxiZXZlbEhhbGZMZW4pO3ZhciBiZXZlbEVuZFJpZ2h0PW1pdHJlTWlkTGluZS5wb2ludEFsb25nT2Zmc2V0KDEuMCwtYmV2ZWxIYWxmTGVuKTtpZih0aGlzLnNpZGU9PWpzdHMuZ2VvbWdyYXBoLlBvc2l0aW9uLkxFRlQpe3RoaXMuc2VnTGlzdC5hZGRQdChiZXZlbEVuZExlZnQpO3RoaXMuc2VnTGlzdC5hZGRQdChiZXZlbEVuZFJpZ2h0KTt9ZWxzZXt0aGlzLnNlZ0xpc3QuYWRkUHQoYmV2ZWxFbmRSaWdodCk7dGhpcy5zZWdMaXN0LmFkZFB0KGJldmVsRW5kTGVmdCk7fX07anN0cy5vcGVyYXRpb24uYnVmZmVyLk9mZnNldFNlZ21lbnRHZW5lcmF0b3IucHJvdG90eXBlLmFkZEJldmVsSm9pbj1mdW5jdGlvbihvZmZzZXQwLG9mZnNldDEpe3RoaXMuc2VnTGlzdC5hZGRQdChvZmZzZXQwLnAxKTt0aGlzLnNlZ0xpc3QuYWRkUHQob2Zmc2V0MS5wMCk7fTtqc3RzLm9wZXJhdGlvbi5idWZmZXIuT2Zmc2V0U2VnbWVudEdlbmVyYXRvci5wcm90b3R5cGUuYWRkRmlsbGV0PWZ1bmN0aW9uKHAscDAscDEsZGlyZWN0aW9uLHJhZGl1cyl7aWYoIShwMSBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5Db29yZGluYXRlKSl7dGhpcy5hZGRGaWxsZXQyLmFwcGx5KHRoaXMsYXJndW1lbnRzKTtyZXR1cm47fVxudmFyIGR4MD1wMC54LXAueDt2YXIgZHkwPXAwLnktcC55O3ZhciBzdGFydEFuZ2xlPU1hdGguYXRhbjIoZHkwLGR4MCk7dmFyIGR4MT1wMS54LXAueDt2YXIgZHkxPXAxLnktcC55O3ZhciBlbmRBbmdsZT1NYXRoLmF0YW4yKGR5MSxkeDEpO2lmKGRpcmVjdGlvbj09PWpzdHMuYWxnb3JpdGhtLkNHQWxnb3JpdGhtcy5DTE9DS1dJU0Upe2lmKHN0YXJ0QW5nbGU8PWVuZEFuZ2xlKVxuc3RhcnRBbmdsZSs9Mi4wKk1hdGguUEk7fWVsc2V7aWYoc3RhcnRBbmdsZT49ZW5kQW5nbGUpXG5zdGFydEFuZ2xlLT0yLjAqTWF0aC5QSTt9XG50aGlzLnNlZ0xpc3QuYWRkUHQocDApO3RoaXMuYWRkRmlsbGV0KHAsc3RhcnRBbmdsZSxlbmRBbmdsZSxkaXJlY3Rpb24scmFkaXVzKTt0aGlzLnNlZ0xpc3QuYWRkUHQocDEpO307anN0cy5vcGVyYXRpb24uYnVmZmVyLk9mZnNldFNlZ21lbnRHZW5lcmF0b3IucHJvdG90eXBlLmFkZEZpbGxldDI9ZnVuY3Rpb24ocCxzdGFydEFuZ2xlLGVuZEFuZ2xlLGRpcmVjdGlvbixyYWRpdXMpe3ZhciBkaXJlY3Rpb25GYWN0b3I9ZGlyZWN0aW9uPT09anN0cy5hbGdvcml0aG0uQ0dBbGdvcml0aG1zLkNMT0NLV0lTRT8tMToxO3ZhciB0b3RhbEFuZ2xlPU1hdGguYWJzKHN0YXJ0QW5nbGUtZW5kQW5nbGUpO3ZhciBuU2Vncz1wYXJzZUludCgodG90YWxBbmdsZS90aGlzLmZpbGxldEFuZ2xlUXVhbnR1bSswLjUpKTtpZihuU2VnczwxKVxucmV0dXJuO3ZhciBpbml0QW5nbGUsY3VyckFuZ2xlSW5jO2luaXRBbmdsZT0wLjA7Y3VyckFuZ2xlSW5jPXRvdGFsQW5nbGUvblNlZ3M7dmFyIGN1cnJBbmdsZT1pbml0QW5nbGU7dmFyIHB0PW5ldyBqc3RzLmdlb20uQ29vcmRpbmF0ZSgpO3doaWxlKGN1cnJBbmdsZTx0b3RhbEFuZ2xlKXt2YXIgYW5nbGU9c3RhcnRBbmdsZStkaXJlY3Rpb25GYWN0b3IqY3VyckFuZ2xlO3B0Lng9cC54K3JhZGl1cypNYXRoLmNvcyhhbmdsZSk7cHQueT1wLnkrcmFkaXVzKk1hdGguc2luKGFuZ2xlKTt0aGlzLnNlZ0xpc3QuYWRkUHQocHQpO2N1cnJBbmdsZSs9Y3VyckFuZ2xlSW5jO319O2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5PZmZzZXRTZWdtZW50R2VuZXJhdG9yLnByb3RvdHlwZS5jcmVhdGVDaXJjbGU9ZnVuY3Rpb24ocCl7dmFyIHB0PW5ldyBqc3RzLmdlb20uQ29vcmRpbmF0ZShwLngrdGhpcy5kaXN0YW5jZSxwLnkpO3RoaXMuc2VnTGlzdC5hZGRQdChwdCk7dGhpcy5hZGRGaWxsZXQocCwwLjAsMi4wKk1hdGguUEksLTEsdGhpcy5kaXN0YW5jZSk7dGhpcy5zZWdMaXN0LmNsb3NlUmluZygpO307anN0cy5vcGVyYXRpb24uYnVmZmVyLk9mZnNldFNlZ21lbnRHZW5lcmF0b3IucHJvdG90eXBlLmNyZWF0ZVNxdWFyZT1mdW5jdGlvbihwKXt0aGlzLnNlZ0xpc3QuYWRkUHQobmV3IGpzdHMuZ2VvbS5Db29yZGluYXRlKHAueCtkaXN0YW5jZSxwLnkrZGlzdGFuY2UpKTt0aGlzLnNlZ0xpc3QuYWRkUHQobmV3IGpzdHMuZ2VvbS5Db29yZGluYXRlKHAueCtkaXN0YW5jZSxwLnktZGlzdGFuY2UpKTt0aGlzLnNlZ0xpc3QuYWRkUHQobmV3IGpzdHMuZ2VvbS5Db29yZGluYXRlKHAueC1kaXN0YW5jZSxwLnktZGlzdGFuY2UpKTt0aGlzLnNlZ0xpc3QuYWRkUHQobmV3IGpzdHMuZ2VvbS5Db29yZGluYXRlKHAueC1kaXN0YW5jZSxwLnkrZGlzdGFuY2UpKTt0aGlzLnNlZ0xpc3QuY2xvc2VSaW5nKCk7fTtqc3RzLm9wZXJhdGlvbi5vdmVybGF5Lk1heGltYWxFZGdlUmluZz1mdW5jdGlvbihzdGFydCxnZW9tZXRyeUZhY3Rvcnkpe2pzdHMuZ2VvbWdyYXBoLkVkZ2VSaW5nLmNhbGwodGhpcyxzdGFydCxnZW9tZXRyeUZhY3RvcnkpO307anN0cy5vcGVyYXRpb24ub3ZlcmxheS5NYXhpbWFsRWRnZVJpbmcucHJvdG90eXBlPW5ldyBqc3RzLmdlb21ncmFwaC5FZGdlUmluZygpO2pzdHMub3BlcmF0aW9uLm92ZXJsYXkuTWF4aW1hbEVkZ2VSaW5nLmNvbnN0cnVjdG9yPWpzdHMub3BlcmF0aW9uLm92ZXJsYXkuTWF4aW1hbEVkZ2VSaW5nO2pzdHMub3BlcmF0aW9uLm92ZXJsYXkuTWF4aW1hbEVkZ2VSaW5nLnByb3RvdHlwZS5nZXROZXh0PWZ1bmN0aW9uKGRlKVxue3JldHVybiBkZS5nZXROZXh0KCk7fTtqc3RzLm9wZXJhdGlvbi5vdmVybGF5Lk1heGltYWxFZGdlUmluZy5wcm90b3R5cGUuc2V0RWRnZVJpbmc9ZnVuY3Rpb24oZGUsZXIpXG57ZGUuc2V0RWRnZVJpbmcoZXIpO307anN0cy5vcGVyYXRpb24ub3ZlcmxheS5NYXhpbWFsRWRnZVJpbmcucHJvdG90eXBlLmxpbmtEaXJlY3RlZEVkZ2VzRm9yTWluaW1hbEVkZ2VSaW5ncz1mdW5jdGlvbigpXG57dmFyIGRlPXRoaXMuc3RhcnREZTtkb3t2YXIgbm9kZT1kZS5nZXROb2RlKCk7bm9kZS5nZXRFZGdlcygpLmxpbmtNaW5pbWFsRGlyZWN0ZWRFZGdlcyh0aGlzKTtkZT1kZS5nZXROZXh0KCk7fXdoaWxlKGRlIT10aGlzLnN0YXJ0RGUpO307anN0cy5vcGVyYXRpb24ub3ZlcmxheS5NYXhpbWFsRWRnZVJpbmcucHJvdG90eXBlLmJ1aWxkTWluaW1hbFJpbmdzPWZ1bmN0aW9uKClcbnt2YXIgbWluRWRnZVJpbmdzPVtdO3ZhciBkZT10aGlzLnN0YXJ0RGU7ZG97aWYoZGUuZ2V0TWluRWRnZVJpbmcoKT09PW51bGwpe3ZhciBtaW5Fcj1uZXcganN0cy5vcGVyYXRpb24ub3ZlcmxheS5NaW5pbWFsRWRnZVJpbmcoZGUsdGhpcy5nZW9tZXRyeUZhY3RvcnkpO21pbkVkZ2VSaW5ncy5wdXNoKG1pbkVyKTt9XG5kZT1kZS5nZXROZXh0KCk7fXdoaWxlKGRlIT10aGlzLnN0YXJ0RGUpO3JldHVybiBtaW5FZGdlUmluZ3M7fTtqc3RzLmFsZ29yaXRobS5DZW50cm9pZFBvaW50PWZ1bmN0aW9uKCl7dGhpcy5jZW50U3VtPW5ldyBqc3RzLmdlb20uQ29vcmRpbmF0ZSgpO307anN0cy5hbGdvcml0aG0uQ2VudHJvaWRQb2ludC5wcm90b3R5cGUucHRDb3VudD0wO2pzdHMuYWxnb3JpdGhtLkNlbnRyb2lkUG9pbnQucHJvdG90eXBlLmNlbnRTdW09bnVsbDtqc3RzLmFsZ29yaXRobS5DZW50cm9pZFBvaW50LnByb3RvdHlwZS5hZGQ9ZnVuY3Rpb24oZ2VvbSl7aWYoZ2VvbSBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5Qb2ludCl7dGhpcy5hZGQyKGdlb20uZ2V0Q29vcmRpbmF0ZSgpKTt9ZWxzZSBpZihnZW9tIGluc3RhbmNlb2YganN0cy5nZW9tLkdlb21ldHJ5Q29sbGVjdGlvbnx8Z2VvbSBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5NdWx0aVBvaW50fHxnZW9tIGluc3RhbmNlb2YganN0cy5nZW9tLk11bHRpTGluZVN0cmluZ3x8Z2VvbSBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5NdWx0aVBvbHlnb24pe3ZhciBnYz1nZW9tO2Zvcih2YXIgaT0wO2k8Z2MuZ2V0TnVtR2VvbWV0cmllcygpO2krKyl7dGhpcy5hZGQoZ2MuZ2V0R2VvbWV0cnlOKGkpKTt9fX07anN0cy5hbGdvcml0aG0uQ2VudHJvaWRQb2ludC5wcm90b3R5cGUuYWRkMj1mdW5jdGlvbihwdCl7dGhpcy5wdENvdW50Kz0xO3RoaXMuY2VudFN1bS54Kz1wdC54O3RoaXMuY2VudFN1bS55Kz1wdC55O307anN0cy5hbGdvcml0aG0uQ2VudHJvaWRQb2ludC5wcm90b3R5cGUuZ2V0Q2VudHJvaWQ9ZnVuY3Rpb24oKXt2YXIgY2VudD1uZXcganN0cy5nZW9tLkNvb3JkaW5hdGUoKTtjZW50Lng9dGhpcy5jZW50U3VtLngvdGhpcy5wdENvdW50O2NlbnQueT10aGlzLmNlbnRTdW0ueS90aGlzLnB0Q291bnQ7cmV0dXJuIGNlbnQ7fTtqc3RzLm9wZXJhdGlvbi5kaXN0YW5jZS5Db25uZWN0ZWRFbGVtZW50TG9jYXRpb25GaWx0ZXI9ZnVuY3Rpb24obG9jYXRpb25zKXt0aGlzLmxvY2F0aW9ucz1sb2NhdGlvbnM7fTtqc3RzLm9wZXJhdGlvbi5kaXN0YW5jZS5Db25uZWN0ZWRFbGVtZW50TG9jYXRpb25GaWx0ZXIucHJvdG90eXBlPW5ldyBqc3RzLmdlb20uR2VvbWV0cnlGaWx0ZXIoKTtqc3RzLm9wZXJhdGlvbi5kaXN0YW5jZS5Db25uZWN0ZWRFbGVtZW50TG9jYXRpb25GaWx0ZXIucHJvdG90eXBlLmxvY2F0aW9ucz1udWxsO2pzdHMub3BlcmF0aW9uLmRpc3RhbmNlLkNvbm5lY3RlZEVsZW1lbnRMb2NhdGlvbkZpbHRlci5nZXRMb2NhdGlvbnM9ZnVuY3Rpb24oZ2VvbSl7dmFyIGxvY2F0aW9ucz1bXTtnZW9tLmFwcGx5KG5ldyBqc3RzLm9wZXJhdGlvbi5kaXN0YW5jZS5Db25uZWN0ZWRFbGVtZW50TG9jYXRpb25GaWx0ZXIobG9jYXRpb25zKSk7cmV0dXJuIGxvY2F0aW9uczt9O2pzdHMub3BlcmF0aW9uLmRpc3RhbmNlLkNvbm5lY3RlZEVsZW1lbnRMb2NhdGlvbkZpbHRlci5wcm90b3R5cGUuZmlsdGVyPWZ1bmN0aW9uKGdlb20pe2lmKGdlb20gaW5zdGFuY2VvZiBqc3RzLmdlb20uUG9pbnR8fGdlb20gaW5zdGFuY2VvZiBqc3RzLmdlb20uTGluZVN0cmluZ3x8Z2VvbSBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5Qb2x5Z29uKVxudGhpcy5sb2NhdGlvbnMucHVzaChuZXcganN0cy5vcGVyYXRpb24uZGlzdGFuY2UuR2VvbWV0cnlMb2NhdGlvbihnZW9tLDAsZ2VvbS5nZXRDb29yZGluYXRlKCkpKTt9O2pzdHMuZ2VvbWdyYXBoLmluZGV4Lk1vbm90b25lQ2hhaW5FZGdlPWZ1bmN0aW9uKGUpe3RoaXMuZT1lO3RoaXMucHRzPWUuZ2V0Q29vcmRpbmF0ZXMoKTt2YXIgbWNiPW5ldyBqc3RzLmdlb21ncmFwaC5pbmRleC5Nb25vdG9uZUNoYWluSW5kZXhlcigpO3RoaXMuc3RhcnRJbmRleD1tY2IuZ2V0Q2hhaW5TdGFydEluZGljZXModGhpcy5wdHMpO307anN0cy5nZW9tZ3JhcGguaW5kZXguTW9ub3RvbmVDaGFpbkVkZ2UucHJvdG90eXBlLmU9bnVsbDtqc3RzLmdlb21ncmFwaC5pbmRleC5Nb25vdG9uZUNoYWluRWRnZS5wcm90b3R5cGUucHRzPW51bGw7anN0cy5nZW9tZ3JhcGguaW5kZXguTW9ub3RvbmVDaGFpbkVkZ2UucHJvdG90eXBlLnN0YXJ0SW5kZXg9bnVsbDtqc3RzLmdlb21ncmFwaC5pbmRleC5Nb25vdG9uZUNoYWluRWRnZS5wcm90b3R5cGUuZW52MT1uZXcganN0cy5nZW9tLkVudmVsb3BlKCk7anN0cy5nZW9tZ3JhcGguaW5kZXguTW9ub3RvbmVDaGFpbkVkZ2UucHJvdG90eXBlLmVudjI9bmV3IGpzdHMuZ2VvbS5FbnZlbG9wZSgpO2pzdHMuZ2VvbWdyYXBoLmluZGV4Lk1vbm90b25lQ2hhaW5FZGdlLnByb3RvdHlwZS5nZXRDb29yZGluYXRlcz1mdW5jdGlvbigpe3JldHVybiB0aGlzLnB0czt9O2pzdHMuZ2VvbWdyYXBoLmluZGV4Lk1vbm90b25lQ2hhaW5FZGdlLnByb3RvdHlwZS5nZXRTdGFydEluZGV4ZXM9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5zdGFydEluZGV4O307anN0cy5nZW9tZ3JhcGguaW5kZXguTW9ub3RvbmVDaGFpbkVkZ2UucHJvdG90eXBlLmdldE1pblg9ZnVuY3Rpb24oY2hhaW5JbmRleCl7dmFyIHgxPXRoaXMucHRzW3RoaXMuc3RhcnRJbmRleFtjaGFpbkluZGV4XV0ueDt2YXIgeDI9dGhpcy5wdHNbdGhpcy5zdGFydEluZGV4W2NoYWluSW5kZXgrMV1dLng7aWYoeDE8eDIpe3JldHVybiB4MTt9XG5yZXR1cm4geDI7fTtqc3RzLmdlb21ncmFwaC5pbmRleC5Nb25vdG9uZUNoYWluRWRnZS5wcm90b3R5cGUuZ2V0TWF4WD1mdW5jdGlvbihjaGFpbkluZGV4KXt2YXIgeDE9dGhpcy5wdHNbdGhpcy5zdGFydEluZGV4W2NoYWluSW5kZXhdXS54O3ZhciB4Mj10aGlzLnB0c1t0aGlzLnN0YXJ0SW5kZXhbY2hhaW5JbmRleCsxXV0ueDtpZih4MT54Mil7cmV0dXJuIHgxO31cbnJldHVybiB4Mjt9O2pzdHMuZ2VvbWdyYXBoLmluZGV4Lk1vbm90b25lQ2hhaW5FZGdlLnByb3RvdHlwZS5jb21wdXRlSW50ZXJzZWN0cz1mdW5jdGlvbihtY2Usc2kpe2Zvcih2YXIgaT0wO2k8dGhpcy5zdGFydEluZGV4Lmxlbmd0aC0xO2krKyl7Zm9yKHZhciBqPTA7ajxtY2Uuc3RhcnRJbmRleC5sZW5ndGgtMTtqKyspe3RoaXMuY29tcHV0ZUludGVyc2VjdHNGb3JDaGFpbihpLG1jZSxqLHNpKTt9fX07anN0cy5nZW9tZ3JhcGguaW5kZXguTW9ub3RvbmVDaGFpbkVkZ2UucHJvdG90eXBlLmNvbXB1dGVJbnRlcnNlY3RzRm9yQ2hhaW49ZnVuY3Rpb24oY2hhaW5JbmRleDAsbWNlLGNoYWluSW5kZXgxLHNpKXt0aGlzLmNvbXB1dGVJbnRlcnNlY3RzRm9yQ2hhaW4yKHRoaXMuc3RhcnRJbmRleFtjaGFpbkluZGV4MF0sdGhpcy5zdGFydEluZGV4W2NoYWluSW5kZXgwKzFdLG1jZSxtY2Uuc3RhcnRJbmRleFtjaGFpbkluZGV4MV0sbWNlLnN0YXJ0SW5kZXhbY2hhaW5JbmRleDErMV0sc2kpO307anN0cy5nZW9tZ3JhcGguaW5kZXguTW9ub3RvbmVDaGFpbkVkZ2UucHJvdG90eXBlLmNvbXB1dGVJbnRlcnNlY3RzRm9yQ2hhaW4yPWZ1bmN0aW9uKHN0YXJ0MCxlbmQwLG1jZSxzdGFydDEsZW5kMSxlaSl7dmFyIHAwMD10aGlzLnB0c1tzdGFydDBdO3ZhciBwMDE9dGhpcy5wdHNbZW5kMF07dmFyIHAxMD1tY2UucHRzW3N0YXJ0MV07dmFyIHAxMT1tY2UucHRzW2VuZDFdO2lmKGVuZDAtc3RhcnQwPT0xJiZlbmQxLXN0YXJ0MT09MSl7ZWkuYWRkSW50ZXJzZWN0aW9ucyh0aGlzLmUsc3RhcnQwLG1jZS5lLHN0YXJ0MSk7cmV0dXJuO31cbnRoaXMuZW52MS5pbml0KHAwMCxwMDEpO3RoaXMuZW52Mi5pbml0KHAxMCxwMTEpO2lmKCF0aGlzLmVudjEuaW50ZXJzZWN0cyh0aGlzLmVudjIpKXtyZXR1cm47fVxudmFyIG1pZDA9TWF0aC5mbG9vcigoc3RhcnQwK2VuZDApLzIpO3ZhciBtaWQxPU1hdGguZmxvb3IoKHN0YXJ0MStlbmQxKS8yKTtpZihzdGFydDA8bWlkMCl7aWYoc3RhcnQxPG1pZDEpe3RoaXMuY29tcHV0ZUludGVyc2VjdHNGb3JDaGFpbjIoc3RhcnQwLG1pZDAsbWNlLHN0YXJ0MSxtaWQxLGVpKTt9XG5pZihtaWQxPGVuZDEpe3RoaXMuY29tcHV0ZUludGVyc2VjdHNGb3JDaGFpbjIoc3RhcnQwLG1pZDAsbWNlLG1pZDEsZW5kMSxlaSk7fX1cbmlmKG1pZDA8ZW5kMCl7aWYoc3RhcnQxPG1pZDEpe3RoaXMuY29tcHV0ZUludGVyc2VjdHNGb3JDaGFpbjIobWlkMCxlbmQwLG1jZSxzdGFydDEsbWlkMSxlaSk7fVxuaWYobWlkMTxlbmQxKXt0aGlzLmNvbXB1dGVJbnRlcnNlY3RzRm9yQ2hhaW4yKG1pZDAsZW5kMCxtY2UsbWlkMSxlbmQxLGVpKTt9fX07KGZ1bmN0aW9uKCl7dmFyIEFycmF5TGlzdD1qYXZhc2NyaXB0LnV0aWwuQXJyYXlMaXN0O2pzdHMub3BlcmF0aW9uLnJlbGF0ZS5FZGdlRW5kQnVpbGRlcj1mdW5jdGlvbigpe307anN0cy5vcGVyYXRpb24ucmVsYXRlLkVkZ2VFbmRCdWlsZGVyLnByb3RvdHlwZS5jb21wdXRlRWRnZUVuZHM9ZnVuY3Rpb24oZWRnZXMpe2lmKGFyZ3VtZW50cy5sZW5ndGg9PTIpe3RoaXMuY29tcHV0ZUVkZ2VFbmRzMi5hcHBseSh0aGlzLGFyZ3VtZW50cyk7cmV0dXJuO31cbnZhciBsPW5ldyBBcnJheUxpc3QoKTtmb3IodmFyIGk9ZWRnZXM7aS5oYXNOZXh0KCk7KXt2YXIgZT1pLm5leHQoKTt0aGlzLmNvbXB1dGVFZGdlRW5kczIoZSxsKTt9XG5yZXR1cm4gbDt9O2pzdHMub3BlcmF0aW9uLnJlbGF0ZS5FZGdlRW5kQnVpbGRlci5wcm90b3R5cGUuY29tcHV0ZUVkZ2VFbmRzMj1mdW5jdGlvbihlZGdlLGwpe3ZhciBlaUxpc3Q9ZWRnZS5nZXRFZGdlSW50ZXJzZWN0aW9uTGlzdCgpO2VpTGlzdC5hZGRFbmRwb2ludHMoKTt2YXIgaXQ9ZWlMaXN0Lml0ZXJhdG9yKCk7dmFyIGVpUHJldj1udWxsO3ZhciBlaUN1cnI9bnVsbDtpZighaXQuaGFzTmV4dCgpKVxucmV0dXJuO3ZhciBlaU5leHQ9aXQubmV4dCgpO2Rve2VpUHJldj1laUN1cnI7ZWlDdXJyPWVpTmV4dDtlaU5leHQ9bnVsbDtpZihpdC5oYXNOZXh0KCkpXG5laU5leHQ9aXQubmV4dCgpO2lmKGVpQ3VyciE9PW51bGwpe3RoaXMuY3JlYXRlRWRnZUVuZEZvclByZXYoZWRnZSxsLGVpQ3VycixlaVByZXYpO3RoaXMuY3JlYXRlRWRnZUVuZEZvck5leHQoZWRnZSxsLGVpQ3VycixlaU5leHQpO319d2hpbGUoZWlDdXJyIT09bnVsbCk7fTtqc3RzLm9wZXJhdGlvbi5yZWxhdGUuRWRnZUVuZEJ1aWxkZXIucHJvdG90eXBlLmNyZWF0ZUVkZ2VFbmRGb3JQcmV2PWZ1bmN0aW9uKGVkZ2UsbCxlaUN1cnIsZWlQcmV2KXt2YXIgaVByZXY9ZWlDdXJyLnNlZ21lbnRJbmRleDtpZihlaUN1cnIuZGlzdD09PTAuMCl7aWYoaVByZXY9PT0wKVxucmV0dXJuO2lQcmV2LS07fVxudmFyIHBQcmV2PWVkZ2UuZ2V0Q29vcmRpbmF0ZShpUHJldik7aWYoZWlQcmV2IT09bnVsbCYmZWlQcmV2LnNlZ21lbnRJbmRleD49aVByZXYpXG5wUHJldj1laVByZXYuY29vcmQ7dmFyIGxhYmVsPW5ldyBqc3RzLmdlb21ncmFwaC5MYWJlbChlZGdlLmdldExhYmVsKCkpO2xhYmVsLmZsaXAoKTt2YXIgZT1uZXcganN0cy5nZW9tZ3JhcGguRWRnZUVuZChlZGdlLGVpQ3Vyci5jb29yZCxwUHJldixsYWJlbCk7bC5hZGQoZSk7fTtqc3RzLm9wZXJhdGlvbi5yZWxhdGUuRWRnZUVuZEJ1aWxkZXIucHJvdG90eXBlLmNyZWF0ZUVkZ2VFbmRGb3JOZXh0PWZ1bmN0aW9uKGVkZ2UsbCxlaUN1cnIsZWlOZXh0KXt2YXIgaU5leHQ9ZWlDdXJyLnNlZ21lbnRJbmRleCsxO2lmKGlOZXh0Pj1lZGdlLmdldE51bVBvaW50cygpJiZlaU5leHQ9PT1udWxsKVxucmV0dXJuO3ZhciBwTmV4dD1lZGdlLmdldENvb3JkaW5hdGUoaU5leHQpO2lmKGVpTmV4dCE9PW51bGwmJmVpTmV4dC5zZWdtZW50SW5kZXg9PT1laUN1cnIuc2VnbWVudEluZGV4KVxucE5leHQ9ZWlOZXh0LmNvb3JkO3ZhciBlPW5ldyBqc3RzLmdlb21ncmFwaC5FZGdlRW5kKGVkZ2UsZWlDdXJyLmNvb3JkLHBOZXh0LG5ldyBqc3RzLmdlb21ncmFwaC5MYWJlbChlZGdlLmdldExhYmVsKCkpKTtsLmFkZChlKTt9O30pKCk7KGZ1bmN0aW9uKCl7dmFyIEFycmF5TGlzdD1qYXZhc2NyaXB0LnV0aWwuQXJyYXlMaXN0O3ZhciBUcmVlU2V0PWphdmFzY3JpcHQudXRpbC5UcmVlU2V0O3ZhciBDb29yZGluYXRlRmlsdGVyPWpzdHMuZ2VvbS5Db29yZGluYXRlRmlsdGVyO2pzdHMudXRpbC5VbmlxdWVDb29yZGluYXRlQXJyYXlGaWx0ZXI9ZnVuY3Rpb24oKXt0aGlzLnRyZWVTZXQ9bmV3IFRyZWVTZXQoKTt0aGlzLmxpc3Q9bmV3IEFycmF5TGlzdCgpO307anN0cy51dGlsLlVuaXF1ZUNvb3JkaW5hdGVBcnJheUZpbHRlci5wcm90b3R5cGU9bmV3IENvb3JkaW5hdGVGaWx0ZXIoKTtqc3RzLnV0aWwuVW5pcXVlQ29vcmRpbmF0ZUFycmF5RmlsdGVyLnByb3RvdHlwZS50cmVlU2V0PW51bGw7anN0cy51dGlsLlVuaXF1ZUNvb3JkaW5hdGVBcnJheUZpbHRlci5wcm90b3R5cGUubGlzdD1udWxsO2pzdHMudXRpbC5VbmlxdWVDb29yZGluYXRlQXJyYXlGaWx0ZXIucHJvdG90eXBlLmdldENvb3JkaW5hdGVzPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMubGlzdC50b0FycmF5KCk7fTtqc3RzLnV0aWwuVW5pcXVlQ29vcmRpbmF0ZUFycmF5RmlsdGVyLnByb3RvdHlwZS5maWx0ZXI9ZnVuY3Rpb24oY29vcmQpe2lmKCF0aGlzLnRyZWVTZXQuY29udGFpbnMoY29vcmQpKXt0aGlzLmxpc3QuYWRkKGNvb3JkKTt0aGlzLnRyZWVTZXQuYWRkKGNvb3JkKTt9fTt9KSgpOyhmdW5jdGlvbigpe3ZhciBDR0FsZ29yaXRobXM9anN0cy5hbGdvcml0aG0uQ0dBbGdvcml0aG1zO3ZhciBVbmlxdWVDb29yZGluYXRlQXJyYXlGaWx0ZXI9anN0cy51dGlsLlVuaXF1ZUNvb3JkaW5hdGVBcnJheUZpbHRlcjt2YXIgQXNzZXJ0PWpzdHMudXRpbC5Bc3NlcnQ7dmFyIFN0YWNrPWphdmFzY3JpcHQudXRpbC5TdGFjazt2YXIgQXJyYXlMaXN0PWphdmFzY3JpcHQudXRpbC5BcnJheUxpc3Q7dmFyIEFycmF5cz1qYXZhc2NyaXB0LnV0aWwuQXJyYXlzO3ZhciBSYWRpYWxDb21wYXJhdG9yPWZ1bmN0aW9uKG9yaWdpbil7dGhpcy5vcmlnaW49b3JpZ2luO307UmFkaWFsQ29tcGFyYXRvci5wcm90b3R5cGUub3JpZ2luPW51bGw7UmFkaWFsQ29tcGFyYXRvci5wcm90b3R5cGUuY29tcGFyZT1mdW5jdGlvbihvMSxvMil7dmFyIHAxPW8xO3ZhciBwMj1vMjtyZXR1cm4gUmFkaWFsQ29tcGFyYXRvci5wb2xhckNvbXBhcmUodGhpcy5vcmlnaW4scDEscDIpO307UmFkaWFsQ29tcGFyYXRvci5wb2xhckNvbXBhcmU9ZnVuY3Rpb24obyxwLHEpe3ZhciBkeHA9cC54LW8ueDt2YXIgZHlwPXAueS1vLnk7dmFyIGR4cT1xLngtby54O3ZhciBkeXE9cS55LW8ueTt2YXIgb3JpZW50PUNHQWxnb3JpdGhtcy5jb21wdXRlT3JpZW50YXRpb24obyxwLHEpO2lmKG9yaWVudD09Q0dBbGdvcml0aG1zLkNPVU5URVJDTE9DS1dJU0UpXG5yZXR1cm4gMTtpZihvcmllbnQ9PUNHQWxnb3JpdGhtcy5DTE9DS1dJU0UpXG5yZXR1cm4tMTt2YXIgb3A9ZHhwKmR4cCtkeXAqZHlwO3ZhciBvcT1keHEqZHhxK2R5cSpkeXE7aWYob3A8b3Epe3JldHVybi0xO31cbmlmKG9wPm9xKXtyZXR1cm4gMTt9XG5yZXR1cm4gMDt9O2pzdHMuYWxnb3JpdGhtLkNvbnZleEh1bGw9ZnVuY3Rpb24oKXtpZihhcmd1bWVudHMubGVuZ3RoPT09MSl7dmFyIGdlb21ldHJ5PWFyZ3VtZW50c1swXTt0aGlzLmlucHV0UHRzPWpzdHMuYWxnb3JpdGhtLkNvbnZleEh1bGwuZXh0cmFjdENvb3JkaW5hdGVzKGdlb21ldHJ5KTt0aGlzLmdlb21GYWN0b3J5PWdlb21ldHJ5LmdldEZhY3RvcnkoKTt9ZWxzZXt0aGlzLnB0cz1hcmd1bWVudHNbMF07dGhpcy5nZW9tRmFjdG9yeT1hcmd1bWVudHNbMV07fX07anN0cy5hbGdvcml0aG0uQ29udmV4SHVsbC5wcm90b3R5cGUuZ2VvbUZhY3Rvcnk9bnVsbDtqc3RzLmFsZ29yaXRobS5Db252ZXhIdWxsLnByb3RvdHlwZS5pbnB1dFB0cz1udWxsO2pzdHMuYWxnb3JpdGhtLkNvbnZleEh1bGwuZXh0cmFjdENvb3JkaW5hdGVzPWZ1bmN0aW9uKGdlb20pe3ZhciBmaWx0ZXI9bmV3IFVuaXF1ZUNvb3JkaW5hdGVBcnJheUZpbHRlcigpO2dlb20uYXBwbHkoZmlsdGVyKTtyZXR1cm4gZmlsdGVyLmdldENvb3JkaW5hdGVzKCk7fTtqc3RzLmFsZ29yaXRobS5Db252ZXhIdWxsLnByb3RvdHlwZS5nZXRDb252ZXhIdWxsPWZ1bmN0aW9uKCl7aWYodGhpcy5pbnB1dFB0cy5sZW5ndGg9PTApe3JldHVybiB0aGlzLmdlb21GYWN0b3J5LmNyZWF0ZUdlb21ldHJ5Q29sbGVjdGlvbihudWxsKTt9XG5pZih0aGlzLmlucHV0UHRzLmxlbmd0aD09MSl7cmV0dXJuIHRoaXMuZ2VvbUZhY3RvcnkuY3JlYXRlUG9pbnQodGhpcy5pbnB1dFB0c1swXSk7fVxuaWYodGhpcy5pbnB1dFB0cy5sZW5ndGg9PTIpe3JldHVybiB0aGlzLmdlb21GYWN0b3J5LmNyZWF0ZUxpbmVTdHJpbmcodGhpcy5pbnB1dFB0cyk7fVxudmFyIHJlZHVjZWRQdHM9dGhpcy5pbnB1dFB0cztpZih0aGlzLmlucHV0UHRzLmxlbmd0aD41MCl7cmVkdWNlZFB0cz10aGlzLnJlZHVjZSh0aGlzLmlucHV0UHRzKTt9XG52YXIgc29ydGVkUHRzPXRoaXMucHJlU29ydChyZWR1Y2VkUHRzKTt2YXIgY0hTPXRoaXMuZ3JhaGFtU2Nhbihzb3J0ZWRQdHMpO3ZhciBjSD1jSFMudG9BcnJheSgpO3JldHVybiB0aGlzLmxpbmVPclBvbHlnb24oY0gpO307anN0cy5hbGdvcml0aG0uQ29udmV4SHVsbC5wcm90b3R5cGUucmVkdWNlPWZ1bmN0aW9uKGlucHV0UHRzKXt2YXIgcG9seVB0cz10aGlzLmNvbXB1dGVPY3RSaW5nKGlucHV0UHRzKTtpZihwb2x5UHRzPT1udWxsKVxucmV0dXJuIHRoaXMuaW5wdXRQdHM7dmFyIHJlZHVjZWRTZXQ9bmV3IGphdmFzY3JpcHQudXRpbC5UcmVlU2V0KCk7Zm9yKHZhciBpPTA7aTxwb2x5UHRzLmxlbmd0aDtpKyspe3JlZHVjZWRTZXQuYWRkKHBvbHlQdHNbaV0pO31cbmZvcih2YXIgaT0wO2k8aW5wdXRQdHMubGVuZ3RoO2krKyl7aWYoIUNHQWxnb3JpdGhtcy5pc1BvaW50SW5SaW5nKGlucHV0UHRzW2ldLHBvbHlQdHMpKXtyZWR1Y2VkU2V0LmFkZChpbnB1dFB0c1tpXSk7fX1cbnZhciByZWR1Y2VkUHRzPXJlZHVjZWRTZXQudG9BcnJheSgpO2lmKHJlZHVjZWRQdHMubGVuZ3RoPDMpXG5yZXR1cm4gdGhpcy5wYWRBcnJheTMocmVkdWNlZFB0cyk7cmV0dXJuIHJlZHVjZWRQdHM7fTtqc3RzLmFsZ29yaXRobS5Db252ZXhIdWxsLnByb3RvdHlwZS5wYWRBcnJheTM9ZnVuY3Rpb24ocHRzKXt2YXIgcGFkPVtdO2Zvcih2YXIgaT0wO2k8cGFkLmxlbmd0aDtpKyspe2lmKGk8cHRzLmxlbmd0aCl7cGFkW2ldPXB0c1tpXTt9ZWxzZVxucGFkW2ldPXB0c1swXTt9XG5yZXR1cm4gcGFkO307anN0cy5hbGdvcml0aG0uQ29udmV4SHVsbC5wcm90b3R5cGUucHJlU29ydD1mdW5jdGlvbihwdHMpe3ZhciB0O2Zvcih2YXIgaT0xO2k8cHRzLmxlbmd0aDtpKyspe2lmKChwdHNbaV0ueTxwdHNbMF0ueSl8fCgocHRzW2ldLnk9PXB0c1swXS55KSYmKHB0c1tpXS54PHB0c1swXS54KSkpe3Q9cHRzWzBdO3B0c1swXT1wdHNbaV07cHRzW2ldPXQ7fX1cbkFycmF5cy5zb3J0KHB0cywxLHB0cy5sZW5ndGgsbmV3IFJhZGlhbENvbXBhcmF0b3IocHRzWzBdKSk7cmV0dXJuIHB0czt9O2pzdHMuYWxnb3JpdGhtLkNvbnZleEh1bGwucHJvdG90eXBlLmdyYWhhbVNjYW49ZnVuY3Rpb24oYyl7dmFyIHA7dmFyIHBzPW5ldyBTdGFjaygpO3A9cHMucHVzaChjWzBdKTtwPXBzLnB1c2goY1sxXSk7cD1wcy5wdXNoKGNbMl0pO2Zvcih2YXIgaT0zO2k8Yy5sZW5ndGg7aSsrKXtwPXBzLnBvcCgpO3doaWxlKCFwcy5lbXB0eSgpJiZDR0FsZ29yaXRobXMuY29tcHV0ZU9yaWVudGF0aW9uKHBzLnBlZWsoKSxwLGNbaV0pPjApe3A9cHMucG9wKCk7fVxucD1wcy5wdXNoKHApO3A9cHMucHVzaChjW2ldKTt9XG5wPXBzLnB1c2goY1swXSk7cmV0dXJuIHBzO307anN0cy5hbGdvcml0aG0uQ29udmV4SHVsbC5wcm90b3R5cGUuaXNCZXR3ZWVuPWZ1bmN0aW9uKGMxLGMyLGMzKXtpZihDR0FsZ29yaXRobXMuY29tcHV0ZU9yaWVudGF0aW9uKGMxLGMyLGMzKSE9PTApe3JldHVybiBmYWxzZTt9XG5pZihjMS54IT1jMy54KXtpZihjMS54PD1jMi54JiZjMi54PD1jMy54KXtyZXR1cm4gdHJ1ZTt9XG5pZihjMy54PD1jMi54JiZjMi54PD1jMS54KXtyZXR1cm4gdHJ1ZTt9fVxuaWYoYzEueSE9YzMueSl7aWYoYzEueTw9YzIueSYmYzIueTw9YzMueSl7cmV0dXJuIHRydWU7fVxuaWYoYzMueTw9YzIueSYmYzIueTw9YzEueSl7cmV0dXJuIHRydWU7fX1cbnJldHVybiBmYWxzZTt9O2pzdHMuYWxnb3JpdGhtLkNvbnZleEh1bGwucHJvdG90eXBlLmNvbXB1dGVPY3RSaW5nPWZ1bmN0aW9uKGlucHV0UHRzKXt2YXIgb2N0UHRzPXRoaXMuY29tcHV0ZU9jdFB0cyhpbnB1dFB0cyk7dmFyIGNvb3JkTGlzdD1uZXcganN0cy5nZW9tLkNvb3JkaW5hdGVMaXN0KCk7Y29vcmRMaXN0LmFkZChvY3RQdHMsZmFsc2UpO2lmKGNvb3JkTGlzdC5zaXplKCk8Myl7cmV0dXJuIG51bGw7fVxuY29vcmRMaXN0LmNsb3NlUmluZygpO3JldHVybiBjb29yZExpc3QudG9Db29yZGluYXRlQXJyYXkoKTt9O2pzdHMuYWxnb3JpdGhtLkNvbnZleEh1bGwucHJvdG90eXBlLmNvbXB1dGVPY3RQdHM9ZnVuY3Rpb24oaW5wdXRQdHMpe3ZhciBwdHM9W107Zm9yKHZhciBqPTA7ajw4O2orKyl7cHRzW2pdPWlucHV0UHRzWzBdO31cbmZvcih2YXIgaT0xO2k8aW5wdXRQdHMubGVuZ3RoO2krKyl7aWYoaW5wdXRQdHNbaV0ueDxwdHNbMF0ueCl7cHRzWzBdPWlucHV0UHRzW2ldO31cbmlmKGlucHV0UHRzW2ldLngtaW5wdXRQdHNbaV0ueTxwdHNbMV0ueC1wdHNbMV0ueSl7cHRzWzFdPWlucHV0UHRzW2ldO31cbmlmKGlucHV0UHRzW2ldLnk+cHRzWzJdLnkpe3B0c1syXT1pbnB1dFB0c1tpXTt9XG5pZihpbnB1dFB0c1tpXS54K2lucHV0UHRzW2ldLnk+cHRzWzNdLngrcHRzWzNdLnkpe3B0c1szXT1pbnB1dFB0c1tpXTt9XG5pZihpbnB1dFB0c1tpXS54PnB0c1s0XS54KXtwdHNbNF09aW5wdXRQdHNbaV07fVxuaWYoaW5wdXRQdHNbaV0ueC1pbnB1dFB0c1tpXS55PnB0c1s1XS54LXB0c1s1XS55KXtwdHNbNV09aW5wdXRQdHNbaV07fVxuaWYoaW5wdXRQdHNbaV0ueTxwdHNbNl0ueSl7cHRzWzZdPWlucHV0UHRzW2ldO31cbmlmKGlucHV0UHRzW2ldLngraW5wdXRQdHNbaV0ueTxwdHNbN10ueCtwdHNbN10ueSl7cHRzWzddPWlucHV0UHRzW2ldO319XG5yZXR1cm4gcHRzO307anN0cy5hbGdvcml0aG0uQ29udmV4SHVsbC5wcm90b3R5cGUubGluZU9yUG9seWdvbj1mdW5jdGlvbihjb29yZGluYXRlcyl7Y29vcmRpbmF0ZXM9dGhpcy5jbGVhblJpbmcoY29vcmRpbmF0ZXMpO2lmKGNvb3JkaW5hdGVzLmxlbmd0aD09Myl7cmV0dXJuIHRoaXMuZ2VvbUZhY3RvcnkuY3JlYXRlTGluZVN0cmluZyhbY29vcmRpbmF0ZXNbMF0sY29vcmRpbmF0ZXNbMV1dKTt9XG52YXIgbGluZWFyUmluZz10aGlzLmdlb21GYWN0b3J5LmNyZWF0ZUxpbmVhclJpbmcoY29vcmRpbmF0ZXMpO3JldHVybiB0aGlzLmdlb21GYWN0b3J5LmNyZWF0ZVBvbHlnb24obGluZWFyUmluZyxudWxsKTt9O2pzdHMuYWxnb3JpdGhtLkNvbnZleEh1bGwucHJvdG90eXBlLmNsZWFuUmluZz1mdW5jdGlvbihvcmlnaW5hbCl7QXNzZXJ0LmVxdWFscyhvcmlnaW5hbFswXSxvcmlnaW5hbFtvcmlnaW5hbC5sZW5ndGgtMV0pO3ZhciBjbGVhbmVkUmluZz1uZXcgQXJyYXlMaXN0KCk7dmFyIHByZXZpb3VzRGlzdGluY3RDb29yZGluYXRlPW51bGw7Zm9yKHZhciBpPTA7aTw9b3JpZ2luYWwubGVuZ3RoLTI7aSsrKXt2YXIgY3VycmVudENvb3JkaW5hdGU9b3JpZ2luYWxbaV07dmFyIG5leHRDb29yZGluYXRlPW9yaWdpbmFsW2krMV07aWYoY3VycmVudENvb3JkaW5hdGUuZXF1YWxzKG5leHRDb29yZGluYXRlKSl7Y29udGludWU7fVxuaWYocHJldmlvdXNEaXN0aW5jdENvb3JkaW5hdGUhPW51bGwmJnRoaXMuaXNCZXR3ZWVuKHByZXZpb3VzRGlzdGluY3RDb29yZGluYXRlLGN1cnJlbnRDb29yZGluYXRlLG5leHRDb29yZGluYXRlKSl7Y29udGludWU7fVxuY2xlYW5lZFJpbmcuYWRkKGN1cnJlbnRDb29yZGluYXRlKTtwcmV2aW91c0Rpc3RpbmN0Q29vcmRpbmF0ZT1jdXJyZW50Q29vcmRpbmF0ZTt9XG5jbGVhbmVkUmluZy5hZGQob3JpZ2luYWxbb3JpZ2luYWwubGVuZ3RoLTFdKTt2YXIgY2xlYW5lZFJpbmdDb29yZGluYXRlcz1bXTtyZXR1cm4gY2xlYW5lZFJpbmcudG9BcnJheShjbGVhbmVkUmluZ0Nvb3JkaW5hdGVzKTt9O30pKCk7anN0cy5hbGdvcml0aG0uTWluaW11bURpYW1ldGVyPWZ1bmN0aW9uKGlucHV0R2VvbSxpc0NvbnZleCl7dGhpcy5jb252ZXhIdWxsUHRzPW51bGw7dGhpcy5taW5CYXNlU2VnPW5ldyBqc3RzLmdlb20uTGluZVNlZ21lbnQoKTt0aGlzLm1pbldpZHRoUHQ9bnVsbDt0aGlzLm1pblB0SW5kZXg9MDt0aGlzLm1pbldpZHRoPTA7anN0cy5hbGdvcml0aG0uTWluaW11bURpYW1ldGVyLmlucHV0R2VvbT1pbnB1dEdlb207anN0cy5hbGdvcml0aG0uTWluaW11bURpYW1ldGVyLmlzQ29udmV4PWlzQ29udmV4fHxmYWxzZTt9O2pzdHMuYWxnb3JpdGhtLk1pbmltdW1EaWFtZXRlci5pbnB1dEdlb209bnVsbDtqc3RzLmFsZ29yaXRobS5NaW5pbXVtRGlhbWV0ZXIuaXNDb252ZXg9ZmFsc2U7anN0cy5hbGdvcml0aG0uTWluaW11bURpYW1ldGVyLm5leHRJbmRleD1mdW5jdGlvbihwdHMsaW5kZXgpe2luZGV4Kys7aWYoaW5kZXg+PXB0cy5sZW5ndGgpe2luZGV4PTA7fVxucmV0dXJuIGluZGV4O307anN0cy5hbGdvcml0aG0uTWluaW11bURpYW1ldGVyLmNvbXB1dGVDPWZ1bmN0aW9uKGEsYixwKXtyZXR1cm4gYSpwLnktYipwLng7fTtqc3RzLmFsZ29yaXRobS5NaW5pbXVtRGlhbWV0ZXIuY29tcHV0ZVNlZ21lbnRGb3JMaW5lPWZ1bmN0aW9uKGEsYixjKXt2YXIgcDA7dmFyIHAxO2lmKE1hdGguYWJzKGIpPk1hdGguYWJzKGEpKXtwMD1uZXcganN0cy5nZW9tLkNvb3JkaW5hdGUoMCxjL2IpO3AxPW5ldyBqc3RzLmdlb20uQ29vcmRpbmF0ZSgxLGMvYi1hL2IpO31cbmVsc2V7cDA9bmV3IGpzdHMuZ2VvbS5Db29yZGluYXRlKGMvYSwwKTtwMT1uZXcganN0cy5nZW9tLkNvb3JkaW5hdGUoYy9hLWIvYSwxKTt9XG5yZXR1cm4gbmV3IGpzdHMuZ2VvbS5MaW5lU2VnbWVudChwMCxwMSk7fTtqc3RzLmFsZ29yaXRobS5NaW5pbXVtRGlhbWV0ZXIucHJvdG90eXBlLmdldExlbmd0aD1mdW5jdGlvbigpe3RoaXMuY29tcHV0ZU1pbmltdW1EaWFtZXRlcigpO3JldHVybiB0aGlzLm1pbldpZHRoO307anN0cy5hbGdvcml0aG0uTWluaW11bURpYW1ldGVyLnByb3RvdHlwZS5nZXRXaWR0aENvb3JkaW5hdGU9ZnVuY3Rpb24oKXt0aGlzLmNvbXB1dGVNaW5pbXVtRGlhbWV0ZXIoKTtyZXR1cm4gdGhpcy5taW5XaWR0aFB0O307anN0cy5hbGdvcml0aG0uTWluaW11bURpYW1ldGVyLnByb3RvdHlwZS5nZXRTdXBwb3J0aW5nU2VnbWVudD1mdW5jdGlvbigpe3RoaXMuY29tcHV0ZU1pbmltdW1EaWFtZXRlcigpO3ZhciBjb29yZD1bdGhpcy5taW5CYXNlU2VnLnAwLHRoaXMubWluQmFzZVNlZy5wMV07cmV0dXJuIGpzdHMuYWxnb3JpdGhtLk1pbmltdW1EaWFtZXRlci5pbnB1dEdlb20uZ2V0RmFjdG9yeSgpLmNyZWF0ZUxpbmVTdHJpbmcoY29vcmQpO307anN0cy5hbGdvcml0aG0uTWluaW11bURpYW1ldGVyLnByb3RvdHlwZS5nZXREaWFtZXRlcj1mdW5jdGlvbigpe3RoaXMuY29tcHV0ZU1pbmltdW1EaWFtZXRlcigpO2lmKHRoaXMubWluV2lkdGhQdD09PW51bGwpe3JldHVybiBqc3RzLmFsZ29yaXRobS5NaW5pbXVtRGlhbWV0ZXIuaW5wdXRHZW9tLmdldEZhY3RvcnkoKS5jcmVhdGVMaW5lU3RyaW5nKG51bGwpO31cbnZhciBiYXNlUHQ9dGhpcy5taW5CYXNlU2VnLnByb2plY3QodGhpcy5taW5XaWR0aFB0KTtyZXR1cm4ganN0cy5hbGdvcml0aG0uTWluaW11bURpYW1ldGVyLmlucHV0R2VvbS5nZXRGYWN0b3J5KCkuY3JlYXRlTGluZVN0cmluZyhbYmFzZVB0LHRoaXMubWluV2lkdGhQdF0pO307anN0cy5hbGdvcml0aG0uTWluaW11bURpYW1ldGVyLnByb3RvdHlwZS5jb21wdXRlTWluaW11bURpYW1ldGVyPWZ1bmN0aW9uKCl7aWYodGhpcy5taW5XaWR0aFB0IT09bnVsbCl7cmV0dXJuO31cbmlmKGpzdHMuYWxnb3JpdGhtLk1pbmltdW1EaWFtZXRlci5pc0NvbnZleClcbnRoaXMuY29tcHV0ZVdpZHRoQ29udmV4KGpzdHMuYWxnb3JpdGhtLk1pbmltdW1EaWFtZXRlci5pbnB1dEdlb20pO2Vsc2V7dmFyIGNvbnZleEdlb209bmV3IGpzdHMuYWxnb3JpdGhtLkNvbnZleEh1bGwoanN0cy5hbGdvcml0aG0uTWluaW11bURpYW1ldGVyLmlucHV0R2VvbSkuZ2V0Q29udmV4SHVsbCgpO3RoaXMuY29tcHV0ZVdpZHRoQ29udmV4KGNvbnZleEdlb20pO319O2pzdHMuYWxnb3JpdGhtLk1pbmltdW1EaWFtZXRlci5wcm90b3R5cGUuY29tcHV0ZVdpZHRoQ29udmV4PWZ1bmN0aW9uKGNvbnZleEdlb20pe2lmKGNvbnZleEdlb20gaW5zdGFuY2VvZiBqc3RzLmdlb20uUG9seWdvbil7dGhpcy5jb252ZXhIdWxsUHRzPWNvbnZleEdlb20uZ2V0RXh0ZXJpb3JSaW5nKCkuZ2V0Q29vcmRpbmF0ZXMoKTt9ZWxzZXt0aGlzLmNvbnZleEh1bGxQdHM9Y29udmV4R2VvbS5nZXRDb29yZGluYXRlcygpO31cbmlmKHRoaXMuY29udmV4SHVsbFB0cy5sZW5ndGg9PT0wKXt0aGlzLm1pbldpZHRoPTA7dGhpcy5taW5XaWR0aFB0PW51bGw7dGhpcy5taW5CYXNlU2VnPW51bGw7fWVsc2UgaWYodGhpcy5jb252ZXhIdWxsUHRzLmxlbmd0aD09PTEpe3RoaXMubWluV2lkdGg9MDt0aGlzLm1pbldpZHRoUHQ9dGhpcy5jb252ZXhIdWxsUHRzWzBdO3RoaXMubWluQmFzZVNlZy5wMD10aGlzLmNvbnZleEh1bGxQdHNbMF07dGhpcy5taW5CYXNlU2VnLnAxPXRoaXMuY29udmV4SHVsbFB0c1swXTt9ZWxzZSBpZih0aGlzLmNvbnZleEh1bGxQdHMubGVuZ3RoPT09Mnx8dGhpcy5jb252ZXhIdWxsUHRzLmxlbmd0aD09PTMpe3RoaXMubWluV2lkdGg9MDt0aGlzLm1pbldpZHRoUHQ9dGhpcy5jb252ZXhIdWxsUHRzWzBdO3RoaXMubWluQmFzZVNlZy5wMD10aGlzLmNvbnZleEh1bGxQdHNbMF07dGhpcy5taW5CYXNlU2VnLnAxPXRoaXMuY29udmV4SHVsbFB0c1sxXTt9ZWxzZXt0aGlzLmNvbXB1dGVDb252ZXhSaW5nTWluRGlhbWV0ZXIodGhpcy5jb252ZXhIdWxsUHRzKTt9fTtqc3RzLmFsZ29yaXRobS5NaW5pbXVtRGlhbWV0ZXIucHJvdG90eXBlLmNvbXB1dGVDb252ZXhSaW5nTWluRGlhbWV0ZXI9ZnVuY3Rpb24ocHRzKXt0aGlzLm1pbldpZHRoPU51bWJlci5NQVhfVkFMVUU7dmFyIGN1cnJNYXhJbmRleD0xO3ZhciBzZWc9bmV3IGpzdHMuZ2VvbS5MaW5lU2VnbWVudCgpO2Zvcih2YXIgaT0wO2k8cHRzLmxlbmd0aC0xO2krKyl7c2VnLnAwPXB0c1tpXTtzZWcucDE9cHRzW2krMV07Y3Vyck1heEluZGV4PXRoaXMuZmluZE1heFBlcnBEaXN0YW5jZShwdHMsc2VnLGN1cnJNYXhJbmRleCk7fX07anN0cy5hbGdvcml0aG0uTWluaW11bURpYW1ldGVyLnByb3RvdHlwZS5maW5kTWF4UGVycERpc3RhbmNlPWZ1bmN0aW9uKHB0cyxzZWcsc3RhcnRJbmRleCl7dmFyIG1heFBlcnBEaXN0YW5jZT1zZWcuZGlzdGFuY2VQZXJwZW5kaWN1bGFyKHB0c1tzdGFydEluZGV4XSk7dmFyIG5leHRQZXJwRGlzdGFuY2U9bWF4UGVycERpc3RhbmNlO3ZhciBtYXhJbmRleD1zdGFydEluZGV4O3ZhciBuZXh0SW5kZXg9bWF4SW5kZXg7d2hpbGUobmV4dFBlcnBEaXN0YW5jZT49bWF4UGVycERpc3RhbmNlKXttYXhQZXJwRGlzdGFuY2U9bmV4dFBlcnBEaXN0YW5jZTttYXhJbmRleD1uZXh0SW5kZXg7bmV4dEluZGV4PWpzdHMuYWxnb3JpdGhtLk1pbmltdW1EaWFtZXRlci5uZXh0SW5kZXgocHRzLG1heEluZGV4KTtuZXh0UGVycERpc3RhbmNlPXNlZy5kaXN0YW5jZVBlcnBlbmRpY3VsYXIocHRzW25leHRJbmRleF0pO31cbmlmKG1heFBlcnBEaXN0YW5jZTx0aGlzLm1pbldpZHRoKXt0aGlzLm1pblB0SW5kZXg9bWF4SW5kZXg7dGhpcy5taW5XaWR0aD1tYXhQZXJwRGlzdGFuY2U7dGhpcy5taW5XaWR0aFB0PXB0c1t0aGlzLm1pblB0SW5kZXhdO3RoaXMubWluQmFzZVNlZz1uZXcganN0cy5nZW9tLkxpbmVTZWdtZW50KHNlZyk7fVxucmV0dXJuIG1heEluZGV4O307anN0cy5hbGdvcml0aG0uTWluaW11bURpYW1ldGVyLnByb3RvdHlwZS5nZXRNaW5pbXVtUmVjdGFuZ2xlPWZ1bmN0aW9uKCl7dGhpcy5jb21wdXRlTWluaW11bURpYW1ldGVyKCk7aWYodGhpcy5taW5XaWR0aD09PTApe2lmKHRoaXMubWluQmFzZVNlZy5wMC5lcXVhbHMyRCh0aGlzLm1pbkJhc2VTZWcucDEpKXtyZXR1cm4ganN0cy5hbGdvcml0aG0uTWluaW11bURpYW1ldGVyLmlucHV0R2VvbS5nZXRGYWN0b3J5KCkuY3JlYXRlUG9pbnQodGhpcy5taW5CYXNlU2VnLnAwKTt9XG5yZXR1cm4gdGhpcy5taW5CYXNlU2VnLnRvR2VvbWV0cnkoanN0cy5hbGdvcml0aG0uTWluaW11bURpYW1ldGVyLmlucHV0R2VvbS5nZXRGYWN0b3J5KCkpO31cbnZhciBkeD10aGlzLm1pbkJhc2VTZWcucDEueC10aGlzLm1pbkJhc2VTZWcucDAueDt2YXIgZHk9dGhpcy5taW5CYXNlU2VnLnAxLnktdGhpcy5taW5CYXNlU2VnLnAwLnk7dmFyIG1pblBhcmE9TnVtYmVyLk1BWF9WQUxVRTt2YXIgbWF4UGFyYT0tTnVtYmVyLk1BWF9WQUxVRTt2YXIgbWluUGVycD1OdW1iZXIuTUFYX1ZBTFVFO3ZhciBtYXhQZXJwPS1OdW1iZXIuTUFYX1ZBTFVFO2Zvcih2YXIgaT0wO2k8dGhpcy5jb252ZXhIdWxsUHRzLmxlbmd0aDtpKyspe3ZhciBwYXJhQz1qc3RzLmFsZ29yaXRobS5NaW5pbXVtRGlhbWV0ZXIuY29tcHV0ZUMoZHgsZHksdGhpcy5jb252ZXhIdWxsUHRzW2ldKTtpZihwYXJhQz5tYXhQYXJhKW1heFBhcmE9cGFyYUM7aWYocGFyYUM8bWluUGFyYSltaW5QYXJhPXBhcmFDO3ZhciBwZXJwQz1qc3RzLmFsZ29yaXRobS5NaW5pbXVtRGlhbWV0ZXIuY29tcHV0ZUMoLWR5LGR4LHRoaXMuY29udmV4SHVsbFB0c1tpXSk7aWYocGVycEM+bWF4UGVycCltYXhQZXJwPXBlcnBDO2lmKHBlcnBDPG1pblBlcnApbWluUGVycD1wZXJwQzt9XG52YXIgbWF4UGVycExpbmU9anN0cy5hbGdvcml0aG0uTWluaW11bURpYW1ldGVyLmNvbXB1dGVTZWdtZW50Rm9yTGluZSgtZHgsLWR5LG1heFBlcnApO3ZhciBtaW5QZXJwTGluZT1qc3RzLmFsZ29yaXRobS5NaW5pbXVtRGlhbWV0ZXIuY29tcHV0ZVNlZ21lbnRGb3JMaW5lKC1keCwtZHksbWluUGVycCk7dmFyIG1heFBhcmFMaW5lPWpzdHMuYWxnb3JpdGhtLk1pbmltdW1EaWFtZXRlci5jb21wdXRlU2VnbWVudEZvckxpbmUoLWR5LGR4LG1heFBhcmEpO3ZhciBtaW5QYXJhTGluZT1qc3RzLmFsZ29yaXRobS5NaW5pbXVtRGlhbWV0ZXIuY29tcHV0ZVNlZ21lbnRGb3JMaW5lKC1keSxkeCxtaW5QYXJhKTt2YXIgcDA9bWF4UGFyYUxpbmUubGluZUludGVyc2VjdGlvbihtYXhQZXJwTGluZSk7dmFyIHAxPW1pblBhcmFMaW5lLmxpbmVJbnRlcnNlY3Rpb24obWF4UGVycExpbmUpO3ZhciBwMj1taW5QYXJhTGluZS5saW5lSW50ZXJzZWN0aW9uKG1pblBlcnBMaW5lKTt2YXIgcDM9bWF4UGFyYUxpbmUubGluZUludGVyc2VjdGlvbihtaW5QZXJwTGluZSk7dmFyIHNoZWxsPWpzdHMuYWxnb3JpdGhtLk1pbmltdW1EaWFtZXRlci5pbnB1dEdlb20uZ2V0RmFjdG9yeSgpLmNyZWF0ZUxpbmVhclJpbmcoW3AwLHAxLHAyLHAzLHAwXSk7cmV0dXJuIGpzdHMuYWxnb3JpdGhtLk1pbmltdW1EaWFtZXRlci5pbnB1dEdlb20uZ2V0RmFjdG9yeSgpLmNyZWF0ZVBvbHlnb24oc2hlbGwsbnVsbCk7fTsoZnVuY3Rpb24oKXtqc3RzLmlvLkdlb0pTT05QYXJzZXI9ZnVuY3Rpb24oZ2VvbWV0cnlGYWN0b3J5KXt0aGlzLmdlb21ldHJ5RmFjdG9yeT1nZW9tZXRyeUZhY3Rvcnl8fG5ldyBqc3RzLmdlb20uR2VvbWV0cnlGYWN0b3J5KCk7dGhpcy5nZW9tZXRyeVR5cGVzPVsnUG9pbnQnLCdNdWx0aVBvaW50JywnTGluZVN0cmluZycsJ011bHRpTGluZVN0cmluZycsJ1BvbHlnb24nLCdNdWx0aVBvbHlnb24nXTt9O2pzdHMuaW8uR2VvSlNPTlBhcnNlci5wcm90b3R5cGUucmVhZD1mdW5jdGlvbihqc29uKXt2YXIgb2JqO2lmKHR5cGVvZiBqc29uPT09J3N0cmluZycpe29iaj1KU09OLnBhcnNlKGpzb24pO31lbHNle29iaj1qc29uO31cbnZhciB0eXBlPW9iai50eXBlO2lmKCF0aGlzLnBhcnNlW3R5cGVdKXt0aHJvdyBuZXcgRXJyb3IoJ1Vua25vd24gR2VvSlNPTiB0eXBlOiAnK29iai50eXBlKTt9XG5pZih0aGlzLmdlb21ldHJ5VHlwZXMuaW5kZXhPZih0eXBlKSE9LTEpe3JldHVybiB0aGlzLnBhcnNlW3R5cGVdLmFwcGx5KHRoaXMsW29iai5jb29yZGluYXRlc10pO31lbHNlIGlmKHR5cGU9PT0nR2VvbWV0cnlDb2xsZWN0aW9uJyl7cmV0dXJuIHRoaXMucGFyc2VbdHlwZV0uYXBwbHkodGhpcyxbb2JqLmdlb21ldHJpZXNdKTt9XG5yZXR1cm4gdGhpcy5wYXJzZVt0eXBlXS5hcHBseSh0aGlzLFtvYmpdKTt9O2pzdHMuaW8uR2VvSlNPTlBhcnNlci5wcm90b3R5cGUucGFyc2U9eydGZWF0dXJlJzpmdW5jdGlvbihvYmope3ZhciBmZWF0dXJlPXt9O2Zvcih2YXIga2V5IGluIG9iail7ZmVhdHVyZVtrZXldPW9ialtrZXldO31cbmlmKG9iai5nZW9tZXRyeSl7dmFyIHR5cGU9b2JqLmdlb21ldHJ5LnR5cGU7aWYoIXRoaXMucGFyc2VbdHlwZV0pe3Rocm93IG5ldyBFcnJvcignVW5rbm93biBHZW9KU09OIHR5cGU6ICcrb2JqLnR5cGUpO31cbmZlYXR1cmUuZ2VvbWV0cnk9dGhpcy5yZWFkKG9iai5nZW9tZXRyeSk7fVxuaWYob2JqLmJib3gpe2ZlYXR1cmUuYmJveD10aGlzLnBhcnNlLmJib3guYXBwbHkodGhpcyxbb2JqLmJib3hdKTt9XG5yZXR1cm4gZmVhdHVyZTt9LCdGZWF0dXJlQ29sbGVjdGlvbic6ZnVuY3Rpb24ob2JqKXt2YXIgZmVhdHVyZUNvbGxlY3Rpb249e307aWYob2JqLmZlYXR1cmVzKXtmZWF0dXJlQ29sbGVjdGlvbi5mZWF0dXJlcz1bXTtmb3IodmFyIGk9MDtpPG9iai5mZWF0dXJlcy5sZW5ndGg7KytpKXtmZWF0dXJlQ29sbGVjdGlvbi5mZWF0dXJlcy5wdXNoKHRoaXMucmVhZChvYmouZmVhdHVyZXNbaV0pKTt9fVxuaWYob2JqLmJib3gpe2ZlYXR1cmVDb2xsZWN0aW9uLmJib3g9dGhpcy5wYXJzZS5iYm94LmFwcGx5KHRoaXMsW29iai5iYm94XSk7fVxucmV0dXJuIGZlYXR1cmVDb2xsZWN0aW9uO30sJ2Nvb3JkaW5hdGVzJzpmdW5jdGlvbihhcnJheSl7dmFyIGNvb3JkaW5hdGVzPVtdO2Zvcih2YXIgaT0wO2k8YXJyYXkubGVuZ3RoOysraSl7dmFyIHN1Yj1hcnJheVtpXTtjb29yZGluYXRlcy5wdXNoKG5ldyBqc3RzLmdlb20uQ29vcmRpbmF0ZShzdWJbMF0sc3ViWzFdKSk7fVxucmV0dXJuIGNvb3JkaW5hdGVzO30sJ2Jib3gnOmZ1bmN0aW9uKGFycmF5KXtyZXR1cm4gdGhpcy5nZW9tZXRyeUZhY3RvcnkuY3JlYXRlTGluZWFyUmluZyhbbmV3IGpzdHMuZ2VvbS5Db29yZGluYXRlKGFycmF5WzBdLGFycmF5WzFdKSxuZXcganN0cy5nZW9tLkNvb3JkaW5hdGUoYXJyYXlbMl0sYXJyYXlbMV0pLG5ldyBqc3RzLmdlb20uQ29vcmRpbmF0ZShhcnJheVsyXSxhcnJheVszXSksbmV3IGpzdHMuZ2VvbS5Db29yZGluYXRlKGFycmF5WzBdLGFycmF5WzNdKSxuZXcganN0cy5nZW9tLkNvb3JkaW5hdGUoYXJyYXlbMF0sYXJyYXlbMV0pXSk7fSwnUG9pbnQnOmZ1bmN0aW9uKGFycmF5KXt2YXIgY29vcmRpbmF0ZT1uZXcganN0cy5nZW9tLkNvb3JkaW5hdGUoYXJyYXlbMF0sYXJyYXlbMV0pO3JldHVybiB0aGlzLmdlb21ldHJ5RmFjdG9yeS5jcmVhdGVQb2ludChjb29yZGluYXRlKTt9LCdNdWx0aVBvaW50JzpmdW5jdGlvbihhcnJheSl7dmFyIHBvaW50cz1bXTtmb3IodmFyIGk9MDtpPGFycmF5Lmxlbmd0aDsrK2kpe3BvaW50cy5wdXNoKHRoaXMucGFyc2UuUG9pbnQuYXBwbHkodGhpcyxbYXJyYXlbaV1dKSk7fVxucmV0dXJuIHRoaXMuZ2VvbWV0cnlGYWN0b3J5LmNyZWF0ZU11bHRpUG9pbnQocG9pbnRzKTt9LCdMaW5lU3RyaW5nJzpmdW5jdGlvbihhcnJheSl7dmFyIGNvb3JkaW5hdGVzPXRoaXMucGFyc2UuY29vcmRpbmF0ZXMuYXBwbHkodGhpcyxbYXJyYXldKTtyZXR1cm4gdGhpcy5nZW9tZXRyeUZhY3RvcnkuY3JlYXRlTGluZVN0cmluZyhjb29yZGluYXRlcyk7fSwnTXVsdGlMaW5lU3RyaW5nJzpmdW5jdGlvbihhcnJheSl7dmFyIGxpbmVTdHJpbmdzPVtdO2Zvcih2YXIgaT0wO2k8YXJyYXkubGVuZ3RoOysraSl7bGluZVN0cmluZ3MucHVzaCh0aGlzLnBhcnNlLkxpbmVTdHJpbmcuYXBwbHkodGhpcyxbYXJyYXlbaV1dKSk7fVxucmV0dXJuIHRoaXMuZ2VvbWV0cnlGYWN0b3J5LmNyZWF0ZU11bHRpTGluZVN0cmluZyhsaW5lU3RyaW5ncyk7fSwnUG9seWdvbic6ZnVuY3Rpb24oYXJyYXkpe3ZhciBzaGVsbENvb3JkaW5hdGVzPXRoaXMucGFyc2UuY29vcmRpbmF0ZXMuYXBwbHkodGhpcyxbYXJyYXlbMF1dKTt2YXIgc2hlbGw9dGhpcy5nZW9tZXRyeUZhY3RvcnkuY3JlYXRlTGluZWFyUmluZyhzaGVsbENvb3JkaW5hdGVzKTt2YXIgaG9sZXM9W107Zm9yKHZhciBpPTE7aTxhcnJheS5sZW5ndGg7KytpKXt2YXIgaG9sZT1hcnJheVtpXTt2YXIgY29vcmRpbmF0ZXM9dGhpcy5wYXJzZS5jb29yZGluYXRlcy5hcHBseSh0aGlzLFtob2xlXSk7dmFyIGxpbmVhclJpbmc9dGhpcy5nZW9tZXRyeUZhY3RvcnkuY3JlYXRlTGluZWFyUmluZyhjb29yZGluYXRlcyk7aG9sZXMucHVzaChsaW5lYXJSaW5nKTt9XG5yZXR1cm4gdGhpcy5nZW9tZXRyeUZhY3RvcnkuY3JlYXRlUG9seWdvbihzaGVsbCxob2xlcyk7fSwnTXVsdGlQb2x5Z29uJzpmdW5jdGlvbihhcnJheSl7dmFyIHBvbHlnb25zPVtdO2Zvcih2YXIgaT0wO2k8YXJyYXkubGVuZ3RoOysraSl7dmFyIHBvbHlnb249YXJyYXlbaV07cG9seWdvbnMucHVzaCh0aGlzLnBhcnNlLlBvbHlnb24uYXBwbHkodGhpcyxbcG9seWdvbl0pKTt9XG5yZXR1cm4gdGhpcy5nZW9tZXRyeUZhY3RvcnkuY3JlYXRlTXVsdGlQb2x5Z29uKHBvbHlnb25zKTt9LCdHZW9tZXRyeUNvbGxlY3Rpb24nOmZ1bmN0aW9uKGFycmF5KXt2YXIgZ2VvbWV0cmllcz1bXTtmb3IodmFyIGk9MDtpPGFycmF5Lmxlbmd0aDsrK2kpe3ZhciBnZW9tZXRyeT1hcnJheVtpXTtnZW9tZXRyaWVzLnB1c2godGhpcy5yZWFkKGdlb21ldHJ5KSk7fVxucmV0dXJuIHRoaXMuZ2VvbWV0cnlGYWN0b3J5LmNyZWF0ZUdlb21ldHJ5Q29sbGVjdGlvbihnZW9tZXRyaWVzKTt9fTtqc3RzLmlvLkdlb0pTT05QYXJzZXIucHJvdG90eXBlLndyaXRlPWZ1bmN0aW9uKGdlb21ldHJ5KXt2YXIgdHlwZT1nZW9tZXRyeS5DTEFTU19OQU1FLnNsaWNlKDEwKTtpZighdGhpcy5leHRyYWN0W3R5cGVdKXt0aHJvdyBuZXcgRXJyb3IoJ0dlb21ldHJ5IGlzIG5vdCBzdXBwb3J0ZWQnKTt9XG5yZXR1cm4gdGhpcy5leHRyYWN0W3R5cGVdLmFwcGx5KHRoaXMsW2dlb21ldHJ5XSk7fTtqc3RzLmlvLkdlb0pTT05QYXJzZXIucHJvdG90eXBlLmV4dHJhY3Q9eydjb29yZGluYXRlJzpmdW5jdGlvbihjb29yZGluYXRlKXtyZXR1cm5bY29vcmRpbmF0ZS54LGNvb3JkaW5hdGUueV07fSwnUG9pbnQnOmZ1bmN0aW9uKHBvaW50KXt2YXIgYXJyYXk9dGhpcy5leHRyYWN0LmNvb3JkaW5hdGUuYXBwbHkodGhpcyxbcG9pbnQuY29vcmRpbmF0ZV0pO3JldHVybnt0eXBlOidQb2ludCcsY29vcmRpbmF0ZXM6YXJyYXl9O30sJ011bHRpUG9pbnQnOmZ1bmN0aW9uKG11bHRpcG9pbnQpe3ZhciBhcnJheT1bXTtmb3IodmFyIGk9MDtpPG11bHRpcG9pbnQuZ2VvbWV0cmllcy5sZW5ndGg7KytpKXt2YXIgcG9pbnQ9bXVsdGlwb2ludC5nZW9tZXRyaWVzW2ldO3ZhciBnZW9Kc29uPXRoaXMuZXh0cmFjdC5Qb2ludC5hcHBseSh0aGlzLFtwb2ludF0pO2FycmF5LnB1c2goZ2VvSnNvbi5jb29yZGluYXRlcyk7fVxucmV0dXJue3R5cGU6J011bHRpUG9pbnQnLGNvb3JkaW5hdGVzOmFycmF5fTt9LCdMaW5lU3RyaW5nJzpmdW5jdGlvbihsaW5lc3RyaW5nKXt2YXIgYXJyYXk9W107Zm9yKHZhciBpPTA7aTxsaW5lc3RyaW5nLnBvaW50cy5sZW5ndGg7KytpKXt2YXIgY29vcmRpbmF0ZT1saW5lc3RyaW5nLnBvaW50c1tpXTthcnJheS5wdXNoKHRoaXMuZXh0cmFjdC5jb29yZGluYXRlLmFwcGx5KHRoaXMsW2Nvb3JkaW5hdGVdKSk7fVxucmV0dXJue3R5cGU6J0xpbmVTdHJpbmcnLGNvb3JkaW5hdGVzOmFycmF5fTt9LCdNdWx0aUxpbmVTdHJpbmcnOmZ1bmN0aW9uKG11bHRpbGluZXN0cmluZyl7dmFyIGFycmF5PVtdO2Zvcih2YXIgaT0wO2k8bXVsdGlsaW5lc3RyaW5nLmdlb21ldHJpZXMubGVuZ3RoOysraSl7dmFyIGxpbmVzdHJpbmc9bXVsdGlsaW5lc3RyaW5nLmdlb21ldHJpZXNbaV07dmFyIGdlb0pzb249dGhpcy5leHRyYWN0LkxpbmVTdHJpbmcuYXBwbHkodGhpcyxbbGluZXN0cmluZ10pO2FycmF5LnB1c2goZ2VvSnNvbi5jb29yZGluYXRlcyk7fVxucmV0dXJue3R5cGU6J011bHRpTGluZVN0cmluZycsY29vcmRpbmF0ZXM6YXJyYXl9O30sJ1BvbHlnb24nOmZ1bmN0aW9uKHBvbHlnb24pe3ZhciBhcnJheT1bXTt2YXIgc2hlbGxHZW9Kc29uPXRoaXMuZXh0cmFjdC5MaW5lU3RyaW5nLmFwcGx5KHRoaXMsW3BvbHlnb24uc2hlbGxdKTthcnJheS5wdXNoKHNoZWxsR2VvSnNvbi5jb29yZGluYXRlcyk7Zm9yKHZhciBpPTA7aTxwb2x5Z29uLmhvbGVzLmxlbmd0aDsrK2kpe3ZhciBob2xlPXBvbHlnb24uaG9sZXNbaV07dmFyIGhvbGVHZW9Kc29uPXRoaXMuZXh0cmFjdC5MaW5lU3RyaW5nLmFwcGx5KHRoaXMsW2hvbGVdKTthcnJheS5wdXNoKGhvbGVHZW9Kc29uLmNvb3JkaW5hdGVzKTt9XG5yZXR1cm57dHlwZTonUG9seWdvbicsY29vcmRpbmF0ZXM6YXJyYXl9O30sJ011bHRpUG9seWdvbic6ZnVuY3Rpb24obXVsdGlwb2x5Z29uKXt2YXIgYXJyYXk9W107Zm9yKHZhciBpPTA7aTxtdWx0aXBvbHlnb24uZ2VvbWV0cmllcy5sZW5ndGg7KytpKXt2YXIgcG9seWdvbj1tdWx0aXBvbHlnb24uZ2VvbWV0cmllc1tpXTt2YXIgZ2VvSnNvbj10aGlzLmV4dHJhY3QuUG9seWdvbi5hcHBseSh0aGlzLFtwb2x5Z29uXSk7YXJyYXkucHVzaChnZW9Kc29uLmNvb3JkaW5hdGVzKTt9XG5yZXR1cm57dHlwZTonTXVsdGlQb2x5Z29uJyxjb29yZGluYXRlczphcnJheX07fSwnR2VvbWV0cnlDb2xsZWN0aW9uJzpmdW5jdGlvbihjb2xsZWN0aW9uKXt2YXIgYXJyYXk9W107Zm9yKHZhciBpPTA7aTxjb2xsZWN0aW9uLmdlb21ldHJpZXMubGVuZ3RoOysraSl7dmFyIGdlb21ldHJ5PWNvbGxlY3Rpb24uZ2VvbWV0cmllc1tpXTt2YXIgdHlwZT1nZW9tZXRyeS5DTEFTU19OQU1FLnNsaWNlKDEwKTthcnJheS5wdXNoKHRoaXMuZXh0cmFjdFt0eXBlXS5hcHBseSh0aGlzLFtnZW9tZXRyeV0pKTt9XG5yZXR1cm57dHlwZTonR2VvbWV0cnlDb2xsZWN0aW9uJyxnZW9tZXRyaWVzOmFycmF5fTt9fTt9KSgpO2pzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuVmVydGV4PWZ1bmN0aW9uKCl7aWYoYXJndW1lbnRzLmxlbmd0aD09PTEpe3RoaXMuaW5pdEZyb21Db29yZGluYXRlKGFyZ3VtZW50c1swXSk7fWVsc2V7dGhpcy5pbml0RnJvbVhZKGFyZ3VtZW50c1swXSxhcmd1bWVudHNbMV0pO319O2pzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuVmVydGV4LkxFRlQ9MDtqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlZlcnRleC5SSUdIVD0xO2pzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuVmVydGV4LkJFWU9ORD0yO2pzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuVmVydGV4LkJFSElORD0zO2pzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuVmVydGV4LkJFVFdFRU49NDtqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlZlcnRleC5PUklHSU49NTtqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlZlcnRleC5ERVNUSU5BVElPTj02O2pzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuVmVydGV4LnByb3RvdHlwZS5pbml0RnJvbVhZPWZ1bmN0aW9uKHgseSl7dGhpcy5wPW5ldyBqc3RzLmdlb20uQ29vcmRpbmF0ZSh4LHkpO307anN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5WZXJ0ZXgucHJvdG90eXBlLmluaXRGcm9tQ29vcmRpbmF0ZT1mdW5jdGlvbihfcCl7dGhpcy5wPW5ldyBqc3RzLmdlb20uQ29vcmRpbmF0ZShfcCk7fTtqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlZlcnRleC5wcm90b3R5cGUuZ2V0WD1mdW5jdGlvbigpe3JldHVybiB0aGlzLnAueDt9O2pzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuVmVydGV4LnByb3RvdHlwZS5nZXRZPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMucC55O307anN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5WZXJ0ZXgucHJvdG90eXBlLmdldFo9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5wLno7fTtqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlZlcnRleC5wcm90b3R5cGUuc2V0Wj1mdW5jdGlvbih6KXt0aGlzLnAuej16O307anN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5WZXJ0ZXgucHJvdG90eXBlLmdldENvb3JkaW5hdGU9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5wO307anN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5WZXJ0ZXgucHJvdG90eXBlLnRvU3RyaW5nPWZ1bmN0aW9uKCl7cmV0dXJuJ1BPSU5UICgnK3RoaXMucC54KycgJyt0aGlzLnAueSsnKSc7fTtqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlZlcnRleC5wcm90b3R5cGUuZXF1YWxzPWZ1bmN0aW9uKCl7aWYoYXJndW1lbnRzLmxlbmd0aD09PTEpe3JldHVybiB0aGlzLmVxdWFsc0V4YWN0KGFyZ3VtZW50c1swXSk7fWVsc2V7cmV0dXJuIHRoaXMuZXF1YWxzV2l0aFRvbGVyYW5jZShhcmd1bWVudHNbMF0sYXJndW1lbnRzWzFdKTt9fTtqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlZlcnRleC5wcm90b3R5cGUuZXF1YWxzRXhhY3Q9ZnVuY3Rpb24ob3RoZXIpe3JldHVybih0aGlzLnAueD09PW90aGVyLmdldFgoKSYmdGhpcy5wLnk9PT1vdGhlci5nZXRZKCkpO307anN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5WZXJ0ZXgucHJvdG90eXBlLmVxdWFsc1dpdGhUb2xlcmFuY2U9ZnVuY3Rpb24ob3RoZXIsdG9sZXJhbmNlKXtyZXR1cm4odGhpcy5wLmRpc3RhbmNlKG90aGVyLmdldENvb3JkaW5hdGUoKSk8dG9sZXJhbmNlKTt9O2pzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuVmVydGV4LnByb3RvdHlwZS5jbGFzc2lmeT1mdW5jdGlvbihwMCxwMSl7dmFyIHAyLGEsYixzYTtwMj10aGlzO2E9cDEuc3ViKHAwKTtiPXAyLnN1YihwMCk7c2E9YS5jcm9zc1Byb2R1Y3QoYik7aWYoc2E+MC4wKXtyZXR1cm4ganN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5WZXJ0ZXguTEVGVDt9XG5pZihzYTwwLjApe3JldHVybiBqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlZlcnRleC5SSUdIVDt9XG5pZigoYS5nZXRYKCkqYi5nZXRYKCk8MC4wKXx8KGEuZ2V0WSgpKmIuZ2V0WSgpPDAuMCkpe3JldHVybiBqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlZlcnRleC5CRUhJTkQ7fVxuaWYoYS5tYWduKCk8Yi5tYWduKCkpe3JldHVybiBqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlZlcnRleC5CRVlPTkQ7fVxuaWYocDAuZXF1YWxzKHAyKSl7cmV0dXJuIGpzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuVmVydGV4Lk9SSUdJTjt9XG5pZihwMS5lcXVhbHMocDIpKXtyZXR1cm4ganN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5WZXJ0ZXguREVTVElOQVRJT047fVxucmV0dXJuIGpzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuVmVydGV4LkJFVFdFRU47fTtqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlZlcnRleC5wcm90b3R5cGUuY3Jvc3NQcm9kdWN0PWZ1bmN0aW9uKHYpe3JldHVybigodGhpcy5wLngqdi5nZXRZKCkpLSh0aGlzLnAueSp2LmdldFgoKSkpO307anN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5WZXJ0ZXgucHJvdG90eXBlLmRvdD1mdW5jdGlvbih2KXtyZXR1cm4oKHRoaXMucC54KnYuZ2V0WCgpKSsodGhpcy5wLnkqdi5nZXRZKCkpKTt9O2pzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuVmVydGV4LnByb3RvdHlwZS50aW1lcz1mdW5jdGlvbihjKXtyZXR1cm4gbmV3IGpzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuVmVydGV4KGMqdGhpcy5wLngsYyp0aGlzLnAueSk7fTtqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlZlcnRleC5wcm90b3R5cGUuc3VtPWZ1bmN0aW9uKHYpe3JldHVybiBuZXcganN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5WZXJ0ZXgodGhpcy5wLngrdi5nZXRYKCksdGhpcy5wLnkrXG52LmdldFkoKSk7fTtqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlZlcnRleC5wcm90b3R5cGUuc3ViPWZ1bmN0aW9uKHYpe3JldHVybiBuZXcganN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5WZXJ0ZXgodGhpcy5wLngtdi5nZXRYKCksdGhpcy5wLnktXG52LmdldFkoKSk7fTtqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlZlcnRleC5wcm90b3R5cGUubWFnbj1mdW5jdGlvbigpe3JldHVybihNYXRoLnNxcnQoKHRoaXMucC54KnRoaXMucC54KSsodGhpcy5wLnkqdGhpcy5wLnkpKSk7fTtqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlZlcnRleC5wcm90b3R5cGUuY3Jvc3M9ZnVuY3Rpb24oKXtyZXR1cm4gbmV3IFZlcnRleCh0aGlzLnAueSwtdGhpcy5wLngpO307anN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5WZXJ0ZXgucHJvdG90eXBlLmlzSW5DaXJjbGU9ZnVuY3Rpb24oYSxiLGMpe3JldHVybiBqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlRyaWFuZ2xlUHJlZGljYXRlLmlzSW5DaXJjbGVSb2J1c3QoYS5wLGIucCxjLnAsdGhpcy5wKTt9O2pzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuVmVydGV4LnByb3RvdHlwZS5pc0NDVz1mdW5jdGlvbihiLGMpe3JldHVybigoYi5wLngtdGhpcy5wLngpKihjLnAueS10aGlzLnAueSktKGIucC55LXRoaXMucC55KSooYy5wLngtdGhpcy5wLngpPjApO307anN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5WZXJ0ZXgucHJvdG90eXBlLnJpZ2h0T2Y9ZnVuY3Rpb24oZSl7cmV0dXJuIHRoaXMuaXNDQ1coZS5kZXN0KCksZS5vcmlnKCkpO307anN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5WZXJ0ZXgucHJvdG90eXBlLmxlZnRPZj1mdW5jdGlvbihlKXtyZXR1cm4gdGhpcy5pc0NDVyhlLm9yaWcoKSxlLmRlc3QoKSk7fTtqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlZlcnRleC5wcm90b3R5cGUuYmlzZWN0b3I9ZnVuY3Rpb24oYSxiKXt2YXIgZHgsZHksbDEsbDI7ZHg9Yi5nZXRYKCktYS5nZXRYKCk7ZHk9Yi5nZXRZKCktYS5nZXRZKCk7bDE9bmV3IGpzdHMuYWxnb3JpdGhtLkhDb29yZGluYXRlKGEuZ2V0WCgpKyhkeC8yLjApLGEuZ2V0WSgpK1xuKGR5LzIuMCksMS4wKTtsMj1uZXcganN0cy5hbGdvcml0aG0uSENvb3JkaW5hdGUoYS5nZXRYKCktZHkrKGR4LzIuMCksYS5nZXRZKCkrXG5keCsoZHkvMi4wKSwxLjApO3JldHVybiBuZXcganN0cy5hbGdvcml0aG0uSENvb3JkaW5hdGUobDEsbDIpO307anN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5WZXJ0ZXgucHJvdG90eXBlLmRpc3RhbmNlPWZ1bmN0aW9uKHYxLHYyKXtyZXR1cm4gdjEucC5kaXN0YW5jZSh2Mi5wKTt9O2pzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuVmVydGV4LnByb3RvdHlwZS5jaXJjdW1SYWRpdXNSYXRpbz1mdW5jdGlvbihiLGMpe3ZhciB4LHJhZGl1cyxlZGdlTGVuZ3RoLGVsO3g9dGhpcy5jaXJjbGVDZW50ZXIoYixjKTtyYWRpdXM9dGhpcy5kaXN0YW5jZSh4LGIpO2VkZ2VMZW5ndGg9dGhpcy5kaXN0YW5jZSh0aGlzLGIpO2VsPXRoaXMuZGlzdGFuY2UoYixjKTtpZihlbDxlZGdlTGVuZ3RoKXtlZGdlTGVuZ3RoPWVsO31cbmVsPXRoaXMuZGlzdGFuY2UoYyx0aGlzKTtpZihlbDxlZGdlTGVuZ3RoKXtlZGdlTGVuZ3RoPWVsO31cbnJldHVybiByYWRpdXMvZWRnZUxlbmd0aDt9O2pzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuVmVydGV4LnByb3RvdHlwZS5taWRQb2ludD1mdW5jdGlvbihhKXt2YXIgeG0seW07eG09KHRoaXMucC54K2EuZ2V0WCgpKS8yLjA7eW09KHRoaXMucC55K2EuZ2V0WSgpKS8yLjA7cmV0dXJuIG5ldyBqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlZlcnRleCh4bSx5bSk7fTtqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlZlcnRleC5wcm90b3R5cGUuY2lyY2xlQ2VudGVyPWZ1bmN0aW9uKGIsYyl7dmFyIGEsY2FiLGNiYyxoY2MsY2M7YT1uZXcganN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5WZXJ0ZXgodGhpcy5nZXRYKCksdGhpcy5nZXRZKCkpO2NhYj10aGlzLmJpc2VjdG9yKGEsYik7Y2JjPXRoaXMuYmlzZWN0b3IoYixjKTtoY2M9bmV3IGpzdHMuYWxnb3JpdGhtLkhDb29yZGluYXRlKGNhYixjYmMpO2NjPW51bGw7dHJ5e2NjPW5ldyBqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlZlcnRleChoY2MuZ2V0WCgpLGhjYy5nZXRZKCkpO31jYXRjaChlcnIpe31cbnJldHVybiBjYzt9O2pzdHMub3BlcmF0aW9uLnZhbGlkLklzVmFsaWRPcD1mdW5jdGlvbihwYXJlbnRHZW9tZXRyeSl7dGhpcy5wYXJlbnRHZW9tZXRyeT1wYXJlbnRHZW9tZXRyeTt0aGlzLmlzU2VsZlRvdWNoaW5nUmluZ0Zvcm1pbmdIb2xlVmFsaWQ9ZmFsc2U7dGhpcy52YWxpZEVycj1udWxsO307anN0cy5vcGVyYXRpb24udmFsaWQuSXNWYWxpZE9wLmlzVmFsaWQ9ZnVuY3Rpb24oYXJnKXtpZihhcmd1bWVudHNbMF1pbnN0YW5jZW9mIGpzdHMuZ2VvbS5Db29yZGluYXRlKXtpZihpc05hTihhcmcueCkpe3JldHVybiBmYWxzZTt9XG5pZighaXNGaW5pdGUoYXJnLngpJiYhaXNOYU4oYXJnLngpKXtyZXR1cm4gZmFsc2U7fVxuaWYoaXNOYU4oYXJnLnkpKXtyZXR1cm4gZmFsc2U7fVxuaWYoIWlzRmluaXRlKGFyZy55KSYmIWlzTmFOKGFyZy55KSl7cmV0dXJuIGZhbHNlO31cbnJldHVybiB0cnVlO31lbHNle3ZhciBpc1ZhbGlkT3A9bmV3IGpzdHMub3BlcmF0aW9uLnZhbGlkLklzVmFsaWRPcChhcmcpO3JldHVybiBpc1ZhbGlkT3AuaXNWYWxpZCgpO319O2pzdHMub3BlcmF0aW9uLnZhbGlkLklzVmFsaWRPcC5maW5kUHROb3ROb2RlPWZ1bmN0aW9uKHRlc3RDb29yZHMsc2VhcmNoUmluZyxncmFwaCl7dmFyIHNlYXJjaEVkZ2U9Z3JhcGguZmluZEVkZ2Uoc2VhcmNoUmluZyk7dmFyIGVpTGlzdD1zZWFyY2hFZGdlLmdldEVkZ2VJbnRlcnNlY3Rpb25MaXN0KCk7Zm9yKHZhciBpPTA7aTx0ZXN0Q29vcmRzLmxlbmd0aDtpKyspe3ZhciBwdD10ZXN0Q29vcmRzW2ldO2lmKCFlaUxpc3QuaXNJbnRlcnNlY3Rpb24ocHQpKXtyZXR1cm4gcHQ7fX1cbnJldHVybiBudWxsO307anN0cy5vcGVyYXRpb24udmFsaWQuSXNWYWxpZE9wLnByb3RvdHlwZS5zZXRTZWxmVG91Y2hpbmdSaW5nRm9ybWluZ0hvbGVWYWxpZD1mdW5jdGlvbihpc1ZhbGlkKXt0aGlzLmlzU2VsZlRvdWNoaW5nUmluZ0Zvcm1pbmdIb2xlVmFsaWQ9aXNWYWxpZDt9O2pzdHMub3BlcmF0aW9uLnZhbGlkLklzVmFsaWRPcC5wcm90b3R5cGUuaXNWYWxpZD1mdW5jdGlvbigpe3RoaXMuY2hlY2tWYWxpZCh0aGlzLnBhcmVudEdlb21ldHJ5KTtyZXR1cm4gdGhpcy52YWxpZEVycj09bnVsbDt9O2pzdHMub3BlcmF0aW9uLnZhbGlkLklzVmFsaWRPcC5wcm90b3R5cGUuZ2V0VmFsaWRhdGlvbkVycm9yPWZ1bmN0aW9uKCl7dGhpcy5jaGVja1ZhbGlkKHRoaXMucGFyZW50R2VvbWV0cnkpO3JldHVybiB0aGlzLnZhbGlkRXJyO307anN0cy5vcGVyYXRpb24udmFsaWQuSXNWYWxpZE9wLnByb3RvdHlwZS5jaGVja1ZhbGlkPWZ1bmN0aW9uKGcpe3RoaXMudmFsaWRFcnI9bnVsbDtpZihnLmlzRW1wdHkoKSl7cmV0dXJuO31cbmlmKGcgaW5zdGFuY2VvZiBqc3RzLmdlb20uUG9pbnQpe3RoaXMuY2hlY2tWYWxpZFBvaW50KGcpO31lbHNlIGlmKGcgaW5zdGFuY2VvZiBqc3RzLmdlb20uTXVsdGlQb2ludCl7dGhpcy5jaGVja1ZhbGlkTXVsdGlQb2ludChnKTt9ZWxzZSBpZihnIGluc3RhbmNlb2YganN0cy5nZW9tLkxpbmVhclJpbmcpe3RoaXMuY2hlY2tWYWxpZExpbmVhclJpbmcoZyk7fWVsc2UgaWYoZyBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5MaW5lU3RyaW5nKXt0aGlzLmNoZWNrVmFsaWRMaW5lU3RyaW5nKGcpO31lbHNlIGlmKGcgaW5zdGFuY2VvZiBqc3RzLmdlb20uUG9seWdvbil7dGhpcy5jaGVja1ZhbGlkUG9seWdvbihnKTt9ZWxzZSBpZihnIGluc3RhbmNlb2YganN0cy5nZW9tLk11bHRpUG9seWdvbil7dGhpcy5jaGVja1ZhbGlkTXVsdGlQb2x5Z29uKGcpO31lbHNlIGlmKGcgaW5zdGFuY2VvZiBqc3RzLmdlb20uR2VvbWV0cnlDb2xsZWN0aW9uKXt0aGlzLmNoZWNrVmFsaWRHZW9tZXRyeUNvbGxlY3Rpb24oZyk7fWVsc2V7dGhyb3cgZy5jb25zdHJ1Y3Rvcjt9fTtqc3RzLm9wZXJhdGlvbi52YWxpZC5Jc1ZhbGlkT3AucHJvdG90eXBlLmNoZWNrVmFsaWRQb2ludD1mdW5jdGlvbihnKXt0aGlzLmNoZWNrSW52YWxpZENvb3JkaW5hdGVzKGcuZ2V0Q29vcmRpbmF0ZXMoKSk7fTtqc3RzLm9wZXJhdGlvbi52YWxpZC5Jc1ZhbGlkT3AucHJvdG90eXBlLmNoZWNrVmFsaWRNdWx0aVBvaW50PWZ1bmN0aW9uKGcpe3RoaXMuY2hlY2tJbnZhbGlkQ29vcmRpbmF0ZXMoZy5nZXRDb29yZGluYXRlcygpKTt9O2pzdHMub3BlcmF0aW9uLnZhbGlkLklzVmFsaWRPcC5wcm90b3R5cGUuY2hlY2tWYWxpZExpbmVTdHJpbmc9ZnVuY3Rpb24oZyl7dGhpcy5jaGVja0ludmFsaWRDb29yZGluYXRlcyhnLmdldENvb3JkaW5hdGVzKCkpO2lmKHRoaXMudmFsaWRFcnIhPW51bGwpe3JldHVybjt9XG52YXIgZ3JhcGg9bmV3IGpzdHMuZ2VvbWdyYXBoLkdlb21ldHJ5R3JhcGgoMCxnKTt0aGlzLmNoZWNrVG9vRmV3UG9pbnRzKGdyYXBoKTt9O2pzdHMub3BlcmF0aW9uLnZhbGlkLklzVmFsaWRPcC5wcm90b3R5cGUuY2hlY2tWYWxpZExpbmVhclJpbmc9ZnVuY3Rpb24oZyl7dGhpcy5jaGVja0ludmFsaWRDb29yZGluYXRlcyhnLmdldENvb3JkaW5hdGVzKCkpO2lmKHRoaXMudmFsaWRFcnIhPW51bGwpe3JldHVybjt9XG50aGlzLmNoZWNrQ2xvc2VkUmluZyhnKTtpZih0aGlzLnZhbGlkRXJyIT1udWxsKXtyZXR1cm47fVxudmFyIGdyYXBoPW5ldyBqc3RzLmdlb21ncmFwaC5HZW9tZXRyeUdyYXBoKDAsZyk7dGhpcy5jaGVja1Rvb0Zld1BvaW50cyhncmFwaCk7aWYodGhpcy52YWxpZEVyciE9bnVsbCl7cmV0dXJuO31cbnZhciBsaT1uZXcganN0cy5hbGdvcml0aG0uUm9idXN0TGluZUludGVyc2VjdG9yKCk7Z3JhcGguY29tcHV0ZVNlbGZOb2RlcyhsaSx0cnVlKTt0aGlzLmNoZWNrTm9TZWxmSW50ZXJzZWN0aW5nUmluZ3MoZ3JhcGgpO307anN0cy5vcGVyYXRpb24udmFsaWQuSXNWYWxpZE9wLnByb3RvdHlwZS5jaGVja1ZhbGlkUG9seWdvbj1mdW5jdGlvbihnKXt0aGlzLmNoZWNrSW52YWxpZENvb3JkaW5hdGVzKGcpO2lmKHRoaXMudmFsaWRFcnIhPW51bGwpe3JldHVybjt9XG50aGlzLmNoZWNrQ2xvc2VkUmluZ3MoZyk7aWYodGhpcy52YWxpZEVyciE9bnVsbCl7cmV0dXJuO31cbnZhciBncmFwaD1uZXcganN0cy5nZW9tZ3JhcGguR2VvbWV0cnlHcmFwaCgwLGcpO3RoaXMuY2hlY2tUb29GZXdQb2ludHMoZ3JhcGgpO2lmKHRoaXMudmFsaWRFcnIhPW51bGwpe3JldHVybjt9XG50aGlzLmNoZWNrQ29uc2lzdGVudEFyZWEoZ3JhcGgpO2lmKHRoaXMudmFsaWRFcnIhPW51bGwpe3JldHVybjt9XG5pZighdGhpcy5pc1NlbGZUb3VjaGluZ1JpbmdGb3JtaW5nSG9sZVZhbGlkKXt0aGlzLmNoZWNrTm9TZWxmSW50ZXJzZWN0aW5nUmluZ3MoZ3JhcGgpO2lmKHRoaXMudmFsaWRFcnIhPW51bGwpe3JldHVybjt9fVxudGhpcy5jaGVja0hvbGVzSW5TaGVsbChnLGdyYXBoKTtpZih0aGlzLnZhbGlkRXJyIT1udWxsKXtyZXR1cm47fVxudGhpcy5jaGVja0hvbGVzTm90TmVzdGVkKGcsZ3JhcGgpO2lmKHRoaXMudmFsaWRFcnIhPW51bGwpe3JldHVybjt9XG50aGlzLmNoZWNrQ29ubmVjdGVkSW50ZXJpb3JzKGdyYXBoKTt9O2pzdHMub3BlcmF0aW9uLnZhbGlkLklzVmFsaWRPcC5wcm90b3R5cGUuY2hlY2tWYWxpZE11bHRpUG9seWdvbj1mdW5jdGlvbihnKXt2YXIgaWw9Zy5nZXROdW1HZW9tZXRyaWVzKCk7Zm9yKHZhciBpPTA7aTxpbDtpKyspe3ZhciBwPWcuZ2V0R2VvbWV0cnlOKGkpO3RoaXMuY2hlY2tJbnZhbGlkQ29vcmRpbmF0ZXMocCk7aWYodGhpcy52YWxpZEVyciE9bnVsbCl7cmV0dXJuO31cbnRoaXMuY2hlY2tDbG9zZWRSaW5ncyhwKTtpZih0aGlzLnZhbGlkRXJyIT1udWxsKXtyZXR1cm47fX1cbnZhciBncmFwaD1uZXcganN0cy5nZW9tZ3JhcGguR2VvbWV0cnlHcmFwaCgwLGcpO3RoaXMuY2hlY2tUb29GZXdQb2ludHMoZ3JhcGgpO2lmKHRoaXMudmFsaWRFcnIhPW51bGwpe3JldHVybjt9XG50aGlzLmNoZWNrQ29uc2lzdGVudEFyZWEoZ3JhcGgpO2lmKHRoaXMudmFsaWRFcnIhPW51bGwpe3JldHVybjt9XG5pZighdGhpcy5pc1NlbGZUb3VjaGluZ1JpbmdGb3JtaW5nSG9sZVZhbGlkKXt0aGlzLmNoZWNrTm9TZWxmSW50ZXJzZWN0aW5nUmluZ3MoZ3JhcGgpO2lmKHRoaXMudmFsaWRFcnIhPW51bGwpe3JldHVybjt9fVxuZm9yKHZhciBpPTA7aTxnLmdldE51bUdlb21ldHJpZXMoKTtpKyspe3ZhciBwPWcuZ2V0R2VvbWV0cnlOKGkpO3RoaXMuY2hlY2tIb2xlc0luU2hlbGwocCxncmFwaCk7aWYodGhpcy52YWxpZEVyciE9bnVsbCl7cmV0dXJuO319XG5mb3IodmFyIGk9MDtpPGcuZ2V0TnVtR2VvbWV0cmllcygpO2krKyl7dmFyIHA9Zy5nZXRHZW9tZXRyeU4oaSk7dGhpcy5jaGVja0hvbGVzTm90TmVzdGVkKHAsZ3JhcGgpO2lmKHRoaXMudmFsaWRFcnIhPW51bGwpe3JldHVybjt9fVxudGhpcy5jaGVja1NoZWxsc05vdE5lc3RlZChnLGdyYXBoKTtpZih0aGlzLnZhbGlkRXJyIT1udWxsKXtyZXR1cm47fVxudGhpcy5jaGVja0Nvbm5lY3RlZEludGVyaW9ycyhncmFwaCk7fTtqc3RzLm9wZXJhdGlvbi52YWxpZC5Jc1ZhbGlkT3AucHJvdG90eXBlLmNoZWNrVmFsaWRHZW9tZXRyeUNvbGxlY3Rpb249ZnVuY3Rpb24oZ2Mpe2Zvcih2YXIgaT0wO2k8Z2MuZ2V0TnVtR2VvbWV0cmllcygpO2krKyl7dmFyIGc9Z2MuZ2V0R2VvbWV0cnlOKGkpO3RoaXMuY2hlY2tWYWxpZChnKTtpZih0aGlzLnZhbGlkRXJyIT1udWxsKXtyZXR1cm47fX19O2pzdHMub3BlcmF0aW9uLnZhbGlkLklzVmFsaWRPcC5wcm90b3R5cGUuY2hlY2tJbnZhbGlkQ29vcmRpbmF0ZXM9ZnVuY3Rpb24oYXJnKXtpZihhcmcgaW5zdGFuY2VvZiBqc3RzLmdlb20uUG9seWdvbil7dmFyIHBvbHk9YXJnO3RoaXMuY2hlY2tJbnZhbGlkQ29vcmRpbmF0ZXMocG9seS5nZXRFeHRlcmlvclJpbmcoKS5nZXRDb29yZGluYXRlcygpKTtpZih0aGlzLnZhbGlkRXJyIT1udWxsKXtyZXR1cm47fVxuZm9yKHZhciBpPTA7aTxwb2x5LmdldE51bUludGVyaW9yUmluZygpO2krKyl7dGhpcy5jaGVja0ludmFsaWRDb29yZGluYXRlcyhwb2x5LmdldEludGVyaW9yUmluZ04oaSkuZ2V0Q29vcmRpbmF0ZXMoKSk7aWYodGhpcy52YWxpZEVyciE9bnVsbCl7cmV0dXJuO319fWVsc2V7dmFyIGNvb3Jkcz1hcmc7Zm9yKHZhciBpPTA7aTxjb29yZHMubGVuZ3RoO2krKyl7aWYoIWpzdHMub3BlcmF0aW9uLnZhbGlkLklzVmFsaWRPcC5pc1ZhbGlkKGNvb3Jkc1tpXSkpe3RoaXMudmFsaWRFcnI9bmV3IGpzdHMub3BlcmF0aW9uLnZhbGlkLlRvcG9sb2d5VmFsaWRhdGlvbkVycm9yKGpzdHMub3BlcmF0aW9uLnZhbGlkLlRvcG9sb2d5VmFsaWRhdGlvbkVycm9yLklOVkFMSURfQ09PUkRJTkFURSxjb29yZHNbaV0pO3JldHVybjt9fX19O2pzdHMub3BlcmF0aW9uLnZhbGlkLklzVmFsaWRPcC5wcm90b3R5cGUuY2hlY2tDbG9zZWRSaW5ncz1mdW5jdGlvbihwb2x5KXt0aGlzLmNoZWNrQ2xvc2VkUmluZyhwb2x5LmdldEV4dGVyaW9yUmluZygpKTtpZih0aGlzLnZhbGlkRXJyIT1udWxsKXtyZXR1cm47fVxuZm9yKHZhciBpPTA7aTxwb2x5LmdldE51bUludGVyaW9yUmluZygpO2krKyl7dGhpcy5jaGVja0Nsb3NlZFJpbmcocG9seS5nZXRJbnRlcmlvclJpbmdOKGkpKTtpZih0aGlzLnZhbGlkRXJyIT1udWxsKXtyZXR1cm47fX19O2pzdHMub3BlcmF0aW9uLnZhbGlkLklzVmFsaWRPcC5wcm90b3R5cGUuY2hlY2tDbG9zZWRSaW5nPWZ1bmN0aW9uKHJpbmcpe2lmKCFyaW5nLmlzQ2xvc2VkKCkpe3ZhciBwdD1udWxsO2lmKHJpbmcuZ2V0TnVtUG9pbnRzKCk+PTEpe3B0PXJpbmcuZ2V0Q29vcmRpbmF0ZU4oMCk7fVxudGhpcy52YWxpZEVycj1uZXcganN0cy5vcGVyYXRpb24udmFsaWQuVG9wb2xvZ3lWYWxpZGF0aW9uRXJyb3IoanN0cy5vcGVyYXRpb24udmFsaWQuVG9wb2xvZ3lWYWxpZGF0aW9uRXJyb3IuUklOR19OT1RfQ0xPU0VELHB0KTt9fTtqc3RzLm9wZXJhdGlvbi52YWxpZC5Jc1ZhbGlkT3AucHJvdG90eXBlLmNoZWNrVG9vRmV3UG9pbnRzPWZ1bmN0aW9uKGdyYXBoKXtpZihncmFwaC5oYXNUb29GZXdQb2ludHMpe3RoaXMudmFsaWRFcnI9bmV3IGpzdHMub3BlcmF0aW9uLnZhbGlkLlRvcG9sb2d5VmFsaWRhdGlvbkVycm9yKGpzdHMub3BlcmF0aW9uLnZhbGlkLlRvcG9sb2d5VmFsaWRhdGlvbkVycm9yLlRPT19GRVdfUE9JTlRTLGdyYXBoLmdldEludmFsaWRQb2ludCgpKTtyZXR1cm47fX07anN0cy5vcGVyYXRpb24udmFsaWQuSXNWYWxpZE9wLnByb3RvdHlwZS5jaGVja0NvbnNpc3RlbnRBcmVhPWZ1bmN0aW9uKGdyYXBoKXt2YXIgY2F0PW5ldyBqc3RzLm9wZXJhdGlvbi52YWxpZC5Db25zaXN0ZW50QXJlYVRlc3RlcihncmFwaCk7dmFyIGlzVmFsaWRBcmVhPWNhdC5pc05vZGVDb25zaXN0ZW50QXJlYSgpO2lmKCFpc1ZhbGlkQXJlYSl7dGhpcy52YWxpZEVycj1uZXcganN0cy5vcGVyYXRpb24udmFsaWQuVG9wb2xvZ3lWYWxpZGF0aW9uRXJyb3IoanN0cy5vcGVyYXRpb24udmFsaWQuVG9wb2xvZ3lWYWxpZGF0aW9uRXJyb3IuU0VMRl9JTlRFUlNFQ1RJT04sY2F0LmdldEludmFsaWRQb2ludCgpKTtyZXR1cm47fVxuaWYoY2F0Lmhhc0R1cGxpY2F0ZVJpbmdzKCkpe3RoaXMudmFsaWRFcnI9bmV3IGpzdHMub3BlcmF0aW9uLnZhbGlkLlRvcG9sb2d5VmFsaWRhdGlvbkVycm9yKGpzdHMub3BlcmF0aW9uLnZhbGlkLlRvcG9sb2d5VmFsaWRhdGlvbkVycm9yLkRVUExJQ0FURV9SSU5HUyxjYXQuZ2V0SW52YWxpZFBvaW50KCkpO319O2pzdHMub3BlcmF0aW9uLnZhbGlkLklzVmFsaWRPcC5wcm90b3R5cGUuY2hlY2tOb1NlbGZJbnRlcnNlY3RpbmdSaW5ncz1mdW5jdGlvbihncmFwaCl7Zm9yKHZhciBpPWdyYXBoLmdldEVkZ2VJdGVyYXRvcigpO2kuaGFzTmV4dCgpOyl7dmFyIGU9aS5uZXh0KCk7dGhpcy5jaGVja05vU2VsZkludGVyc2VjdGluZ1JpbmcoZS5nZXRFZGdlSW50ZXJzZWN0aW9uTGlzdCgpKTtpZih0aGlzLnZhbGlkRXJyIT1udWxsKXtyZXR1cm47fX19O2pzdHMub3BlcmF0aW9uLnZhbGlkLklzVmFsaWRPcC5wcm90b3R5cGUuY2hlY2tOb1NlbGZJbnRlcnNlY3RpbmdSaW5nPWZ1bmN0aW9uKGVpTGlzdCl7dmFyIG5vZGVTZXQ9W107dmFyIGlzRmlyc3Q9dHJ1ZTtmb3IodmFyIGk9ZWlMaXN0Lml0ZXJhdG9yKCk7aS5oYXNOZXh0KCk7KXt2YXIgZWk9aS5uZXh0KCk7aWYoaXNGaXJzdCl7aXNGaXJzdD1mYWxzZTtjb250aW51ZTt9XG5pZihub2RlU2V0LmluZGV4T2YoZWkuY29vcmQpPj0wKXt0aGlzLnZhbGlkRXJyPW5ldyBqc3RzLm9wZXJhdGlvbi52YWxpZC5Ub3BvbG9neVZhbGlkYXRpb25FcnJvcihqc3RzLm9wZXJhdGlvbi52YWxpZC5Ub3BvbG9neVZhbGlkYXRpb25FcnJvci5SSU5HX1NFTEZfSU5URVJTRUNUSU9OLGVpLmNvb3JkKTtyZXR1cm47fWVsc2V7bm9kZVNldC5wdXNoKGVpLmNvb3JkKTt9fX07anN0cy5vcGVyYXRpb24udmFsaWQuSXNWYWxpZE9wLnByb3RvdHlwZS5jaGVja0hvbGVzSW5TaGVsbD1mdW5jdGlvbihwLGdyYXBoKXt2YXIgc2hlbGw9cC5nZXRFeHRlcmlvclJpbmcoKTt2YXIgcGlyPW5ldyBqc3RzLmFsZ29yaXRobS5NQ1BvaW50SW5SaW5nKHNoZWxsKTtmb3IodmFyIGk9MDtpPHAuZ2V0TnVtSW50ZXJpb3JSaW5nKCk7aSsrKXt2YXIgaG9sZT1wLmdldEludGVyaW9yUmluZ04oaSk7dmFyIGhvbGVQdD1qc3RzLm9wZXJhdGlvbi52YWxpZC5Jc1ZhbGlkT3AuZmluZFB0Tm90Tm9kZShob2xlLmdldENvb3JkaW5hdGVzKCksc2hlbGwsZ3JhcGgpO2lmKGhvbGVQdD09bnVsbCl7cmV0dXJuO31cbnZhciBvdXRzaWRlPSFwaXIuaXNJbnNpZGUoaG9sZVB0KTtpZihvdXRzaWRlKXt0aGlzLnZhbGlkRXJyPW5ldyBqc3RzLm9wZXJhdGlvbi52YWxpZC5Ub3BvbG9neVZhbGlkYXRpb25FcnJvcihqc3RzLm9wZXJhdGlvbi52YWxpZC5Ub3BvbG9neVZhbGlkYXRpb25FcnJvci5IT0xFX09VVFNJREVfU0hFTEwsaG9sZVB0KTtyZXR1cm47fX19O2pzdHMub3BlcmF0aW9uLnZhbGlkLklzVmFsaWRPcC5wcm90b3R5cGUuY2hlY2tIb2xlc05vdE5lc3RlZD1mdW5jdGlvbihwLGdyYXBoKXt2YXIgbmVzdGVkVGVzdGVyPW5ldyBqc3RzLm9wZXJhdGlvbi52YWxpZC5JbmRleGVkTmVzdGVkUmluZ1Rlc3RlcihncmFwaCk7Zm9yKHZhciBpPTA7aTxwLmdldE51bUludGVyaW9yUmluZygpO2krKyl7dmFyIGlubmVySG9sZT1wLmdldEludGVyaW9yUmluZ04oaSk7bmVzdGVkVGVzdGVyLmFkZChpbm5lckhvbGUpO31cbnZhciBpc05vbk5lc3RlZD1uZXN0ZWRUZXN0ZXIuaXNOb25OZXN0ZWQoKTtpZighaXNOb25OZXN0ZWQpe3RoaXMudmFsaWRFcnI9bmV3IGpzdHMub3BlcmF0aW9uLnZhbGlkLlRvcG9sb2d5VmFsaWRhdGlvbkVycm9yKGpzdHMub3BlcmF0aW9uLnZhbGlkLlRvcG9sb2d5VmFsaWRhdGlvbkVycm9yLk5FU1RFRF9IT0xFUyxuZXN0ZWRUZXN0ZXIuZ2V0TmVzdGVkUG9pbnQoKSk7fX07anN0cy5vcGVyYXRpb24udmFsaWQuSXNWYWxpZE9wLnByb3RvdHlwZS5jaGVja1NoZWxsc05vdE5lc3RlZD1mdW5jdGlvbihtcCxncmFwaCl7Zm9yKHZhciBpPTA7aTxtcC5nZXROdW1HZW9tZXRyaWVzKCk7aSsrKXt2YXIgcD1tcC5nZXRHZW9tZXRyeU4oaSk7dmFyIHNoZWxsPXAuZ2V0RXh0ZXJpb3JSaW5nKCk7Zm9yKHZhciBqPTA7ajxtcC5nZXROdW1HZW9tZXRyaWVzKCk7aisrKXtpZihpPT1qKXtjb250aW51ZTt9XG52YXIgcDI9bXAuZ2V0R2VvbWV0cnlOKGopO3RoaXMuY2hlY2tTaGVsbE5vdE5lc3RlZChzaGVsbCxwMixncmFwaCk7aWYodGhpcy52YWxpZEVyciE9bnVsbCl7cmV0dXJuO319fX07anN0cy5vcGVyYXRpb24udmFsaWQuSXNWYWxpZE9wLnByb3RvdHlwZS5jaGVja1NoZWxsTm90TmVzdGVkPWZ1bmN0aW9uKHNoZWxsLHAsZ3JhcGgpe3ZhciBzaGVsbFB0cz1zaGVsbC5nZXRDb29yZGluYXRlcygpO3ZhciBwb2x5U2hlbGw9cC5nZXRFeHRlcmlvclJpbmcoKTt2YXIgcG9seVB0cz1wb2x5U2hlbGwuZ2V0Q29vcmRpbmF0ZXMoKTt2YXIgc2hlbGxQdD1qc3RzLm9wZXJhdGlvbi52YWxpZC5Jc1ZhbGlkT3AuZmluZFB0Tm90Tm9kZShzaGVsbFB0cyxwb2x5U2hlbGwsZ3JhcGgpO2lmKHNoZWxsUHQ9PW51bGwpe3JldHVybjt9XG52YXIgaW5zaWRlUG9seVNoZWxsPWpzdHMuYWxnb3JpdGhtLkNHQWxnb3JpdGhtcy5pc1BvaW50SW5SaW5nKHNoZWxsUHQscG9seVB0cyk7aWYoIWluc2lkZVBvbHlTaGVsbCl7cmV0dXJuO31cbmlmKHAuZ2V0TnVtSW50ZXJpb3JSaW5nKCk8PTApe3RoaXMudmFsaWRFcnI9bmV3IGpzdHMub3BlcmF0aW9uLnZhbGlkLlRvcG9sb2d5VmFsaWRhdGlvbkVycm9yKGpzdHMub3BlcmF0aW9uLnZhbGlkLlRvcG9sb2d5VmFsaWRhdGlvbkVycm9yLk5FU1RFRF9TSEVMTFMsc2hlbGxQdCk7cmV0dXJuO31cbnZhciBiYWROZXN0ZWRQdD1udWxsO2Zvcih2YXIgaT0wO2k8cC5nZXROdW1JbnRlcmlvclJpbmcoKTtpKyspe3ZhciBob2xlPXAuZ2V0SW50ZXJpb3JSaW5nTihpKTtiYWROZXN0ZWRQdD10aGlzLmNoZWNrU2hlbGxJbnNpZGVIb2xlKHNoZWxsLGhvbGUsZ3JhcGgpO2lmKGJhZE5lc3RlZFB0PT1udWxsKXtyZXR1cm47fX1cbnRoaXMudmFsaWRFcnI9bmV3IGpzdHMub3BlcmF0aW9uLnZhbGlkLlRvcG9sb2d5VmFsaWRhdGlvbkVycm9yKGpzdHMub3BlcmF0aW9uLnZhbGlkLlRvcG9sb2d5VmFsaWRhdGlvbkVycm9yLk5FU1RFRF9TSEVMTFMsYmFkTmVzdGVkUHQpO307anN0cy5vcGVyYXRpb24udmFsaWQuSXNWYWxpZE9wLnByb3RvdHlwZS5jaGVja1NoZWxsSW5zaWRlSG9sZT1mdW5jdGlvbihzaGVsbCxob2xlLGdyYXBoKXt2YXIgc2hlbGxQdHM9c2hlbGwuZ2V0Q29vcmRpbmF0ZXMoKTt2YXIgaG9sZVB0cz1ob2xlLmdldENvb3JkaW5hdGVzKCk7dmFyIHNoZWxsUHQ9anN0cy5vcGVyYXRpb24udmFsaWQuSXNWYWxpZE9wLmZpbmRQdE5vdE5vZGUoc2hlbGxQdHMsaG9sZSxncmFwaCk7aWYoc2hlbGxQdCE9bnVsbCl7dmFyIGluc2lkZUhvbGU9anN0cy5hbGdvcml0aG0uQ0dBbGdvcml0aG1zLmlzUG9pbnRJblJpbmcoc2hlbGxQdCxob2xlUHRzKTtpZighaW5zaWRlSG9sZSl7cmV0dXJuIHNoZWxsUHQ7fX1cbnZhciBob2xlUHQ9anN0cy5vcGVyYXRpb24udmFsaWQuSXNWYWxpZE9wLmZpbmRQdE5vdE5vZGUoaG9sZVB0cyxzaGVsbCxncmFwaCk7aWYoaG9sZVB0IT1udWxsKXt2YXIgaW5zaWRlU2hlbGw9anN0cy5hbGdvcml0aG0uQ0dBbGdvcml0aG1zLmlzUG9pbnRJblJpbmcoaG9sZVB0LHNoZWxsUHRzKTtpZihpbnNpZGVTaGVsbCl7cmV0dXJuIGhvbGVQdDt9XG5yZXR1cm4gbnVsbDt9XG5qc3RzLnV0aWwuQXNzZXJ0LnNob3VsZE5ldmVyUmVhY2hIZXJlKCdwb2ludHMgaW4gc2hlbGwgYW5kIGhvbGUgYXBwZWFyIHRvIGJlIGVxdWFsJyk7cmV0dXJuIG51bGw7fTtqc3RzLm9wZXJhdGlvbi52YWxpZC5Jc1ZhbGlkT3AucHJvdG90eXBlLmNoZWNrQ29ubmVjdGVkSW50ZXJpb3JzPWZ1bmN0aW9uKGdyYXBoKXt2YXIgY2l0PW5ldyBqc3RzLm9wZXJhdGlvbi52YWxpZC5Db25uZWN0ZWRJbnRlcmlvclRlc3RlcihncmFwaCk7aWYoIWNpdC5pc0ludGVyaW9yc0Nvbm5lY3RlZCgpKXt0aGlzLnZhbGlkRXJyPW5ldyBqc3RzLm9wZXJhdGlvbi52YWxpZC5Ub3BvbG9neVZhbGlkYXRpb25FcnJvcihqc3RzLm9wZXJhdGlvbi52YWxpZC5Ub3BvbG9neVZhbGlkYXRpb25FcnJvci5ESVNDT05ORUNURURfSU5URVJJT1IsY2l0LmdldENvb3JkaW5hdGUoKSk7fX07anN0cy5hbGdvcml0aG0uUm9idXN0RGV0ZXJtaW5hbnQ9ZnVuY3Rpb24oKXt9O2pzdHMuYWxnb3JpdGhtLlJvYnVzdERldGVybWluYW50LnNpZ25PZkRldDJ4Mj1mdW5jdGlvbih4MSx5MSx4Mix5Mil7dmFyIHNpZ24sc3dhcCxrLGNvdW50O2NvdW50PTA7c2lnbj0xO2lmKCh4MT09PTAuMCl8fCh5Mj09PTAuMCkpe2lmKCh5MT09PTAuMCl8fCh4Mj09PTAuMCkpe3JldHVybiAwO31cbmVsc2UgaWYoeTE+MCl7aWYoeDI+MCl7cmV0dXJuLXNpZ247fVxuZWxzZXtyZXR1cm4gc2lnbjt9fVxuZWxzZXtpZih4Mj4wKXtyZXR1cm4gc2lnbjt9XG5lbHNle3JldHVybi1zaWduO319fVxuaWYoKHkxPT09MC4wKXx8KHgyPT09MC4wKSl7aWYoeTI+MCl7aWYoeDE+MCl7cmV0dXJuIHNpZ247fVxuZWxzZXtyZXR1cm4tc2lnbjt9fVxuZWxzZXtpZih4MT4wKXtyZXR1cm4tc2lnbjt9XG5lbHNle3JldHVybiBzaWduO319fVxuaWYoMC4wPHkxKXtpZigwLjA8eTIpe2lmKHkxPnkyKXtzaWduPS1zaWduO3N3YXA9eDE7eDE9eDI7eDI9c3dhcDtzd2FwPXkxO3kxPXkyO3kyPXN3YXA7fX1cbmVsc2V7aWYoeTE8PS15Mil7c2lnbj0tc2lnbjt4Mj0teDI7eTI9LXkyO31cbmVsc2V7c3dhcD14MTt4MT0teDI7eDI9c3dhcDtzd2FwPXkxO3kxPS15Mjt5Mj1zd2FwO319fVxuZWxzZXtpZigwLjA8eTIpe2lmKC15MTw9eTIpe3NpZ249LXNpZ247eDE9LXgxO3kxPS15MTt9XG5lbHNle3N3YXA9LXgxO3gxPXgyO3gyPXN3YXA7c3dhcD0teTE7eTE9eTI7eTI9c3dhcDt9fVxuZWxzZXtpZih5MT49eTIpe3gxPS14MTt5MT0teTE7eDI9LXgyO3kyPS15Mjt9XG5lbHNle3NpZ249LXNpZ247c3dhcD0teDE7eDE9LXgyO3gyPXN3YXA7c3dhcD0teTE7eTE9LXkyO3kyPXN3YXA7fX19XG5pZigwLjA8eDEpe2lmKDAuMDx4Mil7aWYoeDE+eDIpe3JldHVybiBzaWduO319XG5lbHNle3JldHVybiBzaWduO319XG5lbHNle2lmKDAuMDx4Mil7cmV0dXJuLXNpZ247fVxuZWxzZXtpZih4MT49eDIpe3NpZ249LXNpZ247eDE9LXgxO3gyPS14Mjt9XG5lbHNle3JldHVybi1zaWduO319fVxud2hpbGUodHJ1ZSl7Y291bnQ9Y291bnQrMTtrPU1hdGguZmxvb3IoeDIveDEpO3gyPXgyLWsqeDE7eTI9eTItayp5MTtpZih5MjwwLjApe3JldHVybi1zaWduO31cbmlmKHkyPnkxKXtyZXR1cm4gc2lnbjt9XG5pZih4MT54Mit4Mil7aWYoeTE8eTIreTIpe3JldHVybiBzaWduO319XG5lbHNle2lmKHkxPnkyK3kyKXtyZXR1cm4tc2lnbjt9XG5lbHNle3gyPXgxLXgyO3kyPXkxLXkyO3NpZ249LXNpZ247fX1cbmlmKHkyPT09MC4wKXtpZih4Mj09PTAuMCl7cmV0dXJuIDA7fVxuZWxzZXtyZXR1cm4tc2lnbjt9fVxuaWYoeDI9PT0wLjApe3JldHVybiBzaWduO31cbms9TWF0aC5mbG9vcih4MS94Mik7eDE9eDEtayp4Mjt5MT15MS1rKnkyO2lmKHkxPDAuMCl7cmV0dXJuIHNpZ247fVxuaWYoeTE+eTIpe3JldHVybi1zaWduO31cbmlmKHgyPngxK3gxKXtpZih5Mjx5MSt5MSl7cmV0dXJuLXNpZ247fX1cbmVsc2V7aWYoeTI+eTEreTEpe3JldHVybiBzaWduO31cbmVsc2V7eDE9eDIteDE7eTE9eTIteTE7c2lnbj0tc2lnbjt9fVxuaWYoeTE9PT0wLjApe2lmKHgxPT09MC4wKXtyZXR1cm4gMDt9XG5lbHNle3JldHVybiBzaWduO319XG5pZih4MT09PTAuMCl7cmV0dXJuLXNpZ247fX19O2pzdHMuYWxnb3JpdGhtLlJvYnVzdERldGVybWluYW50Lm9yaWVudGF0aW9uSW5kZXg9ZnVuY3Rpb24ocDEscDIscSl7dmFyIGR4MT1wMi54LXAxLng7dmFyIGR5MT1wMi55LXAxLnk7dmFyIGR4Mj1xLngtcDIueDt2YXIgZHkyPXEueS1wMi55O3JldHVybiBqc3RzLmFsZ29yaXRobS5Sb2J1c3REZXRlcm1pbmFudC5zaWduT2ZEZXQyeDIoZHgxLGR5MSxkeDIsZHkyKTt9O2pzdHMuaW5kZXgucXVhZHRyZWUuTm9kZUJhc2U9ZnVuY3Rpb24oKXt0aGlzLnN1Ym5vZGU9bmV3IEFycmF5KDQpO3RoaXMuc3Vibm9kZVswXT1udWxsO3RoaXMuc3Vibm9kZVsxXT1udWxsO3RoaXMuc3Vibm9kZVsyXT1udWxsO3RoaXMuc3Vibm9kZVszXT1udWxsO3RoaXMuaXRlbXM9W107fTtqc3RzLmluZGV4LnF1YWR0cmVlLk5vZGVCYXNlLnByb3RvdHlwZS5nZXRTdWJub2RlSW5kZXg9ZnVuY3Rpb24oZW52LGNlbnRyZSl7dmFyIHN1Ym5vZGVJbmRleD0tMTtpZihlbnYuZ2V0TWluWCgpPj1jZW50cmUueCl7aWYoZW52LmdldE1pblkoKT49Y2VudHJlLnkpe3N1Ym5vZGVJbmRleD0zO31cbmlmKGVudi5nZXRNYXhZKCk8PWNlbnRyZS55KXtzdWJub2RlSW5kZXg9MTt9fVxuaWYoZW52LmdldE1heFgoKTw9Y2VudHJlLngpe2lmKGVudi5nZXRNaW5ZKCk+PWNlbnRyZS55KXtzdWJub2RlSW5kZXg9Mjt9XG5pZihlbnYuZ2V0TWF4WSgpPD1jZW50cmUueSl7c3Vibm9kZUluZGV4PTA7fX1cbnJldHVybiBzdWJub2RlSW5kZXg7fTtqc3RzLmluZGV4LnF1YWR0cmVlLk5vZGVCYXNlLnByb3RvdHlwZS5nZXRJdGVtcz1mdW5jdGlvbigpe3JldHVybiB0aGlzLml0ZW1zO307anN0cy5pbmRleC5xdWFkdHJlZS5Ob2RlQmFzZS5wcm90b3R5cGUuaGFzSXRlbXM9ZnVuY3Rpb24oKXtyZXR1cm4odGhpcy5pdGVtcy5sZW5ndGg+MCk7fTtqc3RzLmluZGV4LnF1YWR0cmVlLk5vZGVCYXNlLnByb3RvdHlwZS5hZGQ9ZnVuY3Rpb24oaXRlbSl7dGhpcy5pdGVtcy5wdXNoKGl0ZW0pO307anN0cy5pbmRleC5xdWFkdHJlZS5Ob2RlQmFzZS5wcm90b3R5cGUucmVtb3ZlPWZ1bmN0aW9uKGl0ZW1FbnYsaXRlbSl7aWYoIXRoaXMuaXNTZWFyY2hNYXRjaChpdGVtRW52KSl7cmV0dXJuIGZhbHNlO31cbnZhciBmb3VuZD1mYWxzZSxpPTA7Zm9yKGk7aTw0O2krKyl7aWYodGhpcy5zdWJub2RlW2ldIT09bnVsbCl7Zm91bmQ9dGhpcy5zdWJub2RlW2ldLnJlbW92ZShpdGVtRW52LGl0ZW0pO2lmKGZvdW5kKXtpZih0aGlzLnN1Ym5vZGVbaV0uaXNQcnVuYWJsZSgpKXt0aGlzLnN1Ym5vZGVbaV09bnVsbDt9XG5icmVhazt9fX1cbmlmKGZvdW5kKXtyZXR1cm4gZm91bmQ7fVxuaWYodGhpcy5pdGVtcy5pbmRleE9mKGl0ZW0pIT09LTEpe2Zvcih2YXIgaT10aGlzLml0ZW1zLmxlbmd0aC0xO2k+PTA7aS0tKXtpZih0aGlzLml0ZW1zW2ldPT09aXRlbSl7dGhpcy5pdGVtcy5zcGxpY2UoaSwxKTt9fVxuZm91bmQ9dHJ1ZTt9XG5yZXR1cm4gZm91bmQ7fTtqc3RzLmluZGV4LnF1YWR0cmVlLk5vZGVCYXNlLnByb3RvdHlwZS5pc1BydW5hYmxlPWZ1bmN0aW9uKCl7cmV0dXJuISh0aGlzLmhhc0NoaWxkcmVuKCl8fHRoaXMuaGFzSXRlbXMoKSk7fTtqc3RzLmluZGV4LnF1YWR0cmVlLk5vZGVCYXNlLnByb3RvdHlwZS5oYXNDaGlsZHJlbj1mdW5jdGlvbigpe3ZhciBpPTA7Zm9yKGk7aTw0O2krKyl7aWYodGhpcy5zdWJub2RlW2ldIT09bnVsbCl7cmV0dXJuIHRydWU7fX1cbnJldHVybiBmYWxzZTt9O2pzdHMuaW5kZXgucXVhZHRyZWUuTm9kZUJhc2UucHJvdG90eXBlLmlzRW1wdHk9ZnVuY3Rpb24oKXt2YXIgaXNFbXB0eT10cnVlO2lmKHRoaXMuaXRlbXMubGVuZ3RoPjApe2lzRW1wdHk9ZmFsc2U7fVxudmFyIGk9MDtmb3IoaTtpPDQ7aSsrKXtpZih0aGlzLnN1Ym5vZGVbaV0hPT1udWxsKXtpZighdGhpcy5zdWJub2RlW2ldLmlzRW1wdHkoKSl7aXNFbXB0eT1mYWxzZTt9fX1cbnJldHVybiBpc0VtcHR5O307anN0cy5pbmRleC5xdWFkdHJlZS5Ob2RlQmFzZS5wcm90b3R5cGUuYWRkQWxsSXRlbXM9ZnVuY3Rpb24ocmVzdWx0SXRlbXMpe3Jlc3VsdEl0ZW1zPXJlc3VsdEl0ZW1zLmNvbmNhdCh0aGlzLml0ZW1zKTt2YXIgaT0wO2ZvcihpO2k8NDtpKyspe2lmKHRoaXMuc3Vibm9kZVtpXSE9PW51bGwpe3Jlc3VsdEl0ZW1zPXRoaXMuc3Vibm9kZVtpXS5hZGRBbGxJdGVtcyhyZXN1bHRJdGVtcyk7fX1cbnJldHVybiByZXN1bHRJdGVtczt9O2pzdHMuaW5kZXgucXVhZHRyZWUuTm9kZUJhc2UucHJvdG90eXBlLmFkZEFsbEl0ZW1zRnJvbU92ZXJsYXBwaW5nPWZ1bmN0aW9uKHNlYXJjaEVudixyZXN1bHRJdGVtcyl7aWYoIXRoaXMuaXNTZWFyY2hNYXRjaChzZWFyY2hFbnYpKXtyZXR1cm47fVxucmVzdWx0SXRlbXM9cmVzdWx0SXRlbXMuY29uY2F0KHRoaXMuaXRlbXMpO3ZhciBpPTA7Zm9yKGk7aTw0O2krKyl7aWYodGhpcy5zdWJub2RlW2ldIT09bnVsbCl7cmVzdWx0SXRlbXM9dGhpcy5zdWJub2RlW2ldLmFkZEFsbEl0ZW1zRnJvbU92ZXJsYXBwaW5nKHNlYXJjaEVudixyZXN1bHRJdGVtcyk7fX19O2pzdHMuaW5kZXgucXVhZHRyZWUuTm9kZUJhc2UucHJvdG90eXBlLnZpc2l0PWZ1bmN0aW9uKHNlYXJjaEVudix2aXNpdG9yKXtpZighdGhpcy5pc1NlYXJjaE1hdGNoKHNlYXJjaEVudikpe3JldHVybjt9XG50aGlzLnZpc2l0SXRlbXMoc2VhcmNoRW52LHZpc2l0b3IpO3ZhciBpPTA7Zm9yKGk7aTw0O2krKyl7aWYodGhpcy5zdWJub2RlW2ldIT09bnVsbCl7dGhpcy5zdWJub2RlW2ldLnZpc2l0KHNlYXJjaEVudix2aXNpdG9yKTt9fX07anN0cy5pbmRleC5xdWFkdHJlZS5Ob2RlQmFzZS5wcm90b3R5cGUudmlzaXRJdGVtcz1mdW5jdGlvbihlbnYsdmlzaXRvcil7dmFyIGk9MCxpbD10aGlzLml0ZW1zLmxlbmd0aDtmb3IoaTtpPGlsO2krKyl7dmlzaXRvci52aXNpdEl0ZW0odGhpcy5pdGVtc1tpXSk7fX07anN0cy5pbmRleC5xdWFkdHJlZS5Ob2RlQmFzZS5wcm90b3R5cGUuZGVwdGg9ZnVuY3Rpb24oKXt2YXIgbWF4U3ViRGVwdGg9MCxpPTAsc3FkO2ZvcihpO2k8NDtpKyspe2lmKHRoaXMuc3Vibm9kZVtpXSE9PW51bGwpe3NxZD10aGlzLnN1Ym5vZGVbaV0uZGVwdGgoKTtpZihzcWQ+bWF4U3ViRGVwdGgpe21heFN1YkRlcHRoPXNxZDt9fX1cbnJldHVybiBtYXhTdWJEZXB0aCsxO307anN0cy5pbmRleC5xdWFkdHJlZS5Ob2RlQmFzZS5wcm90b3R5cGUuc2l6ZT1mdW5jdGlvbigpe3ZhciBzdWJTaXplPTAsaT0wO2ZvcihpO2k8NDtpKyspe2lmKHRoaXMuc3Vibm9kZVtpXSE9PW51bGwpe3N1YlNpemUrPXRoaXMuc3Vibm9kZVtpXS5zaXplKCk7fX1cbnJldHVybiBzdWJTaXplK3RoaXMuaXRlbXMubGVuZ3RoO307anN0cy5pbmRleC5xdWFkdHJlZS5Ob2RlQmFzZS5wcm90b3R5cGUuZ2V0Tm9kZUNvdW50PWZ1bmN0aW9uKCl7dmFyIHN1YlNpemU9MCxpPTA7Zm9yKGk7aTw0O2krKyl7aWYodGhpcy5zdWJub2RlW2ldIT09bnVsbCl7c3ViU2l6ZSs9dGhpcy5zdWJub2RlW2ldLnNpemUoKTt9fVxucmV0dXJuIHN1YlNpemUrMTt9O2pzdHMuaW5kZXgucXVhZHRyZWUuTm9kZT1mdW5jdGlvbihlbnYsbGV2ZWwpe2pzdHMuaW5kZXgucXVhZHRyZWUuTm9kZUJhc2UucHJvdG90eXBlLmNvbnN0cnVjdG9yLmFwcGx5KHRoaXMsYXJndW1lbnRzKTt0aGlzLmVudj1lbnY7dGhpcy5sZXZlbD1sZXZlbDt0aGlzLmNlbnRyZT1uZXcganN0cy5nZW9tLkNvb3JkaW5hdGUoKTt0aGlzLmNlbnRyZS54PShlbnYuZ2V0TWluWCgpK2Vudi5nZXRNYXhYKCkpLzI7dGhpcy5jZW50cmUueT0oZW52LmdldE1pblkoKStlbnYuZ2V0TWF4WSgpKS8yO307anN0cy5pbmRleC5xdWFkdHJlZS5Ob2RlLnByb3RvdHlwZT1uZXcganN0cy5pbmRleC5xdWFkdHJlZS5Ob2RlQmFzZSgpO2pzdHMuaW5kZXgucXVhZHRyZWUuTm9kZS5jcmVhdGVOb2RlPWZ1bmN0aW9uKGVudil7dmFyIGtleSxub2RlO2tleT1uZXcganN0cy5pbmRleC5xdWFkdHJlZS5LZXkoZW52KTtub2RlPW5ldyBqc3RzLmluZGV4LnF1YWR0cmVlLk5vZGUoa2V5LmdldEVudmVsb3BlKCksa2V5LmdldExldmVsKCkpO3JldHVybiBub2RlO307anN0cy5pbmRleC5xdWFkdHJlZS5Ob2RlLmNyZWF0ZUV4cGFuZGVkPWZ1bmN0aW9uKG5vZGUsYWRkRW52KXt2YXIgZXhwYW5kRW52PW5ldyBqc3RzLmdlb20uRW52ZWxvcGUoYWRkRW52KSxsYXJnZXJOb2RlO2lmKG5vZGUhPT1udWxsKXtleHBhbmRFbnYuZXhwYW5kVG9JbmNsdWRlKG5vZGUuZW52KTt9XG5sYXJnZXJOb2RlPWpzdHMuaW5kZXgucXVhZHRyZWUuTm9kZS5jcmVhdGVOb2RlKGV4cGFuZEVudik7aWYobm9kZSE9PW51bGwpe2xhcmdlck5vZGUuaW5zZXJ0Tm9kZShub2RlKTt9XG5yZXR1cm4gbGFyZ2VyTm9kZTt9O2pzdHMuaW5kZXgucXVhZHRyZWUuTm9kZS5wcm90b3R5cGUuZ2V0RW52ZWxvcGU9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5lbnY7fTtqc3RzLmluZGV4LnF1YWR0cmVlLk5vZGUucHJvdG90eXBlLmlzU2VhcmNoTWF0Y2g9ZnVuY3Rpb24oc2VhcmNoRW52KXtyZXR1cm4gdGhpcy5lbnYuaW50ZXJzZWN0cyhzZWFyY2hFbnYpO307anN0cy5pbmRleC5xdWFkdHJlZS5Ob2RlLnByb3RvdHlwZS5nZXROb2RlPWZ1bmN0aW9uKHNlYXJjaEVudil7dmFyIHN1Ym5vZGVJbmRleD10aGlzLmdldFN1Ym5vZGVJbmRleChzZWFyY2hFbnYsdGhpcy5jZW50cmUpLG5vZGU7aWYoc3Vibm9kZUluZGV4IT09LTEpe25vZGU9dGhpcy5nZXRTdWJub2RlKHN1Ym5vZGVJbmRleCk7cmV0dXJuIG5vZGUuZ2V0Tm9kZShzZWFyY2hFbnYpO31lbHNle3JldHVybiB0aGlzO319O2pzdHMuaW5kZXgucXVhZHRyZWUuTm9kZS5wcm90b3R5cGUuZmluZD1mdW5jdGlvbihzZWFyY2hFbnYpe3ZhciBzdWJub2RlSW5kZXg9dGhpcy5nZXRTdWJub2RlSW5kZXgoc2VhcmNoRW52LHRoaXMuY2VudHJlKSxub2RlO2lmKHN1Ym5vZGVJbmRleD09PS0xKXtyZXR1cm4gdGhpczt9XG5pZih0aGlzLnN1Ym5vZGVbc3Vibm9kZUluZGV4XSE9PW51bGwpe25vZGU9dGhpcy5zdWJub2RlW3N1Ym5vZGVJbmRleF07cmV0dXJuIG5vZGUuZmluZChzZWFyY2hFbnYpO31cbnJldHVybiB0aGlzO307anN0cy5pbmRleC5xdWFkdHJlZS5Ob2RlLnByb3RvdHlwZS5pbnNlcnROb2RlPWZ1bmN0aW9uKG5vZGUpe3ZhciBpbmRleD10aGlzLmdldFN1Ym5vZGVJbmRleChub2RlLmVudix0aGlzLmNlbnRyZSksY2hpbGROb2RlO2lmKG5vZGUubGV2ZWw9PT10aGlzLmxldmVsLTEpe3RoaXMuc3Vibm9kZVtpbmRleF09bm9kZTt9ZWxzZXtjaGlsZE5vZGU9dGhpcy5jcmVhdGVTdWJub2RlKGluZGV4KTtjaGlsZE5vZGUuaW5zZXJ0Tm9kZShub2RlKTt0aGlzLnN1Ym5vZGVbaW5kZXhdPWNoaWxkTm9kZTt9fTtqc3RzLmluZGV4LnF1YWR0cmVlLk5vZGUucHJvdG90eXBlLmdldFN1Ym5vZGU9ZnVuY3Rpb24oaW5kZXgpe2lmKHRoaXMuc3Vibm9kZVtpbmRleF09PT1udWxsKXt0aGlzLnN1Ym5vZGVbaW5kZXhdPXRoaXMuY3JlYXRlU3Vibm9kZShpbmRleCk7fVxucmV0dXJuIHRoaXMuc3Vibm9kZVtpbmRleF07fTtqc3RzLmluZGV4LnF1YWR0cmVlLk5vZGUucHJvdG90eXBlLmNyZWF0ZVN1Ym5vZGU9ZnVuY3Rpb24oaW5kZXgpe3ZhciBtaW54PTAuMCxtYXh4PTAuMCxtaW55PTAuMCxtYXh5PTAuMCxzcUVudixub2RlO3N3aXRjaChpbmRleCl7Y2FzZSAwOm1pbng9dGhpcy5lbnYuZ2V0TWluWCgpO21heHg9dGhpcy5jZW50cmUueDttaW55PXRoaXMuZW52LmdldE1pblkoKTttYXh5PXRoaXMuY2VudHJlLnk7YnJlYWs7Y2FzZSAxOm1pbng9dGhpcy5jZW50cmUueDttYXh4PXRoaXMuZW52LmdldE1heFgoKTttaW55PXRoaXMuZW52LmdldE1pblkoKTttYXh5PXRoaXMuY2VudHJlLnk7YnJlYWs7Y2FzZSAyOm1pbng9dGhpcy5lbnYuZ2V0TWluWCgpO21heHg9dGhpcy5jZW50cmUueDttaW55PXRoaXMuY2VudHJlLnk7bWF4eT10aGlzLmVudi5nZXRNYXhZKCk7YnJlYWs7Y2FzZSAzOm1pbng9dGhpcy5jZW50cmUueDttYXh4PXRoaXMuZW52LmdldE1heFgoKTttaW55PXRoaXMuY2VudHJlLnk7bWF4eT10aGlzLmVudi5nZXRNYXhZKCk7YnJlYWs7fVxuc3FFbnY9bmV3IGpzdHMuZ2VvbS5FbnZlbG9wZShtaW54LG1heHgsbWlueSxtYXh5KTtub2RlPW5ldyBqc3RzLmluZGV4LnF1YWR0cmVlLk5vZGUoc3FFbnYsdGhpcy5sZXZlbC0xKTtyZXR1cm4gbm9kZTt9OyhmdW5jdGlvbigpe2pzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuUXVhZEVkZ2U9ZnVuY3Rpb24oKXt0aGlzLnJvdD1udWxsO3RoaXMudmVydGV4PW51bGw7dGhpcy5uZXh0PW51bGw7dGhpcy5kYXRhPW51bGw7fTt2YXIgUXVhZEVkZ2U9anN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5RdWFkRWRnZTtqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlF1YWRFZGdlLm1ha2VFZGdlPWZ1bmN0aW9uKG8sZCl7dmFyIHEwLHExLHEyLHEzLGJhc2U7cTA9bmV3IFF1YWRFZGdlKCk7cTE9bmV3IFF1YWRFZGdlKCk7cTI9bmV3IFF1YWRFZGdlKCk7cTM9bmV3IFF1YWRFZGdlKCk7cTAucm90PXExO3ExLnJvdD1xMjtxMi5yb3Q9cTM7cTMucm90PXEwO3EwLnNldE5leHQocTApO3ExLnNldE5leHQocTMpO3EyLnNldE5leHQocTIpO3EzLnNldE5leHQocTEpO2Jhc2U9cTA7YmFzZS5zZXRPcmlnKG8pO2Jhc2Uuc2V0RGVzdChkKTtyZXR1cm4gYmFzZTt9O2pzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuUXVhZEVkZ2UuY29ubmVjdD1mdW5jdGlvbihhLGIpe3ZhciBlPVF1YWRFZGdlLm1ha2VFZGdlKGEuZGVzdCgpLGIub3JpZygpKTtRdWFkRWRnZS5zcGxpY2UoZSxhLmxOZXh0KCkpO1F1YWRFZGdlLnNwbGljZShlLnN5bSgpLGIpO3JldHVybiBlO307anN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5RdWFkRWRnZS5zcGxpY2U9ZnVuY3Rpb24oYSxiKXt2YXIgYWxwaGEsYmV0YSx0MSx0Mix0Myx0NDthbHBoYT1hLm9OZXh0KCkucm90O2JldGE9Yi5vTmV4dCgpLnJvdDt0MT1iLm9OZXh0KCk7dDI9YS5vTmV4dCgpO3QzPWJldGEub05leHQoKTt0ND1hbHBoYS5vTmV4dCgpO2Euc2V0TmV4dCh0MSk7Yi5zZXROZXh0KHQyKTthbHBoYS5zZXROZXh0KHQzKTtiZXRhLnNldE5leHQodDQpO307anN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5RdWFkRWRnZS5zd2FwPWZ1bmN0aW9uKGUpe3ZhciBhLGI7YT1lLm9QcmV2KCk7Yj1lLnN5bSgpLm9QcmV2KCk7UXVhZEVkZ2Uuc3BsaWNlKGUsYSk7UXVhZEVkZ2Uuc3BsaWNlKGUuc3ltKCksYik7UXVhZEVkZ2Uuc3BsaWNlKGUsYS5sTmV4dCgpKTtRdWFkRWRnZS5zcGxpY2UoZS5zeW0oKSxiLmxOZXh0KCkpO2Uuc2V0T3JpZyhhLmRlc3QoKSk7ZS5zZXREZXN0KGIuZGVzdCgpKTt9O2pzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuUXVhZEVkZ2UucHJvdG90eXBlLmdldFByaW1hcnk9ZnVuY3Rpb24oKXtpZih0aGlzLm9yaWcoKS5nZXRDb29yZGluYXRlKCkuY29tcGFyZVRvKHRoaXMuZGVzdCgpLmdldENvb3JkaW5hdGUoKSk8PTApe3JldHVybiB0aGlzO31cbmVsc2V7cmV0dXJuIHRoaXMuc3ltKCk7fX07anN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5RdWFkRWRnZS5wcm90b3R5cGUuc2V0RGF0YT1mdW5jdGlvbihkYXRhKXt0aGlzLmRhdGE9ZGF0YTt9O2pzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuUXVhZEVkZ2UucHJvdG90eXBlLmdldERhdGE9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5kYXRhO307anN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5RdWFkRWRnZS5wcm90b3R5cGUuZGVsZXRlX2pzdHM9ZnVuY3Rpb24oKXt0aGlzLnJvdD1udWxsO307anN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5RdWFkRWRnZS5wcm90b3R5cGUuaXNMaXZlPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMucm90IT09bnVsbDt9O2pzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuUXVhZEVkZ2UucHJvdG90eXBlLnNldE5leHQ9ZnVuY3Rpb24obmV4dCl7dGhpcy5uZXh0PW5leHQ7fTtqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlF1YWRFZGdlLnByb3RvdHlwZS5pbnZSb3Q9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5yb3Quc3ltKCk7fTtqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlF1YWRFZGdlLnByb3RvdHlwZS5zeW09ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5yb3Qucm90O307anN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5RdWFkRWRnZS5wcm90b3R5cGUub05leHQ9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5uZXh0O307anN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5RdWFkRWRnZS5wcm90b3R5cGUub1ByZXY9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5yb3QubmV4dC5yb3Q7fTtqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlF1YWRFZGdlLnByb3RvdHlwZS5kTmV4dD1mdW5jdGlvbigpe3JldHVybiB0aGlzLnN5bSgpLm9OZXh0KCkuc3ltKCk7fTtqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlF1YWRFZGdlLnByb3RvdHlwZS5kUHJldj1mdW5jdGlvbigpe3JldHVybiB0aGlzLmludlJvdCgpLm9OZXh0KCkuaW52Um90KCk7fTtqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlF1YWRFZGdlLnByb3RvdHlwZS5sTmV4dD1mdW5jdGlvbigpe3JldHVybiB0aGlzLmludlJvdCgpLm9OZXh0KCkucm90O307anN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5RdWFkRWRnZS5wcm90b3R5cGUubFByZXY9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5uZXh0LnN5bSgpO307anN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5RdWFkRWRnZS5wcm90b3R5cGUuck5leHQ9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5yb3QubmV4dC5pbnZSb3QoKTt9O2pzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuUXVhZEVkZ2UucHJvdG90eXBlLnJQcmV2PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuc3ltKCkub05leHQoKTt9O2pzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuUXVhZEVkZ2UucHJvdG90eXBlLnNldE9yaWc9ZnVuY3Rpb24obyl7dGhpcy52ZXJ0ZXg9bzt9O2pzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuUXVhZEVkZ2UucHJvdG90eXBlLnNldERlc3Q9ZnVuY3Rpb24oZCl7dGhpcy5zeW0oKS5zZXRPcmlnKGQpO307anN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5RdWFkRWRnZS5wcm90b3R5cGUub3JpZz1mdW5jdGlvbigpe3JldHVybiB0aGlzLnZlcnRleDt9O2pzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuUXVhZEVkZ2UucHJvdG90eXBlLmRlc3Q9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5zeW0oKS5vcmlnKCk7fTtqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlF1YWRFZGdlLnByb3RvdHlwZS5nZXRMZW5ndGg9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5vcmlnKCkuZ2V0Q29vcmRpbmF0ZSgpLmRpc3RhbmNlKGRlc3QoKS5nZXRDb29yZGluYXRlKCkpO307anN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5RdWFkRWRnZS5wcm90b3R5cGUuZXF1YWxzTm9uT3JpZW50ZWQ9ZnVuY3Rpb24ocWUpe2lmKHRoaXMuZXF1YWxzT3JpZW50ZWQocWUpKXtyZXR1cm4gdHJ1ZTt9XG5pZih0aGlzLmVxdWFsc09yaWVudGVkKHFlLnN5bSgpKSl7cmV0dXJuIHRydWU7fVxucmV0dXJuIGZhbHNlO307anN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5RdWFkRWRnZS5wcm90b3R5cGUuZXF1YWxzT3JpZW50ZWQ9ZnVuY3Rpb24ocWUpe2lmKHRoaXMub3JpZygpLmdldENvb3JkaW5hdGUoKS5lcXVhbHMyRChxZS5vcmlnKCkuZ2V0Q29vcmRpbmF0ZSgpKSYmdGhpcy5kZXN0KCkuZ2V0Q29vcmRpbmF0ZSgpLmVxdWFsczJEKHFlLmRlc3QoKS5nZXRDb29yZGluYXRlKCkpKXtyZXR1cm4gdHJ1ZTt9XG5yZXR1cm4gZmFsc2U7fTtqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlF1YWRFZGdlLnByb3RvdHlwZS50b0xpbmVTZWdtZW50PWZ1bmN0aW9uKClcbntyZXR1cm4gbmV3IGpzdHMuZ2VvbS5MaW5lU2VnbWVudCh0aGlzLnZlcnRleC5nZXRDb29yZGluYXRlKCksdGhpcy5kZXN0KCkuZ2V0Q29vcmRpbmF0ZSgpKTt9O2pzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuUXVhZEVkZ2UucHJvdG90eXBlLnRvU3RyaW5nPWZ1bmN0aW9uKCl7dmFyIHAwLHAxO3AwPXRoaXMudmVydGV4LmdldENvb3JkaW5hdGUoKTtwMT10aGlzLmRlc3QoKS5nZXRDb29yZGluYXRlKCk7cmV0dXJuIGpzdHMuaW8uV0tUV3JpdGVyLnRvTGluZVN0cmluZyhwMCxwMSk7fTt9KSgpOyhmdW5jdGlvbigpe3ZhciBBc3NlcnQ9anN0cy51dGlsLkFzc2VydDtqc3RzLmdlb21ncmFwaC5FZGdlRW5kPWZ1bmN0aW9uKGVkZ2UscDAscDEsbGFiZWwpe3RoaXMuZWRnZT1lZGdlO2lmKHAwJiZwMSl7dGhpcy5pbml0KHAwLHAxKTt9XG5pZihsYWJlbCl7dGhpcy5sYWJlbD1sYWJlbHx8bnVsbDt9fTtqc3RzLmdlb21ncmFwaC5FZGdlRW5kLnByb3RvdHlwZS5lZGdlPW51bGw7anN0cy5nZW9tZ3JhcGguRWRnZUVuZC5wcm90b3R5cGUubGFiZWw9bnVsbDtqc3RzLmdlb21ncmFwaC5FZGdlRW5kLnByb3RvdHlwZS5ub2RlPW51bGw7anN0cy5nZW9tZ3JhcGguRWRnZUVuZC5wcm90b3R5cGUucDA9bnVsbDtqc3RzLmdlb21ncmFwaC5FZGdlRW5kLnByb3RvdHlwZS5wMT1udWxsO2pzdHMuZ2VvbWdyYXBoLkVkZ2VFbmQucHJvdG90eXBlLmR4PW51bGw7anN0cy5nZW9tZ3JhcGguRWRnZUVuZC5wcm90b3R5cGUuZHk9bnVsbDtqc3RzLmdlb21ncmFwaC5FZGdlRW5kLnByb3RvdHlwZS5xdWFkcmFudD1udWxsO2pzdHMuZ2VvbWdyYXBoLkVkZ2VFbmQucHJvdG90eXBlLmluaXQ9ZnVuY3Rpb24ocDAscDEpe3RoaXMucDA9cDA7dGhpcy5wMT1wMTt0aGlzLmR4PXAxLngtcDAueDt0aGlzLmR5PXAxLnktcDAueTt0aGlzLnF1YWRyYW50PWpzdHMuZ2VvbWdyYXBoLlF1YWRyYW50LnF1YWRyYW50KHRoaXMuZHgsdGhpcy5keSk7QXNzZXJ0LmlzVHJ1ZSghKHRoaXMuZHg9PT0wJiZ0aGlzLmR5PT09MCksJ0VkZ2VFbmQgd2l0aCBpZGVudGljYWwgZW5kcG9pbnRzIGZvdW5kJyk7fTtqc3RzLmdlb21ncmFwaC5FZGdlRW5kLnByb3RvdHlwZS5nZXRFZGdlPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZWRnZTt9O2pzdHMuZ2VvbWdyYXBoLkVkZ2VFbmQucHJvdG90eXBlLmdldExhYmVsPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMubGFiZWw7fTtqc3RzLmdlb21ncmFwaC5FZGdlRW5kLnByb3RvdHlwZS5nZXRDb29yZGluYXRlPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMucDA7fTtqc3RzLmdlb21ncmFwaC5FZGdlRW5kLnByb3RvdHlwZS5nZXREaXJlY3RlZENvb3JkaW5hdGU9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5wMTt9O2pzdHMuZ2VvbWdyYXBoLkVkZ2VFbmQucHJvdG90eXBlLmdldFF1YWRyYW50PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMucXVhZHJhbnQ7fTtqc3RzLmdlb21ncmFwaC5FZGdlRW5kLnByb3RvdHlwZS5nZXREeD1mdW5jdGlvbigpe3JldHVybiB0aGlzLmR4O307anN0cy5nZW9tZ3JhcGguRWRnZUVuZC5wcm90b3R5cGUuZ2V0RHk9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5keTt9O2pzdHMuZ2VvbWdyYXBoLkVkZ2VFbmQucHJvdG90eXBlLnNldE5vZGU9ZnVuY3Rpb24obm9kZSl7dGhpcy5ub2RlPW5vZGU7fTtqc3RzLmdlb21ncmFwaC5FZGdlRW5kLnByb3RvdHlwZS5nZXROb2RlPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMubm9kZTt9O2pzdHMuZ2VvbWdyYXBoLkVkZ2VFbmQucHJvdG90eXBlLmNvbXBhcmVUbz1mdW5jdGlvbihlKXtyZXR1cm4gdGhpcy5jb21wYXJlRGlyZWN0aW9uKGUpO307anN0cy5nZW9tZ3JhcGguRWRnZUVuZC5wcm90b3R5cGUuY29tcGFyZURpcmVjdGlvbj1mdW5jdGlvbihlKXtpZih0aGlzLmR4PT09ZS5keCYmdGhpcy5keT09PWUuZHkpXG5yZXR1cm4gMDtpZih0aGlzLnF1YWRyYW50PmUucXVhZHJhbnQpXG5yZXR1cm4gMTtpZih0aGlzLnF1YWRyYW50PGUucXVhZHJhbnQpXG5yZXR1cm4tMTtyZXR1cm4ganN0cy5hbGdvcml0aG0uQ0dBbGdvcml0aG1zLmNvbXB1dGVPcmllbnRhdGlvbihlLnAwLGUucDEsdGhpcy5wMSk7fTtqc3RzLmdlb21ncmFwaC5FZGdlRW5kLnByb3RvdHlwZS5jb21wdXRlTGFiZWw9ZnVuY3Rpb24oYm91bmRhcnlOb2RlUnVsZSl7fTt9KSgpO2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5SaWdodG1vc3RFZGdlRmluZGVyPWZ1bmN0aW9uKCl7fTtqc3RzLm9wZXJhdGlvbi5idWZmZXIuUmlnaHRtb3N0RWRnZUZpbmRlci5wcm90b3R5cGUubWluSW5kZXg9LTE7anN0cy5vcGVyYXRpb24uYnVmZmVyLlJpZ2h0bW9zdEVkZ2VGaW5kZXIucHJvdG90eXBlLm1pbkNvb3JkPW51bGw7anN0cy5vcGVyYXRpb24uYnVmZmVyLlJpZ2h0bW9zdEVkZ2VGaW5kZXIucHJvdG90eXBlLm1pbkRlPW51bGw7anN0cy5vcGVyYXRpb24uYnVmZmVyLlJpZ2h0bW9zdEVkZ2VGaW5kZXIucHJvdG90eXBlLm9yaWVudGVkRGU9bnVsbDtqc3RzLm9wZXJhdGlvbi5idWZmZXIuUmlnaHRtb3N0RWRnZUZpbmRlci5wcm90b3R5cGUuZ2V0RWRnZT1mdW5jdGlvbigpe3JldHVybiB0aGlzLm9yaWVudGVkRGU7fTtqc3RzLm9wZXJhdGlvbi5idWZmZXIuUmlnaHRtb3N0RWRnZUZpbmRlci5wcm90b3R5cGUuZ2V0Q29vcmRpbmF0ZT1mdW5jdGlvbigpe3JldHVybiB0aGlzLm1pbkNvb3JkO307anN0cy5vcGVyYXRpb24uYnVmZmVyLlJpZ2h0bW9zdEVkZ2VGaW5kZXIucHJvdG90eXBlLmZpbmRFZGdlPWZ1bmN0aW9uKGRpckVkZ2VMaXN0KXtmb3IodmFyIGk9ZGlyRWRnZUxpc3QuaXRlcmF0b3IoKTtpLmhhc05leHQoKTspe3ZhciBkZT1pLm5leHQoKTtpZighZGUuaXNGb3J3YXJkKCkpXG5jb250aW51ZTt0aGlzLmNoZWNrRm9yUmlnaHRtb3N0Q29vcmRpbmF0ZShkZSk7fVxuanN0cy51dGlsLkFzc2VydC5pc1RydWUodGhpcy5taW5JbmRleCE9PTB8fHRoaXMubWluQ29vcmQuZXF1YWxzKHRoaXMubWluRGUuZ2V0Q29vcmRpbmF0ZSgpKSwnaW5jb25zaXN0ZW5jeSBpbiByaWdodG1vc3QgcHJvY2Vzc2luZycpO2lmKHRoaXMubWluSW5kZXg9PT0wKXt0aGlzLmZpbmRSaWdodG1vc3RFZGdlQXROb2RlKCk7fWVsc2V7dGhpcy5maW5kUmlnaHRtb3N0RWRnZUF0VmVydGV4KCk7fVxudGhpcy5vcmllbnRlZERlPXRoaXMubWluRGU7dmFyIHJpZ2h0bW9zdFNpZGU9dGhpcy5nZXRSaWdodG1vc3RTaWRlKHRoaXMubWluRGUsdGhpcy5taW5JbmRleCk7aWYocmlnaHRtb3N0U2lkZT09anN0cy5nZW9tZ3JhcGguUG9zaXRpb24uTEVGVCl7dGhpcy5vcmllbnRlZERlPXRoaXMubWluRGUuZ2V0U3ltKCk7fX07anN0cy5vcGVyYXRpb24uYnVmZmVyLlJpZ2h0bW9zdEVkZ2VGaW5kZXIucHJvdG90eXBlLmZpbmRSaWdodG1vc3RFZGdlQXROb2RlPWZ1bmN0aW9uKCl7dmFyIG5vZGU9dGhpcy5taW5EZS5nZXROb2RlKCk7dmFyIHN0YXI9bm9kZS5nZXRFZGdlcygpO3RoaXMubWluRGU9c3Rhci5nZXRSaWdodG1vc3RFZGdlKCk7aWYoIXRoaXMubWluRGUuaXNGb3J3YXJkKCkpe3RoaXMubWluRGU9dGhpcy5taW5EZS5nZXRTeW0oKTt0aGlzLm1pbkluZGV4PXRoaXMubWluRGUuZ2V0RWRnZSgpLmdldENvb3JkaW5hdGVzKCkubGVuZ3RoLTE7fX07anN0cy5vcGVyYXRpb24uYnVmZmVyLlJpZ2h0bW9zdEVkZ2VGaW5kZXIucHJvdG90eXBlLmZpbmRSaWdodG1vc3RFZGdlQXRWZXJ0ZXg9ZnVuY3Rpb24oKXt2YXIgcHRzPXRoaXMubWluRGUuZ2V0RWRnZSgpLmdldENvb3JkaW5hdGVzKCk7anN0cy51dGlsLkFzc2VydC5pc1RydWUodGhpcy5taW5JbmRleD4wJiZ0aGlzLm1pbkluZGV4PHB0cy5sZW5ndGgsJ3JpZ2h0bW9zdCBwb2ludCBleHBlY3RlZCB0byBiZSBpbnRlcmlvciB2ZXJ0ZXggb2YgZWRnZScpO3ZhciBwUHJldj1wdHNbdGhpcy5taW5JbmRleC0xXTt2YXIgcE5leHQ9cHRzW3RoaXMubWluSW5kZXgrMV07dmFyIG9yaWVudGF0aW9uPWpzdHMuYWxnb3JpdGhtLkNHQWxnb3JpdGhtcy5jb21wdXRlT3JpZW50YXRpb24odGhpcy5taW5Db29yZCxwTmV4dCxwUHJldik7dmFyIHVzZVByZXY9ZmFsc2U7aWYocFByZXYueTx0aGlzLm1pbkNvb3JkLnkmJnBOZXh0Lnk8dGhpcy5taW5Db29yZC55JiZvcmllbnRhdGlvbj09PWpzdHMuYWxnb3JpdGhtLkNHQWxnb3JpdGhtcy5DT1VOVEVSQ0xPQ0tXSVNFKXt1c2VQcmV2PXRydWU7fWVsc2UgaWYocFByZXYueT50aGlzLm1pbkNvb3JkLnkmJnBOZXh0Lnk+dGhpcy5taW5Db29yZC55JiZvcmllbnRhdGlvbj09PWpzdHMuYWxnb3JpdGhtLkNHQWxnb3JpdGhtcy5DTE9DS1dJU0Upe3VzZVByZXY9dHJ1ZTt9XG5pZih1c2VQcmV2KXt0aGlzLm1pbkluZGV4PXRoaXMubWluSW5kZXgtMTt9fTtqc3RzLm9wZXJhdGlvbi5idWZmZXIuUmlnaHRtb3N0RWRnZUZpbmRlci5wcm90b3R5cGUuY2hlY2tGb3JSaWdodG1vc3RDb29yZGluYXRlPWZ1bmN0aW9uKGRlKXt2YXIgY29vcmQ9ZGUuZ2V0RWRnZSgpLmdldENvb3JkaW5hdGVzKCk7Zm9yKHZhciBpPTA7aTxjb29yZC5sZW5ndGgtMTtpKyspe2lmKHRoaXMubWluQ29vcmQ9PT1udWxsfHxjb29yZFtpXS54PnRoaXMubWluQ29vcmQueCl7dGhpcy5taW5EZT1kZTt0aGlzLm1pbkluZGV4PWk7dGhpcy5taW5Db29yZD1jb29yZFtpXTt9fX07anN0cy5vcGVyYXRpb24uYnVmZmVyLlJpZ2h0bW9zdEVkZ2VGaW5kZXIucHJvdG90eXBlLmdldFJpZ2h0bW9zdFNpZGU9ZnVuY3Rpb24oZGUsaW5kZXgpe3ZhciBzaWRlPXRoaXMuZ2V0UmlnaHRtb3N0U2lkZU9mU2VnbWVudChkZSxpbmRleCk7aWYoc2lkZTwwKVxuc2lkZT10aGlzLmdldFJpZ2h0bW9zdFNpZGVPZlNlZ21lbnQoZGUsaW5kZXgtMSk7aWYoc2lkZTwwKXt0aGlzLm1pbkNvb3JkPW51bGw7dGhpcy5jaGVja0ZvclJpZ2h0bW9zdENvb3JkaW5hdGUoZGUpO31cbnJldHVybiBzaWRlO307anN0cy5vcGVyYXRpb24uYnVmZmVyLlJpZ2h0bW9zdEVkZ2VGaW5kZXIucHJvdG90eXBlLmdldFJpZ2h0bW9zdFNpZGVPZlNlZ21lbnQ9ZnVuY3Rpb24oZGUsaSl7dmFyIGU9ZGUuZ2V0RWRnZSgpO3ZhciBjb29yZD1lLmdldENvb3JkaW5hdGVzKCk7aWYoaTwwfHxpKzE+PWNvb3JkLmxlbmd0aClcbnJldHVybi0xO2lmKGNvb3JkW2ldLnk9PWNvb3JkW2krMV0ueSlcbnJldHVybi0xO3ZhciBwb3M9anN0cy5nZW9tZ3JhcGguUG9zaXRpb24uTEVGVDtpZihjb29yZFtpXS55PGNvb3JkW2krMV0ueSlcbnBvcz1qc3RzLmdlb21ncmFwaC5Qb3NpdGlvbi5SSUdIVDtyZXR1cm4gcG9zO307KGZ1bmN0aW9uKCl7anN0cy50cmlhbmd1bGF0ZS5JbmNyZW1lbnRhbERlbGF1bmF5VHJpYW5ndWxhdG9yPWZ1bmN0aW9uKHN1YmRpdil7dGhpcy5zdWJkaXY9c3ViZGl2O3RoaXMuaXNVc2luZ1RvbGVyYW5jZT1zdWJkaXYuZ2V0VG9sZXJhbmNlKCk+MC4wO307anN0cy50cmlhbmd1bGF0ZS5JbmNyZW1lbnRhbERlbGF1bmF5VHJpYW5ndWxhdG9yLnByb3RvdHlwZS5pbnNlcnRTaXRlcz1mdW5jdGlvbih2ZXJ0aWNlcyl7dmFyIGk9MCxpbD12ZXJ0aWNlcy5sZW5ndGgsdjtmb3IoaTtpPGlsO2krKyl7dj12ZXJ0aWNlc1tpXTt0aGlzLmluc2VydFNpdGUodik7fX07anN0cy50cmlhbmd1bGF0ZS5JbmNyZW1lbnRhbERlbGF1bmF5VHJpYW5ndWxhdG9yLnByb3RvdHlwZS5pbnNlcnRTaXRlPWZ1bmN0aW9uKHYpe3ZhciBlLGJhc2Usc3RhcnRFZGdlLHQ7ZT10aGlzLnN1YmRpdi5sb2NhdGUodik7aWYodGhpcy5zdWJkaXYuaXNWZXJ0ZXhPZkVkZ2UoZSx2KSl7cmV0dXJuIGU7fVxuZWxzZSBpZih0aGlzLnN1YmRpdi5pc09uRWRnZShlLHYuZ2V0Q29vcmRpbmF0ZSgpKSl7ZT1lLm9QcmV2KCk7dGhpcy5zdWJkaXYuZGVsZXRlX2pzdHMoZS5vTmV4dCgpKTt9XG5iYXNlPXRoaXMuc3ViZGl2Lm1ha2VFZGdlKGUub3JpZygpLHYpO2pzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuUXVhZEVkZ2Uuc3BsaWNlKGJhc2UsZSk7c3RhcnRFZGdlPWJhc2U7ZG97YmFzZT10aGlzLnN1YmRpdi5jb25uZWN0KGUsYmFzZS5zeW0oKSk7ZT1iYXNlLm9QcmV2KCk7fXdoaWxlKGUubE5leHQoKSE9c3RhcnRFZGdlKTtkb3t0PWUub1ByZXYoKTtpZih0LmRlc3QoKS5yaWdodE9mKGUpJiZ2LmlzSW5DaXJjbGUoZS5vcmlnKCksdC5kZXN0KCksZS5kZXN0KCkpKXtqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlF1YWRFZGdlLnN3YXAoZSk7ZT1lLm9QcmV2KCk7fWVsc2UgaWYoZS5vTmV4dCgpPT1zdGFydEVkZ2Upe3JldHVybiBiYXNlO31lbHNle2U9ZS5vTmV4dCgpLmxQcmV2KCk7fX13aGlsZSh0cnVlKTt9O30oKSk7anN0cy5hbGdvcml0aG0uQ2VudHJvaWRBcmVhPWZ1bmN0aW9uKCl7dGhpcy5iYXNlUHQ9bnVsbDt0aGlzLnRyaWFuZ2xlQ2VudDM9bmV3IGpzdHMuZ2VvbS5Db29yZGluYXRlKCk7dGhpcy5jZW50U3VtPW5ldyBqc3RzLmdlb20uQ29vcmRpbmF0ZSgpO3RoaXMuY2czPW5ldyBqc3RzLmdlb20uQ29vcmRpbmF0ZSgpO307anN0cy5hbGdvcml0aG0uQ2VudHJvaWRBcmVhLnByb3RvdHlwZS5iYXNlUHQ9bnVsbDtqc3RzLmFsZ29yaXRobS5DZW50cm9pZEFyZWEucHJvdG90eXBlLnRyaWFuZ2xlQ2VudDM9bnVsbDtqc3RzLmFsZ29yaXRobS5DZW50cm9pZEFyZWEucHJvdG90eXBlLmFyZWFzdW0yPTA7anN0cy5hbGdvcml0aG0uQ2VudHJvaWRBcmVhLnByb3RvdHlwZS5jZzM9bnVsbDtqc3RzLmFsZ29yaXRobS5DZW50cm9pZEFyZWEucHJvdG90eXBlLmNlbnRTdW09bnVsbDtqc3RzLmFsZ29yaXRobS5DZW50cm9pZEFyZWEucHJvdG90eXBlLnRvdGFsTGVuZ3RoPTAuMDtqc3RzLmFsZ29yaXRobS5DZW50cm9pZEFyZWEucHJvdG90eXBlLmFkZD1mdW5jdGlvbihnZW9tKXtpZihnZW9tIGluc3RhbmNlb2YganN0cy5nZW9tLlBvbHlnb24pe3ZhciBwb2x5PWdlb207dGhpcy5zZXRCYXNlUG9pbnQocG9seS5nZXRFeHRlcmlvclJpbmcoKS5nZXRDb29yZGluYXRlTigwKSk7dGhpcy5hZGQzKHBvbHkpO31lbHNlIGlmKGdlb20gaW5zdGFuY2VvZiBqc3RzLmdlb20uR2VvbWV0cnlDb2xsZWN0aW9ufHxnZW9tIGluc3RhbmNlb2YganN0cy5nZW9tLk11bHRpUG9seWdvbil7dmFyIGdjPWdlb207Zm9yKHZhciBpPTA7aTxnYy5nZXROdW1HZW9tZXRyaWVzKCk7aSsrKXt0aGlzLmFkZChnYy5nZXRHZW9tZXRyeU4oaSkpO319ZWxzZSBpZihnZW9tIGluc3RhbmNlb2YgQXJyYXkpe3RoaXMuYWRkMihnZW9tKTt9fTtqc3RzLmFsZ29yaXRobS5DZW50cm9pZEFyZWEucHJvdG90eXBlLmFkZDI9ZnVuY3Rpb24ocmluZyl7dGhpcy5zZXRCYXNlUG9pbnQocmluZ1swXSk7dGhpcy5hZGRTaGVsbChyaW5nKTt9O2pzdHMuYWxnb3JpdGhtLkNlbnRyb2lkQXJlYS5wcm90b3R5cGUuZ2V0Q2VudHJvaWQ9ZnVuY3Rpb24oKXt2YXIgY2VudD1uZXcganN0cy5nZW9tLkNvb3JkaW5hdGUoKTtpZihNYXRoLmFicyh0aGlzLmFyZWFzdW0yKT4wLjApe2NlbnQueD10aGlzLmNnMy54LzMvdGhpcy5hcmVhc3VtMjtjZW50Lnk9dGhpcy5jZzMueS8zL3RoaXMuYXJlYXN1bTI7fWVsc2V7Y2VudC54PXRoaXMuY2VudFN1bS54L3RoaXMudG90YWxMZW5ndGg7Y2VudC55PXRoaXMuY2VudFN1bS55L3RoaXMudG90YWxMZW5ndGg7fVxucmV0dXJuIGNlbnQ7fTtqc3RzLmFsZ29yaXRobS5DZW50cm9pZEFyZWEucHJvdG90eXBlLnNldEJhc2VQb2ludD1mdW5jdGlvbihiYXNlUHQpe2lmKHRoaXMuYmFzZVB0PT1udWxsKVxudGhpcy5iYXNlUHQ9YmFzZVB0O307anN0cy5hbGdvcml0aG0uQ2VudHJvaWRBcmVhLnByb3RvdHlwZS5hZGQzPWZ1bmN0aW9uKHBvbHkpe3RoaXMuYWRkU2hlbGwocG9seS5nZXRFeHRlcmlvclJpbmcoKS5nZXRDb29yZGluYXRlcygpKTtmb3IodmFyIGk9MDtpPHBvbHkuZ2V0TnVtSW50ZXJpb3JSaW5nKCk7aSsrKXt0aGlzLmFkZEhvbGUocG9seS5nZXRJbnRlcmlvclJpbmdOKGkpLmdldENvb3JkaW5hdGVzKCkpO319O2pzdHMuYWxnb3JpdGhtLkNlbnRyb2lkQXJlYS5wcm90b3R5cGUuYWRkU2hlbGw9ZnVuY3Rpb24ocHRzKXt2YXIgaXNQb3NpdGl2ZUFyZWE9IWpzdHMuYWxnb3JpdGhtLkNHQWxnb3JpdGhtcy5pc0NDVyhwdHMpO2Zvcih2YXIgaT0wO2k8cHRzLmxlbmd0aC0xO2krKyl7dGhpcy5hZGRUcmlhbmdsZSh0aGlzLmJhc2VQdCxwdHNbaV0scHRzW2krMV0saXNQb3NpdGl2ZUFyZWEpO31cbnRoaXMuYWRkTGluZWFyU2VnbWVudHMocHRzKTt9O2pzdHMuYWxnb3JpdGhtLkNlbnRyb2lkQXJlYS5wcm90b3R5cGUuYWRkSG9sZT1mdW5jdGlvbihwdHMpe3ZhciBpc1Bvc2l0aXZlQXJlYT1qc3RzLmFsZ29yaXRobS5DR0FsZ29yaXRobXMuaXNDQ1cocHRzKTtmb3IodmFyIGk9MDtpPHB0cy5sZW5ndGgtMTtpKyspe3RoaXMuYWRkVHJpYW5nbGUodGhpcy5iYXNlUHQscHRzW2ldLHB0c1tpKzFdLGlzUG9zaXRpdmVBcmVhKTt9XG50aGlzLmFkZExpbmVhclNlZ21lbnRzKHB0cyk7fTtqc3RzLmFsZ29yaXRobS5DZW50cm9pZEFyZWEucHJvdG90eXBlLmFkZFRyaWFuZ2xlPWZ1bmN0aW9uKHAwLHAxLHAyLGlzUG9zaXRpdmVBcmVhKXt2YXIgc2lnbj0oaXNQb3NpdGl2ZUFyZWEpPzEuMDotMS4wO2pzdHMuYWxnb3JpdGhtLkNlbnRyb2lkQXJlYS5jZW50cm9pZDMocDAscDEscDIsdGhpcy50cmlhbmdsZUNlbnQzKTt2YXIgYXJlYTI9anN0cy5hbGdvcml0aG0uQ2VudHJvaWRBcmVhLmFyZWEyKHAwLHAxLHAyKTt0aGlzLmNnMy54Kz1zaWduKmFyZWEyKnRoaXMudHJpYW5nbGVDZW50My54O3RoaXMuY2czLnkrPXNpZ24qYXJlYTIqdGhpcy50cmlhbmdsZUNlbnQzLnk7dGhpcy5hcmVhc3VtMis9c2lnbiphcmVhMjt9O2pzdHMuYWxnb3JpdGhtLkNlbnRyb2lkQXJlYS5jZW50cm9pZDM9ZnVuY3Rpb24ocDEscDIscDMsYyl7Yy54PXAxLngrcDIueCtwMy54O2MueT1wMS55K3AyLnkrcDMueTtyZXR1cm47fTtqc3RzLmFsZ29yaXRobS5DZW50cm9pZEFyZWEuYXJlYTI9ZnVuY3Rpb24ocDEscDIscDMpe3JldHVybihwMi54LXAxLngpKihwMy55LXAxLnkpLShwMy54LXAxLngpKihwMi55LXAxLnkpO307anN0cy5hbGdvcml0aG0uQ2VudHJvaWRBcmVhLnByb3RvdHlwZS5hZGRMaW5lYXJTZWdtZW50cz1mdW5jdGlvbihwdHMpe2Zvcih2YXIgaT0wO2k8cHRzLmxlbmd0aC0xO2krKyl7dmFyIHNlZ21lbnRMZW49cHRzW2ldLmRpc3RhbmNlKHB0c1tpKzFdKTt0aGlzLnRvdGFsTGVuZ3RoKz1zZWdtZW50TGVuO3ZhciBtaWR4PShwdHNbaV0ueCtwdHNbaSsxXS54KS8yO3RoaXMuY2VudFN1bS54Kz1zZWdtZW50TGVuKm1pZHg7dmFyIG1pZHk9KHB0c1tpXS55K3B0c1tpKzFdLnkpLzI7dGhpcy5jZW50U3VtLnkrPXNlZ21lbnRMZW4qbWlkeTt9fTtqc3RzLmdlb21ncmFwaC5pbmRleC5Td2VlcExpbmVTZWdtZW50PWZ1bmN0aW9uKGVkZ2UscHRJbmRleCl7dGhpcy5lZGdlPWVkZ2U7dGhpcy5wdEluZGV4PXB0SW5kZXg7dGhpcy5wdHM9ZWRnZS5nZXRDb29yZGluYXRlcygpO307anN0cy5nZW9tZ3JhcGguaW5kZXguU3dlZXBMaW5lU2VnbWVudC5wcm90b3R5cGUuZWRnZT1udWxsO2pzdHMuZ2VvbWdyYXBoLmluZGV4LlN3ZWVwTGluZVNlZ21lbnQucHJvdG90eXBlLnB0cz1udWxsO2pzdHMuZ2VvbWdyYXBoLmluZGV4LlN3ZWVwTGluZVNlZ21lbnQucHJvdG90eXBlLnB0SW5kZXg9bnVsbDtqc3RzLmdlb21ncmFwaC5pbmRleC5Td2VlcExpbmVTZWdtZW50LnByb3RvdHlwZS5nZXRNaW5YPWZ1bmN0aW9uKCl7dmFyIHgxPXRoaXMucHRzW3RoaXMucHRJbmRleF0ueDt2YXIgeDI9dGhpcy5wdHNbdGhpcy5wdEluZGV4KzFdLng7aWYoeDE8eDIpe3JldHVybiB4MTt9XG5yZXR1cm4geDI7fTtqc3RzLmdlb21ncmFwaC5pbmRleC5Td2VlcExpbmVTZWdtZW50LnByb3RvdHlwZS5nZXRNYXhYPWZ1bmN0aW9uKCl7dmFyIHgxPXRoaXMucHRzW3RoaXMucHRJbmRleF0ueDt2YXIgeDI9dGhpcy5wdHNbdGhpcy5wdEluZGV4KzFdLng7aWYoeDE+eDIpe3JldHVybiB4MTt9XG5yZXR1cm4geDI7fTtqc3RzLmdlb21ncmFwaC5pbmRleC5Td2VlcExpbmVTZWdtZW50LnByb3RvdHlwZS5jb21wdXRlSW50ZXJzZWN0aW9ucz1mdW5jdGlvbihzcyxzaSl7c2kuYWRkSW50ZXJzZWN0aW9ucyh0aGlzLmVkZ2UsdGhpcy5wdEluZGV4LHNzLmVkZ2Usc3MucHRJbmRleCk7fTtqc3RzLmluZGV4LnF1YWR0cmVlLlJvb3Q9ZnVuY3Rpb24oKXtqc3RzLmluZGV4LnF1YWR0cmVlLk5vZGVCYXNlLnByb3RvdHlwZS5jb25zdHJ1Y3Rvci5hcHBseSh0aGlzLGFyZ3VtZW50cyk7dGhpcy5vcmlnaW49bmV3IGpzdHMuZ2VvbS5Db29yZGluYXRlKDAuMCwwLjApO307anN0cy5pbmRleC5xdWFkdHJlZS5Sb290LnByb3RvdHlwZT1uZXcganN0cy5pbmRleC5xdWFkdHJlZS5Ob2RlQmFzZSgpO2pzdHMuaW5kZXgucXVhZHRyZWUuUm9vdC5wcm90b3R5cGUuaW5zZXJ0PWZ1bmN0aW9uKGl0ZW1FbnYsaXRlbSl7dmFyIGluZGV4PXRoaXMuZ2V0U3Vibm9kZUluZGV4KGl0ZW1FbnYsdGhpcy5vcmlnaW4pO2lmKGluZGV4PT09LTEpe3RoaXMuYWRkKGl0ZW0pO3JldHVybjt9XG52YXIgbm9kZT10aGlzLnN1Ym5vZGVbaW5kZXhdO2lmKG5vZGU9PT1udWxsfHwhbm9kZS5nZXRFbnZlbG9wZSgpLmNvbnRhaW5zKGl0ZW1FbnYpKXt2YXIgbGFyZ2VyTm9kZT1qc3RzLmluZGV4LnF1YWR0cmVlLk5vZGUuY3JlYXRlRXhwYW5kZWQobm9kZSxpdGVtRW52KTt0aGlzLnN1Ym5vZGVbaW5kZXhdPWxhcmdlck5vZGU7fVxudGhpcy5pbnNlcnRDb250YWluZWQodGhpcy5zdWJub2RlW2luZGV4XSxpdGVtRW52LGl0ZW0pO307anN0cy5pbmRleC5xdWFkdHJlZS5Sb290LnByb3RvdHlwZS5pbnNlcnRDb250YWluZWQ9ZnVuY3Rpb24odHJlZSxpdGVtRW52LGl0ZW0pe3ZhciBpc1plcm9YLGlzWmVyb1ksbm9kZTtpc1plcm9YPWpzdHMuaW5kZXguSW50ZXJ2YWxTaXplLmlzWmVyb1dpZHRoKGl0ZW1FbnYuZ2V0TWluWCgpLGl0ZW1FbnYuZ2V0TWF4WCgpKTtpc1plcm9ZPWpzdHMuaW5kZXguSW50ZXJ2YWxTaXplLmlzWmVyb1dpZHRoKGl0ZW1FbnYuZ2V0TWluWSgpLGl0ZW1FbnYuZ2V0TWF4WSgpKTtpZihpc1plcm9YfHxpc1plcm9ZKXtub2RlPXRyZWUuZmluZChpdGVtRW52KTt9ZWxzZXtub2RlPXRyZWUuZ2V0Tm9kZShpdGVtRW52KTt9XG5ub2RlLmFkZChpdGVtKTt9O2pzdHMuaW5kZXgucXVhZHRyZWUuUm9vdC5wcm90b3R5cGUuaXNTZWFyY2hNYXRjaD1mdW5jdGlvbihzZWFyY2hFbnYpe3JldHVybiB0cnVlO307anN0cy5nZW9tZ3JhcGguaW5kZXguTW9ub3RvbmVDaGFpbkluZGV4ZXI9ZnVuY3Rpb24oKXt9O2pzdHMuZ2VvbWdyYXBoLmluZGV4Lk1vbm90b25lQ2hhaW5JbmRleGVyLnRvSW50QXJyYXk9ZnVuY3Rpb24obGlzdCl7dmFyIGFycmF5PVtdO2Zvcih2YXIgaT1saXN0Lml0ZXJhdG9yKCk7aS5oYXNOZXh0KCk7KXt2YXIgZWxlbWVudD1pLm5leHQoKTthcnJheS5wdXNoKGVsZW1lbnQpO31cbnJldHVybiBhcnJheTt9O2pzdHMuZ2VvbWdyYXBoLmluZGV4Lk1vbm90b25lQ2hhaW5JbmRleGVyLnByb3RvdHlwZS5nZXRDaGFpblN0YXJ0SW5kaWNlcz1mdW5jdGlvbihwdHMpe3ZhciBzdGFydD0wO3ZhciBzdGFydEluZGV4TGlzdD1uZXcgamF2YXNjcmlwdC51dGlsLkFycmF5TGlzdCgpO3N0YXJ0SW5kZXhMaXN0LmFkZChzdGFydCk7ZG97dmFyIGxhc3Q9dGhpcy5maW5kQ2hhaW5FbmQocHRzLHN0YXJ0KTtzdGFydEluZGV4TGlzdC5hZGQobGFzdCk7c3RhcnQ9bGFzdDt9d2hpbGUoc3RhcnQ8cHRzLmxlbmd0aC0xKTt2YXIgc3RhcnRJbmRleD1qc3RzLmdlb21ncmFwaC5pbmRleC5Nb25vdG9uZUNoYWluSW5kZXhlci50b0ludEFycmF5KHN0YXJ0SW5kZXhMaXN0KTtyZXR1cm4gc3RhcnRJbmRleDt9O2pzdHMuZ2VvbWdyYXBoLmluZGV4Lk1vbm90b25lQ2hhaW5JbmRleGVyLnByb3RvdHlwZS5maW5kQ2hhaW5FbmQ9ZnVuY3Rpb24ocHRzLHN0YXJ0KXt2YXIgY2hhaW5RdWFkPWpzdHMuZ2VvbWdyYXBoLlF1YWRyYW50LnF1YWRyYW50KHB0c1tzdGFydF0scHRzW3N0YXJ0KzFdKTt2YXIgbGFzdD1zdGFydCsxO3doaWxlKGxhc3Q8cHRzLmxlbmd0aCl7dmFyIHF1YWQ9anN0cy5nZW9tZ3JhcGguUXVhZHJhbnQucXVhZHJhbnQocHRzW2xhc3QtMV0scHRzW2xhc3RdKTtpZihxdWFkIT1jaGFpblF1YWQpe2JyZWFrO31cbmxhc3QrKzt9XG5yZXR1cm4gbGFzdC0xO307anN0cy5ub2RpbmcuSW50ZXJzZWN0aW9uQWRkZXI9ZnVuY3Rpb24obGkpe3RoaXMubGk9bGk7fTtqc3RzLm5vZGluZy5JbnRlcnNlY3Rpb25BZGRlci5wcm90b3R5cGU9bmV3IGpzdHMubm9kaW5nLlNlZ21lbnRJbnRlcnNlY3RvcigpO2pzdHMubm9kaW5nLkludGVyc2VjdGlvbkFkZGVyLmNvbnN0cnVjdG9yPWpzdHMubm9kaW5nLkludGVyc2VjdGlvbkFkZGVyO2pzdHMubm9kaW5nLkludGVyc2VjdGlvbkFkZGVyLmlzQWRqYWNlbnRTZWdtZW50cz1mdW5jdGlvbihpMSxpMil7cmV0dXJuIE1hdGguYWJzKGkxLWkyKT09PTE7fTtqc3RzLm5vZGluZy5JbnRlcnNlY3Rpb25BZGRlci5wcm90b3R5cGUuX2hhc0ludGVyc2VjdGlvbj1mYWxzZTtqc3RzLm5vZGluZy5JbnRlcnNlY3Rpb25BZGRlci5wcm90b3R5cGUuaGFzUHJvcGVyPWZhbHNlO2pzdHMubm9kaW5nLkludGVyc2VjdGlvbkFkZGVyLnByb3RvdHlwZS5oYXNQcm9wZXJJbnRlcmlvcj1mYWxzZTtqc3RzLm5vZGluZy5JbnRlcnNlY3Rpb25BZGRlci5wcm90b3R5cGUuaGFzSW50ZXJpb3I9ZmFsc2U7anN0cy5ub2RpbmcuSW50ZXJzZWN0aW9uQWRkZXIucHJvdG90eXBlLnByb3BlckludGVyc2VjdGlvblBvaW50PW51bGw7anN0cy5ub2RpbmcuSW50ZXJzZWN0aW9uQWRkZXIucHJvdG90eXBlLmxpPW51bGw7anN0cy5ub2RpbmcuSW50ZXJzZWN0aW9uQWRkZXIucHJvdG90eXBlLmlzU2VsZkludGVyc2VjdGlvbj1udWxsO2pzdHMubm9kaW5nLkludGVyc2VjdGlvbkFkZGVyLnByb3RvdHlwZS5udW1JbnRlcnNlY3Rpb25zPTA7anN0cy5ub2RpbmcuSW50ZXJzZWN0aW9uQWRkZXIucHJvdG90eXBlLm51bUludGVyaW9ySW50ZXJzZWN0aW9ucz0wO2pzdHMubm9kaW5nLkludGVyc2VjdGlvbkFkZGVyLnByb3RvdHlwZS5udW1Qcm9wZXJJbnRlcnNlY3Rpb25zPTA7anN0cy5ub2RpbmcuSW50ZXJzZWN0aW9uQWRkZXIucHJvdG90eXBlLm51bVRlc3RzPTA7anN0cy5ub2RpbmcuSW50ZXJzZWN0aW9uQWRkZXIucHJvdG90eXBlLmdldExpbmVJbnRlcnNlY3Rvcj1mdW5jdGlvbigpe3JldHVybiB0aGlzLmxpO307anN0cy5ub2RpbmcuSW50ZXJzZWN0aW9uQWRkZXIucHJvdG90eXBlLmdldFByb3BlckludGVyc2VjdGlvblBvaW50PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMucHJvcGVySW50ZXJzZWN0aW9uUG9pbnQ7fTtqc3RzLm5vZGluZy5JbnRlcnNlY3Rpb25BZGRlci5wcm90b3R5cGUuaGFzSW50ZXJzZWN0aW9uPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2hhc0ludGVyc2VjdGlvbjt9O2pzdHMubm9kaW5nLkludGVyc2VjdGlvbkFkZGVyLnByb3RvdHlwZS5oYXNQcm9wZXJJbnRlcnNlY3Rpb249ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5oYXNQcm9wZXI7fTtqc3RzLm5vZGluZy5JbnRlcnNlY3Rpb25BZGRlci5wcm90b3R5cGUuaGFzUHJvcGVySW50ZXJpb3JJbnRlcnNlY3Rpb249ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5oYXNQcm9wZXJJbnRlcmlvcjt9O2pzdHMubm9kaW5nLkludGVyc2VjdGlvbkFkZGVyLnByb3RvdHlwZS5oYXNJbnRlcmlvckludGVyc2VjdGlvbj1mdW5jdGlvbigpe3JldHVybiB0aGlzLmhhc0ludGVyaW9yO307anN0cy5ub2RpbmcuSW50ZXJzZWN0aW9uQWRkZXIucHJvdG90eXBlLmlzVHJpdmlhbEludGVyc2VjdGlvbj1mdW5jdGlvbihlMCxzZWdJbmRleDAsZTEsc2VnSW5kZXgxKXtpZihlMD09ZTEpe2lmKHRoaXMubGkuZ2V0SW50ZXJzZWN0aW9uTnVtKCk9PTEpe2lmKGpzdHMubm9kaW5nLkludGVyc2VjdGlvbkFkZGVyLmlzQWRqYWNlbnRTZWdtZW50cyhzZWdJbmRleDAsc2VnSW5kZXgxKSlcbnJldHVybiB0cnVlO2lmKGUwLmlzQ2xvc2VkKCkpe3ZhciBtYXhTZWdJbmRleD1lMC5zaXplKCktMTtpZigoc2VnSW5kZXgwPT09MCYmc2VnSW5kZXgxPT09bWF4U2VnSW5kZXgpfHwoc2VnSW5kZXgxPT09MCYmc2VnSW5kZXgwPT09bWF4U2VnSW5kZXgpKXtyZXR1cm4gdHJ1ZTt9fX19XG5yZXR1cm4gZmFsc2U7fTtqc3RzLm5vZGluZy5JbnRlcnNlY3Rpb25BZGRlci5wcm90b3R5cGUucHJvY2Vzc0ludGVyc2VjdGlvbnM9ZnVuY3Rpb24oZTAsc2VnSW5kZXgwLGUxLHNlZ0luZGV4MSl7aWYoZTA9PT1lMSYmc2VnSW5kZXgwPT09c2VnSW5kZXgxKVxucmV0dXJuO3RoaXMubnVtVGVzdHMrKzt2YXIgcDAwPWUwLmdldENvb3JkaW5hdGVzKClbc2VnSW5kZXgwXTt2YXIgcDAxPWUwLmdldENvb3JkaW5hdGVzKClbc2VnSW5kZXgwKzFdO3ZhciBwMTA9ZTEuZ2V0Q29vcmRpbmF0ZXMoKVtzZWdJbmRleDFdO3ZhciBwMTE9ZTEuZ2V0Q29vcmRpbmF0ZXMoKVtzZWdJbmRleDErMV07dGhpcy5saS5jb21wdXRlSW50ZXJzZWN0aW9uKHAwMCxwMDEscDEwLHAxMSk7aWYodGhpcy5saS5oYXNJbnRlcnNlY3Rpb24oKSl7dGhpcy5udW1JbnRlcnNlY3Rpb25zKys7aWYodGhpcy5saS5pc0ludGVyaW9ySW50ZXJzZWN0aW9uKCkpe3RoaXMubnVtSW50ZXJpb3JJbnRlcnNlY3Rpb25zKys7dGhpcy5oYXNJbnRlcmlvcj10cnVlO31cbmlmKCF0aGlzLmlzVHJpdmlhbEludGVyc2VjdGlvbihlMCxzZWdJbmRleDAsZTEsc2VnSW5kZXgxKSl7dGhpcy5faGFzSW50ZXJzZWN0aW9uPXRydWU7ZTAuYWRkSW50ZXJzZWN0aW9ucyh0aGlzLmxpLHNlZ0luZGV4MCwwKTtlMS5hZGRJbnRlcnNlY3Rpb25zKHRoaXMubGksc2VnSW5kZXgxLDEpO2lmKHRoaXMubGkuaXNQcm9wZXIoKSl7dGhpcy5udW1Qcm9wZXJJbnRlcnNlY3Rpb25zKys7dGhpcy5oYXNQcm9wZXI9dHJ1ZTt0aGlzLmhhc1Byb3BlckludGVyaW9yPXRydWU7fX19fTtqc3RzLm5vZGluZy5JbnRlcnNlY3Rpb25BZGRlci5wcm90b3R5cGUuaXNEb25lPWZ1bmN0aW9uKCl7cmV0dXJuIGZhbHNlO307anN0cy5vcGVyYXRpb24udW5pb24uQ2FzY2FkZWRQb2x5Z29uVW5pb249ZnVuY3Rpb24ocG9seXMpe3RoaXMuaW5wdXRQb2x5cz1wb2x5czt9O2pzdHMub3BlcmF0aW9uLnVuaW9uLkNhc2NhZGVkUG9seWdvblVuaW9uLnVuaW9uPWZ1bmN0aW9uKHBvbHlzKXt2YXIgb3A9bmV3IGpzdHMub3BlcmF0aW9uLnVuaW9uLkNhc2NhZGVkUG9seWdvblVuaW9uKHBvbHlzKTtyZXR1cm4gb3AudW5pb24oKTt9O2pzdHMub3BlcmF0aW9uLnVuaW9uLkNhc2NhZGVkUG9seWdvblVuaW9uLnByb3RvdHlwZS5pbnB1dFBvbHlzO2pzdHMub3BlcmF0aW9uLnVuaW9uLkNhc2NhZGVkUG9seWdvblVuaW9uLnByb3RvdHlwZS5nZW9tRmFjdG9yeT1udWxsO2pzdHMub3BlcmF0aW9uLnVuaW9uLkNhc2NhZGVkUG9seWdvblVuaW9uLnByb3RvdHlwZS5TVFJUUkVFX05PREVfQ0FQQUNJVFk9NDtqc3RzLm9wZXJhdGlvbi51bmlvbi5DYXNjYWRlZFBvbHlnb25Vbmlvbi5wcm90b3R5cGUudW5pb249ZnVuY3Rpb24oKXtpZih0aGlzLmlucHV0UG9seXMubGVuZ3RoPT09MCl7cmV0dXJuIG51bGw7fVxudGhpcy5nZW9tRmFjdG9yeT10aGlzLmlucHV0UG9seXNbMF0uZ2V0RmFjdG9yeSgpO3ZhciBpbmRleD1uZXcganN0cy5pbmRleC5zdHJ0cmVlLlNUUnRyZWUodGhpcy5TVFJUUkVFX05PREVfQ0FQQUNJVFkpO2Zvcih2YXIgaT0wLGw9dGhpcy5pbnB1dFBvbHlzLmxlbmd0aDtpPGw7aSsrKXt2YXIgaXRlbT10aGlzLmlucHV0UG9seXNbaV07aW5kZXguaW5zZXJ0KGl0ZW0uZ2V0RW52ZWxvcGVJbnRlcm5hbCgpLGl0ZW0pO31cbnZhciBpdGVtVHJlZT1pbmRleC5pdGVtc1RyZWUoKTt2YXIgdW5pb25BbGw9dGhpcy51bmlvblRyZWUoaXRlbVRyZWUpO3JldHVybiB1bmlvbkFsbDt9O2pzdHMub3BlcmF0aW9uLnVuaW9uLkNhc2NhZGVkUG9seWdvblVuaW9uLnByb3RvdHlwZS51bmlvblRyZWU9ZnVuY3Rpb24oZ2VvbVRyZWUpe3ZhciBnZW9tcz10aGlzLnJlZHVjZVRvR2VvbWV0cmllcyhnZW9tVHJlZSk7dmFyIHVuaW9uPXRoaXMuYmluYXJ5VW5pb24oZ2VvbXMpO3JldHVybiB1bmlvbjt9O2pzdHMub3BlcmF0aW9uLnVuaW9uLkNhc2NhZGVkUG9seWdvblVuaW9uLnByb3RvdHlwZS5iaW5hcnlVbmlvbj1mdW5jdGlvbihnZW9tcyxzdGFydCxlbmQpe3N0YXJ0PXN0YXJ0fHwwO2VuZD1lbmR8fGdlb21zLmxlbmd0aDtpZihlbmQtc3RhcnQ8PTEpe3ZhciBnMD10aGlzLmdldEdlb21ldHJ5KGdlb21zLHN0YXJ0KTtyZXR1cm4gdGhpcy51bmlvblNhZmUoZzAsbnVsbCk7fVxuZWxzZSBpZihlbmQtc3RhcnQ9PT0yKXtyZXR1cm4gdGhpcy51bmlvblNhZmUodGhpcy5nZXRHZW9tZXRyeShnZW9tcyxzdGFydCksdGhpcy5nZXRHZW9tZXRyeShnZW9tcyxzdGFydCsxKSk7fVxuZWxzZXt2YXIgbWlkPXBhcnNlSW50KChlbmQrc3RhcnQpLzIpO3ZhciBnMD10aGlzLmJpbmFyeVVuaW9uKGdlb21zLHN0YXJ0LG1pZCk7dmFyIGcxPXRoaXMuYmluYXJ5VW5pb24oZ2VvbXMsbWlkLGVuZCk7cmV0dXJuIHRoaXMudW5pb25TYWZlKGcwLGcxKTt9fTtqc3RzLm9wZXJhdGlvbi51bmlvbi5DYXNjYWRlZFBvbHlnb25Vbmlvbi5wcm90b3R5cGUuZ2V0R2VvbWV0cnk9ZnVuY3Rpb24obGlzdCxpbmRleCl7aWYoaW5kZXg+PWxpc3QubGVuZ3RoKXtyZXR1cm4gbnVsbDt9XG5yZXR1cm4gbGlzdFtpbmRleF07fTtqc3RzLm9wZXJhdGlvbi51bmlvbi5DYXNjYWRlZFBvbHlnb25Vbmlvbi5wcm90b3R5cGUucmVkdWNlVG9HZW9tZXRyaWVzPWZ1bmN0aW9uKGdlb21UcmVlKXt2YXIgZ2VvbXM9W107Zm9yKHZhciBpPTAsbD1nZW9tVHJlZS5sZW5ndGg7aTxsO2krKyl7dmFyIG89Z2VvbVRyZWVbaV0sZ2VvbT1udWxsO2lmKG8gaW5zdGFuY2VvZiBBcnJheSl7Z2VvbT10aGlzLnVuaW9uVHJlZShvKTt9XG5lbHNlIGlmKG8gaW5zdGFuY2VvZiBqc3RzLmdlb20uR2VvbWV0cnkpe2dlb209bzt9XG5nZW9tcy5wdXNoKGdlb20pO31cbnJldHVybiBnZW9tczt9O2pzdHMub3BlcmF0aW9uLnVuaW9uLkNhc2NhZGVkUG9seWdvblVuaW9uLnByb3RvdHlwZS51bmlvblNhZmU9ZnVuY3Rpb24oZzAsZzEpe2lmKGcwPT09bnVsbCYmZzE9PT1udWxsKXtyZXR1cm4gbnVsbDt9XG5pZihnMD09PW51bGwpe3JldHVybiBnMS5jbG9uZSgpO31cbmlmKGcxPT09bnVsbCl7cmV0dXJuIGcwLmNsb25lKCk7fVxucmV0dXJuIHRoaXMudW5pb25PcHRpbWl6ZWQoZzAsZzEpO307anN0cy5vcGVyYXRpb24udW5pb24uQ2FzY2FkZWRQb2x5Z29uVW5pb24ucHJvdG90eXBlLnVuaW9uT3B0aW1pemVkPWZ1bmN0aW9uKGcwLGcxKXt2YXIgZzBFbnY9ZzAuZ2V0RW52ZWxvcGVJbnRlcm5hbCgpLGcxRW52PWcxLmdldEVudmVsb3BlSW50ZXJuYWwoKTtpZighZzBFbnYuaW50ZXJzZWN0cyhnMUVudikpe3ZhciBjb21ibz1qc3RzLmdlb20udXRpbC5HZW9tZXRyeUNvbWJpbmVyLmNvbWJpbmUoZzAsZzEpO3JldHVybiBjb21ibzt9XG5pZihnMC5nZXROdW1HZW9tZXRyaWVzPD0xJiZnMS5nZXROdW1HZW9tZXRyaWVzPD0xKXtyZXR1cm4gdGhpcy51bmlvbkFjdHVhbChnMCxnMSk7fVxudmFyIGNvbW1vbkVudj1nMEVudi5pbnRlcnNlY3Rpb24oZzFFbnYpO3JldHVybiB0aGlzLnVuaW9uVXNpbmdFbnZlbG9wZUludGVyc2VjdGlvbihnMCxnMSxjb21tb25FbnYpO307anN0cy5vcGVyYXRpb24udW5pb24uQ2FzY2FkZWRQb2x5Z29uVW5pb24ucHJvdG90eXBlLnVuaW9uVXNpbmdFbnZlbG9wZUludGVyc2VjdGlvbj1mdW5jdGlvbihnMCxnMSxjb21tb24pe3ZhciBkaXNqb2ludFBvbHlzPW5ldyBqYXZhc2NyaXB0LnV0aWwuQXJyYXlMaXN0KCk7dmFyIGcwSW50PXRoaXMuZXh0cmFjdEJ5RW52ZWxvcGUoY29tbW9uLGcwLGRpc2pvaW50UG9seXMpO3ZhciBnMUludD10aGlzLmV4dHJhY3RCeUVudmVsb3BlKGNvbW1vbixnMSxkaXNqb2ludFBvbHlzKTt2YXIgdW5pb249dGhpcy51bmlvbkFjdHVhbChnMEludCxnMUludCk7ZGlzam9pbnRQb2x5cy5hZGQodW5pb24pO3ZhciBvdmVyYWxsVW5pb249anN0cy5nZW9tLnV0aWwuR2VvbWV0cnlDb21iaW5lci5jb21iaW5lKGRpc2pvaW50UG9seXMpO3JldHVybiBvdmVyYWxsVW5pb247fTtqc3RzLm9wZXJhdGlvbi51bmlvbi5DYXNjYWRlZFBvbHlnb25Vbmlvbi5wcm90b3R5cGUuZXh0cmFjdEJ5RW52ZWxvcGU9ZnVuY3Rpb24oZW52LGdlb20sZGlzam9pbnRHZW9tcyl7dmFyIGludGVyc2VjdGluZ0dlb21zPW5ldyBqYXZhc2NyaXB0LnV0aWwuQXJyYXlMaXN0KCk7Zm9yKHZhciBpPTA7aTxnZW9tLmdldE51bUdlb21ldHJpZXMoKTtpKyspe3ZhciBlbGVtPWdlb20uZ2V0R2VvbWV0cnlOKGkpO2lmKGVsZW0uZ2V0RW52ZWxvcGVJbnRlcm5hbCgpLmludGVyc2VjdHMoZW52KSl7aW50ZXJzZWN0aW5nR2VvbXMuYWRkKGVsZW0pO31cbmVsc2V7ZGlzam9pbnRHZW9tcy5hZGQoZWxlbSk7fX1cbnJldHVybiB0aGlzLmdlb21GYWN0b3J5LmJ1aWxkR2VvbWV0cnkoaW50ZXJzZWN0aW5nR2VvbXMpO307anN0cy5vcGVyYXRpb24udW5pb24uQ2FzY2FkZWRQb2x5Z29uVW5pb24ucHJvdG90eXBlLnVuaW9uQWN0dWFsPWZ1bmN0aW9uKGcwLGcxKXtyZXR1cm4gZzAudW5pb24oZzEpO307KGZ1bmN0aW9uKCl7anN0cy5nZW9tLk11bHRpUG9pbnQ9ZnVuY3Rpb24ocG9pbnRzLGZhY3Rvcnkpe3RoaXMuZ2VvbWV0cmllcz1wb2ludHN8fFtdO3RoaXMuZmFjdG9yeT1mYWN0b3J5O307anN0cy5nZW9tLk11bHRpUG9pbnQucHJvdG90eXBlPW5ldyBqc3RzLmdlb20uR2VvbWV0cnlDb2xsZWN0aW9uKCk7anN0cy5nZW9tLk11bHRpUG9pbnQuY29uc3RydWN0b3I9anN0cy5nZW9tLk11bHRpUG9pbnQ7anN0cy5nZW9tLk11bHRpUG9pbnQucHJvdG90eXBlLmdldEJvdW5kYXJ5PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZ2V0RmFjdG9yeSgpLmNyZWF0ZUdlb21ldHJ5Q29sbGVjdGlvbihudWxsKTt9O2pzdHMuZ2VvbS5NdWx0aVBvaW50LnByb3RvdHlwZS5nZXRHZW9tZXRyeU49ZnVuY3Rpb24obil7cmV0dXJuIHRoaXMuZ2VvbWV0cmllc1tuXTt9O2pzdHMuZ2VvbS5NdWx0aVBvaW50LnByb3RvdHlwZS5lcXVhbHNFeGFjdD1mdW5jdGlvbihvdGhlcix0b2xlcmFuY2Upe2lmKCF0aGlzLmlzRXF1aXZhbGVudENsYXNzKG90aGVyKSl7cmV0dXJuIGZhbHNlO31cbnJldHVybiBqc3RzLmdlb20uR2VvbWV0cnlDb2xsZWN0aW9uLnByb3RvdHlwZS5lcXVhbHNFeGFjdC5jYWxsKHRoaXMsb3RoZXIsdG9sZXJhbmNlKTt9O2pzdHMuZ2VvbS5NdWx0aVBvaW50LnByb3RvdHlwZS5DTEFTU19OQU1FPSdqc3RzLmdlb20uTXVsdGlQb2ludCc7fSkoKTtqc3RzLm9wZXJhdGlvbi5idWZmZXIuT2Zmc2V0Q3VydmVCdWlsZGVyPWZ1bmN0aW9uKHByZWNpc2lvbk1vZGVsLGJ1ZlBhcmFtcyl7dGhpcy5wcmVjaXNpb25Nb2RlbD1wcmVjaXNpb25Nb2RlbDt0aGlzLmJ1ZlBhcmFtcz1idWZQYXJhbXM7fTtqc3RzLm9wZXJhdGlvbi5idWZmZXIuT2Zmc2V0Q3VydmVCdWlsZGVyLnByb3RvdHlwZS5kaXN0YW5jZT0wLjA7anN0cy5vcGVyYXRpb24uYnVmZmVyLk9mZnNldEN1cnZlQnVpbGRlci5wcm90b3R5cGUucHJlY2lzaW9uTW9kZWw9bnVsbDtqc3RzLm9wZXJhdGlvbi5idWZmZXIuT2Zmc2V0Q3VydmVCdWlsZGVyLnByb3RvdHlwZS5idWZQYXJhbXM9bnVsbDtqc3RzLm9wZXJhdGlvbi5idWZmZXIuT2Zmc2V0Q3VydmVCdWlsZGVyLnByb3RvdHlwZS5nZXRCdWZmZXJQYXJhbWV0ZXJzPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuYnVmUGFyYW1zO307anN0cy5vcGVyYXRpb24uYnVmZmVyLk9mZnNldEN1cnZlQnVpbGRlci5wcm90b3R5cGUuZ2V0TGluZUN1cnZlPWZ1bmN0aW9uKGlucHV0UHRzLGRpc3RhbmNlKXt0aGlzLmRpc3RhbmNlPWRpc3RhbmNlO2lmKHRoaXMuZGlzdGFuY2U8MC4wJiYhdGhpcy5idWZQYXJhbXMuaXNTaW5nbGVTaWRlZCgpKVxucmV0dXJuIG51bGw7aWYodGhpcy5kaXN0YW5jZT09MC4wKVxucmV0dXJuIG51bGw7dmFyIHBvc0Rpc3RhbmNlPU1hdGguYWJzKHRoaXMuZGlzdGFuY2UpO3ZhciBzZWdHZW49dGhpcy5nZXRTZWdHZW4ocG9zRGlzdGFuY2UpO2lmKGlucHV0UHRzLmxlbmd0aDw9MSl7dGhpcy5jb21wdXRlUG9pbnRDdXJ2ZShpbnB1dFB0c1swXSxzZWdHZW4pO31lbHNle2lmKHRoaXMuYnVmUGFyYW1zLmlzU2luZ2xlU2lkZWQoKSl7dmFyIGlzUmlnaHRTaWRlPWRpc3RhbmNlPDAuMDt0aGlzLmNvbXB1dGVTaW5nbGVTaWRlZEJ1ZmZlckN1cnZlKGlucHV0UHRzLGlzUmlnaHRTaWRlLHNlZ0dlbik7fWVsc2VcbnRoaXMuY29tcHV0ZUxpbmVCdWZmZXJDdXJ2ZShpbnB1dFB0cyxzZWdHZW4pO31cbnZhciBsaW5lQ29vcmQ9c2VnR2VuLmdldENvb3JkaW5hdGVzKCk7cmV0dXJuIGxpbmVDb29yZDt9O2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5PZmZzZXRDdXJ2ZUJ1aWxkZXIucHJvdG90eXBlLmdldFJpbmdDdXJ2ZT1mdW5jdGlvbihpbnB1dFB0cyxzaWRlLGRpc3RhbmNlKXt0aGlzLmRpc3RhbmNlPWRpc3RhbmNlO2lmKGlucHV0UHRzLmxlbmd0aDw9MilcbnJldHVybiB0aGlzLmdldExpbmVDdXJ2ZShpbnB1dFB0cyxkaXN0YW5jZSk7aWYodGhpcy5kaXN0YW5jZT09MC4wKXtyZXR1cm4ganN0cy5vcGVyYXRpb24uYnVmZmVyLk9mZnNldEN1cnZlQnVpbGRlci5jb3B5Q29vcmRpbmF0ZXMoaW5wdXRQdHMpO31cbnZhciBzZWdHZW49dGhpcy5nZXRTZWdHZW4odGhpcy5kaXN0YW5jZSk7dGhpcy5jb21wdXRlUmluZ0J1ZmZlckN1cnZlKGlucHV0UHRzLHNpZGUsc2VnR2VuKTtyZXR1cm4gc2VnR2VuLmdldENvb3JkaW5hdGVzKCk7fTtqc3RzLm9wZXJhdGlvbi5idWZmZXIuT2Zmc2V0Q3VydmVCdWlsZGVyLnByb3RvdHlwZS5nZXRPZmZzZXRDdXJ2ZT1mdW5jdGlvbihpbnB1dFB0cyxkaXN0YW5jZSl7dGhpcy5kaXN0YW5jZT1kaXN0YW5jZTtpZih0aGlzLmRpc3RhbmNlPT09MC4wKVxucmV0dXJuIG51bGw7dmFyIGlzUmlnaHRTaWRlPXRoaXMuZGlzdGFuY2U8MC4wO3ZhciBwb3NEaXN0YW5jZT1NYXRoLmFicyh0aGlzLmRpc3RhbmNlKTt2YXIgc2VnR2VuPXRoaXMuZ2V0U2VnR2VuKHBvc0Rpc3RhbmNlKTtpZihpbnB1dFB0cy5sZW5ndGg8PTEpe3RoaXMuY29tcHV0ZVBvaW50Q3VydmUoaW5wdXRQdHNbMF0sc2VnR2VuKTt9ZWxzZXt0aGlzLmNvbXB1dGVPZmZzZXRDdXJ2ZShpbnB1dFB0cyxpc1JpZ2h0U2lkZSxzZWdHZW4pO31cbnZhciBjdXJ2ZVB0cz1zZWdHZW4uZ2V0Q29vcmRpbmF0ZXMoKTtpZihpc1JpZ2h0U2lkZSlcbmN1cnZlUHRzLnJldmVyc2UoKTtyZXR1cm4gY3VydmVQdHM7fTtqc3RzLm9wZXJhdGlvbi5idWZmZXIuT2Zmc2V0Q3VydmVCdWlsZGVyLmNvcHlDb29yZGluYXRlcz1mdW5jdGlvbihwdHMpe3ZhciBjb3B5PVtdO2Zvcih2YXIgaT0wO2k8cHRzLmxlbmd0aDtpKyspe2NvcHkucHVzaChwdHNbaV0uY2xvbmUoKSk7fVxucmV0dXJuIGNvcHk7fTtqc3RzLm9wZXJhdGlvbi5idWZmZXIuT2Zmc2V0Q3VydmVCdWlsZGVyLnByb3RvdHlwZS5nZXRTZWdHZW49ZnVuY3Rpb24oZGlzdGFuY2Upe3JldHVybiBuZXcganN0cy5vcGVyYXRpb24uYnVmZmVyLk9mZnNldFNlZ21lbnRHZW5lcmF0b3IodGhpcy5wcmVjaXNpb25Nb2RlbCx0aGlzLmJ1ZlBhcmFtcyxkaXN0YW5jZSk7fTtqc3RzLm9wZXJhdGlvbi5idWZmZXIuT2Zmc2V0Q3VydmVCdWlsZGVyLlNJTVBMSUZZX0ZBQ1RPUj0xMDAuMDtqc3RzLm9wZXJhdGlvbi5idWZmZXIuT2Zmc2V0Q3VydmVCdWlsZGVyLnNpbXBsaWZ5VG9sZXJhbmNlPWZ1bmN0aW9uKGJ1ZkRpc3RhbmNlKXtyZXR1cm4gYnVmRGlzdGFuY2UvanN0cy5vcGVyYXRpb24uYnVmZmVyLk9mZnNldEN1cnZlQnVpbGRlci5TSU1QTElGWV9GQUNUT1I7fTtqc3RzLm9wZXJhdGlvbi5idWZmZXIuT2Zmc2V0Q3VydmVCdWlsZGVyLnByb3RvdHlwZS5jb21wdXRlUG9pbnRDdXJ2ZT1mdW5jdGlvbihwdCxzZWdHZW4pe3N3aXRjaCh0aGlzLmJ1ZlBhcmFtcy5nZXRFbmRDYXBTdHlsZSgpKXtjYXNlIGpzdHMub3BlcmF0aW9uLmJ1ZmZlci5CdWZmZXJQYXJhbWV0ZXJzLkNBUF9ST1VORDpzZWdHZW4uY3JlYXRlQ2lyY2xlKHB0KTticmVhaztjYXNlIGpzdHMub3BlcmF0aW9uLmJ1ZmZlci5CdWZmZXJQYXJhbWV0ZXJzLkNBUF9TUVVBUkU6c2VnR2VuLmNyZWF0ZVNxdWFyZShwdCk7YnJlYWs7fX07anN0cy5vcGVyYXRpb24uYnVmZmVyLk9mZnNldEN1cnZlQnVpbGRlci5wcm90b3R5cGUuY29tcHV0ZUxpbmVCdWZmZXJDdXJ2ZT1mdW5jdGlvbihpbnB1dFB0cyxzZWdHZW4pe3ZhciBkaXN0VG9sPWpzdHMub3BlcmF0aW9uLmJ1ZmZlci5PZmZzZXRDdXJ2ZUJ1aWxkZXIuc2ltcGxpZnlUb2xlcmFuY2UodGhpcy5kaXN0YW5jZSk7dmFyIHNpbXAxPWpzdHMub3BlcmF0aW9uLmJ1ZmZlci5CdWZmZXJJbnB1dExpbmVTaW1wbGlmaWVyLnNpbXBsaWZ5KGlucHV0UHRzLGRpc3RUb2wpO3ZhciBuMT1zaW1wMS5sZW5ndGgtMTtzZWdHZW4uaW5pdFNpZGVTZWdtZW50cyhzaW1wMVswXSxzaW1wMVsxXSxqc3RzLmdlb21ncmFwaC5Qb3NpdGlvbi5MRUZUKTtmb3IodmFyIGk9MjtpPD1uMTtpKyspe3NlZ0dlbi5hZGROZXh0U2VnbWVudChzaW1wMVtpXSx0cnVlKTt9XG5zZWdHZW4uYWRkTGFzdFNlZ21lbnQoKTtzZWdHZW4uYWRkTGluZUVuZENhcChzaW1wMVtuMS0xXSxzaW1wMVtuMV0pO3ZhciBzaW1wMj1qc3RzLm9wZXJhdGlvbi5idWZmZXIuQnVmZmVySW5wdXRMaW5lU2ltcGxpZmllci5zaW1wbGlmeShpbnB1dFB0cywtZGlzdFRvbCk7dmFyIG4yPXNpbXAyLmxlbmd0aC0xO3NlZ0dlbi5pbml0U2lkZVNlZ21lbnRzKHNpbXAyW24yXSxzaW1wMltuMi0xXSxqc3RzLmdlb21ncmFwaC5Qb3NpdGlvbi5MRUZUKTtmb3IodmFyIGk9bjItMjtpPj0wO2ktLSl7c2VnR2VuLmFkZE5leHRTZWdtZW50KHNpbXAyW2ldLHRydWUpO31cbnNlZ0dlbi5hZGRMYXN0U2VnbWVudCgpO3NlZ0dlbi5hZGRMaW5lRW5kQ2FwKHNpbXAyWzFdLHNpbXAyWzBdKTtzZWdHZW4uY2xvc2VSaW5nKCk7fTtqc3RzLm9wZXJhdGlvbi5idWZmZXIuT2Zmc2V0Q3VydmVCdWlsZGVyLnByb3RvdHlwZS5jb21wdXRlU2luZ2xlU2lkZWRCdWZmZXJDdXJ2ZT1mdW5jdGlvbihpbnB1dFB0cyxpc1JpZ2h0U2lkZSxzZWdHZW4pe3ZhciBkaXN0VG9sPWpzdHMub3BlcmF0aW9uLmJ1ZmZlci5PZmZzZXRDdXJ2ZUJ1aWxkZXIuc2ltcGxpZnlUb2xlcmFuY2UodGhpcy5kaXN0YW5jZSk7aWYoaXNSaWdodFNpZGUpe3NlZ0dlbi5hZGRTZWdtZW50cyhpbnB1dFB0cyx0cnVlKTt2YXIgc2ltcDI9anN0cy5vcGVyYXRpb24uYnVmZmVyLkJ1ZmZlcklucHV0TGluZVNpbXBsaWZpZXIuc2ltcGxpZnkoaW5wdXRQdHMsLWRpc3RUb2wpO3ZhciBuMj1zaW1wMi5sZW5ndGgtMTtzZWdHZW4uaW5pdFNpZGVTZWdtZW50cyhzaW1wMltuMl0sc2ltcDJbbjItMV0sanN0cy5nZW9tZ3JhcGguUG9zaXRpb24uTEVGVCk7c2VnR2VuLmFkZEZpcnN0U2VnbWVudCgpO2Zvcih2YXIgaT1uMi0yO2k+PTA7aS0tKXtzZWdHZW4uYWRkTmV4dFNlZ21lbnQoc2ltcDJbaV0sdHJ1ZSk7fX1lbHNle3NlZ0dlbi5hZGRTZWdtZW50cyhpbnB1dFB0cyxmYWxzZSk7dmFyIHNpbXAxPWpzdHMub3BlcmF0aW9uLmJ1ZmZlci5CdWZmZXJJbnB1dExpbmVTaW1wbGlmaWVyLnNpbXBsaWZ5KGlucHV0UHRzLGRpc3RUb2wpO3ZhciBuMT1zaW1wMS5sZW5ndGgtMTtzZWdHZW4uaW5pdFNpZGVTZWdtZW50cyhzaW1wMVswXSxzaW1wMVsxXSxqc3RzLmdlb21ncmFwaC5Qb3NpdGlvbi5MRUZUKTtzZWdHZW4uYWRkRmlyc3RTZWdtZW50KCk7Zm9yKHZhciBpPTI7aTw9bjE7aSsrKXtzZWdHZW4uYWRkTmV4dFNlZ21lbnQoc2ltcDFbaV0sdHJ1ZSk7fX1cbnNlZ0dlbi5hZGRMYXN0U2VnbWVudCgpO3NlZ0dlbi5jbG9zZVJpbmcoKTt9O2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5PZmZzZXRDdXJ2ZUJ1aWxkZXIucHJvdG90eXBlLmNvbXB1dGVPZmZzZXRDdXJ2ZT1mdW5jdGlvbihpbnB1dFB0cyxpc1JpZ2h0U2lkZSxzZWdHZW4pe3ZhciBkaXN0VG9sPWpzdHMub3BlcmF0aW9uLmJ1ZmZlci5PZmZzZXRDdXJ2ZUJ1aWxkZXIuc2ltcGxpZnlUb2xlcmFuY2UodGhpcy5kaXN0YW5jZSk7aWYoaXNSaWdodFNpZGUpe3ZhciBzaW1wMj1qc3RzLm9wZXJhdGlvbi5idWZmZXIuQnVmZmVySW5wdXRMaW5lU2ltcGxpZmllci5zaW1wbGlmeShpbnB1dFB0cywtZGlzdFRvbCk7dmFyIG4yPXNpbXAyLmxlbmd0aC0xO3NlZ0dlbi5pbml0U2lkZVNlZ21lbnRzKHNpbXAyW24yXSxzaW1wMltuMi0xXSxqc3RzLmdlb21ncmFwaC5Qb3NpdGlvbi5MRUZUKTtzZWdHZW4uYWRkRmlyc3RTZWdtZW50KCk7Zm9yKHZhciBpPW4yLTI7aT49MDtpLS0pe3NlZ0dlbi5hZGROZXh0U2VnbWVudChzaW1wMltpXSx0cnVlKTt9fWVsc2V7dmFyIHNpbXAxPWpzdHMub3BlcmF0aW9uLmJ1ZmZlci5CdWZmZXJJbnB1dExpbmVTaW1wbGlmaWVyLnNpbXBsaWZ5KGlucHV0UHRzLGRpc3RUb2wpO3ZhciBuMT1zaW1wMS5sZW5ndGgtMTtzZWdHZW4uaW5pdFNpZGVTZWdtZW50cyhzaW1wMVswXSxzaW1wMVsxXSxqc3RzLmdlb21ncmFwaC5Qb3NpdGlvbi5MRUZUKTtzZWdHZW4uYWRkRmlyc3RTZWdtZW50KCk7Zm9yKHZhciBpPTI7aTw9bjE7aSsrKXtzZWdHZW4uYWRkTmV4dFNlZ21lbnQoc2ltcDFbaV0sdHJ1ZSk7fX1cbnNlZ0dlbi5hZGRMYXN0U2VnbWVudCgpO307anN0cy5vcGVyYXRpb24uYnVmZmVyLk9mZnNldEN1cnZlQnVpbGRlci5wcm90b3R5cGUuY29tcHV0ZVJpbmdCdWZmZXJDdXJ2ZT1mdW5jdGlvbihpbnB1dFB0cyxzaWRlLHNlZ0dlbil7dmFyIGRpc3RUb2w9anN0cy5vcGVyYXRpb24uYnVmZmVyLk9mZnNldEN1cnZlQnVpbGRlci5zaW1wbGlmeVRvbGVyYW5jZSh0aGlzLmRpc3RhbmNlKTtpZihzaWRlPT09anN0cy5nZW9tZ3JhcGguUG9zaXRpb24uUklHSFQpXG5kaXN0VG9sPS1kaXN0VG9sO3ZhciBzaW1wPWpzdHMub3BlcmF0aW9uLmJ1ZmZlci5CdWZmZXJJbnB1dExpbmVTaW1wbGlmaWVyLnNpbXBsaWZ5KGlucHV0UHRzLGRpc3RUb2wpO3ZhciBuPXNpbXAubGVuZ3RoLTE7c2VnR2VuLmluaXRTaWRlU2VnbWVudHMoc2ltcFtuLTFdLHNpbXBbMF0sc2lkZSk7Zm9yKHZhciBpPTE7aTw9bjtpKyspe3ZhciBhZGRTdGFydFBvaW50PWkhPT0xO3NlZ0dlbi5hZGROZXh0U2VnbWVudChzaW1wW2ldLGFkZFN0YXJ0UG9pbnQpO31cbnNlZ0dlbi5jbG9zZVJpbmcoKTt9OyhmdW5jdGlvbigpe3ZhciBIb3RQaXhlbFNuYXBBY3Rpb249ZnVuY3Rpb24oaG90UGl4ZWwscGFyZW50RWRnZSx2ZXJ0ZXhJbmRleCl7dGhpcy5ob3RQaXhlbD1ob3RQaXhlbDt0aGlzLnBhcmVudEVkZ2U9cGFyZW50RWRnZTt0aGlzLnZlcnRleEluZGV4PXZlcnRleEluZGV4O307SG90UGl4ZWxTbmFwQWN0aW9uLnByb3RvdHlwZT1uZXcganN0cy5pbmRleC5jaGFpbi5Nb25vdG9uZUNoYWluU2VsZWN0QWN0aW9uKCk7SG90UGl4ZWxTbmFwQWN0aW9uLmNvbnN0cnVjdG9yPUhvdFBpeGVsU25hcEFjdGlvbjtIb3RQaXhlbFNuYXBBY3Rpb24ucHJvdG90eXBlLmhvdFBpeGVsPW51bGw7SG90UGl4ZWxTbmFwQWN0aW9uLnByb3RvdHlwZS5wYXJlbnRFZGdlPW51bGw7SG90UGl4ZWxTbmFwQWN0aW9uLnByb3RvdHlwZS52ZXJ0ZXhJbmRleD1udWxsO0hvdFBpeGVsU25hcEFjdGlvbi5wcm90b3R5cGUuX2lzTm9kZUFkZGVkPWZhbHNlO0hvdFBpeGVsU25hcEFjdGlvbi5wcm90b3R5cGUuaXNOb2RlQWRkZWQ9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5faXNOb2RlQWRkZWQ7fTtIb3RQaXhlbFNuYXBBY3Rpb24ucHJvdG90eXBlLnNlbGVjdD1mdW5jdGlvbihtYyxzdGFydEluZGV4KXt2YXIgc3M9bWMuZ2V0Q29udGV4dCgpO2lmKHRoaXMucGFyZW50RWRnZSE9PW51bGwpe2lmKHNzPT09dGhpcy5wYXJlbnRFZGdlJiZzdGFydEluZGV4PT09dGhpcy52ZXJ0ZXhJbmRleClcbnJldHVybjt9XG50aGlzLl9pc05vZGVBZGRlZD10aGlzLmhvdFBpeGVsLmFkZFNuYXBwZWROb2RlKHNzLHN0YXJ0SW5kZXgpO307anN0cy5ub2Rpbmcuc25hcHJvdW5kLk1DSW5kZXhQb2ludFNuYXBwZXI9ZnVuY3Rpb24oaW5kZXgpe3RoaXMuaW5kZXg9aW5kZXg7fTtqc3RzLm5vZGluZy5zbmFwcm91bmQuTUNJbmRleFBvaW50U25hcHBlci5wcm90b3R5cGUuaW5kZXg9bnVsbDtqc3RzLm5vZGluZy5zbmFwcm91bmQuTUNJbmRleFBvaW50U25hcHBlci5wcm90b3R5cGUuc25hcD1mdW5jdGlvbihob3RQaXhlbCxwYXJlbnRFZGdlLHZlcnRleEluZGV4KXtpZihhcmd1bWVudHMubGVuZ3RoPT09MSl7dGhpcy5zbmFwMi5hcHBseSh0aGlzLGFyZ3VtZW50cyk7cmV0dXJuO31cbnZhciBwaXhlbEVudj1ob3RQaXhlbC5nZXRTYWZlRW52ZWxvcGUoKTt2YXIgaG90UGl4ZWxTbmFwQWN0aW9uPW5ldyBIb3RQaXhlbFNuYXBBY3Rpb24oaG90UGl4ZWwscGFyZW50RWRnZSx2ZXJ0ZXhJbmRleCk7dGhpcy5pbmRleC5xdWVyeShwaXhlbEVudix7dmlzaXRJdGVtOmZ1bmN0aW9uKHRlc3RDaGFpbil7dGVzdENoYWluLnNlbGVjdChwaXhlbEVudixob3RQaXhlbFNuYXBBY3Rpb24pO319KTtyZXR1cm4gaG90UGl4ZWxTbmFwQWN0aW9uLmlzTm9kZUFkZGVkKCk7fTtqc3RzLm5vZGluZy5zbmFwcm91bmQuTUNJbmRleFBvaW50U25hcHBlci5wcm90b3R5cGUuc25hcDI9ZnVuY3Rpb24oaG90UGl4ZWwpe3JldHVybiB0aGlzLnNuYXAoaG90UGl4ZWwsbnVsbCwtMSk7fTt9KSgpOyhmdW5jdGlvbigpe3ZhciBOb2RlQmFzZT1mdW5jdGlvbigpe3RoaXMuaXRlbXM9bmV3IGphdmFzY3JpcHQudXRpbC5BcnJheUxpc3QoKTt0aGlzLnN1Ym5vZGU9W251bGwsbnVsbF07fTtOb2RlQmFzZS5nZXRTdWJub2RlSW5kZXg9ZnVuY3Rpb24oaW50ZXJ2YWwsY2VudHJlKXt2YXIgc3Vibm9kZUluZGV4PS0xO2lmKGludGVydmFsLm1pbj49Y2VudHJlKXtzdWJub2RlSW5kZXg9MTt9XG5pZihpbnRlcnZhbC5tYXg8PWNlbnRyZSl7c3Vibm9kZUluZGV4PTA7fVxucmV0dXJuIHN1Ym5vZGVJbmRleDt9O05vZGVCYXNlLnByb3RvdHlwZS5nZXRJdGVtcz1mdW5jdGlvbigpe3JldHVybiB0aGlzLml0ZW1zO307Tm9kZUJhc2UucHJvdG90eXBlLmFkZD1mdW5jdGlvbihpdGVtKXt0aGlzLml0ZW1zLmFkZChpdGVtKTt9O05vZGVCYXNlLnByb3RvdHlwZS5hZGRBbGxJdGVtcz1mdW5jdGlvbihpdGVtcyl7aXRlbXMuYWRkQWxsKHRoaXMuaXRlbXMpO3ZhciBpPTAsaWw9Mjtmb3IoaTtpPGlsO2krKyl7aWYodGhpcy5zdWJub2RlW2ldIT09bnVsbCl7dGhpcy5zdWJub2RlW2ldLmFkZEFsbEl0ZW1zKGl0ZW1zKTt9fVxucmV0dXJuIGl0ZW1zO307Tm9kZUJhc2UucHJvdG90eXBlLmFkZEFsbEl0ZW1zRnJvbU92ZXJsYXBwaW5nPWZ1bmN0aW9uKGludGVydmFsLHJlc3VsdEl0ZW1zKXtpZihpbnRlcnZhbCE9PW51bGwmJiF0aGlzLmlzU2VhcmNoTWF0Y2goaW50ZXJ2YWwpKXtyZXR1cm47fVxucmVzdWx0SXRlbXMuYWRkQWxsKHRoaXMuaXRlbXMpO2lmKHRoaXMuc3Vibm9kZVswXSE9PW51bGwpe3RoaXMuc3Vibm9kZVswXS5hZGRBbGxJdGVtc0Zyb21PdmVybGFwcGluZyhpbnRlcnZhbCxyZXN1bHRJdGVtcyk7fVxuaWYodGhpcy5zdWJub2RlWzFdIT09bnVsbCl7dGhpcy5zdWJub2RlWzFdLmFkZEFsbEl0ZW1zRnJvbU92ZXJsYXBwaW5nKGludGVydmFsLHJlc3VsdEl0ZW1zKTt9fTtOb2RlQmFzZS5wcm90b3R5cGUucmVtb3ZlPWZ1bmN0aW9uKGl0ZW1JbnRlcnZhbCxpdGVtKXtpZighdGhpcy5pc1NlYXJjaE1hdGNoKGl0ZW1JbnRlcnZhbCkpe3JldHVybiBmYWxzZTt9XG52YXIgZm91bmQ9ZmFsc2UsaT0wLGlsPTI7Zm9yKGk7aTxpbDtpKyspe2lmKHRoaXMuc3Vibm9kZVtpXSE9PW51bGwpe2ZvdW5kPXRoaXMuc3Vibm9kZVtpXS5yZW1vdmUoaXRlbUludGVydmFsLGl0ZW0pO2lmKGZvdW5kKXtpZih0aGlzLnN1Ym5vZGVbaV0uaXNQcnVuYWJsZSgpKXt0aGlzLnN1Ym5vZGVbaV09bnVsbDt9XG5icmVhazt9fX1cbmlmKGZvdW5kKXtyZXR1cm4gZm91bmQ7fVxuZm91bmQ9dGhpcy5pdGVtcy5yZW1vdmUoaXRlbSk7cmV0dXJuIGZvdW5kO307Tm9kZUJhc2UucHJvdG90eXBlLmlzUHJ1bmFibGU9ZnVuY3Rpb24oKXtyZXR1cm4hKHRoaXMuaGFzQ2hpbGRyZW4oKXx8dGhpcy5oYXNJdGVtcygpKTt9O05vZGVCYXNlLnByb3RvdHlwZS5oYXNDaGlsZHJlbj1mdW5jdGlvbigpe3ZhciBpPTAsaWw9Mjtmb3IoaTtpPGlsO2krKyl7aWYodGhpcy5zdWJub2RlW2ldIT09bnVsbCl7cmV0dXJuIHRydWU7fX1cbnJldHVybiBmYWxzZTt9O05vZGVCYXNlLnByb3RvdHlwZS5oYXNJdGVtcz1mdW5jdGlvbigpe3JldHVybiF0aGlzLml0ZW1zLmlzRW1wdHkoKTt9O05vZGVCYXNlLnByb3RvdHlwZS5kZXB0aD1mdW5jdGlvbigpe3ZhciBtYXhTdWJEZXB0aD0wLGk9MCxpbD0yLHNxZDtmb3IoaTtpPGlsO2krKyl7aWYodGhpcy5zdWJub2RlW2ldIT09bnVsbCl7c3FkPXRoaXMuc3Vibm9kZVtpXS5kZXB0aCgpO2lmKHNxZD5tYXhTdWJEZXB0aCl7bWF4U3ViRGVwdGg9c3FkO319fVxucmV0dXJuIG1heFN1YkRlcHRoKzE7fTtOb2RlQmFzZS5wcm90b3R5cGUuc2l6ZT1mdW5jdGlvbigpe3ZhciBzdWJTaXplPTAsaT0wLGlsPTI7Zm9yKGk7aTxpbDtpKyspe2lmKHRoaXMuc3Vibm9kZVtpXSE9PW51bGwpe3N1YlNpemUrPXRoaXMuc3Vibm9kZVtpXS5zaXplKCk7fX1cbnJldHVybiBzdWJTaXplK3RoaXMuaXRlbXMuc2l6ZSgpO307Tm9kZUJhc2UucHJvdG90eXBlLm5vZGVTaXplPWZ1bmN0aW9uKCl7dmFyIHN1YlNpemU9MCxpPTAsaWw9Mjtmb3IoaTtpPGlsO2krKyl7aWYodGhpcy5zdWJub2RlW2ldIT09bnVsbCl7c3ViU2l6ZSs9dGhpcy5zdWJub2RlW2ldLm5vZGVTaXplKCk7fX1cbnJldHVybiBzdWJTaXplKzE7fTtqc3RzLmluZGV4LmJpbnRyZWUuTm9kZUJhc2U9Tm9kZUJhc2U7fSkoKTsoZnVuY3Rpb24oKXt2YXIgTm9kZUJhc2U9anN0cy5pbmRleC5iaW50cmVlLk5vZGVCYXNlO3ZhciBLZXk9anN0cy5pbmRleC5iaW50cmVlLktleTt2YXIgSW50ZXJ2YWw9anN0cy5pbmRleC5iaW50cmVlLkludGVydmFsO3ZhciBOb2RlPWZ1bmN0aW9uKGludGVydmFsLGxldmVsKXt0aGlzLml0ZW1zPW5ldyBqYXZhc2NyaXB0LnV0aWwuQXJyYXlMaXN0KCk7dGhpcy5zdWJub2RlPVtudWxsLG51bGxdO3RoaXMuaW50ZXJ2YWw9aW50ZXJ2YWw7dGhpcy5sZXZlbD1sZXZlbDt0aGlzLmNlbnRyZT0oaW50ZXJ2YWwuZ2V0TWluKCkraW50ZXJ2YWwuZ2V0TWF4KCkpLzI7fTtOb2RlLnByb3RvdHlwZT1uZXcgTm9kZUJhc2UoKTtOb2RlLmNvbnN0cnVjdG9yPU5vZGU7Tm9kZS5jcmVhdGVOb2RlPWZ1bmN0aW9uKGl0ZW1JbnRlcnZhbCl7dmFyIGtleSxub2RlO2tleT1uZXcgS2V5KGl0ZW1JbnRlcnZhbCk7bm9kZT1uZXcgTm9kZShrZXkuZ2V0SW50ZXJ2YWwoKSxrZXkuZ2V0TGV2ZWwoKSk7cmV0dXJuIG5vZGU7fTtOb2RlLmNyZWF0ZUV4cGFuZGVkPWZ1bmN0aW9uKG5vZGUsYWRkSW50ZXJ2YWwpe3ZhciBleHBhbmRJbnQsbGFyZ2VyTm9kZTtleHBhbmRJbnQ9bmV3IEludGVydmFsKGFkZEludGVydmFsKTtpZihub2RlIT09bnVsbCl7ZXhwYW5kSW50LmV4cGFuZFRvSW5jbHVkZShub2RlLmludGVydmFsKTt9XG5sYXJnZXJOb2RlPU5vZGUuY3JlYXRlTm9kZShleHBhbmRJbnQpO2lmKG5vZGUhPT1udWxsKXtsYXJnZXJOb2RlLmluc2VydChub2RlKTt9XG5yZXR1cm4gbGFyZ2VyTm9kZTt9O05vZGUucHJvdG90eXBlLmdldEludGVydmFsPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuaW50ZXJ2YWw7fTtOb2RlLnByb3RvdHlwZS5pc1NlYXJjaE1hdGNoPWZ1bmN0aW9uKGl0ZW1JbnRlcnZhbCl7cmV0dXJuIGl0ZW1JbnRlcnZhbC5vdmVybGFwcyh0aGlzLmludGVydmFsKTt9O05vZGUucHJvdG90eXBlLmdldE5vZGU9ZnVuY3Rpb24oc2VhcmNoSW50ZXJ2YWwpe3ZhciBzdWJub2RlSW5kZXg9Tm9kZUJhc2UuZ2V0U3Vibm9kZUluZGV4KHNlYXJjaEludGVydmFsLHRoaXMuY2VudHJlKSxub2RlO2lmKHN1Ym5vZGVJbmRleCE9LTEpe25vZGU9dGhpcy5nZXRTdWJub2RlKHN1Ym5vZGVJbmRleCk7cmV0dXJuIG5vZGUuZ2V0Tm9kZShzZWFyY2hJbnRlcnZhbCk7fWVsc2V7cmV0dXJuIHRoaXM7fX07Tm9kZS5wcm90b3R5cGUuZmluZD1mdW5jdGlvbihzZWFyY2hJbnRlcnZhbCl7dmFyIHN1Ym5vZGVJbmRleD1Ob2RlQmFzZS5nZXRTdWJub2RlSW5kZXgoc2VhcmNoSW50ZXJ2YWwsdGhpcy5jZW50cmUpLG5vZGU7aWYoc3Vibm9kZUluZGV4PT09LTEpe3JldHVybiB0aGlzO31cbmlmKHRoaXMuc3Vibm9kZVtzdWJub2RlSW5kZXhdIT09bnVsbCl7bm9kZT10aGlzLnN1Ym5vZGVbc3Vibm9kZUluZGV4XTtyZXR1cm4gbm9kZS5maW5kKHNlYXJjaEludGVydmFsKTt9XG5yZXR1cm4gdGhpczt9O05vZGUucHJvdG90eXBlLmluc2VydD1mdW5jdGlvbihub2RlKXt2YXIgaW5kZXg9Tm9kZUJhc2UuZ2V0U3Vibm9kZUluZGV4KG5vZGUuaW50ZXJ2YWwsdGhpcy5jZW50cmUpLGNoaWxkTm9kZTtpZihub2RlLmxldmVsPT09dGhpcy5sZXZlbC0xKXt0aGlzLnN1Ym5vZGVbaW5kZXhdPW5vZGU7fWVsc2V7Y2hpbGROb2RlPXRoaXMuY3JlYXRlU3Vibm9kZShpbmRleCk7Y2hpbGROb2RlLmluc2VydChub2RlKTt0aGlzLnN1Ym5vZGVbaW5kZXhdPWNoaWxkTm9kZTt9fTtOb2RlLnByb3RvdHlwZS5nZXRTdWJub2RlPWZ1bmN0aW9uKGluZGV4KXtpZih0aGlzLnN1Ym5vZGVbaW5kZXhdPT09bnVsbCl7dGhpcy5zdWJub2RlW2luZGV4XT10aGlzLmNyZWF0ZVN1Ym5vZGUoaW5kZXgpO31cbnJldHVybiB0aGlzLnN1Ym5vZGVbaW5kZXhdO307Tm9kZS5wcm90b3R5cGUuY3JlYXRlU3Vibm9kZT1mdW5jdGlvbihpbmRleCl7dmFyIG1pbixtYXgsc3ViSW50LG5vZGU7bWluPTAuMDttYXg9MC4wO3N3aXRjaChpbmRleCl7Y2FzZSAwOm1pbj10aGlzLmludGVydmFsLmdldE1pbigpO21heD10aGlzLmNlbnRyZTticmVhaztjYXNlIDE6bWluPXRoaXMuY2VudHJlO21heD10aGlzLmludGVydmFsLmdldE1heCgpO2JyZWFrO31cbnN1YkludD1uZXcgSW50ZXJ2YWwobWluLG1heCk7bm9kZT1uZXcgTm9kZShzdWJJbnQsdGhpcy5sZXZlbC0xKTtyZXR1cm4gbm9kZTt9O2pzdHMuaW5kZXguYmludHJlZS5Ob2RlPU5vZGU7fSkoKTsoZnVuY3Rpb24oKXt2YXIgTm9kZT1qc3RzLmluZGV4LmJpbnRyZWUuTm9kZTt2YXIgTm9kZUJhc2U9anN0cy5pbmRleC5iaW50cmVlLk5vZGVCYXNlO3ZhciBSb290PWZ1bmN0aW9uKCl7dGhpcy5zdWJub2RlPVtudWxsLG51bGxdO3RoaXMuaXRlbXM9bmV3IGphdmFzY3JpcHQudXRpbC5BcnJheUxpc3QoKTt9O1Jvb3QucHJvdG90eXBlPW5ldyBqc3RzLmluZGV4LmJpbnRyZWUuTm9kZUJhc2UoKTtSb290LmNvbnN0cnVjdG9yPVJvb3Q7Um9vdC5vcmlnaW49MC4wO1Jvb3QucHJvdG90eXBlLmluc2VydD1mdW5jdGlvbihpdGVtSW50ZXJ2YWwsaXRlbSl7dmFyIGluZGV4PU5vZGVCYXNlLmdldFN1Ym5vZGVJbmRleChpdGVtSW50ZXJ2YWwsUm9vdC5vcmlnaW4pLG5vZGUsbGFyZ2VyTm9kZTtpZihpbmRleD09PS0xKXt0aGlzLmFkZChpdGVtKTtyZXR1cm47fVxubm9kZT10aGlzLnN1Ym5vZGVbaW5kZXhdO2lmKG5vZGU9PT1udWxsfHwhbm9kZS5nZXRJbnRlcnZhbCgpLmNvbnRhaW5zKGl0ZW1JbnRlcnZhbCkpe2xhcmdlck5vZGU9Tm9kZS5jcmVhdGVFeHBhbmRlZChub2RlLGl0ZW1JbnRlcnZhbCk7dGhpcy5zdWJub2RlW2luZGV4XT1sYXJnZXJOb2RlO31cbnRoaXMuaW5zZXJ0Q29udGFpbmVkKHRoaXMuc3Vibm9kZVtpbmRleF0saXRlbUludGVydmFsLGl0ZW0pO307Um9vdC5wcm90b3R5cGUuaW5zZXJ0Q29udGFpbmVkPWZ1bmN0aW9uKHRyZWUsaXRlbUludGVydmFsLGl0ZW0pe3ZhciBpc1plcm9BcmVhLG5vZGU7aXNaZXJvQXJlYT1qc3RzLmluZGV4LkludGVydmFsU2l6ZS5pc1plcm9XaWR0aChpdGVtSW50ZXJ2YWwuZ2V0TWluKCksaXRlbUludGVydmFsLmdldE1heCgpKTtub2RlPWlzWmVyb0FyZWE/dHJlZS5maW5kKGl0ZW1JbnRlcnZhbCk6dHJlZS5nZXROb2RlKGl0ZW1JbnRlcnZhbCk7bm9kZS5hZGQoaXRlbSk7fTtSb290LnByb3RvdHlwZS5pc1NlYXJjaE1hdGNoPWZ1bmN0aW9uKGludGVydmFsKXtyZXR1cm4gdHJ1ZTt9O2pzdHMuaW5kZXguYmludHJlZS5Sb290PVJvb3Q7fSkoKTtqc3RzLmdlb21ncmFwaC5RdWFkcmFudD1mdW5jdGlvbigpe307anN0cy5nZW9tZ3JhcGguUXVhZHJhbnQuTkU9MDtqc3RzLmdlb21ncmFwaC5RdWFkcmFudC5OVz0xO2pzdHMuZ2VvbWdyYXBoLlF1YWRyYW50LlNXPTI7anN0cy5nZW9tZ3JhcGguUXVhZHJhbnQuU0U9Mztqc3RzLmdlb21ncmFwaC5RdWFkcmFudC5xdWFkcmFudD1mdW5jdGlvbihkeCxkeSl7aWYoZHggaW5zdGFuY2VvZiBqc3RzLmdlb20uQ29vcmRpbmF0ZSl7cmV0dXJuIGpzdHMuZ2VvbWdyYXBoLlF1YWRyYW50LnF1YWRyYW50Mi5hcHBseSh0aGlzLGFyZ3VtZW50cyk7fVxuaWYoZHg9PT0wLjAmJmR5PT09MC4wKVxudGhyb3cgbmV3IGpzdHMuZXJyb3IuSWxsZWdhbEFyZ3VtZW50RXJyb3IoJ0Nhbm5vdCBjb21wdXRlIHRoZSBxdWFkcmFudCBmb3IgcG9pbnQgKCAnK2R4KycsICcrZHkrJyApJyk7aWYoZHg+PTAuMCl7aWYoZHk+PTAuMClcbnJldHVybiBqc3RzLmdlb21ncmFwaC5RdWFkcmFudC5ORTtlbHNlXG5yZXR1cm4ganN0cy5nZW9tZ3JhcGguUXVhZHJhbnQuU0U7fWVsc2V7aWYoZHk+PTAuMClcbnJldHVybiBqc3RzLmdlb21ncmFwaC5RdWFkcmFudC5OVztlbHNlXG5yZXR1cm4ganN0cy5nZW9tZ3JhcGguUXVhZHJhbnQuU1c7fX07anN0cy5nZW9tZ3JhcGguUXVhZHJhbnQucXVhZHJhbnQyPWZ1bmN0aW9uKHAwLHAxKXtpZihwMS54PT09cDAueCYmcDEueT09PXAwLnkpXG50aHJvdyBuZXcganN0cy5lcnJvci5JbGxlZ2FsQXJndW1lbnRFcnJvcignQ2Fubm90IGNvbXB1dGUgdGhlIHF1YWRyYW50IGZvciB0d28gaWRlbnRpY2FsIHBvaW50cyAnK3AwKTtpZihwMS54Pj1wMC54KXtpZihwMS55Pj1wMC55KVxucmV0dXJuIGpzdHMuZ2VvbWdyYXBoLlF1YWRyYW50Lk5FO2Vsc2VcbnJldHVybiBqc3RzLmdlb21ncmFwaC5RdWFkcmFudC5TRTt9ZWxzZXtpZihwMS55Pj1wMC55KVxucmV0dXJuIGpzdHMuZ2VvbWdyYXBoLlF1YWRyYW50Lk5XO2Vsc2VcbnJldHVybiBqc3RzLmdlb21ncmFwaC5RdWFkcmFudC5TVzt9fTtqc3RzLmdlb21ncmFwaC5RdWFkcmFudC5pc09wcG9zaXRlPWZ1bmN0aW9uKHF1YWQxLHF1YWQyKXtpZihxdWFkMT09PXF1YWQyKVxucmV0dXJuIGZhbHNlO3ZhciBkaWZmPShxdWFkMS1xdWFkMis0KSU0O2lmKGRpZmY9PT0yKVxucmV0dXJuIHRydWU7cmV0dXJuIGZhbHNlO307anN0cy5nZW9tZ3JhcGguUXVhZHJhbnQuY29tbW9uSGFsZlBsYW5lPWZ1bmN0aW9uKHF1YWQxLHF1YWQyKXtpZihxdWFkMT09PXF1YWQyKVxucmV0dXJuIHF1YWQxO3ZhciBkaWZmPShxdWFkMS1xdWFkMis0KSU0O2lmKGRpZmY9PT0yKVxucmV0dXJuLTE7dmFyIG1pbj0ocXVhZDE8cXVhZDIpP3F1YWQxOnF1YWQyO3ZhciBtYXg9KHF1YWQxPnF1YWQyKT9xdWFkMTpxdWFkMjtpZihtaW49PT0wJiZtYXg9PT0zKVxucmV0dXJuIDM7cmV0dXJuIG1pbjt9O2pzdHMuZ2VvbWdyYXBoLlF1YWRyYW50LmlzSW5IYWxmUGxhbmU9ZnVuY3Rpb24ocXVhZCxoYWxmUGxhbmUpe2lmKGhhbGZQbGFuZT09PWpzdHMuZ2VvbWdyYXBoLlF1YWRyYW50LlNFKXtyZXR1cm4gcXVhZD09PWpzdHMuZ2VvbWdyYXBoLlF1YWRyYW50LlNFfHxxdWFkPT09anN0cy5nZW9tZ3JhcGguUXVhZHJhbnQuU1c7fVxucmV0dXJuIHF1YWQ9PT1oYWxmUGxhbmV8fHF1YWQ9PT1oYWxmUGxhbmUrMTt9O2pzdHMuZ2VvbWdyYXBoLlF1YWRyYW50LmlzTm9ydGhlcm49ZnVuY3Rpb24ocXVhZCl7cmV0dXJuIHF1YWQ9PT1qc3RzLmdlb21ncmFwaC5RdWFkcmFudC5ORXx8cXVhZD09PWpzdHMuZ2VvbWdyYXBoLlF1YWRyYW50Lk5XO307anN0cy5vcGVyYXRpb24udmFsaWQuQ29uc2lzdGVudEFyZWFUZXN0ZXI9ZnVuY3Rpb24oZ2VvbUdyYXBoKXt0aGlzLmdlb21HcmFwaD1nZW9tR3JhcGg7dGhpcy5saT1uZXcganN0cy5hbGdvcml0aG0uUm9idXN0TGluZUludGVyc2VjdG9yKCk7dGhpcy5ub2RlR3JhcGg9bmV3IGpzdHMub3BlcmF0aW9uLnJlbGF0ZS5SZWxhdGVOb2RlR3JhcGgoKTt0aGlzLmludmFsaWRQb2ludD1udWxsO307anN0cy5vcGVyYXRpb24udmFsaWQuQ29uc2lzdGVudEFyZWFUZXN0ZXIucHJvdG90eXBlLmdldEludmFsaWRQb2ludD1mdW5jdGlvbigpe3JldHVybiB0aGlzLmludmFsaWRQb2ludDt9O2pzdHMub3BlcmF0aW9uLnZhbGlkLkNvbnNpc3RlbnRBcmVhVGVzdGVyLnByb3RvdHlwZS5pc05vZGVDb25zaXN0ZW50QXJlYT1mdW5jdGlvbigpe3ZhciBpbnRlcnNlY3Rvcj10aGlzLmdlb21HcmFwaC5jb21wdXRlU2VsZk5vZGVzKHRoaXMubGksdHJ1ZSk7aWYoaW50ZXJzZWN0b3IuaGFzUHJvcGVySW50ZXJzZWN0aW9uKCkpe3RoaXMuaW52YWxpZFBvaW50PWludGVyc2VjdG9yLmdldFByb3BlckludGVyc2VjdGlvblBvaW50KCk7cmV0dXJuIGZhbHNlO31cbnRoaXMubm9kZUdyYXBoLmJ1aWxkKHRoaXMuZ2VvbUdyYXBoKTtyZXR1cm4gdGhpcy5pc05vZGVFZGdlQXJlYUxhYmVsc0NvbnNpc3RlbnQoKTt9O2pzdHMub3BlcmF0aW9uLnZhbGlkLkNvbnNpc3RlbnRBcmVhVGVzdGVyLnByb3RvdHlwZS5pc05vZGVFZGdlQXJlYUxhYmVsc0NvbnNpc3RlbnQ9ZnVuY3Rpb24oKXtmb3IodmFyIG5vZGVJdD10aGlzLm5vZGVHcmFwaC5nZXROb2RlSXRlcmF0b3IoKTtub2RlSXQuaGFzTmV4dCgpOyl7dmFyIG5vZGU9bm9kZUl0Lm5leHQoKTtpZighbm9kZS5nZXRFZGdlcygpLmlzQXJlYUxhYmVsc0NvbnNpc3RlbnQodGhpcy5nZW9tR3JhcGgpKXt0aGlzLmludmFsaWRQb2ludD1ub2RlLmdldENvb3JkaW5hdGUoKS5jbG9uZSgpO3JldHVybiBmYWxzZTt9fVxucmV0dXJuIHRydWU7fTtqc3RzLm9wZXJhdGlvbi52YWxpZC5Db25zaXN0ZW50QXJlYVRlc3Rlci5wcm90b3R5cGUuaGFzRHVwbGljYXRlUmluZ3M9ZnVuY3Rpb24oKXtmb3IodmFyIG5vZGVJdD10aGlzLm5vZGVHcmFwaC5nZXROb2RlSXRlcmF0b3IoKTtub2RlSXQuaGFzTmV4dCgpOyl7dmFyIG5vZGU9bm9kZUl0Lm5leHQoKTtmb3IodmFyIGk9bm9kZS5nZXRFZGdlcygpLml0ZXJhdG9yKCk7aS5oYXNOZXh0KCk7KXt2YXIgZWViPWkubmV4dCgpO2lmKGVlYi5nZXRFZGdlRW5kcygpLmxlbmd0aD4xKXtpbnZhbGlkUG9pbnQ9ZWViLmdldEVkZ2UoKS5nZXRDb29yZGluYXRlKDApO3JldHVybiB0cnVlO319fVxucmV0dXJuIGZhbHNlO307anN0cy5vcGVyYXRpb24ucmVsYXRlLlJlbGF0ZU5vZGU9ZnVuY3Rpb24oY29vcmQsZWRnZXMpe2pzdHMuZ2VvbWdyYXBoLk5vZGUuYXBwbHkodGhpcyxhcmd1bWVudHMpO307anN0cy5vcGVyYXRpb24ucmVsYXRlLlJlbGF0ZU5vZGUucHJvdG90eXBlPW5ldyBqc3RzLmdlb21ncmFwaC5Ob2RlKCk7anN0cy5vcGVyYXRpb24ucmVsYXRlLlJlbGF0ZU5vZGUucHJvdG90eXBlLmNvbXB1dGVJTT1mdW5jdGlvbihpbSl7aW0uc2V0QXRMZWFzdElmVmFsaWQodGhpcy5sYWJlbC5nZXRMb2NhdGlvbigwKSx0aGlzLmxhYmVsLmdldExvY2F0aW9uKDEpLDApO307anN0cy5vcGVyYXRpb24ucmVsYXRlLlJlbGF0ZU5vZGUucHJvdG90eXBlLnVwZGF0ZUlNRnJvbUVkZ2VzPWZ1bmN0aW9uKGltKXt0aGlzLmVkZ2VzLnVwZGF0ZUlNKGltKTt9OyhmdW5jdGlvbigpe3ZhciBMb2NhdGlvbj1qc3RzLmdlb20uTG9jYXRpb247dmFyIFBvc2l0aW9uPWpzdHMuZ2VvbWdyYXBoLlBvc2l0aW9uO3ZhciBFZGdlRW5kPWpzdHMuZ2VvbWdyYXBoLkVkZ2VFbmQ7anN0cy5nZW9tZ3JhcGguRGlyZWN0ZWRFZGdlPWZ1bmN0aW9uKGVkZ2UsaXNGb3J3YXJkKXtFZGdlRW5kLmNhbGwodGhpcyxlZGdlKTt0aGlzLmRlcHRoPVswLC05OTksLTk5OV07dGhpcy5faXNGb3J3YXJkPWlzRm9yd2FyZDtpZihpc0ZvcndhcmQpe3RoaXMuaW5pdChlZGdlLmdldENvb3JkaW5hdGUoMCksZWRnZS5nZXRDb29yZGluYXRlKDEpKTt9ZWxzZXt2YXIgbj1lZGdlLmdldE51bVBvaW50cygpLTE7dGhpcy5pbml0KGVkZ2UuZ2V0Q29vcmRpbmF0ZShuKSxlZGdlLmdldENvb3JkaW5hdGUobi0xKSk7fVxudGhpcy5jb21wdXRlRGlyZWN0ZWRMYWJlbCgpO307anN0cy5nZW9tZ3JhcGguRGlyZWN0ZWRFZGdlLnByb3RvdHlwZT1uZXcgRWRnZUVuZCgpO2pzdHMuZ2VvbWdyYXBoLkRpcmVjdGVkRWRnZS5jb25zdHJ1Y3Rvcj1qc3RzLmdlb21ncmFwaC5EaXJlY3RlZEVkZ2U7anN0cy5nZW9tZ3JhcGguRGlyZWN0ZWRFZGdlLmRlcHRoRmFjdG9yPWZ1bmN0aW9uKGN1cnJMb2NhdGlvbixuZXh0TG9jYXRpb24pe2lmKGN1cnJMb2NhdGlvbj09PUxvY2F0aW9uLkVYVEVSSU9SJiZuZXh0TG9jYXRpb249PT1Mb2NhdGlvbi5JTlRFUklPUilcbnJldHVybiAxO2Vsc2UgaWYoY3VyckxvY2F0aW9uPT09TG9jYXRpb24uSU5URVJJT1ImJm5leHRMb2NhdGlvbj09PUxvY2F0aW9uLkVYVEVSSU9SKVxucmV0dXJuLTE7cmV0dXJuIDA7fTtqc3RzLmdlb21ncmFwaC5EaXJlY3RlZEVkZ2UucHJvdG90eXBlLl9pc0ZvcndhcmQ9bnVsbDtqc3RzLmdlb21ncmFwaC5EaXJlY3RlZEVkZ2UucHJvdG90eXBlLl9pc0luUmVzdWx0PWZhbHNlO2pzdHMuZ2VvbWdyYXBoLkRpcmVjdGVkRWRnZS5wcm90b3R5cGUuX2lzVmlzaXRlZD1mYWxzZTtqc3RzLmdlb21ncmFwaC5EaXJlY3RlZEVkZ2UucHJvdG90eXBlLnN5bT1udWxsO2pzdHMuZ2VvbWdyYXBoLkRpcmVjdGVkRWRnZS5wcm90b3R5cGUubmV4dD1udWxsO2pzdHMuZ2VvbWdyYXBoLkRpcmVjdGVkRWRnZS5wcm90b3R5cGUubmV4dE1pbj1udWxsO2pzdHMuZ2VvbWdyYXBoLkRpcmVjdGVkRWRnZS5wcm90b3R5cGUuZWRnZVJpbmc9bnVsbDtqc3RzLmdlb21ncmFwaC5EaXJlY3RlZEVkZ2UucHJvdG90eXBlLm1pbkVkZ2VSaW5nPW51bGw7anN0cy5nZW9tZ3JhcGguRGlyZWN0ZWRFZGdlLnByb3RvdHlwZS5kZXB0aD1udWxsO2pzdHMuZ2VvbWdyYXBoLkRpcmVjdGVkRWRnZS5wcm90b3R5cGUuZ2V0RWRnZT1mdW5jdGlvbigpe3JldHVybiB0aGlzLmVkZ2U7fTtqc3RzLmdlb21ncmFwaC5EaXJlY3RlZEVkZ2UucHJvdG90eXBlLnNldEluUmVzdWx0PWZ1bmN0aW9uKGlzSW5SZXN1bHQpe3RoaXMuX2lzSW5SZXN1bHQ9aXNJblJlc3VsdDt9O2pzdHMuZ2VvbWdyYXBoLkRpcmVjdGVkRWRnZS5wcm90b3R5cGUuaXNJblJlc3VsdD1mdW5jdGlvbigpe3JldHVybiB0aGlzLl9pc0luUmVzdWx0O307anN0cy5nZW9tZ3JhcGguRGlyZWN0ZWRFZGdlLnByb3RvdHlwZS5pc1Zpc2l0ZWQ9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5faXNWaXNpdGVkO307anN0cy5nZW9tZ3JhcGguRGlyZWN0ZWRFZGdlLnByb3RvdHlwZS5zZXRWaXNpdGVkPWZ1bmN0aW9uKGlzVmlzaXRlZCl7dGhpcy5faXNWaXNpdGVkPWlzVmlzaXRlZDt9O2pzdHMuZ2VvbWdyYXBoLkRpcmVjdGVkRWRnZS5wcm90b3R5cGUuc2V0RWRnZVJpbmc9ZnVuY3Rpb24oZWRnZVJpbmcpe3RoaXMuZWRnZVJpbmc9ZWRnZVJpbmc7fTtqc3RzLmdlb21ncmFwaC5EaXJlY3RlZEVkZ2UucHJvdG90eXBlLmdldEVkZ2VSaW5nPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZWRnZVJpbmc7fTtqc3RzLmdlb21ncmFwaC5EaXJlY3RlZEVkZ2UucHJvdG90eXBlLnNldE1pbkVkZ2VSaW5nPWZ1bmN0aW9uKG1pbkVkZ2VSaW5nKXt0aGlzLm1pbkVkZ2VSaW5nPW1pbkVkZ2VSaW5nO307anN0cy5nZW9tZ3JhcGguRGlyZWN0ZWRFZGdlLnByb3RvdHlwZS5nZXRNaW5FZGdlUmluZz1mdW5jdGlvbigpe3JldHVybiB0aGlzLm1pbkVkZ2VSaW5nO307anN0cy5nZW9tZ3JhcGguRGlyZWN0ZWRFZGdlLnByb3RvdHlwZS5nZXREZXB0aD1mdW5jdGlvbihwb3NpdGlvbil7cmV0dXJuIHRoaXMuZGVwdGhbcG9zaXRpb25dO307anN0cy5nZW9tZ3JhcGguRGlyZWN0ZWRFZGdlLnByb3RvdHlwZS5zZXREZXB0aD1mdW5jdGlvbihwb3NpdGlvbixkZXB0aFZhbCl7aWYodGhpcy5kZXB0aFtwb3NpdGlvbl0hPT0tOTk5KXtpZih0aGlzLmRlcHRoW3Bvc2l0aW9uXSE9PWRlcHRoVmFsKVxudGhyb3cgbmV3IGpzdHMuZXJyb3IuVG9wb2xvZ3lFcnJvcignYXNzaWduZWQgZGVwdGhzIGRvIG5vdCBtYXRjaCcsdGhpcy5nZXRDb29yZGluYXRlKCkpO31cbnRoaXMuZGVwdGhbcG9zaXRpb25dPWRlcHRoVmFsO307anN0cy5nZW9tZ3JhcGguRGlyZWN0ZWRFZGdlLnByb3RvdHlwZS5nZXREZXB0aERlbHRhPWZ1bmN0aW9uKCl7dmFyIGRlcHRoRGVsdGE9dGhpcy5lZGdlLmdldERlcHRoRGVsdGEoKTtpZighdGhpcy5faXNGb3J3YXJkKVxuZGVwdGhEZWx0YT0tZGVwdGhEZWx0YTtyZXR1cm4gZGVwdGhEZWx0YTt9O2pzdHMuZ2VvbWdyYXBoLkRpcmVjdGVkRWRnZS5wcm90b3R5cGUuc2V0VmlzaXRlZEVkZ2U9ZnVuY3Rpb24oaXNWaXNpdGVkKXt0aGlzLnNldFZpc2l0ZWQoaXNWaXNpdGVkKTt0aGlzLnN5bS5zZXRWaXNpdGVkKGlzVmlzaXRlZCk7fTtqc3RzLmdlb21ncmFwaC5EaXJlY3RlZEVkZ2UucHJvdG90eXBlLmdldFN5bT1mdW5jdGlvbigpe3JldHVybiB0aGlzLnN5bTt9O2pzdHMuZ2VvbWdyYXBoLkRpcmVjdGVkRWRnZS5wcm90b3R5cGUuaXNGb3J3YXJkPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2lzRm9yd2FyZDt9O2pzdHMuZ2VvbWdyYXBoLkRpcmVjdGVkRWRnZS5wcm90b3R5cGUuc2V0U3ltPWZ1bmN0aW9uKGRlKXt0aGlzLnN5bT1kZTt9O2pzdHMuZ2VvbWdyYXBoLkRpcmVjdGVkRWRnZS5wcm90b3R5cGUuZ2V0TmV4dD1mdW5jdGlvbigpe3JldHVybiB0aGlzLm5leHQ7fTtqc3RzLmdlb21ncmFwaC5EaXJlY3RlZEVkZ2UucHJvdG90eXBlLnNldE5leHQ9ZnVuY3Rpb24obmV4dCl7dGhpcy5uZXh0PW5leHQ7fTtqc3RzLmdlb21ncmFwaC5EaXJlY3RlZEVkZ2UucHJvdG90eXBlLmdldE5leHRNaW49ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5uZXh0TWluO307anN0cy5nZW9tZ3JhcGguRGlyZWN0ZWRFZGdlLnByb3RvdHlwZS5zZXROZXh0TWluPWZ1bmN0aW9uKG5leHRNaW4pe3RoaXMubmV4dE1pbj1uZXh0TWluO307anN0cy5nZW9tZ3JhcGguRGlyZWN0ZWRFZGdlLnByb3RvdHlwZS5pc0xpbmVFZGdlPWZ1bmN0aW9uKCl7dmFyIGlzTGluZT10aGlzLmxhYmVsLmlzTGluZSgwKXx8dGhpcy5sYWJlbC5pc0xpbmUoMSk7dmFyIGlzRXh0ZXJpb3JJZkFyZWEwPSF0aGlzLmxhYmVsLmlzQXJlYSgwKXx8dGhpcy5sYWJlbC5hbGxQb3NpdGlvbnNFcXVhbCgwLExvY2F0aW9uLkVYVEVSSU9SKTt2YXIgaXNFeHRlcmlvcklmQXJlYTE9IXRoaXMubGFiZWwuaXNBcmVhKDEpfHx0aGlzLmxhYmVsLmFsbFBvc2l0aW9uc0VxdWFsKDEsTG9jYXRpb24uRVhURVJJT1IpO3JldHVybiBpc0xpbmUmJmlzRXh0ZXJpb3JJZkFyZWEwJiZpc0V4dGVyaW9ySWZBcmVhMTt9O2pzdHMuZ2VvbWdyYXBoLkRpcmVjdGVkRWRnZS5wcm90b3R5cGUuaXNJbnRlcmlvckFyZWFFZGdlPWZ1bmN0aW9uKCl7dmFyIGlzSW50ZXJpb3JBcmVhRWRnZT10cnVlO2Zvcih2YXIgaT0wO2k8MjtpKyspe2lmKCEodGhpcy5sYWJlbC5pc0FyZWEoaSkmJnRoaXMubGFiZWwuZ2V0TG9jYXRpb24oaSxQb3NpdGlvbi5MRUZUKT09PUxvY2F0aW9uLklOVEVSSU9SJiZ0aGlzLmxhYmVsLmdldExvY2F0aW9uKGksUG9zaXRpb24uUklHSFQpPT09TG9jYXRpb24uSU5URVJJT1IpKXtpc0ludGVyaW9yQXJlYUVkZ2U9ZmFsc2U7fX1cbnJldHVybiBpc0ludGVyaW9yQXJlYUVkZ2U7fTtqc3RzLmdlb21ncmFwaC5EaXJlY3RlZEVkZ2UucHJvdG90eXBlLmNvbXB1dGVEaXJlY3RlZExhYmVsPWZ1bmN0aW9uKCl7dGhpcy5sYWJlbD1uZXcganN0cy5nZW9tZ3JhcGguTGFiZWwodGhpcy5lZGdlLmdldExhYmVsKCkpO2lmKCF0aGlzLl9pc0ZvcndhcmQpXG50aGlzLmxhYmVsLmZsaXAoKTt9O2pzdHMuZ2VvbWdyYXBoLkRpcmVjdGVkRWRnZS5wcm90b3R5cGUuc2V0RWRnZURlcHRocz1mdW5jdGlvbihwb3NpdGlvbixkZXB0aCl7dmFyIGRlcHRoRGVsdGE9dGhpcy5nZXRFZGdlKCkuZ2V0RGVwdGhEZWx0YSgpO2lmKCF0aGlzLl9pc0ZvcndhcmQpXG5kZXB0aERlbHRhPS1kZXB0aERlbHRhO3ZhciBkaXJlY3Rpb25GYWN0b3I9MTtpZihwb3NpdGlvbj09PVBvc2l0aW9uLkxFRlQpXG5kaXJlY3Rpb25GYWN0b3I9LTE7dmFyIG9wcG9zaXRlUG9zPVBvc2l0aW9uLm9wcG9zaXRlKHBvc2l0aW9uKTt2YXIgZGVsdGE9ZGVwdGhEZWx0YSpkaXJlY3Rpb25GYWN0b3I7dmFyIG9wcG9zaXRlRGVwdGg9ZGVwdGgrZGVsdGE7dGhpcy5zZXREZXB0aChwb3NpdGlvbixkZXB0aCk7dGhpcy5zZXREZXB0aChvcHBvc2l0ZVBvcyxvcHBvc2l0ZURlcHRoKTt9O30pKCk7anN0cy5vcGVyYXRpb24uZGlzdGFuY2UuRGlzdGFuY2VPcD1mdW5jdGlvbihnMCxnMSx0ZXJtaW5hdGVEaXN0YW5jZSl7dGhpcy5wdExvY2F0b3I9bmV3IGpzdHMuYWxnb3JpdGhtLlBvaW50TG9jYXRvcigpO3RoaXMuZ2VvbT1bXTt0aGlzLmdlb21bMF09ZzA7dGhpcy5nZW9tWzFdPWcxO3RoaXMudGVybWluYXRlRGlzdGFuY2U9dGVybWluYXRlRGlzdGFuY2U7fTtqc3RzLm9wZXJhdGlvbi5kaXN0YW5jZS5EaXN0YW5jZU9wLnByb3RvdHlwZS5nZW9tPW51bGw7anN0cy5vcGVyYXRpb24uZGlzdGFuY2UuRGlzdGFuY2VPcC5wcm90b3R5cGUudGVybWluYXRlRGlzdGFuY2U9MC4wO2pzdHMub3BlcmF0aW9uLmRpc3RhbmNlLkRpc3RhbmNlT3AucHJvdG90eXBlLnB0TG9jYXRvcj1udWxsO2pzdHMub3BlcmF0aW9uLmRpc3RhbmNlLkRpc3RhbmNlT3AucHJvdG90eXBlLm1pbkRpc3RhbmNlTG9jYXRpb249bnVsbDtqc3RzLm9wZXJhdGlvbi5kaXN0YW5jZS5EaXN0YW5jZU9wLnByb3RvdHlwZS5taW5EaXN0YW5jZT1OdW1iZXIuTUFYX1ZBTFVFO2pzdHMub3BlcmF0aW9uLmRpc3RhbmNlLkRpc3RhbmNlT3AuZGlzdGFuY2U9ZnVuY3Rpb24oZzAsZzEpe3ZhciBkaXN0T3A9bmV3IGpzdHMub3BlcmF0aW9uLmRpc3RhbmNlLkRpc3RhbmNlT3AoZzAsZzEsMC4wKTtyZXR1cm4gZGlzdE9wLmRpc3RhbmNlKCk7fTtqc3RzLm9wZXJhdGlvbi5kaXN0YW5jZS5EaXN0YW5jZU9wLmlzV2l0aGluRGlzdGFuY2U9ZnVuY3Rpb24oZzAsZzEsZGlzdGFuY2Upe3ZhciBkaXN0T3A9bmV3IGpzdHMub3BlcmF0aW9uLmRpc3RhbmNlLkRpc3RhbmNlT3AoZzAsZzEsZGlzdGFuY2UpO3JldHVybiBkaXN0T3AuZGlzdGFuY2UoKTw9ZGlzdGFuY2U7fTtqc3RzLm9wZXJhdGlvbi5kaXN0YW5jZS5EaXN0YW5jZU9wLm5lYXJlc3RQb2ludHM9ZnVuY3Rpb24oZzAsZzEpe3ZhciBkaXN0T3A9bmV3IGpzdHMub3BlcmF0aW9uLmRpc3RhbmNlLkRpc3RhbmNlT3AoZzAsZzEsMC4wKTtyZXR1cm4gZGlzdE9wLm5lYXJlc3RQb2ludHMoKTt9O2pzdHMub3BlcmF0aW9uLmRpc3RhbmNlLkRpc3RhbmNlT3AucHJvdG90eXBlLmRpc3RhbmNlPWZ1bmN0aW9uKCl7aWYodGhpcy5nZW9tWzBdPT09bnVsbHx8dGhpcy5nZW9tWzFdPT09bnVsbClcbnRocm93IG5ldyBqc3RzLmVycm9yLklsbGVnYWxBcmd1bWVudEVycm9yKCdudWxsIGdlb21ldHJpZXMgYXJlIG5vdCBzdXBwb3J0ZWQnKTtpZih0aGlzLmdlb21bMF0uaXNFbXB0eSgpfHx0aGlzLmdlb21bMV0uaXNFbXB0eSgpKVxucmV0dXJuIDAuMDt0aGlzLmNvbXB1dGVNaW5EaXN0YW5jZSgpO3JldHVybiB0aGlzLm1pbkRpc3RhbmNlO307anN0cy5vcGVyYXRpb24uZGlzdGFuY2UuRGlzdGFuY2VPcC5wcm90b3R5cGUubmVhcmVzdFBvaW50cz1mdW5jdGlvbigpe3RoaXMuY29tcHV0ZU1pbkRpc3RhbmNlKCk7dmFyIG5lYXJlc3RQdHM9W3RoaXMubWluRGlzdGFuY2VMb2NhdGlvblswXS5nZXRDb29yZGluYXRlKCksdGhpcy5taW5EaXN0YW5jZUxvY2F0aW9uWzFdLmdldENvb3JkaW5hdGUoKV07cmV0dXJuIG5lYXJlc3RQdHM7fTtqc3RzLm9wZXJhdGlvbi5kaXN0YW5jZS5EaXN0YW5jZU9wLnByb3RvdHlwZS5uZWFyZXN0TG9jYXRpb25zPWZ1bmN0aW9uKCl7dGhpcy5jb21wdXRlTWluRGlzdGFuY2UoKTtyZXR1cm4gdGhpcy5taW5EaXN0YW5jZUxvY2F0aW9uO307anN0cy5vcGVyYXRpb24uZGlzdGFuY2UuRGlzdGFuY2VPcC5wcm90b3R5cGUudXBkYXRlTWluRGlzdGFuY2U9ZnVuY3Rpb24obG9jR2VvbSxmbGlwKXtpZihsb2NHZW9tWzBdPT09bnVsbClcbnJldHVybjtpZihmbGlwKXt0aGlzLm1pbkRpc3RhbmNlTG9jYXRpb25bMF09bG9jR2VvbVsxXTt0aGlzLm1pbkRpc3RhbmNlTG9jYXRpb25bMV09bG9jR2VvbVswXTt9ZWxzZXt0aGlzLm1pbkRpc3RhbmNlTG9jYXRpb25bMF09bG9jR2VvbVswXTt0aGlzLm1pbkRpc3RhbmNlTG9jYXRpb25bMV09bG9jR2VvbVsxXTt9fTtqc3RzLm9wZXJhdGlvbi5kaXN0YW5jZS5EaXN0YW5jZU9wLnByb3RvdHlwZS5jb21wdXRlTWluRGlzdGFuY2U9ZnVuY3Rpb24oKXtpZihhcmd1bWVudHMubGVuZ3RoPjApe3RoaXMuY29tcHV0ZU1pbkRpc3RhbmNlMi5hcHBseSh0aGlzLGFyZ3VtZW50cyk7cmV0dXJuO31cbmlmKHRoaXMubWluRGlzdGFuY2VMb2NhdGlvbiE9PW51bGwpXG5yZXR1cm47dGhpcy5taW5EaXN0YW5jZUxvY2F0aW9uPVtdO3RoaXMuY29tcHV0ZUNvbnRhaW5tZW50RGlzdGFuY2UoKTtpZih0aGlzLm1pbkRpc3RhbmNlPD10aGlzLnRlcm1pbmF0ZURpc3RhbmNlKVxucmV0dXJuO3RoaXMuY29tcHV0ZUZhY2V0RGlzdGFuY2UoKTt9O2pzdHMub3BlcmF0aW9uLmRpc3RhbmNlLkRpc3RhbmNlT3AucHJvdG90eXBlLmNvbXB1dGVDb250YWlubWVudERpc3RhbmNlPWZ1bmN0aW9uKCl7aWYoYXJndW1lbnRzLmxlbmd0aD09PTIpe3RoaXMuY29tcHV0ZUNvbnRhaW5tZW50RGlzdGFuY2UyLmFwcGx5KHRoaXMsYXJndW1lbnRzKTtyZXR1cm47fWVsc2UgaWYoYXJndW1lbnRzLmxlbmd0aD09PTMmJighYXJndW1lbnRzWzBdaW5zdGFuY2VvZiBqc3RzLm9wZXJhdGlvbi5kaXN0YW5jZS5HZW9tZXRyeUxvY2F0aW9uKSl7dGhpcy5jb21wdXRlQ29udGFpbm1lbnREaXN0YW5jZTMuYXBwbHkodGhpcyxhcmd1bWVudHMpO3JldHVybjt9ZWxzZSBpZihhcmd1bWVudHMubGVuZ3RoPT09Myl7dGhpcy5jb21wdXRlQ29udGFpbm1lbnREaXN0YW5jZTQuYXBwbHkodGhpcyxhcmd1bWVudHMpO3JldHVybjt9XG52YXIgbG9jUHRQb2x5PVtdO3RoaXMuY29tcHV0ZUNvbnRhaW5tZW50RGlzdGFuY2UyKDAsbG9jUHRQb2x5KTtpZih0aGlzLm1pbkRpc3RhbmNlPD10aGlzLnRlcm1pbmF0ZURpc3RhbmNlKVxucmV0dXJuO3RoaXMuY29tcHV0ZUNvbnRhaW5tZW50RGlzdGFuY2UyKDEsbG9jUHRQb2x5KTt9O2pzdHMub3BlcmF0aW9uLmRpc3RhbmNlLkRpc3RhbmNlT3AucHJvdG90eXBlLmNvbXB1dGVDb250YWlubWVudERpc3RhbmNlMj1mdW5jdGlvbihwb2x5R2VvbUluZGV4LGxvY1B0UG9seSl7dmFyIGxvY2F0aW9uc0luZGV4PTEtcG9seUdlb21JbmRleDt2YXIgcG9seXM9anN0cy5nZW9tLnV0aWwuUG9seWdvbkV4dHJhY3Rlci5nZXRQb2x5Z29ucyh0aGlzLmdlb21bcG9seUdlb21JbmRleF0pO2lmKHBvbHlzLmxlbmd0aD4wKXt2YXIgaW5zaWRlTG9jcz1qc3RzLm9wZXJhdGlvbi5kaXN0YW5jZS5Db25uZWN0ZWRFbGVtZW50TG9jYXRpb25GaWx0ZXIuZ2V0TG9jYXRpb25zKHRoaXMuZ2VvbVtsb2NhdGlvbnNJbmRleF0pO3RoaXMuY29tcHV0ZUNvbnRhaW5tZW50RGlzdGFuY2UzKGluc2lkZUxvY3MscG9seXMsbG9jUHRQb2x5KTtpZih0aGlzLm1pbkRpc3RhbmNlPD10aGlzLnRlcm1pbmF0ZURpc3RhbmNlKXt0aGlzLm1pbkRpc3RhbmNlTG9jYXRpb25bbG9jYXRpb25zSW5kZXhdPWxvY1B0UG9seVswXTt0aGlzLm1pbkRpc3RhbmNlTG9jYXRpb25bcG9seUdlb21JbmRleF09bG9jUHRQb2x5WzFdO3JldHVybjt9fX07anN0cy5vcGVyYXRpb24uZGlzdGFuY2UuRGlzdGFuY2VPcC5wcm90b3R5cGUuY29tcHV0ZUNvbnRhaW5tZW50RGlzdGFuY2UzPWZ1bmN0aW9uKGxvY3MscG9seXMsbG9jUHRQb2x5KXtmb3IodmFyIGk9MDtpPGxvY3MubGVuZ3RoO2krKyl7dmFyIGxvYz1sb2NzW2ldO2Zvcih2YXIgaj0wO2o8cG9seXMubGVuZ3RoO2orKyl7dGhpcy5jb21wdXRlQ29udGFpbm1lbnREaXN0YW5jZTQobG9jLHBvbHlzW2pdLGxvY1B0UG9seSk7aWYodGhpcy5taW5EaXN0YW5jZTw9dGhpcy50ZXJtaW5hdGVEaXN0YW5jZSlcbnJldHVybjt9fX07anN0cy5vcGVyYXRpb24uZGlzdGFuY2UuRGlzdGFuY2VPcC5wcm90b3R5cGUuY29tcHV0ZUNvbnRhaW5tZW50RGlzdGFuY2U0PWZ1bmN0aW9uKHB0TG9jLHBvbHksbG9jUHRQb2x5KXt2YXIgcHQ9cHRMb2MuZ2V0Q29vcmRpbmF0ZSgpO2lmKGpzdHMuZ2VvbS5Mb2NhdGlvbi5FWFRFUklPUiE9PXRoaXMucHRMb2NhdG9yLmxvY2F0ZShwdCxwb2x5KSl7dGhpcy5taW5EaXN0YW5jZT0wLjA7bG9jUHRQb2x5WzBdPXB0TG9jO2xvY1B0UG9seVsxXT1uZXcganN0cy5vcGVyYXRpb24uZGlzdGFuY2UuR2VvbWV0cnlMb2NhdGlvbihwb2x5LHB0KTtyZXR1cm47fX07anN0cy5vcGVyYXRpb24uZGlzdGFuY2UuRGlzdGFuY2VPcC5wcm90b3R5cGUuY29tcHV0ZUZhY2V0RGlzdGFuY2U9ZnVuY3Rpb24oKXt2YXIgbG9jR2VvbT1bXTt2YXIgbGluZXMwPWpzdHMuZ2VvbS51dGlsLkxpbmVhckNvbXBvbmVudEV4dHJhY3Rlci5nZXRMaW5lcyh0aGlzLmdlb21bMF0pO3ZhciBsaW5lczE9anN0cy5nZW9tLnV0aWwuTGluZWFyQ29tcG9uZW50RXh0cmFjdGVyLmdldExpbmVzKHRoaXMuZ2VvbVsxXSk7dmFyIHB0czA9anN0cy5nZW9tLnV0aWwuUG9pbnRFeHRyYWN0ZXIuZ2V0UG9pbnRzKHRoaXMuZ2VvbVswXSk7dmFyIHB0czE9anN0cy5nZW9tLnV0aWwuUG9pbnRFeHRyYWN0ZXIuZ2V0UG9pbnRzKHRoaXMuZ2VvbVsxXSk7dGhpcy5jb21wdXRlTWluRGlzdGFuY2VMaW5lcyhsaW5lczAsbGluZXMxLGxvY0dlb20pO3RoaXMudXBkYXRlTWluRGlzdGFuY2UobG9jR2VvbSxmYWxzZSk7aWYodGhpcy5taW5EaXN0YW5jZTw9dGhpcy50ZXJtaW5hdGVEaXN0YW5jZSlcbnJldHVybjtsb2NHZW9tWzBdPW51bGw7bG9jR2VvbVsxXT1udWxsO3RoaXMuY29tcHV0ZU1pbkRpc3RhbmNlTGluZXNQb2ludHMobGluZXMwLHB0czEsbG9jR2VvbSk7dGhpcy51cGRhdGVNaW5EaXN0YW5jZShsb2NHZW9tLGZhbHNlKTtpZih0aGlzLm1pbkRpc3RhbmNlPD10aGlzLnRlcm1pbmF0ZURpc3RhbmNlKVxucmV0dXJuO2xvY0dlb21bMF09bnVsbDtsb2NHZW9tWzFdPW51bGw7dGhpcy5jb21wdXRlTWluRGlzdGFuY2VMaW5lc1BvaW50cyhsaW5lczEscHRzMCxsb2NHZW9tKTt0aGlzLnVwZGF0ZU1pbkRpc3RhbmNlKGxvY0dlb20sdHJ1ZSk7aWYodGhpcy5taW5EaXN0YW5jZTw9dGhpcy50ZXJtaW5hdGVEaXN0YW5jZSlcbnJldHVybjtsb2NHZW9tWzBdPW51bGw7bG9jR2VvbVsxXT1udWxsO3RoaXMuY29tcHV0ZU1pbkRpc3RhbmNlUG9pbnRzKHB0czAscHRzMSxsb2NHZW9tKTt0aGlzLnVwZGF0ZU1pbkRpc3RhbmNlKGxvY0dlb20sZmFsc2UpO307anN0cy5vcGVyYXRpb24uZGlzdGFuY2UuRGlzdGFuY2VPcC5wcm90b3R5cGUuY29tcHV0ZU1pbkRpc3RhbmNlTGluZXM9ZnVuY3Rpb24obGluZXMwLGxpbmVzMSxsb2NHZW9tKXtmb3IodmFyIGk9MDtpPGxpbmVzMC5sZW5ndGg7aSsrKXt2YXIgbGluZTA9bGluZXMwW2ldO2Zvcih2YXIgaj0wO2o8bGluZXMxLmxlbmd0aDtqKyspe3ZhciBsaW5lMT1saW5lczFbal07dGhpcy5jb21wdXRlTWluRGlzdGFuY2UobGluZTAsbGluZTEsbG9jR2VvbSk7aWYodGhpcy5taW5EaXN0YW5jZTw9dGhpcy50ZXJtaW5hdGVEaXN0YW5jZSlcbnJldHVybjt9fX07anN0cy5vcGVyYXRpb24uZGlzdGFuY2UuRGlzdGFuY2VPcC5wcm90b3R5cGUuY29tcHV0ZU1pbkRpc3RhbmNlUG9pbnRzPWZ1bmN0aW9uKHBvaW50czAscG9pbnRzMSxsb2NHZW9tKXtmb3IodmFyIGk9MDtpPHBvaW50czAubGVuZ3RoO2krKyl7dmFyIHB0MD1wb2ludHMwW2ldO2Zvcih2YXIgaj0wO2o8cG9pbnRzMS5sZW5ndGg7aisrKXt2YXIgcHQxPXBvaW50czFbal07dmFyIGRpc3Q9cHQwLmdldENvb3JkaW5hdGUoKS5kaXN0YW5jZShwdDEuZ2V0Q29vcmRpbmF0ZSgpKTtpZihkaXN0PHRoaXMubWluRGlzdGFuY2Upe3RoaXMubWluRGlzdGFuY2U9ZGlzdDtsb2NHZW9tWzBdPW5ldyBqc3RzLm9wZXJhdGlvbi5kaXN0YW5jZS5HZW9tZXRyeUxvY2F0aW9uKHB0MCwwLHB0MC5nZXRDb29yZGluYXRlKCkpO2xvY0dlb21bMV09bmV3IGpzdHMub3BlcmF0aW9uLmRpc3RhbmNlLkdlb21ldHJ5TG9jYXRpb24ocHQxLDAscHQxLmdldENvb3JkaW5hdGUoKSk7fVxuaWYodGhpcy5taW5EaXN0YW5jZTw9dGhpcy50ZXJtaW5hdGVEaXN0YW5jZSlcbnJldHVybjt9fX07anN0cy5vcGVyYXRpb24uZGlzdGFuY2UuRGlzdGFuY2VPcC5wcm90b3R5cGUuY29tcHV0ZU1pbkRpc3RhbmNlTGluZXNQb2ludHM9ZnVuY3Rpb24obGluZXMscG9pbnRzLGxvY0dlb20pe2Zvcih2YXIgaT0wO2k8bGluZXMubGVuZ3RoO2krKyl7dmFyIGxpbmU9bGluZXNbaV07Zm9yKHZhciBqPTA7ajxwb2ludHMubGVuZ3RoO2orKyl7dmFyIHB0PXBvaW50c1tqXTt0aGlzLmNvbXB1dGVNaW5EaXN0YW5jZShsaW5lLHB0LGxvY0dlb20pO2lmKHRoaXMubWluRGlzdGFuY2U8PXRoaXMudGVybWluYXRlRGlzdGFuY2UpXG5yZXR1cm47fX19O2pzdHMub3BlcmF0aW9uLmRpc3RhbmNlLkRpc3RhbmNlT3AucHJvdG90eXBlLmNvbXB1dGVNaW5EaXN0YW5jZTI9ZnVuY3Rpb24obGluZTAsbGluZTEsbG9jR2VvbSl7aWYobGluZTEgaW5zdGFuY2VvZiBqc3RzLmdlb20uUG9pbnQpe3RoaXMuY29tcHV0ZU1pbkRpc3RhbmNlMyhsaW5lMCxsaW5lMSxsb2NHZW9tKTtyZXR1cm47fVxuaWYobGluZTAuZ2V0RW52ZWxvcGVJbnRlcm5hbCgpLmRpc3RhbmNlKGxpbmUxLmdldEVudmVsb3BlSW50ZXJuYWwoKSk+dGhpcy5taW5EaXN0YW5jZSl7cmV0dXJuO31cbnZhciBjb29yZDA9bGluZTAuZ2V0Q29vcmRpbmF0ZXMoKTt2YXIgY29vcmQxPWxpbmUxLmdldENvb3JkaW5hdGVzKCk7Zm9yKHZhciBpPTA7aTxjb29yZDAubGVuZ3RoLTE7aSsrKXtmb3IodmFyIGo9MDtqPGNvb3JkMS5sZW5ndGgtMTtqKyspe3ZhciBkaXN0PWpzdHMuYWxnb3JpdGhtLkNHQWxnb3JpdGhtcy5kaXN0YW5jZUxpbmVMaW5lKGNvb3JkMFtpXSxjb29yZDBbaSsxXSxjb29yZDFbal0sY29vcmQxW2orMV0pO2lmKGRpc3Q8dGhpcy5taW5EaXN0YW5jZSl7dGhpcy5taW5EaXN0YW5jZT1kaXN0O3ZhciBzZWcwPW5ldyBqc3RzLmdlb20uTGluZVNlZ21lbnQoY29vcmQwW2ldLGNvb3JkMFtpKzFdKTt2YXIgc2VnMT1uZXcganN0cy5nZW9tLkxpbmVTZWdtZW50KGNvb3JkMVtqXSxjb29yZDFbaisxXSk7dmFyIGNsb3Nlc3RQdD1zZWcwLmNsb3Nlc3RQb2ludHMoc2VnMSk7bG9jR2VvbVswXT1uZXcganN0cy5vcGVyYXRpb24uZGlzdGFuY2UuR2VvbWV0cnlMb2NhdGlvbihsaW5lMCxpLGNsb3Nlc3RQdFswXSk7bG9jR2VvbVsxXT1uZXcganN0cy5vcGVyYXRpb24uZGlzdGFuY2UuR2VvbWV0cnlMb2NhdGlvbihsaW5lMSxqLGNsb3Nlc3RQdFsxXSk7fVxuaWYodGhpcy5taW5EaXN0YW5jZTw9dGhpcy50ZXJtaW5hdGVEaXN0YW5jZSl7cmV0dXJuO319fX07anN0cy5vcGVyYXRpb24uZGlzdGFuY2UuRGlzdGFuY2VPcC5wcm90b3R5cGUuY29tcHV0ZU1pbkRpc3RhbmNlMz1mdW5jdGlvbihsaW5lLHB0LGxvY0dlb20pe2lmKGxpbmUuZ2V0RW52ZWxvcGVJbnRlcm5hbCgpLmRpc3RhbmNlKHB0LmdldEVudmVsb3BlSW50ZXJuYWwoKSk+dGhpcy5taW5EaXN0YW5jZSl7cmV0dXJuO31cbnZhciBjb29yZDA9bGluZS5nZXRDb29yZGluYXRlcygpO3ZhciBjb29yZD1wdC5nZXRDb29yZGluYXRlKCk7Zm9yKHZhciBpPTA7aTxjb29yZDAubGVuZ3RoLTE7aSsrKXt2YXIgZGlzdD1qc3RzLmFsZ29yaXRobS5DR0FsZ29yaXRobXMuZGlzdGFuY2VQb2ludExpbmUoY29vcmQsY29vcmQwW2ldLGNvb3JkMFtpKzFdKTtpZihkaXN0PHRoaXMubWluRGlzdGFuY2Upe3RoaXMubWluRGlzdGFuY2U9ZGlzdDt2YXIgc2VnPW5ldyBqc3RzLmdlb20uTGluZVNlZ21lbnQoY29vcmQwW2ldLGNvb3JkMFtpKzFdKTt2YXIgc2VnQ2xvc2VzdFBvaW50PXNlZy5jbG9zZXN0UG9pbnQoY29vcmQpO2xvY0dlb21bMF09bmV3IGpzdHMub3BlcmF0aW9uLmRpc3RhbmNlLkdlb21ldHJ5TG9jYXRpb24obGluZSxpLHNlZ0Nsb3Nlc3RQb2ludCk7bG9jR2VvbVsxXT1uZXcganN0cy5vcGVyYXRpb24uZGlzdGFuY2UuR2VvbWV0cnlMb2NhdGlvbihwdCwwLGNvb3JkKTt9XG5pZih0aGlzLm1pbkRpc3RhbmNlPD10aGlzLnRlcm1pbmF0ZURpc3RhbmNlKXtyZXR1cm47fX19O2pzdHMuaW5kZXguc3RydHJlZS5TSVJ0cmVlPWZ1bmN0aW9uKG5vZGVDYXBhY2l0eSl7bm9kZUNhcGFjaXR5PW5vZGVDYXBhY2l0eXx8MTA7anN0cy5pbmRleC5zdHJ0cmVlLkFic3RyYWN0U1RSdHJlZS5jYWxsKHRoaXMsbm9kZUNhcGFjaXR5KTt9O2pzdHMuaW5kZXguc3RydHJlZS5TSVJ0cmVlLnByb3RvdHlwZT1uZXcganN0cy5pbmRleC5zdHJ0cmVlLkFic3RyYWN0U1RSdHJlZSgpO2pzdHMuaW5kZXguc3RydHJlZS5TSVJ0cmVlLmNvbnN0cnVjdG9yPWpzdHMuaW5kZXguc3RydHJlZS5TSVJ0cmVlO2pzdHMuaW5kZXguc3RydHJlZS5TSVJ0cmVlLnByb3RvdHlwZS5jb21wZXJhdG9yPXtjb21wYXJlOmZ1bmN0aW9uKG8xLG8yKXtyZXR1cm4gbzEuZ2V0Qm91bmRzKCkuZ2V0Q2VudHJlKCktbzIuZ2V0Qm91bmRzKCkuZ2V0Q2VudHJlKCk7fX07anN0cy5pbmRleC5zdHJ0cmVlLlNJUnRyZWUucHJvdG90eXBlLmludGVyc2VjdGlvbk9wPXtpbnRlcnNlY3RzOmZ1bmN0aW9uKGFCb3VuZHMsYkJvdW5kcyl7cmV0dXJuIGFCb3VuZHMuaW50ZXJzZWN0cyhiQm91bmRzKTt9fTtqc3RzLmluZGV4LnN0cnRyZWUuU0lSdHJlZS5wcm90b3R5cGUuY3JlYXRlTm9kZT1mdW5jdGlvbihsZXZlbCl7dmFyIEFic3RyYWN0Tm9kZT1mdW5jdGlvbihsZXZlbCl7anN0cy5pbmRleC5zdHJ0cmVlLkFic3RyYWN0Tm9kZS5hcHBseSh0aGlzLGFyZ3VtZW50cyk7fTtBYnN0cmFjdE5vZGUucHJvdG90eXBlPW5ldyBqc3RzLmluZGV4LnN0cnRyZWUuQWJzdHJhY3ROb2RlKCk7QWJzdHJhY3ROb2RlLmNvbnN0cnVjdG9yPUFic3RyYWN0Tm9kZTtBYnN0cmFjdE5vZGUucHJvdG90eXBlLmNvbXB1dGVCb3VuZHM9ZnVuY3Rpb24oKXt2YXIgYm91bmRzPW51bGwsY2hpbGRCb3VuZGFibGVzPXRoaXMuZ2V0Q2hpbGRCb3VuZGFibGVzKCksY2hpbGRCb3VuZGFibGU7Zm9yKHZhciBpPTAsbD1jaGlsZEJvdW5kYWJsZXMubGVuZ3RoO2k8bDtpKyspe2NoaWxkQm91bmRhYmxlPWNoaWxkQm91bmRhYmxlc1tpXTtpZihib3VuZHM9PT1udWxsKXtib3VuZHM9bmV3IGpzdHMuaW5kZXguc3RydHJlZS5JbnRlcnZhbChjaGlsZEJvdW5kYWJsZS5nZXRCb3VuZHMoKSk7fVxuZWxzZXtib3VuZHMuZXhwYW5kVG9JbmNsdWRlKGNoaWxkQm91bmRhYmxlLmdldEJvdW5kcygpKTt9fVxucmV0dXJuIGJvdW5kczt9O3JldHVybiBBYnN0cmFjdE5vZGU7fTtqc3RzLmluZGV4LnN0cnRyZWUuU0lSdHJlZS5wcm90b3R5cGUuaW5zZXJ0PWZ1bmN0aW9uKHgxLHgyLGl0ZW0pe2pzdHMuaW5kZXguc3RydHJlZS5BYnN0cmFjdFNUUnRyZWUucHJvdG90eXBlLmluc2VydChuZXcganN0cy5pbmRleC5zdHJ0cmVlLkludGVydmFsKE1hdGgubWluKHgxLHgyKSxNYXRoLm1heCh4MSx4MikpLGl0ZW0pO307anN0cy5pbmRleC5zdHJ0cmVlLlNJUnRyZWUucHJvdG90eXBlLnF1ZXJ5PWZ1bmN0aW9uKHgxLHgyKXt4Mj14Mnx8eDE7anN0cy5pbmRleC5zdHJ0cmVlLkFic3RyYWN0U1RSdHJlZS5wcm90b3R5cGUucXVlcnkobmV3IGpzdHMuaW5kZXguc3RydHJlZS5JbnRlcnZhbChNYXRoLm1pbih4MSx4MiksTWF0aC5tYXgoeDEseDIpKSk7fTtqc3RzLmluZGV4LnN0cnRyZWUuU0lSdHJlZS5wcm90b3R5cGUuZ2V0SW50ZXJzZWN0c09wPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuaW50ZXJzZWN0aW9uT3A7fTtqc3RzLmluZGV4LnN0cnRyZWUuU0lSdHJlZS5wcm90b3R5cGUuZ2V0Q29tcGFyYXRvcj1mdW5jdGlvbigpe3JldHVybiB0aGlzLmNvbXBlcmF0b3I7fTtqc3RzLnNpbXBsaWZ5LkRvdWdsYXNQZXVja2VyU2ltcGxpZmllcj1mdW5jdGlvbihpbnB1dEdlb20pe3RoaXMuaW5wdXRHZW9tPWlucHV0R2VvbTt0aGlzLmlzRW5zdXJlVmFsaWRUb3BvbG9neT10cnVlO307anN0cy5zaW1wbGlmeS5Eb3VnbGFzUGV1Y2tlclNpbXBsaWZpZXIucHJvdG90eXBlLmlucHV0R2VvbT1udWxsO2pzdHMuc2ltcGxpZnkuRG91Z2xhc1BldWNrZXJTaW1wbGlmaWVyLnByb3RvdHlwZS5kaXN0YW5jZVRvbGVyYW5jZT1udWxsO2pzdHMuc2ltcGxpZnkuRG91Z2xhc1BldWNrZXJTaW1wbGlmaWVyLnByb3RvdHlwZS5pc0Vuc3VyZVZhbGlkVG9wb2xvZ3k9bnVsbDtqc3RzLnNpbXBsaWZ5LkRvdWdsYXNQZXVja2VyU2ltcGxpZmllci5zaW1wbGlmeT1mdW5jdGlvbihnZW9tLGRpc3RhbmNlVG9sZXJhbmNlKXt2YXIgdHNzPW5ldyBqc3RzLnNpbXBsaWZ5LkRvdWdsYXNQZXVja2VyU2ltcGxpZmllcihnZW9tKTt0c3Muc2V0RGlzdGFuY2VUb2xlcmFuY2UoZGlzdGFuY2VUb2xlcmFuY2UpO3JldHVybiB0c3MuZ2V0UmVzdWx0R2VvbWV0cnkoKTt9O2pzdHMuc2ltcGxpZnkuRG91Z2xhc1BldWNrZXJTaW1wbGlmaWVyLnByb3RvdHlwZS5zZXREaXN0YW5jZVRvbGVyYW5jZT1mdW5jdGlvbihkaXN0YW5jZVRvbGVyYW5jZSl7aWYoZGlzdGFuY2VUb2xlcmFuY2U8MC4wKXt0aHJvd1wiVG9sZXJhbmNlIG11c3QgYmUgbm9uLW5lZ2F0aXZlXCI7fVxudGhpcy5kaXN0YW5jZVRvbGVyYW5jZT1kaXN0YW5jZVRvbGVyYW5jZTt9O2pzdHMuc2ltcGxpZnkuRG91Z2xhc1BldWNrZXJTaW1wbGlmaWVyLnByb3RvdHlwZS5zZXRFbnN1cmVWYWxpZD1mdW5jdGlvbihpc0Vuc3VyZVZhbGlkVG9wb2xvZ3kpe3RoaXMuaXNFbnN1cmVWYWxpZFRvcG9sb2d5PWlzRW5zdXJlVmFsaWRUb3BvbG9neTt9O2pzdHMuc2ltcGxpZnkuRG91Z2xhc1BldWNrZXJTaW1wbGlmaWVyLnByb3RvdHlwZS5nZXRSZXN1bHRHZW9tZXRyeT1mdW5jdGlvbigpe2lmKHRoaXMuaW5wdXRHZW9tLmlzRW1wdHkoKSl7cmV0dXJuIHRoaXMuaW5wdXRHZW9tLmNsb25lKCk7fVxucmV0dXJuKG5ldyBqc3RzLnNpbXBsaWZ5LkRQVHJhbnNmb3JtZXIodGhpcy5kaXN0YW5jZVRvbGVyYW5jZSx0aGlzLmlzRW5zdXJlVmFsaWRUb3BvbG9neSkpLnRyYW5zZm9ybSh0aGlzLmlucHV0R2VvbSk7fTsoZnVuY3Rpb24oKXtqc3RzLm9wZXJhdGlvbi5wcmVkaWNhdGUuUmVjdGFuZ2xlQ29udGFpbnM9ZnVuY3Rpb24ocmVjdGFuZ2xlKXt0aGlzLnJlY3RFbnY9cmVjdGFuZ2xlLmdldEVudmVsb3BlSW50ZXJuYWwoKTt9XG5qc3RzLm9wZXJhdGlvbi5wcmVkaWNhdGUuUmVjdGFuZ2xlQ29udGFpbnMuY29udGFpbnM9ZnVuY3Rpb24ocmVjdGFuZ2xlLGIpe3ZhciByYz1uZXcganN0cy5vcGVyYXRpb24ucHJlZGljYXRlLlJlY3RhbmdsZUNvbnRhaW5zKHJlY3RhbmdsZSk7cmV0dXJuIHJjLmNvbnRhaW5zKGIpO31cbmpzdHMub3BlcmF0aW9uLnByZWRpY2F0ZS5SZWN0YW5nbGVDb250YWlucy5wcm90b3R5cGUucmVjdEVudj1udWxsO2pzdHMub3BlcmF0aW9uLnByZWRpY2F0ZS5SZWN0YW5nbGVDb250YWlucy5wcm90b3R5cGUuY29udGFpbnM9ZnVuY3Rpb24oZ2VvbSl7aWYoIXRoaXMucmVjdEVudi5jb250YWlucyhnZW9tLmdldEVudmVsb3BlSW50ZXJuYWwoKSkpXG5yZXR1cm4gZmFsc2U7aWYodGhpcy5pc0NvbnRhaW5lZEluQm91bmRhcnkoZ2VvbSkpXG5yZXR1cm4gZmFsc2U7cmV0dXJuIHRydWU7fVxuanN0cy5vcGVyYXRpb24ucHJlZGljYXRlLlJlY3RhbmdsZUNvbnRhaW5zLnByb3RvdHlwZS5pc0NvbnRhaW5lZEluQm91bmRhcnk9ZnVuY3Rpb24oZ2VvbSl7aWYoZ2VvbSBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5Qb2x5Z29uKXJldHVybiBmYWxzZTtpZihnZW9tIGluc3RhbmNlb2YganN0cy5nZW9tLlBvaW50KXJldHVybiB0aGlzLmlzUG9pbnRDb250YWluZWRJbkJvdW5kYXJ5KGdlb20uZ2V0Q29vcmRpbmF0ZSgpKTtpZihnZW9tIGluc3RhbmNlb2YganN0cy5nZW9tLkxpbmVTdHJpbmcpcmV0dXJuIHRoaXMuaXNMaW5lU3RyaW5nQ29udGFpbmVkSW5Cb3VuZGFyeShnZW9tKTtmb3IodmFyIGk9MDtpPGdlb20uZ2V0TnVtR2VvbWV0cmllcygpO2krKyl7dmFyIGNvbXA9Z2VvbS5nZXRHZW9tZXRyeU4oaSk7aWYoIXRoaXMuaXNDb250YWluZWRJbkJvdW5kYXJ5KGNvbXApKVxucmV0dXJuIGZhbHNlO31cbnJldHVybiB0cnVlO31cbmpzdHMub3BlcmF0aW9uLnByZWRpY2F0ZS5SZWN0YW5nbGVDb250YWlucy5wcm90b3R5cGUuaXNQb2ludENvbnRhaW5lZEluQm91bmRhcnk9ZnVuY3Rpb24ocHQpe3JldHVybiBwdC54PT10aGlzLnJlY3RFbnYuZ2V0TWluWCgpfHxwdC54PT10aGlzLnJlY3RFbnYuZ2V0TWF4WCgpfHxwdC55PT10aGlzLnJlY3RFbnYuZ2V0TWluWSgpfHxwdC55PT10aGlzLnJlY3RFbnYuZ2V0TWF4WSgpO31cbmpzdHMub3BlcmF0aW9uLnByZWRpY2F0ZS5SZWN0YW5nbGVDb250YWlucy5wcm90b3R5cGUuaXNMaW5lU3RyaW5nQ29udGFpbmVkSW5Cb3VuZGFyeT1mdW5jdGlvbihsaW5lKXt2YXIgc2VxPWxpbmUuZ2V0Q29vcmRpbmF0ZVNlcXVlbmNlKCk7Zm9yKHZhciBpPTA7aTxzZXEubGVuZ3RoLTE7aSsrKXt2YXIgcDA9c2VxW2ldO3ZhciBwMT1zZXFbaSsxXTtpZighdGhpcy5pc0xpbmVTZWdtZW50Q29udGFpbmVkSW5Cb3VuZGFyeShwMCxwMSkpXG5yZXR1cm4gZmFsc2U7fVxucmV0dXJuIHRydWU7fVxuanN0cy5vcGVyYXRpb24ucHJlZGljYXRlLlJlY3RhbmdsZUNvbnRhaW5zLnByb3RvdHlwZS5pc0xpbmVTZWdtZW50Q29udGFpbmVkSW5Cb3VuZGFyeT1mdW5jdGlvbihwMCxwMSl7aWYocDAuZXF1YWxzKHAxKSlcbnJldHVybiB0aGlzLmlzUG9pbnRDb250YWluZWRJbkJvdW5kYXJ5KHAwKTtpZihwMC54PT1wMS54KXtpZihwMC54PT10aGlzLnJlY3RFbnYuZ2V0TWluWCgpfHxwMC54PT10aGlzLnJlY3RFbnYuZ2V0TWF4WCgpKVxucmV0dXJuIHRydWU7fVxuZWxzZSBpZihwMC55PT1wMS55KXtpZihwMC55PT10aGlzLnJlY3RFbnYuZ2V0TWluWSgpfHxwMC55PT10aGlzLnJlY3RFbnYuZ2V0TWF4WSgpKVxucmV0dXJuIHRydWU7fVxucmV0dXJuIGZhbHNlO319KSgpOyhmdW5jdGlvbigpe3ZhciBMb2NhdGlvbj1qc3RzLmdlb20uTG9jYXRpb247dmFyIFBvc2l0aW9uPWpzdHMuZ2VvbWdyYXBoLlBvc2l0aW9uO2pzdHMuZ2VvbWdyYXBoLkRlcHRoPWZ1bmN0aW9uKCl7dGhpcy5kZXB0aD1bW10sW11dO2Zvcih2YXIgaT0wO2k8MjtpKyspe2Zvcih2YXIgaj0wO2o8MztqKyspe3RoaXMuZGVwdGhbaV1bal09anN0cy5nZW9tZ3JhcGguRGVwdGguTlVMTF9WQUxVRTt9fX07anN0cy5nZW9tZ3JhcGguRGVwdGguTlVMTF9WQUxVRT0tMTtqc3RzLmdlb21ncmFwaC5EZXB0aC5kZXB0aEF0TG9jYXRpb249ZnVuY3Rpb24obG9jYXRpb24pe2lmKGxvY2F0aW9uPT09TG9jYXRpb24uRVhURVJJT1IpXG5yZXR1cm4gMDtpZihsb2NhdGlvbj09PUxvY2F0aW9uLklOVEVSSU9SKVxucmV0dXJuIDE7cmV0dXJuIGpzdHMuZ2VvbWdyYXBoLkRlcHRoLk5VTExfVkFMVUU7fTtqc3RzLmdlb21ncmFwaC5EZXB0aC5wcm90b3R5cGUuZGVwdGg9bnVsbDtqc3RzLmdlb21ncmFwaC5EZXB0aC5wcm90b3R5cGUuZ2V0RGVwdGg9ZnVuY3Rpb24oZ2VvbUluZGV4LHBvc0luZGV4KXtyZXR1cm4gdGhpcy5kZXB0aFtnZW9tSW5kZXhdW3Bvc0luZGV4XTt9O2pzdHMuZ2VvbWdyYXBoLkRlcHRoLnByb3RvdHlwZS5zZXREZXB0aD1mdW5jdGlvbihnZW9tSW5kZXgscG9zSW5kZXgsZGVwdGhWYWx1ZSl7dGhpcy5kZXB0aFtnZW9tSW5kZXhdW3Bvc0luZGV4XT1kZXB0aFZhbHVlO307anN0cy5nZW9tZ3JhcGguRGVwdGgucHJvdG90eXBlLmdldExvY2F0aW9uPWZ1bmN0aW9uKGdlb21JbmRleCxwb3NJbmRleCl7aWYodGhpcy5kZXB0aFtnZW9tSW5kZXhdW3Bvc0luZGV4XTw9MClcbnJldHVybiBMb2NhdGlvbi5FWFRFUklPUjtyZXR1cm4gTG9jYXRpb24uSU5URVJJT1I7fTtqc3RzLmdlb21ncmFwaC5EZXB0aC5wcm90b3R5cGUuYWRkPWZ1bmN0aW9uKGdlb21JbmRleCxwb3NJbmRleCxsb2NhdGlvbil7aWYobG9jYXRpb249PT1Mb2NhdGlvbi5JTlRFUklPUilcbnRoaXMuZGVwdGhbZ2VvbUluZGV4XVtwb3NJbmRleF0rKzt9O2pzdHMuZ2VvbWdyYXBoLkRlcHRoLnByb3RvdHlwZS5pc051bGw9ZnVuY3Rpb24oKXtpZihhcmd1bWVudHMubGVuZ3RoPjApe3JldHVybiB0aGlzLmlzTnVsbDIuYXBwbHkodGhpcyxhcmd1bWVudHMpO31cbmZvcih2YXIgaT0wO2k8MjtpKyspe2Zvcih2YXIgaj0wO2o8MztqKyspe2lmKHRoaXMuZGVwdGhbaV1bal0hPT1qc3RzLmdlb21ncmFwaC5EZXB0aC5OVUxMX1ZBTFVFKVxucmV0dXJuIGZhbHNlO319XG5yZXR1cm4gdHJ1ZTt9O2pzdHMuZ2VvbWdyYXBoLkRlcHRoLnByb3RvdHlwZS5pc051bGwyPWZ1bmN0aW9uKGdlb21JbmRleCl7aWYoYXJndW1lbnRzLmxlbmd0aD4xKXtyZXR1cm4gdGhpcy5pc051bGwzLmFwcGx5KHRoaXMsYXJndW1lbnRzKTt9XG5yZXR1cm4gdGhpcy5kZXB0aFtnZW9tSW5kZXhdWzFdPT1qc3RzLmdlb21ncmFwaC5EZXB0aC5OVUxMX1ZBTFVFO307anN0cy5nZW9tZ3JhcGguRGVwdGgucHJvdG90eXBlLmlzTnVsbDM9ZnVuY3Rpb24oZ2VvbUluZGV4LHBvc0luZGV4KXtyZXR1cm4gdGhpcy5kZXB0aFtnZW9tSW5kZXhdW3Bvc0luZGV4XT09anN0cy5nZW9tZ3JhcGguRGVwdGguTlVMTF9WQUxVRTt9O2pzdHMuZ2VvbWdyYXBoLkRlcHRoLnByb3RvdHlwZS5hZGQ9ZnVuY3Rpb24obGJsKXtmb3IodmFyIGk9MDtpPDI7aSsrKXtmb3IodmFyIGo9MTtqPDM7aisrKXt2YXIgbG9jPWxibC5nZXRMb2NhdGlvbihpLGopO2lmKGxvYz09PUxvY2F0aW9uLkVYVEVSSU9SfHxsb2M9PT1Mb2NhdGlvbi5JTlRFUklPUil7aWYodGhpcy5pc051bGwoaSxqKSl7dGhpcy5kZXB0aFtpXVtqXT1qc3RzLmdlb21ncmFwaC5EZXB0aC5kZXB0aEF0TG9jYXRpb24obG9jKTt9ZWxzZVxudGhpcy5kZXB0aFtpXVtqXSs9anN0cy5nZW9tZ3JhcGguRGVwdGguZGVwdGhBdExvY2F0aW9uKGxvYyk7fX19fTtqc3RzLmdlb21ncmFwaC5EZXB0aC5wcm90b3R5cGUuZ2V0RGVsdGE9ZnVuY3Rpb24oZ2VvbUluZGV4KXtyZXR1cm4gdGhpcy5kZXB0aFtnZW9tSW5kZXhdW1Bvc2l0aW9uLlJJR0hUXS1cbnRoaXMuZGVwdGhbZ2VvbUluZGV4XVtQb3NpdGlvbi5MRUZUXTt9O2pzdHMuZ2VvbWdyYXBoLkRlcHRoLnByb3RvdHlwZS5ub3JtYWxpemU9ZnVuY3Rpb24oKXtmb3IodmFyIGk9MDtpPDI7aSsrKXtpZighdGhpcy5pc051bGwoaSkpe3ZhciBtaW5EZXB0aD10aGlzLmRlcHRoW2ldWzFdO2lmKHRoaXMuZGVwdGhbaV1bMl08bWluRGVwdGgpXG5taW5EZXB0aD10aGlzLmRlcHRoW2ldWzJdO2lmKG1pbkRlcHRoPDApXG5taW5EZXB0aD0wO2Zvcih2YXIgaj0xO2o8MztqKyspe3ZhciBuZXdWYWx1ZT0wO2lmKHRoaXMuZGVwdGhbaV1bal0+bWluRGVwdGgpXG5uZXdWYWx1ZT0xO3RoaXMuZGVwdGhbaV1bal09bmV3VmFsdWU7fX19fTtqc3RzLmdlb21ncmFwaC5EZXB0aC5wcm90b3R5cGUudG9TdHJpbmc9ZnVuY3Rpb24oKXtyZXR1cm4nQTogJyt0aGlzLmRlcHRoWzBdWzFdKycsJyt0aGlzLmRlcHRoWzBdWzJdKycgQjogJytcbnRoaXMuZGVwdGhbMV1bMV0rJywnK3RoaXMuZGVwdGhbMV1bMl07fTt9KSgpO2pzdHMuYWxnb3JpdGhtLkJvdW5kYXJ5Tm9kZVJ1bGU9ZnVuY3Rpb24oKXt9O2pzdHMuYWxnb3JpdGhtLkJvdW5kYXJ5Tm9kZVJ1bGUucHJvdG90eXBlLmlzSW5Cb3VuZGFyeT1mdW5jdGlvbihib3VuZGFyeUNvdW50KXt0aHJvdyBuZXcganN0cy5lcnJvci5BYnN0cmFjdE1ldGhvZEludm9jYXRpb25FcnJvcigpO307anN0cy5hbGdvcml0aG0uTW9kMkJvdW5kYXJ5Tm9kZVJ1bGU9ZnVuY3Rpb24oKXt9O2pzdHMuYWxnb3JpdGhtLk1vZDJCb3VuZGFyeU5vZGVSdWxlLnByb3RvdHlwZT1uZXcganN0cy5hbGdvcml0aG0uQm91bmRhcnlOb2RlUnVsZSgpO2pzdHMuYWxnb3JpdGhtLk1vZDJCb3VuZGFyeU5vZGVSdWxlLnByb3RvdHlwZS5pc0luQm91bmRhcnk9ZnVuY3Rpb24oYm91bmRhcnlDb3VudCl7cmV0dXJuIGJvdW5kYXJ5Q291bnQlMj09PTE7fTtqc3RzLmFsZ29yaXRobS5Cb3VuZGFyeU5vZGVSdWxlLk1PRDJfQk9VTkRBUllfUlVMRT1uZXcganN0cy5hbGdvcml0aG0uTW9kMkJvdW5kYXJ5Tm9kZVJ1bGUoKTtqc3RzLmFsZ29yaXRobS5Cb3VuZGFyeU5vZGVSdWxlLk9HQ19TRlNfQk9VTkRBUllfUlVMRT1qc3RzLmFsZ29yaXRobS5Cb3VuZGFyeU5vZGVSdWxlLk1PRDJfQk9VTkRBUllfUlVMRTtqc3RzLm9wZXJhdGlvbi5kaXN0YW5jZS5HZW9tZXRyeUxvY2F0aW9uPWZ1bmN0aW9uKGNvbXBvbmVudCxzZWdJbmRleCxwdCl7dGhpcy5jb21wb25lbnQ9Y29tcG9uZW50O3RoaXMuc2VnSW5kZXg9c2VnSW5kZXg7dGhpcy5wdD1wdDt9O2pzdHMub3BlcmF0aW9uLmRpc3RhbmNlLkdlb21ldHJ5TG9jYXRpb24uSU5TSURFX0FSRUE9LTE7anN0cy5vcGVyYXRpb24uZGlzdGFuY2UuR2VvbWV0cnlMb2NhdGlvbi5wcm90b3R5cGUuY29tcG9uZW50PW51bGw7anN0cy5vcGVyYXRpb24uZGlzdGFuY2UuR2VvbWV0cnlMb2NhdGlvbi5wcm90b3R5cGUuc2VnSW5kZXg9bnVsbDtqc3RzLm9wZXJhdGlvbi5kaXN0YW5jZS5HZW9tZXRyeUxvY2F0aW9uLnByb3RvdHlwZS5wdD1udWxsO2pzdHMub3BlcmF0aW9uLmRpc3RhbmNlLkdlb21ldHJ5TG9jYXRpb24ucHJvdG90eXBlLmdldEdlb21ldHJ5Q29tcG9uZW50PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuY29tcG9uZW50O307anN0cy5vcGVyYXRpb24uZGlzdGFuY2UuR2VvbWV0cnlMb2NhdGlvbi5wcm90b3R5cGUuZ2V0U2VnbWVudEluZGV4PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuc2VnSW5kZXg7fTtqc3RzLm9wZXJhdGlvbi5kaXN0YW5jZS5HZW9tZXRyeUxvY2F0aW9uLnByb3RvdHlwZS5nZXRDb29yZGluYXRlPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMucHQ7fTtqc3RzLm9wZXJhdGlvbi5kaXN0YW5jZS5HZW9tZXRyeUxvY2F0aW9uLnByb3RvdHlwZS5pc0luc2lkZUFyZWE9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5zZWdJbmRleD09PWpzdHMub3BlcmF0aW9uLmRpc3RhbmNlLkdlb21ldHJ5TG9jYXRpb24uSU5TSURFX0FSRUE7fTtqc3RzLmdlb20udXRpbC5Qb2ludEV4dHJhY3Rlcj1mdW5jdGlvbihwdHMpe3RoaXMucHRzPXB0czt9O2pzdHMuZ2VvbS51dGlsLlBvaW50RXh0cmFjdGVyLnByb3RvdHlwZT1uZXcganN0cy5nZW9tLkdlb21ldHJ5RmlsdGVyKCk7anN0cy5nZW9tLnV0aWwuUG9pbnRFeHRyYWN0ZXIucHJvdG90eXBlLnB0cz1udWxsO2pzdHMuZ2VvbS51dGlsLlBvaW50RXh0cmFjdGVyLmdldFBvaW50cz1mdW5jdGlvbihnZW9tLGxpc3Qpe2lmKGxpc3Q9PT11bmRlZmluZWQpe2xpc3Q9W107fVxuaWYoZ2VvbSBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5Qb2ludCl7bGlzdC5wdXNoKGdlb20pO31lbHNlIGlmKGdlb20gaW5zdGFuY2VvZiBqc3RzLmdlb20uR2VvbWV0cnlDb2xsZWN0aW9ufHxnZW9tIGluc3RhbmNlb2YganN0cy5nZW9tLk11bHRpUG9pbnR8fGdlb20gaW5zdGFuY2VvZiBqc3RzLmdlb20uTXVsdGlMaW5lU3RyaW5nfHxnZW9tIGluc3RhbmNlb2YganN0cy5nZW9tLk11bHRpUG9seWdvbil7Z2VvbS5hcHBseShuZXcganN0cy5nZW9tLnV0aWwuUG9pbnRFeHRyYWN0ZXIobGlzdCkpO31cbnJldHVybiBsaXN0O307anN0cy5nZW9tLnV0aWwuUG9pbnRFeHRyYWN0ZXIucHJvdG90eXBlLmZpbHRlcj1mdW5jdGlvbihnZW9tKXtpZihnZW9tIGluc3RhbmNlb2YganN0cy5nZW9tLlBvaW50KVxudGhpcy5wdHMucHVzaChnZW9tKTt9OyhmdW5jdGlvbigpe3ZhciBMb2NhdGlvbj1qc3RzLmdlb20uTG9jYXRpb247anN0cy5vcGVyYXRpb24ucmVsYXRlLlJlbGF0ZU5vZGVHcmFwaD1mdW5jdGlvbigpe3RoaXMubm9kZXM9bmV3IGpzdHMuZ2VvbWdyYXBoLk5vZGVNYXAobmV3IGpzdHMub3BlcmF0aW9uLnJlbGF0ZS5SZWxhdGVOb2RlRmFjdG9yeSgpKTt9O2pzdHMub3BlcmF0aW9uLnJlbGF0ZS5SZWxhdGVOb2RlR3JhcGgucHJvdG90eXBlLm5vZGVzPW51bGw7anN0cy5vcGVyYXRpb24ucmVsYXRlLlJlbGF0ZU5vZGVHcmFwaC5wcm90b3R5cGUuYnVpbGQ9ZnVuY3Rpb24oZ2VvbUdyYXBoKXt0aGlzLmNvbXB1dGVJbnRlcnNlY3Rpb25Ob2RlcyhnZW9tR3JhcGgsMCk7dGhpcy5jb3B5Tm9kZXNBbmRMYWJlbHMoZ2VvbUdyYXBoLDApO3ZhciBlZUJ1aWxkZXI9bmV3IGpzdHMub3BlcmF0aW9uLnJlbGF0ZS5FZGdlRW5kQnVpbGRlcigpO3ZhciBlZUxpc3Q9ZWVCdWlsZGVyLmNvbXB1dGVFZGdlRW5kcyhnZW9tR3JhcGguZ2V0RWRnZUl0ZXJhdG9yKCkpO3RoaXMuaW5zZXJ0RWRnZUVuZHMoZWVMaXN0KTt9O2pzdHMub3BlcmF0aW9uLnJlbGF0ZS5SZWxhdGVOb2RlR3JhcGgucHJvdG90eXBlLmNvbXB1dGVJbnRlcnNlY3Rpb25Ob2Rlcz1mdW5jdGlvbihnZW9tR3JhcGgsYXJnSW5kZXgpe2Zvcih2YXIgZWRnZUl0PWdlb21HcmFwaC5nZXRFZGdlSXRlcmF0b3IoKTtlZGdlSXQuaGFzTmV4dCgpOyl7dmFyIGU9ZWRnZUl0Lm5leHQoKTt2YXIgZUxvYz1lLmdldExhYmVsKCkuZ2V0TG9jYXRpb24oYXJnSW5kZXgpO2Zvcih2YXIgZWlJdD1lLmdldEVkZ2VJbnRlcnNlY3Rpb25MaXN0KCkuaXRlcmF0b3IoKTtlaUl0Lmhhc05leHQoKTspe3ZhciBlaT1laUl0Lm5leHQoKTt2YXIgbj10aGlzLm5vZGVzLmFkZE5vZGUoZWkuY29vcmQpO2lmKGVMb2M9PT1Mb2NhdGlvbi5CT1VOREFSWSlcbm4uc2V0TGFiZWxCb3VuZGFyeShhcmdJbmRleCk7ZWxzZXtpZihuLmdldExhYmVsKCkuaXNOdWxsKGFyZ0luZGV4KSlcbm4uc2V0TGFiZWwoYXJnSW5kZXgsTG9jYXRpb24uSU5URVJJT1IpO319fX07anN0cy5vcGVyYXRpb24ucmVsYXRlLlJlbGF0ZU5vZGVHcmFwaC5wcm90b3R5cGUuY29weU5vZGVzQW5kTGFiZWxzPWZ1bmN0aW9uKGdlb21HcmFwaCxhcmdJbmRleCl7Zm9yKHZhciBub2RlSXQ9Z2VvbUdyYXBoLmdldE5vZGVJdGVyYXRvcigpO25vZGVJdC5oYXNOZXh0KCk7KXt2YXIgZ3JhcGhOb2RlPW5vZGVJdC5uZXh0KCk7dmFyIG5ld05vZGU9dGhpcy5ub2Rlcy5hZGROb2RlKGdyYXBoTm9kZS5nZXRDb29yZGluYXRlKCkpO25ld05vZGUuc2V0TGFiZWwoYXJnSW5kZXgsZ3JhcGhOb2RlLmdldExhYmVsKCkuZ2V0TG9jYXRpb24oYXJnSW5kZXgpKTt9fTtqc3RzLm9wZXJhdGlvbi5yZWxhdGUuUmVsYXRlTm9kZUdyYXBoLnByb3RvdHlwZS5pbnNlcnRFZGdlRW5kcz1mdW5jdGlvbihlZSl7Zm9yKHZhciBpPWVlLml0ZXJhdG9yKCk7aS5oYXNOZXh0KCk7KXt2YXIgZT1pLm5leHQoKTt0aGlzLm5vZGVzLmFkZChlKTt9fTtqc3RzLm9wZXJhdGlvbi5yZWxhdGUuUmVsYXRlTm9kZUdyYXBoLnByb3RvdHlwZS5nZXROb2RlSXRlcmF0b3I9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5ub2Rlcy5pdGVyYXRvcigpO307fSkoKTtqc3RzLmdlb21ncmFwaC5pbmRleC5TaW1wbGVTd2VlcExpbmVJbnRlcnNlY3Rvcj1mdW5jdGlvbigpe307anN0cy5nZW9tZ3JhcGguaW5kZXguU2ltcGxlU3dlZXBMaW5lSW50ZXJzZWN0b3IucHJvdG90eXBlPW5ldyBqc3RzLmdlb21ncmFwaC5pbmRleC5FZGdlU2V0SW50ZXJzZWN0b3IoKTtqc3RzLmdlb21ncmFwaC5pbmRleC5TaW1wbGVTd2VlcExpbmVJbnRlcnNlY3Rvci5wcm90b3R5cGUuZXZlbnRzPVtdO2pzdHMuZ2VvbWdyYXBoLmluZGV4LlNpbXBsZVN3ZWVwTGluZUludGVyc2VjdG9yLnByb3RvdHlwZS5uT3ZlcmxhcHM9bnVsbDtqc3RzLmdlb21ncmFwaC5pbmRleC5TaW1wbGVTd2VlcExpbmVJbnRlcnNlY3Rvci5wcm90b3R5cGUuY29tcHV0ZUludGVyc2VjdGlvbnM9ZnVuY3Rpb24oZWRnZXMsc2ksdGVzdEFsbFNlZ21lbnRzKXtpZihzaSBpbnN0YW5jZW9mIGphdmFzY3JpcHQudXRpbC5MaXN0KXt0aGlzLmNvbXB1dGVJbnRlcnNlY3Rpb25zMi5hcHBseSh0aGlzLGFyZ3VtZW50cyk7cmV0dXJuO31cbmlmKHRlc3RBbGxTZWdtZW50cyl7dGhpcy5hZGQoZWRnZXMsbnVsbCk7fWVsc2V7dGhpcy5hZGQoZWRnZXMpO31cbnRoaXMuY29tcHV0ZUludGVyc2VjdGlvbnMzKHNpKTt9O2pzdHMuZ2VvbWdyYXBoLmluZGV4LlNpbXBsZVN3ZWVwTGluZUludGVyc2VjdG9yLnByb3RvdHlwZS5jb21wdXRlSW50ZXJzZWN0aW9uczI9ZnVuY3Rpb24oZWRnZXMwLGVkZ2VzMSxzaSl7dGhpcy5hZGQoZWRnZXMwLGVkZ2VzMCk7dGhpcy5hZGQoZWRnZXMxLGVkZ2VzMSk7dGhpcy5jb21wdXRlSW50ZXJzZWN0aW9uczMoc2kpO307anN0cy5nZW9tZ3JhcGguaW5kZXguU2ltcGxlU3dlZXBMaW5lSW50ZXJzZWN0b3IucHJvdG90eXBlLmFkZD1mdW5jdGlvbihlZGdlLGVkZ2VTZXQpe2lmKGVkZ2UgaW5zdGFuY2VvZiBqYXZhc2NyaXB0LnV0aWwuTGlzdCl7dGhpcy5hZGQyLmFwcGx5KHRoaXMsYXJndW1lbnRzKTtyZXR1cm47fVxudmFyIHB0cz1lZGdlLmdldENvb3JkaW5hdGVzKCk7Zm9yKHZhciBpPTA7aTxwdHMubGVuZ3RoLTE7aSsrKXt2YXIgc3M9bmV3IGpzdHMuZ2VvbWdyYXBoLmluZGV4LlN3ZWVwTGluZVNlZ21lbnQoZWRnZSxpKTt2YXIgaW5zZXJ0RXZlbnQ9bmV3IGpzdHMuZ2VvbWdyYXBoLmluZGV4LlN3ZWVwTGluZUV2ZW50KHNzLmdldE1pblgoKSxzcyxlZGdlU2V0KTt0aGlzLmV2ZW50cy5wdXNoKGluc2VydEV2ZW50KTt0aGlzLmV2ZW50cy5wdXNoKG5ldyBqc3RzLmdlb21ncmFwaC5pbmRleC5Td2VlcExpbmVFdmVudChzcy5nZXRNYXhYKCksaW5zZXJ0RXZlbnQpKTt9fTtqc3RzLmdlb21ncmFwaC5pbmRleC5TaW1wbGVTd2VlcExpbmVJbnRlcnNlY3Rvci5wcm90b3R5cGUuYWRkMj1mdW5jdGlvbihlZGdlcyxlZGdlU2V0KXtmb3IodmFyIGk9ZWRnZXMuaXRlcmF0b3IoKTtpLmhhc05leHQoKTspe3ZhciBlZGdlPWkubmV4dCgpO2lmKGVkZ2VTZXQpe3RoaXMuYWRkKGVkZ2UsZWRnZVNldCk7fWVsc2V7dGhpcy5hZGQoZWRnZSxlZGdlKTt9fX07anN0cy5nZW9tZ3JhcGguaW5kZXguU2ltcGxlU3dlZXBMaW5lSW50ZXJzZWN0b3IucHJvdG90eXBlLnByZXBhcmVFdmVudHM9ZnVuY3Rpb24oKXt0aGlzLmV2ZW50cy5zb3J0KGZ1bmN0aW9uKGEsYil7cmV0dXJuIGEuY29tcGFyZVRvKGIpO30pO2Zvcih2YXIgaT0wO2k8dGhpcy5ldmVudHMubGVuZ3RoO2krKyl7dmFyIGV2PXRoaXMuZXZlbnRzW2ldO2lmKGV2LmlzRGVsZXRlKCkpe2V2LmdldEluc2VydEV2ZW50KCkuc2V0RGVsZXRlRXZlbnRJbmRleChpKTt9fX07anN0cy5nZW9tZ3JhcGguaW5kZXguU2ltcGxlU3dlZXBMaW5lSW50ZXJzZWN0b3IucHJvdG90eXBlLmNvbXB1dGVJbnRlcnNlY3Rpb25zMz1mdW5jdGlvbihzaSl7dGhpcy5uT3ZlcmxhcHM9MDt0aGlzLnByZXBhcmVFdmVudHMoKTtmb3IodmFyIGk9MDtpPHRoaXMuZXZlbnRzLmxlbmd0aDtpKyspe3ZhciBldj10aGlzLmV2ZW50c1tpXTtpZihldi5pc0luc2VydCgpKXt0aGlzLnByb2Nlc3NPdmVybGFwcyhpLGV2LmdldERlbGV0ZUV2ZW50SW5kZXgoKSxldixzaSk7fX19O2pzdHMuZ2VvbWdyYXBoLmluZGV4LlNpbXBsZVN3ZWVwTGluZUludGVyc2VjdG9yLnByb3RvdHlwZS5wcm9jZXNzT3ZlcmxhcHM9ZnVuY3Rpb24oc3RhcnQsZW5kLGV2MCxzaSl7dmFyIHNzMD1ldjAuZ2V0T2JqZWN0KCk7Zm9yKHZhciBpPXN0YXJ0O2k8ZW5kO2krKyl7dmFyIGV2MT10aGlzLmV2ZW50c1tpXTtpZihldjEuaXNJbnNlcnQoKSl7dmFyIHNzMT1ldjEuZ2V0T2JqZWN0KCk7aWYoIWV2MC5pc1NhbWVMYWJlbChldjEpKXtzczAuY29tcHV0ZUludGVyc2VjdGlvbnMoc3MxLHNpKTt0aGlzLm5PdmVybGFwcysrO319fX1cbmpzdHMudHJpYW5ndWxhdGUuVm9yb25vaURpYWdyYW1CdWlsZGVyPWZ1bmN0aW9uKCl7dGhpcy5zaXRlQ29vcmRzPW51bGw7dGhpcy50b2xlcmFuY2U9MC4wO3RoaXMuc3ViZGl2PW51bGw7dGhpcy5jbGlwRW52PW51bGw7dGhpcy5kaWFncmFtRW52PW51bGw7fTtqc3RzLnRyaWFuZ3VsYXRlLlZvcm9ub2lEaWFncmFtQnVpbGRlci5wcm90b3R5cGUuc2V0U2l0ZXM9ZnVuY3Rpb24oKXt2YXIgYXJnPWFyZ3VtZW50c1swXTtpZihhcmcgaW5zdGFuY2VvZiBqc3RzLmdlb20uR2VvbWV0cnl8fGFyZyBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5Db29yZGluYXRlfHxhcmcgaW5zdGFuY2VvZiBqc3RzLmdlb20uUG9pbnR8fGFyZyBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5NdWx0aVBvaW50fHxhcmcgaW5zdGFuY2VvZiBqc3RzLmdlb20uTGluZVN0cmluZ3x8YXJnIGluc3RhbmNlb2YganN0cy5nZW9tLk11bHRpTGluZVN0cmluZ3x8YXJnIGluc3RhbmNlb2YganN0cy5nZW9tLkxpbmVhclJpbmd8fGFyZyBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5Qb2x5Z29ufHxhcmcgaW5zdGFuY2VvZiBqc3RzLmdlb20uTXVsdGlQb2x5Z29uKXt0aGlzLnNldFNpdGVzQnlHZW9tZXRyeShhcmcpO31lbHNle3RoaXMuc2V0U2l0ZXNCeUFycmF5KGFyZyk7fX07anN0cy50cmlhbmd1bGF0ZS5Wb3Jvbm9pRGlhZ3JhbUJ1aWxkZXIucHJvdG90eXBlLnNldFNpdGVzQnlHZW9tZXRyeT1mdW5jdGlvbihnZW9tKXt0aGlzLnNpdGVDb29yZHM9anN0cy50cmlhbmd1bGF0ZS5EZWxhdW5heVRyaWFuZ3VsYXRpb25CdWlsZGVyLmV4dHJhY3RVbmlxdWVDb29yZGluYXRlcyhnZW9tKTt9O2pzdHMudHJpYW5ndWxhdGUuVm9yb25vaURpYWdyYW1CdWlsZGVyLnByb3RvdHlwZS5zZXRTaXRlc0J5QXJyYXk9ZnVuY3Rpb24oY29vcmRzKXt0aGlzLnNpdGVDb29yZHM9anN0cy50cmlhbmd1bGF0ZS5EZWxhdW5heVRyaWFuZ3VsYXRpb25CdWlsZGVyLnVuaXF1ZShjb29yZHMpO307anN0cy50cmlhbmd1bGF0ZS5Wb3Jvbm9pRGlhZ3JhbUJ1aWxkZXIucHJvdG90eXBlLnNldENsaXBFbnZlbG9wZT1mdW5jdGlvbihjbGlwRW52KXt0aGlzLmNsaXBFbnY9Y2xpcEVudjt9O2pzdHMudHJpYW5ndWxhdGUuVm9yb25vaURpYWdyYW1CdWlsZGVyLnByb3RvdHlwZS5zZXRUb2xlcmFuY2U9ZnVuY3Rpb24odG9sZXJhbmNlKVxue3RoaXMudG9sZXJhbmNlPXRvbGVyYW5jZTt9O2pzdHMudHJpYW5ndWxhdGUuVm9yb25vaURpYWdyYW1CdWlsZGVyLnByb3RvdHlwZS5jcmVhdGU9ZnVuY3Rpb24oKXtpZih0aGlzLnN1YmRpdiE9PW51bGwpe3JldHVybjt9XG52YXIgc2l0ZUVudixleHBhbmRCeSx2ZXJ0aWNlcyx0cmlhbmd1bGF0b3I7c2l0ZUVudj1qc3RzLnRyaWFuZ3VsYXRlLkRlbGF1bmF5VHJpYW5ndWxhdGlvbkJ1aWxkZXIuZW52ZWxvcGUodGhpcy5zaXRlQ29vcmRzKTt0aGlzLmRpYWdyYW1FbnY9c2l0ZUVudjtleHBhbmRCeT1NYXRoLm1heCh0aGlzLmRpYWdyYW1FbnYuZ2V0V2lkdGgoKSx0aGlzLmRpYWdyYW1FbnYuZ2V0SGVpZ2h0KCkpO3RoaXMuZGlhZ3JhbUVudi5leHBhbmRCeShleHBhbmRCeSk7aWYodGhpcy5jbGlwRW52IT09bnVsbCl7dGhpcy5kaWFncmFtRW52LmV4cGFuZFRvSW5jbHVkZSh0aGlzLmNsaXBFbnYpO31cbnZlcnRpY2VzPWpzdHMudHJpYW5ndWxhdGUuRGVsYXVuYXlUcmlhbmd1bGF0aW9uQnVpbGRlci50b1ZlcnRpY2VzKHRoaXMuc2l0ZUNvb3Jkcyk7dGhpcy5zdWJkaXY9bmV3IGpzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuUXVhZEVkZ2VTdWJkaXZpc2lvbihzaXRlRW52LHRoaXMudG9sZXJhbmNlKTt0cmlhbmd1bGF0b3I9bmV3IGpzdHMudHJpYW5ndWxhdGUuSW5jcmVtZW50YWxEZWxhdW5heVRyaWFuZ3VsYXRvcih0aGlzLnN1YmRpdik7dHJpYW5ndWxhdG9yLmluc2VydFNpdGVzKHZlcnRpY2VzKTt9O2pzdHMudHJpYW5ndWxhdGUuVm9yb25vaURpYWdyYW1CdWlsZGVyLnByb3RvdHlwZS5nZXRTdWJkaXZpc2lvbj1mdW5jdGlvbigpe3RoaXMuY3JlYXRlKCk7cmV0dXJuIHRoaXMuc3ViZGl2O307anN0cy50cmlhbmd1bGF0ZS5Wb3Jvbm9pRGlhZ3JhbUJ1aWxkZXIucHJvdG90eXBlLmdldERpYWdyYW09ZnVuY3Rpb24oZ2VvbUZhY3Qpe3RoaXMuY3JlYXRlKCk7dmFyIHBvbHlzPXRoaXMuc3ViZGl2LmdldFZvcm9ub2lEaWFncmFtKGdlb21GYWN0KTtyZXR1cm4gdGhpcy5jbGlwR2VvbWV0cnlDb2xsZWN0aW9uKHBvbHlzLHRoaXMuZGlhZ3JhbUVudik7fTtqc3RzLnRyaWFuZ3VsYXRlLlZvcm9ub2lEaWFncmFtQnVpbGRlci5wcm90b3R5cGUuY2xpcEdlb21ldHJ5Q29sbGVjdGlvbj1mdW5jdGlvbihnZW9tLGNsaXBFbnYpe3ZhciBjbGlwUG9seSxjbGlwcGVkLGksaWwsZyxyZXN1bHQ7Y2xpcFBvbHk9Z2VvbS5nZXRGYWN0b3J5KCkudG9HZW9tZXRyeShjbGlwRW52KTtjbGlwcGVkPVtdO2k9MCxpbD1nZW9tLmdldE51bUdlb21ldHJpZXMoKTtmb3IoaTtpPGlsO2krKyl7Zz1nZW9tLmdldEdlb21ldHJ5TihpKTtyZXN1bHQ9bnVsbDtpZihjbGlwRW52LmNvbnRhaW5zKGcuZ2V0RW52ZWxvcGVJbnRlcm5hbCgpKSl7cmVzdWx0PWc7fVxuZWxzZSBpZihjbGlwRW52LmludGVyc2VjdHMoZy5nZXRFbnZlbG9wZUludGVybmFsKCkpKXtyZXN1bHQ9Y2xpcFBvbHkuaW50ZXJzZWN0aW9uKGcpO31cbmlmKHJlc3VsdCE9PW51bGwmJiFyZXN1bHQuaXNFbXB0eSgpKXtjbGlwcGVkLnB1c2gocmVzdWx0KTt9fVxucmV0dXJuIGdlb20uZ2V0RmFjdG9yeSgpLmNyZWF0ZUdlb21ldHJ5Q29sbGVjdGlvbihjbGlwcGVkKTt9O2pzdHMub3BlcmF0aW9uLnZhbGlkLkluZGV4ZWROZXN0ZWRSaW5nVGVzdGVyPWZ1bmN0aW9uKGdyYXBoKXt0aGlzLmdyYXBoPWdyYXBoO3RoaXMucmluZ3M9bmV3IGphdmFzY3JpcHQudXRpbC5BcnJheUxpc3QoKTt0aGlzLnRvdGFsRW52PW5ldyBqc3RzLmdlb20uRW52ZWxvcGUoKTt0aGlzLmluZGV4PW51bGw7dGhpcy5uZXN0ZWRQdD1udWxsO307anN0cy5vcGVyYXRpb24udmFsaWQuSW5kZXhlZE5lc3RlZFJpbmdUZXN0ZXIucHJvdG90eXBlLmdldE5lc3RlZFBvaW50PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMubmVzdGVkUHQ7fTtqc3RzLm9wZXJhdGlvbi52YWxpZC5JbmRleGVkTmVzdGVkUmluZ1Rlc3Rlci5wcm90b3R5cGUuYWRkPWZ1bmN0aW9uKHJpbmcpe3RoaXMucmluZ3MuYWRkKHJpbmcpO3RoaXMudG90YWxFbnYuZXhwYW5kVG9JbmNsdWRlKHJpbmcuZ2V0RW52ZWxvcGVJbnRlcm5hbCgpKTt9O2pzdHMub3BlcmF0aW9uLnZhbGlkLkluZGV4ZWROZXN0ZWRSaW5nVGVzdGVyLnByb3RvdHlwZS5pc05vbk5lc3RlZD1mdW5jdGlvbigpe3RoaXMuYnVpbGRJbmRleCgpO2Zvcih2YXIgaT0wO2k8dGhpcy5yaW5ncy5zaXplKCk7aSsrKXt2YXIgaW5uZXJSaW5nPXRoaXMucmluZ3MuZ2V0KGkpO3ZhciBpbm5lclJpbmdQdHM9aW5uZXJSaW5nLmdldENvb3JkaW5hdGVzKCk7dmFyIHJlc3VsdHM9dGhpcy5pbmRleC5xdWVyeShpbm5lclJpbmcuZ2V0RW52ZWxvcGVJbnRlcm5hbCgpKTtmb3IodmFyIGo9MDtqPHJlc3VsdHMubGVuZ3RoO2orKyl7dmFyIHNlYXJjaFJpbmc9cmVzdWx0c1tqXTt2YXIgc2VhcmNoUmluZ1B0cz1zZWFyY2hSaW5nLmdldENvb3JkaW5hdGVzKCk7aWYoaW5uZXJSaW5nPT1zZWFyY2hSaW5nKXtjb250aW51ZTt9XG5pZighaW5uZXJSaW5nLmdldEVudmVsb3BlSW50ZXJuYWwoKS5pbnRlcnNlY3RzKHNlYXJjaFJpbmcuZ2V0RW52ZWxvcGVJbnRlcm5hbCgpKSl7Y29udGludWU7fVxudmFyIGlubmVyUmluZ1B0PWpzdHMub3BlcmF0aW9uLnZhbGlkLklzVmFsaWRPcC5maW5kUHROb3ROb2RlKGlubmVyUmluZ1B0cyxzZWFyY2hSaW5nLHRoaXMuZ3JhcGgpO2lmKGlubmVyUmluZ1B0PT1udWxsKXtjb250aW51ZTt9XG52YXIgaXNJbnNpZGU9anN0cy5hbGdvcml0aG0uQ0dBbGdvcml0aG1zLmlzUG9pbnRJblJpbmcoaW5uZXJSaW5nUHQsc2VhcmNoUmluZ1B0cyk7aWYoaXNJbnNpZGUpe3RoaXMubmVzdGVkUHQ9aW5uZXJSaW5nUHQ7cmV0dXJuIGZhbHNlO319fVxucmV0dXJuIHRydWU7fTtqc3RzLm9wZXJhdGlvbi52YWxpZC5JbmRleGVkTmVzdGVkUmluZ1Rlc3Rlci5wcm90b3R5cGUuYnVpbGRJbmRleD1mdW5jdGlvbigpe3RoaXMuaW5kZXg9bmV3IGpzdHMuaW5kZXguc3RydHJlZS5TVFJ0cmVlKCk7Zm9yKHZhciBpPTA7aTx0aGlzLnJpbmdzLnNpemUoKTtpKyspe3ZhciByaW5nPXRoaXMucmluZ3MuZ2V0KGkpO3ZhciBlbnY9cmluZy5nZXRFbnZlbG9wZUludGVybmFsKCk7dGhpcy5pbmRleC5pbnNlcnQoZW52LHJpbmcpO319O2pzdHMuZ2VvbWdyYXBoLmluZGV4Lk1vbm90b25lQ2hhaW49ZnVuY3Rpb24obWNlLGNoYWluSW5kZXgpe3RoaXMubWNlPW1jZTt0aGlzLmNoYWluSW5kZXg9Y2hhaW5JbmRleDt9O2pzdHMuZ2VvbWdyYXBoLmluZGV4Lk1vbm90b25lQ2hhaW4ucHJvdG90eXBlLm1jZT1udWxsO2pzdHMuZ2VvbWdyYXBoLmluZGV4Lk1vbm90b25lQ2hhaW4ucHJvdG90eXBlLmNoYWluSW5kZXg9bnVsbDtqc3RzLmdlb21ncmFwaC5pbmRleC5Nb25vdG9uZUNoYWluLnByb3RvdHlwZS5jb21wdXRlSW50ZXJzZWN0aW9ucz1mdW5jdGlvbihtYyxzaSl7dGhpcy5tY2UuY29tcHV0ZUludGVyc2VjdHNGb3JDaGFpbih0aGlzLmNoYWluSW5kZXgsbWMubWNlLG1jLmNoYWluSW5kZXgsc2kpO307anN0cy5ub2RpbmcuU2VnbWVudE5vZGU9ZnVuY3Rpb24oc2VnU3RyaW5nLGNvb3JkLHNlZ21lbnRJbmRleCxzZWdtZW50T2N0YW50KXt0aGlzLnNlZ1N0cmluZz1zZWdTdHJpbmc7dGhpcy5jb29yZD1uZXcganN0cy5nZW9tLkNvb3JkaW5hdGUoY29vcmQpO3RoaXMuc2VnbWVudEluZGV4PXNlZ21lbnRJbmRleDt0aGlzLnNlZ21lbnRPY3RhbnQ9c2VnbWVudE9jdGFudDt0aGlzLl9pc0ludGVyaW9yPSFjb29yZC5lcXVhbHMyRChzZWdTdHJpbmcuZ2V0Q29vcmRpbmF0ZShzZWdtZW50SW5kZXgpKTt9O2pzdHMubm9kaW5nLlNlZ21lbnROb2RlLnByb3RvdHlwZS5zZWdTdHJpbmc9bnVsbDtqc3RzLm5vZGluZy5TZWdtZW50Tm9kZS5wcm90b3R5cGUuY29vcmQ9bnVsbDtqc3RzLm5vZGluZy5TZWdtZW50Tm9kZS5wcm90b3R5cGUuc2VnbWVudEluZGV4PW51bGw7anN0cy5ub2RpbmcuU2VnbWVudE5vZGUucHJvdG90eXBlLnNlZ21lbnRPY3RhbnQ9bnVsbDtqc3RzLm5vZGluZy5TZWdtZW50Tm9kZS5wcm90b3R5cGUuX2lzSW50ZXJpb3I9bnVsbDtqc3RzLm5vZGluZy5TZWdtZW50Tm9kZS5wcm90b3R5cGUuZ2V0Q29vcmRpbmF0ZT1mdW5jdGlvbigpe3JldHVybiB0aGlzLmNvb3JkO307anN0cy5ub2RpbmcuU2VnbWVudE5vZGUucHJvdG90eXBlLmlzSW50ZXJpb3I9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5faXNJbnRlcmlvcjt9O2pzdHMubm9kaW5nLlNlZ21lbnROb2RlLnByb3RvdHlwZS5pc0VuZFBvaW50PWZ1bmN0aW9uKG1heFNlZ21lbnRJbmRleCl7aWYodGhpcy5zZWdtZW50SW5kZXg9PT0wJiYhdGhpcy5faXNJbnRlcmlvcilyZXR1cm4gdHJ1ZTtpZih0aGlzLnNlZ21lbnRJbmRleD09PXRoaXMubWF4U2VnbWVudEluZGV4KXJldHVybiB0cnVlO3JldHVybiBmYWxzZTt9O2pzdHMubm9kaW5nLlNlZ21lbnROb2RlLnByb3RvdHlwZS5jb21wYXJlVG89ZnVuY3Rpb24ob2JqKXt2YXIgb3RoZXI9b2JqO2lmKHRoaXMuc2VnbWVudEluZGV4PG90aGVyLnNlZ21lbnRJbmRleClyZXR1cm4tMTtpZih0aGlzLnNlZ21lbnRJbmRleD5vdGhlci5zZWdtZW50SW5kZXgpcmV0dXJuIDE7aWYodGhpcy5jb29yZC5lcXVhbHMyRChvdGhlci5jb29yZCkpcmV0dXJuIDA7cmV0dXJuIGpzdHMubm9kaW5nLlNlZ21lbnRQb2ludENvbXBhcmF0b3IuY29tcGFyZSh0aGlzLnNlZ21lbnRPY3RhbnQsdGhpcy5jb29yZCxvdGhlci5jb29yZCk7fTsoZnVuY3Rpb24oKXtqc3RzLmlvLkdlb0pTT05Xcml0ZXI9ZnVuY3Rpb24oKXt0aGlzLnBhcnNlcj1uZXcganN0cy5pby5HZW9KU09OUGFyc2VyKHRoaXMuZ2VvbWV0cnlGYWN0b3J5KTt9O2pzdHMuaW8uR2VvSlNPTldyaXRlci5wcm90b3R5cGUud3JpdGU9ZnVuY3Rpb24oZ2VvbWV0cnkpe3ZhciBnZW9Kc29uPXRoaXMucGFyc2VyLndyaXRlKGdlb21ldHJ5KTtyZXR1cm4gZ2VvSnNvbjt9O30pKCk7anN0cy5pby5PcGVuTGF5ZXJzUGFyc2VyPWZ1bmN0aW9uKGdlb21ldHJ5RmFjdG9yeSl7dGhpcy5nZW9tZXRyeUZhY3Rvcnk9Z2VvbWV0cnlGYWN0b3J5fHxuZXcganN0cy5nZW9tLkdlb21ldHJ5RmFjdG9yeSgpO307anN0cy5pby5PcGVuTGF5ZXJzUGFyc2VyLnByb3RvdHlwZS5yZWFkPWZ1bmN0aW9uKGdlb21ldHJ5KXtpZihnZW9tZXRyeS5DTEFTU19OQU1FPT09J09wZW5MYXllcnMuR2VvbWV0cnkuUG9pbnQnKXtyZXR1cm4gdGhpcy5jb252ZXJ0RnJvbVBvaW50KGdlb21ldHJ5KTt9ZWxzZSBpZihnZW9tZXRyeS5DTEFTU19OQU1FPT09J09wZW5MYXllcnMuR2VvbWV0cnkuTGluZVN0cmluZycpe3JldHVybiB0aGlzLmNvbnZlcnRGcm9tTGluZVN0cmluZyhnZW9tZXRyeSk7fWVsc2UgaWYoZ2VvbWV0cnkuQ0xBU1NfTkFNRT09PSdPcGVuTGF5ZXJzLkdlb21ldHJ5LkxpbmVhclJpbmcnKXtyZXR1cm4gdGhpcy5jb252ZXJ0RnJvbUxpbmVhclJpbmcoZ2VvbWV0cnkpO31lbHNlIGlmKGdlb21ldHJ5LkNMQVNTX05BTUU9PT0nT3BlbkxheWVycy5HZW9tZXRyeS5Qb2x5Z29uJyl7cmV0dXJuIHRoaXMuY29udmVydEZyb21Qb2x5Z29uKGdlb21ldHJ5KTt9ZWxzZSBpZihnZW9tZXRyeS5DTEFTU19OQU1FPT09J09wZW5MYXllcnMuR2VvbWV0cnkuTXVsdGlQb2ludCcpe3JldHVybiB0aGlzLmNvbnZlcnRGcm9tTXVsdGlQb2ludChnZW9tZXRyeSk7fWVsc2UgaWYoZ2VvbWV0cnkuQ0xBU1NfTkFNRT09PSdPcGVuTGF5ZXJzLkdlb21ldHJ5Lk11bHRpTGluZVN0cmluZycpe3JldHVybiB0aGlzLmNvbnZlcnRGcm9tTXVsdGlMaW5lU3RyaW5nKGdlb21ldHJ5KTt9ZWxzZSBpZihnZW9tZXRyeS5DTEFTU19OQU1FPT09J09wZW5MYXllcnMuR2VvbWV0cnkuTXVsdGlQb2x5Z29uJyl7cmV0dXJuIHRoaXMuY29udmVydEZyb21NdWx0aVBvbHlnb24oZ2VvbWV0cnkpO31lbHNlIGlmKGdlb21ldHJ5LkNMQVNTX05BTUU9PT0nT3BlbkxheWVycy5HZW9tZXRyeS5Db2xsZWN0aW9uJyl7cmV0dXJuIHRoaXMuY29udmVydEZyb21Db2xsZWN0aW9uKGdlb21ldHJ5KTt9fTtqc3RzLmlvLk9wZW5MYXllcnNQYXJzZXIucHJvdG90eXBlLmNvbnZlcnRGcm9tUG9pbnQ9ZnVuY3Rpb24ocG9pbnQpe3JldHVybiB0aGlzLmdlb21ldHJ5RmFjdG9yeS5jcmVhdGVQb2ludChuZXcganN0cy5nZW9tLkNvb3JkaW5hdGUocG9pbnQueCxwb2ludC55KSk7fTtqc3RzLmlvLk9wZW5MYXllcnNQYXJzZXIucHJvdG90eXBlLmNvbnZlcnRGcm9tTGluZVN0cmluZz1mdW5jdGlvbihsaW5lU3RyaW5nKXt2YXIgaTt2YXIgY29vcmRpbmF0ZXM9W107Zm9yKGk9MDtpPGxpbmVTdHJpbmcuY29tcG9uZW50cy5sZW5ndGg7aSsrKXtjb29yZGluYXRlcy5wdXNoKG5ldyBqc3RzLmdlb20uQ29vcmRpbmF0ZShsaW5lU3RyaW5nLmNvbXBvbmVudHNbaV0ueCxsaW5lU3RyaW5nLmNvbXBvbmVudHNbaV0ueSkpO31cbnJldHVybiB0aGlzLmdlb21ldHJ5RmFjdG9yeS5jcmVhdGVMaW5lU3RyaW5nKGNvb3JkaW5hdGVzKTt9O2pzdHMuaW8uT3BlbkxheWVyc1BhcnNlci5wcm90b3R5cGUuY29udmVydEZyb21MaW5lYXJSaW5nPWZ1bmN0aW9uKGxpbmVhclJpbmcpe3ZhciBpO3ZhciBjb29yZGluYXRlcz1bXTtmb3IoaT0wO2k8bGluZWFyUmluZy5jb21wb25lbnRzLmxlbmd0aDtpKyspe2Nvb3JkaW5hdGVzLnB1c2gobmV3IGpzdHMuZ2VvbS5Db29yZGluYXRlKGxpbmVhclJpbmcuY29tcG9uZW50c1tpXS54LGxpbmVhclJpbmcuY29tcG9uZW50c1tpXS55KSk7fVxucmV0dXJuIHRoaXMuZ2VvbWV0cnlGYWN0b3J5LmNyZWF0ZUxpbmVhclJpbmcoY29vcmRpbmF0ZXMpO307anN0cy5pby5PcGVuTGF5ZXJzUGFyc2VyLnByb3RvdHlwZS5jb252ZXJ0RnJvbVBvbHlnb249ZnVuY3Rpb24ocG9seWdvbil7dmFyIGk7dmFyIHNoZWxsPW51bGw7dmFyIGhvbGVzPVtdO2ZvcihpPTA7aTxwb2x5Z29uLmNvbXBvbmVudHMubGVuZ3RoO2krKyl7dmFyIGxpbmVhclJpbmc9dGhpcy5jb252ZXJ0RnJvbUxpbmVhclJpbmcocG9seWdvbi5jb21wb25lbnRzW2ldKTtpZihpPT09MCl7c2hlbGw9bGluZWFyUmluZzt9ZWxzZXtob2xlcy5wdXNoKGxpbmVhclJpbmcpO319XG5yZXR1cm4gdGhpcy5nZW9tZXRyeUZhY3RvcnkuY3JlYXRlUG9seWdvbihzaGVsbCxob2xlcyk7fTtqc3RzLmlvLk9wZW5MYXllcnNQYXJzZXIucHJvdG90eXBlLmNvbnZlcnRGcm9tTXVsdGlQb2ludD1mdW5jdGlvbihtdWx0aVBvaW50KXt2YXIgaTt2YXIgcG9pbnRzPVtdO2ZvcihpPTA7aTxtdWx0aVBvaW50LmNvbXBvbmVudHMubGVuZ3RoO2krKyl7cG9pbnRzLnB1c2godGhpcy5jb252ZXJ0RnJvbVBvaW50KG11bHRpUG9pbnQuY29tcG9uZW50c1tpXSkpO31cbnJldHVybiB0aGlzLmdlb21ldHJ5RmFjdG9yeS5jcmVhdGVNdWx0aVBvaW50KHBvaW50cyk7fTtqc3RzLmlvLk9wZW5MYXllcnNQYXJzZXIucHJvdG90eXBlLmNvbnZlcnRGcm9tTXVsdGlMaW5lU3RyaW5nPWZ1bmN0aW9uKG11bHRpTGluZVN0cmluZyl7dmFyIGk7dmFyIGxpbmVTdHJpbmdzPVtdO2ZvcihpPTA7aTxtdWx0aUxpbmVTdHJpbmcuY29tcG9uZW50cy5sZW5ndGg7aSsrKXtsaW5lU3RyaW5ncy5wdXNoKHRoaXMuY29udmVydEZyb21MaW5lU3RyaW5nKG11bHRpTGluZVN0cmluZy5jb21wb25lbnRzW2ldKSk7fVxucmV0dXJuIHRoaXMuZ2VvbWV0cnlGYWN0b3J5LmNyZWF0ZU11bHRpTGluZVN0cmluZyhsaW5lU3RyaW5ncyk7fTtqc3RzLmlvLk9wZW5MYXllcnNQYXJzZXIucHJvdG90eXBlLmNvbnZlcnRGcm9tTXVsdGlQb2x5Z29uPWZ1bmN0aW9uKG11bHRpUG9seWdvbil7dmFyIGk7dmFyIHBvbHlnb25zPVtdO2ZvcihpPTA7aTxtdWx0aVBvbHlnb24uY29tcG9uZW50cy5sZW5ndGg7aSsrKXtwb2x5Z29ucy5wdXNoKHRoaXMuY29udmVydEZyb21Qb2x5Z29uKG11bHRpUG9seWdvbi5jb21wb25lbnRzW2ldKSk7fVxucmV0dXJuIHRoaXMuZ2VvbWV0cnlGYWN0b3J5LmNyZWF0ZU11bHRpUG9seWdvbihwb2x5Z29ucyk7fTtqc3RzLmlvLk9wZW5MYXllcnNQYXJzZXIucHJvdG90eXBlLmNvbnZlcnRGcm9tQ29sbGVjdGlvbj1mdW5jdGlvbihjb2xsZWN0aW9uKXt2YXIgaTt2YXIgZ2VvbWV0cmllcz1bXTtmb3IoaT0wO2k8Y29sbGVjdGlvbi5jb21wb25lbnRzLmxlbmd0aDtpKyspe2dlb21ldHJpZXMucHVzaCh0aGlzLnJlYWQoY29sbGVjdGlvbi5jb21wb25lbnRzW2ldKSk7fVxucmV0dXJuIHRoaXMuZ2VvbWV0cnlGYWN0b3J5LmNyZWF0ZUdlb21ldHJ5Q29sbGVjdGlvbihnZW9tZXRyaWVzKTt9O2pzdHMuaW8uT3BlbkxheWVyc1BhcnNlci5wcm90b3R5cGUud3JpdGU9ZnVuY3Rpb24oZ2VvbWV0cnkpe2lmKGdlb21ldHJ5LkNMQVNTX05BTUU9PT0nanN0cy5nZW9tLlBvaW50Jyl7cmV0dXJuIHRoaXMuY29udmVydFRvUG9pbnQoZ2VvbWV0cnkuY29vcmRpbmF0ZSk7fWVsc2UgaWYoZ2VvbWV0cnkuQ0xBU1NfTkFNRT09PSdqc3RzLmdlb20uTGluZVN0cmluZycpe3JldHVybiB0aGlzLmNvbnZlcnRUb0xpbmVTdHJpbmcoZ2VvbWV0cnkpO31lbHNlIGlmKGdlb21ldHJ5LkNMQVNTX05BTUU9PT0nanN0cy5nZW9tLkxpbmVhclJpbmcnKXtyZXR1cm4gdGhpcy5jb252ZXJ0VG9MaW5lYXJSaW5nKGdlb21ldHJ5KTt9ZWxzZSBpZihnZW9tZXRyeS5DTEFTU19OQU1FPT09J2pzdHMuZ2VvbS5Qb2x5Z29uJyl7cmV0dXJuIHRoaXMuY29udmVydFRvUG9seWdvbihnZW9tZXRyeSk7fWVsc2UgaWYoZ2VvbWV0cnkuQ0xBU1NfTkFNRT09PSdqc3RzLmdlb20uTXVsdGlQb2ludCcpe3JldHVybiB0aGlzLmNvbnZlcnRUb011bHRpUG9pbnQoZ2VvbWV0cnkpO31lbHNlIGlmKGdlb21ldHJ5LkNMQVNTX05BTUU9PT0nanN0cy5nZW9tLk11bHRpTGluZVN0cmluZycpe3JldHVybiB0aGlzLmNvbnZlcnRUb011bHRpTGluZVN0cmluZyhnZW9tZXRyeSk7fWVsc2UgaWYoZ2VvbWV0cnkuQ0xBU1NfTkFNRT09PSdqc3RzLmdlb20uTXVsdGlQb2x5Z29uJyl7cmV0dXJuIHRoaXMuY29udmVydFRvTXVsdGlQb2x5Z29uKGdlb21ldHJ5KTt9ZWxzZSBpZihnZW9tZXRyeS5DTEFTU19OQU1FPT09J2pzdHMuZ2VvbS5HZW9tZXRyeUNvbGxlY3Rpb24nKXtyZXR1cm4gdGhpcy5jb252ZXJ0VG9Db2xsZWN0aW9uKGdlb21ldHJ5KTt9fTtqc3RzLmlvLk9wZW5MYXllcnNQYXJzZXIucHJvdG90eXBlLmNvbnZlcnRUb1BvaW50PWZ1bmN0aW9uKGNvb3JkaW5hdGUpe3JldHVybiBuZXcgT3BlbkxheWVycy5HZW9tZXRyeS5Qb2ludChjb29yZGluYXRlLngsY29vcmRpbmF0ZS55KTt9O2pzdHMuaW8uT3BlbkxheWVyc1BhcnNlci5wcm90b3R5cGUuY29udmVydFRvTGluZVN0cmluZz1mdW5jdGlvbihsaW5lU3RyaW5nKXt2YXIgaTt2YXIgcG9pbnRzPVtdO2ZvcihpPTA7aTxsaW5lU3RyaW5nLnBvaW50cy5sZW5ndGg7aSsrKXt2YXIgY29vcmRpbmF0ZT1saW5lU3RyaW5nLnBvaW50c1tpXTtwb2ludHMucHVzaCh0aGlzLmNvbnZlcnRUb1BvaW50KGNvb3JkaW5hdGUpKTt9XG5yZXR1cm4gbmV3IE9wZW5MYXllcnMuR2VvbWV0cnkuTGluZVN0cmluZyhwb2ludHMpO307anN0cy5pby5PcGVuTGF5ZXJzUGFyc2VyLnByb3RvdHlwZS5jb252ZXJ0VG9MaW5lYXJSaW5nPWZ1bmN0aW9uKGxpbmVhclJpbmcpe3ZhciBpO3ZhciBwb2ludHM9W107Zm9yKGk9MDtpPGxpbmVhclJpbmcucG9pbnRzLmxlbmd0aDtpKyspe3ZhciBjb29yZGluYXRlPWxpbmVhclJpbmcucG9pbnRzW2ldO3BvaW50cy5wdXNoKHRoaXMuY29udmVydFRvUG9pbnQoY29vcmRpbmF0ZSkpO31cbnJldHVybiBuZXcgT3BlbkxheWVycy5HZW9tZXRyeS5MaW5lYXJSaW5nKHBvaW50cyk7fTtqc3RzLmlvLk9wZW5MYXllcnNQYXJzZXIucHJvdG90eXBlLmNvbnZlcnRUb1BvbHlnb249ZnVuY3Rpb24ocG9seWdvbil7dmFyIGk7dmFyIHJpbmdzPVtdO3JpbmdzLnB1c2godGhpcy5jb252ZXJ0VG9MaW5lYXJSaW5nKHBvbHlnb24uc2hlbGwpKTtmb3IoaT0wO2k8cG9seWdvbi5ob2xlcy5sZW5ndGg7aSsrKXt2YXIgcmluZz1wb2x5Z29uLmhvbGVzW2ldO3JpbmdzLnB1c2godGhpcy5jb252ZXJ0VG9MaW5lYXJSaW5nKHJpbmcpKTt9XG5yZXR1cm4gbmV3IE9wZW5MYXllcnMuR2VvbWV0cnkuUG9seWdvbihyaW5ncyk7fTtqc3RzLmlvLk9wZW5MYXllcnNQYXJzZXIucHJvdG90eXBlLmNvbnZlcnRUb011bHRpUG9pbnQ9ZnVuY3Rpb24obXVsdGlQb2ludCl7dmFyIGk7dmFyIHBvaW50cz1bXTtmb3IoaT0wO2k8bXVsdGlQb2ludC5nZW9tZXRyaWVzLmxlbmd0aDtpKyspe3ZhciBjb29yZGluYXRlPW11bHRpUG9pbnQuZ2VvbWV0cmllc1tpXS5jb29yZGluYXRlO3BvaW50cy5wdXNoKG5ldyBPcGVuTGF5ZXJzLkdlb21ldHJ5LlBvaW50KGNvb3JkaW5hdGUueCxjb29yZGluYXRlLnkpKTt9XG5yZXR1cm4gbmV3IE9wZW5MYXllcnMuR2VvbWV0cnkuTXVsdGlQb2ludChwb2ludHMpO307anN0cy5pby5PcGVuTGF5ZXJzUGFyc2VyLnByb3RvdHlwZS5jb252ZXJ0VG9NdWx0aUxpbmVTdHJpbmc9ZnVuY3Rpb24obXVsdGlMaW5lU3RyaW5nKXt2YXIgaTt2YXIgbGluZVN0cmluZ3M9W107Zm9yKGk9MDtpPG11bHRpTGluZVN0cmluZy5nZW9tZXRyaWVzLmxlbmd0aDtpKyspe2xpbmVTdHJpbmdzLnB1c2godGhpcy5jb252ZXJ0VG9MaW5lU3RyaW5nKG11bHRpTGluZVN0cmluZy5nZW9tZXRyaWVzW2ldKSk7fVxucmV0dXJuIG5ldyBPcGVuTGF5ZXJzLkdlb21ldHJ5Lk11bHRpTGluZVN0cmluZyhsaW5lU3RyaW5ncyk7fTtqc3RzLmlvLk9wZW5MYXllcnNQYXJzZXIucHJvdG90eXBlLmNvbnZlcnRUb011bHRpUG9seWdvbj1mdW5jdGlvbihtdWx0aVBvbHlnb24pe3ZhciBpO3ZhciBwb2x5Z29ucz1bXTtmb3IoaT0wO2k8bXVsdGlQb2x5Z29uLmdlb21ldHJpZXMubGVuZ3RoO2krKyl7cG9seWdvbnMucHVzaCh0aGlzLmNvbnZlcnRUb1BvbHlnb24obXVsdGlQb2x5Z29uLmdlb21ldHJpZXNbaV0pKTt9XG5yZXR1cm4gbmV3IE9wZW5MYXllcnMuR2VvbWV0cnkuTXVsdGlQb2x5Z29uKHBvbHlnb25zKTt9O2pzdHMuaW8uT3BlbkxheWVyc1BhcnNlci5wcm90b3R5cGUuY29udmVydFRvQ29sbGVjdGlvbj1mdW5jdGlvbihnZW9tZXRyeUNvbGxlY3Rpb24pe3ZhciBpO3ZhciBnZW9tZXRyaWVzPVtdO2ZvcihpPTA7aTxnZW9tZXRyeUNvbGxlY3Rpb24uZ2VvbWV0cmllcy5sZW5ndGg7aSsrKXt2YXIgZ2VvbWV0cnk9Z2VvbWV0cnlDb2xsZWN0aW9uLmdlb21ldHJpZXNbaV07dmFyIGdlb21ldHJ5T3BlbkxheWVycz10aGlzLndyaXRlKGdlb21ldHJ5KTtnZW9tZXRyaWVzLnB1c2goZ2VvbWV0cnlPcGVuTGF5ZXJzKTt9XG5yZXR1cm4gbmV3IE9wZW5MYXllcnMuR2VvbWV0cnkuQ29sbGVjdGlvbihnZW9tZXRyaWVzKTt9O2pzdHMuaW5kZXgucXVhZHRyZWUuUXVhZHRyZWU9ZnVuY3Rpb24oKXt0aGlzLnJvb3Q9bmV3IGpzdHMuaW5kZXgucXVhZHRyZWUuUm9vdCgpO3RoaXMubWluRXh0ZW50PTEuMDt9O2pzdHMuaW5kZXgucXVhZHRyZWUuUXVhZHRyZWUuZW5zdXJlRXh0ZW50PWZ1bmN0aW9uKGl0ZW1FbnYsbWluRXh0ZW50KXt2YXIgbWlueCxtYXh4LG1pbnksbWF4eTttaW54PWl0ZW1FbnYuZ2V0TWluWCgpO21heHg9aXRlbUVudi5nZXRNYXhYKCk7bWlueT1pdGVtRW52LmdldE1pblkoKTttYXh5PWl0ZW1FbnYuZ2V0TWF4WSgpO2lmKG1pbnghPT1tYXh4JiZtaW55IT09bWF4eSl7cmV0dXJuIGl0ZW1FbnY7fVxuaWYobWlueD09PW1heHgpe21pbng9bWlueC0obWluRXh0ZW50LzIuMCk7bWF4eD1taW54KyhtaW5FeHRlbnQvMi4wKTt9XG5pZihtaW55PT09bWF4eSl7bWlueT1taW55LShtaW5FeHRlbnQvMi4wKTttYXh5PW1pbnkrKG1pbkV4dGVudC8yLjApO31cbnJldHVybiBuZXcganN0cy5nZW9tLkVudmVsb3BlKG1pbngsbWF4eCxtaW55LG1heHkpO307anN0cy5pbmRleC5xdWFkdHJlZS5RdWFkdHJlZS5wcm90b3R5cGUuZGVwdGg9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5yb290LmRlcHRoKCk7fTtqc3RzLmluZGV4LnF1YWR0cmVlLlF1YWR0cmVlLnByb3RvdHlwZS5zaXplPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMucm9vdC5zaXplKCk7fTtqc3RzLmluZGV4LnF1YWR0cmVlLlF1YWR0cmVlLnByb3RvdHlwZS5pbnNlcnQ9ZnVuY3Rpb24oaXRlbUVudixpdGVtKXt0aGlzLmNvbGxlY3RTdGF0cyhpdGVtRW52KTt2YXIgaW5zZXJ0RW52PWpzdHMuaW5kZXgucXVhZHRyZWUuUXVhZHRyZWUuZW5zdXJlRXh0ZW50KGl0ZW1FbnYsdGhpcy5taW5FeHRlbnQpO3RoaXMucm9vdC5pbnNlcnQoaW5zZXJ0RW52LGl0ZW0pO307anN0cy5pbmRleC5xdWFkdHJlZS5RdWFkdHJlZS5wcm90b3R5cGUucmVtb3ZlPWZ1bmN0aW9uKGl0ZW1FbnYsaXRlbSl7dmFyIHBvc0Vudj1qc3RzLmluZGV4LnF1YWR0cmVlLlF1YWR0cmVlLmVuc3VyZUV4dGVudChpdGVtRW52LHRoaXMubWluRXh0ZW50KTtyZXR1cm4gdGhpcy5yb290LnJlbW92ZShwb3NFbnYsaXRlbSk7fTtqc3RzLmluZGV4LnF1YWR0cmVlLlF1YWR0cmVlLnByb3RvdHlwZS5xdWVyeT1mdW5jdGlvbigpe2lmKGFyZ3VtZW50cy5sZW5ndGg9PT0xKXtyZXR1cm4ganN0cy5pbmRleC5xdWFkdHJlZS5RdWFkdHJlZS5wcm90b3R5cGUucXVlcnlCeUVudmVsb3BlLmFwcGx5KHRoaXMsYXJndW1lbnRzKTt9ZWxzZXtqc3RzLmluZGV4LnF1YWR0cmVlLlF1YWR0cmVlLnByb3RvdHlwZS5xdWVyeVdpdGhWaXNpdG9yLmFwcGx5KHRoaXMsYXJndW1lbnRzKTt9fTtqc3RzLmluZGV4LnF1YWR0cmVlLlF1YWR0cmVlLnByb3RvdHlwZS5xdWVyeUJ5RW52ZWxvcGU9ZnVuY3Rpb24oc2VhcmNoRW52KXt2YXIgdmlzaXRvcj1uZXcganN0cy5pbmRleC5BcnJheUxpc3RWaXNpdG9yKCk7dGhpcy5xdWVyeShzZWFyY2hFbnYsdmlzaXRvcik7cmV0dXJuIHZpc2l0b3IuZ2V0SXRlbXMoKTt9O2pzdHMuaW5kZXgucXVhZHRyZWUuUXVhZHRyZWUucHJvdG90eXBlLnF1ZXJ5V2l0aFZpc2l0b3I9ZnVuY3Rpb24oc2VhcmNoRW52LHZpc2l0b3Ipe3RoaXMucm9vdC52aXNpdChzZWFyY2hFbnYsdmlzaXRvcik7fTtqc3RzLmluZGV4LnF1YWR0cmVlLlF1YWR0cmVlLnByb3RvdHlwZS5xdWVyeUFsbD1mdW5jdGlvbigpe3ZhciBmb3VuZEl0ZW1zPVtdO2ZvdW5kSXRlbXM9dGhpcy5yb290LmFkZEFsbEl0ZW1zKGZvdW5kSXRlbXMpO3JldHVybiBmb3VuZEl0ZW1zO307anN0cy5pbmRleC5xdWFkdHJlZS5RdWFkdHJlZS5wcm90b3R5cGUuY29sbGVjdFN0YXRzPWZ1bmN0aW9uKGl0ZW1FbnYpe3ZhciBkZWxYPWl0ZW1FbnYuZ2V0V2lkdGgoKTtpZihkZWxYPHRoaXMubWluRXh0ZW50JiZkZWxYPjAuMCl7dGhpcy5taW5FeHRlbnQ9ZGVsWDt9XG52YXIgZGVsWT1pdGVtRW52LmdldEhlaWdodCgpO2lmKGRlbFk8dGhpcy5taW5FeHRlbnQmJmRlbFk+MC4wKXt0aGlzLm1pbkV4dGVudD1kZWxZO319O2pzdHMub3BlcmF0aW9uLnJlbGF0ZS5SZWxhdGVOb2RlRmFjdG9yeT1mdW5jdGlvbigpe307anN0cy5vcGVyYXRpb24ucmVsYXRlLlJlbGF0ZU5vZGVGYWN0b3J5LnByb3RvdHlwZT1uZXcganN0cy5nZW9tZ3JhcGguTm9kZUZhY3RvcnkoKTtqc3RzLm9wZXJhdGlvbi5yZWxhdGUuUmVsYXRlTm9kZUZhY3RvcnkucHJvdG90eXBlLmNyZWF0ZU5vZGU9ZnVuY3Rpb24oY29vcmQpe3JldHVybiBuZXcganN0cy5vcGVyYXRpb24ucmVsYXRlLlJlbGF0ZU5vZGUoY29vcmQsbmV3IGpzdHMub3BlcmF0aW9uLnJlbGF0ZS5FZGdlRW5kQnVuZGxlU3RhcigpKTt9O2pzdHMuaW5kZXgucXVhZHRyZWUuS2V5PWZ1bmN0aW9uKGl0ZW1FbnYpe3RoaXMucHQ9bmV3IGpzdHMuZ2VvbS5Db29yZGluYXRlKCk7dGhpcy5sZXZlbD0wO3RoaXMuZW52PW51bGw7dGhpcy5jb21wdXRlS2V5KGl0ZW1FbnYpO307anN0cy5pbmRleC5xdWFkdHJlZS5LZXkuY29tcHV0ZVF1YWRMZXZlbD1mdW5jdGlvbihlbnYpe3ZhciBkeCxkeSxkTWF4LGxldmVsO2R4PWVudi5nZXRXaWR0aCgpO2R5PWVudi5nZXRIZWlnaHQoKTtkTWF4PWR4PmR5P2R4OmR5O2xldmVsPWpzdHMuaW5kZXguRG91YmxlQml0cy5leHBvbmVudChkTWF4KSsxO3JldHVybiBsZXZlbDt9O2pzdHMuaW5kZXgucXVhZHRyZWUuS2V5LnByb3RvdHlwZS5nZXRQb2ludD1mdW5jdGlvbigpe3JldHVybiB0aGlzLnB0O307anN0cy5pbmRleC5xdWFkdHJlZS5LZXkucHJvdG90eXBlLmdldExldmVsPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMubGV2ZWw7fTtqc3RzLmluZGV4LnF1YWR0cmVlLktleS5wcm90b3R5cGUuZ2V0RW52ZWxvcGU9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5lbnY7fTtqc3RzLmluZGV4LnF1YWR0cmVlLktleS5wcm90b3R5cGUuZ2V0Q2VudHJlPWZ1bmN0aW9uKCl7dmFyIHgseTt4PSh0aGlzLmVudi5nZXRNaW5YKCkrdGhpcy5lbnYuZ2V0TWF4WCgpKS8yO3k9KHRoaXMuZW52LmdldE1pblkoKSt0aGlzLmVudi5nZXRNYXhZKCkpLzI7cmV0dXJuIG5ldyBqc3RzLmdlb20uQ29vcmRpbmF0ZSh4LHkpO307anN0cy5pbmRleC5xdWFkdHJlZS5LZXkucHJvdG90eXBlLmNvbXB1dGVLZXk9ZnVuY3Rpb24oKXtpZihhcmd1bWVudHNbMF1pbnN0YW5jZW9mIGpzdHMuZ2VvbS5FbnZlbG9wZSl7dGhpcy5jb21wdXRlS2V5RnJvbUVudmVsb3BlKGFyZ3VtZW50c1swXSk7fWVsc2V7dGhpcy5jb21wdXRlS2V5RnJvbUxldmVsKGFyZ3VtZW50c1swXSxhcmd1bWVudHNbMV0pO319O2pzdHMuaW5kZXgucXVhZHRyZWUuS2V5LnByb3RvdHlwZS5jb21wdXRlS2V5RnJvbUVudmVsb3BlPWZ1bmN0aW9uKGVudil7dGhpcy5sZXZlbD1qc3RzLmluZGV4LnF1YWR0cmVlLktleS5jb21wdXRlUXVhZExldmVsKGVudik7dGhpcy5lbnY9bmV3IGpzdHMuZ2VvbS5FbnZlbG9wZSgpO3RoaXMuY29tcHV0ZUtleSh0aGlzLmxldmVsLGVudik7d2hpbGUoIXRoaXMuZW52LmNvbnRhaW5zKGVudikpe3RoaXMubGV2ZWwrPTE7dGhpcy5jb21wdXRlS2V5KHRoaXMubGV2ZWwsZW52KTt9fTtqc3RzLmluZGV4LnF1YWR0cmVlLktleS5wcm90b3R5cGUuY29tcHV0ZUtleUZyb21MZXZlbD1mdW5jdGlvbihsZXZlbCxlbnYpe3ZhciBxdWFkU2l6ZT1qc3RzLmluZGV4LkRvdWJsZUJpdHMucG93ZXJPZjIobGV2ZWwpO3RoaXMucHQueD1NYXRoLmZsb29yKGVudi5nZXRNaW5YKCkvcXVhZFNpemUpKnF1YWRTaXplO3RoaXMucHQueT1NYXRoLmZsb29yKGVudi5nZXRNaW5ZKCkvcXVhZFNpemUpKnF1YWRTaXplO3RoaXMuZW52LmluaXQodGhpcy5wdC54LHRoaXMucHQueCtxdWFkU2l6ZSx0aGlzLnB0LnksdGhpcy5wdC55K1xucXVhZFNpemUpO307anN0cy5nZW9tLkNvb3JkaW5hdGVBcnJheXM9ZnVuY3Rpb24oKXt0aHJvdyBuZXcganN0cy5lcnJvci5BYnN0cmFjdE1ldGhvZEludm9jYXRpb25FcnJvcigpO307anN0cy5nZW9tLkNvb3JkaW5hdGVBcnJheXMuY29weURlZXA9ZnVuY3Rpb24oKXtpZihhcmd1bWVudHMubGVuZ3RoPT09MSl7cmV0dXJuIGpzdHMuZ2VvbS5Db29yZGluYXRlQXJyYXlzLmNvcHlEZWVwMShhcmd1bWVudHNbMF0pO31lbHNlIGlmKGFyZ3VtZW50cy5sZW5ndGg9PT01KXtqc3RzLmdlb20uQ29vcmRpbmF0ZUFycmF5cy5jb3B5RGVlcDIoYXJndW1lbnRzWzBdLGFyZ3VtZW50c1sxXSxhcmd1bWVudHNbMl0sYXJndW1lbnRzWzNdLGFyZ3VtZW50c1s0XSk7fX07anN0cy5nZW9tLkNvb3JkaW5hdGVBcnJheXMuY29weURlZXAxPWZ1bmN0aW9uKGNvb3JkaW5hdGVzKXt2YXIgY29weT1bXTtmb3IodmFyIGk9MDtpPGNvb3JkaW5hdGVzLmxlbmd0aDtpKyspe2NvcHlbaV09bmV3IGpzdHMuZ2VvbS5Db29yZGluYXRlKGNvb3JkaW5hdGVzW2ldKTt9XG5yZXR1cm4gY29weTt9O2pzdHMuZ2VvbS5Db29yZGluYXRlQXJyYXlzLmNvcHlEZWVwMj1mdW5jdGlvbihzcmMsc3JjU3RhcnQsZGVzdCxkZXN0U3RhcnQsbGVuZ3RoKXtmb3IodmFyIGk9MDtpPGxlbmd0aDtpKyspe2Rlc3RbZGVzdFN0YXJ0K2ldPW5ldyBqc3RzLmdlb20uQ29vcmRpbmF0ZShzcmNbc3JjU3RhcnQraV0pO319O2pzdHMuZ2VvbS5Db29yZGluYXRlQXJyYXlzLnJlbW92ZVJlcGVhdGVkUG9pbnRzPWZ1bmN0aW9uKGNvb3JkKXt2YXIgY29vcmRMaXN0O2lmKCF0aGlzLmhhc1JlcGVhdGVkUG9pbnRzKGNvb3JkKSl7cmV0dXJuIGNvb3JkO31cbmNvb3JkTGlzdD1uZXcganN0cy5nZW9tLkNvb3JkaW5hdGVMaXN0KGNvb3JkLGZhbHNlKTtyZXR1cm4gY29vcmRMaXN0LnRvQ29vcmRpbmF0ZUFycmF5KCk7fTtqc3RzLmdlb20uQ29vcmRpbmF0ZUFycmF5cy5oYXNSZXBlYXRlZFBvaW50cz1mdW5jdGlvbihjb29yZCl7dmFyIGk7Zm9yKGk9MTtpPGNvb3JkLmxlbmd0aDtpKyspe2lmKGNvb3JkW2ktMV0uZXF1YWxzKGNvb3JkW2ldKSl7cmV0dXJuIHRydWU7fX1cbnJldHVybiBmYWxzZTt9O2pzdHMuZ2VvbS5Db29yZGluYXRlQXJyYXlzLnB0Tm90SW5MaXN0PWZ1bmN0aW9uKHRlc3RQdHMscHRzKXtmb3IodmFyIGk9MDtpPHRlc3RQdHMubGVuZ3RoO2krKyl7dmFyIHRlc3RQdD10ZXN0UHRzW2ldO2lmKGpzdHMuZ2VvbS5Db29yZGluYXRlQXJyYXlzLmluZGV4T2YodGVzdFB0LHB0cyk8MClcbnJldHVybiB0ZXN0UHQ7fVxucmV0dXJuIG51bGw7fTtqc3RzLmdlb20uQ29vcmRpbmF0ZUFycmF5cy5pbmNyZWFzaW5nRGlyZWN0aW9uPWZ1bmN0aW9uKHB0cyl7Zm9yKHZhciBpPTA7aTxwYXJzZUludChwdHMubGVuZ3RoLzIpO2krKyl7dmFyIGo9cHRzLmxlbmd0aC0xLWk7dmFyIGNvbXA9cHRzW2ldLmNvbXBhcmVUbyhwdHNbal0pO2lmKGNvbXAhPTApXG5yZXR1cm4gY29tcDt9XG5yZXR1cm4gMTt9O2pzdHMuZ2VvbS5Db29yZGluYXRlQXJyYXlzLm1pbkNvb3JkaW5hdGU9ZnVuY3Rpb24oY29vcmRpbmF0ZXMpe3ZhciBtaW5Db29yZD1udWxsO2Zvcih2YXIgaT0wO2k8Y29vcmRpbmF0ZXMubGVuZ3RoO2krKyl7aWYobWluQ29vcmQ9PT1udWxsfHxtaW5Db29yZC5jb21wYXJlVG8oY29vcmRpbmF0ZXNbaV0pPjApe21pbkNvb3JkPWNvb3JkaW5hdGVzW2ldO319XG5yZXR1cm4gbWluQ29vcmQ7fTtqc3RzLmdlb20uQ29vcmRpbmF0ZUFycmF5cy5zY3JvbGw9ZnVuY3Rpb24oY29vcmRpbmF0ZXMsZmlyc3RDb29yZGluYXRlKXt2YXIgaT1qc3RzLmdlb20uQ29vcmRpbmF0ZUFycmF5cy5pbmRleE9mKGZpcnN0Q29vcmRpbmF0ZSxjb29yZGluYXRlcyk7aWYoaTwwKVxucmV0dXJuO3ZhciBuZXdDb29yZGluYXRlcz1jb29yZGluYXRlcy5zbGljZShpKS5jb25jYXQoY29vcmRpbmF0ZXMuc2xpY2UoMCxpKSk7Zm9yKGk9MDtpPG5ld0Nvb3JkaW5hdGVzLmxlbmd0aDtpKyspe2Nvb3JkaW5hdGVzW2ldPW5ld0Nvb3JkaW5hdGVzW2ldO319O2pzdHMuZ2VvbS5Db29yZGluYXRlQXJyYXlzLmluZGV4T2Y9ZnVuY3Rpb24oY29vcmRpbmF0ZSxjb29yZGluYXRlcyl7Zm9yKHZhciBpPTA7aTxjb29yZGluYXRlcy5sZW5ndGg7aSsrKXtpZihjb29yZGluYXRlLmVxdWFscyhjb29yZGluYXRlc1tpXSkpe3JldHVybiBpO319XG5yZXR1cm4tMTt9O2pzdHMub3BlcmF0aW9uLm92ZXJsYXkuTWluaW1hbEVkZ2VSaW5nPWZ1bmN0aW9uKHN0YXJ0LGdlb21ldHJ5RmFjdG9yeSl7anN0cy5nZW9tZ3JhcGguRWRnZVJpbmcuY2FsbCh0aGlzLHN0YXJ0LGdlb21ldHJ5RmFjdG9yeSk7fTtqc3RzLm9wZXJhdGlvbi5vdmVybGF5Lk1pbmltYWxFZGdlUmluZy5wcm90b3R5cGU9bmV3IGpzdHMuZ2VvbWdyYXBoLkVkZ2VSaW5nKCk7anN0cy5vcGVyYXRpb24ub3ZlcmxheS5NaW5pbWFsRWRnZVJpbmcuY29uc3RydWN0b3I9anN0cy5vcGVyYXRpb24ub3ZlcmxheS5NaW5pbWFsRWRnZVJpbmc7anN0cy5vcGVyYXRpb24ub3ZlcmxheS5NaW5pbWFsRWRnZVJpbmcucHJvdG90eXBlLmdldE5leHQ9ZnVuY3Rpb24oZGUpe3JldHVybiBkZS5nZXROZXh0TWluKCk7fTtqc3RzLm9wZXJhdGlvbi5vdmVybGF5Lk1pbmltYWxFZGdlUmluZy5wcm90b3R5cGUuc2V0RWRnZVJpbmc9ZnVuY3Rpb24oZGUsZXIpe2RlLnNldE1pbkVkZ2VSaW5nKGVyKTt9O2pzdHMudHJpYW5ndWxhdGUuRGVsYXVuYXlUcmlhbmd1bGF0aW9uQnVpbGRlcj1mdW5jdGlvbigpe3RoaXMuc2l0ZUNvb3Jkcz1udWxsO3RoaXMudG9sZXJhbmNlPTAuMDt0aGlzLnN1YmRpdj1udWxsO307anN0cy50cmlhbmd1bGF0ZS5EZWxhdW5heVRyaWFuZ3VsYXRpb25CdWlsZGVyLmV4dHJhY3RVbmlxdWVDb29yZGluYXRlcz1mdW5jdGlvbihnZW9tKXtpZihnZW9tPT09dW5kZWZpbmVkfHxnZW9tPT09bnVsbCl7cmV0dXJuIG5ldyBqc3RzLmdlb20uQ29vcmRpbmF0ZUxpc3QoW10sZmFsc2UpLnRvQXJyYXkoKTt9XG52YXIgY29vcmRzPWdlb20uZ2V0Q29vcmRpbmF0ZXMoKTtyZXR1cm4ganN0cy50cmlhbmd1bGF0ZS5EZWxhdW5heVRyaWFuZ3VsYXRpb25CdWlsZGVyLnVuaXF1ZShjb29yZHMpO307anN0cy50cmlhbmd1bGF0ZS5EZWxhdW5heVRyaWFuZ3VsYXRpb25CdWlsZGVyLnVuaXF1ZT1mdW5jdGlvbihjb29yZHMpe2Nvb3Jkcy5zb3J0KGZ1bmN0aW9uKGEsYil7cmV0dXJuIGEuY29tcGFyZVRvKGIpO30pO3ZhciBjb29yZExpc3Q9bmV3IGpzdHMuZ2VvbS5Db29yZGluYXRlTGlzdChjb29yZHMsZmFsc2UpO3JldHVybiBjb29yZExpc3QudG9BcnJheSgpO307anN0cy50cmlhbmd1bGF0ZS5EZWxhdW5heVRyaWFuZ3VsYXRpb25CdWlsZGVyLnRvVmVydGljZXM9ZnVuY3Rpb24oY29vcmRzKXt2YXIgdmVydHM9bmV3IEFycmF5KGNvb3Jkcy5sZW5ndGgpLGk9MCxpbD1jb29yZHMubGVuZ3RoLGNvb3JkO2ZvcihpO2k8aWw7aSsrKXtjb29yZD1jb29yZHNbaV07dmVydHNbaV09bmV3IGpzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuVmVydGV4KGNvb3JkKTt9XG5yZXR1cm4gdmVydHM7fTtqc3RzLnRyaWFuZ3VsYXRlLkRlbGF1bmF5VHJpYW5ndWxhdGlvbkJ1aWxkZXIuZW52ZWxvcGU9ZnVuY3Rpb24oY29vcmRzKXt2YXIgZW52PW5ldyBqc3RzLmdlb20uRW52ZWxvcGUoKSxpPTAsaWw9Y29vcmRzLmxlbmd0aDtmb3IoaTtpPGlsO2krKyl7ZW52LmV4cGFuZFRvSW5jbHVkZShjb29yZHNbaV0pO31cbnJldHVybiBlbnY7fTtqc3RzLnRyaWFuZ3VsYXRlLkRlbGF1bmF5VHJpYW5ndWxhdGlvbkJ1aWxkZXIucHJvdG90eXBlLnNldFNpdGVzPWZ1bmN0aW9uKCl7dmFyIGFyZz1hcmd1bWVudHNbMF07aWYoYXJnIGluc3RhbmNlb2YganN0cy5nZW9tLkdlb21ldHJ5fHxhcmcgaW5zdGFuY2VvZiBqc3RzLmdlb20uQ29vcmRpbmF0ZXx8YXJnIGluc3RhbmNlb2YganN0cy5nZW9tLlBvaW50fHxhcmcgaW5zdGFuY2VvZiBqc3RzLmdlb20uTXVsdGlQb2ludHx8YXJnIGluc3RhbmNlb2YganN0cy5nZW9tLkxpbmVTdHJpbmd8fGFyZyBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5NdWx0aUxpbmVTdHJpbmd8fGFyZyBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5MaW5lYXJSaW5nfHxhcmcgaW5zdGFuY2VvZiBqc3RzLmdlb20uUG9seWdvbnx8YXJnIGluc3RhbmNlb2YganN0cy5nZW9tLk11bHRpUG9seWdvbil7dGhpcy5zZXRTaXRlc0Zyb21HZW9tZXRyeShhcmcpO31lbHNle3RoaXMuc2V0U2l0ZXNGcm9tQ29sbGVjdGlvbihhcmcpO319O2pzdHMudHJpYW5ndWxhdGUuRGVsYXVuYXlUcmlhbmd1bGF0aW9uQnVpbGRlci5wcm90b3R5cGUuc2V0U2l0ZXNGcm9tR2VvbWV0cnk9ZnVuY3Rpb24oZ2VvbSl7dGhpcy5zaXRlQ29vcmRzPWpzdHMudHJpYW5ndWxhdGUuRGVsYXVuYXlUcmlhbmd1bGF0aW9uQnVpbGRlci5leHRyYWN0VW5pcXVlQ29vcmRpbmF0ZXMoZ2VvbSk7fTtqc3RzLnRyaWFuZ3VsYXRlLkRlbGF1bmF5VHJpYW5ndWxhdGlvbkJ1aWxkZXIucHJvdG90eXBlLnNldFNpdGVzRnJvbUNvbGxlY3Rpb249ZnVuY3Rpb24oY29vcmRzKXt0aGlzLnNpdGVDb29yZHM9anN0cy50cmlhbmd1bGF0ZS5EZWxhdW5heVRyaWFuZ3VsYXRpb25CdWlsZGVyLnVuaXF1ZShjb29yZHMpO307anN0cy50cmlhbmd1bGF0ZS5EZWxhdW5heVRyaWFuZ3VsYXRpb25CdWlsZGVyLnByb3RvdHlwZS5zZXRUb2xlcmFuY2U9ZnVuY3Rpb24odG9sZXJhbmNlKXt0aGlzLnRvbGVyYW5jZT10b2xlcmFuY2U7fTtqc3RzLnRyaWFuZ3VsYXRlLkRlbGF1bmF5VHJpYW5ndWxhdGlvbkJ1aWxkZXIucHJvdG90eXBlLmNyZWF0ZT1mdW5jdGlvbigpe2lmKHRoaXMuc3ViZGl2PT09bnVsbCl7dmFyIHNpdGVFbnYsdmVydGljZXMsdHJpYW5ndWxhdG9yO3NpdGVFbnY9anN0cy50cmlhbmd1bGF0ZS5EZWxhdW5heVRyaWFuZ3VsYXRpb25CdWlsZGVyLmVudmVsb3BlKHRoaXMuc2l0ZUNvb3Jkcyk7dmVydGljZXM9anN0cy50cmlhbmd1bGF0ZS5EZWxhdW5heVRyaWFuZ3VsYXRpb25CdWlsZGVyLnRvVmVydGljZXModGhpcy5zaXRlQ29vcmRzKTt0aGlzLnN1YmRpdj1uZXcganN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5RdWFkRWRnZVN1YmRpdmlzaW9uKHNpdGVFbnYsdGhpcy50b2xlcmFuY2UpO3RyaWFuZ3VsYXRvcj1uZXcganN0cy50cmlhbmd1bGF0ZS5JbmNyZW1lbnRhbERlbGF1bmF5VHJpYW5ndWxhdG9yKHRoaXMuc3ViZGl2KTt0cmlhbmd1bGF0b3IuaW5zZXJ0U2l0ZXModmVydGljZXMpO319O2pzdHMudHJpYW5ndWxhdGUuRGVsYXVuYXlUcmlhbmd1bGF0aW9uQnVpbGRlci5wcm90b3R5cGUuZ2V0U3ViZGl2aXNpb249ZnVuY3Rpb24oKXt0aGlzLmNyZWF0ZSgpO3JldHVybiB0aGlzLnN1YmRpdjt9O2pzdHMudHJpYW5ndWxhdGUuRGVsYXVuYXlUcmlhbmd1bGF0aW9uQnVpbGRlci5wcm90b3R5cGUuZ2V0RWRnZXM9ZnVuY3Rpb24oZ2VvbUZhY3Qpe3RoaXMuY3JlYXRlKCk7cmV0dXJuIHRoaXMuc3ViZGl2LmdldEVkZ2VzKGdlb21GYWN0KTt9O2pzdHMudHJpYW5ndWxhdGUuRGVsYXVuYXlUcmlhbmd1bGF0aW9uQnVpbGRlci5wcm90b3R5cGUuZ2V0VHJpYW5nbGVzPWZ1bmN0aW9uKGdlb21GYWN0KXt0aGlzLmNyZWF0ZSgpO3JldHVybiB0aGlzLnN1YmRpdi5nZXRUcmlhbmdsZXMoZ2VvbUZhY3QpO307anN0cy5hbGdvcml0aG0uUmF5Q3Jvc3NpbmdDb3VudGVyPWZ1bmN0aW9uKHApe3RoaXMucD1wO307anN0cy5hbGdvcml0aG0uUmF5Q3Jvc3NpbmdDb3VudGVyLmxvY2F0ZVBvaW50SW5SaW5nPWZ1bmN0aW9uKHAscmluZyl7dmFyIGNvdW50ZXI9bmV3IGpzdHMuYWxnb3JpdGhtLlJheUNyb3NzaW5nQ291bnRlcihwKTtmb3IodmFyIGk9MTtpPHJpbmcubGVuZ3RoO2krKyl7dmFyIHAxPXJpbmdbaV07dmFyIHAyPXJpbmdbaS0xXTtjb3VudGVyLmNvdW50U2VnbWVudChwMSxwMik7aWYoY291bnRlci5pc09uU2VnbWVudCgpKVxucmV0dXJuIGNvdW50ZXIuZ2V0TG9jYXRpb24oKTt9XG5yZXR1cm4gY291bnRlci5nZXRMb2NhdGlvbigpO307anN0cy5hbGdvcml0aG0uUmF5Q3Jvc3NpbmdDb3VudGVyLnByb3RvdHlwZS5wPW51bGw7anN0cy5hbGdvcml0aG0uUmF5Q3Jvc3NpbmdDb3VudGVyLnByb3RvdHlwZS5jcm9zc2luZ0NvdW50PTA7anN0cy5hbGdvcml0aG0uUmF5Q3Jvc3NpbmdDb3VudGVyLnByb3RvdHlwZS5pc1BvaW50T25TZWdtZW50PWZhbHNlO2pzdHMuYWxnb3JpdGhtLlJheUNyb3NzaW5nQ291bnRlci5wcm90b3R5cGUuY291bnRTZWdtZW50PWZ1bmN0aW9uKHAxLHAyKXtpZihwMS54PHRoaXMucC54JiZwMi54PHRoaXMucC54KVxucmV0dXJuO2lmKHRoaXMucC54PT1wMi54JiZ0aGlzLnAueT09PXAyLnkpe3RoaXMuaXNQb2ludE9uU2VnbWVudD10cnVlO3JldHVybjt9XG5pZihwMS55PT09dGhpcy5wLnkmJnAyLnk9PT10aGlzLnAueSl7dmFyIG1pbng9cDEueDt2YXIgbWF4eD1wMi54O2lmKG1pbng+bWF4eCl7bWlueD1wMi54O21heHg9cDEueDt9XG5pZih0aGlzLnAueD49bWlueCYmdGhpcy5wLng8PW1heHgpe3RoaXMuaXNQb2ludE9uU2VnbWVudD10cnVlO31cbnJldHVybjt9XG5pZigoKHAxLnk+dGhpcy5wLnkpJiYocDIueTw9dGhpcy5wLnkpKXx8KChwMi55PnRoaXMucC55KSYmKHAxLnk8PXRoaXMucC55KSkpe3ZhciB4MT1wMS54LXRoaXMucC54O3ZhciB5MT1wMS55LXRoaXMucC55O3ZhciB4Mj1wMi54LXRoaXMucC54O3ZhciB5Mj1wMi55LXRoaXMucC55O3ZhciB4SW50U2lnbj1qc3RzLmFsZ29yaXRobS5Sb2J1c3REZXRlcm1pbmFudC5zaWduT2ZEZXQyeDIoeDEseTEseDIseTIpO2lmKHhJbnRTaWduPT09MC4wKXt0aGlzLmlzUG9pbnRPblNlZ21lbnQ9dHJ1ZTtyZXR1cm47fVxuaWYoeTI8eTEpXG54SW50U2lnbj0teEludFNpZ247aWYoeEludFNpZ24+MC4wKXt0aGlzLmNyb3NzaW5nQ291bnQrKzt9fX07anN0cy5hbGdvcml0aG0uUmF5Q3Jvc3NpbmdDb3VudGVyLnByb3RvdHlwZS5pc09uU2VnbWVudD1mdW5jdGlvbigpe3JldHVybiBqc3RzLmdlb20uaXNQb2ludE9uU2VnbWVudDt9O2pzdHMuYWxnb3JpdGhtLlJheUNyb3NzaW5nQ291bnRlci5wcm90b3R5cGUuZ2V0TG9jYXRpb249ZnVuY3Rpb24oKXtpZih0aGlzLmlzUG9pbnRPblNlZ21lbnQpXG5yZXR1cm4ganN0cy5nZW9tLkxvY2F0aW9uLkJPVU5EQVJZO2lmKCh0aGlzLmNyb3NzaW5nQ291bnQlMik9PT0xKXtyZXR1cm4ganN0cy5nZW9tLkxvY2F0aW9uLklOVEVSSU9SO31cbnJldHVybiBqc3RzLmdlb20uTG9jYXRpb24uRVhURVJJT1I7fTtqc3RzLmFsZ29yaXRobS5SYXlDcm9zc2luZ0NvdW50ZXIucHJvdG90eXBlLmlzUG9pbnRJblBvbHlnb249ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5nZXRMb2NhdGlvbigpIT09anN0cy5nZW9tLkxvY2F0aW9uLkVYVEVSSU9SO307anN0cy5vcGVyYXRpb24uQm91bmRhcnlPcD1mdW5jdGlvbihnZW9tLGJuUnVsZSl7dGhpcy5nZW9tPWdlb207dGhpcy5nZW9tRmFjdD1nZW9tLmdldEZhY3RvcnkoKTt0aGlzLmJuUnVsZT1iblJ1bGV8fGpzdHMuYWxnb3JpdGhtLkJvdW5kYXJ5Tm9kZVJ1bGUuTU9EMl9CT1VOREFSWV9SVUxFO307anN0cy5vcGVyYXRpb24uQm91bmRhcnlPcC5wcm90b3R5cGUuZ2VvbT1udWxsO2pzdHMub3BlcmF0aW9uLkJvdW5kYXJ5T3AucHJvdG90eXBlLmdlb21GYWN0PW51bGw7anN0cy5vcGVyYXRpb24uQm91bmRhcnlPcC5wcm90b3R5cGUuYm5SdWxlPW51bGw7anN0cy5vcGVyYXRpb24uQm91bmRhcnlPcC5wcm90b3R5cGUuZ2V0Qm91bmRhcnk9ZnVuY3Rpb24oKXtpZih0aGlzLmdlb20gaW5zdGFuY2VvZiBqc3RzLmdlb20uTGluZVN0cmluZylyZXR1cm4gdGhpcy5ib3VuZGFyeUxpbmVTdHJpbmcodGhpcy5nZW9tKTtpZih0aGlzLmdlb20gaW5zdGFuY2VvZiBqc3RzLmdlb20uTXVsdGlMaW5lU3RyaW5nKXJldHVybiB0aGlzLmJvdW5kYXJ5TXVsdGlMaW5lU3RyaW5nKHRoaXMuZ2VvbSk7cmV0dXJuIHRoaXMuZ2VvbS5nZXRCb3VuZGFyeSgpO307anN0cy5vcGVyYXRpb24uQm91bmRhcnlPcC5wcm90b3R5cGUuZ2V0RW1wdHlNdWx0aVBvaW50PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZ2VvbUZhY3QuY3JlYXRlTXVsdGlQb2ludChudWxsKTt9O2pzdHMub3BlcmF0aW9uLkJvdW5kYXJ5T3AucHJvdG90eXBlLmJvdW5kYXJ5TXVsdGlMaW5lU3RyaW5nPWZ1bmN0aW9uKG1MaW5lKXtpZih0aGlzLmdlb20uaXNFbXB0eSgpKXtyZXR1cm4gdGhpcy5nZXRFbXB0eU11bHRpUG9pbnQoKTt9XG52YXIgYmR5UHRzPXRoaXMuY29tcHV0ZUJvdW5kYXJ5Q29vcmRpbmF0ZXMobUxpbmUpO2lmKGJkeVB0cy5sZW5ndGg9PTEpe3JldHVybiB0aGlzLmdlb21GYWN0LmNyZWF0ZVBvaW50KGJkeVB0c1swXSk7fVxucmV0dXJuIHRoaXMuZ2VvbUZhY3QuY3JlYXRlTXVsdGlQb2ludChiZHlQdHMpO307anN0cy5vcGVyYXRpb24uQm91bmRhcnlPcC5wcm90b3R5cGUuZW5kcG9pbnRzPW51bGw7anN0cy5vcGVyYXRpb24uQm91bmRhcnlPcC5wcm90b3R5cGUuY29tcHV0ZUJvdW5kYXJ5Q29vcmRpbmF0ZXM9ZnVuY3Rpb24obUxpbmUpe3ZhciBpLGxpbmUsZW5kcG9pbnQsYmR5UHRzPVtdO3RoaXMuZW5kcG9pbnRzPVtdO2ZvcihpPTA7aTxtTGluZS5nZXROdW1HZW9tZXRyaWVzKCk7aSsrKXtsaW5lPW1MaW5lLmdldEdlb21ldHJ5TihpKTtpZihsaW5lLmdldE51bVBvaW50cygpPT0wKVxuY29udGludWU7dGhpcy5hZGRFbmRwb2ludChsaW5lLmdldENvb3JkaW5hdGVOKDApKTt0aGlzLmFkZEVuZHBvaW50KGxpbmUuZ2V0Q29vcmRpbmF0ZU4obGluZS5nZXROdW1Qb2ludHMoKS0xKSk7fVxuZm9yKGk9MDtpPHRoaXMuZW5kcG9pbnRzLmxlbmd0aDtpKyspe2VuZHBvaW50PXRoaXMuZW5kcG9pbnRzW2ldO2lmKHRoaXMuYm5SdWxlLmlzSW5Cb3VuZGFyeShlbmRwb2ludC5jb3VudCkpe2JkeVB0cy5wdXNoKGVuZHBvaW50LmNvb3JkaW5hdGUpO319XG5yZXR1cm4gYmR5UHRzO307anN0cy5vcGVyYXRpb24uQm91bmRhcnlPcC5wcm90b3R5cGUuYWRkRW5kcG9pbnQ9ZnVuY3Rpb24ocHQpe3ZhciBpLGVuZHBvaW50LGZvdW5kPWZhbHNlO2ZvcihpPTA7aTx0aGlzLmVuZHBvaW50cy5sZW5ndGg7aSsrKXtlbmRwb2ludD10aGlzLmVuZHBvaW50c1tpXTtpZihlbmRwb2ludC5jb29yZGluYXRlLmVxdWFscyhwdCkpe2ZvdW5kPXRydWU7YnJlYWs7fX1cbmlmKCFmb3VuZCl7ZW5kcG9pbnQ9e307ZW5kcG9pbnQuY29vcmRpbmF0ZT1wdDtlbmRwb2ludC5jb3VudD0wO3RoaXMuZW5kcG9pbnRzLnB1c2goZW5kcG9pbnQpO31cbmVuZHBvaW50LmNvdW50Kys7fTtqc3RzLm9wZXJhdGlvbi5Cb3VuZGFyeU9wLnByb3RvdHlwZS5ib3VuZGFyeUxpbmVTdHJpbmc9ZnVuY3Rpb24obGluZSl7aWYodGhpcy5nZW9tLmlzRW1wdHkoKSl7cmV0dXJuIHRoaXMuZ2V0RW1wdHlNdWx0aVBvaW50KCk7fVxuaWYobGluZS5pc0Nsb3NlZCgpKXt2YXIgY2xvc2VkRW5kcG9pbnRPbkJvdW5kYXJ5PXRoaXMuYm5SdWxlLmlzSW5Cb3VuZGFyeSgyKTtpZihjbG9zZWRFbmRwb2ludE9uQm91bmRhcnkpe3JldHVybiBsaW5lLmdldFN0YXJ0UG9pbnQoKTt9XG5lbHNle3JldHVybiB0aGlzLmdlb21GYWN0LmNyZWF0ZU11bHRpUG9pbnQobnVsbCk7fX1cbnJldHVybiB0aGlzLmdlb21GYWN0LmNyZWF0ZU11bHRpUG9pbnQoW2xpbmUuZ2V0U3RhcnRQb2ludCgpLGxpbmUuZ2V0RW5kUG9pbnQoKV0pO307anN0cy5vcGVyYXRpb24uYnVmZmVyLk9mZnNldEN1cnZlU2V0QnVpbGRlcj1mdW5jdGlvbihpbnB1dEdlb20sZGlzdGFuY2UsY3VydmVCdWlsZGVyKXt0aGlzLmlucHV0R2VvbT1pbnB1dEdlb207dGhpcy5kaXN0YW5jZT1kaXN0YW5jZTt0aGlzLmN1cnZlQnVpbGRlcj1jdXJ2ZUJ1aWxkZXI7dGhpcy5jdXJ2ZUxpc3Q9bmV3IGphdmFzY3JpcHQudXRpbC5BcnJheUxpc3QoKTt9O2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5PZmZzZXRDdXJ2ZVNldEJ1aWxkZXIucHJvdG90eXBlLmlucHV0R2VvbT1udWxsO2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5PZmZzZXRDdXJ2ZVNldEJ1aWxkZXIucHJvdG90eXBlLmRpc3RhbmNlPW51bGw7anN0cy5vcGVyYXRpb24uYnVmZmVyLk9mZnNldEN1cnZlU2V0QnVpbGRlci5wcm90b3R5cGUuY3VydmVCdWlsZGVyPW51bGw7anN0cy5vcGVyYXRpb24uYnVmZmVyLk9mZnNldEN1cnZlU2V0QnVpbGRlci5wcm90b3R5cGUuY3VydmVMaXN0PW51bGw7anN0cy5vcGVyYXRpb24uYnVmZmVyLk9mZnNldEN1cnZlU2V0QnVpbGRlci5wcm90b3R5cGUuZ2V0Q3VydmVzPWZ1bmN0aW9uKCl7dGhpcy5hZGQodGhpcy5pbnB1dEdlb20pO3JldHVybiB0aGlzLmN1cnZlTGlzdDt9O2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5PZmZzZXRDdXJ2ZVNldEJ1aWxkZXIucHJvdG90eXBlLmFkZEN1cnZlPWZ1bmN0aW9uKGNvb3JkLGxlZnRMb2MscmlnaHRMb2Mpe2lmKGNvb3JkPT1udWxsfHxjb29yZC5sZW5ndGg8MilcbnJldHVybjt2YXIgZT1uZXcganN0cy5ub2RpbmcuTm9kZWRTZWdtZW50U3RyaW5nKGNvb3JkLG5ldyBqc3RzLmdlb21ncmFwaC5MYWJlbCgwLGpzdHMuZ2VvbS5Mb2NhdGlvbi5CT1VOREFSWSxsZWZ0TG9jLHJpZ2h0TG9jKSk7dGhpcy5jdXJ2ZUxpc3QuYWRkKGUpO307anN0cy5vcGVyYXRpb24uYnVmZmVyLk9mZnNldEN1cnZlU2V0QnVpbGRlci5wcm90b3R5cGUuYWRkPWZ1bmN0aW9uKGcpe2lmKGcuaXNFbXB0eSgpKVxucmV0dXJuO2lmKGcgaW5zdGFuY2VvZiBqc3RzLmdlb20uUG9seWdvbilcbnRoaXMuYWRkUG9seWdvbihnKTtlbHNlIGlmKGcgaW5zdGFuY2VvZiBqc3RzLmdlb20uTGluZVN0cmluZylcbnRoaXMuYWRkTGluZVN0cmluZyhnKTtlbHNlIGlmKGcgaW5zdGFuY2VvZiBqc3RzLmdlb20uUG9pbnQpXG50aGlzLmFkZFBvaW50KGcpO2Vsc2UgaWYoZyBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5NdWx0aVBvaW50KVxudGhpcy5hZGRDb2xsZWN0aW9uKGcpO2Vsc2UgaWYoZyBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5NdWx0aUxpbmVTdHJpbmcpXG50aGlzLmFkZENvbGxlY3Rpb24oZyk7ZWxzZSBpZihnIGluc3RhbmNlb2YganN0cy5nZW9tLk11bHRpUG9seWdvbilcbnRoaXMuYWRkQ29sbGVjdGlvbihnKTtlbHNlIGlmKGcgaW5zdGFuY2VvZiBqc3RzLmdlb20uR2VvbWV0cnlDb2xsZWN0aW9uKVxudGhpcy5hZGRDb2xsZWN0aW9uKGcpO2Vsc2VcbnRocm93IG5ldyBqc3RzLmVycm9yLklsbGVnYWxBcmd1bWVudEVycm9yKCk7fTtqc3RzLm9wZXJhdGlvbi5idWZmZXIuT2Zmc2V0Q3VydmVTZXRCdWlsZGVyLnByb3RvdHlwZS5hZGRDb2xsZWN0aW9uPWZ1bmN0aW9uKGdjKXtmb3IodmFyIGk9MDtpPGdjLmdldE51bUdlb21ldHJpZXMoKTtpKyspe3ZhciBnPWdjLmdldEdlb21ldHJ5TihpKTt0aGlzLmFkZChnKTt9fTtqc3RzLm9wZXJhdGlvbi5idWZmZXIuT2Zmc2V0Q3VydmVTZXRCdWlsZGVyLnByb3RvdHlwZS5hZGRQb2ludD1mdW5jdGlvbihwKXtpZih0aGlzLmRpc3RhbmNlPD0wLjApXG5yZXR1cm47dmFyIGNvb3JkPXAuZ2V0Q29vcmRpbmF0ZXMoKTt2YXIgY3VydmU9dGhpcy5jdXJ2ZUJ1aWxkZXIuZ2V0TGluZUN1cnZlKGNvb3JkLHRoaXMuZGlzdGFuY2UpO3RoaXMuYWRkQ3VydmUoY3VydmUsanN0cy5nZW9tLkxvY2F0aW9uLkVYVEVSSU9SLGpzdHMuZ2VvbS5Mb2NhdGlvbi5JTlRFUklPUik7fTtqc3RzLm9wZXJhdGlvbi5idWZmZXIuT2Zmc2V0Q3VydmVTZXRCdWlsZGVyLnByb3RvdHlwZS5hZGRMaW5lU3RyaW5nPWZ1bmN0aW9uKGxpbmUpe2lmKHRoaXMuZGlzdGFuY2U8PTAuMCYmIXRoaXMuY3VydmVCdWlsZGVyLmdldEJ1ZmZlclBhcmFtZXRlcnMoKS5pc1NpbmdsZVNpZGVkKCkpXG5yZXR1cm47dmFyIGNvb3JkPWpzdHMuZ2VvbS5Db29yZGluYXRlQXJyYXlzLnJlbW92ZVJlcGVhdGVkUG9pbnRzKGxpbmUuZ2V0Q29vcmRpbmF0ZXMoKSk7dmFyIGN1cnZlPXRoaXMuY3VydmVCdWlsZGVyLmdldExpbmVDdXJ2ZShjb29yZCx0aGlzLmRpc3RhbmNlKTt0aGlzLmFkZEN1cnZlKGN1cnZlLGpzdHMuZ2VvbS5Mb2NhdGlvbi5FWFRFUklPUixqc3RzLmdlb20uTG9jYXRpb24uSU5URVJJT1IpO307anN0cy5vcGVyYXRpb24uYnVmZmVyLk9mZnNldEN1cnZlU2V0QnVpbGRlci5wcm90b3R5cGUuYWRkUG9seWdvbj1mdW5jdGlvbihwKXt2YXIgb2Zmc2V0RGlzdGFuY2U9dGhpcy5kaXN0YW5jZTt2YXIgb2Zmc2V0U2lkZT1qc3RzLmdlb21ncmFwaC5Qb3NpdGlvbi5MRUZUO2lmKHRoaXMuZGlzdGFuY2U8MC4wKXtvZmZzZXREaXN0YW5jZT0tdGhpcy5kaXN0YW5jZTtvZmZzZXRTaWRlPWpzdHMuZ2VvbWdyYXBoLlBvc2l0aW9uLlJJR0hUO31cbnZhciBzaGVsbD1wLmdldEV4dGVyaW9yUmluZygpO3ZhciBzaGVsbENvb3JkPWpzdHMuZ2VvbS5Db29yZGluYXRlQXJyYXlzLnJlbW92ZVJlcGVhdGVkUG9pbnRzKHNoZWxsLmdldENvb3JkaW5hdGVzKCkpO2lmKHRoaXMuZGlzdGFuY2U8MC4wJiZ0aGlzLmlzRXJvZGVkQ29tcGxldGVseShzaGVsbCx0aGlzLmRpc3RhbmNlKSlcbnJldHVybjtpZih0aGlzLmRpc3RhbmNlPD0wLjAmJnNoZWxsQ29vcmQubGVuZ3RoPDMpXG5yZXR1cm47dGhpcy5hZGRQb2x5Z29uUmluZyhzaGVsbENvb3JkLG9mZnNldERpc3RhbmNlLG9mZnNldFNpZGUsanN0cy5nZW9tLkxvY2F0aW9uLkVYVEVSSU9SLGpzdHMuZ2VvbS5Mb2NhdGlvbi5JTlRFUklPUik7Zm9yKHZhciBpPTA7aTxwLmdldE51bUludGVyaW9yUmluZygpO2krKyl7dmFyIGhvbGU9cC5nZXRJbnRlcmlvclJpbmdOKGkpO3ZhciBob2xlQ29vcmQ9anN0cy5nZW9tLkNvb3JkaW5hdGVBcnJheXMucmVtb3ZlUmVwZWF0ZWRQb2ludHMoaG9sZS5nZXRDb29yZGluYXRlcygpKTtpZih0aGlzLmRpc3RhbmNlPjAuMCYmdGhpcy5pc0Vyb2RlZENvbXBsZXRlbHkoaG9sZSwtdGhpcy5kaXN0YW5jZSkpXG5jb250aW51ZTt0aGlzLmFkZFBvbHlnb25SaW5nKGhvbGVDb29yZCxvZmZzZXREaXN0YW5jZSxqc3RzLmdlb21ncmFwaC5Qb3NpdGlvbi5vcHBvc2l0ZShvZmZzZXRTaWRlKSxqc3RzLmdlb20uTG9jYXRpb24uSU5URVJJT1IsanN0cy5nZW9tLkxvY2F0aW9uLkVYVEVSSU9SKTt9fTtqc3RzLm9wZXJhdGlvbi5idWZmZXIuT2Zmc2V0Q3VydmVTZXRCdWlsZGVyLnByb3RvdHlwZS5hZGRQb2x5Z29uUmluZz1mdW5jdGlvbihjb29yZCxvZmZzZXREaXN0YW5jZSxzaWRlLGN3TGVmdExvYyxjd1JpZ2h0TG9jKXtpZihvZmZzZXREaXN0YW5jZT09MC4wJiZjb29yZC5sZW5ndGg8anN0cy5nZW9tLkxpbmVhclJpbmcuTUlOSU1VTV9WQUxJRF9TSVpFKVxucmV0dXJuO3ZhciBsZWZ0TG9jPWN3TGVmdExvYzt2YXIgcmlnaHRMb2M9Y3dSaWdodExvYztpZihjb29yZC5sZW5ndGg+PWpzdHMuZ2VvbS5MaW5lYXJSaW5nLk1JTklNVU1fVkFMSURfU0laRSYmanN0cy5hbGdvcml0aG0uQ0dBbGdvcml0aG1zLmlzQ0NXKGNvb3JkKSl7bGVmdExvYz1jd1JpZ2h0TG9jO3JpZ2h0TG9jPWN3TGVmdExvYztzaWRlPWpzdHMuZ2VvbWdyYXBoLlBvc2l0aW9uLm9wcG9zaXRlKHNpZGUpO31cbnZhciBjdXJ2ZT10aGlzLmN1cnZlQnVpbGRlci5nZXRSaW5nQ3VydmUoY29vcmQsc2lkZSxvZmZzZXREaXN0YW5jZSk7dGhpcy5hZGRDdXJ2ZShjdXJ2ZSxsZWZ0TG9jLHJpZ2h0TG9jKTt9O2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5PZmZzZXRDdXJ2ZVNldEJ1aWxkZXIucHJvdG90eXBlLmlzRXJvZGVkQ29tcGxldGVseT1mdW5jdGlvbihyaW5nLGJ1ZmZlckRpc3RhbmNlKXt2YXIgcmluZ0Nvb3JkPXJpbmcuZ2V0Q29vcmRpbmF0ZXMoKTt2YXIgbWluRGlhbT0wLjA7aWYocmluZ0Nvb3JkLmxlbmd0aDw0KVxucmV0dXJuIGJ1ZmZlckRpc3RhbmNlPDA7aWYocmluZ0Nvb3JkLmxlbmd0aD09NClcbnJldHVybiB0aGlzLmlzVHJpYW5nbGVFcm9kZWRDb21wbGV0ZWx5KHJpbmdDb29yZCxidWZmZXJEaXN0YW5jZSk7dmFyIGVudj1yaW5nLmdldEVudmVsb3BlSW50ZXJuYWwoKTt2YXIgZW52TWluRGltZW5zaW9uPU1hdGgubWluKGVudi5nZXRIZWlnaHQoKSxlbnYuZ2V0V2lkdGgoKSk7aWYoYnVmZmVyRGlzdGFuY2U8MC4wJiYyKk1hdGguYWJzKGJ1ZmZlckRpc3RhbmNlKT5lbnZNaW5EaW1lbnNpb24pXG5yZXR1cm4gdHJ1ZTtyZXR1cm4gZmFsc2U7fTtqc3RzLm9wZXJhdGlvbi5idWZmZXIuT2Zmc2V0Q3VydmVTZXRCdWlsZGVyLnByb3RvdHlwZS5pc1RyaWFuZ2xlRXJvZGVkQ29tcGxldGVseT1mdW5jdGlvbih0cmlhbmdsZUNvb3JkLGJ1ZmZlckRpc3RhbmNlKXt2YXIgdHJpPW5ldyBqc3RzLmdlb20uVHJpYW5nbGUodHJpYW5nbGVDb29yZFswXSx0cmlhbmdsZUNvb3JkWzFdLHRyaWFuZ2xlQ29vcmRbMl0pO3ZhciBpbkNlbnRyZT10cmkuaW5DZW50cmUoKTt2YXIgZGlzdFRvQ2VudHJlPWpzdHMuYWxnb3JpdGhtLkNHQWxnb3JpdGhtcy5kaXN0YW5jZVBvaW50TGluZShpbkNlbnRyZSx0cmkucDAsdHJpLnAxKTtyZXR1cm4gZGlzdFRvQ2VudHJlPE1hdGguYWJzKGJ1ZmZlckRpc3RhbmNlKTt9O2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5CdWZmZXJTdWJncmFwaD1mdW5jdGlvbigpe3RoaXMuZGlyRWRnZUxpc3Q9bmV3IGphdmFzY3JpcHQudXRpbC5BcnJheUxpc3QoKTt0aGlzLm5vZGVzPW5ldyBqYXZhc2NyaXB0LnV0aWwuQXJyYXlMaXN0KCk7dGhpcy5maW5kZXI9bmV3IGpzdHMub3BlcmF0aW9uLmJ1ZmZlci5SaWdodG1vc3RFZGdlRmluZGVyKCk7fTtqc3RzLm9wZXJhdGlvbi5idWZmZXIuQnVmZmVyU3ViZ3JhcGgucHJvdG90eXBlLmZpbmRlcj1udWxsO2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5CdWZmZXJTdWJncmFwaC5wcm90b3R5cGUuZGlyRWRnZUxpc3Q9bnVsbDtqc3RzLm9wZXJhdGlvbi5idWZmZXIuQnVmZmVyU3ViZ3JhcGgucHJvdG90eXBlLm5vZGVzPW51bGw7anN0cy5vcGVyYXRpb24uYnVmZmVyLkJ1ZmZlclN1YmdyYXBoLnByb3RvdHlwZS5yaWdodE1vc3RDb29yZD1udWxsO2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5CdWZmZXJTdWJncmFwaC5wcm90b3R5cGUuZW52PW51bGw7anN0cy5vcGVyYXRpb24uYnVmZmVyLkJ1ZmZlclN1YmdyYXBoLnByb3RvdHlwZS5nZXREaXJlY3RlZEVkZ2VzPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZGlyRWRnZUxpc3Q7fTtqc3RzLm9wZXJhdGlvbi5idWZmZXIuQnVmZmVyU3ViZ3JhcGgucHJvdG90eXBlLmdldE5vZGVzPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMubm9kZXM7fTtqc3RzLm9wZXJhdGlvbi5idWZmZXIuQnVmZmVyU3ViZ3JhcGgucHJvdG90eXBlLmdldEVudmVsb3BlPWZ1bmN0aW9uKCl7aWYodGhpcy5lbnY9PT1udWxsKXt2YXIgZWRnZUVudj1uZXcganN0cy5nZW9tLkVudmVsb3BlKCk7Zm9yKHZhciBpdD10aGlzLmRpckVkZ2VMaXN0Lml0ZXJhdG9yKCk7aXQuaGFzTmV4dCgpOyl7dmFyIGRpckVkZ2U9aXQubmV4dCgpO3ZhciBwdHM9ZGlyRWRnZS5nZXRFZGdlKCkuZ2V0Q29vcmRpbmF0ZXMoKTtmb3IodmFyIGo9MDtqPHB0cy5sZW5ndGgtMTtqKyspe2VkZ2VFbnYuZXhwYW5kVG9JbmNsdWRlKHB0c1tqXSk7fX1cbnRoaXMuZW52PWVkZ2VFbnY7fVxucmV0dXJuIHRoaXMuZW52O307anN0cy5vcGVyYXRpb24uYnVmZmVyLkJ1ZmZlclN1YmdyYXBoLnByb3RvdHlwZS5nZXRSaWdodG1vc3RDb29yZGluYXRlPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMucmlnaHRNb3N0Q29vcmQ7fTtqc3RzLm9wZXJhdGlvbi5idWZmZXIuQnVmZmVyU3ViZ3JhcGgucHJvdG90eXBlLmNyZWF0ZT1mdW5jdGlvbihub2RlKXt0aGlzLmFkZFJlYWNoYWJsZShub2RlKTt0aGlzLmZpbmRlci5maW5kRWRnZSh0aGlzLmRpckVkZ2VMaXN0KTt0aGlzLnJpZ2h0TW9zdENvb3JkPXRoaXMuZmluZGVyLmdldENvb3JkaW5hdGUoKTt9O2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5CdWZmZXJTdWJncmFwaC5wcm90b3R5cGUuYWRkUmVhY2hhYmxlPWZ1bmN0aW9uKHN0YXJ0Tm9kZSl7dmFyIG5vZGVTdGFjaz1bXTtub2RlU3RhY2sucHVzaChzdGFydE5vZGUpO3doaWxlKG5vZGVTdGFjay5sZW5ndGghPT0wKXt2YXIgbm9kZT1ub2RlU3RhY2sucG9wKCk7dGhpcy5hZGQobm9kZSxub2RlU3RhY2spO319O2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5CdWZmZXJTdWJncmFwaC5wcm90b3R5cGUuYWRkPWZ1bmN0aW9uKG5vZGUsbm9kZVN0YWNrKXtub2RlLnNldFZpc2l0ZWQodHJ1ZSk7dGhpcy5ub2Rlcy5hZGQobm9kZSk7Zm9yKHZhciBpPW5vZGUuZ2V0RWRnZXMoKS5pdGVyYXRvcigpO2kuaGFzTmV4dCgpOyl7dmFyIGRlPWkubmV4dCgpO3RoaXMuZGlyRWRnZUxpc3QuYWRkKGRlKTt2YXIgc3ltPWRlLmdldFN5bSgpO3ZhciBzeW1Ob2RlPXN5bS5nZXROb2RlKCk7aWYoIXN5bU5vZGUuaXNWaXNpdGVkKCkpXG5ub2RlU3RhY2sucHVzaChzeW1Ob2RlKTt9fTtqc3RzLm9wZXJhdGlvbi5idWZmZXIuQnVmZmVyU3ViZ3JhcGgucHJvdG90eXBlLmNsZWFyVmlzaXRlZEVkZ2VzPWZ1bmN0aW9uKCl7Zm9yKHZhciBpdD10aGlzLmRpckVkZ2VMaXN0Lml0ZXJhdG9yKCk7aXQuaGFzTmV4dCgpOyl7dmFyIGRlPWl0Lm5leHQoKTtkZS5zZXRWaXNpdGVkKGZhbHNlKTt9fTtqc3RzLm9wZXJhdGlvbi5idWZmZXIuQnVmZmVyU3ViZ3JhcGgucHJvdG90eXBlLmNvbXB1dGVEZXB0aD1mdW5jdGlvbihvdXRzaWRlRGVwdGgpe3RoaXMuY2xlYXJWaXNpdGVkRWRnZXMoKTt2YXIgZGU9dGhpcy5maW5kZXIuZ2V0RWRnZSgpO3ZhciBuPWRlLmdldE5vZGUoKTt2YXIgbGFiZWw9ZGUuZ2V0TGFiZWwoKTtkZS5zZXRFZGdlRGVwdGhzKGpzdHMuZ2VvbWdyYXBoLlBvc2l0aW9uLlJJR0hULG91dHNpZGVEZXB0aCk7dGhpcy5jb3B5U3ltRGVwdGhzKGRlKTt0aGlzLmNvbXB1dGVEZXB0aHMoZGUpO307anN0cy5vcGVyYXRpb24uYnVmZmVyLkJ1ZmZlclN1YmdyYXBoLnByb3RvdHlwZS5jb21wdXRlRGVwdGhzPWZ1bmN0aW9uKHN0YXJ0RWRnZSl7dmFyIG5vZGVzVmlzaXRlZD1bXTt2YXIgbm9kZVF1ZXVlPVtdO3ZhciBzdGFydE5vZGU9c3RhcnRFZGdlLmdldE5vZGUoKTtub2RlUXVldWUucHVzaChzdGFydE5vZGUpO25vZGVzVmlzaXRlZC5wdXNoKHN0YXJ0Tm9kZSk7c3RhcnRFZGdlLnNldFZpc2l0ZWQodHJ1ZSk7d2hpbGUobm9kZVF1ZXVlLmxlbmd0aCE9PTApe3ZhciBuPW5vZGVRdWV1ZS5zaGlmdCgpO25vZGVzVmlzaXRlZC5wdXNoKG4pO3RoaXMuY29tcHV0ZU5vZGVEZXB0aChuKTtmb3IodmFyIGk9bi5nZXRFZGdlcygpLml0ZXJhdG9yKCk7aS5oYXNOZXh0KCk7KXt2YXIgZGU9aS5uZXh0KCk7dmFyIHN5bT1kZS5nZXRTeW0oKTtpZihzeW0uaXNWaXNpdGVkKCkpXG5jb250aW51ZTt2YXIgYWRqTm9kZT1zeW0uZ2V0Tm9kZSgpO2lmKG5vZGVzVmlzaXRlZC5pbmRleE9mKGFkak5vZGUpPT09LTEpe25vZGVRdWV1ZS5wdXNoKGFkak5vZGUpO25vZGVzVmlzaXRlZC5wdXNoKGFkak5vZGUpO319fX07anN0cy5vcGVyYXRpb24uYnVmZmVyLkJ1ZmZlclN1YmdyYXBoLnByb3RvdHlwZS5jb21wdXRlTm9kZURlcHRoPWZ1bmN0aW9uKG4pe3ZhciBzdGFydEVkZ2U9bnVsbDtmb3IodmFyIGk9bi5nZXRFZGdlcygpLml0ZXJhdG9yKCk7aS5oYXNOZXh0KCk7KXt2YXIgZGU9aS5uZXh0KCk7aWYoZGUuaXNWaXNpdGVkKCl8fGRlLmdldFN5bSgpLmlzVmlzaXRlZCgpKXtzdGFydEVkZ2U9ZGU7YnJlYWs7fX1cbmlmKHN0YXJ0RWRnZT09bnVsbClcbnRocm93IG5ldyBqc3RzLmVycm9yLlRvcG9sb2d5RXJyb3IoJ3VuYWJsZSB0byBmaW5kIGVkZ2UgdG8gY29tcHV0ZSBkZXB0aHMgYXQgJytuLmdldENvb3JkaW5hdGUoKSk7bi5nZXRFZGdlcygpLmNvbXB1dGVEZXB0aHMoc3RhcnRFZGdlKTtmb3IodmFyIGk9bi5nZXRFZGdlcygpLml0ZXJhdG9yKCk7aS5oYXNOZXh0KCk7KXt2YXIgZGU9aS5uZXh0KCk7ZGUuc2V0VmlzaXRlZCh0cnVlKTt0aGlzLmNvcHlTeW1EZXB0aHMoZGUpO319O2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5CdWZmZXJTdWJncmFwaC5wcm90b3R5cGUuY29weVN5bURlcHRocz1mdW5jdGlvbihkZSl7dmFyIHN5bT1kZS5nZXRTeW0oKTtzeW0uc2V0RGVwdGgoanN0cy5nZW9tZ3JhcGguUG9zaXRpb24uTEVGVCxkZS5nZXREZXB0aChqc3RzLmdlb21ncmFwaC5Qb3NpdGlvbi5SSUdIVCkpO3N5bS5zZXREZXB0aChqc3RzLmdlb21ncmFwaC5Qb3NpdGlvbi5SSUdIVCxkZS5nZXREZXB0aChqc3RzLmdlb21ncmFwaC5Qb3NpdGlvbi5MRUZUKSk7fTtqc3RzLm9wZXJhdGlvbi5idWZmZXIuQnVmZmVyU3ViZ3JhcGgucHJvdG90eXBlLmZpbmRSZXN1bHRFZGdlcz1mdW5jdGlvbigpe2Zvcih2YXIgaXQ9dGhpcy5kaXJFZGdlTGlzdC5pdGVyYXRvcigpO2l0Lmhhc05leHQoKTspe3ZhciBkZT1pdC5uZXh0KCk7aWYoZGUuZ2V0RGVwdGgoanN0cy5nZW9tZ3JhcGguUG9zaXRpb24uUklHSFQpPj0xJiZkZS5nZXREZXB0aChqc3RzLmdlb21ncmFwaC5Qb3NpdGlvbi5MRUZUKTw9MCYmIWRlLmlzSW50ZXJpb3JBcmVhRWRnZSgpKXtkZS5zZXRJblJlc3VsdCh0cnVlKTt9fX07anN0cy5vcGVyYXRpb24uYnVmZmVyLkJ1ZmZlclN1YmdyYXBoLnByb3RvdHlwZS5jb21wYXJlVG89ZnVuY3Rpb24obyl7dmFyIGdyYXBoPW87aWYodGhpcy5yaWdodE1vc3RDb29yZC54PGdyYXBoLnJpZ2h0TW9zdENvb3JkLngpe3JldHVybi0xO31cbmlmKHRoaXMucmlnaHRNb3N0Q29vcmQueD5ncmFwaC5yaWdodE1vc3RDb29yZC54KXtyZXR1cm4gMTt9XG5yZXR1cm4gMDt9O2pzdHMuc2ltcGxpZnkuRFBUcmFuc2Zvcm1lcj1mdW5jdGlvbihkaXN0YW5jZVRvbGVyYW5jZSxpc0Vuc3VyZVZhbGlkVG9wb2xvZ3kpe3RoaXMuZGlzdGFuY2VUb2xlcmFuY2U9ZGlzdGFuY2VUb2xlcmFuY2U7dGhpcy5pc0Vuc3VyZVZhbGlkVG9wb2xvZ3k9aXNFbnN1cmVWYWxpZFRvcG9sb2d5O307anN0cy5zaW1wbGlmeS5EUFRyYW5zZm9ybWVyLnByb3RvdHlwZT1uZXcganN0cy5nZW9tLnV0aWwuR2VvbWV0cnlUcmFuc2Zvcm1lcigpO2pzdHMuc2ltcGxpZnkuRFBUcmFuc2Zvcm1lci5wcm90b3R5cGUuZGlzdGFuY2VUb2xlcmFuY2U9bnVsbDtqc3RzLnNpbXBsaWZ5LkRQVHJhbnNmb3JtZXIucHJvdG90eXBlLmlzRW5zdXJlVmFsaWRUb3BvbG9neT1udWxsO2pzdHMuc2ltcGxpZnkuRFBUcmFuc2Zvcm1lci5wcm90b3R5cGUudHJhbnNmb3JtQ29vcmRpbmF0ZXM9ZnVuY3Rpb24oY29vcmRzLHBhcmVudCl7dmFyIGlucHV0UHRzPWNvb3Jkczt2YXIgbmV3UHRzPW51bGw7aWYoaW5wdXRQdHMubGVuZ3RoPT0wKXtuZXdQdHM9W107fWVsc2V7bmV3UHRzPWpzdHMuc2ltcGxpZnkuRG91Z2xhc1BldWNrZXJMaW5lU2ltcGxpZmllci5zaW1wbGlmeShpbnB1dFB0cyx0aGlzLmRpc3RhbmNlVG9sZXJhbmNlKTt9XG5yZXR1cm4gbmV3UHRzO307anN0cy5zaW1wbGlmeS5EUFRyYW5zZm9ybWVyLnByb3RvdHlwZS50cmFuc2Zvcm1Qb2x5Z29uPWZ1bmN0aW9uKGdlb20scGFyZW50KXtpZihnZW9tLmlzRW1wdHkoKSl7cmV0dXJuIG51bGw7fVxudmFyIHJhd0dlb209anN0cy5nZW9tLnV0aWwuR2VvbWV0cnlUcmFuc2Zvcm1lci5wcm90b3R5cGUudHJhbnNmb3JtUG9seWdvbi5hcHBseSh0aGlzLGFyZ3VtZW50cyk7aWYocGFyZW50IGluc3RhbmNlb2YganN0cy5nZW9tLk11bHRpUG9seWdvbil7cmV0dXJuIHJhd0dlb207fVxucmV0dXJuIHRoaXMuY3JlYXRlVmFsaWRBcmVhKHJhd0dlb20pO307anN0cy5zaW1wbGlmeS5EUFRyYW5zZm9ybWVyLnByb3RvdHlwZS50cmFuc2Zvcm1MaW5lYXJSaW5nPWZ1bmN0aW9uKGdlb20scGFyZW50KXt2YXIgcmVtb3ZlRGVnZW5lcmF0ZVJpbmdzPXBhcmVudCBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5Qb2x5Z29uO3ZhciBzaW1wUmVzdWx0PWpzdHMuZ2VvbS51dGlsLkdlb21ldHJ5VHJhbnNmb3JtZXIucHJvdG90eXBlLnRyYW5zZm9ybUxpbmVhclJpbmcuYXBwbHkodGhpcyxhcmd1bWVudHMpO2lmKHJlbW92ZURlZ2VuZXJhdGVSaW5ncyYmIShzaW1wUmVzdWx0IGluc3RhbmNlb2YganN0cy5nZW9tLkxpbmVhclJpbmcpKXtyZXR1cm4gbnVsbDt9XG5yZXR1cm4gc2ltcFJlc3VsdDt9O2pzdHMuc2ltcGxpZnkuRFBUcmFuc2Zvcm1lci5wcm90b3R5cGUudHJhbnNmb3JtTXVsdGlQb2x5Z29uPWZ1bmN0aW9uKGdlb20scGFyZW50KXt2YXIgcmF3R2VvbT1qc3RzLmdlb20udXRpbC5HZW9tZXRyeVRyYW5zZm9ybWVyLnByb3RvdHlwZS50cmFuc2Zvcm1NdWx0aVBvbHlnb24uYXBwbHkodGhpcyxhcmd1bWVudHMpO3JldHVybiB0aGlzLmNyZWF0ZVZhbGlkQXJlYShyYXdHZW9tKTt9O2pzdHMuc2ltcGxpZnkuRFBUcmFuc2Zvcm1lci5wcm90b3R5cGUuY3JlYXRlVmFsaWRBcmVhPWZ1bmN0aW9uKHJhd0FyZWFHZW9tKXtpZih0aGlzLmlzRW5zdXJlVmFsaWRUb3BvbG9neSl7cmV0dXJuIHJhd0FyZWFHZW9tLmJ1ZmZlcigwLjApO31cbnJldHVybiByYXdBcmVhR2VvbTt9O2pzdHMuZ2VvbS51dGlsLkdlb21ldHJ5RXh0cmFjdGVyPWZ1bmN0aW9uKGNseixjb21wcyl7dGhpcy5jbHo9Y2x6O3RoaXMuY29tcHM9Y29tcHM7fTtqc3RzLmdlb20udXRpbC5HZW9tZXRyeUV4dHJhY3Rlci5wcm90b3R5cGU9bmV3IGpzdHMuZ2VvbS5HZW9tZXRyeUZpbHRlcigpO2pzdHMuZ2VvbS51dGlsLkdlb21ldHJ5RXh0cmFjdGVyLnByb3RvdHlwZS5jbHo9bnVsbDtqc3RzLmdlb20udXRpbC5HZW9tZXRyeUV4dHJhY3Rlci5wcm90b3R5cGUuY29tcHM9bnVsbDtqc3RzLmdlb20udXRpbC5HZW9tZXRyeUV4dHJhY3Rlci5leHRyYWN0PWZ1bmN0aW9uKGdlb20sY2x6LGxpc3Qpe2xpc3Q9bGlzdHx8bmV3IGphdmFzY3JpcHQudXRpbC5BcnJheUxpc3QoKTtpZihnZW9tIGluc3RhbmNlb2YgY2x6KXtsaXN0LmFkZChnZW9tKTt9XG5lbHNlIGlmKGdlb20gaW5zdGFuY2VvZiBqc3RzLmdlb20uR2VvbWV0cnlDb2xsZWN0aW9ufHxnZW9tIGluc3RhbmNlb2YganN0cy5nZW9tLk11bHRpUG9pbnR8fGdlb20gaW5zdGFuY2VvZiBqc3RzLmdlb20uTXVsdGlMaW5lU3RyaW5nfHxnZW9tIGluc3RhbmNlb2YganN0cy5nZW9tLk11bHRpUG9seWdvbil7Z2VvbS5hcHBseShuZXcganN0cy5nZW9tLnV0aWwuR2VvbWV0cnlFeHRyYWN0ZXIoY2x6LGxpc3QpKTt9XG5yZXR1cm4gbGlzdDt9O2pzdHMuZ2VvbS51dGlsLkdlb21ldHJ5RXh0cmFjdGVyLnByb3RvdHlwZS5maWx0ZXI9ZnVuY3Rpb24oZ2VvbSl7aWYodGhpcy5jbHo9PT1udWxsfHxnZW9tIGluc3RhbmNlb2YgdGhpcy5jbHope3RoaXMuY29tcHMuYWRkKGdlb20pO319OyhmdW5jdGlvbigpe3ZhciBPdmVybGF5T3A9anN0cy5vcGVyYXRpb24ub3ZlcmxheS5PdmVybGF5T3A7dmFyIFNuYXBPdmVybGF5T3A9anN0cy5vcGVyYXRpb24ub3ZlcmxheS5zbmFwLlNuYXBPdmVybGF5T3A7dmFyIFNuYXBJZk5lZWRlZE92ZXJsYXlPcD1mdW5jdGlvbihnMSxnMil7dGhpcy5nZW9tPVtdO3RoaXMuZ2VvbVswXT1nMTt0aGlzLmdlb21bMV09ZzI7fTtTbmFwSWZOZWVkZWRPdmVybGF5T3Aub3ZlcmxheU9wPWZ1bmN0aW9uKGcwLGcxLG9wQ29kZSl7dmFyIG9wPW5ldyBTbmFwSWZOZWVkZWRPdmVybGF5T3AoZzAsZzEpO3JldHVybiBvcC5nZXRSZXN1bHRHZW9tZXRyeShvcENvZGUpO307U25hcElmTmVlZGVkT3ZlcmxheU9wLmludGVyc2VjdGlvbj1mdW5jdGlvbihnMCxnMSl7cmV0dXJuIG92ZXJsYXlPcChnMCxnMSxPdmVybGF5T3AuSU5URVJTRUNUSU9OKTt9O1NuYXBJZk5lZWRlZE92ZXJsYXlPcC51bmlvbj1mdW5jdGlvbihnMCxnMSl7cmV0dXJuIG92ZXJsYXlPcChnMCxnMSxPdmVybGF5T3AuVU5JT04pO307U25hcElmTmVlZGVkT3ZlcmxheU9wLmRpZmZlcmVuY2U9ZnVuY3Rpb24oZzAsZzEpe3JldHVybiBvdmVybGF5T3AoZzAsZzEsT3ZlcmxheU9wLkRJRkZFUkVOQ0UpO307U25hcElmTmVlZGVkT3ZlcmxheU9wLnN5bURpZmZlcmVuY2U9ZnVuY3Rpb24oZzAsZzEpe3JldHVybiBvdmVybGF5T3AoZzAsZzEsT3ZlcmxheU9wLlNZTURJRkZFUkVOQ0UpO307U25hcElmTmVlZGVkT3ZlcmxheU9wLnByb3RvdHlwZS5nZW9tPW51bGw7U25hcElmTmVlZGVkT3ZlcmxheU9wLnByb3RvdHlwZS5nZXRSZXN1bHRHZW9tZXRyeT1mdW5jdGlvbihvcENvZGUpe3ZhciByZXN1bHQ9bnVsbDt2YXIgaXNTdWNjZXNzPWZhbHNlO3ZhciBzYXZlZEV4Y2VwdGlvbj1udWxsO3RyeXtyZXN1bHQ9T3ZlcmxheU9wLm92ZXJsYXlPcCh0aGlzLmdlb21bMF0sdGhpcy5nZW9tWzFdLG9wQ29kZSk7dmFyIGlzVmFsaWQ9dHJ1ZTtpZihpc1ZhbGlkKVxuaXNTdWNjZXNzPXRydWU7fWNhdGNoKGV4KXtzYXZlZEV4Y2VwdGlvbj1leDt9XG5pZighaXNTdWNjZXNzKXt0cnl7cmVzdWx0PVNuYXBPdmVybGF5T3Aub3ZlcmxheU9wKHRoaXMuZ2VvbVswXSx0aGlzLmdlb21bMV0sb3BDb2RlKTt9Y2F0Y2goZXgpe3Rocm93IHNhdmVkRXhjZXB0aW9uO319XG5yZXR1cm4gcmVzdWx0O307anN0cy5vcGVyYXRpb24ub3ZlcmxheS5zbmFwLlNuYXBJZk5lZWRlZE92ZXJsYXlPcD1TbmFwSWZOZWVkZWRPdmVybGF5T3A7fSkoKTsoZnVuY3Rpb24oKXt2YXIgR2VvbWV0cnlFeHRyYWN0ZXI9anN0cy5nZW9tLnV0aWwuR2VvbWV0cnlFeHRyYWN0ZXI7dmFyIENhc2NhZGVkUG9seWdvblVuaW9uPWpzdHMub3BlcmF0aW9uLnVuaW9uLkNhc2NhZGVkUG9seWdvblVuaW9uO3ZhciBQb2ludEdlb21ldHJ5VW5pb249anN0cy5vcGVyYXRpb24udW5pb24uUG9pbnRHZW9tZXRyeVVuaW9uO3ZhciBPdmVybGF5T3A9anN0cy5vcGVyYXRpb24ub3ZlcmxheS5PdmVybGF5T3A7dmFyIFNuYXBJZk5lZWRlZE92ZXJsYXlPcD1qc3RzLm9wZXJhdGlvbi5vdmVybGF5LnNuYXAuU25hcElmTmVlZGVkT3ZlcmxheU9wO3ZhciBBcnJheUxpc3Q9amF2YXNjcmlwdC51dGlsLkFycmF5TGlzdDtqc3RzLm9wZXJhdGlvbi51bmlvbi5VbmFyeVVuaW9uT3A9ZnVuY3Rpb24oZ2VvbXMsZ2VvbUZhY3Qpe3RoaXMucG9seWdvbnM9bmV3IEFycmF5TGlzdCgpO3RoaXMubGluZXM9bmV3IEFycmF5TGlzdCgpO3RoaXMucG9pbnRzPW5ldyBBcnJheUxpc3QoKTtpZihnZW9tRmFjdCl7dGhpcy5nZW9tRmFjdD1nZW9tRmFjdDt9XG50aGlzLmV4dHJhY3QoZ2VvbXMpO307anN0cy5vcGVyYXRpb24udW5pb24uVW5hcnlVbmlvbk9wLnVuaW9uPWZ1bmN0aW9uKGdlb21zLGdlb21GYWN0KXt2YXIgb3A9bmV3IGpzdHMub3BlcmF0aW9uLnVuaW9uLlVuYXJ5VW5pb25PcChnZW9tcyxnZW9tRmFjdCk7cmV0dXJuIG9wLnVuaW9uKCk7fTtqc3RzLm9wZXJhdGlvbi51bmlvbi5VbmFyeVVuaW9uT3AucHJvdG90eXBlLnBvbHlnb25zPW51bGw7anN0cy5vcGVyYXRpb24udW5pb24uVW5hcnlVbmlvbk9wLnByb3RvdHlwZS5saW5lcz1udWxsO2pzdHMub3BlcmF0aW9uLnVuaW9uLlVuYXJ5VW5pb25PcC5wcm90b3R5cGUucG9pbnRzPW51bGw7anN0cy5vcGVyYXRpb24udW5pb24uVW5hcnlVbmlvbk9wLnByb3RvdHlwZS5nZW9tRmFjdD1udWxsO2pzdHMub3BlcmF0aW9uLnVuaW9uLlVuYXJ5VW5pb25PcC5wcm90b3R5cGUuZXh0cmFjdD1mdW5jdGlvbihnZW9tcyl7aWYoZ2VvbXMgaW5zdGFuY2VvZiBBcnJheUxpc3Qpe2Zvcih2YXIgaT1nZW9tcy5pdGVyYXRvcigpO2kuaGFzTmV4dCgpOyl7dmFyIGdlb209aS5uZXh0KCk7dGhpcy5leHRyYWN0KGdlb20pO319ZWxzZXtpZih0aGlzLmdlb21GYWN0PT09bnVsbCl7dGhpcy5nZW9tRmFjdD1nZW9tcy5nZXRGYWN0b3J5KCk7fVxuR2VvbWV0cnlFeHRyYWN0ZXIuZXh0cmFjdChnZW9tcyxqc3RzLmdlb20uUG9seWdvbix0aGlzLnBvbHlnb25zKTtHZW9tZXRyeUV4dHJhY3Rlci5leHRyYWN0KGdlb21zLGpzdHMuZ2VvbS5MaW5lU3RyaW5nLHRoaXMubGluZXMpO0dlb21ldHJ5RXh0cmFjdGVyLmV4dHJhY3QoZ2VvbXMsanN0cy5nZW9tLlBvaW50LHRoaXMucG9pbnRzKTt9fTtqc3RzLm9wZXJhdGlvbi51bmlvbi5VbmFyeVVuaW9uT3AucHJvdG90eXBlLnVuaW9uPWZ1bmN0aW9uKCl7aWYodGhpcy5nZW9tRmFjdD09PW51bGwpe3JldHVybiBudWxsO31cbnZhciB1bmlvblBvaW50cz1udWxsO2lmKHRoaXMucG9pbnRzLnNpemUoKT4wKXt2YXIgcHRHZW9tPXRoaXMuZ2VvbUZhY3QuYnVpbGRHZW9tZXRyeSh0aGlzLnBvaW50cyk7dW5pb25Qb2ludHM9dGhpcy51bmlvbk5vT3B0KHB0R2VvbSk7fVxudmFyIHVuaW9uTGluZXM9bnVsbDtpZih0aGlzLmxpbmVzLnNpemUoKT4wKXt2YXIgbGluZUdlb209dGhpcy5nZW9tRmFjdC5idWlsZEdlb21ldHJ5KHRoaXMubGluZXMpO3VuaW9uTGluZXM9dGhpcy51bmlvbk5vT3B0KGxpbmVHZW9tKTt9XG52YXIgdW5pb25Qb2x5Z29ucz1udWxsO2lmKHRoaXMucG9seWdvbnMuc2l6ZSgpPjApe3VuaW9uUG9seWdvbnM9Q2FzY2FkZWRQb2x5Z29uVW5pb24udW5pb24odGhpcy5wb2x5Z29ucyk7fVxudmFyIHVuaW9uTEE9dGhpcy51bmlvbldpdGhOdWxsKHVuaW9uTGluZXMsdW5pb25Qb2x5Z29ucyk7dmFyIHVuaW9uPW51bGw7aWYodW5pb25Qb2ludHM9PT1udWxsKXt1bmlvbj11bmlvbkxBO31lbHNlIGlmKHVuaW9uTEE9PT1udWxsKXt1bmlvbj11bmlvblBvaW50czt9ZWxzZXt1bmlvbj1Qb2ludEdlb21ldHJ5VW5pb24odW5pb25Qb2ludHMsdW5pb25MQSk7fVxuaWYodW5pb249PT1udWxsKXtyZXR1cm4gdGhpcy5nZW9tRmFjdC5jcmVhdGVHZW9tZXRyeUNvbGxlY3Rpb24obnVsbCk7fVxucmV0dXJuIHVuaW9uO307anN0cy5vcGVyYXRpb24udW5pb24uVW5hcnlVbmlvbk9wLnByb3RvdHlwZS51bmlvbldpdGhOdWxsPWZ1bmN0aW9uKGcwLGcxKXtpZihnMD09PW51bGwmJmcxPT09bnVsbCl7cmV0dXJuIG51bGw7fVxuaWYoZzE9PT1udWxsKXtyZXR1cm4gZzA7fVxuaWYoZzA9PT1udWxsKXtyZXR1cm4gZzE7fVxucmV0dXJuIGcwLnVuaW9uKGcxKTt9O2pzdHMub3BlcmF0aW9uLnVuaW9uLlVuYXJ5VW5pb25PcC5wcm90b3R5cGUudW5pb25Ob09wdD1mdW5jdGlvbihnMCl7dmFyIGVtcHR5PXRoaXMuZ2VvbUZhY3QuY3JlYXRlUG9pbnQobnVsbCk7cmV0dXJuIFNuYXBJZk5lZWRlZE92ZXJsYXlPcC5vdmVybGF5T3AoZzAsZW1wdHksT3ZlcmxheU9wLlVOSU9OKTt9O30oKSk7anN0cy5pbmRleC5rZHRyZWUuS2ROb2RlPWZ1bmN0aW9uKCl7dGhpcy5sZWZ0PW51bGw7dGhpcy5yaWdodD1udWxsO3RoaXMuY291bnQ9MTtpZihhcmd1bWVudHMubGVuZ3RoPT09Mil7dGhpcy5pbml0aWFsaXplRnJvbUNvb3JkaW5hdGUuYXBwbHkodGhpcyxhcmd1bWVudHNbMF0sYXJndW1lbnRzWzFdKTt9ZWxzZSBpZihhcmd1bWVudHMubGVuZ3RoPT09Myl7dGhpcy5pbml0aWFsaXplRnJvbVhZLmFwcGx5KHRoaXMsYXJndW1lbnRzWzBdLGFyZ3VtZW50c1sxXSxhcmd1bWVudHNbMl0pO319O2pzdHMuaW5kZXgua2R0cmVlLktkTm9kZS5wcm90b3R5cGUuaW5pdGlhbGl6ZUZyb21YWT1mdW5jdGlvbih4LHksZGF0YSl7dGhpcy5wPW5ldyBqc3RzLmdlb20uQ29vcmRpbmF0ZSh4LHkpO3RoaXMuZGF0YT1kYXRhO307anN0cy5pbmRleC5rZHRyZWUuS2ROb2RlLnByb3RvdHlwZS5pbml0aWFsaXplRnJvbUNvb3JkaW5hdGU9ZnVuY3Rpb24ocCxkYXRhKXt0aGlzLnA9cDt0aGlzLmRhdGE9ZGF0YTt9O2pzdHMuaW5kZXgua2R0cmVlLktkTm9kZS5wcm90b3R5cGUuZ2V0WD1mdW5jdGlvbigpe3JldHVybiB0aGlzLnAueDt9O2pzdHMuaW5kZXgua2R0cmVlLktkTm9kZS5wcm90b3R5cGUuZ2V0WT1mdW5jdGlvbigpe3JldHVybiB0aGlzLnAueTt9O2pzdHMuaW5kZXgua2R0cmVlLktkTm9kZS5wcm90b3R5cGUuZ2V0Q29vcmRpbmF0ZT1mdW5jdGlvbigpe3JldHVybiB0aGlzLnA7fTtqc3RzLmluZGV4LmtkdHJlZS5LZE5vZGUucHJvdG90eXBlLmdldERhdGE9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5kYXRhO307anN0cy5pbmRleC5rZHRyZWUuS2ROb2RlLnByb3RvdHlwZS5nZXRMZWZ0PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMubGVmdDt9O2pzdHMuaW5kZXgua2R0cmVlLktkTm9kZS5wcm90b3R5cGUuZ2V0UmlnaHQ9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5yaWdodDt9O2pzdHMuaW5kZXgua2R0cmVlLktkTm9kZS5wcm90b3R5cGUuaW5jcmVtZW50PWZ1bmN0aW9uKCl7dGhpcy5jb3VudCs9MTt9O2pzdHMuaW5kZXgua2R0cmVlLktkTm9kZS5wcm90b3R5cGUuZ2V0Q291bnQ9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5jb3VudDt9O2pzdHMuaW5kZXgua2R0cmVlLktkTm9kZS5wcm90b3R5cGUuaXNSZXBlYXRlZD1mdW5jdGlvbigpe3JldHVybiBjb3VudD4xO307anN0cy5pbmRleC5rZHRyZWUuS2ROb2RlLnByb3RvdHlwZS5zZXRMZWZ0PWZ1bmN0aW9uKGxlZnQpe3RoaXMubGVmdD1sZWZ0O307anN0cy5pbmRleC5rZHRyZWUuS2ROb2RlLnByb3RvdHlwZS5zZXRSaWdodD1mdW5jdGlvbihyaWdodCl7dGhpcy5yaWdodD1yaWdodDt9O2pzdHMuYWxnb3JpdGhtLkludGVyaW9yUG9pbnRQb2ludD1mdW5jdGlvbihnZW9tZXRyeSl7dGhpcy5taW5EaXN0YW5jZT1OdW1iZXIuTUFYX1ZBTFVFO3RoaXMuaW50ZXJpb3JQb2ludD1udWxsO3RoaXMuY2VudHJvaWQ9Z2VvbWV0cnkuZ2V0Q2VudHJvaWQoKS5nZXRDb29yZGluYXRlKCk7dGhpcy5hZGQoZ2VvbWV0cnkpO307anN0cy5hbGdvcml0aG0uSW50ZXJpb3JQb2ludFBvaW50LnByb3RvdHlwZS5hZGQ9ZnVuY3Rpb24oZ2VvbWV0cnkpe2lmKGdlb21ldHJ5IGluc3RhbmNlb2YganN0cy5nZW9tLlBvaW50KXt0aGlzLmFkZFBvaW50KGdlb21ldHJ5LmdldENvb3JkaW5hdGUoKSk7fWVsc2UgaWYoZ2VvbWV0cnkgaW5zdGFuY2VvZiBqc3RzLmdlb20uR2VvbWV0cnlDb2xsZWN0aW9uKXtmb3IodmFyIGk9MDtpPGdlb21ldHJ5LmdldE51bUdlb21ldHJpZXMoKTtpKyspe3RoaXMuYWRkKGdlb21ldHJ5LmdldEdlb21ldHJ5TihpKSk7fX19O2pzdHMuYWxnb3JpdGhtLkludGVyaW9yUG9pbnRQb2ludC5wcm90b3R5cGUuYWRkUG9pbnQ9ZnVuY3Rpb24ocG9pbnQpe3ZhciBkaXN0PXBvaW50LmRpc3RhbmNlKHRoaXMuY2VudHJvaWQpO2lmKGRpc3Q8dGhpcy5taW5EaXN0YW5jZSl7dGhpcy5pbnRlcmlvclBvaW50PW5ldyBqc3RzLmdlb20uQ29vcmRpbmF0ZShwb2ludCk7dGhpcy5taW5EaXN0YW5jZT1kaXN0O319O2pzdHMuYWxnb3JpdGhtLkludGVyaW9yUG9pbnRQb2ludC5wcm90b3R5cGUuZ2V0SW50ZXJpb3JQb2ludD1mdW5jdGlvbigpe3JldHVybiB0aGlzLmludGVyaW9yUG9pbnQ7fTsoZnVuY3Rpb24oKXtqc3RzLmdlb20uTXVsdGlMaW5lU3RyaW5nPWZ1bmN0aW9uKGdlb21ldHJpZXMsZmFjdG9yeSl7dGhpcy5nZW9tZXRyaWVzPWdlb21ldHJpZXN8fFtdO3RoaXMuZmFjdG9yeT1mYWN0b3J5O307anN0cy5nZW9tLk11bHRpTGluZVN0cmluZy5wcm90b3R5cGU9bmV3IGpzdHMuZ2VvbS5HZW9tZXRyeUNvbGxlY3Rpb24oKTtqc3RzLmdlb20uTXVsdGlMaW5lU3RyaW5nLmNvbnN0cnVjdG9yPWpzdHMuZ2VvbS5NdWx0aUxpbmVTdHJpbmc7anN0cy5nZW9tLk11bHRpTGluZVN0cmluZy5wcm90b3R5cGUuZ2V0Qm91bmRhcnk9ZnVuY3Rpb24oKXtyZXR1cm4obmV3IGpzdHMub3BlcmF0aW9uLkJvdW5kYXJ5T3AodGhpcykpLmdldEJvdW5kYXJ5KCk7fTtqc3RzLmdlb20uTXVsdGlMaW5lU3RyaW5nLnByb3RvdHlwZS5lcXVhbHNFeGFjdD1mdW5jdGlvbihvdGhlcix0b2xlcmFuY2Upe2lmKCF0aGlzLmlzRXF1aXZhbGVudENsYXNzKG90aGVyKSl7cmV0dXJuIGZhbHNlO31cbnJldHVybiBqc3RzLmdlb20uR2VvbWV0cnlDb2xsZWN0aW9uLnByb3RvdHlwZS5lcXVhbHNFeGFjdC5jYWxsKHRoaXMsb3RoZXIsdG9sZXJhbmNlKTt9O2pzdHMuZ2VvbS5NdWx0aUxpbmVTdHJpbmcucHJvdG90eXBlLkNMQVNTX05BTUU9J2pzdHMuZ2VvbS5NdWx0aUxpbmVTdHJpbmcnO30pKCk7KGZ1bmN0aW9uKCl7dmFyIEludGVydmFsPWpzdHMuaW5kZXguYmludHJlZS5JbnRlcnZhbDt2YXIgUm9vdD1qc3RzLmluZGV4LmJpbnRyZWUuUm9vdDt2YXIgQmludHJlZT1mdW5jdGlvbigpe3RoaXMucm9vdD1uZXcgUm9vdCgpO3RoaXMubWluRXh0ZW50PTEuMDt9O0JpbnRyZWUuZW5zdXJlRXh0ZW50PWZ1bmN0aW9uKGl0ZW1JbnRlcnZhbCxtaW5FeHRlbnQpe3ZhciBtaW4sbWF4O21pbj1pdGVtSW50ZXJ2YWwuZ2V0TWluKCk7bWF4PWl0ZW1JbnRlcnZhbC5nZXRNYXgoKTtpZihtaW4hPT1tYXgpe3JldHVybiBpdGVtSW50ZXJ2YWw7fVxuaWYobWluPT09bWF4KXttaW49bWluLShtaW5FeHRlbnQvMi4wKTttYXg9bWluKyhtaW5FeHRlbnQvMi4wKTt9XG5yZXR1cm4gbmV3IEludGVydmFsKG1pbixtYXgpO307QmludHJlZS5wcm90b3R5cGUuZGVwdGg9ZnVuY3Rpb24oKXtpZih0aGlzLnJvb3QhPT1udWxsKXtyZXR1cm4gdGhpcy5yb290LmRlcHRoKCk7fVxucmV0dXJuIDA7fTtCaW50cmVlLnByb3RvdHlwZS5zaXplPWZ1bmN0aW9uKCl7aWYodGhpcy5yb290IT09bnVsbCl7cmV0dXJuIHRoaXMucm9vdC5zaXplKCk7fVxucmV0dXJuIDA7fTtCaW50cmVlLnByb3RvdHlwZS5ub2RlU2l6ZT1mdW5jdGlvbigpe2lmKHRoaXMucm9vdCE9PW51bGwpe3JldHVybiB0aGlzLnJvb3Qubm9kZVNpemUoKTt9XG5yZXR1cm4gMDt9O0JpbnRyZWUucHJvdG90eXBlLmluc2VydD1mdW5jdGlvbihpdGVtSW50ZXJ2YWwsaXRlbSl7dGhpcy5jb2xsZWN0U3RhdHMoaXRlbUludGVydmFsKTt2YXIgaW5zZXJ0SW50ZXJ2YWw9QmludHJlZS5lbnN1cmVFeHRlbnQoaXRlbUludGVydmFsLHRoaXMubWluRXh0ZW50KTt0aGlzLnJvb3QuaW5zZXJ0KGluc2VydEludGVydmFsLGl0ZW0pO307QmludHJlZS5wcm90b3R5cGUucmVtb3ZlPWZ1bmN0aW9uKGl0ZW1JbnRlcnZhbCxpdGVtKXt2YXIgaW5zZXJ0SW50ZXJ2YWw9QmludHJlZS5lbnN1cmVFeHRlbnQoaXRlbUludGVydmFsLHRoaXMubWluRXh0ZW50KTtyZXR1cm4gdGhpcy5yb290LnJlbW92ZShpbnNlcnRJbnRlcnZhbCxpdGVtKTt9O0JpbnRyZWUucHJvdG90eXBlLml0ZXJhdG9yPWZ1bmN0aW9uKCl7dmFyIGZvdW5kSXRlbXM9bmV3IGphdmFzY3JpcHQudXRpbC5BcnJheUxpc3QoKTt0aGlzLnJvb3QuYWRkQWxsSXRlbXMoZm91bmRJdGVtcyk7cmV0dXJuIGZvdW5kSXRlbXMuaXRlcmF0b3IoKTt9O0JpbnRyZWUucHJvdG90eXBlLnF1ZXJ5PWZ1bmN0aW9uKCl7aWYoYXJndW1lbnRzLmxlbmd0aD09PTIpe3RoaXMucXVlcnlBbmRBZGQoYXJndW1lbnRzWzBdLGFyZ3VtZW50c1sxXSk7fWVsc2V7dmFyIHg9YXJndW1lbnRzWzBdO2lmKCF4IGluc3RhbmNlb2YgSW50ZXJ2YWwpe3g9bmV3IEludGVydmFsKHgseCk7fVxucmV0dXJuIHRoaXMucXVlcnlJbnRlcnZhbCh4KTt9fTtCaW50cmVlLnByb3RvdHlwZS5xdWVyeUludGVydmFsPWZ1bmN0aW9uKGludGVydmFsKXt2YXIgZm91bmRJdGVtcz1uZXcgamF2YXNjcmlwdC51dGlsLkFycmF5TGlzdCgpO3RoaXMucXVlcnkoaW50ZXJ2YWwsZm91bmRJdGVtcyk7cmV0dXJuIGZvdW5kSXRlbXM7fTtCaW50cmVlLnByb3RvdHlwZS5xdWVyeUFuZEFkZD1mdW5jdGlvbihpbnRlcnZhbCxmb3VuZEl0ZW1zKXt0aGlzLnJvb3QuYWRkQWxsSXRlbXNGcm9tT3ZlcmxhcHBpbmcoaW50ZXJ2YWwsZm91bmRJdGVtcyk7fTtCaW50cmVlLnByb3RvdHlwZS5jb2xsZWN0U3RhdHM9ZnVuY3Rpb24oaW50ZXJ2YWwpe3ZhciBkZWw9aW50ZXJ2YWwuZ2V0V2lkdGgoKTtpZihkZWw8dGhpcy5taW5FeHRlbnQmJmRlbD4wLjApe3RoaXMubWluRXh0ZW50PWRlbDt9fTtqc3RzLmluZGV4LmJpbnRyZWUuQmludHJlZT1CaW50cmVlO30pKCk7anN0cy5hbGdvcml0aG0uSW50ZXJpb3JQb2ludEFyZWE9ZnVuY3Rpb24oZ2VvbWV0cnkpe3RoaXMuZmFjdG9yeTt0aGlzLmludGVyaW9yUG9pbnQ9bnVsbDt0aGlzLm1heFdpZHRoPTA7dGhpcy5mYWN0b3J5PWdlb21ldHJ5LmdldEZhY3RvcnkoKTt0aGlzLmFkZChnZW9tZXRyeSk7fTtqc3RzLmFsZ29yaXRobS5JbnRlcmlvclBvaW50QXJlYS5hdmc9ZnVuY3Rpb24oYSxiKXtyZXR1cm4oYStiKS8yO307anN0cy5hbGdvcml0aG0uSW50ZXJpb3JQb2ludEFyZWEucHJvdG90eXBlLmdldEludGVyaW9yUG9pbnQ9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5pbnRlcmlvclBvaW50O307anN0cy5hbGdvcml0aG0uSW50ZXJpb3JQb2ludEFyZWEucHJvdG90eXBlLmFkZD1mdW5jdGlvbihnZW9tZXRyeSl7aWYoZ2VvbWV0cnkgaW5zdGFuY2VvZiBqc3RzLmdlb20uUG9seWdvbil7dGhpcy5hZGRQb2x5Z29uKGdlb21ldHJ5KTt9ZWxzZSBpZihnZW9tZXRyeSBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5HZW9tZXRyeUNvbGxlY3Rpb24pe2Zvcih2YXIgaT0wO2k8Z2VvbWV0cnkuZ2V0TnVtR2VvbWV0cmllcygpO2krKyl7dGhpcy5hZGQoZ2VvbWV0cnkuZ2V0R2VvbWV0cnlOKGkpKTt9fX07anN0cy5hbGdvcml0aG0uSW50ZXJpb3JQb2ludEFyZWEucHJvdG90eXBlLmFkZFBvbHlnb249ZnVuY3Rpb24oZ2VvbWV0cnkpe2lmKGdlb21ldHJ5LmlzRW1wdHkoKSl7cmV0dXJuO31cbnZhciBpbnRQdDt2YXIgd2lkdGg9MDt2YXIgYmlzZWN0b3I9dGhpcy5ob3Jpem9udGFsQmlzZWN0b3IoZ2VvbWV0cnkpO2lmKGJpc2VjdG9yLmdldExlbmd0aCgpPT0wLjApe3dpZHRoPTA7aW50UHQ9YmlzZWN0b3IuZ2V0Q29vcmRpbmF0ZSgpO31lbHNle3ZhciBpbnRlcnNlY3Rpb25zPWJpc2VjdG9yLmludGVyc2VjdGlvbihnZW9tZXRyeSk7dmFyIHdpZGVzdEludGVyc2VjdGlvbj10aGlzLndpZGVzdEdlb21ldHJ5KGludGVyc2VjdGlvbnMpO3dpZHRoPXdpZGVzdEludGVyc2VjdGlvbi5nZXRFbnZlbG9wZUludGVybmFsKCkuZ2V0V2lkdGgoKTtpbnRQdD10aGlzLmNlbnRyZSh3aWRlc3RJbnRlcnNlY3Rpb24uZ2V0RW52ZWxvcGVJbnRlcm5hbCgpKTt9XG5pZih0aGlzLmludGVyaW9yUG9pbnQ9PW51bGx8fHdpZHRoPnRoaXMubWF4V2lkdGgpe3RoaXMuaW50ZXJpb3JQb2ludD1pbnRQdDt0aGlzLm1heFdpZHRoPXdpZHRoO319O2pzdHMuYWxnb3JpdGhtLkludGVyaW9yUG9pbnRBcmVhLnByb3RvdHlwZS53aWRlc3RHZW9tZXRyeT1mdW5jdGlvbihvYmope2lmKG9iaiBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5HZW9tZXRyeUNvbGxlY3Rpb24pe3ZhciBnYz1vYmo7aWYoZ2MuaXNFbXB0eSgpKXtyZXR1cm4gZ2M7fVxudmFyIHdpZGVzdEdlb21ldHJ5PWdjLmdldEdlb21ldHJ5TigwKTtmb3IodmFyIGk9MTtpPGdjLmdldE51bUdlb21ldHJpZXMoKTtpKyspe2lmKGdjLmdldEdlb21ldHJ5TihpKS5nZXRFbnZlbG9wZUludGVybmFsKCkuZ2V0V2lkdGgoKT53aWRlc3RHZW9tZXRyeS5nZXRFbnZlbG9wZUludGVybmFsKCkuZ2V0V2lkdGgoKSl7d2lkZXN0R2VvbWV0cnk9Z2MuZ2V0R2VvbWV0cnlOKGkpO319XG5yZXR1cm4gd2lkZXN0R2VvbWV0cnk7fWVsc2UgaWYob2JqIGluc3RhbmNlb2YganN0cy5nZW9tLkdlb21ldHJ5KXtyZXR1cm4gb2JqO319O2pzdHMuYWxnb3JpdGhtLkludGVyaW9yUG9pbnRBcmVhLnByb3RvdHlwZS5ob3Jpem9udGFsQmlzZWN0b3I9ZnVuY3Rpb24oZ2VvbWV0cnkpe3ZhciBlbnZlbG9wZT1nZW9tZXRyeS5nZXRFbnZlbG9wZUludGVybmFsKCk7dmFyIGJpc2VjdFk9anN0cy5hbGdvcml0aG0uU2FmZUJpc2VjdG9yRmluZGVyLmdldEJpc2VjdG9yWShnZW9tZXRyeSk7cmV0dXJuIHRoaXMuZmFjdG9yeS5jcmVhdGVMaW5lU3RyaW5nKFtuZXcganN0cy5nZW9tLkNvb3JkaW5hdGUoZW52ZWxvcGUuZ2V0TWluWCgpLGJpc2VjdFkpLG5ldyBqc3RzLmdlb20uQ29vcmRpbmF0ZShlbnZlbG9wZS5nZXRNYXhYKCksYmlzZWN0WSldKTt9O2pzdHMuYWxnb3JpdGhtLkludGVyaW9yUG9pbnRBcmVhLnByb3RvdHlwZS5jZW50cmU9ZnVuY3Rpb24oZW52ZWxvcGUpe3JldHVybiBuZXcganN0cy5nZW9tLkNvb3JkaW5hdGUoanN0cy5hbGdvcml0aG0uSW50ZXJpb3JQb2ludEFyZWEuYXZnKGVudmVsb3BlLmdldE1pblgoKSxlbnZlbG9wZS5nZXRNYXhYKCkpLGpzdHMuYWxnb3JpdGhtLkludGVyaW9yUG9pbnRBcmVhLmF2ZyhlbnZlbG9wZS5nZXRNaW5ZKCksZW52ZWxvcGUuZ2V0TWF4WSgpKSk7fTtqc3RzLmFsZ29yaXRobS5TYWZlQmlzZWN0b3JGaW5kZXI9ZnVuY3Rpb24ocG9seSl7dGhpcy5wb2x5O3RoaXMuY2VudHJlWTt0aGlzLmhpWT1OdW1iZXIuTUFYX1ZBTFVFO3RoaXMubG9ZPS1OdW1iZXIuTUFYX1ZBTFVFO3RoaXMucG9seT1wb2x5O3RoaXMuaGlZPXBvbHkuZ2V0RW52ZWxvcGVJbnRlcm5hbCgpLmdldE1heFkoKTt0aGlzLmxvWT1wb2x5LmdldEVudmVsb3BlSW50ZXJuYWwoKS5nZXRNaW5ZKCk7dGhpcy5jZW50cmVZPWpzdHMuYWxnb3JpdGhtLkludGVyaW9yUG9pbnRBcmVhLmF2Zyh0aGlzLmxvWSx0aGlzLmhpWSk7fTtqc3RzLmFsZ29yaXRobS5TYWZlQmlzZWN0b3JGaW5kZXIuZ2V0QmlzZWN0b3JZPWZ1bmN0aW9uKHBvbHkpe3ZhciBmaW5kZXI9bmV3IGpzdHMuYWxnb3JpdGhtLlNhZmVCaXNlY3RvckZpbmRlcihwb2x5KTtyZXR1cm4gZmluZGVyLmdldEJpc2VjdG9yWSgpO307anN0cy5hbGdvcml0aG0uU2FmZUJpc2VjdG9yRmluZGVyLnByb3RvdHlwZS5nZXRCaXNlY3Rvclk9ZnVuY3Rpb24oKXt0aGlzLnByb2Nlc3ModGhpcy5wb2x5LmdldEV4dGVyaW9yUmluZygpKTtmb3IodmFyIGk9MDtpPHRoaXMucG9seS5nZXROdW1JbnRlcmlvclJpbmcoKTtpKyspe3RoaXMucHJvY2Vzcyh0aGlzLnBvbHkuZ2V0SW50ZXJpb3JSaW5nTihpKSk7fVxudmFyIGJpc2VjdFk9anN0cy5hbGdvcml0aG0uSW50ZXJpb3JQb2ludEFyZWEuYXZnKHRoaXMuaGlZLHRoaXMubG9ZKTtyZXR1cm4gYmlzZWN0WTt9O2pzdHMuYWxnb3JpdGhtLlNhZmVCaXNlY3RvckZpbmRlci5wcm90b3R5cGUucHJvY2Vzcz1mdW5jdGlvbihsaW5lKXt2YXIgc2VxPWxpbmUuZ2V0Q29vcmRpbmF0ZVNlcXVlbmNlKCk7Zm9yKHZhciBpPTA7aTxzZXEubGVuZ3RoO2krKyl7dmFyIHk9c2VxW2ldLnk7dGhpcy51cGRhdGVJbnRlcnZhbCh5KTt9fTtqc3RzLmFsZ29yaXRobS5TYWZlQmlzZWN0b3JGaW5kZXIucHJvdG90eXBlLnVwZGF0ZUludGVydmFsPWZ1bmN0aW9uKHkpe2lmKHk8PXRoaXMuY2VudHJlWSl7aWYoeT50aGlzLmxvWSl7dGhpcy5sb1k9eTt9fWVsc2UgaWYoeT50aGlzLmNlbnRyZVkpe2lmKHk8dGhpcy5oaVkpe3RoaXMuaGlZPXk7fX19O2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5CdWZmZXJQYXJhbWV0ZXJzPWZ1bmN0aW9uKHF1YWRyYW50U2VnbWVudHMsZW5kQ2FwU3R5bGUsam9pblN0eWxlLG1pdHJlTGltaXQpe2lmKHF1YWRyYW50U2VnbWVudHMpXG50aGlzLnNldFF1YWRyYW50U2VnbWVudHMocXVhZHJhbnRTZWdtZW50cyk7aWYoZW5kQ2FwU3R5bGUpXG50aGlzLnNldEVuZENhcFN0eWxlKGVuZENhcFN0eWxlKTtpZihqb2luU3R5bGUpXG50aGlzLnNldEpvaW5TdHlsZShqb2luU3R5bGUpO2lmKG1pdHJlTGltaXQpXG50aGlzLnNldE1pdHJlTGltaXQobWl0cmVMaW1pdCk7fTtqc3RzLm9wZXJhdGlvbi5idWZmZXIuQnVmZmVyUGFyYW1ldGVycy5DQVBfUk9VTkQ9MTtqc3RzLm9wZXJhdGlvbi5idWZmZXIuQnVmZmVyUGFyYW1ldGVycy5DQVBfRkxBVD0yO2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5CdWZmZXJQYXJhbWV0ZXJzLkNBUF9TUVVBUkU9Mztqc3RzLm9wZXJhdGlvbi5idWZmZXIuQnVmZmVyUGFyYW1ldGVycy5KT0lOX1JPVU5EPTE7anN0cy5vcGVyYXRpb24uYnVmZmVyLkJ1ZmZlclBhcmFtZXRlcnMuSk9JTl9NSVRSRT0yO2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5CdWZmZXJQYXJhbWV0ZXJzLkpPSU5fQkVWRUw9Mztqc3RzLm9wZXJhdGlvbi5idWZmZXIuQnVmZmVyUGFyYW1ldGVycy5ERUZBVUxUX1FVQURSQU5UX1NFR01FTlRTPTg7anN0cy5vcGVyYXRpb24uYnVmZmVyLkJ1ZmZlclBhcmFtZXRlcnMuREVGQVVMVF9NSVRSRV9MSU1JVD01LjA7anN0cy5vcGVyYXRpb24uYnVmZmVyLkJ1ZmZlclBhcmFtZXRlcnMucHJvdG90eXBlLnF1YWRyYW50U2VnbWVudHM9anN0cy5vcGVyYXRpb24uYnVmZmVyLkJ1ZmZlclBhcmFtZXRlcnMuREVGQVVMVF9RVUFEUkFOVF9TRUdNRU5UUztqc3RzLm9wZXJhdGlvbi5idWZmZXIuQnVmZmVyUGFyYW1ldGVycy5wcm90b3R5cGUuZW5kQ2FwU3R5bGU9anN0cy5vcGVyYXRpb24uYnVmZmVyLkJ1ZmZlclBhcmFtZXRlcnMuQ0FQX1JPVU5EO2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5CdWZmZXJQYXJhbWV0ZXJzLnByb3RvdHlwZS5qb2luU3R5bGU9anN0cy5vcGVyYXRpb24uYnVmZmVyLkJ1ZmZlclBhcmFtZXRlcnMuSk9JTl9ST1VORDtqc3RzLm9wZXJhdGlvbi5idWZmZXIuQnVmZmVyUGFyYW1ldGVycy5wcm90b3R5cGUubWl0cmVMaW1pdD1qc3RzLm9wZXJhdGlvbi5idWZmZXIuQnVmZmVyUGFyYW1ldGVycy5ERUZBVUxUX01JVFJFX0xJTUlUO2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5CdWZmZXJQYXJhbWV0ZXJzLnByb3RvdHlwZS5faXNTaW5nbGVTaWRlZD1mYWxzZTtqc3RzLm9wZXJhdGlvbi5idWZmZXIuQnVmZmVyUGFyYW1ldGVycy5wcm90b3R5cGUuZ2V0UXVhZHJhbnRTZWdtZW50cz1mdW5jdGlvbigpe3JldHVybiB0aGlzLnF1YWRyYW50U2VnbWVudHM7fTtqc3RzLm9wZXJhdGlvbi5idWZmZXIuQnVmZmVyUGFyYW1ldGVycy5wcm90b3R5cGUuc2V0UXVhZHJhbnRTZWdtZW50cz1mdW5jdGlvbihxdWFkcmFudFNlZ21lbnRzKXt0aGlzLnF1YWRyYW50U2VnbWVudHM9cXVhZHJhbnRTZWdtZW50czt9O2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5CdWZmZXJQYXJhbWV0ZXJzLnByb3RvdHlwZS5zZXRRdWFkcmFudFNlZ21lbnRzPWZ1bmN0aW9uKHF1YWRTZWdzKXt0aGlzLnF1YWRyYW50U2VnbWVudHM9cXVhZFNlZ3M7aWYodGhpcy5xdWFkcmFudFNlZ21lbnRzPT09MClcbnRoaXMuam9pblN0eWxlPWpzdHMub3BlcmF0aW9uLmJ1ZmZlci5CdWZmZXJQYXJhbWV0ZXJzLkpPSU5fQkVWRUw7aWYodGhpcy5xdWFkcmFudFNlZ21lbnRzPDApe3RoaXMuam9pblN0eWxlPWpzdHMub3BlcmF0aW9uLmJ1ZmZlci5CdWZmZXJQYXJhbWV0ZXJzLkpPSU5fTUlUUkU7dGhpcy5taXRyZUxpbWl0PU1hdGguYWJzKHRoaXMucXVhZHJhbnRTZWdtZW50cyk7fVxuaWYocXVhZFNlZ3M8PTApe3RoaXMucXVhZHJhbnRTZWdtZW50cz0xO31cbmlmKHRoaXMuam9pblN0eWxlIT09anN0cy5vcGVyYXRpb24uYnVmZmVyLkJ1ZmZlclBhcmFtZXRlcnMuSk9JTl9ST1VORCl7dGhpcy5xdWFkcmFudFNlZ21lbnRzPWpzdHMub3BlcmF0aW9uLmJ1ZmZlci5CdWZmZXJQYXJhbWV0ZXJzLkRFRkFVTFRfUVVBRFJBTlRfU0VHTUVOVFM7fX07anN0cy5vcGVyYXRpb24uYnVmZmVyLkJ1ZmZlclBhcmFtZXRlcnMuYnVmZmVyRGlzdGFuY2VFcnJvcj1mdW5jdGlvbihxdWFkU2Vncyl7dmFyIGFscGhhPU1hdGguUEkvMi4wL3F1YWRTZWdzO3JldHVybiAxLU1hdGguY29zKGFscGhhLzIuMCk7fTtqc3RzLm9wZXJhdGlvbi5idWZmZXIuQnVmZmVyUGFyYW1ldGVycy5wcm90b3R5cGUuZ2V0RW5kQ2FwU3R5bGU9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5lbmRDYXBTdHlsZTt9O2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5CdWZmZXJQYXJhbWV0ZXJzLnByb3RvdHlwZS5zZXRFbmRDYXBTdHlsZT1mdW5jdGlvbihlbmRDYXBTdHlsZSl7dGhpcy5lbmRDYXBTdHlsZT1lbmRDYXBTdHlsZTt9O2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5CdWZmZXJQYXJhbWV0ZXJzLnByb3RvdHlwZS5nZXRKb2luU3R5bGU9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5qb2luU3R5bGU7fTtqc3RzLm9wZXJhdGlvbi5idWZmZXIuQnVmZmVyUGFyYW1ldGVycy5wcm90b3R5cGUuc2V0Sm9pblN0eWxlPWZ1bmN0aW9uKGpvaW5TdHlsZSl7dGhpcy5qb2luU3R5bGU9am9pblN0eWxlO307anN0cy5vcGVyYXRpb24uYnVmZmVyLkJ1ZmZlclBhcmFtZXRlcnMucHJvdG90eXBlLmdldE1pdHJlTGltaXQ9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5taXRyZUxpbWl0O307anN0cy5vcGVyYXRpb24uYnVmZmVyLkJ1ZmZlclBhcmFtZXRlcnMucHJvdG90eXBlLnNldE1pdHJlTGltaXQ9ZnVuY3Rpb24obWl0cmVMaW1pdCl7dGhpcy5taXRyZUxpbWl0PW1pdHJlTGltaXQ7fTtqc3RzLm9wZXJhdGlvbi5idWZmZXIuQnVmZmVyUGFyYW1ldGVycy5wcm90b3R5cGUuc2V0U2luZ2xlU2lkZWQ9ZnVuY3Rpb24oaXNTaW5nbGVTaWRlZCl7dGhpcy5faXNTaW5nbGVTaWRlZD1pc1NpbmdsZVNpZGVkO307anN0cy5vcGVyYXRpb24uYnVmZmVyLkJ1ZmZlclBhcmFtZXRlcnMucHJvdG90eXBlLmlzU2luZ2xlU2lkZWQ9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5faXNTaW5nbGVTaWRlZDt9OyhmdW5jdGlvbigpe2pzdHMuZ2VvbS51dGlsLlNob3J0Q2lyY3VpdGVkR2VvbWV0cnlWaXNpdG9yPWZ1bmN0aW9uKCl7fTtqc3RzLmdlb20udXRpbC5TaG9ydENpcmN1aXRlZEdlb21ldHJ5VmlzaXRvci5wcm90b3R5cGUuaXNEb25lPWZhbHNlO2pzdHMuZ2VvbS51dGlsLlNob3J0Q2lyY3VpdGVkR2VvbWV0cnlWaXNpdG9yLnByb3RvdHlwZS5hcHBseVRvPWZ1bmN0aW9uKGdlb20pe2Zvcih2YXIgaT0wO2k8Z2VvbS5nZXROdW1HZW9tZXRyaWVzKCkmJiF0aGlzLmlzRG9uZTtpKyspe3ZhciBlbGVtZW50PWdlb20uZ2V0R2VvbWV0cnlOKGkpO2lmKCEoZWxlbWVudCBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5HZW9tZXRyeUNvbGxlY3Rpb24pKXt0aGlzLnZpc2l0KGVsZW1lbnQpO2lmKHRoaXMuaXNEb25lKCkpe3RoaXMuaXNEb25lPXRydWU7cmV0dXJuO319XG5lbHNlXG50aGlzLmFwcGx5VG8oZWxlbWVudCk7fX1cbmpzdHMuZ2VvbS51dGlsLlNob3J0Q2lyY3VpdGVkR2VvbWV0cnlWaXNpdG9yLnByb3RvdHlwZS52aXNpdD1mdW5jdGlvbihlbGVtZW50KXt9O2pzdHMuZ2VvbS51dGlsLlNob3J0Q2lyY3VpdGVkR2VvbWV0cnlWaXNpdG9yLnByb3RvdHlwZS5pc0RvbmU9ZnVuY3Rpb24oKXt9O30pKCk7KGZ1bmN0aW9uKCl7dmFyIEVudmVsb3BlSW50ZXJzZWN0c1Zpc2l0b3I9ZnVuY3Rpb24ocmVjdEVudil7dGhpcy5yZWN0RW52PXJlY3RFbnY7fTtFbnZlbG9wZUludGVyc2VjdHNWaXNpdG9yLnByb3RvdHlwZT1uZXcganN0cy5nZW9tLnV0aWwuU2hvcnRDaXJjdWl0ZWRHZW9tZXRyeVZpc2l0b3IoKTtFbnZlbG9wZUludGVyc2VjdHNWaXNpdG9yLmNvbnN0cnVjdG9yPUVudmVsb3BlSW50ZXJzZWN0c1Zpc2l0b3I7RW52ZWxvcGVJbnRlcnNlY3RzVmlzaXRvci5wcm90b3R5cGUucmVjdEVudj1udWxsO0VudmVsb3BlSW50ZXJzZWN0c1Zpc2l0b3IucHJvdG90eXBlLmludGVyc2VjdHM9ZmFsc2U7RW52ZWxvcGVJbnRlcnNlY3RzVmlzaXRvci5wcm90b3R5cGUuaW50ZXJzZWN0cz1mdW5jdGlvbigpe3JldHVybiB0aGlzLmludGVyc2VjdHM7fVxuRW52ZWxvcGVJbnRlcnNlY3RzVmlzaXRvci5wcm90b3R5cGUudmlzaXQ9ZnVuY3Rpb24oZWxlbWVudCl7dmFyIGVsZW1lbnRFbnY9ZWxlbWVudC5nZXRFbnZlbG9wZUludGVybmFsKCk7aWYoIXRoaXMucmVjdEVudi5pbnRlcnNlY3RzKGVsZW1lbnRFbnYpKXtyZXR1cm47fVxuaWYodGhpcy5yZWN0RW52LmNvbnRhaW5zKGVsZW1lbnRFbnYpKXt0aGlzLmludGVyc2VjdHM9dHJ1ZTtyZXR1cm47fVxuaWYoZWxlbWVudEVudi5nZXRNaW5YKCk+PXJlY3RFbnYuZ2V0TWluWCgpJiZlbGVtZW50RW52LmdldE1heFgoKTw9cmVjdEVudi5nZXRNYXhYKCkpe3RoaXMuaW50ZXJzZWN0cz10cnVlO3JldHVybjt9XG5pZihlbGVtZW50RW52LmdldE1pblkoKT49cmVjdEVudi5nZXRNaW5ZKCkmJmVsZW1lbnRFbnYuZ2V0TWF4WSgpPD1yZWN0RW52LmdldE1heFkoKSl7dGhpcy5pbnRlcnNlY3RzPXRydWU7cmV0dXJuO319XG5FbnZlbG9wZUludGVyc2VjdHNWaXNpdG9yLnByb3RvdHlwZS5pc0RvbmU9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5pbnRlcnNlY3RzPT10cnVlO31cbnZhciBHZW9tZXRyeUNvbnRhaW5zUG9pbnRWaXNpdG9yPWZ1bmN0aW9uKHJlY3RhbmdsZSl7dGhpcy5yZWN0U2VxPXJlY3RhbmdsZS5nZXRFeHRlcmlvclJpbmcoKS5nZXRDb29yZGluYXRlU2VxdWVuY2UoKTt0aGlzLnJlY3RFbnY9cmVjdGFuZ2xlLmdldEVudmVsb3BlSW50ZXJuYWwoKTt9O0dlb21ldHJ5Q29udGFpbnNQb2ludFZpc2l0b3IucHJvdG90eXBlPW5ldyBqc3RzLmdlb20udXRpbC5TaG9ydENpcmN1aXRlZEdlb21ldHJ5VmlzaXRvcigpO0dlb21ldHJ5Q29udGFpbnNQb2ludFZpc2l0b3IuY29uc3RydWN0b3I9R2VvbWV0cnlDb250YWluc1BvaW50VmlzaXRvcjtHZW9tZXRyeUNvbnRhaW5zUG9pbnRWaXNpdG9yLnByb3RvdHlwZS5yZWN0U2VxPW51bGw7R2VvbWV0cnlDb250YWluc1BvaW50VmlzaXRvci5wcm90b3R5cGUucmVjdEVudj1udWxsO0dlb21ldHJ5Q29udGFpbnNQb2ludFZpc2l0b3IucHJvdG90eXBlLmNvbnRhaW5zUG9pbnQ9ZmFsc2U7R2VvbWV0cnlDb250YWluc1BvaW50VmlzaXRvci5wcm90b3R5cGUuY29udGFpbnNQb2ludD1mdW5jdGlvbigpe3JldHVybiB0aGlzLmNvbnRhaW5zUG9pbnQ7fVxuR2VvbWV0cnlDb250YWluc1BvaW50VmlzaXRvci5wcm90b3R5cGUudmlzaXQ9ZnVuY3Rpb24oZ2VvbSl7aWYoIShnZW9tIGluc3RhbmNlb2YganN0cy5nZW9tLlBvbHlnb24pKVxucmV0dXJuO3ZhciBlbGVtZW50RW52PWdlb20uZ2V0RW52ZWxvcGVJbnRlcm5hbCgpO2lmKCF0aGlzLnJlY3RFbnYuaW50ZXJzZWN0cyhlbGVtZW50RW52KSlcbnJldHVybjt2YXIgcmVjdFB0PW5ldyBqc3RzLmdlb20uQ29vcmRpbmF0ZSgpO2Zvcih2YXIgaT0wO2k8NDtpKyspe3RoaXMucmVjdFNlcS5nZXRDb29yZGluYXRlKGkscmVjdFB0KTtpZighZWxlbWVudEVudi5jb250YWlucyhyZWN0UHQpKVxuY29udGludWU7aWYoU2ltcGxlUG9pbnRJbkFyZWFMb2NhdG9yLmNvbnRhaW5zUG9pbnRJblBvbHlnb24ocmVjdFB0LGdlb20pKXt0aGlzLmNvbnRhaW5zUG9pbnQ9dHJ1ZTtyZXR1cm47fX19XG5HZW9tZXRyeUNvbnRhaW5zUG9pbnRWaXNpdG9yLnByb3RvdHlwZS5pc0RvbmU9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5jb250YWluc1BvaW50PT10cnVlO31cbnZhciBSZWN0YW5nbGVJbnRlcnNlY3RzU2VnbWVudFZpc2l0b3I9ZnVuY3Rpb24ocmVjdGFuZ2xlKXt0aGlzLnJlY3RFbnY9cmVjdGFuZ2xlLmdldEVudmVsb3BlSW50ZXJuYWwoKTt0aGlzLnJlY3RJbnRlcnNlY3Rvcj1uZXcgUmVjdGFuZ2xlTGluZUludGVyc2VjdG9yKHJlY3RFbnYpO307UmVjdGFuZ2xlSW50ZXJzZWN0c1NlZ21lbnRWaXNpdG9yLnByb3RvdHlwZT1uZXcganN0cy5nZW9tLnV0aWwuU2hvcnRDaXJjdWl0ZWRHZW9tZXRyeVZpc2l0b3IoKTtSZWN0YW5nbGVJbnRlcnNlY3RzU2VnbWVudFZpc2l0b3IuY29uc3RydWN0b3I9UmVjdGFuZ2xlSW50ZXJzZWN0c1NlZ21lbnRWaXNpdG9yO1JlY3RhbmdsZUludGVyc2VjdHNTZWdtZW50VmlzaXRvci5wcm90b3R5cGUucmVjdEVudj1udWxsO1JlY3RhbmdsZUludGVyc2VjdHNTZWdtZW50VmlzaXRvci5wcm90b3R5cGUucmVjdEludGVyc2VjdG9yPW51bGw7UmVjdGFuZ2xlSW50ZXJzZWN0c1NlZ21lbnRWaXNpdG9yLnByb3RvdHlwZS5oYXNJbnRlcnNlY3Rpb249ZmFsc2U7UmVjdGFuZ2xlSW50ZXJzZWN0c1NlZ21lbnRWaXNpdG9yLnByb3RvdHlwZS5wMD1udWxsO1JlY3RhbmdsZUludGVyc2VjdHNTZWdtZW50VmlzaXRvci5wcm90b3R5cGUucDE9bnVsbDtSZWN0YW5nbGVJbnRlcnNlY3RzU2VnbWVudFZpc2l0b3IucHJvdG90eXBlLmludGVyc2VjdHM9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5oYXNJbnRlcnNlY3Rpb247fVxuUmVjdGFuZ2xlSW50ZXJzZWN0c1NlZ21lbnRWaXNpdG9yLnByb3RvdHlwZS52aXNpdD1mdW5jdGlvbihnZW9tKXt2YXIgZWxlbWVudEVudj1nZW9tLmdldEVudmVsb3BlSW50ZXJuYWwoKTtpZighdGhpcy5yZWN0RW52LmludGVyc2VjdHMoZWxlbWVudEVudikpXG5yZXR1cm47dmFyIGxpbmVzPUxpbmVhckNvbXBvbmVudEV4dHJhY3Rlci5nZXRMaW5lcyhnZW9tKTt0aGlzLmNoZWNrSW50ZXJzZWN0aW9uV2l0aExpbmVTdHJpbmdzKGxpbmVzKTt9XG5SZWN0YW5nbGVJbnRlcnNlY3RzU2VnbWVudFZpc2l0b3IucHJvdG90eXBlLmNoZWNrSW50ZXJzZWN0aW9uV2l0aExpbmVTdHJpbmdzPWZ1bmN0aW9uKGxpbmVzKXtmb3IodmFyIGk9bGluZXMuaXRlcmF0b3IoKTtpLmhhc05leHQoKTspe3ZhciB0ZXN0TGluZT1pLm5leHQoKTt0aGlzLmNoZWNrSW50ZXJzZWN0aW9uV2l0aFNlZ21lbnRzKHRlc3RMaW5lKTtpZih0aGlzLmhhc0ludGVyc2VjdGlvbilcbnJldHVybjt9fVxuUmVjdGFuZ2xlSW50ZXJzZWN0c1NlZ21lbnRWaXNpdG9yLnByb3RvdHlwZS5jaGVja0ludGVyc2VjdGlvbldpdGhTZWdtZW50cz1mdW5jdGlvbih0ZXN0TGluZSl7dmFyIHNlcTE9dGVzdExpbmUuZ2V0Q29vcmRpbmF0ZVNlcXVlbmNlKCk7Zm9yKHZhciBqPTE7ajxzZXExLmxlbmd0aDtqKyspe3RoaXMucDA9c2VxMVtqLTFdO3RoaXMucDE9c2VxMVtqXTtpZihyZWN0SW50ZXJzZWN0b3IuaW50ZXJzZWN0cyhwMCxwMSkpe3RoaXMuaGFzSW50ZXJzZWN0aW9uPXRydWU7cmV0dXJuO319fVxuUmVjdGFuZ2xlSW50ZXJzZWN0c1NlZ21lbnRWaXNpdG9yLnByb3RvdHlwZS5pc0RvbmU9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5oYXNJbnRlcnNlY3Rpb249PXRydWU7fVxuanN0cy5vcGVyYXRpb24ucHJlZGljYXRlLlJlY3RhbmdsZUludGVyc2VjdHM9ZnVuY3Rpb24ocmVjdGFuZ2xlKXt0aGlzLnJlY3RhbmdsZT1yZWN0YW5nbGU7dGhpcy5yZWN0RW52PXJlY3RhbmdsZS5nZXRFbnZlbG9wZUludGVybmFsKCk7fVxuanN0cy5vcGVyYXRpb24ucHJlZGljYXRlLlJlY3RhbmdsZUludGVyc2VjdHMuaW50ZXJzZWN0cz1mdW5jdGlvbihyZWN0YW5nbGUsYil7dmFyIHJwPW5ldyBqc3RzLm9wZXJhdGlvbi5wcmVkaWNhdGUuUmVjdGFuZ2xlSW50ZXJzZWN0cyhyZWN0YW5nbGUpO3JldHVybiBycC5pbnRlcnNlY3RzKGIpO31cbmpzdHMub3BlcmF0aW9uLnByZWRpY2F0ZS5SZWN0YW5nbGVJbnRlcnNlY3RzLnByb3RvdHlwZS5yZWN0YW5nbGU9bnVsbDtqc3RzLm9wZXJhdGlvbi5wcmVkaWNhdGUuUmVjdGFuZ2xlSW50ZXJzZWN0cy5wcm90b3R5cGUucmVjdEVudj1udWxsO2pzdHMub3BlcmF0aW9uLnByZWRpY2F0ZS5SZWN0YW5nbGVJbnRlcnNlY3RzLnByb3RvdHlwZS5pbnRlcnNlY3RzPWZ1bmN0aW9uKGdlb20pe2lmKCF0aGlzLnJlY3RFbnYuaW50ZXJzZWN0cyhnZW9tLmdldEVudmVsb3BlSW50ZXJuYWwoKSkpXG5yZXR1cm4gZmFsc2U7dmFyIHZpc2l0b3I9bmV3IEVudmVsb3BlSW50ZXJzZWN0c1Zpc2l0b3IodGhpcy5yZWN0RW52KTt2aXNpdG9yLmFwcGx5VG8oZ2VvbSk7aWYodmlzaXRvci5pbnRlcnNlY3RzKCkpXG5yZXR1cm4gdHJ1ZTt2YXIgZWNwVmlzaXRvcj1uZXcgR2VvbWV0cnlDb250YWluc1BvaW50VmlzaXRvcihyZWN0YW5nbGUpO2VjcFZpc2l0b3IuYXBwbHlUbyhnZW9tKTtpZihlY3BWaXNpdG9yLmNvbnRhaW5zUG9pbnQoKSlcbnJldHVybiB0cnVlO3ZhciByaVZpc2l0b3I9bmV3IFJlY3RhbmdsZUludGVyc2VjdHNTZWdtZW50VmlzaXRvcihyZWN0YW5nbGUpO3JpVmlzaXRvci5hcHBseVRvKGdlb20pO2lmKHJpVmlzaXRvci5pbnRlcnNlY3RzKCkpXG5yZXR1cm4gdHJ1ZTtyZXR1cm4gZmFsc2U7fX0pKCk7anN0cy5vcGVyYXRpb24uYnVmZmVyLkJ1ZmZlckJ1aWxkZXI9ZnVuY3Rpb24oYnVmUGFyYW1zKXt0aGlzLmJ1ZlBhcmFtcz1idWZQYXJhbXM7dGhpcy5lZGdlTGlzdD1uZXcganN0cy5nZW9tZ3JhcGguRWRnZUxpc3QoKTt9O2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5CdWZmZXJCdWlsZGVyLmRlcHRoRGVsdGE9ZnVuY3Rpb24obGFiZWwpe3ZhciBsTG9jPWxhYmVsLmdldExvY2F0aW9uKDAsanN0cy5nZW9tZ3JhcGguUG9zaXRpb24uTEVGVCk7dmFyIHJMb2M9bGFiZWwuZ2V0TG9jYXRpb24oMCxqc3RzLmdlb21ncmFwaC5Qb3NpdGlvbi5SSUdIVCk7aWYobExvYz09PWpzdHMuZ2VvbS5Mb2NhdGlvbi5JTlRFUklPUiYmckxvYz09PWpzdHMuZ2VvbS5Mb2NhdGlvbi5FWFRFUklPUilcbnJldHVybiAxO2Vsc2UgaWYobExvYz09PWpzdHMuZ2VvbS5Mb2NhdGlvbi5FWFRFUklPUiYmckxvYz09PWpzdHMuZ2VvbS5Mb2NhdGlvbi5JTlRFUklPUilcbnJldHVybi0xO3JldHVybiAwO307anN0cy5vcGVyYXRpb24uYnVmZmVyLkJ1ZmZlckJ1aWxkZXIucHJvdG90eXBlLmJ1ZlBhcmFtcz1udWxsO2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5CdWZmZXJCdWlsZGVyLnByb3RvdHlwZS53b3JraW5nUHJlY2lzaW9uTW9kZWw9bnVsbDtqc3RzLm9wZXJhdGlvbi5idWZmZXIuQnVmZmVyQnVpbGRlci5wcm90b3R5cGUud29ya2luZ05vZGVyPW51bGw7anN0cy5vcGVyYXRpb24uYnVmZmVyLkJ1ZmZlckJ1aWxkZXIucHJvdG90eXBlLmdlb21GYWN0PW51bGw7anN0cy5vcGVyYXRpb24uYnVmZmVyLkJ1ZmZlckJ1aWxkZXIucHJvdG90eXBlLmdyYXBoPW51bGw7anN0cy5vcGVyYXRpb24uYnVmZmVyLkJ1ZmZlckJ1aWxkZXIucHJvdG90eXBlLmVkZ2VMaXN0PW51bGw7anN0cy5vcGVyYXRpb24uYnVmZmVyLkJ1ZmZlckJ1aWxkZXIucHJvdG90eXBlLnNldFdvcmtpbmdQcmVjaXNpb25Nb2RlbD1mdW5jdGlvbihwbSl7dGhpcy53b3JraW5nUHJlY2lzaW9uTW9kZWw9cG07fTtqc3RzLm9wZXJhdGlvbi5idWZmZXIuQnVmZmVyQnVpbGRlci5wcm90b3R5cGUuc2V0Tm9kZXI9ZnVuY3Rpb24obm9kZXIpe3RoaXMud29ya2luZ05vZGVyPW5vZGVyO307anN0cy5vcGVyYXRpb24uYnVmZmVyLkJ1ZmZlckJ1aWxkZXIucHJvdG90eXBlLmJ1ZmZlcj1mdW5jdGlvbihnLGRpc3RhbmNlKXt2YXIgcHJlY2lzaW9uTW9kZWw9dGhpcy53b3JraW5nUHJlY2lzaW9uTW9kZWw7aWYocHJlY2lzaW9uTW9kZWw9PT1udWxsKVxucHJlY2lzaW9uTW9kZWw9Zy5nZXRQcmVjaXNpb25Nb2RlbCgpO3RoaXMuZ2VvbUZhY3Q9Zy5nZXRGYWN0b3J5KCk7dmFyIGN1cnZlQnVpbGRlcj1uZXcganN0cy5vcGVyYXRpb24uYnVmZmVyLk9mZnNldEN1cnZlQnVpbGRlcihwcmVjaXNpb25Nb2RlbCx0aGlzLmJ1ZlBhcmFtcyk7dmFyIGN1cnZlU2V0QnVpbGRlcj1uZXcganN0cy5vcGVyYXRpb24uYnVmZmVyLk9mZnNldEN1cnZlU2V0QnVpbGRlcihnLGRpc3RhbmNlLGN1cnZlQnVpbGRlcik7dmFyIGJ1ZmZlclNlZ1N0ckxpc3Q9Y3VydmVTZXRCdWlsZGVyLmdldEN1cnZlcygpO2lmKGJ1ZmZlclNlZ1N0ckxpc3Quc2l6ZSgpPD0wKXtyZXR1cm4gdGhpcy5jcmVhdGVFbXB0eVJlc3VsdEdlb21ldHJ5KCk7fVxudGhpcy5jb21wdXRlTm9kZWRFZGdlcyhidWZmZXJTZWdTdHJMaXN0LHByZWNpc2lvbk1vZGVsKTt0aGlzLmdyYXBoPW5ldyBqc3RzLmdlb21ncmFwaC5QbGFuYXJHcmFwaChuZXcganN0cy5vcGVyYXRpb24ub3ZlcmxheS5PdmVybGF5Tm9kZUZhY3RvcnkoKSk7dGhpcy5ncmFwaC5hZGRFZGdlcyh0aGlzLmVkZ2VMaXN0LmdldEVkZ2VzKCkpO3ZhciBzdWJncmFwaExpc3Q9dGhpcy5jcmVhdGVTdWJncmFwaHModGhpcy5ncmFwaCk7dmFyIHBvbHlCdWlsZGVyPW5ldyBqc3RzLm9wZXJhdGlvbi5vdmVybGF5LlBvbHlnb25CdWlsZGVyKHRoaXMuZ2VvbUZhY3QpO3RoaXMuYnVpbGRTdWJncmFwaHMoc3ViZ3JhcGhMaXN0LHBvbHlCdWlsZGVyKTt2YXIgcmVzdWx0UG9seUxpc3Q9cG9seUJ1aWxkZXIuZ2V0UG9seWdvbnMoKTtpZihyZXN1bHRQb2x5TGlzdC5zaXplKCk8PTApe3JldHVybiB0aGlzLmNyZWF0ZUVtcHR5UmVzdWx0R2VvbWV0cnkoKTt9XG52YXIgcmVzdWx0R2VvbT10aGlzLmdlb21GYWN0LmJ1aWxkR2VvbWV0cnkocmVzdWx0UG9seUxpc3QpO3JldHVybiByZXN1bHRHZW9tO307anN0cy5vcGVyYXRpb24uYnVmZmVyLkJ1ZmZlckJ1aWxkZXIucHJvdG90eXBlLmdldE5vZGVyPWZ1bmN0aW9uKHByZWNpc2lvbk1vZGVsKXtpZih0aGlzLndvcmtpbmdOb2RlciE9PW51bGwpXG5yZXR1cm4gdGhpcy53b3JraW5nTm9kZXI7dmFyIG5vZGVyPW5ldyBqc3RzLm5vZGluZy5NQ0luZGV4Tm9kZXIoKTt2YXIgbGk9bmV3IGpzdHMuYWxnb3JpdGhtLlJvYnVzdExpbmVJbnRlcnNlY3RvcigpO2xpLnNldFByZWNpc2lvbk1vZGVsKHByZWNpc2lvbk1vZGVsKTtub2Rlci5zZXRTZWdtZW50SW50ZXJzZWN0b3IobmV3IGpzdHMubm9kaW5nLkludGVyc2VjdGlvbkFkZGVyKGxpKSk7cmV0dXJuIG5vZGVyO307anN0cy5vcGVyYXRpb24uYnVmZmVyLkJ1ZmZlckJ1aWxkZXIucHJvdG90eXBlLmNvbXB1dGVOb2RlZEVkZ2VzPWZ1bmN0aW9uKGJ1ZmZlclNlZ1N0ckxpc3QscHJlY2lzaW9uTW9kZWwpe3ZhciBub2Rlcj10aGlzLmdldE5vZGVyKHByZWNpc2lvbk1vZGVsKTtub2Rlci5jb21wdXRlTm9kZXMoYnVmZmVyU2VnU3RyTGlzdCk7dmFyIG5vZGVkU2VnU3RyaW5ncz1ub2Rlci5nZXROb2RlZFN1YnN0cmluZ3MoKTtmb3IodmFyIGk9bm9kZWRTZWdTdHJpbmdzLml0ZXJhdG9yKCk7aS5oYXNOZXh0KCk7KXt2YXIgc2VnU3RyPWkubmV4dCgpO3ZhciBvbGRMYWJlbD1zZWdTdHIuZ2V0RGF0YSgpO3ZhciBlZGdlPW5ldyBqc3RzLmdlb21ncmFwaC5FZGdlKHNlZ1N0ci5nZXRDb29yZGluYXRlcygpLG5ldyBqc3RzLmdlb21ncmFwaC5MYWJlbChvbGRMYWJlbCkpO3RoaXMuaW5zZXJ0VW5pcXVlRWRnZShlZGdlKTt9fTtqc3RzLm9wZXJhdGlvbi5idWZmZXIuQnVmZmVyQnVpbGRlci5wcm90b3R5cGUuaW5zZXJ0VW5pcXVlRWRnZT1mdW5jdGlvbihlKXt2YXIgZXhpc3RpbmdFZGdlPXRoaXMuZWRnZUxpc3QuZmluZEVxdWFsRWRnZShlKTtpZihleGlzdGluZ0VkZ2UhPW51bGwpe3ZhciBleGlzdGluZ0xhYmVsPWV4aXN0aW5nRWRnZS5nZXRMYWJlbCgpO3ZhciBsYWJlbFRvTWVyZ2U9ZS5nZXRMYWJlbCgpO2lmKCFleGlzdGluZ0VkZ2UuaXNQb2ludHdpc2VFcXVhbChlKSl7bGFiZWxUb01lcmdlPW5ldyBqc3RzLmdlb21ncmFwaC5MYWJlbChlLmdldExhYmVsKCkpO2xhYmVsVG9NZXJnZS5mbGlwKCk7fVxuZXhpc3RpbmdMYWJlbC5tZXJnZShsYWJlbFRvTWVyZ2UpO3ZhciBtZXJnZURlbHRhPWpzdHMub3BlcmF0aW9uLmJ1ZmZlci5CdWZmZXJCdWlsZGVyLmRlcHRoRGVsdGEobGFiZWxUb01lcmdlKTt2YXIgZXhpc3RpbmdEZWx0YT1leGlzdGluZ0VkZ2UuZ2V0RGVwdGhEZWx0YSgpO3ZhciBuZXdEZWx0YT1leGlzdGluZ0RlbHRhK21lcmdlRGVsdGE7ZXhpc3RpbmdFZGdlLnNldERlcHRoRGVsdGEobmV3RGVsdGEpO31lbHNle3RoaXMuZWRnZUxpc3QuYWRkKGUpO2Uuc2V0RGVwdGhEZWx0YShqc3RzLm9wZXJhdGlvbi5idWZmZXIuQnVmZmVyQnVpbGRlci5kZXB0aERlbHRhKGUuZ2V0TGFiZWwoKSkpO319O2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5CdWZmZXJCdWlsZGVyLnByb3RvdHlwZS5jcmVhdGVTdWJncmFwaHM9ZnVuY3Rpb24oZ3JhcGgpe3ZhciBzdWJncmFwaExpc3Q9W107Zm9yKHZhciBpPWdyYXBoLmdldE5vZGVzKCkuaXRlcmF0b3IoKTtpLmhhc05leHQoKTspe3ZhciBub2RlPWkubmV4dCgpO2lmKCFub2RlLmlzVmlzaXRlZCgpKXt2YXIgc3ViZ3JhcGg9bmV3IGpzdHMub3BlcmF0aW9uLmJ1ZmZlci5CdWZmZXJTdWJncmFwaCgpO3N1YmdyYXBoLmNyZWF0ZShub2RlKTtzdWJncmFwaExpc3QucHVzaChzdWJncmFwaCk7fX1cbnZhciBjb21wYXJlPWZ1bmN0aW9uKGEsYil7cmV0dXJuIGEuY29tcGFyZVRvKGIpO307c3ViZ3JhcGhMaXN0LnNvcnQoY29tcGFyZSk7c3ViZ3JhcGhMaXN0LnJldmVyc2UoKTtyZXR1cm4gc3ViZ3JhcGhMaXN0O307anN0cy5vcGVyYXRpb24uYnVmZmVyLkJ1ZmZlckJ1aWxkZXIucHJvdG90eXBlLmJ1aWxkU3ViZ3JhcGhzPWZ1bmN0aW9uKHN1YmdyYXBoTGlzdCxwb2x5QnVpbGRlcil7dmFyIHByb2Nlc3NlZEdyYXBocz1bXTtmb3IodmFyIGk9MDtpPHN1YmdyYXBoTGlzdC5sZW5ndGg7aSsrKXt2YXIgc3ViZ3JhcGg9c3ViZ3JhcGhMaXN0W2ldO3ZhciBwPXN1YmdyYXBoLmdldFJpZ2h0bW9zdENvb3JkaW5hdGUoKTt2YXIgbG9jYXRlcj1uZXcganN0cy5vcGVyYXRpb24uYnVmZmVyLlN1YmdyYXBoRGVwdGhMb2NhdGVyKHByb2Nlc3NlZEdyYXBocyk7dmFyIG91dHNpZGVEZXB0aD1sb2NhdGVyLmdldERlcHRoKHApO3N1YmdyYXBoLmNvbXB1dGVEZXB0aChvdXRzaWRlRGVwdGgpO3N1YmdyYXBoLmZpbmRSZXN1bHRFZGdlcygpO3Byb2Nlc3NlZEdyYXBocy5wdXNoKHN1YmdyYXBoKTtwb2x5QnVpbGRlci5hZGQoc3ViZ3JhcGguZ2V0RGlyZWN0ZWRFZGdlcygpLHN1YmdyYXBoLmdldE5vZGVzKCkpO319O2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5CdWZmZXJCdWlsZGVyLmNvbnZlcnRTZWdTdHJpbmdzPWZ1bmN0aW9uKGl0KXt2YXIgZmFjdD1uZXcganN0cy5nZW9tLkdlb21ldHJ5RmFjdG9yeSgpO3ZhciBsaW5lcz1uZXcgamF2YXNjcmlwdC51dGlsLkFycmF5TGlzdCgpO3doaWxlKGl0Lmhhc05leHQoKSl7dmFyIHNzPWl0Lm5leHQoKTt2YXIgbGluZT1mYWN0LmNyZWF0ZUxpbmVTdHJpbmcoc3MuZ2V0Q29vcmRpbmF0ZXMoKSk7bGluZXMuYWRkKGxpbmUpO31cbnJldHVybiBmYWN0LmJ1aWxkR2VvbWV0cnkobGluZXMpO307anN0cy5vcGVyYXRpb24uYnVmZmVyLkJ1ZmZlckJ1aWxkZXIucHJvdG90eXBlLmNyZWF0ZUVtcHR5UmVzdWx0R2VvbWV0cnk9ZnVuY3Rpb24oKXt2YXIgZW1wdHlHZW9tPXRoaXMuZ2VvbUZhY3QuY3JlYXRlUG9seWdvbihudWxsLG51bGwpO3JldHVybiBlbXB0eUdlb207fTtqc3RzLm5vZGluZy5TZWdtZW50UG9pbnRDb21wYXJhdG9yPWZ1bmN0aW9uKCl7fTtqc3RzLm5vZGluZy5TZWdtZW50UG9pbnRDb21wYXJhdG9yLmNvbXBhcmU9ZnVuY3Rpb24ob2N0YW50LHAwLHAxKXtpZihwMC5lcXVhbHMyRChwMSkpXG5yZXR1cm4gMDt2YXIgeFNpZ249anN0cy5ub2RpbmcuU2VnbWVudFBvaW50Q29tcGFyYXRvci5yZWxhdGl2ZVNpZ24ocDAueCxwMS54KTt2YXIgeVNpZ249anN0cy5ub2RpbmcuU2VnbWVudFBvaW50Q29tcGFyYXRvci5yZWxhdGl2ZVNpZ24ocDAueSxwMS55KTtzd2l0Y2gob2N0YW50KXtjYXNlIDA6cmV0dXJuIGpzdHMubm9kaW5nLlNlZ21lbnRQb2ludENvbXBhcmF0b3IuY29tcGFyZVZhbHVlKHhTaWduLHlTaWduKTtjYXNlIDE6cmV0dXJuIGpzdHMubm9kaW5nLlNlZ21lbnRQb2ludENvbXBhcmF0b3IuY29tcGFyZVZhbHVlKHlTaWduLHhTaWduKTtjYXNlIDI6cmV0dXJuIGpzdHMubm9kaW5nLlNlZ21lbnRQb2ludENvbXBhcmF0b3IuY29tcGFyZVZhbHVlKHlTaWduLC14U2lnbik7Y2FzZSAzOnJldHVybiBqc3RzLm5vZGluZy5TZWdtZW50UG9pbnRDb21wYXJhdG9yLmNvbXBhcmVWYWx1ZSgteFNpZ24seVNpZ24pO2Nhc2UgNDpyZXR1cm4ganN0cy5ub2RpbmcuU2VnbWVudFBvaW50Q29tcGFyYXRvci5jb21wYXJlVmFsdWUoLXhTaWduLC15U2lnbik7Y2FzZSA1OnJldHVybiBqc3RzLm5vZGluZy5TZWdtZW50UG9pbnRDb21wYXJhdG9yLmNvbXBhcmVWYWx1ZSgteVNpZ24sLXhTaWduKTtjYXNlIDY6cmV0dXJuIGpzdHMubm9kaW5nLlNlZ21lbnRQb2ludENvbXBhcmF0b3IuY29tcGFyZVZhbHVlKC15U2lnbix4U2lnbik7Y2FzZSA3OnJldHVybiBqc3RzLm5vZGluZy5TZWdtZW50UG9pbnRDb21wYXJhdG9yLmNvbXBhcmVWYWx1ZSh4U2lnbiwteVNpZ24pO31cbnJldHVybiAwO307anN0cy5ub2RpbmcuU2VnbWVudFBvaW50Q29tcGFyYXRvci5yZWxhdGl2ZVNpZ249ZnVuY3Rpb24oeDAseDEpe2lmKHgwPHgxKVxucmV0dXJuLTE7aWYoeDA+eDEpXG5yZXR1cm4gMTtyZXR1cm4gMDt9O2pzdHMubm9kaW5nLlNlZ21lbnRQb2ludENvbXBhcmF0b3IuY29tcGFyZVZhbHVlPWZ1bmN0aW9uKGNvbXBhcmVTaWduMCxjb21wYXJlU2lnbjEpe2lmKGNvbXBhcmVTaWduMDwwKVxucmV0dXJuLTE7aWYoY29tcGFyZVNpZ24wPjApXG5yZXR1cm4gMTtpZihjb21wYXJlU2lnbjE8MClcbnJldHVybi0xO2lmKGNvbXBhcmVTaWduMT4wKVxucmV0dXJuIDE7cmV0dXJuIDA7fTtqc3RzLm9wZXJhdGlvbi5yZWxhdGUuUmVsYXRlT3A9ZnVuY3Rpb24oKXtqc3RzLm9wZXJhdGlvbi5HZW9tZXRyeUdyYXBoT3BlcmF0aW9uLmFwcGx5KHRoaXMsYXJndW1lbnRzKTt0aGlzLl9yZWxhdGU9bmV3IGpzdHMub3BlcmF0aW9uLnJlbGF0ZS5SZWxhdGVDb21wdXRlcih0aGlzLmFyZyk7fTtqc3RzLm9wZXJhdGlvbi5yZWxhdGUuUmVsYXRlT3AucHJvdG90eXBlPW5ldyBqc3RzLm9wZXJhdGlvbi5HZW9tZXRyeUdyYXBoT3BlcmF0aW9uKCk7anN0cy5vcGVyYXRpb24ucmVsYXRlLlJlbGF0ZU9wLnJlbGF0ZT1mdW5jdGlvbihhLGIsYm91bmRhcnlOb2RlUnVsZSl7dmFyIHJlbE9wPW5ldyBqc3RzLm9wZXJhdGlvbi5yZWxhdGUuUmVsYXRlT3AoYSxiLGJvdW5kYXJ5Tm9kZVJ1bGUpO3ZhciBpbT1yZWxPcC5nZXRJbnRlcnNlY3Rpb25NYXRyaXgoKTtyZXR1cm4gaW07fTtqc3RzLm9wZXJhdGlvbi5yZWxhdGUuUmVsYXRlT3AucHJvdG90eXBlLl9yZWxhdGU9bnVsbDtqc3RzLm9wZXJhdGlvbi5yZWxhdGUuUmVsYXRlT3AucHJvdG90eXBlLmdldEludGVyc2VjdGlvbk1hdHJpeD1mdW5jdGlvbigpe3JldHVybiB0aGlzLl9yZWxhdGUuY29tcHV0ZUlNKCk7fTtqc3RzLmluZGV4LmNoYWluLk1vbm90b25lQ2hhaW49ZnVuY3Rpb24ocHRzLHN0YXJ0LGVuZCxjb250ZXh0KXt0aGlzLnB0cz1wdHM7dGhpcy5zdGFydD1zdGFydDt0aGlzLmVuZD1lbmQ7dGhpcy5jb250ZXh0PWNvbnRleHQ7fTtqc3RzLmluZGV4LmNoYWluLk1vbm90b25lQ2hhaW4ucHJvdG90eXBlLnB0cz1udWxsO2pzdHMuaW5kZXguY2hhaW4uTW9ub3RvbmVDaGFpbi5wcm90b3R5cGUuc3RhcnQ9bnVsbDtqc3RzLmluZGV4LmNoYWluLk1vbm90b25lQ2hhaW4ucHJvdG90eXBlLmVuZD1udWxsO2pzdHMuaW5kZXguY2hhaW4uTW9ub3RvbmVDaGFpbi5wcm90b3R5cGUuZW52PW51bGw7anN0cy5pbmRleC5jaGFpbi5Nb25vdG9uZUNoYWluLnByb3RvdHlwZS5jb250ZXh0PW51bGw7anN0cy5pbmRleC5jaGFpbi5Nb25vdG9uZUNoYWluLnByb3RvdHlwZS5pZD1udWxsO2pzdHMuaW5kZXguY2hhaW4uTW9ub3RvbmVDaGFpbi5wcm90b3R5cGUuc2V0SWQ9ZnVuY3Rpb24oaWQpe3RoaXMuaWQ9aWQ7fTtqc3RzLmluZGV4LmNoYWluLk1vbm90b25lQ2hhaW4ucHJvdG90eXBlLmdldElkPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuaWQ7fTtqc3RzLmluZGV4LmNoYWluLk1vbm90b25lQ2hhaW4ucHJvdG90eXBlLmdldENvbnRleHQ9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5jb250ZXh0O307anN0cy5pbmRleC5jaGFpbi5Nb25vdG9uZUNoYWluLnByb3RvdHlwZS5nZXRFbnZlbG9wZT1mdW5jdGlvbigpe2lmKHRoaXMuZW52PT1udWxsKXt2YXIgcDA9dGhpcy5wdHNbdGhpcy5zdGFydF07dmFyIHAxPXRoaXMucHRzW3RoaXMuZW5kXTt0aGlzLmVudj1uZXcganN0cy5nZW9tLkVudmVsb3BlKHAwLHAxKTt9XG5yZXR1cm4gdGhpcy5lbnY7fTtqc3RzLmluZGV4LmNoYWluLk1vbm90b25lQ2hhaW4ucHJvdG90eXBlLmdldFN0YXJ0SW5kZXg9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5zdGFydDt9O2pzdHMuaW5kZXguY2hhaW4uTW9ub3RvbmVDaGFpbi5wcm90b3R5cGUuZ2V0RW5kSW5kZXg9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5lbmQ7fTtqc3RzLmluZGV4LmNoYWluLk1vbm90b25lQ2hhaW4ucHJvdG90eXBlLmdldExpbmVTZWdtZW50PWZ1bmN0aW9uKGluZGV4LGxzKXtscy5wMD10aGlzLnB0c1tpbmRleF07bHMucDE9dGhpcy5wdHNbaW5kZXgrMV07fTtqc3RzLmluZGV4LmNoYWluLk1vbm90b25lQ2hhaW4ucHJvdG90eXBlLmdldENvb3JkaW5hdGVzPWZ1bmN0aW9uKCl7dmFyIGNvb3JkPVtdO3ZhciBpbmRleD0wO2Zvcih2YXIgaT10aGlzLnN0YXJ0O2k8PXRoaXMuZW5kO2krKyl7Y29vcmRbaW5kZXgrK109dGhpcy5wdHNbaV07fVxucmV0dXJuIGNvb3JkO307anN0cy5pbmRleC5jaGFpbi5Nb25vdG9uZUNoYWluLnByb3RvdHlwZS5zZWxlY3Q9ZnVuY3Rpb24oc2VhcmNoRW52LG1jcyl7dGhpcy5jb21wdXRlU2VsZWN0MihzZWFyY2hFbnYsdGhpcy5zdGFydCx0aGlzLmVuZCxtY3MpO307anN0cy5pbmRleC5jaGFpbi5Nb25vdG9uZUNoYWluLnByb3RvdHlwZS5jb21wdXRlU2VsZWN0Mj1mdW5jdGlvbihzZWFyY2hFbnYsc3RhcnQwLGVuZDAsbWNzKXt2YXIgcDA9dGhpcy5wdHNbc3RhcnQwXTt2YXIgcDE9dGhpcy5wdHNbZW5kMF07bWNzLnRlbXBFbnYxLmluaXQocDAscDEpO2lmKGVuZDAtc3RhcnQwPT09MSl7bWNzLnNlbGVjdCh0aGlzLHN0YXJ0MCk7cmV0dXJuO31cbmlmKCFzZWFyY2hFbnYuaW50ZXJzZWN0cyhtY3MudGVtcEVudjEpKVxucmV0dXJuO3ZhciBtaWQ9cGFyc2VJbnQoKHN0YXJ0MCtlbmQwKS8yKTtpZihzdGFydDA8bWlkKXt0aGlzLmNvbXB1dGVTZWxlY3QyKHNlYXJjaEVudixzdGFydDAsbWlkLG1jcyk7fVxuaWYobWlkPGVuZDApe3RoaXMuY29tcHV0ZVNlbGVjdDIoc2VhcmNoRW52LG1pZCxlbmQwLG1jcyk7fX07anN0cy5pbmRleC5jaGFpbi5Nb25vdG9uZUNoYWluLnByb3RvdHlwZS5jb21wdXRlT3ZlcmxhcHM9ZnVuY3Rpb24obWMsbWNvKXtpZihhcmd1bWVudHMubGVuZ3RoPT09Nil7cmV0dXJuIHRoaXMuY29tcHV0ZU92ZXJsYXBzMi5hcHBseSh0aGlzLGFyZ3VtZW50cyk7fVxudGhpcy5jb21wdXRlT3ZlcmxhcHMyKHRoaXMuc3RhcnQsdGhpcy5lbmQsbWMsbWMuc3RhcnQsbWMuZW5kLG1jbyk7fTtqc3RzLmluZGV4LmNoYWluLk1vbm90b25lQ2hhaW4ucHJvdG90eXBlLmNvbXB1dGVPdmVybGFwczI9ZnVuY3Rpb24oc3RhcnQwLGVuZDAsbWMsc3RhcnQxLGVuZDEsbWNvKXt2YXIgcDAwPXRoaXMucHRzW3N0YXJ0MF07dmFyIHAwMT10aGlzLnB0c1tlbmQwXTt2YXIgcDEwPW1jLnB0c1tzdGFydDFdO3ZhciBwMTE9bWMucHRzW2VuZDFdO2lmKGVuZDAtc3RhcnQwPT09MSYmZW5kMS1zdGFydDE9PT0xKXttY28ub3ZlcmxhcCh0aGlzLHN0YXJ0MCxtYyxzdGFydDEpO3JldHVybjt9XG5tY28udGVtcEVudjEuaW5pdChwMDAscDAxKTttY28udGVtcEVudjIuaW5pdChwMTAscDExKTtpZighbWNvLnRlbXBFbnYxLmludGVyc2VjdHMobWNvLnRlbXBFbnYyKSlcbnJldHVybjt2YXIgbWlkMD1wYXJzZUludCgoc3RhcnQwK2VuZDApLzIpO3ZhciBtaWQxPXBhcnNlSW50KChzdGFydDErZW5kMSkvMik7aWYoc3RhcnQwPG1pZDApe2lmKHN0YXJ0MTxtaWQxKVxudGhpcy5jb21wdXRlT3ZlcmxhcHMyKHN0YXJ0MCxtaWQwLG1jLHN0YXJ0MSxtaWQxLG1jbyk7aWYobWlkMTxlbmQxKVxudGhpcy5jb21wdXRlT3ZlcmxhcHMyKHN0YXJ0MCxtaWQwLG1jLG1pZDEsZW5kMSxtY28pO31cbmlmKG1pZDA8ZW5kMCl7aWYoc3RhcnQxPG1pZDEpXG50aGlzLmNvbXB1dGVPdmVybGFwczIobWlkMCxlbmQwLG1jLHN0YXJ0MSxtaWQxLG1jbyk7aWYobWlkMTxlbmQxKVxudGhpcy5jb21wdXRlT3ZlcmxhcHMyKG1pZDAsZW5kMCxtYyxtaWQxLGVuZDEsbWNvKTt9fTsoZnVuY3Rpb24oKXt2YXIgTG9jYXRpb249anN0cy5nZW9tLkxvY2F0aW9uO3ZhciBEaW1lbnNpb249anN0cy5nZW9tLkRpbWVuc2lvbjtqc3RzLmdlb20uSW50ZXJzZWN0aW9uTWF0cml4PWZ1bmN0aW9uKGVsZW1lbnRzKXt2YXIgb3RoZXI9ZWxlbWVudHM7aWYoZWxlbWVudHM9PT11bmRlZmluZWR8fGVsZW1lbnRzPT09bnVsbCl7dGhpcy5tYXRyaXg9W1tdLFtdLFtdXTt0aGlzLnNldEFsbChEaW1lbnNpb24uRkFMU0UpO31lbHNlIGlmKHR5cGVvZiBlbGVtZW50cz09PSdzdHJpbmcnKXt0aGlzLnNldChlbGVtZW50cyk7fWVsc2UgaWYob3RoZXIgaW5zdGFuY2VvZiBqc3RzLmdlb20uSW50ZXJzZWN0aW9uTWF0cml4KXt0aGlzLm1hdHJpeFtMb2NhdGlvbi5JTlRFUklPUl1bTG9jYXRpb24uSU5URVJJT1JdPW90aGVyLm1hdHJpeFtMb2NhdGlvbi5JTlRFUklPUl1bTG9jYXRpb24uSU5URVJJT1JdO3RoaXMubWF0cml4W0xvY2F0aW9uLklOVEVSSU9SXVtMb2NhdGlvbi5CT1VOREFSWV09b3RoZXIubWF0cml4W0xvY2F0aW9uLklOVEVSSU9SXVtMb2NhdGlvbi5CT1VOREFSWV07dGhpcy5tYXRyaXhbTG9jYXRpb24uSU5URVJJT1JdW0xvY2F0aW9uLkVYVEVSSU9SXT1vdGhlci5tYXRyaXhbTG9jYXRpb24uSU5URVJJT1JdW0xvY2F0aW9uLkVYVEVSSU9SXTt0aGlzLm1hdHJpeFtMb2NhdGlvbi5CT1VOREFSWV1bTG9jYXRpb24uSU5URVJJT1JdPW90aGVyLm1hdHJpeFtMb2NhdGlvbi5CT1VOREFSWV1bTG9jYXRpb24uSU5URVJJT1JdO3RoaXMubWF0cml4W0xvY2F0aW9uLkJPVU5EQVJZXVtMb2NhdGlvbi5CT1VOREFSWV09b3RoZXIubWF0cml4W0xvY2F0aW9uLkJPVU5EQVJZXVtMb2NhdGlvbi5CT1VOREFSWV07dGhpcy5tYXRyaXhbTG9jYXRpb24uQk9VTkRBUlldW0xvY2F0aW9uLkVYVEVSSU9SXT1vdGhlci5tYXRyaXhbTG9jYXRpb24uQk9VTkRBUlldW0xvY2F0aW9uLkVYVEVSSU9SXTt0aGlzLm1hdHJpeFtMb2NhdGlvbi5FWFRFUklPUl1bTG9jYXRpb24uSU5URVJJT1JdPW90aGVyLm1hdHJpeFtMb2NhdGlvbi5FWFRFUklPUl1bTG9jYXRpb24uSU5URVJJT1JdO3RoaXMubWF0cml4W0xvY2F0aW9uLkVYVEVSSU9SXVtMb2NhdGlvbi5CT1VOREFSWV09b3RoZXIubWF0cml4W0xvY2F0aW9uLkVYVEVSSU9SXVtMb2NhdGlvbi5CT1VOREFSWV07dGhpcy5tYXRyaXhbTG9jYXRpb24uRVhURVJJT1JdW0xvY2F0aW9uLkVYVEVSSU9SXT1vdGhlci5tYXRyaXhbTG9jYXRpb24uRVhURVJJT1JdW0xvY2F0aW9uLkVYVEVSSU9SXTt9fTtqc3RzLmdlb20uSW50ZXJzZWN0aW9uTWF0cml4LnByb3RvdHlwZS5tYXRyaXg9bnVsbDtqc3RzLmdlb20uSW50ZXJzZWN0aW9uTWF0cml4LnByb3RvdHlwZS5hZGQ9ZnVuY3Rpb24oaW0pe3ZhciBpLGo7Zm9yKGk9MDtpPDM7aSsrKXtmb3Ioaj0wO2o8MztqKyspe3RoaXMuc2V0QXRMZWFzdChpLGosaW0uZ2V0KGksaikpO319fTtqc3RzLmdlb20uSW50ZXJzZWN0aW9uTWF0cml4Lm1hdGNoZXM9ZnVuY3Rpb24oYWN0dWFsRGltZW5zaW9uVmFsdWUscmVxdWlyZWREaW1lbnNpb25TeW1ib2wpe2lmKHR5cGVvZiBhY3R1YWxEaW1lbnNpb25WYWx1ZT09PSdzdHJpbmcnKXtyZXR1cm4ganN0cy5nZW9tLkludGVyc2VjdGlvbk1hdHJpeC5tYXRjaGVzMi5jYWxsKHRoaXMsYXJndW1lbnRzKTt9XG5pZihyZXF1aXJlZERpbWVuc2lvblN5bWJvbD09PScqJyl7cmV0dXJuIHRydWU7fVxuaWYocmVxdWlyZWREaW1lbnNpb25TeW1ib2w9PT0nVCcmJihhY3R1YWxEaW1lbnNpb25WYWx1ZT49MHx8YWN0dWFsRGltZW5zaW9uVmFsdWU9PT1EaW1lbnNpb24uVFJVRSkpe3JldHVybiB0cnVlO31cbmlmKHJlcXVpcmVkRGltZW5zaW9uU3ltYm9sPT09J0YnJiZhY3R1YWxEaW1lbnNpb25WYWx1ZT09PURpbWVuc2lvbi5GQUxTRSl7cmV0dXJuIHRydWU7fVxuaWYocmVxdWlyZWREaW1lbnNpb25TeW1ib2w9PT0nMCcmJmFjdHVhbERpbWVuc2lvblZhbHVlPT09RGltZW5zaW9uLlApe3JldHVybiB0cnVlO31cbmlmKHJlcXVpcmVkRGltZW5zaW9uU3ltYm9sPT09JzEnJiZhY3R1YWxEaW1lbnNpb25WYWx1ZT09PURpbWVuc2lvbi5MKXtyZXR1cm4gdHJ1ZTt9XG5pZihyZXF1aXJlZERpbWVuc2lvblN5bWJvbD09PScyJyYmYWN0dWFsRGltZW5zaW9uVmFsdWU9PT1EaW1lbnNpb24uQSl7cmV0dXJuIHRydWU7fVxucmV0dXJuIGZhbHNlO307anN0cy5nZW9tLkludGVyc2VjdGlvbk1hdHJpeC5tYXRjaGVzMj1mdW5jdGlvbihhY3R1YWxEaW1lbnNpb25TeW1ib2xzLHJlcXVpcmVkRGltZW5zaW9uU3ltYm9scyl7dmFyIG09bmV3IGpzdHMuZ2VvbS5JbnRlcnNlY3Rpb25NYXRyaXgoYWN0dWFsRGltZW5zaW9uU3ltYm9scyk7cmV0dXJuIG0ubWF0Y2hlcyhyZXF1aXJlZERpbWVuc2lvblN5bWJvbHMpO307anN0cy5nZW9tLkludGVyc2VjdGlvbk1hdHJpeC5wcm90b3R5cGUuc2V0PWZ1bmN0aW9uKHJvdyxjb2x1bW4sZGltZW5zaW9uVmFsdWUpe2lmKHR5cGVvZiByb3c9PT0nc3RyaW5nJyl7dGhpcy5zZXQyKHJvdyk7cmV0dXJuO31cbnRoaXMubWF0cml4W3Jvd11bY29sdW1uXT1kaW1lbnNpb25WYWx1ZTt9O2pzdHMuZ2VvbS5JbnRlcnNlY3Rpb25NYXRyaXgucHJvdG90eXBlLnNldDI9ZnVuY3Rpb24oZGltZW5zaW9uU3ltYm9scyl7Zm9yKHZhciBpPTA7aTxkaW1lbnNpb25TeW1ib2xzLmxlbmd0aCgpO2krKyl7dmFyIHJvdz1pLzM7dmFyIGNvbD1pJTM7dGhpcy5tYXRyaXhbcm93XVtjb2xdPURpbWVuc2lvbi50b0RpbWVuc2lvblZhbHVlKGRpbWVuc2lvblN5bWJvbHMuY2hhckF0KGkpKTt9fTtqc3RzLmdlb20uSW50ZXJzZWN0aW9uTWF0cml4LnByb3RvdHlwZS5zZXRBdExlYXN0PWZ1bmN0aW9uKHJvdyxjb2x1bW4sbWluaW11bURpbWVuc2lvblZhbHVlKXtpZihhcmd1bWVudHMubGVuZ3RoPT09MSl7dGhpcy5zZXRBdExlYXN0Mihhcmd1bWVudHNbMF0pO3JldHVybjt9XG5pZih0aGlzLm1hdHJpeFtyb3ddW2NvbHVtbl08bWluaW11bURpbWVuc2lvblZhbHVlKXt0aGlzLm1hdHJpeFtyb3ddW2NvbHVtbl09bWluaW11bURpbWVuc2lvblZhbHVlO319O2pzdHMuZ2VvbS5JbnRlcnNlY3Rpb25NYXRyaXgucHJvdG90eXBlLnNldEF0TGVhc3RJZlZhbGlkPWZ1bmN0aW9uKHJvdyxjb2x1bW4sbWluaW11bURpbWVuc2lvblZhbHVlKXtpZihyb3c+PTAmJmNvbHVtbj49MCl7dGhpcy5zZXRBdExlYXN0KHJvdyxjb2x1bW4sbWluaW11bURpbWVuc2lvblZhbHVlKTt9fTtqc3RzLmdlb20uSW50ZXJzZWN0aW9uTWF0cml4LnByb3RvdHlwZS5zZXRBdExlYXN0Mj1mdW5jdGlvbihtaW5pbXVtRGltZW5zaW9uU3ltYm9scyl7dmFyIGk7Zm9yKGk9MDtpPG1pbmltdW1EaW1lbnNpb25TeW1ib2xzLmxlbmd0aDtpKyspe3ZhciByb3c9cGFyc2VJbnQoaS8zKTt2YXIgY29sPXBhcnNlSW50KGklMyk7dGhpcy5zZXRBdExlYXN0KHJvdyxjb2wsanN0cy5nZW9tLkRpbWVuc2lvbi50b0RpbWVuc2lvblZhbHVlKG1pbmltdW1EaW1lbnNpb25TeW1ib2xzLmNoYXJBdChpKSkpO319O2pzdHMuZ2VvbS5JbnRlcnNlY3Rpb25NYXRyaXgucHJvdG90eXBlLnNldEFsbD1mdW5jdGlvbihkaW1lbnNpb25WYWx1ZSl7dmFyIGFpLGJpO2ZvcihhaT0wO2FpPDM7YWkrKyl7Zm9yKGJpPTA7Ymk8MztiaSsrKXt0aGlzLm1hdHJpeFthaV1bYmldPWRpbWVuc2lvblZhbHVlO319fTtqc3RzLmdlb20uSW50ZXJzZWN0aW9uTWF0cml4LnByb3RvdHlwZS5nZXQ9ZnVuY3Rpb24ocm93LGNvbHVtbil7cmV0dXJuIHRoaXMubWF0cml4W3Jvd11bY29sdW1uXTt9O2pzdHMuZ2VvbS5JbnRlcnNlY3Rpb25NYXRyaXgucHJvdG90eXBlLmlzRGlzam9pbnQ9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5tYXRyaXhbTG9jYXRpb24uSU5URVJJT1JdW0xvY2F0aW9uLklOVEVSSU9SXT09PURpbWVuc2lvbi5GQUxTRSYmdGhpcy5tYXRyaXhbTG9jYXRpb24uSU5URVJJT1JdW0xvY2F0aW9uLkJPVU5EQVJZXT09PURpbWVuc2lvbi5GQUxTRSYmdGhpcy5tYXRyaXhbTG9jYXRpb24uQk9VTkRBUlldW0xvY2F0aW9uLklOVEVSSU9SXT09PURpbWVuc2lvbi5GQUxTRSYmdGhpcy5tYXRyaXhbTG9jYXRpb24uQk9VTkRBUlldW0xvY2F0aW9uLkJPVU5EQVJZXT09PURpbWVuc2lvbi5GQUxTRTt9O2pzdHMuZ2VvbS5JbnRlcnNlY3Rpb25NYXRyaXgucHJvdG90eXBlLmlzSW50ZXJzZWN0cz1mdW5jdGlvbigpe3JldHVybiF0aGlzLmlzRGlzam9pbnQoKTt9O2pzdHMuZ2VvbS5JbnRlcnNlY3Rpb25NYXRyaXgucHJvdG90eXBlLmlzVG91Y2hlcz1mdW5jdGlvbihkaW1lbnNpb25PZkdlb21ldHJ5QSxkaW1lbnNpb25PZkdlb21ldHJ5Qil7aWYoZGltZW5zaW9uT2ZHZW9tZXRyeUE+ZGltZW5zaW9uT2ZHZW9tZXRyeUIpe3JldHVybiB0aGlzLmlzVG91Y2hlcyhkaW1lbnNpb25PZkdlb21ldHJ5QixkaW1lbnNpb25PZkdlb21ldHJ5QSk7fVxuaWYoKGRpbWVuc2lvbk9mR2VvbWV0cnlBPT1EaW1lbnNpb24uQSYmZGltZW5zaW9uT2ZHZW9tZXRyeUI9PURpbWVuc2lvbi5BKXx8KGRpbWVuc2lvbk9mR2VvbWV0cnlBPT1EaW1lbnNpb24uTCYmZGltZW5zaW9uT2ZHZW9tZXRyeUI9PURpbWVuc2lvbi5MKXx8KGRpbWVuc2lvbk9mR2VvbWV0cnlBPT1EaW1lbnNpb24uTCYmZGltZW5zaW9uT2ZHZW9tZXRyeUI9PURpbWVuc2lvbi5BKXx8KGRpbWVuc2lvbk9mR2VvbWV0cnlBPT1EaW1lbnNpb24uUCYmZGltZW5zaW9uT2ZHZW9tZXRyeUI9PURpbWVuc2lvbi5BKXx8KGRpbWVuc2lvbk9mR2VvbWV0cnlBPT1EaW1lbnNpb24uUCYmZGltZW5zaW9uT2ZHZW9tZXRyeUI9PURpbWVuc2lvbi5MKSl7cmV0dXJuIHRoaXMubWF0cml4W0xvY2F0aW9uLklOVEVSSU9SXVtMb2NhdGlvbi5JTlRFUklPUl09PT1EaW1lbnNpb24uRkFMU0UmJihqc3RzLmdlb20uSW50ZXJzZWN0aW9uTWF0cml4Lm1hdGNoZXModGhpcy5tYXRyaXhbTG9jYXRpb24uSU5URVJJT1JdW0xvY2F0aW9uLkJPVU5EQVJZXSwnVCcpfHxqc3RzLmdlb20uSW50ZXJzZWN0aW9uTWF0cml4Lm1hdGNoZXModGhpcy5tYXRyaXhbTG9jYXRpb24uQk9VTkRBUlldW0xvY2F0aW9uLklOVEVSSU9SXSwnVCcpfHxqc3RzLmdlb20uSW50ZXJzZWN0aW9uTWF0cml4Lm1hdGNoZXModGhpcy5tYXRyaXhbTG9jYXRpb24uQk9VTkRBUlldW0xvY2F0aW9uLkJPVU5EQVJZXSwnVCcpKTt9XG5yZXR1cm4gZmFsc2U7fTtqc3RzLmdlb20uSW50ZXJzZWN0aW9uTWF0cml4LnByb3RvdHlwZS5pc0Nyb3NzZXM9ZnVuY3Rpb24oZGltZW5zaW9uT2ZHZW9tZXRyeUEsZGltZW5zaW9uT2ZHZW9tZXRyeUIpe2lmKChkaW1lbnNpb25PZkdlb21ldHJ5QT09RGltZW5zaW9uLlAmJmRpbWVuc2lvbk9mR2VvbWV0cnlCPT1EaW1lbnNpb24uTCl8fChkaW1lbnNpb25PZkdlb21ldHJ5QT09RGltZW5zaW9uLlAmJmRpbWVuc2lvbk9mR2VvbWV0cnlCPT1EaW1lbnNpb24uQSl8fChkaW1lbnNpb25PZkdlb21ldHJ5QT09RGltZW5zaW9uLkwmJmRpbWVuc2lvbk9mR2VvbWV0cnlCPT1EaW1lbnNpb24uQSkpe3JldHVybiBqc3RzLmdlb20uSW50ZXJzZWN0aW9uTWF0cml4Lm1hdGNoZXModGhpcy5tYXRyaXhbTG9jYXRpb24uSU5URVJJT1JdW0xvY2F0aW9uLklOVEVSSU9SXSwnVCcpJiZqc3RzLmdlb20uSW50ZXJzZWN0aW9uTWF0cml4Lm1hdGNoZXModGhpcy5tYXRyaXhbTG9jYXRpb24uSU5URVJJT1JdW0xvY2F0aW9uLkVYVEVSSU9SXSwnVCcpO31cbmlmKChkaW1lbnNpb25PZkdlb21ldHJ5QT09RGltZW5zaW9uLkwmJmRpbWVuc2lvbk9mR2VvbWV0cnlCPT1EaW1lbnNpb24uUCl8fChkaW1lbnNpb25PZkdlb21ldHJ5QT09RGltZW5zaW9uLkEmJmRpbWVuc2lvbk9mR2VvbWV0cnlCPT1EaW1lbnNpb24uUCl8fChkaW1lbnNpb25PZkdlb21ldHJ5QT09RGltZW5zaW9uLkEmJmRpbWVuc2lvbk9mR2VvbWV0cnlCPT1EaW1lbnNpb24uTCkpe3JldHVybiBqc3RzLmdlb20uSW50ZXJzZWN0aW9uTWF0cml4Lm1hdGNoZXMobWF0cml4W0xvY2F0aW9uLklOVEVSSU9SXVtMb2NhdGlvbi5JTlRFUklPUl0sJ1QnKSYmanN0cy5nZW9tLkludGVyc2VjdGlvbk1hdHJpeC5tYXRjaGVzKHRoaXMubWF0cml4W0xvY2F0aW9uLkVYVEVSSU9SXVtMb2NhdGlvbi5JTlRFUklPUl0sJ1QnKTt9XG5pZihkaW1lbnNpb25PZkdlb21ldHJ5QT09PURpbWVuc2lvbi5MJiZkaW1lbnNpb25PZkdlb21ldHJ5Qj09PURpbWVuc2lvbi5MKXtyZXR1cm4gdGhpcy5tYXRyaXhbTG9jYXRpb24uSU5URVJJT1JdW0xvY2F0aW9uLklOVEVSSU9SXT09PTA7fVxucmV0dXJuIGZhbHNlO307anN0cy5nZW9tLkludGVyc2VjdGlvbk1hdHJpeC5wcm90b3R5cGUuaXNXaXRoaW49ZnVuY3Rpb24oKXtyZXR1cm4ganN0cy5nZW9tLkludGVyc2VjdGlvbk1hdHJpeC5tYXRjaGVzKHRoaXMubWF0cml4W0xvY2F0aW9uLklOVEVSSU9SXVtMb2NhdGlvbi5JTlRFUklPUl0sJ1QnKSYmdGhpcy5tYXRyaXhbTG9jYXRpb24uSU5URVJJT1JdW0xvY2F0aW9uLkVYVEVSSU9SXT09RGltZW5zaW9uLkZBTFNFJiZ0aGlzLm1hdHJpeFtMb2NhdGlvbi5CT1VOREFSWV1bTG9jYXRpb24uRVhURVJJT1JdPT1EaW1lbnNpb24uRkFMU0U7fTtqc3RzLmdlb20uSW50ZXJzZWN0aW9uTWF0cml4LnByb3RvdHlwZS5pc0NvbnRhaW5zPWZ1bmN0aW9uKCl7cmV0dXJuIGpzdHMuZ2VvbS5JbnRlcnNlY3Rpb25NYXRyaXgubWF0Y2hlcyh0aGlzLm1hdHJpeFtMb2NhdGlvbi5JTlRFUklPUl1bTG9jYXRpb24uSU5URVJJT1JdLCdUJykmJnRoaXMubWF0cml4W0xvY2F0aW9uLkVYVEVSSU9SXVtMb2NhdGlvbi5JTlRFUklPUl09PURpbWVuc2lvbi5GQUxTRSYmdGhpcy5tYXRyaXhbTG9jYXRpb24uRVhURVJJT1JdW0xvY2F0aW9uLkJPVU5EQVJZXT09RGltZW5zaW9uLkZBTFNFO307anN0cy5nZW9tLkludGVyc2VjdGlvbk1hdHJpeC5wcm90b3R5cGUuaXNDb3ZlcnM9ZnVuY3Rpb24oKXt2YXIgaGFzUG9pbnRJbkNvbW1vbj1qc3RzLmdlb20uSW50ZXJzZWN0aW9uTWF0cml4Lm1hdGNoZXModGhpcy5tYXRyaXhbTG9jYXRpb24uSU5URVJJT1JdW0xvY2F0aW9uLklOVEVSSU9SXSwnVCcpfHxqc3RzLmdlb20uSW50ZXJzZWN0aW9uTWF0cml4Lm1hdGNoZXModGhpcy5tYXRyaXhbTG9jYXRpb24uSU5URVJJT1JdW0xvY2F0aW9uLkJPVU5EQVJZXSwnVCcpfHxqc3RzLmdlb20uSW50ZXJzZWN0aW9uTWF0cml4Lm1hdGNoZXModGhpcy5tYXRyaXhbTG9jYXRpb24uQk9VTkRBUlldW0xvY2F0aW9uLklOVEVSSU9SXSwnVCcpfHxqc3RzLmdlb20uSW50ZXJzZWN0aW9uTWF0cml4Lm1hdGNoZXModGhpcy5tYXRyaXhbTG9jYXRpb24uQk9VTkRBUlldW0xvY2F0aW9uLkJPVU5EQVJZXSwnVCcpO3JldHVybiBoYXNQb2ludEluQ29tbW9uJiZ0aGlzLm1hdHJpeFtMb2NhdGlvbi5FWFRFUklPUl1bTG9jYXRpb24uSU5URVJJT1JdPT1EaW1lbnNpb24uRkFMU0UmJnRoaXMubWF0cml4W0xvY2F0aW9uLkVYVEVSSU9SXVtMb2NhdGlvbi5CT1VOREFSWV09PURpbWVuc2lvbi5GQUxTRTt9O2pzdHMuZ2VvbS5JbnRlcnNlY3Rpb25NYXRyaXgucHJvdG90eXBlLmlzQ292ZXJlZEJ5PWZ1bmN0aW9uKCl7dmFyIGhhc1BvaW50SW5Db21tb249anN0cy5nZW9tLkludGVyc2VjdGlvbk1hdHJpeC5tYXRjaGVzKHRoaXMubWF0cml4W0xvY2F0aW9uLklOVEVSSU9SXVtMb2NhdGlvbi5JTlRFUklPUl0sJ1QnKXx8anN0cy5nZW9tLkludGVyc2VjdGlvbk1hdHJpeC5tYXRjaGVzKHRoaXMubWF0cml4W0xvY2F0aW9uLklOVEVSSU9SXVtMb2NhdGlvbi5CT1VOREFSWV0sJ1QnKXx8anN0cy5nZW9tLkludGVyc2VjdGlvbk1hdHJpeC5tYXRjaGVzKHRoaXMubWF0cml4W0xvY2F0aW9uLkJPVU5EQVJZXVtMb2NhdGlvbi5JTlRFUklPUl0sJ1QnKXx8anN0cy5nZW9tLkludGVyc2VjdGlvbk1hdHJpeC5tYXRjaGVzKHRoaXMubWF0cml4W0xvY2F0aW9uLkJPVU5EQVJZXVtMb2NhdGlvbi5CT1VOREFSWV0sJ1QnKTtyZXR1cm4gaGFzUG9pbnRJbkNvbW1vbiYmdGhpcy5tYXRyaXhbTG9jYXRpb24uSU5URVJJT1JdW0xvY2F0aW9uLkVYVEVSSU9SXT09PURpbWVuc2lvbi5GQUxTRSYmdGhpcy5tYXRyaXhbTG9jYXRpb24uQk9VTkRBUlldW0xvY2F0aW9uLkVYVEVSSU9SXT09PURpbWVuc2lvbi5GQUxTRTt9O2pzdHMuZ2VvbS5JbnRlcnNlY3Rpb25NYXRyaXgucHJvdG90eXBlLmlzRXF1YWxzPWZ1bmN0aW9uKGRpbWVuc2lvbk9mR2VvbWV0cnlBLGRpbWVuc2lvbk9mR2VvbWV0cnlCKXtpZihkaW1lbnNpb25PZkdlb21ldHJ5QSE9PWRpbWVuc2lvbk9mR2VvbWV0cnlCKXtyZXR1cm4gZmFsc2U7fVxucmV0dXJuIGpzdHMuZ2VvbS5JbnRlcnNlY3Rpb25NYXRyaXgubWF0Y2hlcyh0aGlzLm1hdHJpeFtMb2NhdGlvbi5JTlRFUklPUl1bTG9jYXRpb24uSU5URVJJT1JdLCdUJykmJnRoaXMubWF0cml4W0xvY2F0aW9uLkVYVEVSSU9SXVtMb2NhdGlvbi5JTlRFUklPUl09PT1EaW1lbnNpb24uRkFMU0UmJnRoaXMubWF0cml4W0xvY2F0aW9uLklOVEVSSU9SXVtMb2NhdGlvbi5FWFRFUklPUl09PT1EaW1lbnNpb24uRkFMU0UmJnRoaXMubWF0cml4W0xvY2F0aW9uLkVYVEVSSU9SXVtMb2NhdGlvbi5CT1VOREFSWV09PT1EaW1lbnNpb24uRkFMU0UmJnRoaXMubWF0cml4W0xvY2F0aW9uLkJPVU5EQVJZXVtMb2NhdGlvbi5FWFRFUklPUl09PT1EaW1lbnNpb24uRkFMU0U7fTtqc3RzLmdlb20uSW50ZXJzZWN0aW9uTWF0cml4LnByb3RvdHlwZS5pc092ZXJsYXBzPWZ1bmN0aW9uKGRpbWVuc2lvbk9mR2VvbWV0cnlBLGRpbWVuc2lvbk9mR2VvbWV0cnlCKXtpZigoZGltZW5zaW9uT2ZHZW9tZXRyeUE9PURpbWVuc2lvbi5QJiZkaW1lbnNpb25PZkdlb21ldHJ5Qj09PURpbWVuc2lvbi5QKXx8KGRpbWVuc2lvbk9mR2VvbWV0cnlBPT1EaW1lbnNpb24uQSYmZGltZW5zaW9uT2ZHZW9tZXRyeUI9PT1EaW1lbnNpb24uQSkpe3JldHVybiBqc3RzLmdlb20uSW50ZXJzZWN0aW9uTWF0cml4Lm1hdGNoZXModGhpcy5tYXRyaXhbTG9jYXRpb24uSU5URVJJT1JdW0xvY2F0aW9uLklOVEVSSU9SXSwnVCcpJiZqc3RzLmdlb20uSW50ZXJzZWN0aW9uTWF0cml4Lm1hdGNoZXModGhpcy5tYXRyaXhbTG9jYXRpb24uSU5URVJJT1JdW0xvY2F0aW9uLkVYVEVSSU9SXSwnVCcpJiZqc3RzLmdlb20uSW50ZXJzZWN0aW9uTWF0cml4Lm1hdGNoZXModGhpcy5tYXRyaXhbTG9jYXRpb24uRVhURVJJT1JdW0xvY2F0aW9uLklOVEVSSU9SXSwnVCcpO31cbmlmKGRpbWVuc2lvbk9mR2VvbWV0cnlBPT09RGltZW5zaW9uLkwmJmRpbWVuc2lvbk9mR2VvbWV0cnlCPT09RGltZW5zaW9uLkwpe3JldHVybiB0aGlzLm1hdHJpeFtMb2NhdGlvbi5JTlRFUklPUl1bTG9jYXRpb24uSU5URVJJT1JdPT0xJiZqc3RzLmdlb20uSW50ZXJzZWN0aW9uTWF0cml4Lm1hdGNoZXModGhpcy5tYXRyaXhbTG9jYXRpb24uSU5URVJJT1JdW0xvY2F0aW9uLkVYVEVSSU9SXSwnVCcpJiZqc3RzLmdlb20uSW50ZXJzZWN0aW9uTWF0cml4Lm1hdGNoZXModGhpcy5tYXRyaXhbTG9jYXRpb24uRVhURVJJT1JdW0xvY2F0aW9uLklOVEVSSU9SXSwnVCcpO31cbnJldHVybiBmYWxzZTt9O2pzdHMuZ2VvbS5JbnRlcnNlY3Rpb25NYXRyaXgucHJvdG90eXBlLm1hdGNoZXM9ZnVuY3Rpb24ocmVxdWlyZWREaW1lbnNpb25TeW1ib2xzKXtpZihyZXF1aXJlZERpbWVuc2lvblN5bWJvbHMubGVuZ3RoIT05KXt0aHJvdyBuZXcganN0cy5lcnJvci5JbGxlZ2FsQXJndW1lbnRFeGNlcHRpb24oJ1Nob3VsZCBiZSBsZW5ndGggOTogJytcbnJlcXVpcmVkRGltZW5zaW9uU3ltYm9scyk7fVxuZm9yKHZhciBhaT0wO2FpPDM7YWkrKyl7Zm9yKHZhciBiaT0wO2JpPDM7YmkrKyl7aWYoIWpzdHMuZ2VvbS5JbnRlcnNlY3Rpb25NYXRyaXgubWF0Y2hlcyh0aGlzLm1hdHJpeFthaV1bYmldLHJlcXVpcmVkRGltZW5zaW9uU3ltYm9scy5jaGFyQXQoMyphaStiaSkpKXtyZXR1cm4gZmFsc2U7fX19XG5yZXR1cm4gdHJ1ZTt9O2pzdHMuZ2VvbS5JbnRlcnNlY3Rpb25NYXRyaXgucHJvdG90eXBlLnRyYW5zcG9zZT1mdW5jdGlvbigpe3ZhciB0ZW1wPW1hdHJpeFsxXVswXTt0aGlzLm1hdHJpeFsxXVswXT10aGlzLm1hdHJpeFswXVsxXTt0aGlzLm1hdHJpeFswXVsxXT10ZW1wO3RlbXA9dGhpcy5tYXRyaXhbMl1bMF07dGhpcy5tYXRyaXhbMl1bMF09dGhpcy5tYXRyaXhbMF1bMl07dGhpcy5tYXRyaXhbMF1bMl09dGVtcDt0ZW1wPXRoaXMubWF0cml4WzJdWzFdO3RoaXMubWF0cml4WzJdWzFdPXRoaXMubWF0cml4WzFdWzJdO3RoaXMubWF0cml4WzFdWzJdPXRlbXA7cmV0dXJuIHRoaXM7fTtqc3RzLmdlb20uSW50ZXJzZWN0aW9uTWF0cml4LnByb3RvdHlwZS50b1N0cmluZz1mdW5jdGlvbigpe3ZhciBhaSxiaSxidWY9Jyc7Zm9yKGFpPTA7YWk8MzthaSsrKXtmb3IoYmk9MDtiaTwzO2JpKyspe2J1Zis9RGltZW5zaW9uLnRvRGltZW5zaW9uU3ltYm9sKHRoaXMubWF0cml4W2FpXVtiaV0pO319XG5yZXR1cm4gYnVmO307fSkoKTtqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLkxhc3RGb3VuZFF1YWRFZGdlTG9jYXRvcj1mdW5jdGlvbihzdWJkaXYpe3RoaXMuc3ViZGl2PXN1YmRpdjt0aGlzLmxhc3RFZGdlPW51bGw7dGhpcy5pbml0KCk7fTtqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLkxhc3RGb3VuZFF1YWRFZGdlTG9jYXRvci5wcm90b3R5cGUuaW5pdD1mdW5jdGlvbigpe3RoaXMubGFzdEVkZ2U9dGhpcy5maW5kRWRnZSgpO307anN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5MYXN0Rm91bmRRdWFkRWRnZUxvY2F0b3IucHJvdG90eXBlLmZpbmRFZGdlPWZ1bmN0aW9uKCl7dmFyIGVkZ2VzPXRoaXMuc3ViZGl2LmdldEVkZ2VzKCk7cmV0dXJuIGVkZ2VzWzBdO307anN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5MYXN0Rm91bmRRdWFkRWRnZUxvY2F0b3IucHJvdG90eXBlLmxvY2F0ZT1mdW5jdGlvbih2KXtpZighdGhpcy5sYXN0RWRnZS5pc0xpdmUoKSl7dGhpcy5pbml0KCk7fVxudmFyIGU9dGhpcy5zdWJkaXYubG9jYXRlRnJvbUVkZ2Uodix0aGlzLmxhc3RFZGdlKTt0aGlzLmxhc3RFZGdlPWU7cmV0dXJuIGU7fTtqc3RzLm5vZGluZy5TZWdtZW50Tm9kZUxpc3Q9ZnVuY3Rpb24oZWRnZSl7dGhpcy5ub2RlTWFwPW5ldyBqYXZhc2NyaXB0LnV0aWwuVHJlZU1hcCgpO3RoaXMuZWRnZT1lZGdlO307anN0cy5ub2RpbmcuU2VnbWVudE5vZGVMaXN0LnByb3RvdHlwZS5ub2RlTWFwPW51bGw7anN0cy5ub2RpbmcuU2VnbWVudE5vZGVMaXN0LnByb3RvdHlwZS5pdGVyYXRvcj1mdW5jdGlvbigpe3JldHVybiB0aGlzLm5vZGVNYXAudmFsdWVzKCkuaXRlcmF0b3IoKTt9O2pzdHMubm9kaW5nLlNlZ21lbnROb2RlTGlzdC5wcm90b3R5cGUuZWRnZT1udWxsO2pzdHMubm9kaW5nLlNlZ21lbnROb2RlTGlzdC5wcm90b3R5cGUuZ2V0RWRnZT1mdW5jdGlvbigpe3JldHVybiB0aGlzLmVkZ2U7fTtqc3RzLm5vZGluZy5TZWdtZW50Tm9kZUxpc3QucHJvdG90eXBlLmFkZD1mdW5jdGlvbihpbnRQdCxzZWdtZW50SW5kZXgpe3ZhciBlaU5ldz1uZXcganN0cy5ub2RpbmcuU2VnbWVudE5vZGUodGhpcy5lZGdlLGludFB0LHNlZ21lbnRJbmRleCx0aGlzLmVkZ2UuZ2V0U2VnbWVudE9jdGFudChzZWdtZW50SW5kZXgpKTt2YXIgZWk9dGhpcy5ub2RlTWFwLmdldChlaU5ldyk7aWYoZWkhPT1udWxsKXtqc3RzLnV0aWwuQXNzZXJ0LmlzVHJ1ZShlaS5jb29yZC5lcXVhbHMyRChpbnRQdCksJ0ZvdW5kIGVxdWFsIG5vZGVzIHdpdGggZGlmZmVyZW50IGNvb3JkaW5hdGVzJyk7cmV0dXJuIGVpO31cbnRoaXMubm9kZU1hcC5wdXQoZWlOZXcsZWlOZXcpO3JldHVybiBlaU5ldzt9O2pzdHMubm9kaW5nLlNlZ21lbnROb2RlTGlzdC5wcm90b3R5cGUuYWRkRW5kcG9pbnRzPWZ1bmN0aW9uKCl7dmFyIG1heFNlZ0luZGV4PXRoaXMuZWRnZS5zaXplKCktMTt0aGlzLmFkZCh0aGlzLmVkZ2UuZ2V0Q29vcmRpbmF0ZSgwKSwwKTt0aGlzLmFkZCh0aGlzLmVkZ2UuZ2V0Q29vcmRpbmF0ZShtYXhTZWdJbmRleCksbWF4U2VnSW5kZXgpO307anN0cy5ub2RpbmcuU2VnbWVudE5vZGVMaXN0LnByb3RvdHlwZS5hZGRDb2xsYXBzZWROb2Rlcz1mdW5jdGlvbigpe3ZhciBjb2xsYXBzZWRWZXJ0ZXhJbmRleGVzPVtdO3RoaXMuZmluZENvbGxhcHNlc0Zyb21JbnNlcnRlZE5vZGVzKGNvbGxhcHNlZFZlcnRleEluZGV4ZXMpO3RoaXMuZmluZENvbGxhcHNlc0Zyb21FeGlzdGluZ1ZlcnRpY2VzKGNvbGxhcHNlZFZlcnRleEluZGV4ZXMpO2Zvcih2YXIgaT0wO2k8Y29sbGFwc2VkVmVydGV4SW5kZXhlcy5sZW5ndGg7aSsrKXt2YXIgdmVydGV4SW5kZXg9Y29sbGFwc2VkVmVydGV4SW5kZXhlc1tpXTt0aGlzLmFkZCh0aGlzLmVkZ2UuZ2V0Q29vcmRpbmF0ZSh2ZXJ0ZXhJbmRleCksdmVydGV4SW5kZXgpO319O2pzdHMubm9kaW5nLlNlZ21lbnROb2RlTGlzdC5wcm90b3R5cGUuZmluZENvbGxhcHNlc0Zyb21FeGlzdGluZ1ZlcnRpY2VzPWZ1bmN0aW9uKGNvbGxhcHNlZFZlcnRleEluZGV4ZXMpe2Zvcih2YXIgaT0wO2k8dGhpcy5lZGdlLnNpemUoKS0yO2krKyl7dmFyIHAwPXRoaXMuZWRnZS5nZXRDb29yZGluYXRlKGkpO3ZhciBwMT10aGlzLmVkZ2UuZ2V0Q29vcmRpbmF0ZShpKzEpO3ZhciBwMj10aGlzLmVkZ2UuZ2V0Q29vcmRpbmF0ZShpKzIpO2lmKHAwLmVxdWFsczJEKHAyKSl7Y29sbGFwc2VkVmVydGV4SW5kZXhlcy5wdXNoKGkrMSk7fX19O2pzdHMubm9kaW5nLlNlZ21lbnROb2RlTGlzdC5wcm90b3R5cGUuZmluZENvbGxhcHNlc0Zyb21JbnNlcnRlZE5vZGVzPWZ1bmN0aW9uKGNvbGxhcHNlZFZlcnRleEluZGV4ZXMpe3ZhciBjb2xsYXBzZWRWZXJ0ZXhJbmRleD1bbnVsbF07dmFyIGl0PXRoaXMuaXRlcmF0b3IoKTt2YXIgZWlQcmV2PWl0Lm5leHQoKTt3aGlsZShpdC5oYXNOZXh0KCkpe3ZhciBlaT1pdC5uZXh0KCk7dmFyIGlzQ29sbGFwc2VkPXRoaXMuZmluZENvbGxhcHNlSW5kZXgoZWlQcmV2LGVpLGNvbGxhcHNlZFZlcnRleEluZGV4KTtpZihpc0NvbGxhcHNlZClcbmNvbGxhcHNlZFZlcnRleEluZGV4ZXMucHVzaChjb2xsYXBzZWRWZXJ0ZXhJbmRleFswXSk7ZWlQcmV2PWVpO319O2pzdHMubm9kaW5nLlNlZ21lbnROb2RlTGlzdC5wcm90b3R5cGUuZmluZENvbGxhcHNlSW5kZXg9ZnVuY3Rpb24oZWkwLGVpMSxjb2xsYXBzZWRWZXJ0ZXhJbmRleCl7aWYoIWVpMC5jb29yZC5lcXVhbHMyRChlaTEuY29vcmQpKVxucmV0dXJuIGZhbHNlO3ZhciBudW1WZXJ0aWNlc0JldHdlZW49ZWkxLnNlZ21lbnRJbmRleC1laTAuc2VnbWVudEluZGV4O2lmKCFlaTEuaXNJbnRlcmlvcigpKXtudW1WZXJ0aWNlc0JldHdlZW4tLTt9XG5pZihudW1WZXJ0aWNlc0JldHdlZW49PT0xKXtjb2xsYXBzZWRWZXJ0ZXhJbmRleFswXT1laTAuc2VnbWVudEluZGV4KzE7cmV0dXJuIHRydWU7fVxucmV0dXJuIGZhbHNlO307anN0cy5ub2RpbmcuU2VnbWVudE5vZGVMaXN0LnByb3RvdHlwZS5hZGRTcGxpdEVkZ2VzPWZ1bmN0aW9uKGVkZ2VMaXN0KXt0aGlzLmFkZEVuZHBvaW50cygpO3RoaXMuYWRkQ29sbGFwc2VkTm9kZXMoKTt2YXIgaXQ9dGhpcy5pdGVyYXRvcigpO3ZhciBlaVByZXY9aXQubmV4dCgpO3doaWxlKGl0Lmhhc05leHQoKSl7dmFyIGVpPWl0Lm5leHQoKTt2YXIgbmV3RWRnZT10aGlzLmNyZWF0ZVNwbGl0RWRnZShlaVByZXYsZWkpO2VkZ2VMaXN0LmFkZChuZXdFZGdlKTtlaVByZXY9ZWk7fX07anN0cy5ub2RpbmcuU2VnbWVudE5vZGVMaXN0LnByb3RvdHlwZS5jaGVja1NwbGl0RWRnZXNDb3JyZWN0bmVzcz1mdW5jdGlvbihzcGxpdEVkZ2VzKXt2YXIgZWRnZVB0cz1lZGdlLmdldENvb3JkaW5hdGVzKCk7dmFyIHNwbGl0MD1zcGxpdEVkZ2VzWzBdO3ZhciBwdDA9c3BsaXQwLmdldENvb3JkaW5hdGUoMCk7aWYoIXB0MC5lcXVhbHMyRChlZGdlUHRzWzBdKSlcbnRocm93IG5ldyBFcnJvcignYmFkIHNwbGl0IGVkZ2Ugc3RhcnQgcG9pbnQgYXQgJytwdDApO3ZhciBzcGxpdG49c3BsaXRFZGdlc1tzcGxpdEVkZ2VzLmxlbmd0aC0xXTt2YXIgc3BsaXRuUHRzPXNwbGl0bi5nZXRDb29yZGluYXRlcygpO3ZhciBwdG49c3BsaXRuUHRzW3NwbGl0blB0cy5sZW5ndGgtMV07aWYoIXB0bi5lcXVhbHMyRChlZGdlUHRzW2VkZ2VQdHMubGVuZ3RoLTFdKSlcbnRocm93IG5ldyBFcnJvcignYmFkIHNwbGl0IGVkZ2UgZW5kIHBvaW50IGF0ICcrcHRuKTt9O2pzdHMubm9kaW5nLlNlZ21lbnROb2RlTGlzdC5wcm90b3R5cGUuY3JlYXRlU3BsaXRFZGdlPWZ1bmN0aW9uKGVpMCxlaTEpe3ZhciBucHRzPWVpMS5zZWdtZW50SW5kZXgtZWkwLnNlZ21lbnRJbmRleCsyO3ZhciBsYXN0U2VnU3RhcnRQdD10aGlzLmVkZ2UuZ2V0Q29vcmRpbmF0ZShlaTEuc2VnbWVudEluZGV4KTt2YXIgdXNlSW50UHQxPWVpMS5pc0ludGVyaW9yKCl8fCFlaTEuY29vcmQuZXF1YWxzMkQobGFzdFNlZ1N0YXJ0UHQpO2lmKCF1c2VJbnRQdDEpe25wdHMtLTt9XG52YXIgcHRzPVtdO3ZhciBpcHQ9MDtwdHNbaXB0KytdPW5ldyBqc3RzLmdlb20uQ29vcmRpbmF0ZShlaTAuY29vcmQpO2Zvcih2YXIgaT1laTAuc2VnbWVudEluZGV4KzE7aTw9ZWkxLnNlZ21lbnRJbmRleDtpKyspe3B0c1tpcHQrK109dGhpcy5lZGdlLmdldENvb3JkaW5hdGUoaSk7fVxuaWYodXNlSW50UHQxKVxucHRzW2lwdF09ZWkxLmNvb3JkO3JldHVybiBuZXcganN0cy5ub2RpbmcuTm9kZWRTZWdtZW50U3RyaW5nKHB0cyx0aGlzLmVkZ2UuZ2V0RGF0YSgpKTt9O2pzdHMuaW8uV0tUV3JpdGVyPWZ1bmN0aW9uKCl7dGhpcy5wYXJzZXI9bmV3IGpzdHMuaW8uV0tUUGFyc2VyKHRoaXMuZ2VvbWV0cnlGYWN0b3J5KTt9O2pzdHMuaW8uV0tUV3JpdGVyLnByb3RvdHlwZS53cml0ZT1mdW5jdGlvbihnZW9tZXRyeSl7dmFyIHdrdD10aGlzLnBhcnNlci53cml0ZShnZW9tZXRyeSk7cmV0dXJuIHdrdDt9O2pzdHMuaW8uV0tUV3JpdGVyLnRvTGluZVN0cmluZz1mdW5jdGlvbihwMCxwMSl7aWYoYXJndW1lbnRzLmxlbmd0aCE9PTIpe3Rocm93IG5ldyBqc3RzLmVycm9yLk5vdEltcGxlbWVudGVkRXJyb3IoKTt9XG5yZXR1cm4nTElORVNUUklORyAoICcrcDAueCsnICcrcDAueSsnLCAnK3AxLngrJyAnK3AxLnkrJyApJzt9O2pzdHMuaW8uV0tUUmVhZGVyPWZ1bmN0aW9uKGdlb21ldHJ5RmFjdG9yeSl7dGhpcy5nZW9tZXRyeUZhY3Rvcnk9Z2VvbWV0cnlGYWN0b3J5fHxuZXcganN0cy5nZW9tLkdlb21ldHJ5RmFjdG9yeSgpO3RoaXMucHJlY2lzaW9uTW9kZWw9dGhpcy5nZW9tZXRyeUZhY3RvcnkuZ2V0UHJlY2lzaW9uTW9kZWwoKTt0aGlzLnBhcnNlcj1uZXcganN0cy5pby5XS1RQYXJzZXIodGhpcy5nZW9tZXRyeUZhY3RvcnkpO307anN0cy5pby5XS1RSZWFkZXIucHJvdG90eXBlLnJlYWQ9ZnVuY3Rpb24od2t0KXt2YXIgZ2VvbWV0cnk9dGhpcy5wYXJzZXIucmVhZCh3a3QpO2lmKHRoaXMucHJlY2lzaW9uTW9kZWwuZ2V0VHlwZSgpPT09anN0cy5nZW9tLlByZWNpc2lvbk1vZGVsLkZJWEVEKXt0aGlzLnJlZHVjZVByZWNpc2lvbihnZW9tZXRyeSk7fVxucmV0dXJuIGdlb21ldHJ5O307anN0cy5pby5XS1RSZWFkZXIucHJvdG90eXBlLnJlZHVjZVByZWNpc2lvbj1mdW5jdGlvbihnZW9tZXRyeSl7dmFyIGksbGVuO2lmKGdlb21ldHJ5LmNvb3JkaW5hdGUpe3RoaXMucHJlY2lzaW9uTW9kZWwubWFrZVByZWNpc2UoZ2VvbWV0cnkuY29vcmRpbmF0ZSk7fWVsc2UgaWYoZ2VvbWV0cnkucG9pbnRzKXtmb3IoaT0wLGxlbj1nZW9tZXRyeS5wb2ludHMubGVuZ3RoO2k8bGVuO2krKyl7dGhpcy5wcmVjaXNpb25Nb2RlbC5tYWtlUHJlY2lzZShnZW9tZXRyeS5wb2ludHNbaV0pO319ZWxzZSBpZihnZW9tZXRyeS5nZW9tZXRyaWVzKXtmb3IoaT0wLGxlbj1nZW9tZXRyeS5nZW9tZXRyaWVzLmxlbmd0aDtpPGxlbjtpKyspe3RoaXMucmVkdWNlUHJlY2lzaW9uKGdlb21ldHJ5Lmdlb21ldHJpZXNbaV0pO319fTtqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlF1YWRFZGdlU3ViZGl2aXNpb249ZnVuY3Rpb24oZW52LHRvbGVyYW5jZSl7dGhpcy50b2xlcmFuY2U9dG9sZXJhbmNlO3RoaXMuZWRnZUNvaW5jaWRlbmNlVG9sZXJhbmNlPXRvbGVyYW5jZS9qc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlF1YWRFZGdlU3ViZGl2aXNpb24uRURHRV9DT0lOQ0lERU5DRV9UT0xfRkFDVE9SO3RoaXMudmlzaXRlZEtleT0wO3RoaXMucXVhZEVkZ2VzPVtdO3RoaXMuc3RhcnRpbmdFZGdlO3RoaXMudG9sZXJhbmNlO3RoaXMuZWRnZUNvaW5jaWRlbmNlVG9sZXJhbmNlO3RoaXMuZnJhbWVFbnY7dGhpcy5sb2NhdG9yPW51bGw7dGhpcy5zZWc9bmV3IGpzdHMuZ2VvbS5MaW5lU2VnbWVudCgpO3RoaXMudHJpRWRnZXM9bmV3IEFycmF5KDMpO3RoaXMuZnJhbWVWZXJ0ZXg9bmV3IEFycmF5KDMpO3RoaXMuY3JlYXRlRnJhbWUoZW52KTt0aGlzLnN0YXJ0aW5nRWRnZT10aGlzLmluaXRTdWJkaXYoKTt0aGlzLmxvY2F0b3I9bmV3IGpzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuTGFzdEZvdW5kUXVhZEVkZ2VMb2NhdG9yKHRoaXMpO307anN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5RdWFkRWRnZVN1YmRpdmlzaW9uLkVER0VfQ09JTkNJREVOQ0VfVE9MX0ZBQ1RPUj0xMDAwO2pzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuUXVhZEVkZ2VTdWJkaXZpc2lvbi5nZXRUcmlhbmdsZUVkZ2VzPWZ1bmN0aW9uKHN0YXJ0UUUsdHJpRWRnZSl7dHJpRWRnZVswXT1zdGFydFFFO3RyaUVkZ2VbMV09dHJpRWRnZVswXS5sTmV4dCgpO3RyaUVkZ2VbMl09dHJpRWRnZVsxXS5sTmV4dCgpO2lmKHRyaUVkZ2VbMl0ubE5leHQoKSE9dHJpRWRnZVswXSl7dGhyb3cgbmV3IGpzdHMuSWxsZWdhbEFyZ3VtZW50RXJyb3IoJ0VkZ2VzIGRvIG5vdCBmb3JtIGEgdHJpYW5nbGUnKTt9fTtqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlF1YWRFZGdlU3ViZGl2aXNpb24ucHJvdG90eXBlLmNyZWF0ZUZyYW1lPWZ1bmN0aW9uKGVudil7dmFyIGRlbHRhWCxkZWx0YVksb2Zmc2V0O2RlbHRhWD1lbnYuZ2V0V2lkdGgoKTtkZWx0YVk9ZW52LmdldEhlaWdodCgpO29mZnNldD0wLjA7aWYoZGVsdGFYPmRlbHRhWSl7b2Zmc2V0PWRlbHRhWCoxMC4wO31lbHNle29mZnNldD1kZWx0YVkqMTAuMDt9XG50aGlzLmZyYW1lVmVydGV4WzBdPW5ldyBqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlZlcnRleCgoZW52LmdldE1heFgoKStlbnYuZ2V0TWluWCgpKS8yLjAsZW52LmdldE1heFkoKVxuK29mZnNldCk7dGhpcy5mcmFtZVZlcnRleFsxXT1uZXcganN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5WZXJ0ZXgoZW52LmdldE1pblgoKS1vZmZzZXQsZW52LmdldE1pblkoKS1vZmZzZXQpO3RoaXMuZnJhbWVWZXJ0ZXhbMl09bmV3IGpzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuVmVydGV4KGVudi5nZXRNYXhYKCkrb2Zmc2V0LGVudi5nZXRNaW5ZKCktb2Zmc2V0KTt0aGlzLmZyYW1lRW52PW5ldyBqc3RzLmdlb20uRW52ZWxvcGUodGhpcy5mcmFtZVZlcnRleFswXS5nZXRDb29yZGluYXRlKCksdGhpcy5mcmFtZVZlcnRleFsxXS5nZXRDb29yZGluYXRlKCkpO3RoaXMuZnJhbWVFbnYuZXhwYW5kVG9JbmNsdWRlKHRoaXMuZnJhbWVWZXJ0ZXhbMl0uZ2V0Q29vcmRpbmF0ZSgpKTt9O2pzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuUXVhZEVkZ2VTdWJkaXZpc2lvbi5wcm90b3R5cGUuaW5pdFN1YmRpdj1mdW5jdGlvbigpe3ZhciBlYSxlYixlYztlYT10aGlzLm1ha2VFZGdlKHRoaXMuZnJhbWVWZXJ0ZXhbMF0sdGhpcy5mcmFtZVZlcnRleFsxXSk7ZWI9dGhpcy5tYWtlRWRnZSh0aGlzLmZyYW1lVmVydGV4WzFdLHRoaXMuZnJhbWVWZXJ0ZXhbMl0pO2pzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuUXVhZEVkZ2Uuc3BsaWNlKGVhLnN5bSgpLGViKTtlYz10aGlzLm1ha2VFZGdlKHRoaXMuZnJhbWVWZXJ0ZXhbMl0sdGhpcy5mcmFtZVZlcnRleFswXSk7anN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5RdWFkRWRnZS5zcGxpY2UoZWIuc3ltKCksZWMpO2pzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuUXVhZEVkZ2Uuc3BsaWNlKGVjLnN5bSgpLGVhKTtyZXR1cm4gZWE7fTtqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlF1YWRFZGdlU3ViZGl2aXNpb24ucHJvdG90eXBlLmdldFRvbGVyYW5jZT1mdW5jdGlvbigpe3JldHVybiB0aGlzLnRvbGVyYW5jZTt9O2pzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuUXVhZEVkZ2VTdWJkaXZpc2lvbi5wcm90b3R5cGUuZ2V0RW52ZWxvcGU9ZnVuY3Rpb24oKXtyZXR1cm4gbmV3IGpzdHMuZ2VvbS5FbnZlbG9wZSh0aGlzLmZyYW1lRW52KTt9O2pzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuUXVhZEVkZ2VTdWJkaXZpc2lvbi5wcm90b3R5cGUuZ2V0RWRnZXM9ZnVuY3Rpb24oKXtpZihhcmd1bWVudHMubGVuZ3RoPjApe3JldHVybiB0aGlzLmdldEVkZ2VzQnlGYWN0b3J5KGFyZ3VtZW50c1swXSk7fWVsc2V7cmV0dXJuIHRoaXMucXVhZEVkZ2VzO319O2pzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuUXVhZEVkZ2VTdWJkaXZpc2lvbi5wcm90b3R5cGUuc2V0TG9jYXRvcj1mdW5jdGlvbihsb2NhdG9yKXt0aGlzLmxvY2F0b3I9bG9jYXRvcjt9O2pzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuUXVhZEVkZ2VTdWJkaXZpc2lvbi5wcm90b3R5cGUubWFrZUVkZ2U9ZnVuY3Rpb24obyxkKXt2YXIgcT1qc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlF1YWRFZGdlLm1ha2VFZGdlKG8sZCk7dGhpcy5xdWFkRWRnZXMucHVzaChxKTtyZXR1cm4gcTt9O2pzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuUXVhZEVkZ2VTdWJkaXZpc2lvbi5wcm90b3R5cGUuY29ubmVjdD1mdW5jdGlvbihhLGIpe3ZhciBxPWpzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuUXVhZEVkZ2UuY29ubmVjdChhLGIpO3RoaXMucXVhZEVkZ2VzLnB1c2gocSk7cmV0dXJuIHE7fTtqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlF1YWRFZGdlU3ViZGl2aXNpb24ucHJvdG90eXBlLmRlbGV0ZV9qc3RzPWZ1bmN0aW9uKGUpe2pzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuUXVhZEVkZ2Uuc3BsaWNlKGUsZS5vUHJldigpKTtqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlF1YWRFZGdlLnNwbGljZShlLnN5bSgpLGUuc3ltKCkub1ByZXYoKSk7dmFyIGVTeW0sZVJvdCxlUm90U3ltO2UuZVN5bT1lLnN5bSgpO2VSb3Q9ZS5yb3Q7ZVJvdFN5bT1lLnJvdC5zeW0oKTt2YXIgaWR4PXRoaXMucXVhZEVkZ2VzLmluZGV4T2YoZSk7aWYoaWR4IT09LTEpe3RoaXMucXVhZEVkZ2VzLnNwbGljZShpZHgsMSk7fVxuaWR4PXRoaXMucXVhZEVkZ2VzLmluZGV4T2YoZVN5bSk7aWYoaWR4IT09LTEpe3RoaXMucXVhZEVkZ2VzLnNwbGljZShpZHgsMSk7fVxuaWR4PXRoaXMucXVhZEVkZ2VzLmluZGV4T2YoZVJvdCk7aWYoaWR4IT09LTEpe3RoaXMucXVhZEVkZ2VzLnNwbGljZShpZHgsMSk7fVxuaWR4PXRoaXMucXVhZEVkZ2VzLmluZGV4T2YoZVJvdFN5bSk7aWYoaWR4IT09LTEpe3RoaXMucXVhZEVkZ2VzLnNwbGljZShpZHgsMSk7fVxuZS5kZWxldGVfanN0cygpO2VTeW0uZGVsZXRlX2pzdHMoKTtlUm90LmRlbGV0ZV9qc3RzKCk7ZVJvdFN5bS5kZWxldGVfanN0cygpO307anN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5RdWFkRWRnZVN1YmRpdmlzaW9uLnByb3RvdHlwZS5sb2NhdGVGcm9tRWRnZT1mdW5jdGlvbih2LHN0YXJ0RWRnZSl7dmFyIGl0ZXI9MCxtYXhJdGVyPXRoaXMucXVhZEVkZ2VzLmxlbmd0aCxlO2U9c3RhcnRFZGdlO3doaWxlKHRydWUpe2l0ZXIrKztpZihpdGVyPm1heEl0ZXIpe3Rocm93IG5ldyBqc3RzLmVycm9yLkxvY2F0ZUZhaWx1cmVFcnJvcihlLnRvTGluZVNlZ21lbnQoKSk7fVxuaWYoKHYuZXF1YWxzKGUub3JpZygpKSl8fCh2LmVxdWFscyhlLmRlc3QoKSkpKXticmVhazt9ZWxzZSBpZih2LnJpZ2h0T2YoZSkpe2U9ZS5zeW0oKTt9ZWxzZSBpZighdi5yaWdodE9mKGUub05leHQoKSkpe2U9ZS5vTmV4dCgpO31lbHNlIGlmKCF2LnJpZ2h0T2YoZS5kUHJldigpKSl7ZT1lLmRQcmV2KCk7fWVsc2V7YnJlYWs7fX1cbnJldHVybiBlO307anN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5RdWFkRWRnZVN1YmRpdmlzaW9uLnByb3RvdHlwZS5sb2NhdGU9ZnVuY3Rpb24oKXtpZihhcmd1bWVudHMubGVuZ3RoPT09MSl7aWYoYXJndW1lbnRzWzBdaW5zdGFuY2VvZiBqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlZlcnRleCl7cmV0dXJuIHRoaXMubG9jYXRlQnlWZXJ0ZXgoYXJndW1lbnRzWzBdKTt9ZWxzZXtyZXR1cm4gdGhpcy5sb2NhdGVCeUNvb3JkaW5hdGUoYXJndW1lbnRzWzBdKTt9fWVsc2V7cmV0dXJuIHRoaXMubG9jYXRlQnlDb29yZGluYXRlcyhhcmd1bWVudHNbMF0sYXJndW1lbnRzWzFdKTt9fTtqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlF1YWRFZGdlU3ViZGl2aXNpb24ucHJvdG90eXBlLmxvY2F0ZUJ5VmVydGV4PWZ1bmN0aW9uKHYpe3JldHVybiB0aGlzLmxvY2F0b3IubG9jYXRlKHYpO307anN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5RdWFkRWRnZVN1YmRpdmlzaW9uLnByb3RvdHlwZS5sb2NhdGVCeUNvb3JkaW5hdGU9ZnVuY3Rpb24ocCl7cmV0dXJuIHRoaXMubG9jYXRvci5sb2NhdGUobmV3IGpzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuVmVydGV4KHApKTt9O2pzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuUXVhZEVkZ2VTdWJkaXZpc2lvbi5wcm90b3R5cGUubG9jYXRlQnlDb29yZGluYXRlcz1mdW5jdGlvbihwMCxwMSl7dmFyIGUsYmFzZSxsb2NFZGdlO3ZhciBlPXRoaXMubG9jYXRvci5sb2NhdGUobmV3IGpzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuVmVydGV4KHAwKSk7aWYoZT09PW51bGwpe3JldHVybiBudWxsO31cbmJhc2U9ZTtpZihlLmRlc3QoKS5nZXRDb29yZGluYXRlKCkuZXF1YWxzMkQocDApKXtiYXNlPWUuc3ltKCk7fVxubG9jRWRnZT1iYXNlO2Rve2lmKGxvY0VkZ2UuZGVzdCgpLmdldENvb3JkaW5hdGUoKS5lcXVhbHMyRChwMSkpe3JldHVybiBsb2NFZGdlO31cbmxvY0VkZ2U9bG9jRWRnZS5vTmV4dCgpO313aGlsZShsb2NFZGdlIT1iYXNlKTtyZXR1cm4gbnVsbDt9O2pzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuUXVhZEVkZ2VTdWJkaXZpc2lvbi5wcm90b3R5cGUuaW5zZXJ0U2l0ZT1mdW5jdGlvbih2KXt2YXIgZSxiYXNlLHN0YXJ0RWRnZTtlPXRoaXMubG9jYXRlKHYpO2lmKCh2LmVxdWFscyhlLm9yaWcoKSx0aGlzLnRvbGVyYW5jZSkpfHwodi5lcXVhbHMoZS5kZXN0KCksdGhpcy50b2xlcmFuY2UpKSl7cmV0dXJuIGU7fVxuYmFzZT10aGlzLm1ha2VFZGdlKGUub3JpZygpLHYpO2pzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuUXVhZEVkZ2Uuc3BsaWNlKGJhc2UsZSk7c3RhcnRFZGdlPWJhc2U7ZG97YmFzZT10aGlzLmNvbm5lY3QoZSxiYXNlLnN5bSgpKTtlPWJhc2Uub1ByZXYoKTt9d2hpbGUoZS5sTmV4dCgpIT1zdGFydEVkZ2UpO3JldHVybiBzdGFydEVkZ2U7fTtqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlF1YWRFZGdlU3ViZGl2aXNpb24ucHJvdG90eXBlLmlzRnJhbWVFZGdlPWZ1bmN0aW9uKGUpe2lmKHRoaXMuaXNGcmFtZVZlcnRleChlLm9yaWcoKSl8fHRoaXMuaXNGcmFtZVZlcnRleChlLmRlc3QoKSkpe3JldHVybiB0cnVlO31cbnJldHVybiBmYWxzZTt9O2pzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuUXVhZEVkZ2VTdWJkaXZpc2lvbi5wcm90b3R5cGUuaXNGcmFtZUJvcmRlckVkZ2U9ZnVuY3Rpb24oZSl7dmFyIGxlZnRUcmkscmlnaHRUcmksdkxlZnRUcmlPdGhlcix2UmlnaHRUcmlPdGhlcjtsZWZ0VHJpPW5ldyBBcnJheSgzKTt0aGlzLmdldFRyaWFuZ2xlRWRnZXMoZSxsZWZ0VHJpKTtyaWdodFRyaT1uZXcgQXJyYXkoMyk7dGhpcy5nZXRUcmlhbmdsZUVkZ2VzKGUuc3ltKCkscmlnaHRUcmkpO3ZMZWZ0VHJpT3RoZXI9ZS5sTmV4dCgpLmRlc3QoKTtpZih0aGlzLmlzRnJhbWVWZXJ0ZXgodkxlZnRUcmlPdGhlcikpe3JldHVybiB0cnVlO31cbnZSaWdodFRyaU90aGVyPWUuc3ltKCkubE5leHQoKS5kZXN0KCk7aWYodGhpcy5pc0ZyYW1lVmVydGV4KHZSaWdodFRyaU90aGVyKSl7cmV0dXJuIHRydWU7fVxucmV0dXJuIGZhbHNlO307anN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5RdWFkRWRnZVN1YmRpdmlzaW9uLnByb3RvdHlwZS5pc0ZyYW1lVmVydGV4PWZ1bmN0aW9uKHYpe2lmKHYuZXF1YWxzKHRoaXMuZnJhbWVWZXJ0ZXhbMF0pKXtyZXR1cm4gdHJ1ZTt9XG5pZih2LmVxdWFscyh0aGlzLmZyYW1lVmVydGV4WzFdKSl7cmV0dXJuIHRydWU7fVxuaWYodi5lcXVhbHModGhpcy5mcmFtZVZlcnRleFsyXSkpe3JldHVybiB0cnVlO31cbnJldHVybiBmYWxzZTt9O2pzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuUXVhZEVkZ2VTdWJkaXZpc2lvbi5wcm90b3R5cGUuaXNPbkVkZ2U9ZnVuY3Rpb24oZSxwKXt0aGlzLnNlZy5zZXRDb29yZGluYXRlcyhlLm9yaWcoKS5nZXRDb29yZGluYXRlKCksZS5kZXN0KCkuZ2V0Q29vcmRpbmF0ZSgpKTt2YXIgZGlzdD10aGlzLnNlZy5kaXN0YW5jZShwKTtyZXR1cm4gZGlzdDx0aGlzLmVkZ2VDb2luY2lkZW5jZVRvbGVyYW5jZTt9O2pzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuUXVhZEVkZ2VTdWJkaXZpc2lvbi5wcm90b3R5cGUuaXNWZXJ0ZXhPZkVkZ2U9ZnVuY3Rpb24oZSx2KXtpZigodi5lcXVhbHMoZS5vcmlnKCksdGhpcy50b2xlcmFuY2UpKXx8KHYuZXF1YWxzKGUuZGVzdCgpLHRoaXMudG9sZXJhbmNlKSkpe3JldHVybiB0cnVlO31cbnJldHVybiBmYWxzZTt9O2pzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuUXVhZEVkZ2VTdWJkaXZpc2lvbi5wcm90b3R5cGUuZ2V0VmVydGljZXM9ZnVuY3Rpb24oaW5jbHVkZUZyYW1lKVxue3ZhciB2ZXJ0aWNlcz1bXSxpLGlsLHFlLHYsdmQ7aT0wLGlsPXRoaXMucXVhZEVkZ2VzLmxlbmd0aDtmb3IoaTtpPGlsO2krKyl7cWU9dGhpcy5xdWFkRWRnZXNbaV07dj1xZS5vcmlnKCk7aWYoaW5jbHVkZUZyYW1lfHwhdGhpcy5pc0ZyYW1lVmVydGV4KHYpKXt2ZXJ0aWNlcy5wdXNoKHYpO31cbnZkPXFlLmRlc3QoKTtpZihpbmNsdWRlRnJhbWV8fCF0aGlzLmlzRnJhbWVWZXJ0ZXgodmQpKXt2ZXJ0aWNlcy5wdXNoKHZkKTt9fVxucmV0dXJuIHZlcnRpY2VzO307anN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5RdWFkRWRnZVN1YmRpdmlzaW9uLnByb3RvdHlwZS5nZXRWZXJ0ZXhVbmlxdWVFZGdlcz1mdW5jdGlvbihpbmNsdWRlRnJhbWUpXG57dmFyIGVkZ2VzLHZpc2l0ZWRWZXJ0aWNlcyxpLGlsLHFlLHYscWQsdmQ7ZWRnZXM9W107dmlzaXRlZFZlcnRpY2VzPVtdO2k9MCxpbD10aGlzLnF1YWRFZGdlcy5sZW5ndGg7Zm9yKGk7aTxpbDtpKyspe3FlPXRoaXMucXVhZEVkZ2VzW2ldO3Y9cWUub3JpZygpO2lmKHZpc2l0ZWRWZXJ0aWNlcy5pbmRleE9mKHYpPT09LTEpe3Zpc2l0ZWRWZXJ0aWNlcy5wdXNoKHYpO2lmKGluY2x1ZGVGcmFtZXx8IXRoaXMuaXNGcmFtZVZlcnRleCh2KSl7ZWRnZXMucHVzaChxZSk7fX1cbnFkPXFlLnN5bSgpO3ZkPXFkLm9yaWcoKTtpZih2aXNpdGVkVmVydGljZXMuaW5kZXhPZih2ZCk9PT0tMSl7dmlzaXRlZFZlcnRpY2VzLnB1c2godmQpO2lmKGluY2x1ZGVGcmFtZXx8IXRoaXMuaXNGcmFtZVZlcnRleCh2ZCkpe2VkZ2VzLnB1c2gocWQpO319fVxucmV0dXJuIGVkZ2VzO307anN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5RdWFkRWRnZVN1YmRpdmlzaW9uLnByb3RvdHlwZS5nZXRQcmltYXJ5RWRnZXM9ZnVuY3Rpb24oaW5jbHVkZUZyYW1lKXt0aGlzLnZpc2l0ZWRLZXkrKzt2YXIgZWRnZXMsZWRnZVN0YWNrLHZpc2l0ZWRFZGdlcyxlZGdlLHByaVFFO2VkZ2VzPVtdO2VkZ2VTdGFjaz1bXTtlZGdlU3RhY2sucHVzaCh0aGlzLnN0YXJ0aW5nRWRnZSk7dmlzaXRlZEVkZ2VzPVtdO3doaWxlKGVkZ2VTdGFjay5sZW5ndGg+MCl7ZWRnZT1lZGdlU3RhY2sucG9wKCk7aWYodmlzaXRlZEVkZ2VzLmluZGV4T2YoZWRnZSk9PT0tMSl7cHJpUUU9ZWRnZS5nZXRQcmltYXJ5KCk7aWYoaW5jbHVkZUZyYW1lfHwhdGhpcy5pc0ZyYW1lRWRnZShwcmlRRSkpe2VkZ2VzLnB1c2gocHJpUUUpO31cbmVkZ2VTdGFjay5wdXNoKGVkZ2Uub05leHQoKSk7ZWRnZVN0YWNrLnB1c2goZWRnZS5zeW0oKS5vTmV4dCgpKTt2aXNpdGVkRWRnZXMucHVzaChlZGdlKTt2aXNpdGVkRWRnZXMucHVzaChlZGdlLnN5bSgpKTt9fVxucmV0dXJuIGVkZ2VzO307anN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5RdWFkRWRnZVN1YmRpdmlzaW9uLnByb3RvdHlwZS52aXNpdFRyaWFuZ2xlcz1mdW5jdGlvbih0cmlWaXNpdG9yLGluY2x1ZGVGcmFtZSl7dGhpcy52aXNpdGVkS2V5Kys7dmFyIGVkZ2VTdGFjayx2aXNpdGVkRWRnZXMsZWRnZSx0cmlFZGdlcztlZGdlU3RhY2s9W107ZWRnZVN0YWNrLnB1c2godGhpcy5zdGFydGluZ0VkZ2UpO3Zpc2l0ZWRFZGdlcz1bXTt3aGlsZShlZGdlU3RhY2subGVuZ3RoPjApe2VkZ2U9ZWRnZVN0YWNrLnBvcCgpO2lmKHZpc2l0ZWRFZGdlcy5pbmRleE9mKGVkZ2UpPT09LTEpe3RyaUVkZ2VzPXRoaXMuZmV0Y2hUcmlhbmdsZVRvVmlzaXQoZWRnZSxlZGdlU3RhY2ssaW5jbHVkZUZyYW1lLHZpc2l0ZWRFZGdlcyk7aWYodHJpRWRnZXMhPT1udWxsKVxudHJpVmlzaXRvci52aXNpdCh0cmlFZGdlcyk7fX19O2pzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuUXVhZEVkZ2VTdWJkaXZpc2lvbi5wcm90b3R5cGUuZmV0Y2hUcmlhbmdsZVRvVmlzaXQ9ZnVuY3Rpb24oZWRnZSxlZGdlU3RhY2ssaW5jbHVkZUZyYW1lLHZpc2l0ZWRFZGdlcyl7dmFyIGN1cnIsZWRnZUNvdW50LGlzRnJhbWUsc3ltO2N1cnI9ZWRnZTtlZGdlQ291bnQ9MDtpc0ZyYW1lPWZhbHNlO2Rve3RoaXMudHJpRWRnZXNbZWRnZUNvdW50XT1jdXJyO2lmKHRoaXMuaXNGcmFtZUVkZ2UoY3Vycikpe2lzRnJhbWU9dHJ1ZTt9XG5zeW09Y3Vyci5zeW0oKTtpZih2aXNpdGVkRWRnZXMuaW5kZXhPZihzeW0pPT09LTEpe2VkZ2VTdGFjay5wdXNoKHN5bSk7fVxudmlzaXRlZEVkZ2VzLnB1c2goY3Vycik7ZWRnZUNvdW50Kys7Y3Vycj1jdXJyLmxOZXh0KCk7fXdoaWxlKGN1cnIhPT1lZGdlKTtpZihpc0ZyYW1lJiYhaW5jbHVkZUZyYW1lKXtyZXR1cm4gbnVsbDt9XG5yZXR1cm4gdGhpcy50cmlFZGdlczt9O2pzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuUXVhZEVkZ2VTdWJkaXZpc2lvbi5wcm90b3R5cGUuZ2V0VHJpYW5nbGVFZGdlcz1mdW5jdGlvbihpbmNsdWRlRnJhbWUpe3ZhciB2aXNpdG9yPW5ldyBqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlRyaWFuZ2xlRWRnZXNMaXN0VmlzaXRvcigpO3RoaXMudmlzaXRUcmlhbmdsZXModmlzaXRvcixpbmNsdWRlRnJhbWUpO3JldHVybiB2aXNpdG9yLmdldFRyaWFuZ2xlRWRnZXMoKTt9O2pzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuUXVhZEVkZ2VTdWJkaXZpc2lvbi5wcm90b3R5cGUuZ2V0VHJpYW5nbGVWZXJ0aWNlcz1mdW5jdGlvbihpbmNsdWRlRnJhbWUpe3ZhciB2aXNpdG9yPW5ldyBUcmlhbmdsZVZlcnRleExpc3RWaXNpdG9yKCk7dGhpcy52aXNpdFRyaWFuZ2xlcyh2aXNpdG9yLGluY2x1ZGVGcmFtZSk7cmV0dXJuIHZpc2l0b3IuZ2V0VHJpYW5nbGVWZXJ0aWNlcygpO307anN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5RdWFkRWRnZVN1YmRpdmlzaW9uLnByb3RvdHlwZS5nZXRUcmlhbmdsZUNvb3JkaW5hdGVzPWZ1bmN0aW9uKGluY2x1ZGVGcmFtZSl7dmFyIHZpc2l0b3I9bmV3IGpzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuVHJpYW5nbGVDb29yZGluYXRlc1Zpc2l0b3IoKTt0aGlzLnZpc2l0VHJpYW5nbGVzKHZpc2l0b3IsaW5jbHVkZUZyYW1lKTtyZXR1cm4gdmlzaXRvci5nZXRUcmlhbmdsZXMoKTt9O2pzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuUXVhZEVkZ2VTdWJkaXZpc2lvbi5wcm90b3R5cGUuZ2V0RWRnZXNCeUZhY3Rvcnk9ZnVuY3Rpb24oZ2VvbUZhY3Qpe3ZhciBxdWFkRWRnZXMsZWRnZXMsaSxpbCxxZSxjb29yZHM7cXVhZEVkZ2VzPXRoaXMuZ2V0UHJpbWFyeUVkZ2VzKGZhbHNlKTtlZGdlcz1bXTtpPTA7aWw9cXVhZEVkZ2VzLmxlbmd0aDtmb3IoaTtpPGlsO2krKyl7cWU9cXVhZEVkZ2VzW2ldO2Nvb3Jkcz1bXTtjb29yZHNbMF09KHFlLm9yaWcoKS5nZXRDb29yZGluYXRlKCkpO2Nvb3Jkc1sxXT0ocWUuZGVzdCgpLmdldENvb3JkaW5hdGUoKSk7ZWRnZXNbaV09Z2VvbUZhY3QuY3JlYXRlTGluZVN0cmluZyhjb29yZHMpO31cbnJldHVybiBnZW9tRmFjdC5jcmVhdGVNdWx0aUxpbmVTdHJpbmcoZWRnZXMpO307anN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5RdWFkRWRnZVN1YmRpdmlzaW9uLnByb3RvdHlwZS5nZXRUcmlhbmdsZXM9ZnVuY3Rpb24oZ2VvbUZhY3Qpe3ZhciB0cmlQdHNMaXN0LHRyaXMsdHJpUHQsaSxpbDt0cmlQdHNMaXN0PXRoaXMuZ2V0VHJpYW5nbGVDb29yZGluYXRlcyhmYWxzZSk7dHJpcz1uZXcgQXJyYXkodHJpUHRzTGlzdC5sZW5ndGgpO2k9MCxpbD10cmlQdHNMaXN0Lmxlbmd0aDtmb3IoaTtpPGlsO2krKyl7dHJpUHQ9dHJpUHRzTGlzdFtpXTt0cmlzW2ldPWdlb21GYWN0LmNyZWF0ZVBvbHlnb24oZ2VvbUZhY3QuY3JlYXRlTGluZWFyUmluZyh0cmlQdCxudWxsKSk7fVxucmV0dXJuIGdlb21GYWN0LmNyZWF0ZUdlb21ldHJ5Q29sbGVjdGlvbih0cmlzKTt9O2pzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuUXVhZEVkZ2VTdWJkaXZpc2lvbi5wcm90b3R5cGUuZ2V0Vm9yb25vaURpYWdyYW09ZnVuY3Rpb24oZ2VvbUZhY3QpXG57dmFyIHZvckNlbGxzPXRoaXMuZ2V0Vm9yb25vaUNlbGxQb2x5Z29ucyhnZW9tRmFjdCk7cmV0dXJuIGdlb21GYWN0LmNyZWF0ZUdlb21ldHJ5Q29sbGVjdGlvbih2b3JDZWxscyk7fTtqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlF1YWRFZGdlU3ViZGl2aXNpb24ucHJvdG90eXBlLmdldFZvcm9ub2lDZWxsUG9seWdvbnM9ZnVuY3Rpb24oZ2VvbUZhY3QpXG57dGhpcy52aXNpdFRyaWFuZ2xlcyhuZXcganN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5UcmlhbmdsZUNpcmN1bWNlbnRyZVZpc2l0b3IoKSx0cnVlKTt2YXIgY2VsbHMsZWRnZXMsaSxpbCxxZTtjZWxscz1bXTtlZGdlcz10aGlzLmdldFZlcnRleFVuaXF1ZUVkZ2VzKGZhbHNlKTtpPTAsaWw9ZWRnZXMubGVuZ3RoO2ZvcihpO2k8aWw7aSsrKXtxZT1lZGdlc1tpXTtjZWxscy5wdXNoKHRoaXMuZ2V0Vm9yb25vaUNlbGxQb2x5Z29uKHFlLGdlb21GYWN0KSk7fVxucmV0dXJuIGNlbGxzO307anN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5RdWFkRWRnZVN1YmRpdmlzaW9uLnByb3RvdHlwZS5nZXRWb3Jvbm9pQ2VsbFBvbHlnb249ZnVuY3Rpb24ocWUsZ2VvbUZhY3QpXG57dmFyIGNlbGxQdHMsc3RhcnRRZSxjYyxjb29yZExpc3QsY2VsbFBvbHksdjtjZWxsUHRzPVtdO3N0YXJ0UUU9cWU7ZG97Y2M9cWUucm90Lm9yaWcoKS5nZXRDb29yZGluYXRlKCk7Y2VsbFB0cy5wdXNoKGNjKTtxZT1xZS5vUHJldigpO313aGlsZShxZSE9PXN0YXJ0UUUpO2Nvb3JkTGlzdD1uZXcganN0cy5nZW9tLkNvb3JkaW5hdGVMaXN0KFtdLGZhbHNlKTtjb29yZExpc3QuYWRkKGNlbGxQdHMsZmFsc2UpO2Nvb3JkTGlzdC5jbG9zZVJpbmcoKTtpZihjb29yZExpc3Quc2l6ZSgpPDQpe2Nvb3JkTGlzdC5hZGQoY29vcmRMaXN0LmdldChjb29yZExpc3Quc2l6ZSgpLTEpLHRydWUpO31cbmNlbGxQb2x5PWdlb21GYWN0LmNyZWF0ZVBvbHlnb24oZ2VvbUZhY3QuY3JlYXRlTGluZWFyUmluZyhjb29yZExpc3QudG9BcnJheSgpKSxudWxsKTt2PXN0YXJ0UUUub3JpZygpO3JldHVybiBjZWxsUG9seTt9O2pzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuVHJpYW5nbGVDaXJjdW1jZW50cmVWaXNpdG9yPWZ1bmN0aW9uKCl7fTtqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlRyaWFuZ2xlQ2lyY3VtY2VudHJlVmlzaXRvci5wcm90b3R5cGUudmlzaXQ9ZnVuY3Rpb24odHJpRWRnZXMpe3ZhciBhLGIsYyxjYyxjY1ZlcnRleCxpO2E9dHJpRWRnZXNbMF0ub3JpZygpLmdldENvb3JkaW5hdGUoKTtiPXRyaUVkZ2VzWzFdLm9yaWcoKS5nZXRDb29yZGluYXRlKCk7Yz10cmlFZGdlc1syXS5vcmlnKCkuZ2V0Q29vcmRpbmF0ZSgpO2NjPWpzdHMuZ2VvbS5UcmlhbmdsZS5jaXJjdW1jZW50cmUoYSxiLGMpO2NjVmVydGV4PW5ldyBqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlZlcnRleChjYyk7aT0wO2ZvcihpO2k8MztpKyspe3RyaUVkZ2VzW2ldLnJvdC5zZXRPcmlnKGNjVmVydGV4KTt9fTtqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlRyaWFuZ2xlRWRnZXNMaXN0VmlzaXRvcj1mdW5jdGlvbigpe3RoaXMudHJpTGlzdD1bXTt9O2pzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuVHJpYW5nbGVFZGdlc0xpc3RWaXNpdG9yLnByb3RvdHlwZS52aXNpdD1mdW5jdGlvbih0cmlFZGdlcyl7dmFyIGNsb25lPXRyaUVkZ2VzLmNvbmNhdCgpO3RoaXMudHJpTGlzdC5wdXNoKGNsb25lKTt9O2pzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuVHJpYW5nbGVFZGdlc0xpc3RWaXNpdG9yLnByb3RvdHlwZS5nZXRUcmlhbmdsZUVkZ2VzPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMudHJpTGlzdDt9O2pzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuVHJpYW5nbGVWZXJ0ZXhMaXN0VmlzaXRvcj1mdW5jdGlvbigpe3RoaXMudHJpTGlzdD1bXTt9O2pzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuVHJpYW5nbGVWZXJ0ZXhMaXN0VmlzaXRvci5wcm90b3R5cGUudmlzaXQ9ZnVuY3Rpb24odHJpRWRnZXMpe3ZhciB2ZXJ0aWNlcz1bXTt2ZXJ0aWNlcy5wdXNoKHRyaWVFZGdlc1swXS5vcmlnKCkpO3ZlcnRpY2VzLnB1c2godHJpZUVkZ2VzWzFdLm9yaWcoKSk7dmVydGljZXMucHVzaCh0cmllRWRnZXNbMl0ub3JpZygpKTt0aGlzLnRyaUxpc3QucHVzaCh2ZXJ0aWNlcyk7fTtqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlRyaWFuZ2xlVmVydGV4TGlzdFZpc2l0b3IucHJvdG90eXBlLmdldFRyaWFuZ2xlVmVydGljZXM9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy50cmlMaXN0O307anN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5UcmlhbmdsZUNvb3JkaW5hdGVzVmlzaXRvcj1mdW5jdGlvbigpe3RoaXMuY29vcmRMaXN0PW5ldyBqc3RzLmdlb20uQ29vcmRpbmF0ZUxpc3QoW10sZmFsc2UpO3RoaXMudHJpQ29vcmRzPVtdO307anN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5UcmlhbmdsZUNvb3JkaW5hdGVzVmlzaXRvci5wcm90b3R5cGUudmlzaXQ9ZnVuY3Rpb24odHJpRWRnZXMpe3RoaXMuY29vcmRMaXN0PW5ldyBqc3RzLmdlb20uQ29vcmRpbmF0ZUxpc3QoW10sZmFsc2UpO3ZhciBpPTAsdixwdHM7Zm9yKGk7aTwzO2krKyl7dj10cmlFZGdlc1tpXS5vcmlnKCk7dGhpcy5jb29yZExpc3QuYWRkKHYuZ2V0Q29vcmRpbmF0ZSgpKTt9XG5pZih0aGlzLmNvb3JkTGlzdC5zaXplKCk+MCl7dGhpcy5jb29yZExpc3QuY2xvc2VSaW5nKCk7cHRzPXRoaXMuY29vcmRMaXN0LnRvQXJyYXkoKTtpZihwdHMubGVuZ3RoIT09NCl7cmV0dXJuO31cbnRoaXMudHJpQ29vcmRzLnB1c2gocHRzKTt9fTtqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlRyaWFuZ2xlQ29vcmRpbmF0ZXNWaXNpdG9yLnByb3RvdHlwZS5nZXRUcmlhbmdsZXM9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy50cmlDb29yZHM7fTtqc3RzLm9wZXJhdGlvbi5yZWxhdGUuRWRnZUVuZEJ1bmRsZT1mdW5jdGlvbigpe3RoaXMuZWRnZUVuZHM9W107dmFyIGU9YXJndW1lbnRzWzBdaW5zdGFuY2VvZiBqc3RzLmdlb21ncmFwaC5FZGdlRW5kP2FyZ3VtZW50c1swXTphcmd1bWVudHNbMV07dmFyIGVkZ2U9ZS5nZXRFZGdlKCk7dmFyIGNvb3JkPWUuZ2V0Q29vcmRpbmF0ZSgpO3ZhciBkaXJDb29yZD1lLmdldERpcmVjdGVkQ29vcmRpbmF0ZSgpO3ZhciBsYWJlbD1uZXcganN0cy5nZW9tZ3JhcGguTGFiZWwoZS5nZXRMYWJlbCgpKTtqc3RzLmdlb21ncmFwaC5FZGdlRW5kLmNhbGwodGhpcyxlZGdlLGNvb3JkLGRpckNvb3JkLGxhYmVsKTt0aGlzLmluc2VydChlKTt9O2pzdHMub3BlcmF0aW9uLnJlbGF0ZS5FZGdlRW5kQnVuZGxlLnByb3RvdHlwZT1uZXcganN0cy5nZW9tZ3JhcGguRWRnZUVuZCgpO2pzdHMub3BlcmF0aW9uLnJlbGF0ZS5FZGdlRW5kQnVuZGxlLnByb3RvdHlwZS5lZGdlRW5kcz1udWxsO2pzdHMub3BlcmF0aW9uLnJlbGF0ZS5FZGdlRW5kQnVuZGxlLnByb3RvdHlwZS5nZXRMYWJlbD1mdW5jdGlvbigpe3JldHVybiB0aGlzLmxhYmVsO307anN0cy5vcGVyYXRpb24ucmVsYXRlLkVkZ2VFbmRCdW5kbGUucHJvdG90eXBlLmdldEVkZ2VFbmRzPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZWRnZUVuZHM7fTtqc3RzLm9wZXJhdGlvbi5yZWxhdGUuRWRnZUVuZEJ1bmRsZS5wcm90b3R5cGUuaW5zZXJ0PWZ1bmN0aW9uKGUpe3RoaXMuZWRnZUVuZHMucHVzaChlKTt9O2pzdHMub3BlcmF0aW9uLnJlbGF0ZS5FZGdlRW5kQnVuZGxlLnByb3RvdHlwZS5jb21wdXRlTGFiZWw9ZnVuY3Rpb24oYm91bmRhcnlOb2RlUnVsZSl7dmFyIGlzQXJlYT1mYWxzZTtmb3IodmFyIGk9MDtpPHRoaXMuZWRnZUVuZHMubGVuZ3RoO2krKyl7dmFyIGU9dGhpcy5lZGdlRW5kc1tpXTtpZihlLmdldExhYmVsKCkuaXNBcmVhKCkpXG5pc0FyZWE9dHJ1ZTt9XG5pZihpc0FyZWEpXG50aGlzLmxhYmVsPW5ldyBqc3RzLmdlb21ncmFwaC5MYWJlbChqc3RzLmdlb20uTG9jYXRpb24uTk9ORSxqc3RzLmdlb20uTG9jYXRpb24uTk9ORSxqc3RzLmdlb20uTG9jYXRpb24uTk9ORSk7ZWxzZVxudGhpcy5sYWJlbD1uZXcganN0cy5nZW9tZ3JhcGguTGFiZWwoanN0cy5nZW9tLkxvY2F0aW9uLk5PTkUpO2Zvcih2YXIgaT0wO2k8MjtpKyspe3RoaXMuY29tcHV0ZUxhYmVsT24oaSxib3VuZGFyeU5vZGVSdWxlKTtpZihpc0FyZWEpXG50aGlzLmNvbXB1dGVMYWJlbFNpZGVzKGkpO319O2pzdHMub3BlcmF0aW9uLnJlbGF0ZS5FZGdlRW5kQnVuZGxlLnByb3RvdHlwZS5jb21wdXRlTGFiZWxPbj1mdW5jdGlvbihnZW9tSW5kZXgsYm91bmRhcnlOb2RlUnVsZSl7dmFyIGJvdW5kYXJ5Q291bnQ9MDt2YXIgZm91bmRJbnRlcmlvcj1mYWxzZTtmb3IodmFyIGk9MDtpPHRoaXMuZWRnZUVuZHMubGVuZ3RoO2krKyl7dmFyIGU9dGhpcy5lZGdlRW5kc1tpXTt2YXIgbG9jPWUuZ2V0TGFiZWwoKS5nZXRMb2NhdGlvbihnZW9tSW5kZXgpO2lmKGxvYz09anN0cy5nZW9tLkxvY2F0aW9uLkJPVU5EQVJZKVxuYm91bmRhcnlDb3VudCsrO2lmKGxvYz09anN0cy5nZW9tLkxvY2F0aW9uLklOVEVSSU9SKVxuZm91bmRJbnRlcmlvcj10cnVlO31cbnZhciBsb2M9anN0cy5nZW9tLkxvY2F0aW9uLk5PTkU7aWYoZm91bmRJbnRlcmlvcilcbmxvYz1qc3RzLmdlb20uTG9jYXRpb24uSU5URVJJT1I7aWYoYm91bmRhcnlDb3VudD4wKXtsb2M9anN0cy5nZW9tZ3JhcGguR2VvbWV0cnlHcmFwaC5kZXRlcm1pbmVCb3VuZGFyeShib3VuZGFyeU5vZGVSdWxlLGJvdW5kYXJ5Q291bnQpO31cbnRoaXMubGFiZWwuc2V0TG9jYXRpb24oZ2VvbUluZGV4LGxvYyk7fTtqc3RzLm9wZXJhdGlvbi5yZWxhdGUuRWRnZUVuZEJ1bmRsZS5wcm90b3R5cGUuY29tcHV0ZUxhYmVsU2lkZXM9ZnVuY3Rpb24oZ2VvbUluZGV4KXt0aGlzLmNvbXB1dGVMYWJlbFNpZGUoZ2VvbUluZGV4LGpzdHMuZ2VvbWdyYXBoLlBvc2l0aW9uLkxFRlQpO3RoaXMuY29tcHV0ZUxhYmVsU2lkZShnZW9tSW5kZXgsanN0cy5nZW9tZ3JhcGguUG9zaXRpb24uUklHSFQpO307anN0cy5vcGVyYXRpb24ucmVsYXRlLkVkZ2VFbmRCdW5kbGUucHJvdG90eXBlLmNvbXB1dGVMYWJlbFNpZGU9ZnVuY3Rpb24oZ2VvbUluZGV4LHNpZGUpe2Zvcih2YXIgaT0wO2k8dGhpcy5lZGdlRW5kcy5sZW5ndGg7aSsrKXt2YXIgZT10aGlzLmVkZ2VFbmRzW2ldO2lmKGUuZ2V0TGFiZWwoKS5pc0FyZWEoKSl7dmFyIGxvYz1lLmdldExhYmVsKCkuZ2V0TG9jYXRpb24oZ2VvbUluZGV4LHNpZGUpO2lmKGxvYz09PWpzdHMuZ2VvbS5Mb2NhdGlvbi5JTlRFUklPUil7dGhpcy5sYWJlbC5zZXRMb2NhdGlvbihnZW9tSW5kZXgsc2lkZSxqc3RzLmdlb20uTG9jYXRpb24uSU5URVJJT1IpO3JldHVybjt9ZWxzZSBpZihsb2M9PT1qc3RzLmdlb20uTG9jYXRpb24uRVhURVJJT1IpXG50aGlzLmxhYmVsLnNldExvY2F0aW9uKGdlb21JbmRleCxzaWRlLGpzdHMuZ2VvbS5Mb2NhdGlvbi5FWFRFUklPUik7fX19O2pzdHMub3BlcmF0aW9uLnJlbGF0ZS5FZGdlRW5kQnVuZGxlLnByb3RvdHlwZS51cGRhdGVJTT1mdW5jdGlvbihpbSl7anN0cy5nZW9tZ3JhcGguRWRnZS51cGRhdGVJTSh0aGlzLmxhYmVsLGltKTt9O2pzdHMuaW5kZXgua2R0cmVlLktkVHJlZT1mdW5jdGlvbih0b2xlcmFuY2Upe3ZhciB0b2w9MC4wO2lmKHRvbGVyYW5jZSE9PXVuZGVmaW5lZCl7dG9sPXRvbGVyYW5jZTt9XG50aGlzLnJvb3Q9bnVsbDt0aGlzLmxhc3Q9bnVsbDt0aGlzLm51bWJlck9mTm9kZXM9MDt0aGlzLnRvbGVyYW5jZT10b2w7fTtqc3RzLmluZGV4LmtkdHJlZS5LZFRyZWUucHJvdG90eXBlLmluc2VydD1mdW5jdGlvbigpe2lmKGFyZ3VtZW50cy5sZW5ndGg9PT0xKXtyZXR1cm4gdGhpcy5pbnNlcnRDb29yZGluYXRlLmFwcGx5KHRoaXMsYXJndW1lbnRzWzBdKTt9ZWxzZXtyZXR1cm4gdGhpcy5pbnNlcnRXaXRoRGF0YS5hcHBseSh0aGlzLGFyZ3VtZW50c1swXSxhcmd1bWVudHNbMV0pO319O2pzdHMuaW5kZXgua2R0cmVlLktkVHJlZS5wcm90b3R5cGUuaW5zZXJ0Q29vcmRpbmF0ZT1mdW5jdGlvbihwKXtyZXR1cm4gdGhpcy5pbnNlcnRXaXRoRGF0YShwLG51bGwpO307anN0cy5pbmRleC5rZHRyZWUuS2RUcmVlLnByb3RvdHlwZS5pbnNlcnRXaXRoRGF0YT1mdW5jdGlvbihwLGRhdGEpe2lmKHRoaXMucm9vdD09PW51bGwpe3RoaXMucm9vdD1uZXcganN0cy5pbmRleC5rZHRyZWUuS2ROb2RlKHAsZGF0YSk7cmV0dXJuIHRoaXMucm9vdDt9XG52YXIgY3VycmVudE5vZGU9dGhpcy5yb290LGxlYWZOb2RlPXRoaXMucm9vdCxpc09kZExldmVsPXRydWUsaXNMZXNzVGhhbj10cnVlO3doaWxlKGN1cnJlbnROb2RlIT09bGFzdCl7aWYoaXNPZGRMZXZlbCl7aXNMZXNzVGhhbj1wLng8Y3VycmVudE5vZGUuZ2V0WCgpO31lbHNle2lzTGVzc1RoYW49cC55PGN1cnJlbnROb2RlLmdldFkoKTt9XG5sZWFmTm9kZT1jdXJyZW50Tm9kZTtpZihpc0xlc3NUaGFuKXtjdXJyZW50Tm9kZT1jdXJyZW50Tm9kZS5nZXRMZWZ0KCk7fWVsc2V7Y3VycmVudE5vZGU9Y3VycmVudE5vZGUuZ2V0UmlnaHQoKTt9XG5pZihjdXJyZW50Tm9kZSE9PW51bGwpe3ZhciBpc0luVG9sZXJhbmNlPXAuZGlzdGFuY2UoY3VycmVudE5vZGUuZ2V0Q29vcmRpbmF0ZSgpKTw9dGhpcy50b2xlcmFuY2U7aWYoaXNJblRvbGVyYW5jZSl7Y3VycmVudE5vZGUuaW5jcmVtZW50KCk7cmV0dXJuIGN1cnJlbnROb2RlO319XG5pc09kZExldmVsPSFpc09kZExldmVsO31cbnRoaXMubnVtYmVyT2ZOb2Rlcz1udW1iZXJPZk5vZGVzKzE7dmFyIG5vZGU9bmV3IGpzdHMuaW5kZXgua2R0cmVlLktkTm9kZShwLGRhdGEpO25vZGUuc2V0TGVmdCh0aGlzLmxhc3QpO25vZGUuc2V0UmlnaHQodGhpcy5sYXN0KTtpZihpc0xlc3NUaGFuKXtsZWFmTm9kZS5zZXRMZWZ0KG5vZGUpO31lbHNle2xlYWZOb2RlLnNldFJpZ2h0KG5vZGUpO31cbnJldHVybiBub2RlO307anN0cy5pbmRleC5rZHRyZWUuS2RUcmVlLnByb3RvdHlwZS5xdWVyeU5vZGU9ZnVuY3Rpb24oY3VycmVudE5vZGUsYm90dG9tTm9kZSxxdWVyeUVudixvZGQscmVzdWx0KXtpZihjdXJyZW50Tm9kZT09PWJvdHRvbU5vZGUpe3JldHVybjt9XG52YXIgbWluLG1heCxkaXNjcmltaW5hbnQ7aWYob2RkKXttaW49cXVlcnlFbnYuZ2V0TWluWCgpO21heD1xdWVyeUVudi5nZXRNYXhYKCk7ZGlzY3JpbWluYW50PWN1cnJlbnROb2RlLmdldFgoKTt9ZWxzZXttaW49cXVlcnlFbnYuZ2V0TWluWSgpO21heD1xdWVyeUVudi5nZXRNYXhZKCk7ZGlzY3JpbWluYW50PWN1cnJlbnROb2RlLmdldFkoKTt9XG52YXIgc2VhcmNoTGVmdD1taW48ZGlzY3JpbWluYW50O3ZhciBzZWFyY2hSaWdodD1kaXNjcmltaW5hbnQ8PW1heDtpZihzZWFyY2hMZWZ0KXt0aGlzLnF1ZXJ5Tm9kZShjdXJyZW50Tm9kZS5nZXRMZWZ0KCksYm90dG9tTm9kZSxxdWVyeUVudiwhb2RkLHJlc3VsdCk7fVxuaWYocXVlcnlFbnYuY29udGFpbnMoY3VycmVudE5vZGUuZ2V0Q29vcmRpbmF0ZSgpKSl7cmVzdWx0LmFkZChjdXJyZW50Tm9kZSk7fVxuaWYoc2VhcmNoUmlnaHQpe3RoaXMucXVlcnlOb2RlKGN1cnJlbnROb2RlLmdldFJpZ2h0KCksYm90dG9tTm9kZSxxdWVyeUVudiwhb2RkLHJlc3VsdCk7fX07anN0cy5pbmRleC5rZHRyZWUuS2RUcmVlLnByb3RvdHlwZS5xdWVyeT1mdW5jdGlvbigpe2lmKGFyZ3VtZW50cy5sZW5ndGg9PT0xKXtyZXR1cm4gdGhpcy5xdWVyeUJ5RW52ZWxvcGUuYXBwbHkodGhpcyxhcmd1bWVudHNbMF0pO31lbHNle3JldHVybiB0aGlzLnF1ZXJ5V2l0aEFycmF5LmFwcGx5KHRoaXMsYXJndW1lbnRzWzBdLGFyZ3VtZW50c1sxXSk7fX07anN0cy5pbmRleC5rZHRyZWUuS2RUcmVlLnByb3RvdHlwZS5xdWVyeUJ5RW52ZWxvcGU9ZnVuY3Rpb24ocXVlcnlFbnYpe3ZhciByZXN1bHQ9W107dGhpcy5xdWVyeU5vZGUodGhpcy5yb290LHRoaXMubGFzdCxxdWVyeUVudix0cnVlLHJlc3VsdCk7cmV0dXJuIHJlc3VsdDt9O2pzdHMuaW5kZXgua2R0cmVlLktkVHJlZS5wcm90b3R5cGUucXVlcnlXaXRoQXJyYXk9ZnVuY3Rpb24ocXVlcnlFbnYscmVzdWx0KXt0aGlzLnF1ZXJ5Tm9kZSh0aGlzLnJvb3QsdGhpcy5sYXN0LHF1ZXJ5RW52LHRydWUscmVzdWx0KTt9O2pzdHMuZ2VvbS5UcmlhbmdsZT1mdW5jdGlvbihwMCxwMSxwMil7dGhpcy5wMD1wMDt0aGlzLnAxPXAxO3RoaXMucDI9cDI7fTtqc3RzLmdlb20uVHJpYW5nbGUuaXNBY3V0ZT1mdW5jdGlvbihhLGIsYyl7aWYoIWpzdHMuYWxnb3JpdGhtLkFuZ2xlLmlzQWN1dGUoYSxiLGMpKXtyZXR1cm4gZmFsc2U7fVxuaWYoIWpzdHMuYWxnb3JpdGhtLkFuZ2xlLmlzQWN1dGUoYixjLGEpKXtyZXR1cm4gZmFsc2U7fVxuaWYoIWpzdHMuYWxnb3JpdGhtLkFuZ2xlLmlzQWN1dGUoYyxhLGIpKXtyZXR1cm4gZmFsc2U7fVxucmV0dXJuIHRydWU7fTtqc3RzLmdlb20uVHJpYW5nbGUucGVycGVuZGljdWxhckJpc2VjdG9yPWZ1bmN0aW9uKGEsYil7dmFyIGR4LGR5LGwxLGwyO2R4PWIueC1hLng7ZHk9Yi55LWEueTtsMT1uZXcganN0cy5hbGdvcml0aG0uSENvb3JkaW5hdGUoYS54K2R4LzIuMCxhLnkrZHkvMi4wLDEuMCk7bDI9bmV3IGpzdHMuYWxnb3JpdGhtLkhDb29yZGluYXRlKGEueC1keStkeC8yLjAsYS55K2R4K2R5LzIuMCwxLjApO3JldHVybiBuZXcganN0cy5hbGdvcml0aG0uSENvb3JkaW5hdGUobDEsbDIpO307anN0cy5nZW9tLlRyaWFuZ2xlLmNpcmN1bWNlbnRyZT1mdW5jdGlvbihhLGIsYyl7dmFyIGN4LGN5LGF4LGF5LGJ4LGJ5LGRlbm9tLG51bXgsbnVteSxjY3gsY2N5O2N4PWMueDtjeT1jLnk7YXg9YS54LWN4O2F5PWEueS1jeTtieD1iLngtY3g7Ynk9Yi55LWN5O2Rlbm9tPTIqanN0cy5nZW9tLlRyaWFuZ2xlLmRldChheCxheSxieCxieSk7bnVteD1qc3RzLmdlb20uVHJpYW5nbGUuZGV0KGF5LGF4KmF4K2F5KmF5LGJ5LGJ4KmJ4K2J5KmJ5KTtudW15PWpzdHMuZ2VvbS5UcmlhbmdsZS5kZXQoYXgsYXgqYXgrYXkqYXksYngsYngqYngrYnkqYnkpO2NjeD1jeC1udW14L2Rlbm9tO2NjeT1jeStudW15L2Rlbm9tO3JldHVybiBuZXcganN0cy5nZW9tLkNvb3JkaW5hdGUoY2N4LGNjeSk7fTtqc3RzLmdlb20uVHJpYW5nbGUuZGV0PWZ1bmN0aW9uKG0wMCxtMDEsbTEwLG0xMSl7cmV0dXJuIG0wMCptMTEtbTAxKm0xMDt9O2pzdHMuZ2VvbS5UcmlhbmdsZS5pbkNlbnRyZT1mdW5jdGlvbihhLGIsYyl7dmFyIGxlbjAsbGVuMSxsZW4yLGNpcmN1bSxpbkNlbnRyZVgsaW5DZW50cmVZO2xlbjA9Yi5kaXN0YW5jZShjKTtsZW4xPWEuZGlzdGFuY2UoYyk7bGVuMj1hLmRpc3RhbmNlKGIpO2NpcmN1bT1sZW4wK2xlbjErbGVuMjtpbkNlbnRyZVg9KGxlbjAqYS54K2xlbjEqYi54K2xlbjIqYy54KS9jaXJjdW07aW5DZW50cmVZPShsZW4wKmEueStsZW4xKmIueStsZW4yKmMueSkvY2lyY3VtO3JldHVybiBuZXcganN0cy5nZW9tLkNvb3JkaW5hdGUoaW5DZW50cmVYLGluQ2VudHJlWSk7fTtqc3RzLmdlb20uVHJpYW5nbGUuY2VudHJvaWQ9ZnVuY3Rpb24oYSxiLGMpe3ZhciB4LHk7eD0oYS54K2IueCtjLngpLzM7eT0oYS55K2IueStjLnkpLzM7cmV0dXJuIG5ldyBqc3RzLmdlb20uQ29vcmRpbmF0ZSh4LHkpO307anN0cy5nZW9tLlRyaWFuZ2xlLmxvbmdlc3RTaWRlTGVuZ3RoPWZ1bmN0aW9uKGEsYixjKXt2YXIgbGVuQUIsbGVuQkMsbGVuQ0EsbWF4TGVuO2xlbkFCPWEuZGlzdGFuY2UoYik7bGVuQkM9Yi5kaXN0YW5jZShjKTtsZW5DQT1jLmRpc3RhbmNlKGEpO21heExlbj1sZW5BQjtpZihsZW5CQz5tYXhMZW4pe21heExlbj1sZW5CQzt9XG5pZihsZW5DQT5tYXhMZW4pe21heExlbj1sZW5DQTt9XG5yZXR1cm4gbWF4TGVuO307anN0cy5nZW9tLlRyaWFuZ2xlLmFuZ2xlQmlzZWN0b3I9ZnVuY3Rpb24oYSxiLGMpe3ZhciBsZW4wLGxlbjIsZnJhYyxkeCxkeSxzcGxpdFB0O2xlbjA9Yi5kaXN0YW5jZShhKTtsZW4yPWIuZGlzdGFuY2UoYyk7ZnJhYz1sZW4wLyhsZW4wK2xlbjIpO2R4PWMueC1hLng7ZHk9Yy55LWEueTtzcGxpdFB0PW5ldyBqc3RzLmdlb20uQ29vcmRpbmF0ZShhLngrZnJhYypkeCxhLnkrZnJhYypkeSk7cmV0dXJuIHNwbGl0UHQ7fTtqc3RzLmdlb20uVHJpYW5nbGUuYXJlYT1mdW5jdGlvbihhLGIsYyl7cmV0dXJuIE1hdGguYWJzKCgoYy54LWEueCkqKGIueS1hLnkpLShiLngtYS54KSooYy55LWEueSkpLzIuMCk7fTtqc3RzLmdlb20uVHJpYW5nbGUuc2lnbmVkQXJlYT1mdW5jdGlvbihhLGIsYyl7cmV0dXJuKChjLngtYS54KSooYi55LWEueSktKGIueC1hLngpKihjLnktYS55KSkvMi4wO307anN0cy5nZW9tLlRyaWFuZ2xlLnByb3RvdHlwZS5pbkNlbnRyZT1mdW5jdGlvbigpe3JldHVybiBqc3RzLmdlb20uVHJpYW5nbGUuaW5DZW50cmUodGhpcy5wMCx0aGlzLnAxLHRoaXMucDIpO307anN0cy5ub2RpbmcuT3JpZW50ZWRDb29yZGluYXRlQXJyYXk9ZnVuY3Rpb24ocHRzKXt0aGlzLnB0cz1wdHM7dGhpcy5fb3JpZW50YXRpb249anN0cy5ub2RpbmcuT3JpZW50ZWRDb29yZGluYXRlQXJyYXkub3JpZW50YXRpb24ocHRzKTt9O2pzdHMubm9kaW5nLk9yaWVudGVkQ29vcmRpbmF0ZUFycmF5LnByb3RvdHlwZS5wdHM9bnVsbDtqc3RzLm5vZGluZy5PcmllbnRlZENvb3JkaW5hdGVBcnJheS5wcm90b3R5cGUuX29yaWVudGF0aW9uPXVuZGVmaW5lZDtqc3RzLm5vZGluZy5PcmllbnRlZENvb3JkaW5hdGVBcnJheS5vcmllbnRhdGlvbj1mdW5jdGlvbihwdHMpe3JldHVybiBqc3RzLmdlb20uQ29vcmRpbmF0ZUFycmF5cy5pbmNyZWFzaW5nRGlyZWN0aW9uKHB0cyk9PT0xO307anN0cy5ub2RpbmcuT3JpZW50ZWRDb29yZGluYXRlQXJyYXkucHJvdG90eXBlLmNvbXBhcmVUbz1mdW5jdGlvbihvMSl7dmFyIG9jYT1vMTt2YXIgY29tcD1qc3RzLm5vZGluZy5PcmllbnRlZENvb3JkaW5hdGVBcnJheS5jb21wYXJlT3JpZW50ZWQodGhpcy5wdHMsdGhpcy5fb3JpZW50YXRpb24sb2NhLnB0cyxvY2EuX29yaWVudGF0aW9uKTtyZXR1cm4gY29tcDt9O2pzdHMubm9kaW5nLk9yaWVudGVkQ29vcmRpbmF0ZUFycmF5LmNvbXBhcmVPcmllbnRlZD1mdW5jdGlvbihwdHMxLG9yaWVudGF0aW9uMSxwdHMyLG9yaWVudGF0aW9uMil7dmFyIGRpcjE9b3JpZW50YXRpb24xPzE6LTE7dmFyIGRpcjI9b3JpZW50YXRpb24yPzE6LTE7dmFyIGxpbWl0MT1vcmllbnRhdGlvbjE/cHRzMS5sZW5ndGg6LTE7dmFyIGxpbWl0Mj1vcmllbnRhdGlvbjI/cHRzMi5sZW5ndGg6LTE7dmFyIGkxPW9yaWVudGF0aW9uMT8wOnB0czEubGVuZ3RoLTE7dmFyIGkyPW9yaWVudGF0aW9uMj8wOnB0czIubGVuZ3RoLTE7dmFyIGNvbXA9MDt3aGlsZSh0cnVlKXt2YXIgY29tcFB0PXB0czFbaTFdLmNvbXBhcmVUbyhwdHMyW2kyXSk7aWYoY29tcFB0IT09MClcbnJldHVybiBjb21wUHQ7aTErPWRpcjE7aTIrPWRpcjI7dmFyIGRvbmUxPWkxPT09bGltaXQxO3ZhciBkb25lMj1pMj09PWxpbWl0MjtpZihkb25lMSYmIWRvbmUyKVxucmV0dXJuLTE7aWYoIWRvbmUxJiZkb25lMilcbnJldHVybiAxO2lmKGRvbmUxJiZkb25lMilcbnJldHVybiAwO319O2pzdHMuYWxnb3JpdGhtLkNlbnRyYWxFbmRwb2ludEludGVyc2VjdG9yPWZ1bmN0aW9uKHAwMCxwMDEscDEwLHAxMSl7dGhpcy5wdHM9W3AwMCxwMDEscDEwLHAxMV07dGhpcy5jb21wdXRlKCk7fTtqc3RzLmFsZ29yaXRobS5DZW50cmFsRW5kcG9pbnRJbnRlcnNlY3Rvci5nZXRJbnRlcnNlY3Rpb249ZnVuY3Rpb24ocDAwLHAwMSxwMTAscDExKXt2YXIgaW50b3I9bmV3IGpzdHMuYWxnb3JpdGhtLkNlbnRyYWxFbmRwb2ludEludGVyc2VjdG9yKHAwMCxwMDEscDEwLHAxMSk7cmV0dXJuIGludG9yLmdldEludGVyc2VjdGlvbigpO307anN0cy5hbGdvcml0aG0uQ2VudHJhbEVuZHBvaW50SW50ZXJzZWN0b3IucHJvdG90eXBlLnB0cz1udWxsO2pzdHMuYWxnb3JpdGhtLkNlbnRyYWxFbmRwb2ludEludGVyc2VjdG9yLnByb3RvdHlwZS5pbnRQdD1udWxsO2pzdHMuYWxnb3JpdGhtLkNlbnRyYWxFbmRwb2ludEludGVyc2VjdG9yLnByb3RvdHlwZS5jb21wdXRlPWZ1bmN0aW9uKCl7dmFyIGNlbnRyb2lkPWpzdHMuYWxnb3JpdGhtLkNlbnRyYWxFbmRwb2ludEludGVyc2VjdG9yLmF2ZXJhZ2UodGhpcy5wdHMpO3RoaXMuaW50UHQ9dGhpcy5maW5kTmVhcmVzdFBvaW50KGNlbnRyb2lkLHRoaXMucHRzKTt9O2pzdHMuYWxnb3JpdGhtLkNlbnRyYWxFbmRwb2ludEludGVyc2VjdG9yLnByb3RvdHlwZS5nZXRJbnRlcnNlY3Rpb249ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5pbnRQdDt9O2pzdHMuYWxnb3JpdGhtLkNlbnRyYWxFbmRwb2ludEludGVyc2VjdG9yLmF2ZXJhZ2U9ZnVuY3Rpb24ocHRzKXt2YXIgYXZnPW5ldyBqc3RzLmdlb20uQ29vcmRpbmF0ZSgpO3ZhciBpLG49cHRzLmxlbmd0aDtmb3IoaT0wO2k8bjtpKyspe2F2Zy54Kz1wdHNbaV0ueDthdmcueSs9cHRzW2ldLnk7fVxuaWYobj4wKXthdmcueC89bjthdmcueS89bjt9XG5yZXR1cm4gYXZnO307anN0cy5hbGdvcml0aG0uQ2VudHJhbEVuZHBvaW50SW50ZXJzZWN0b3IucHJvdG90eXBlLmZpbmROZWFyZXN0UG9pbnQ9ZnVuY3Rpb24ocCxwdHMpe3ZhciBtaW5EaXN0PU51bWJlci5NQVhfVkFMVUU7dmFyIGkscmVzdWx0PW51bGwsZGlzdDtmb3IoaT0wO2k8cHRzLmxlbmd0aDtpKyspe2Rpc3Q9cC5kaXN0YW5jZShwdHNbaV0pO2lmKGRpc3Q8bWluRGlzdCl7bWluRGlzdD1kaXN0O3Jlc3VsdD1wdHNbaV07fX1cbnJldHVybiByZXN1bHQ7fTtqc3RzLm9wZXJhdGlvbi5idWZmZXIuQnVmZmVyT3A9ZnVuY3Rpb24oZyxidWZQYXJhbXMpe3RoaXMuYXJnR2VvbT1nO3RoaXMuYnVmUGFyYW1zPWJ1ZlBhcmFtcz9idWZQYXJhbXM6bmV3IGpzdHMub3BlcmF0aW9uLmJ1ZmZlci5CdWZmZXJQYXJhbWV0ZXJzKCk7fTtqc3RzLm9wZXJhdGlvbi5idWZmZXIuQnVmZmVyT3AuTUFYX1BSRUNJU0lPTl9ESUdJVFM9MTI7anN0cy5vcGVyYXRpb24uYnVmZmVyLkJ1ZmZlck9wLnByZWNpc2lvblNjYWxlRmFjdG9yPWZ1bmN0aW9uKGcsZGlzdGFuY2UsbWF4UHJlY2lzaW9uRGlnaXRzKXt2YXIgZW52PWcuZ2V0RW52ZWxvcGVJbnRlcm5hbCgpO3ZhciBlbnZTaXplPU1hdGgubWF4KGVudi5nZXRIZWlnaHQoKSxlbnYuZ2V0V2lkdGgoKSk7dmFyIGV4cGFuZEJ5RGlzdGFuY2U9ZGlzdGFuY2U+MC4wP2Rpc3RhbmNlOjAuMDt2YXIgYnVmRW52U2l6ZT1lbnZTaXplKzIqZXhwYW5kQnlEaXN0YW5jZTt2YXIgYnVmRW52TG9nMTA9KE1hdGgubG9nKGJ1ZkVudlNpemUpL01hdGgubG9nKDEwKSsxLjApO3ZhciBtaW5Vbml0TG9nMTA9YnVmRW52TG9nMTAtbWF4UHJlY2lzaW9uRGlnaXRzO3ZhciBzY2FsZUZhY3Rvcj1NYXRoLnBvdygxMC4wLC1taW5Vbml0TG9nMTApO3JldHVybiBzY2FsZUZhY3Rvcjt9O2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5CdWZmZXJPcC5idWZmZXJPcD1mdW5jdGlvbihnLGRpc3RhbmNlKXtpZihhcmd1bWVudHMubGVuZ3RoPjIpe3JldHVybiBqc3RzLm9wZXJhdGlvbi5idWZmZXIuQnVmZmVyT3AuYnVmZmVyT3AyLmFwcGx5KHRoaXMsYXJndW1lbnRzKTt9XG52YXIgZ0J1Zj1uZXcganN0cy5vcGVyYXRpb24uYnVmZmVyLkJ1ZmZlck9wKGcpO3ZhciBnZW9tQnVmPWdCdWYuZ2V0UmVzdWx0R2VvbWV0cnkoZGlzdGFuY2UpO3JldHVybiBnZW9tQnVmO307anN0cy5vcGVyYXRpb24uYnVmZmVyLkJ1ZmZlck9wLmJ1ZmZlck9wMj1mdW5jdGlvbihnLGRpc3RhbmNlLHBhcmFtcyl7aWYoYXJndW1lbnRzLmxlbmd0aD4zKXtyZXR1cm4ganN0cy5vcGVyYXRpb24uYnVmZmVyLkJ1ZmZlck9wLmJ1ZmZlck9wMy5hcHBseSh0aGlzLGFyZ3VtZW50cyk7fVxudmFyIGJ1Zk9wPW5ldyBqc3RzLm9wZXJhdGlvbi5idWZmZXIuQnVmZmVyT3AoZyxwYXJhbXMpO3ZhciBnZW9tQnVmPWJ1Zk9wLmdldFJlc3VsdEdlb21ldHJ5KGRpc3RhbmNlKTtyZXR1cm4gZ2VvbUJ1Zjt9O2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5CdWZmZXJPcC5idWZmZXJPcDM9ZnVuY3Rpb24oZyxkaXN0YW5jZSxxdWFkcmFudFNlZ21lbnRzKXtpZihhcmd1bWVudHMubGVuZ3RoPjQpe3JldHVybiBqc3RzLm9wZXJhdGlvbi5idWZmZXIuQnVmZmVyT3AuYnVmZmVyT3A0LmFwcGx5KHRoaXMsYXJndW1lbnRzKTt9XG52YXIgYnVmT3A9bmV3IGpzdHMub3BlcmF0aW9uLmJ1ZmZlci5CdWZmZXJPcChnKTtidWZPcC5zZXRRdWFkcmFudFNlZ21lbnRzKHF1YWRyYW50U2VnbWVudHMpO3ZhciBnZW9tQnVmPWJ1Zk9wLmdldFJlc3VsdEdlb21ldHJ5KGRpc3RhbmNlKTtyZXR1cm4gZ2VvbUJ1Zjt9O2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5CdWZmZXJPcC5idWZmZXJPcDQ9ZnVuY3Rpb24oZyxkaXN0YW5jZSxxdWFkcmFudFNlZ21lbnRzLGVuZENhcFN0eWxlKXt2YXIgYnVmT3A9bmV3IGpzdHMub3BlcmF0aW9uLmJ1ZmZlci5CdWZmZXJPcChnKTtidWZPcC5zZXRRdWFkcmFudFNlZ21lbnRzKHF1YWRyYW50U2VnbWVudHMpO2J1Zk9wLnNldEVuZENhcFN0eWxlKGVuZENhcFN0eWxlKTt2YXIgZ2VvbUJ1Zj1idWZPcC5nZXRSZXN1bHRHZW9tZXRyeShkaXN0YW5jZSk7cmV0dXJuIGdlb21CdWY7fTtqc3RzLm9wZXJhdGlvbi5idWZmZXIuQnVmZmVyT3AucHJvdG90eXBlLmFyZ0dlb209bnVsbDtqc3RzLm9wZXJhdGlvbi5idWZmZXIuQnVmZmVyT3AucHJvdG90eXBlLmRpc3RhbmNlPW51bGw7anN0cy5vcGVyYXRpb24uYnVmZmVyLkJ1ZmZlck9wLnByb3RvdHlwZS5idWZQYXJhbXM9bnVsbDtqc3RzLm9wZXJhdGlvbi5idWZmZXIuQnVmZmVyT3AucHJvdG90eXBlLnJlc3VsdEdlb21ldHJ5PW51bGw7anN0cy5vcGVyYXRpb24uYnVmZmVyLkJ1ZmZlck9wLnByb3RvdHlwZS5zZXRFbmRDYXBTdHlsZT1mdW5jdGlvbihlbmRDYXBTdHlsZSl7dGhpcy5idWZQYXJhbXMuc2V0RW5kQ2FwU3R5bGUoZW5kQ2FwU3R5bGUpO307anN0cy5vcGVyYXRpb24uYnVmZmVyLkJ1ZmZlck9wLnByb3RvdHlwZS5zZXRRdWFkcmFudFNlZ21lbnRzPWZ1bmN0aW9uKHF1YWRyYW50U2VnbWVudHMpe3RoaXMuYnVmUGFyYW1zLnNldFF1YWRyYW50U2VnbWVudHMocXVhZHJhbnRTZWdtZW50cyk7fTtqc3RzLm9wZXJhdGlvbi5idWZmZXIuQnVmZmVyT3AucHJvdG90eXBlLmdldFJlc3VsdEdlb21ldHJ5PWZ1bmN0aW9uKGRpc3Qpe3RoaXMuZGlzdGFuY2U9ZGlzdDt0aGlzLmNvbXB1dGVHZW9tZXRyeSgpO3JldHVybiB0aGlzLnJlc3VsdEdlb21ldHJ5O307anN0cy5vcGVyYXRpb24uYnVmZmVyLkJ1ZmZlck9wLnByb3RvdHlwZS5jb21wdXRlR2VvbWV0cnk9ZnVuY3Rpb24oKXt0aGlzLmJ1ZmZlck9yaWdpbmFsUHJlY2lzaW9uKCk7aWYodGhpcy5yZXN1bHRHZW9tZXRyeSE9PW51bGwpe3JldHVybjt9XG52YXIgYXJnUE09dGhpcy5hcmdHZW9tLmdldFByZWNpc2lvbk1vZGVsKCk7aWYoYXJnUE0uZ2V0VHlwZSgpPT09anN0cy5nZW9tLlByZWNpc2lvbk1vZGVsLkZJWEVEKXt0aGlzLmJ1ZmZlckZpeGVkUHJlY2lzaW9uKGFyZ1BNKTt9ZWxzZXt0aGlzLmJ1ZmZlclJlZHVjZWRQcmVjaXNpb24oKTt9fTtqc3RzLm9wZXJhdGlvbi5idWZmZXIuQnVmZmVyT3AucHJvdG90eXBlLmJ1ZmZlclJlZHVjZWRQcmVjaXNpb249ZnVuY3Rpb24oKXt2YXIgcHJlY0RpZ2l0czt2YXIgc2F2ZUV4Y2VwdGlvbj1udWxsO2ZvcihwcmVjRGlnaXRzPWpzdHMub3BlcmF0aW9uLmJ1ZmZlci5CdWZmZXJPcC5NQVhfUFJFQ0lTSU9OX0RJR0lUUztwcmVjRGlnaXRzPj0wO3ByZWNEaWdpdHMtLSl7dHJ5e3RoaXMuYnVmZmVyUmVkdWNlZFByZWNpc2lvbjIocHJlY0RpZ2l0cyk7fWNhdGNoKGV4KXtzYXZlRXhjZXB0aW9uPWV4O31cbmlmKHRoaXMucmVzdWx0R2VvbWV0cnkhPT1udWxsKXtyZXR1cm47fX1cbnRocm93IHNhdmVFeGNlcHRpb247fTtqc3RzLm9wZXJhdGlvbi5idWZmZXIuQnVmZmVyT3AucHJvdG90eXBlLmJ1ZmZlck9yaWdpbmFsUHJlY2lzaW9uPWZ1bmN0aW9uKCl7dHJ5e3ZhciBidWZCdWlsZGVyPW5ldyBqc3RzLm9wZXJhdGlvbi5idWZmZXIuQnVmZmVyQnVpbGRlcih0aGlzLmJ1ZlBhcmFtcyk7dGhpcy5yZXN1bHRHZW9tZXRyeT1idWZCdWlsZGVyLmJ1ZmZlcih0aGlzLmFyZ0dlb20sdGhpcy5kaXN0YW5jZSk7fWNhdGNoKGUpe319O2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5CdWZmZXJPcC5wcm90b3R5cGUuYnVmZmVyUmVkdWNlZFByZWNpc2lvbjI9ZnVuY3Rpb24ocHJlY2lzaW9uRGlnaXRzKXt2YXIgc2l6ZUJhc2VkU2NhbGVGYWN0b3I9anN0cy5vcGVyYXRpb24uYnVmZmVyLkJ1ZmZlck9wLnByZWNpc2lvblNjYWxlRmFjdG9yKHRoaXMuYXJnR2VvbSx0aGlzLmRpc3RhbmNlLHByZWNpc2lvbkRpZ2l0cyk7dmFyIGZpeGVkUE09bmV3IGpzdHMuZ2VvbS5QcmVjaXNpb25Nb2RlbChzaXplQmFzZWRTY2FsZUZhY3Rvcik7dGhpcy5idWZmZXJGaXhlZFByZWNpc2lvbihmaXhlZFBNKTt9O2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5CdWZmZXJPcC5wcm90b3R5cGUuYnVmZmVyRml4ZWRQcmVjaXNpb249ZnVuY3Rpb24oZml4ZWRQTSl7dmFyIG5vZGVyPW5ldyBqc3RzLm5vZGluZy5TY2FsZWROb2RlcihuZXcganN0cy5ub2Rpbmcuc25hcHJvdW5kLk1DSW5kZXhTbmFwUm91bmRlcihuZXcganN0cy5nZW9tLlByZWNpc2lvbk1vZGVsKDEuMCkpLGZpeGVkUE0uZ2V0U2NhbGUoKSk7dmFyIGJ1ZkJ1aWxkZXI9bmV3IGpzdHMub3BlcmF0aW9uLmJ1ZmZlci5CdWZmZXJCdWlsZGVyKHRoaXMuYnVmUGFyYW1zKTtidWZCdWlsZGVyLnNldFdvcmtpbmdQcmVjaXNpb25Nb2RlbChmaXhlZFBNKTtidWZCdWlsZGVyLnNldE5vZGVyKG5vZGVyKTt0aGlzLnJlc3VsdEdlb21ldHJ5PWJ1ZkJ1aWxkZXIuYnVmZmVyKHRoaXMuYXJnR2VvbSx0aGlzLmRpc3RhbmNlKTt9OyhmdW5jdGlvbigpe3ZhciBMb2NhdGlvbj1qc3RzLmdlb20uTG9jYXRpb247dmFyIFBvc2l0aW9uPWpzdHMuZ2VvbWdyYXBoLlBvc2l0aW9uO3ZhciBBc3NlcnQ9anN0cy51dGlsLkFzc2VydDtqc3RzLmdlb21ncmFwaC5HZW9tZXRyeUdyYXBoPWZ1bmN0aW9uKGFyZ0luZGV4LHBhcmVudEdlb20sYm91bmRhcnlOb2RlUnVsZSl7anN0cy5nZW9tZ3JhcGguUGxhbmFyR3JhcGguY2FsbCh0aGlzKTt0aGlzLmxpbmVFZGdlTWFwPW5ldyBqYXZhc2NyaXB0LnV0aWwuSGFzaE1hcCgpO3RoaXMucHRMb2NhdG9yPW5ldyBqc3RzLmFsZ29yaXRobS5Qb2ludExvY2F0b3IoKTt0aGlzLmFyZ0luZGV4PWFyZ0luZGV4O3RoaXMucGFyZW50R2VvbT1wYXJlbnRHZW9tO3RoaXMuYm91bmRhcnlOb2RlUnVsZT1ib3VuZGFyeU5vZGVSdWxlfHxqc3RzLmFsZ29yaXRobS5Cb3VuZGFyeU5vZGVSdWxlLk9HQ19TRlNfQk9VTkRBUllfUlVMRTtpZihwYXJlbnRHZW9tIT09bnVsbCl7dGhpcy5hZGQocGFyZW50R2VvbSk7fX07anN0cy5nZW9tZ3JhcGguR2VvbWV0cnlHcmFwaC5wcm90b3R5cGU9bmV3IGpzdHMuZ2VvbWdyYXBoLlBsYW5hckdyYXBoKCk7anN0cy5nZW9tZ3JhcGguR2VvbWV0cnlHcmFwaC5jb25zdHJ1Y3Rvcj1qc3RzLmdlb21ncmFwaC5HZW9tZXRyeUdyYXBoO2pzdHMuZ2VvbWdyYXBoLkdlb21ldHJ5R3JhcGgucHJvdG90eXBlLmNyZWF0ZUVkZ2VTZXRJbnRlcnNlY3Rvcj1mdW5jdGlvbigpe3JldHVybiBuZXcganN0cy5nZW9tZ3JhcGguaW5kZXguU2ltcGxlTUNTd2VlcExpbmVJbnRlcnNlY3RvcigpO307anN0cy5nZW9tZ3JhcGguR2VvbWV0cnlHcmFwaC5kZXRlcm1pbmVCb3VuZGFyeT1mdW5jdGlvbihib3VuZGFyeU5vZGVSdWxlLGJvdW5kYXJ5Q291bnQpe3JldHVybiBib3VuZGFyeU5vZGVSdWxlLmlzSW5Cb3VuZGFyeShib3VuZGFyeUNvdW50KT9Mb2NhdGlvbi5CT1VOREFSWTpMb2NhdGlvbi5JTlRFUklPUjt9O2pzdHMuZ2VvbWdyYXBoLkdlb21ldHJ5R3JhcGgucHJvdG90eXBlLnBhcmVudEdlb209bnVsbDtqc3RzLmdlb21ncmFwaC5HZW9tZXRyeUdyYXBoLnByb3RvdHlwZS5saW5lRWRnZU1hcD1udWxsO2pzdHMuZ2VvbWdyYXBoLkdlb21ldHJ5R3JhcGgucHJvdG90eXBlLmJvdW5kYXJ5Tm9kZVJ1bGU9bnVsbDtqc3RzLmdlb21ncmFwaC5HZW9tZXRyeUdyYXBoLnByb3RvdHlwZS51c2VCb3VuZGFyeURldGVybWluYXRpb25SdWxlPXRydWU7anN0cy5nZW9tZ3JhcGguR2VvbWV0cnlHcmFwaC5wcm90b3R5cGUuYXJnSW5kZXg9bnVsbDtqc3RzLmdlb21ncmFwaC5HZW9tZXRyeUdyYXBoLnByb3RvdHlwZS5ib3VuZGFyeU5vZGVzPW51bGw7anN0cy5nZW9tZ3JhcGguR2VvbWV0cnlHcmFwaC5wcm90b3R5cGUuaGFzVG9vRmV3UG9pbnRzPWZhbHNlO2pzdHMuZ2VvbWdyYXBoLkdlb21ldHJ5R3JhcGgucHJvdG90eXBlLmludmFsaWRQb2ludD1udWxsO2pzdHMuZ2VvbWdyYXBoLkdlb21ldHJ5R3JhcGgucHJvdG90eXBlLmFyZWFQdExvY2F0b3I9bnVsbDtqc3RzLmdlb21ncmFwaC5HZW9tZXRyeUdyYXBoLnByb3RvdHlwZS5wdExvY2F0b3I9bnVsbDtqc3RzLmdlb21ncmFwaC5HZW9tZXRyeUdyYXBoLnByb3RvdHlwZS5nZXRHZW9tZXRyeT1mdW5jdGlvbigpe3JldHVybiB0aGlzLnBhcmVudEdlb207fTtqc3RzLmdlb21ncmFwaC5HZW9tZXRyeUdyYXBoLnByb3RvdHlwZS5nZXRCb3VuZGFyeU5vZGVzPWZ1bmN0aW9uKCl7aWYodGhpcy5ib3VuZGFyeU5vZGVzPT09bnVsbClcbnRoaXMuYm91bmRhcnlOb2Rlcz10aGlzLm5vZGVzLmdldEJvdW5kYXJ5Tm9kZXModGhpcy5hcmdJbmRleCk7cmV0dXJuIHRoaXMuYm91bmRhcnlOb2Rlczt9O2pzdHMuZ2VvbWdyYXBoLkdlb21ldHJ5R3JhcGgucHJvdG90eXBlLmdldEJvdW5kYXJ5Tm9kZVJ1bGU9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5ib3VuZGFyeU5vZGVSdWxlO307anN0cy5nZW9tZ3JhcGguR2VvbWV0cnlHcmFwaC5wcm90b3R5cGUuZmluZEVkZ2U9ZnVuY3Rpb24obGluZSl7cmV0dXJuIHRoaXMubGluZUVkZ2VNYXAuZ2V0KGxpbmUpO307anN0cy5nZW9tZ3JhcGguR2VvbWV0cnlHcmFwaC5wcm90b3R5cGUuY29tcHV0ZVNwbGl0RWRnZXM9ZnVuY3Rpb24oZWRnZWxpc3Qpe2Zvcih2YXIgaT10aGlzLmVkZ2VzLml0ZXJhdG9yKCk7aS5oYXNOZXh0KCk7KXt2YXIgZT1pLm5leHQoKTtlLmVpTGlzdC5hZGRTcGxpdEVkZ2VzKGVkZ2VsaXN0KTt9fVxuanN0cy5nZW9tZ3JhcGguR2VvbWV0cnlHcmFwaC5wcm90b3R5cGUuYWRkPWZ1bmN0aW9uKGcpe2lmKGcuaXNFbXB0eSgpKXtyZXR1cm47fVxuaWYoZyBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5NdWx0aVBvbHlnb24pXG50aGlzLnVzZUJvdW5kYXJ5RGV0ZXJtaW5hdGlvblJ1bGU9ZmFsc2U7aWYoZyBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5Qb2x5Z29uKVxudGhpcy5hZGRQb2x5Z29uKGcpO2Vsc2UgaWYoZyBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5MaW5lU3RyaW5nKVxudGhpcy5hZGRMaW5lU3RyaW5nKGcpO2Vsc2UgaWYoZyBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5Qb2ludClcbnRoaXMuYWRkUG9pbnQoZyk7ZWxzZSBpZihnIGluc3RhbmNlb2YganN0cy5nZW9tLk11bHRpUG9pbnQpXG50aGlzLmFkZENvbGxlY3Rpb24oZyk7ZWxzZSBpZihnIGluc3RhbmNlb2YganN0cy5nZW9tLk11bHRpTGluZVN0cmluZylcbnRoaXMuYWRkQ29sbGVjdGlvbihnKTtlbHNlIGlmKGcgaW5zdGFuY2VvZiBqc3RzLmdlb20uTXVsdGlQb2x5Z29uKVxudGhpcy5hZGRDb2xsZWN0aW9uKGcpO2Vsc2UgaWYoZyBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5HZW9tZXRyeUNvbGxlY3Rpb24pXG50aGlzLmFkZENvbGxlY3Rpb24oZyk7ZWxzZVxudGhyb3cgbmV3IGpzdHMuZXJyb3IuSWxsZWdhbEFyZ3VtZW50RXJyb3IoJ0dlb21ldHJ5IHR5cGUgbm90IHN1cHBvcnRlZC4nKTt9O2pzdHMuZ2VvbWdyYXBoLkdlb21ldHJ5R3JhcGgucHJvdG90eXBlLmFkZENvbGxlY3Rpb249ZnVuY3Rpb24oZ2Mpe2Zvcih2YXIgaT0wO2k8Z2MuZ2V0TnVtR2VvbWV0cmllcygpO2krKyl7dmFyIGc9Z2MuZ2V0R2VvbWV0cnlOKGkpO3RoaXMuYWRkKGcpO319O2pzdHMuZ2VvbWdyYXBoLkdlb21ldHJ5R3JhcGgucHJvdG90eXBlLmFkZEVkZ2U9ZnVuY3Rpb24oZSl7dGhpcy5pbnNlcnRFZGdlKGUpO3ZhciBjb29yZD1lLmdldENvb3JkaW5hdGVzKCk7dGhpcy5pbnNlcnRQb2ludCh0aGlzLmFyZ0luZGV4LGNvb3JkWzBdLExvY2F0aW9uLkJPVU5EQVJZKTt0aGlzLmluc2VydFBvaW50KHRoaXMuYXJnSW5kZXgsY29vcmRbY29vcmQubGVuZ3RoLTFdLExvY2F0aW9uLkJPVU5EQVJZKTt9O2pzdHMuZ2VvbWdyYXBoLkdlb21ldHJ5R3JhcGgucHJvdG90eXBlLmFkZFBvaW50PWZ1bmN0aW9uKHApe3ZhciBjb29yZD1wLmdldENvb3JkaW5hdGUoKTt0aGlzLmluc2VydFBvaW50KHRoaXMuYXJnSW5kZXgsY29vcmQsTG9jYXRpb24uSU5URVJJT1IpO307anN0cy5nZW9tZ3JhcGguR2VvbWV0cnlHcmFwaC5wcm90b3R5cGUuYWRkTGluZVN0cmluZz1mdW5jdGlvbihsaW5lKXt2YXIgY29vcmQ9anN0cy5nZW9tLkNvb3JkaW5hdGVBcnJheXMucmVtb3ZlUmVwZWF0ZWRQb2ludHMobGluZS5nZXRDb29yZGluYXRlcygpKTtpZihjb29yZC5sZW5ndGg8Mil7dGhpcy5oYXNUb29GZXdQb2ludHM9dHJ1ZTt0aGlzLmludmFsaWRQb2ludD1jb29yZHNbMF07cmV0dXJuO31cbnZhciBlPW5ldyBqc3RzLmdlb21ncmFwaC5FZGdlKGNvb3JkLG5ldyBqc3RzLmdlb21ncmFwaC5MYWJlbCh0aGlzLmFyZ0luZGV4LExvY2F0aW9uLklOVEVSSU9SKSk7dGhpcy5saW5lRWRnZU1hcC5wdXQobGluZSxlKTt0aGlzLmluc2VydEVkZ2UoZSk7QXNzZXJ0LmlzVHJ1ZShjb29yZC5sZW5ndGg+PTIsJ2ZvdW5kIExpbmVTdHJpbmcgd2l0aCBzaW5nbGUgcG9pbnQnKTt0aGlzLmluc2VydEJvdW5kYXJ5UG9pbnQodGhpcy5hcmdJbmRleCxjb29yZFswXSk7dGhpcy5pbnNlcnRCb3VuZGFyeVBvaW50KHRoaXMuYXJnSW5kZXgsY29vcmRbY29vcmQubGVuZ3RoLTFdKTt9O2pzdHMuZ2VvbWdyYXBoLkdlb21ldHJ5R3JhcGgucHJvdG90eXBlLmFkZFBvbHlnb25SaW5nPWZ1bmN0aW9uKGxyLGN3TGVmdCxjd1JpZ2h0KXtpZihsci5pc0VtcHR5KCkpXG5yZXR1cm47dmFyIGNvb3JkPWpzdHMuZ2VvbS5Db29yZGluYXRlQXJyYXlzLnJlbW92ZVJlcGVhdGVkUG9pbnRzKGxyLmdldENvb3JkaW5hdGVzKCkpO2lmKGNvb3JkLmxlbmd0aDw0KXt0aGlzLmhhc1Rvb0Zld1BvaW50cz10cnVlO3RoaXMuaW52YWxpZFBvaW50PWNvb3JkWzBdO3JldHVybjt9XG52YXIgbGVmdD1jd0xlZnQ7dmFyIHJpZ2h0PWN3UmlnaHQ7aWYoanN0cy5hbGdvcml0aG0uQ0dBbGdvcml0aG1zLmlzQ0NXKGNvb3JkKSl7bGVmdD1jd1JpZ2h0O3JpZ2h0PWN3TGVmdDt9XG52YXIgZT1uZXcganN0cy5nZW9tZ3JhcGguRWRnZShjb29yZCxuZXcganN0cy5nZW9tZ3JhcGguTGFiZWwodGhpcy5hcmdJbmRleCxMb2NhdGlvbi5CT1VOREFSWSxsZWZ0LHJpZ2h0KSk7dGhpcy5saW5lRWRnZU1hcC5wdXQobHIsZSk7dGhpcy5pbnNlcnRFZGdlKGUpO3RoaXMuaW5zZXJ0UG9pbnQodGhpcy5hcmdJbmRleCxjb29yZFswXSxMb2NhdGlvbi5CT1VOREFSWSk7fTtqc3RzLmdlb21ncmFwaC5HZW9tZXRyeUdyYXBoLnByb3RvdHlwZS5hZGRQb2x5Z29uPWZ1bmN0aW9uKHApe3RoaXMuYWRkUG9seWdvblJpbmcocC5nZXRFeHRlcmlvclJpbmcoKSxMb2NhdGlvbi5FWFRFUklPUixMb2NhdGlvbi5JTlRFUklPUik7Zm9yKHZhciBpPTA7aTxwLmdldE51bUludGVyaW9yUmluZygpO2krKyl7dmFyIGhvbGU9cC5nZXRJbnRlcmlvclJpbmdOKGkpO3RoaXMuYWRkUG9seWdvblJpbmcoaG9sZSxMb2NhdGlvbi5JTlRFUklPUixMb2NhdGlvbi5FWFRFUklPUik7fX07anN0cy5nZW9tZ3JhcGguR2VvbWV0cnlHcmFwaC5wcm90b3R5cGUuY29tcHV0ZUVkZ2VJbnRlcnNlY3Rpb25zPWZ1bmN0aW9uKGcsbGksaW5jbHVkZVByb3Blcil7dmFyIHNpPW5ldyBqc3RzLmdlb21ncmFwaC5pbmRleC5TZWdtZW50SW50ZXJzZWN0b3IobGksaW5jbHVkZVByb3Blcix0cnVlKTtzaS5zZXRCb3VuZGFyeU5vZGVzKHRoaXMuZ2V0Qm91bmRhcnlOb2RlcygpLGcuZ2V0Qm91bmRhcnlOb2RlcygpKTt2YXIgZXNpPXRoaXMuY3JlYXRlRWRnZVNldEludGVyc2VjdG9yKCk7ZXNpLmNvbXB1dGVJbnRlcnNlY3Rpb25zKHRoaXMuZWRnZXMsZy5lZGdlcyxzaSk7cmV0dXJuIHNpO307anN0cy5nZW9tZ3JhcGguR2VvbWV0cnlHcmFwaC5wcm90b3R5cGUuY29tcHV0ZVNlbGZOb2Rlcz1mdW5jdGlvbihsaSxjb21wdXRlUmluZ1NlbGZOb2Rlcyl7dmFyIHNpPW5ldyBqc3RzLmdlb21ncmFwaC5pbmRleC5TZWdtZW50SW50ZXJzZWN0b3IobGksdHJ1ZSxmYWxzZSk7dmFyIGVzaT10aGlzLmNyZWF0ZUVkZ2VTZXRJbnRlcnNlY3RvcigpO2lmKCFjb21wdXRlUmluZ1NlbGZOb2RlcyYmKHRoaXMucGFyZW50R2VvbSBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5MaW5lYXJSaW5nfHx0aGlzLnBhcmVudEdlb20gaW5zdGFuY2VvZiBqc3RzLmdlb20uUG9seWdvbnx8dGhpcy5wYXJlbnRHZW9tIGluc3RhbmNlb2YganN0cy5nZW9tLk11bHRpUG9seWdvbikpe2VzaS5jb21wdXRlSW50ZXJzZWN0aW9ucyh0aGlzLmVkZ2VzLHNpLGZhbHNlKTt9ZWxzZXtlc2kuY29tcHV0ZUludGVyc2VjdGlvbnModGhpcy5lZGdlcyxzaSx0cnVlKTt9XG50aGlzLmFkZFNlbGZJbnRlcnNlY3Rpb25Ob2Rlcyh0aGlzLmFyZ0luZGV4KTtyZXR1cm4gc2k7fTtqc3RzLmdlb21ncmFwaC5HZW9tZXRyeUdyYXBoLnByb3RvdHlwZS5pbnNlcnRQb2ludD1mdW5jdGlvbihhcmdJbmRleCxjb29yZCxvbkxvY2F0aW9uKXt2YXIgbj10aGlzLm5vZGVzLmFkZE5vZGUoY29vcmQpO3ZhciBsYmw9bi5nZXRMYWJlbCgpO2lmKGxibD09bnVsbCl7bi5sYWJlbD1uZXcganN0cy5nZW9tZ3JhcGguTGFiZWwoYXJnSW5kZXgsb25Mb2NhdGlvbik7fWVsc2VcbmxibC5zZXRMb2NhdGlvbihhcmdJbmRleCxvbkxvY2F0aW9uKTt9O2pzdHMuZ2VvbWdyYXBoLkdlb21ldHJ5R3JhcGgucHJvdG90eXBlLmluc2VydEJvdW5kYXJ5UG9pbnQ9ZnVuY3Rpb24oYXJnSW5kZXgsY29vcmQpe3ZhciBuPXRoaXMubm9kZXMuYWRkTm9kZShjb29yZCk7dmFyIGxibD1uLmdldExhYmVsKCk7dmFyIGJvdW5kYXJ5Q291bnQ9MTt2YXIgbG9jPUxvY2F0aW9uLk5PTkU7aWYobGJsIT09bnVsbClcbmxvYz1sYmwuZ2V0TG9jYXRpb24oYXJnSW5kZXgsUG9zaXRpb24uT04pO2lmKGxvYz09PUxvY2F0aW9uLkJPVU5EQVJZKVxuYm91bmRhcnlDb3VudCsrO3ZhciBuZXdMb2M9anN0cy5nZW9tZ3JhcGguR2VvbWV0cnlHcmFwaC5kZXRlcm1pbmVCb3VuZGFyeSh0aGlzLmJvdW5kYXJ5Tm9kZVJ1bGUsYm91bmRhcnlDb3VudCk7bGJsLnNldExvY2F0aW9uKGFyZ0luZGV4LG5ld0xvYyk7fTtqc3RzLmdlb21ncmFwaC5HZW9tZXRyeUdyYXBoLnByb3RvdHlwZS5hZGRTZWxmSW50ZXJzZWN0aW9uTm9kZXM9ZnVuY3Rpb24oYXJnSW5kZXgpe2Zvcih2YXIgaT10aGlzLmVkZ2VzLml0ZXJhdG9yKCk7aS5oYXNOZXh0KCk7KXt2YXIgZT1pLm5leHQoKTt2YXIgZUxvYz1lLmdldExhYmVsKCkuZ2V0TG9jYXRpb24oYXJnSW5kZXgpO2Zvcih2YXIgZWlJdD1lLmVpTGlzdC5pdGVyYXRvcigpO2VpSXQuaGFzTmV4dCgpOyl7dmFyIGVpPWVpSXQubmV4dCgpO3RoaXMuYWRkU2VsZkludGVyc2VjdGlvbk5vZGUoYXJnSW5kZXgsZWkuY29vcmQsZUxvYyk7fX19O2pzdHMuZ2VvbWdyYXBoLkdlb21ldHJ5R3JhcGgucHJvdG90eXBlLmFkZFNlbGZJbnRlcnNlY3Rpb25Ob2RlPWZ1bmN0aW9uKGFyZ0luZGV4LGNvb3JkLGxvYyl7aWYodGhpcy5pc0JvdW5kYXJ5Tm9kZShhcmdJbmRleCxjb29yZCkpXG5yZXR1cm47aWYobG9jPT09TG9jYXRpb24uQk9VTkRBUlkmJnRoaXMudXNlQm91bmRhcnlEZXRlcm1pbmF0aW9uUnVsZSlcbnRoaXMuaW5zZXJ0Qm91bmRhcnlQb2ludChhcmdJbmRleCxjb29yZCk7ZWxzZVxudGhpcy5pbnNlcnRQb2ludChhcmdJbmRleCxjb29yZCxsb2MpO307anN0cy5nZW9tZ3JhcGguR2VvbWV0cnlHcmFwaC5wcm90b3R5cGUuZ2V0SW52YWxpZFBvaW50PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuaW52YWxpZFBvaW50O307fSkoKTtqc3RzLm9wZXJhdGlvbi5idWZmZXIuT2Zmc2V0U2VnbWVudFN0cmluZz1mdW5jdGlvbigpe3RoaXMucHRMaXN0PVtdO307anN0cy5vcGVyYXRpb24uYnVmZmVyLk9mZnNldFNlZ21lbnRTdHJpbmcucHJvdG90eXBlLnB0TGlzdD1udWxsO2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5PZmZzZXRTZWdtZW50U3RyaW5nLnByb3RvdHlwZS5wcmVjaXNpb25Nb2RlbD1udWxsO2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5PZmZzZXRTZWdtZW50U3RyaW5nLnByb3RvdHlwZS5taW5pbWltVmVydGV4RGlzdGFuY2U9MC4wO2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5PZmZzZXRTZWdtZW50U3RyaW5nLnByb3RvdHlwZS5zZXRQcmVjaXNpb25Nb2RlbD1mdW5jdGlvbihwcmVjaXNpb25Nb2RlbCl7dGhpcy5wcmVjaXNpb25Nb2RlbD1wcmVjaXNpb25Nb2RlbDt9O2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5PZmZzZXRTZWdtZW50U3RyaW5nLnByb3RvdHlwZS5zZXRNaW5pbXVtVmVydGV4RGlzdGFuY2U9ZnVuY3Rpb24obWluaW1pbVZlcnRleERpc3RhbmNlKXt0aGlzLm1pbmltaW1WZXJ0ZXhEaXN0YW5jZT1taW5pbWltVmVydGV4RGlzdGFuY2U7fTtqc3RzLm9wZXJhdGlvbi5idWZmZXIuT2Zmc2V0U2VnbWVudFN0cmluZy5wcm90b3R5cGUuYWRkUHQ9ZnVuY3Rpb24ocHQpe3ZhciBidWZQdD1uZXcganN0cy5nZW9tLkNvb3JkaW5hdGUocHQpO3RoaXMucHJlY2lzaW9uTW9kZWwubWFrZVByZWNpc2UoYnVmUHQpO2lmKHRoaXMuaXNSZWR1bmRhbnQoYnVmUHQpKVxucmV0dXJuO3RoaXMucHRMaXN0LnB1c2goYnVmUHQpO307anN0cy5vcGVyYXRpb24uYnVmZmVyLk9mZnNldFNlZ21lbnRTdHJpbmcucHJvdG90eXBlLmFkZFB0cz1mdW5jdGlvbihwdCxpc0ZvcndhcmQpe2lmKGlzRm9yd2FyZCl7Zm9yKHZhciBpPTA7aTxwdC5sZW5ndGg7aSsrKXt0aGlzLmFkZFB0KHB0W2ldKTt9fWVsc2V7Zm9yKHZhciBpPXB0Lmxlbmd0aC0xO2k+PTA7aS0tKXt0aGlzLmFkZFB0KHB0W2ldKTt9fX07anN0cy5vcGVyYXRpb24uYnVmZmVyLk9mZnNldFNlZ21lbnRTdHJpbmcucHJvdG90eXBlLmlzUmVkdW5kYW50PWZ1bmN0aW9uKHB0KXtpZih0aGlzLnB0TGlzdC5sZW5ndGg8MSlcbnJldHVybiBmYWxzZTt2YXIgbGFzdFB0PXRoaXMucHRMaXN0W3RoaXMucHRMaXN0Lmxlbmd0aC0xXTt2YXIgcHREaXN0PXB0LmRpc3RhbmNlKGxhc3RQdCk7aWYocHREaXN0PHRoaXMubWluaW1pbVZlcnRleERpc3RhbmNlKVxucmV0dXJuIHRydWU7cmV0dXJuIGZhbHNlO307anN0cy5vcGVyYXRpb24uYnVmZmVyLk9mZnNldFNlZ21lbnRTdHJpbmcucHJvdG90eXBlLmNsb3NlUmluZz1mdW5jdGlvbigpe2lmKHRoaXMucHRMaXN0Lmxlbmd0aDwxKVxucmV0dXJuO3ZhciBzdGFydFB0PW5ldyBqc3RzLmdlb20uQ29vcmRpbmF0ZSh0aGlzLnB0TGlzdFswXSk7dmFyIGxhc3RQdD10aGlzLnB0TGlzdFt0aGlzLnB0TGlzdC5sZW5ndGgtMV07dmFyIGxhc3QyUHQ9bnVsbDtpZih0aGlzLnB0TGlzdC5sZW5ndGg+PTIpXG5sYXN0MlB0PXRoaXMucHRMaXN0W3RoaXMucHRMaXN0Lmxlbmd0aC0yXTtpZihzdGFydFB0LmVxdWFscyhsYXN0UHQpKVxucmV0dXJuO3RoaXMucHRMaXN0LnB1c2goc3RhcnRQdCk7fTtqc3RzLm9wZXJhdGlvbi5idWZmZXIuT2Zmc2V0U2VnbWVudFN0cmluZy5wcm90b3R5cGUucmV2ZXJzZT1mdW5jdGlvbigpe307anN0cy5vcGVyYXRpb24uYnVmZmVyLk9mZnNldFNlZ21lbnRTdHJpbmcucHJvdG90eXBlLmdldENvb3JkaW5hdGVzPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMucHRMaXN0O307anN0cy5hbGdvcml0aG0uZGlzdGFuY2UuUG9pbnRQYWlyRGlzdGFuY2U9ZnVuY3Rpb24oKXt0aGlzLnB0PVtuZXcganN0cy5nZW9tLkNvb3JkaW5hdGUoKSxuZXcganN0cy5nZW9tLkNvb3JkaW5hdGUoKV07fTtqc3RzLmFsZ29yaXRobS5kaXN0YW5jZS5Qb2ludFBhaXJEaXN0YW5jZS5wcm90b3R5cGUucHQ9bnVsbDtqc3RzLmFsZ29yaXRobS5kaXN0YW5jZS5Qb2ludFBhaXJEaXN0YW5jZS5wcm90b3R5cGUuZGlzdGFuY2U9TmFOO2pzdHMuYWxnb3JpdGhtLmRpc3RhbmNlLlBvaW50UGFpckRpc3RhbmNlLnByb3RvdHlwZS5pc051bGw9dHJ1ZTtqc3RzLmFsZ29yaXRobS5kaXN0YW5jZS5Qb2ludFBhaXJEaXN0YW5jZS5wcm90b3R5cGUuaW5pdGlhbGl6ZT1mdW5jdGlvbihwMCxwMSxkaXN0YW5jZSl7aWYocDA9PT11bmRlZmluZWQpe3RoaXMuaXNOdWxsPXRydWU7cmV0dXJuO31cbnRoaXMucHRbMF0uc2V0Q29vcmRpbmF0ZShwMCk7dGhpcy5wdFsxXS5zZXRDb29yZGluYXRlKHAxKTt0aGlzLmRpc3RhbmNlPWRpc3RhbmNlIT09dW5kZWZpbmVkP2Rpc3RhbmNlOnAwLmRpc3RhbmNlKHAxKTt0aGlzLmlzTnVsbD1mYWxzZTt9O2pzdHMuYWxnb3JpdGhtLmRpc3RhbmNlLlBvaW50UGFpckRpc3RhbmNlLnByb3RvdHlwZS5nZXREaXN0YW5jZT1mdW5jdGlvbigpe3JldHVybiB0aGlzLmRpc3RhbmNlO307anN0cy5hbGdvcml0aG0uZGlzdGFuY2UuUG9pbnRQYWlyRGlzdGFuY2UucHJvdG90eXBlLmdldENvb3JkaW5hdGVzPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMucHQ7fTtqc3RzLmFsZ29yaXRobS5kaXN0YW5jZS5Qb2ludFBhaXJEaXN0YW5jZS5wcm90b3R5cGUuZ2V0Q29vcmRpbmF0ZT1mdW5jdGlvbihpKXtyZXR1cm4gdGhpcy5wdFtpXTt9O2pzdHMuYWxnb3JpdGhtLmRpc3RhbmNlLlBvaW50UGFpckRpc3RhbmNlLnByb3RvdHlwZS5zZXRNYXhpbXVtPWZ1bmN0aW9uKHB0RGlzdCl7aWYoYXJndW1lbnRzLmxlbmd0aD09PTIpe3RoaXMuc2V0TWF4aW11bTIuYXBwbHkodGhpcyxhcmd1bWVudHMpO3JldHVybjt9XG50aGlzLnNldE1heGltdW0ocHREaXN0LnB0WzBdLHB0RGlzdC5wdFsxXSk7fTtqc3RzLmFsZ29yaXRobS5kaXN0YW5jZS5Qb2ludFBhaXJEaXN0YW5jZS5wcm90b3R5cGUuc2V0TWF4aW11bTI9ZnVuY3Rpb24ocDAscDEpe2lmKHRoaXMuaXNOdWxsKXt0aGlzLmluaXRpYWxpemUocDAscDEpO3JldHVybjt9XG52YXIgZGlzdD1wMC5kaXN0YW5jZShwMSk7aWYoZGlzdD50aGlzLmRpc3RhbmNlKVxudGhpcy5pbml0aWFsaXplKHAwLHAxLGRpc3QpO307anN0cy5hbGdvcml0aG0uZGlzdGFuY2UuUG9pbnRQYWlyRGlzdGFuY2UucHJvdG90eXBlLnNldE1pbmltdW09ZnVuY3Rpb24ocHREaXN0KXtpZihhcmd1bWVudHMubGVuZ3RoPT09Mil7dGhpcy5zZXRNaW5pbXVtMi5hcHBseSh0aGlzLGFyZ3VtZW50cyk7cmV0dXJuO31cbnRoaXMuc2V0TWluaW11bShwdERpc3QucHRbMF0scHREaXN0LnB0WzFdKTt9O2pzdHMuYWxnb3JpdGhtLmRpc3RhbmNlLlBvaW50UGFpckRpc3RhbmNlLnByb3RvdHlwZS5zZXRNaW5pbXVtMj1mdW5jdGlvbihwMCxwMSl7aWYodGhpcy5pc051bGwpe3RoaXMuaW5pdGlhbGl6ZShwMCxwMSk7cmV0dXJuO31cbnZhciBkaXN0PXAwLmRpc3RhbmNlKHAxKTtpZihkaXN0PHRoaXMuZGlzdGFuY2UpXG50aGlzLmluaXRpYWxpemUocDAscDEsZGlzdCk7fTsoZnVuY3Rpb24oKXt2YXIgUG9pbnRQYWlyRGlzdGFuY2U9anN0cy5hbGdvcml0aG0uZGlzdGFuY2UuUG9pbnRQYWlyRGlzdGFuY2U7dmFyIERpc3RhbmNlVG9Qb2ludD1qc3RzLmFsZ29yaXRobS5kaXN0YW5jZS5EaXN0YW5jZVRvUG9pbnQ7dmFyIE1heFBvaW50RGlzdGFuY2VGaWx0ZXI9ZnVuY3Rpb24oZ2VvbSl7dGhpcy5tYXhQdERpc3Q9bmV3IFBvaW50UGFpckRpc3RhbmNlKCk7dGhpcy5taW5QdERpc3Q9bmV3IFBvaW50UGFpckRpc3RhbmNlKCk7dGhpcy5ldWNsaWRlYW5EaXN0PW5ldyBEaXN0YW5jZVRvUG9pbnQoKTt0aGlzLmdlb209Z2VvbTt9O01heFBvaW50RGlzdGFuY2VGaWx0ZXIucHJvdG90eXBlPW5ldyBqc3RzLmdlb20uQ29vcmRpbmF0ZUZpbHRlcigpO01heFBvaW50RGlzdGFuY2VGaWx0ZXIucHJvdG90eXBlLm1heFB0RGlzdD1uZXcgUG9pbnRQYWlyRGlzdGFuY2UoKTtNYXhQb2ludERpc3RhbmNlRmlsdGVyLnByb3RvdHlwZS5taW5QdERpc3Q9bmV3IFBvaW50UGFpckRpc3RhbmNlKCk7TWF4UG9pbnREaXN0YW5jZUZpbHRlci5wcm90b3R5cGUuZXVjbGlkZWFuRGlzdD1uZXcgRGlzdGFuY2VUb1BvaW50KCk7TWF4UG9pbnREaXN0YW5jZUZpbHRlci5wcm90b3R5cGUuZ2VvbTtNYXhQb2ludERpc3RhbmNlRmlsdGVyLnByb3RvdHlwZS5maWx0ZXI9ZnVuY3Rpb24ocHQpe3RoaXMubWluUHREaXN0LmluaXRpYWxpemUoKTtEaXN0YW5jZVRvUG9pbnQuY29tcHV0ZURpc3RhbmNlKHRoaXMuZ2VvbSxwdCx0aGlzLm1pblB0RGlzdCk7dGhpcy5tYXhQdERpc3Quc2V0TWF4aW11bSh0aGlzLm1pblB0RGlzdCk7fTtNYXhQb2ludERpc3RhbmNlRmlsdGVyLnByb3RvdHlwZS5nZXRNYXhQb2ludERpc3RhbmNlPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMubWF4UHREaXN0O307dmFyIE1heERlbnNpZmllZEJ5RnJhY3Rpb25EaXN0YW5jZUZpbHRlcj1mdW5jdGlvbihnZW9tLGZyYWN0aW9uKXt0aGlzLm1heFB0RGlzdD1uZXcgUG9pbnRQYWlyRGlzdGFuY2UoKTt0aGlzLm1pblB0RGlzdD1uZXcgUG9pbnRQYWlyRGlzdGFuY2UoKTt0aGlzLmdlb209Z2VvbTt0aGlzLm51bVN1YlNlZ3M9TWF0aC5yb3VuZCgxLjAvZnJhY3Rpb24pO307TWF4RGVuc2lmaWVkQnlGcmFjdGlvbkRpc3RhbmNlRmlsdGVyLnByb3RvdHlwZT1uZXcganN0cy5nZW9tLkNvb3JkaW5hdGVTZXF1ZW5jZUZpbHRlcigpO01heERlbnNpZmllZEJ5RnJhY3Rpb25EaXN0YW5jZUZpbHRlci5wcm90b3R5cGUubWF4UHREaXN0PW5ldyBQb2ludFBhaXJEaXN0YW5jZSgpO01heERlbnNpZmllZEJ5RnJhY3Rpb25EaXN0YW5jZUZpbHRlci5wcm90b3R5cGUubWluUHREaXN0PW5ldyBQb2ludFBhaXJEaXN0YW5jZSgpO01heERlbnNpZmllZEJ5RnJhY3Rpb25EaXN0YW5jZUZpbHRlci5wcm90b3R5cGUuZ2VvbTtNYXhEZW5zaWZpZWRCeUZyYWN0aW9uRGlzdGFuY2VGaWx0ZXIucHJvdG90eXBlLm51bVN1YlNlZ3M9MDtNYXhEZW5zaWZpZWRCeUZyYWN0aW9uRGlzdGFuY2VGaWx0ZXIucHJvdG90eXBlLmZpbHRlcj1mdW5jdGlvbihzZXEsaW5kZXgpe2lmKGluZGV4PT0wKVxucmV0dXJuO3ZhciBwMD1zZXFbaW5kZXgtMV07dmFyIHAxPXNlcVtpbmRleF07dmFyIGRlbHg9KHAxLngtcDAueCkvdGhpcy5udW1TdWJTZWdzO3ZhciBkZWx5PShwMS55LXAwLnkpL3RoaXMubnVtU3ViU2Vncztmb3IodmFyIGk9MDtpPHRoaXMubnVtU3ViU2VncztpKyspe3ZhciB4PXAwLngraSpkZWx4O3ZhciB5PXAwLnkraSpkZWx5O3ZhciBwdD1uZXcganN0cy5nZW9tLkNvb3JkaW5hdGUoeCx5KTt0aGlzLm1pblB0RGlzdC5pbml0aWFsaXplKCk7RGlzdGFuY2VUb1BvaW50LmNvbXB1dGVEaXN0YW5jZSh0aGlzLmdlb20scHQsdGhpcy5taW5QdERpc3QpO3RoaXMubWF4UHREaXN0LnNldE1heGltdW0odGhpcy5taW5QdERpc3QpO319O01heERlbnNpZmllZEJ5RnJhY3Rpb25EaXN0YW5jZUZpbHRlci5wcm90b3R5cGUuaXNHZW9tZXRyeUNoYW5nZWQ9ZnVuY3Rpb24oKXtyZXR1cm4gZmFsc2U7fTtNYXhEZW5zaWZpZWRCeUZyYWN0aW9uRGlzdGFuY2VGaWx0ZXIucHJvdG90eXBlLmlzRG9uZT1mdW5jdGlvbigpe3JldHVybiBmYWxzZTt9O01heERlbnNpZmllZEJ5RnJhY3Rpb25EaXN0YW5jZUZpbHRlci5wcm90b3R5cGUuZ2V0TWF4UG9pbnREaXN0YW5jZT1mdW5jdGlvbigpe3JldHVybiB0aGlzLm1heFB0RGlzdDt9O2pzdHMuYWxnb3JpdGhtLmRpc3RhbmNlLkRpc2NyZXRlSGF1c2RvcmZmRGlzdGFuY2U9ZnVuY3Rpb24oZzAsZzEpe3RoaXMuZzA9ZzA7dGhpcy5nMT1nMTt0aGlzLnB0RGlzdD1uZXcganN0cy5hbGdvcml0aG0uZGlzdGFuY2UuUG9pbnRQYWlyRGlzdGFuY2UoKTt9O2pzdHMuYWxnb3JpdGhtLmRpc3RhbmNlLkRpc2NyZXRlSGF1c2RvcmZmRGlzdGFuY2UucHJvdG90eXBlLmcwPW51bGw7anN0cy5hbGdvcml0aG0uZGlzdGFuY2UuRGlzY3JldGVIYXVzZG9yZmZEaXN0YW5jZS5wcm90b3R5cGUuZzE9bnVsbDtqc3RzLmFsZ29yaXRobS5kaXN0YW5jZS5EaXNjcmV0ZUhhdXNkb3JmZkRpc3RhbmNlLnByb3RvdHlwZS5wdERpc3Q9bnVsbDtqc3RzLmFsZ29yaXRobS5kaXN0YW5jZS5EaXNjcmV0ZUhhdXNkb3JmZkRpc3RhbmNlLnByb3RvdHlwZS5kZW5zaWZ5RnJhYz0wLjA7anN0cy5hbGdvcml0aG0uZGlzdGFuY2UuRGlzY3JldGVIYXVzZG9yZmZEaXN0YW5jZS5kaXN0YW5jZT1mdW5jdGlvbihnMCxnMSxkZW5zaWZ5RnJhYyl7dmFyIGRpc3Q9bmV3IGpzdHMuYWxnb3JpdGhtLmRpc3RhbmNlLkRpc2NyZXRlSGF1c2RvcmZmRGlzdGFuY2UoZzAsZzEpO2lmKGRlbnNpZnlGcmFjIT09dW5kZWZpbmVkKVxuZGlzdC5zZXREZW5zaWZ5RnJhY3Rpb24oZGVuc2lmeUZyYWMpO3JldHVybiBkaXN0LmRpc3RhbmNlKCk7fTtqc3RzLmFsZ29yaXRobS5kaXN0YW5jZS5EaXNjcmV0ZUhhdXNkb3JmZkRpc3RhbmNlLnByb3RvdHlwZS5zZXREZW5zaWZ5RnJhY3Rpb249ZnVuY3Rpb24oZGVuc2lmeUZyYWMpe2lmKGRlbnNpZnlGcmFjPjEuMHx8ZGVuc2lmeUZyYWM8PTAuMClcbnRocm93IG5ldyBqc3RzLmVycm9yLklsbGVnYWxBcmd1bWVudEVycm9yKCdGcmFjdGlvbiBpcyBub3QgaW4gcmFuZ2UgKDAuMCAtIDEuMF0nKTt0aGlzLmRlbnNpZnlGcmFjPWRlbnNpZnlGcmFjO307anN0cy5hbGdvcml0aG0uZGlzdGFuY2UuRGlzY3JldGVIYXVzZG9yZmZEaXN0YW5jZS5wcm90b3R5cGUuZGlzdGFuY2U9ZnVuY3Rpb24oKXt0aGlzLmNvbXB1dGUodGhpcy5nMCx0aGlzLmcxKTtyZXR1cm4gcHREaXN0LmdldERpc3RhbmNlKCk7fTtqc3RzLmFsZ29yaXRobS5kaXN0YW5jZS5EaXNjcmV0ZUhhdXNkb3JmZkRpc3RhbmNlLnByb3RvdHlwZS5vcmllbnRlZERpc3RhbmNlPWZ1bmN0aW9uKCl7dGhpcy5jb21wdXRlT3JpZW50ZWREaXN0YW5jZSh0aGlzLmcwLHRoaXMuZzEsdGhpcy5wdERpc3QpO3JldHVybiB0aGlzLnB0RGlzdC5nZXREaXN0YW5jZSgpO307anN0cy5hbGdvcml0aG0uZGlzdGFuY2UuRGlzY3JldGVIYXVzZG9yZmZEaXN0YW5jZS5wcm90b3R5cGUuZ2V0Q29vcmRpbmF0ZXM9ZnVuY3Rpb24oKXtyZXR1cm4gcHREaXN0LmdldENvb3JkaW5hdGVzKCk7fTtqc3RzLmFsZ29yaXRobS5kaXN0YW5jZS5EaXNjcmV0ZUhhdXNkb3JmZkRpc3RhbmNlLnByb3RvdHlwZS5jb21wdXRlPWZ1bmN0aW9uKGcwLGcxKXt0aGlzLmNvbXB1dGVPcmllbnRlZERpc3RhbmNlKGcwLGcxLHRoaXMucHREaXN0KTt0aGlzLmNvbXB1dGVPcmllbnRlZERpc3RhbmNlKGcxLGcwLHRoaXMucHREaXN0KTt9O2pzdHMuYWxnb3JpdGhtLmRpc3RhbmNlLkRpc2NyZXRlSGF1c2RvcmZmRGlzdGFuY2UucHJvdG90eXBlLmNvbXB1dGVPcmllbnRlZERpc3RhbmNlPWZ1bmN0aW9uKGRpc2NyZXRlR2VvbSxnZW9tLHB0RGlzdCl7dmFyIGRpc3RGaWx0ZXI9bmV3IE1heFBvaW50RGlzdGFuY2VGaWx0ZXIoZ2VvbSk7ZGlzY3JldGVHZW9tLmFwcGx5KGRpc3RGaWx0ZXIpO3B0RGlzdC5zZXRNYXhpbXVtKGRpc3RGaWx0ZXIuZ2V0TWF4UG9pbnREaXN0YW5jZSgpKTtpZih0aGlzLmRlbnNpZnlGcmFjPjApe3ZhciBmcmFjRmlsdGVyPW5ldyBNYXhEZW5zaWZpZWRCeUZyYWN0aW9uRGlzdGFuY2VGaWx0ZXIoZ2VvbSx0aGlzLmRlbnNpZnlGcmFjKTtkaXNjcmV0ZUdlb20uYXBwbHkoZnJhY0ZpbHRlcik7cHREaXN0LnNldE1heGltdW0oZnJhY0ZpbHRlci5nZXRNYXhQb2ludERpc3RhbmNlKCkpO319O30pKCk7anN0cy5hbGdvcml0aG0uTWluaW11bUJvdW5kaW5nQ2lyY2xlPWZ1bmN0aW9uKGdlb20pe3RoaXMuaW5wdXQ9bnVsbDt0aGlzLmV4dHJlbWFsUHRzPW51bGw7dGhpcy5jZW50cmU9bnVsbDt0aGlzLnJhZGl1cz0wO3RoaXMuaW5wdXQ9Z2VvbTt9O2pzdHMuYWxnb3JpdGhtLk1pbmltdW1Cb3VuZGluZ0NpcmNsZS5wcm90b3R5cGUuZ2V0Q2lyY2xlPWZ1bmN0aW9uKCl7dGhpcy5jb21wdXRlKCk7aWYodGhpcy5jZW50cmU9PT1udWxsKXtyZXR1cm4gdGhpcy5pbnB1dC5nZXRGYWN0b3J5KCkuY3JlYXRlUG9seWdvbihudWxsLG51bGwpO31cbnZhciBjZW50cmVQb2ludD10aGlzLmlucHV0LmdldEZhY3RvcnkoKS5jcmVhdGVQb2ludCh0aGlzLmNlbnRyZSk7aWYodGhpcy5yYWRpdXM9PT0wKXtyZXR1cm4gY2VudHJlUG9pbnQ7fVxucmV0dXJuIGNlbnRyZVBvaW50LmJ1ZmZlcih0aGlzLnJhZGl1cyk7fTtqc3RzLmFsZ29yaXRobS5NaW5pbXVtQm91bmRpbmdDaXJjbGUucHJvdG90eXBlLmdldEV4dHJlbWFsUG9pbnRzPWZ1bmN0aW9uKCl7dGhpcy5jb21wdXRlKCk7cmV0dXJuIHRoaXMuZXh0cmVtYWxQdHM7fTtqc3RzLmFsZ29yaXRobS5NaW5pbXVtQm91bmRpbmdDaXJjbGUucHJvdG90eXBlLmdldENlbnRyZT1mdW5jdGlvbigpe3RoaXMuY29tcHV0ZSgpO3JldHVybiB0aGlzLmNlbnRyZTt9O2pzdHMuYWxnb3JpdGhtLk1pbmltdW1Cb3VuZGluZ0NpcmNsZS5wcm90b3R5cGUuZ2V0UmFkaXVzPWZ1bmN0aW9uKCl7dGhpcy5jb21wdXRlKCk7cmV0dXJuIHRoaXMucmFkaXVzO307anN0cy5hbGdvcml0aG0uTWluaW11bUJvdW5kaW5nQ2lyY2xlLnByb3RvdHlwZS5jb21wdXRlQ2VudHJlPWZ1bmN0aW9uKCl7c3dpdGNoKHRoaXMuZXh0cmVtYWxQdHMubGVuZ3RoKXtjYXNlIDA6dGhpcy5jZW50cmU9bnVsbDticmVhaztjYXNlIDE6dGhpcy5jZW50cmU9dGhpcy5leHRyZW1hbFB0c1swXTticmVhaztjYXNlIDI6dGhpcy5jZW50cmU9bmV3IGpzdHMuZ2VvbS5Db29yZGluYXRlKCh0aGlzLmV4dHJlbWFsUHRzWzBdLngrdGhpcy5leHRyZW1hbFB0c1sxXS54KS8yLCh0aGlzLmV4dHJlbWFsUHRzWzBdLnkrdGhpcy5leHRyZW1hbFB0c1sxXS55KS8yKTticmVhaztjYXNlIDM6dGhpcy5jZW50cmU9anN0cy5nZW9tLlRyaWFuZ2xlLmNpcmN1bWNlbnRyZSh0aGlzLmV4dHJlbWFsUHRzWzBdLHRoaXMuZXh0cmVtYWxQdHNbMV0sdGhpcy5leHRyZW1hbFB0c1syXSk7YnJlYWs7fX07anN0cy5hbGdvcml0aG0uTWluaW11bUJvdW5kaW5nQ2lyY2xlLnByb3RvdHlwZS5jb21wdXRlPWZ1bmN0aW9uKCl7aWYodGhpcy5leHRyZW1hbFB0cyE9PW51bGwpe3JldHVybjt9XG50aGlzLmNvbXB1dGVDaXJjbGVQb2ludHMoKTt0aGlzLmNvbXB1dGVDZW50cmUoKTtpZih0aGlzLmNlbnRyZSE9PW51bGwpe3RoaXMucmFkaXVzPXRoaXMuY2VudHJlLmRpc3RhbmNlKHRoaXMuZXh0cmVtYWxQdHNbMF0pO319O2pzdHMuYWxnb3JpdGhtLk1pbmltdW1Cb3VuZGluZ0NpcmNsZS5wcm90b3R5cGUuY29tcHV0ZUNpcmNsZVBvaW50cz1mdW5jdGlvbigpe2lmKHRoaXMuaW5wdXQuaXNFbXB0eSgpKXt0aGlzLmV4dHJlbWFsUHRzPVtdO3JldHVybjt9XG52YXIgcHRzO2lmKHRoaXMuaW5wdXQuZ2V0TnVtUG9pbnRzKCk9PT0xKXtwdHM9dGhpcy5pbnB1dC5nZXRDb29yZGluYXRlcygpO3RoaXMuZXh0cmVtYWxQdHM9W25ldyBqc3RzLmdlb20uQ29vcmRpbmF0ZShwdHNbMF0pXTtyZXR1cm47fVxudmFyIGNvbnZleEh1bGw9dGhpcy5pbnB1dC5jb252ZXhIdWxsKCk7dmFyIGh1bGxQdHM9Y29udmV4SHVsbC5nZXRDb29yZGluYXRlcygpO3B0cz1odWxsUHRzO2lmKGh1bGxQdHNbMF0uZXF1YWxzMkQoaHVsbFB0c1todWxsUHRzLmxlbmd0aC0xXSkpe3B0cz1bXTtqc3RzLmdlb20uQ29vcmRpbmF0ZUFycmF5cy5jb3B5RGVlcChodWxsUHRzLDAscHRzLDAsaHVsbFB0cy5sZW5ndGgtMSk7fVxuaWYocHRzLmxlbmd0aDw9Mil7dGhpcy5leHRyZW1hbFB0cz1qc3RzLmdlb20uQ29vcmRpbmF0ZUFycmF5cy5jb3B5RGVlcChwdHMpO3JldHVybjt9XG52YXIgUD1qc3RzLmFsZ29yaXRobS5NaW5pbXVtQm91bmRpbmdDaXJjbGUubG93ZXN0UG9pbnQocHRzKTt2YXIgUT1qc3RzLmFsZ29yaXRobS5NaW5pbXVtQm91bmRpbmdDaXJjbGUucG9pbnRXaXRNaW5BbmdsZVdpdGhYKHB0cyxQKTtmb3IodmFyIGk9MDtpPHB0cy5sZW5ndGg7aSsrKXt2YXIgUj1qc3RzLmFsZ29yaXRobS5NaW5pbXVtQm91bmRpbmdDaXJjbGUucG9pbnRXaXRoTWluQW5nbGVXaXRoU2VnbWVudChwdHMsUCxRKTtpZihqc3RzLmFsZ29yaXRobS5BbmdsZS5pc09idHVzZShQLFIsUSkpe3RoaXMuZXh0cmVtYWxQdHM9W25ldyBqc3RzLmdlb20uQ29vcmRpbmF0ZShQKSxuZXcganN0cy5nZW9tLkNvb3JkaW5hdGUoUSldO3JldHVybjt9XG5pZihqc3RzLmFsZ29yaXRobS5BbmdsZS5pc09idHVzZShSLFAsUSkpe1A9Ujtjb250aW51ZTt9XG5pZihqc3RzLmFsZ29yaXRobS5BbmdsZS5pc09idHVzZShSLFEsUCkpe1E9Ujtjb250aW51ZTt9XG50aGlzLmV4dHJlbWFsUHRzPVtuZXcganN0cy5nZW9tLkNvb3JkaW5hdGUoUCksbmV3IGpzdHMuZ2VvbS5Db29yZGluYXRlKFEpLG5ldyBqc3RzLmdlb20uQ29vcmRpbmF0ZShSKV07cmV0dXJuO31cbnRocm93IG5ldyBFcnJvcihcIkxvZ2ljIGZhaWx1cmUgaW4gTWluaW11bSBCb3VuZGluZyBDaXJjbGUgYWxnb3JpdGhtIVwiKTt9O2pzdHMuYWxnb3JpdGhtLk1pbmltdW1Cb3VuZGluZ0NpcmNsZS5sb3dlc3RQb2ludD1mdW5jdGlvbihwdHMpe3ZhciBtaW49cHRzWzBdO2Zvcih2YXIgaT0xO2k8cHRzLmxlbmd0aDtpKyspe2lmKHB0c1tpXS55PG1pbi55KXttaW49cHRzW2ldO319XG5yZXR1cm4gbWluO307anN0cy5hbGdvcml0aG0uTWluaW11bUJvdW5kaW5nQ2lyY2xlLnBvaW50V2l0TWluQW5nbGVXaXRoWD1mdW5jdGlvbihwdHMsUCl7dmFyIG1pblNpbj1OdW1iZXIuTUFYX1ZBTFVFO3ZhciBtaW5BbmdQdD1udWxsO2Zvcih2YXIgaT0wO2k8cHRzLmxlbmd0aDtpKyspe3ZhciBwPXB0c1tpXTtpZihwPT09UCljb250aW51ZTt2YXIgZHg9cC54LVAueDt2YXIgZHk9cC55LVAueTtpZihkeTwwKWR5PS1keTt2YXIgbGVuPU1hdGguc3FydChkeCpkeCtkeSpkeSk7dmFyIHNpbj1keS9sZW47aWYoc2luPG1pblNpbil7bWluU2luPXNpbjttaW5BbmdQdD1wO319XG5yZXR1cm4gbWluQW5nUHQ7fTtqc3RzLmFsZ29yaXRobS5NaW5pbXVtQm91bmRpbmdDaXJjbGUucG9pbnRXaXRoTWluQW5nbGVXaXRoU2VnbWVudD1mdW5jdGlvbihwdHMsUCxRKXt2YXIgbWluQW5nPU51bWJlci5NQVhfVkFMVUU7dmFyIG1pbkFuZ1B0PW51bGw7Zm9yKHZhciBpPTA7aTxwdHMubGVuZ3RoO2krKyl7dmFyIHA9cHRzW2ldO2lmKHA9PT1QKWNvbnRpbnVlO2lmKHA9PT1RKWNvbnRpbnVlO3ZhciBhbmc9anN0cy5hbGdvcml0aG0uQW5nbGUuYW5nbGVCZXR3ZWVuKFAscCxRKTtpZihhbmc8bWluQW5nKXttaW5Bbmc9YW5nO21pbkFuZ1B0PXA7fX1cbnJldHVybiBtaW5BbmdQdDt9O2pzdHMubm9kaW5nLlNjYWxlZE5vZGVyPWZ1bmN0aW9uKG5vZGVyLHNjYWxlRmFjdG9yLG9mZnNldFgsb2Zmc2V0WSl7dGhpcy5vZmZzZXRYPW9mZnNldFg/b2Zmc2V0WDowO3RoaXMub2Zmc2V0WT1vZmZzZXRZP29mZnNldFk6MDt0aGlzLm5vZGVyPW5vZGVyO3RoaXMuc2NhbGVGYWN0b3I9c2NhbGVGYWN0b3I7dGhpcy5pc1NjYWxlZD0hdGhpcy5pc0ludGVnZXJQcmVjaXNpb24oKTt9O2pzdHMubm9kaW5nLlNjYWxlZE5vZGVyLnByb3RvdHlwZT1uZXcganN0cy5ub2RpbmcuTm9kZXIoKTtqc3RzLm5vZGluZy5TY2FsZWROb2Rlci5jb25zdHJ1Y3Rvcj1qc3RzLm5vZGluZy5TY2FsZWROb2Rlcjtqc3RzLm5vZGluZy5TY2FsZWROb2Rlci5wcm90b3R5cGUubm9kZXI9bnVsbDtqc3RzLm5vZGluZy5TY2FsZWROb2Rlci5wcm90b3R5cGUuc2NhbGVGYWN0b3I9dW5kZWZpbmVkO2pzdHMubm9kaW5nLlNjYWxlZE5vZGVyLnByb3RvdHlwZS5vZmZzZXRYPXVuZGVmaW5lZDtqc3RzLm5vZGluZy5TY2FsZWROb2Rlci5wcm90b3R5cGUub2Zmc2V0WT11bmRlZmluZWQ7anN0cy5ub2RpbmcuU2NhbGVkTm9kZXIucHJvdG90eXBlLmlzU2NhbGVkPWZhbHNlO2pzdHMubm9kaW5nLlNjYWxlZE5vZGVyLnByb3RvdHlwZS5pc0ludGVnZXJQcmVjaXNpb249ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5zY2FsZUZhY3Rvcj09PTEuMDt9O2pzdHMubm9kaW5nLlNjYWxlZE5vZGVyLnByb3RvdHlwZS5nZXROb2RlZFN1YnN0cmluZ3M9ZnVuY3Rpb24oKXt2YXIgc3BsaXRTUz10aGlzLm5vZGVyLmdldE5vZGVkU3Vic3RyaW5ncygpO2lmKHRoaXMuaXNTY2FsZWQpXG50aGlzLnJlc2NhbGUoc3BsaXRTUyk7cmV0dXJuIHNwbGl0U1M7fTtqc3RzLm5vZGluZy5TY2FsZWROb2Rlci5wcm90b3R5cGUuY29tcHV0ZU5vZGVzPWZ1bmN0aW9uKGlucHV0U2VnU3RyaW5ncyl7dmFyIGludFNlZ1N0cmluZ3M9aW5wdXRTZWdTdHJpbmdzO2lmKHRoaXMuaXNTY2FsZWQpXG5pbnRTZWdTdHJpbmdzPXRoaXMuc2NhbGUoaW5wdXRTZWdTdHJpbmdzKTt0aGlzLm5vZGVyLmNvbXB1dGVOb2RlcyhpbnRTZWdTdHJpbmdzKTt9O2pzdHMubm9kaW5nLlNjYWxlZE5vZGVyLnByb3RvdHlwZS5zY2FsZT1mdW5jdGlvbihzZWdTdHJpbmdzKXtpZihzZWdTdHJpbmdzIGluc3RhbmNlb2YgQXJyYXkpe3JldHVybiB0aGlzLnNjYWxlMihzZWdTdHJpbmdzKTt9XG52YXIgdHJhbnNmb3JtZWQ9bmV3IGphdmFzY3JpcHQudXRpbC5BcnJheUxpc3QoKTtmb3IodmFyIGk9c2VnU3RyaW5ncy5pdGVyYXRvcigpO2kuaGFzTmV4dCgpOyl7dmFyIHNzPWkubmV4dCgpO3RyYW5zZm9ybWVkLmFkZChuZXcganN0cy5ub2RpbmcuTm9kZWRTZWdtZW50U3RyaW5nKHRoaXMuc2NhbGUoc3MuZ2V0Q29vcmRpbmF0ZXMoKSksc3MuZ2V0RGF0YSgpKSk7fVxucmV0dXJuIHRyYW5zZm9ybWVkO307anN0cy5ub2RpbmcuU2NhbGVkTm9kZXIucHJvdG90eXBlLnNjYWxlMj1mdW5jdGlvbihwdHMpe3ZhciByb3VuZFB0cz1bXTtmb3IodmFyIGk9MDtpPHB0cy5sZW5ndGg7aSsrKXtyb3VuZFB0c1tpXT1uZXcganN0cy5nZW9tLkNvb3JkaW5hdGUoTWF0aC5yb3VuZCgocHRzW2ldLngtdGhpcy5vZmZzZXRYKSp0aGlzLnNjYWxlRmFjdG9yKSxNYXRoLnJvdW5kKChwdHNbaV0ueS10aGlzLm9mZnNldFkpKnRoaXMuc2NhbGVGYWN0b3IpKTt9XG52YXIgcm91bmRQdHNOb0R1cD1qc3RzLmdlb20uQ29vcmRpbmF0ZUFycmF5cy5yZW1vdmVSZXBlYXRlZFBvaW50cyhyb3VuZFB0cyk7cmV0dXJuIHJvdW5kUHRzTm9EdXA7fTtqc3RzLm5vZGluZy5TY2FsZWROb2Rlci5wcm90b3R5cGUucmVzY2FsZT1mdW5jdGlvbihzZWdTdHJpbmdzKXtpZihzZWdTdHJpbmdzIGluc3RhbmNlb2YgQXJyYXkpe3RoaXMucmVzY2FsZTIoc2VnU3RyaW5ncyk7cmV0dXJuO31cbmZvcih2YXIgaT1zZWdTdHJpbmdzLml0ZXJhdG9yKCk7aS5oYXNOZXh0KCk7KXt2YXIgc3M9aS5uZXh0KCk7dGhpcy5yZXNjYWxlKHNzLmdldENvb3JkaW5hdGVzKCkpO319O2pzdHMubm9kaW5nLlNjYWxlZE5vZGVyLnByb3RvdHlwZS5yZXNjYWxlMj1mdW5jdGlvbihwdHMpe2Zvcih2YXIgaT0wO2k8cHRzLmxlbmd0aDtpKyspe3B0c1tpXS54PXB0c1tpXS54L3RoaXMuc2NhbGVGYWN0b3IrdGhpcy5vZmZzZXRYO3B0c1tpXS55PXB0c1tpXS55L3RoaXMuc2NhbGVGYWN0b3IrdGhpcy5vZmZzZXRZO319OyhmdW5jdGlvbigpe3ZhciBBcnJheUxpc3Q9amF2YXNjcmlwdC51dGlsLkFycmF5TGlzdDtqc3RzLmdlb21ncmFwaC5pbmRleC5TZWdtZW50SW50ZXJzZWN0b3I9ZnVuY3Rpb24obGksaW5jbHVkZVByb3BlcixyZWNvcmRJc29sYXRlZCl7dGhpcy5saT1saTt0aGlzLmluY2x1ZGVQcm9wZXI9aW5jbHVkZVByb3Blcjt0aGlzLnJlY29yZElzb2xhdGVkPXJlY29yZElzb2xhdGVkO307anN0cy5nZW9tZ3JhcGguaW5kZXguU2VnbWVudEludGVyc2VjdG9yLmlzQWRqYWNlbnRTZWdtZW50cz1mdW5jdGlvbihpMSxpMil7cmV0dXJuIE1hdGguYWJzKGkxLWkyKT09PTE7fTtqc3RzLmdlb21ncmFwaC5pbmRleC5TZWdtZW50SW50ZXJzZWN0b3IucHJvdG90eXBlLl9oYXNJbnRlcnNlY3Rpb249ZmFsc2U7anN0cy5nZW9tZ3JhcGguaW5kZXguU2VnbWVudEludGVyc2VjdG9yLnByb3RvdHlwZS5oYXNQcm9wZXI9ZmFsc2U7anN0cy5nZW9tZ3JhcGguaW5kZXguU2VnbWVudEludGVyc2VjdG9yLnByb3RvdHlwZS5oYXNQcm9wZXJJbnRlcmlvcj1mYWxzZTtqc3RzLmdlb21ncmFwaC5pbmRleC5TZWdtZW50SW50ZXJzZWN0b3IucHJvdG90eXBlLnByb3BlckludGVyc2VjdGlvblBvaW50PW51bGw7anN0cy5nZW9tZ3JhcGguaW5kZXguU2VnbWVudEludGVyc2VjdG9yLnByb3RvdHlwZS5saT1udWxsO2pzdHMuZ2VvbWdyYXBoLmluZGV4LlNlZ21lbnRJbnRlcnNlY3Rvci5wcm90b3R5cGUuaW5jbHVkZVByb3Blcj1udWxsO2pzdHMuZ2VvbWdyYXBoLmluZGV4LlNlZ21lbnRJbnRlcnNlY3Rvci5wcm90b3R5cGUucmVjb3JkSXNvbGF0ZWQ9bnVsbDtqc3RzLmdlb21ncmFwaC5pbmRleC5TZWdtZW50SW50ZXJzZWN0b3IucHJvdG90eXBlLmlzU2VsZkludGVyc2VjdGlvbj1udWxsO2pzdHMuZ2VvbWdyYXBoLmluZGV4LlNlZ21lbnRJbnRlcnNlY3Rvci5wcm90b3R5cGUubnVtSW50ZXJzZWN0aW9ucz0wO2pzdHMuZ2VvbWdyYXBoLmluZGV4LlNlZ21lbnRJbnRlcnNlY3Rvci5wcm90b3R5cGUubnVtVGVzdHM9MDtqc3RzLmdlb21ncmFwaC5pbmRleC5TZWdtZW50SW50ZXJzZWN0b3IucHJvdG90eXBlLmJkeU5vZGVzPW51bGw7anN0cy5nZW9tZ3JhcGguaW5kZXguU2VnbWVudEludGVyc2VjdG9yLnByb3RvdHlwZS5zZXRCb3VuZGFyeU5vZGVzPWZ1bmN0aW9uKGJkeU5vZGVzMCxiZHlOb2RlczEpe3RoaXMuYmR5Tm9kZXM9W107dGhpcy5iZHlOb2Rlc1swXT1iZHlOb2RlczA7dGhpcy5iZHlOb2Rlc1sxXT1iZHlOb2RlczE7fTtqc3RzLmdlb21ncmFwaC5pbmRleC5TZWdtZW50SW50ZXJzZWN0b3IucHJvdG90eXBlLmdldFByb3BlckludGVyc2VjdGlvblBvaW50PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMucHJvcGVySW50ZXJzZWN0aW9uUG9pbnQ7fTtqc3RzLmdlb21ncmFwaC5pbmRleC5TZWdtZW50SW50ZXJzZWN0b3IucHJvdG90eXBlLmhhc0ludGVyc2VjdGlvbj1mdW5jdGlvbigpe3JldHVybiB0aGlzLl9oYXNJbnRlcnNlY3Rpb247fTtqc3RzLmdlb21ncmFwaC5pbmRleC5TZWdtZW50SW50ZXJzZWN0b3IucHJvdG90eXBlLmhhc1Byb3BlckludGVyc2VjdGlvbj1mdW5jdGlvbigpe3JldHVybiB0aGlzLmhhc1Byb3Blcjt9O2pzdHMuZ2VvbWdyYXBoLmluZGV4LlNlZ21lbnRJbnRlcnNlY3Rvci5wcm90b3R5cGUuaGFzUHJvcGVySW50ZXJpb3JJbnRlcnNlY3Rpb249ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5oYXNQcm9wZXJJbnRlcmlvcjt9O2pzdHMuZ2VvbWdyYXBoLmluZGV4LlNlZ21lbnRJbnRlcnNlY3Rvci5wcm90b3R5cGUuaXNUcml2aWFsSW50ZXJzZWN0aW9uPWZ1bmN0aW9uKGUwLHNlZ0luZGV4MCxlMSxzZWdJbmRleDEpe2lmKGUwPT09ZTEpe2lmKHRoaXMubGkuZ2V0SW50ZXJzZWN0aW9uTnVtKCk9PT0xKXtpZihqc3RzLmdlb21ncmFwaC5pbmRleC5TZWdtZW50SW50ZXJzZWN0b3IuaXNBZGphY2VudFNlZ21lbnRzKHNlZ0luZGV4MCxzZWdJbmRleDEpKVxucmV0dXJuIHRydWU7aWYoZTAuaXNDbG9zZWQoKSl7dmFyIG1heFNlZ0luZGV4PWUwLmdldE51bVBvaW50cygpLTE7aWYoKHNlZ0luZGV4MD09PTAmJnNlZ0luZGV4MT09PW1heFNlZ0luZGV4KXx8KHNlZ0luZGV4MT09PTAmJnNlZ0luZGV4MD09PW1heFNlZ0luZGV4KSl7cmV0dXJuIHRydWU7fX19fVxucmV0dXJuIGZhbHNlO307anN0cy5nZW9tZ3JhcGguaW5kZXguU2VnbWVudEludGVyc2VjdG9yLnByb3RvdHlwZS5hZGRJbnRlcnNlY3Rpb25zPWZ1bmN0aW9uKGUwLHNlZ0luZGV4MCxlMSxzZWdJbmRleDEpe2lmKGUwPT09ZTEmJnNlZ0luZGV4MD09PXNlZ0luZGV4MSlcbnJldHVybjt0aGlzLm51bVRlc3RzKys7dmFyIHAwMD1lMC5nZXRDb29yZGluYXRlcygpW3NlZ0luZGV4MF07dmFyIHAwMT1lMC5nZXRDb29yZGluYXRlcygpW3NlZ0luZGV4MCsxXTt2YXIgcDEwPWUxLmdldENvb3JkaW5hdGVzKClbc2VnSW5kZXgxXTt2YXIgcDExPWUxLmdldENvb3JkaW5hdGVzKClbc2VnSW5kZXgxKzFdO3RoaXMubGkuY29tcHV0ZUludGVyc2VjdGlvbihwMDAscDAxLHAxMCxwMTEpO2lmKHRoaXMubGkuaGFzSW50ZXJzZWN0aW9uKCkpe2lmKHRoaXMucmVjb3JkSXNvbGF0ZWQpe2UwLnNldElzb2xhdGVkKGZhbHNlKTtlMS5zZXRJc29sYXRlZChmYWxzZSk7fVxudGhpcy5udW1JbnRlcnNlY3Rpb25zKys7aWYoIXRoaXMuaXNUcml2aWFsSW50ZXJzZWN0aW9uKGUwLHNlZ0luZGV4MCxlMSxzZWdJbmRleDEpKXt0aGlzLl9oYXNJbnRlcnNlY3Rpb249dHJ1ZTtpZih0aGlzLmluY2x1ZGVQcm9wZXJ8fCF0aGlzLmxpLmlzUHJvcGVyKCkpe2UwLmFkZEludGVyc2VjdGlvbnModGhpcy5saSxzZWdJbmRleDAsMCk7ZTEuYWRkSW50ZXJzZWN0aW9ucyh0aGlzLmxpLHNlZ0luZGV4MSwxKTt9XG5pZih0aGlzLmxpLmlzUHJvcGVyKCkpe3RoaXMucHJvcGVySW50ZXJzZWN0aW9uUG9pbnQ9dGhpcy5saS5nZXRJbnRlcnNlY3Rpb24oMCkuY2xvbmUoKTt0aGlzLmhhc1Byb3Blcj10cnVlO2lmKCF0aGlzLmlzQm91bmRhcnlQb2ludCh0aGlzLmxpLHRoaXMuYmR5Tm9kZXMpKVxudGhpcy5oYXNQcm9wZXJJbnRlcmlvcj10cnVlO319fX07anN0cy5nZW9tZ3JhcGguaW5kZXguU2VnbWVudEludGVyc2VjdG9yLnByb3RvdHlwZS5pc0JvdW5kYXJ5UG9pbnQ9ZnVuY3Rpb24obGksYmR5Tm9kZXMpe2lmKGJkeU5vZGVzPT09bnVsbClcbnJldHVybiBmYWxzZTtpZihiZHlOb2RlcyBpbnN0YW5jZW9mIEFycmF5KXtpZih0aGlzLmlzQm91bmRhcnlQb2ludChsaSxiZHlOb2Rlc1swXSkpXG5yZXR1cm4gdHJ1ZTtpZih0aGlzLmlzQm91bmRhcnlQb2ludChsaSxiZHlOb2Rlc1sxXSkpXG5yZXR1cm4gdHJ1ZTtyZXR1cm4gZmFsc2U7fWVsc2V7Zm9yKHZhciBpPWJkeU5vZGVzLml0ZXJhdG9yKCk7aS5oYXNOZXh0KCk7KXt2YXIgbm9kZT1pLm5leHQoKTt2YXIgcHQ9bm9kZS5nZXRDb29yZGluYXRlKCk7aWYobGkuaXNJbnRlcnNlY3Rpb24ocHQpKVxucmV0dXJuIHRydWU7fVxucmV0dXJuIGZhbHNlO319O30pKCk7IiwiLypcbiAgamF2YXNjcmlwdC51dGlsIGlzIGEgcG9ydCBvZiBzZWxlY3RlZCBwYXJ0cyBvZiBqYXZhLnV0aWwgdG8gSmF2YVNjcmlwdCB3aGljaFxuICBtYWluIHB1cnBvc2UgaXMgdG8gZWFzZSBwb3J0aW5nIEphdmEgY29kZSB0byBKYXZhU2NyaXB0LlxuICBcbiAgVGhlIE1JVCBMaWNlbnNlIChNSVQpXG5cbiAgQ29weXJpZ2h0IChDKSAyMDExLTIwMTQgYnkgVGhlIEF1dGhvcnNcblxuICBQZXJtaXNzaW9uIGlzIGhlcmVieSBncmFudGVkLCBmcmVlIG9mIGNoYXJnZSwgdG8gYW55IHBlcnNvbiBvYnRhaW5pbmcgYSBjb3B5XG4gIG9mIHRoaXMgc29mdHdhcmUgYW5kIGFzc29jaWF0ZWQgZG9jdW1lbnRhdGlvbiBmaWxlcyAodGhlIFwiU29mdHdhcmVcIiksIHRvIGRlYWxcbiAgaW4gdGhlIFNvZnR3YXJlIHdpdGhvdXQgcmVzdHJpY3Rpb24sIGluY2x1ZGluZyB3aXRob3V0IGxpbWl0YXRpb24gdGhlIHJpZ2h0c1xuICB0byB1c2UsIGNvcHksIG1vZGlmeSwgbWVyZ2UsIHB1Ymxpc2gsIGRpc3RyaWJ1dGUsIHN1YmxpY2Vuc2UsIGFuZC9vciBzZWxsXG4gIGNvcGllcyBvZiB0aGUgU29mdHdhcmUsIGFuZCB0byBwZXJtaXQgcGVyc29ucyB0byB3aG9tIHRoZSBTb2Z0d2FyZSBpc1xuICBmdXJuaXNoZWQgdG8gZG8gc28sIHN1YmplY3QgdG8gdGhlIGZvbGxvd2luZyBjb25kaXRpb25zOlxuXG4gIFRoZSBhYm92ZSBjb3B5cmlnaHQgbm90aWNlIGFuZCB0aGlzIHBlcm1pc3Npb24gbm90aWNlIHNoYWxsIGJlIGluY2x1ZGVkIGluXG4gIGFsbCBjb3BpZXMgb3Igc3Vic3RhbnRpYWwgcG9ydGlvbnMgb2YgdGhlIFNvZnR3YXJlLlxuXG4gIFRIRSBTT0ZUV0FSRSBJUyBQUk9WSURFRCBcIkFTIElTXCIsIFdJVEhPVVQgV0FSUkFOVFkgT0YgQU5ZIEtJTkQsIEVYUFJFU1MgT1JcbiAgSU1QTElFRCwgSU5DTFVESU5HIEJVVCBOT1QgTElNSVRFRCBUTyBUSEUgV0FSUkFOVElFUyBPRiBNRVJDSEFOVEFCSUxJVFksXG4gIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFIEFORCBOT05JTkZSSU5HRU1FTlQuIElOIE5PIEVWRU5UIFNIQUxMIFRIRVxuICBBVVRIT1JTIE9SIENPUFlSSUdIVCBIT0xERVJTIEJFIExJQUJMRSBGT1IgQU5ZIENMQUlNLCBEQU1BR0VTIE9SIE9USEVSXG4gIExJQUJJTElUWSwgV0hFVEhFUiBJTiBBTiBBQ1RJT04gT0YgQ09OVFJBQ1QsIFRPUlQgT1IgT1RIRVJXSVNFLCBBUklTSU5HIEZST00sXG4gIE9VVCBPRiBPUiBJTiBDT05ORUNUSU9OIFdJVEggVEhFIFNPRlRXQVJFIE9SIFRIRSBVU0UgT1IgT1RIRVIgREVBTElOR1MgSU5cbiAgVEhFIFNPRlRXQVJFLlxuKi9cbjsoZnVuY3Rpb24oKXt2YXIgZT10aGlzO2Z1bmN0aW9uIGYoYSxiKXt2YXIgYz1hLnNwbGl0KFwiLlwiKSxkPWU7Y1swXWluIGR8fCFkLmV4ZWNTY3JpcHR8fGQuZXhlY1NjcmlwdChcInZhciBcIitjWzBdKTtmb3IodmFyIHQ7Yy5sZW5ndGgmJih0PWMuc2hpZnQoKSk7KWMubGVuZ3RofHx2b2lkIDA9PT1iP2Q9ZFt0XT9kW3RdOmRbdF09e306ZFt0XT1ifWZ1bmN0aW9uIGcoYSxiKXtmdW5jdGlvbiBjKCl7fWMucHJvdG90eXBlPWIucHJvdG90eXBlO2EucT1iLnByb3RvdHlwZTthLnByb3RvdHlwZT1uZXcgYzthLnByb3RvdHlwZS5jb25zdHJ1Y3Rvcj1hO2EucD1mdW5jdGlvbihhLGMsTyl7dmFyIE09QXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLDIpO3JldHVybiBiLnByb3RvdHlwZVtjXS5hcHBseShhLE0pfX07ZnVuY3Rpb24gaChhKXt0aGlzLm1lc3NhZ2U9YXx8XCJcIn1nKGgsRXJyb3IpO2YoXCJqYXZhc2NyaXB0LnV0aWwuRW1wdHlTdGFja0V4Y2VwdGlvblwiLGgpO2gucHJvdG90eXBlLm5hbWU9XCJFbXB0eVN0YWNrRXhjZXB0aW9uXCI7ZnVuY3Rpb24gayhhKXt0aGlzLm1lc3NhZ2U9YXx8XCJcIn1nKGssRXJyb3IpO2YoXCJqYXZhc2NyaXB0LnV0aWwuSW5kZXhPdXRPZkJvdW5kc0V4Y2VwdGlvblwiLGspO2sucHJvdG90eXBlLm5hbWU9XCJJbmRleE91dE9mQm91bmRzRXhjZXB0aW9uXCI7ZnVuY3Rpb24gbCgpe31mKFwiamF2YXNjcmlwdC51dGlsLkl0ZXJhdG9yXCIsbCk7bC5wcm90b3R5cGUuaGFzTmV4dD1sLnByb3RvdHlwZS5jO2wucHJvdG90eXBlLm5leHQ9bC5wcm90b3R5cGUubmV4dDtsLnByb3RvdHlwZS5yZW1vdmU9bC5wcm90b3R5cGUucmVtb3ZlO2Z1bmN0aW9uIG0oKXt9ZihcImphdmFzY3JpcHQudXRpbC5Db2xsZWN0aW9uXCIsbSk7ZnVuY3Rpb24gbigpe31nKG4sbSk7ZihcImphdmFzY3JpcHQudXRpbC5MaXN0XCIsbik7ZnVuY3Rpb24gcCgpe31mKFwiamF2YXNjcmlwdC51dGlsLk1hcFwiLHApO2Z1bmN0aW9uIHEoYSl7dGhpcy5tZXNzYWdlPWF8fFwiXCJ9ZyhxLEVycm9yKTtmKFwiamF2YXNjcmlwdC51dGlsLk5vU3VjaEVsZW1lbnRFeGNlcHRpb25cIixxKTtxLnByb3RvdHlwZS5uYW1lPVwiTm9TdWNoRWxlbWVudEV4Y2VwdGlvblwiO2Z1bmN0aW9uIHIoYSl7dGhpcy5tZXNzYWdlPWF8fFwiXCJ9ZyhyLEVycm9yKTtyLnByb3RvdHlwZS5uYW1lPVwiT3BlcmF0aW9uTm90U3VwcG9ydGVkXCI7ZnVuY3Rpb24gcyhhKXt0aGlzLmE9W107YSBpbnN0YW5jZW9mIG0mJnRoaXMuZShhKX1nKHMsbik7ZihcImphdmFzY3JpcHQudXRpbC5BcnJheUxpc3RcIixzKTtzLnByb3RvdHlwZS5hPW51bGw7cy5wcm90b3R5cGUuYWRkPWZ1bmN0aW9uKGEpe3RoaXMuYS5wdXNoKGEpO3JldHVybiEwfTtzLnByb3RvdHlwZS5hZGQ9cy5wcm90b3R5cGUuYWRkO3MucHJvdG90eXBlLmU9ZnVuY3Rpb24oYSl7Zm9yKGE9YS5mKCk7YS5jKCk7KXRoaXMuYWRkKGEubmV4dCgpKTtyZXR1cm4hMH07cy5wcm90b3R5cGUuYWRkQWxsPXMucHJvdG90eXBlLmU7cy5wcm90b3R5cGUuc2V0PWZ1bmN0aW9uKGEsYil7dmFyIGM9dGhpcy5hW2FdO3RoaXMuYVthXT1iO3JldHVybiBjfTtzLnByb3RvdHlwZS5zZXQ9cy5wcm90b3R5cGUuc2V0O3MucHJvdG90eXBlLmY9ZnVuY3Rpb24oKXtyZXR1cm4gbmV3IHUodGhpcyl9O3MucHJvdG90eXBlLml0ZXJhdG9yPXMucHJvdG90eXBlLmY7XG5zLnByb3RvdHlwZS5nZXQ9ZnVuY3Rpb24oYSl7aWYoMD5hfHxhPj10aGlzLnNpemUoKSl0aHJvdyBuZXcgaztyZXR1cm4gdGhpcy5hW2FdfTtzLnByb3RvdHlwZS5nZXQ9cy5wcm90b3R5cGUuZ2V0O3MucHJvdG90eXBlLmc9ZnVuY3Rpb24oKXtyZXR1cm4gMD09PXRoaXMuYS5sZW5ndGh9O3MucHJvdG90eXBlLmlzRW1wdHk9cy5wcm90b3R5cGUuZztzLnByb3RvdHlwZS5zaXplPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuYS5sZW5ndGh9O3MucHJvdG90eXBlLnNpemU9cy5wcm90b3R5cGUuc2l6ZTtzLnByb3RvdHlwZS5oPWZ1bmN0aW9uKCl7Zm9yKHZhciBhPVtdLGI9MCxjPXRoaXMuYS5sZW5ndGg7YjxjO2IrKylhLnB1c2godGhpcy5hW2JdKTtyZXR1cm4gYX07cy5wcm90b3R5cGUudG9BcnJheT1zLnByb3RvdHlwZS5oO1xucy5wcm90b3R5cGUucmVtb3ZlPWZ1bmN0aW9uKGEpe2Zvcih2YXIgYj0hMSxjPTAsZD10aGlzLmEubGVuZ3RoO2M8ZDtjKyspaWYodGhpcy5hW2NdPT09YSl7dGhpcy5hLnNwbGljZShjLDEpO2I9ITA7YnJlYWt9cmV0dXJuIGJ9O3MucHJvdG90eXBlLnJlbW92ZT1zLnByb3RvdHlwZS5yZW1vdmU7ZnVuY3Rpb24gdShhKXt0aGlzLmo9YX1mKFwiJGpzY29tcC5zY29wZS5JdGVyYXRvcl9cIix1KTt1LnByb3RvdHlwZS5qPW51bGw7dS5wcm90b3R5cGUuYj0wO3UucHJvdG90eXBlLm5leHQ9ZnVuY3Rpb24oKXtpZih0aGlzLmI9PT10aGlzLmouc2l6ZSgpKXRocm93IG5ldyBxO3JldHVybiB0aGlzLmouZ2V0KHRoaXMuYisrKX07dS5wcm90b3R5cGUubmV4dD11LnByb3RvdHlwZS5uZXh0O3UucHJvdG90eXBlLmM9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5iPHRoaXMuai5zaXplKCk/ITA6ITF9O3UucHJvdG90eXBlLmhhc05leHQ9dS5wcm90b3R5cGUuYztcbnUucHJvdG90eXBlLnJlbW92ZT1mdW5jdGlvbigpe3Rocm93IG5ldyByO307dS5wcm90b3R5cGUucmVtb3ZlPXUucHJvdG90eXBlLnJlbW92ZTtmdW5jdGlvbiB2KCl7fWYoXCJqYXZhc2NyaXB0LnV0aWwuQXJyYXlzXCIsdik7XG52LnNvcnQ9ZnVuY3Rpb24oKXt2YXIgYT1hcmd1bWVudHNbMF0sYixjLGQ7aWYoMT09PWFyZ3VtZW50cy5sZW5ndGgpYS5zb3J0KCk7ZWxzZSBpZigyPT09YXJndW1lbnRzLmxlbmd0aCljPWFyZ3VtZW50c1sxXSxkPWZ1bmN0aW9uKGEsYil7cmV0dXJuIGMuY29tcGFyZShhLGIpfSxhLnNvcnQoZCk7ZWxzZSBpZigzPT09YXJndW1lbnRzLmxlbmd0aClmb3IoYj1hLnNsaWNlKGFyZ3VtZW50c1sxXSxhcmd1bWVudHNbMl0pLGIuc29ydCgpLGQ9YS5zbGljZSgwLGFyZ3VtZW50c1sxXSkuY29uY2F0KGIsYS5zbGljZShhcmd1bWVudHNbMl0sYS5sZW5ndGgpKSxhLnNwbGljZSgwLGEubGVuZ3RoKSxiPTA7YjxkLmxlbmd0aDtiKyspYS5wdXNoKGRbYl0pO2Vsc2UgaWYoND09PWFyZ3VtZW50cy5sZW5ndGgpZm9yKGI9YS5zbGljZShhcmd1bWVudHNbMV0sYXJndW1lbnRzWzJdKSxjPWFyZ3VtZW50c1szXSxkPWZ1bmN0aW9uKGEsYil7cmV0dXJuIGMuY29tcGFyZShhLGIpfSxiLnNvcnQoZCksXG5kPWEuc2xpY2UoMCxhcmd1bWVudHNbMV0pLmNvbmNhdChiLGEuc2xpY2UoYXJndW1lbnRzWzJdLGEubGVuZ3RoKSksYS5zcGxpY2UoMCxhLmxlbmd0aCksYj0wO2I8ZC5sZW5ndGg7YisrKWEucHVzaChkW2JdKX07di5hc0xpc3Q9ZnVuY3Rpb24oYSl7Zm9yKHZhciBiPW5ldyBzLGM9MCxkPWEubGVuZ3RoO2M8ZDtjKyspYi5hZGQoYVtjXSk7cmV0dXJuIGJ9O2Z1bmN0aW9uIHcoKXt0aGlzLmk9e319Zyh3LHApO2YoXCJqYXZhc2NyaXB0LnV0aWwuSGFzaE1hcFwiLHcpO3cucHJvdG90eXBlLmk9bnVsbDt3LnByb3RvdHlwZS5nZXQ9ZnVuY3Rpb24oYSl7cmV0dXJuIHRoaXMuaVthXXx8bnVsbH07dy5wcm90b3R5cGUuZ2V0PXcucHJvdG90eXBlLmdldDt3LnByb3RvdHlwZS5wdXQ9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gdGhpcy5pW2FdPWJ9O3cucHJvdG90eXBlLnB1dD13LnByb3RvdHlwZS5wdXQ7dy5wcm90b3R5cGUubT1mdW5jdGlvbigpe3ZhciBhPW5ldyBzLGI7Zm9yKGIgaW4gdGhpcy5pKXRoaXMuaS5oYXNPd25Qcm9wZXJ0eShiKSYmYS5hZGQodGhpcy5pW2JdKTtyZXR1cm4gYX07dy5wcm90b3R5cGUudmFsdWVzPXcucHJvdG90eXBlLm07dy5wcm90b3R5cGUuc2l6ZT1mdW5jdGlvbigpe3JldHVybiB0aGlzLm0oKS5zaXplKCl9O3cucHJvdG90eXBlLnNpemU9dy5wcm90b3R5cGUuc2l6ZTtmdW5jdGlvbiB4KCl7fWcoeCxtKTtmKFwiamF2YXNjcmlwdC51dGlsLlNldFwiLHgpO2Z1bmN0aW9uIHkoYSl7dGhpcy5hPVtdO2EgaW5zdGFuY2VvZiBtJiZ0aGlzLmUoYSl9Zyh5LHgpO2YoXCJqYXZhc2NyaXB0LnV0aWwuSGFzaFNldFwiLHkpO3kucHJvdG90eXBlLmE9bnVsbDt5LnByb3RvdHlwZS5jb250YWlucz1mdW5jdGlvbihhKXtmb3IodmFyIGI9MCxjPXRoaXMuYS5sZW5ndGg7YjxjO2IrKylpZih0aGlzLmFbYl09PT1hKXJldHVybiEwO3JldHVybiExfTt5LnByb3RvdHlwZS5jb250YWlucz15LnByb3RvdHlwZS5jb250YWluczt5LnByb3RvdHlwZS5hZGQ9ZnVuY3Rpb24oYSl7aWYodGhpcy5jb250YWlucyhhKSlyZXR1cm4hMTt0aGlzLmEucHVzaChhKTtyZXR1cm4hMH07eS5wcm90b3R5cGUuYWRkPXkucHJvdG90eXBlLmFkZDt5LnByb3RvdHlwZS5lPWZ1bmN0aW9uKGEpe2ZvcihhPWEuZigpO2EuYygpOyl0aGlzLmFkZChhLm5leHQoKSk7cmV0dXJuITB9O3kucHJvdG90eXBlLmFkZEFsbD15LnByb3RvdHlwZS5lO1xueS5wcm90b3R5cGUucmVtb3ZlPWZ1bmN0aW9uKCl7dGhyb3cgbmV3IHI7fTt5LnByb3RvdHlwZS5yZW1vdmU9eS5wcm90b3R5cGUucmVtb3ZlO3kucHJvdG90eXBlLnNpemU9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5hLmxlbmd0aH07eS5wcm90b3R5cGUuZz1mdW5jdGlvbigpe3JldHVybiAwPT09dGhpcy5hLmxlbmd0aH07eS5wcm90b3R5cGUuaXNFbXB0eT15LnByb3RvdHlwZS5nO3kucHJvdG90eXBlLmg9ZnVuY3Rpb24oKXtmb3IodmFyIGE9W10sYj0wLGM9dGhpcy5hLmxlbmd0aDtiPGM7YisrKWEucHVzaCh0aGlzLmFbYl0pO3JldHVybiBhfTt5LnByb3RvdHlwZS50b0FycmF5PXkucHJvdG90eXBlLmg7eS5wcm90b3R5cGUuZj1mdW5jdGlvbigpe3JldHVybiBuZXcgeih0aGlzKX07eS5wcm90b3R5cGUuaXRlcmF0b3I9eS5wcm90b3R5cGUuZjtmdW5jdGlvbiB6KGEpe3RoaXMuaz1hfWYoXCIkanNjb21wLnNjb3BlLkl0ZXJhdG9yXyQxXCIseik7ei5wcm90b3R5cGUuaz1udWxsO1xuei5wcm90b3R5cGUuYj0wO3oucHJvdG90eXBlLm5leHQ9ZnVuY3Rpb24oKXtpZih0aGlzLmI9PT10aGlzLmsuc2l6ZSgpKXRocm93IG5ldyBxO3JldHVybiB0aGlzLmsuYVt0aGlzLmIrK119O3oucHJvdG90eXBlLm5leHQ9ei5wcm90b3R5cGUubmV4dDt6LnByb3RvdHlwZS5jPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuYjx0aGlzLmsuc2l6ZSgpPyEwOiExfTt6LnByb3RvdHlwZS5oYXNOZXh0PXoucHJvdG90eXBlLmM7ei5wcm90b3R5cGUucmVtb3ZlPWZ1bmN0aW9uKCl7dGhyb3cgbmV3IHI7fTt6LnByb3RvdHlwZS5yZW1vdmU9ei5wcm90b3R5cGUucmVtb3ZlO2Z1bmN0aW9uIEEoKXt9ZyhBLHApO2YoXCJqYXZhc2NyaXB0LnV0aWwuU29ydGVkTWFwXCIsQSk7ZnVuY3Rpb24gQigpe31nKEIseCk7ZihcImphdmFzY3JpcHQudXRpbC5Tb3J0ZWRTZXRcIixCKTtmdW5jdGlvbiBDKCl7dGhpcy5hPVtdfWcoQyxuKTtmKFwiamF2YXNjcmlwdC51dGlsLlN0YWNrXCIsQyk7Qy5wcm90b3R5cGUuYT1udWxsO0MucHJvdG90eXBlLnB1c2g9ZnVuY3Rpb24oYSl7dGhpcy5hLnB1c2goYSk7cmV0dXJuIGF9O0MucHJvdG90eXBlLnB1c2g9Qy5wcm90b3R5cGUucHVzaDtDLnByb3RvdHlwZS5wb3A9ZnVuY3Rpb24oKXtpZigwPT09dGhpcy5hLmxlbmd0aCl0aHJvdyBuZXcgaDtyZXR1cm4gdGhpcy5hLnBvcCgpfTtDLnByb3RvdHlwZS5wb3A9Qy5wcm90b3R5cGUucG9wO0MucHJvdG90eXBlLm89ZnVuY3Rpb24oKXtpZigwPT09dGhpcy5hLmxlbmd0aCl0aHJvdyBuZXcgaDtyZXR1cm4gdGhpcy5hW3RoaXMuYS5sZW5ndGgtMV19O0MucHJvdG90eXBlLnBlZWs9Qy5wcm90b3R5cGUubztDLnByb3RvdHlwZS5lbXB0eT1mdW5jdGlvbigpe3JldHVybiAwPT09dGhpcy5hLmxlbmd0aD8hMDohMX07Qy5wcm90b3R5cGUuZW1wdHk9Qy5wcm90b3R5cGUuZW1wdHk7XG5DLnByb3RvdHlwZS5nPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZW1wdHkoKX07Qy5wcm90b3R5cGUuaXNFbXB0eT1DLnByb3RvdHlwZS5nO0MucHJvdG90eXBlLnNlYXJjaD1mdW5jdGlvbihhKXtyZXR1cm4gdGhpcy5hLmluZGV4T2YoYSl9O0MucHJvdG90eXBlLnNlYXJjaD1DLnByb3RvdHlwZS5zZWFyY2g7Qy5wcm90b3R5cGUuc2l6ZT1mdW5jdGlvbigpe3JldHVybiB0aGlzLmEubGVuZ3RofTtDLnByb3RvdHlwZS5zaXplPUMucHJvdG90eXBlLnNpemU7Qy5wcm90b3R5cGUuaD1mdW5jdGlvbigpe2Zvcih2YXIgYT1bXSxiPTAsYz10aGlzLmEubGVuZ3RoO2I8YztiKyspYS5wdXNoKHRoaXMuYVtiXSk7cmV0dXJuIGF9O0MucHJvdG90eXBlLnRvQXJyYXk9Qy5wcm90b3R5cGUuaDtmdW5jdGlvbiBEKGEpe3JldHVybiBudWxsPT1hP251bGw6YS5wYXJlbnR9ZnVuY3Rpb24gRShhLGIpe251bGwhPT1hJiYoYS5jb2xvcj1iKX1mdW5jdGlvbiBGKGEpe3JldHVybiBudWxsPT1hP251bGw6YS5sZWZ0fWZ1bmN0aW9uIEcoYSl7cmV0dXJuIG51bGw9PWE/bnVsbDphLnJpZ2h0fWZ1bmN0aW9uIEgoKXt0aGlzLmQ9bnVsbDt0aGlzLm49MH1nKEgsQSk7ZihcImphdmFzY3JpcHQudXRpbC5UcmVlTWFwXCIsSCk7SC5wcm90b3R5cGUuZ2V0PWZ1bmN0aW9uKGEpe2Zvcih2YXIgYj10aGlzLmQ7bnVsbCE9PWI7KXt2YXIgYz1hLmNvbXBhcmVUbyhiLmtleSk7aWYoMD5jKWI9Yi5sZWZ0O2Vsc2UgaWYoMDxjKWI9Yi5yaWdodDtlbHNlIHJldHVybiBiLnZhbHVlfXJldHVybiBudWxsfTtILnByb3RvdHlwZS5nZXQ9SC5wcm90b3R5cGUuZ2V0O1xuSC5wcm90b3R5cGUucHV0PWZ1bmN0aW9uKGEsYil7aWYobnVsbD09PXRoaXMuZClyZXR1cm4gdGhpcy5kPXtrZXk6YSx2YWx1ZTpiLGxlZnQ6bnVsbCxyaWdodDpudWxsLHBhcmVudDpudWxsLGNvbG9yOjB9LHRoaXMubj0xLG51bGw7dmFyIGM9dGhpcy5kLGQsdDtkbyBpZihkPWMsdD1hLmNvbXBhcmVUbyhjLmtleSksMD50KWM9Yy5sZWZ0O2Vsc2UgaWYoMDx0KWM9Yy5yaWdodDtlbHNlIHJldHVybiBkPWMudmFsdWUsYy52YWx1ZT1iLGQ7d2hpbGUobnVsbCE9PWMpO2M9e2tleTphLGxlZnQ6bnVsbCxyaWdodDpudWxsLHZhbHVlOmIscGFyZW50OmQsY29sb3I6MH07MD50P2QubGVmdD1jOmQucmlnaHQ9Yztmb3IoYy5jb2xvcj0xO251bGwhPWMmJmMhPXRoaXMuZCYmMT09Yy5wYXJlbnQuY29sb3I7KUQoYyk9PUYoRChEKGMpKSk/KGQ9RyhEKEQoYykpKSwxPT0obnVsbD09ZD8wOmQuY29sb3IpPyhFKEQoYyksMCksRShkLDApLEUoRChEKGMpKSwxKSxjPUQoRChjKSkpOihjPT1HKEQoYykpJiZcbihjPUQoYyksSSh0aGlzLGMpKSxFKEQoYyksMCksRShEKEQoYykpLDEpLEoodGhpcyxEKEQoYykpKSkpOihkPUYoRChEKGMpKSksMT09KG51bGw9PWQ/MDpkLmNvbG9yKT8oRShEKGMpLDApLEUoZCwwKSxFKEQoRChjKSksMSksYz1EKEQoYykpKTooYz09RihEKGMpKSYmKGM9RChjKSxKKHRoaXMsYykpLEUoRChjKSwwKSxFKEQoRChjKSksMSksSSh0aGlzLEQoRChjKSkpKSk7dGhpcy5kLmNvbG9yPTA7dGhpcy5uKys7cmV0dXJuIG51bGx9O0gucHJvdG90eXBlLnB1dD1ILnByb3RvdHlwZS5wdXQ7SC5wcm90b3R5cGUubT1mdW5jdGlvbigpe3ZhciBhPW5ldyBzLGI7Yj10aGlzLmQ7aWYobnVsbCE9Yilmb3IoO251bGwhPWIubGVmdDspYj1iLmxlZnQ7aWYobnVsbCE9PWIpZm9yKGEuYWRkKGIudmFsdWUpO251bGwhPT0oYj1LKGIpKTspYS5hZGQoYi52YWx1ZSk7cmV0dXJuIGF9O0gucHJvdG90eXBlLnZhbHVlcz1ILnByb3RvdHlwZS5tO1xuZnVuY3Rpb24gSShhLGIpe2lmKG51bGwhPWIpe3ZhciBjPWIucmlnaHQ7Yi5yaWdodD1jLmxlZnQ7bnVsbCE9Yy5sZWZ0JiYoYy5sZWZ0LnBhcmVudD1iKTtjLnBhcmVudD1iLnBhcmVudDtudWxsPT1iLnBhcmVudD9hLmQ9YzpiLnBhcmVudC5sZWZ0PT1iP2IucGFyZW50LmxlZnQ9YzpiLnBhcmVudC5yaWdodD1jO2MubGVmdD1iO2IucGFyZW50PWN9fWZ1bmN0aW9uIEooYSxiKXtpZihudWxsIT1iKXt2YXIgYz1iLmxlZnQ7Yi5sZWZ0PWMucmlnaHQ7bnVsbCE9Yy5yaWdodCYmKGMucmlnaHQucGFyZW50PWIpO2MucGFyZW50PWIucGFyZW50O251bGw9PWIucGFyZW50P2EuZD1jOmIucGFyZW50LnJpZ2h0PT1iP2IucGFyZW50LnJpZ2h0PWM6Yi5wYXJlbnQubGVmdD1jO2MucmlnaHQ9YjtiLnBhcmVudD1jfX1cbmZ1bmN0aW9uIEsoYSl7aWYobnVsbD09PWEpcmV0dXJuIG51bGw7aWYobnVsbCE9PWEucmlnaHQpZm9yKHZhciBiPWEucmlnaHQ7bnVsbCE9PWIubGVmdDspYj1iLmxlZnQ7ZWxzZSBmb3IoYj1hLnBhcmVudDtudWxsIT09YiYmYT09PWIucmlnaHQ7KWE9YixiPWIucGFyZW50O3JldHVybiBifUgucHJvdG90eXBlLnNpemU9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5ufTtILnByb3RvdHlwZS5zaXplPUgucHJvdG90eXBlLnNpemU7ZnVuY3Rpb24gTChhKXt0aGlzLmE9W107YSBpbnN0YW5jZW9mIG0mJnRoaXMuZShhKX1nKEwsQik7ZihcImphdmFzY3JpcHQudXRpbC5UcmVlU2V0XCIsTCk7TC5wcm90b3R5cGUuYT1udWxsO0wucHJvdG90eXBlLmNvbnRhaW5zPWZ1bmN0aW9uKGEpe2Zvcih2YXIgYj0wLGM9dGhpcy5hLmxlbmd0aDtiPGM7YisrKWlmKDA9PT10aGlzLmFbYl0uY29tcGFyZVRvKGEpKXJldHVybiEwO3JldHVybiExfTtMLnByb3RvdHlwZS5jb250YWlucz1MLnByb3RvdHlwZS5jb250YWlucztMLnByb3RvdHlwZS5hZGQ9ZnVuY3Rpb24oYSl7aWYodGhpcy5jb250YWlucyhhKSlyZXR1cm4hMTtmb3IodmFyIGI9MCxjPXRoaXMuYS5sZW5ndGg7YjxjO2IrKylpZigxPT09dGhpcy5hW2JdLmNvbXBhcmVUbyhhKSlyZXR1cm4gdGhpcy5hLnNwbGljZShiLDAsYSksITA7dGhpcy5hLnB1c2goYSk7cmV0dXJuITB9O0wucHJvdG90eXBlLmFkZD1MLnByb3RvdHlwZS5hZGQ7XG5MLnByb3RvdHlwZS5lPWZ1bmN0aW9uKGEpe2ZvcihhPWEuZigpO2EuYygpOyl0aGlzLmFkZChhLm5leHQoKSk7cmV0dXJuITB9O0wucHJvdG90eXBlLmFkZEFsbD1MLnByb3RvdHlwZS5lO0wucHJvdG90eXBlLnJlbW92ZT1mdW5jdGlvbigpe3Rocm93IG5ldyByO307TC5wcm90b3R5cGUucmVtb3ZlPUwucHJvdG90eXBlLnJlbW92ZTtMLnByb3RvdHlwZS5zaXplPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuYS5sZW5ndGh9O0wucHJvdG90eXBlLnNpemU9TC5wcm90b3R5cGUuc2l6ZTtMLnByb3RvdHlwZS5nPWZ1bmN0aW9uKCl7cmV0dXJuIDA9PT10aGlzLmEubGVuZ3RofTtMLnByb3RvdHlwZS5pc0VtcHR5PUwucHJvdG90eXBlLmc7TC5wcm90b3R5cGUuaD1mdW5jdGlvbigpe2Zvcih2YXIgYT1bXSxiPTAsYz10aGlzLmEubGVuZ3RoO2I8YztiKyspYS5wdXNoKHRoaXMuYVtiXSk7cmV0dXJuIGF9O0wucHJvdG90eXBlLnRvQXJyYXk9TC5wcm90b3R5cGUuaDtMLnByb3RvdHlwZS5mPWZ1bmN0aW9uKCl7cmV0dXJuIG5ldyBOKHRoaXMpfTtcbkwucHJvdG90eXBlLml0ZXJhdG9yPUwucHJvdG90eXBlLmY7ZnVuY3Rpb24gTihhKXt0aGlzLmw9YX1mKFwiJGpzY29tcC5zY29wZS5JdGVyYXRvcl8kMlwiLE4pO04ucHJvdG90eXBlLmw9bnVsbDtOLnByb3RvdHlwZS5iPTA7Ti5wcm90b3R5cGUubmV4dD1mdW5jdGlvbigpe2lmKHRoaXMuYj09PXRoaXMubC5zaXplKCkpdGhyb3cgbmV3IHE7cmV0dXJuIHRoaXMubC5hW3RoaXMuYisrXX07Ti5wcm90b3R5cGUubmV4dD1OLnByb3RvdHlwZS5uZXh0O04ucHJvdG90eXBlLmM9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5iPHRoaXMubC5zaXplKCk/ITA6ITF9O04ucHJvdG90eXBlLmhhc05leHQ9Ti5wcm90b3R5cGUuYztOLnByb3RvdHlwZS5yZW1vdmU9ZnVuY3Rpb24oKXt0aHJvdyBuZXcgcjt9O04ucHJvdG90eXBlLnJlbW92ZT1OLnByb3RvdHlwZS5yZW1vdmU7XCJ1bmRlZmluZWRcIiE9PXR5cGVvZiBnbG9iYWwmJihnbG9iYWwuamF2YXNjcmlwdD17fSxnbG9iYWwuamF2YXNjcmlwdC51dGlsPXt9LGdsb2JhbC5qYXZhc2NyaXB0LnV0aWwuQXJyYXlMaXN0PXMsZ2xvYmFsLmphdmFzY3JpcHQudXRpbC5BcnJheXM9dixnbG9iYWwuamF2YXNjcmlwdC51dGlsLkNvbGxlY3Rpb249bSxnbG9iYWwuamF2YXNjcmlwdC51dGlsLkVtcHR5U3RhY2tFeGNlcHRpb249aCxnbG9iYWwuamF2YXNjcmlwdC51dGlsLkhhc2hNYXA9dyxnbG9iYWwuamF2YXNjcmlwdC51dGlsLkhhc2hTZXQ9eSxnbG9iYWwuamF2YXNjcmlwdC51dGlsLkluZGV4T3V0T2ZCb3VuZHNFeGNlcHRpb249ayxnbG9iYWwuamF2YXNjcmlwdC51dGlsLkl0ZXJhdG9yPWwsZ2xvYmFsLmphdmFzY3JpcHQudXRpbC5MaXN0PW4sZ2xvYmFsLmphdmFzY3JpcHQudXRpbC5NYXA9cCxnbG9iYWwuamF2YXNjcmlwdC51dGlsLk5vU3VjaEVsZW1lbnRFeGNlcHRpb249cSxnbG9iYWwuamF2YXNjcmlwdC51dGlsLk9wZXJhdGlvbk5vdFN1cHBvcnRlZD1cbnIsZ2xvYmFsLmphdmFzY3JpcHQudXRpbC5TZXQ9eCxnbG9iYWwuamF2YXNjcmlwdC51dGlsLlNvcnRlZE1hcD1BLGdsb2JhbC5qYXZhc2NyaXB0LnV0aWwuU29ydGVkU2V0PUIsZ2xvYmFsLmphdmFzY3JpcHQudXRpbC5TdGFjaz1DLGdsb2JhbC5qYXZhc2NyaXB0LnV0aWwuVHJlZU1hcD1ILGdsb2JhbC5qYXZhc2NyaXB0LnV0aWwuVHJlZVNldD1MKTt9KS5jYWxsKHRoaXMpO1xuIiwicmVxdWlyZSgnLi9kaXN0L2phdmFzY3JpcHQudXRpbC1ub2RlLm1pbi5qcycpO1xuIiwiLyoqXG4gKiBUYWtlcyBvbmUgb3IgbW9yZSB7QGxpbmsgRmVhdHVyZXxGZWF0dXJlc30gYW5kIGNyZWF0ZXMgYSB7QGxpbmsgRmVhdHVyZUNvbGxlY3Rpb259XG4gKlxuICogQG1vZHVsZSB0dXJmL2ZlYXR1cmVjb2xsZWN0aW9uXG4gKiBAY2F0ZWdvcnkgaGVscGVyXG4gKiBAcGFyYW0ge0ZlYXR1cmV9IGZlYXR1cmVzIGlucHV0IEZlYXR1cmVzXG4gKiBAcmV0dXJucyB7RmVhdHVyZUNvbGxlY3Rpb259IGEgRmVhdHVyZUNvbGxlY3Rpb24gb2YgaW5wdXQgZmVhdHVyZXNcbiAqIEBleGFtcGxlXG4gKiB2YXIgZmVhdHVyZXMgPSBbXG4gKiAgdHVyZi5wb2ludChbLTc1LjM0MywgMzkuOTg0XSwge25hbWU6ICdMb2NhdGlvbiBBJ30pLFxuICogIHR1cmYucG9pbnQoWy03NS44MzMsIDM5LjI4NF0sIHtuYW1lOiAnTG9jYXRpb24gQid9KSxcbiAqICB0dXJmLnBvaW50KFstNzUuNTM0LCAzOS4xMjNdLCB7bmFtZTogJ0xvY2F0aW9uIEMnfSlcbiAqIF07XG4gKlxuICogdmFyIGZjID0gdHVyZi5mZWF0dXJlY29sbGVjdGlvbihmZWF0dXJlcyk7XG4gKlxuICogLy89ZmNcbiAqL1xubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihmZWF0dXJlcyl7XG4gIHJldHVybiB7XG4gICAgdHlwZTogXCJGZWF0dXJlQ29sbGVjdGlvblwiLFxuICAgIGZlYXR1cmVzOiBmZWF0dXJlc1xuICB9O1xufTtcbiIsIi8qKlxuICogVGFrZXMgY29vcmRpbmF0ZXMgYW5kIHByb3BlcnRpZXMgKG9wdGlvbmFsKSBhbmQgcmV0dXJucyBhIG5ldyB7QGxpbmsgUG9pbnR9IGZlYXR1cmUuXG4gKlxuICogQG1vZHVsZSB0dXJmL3BvaW50XG4gKiBAY2F0ZWdvcnkgaGVscGVyXG4gKiBAcGFyYW0ge251bWJlcn0gbG9uZ2l0dWRlIHBvc2l0aW9uIHdlc3QgdG8gZWFzdCBpbiBkZWNpbWFsIGRlZ3JlZXNcbiAqIEBwYXJhbSB7bnVtYmVyfSBsYXRpdHVkZSBwb3NpdGlvbiBzb3V0aCB0byBub3J0aCBpbiBkZWNpbWFsIGRlZ3JlZXNcbiAqIEBwYXJhbSB7T2JqZWN0fSBwcm9wZXJ0aWVzIGFuIE9iamVjdCB0aGF0IGlzIHVzZWQgYXMgdGhlIHtAbGluayBGZWF0dXJlfSdzXG4gKiBwcm9wZXJ0aWVzXG4gKiBAcmV0dXJuIHtQb2ludH0gYSBQb2ludCBmZWF0dXJlXG4gKiBAZXhhbXBsZVxuICogdmFyIHB0MSA9IHR1cmYucG9pbnQoWy03NS4zNDMsIDM5Ljk4NF0pO1xuICpcbiAqIC8vPXB0MVxuICovXG52YXIgaXNBcnJheSA9IEFycmF5LmlzQXJyYXkgfHwgZnVuY3Rpb24oYXJnKSB7XG4gIHJldHVybiBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwoYXJnKSA9PT0gJ1tvYmplY3QgQXJyYXldJztcbn07XG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGNvb3JkaW5hdGVzLCBwcm9wZXJ0aWVzKSB7XG4gIGlmICghaXNBcnJheShjb29yZGluYXRlcykpIHRocm93IG5ldyBFcnJvcignQ29vcmRpbmF0ZXMgbXVzdCBiZSBhbiBhcnJheScpO1xuICBpZiAoY29vcmRpbmF0ZXMubGVuZ3RoIDwgMikgdGhyb3cgbmV3IEVycm9yKCdDb29yZGluYXRlcyBtdXN0IGJlIGF0IGxlYXN0IDIgbnVtYmVycyBsb25nJyk7XG4gIHJldHVybiB7XG4gICAgdHlwZTogXCJGZWF0dXJlXCIsXG4gICAgZ2VvbWV0cnk6IHtcbiAgICAgIHR5cGU6IFwiUG9pbnRcIixcbiAgICAgIGNvb3JkaW5hdGVzOiBjb29yZGluYXRlc1xuICAgIH0sXG4gICAgcHJvcGVydGllczogcHJvcGVydGllcyB8fCB7fVxuICB9O1xufTtcbiIsInZhciBpbnNpZGUgPSByZXF1aXJlKCd0dXJmLWluc2lkZScpO1xudmFyIGZlYXR1cmVDb2xsZWN0aW9uID0gcmVxdWlyZSgndHVyZi1mZWF0dXJlY29sbGVjdGlvbicpO1xuXG4vKipcbiAqIFRha2VzIGEge0BsaW5rIEZlYXR1cmVDb2xsZWN0aW9ufSBvZiB7QGxpbmsgUG9pbnR9IGZlYXR1cmVzIGFuZCBhIEZlYXR1cmVDb2xsZWN0aW9uIG9mIHtAbGluayBQb2x5Z29ufSBmZWF0dXJlcyBhbmQgcmV0dXJucyBhIEZlYXR1cmVDb2xsZWN0aW9uIG9mIFBvaW50IGZlYXR1cmVzIHJlcHJlc2VudGluZyBhbGwgcG9pbnRzIHRoYXQgZmFsbCB3aXRoaW4gYSBjb2xsZWN0aW9uIG9mIHBvbHlnb25zLlxuICpcbiAqIEBtb2R1bGUgdHVyZi93aXRoaW5cbiAqIEBjYXRlZ29yeSBqb2luc1xuICogQHBhcmFtIHtGZWF0dXJlQ29sbGVjdGlvbn0gcG9pbnRzIGEgRmVhdHVyZUNvbGxlY3Rpb24gb2Yge0BsaW5rIFBvaW50fSBmZWF0dXJlc1xuICogQHBhcmFtIHtGZWF0dXJlQ29sbGVjdGlvbn0gcG9seWdvbnMgYSBGZWF0dXJlQ29sbGVjdGlvbiBvZiB7QGxpbmsgUG9seWdvbn0gZmVhdHVyZXNcbiAqIEByZXR1cm4ge0ZlYXR1cmVDb2xsZWN0aW9ufSBhIGNvbGxlY3Rpb24gb2YgYWxsIHBvaW50cyB0aGF0IGxhbmRcbiAqIHdpdGhpbiBhdCBsZWFzdCBvbmUgcG9seWdvblxuICogQGV4YW1wbGVcbiAqIHZhciBzZWFyY2hXaXRoaW4gPSB7XG4gKiAgIFwidHlwZVwiOiBcIkZlYXR1cmVDb2xsZWN0aW9uXCIsXG4gKiAgIFwiZmVhdHVyZXNcIjogW1xuICogICAgIHtcbiAqICAgICAgIFwidHlwZVwiOiBcIkZlYXR1cmVcIixcbiAqICAgICAgIFwicHJvcGVydGllc1wiOiB7fSxcbiAqICAgICAgIFwiZ2VvbWV0cnlcIjoge1xuICogICAgICAgICBcInR5cGVcIjogXCJQb2x5Z29uXCIsXG4gKiAgICAgICAgIFwiY29vcmRpbmF0ZXNcIjogW1tcbiAqICAgICAgICAgICBbLTQ2LjY1MywtMjMuNTQzXSxcbiAqICAgICAgICAgICBbLTQ2LjYzNCwtMjMuNTM0Nl0sXG4gKiAgICAgICAgICAgWy00Ni42MTMsLTIzLjU0M10sXG4gKiAgICAgICAgICAgWy00Ni42MTQsLTIzLjU1OV0sXG4gKiAgICAgICAgICAgWy00Ni42MzEsLTIzLjU2N10sXG4gKiAgICAgICAgICAgWy00Ni42NTMsLTIzLjU2MF0sXG4gKiAgICAgICAgICAgWy00Ni42NTMsLTIzLjU0M11cbiAqICAgICAgICAgXV1cbiAqICAgICAgIH1cbiAqICAgICB9XG4gKiAgIF1cbiAqIH07XG4gKiB2YXIgcG9pbnRzID0ge1xuICogICBcInR5cGVcIjogXCJGZWF0dXJlQ29sbGVjdGlvblwiLFxuICogICBcImZlYXR1cmVzXCI6IFtcbiAqICAgICB7XG4gKiAgICAgICBcInR5cGVcIjogXCJGZWF0dXJlXCIsXG4gKiAgICAgICBcInByb3BlcnRpZXNcIjoge30sXG4gKiAgICAgICBcImdlb21ldHJ5XCI6IHtcbiAqICAgICAgICAgXCJ0eXBlXCI6IFwiUG9pbnRcIixcbiAqICAgICAgICAgXCJjb29yZGluYXRlc1wiOiBbLTQ2LjYzMTgsIC0yMy41NTIzXVxuICogICAgICAgfVxuICogICAgIH0sIHtcbiAqICAgICAgIFwidHlwZVwiOiBcIkZlYXR1cmVcIixcbiAqICAgICAgIFwicHJvcGVydGllc1wiOiB7fSxcbiAqICAgICAgIFwiZ2VvbWV0cnlcIjoge1xuICogICAgICAgICBcInR5cGVcIjogXCJQb2ludFwiLFxuICogICAgICAgICBcImNvb3JkaW5hdGVzXCI6IFstNDYuNjI0NiwgLTIzLjUzMjVdXG4gKiAgICAgICB9XG4gKiAgICAgfSwge1xuICogICAgICAgXCJ0eXBlXCI6IFwiRmVhdHVyZVwiLFxuICogICAgICAgXCJwcm9wZXJ0aWVzXCI6IHt9LFxuICogICAgICAgXCJnZW9tZXRyeVwiOiB7XG4gKiAgICAgICAgIFwidHlwZVwiOiBcIlBvaW50XCIsXG4gKiAgICAgICAgIFwiY29vcmRpbmF0ZXNcIjogWy00Ni42MDYyLCAtMjMuNTUxM11cbiAqICAgICAgIH1cbiAqICAgICB9LCB7XG4gKiAgICAgICBcInR5cGVcIjogXCJGZWF0dXJlXCIsXG4gKiAgICAgICBcInByb3BlcnRpZXNcIjoge30sXG4gKiAgICAgICBcImdlb21ldHJ5XCI6IHtcbiAqICAgICAgICAgXCJ0eXBlXCI6IFwiUG9pbnRcIixcbiAqICAgICAgICAgXCJjb29yZGluYXRlc1wiOiBbLTQ2LjY2MywgLTIzLjU1NF1cbiAqICAgICAgIH1cbiAqICAgICB9LCB7XG4gKiAgICAgICBcInR5cGVcIjogXCJGZWF0dXJlXCIsXG4gKiAgICAgICBcInByb3BlcnRpZXNcIjoge30sXG4gKiAgICAgICBcImdlb21ldHJ5XCI6IHtcbiAqICAgICAgICAgXCJ0eXBlXCI6IFwiUG9pbnRcIixcbiAqICAgICAgICAgXCJjb29yZGluYXRlc1wiOiBbLTQ2LjY0MywgLTIzLjU1N11cbiAqICAgICAgIH1cbiAqICAgICB9XG4gKiAgIF1cbiAqIH07XG4gKlxuICogdmFyIHB0c1dpdGhpbiA9IHR1cmYud2l0aGluKHBvaW50cywgc2VhcmNoV2l0aGluKTtcbiAqXG4gKiAvLz1wb2ludHNcbiAqXG4gKiAvLz1zZWFyY2hXaXRoaW5cbiAqXG4gKiAvLz1wdHNXaXRoaW5cbiAqL1xubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihwdEZDLCBwb2x5RkMpe1xuICB2YXIgcG9pbnRzV2l0aGluID0gZmVhdHVyZUNvbGxlY3Rpb24oW10pO1xuICBmb3IgKHZhciBpID0gMDsgaSA8IHBvbHlGQy5mZWF0dXJlcy5sZW5ndGg7IGkrKykge1xuICAgIGZvciAodmFyIGogPSAwOyBqIDwgcHRGQy5mZWF0dXJlcy5sZW5ndGg7IGorKykge1xuICAgICAgdmFyIGlzSW5zaWRlID0gaW5zaWRlKHB0RkMuZmVhdHVyZXNbal0sIHBvbHlGQy5mZWF0dXJlc1tpXSk7XG4gICAgICBpZihpc0luc2lkZSl7XG4gICAgICAgIHBvaW50c1dpdGhpbi5mZWF0dXJlcy5wdXNoKHB0RkMuZmVhdHVyZXNbal0pO1xuICAgICAgfVxuICAgIH1cbiAgfVxuICByZXR1cm4gcG9pbnRzV2l0aGluO1xufTtcbiIsIi8vIGh0dHA6Ly9lbi53aWtpcGVkaWEub3JnL3dpa2kvRXZlbiVFMiU4MCU5M29kZF9ydWxlXG4vLyBtb2RpZmllZCBmcm9tOiBodHRwczovL2dpdGh1Yi5jb20vc3Vic3RhY2svcG9pbnQtaW4tcG9seWdvbi9ibG9iL21hc3Rlci9pbmRleC5qc1xuLy8gd2hpY2ggd2FzIG1vZGlmaWVkIGZyb20gaHR0cDovL3d3dy5lY3NlLnJwaS5lZHUvSG9tZXBhZ2VzL3dyZi9SZXNlYXJjaC9TaG9ydF9Ob3Rlcy9wbnBvbHkuaHRtbFxuXG4vKipcbiAqIFRha2VzIGEge0BsaW5rIFBvaW50fSBmZWF0dXJlIGFuZCBhIHtAbGluayBQb2x5Z29ufSBmZWF0dXJlIGFuZCBkZXRlcm1pbmVzIGlmIHRoZSBQb2ludCByZXNpZGVzIGluc2lkZSB0aGUgUG9seWdvbi4gVGhlIFBvbHlnb24gY2FuXG4gKiBiZSBjb252ZXggb3IgY29uY2F2ZS4gVGhlIGZ1bmN0aW9uIGFjY2VwdHMgYW55IHZhbGlkIFBvbHlnb24gb3Ige0BsaW5rIE11bHRpUG9seWdvbn1cbiAqIGFuZCBhY2NvdW50cyBmb3IgaG9sZXMuXG4gKlxuICogQG1vZHVsZSB0dXJmL2luc2lkZVxuICogQGNhdGVnb3J5IGpvaW5zXG4gKiBAcGFyYW0ge1BvaW50fSBwb2ludCBhIFBvaW50IGZlYXR1cmVcbiAqIEBwYXJhbSB7UG9seWdvbn0gcG9seWdvbiBhIFBvbHlnb24gZmVhdHVyZVxuICogQHJldHVybiB7Qm9vbGVhbn0gYHRydWVgIGlmIHRoZSBQb2ludCBpcyBpbnNpZGUgdGhlIFBvbHlnb247IGBmYWxzZWAgaWYgdGhlIFBvaW50IGlzIG5vdCBpbnNpZGUgdGhlIFBvbHlnb25cbiAqIEBleGFtcGxlXG4gKiB2YXIgcHQxID0ge1xuICogICBcInR5cGVcIjogXCJGZWF0dXJlXCIsXG4gKiAgIFwicHJvcGVydGllc1wiOiB7XG4gKiAgICAgXCJtYXJrZXItY29sb3JcIjogXCIjZjAwXCJcbiAqICAgfSxcbiAqICAgXCJnZW9tZXRyeVwiOiB7XG4gKiAgICAgXCJ0eXBlXCI6IFwiUG9pbnRcIixcbiAqICAgICBcImNvb3JkaW5hdGVzXCI6IFstMTExLjQ2NzI4NSwgNDAuNzU3NjZdXG4gKiAgIH1cbiAqIH07XG4gKiB2YXIgcHQyID0ge1xuICogICBcInR5cGVcIjogXCJGZWF0dXJlXCIsXG4gKiAgIFwicHJvcGVydGllc1wiOiB7XG4gKiAgICAgXCJtYXJrZXItY29sb3JcIjogXCIjMGYwXCJcbiAqICAgfSxcbiAqICAgXCJnZW9tZXRyeVwiOiB7XG4gKiAgICAgXCJ0eXBlXCI6IFwiUG9pbnRcIixcbiAqICAgICBcImNvb3JkaW5hdGVzXCI6IFstMTExLjg3Mzc3OSwgNDAuNjQ3MzAzXVxuICogICB9XG4gKiB9O1xuICogdmFyIHBvbHkgPSB7XG4gKiAgIFwidHlwZVwiOiBcIkZlYXR1cmVcIixcbiAqICAgXCJwcm9wZXJ0aWVzXCI6IHt9LFxuICogICBcImdlb21ldHJ5XCI6IHtcbiAqICAgICBcInR5cGVcIjogXCJQb2x5Z29uXCIsXG4gKiAgICAgXCJjb29yZGluYXRlc1wiOiBbW1xuICogICAgICAgWy0xMTIuMDc0Mjc5LCA0MC41MjIxNV0sXG4gKiAgICAgICBbLTExMi4wNzQyNzksIDQwLjg1MzI5M10sXG4gKiAgICAgICBbLTExMS42MTAxMDcsIDQwLjg1MzI5M10sXG4gKiAgICAgICBbLTExMS42MTAxMDcsIDQwLjUyMjE1XSxcbiAqICAgICAgIFstMTEyLjA3NDI3OSwgNDAuNTIyMTVdXG4gKiAgICAgXV1cbiAqICAgfVxuICogfTtcbiAqXG4gKiB2YXIgZmVhdHVyZXMgPSB7XG4gKiAgIFwidHlwZVwiOiBcIkZlYXR1cmVDb2xsZWN0aW9uXCIsXG4gKiAgIFwiZmVhdHVyZXNcIjogW3B0MSwgcHQyLCBwb2x5XVxuICogfTtcbiAqXG4gKiAvLz1mZWF0dXJlc1xuICpcbiAqIHZhciBpc0luc2lkZTEgPSB0dXJmLmluc2lkZShwdDEsIHBvbHkpO1xuICogLy89aXNJbnNpZGUxXG4gKlxuICogdmFyIGlzSW5zaWRlMiA9IHR1cmYuaW5zaWRlKHB0MiwgcG9seSk7XG4gKiAvLz1pc0luc2lkZTJcbiAqL1xubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihwb2ludCwgcG9seWdvbikge1xuICB2YXIgcG9seXMgPSBwb2x5Z29uLmdlb21ldHJ5LmNvb3JkaW5hdGVzO1xuICB2YXIgcHQgPSBbcG9pbnQuZ2VvbWV0cnkuY29vcmRpbmF0ZXNbMF0sIHBvaW50Lmdlb21ldHJ5LmNvb3JkaW5hdGVzWzFdXTtcbiAgLy8gbm9ybWFsaXplIHRvIG11bHRpcG9seWdvblxuICBpZihwb2x5Z29uLmdlb21ldHJ5LnR5cGUgPT09ICdQb2x5Z29uJykgcG9seXMgPSBbcG9seXNdO1xuXG4gIHZhciBpbnNpZGVQb2x5ID0gZmFsc2U7XG4gIHZhciBpID0gMDtcbiAgd2hpbGUgKGkgPCBwb2x5cy5sZW5ndGggJiYgIWluc2lkZVBvbHkpIHtcbiAgICAvLyBjaGVjayBpZiBpdCBpcyBpbiB0aGUgb3V0ZXIgcmluZyBmaXJzdFxuICAgIGlmKGluUmluZyhwdCwgcG9seXNbaV1bMF0pKSB7XG4gICAgICB2YXIgaW5Ib2xlID0gZmFsc2U7XG4gICAgICB2YXIgayA9IDE7XG4gICAgICAvLyBjaGVjayBmb3IgdGhlIHBvaW50IGluIGFueSBvZiB0aGUgaG9sZXNcbiAgICAgIHdoaWxlKGsgPCBwb2x5c1tpXS5sZW5ndGggJiYgIWluSG9sZSkge1xuICAgICAgICBpZihpblJpbmcocHQsIHBvbHlzW2ldW2tdKSkge1xuICAgICAgICAgIGluSG9sZSA9IHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgaysrO1xuICAgICAgfVxuICAgICAgaWYoIWluSG9sZSkgaW5zaWRlUG9seSA9IHRydWU7XG4gICAgfVxuICAgIGkrKztcbiAgfVxuICByZXR1cm4gaW5zaWRlUG9seTtcbn1cblxuLy8gcHQgaXMgW3gseV0gYW5kIHJpbmcgaXMgW1t4LHldLCBbeCx5XSwuLl1cbmZ1bmN0aW9uIGluUmluZyAocHQsIHJpbmcpIHtcbiAgdmFyIGlzSW5zaWRlID0gZmFsc2U7XG4gIGZvciAodmFyIGkgPSAwLCBqID0gcmluZy5sZW5ndGggLSAxOyBpIDwgcmluZy5sZW5ndGg7IGogPSBpKyspIHtcbiAgICB2YXIgeGkgPSByaW5nW2ldWzBdLCB5aSA9IHJpbmdbaV1bMV07XG4gICAgdmFyIHhqID0gcmluZ1tqXVswXSwgeWogPSByaW5nW2pdWzFdO1xuICAgIFxuICAgIHZhciBpbnRlcnNlY3QgPSAoKHlpID4gcHRbMV0pICE9ICh5aiA+IHB0WzFdKSlcbiAgICAgICAgJiYgKHB0WzBdIDwgKHhqIC0geGkpICogKHB0WzFdIC0geWkpIC8gKHlqIC0geWkpICsgeGkpO1xuICAgIGlmIChpbnRlcnNlY3QpIGlzSW5zaWRlID0gIWlzSW5zaWRlO1xuICB9XG4gIHJldHVybiBpc0luc2lkZTtcbn1cblxuIiwidmFyIGJ1ZmZlciA9IHJlcXVpcmUoJ3R1cmYtYnVmZmVyJyk7XG52YXIgd2l0aGluID0gcmVxdWlyZSgndHVyZi13aXRoaW4nKTtcbnZhciBmYyA9IHJlcXVpcmUoJ3R1cmYtZmVhdHVyZWNvbGxlY3Rpb24nKTtcbnZhciBwb2ludCA9IHJlcXVpcmUoJ3R1cmYtcG9pbnQnKTtcblxudmFyICQgPSByZXF1aXJlKCdqcXVlcnknKTtcbi8vdmFyIHR1cmYgPSByZXF1aXJlKCd0dXJmJyk7XG5cbnZhciBiYXNlVVJJID0gd2luZG93LmxvY2F0aW9uLmhyZWY7XG52YXIgY3VycmVudFJhZGl1cyA9IDAuNTtcblxuTC5tYXBib3guYWNjZXNzVG9rZW4gPSAncGsuZXlKMUlqb2ljM0owYUhWeWJXRnVJaXdpWVNJNklrVkdYeTFOTUhjaWZRLkVvdUlOREVaR3pqR3MweDBWTWhIeGcnO1xuXG52YXIgbWFwID0gTC5tYXBib3gubWFwKCdtYXAnLCdzcnRodXJtYW4ubjlsNzFpODYnKVxuICAgIC5zZXRWaWV3KFszOC45MDEwNzgsIC03Ny4wMjQzNjFdLCAxNSk7XG4gICAgXG52YXIgd21hdGFSb3V0ZXMgPSBMLm1hcGJveC5mZWF0dXJlTGF5ZXIoKVxuICAgIC5sb2FkVVJMKGJhc2VVUkkrJ3dtYXRhUm91dGVzJylcbiAgICAuYWRkVG8obWFwKTtcbiAgICBcbnZhciBtYXJrZXIgPSBMLm1hcmtlcihuZXcgTC5MYXRMbmcoMzguOTAxMDc4LCAtNzcuMDI0MzYxKSwge1xuICAgIGljb246IEwubWFwYm94Lm1hcmtlci5pY29uKHtcbiAgICAgICAgXCJtYXJrZXItY29sb3JcIjogXCIjRkYwMEZGXCIsXG4gICAgICAgIFwidGl0bGVcIjogXCJZb3UgbmVlZCBjb2ZmZWVcIixcbiAgICAgICAgXCJtYXJrZXItc3ltYm9sXCI6IFwicGl0Y2hcIixcbiAgICAgICAgXCJtYXJrZXItc2l6ZVwiOiBcImxhcmdlXCJcbiAgICB9KSxcbiAgICBkcmFnZ2FibGU6IHRydWUsXG4gICAgekluZGV4T2Zmc2V0Ojk5OVxufSkuYWRkVG8obWFwKTtcblxuXG4kLmdldChiYXNlVVJJKyd3bWF0YVN0b3BzJywgZnVuY3Rpb24oZGF0YSkge1xuICAgIC8vY2xpY2stbW92ZSBmdW5jdGlvbmFsaXR5XG4gICAgbWFwLm9uKCdjbGljaycsZnVuY3Rpb24oZSl7XG4gICAgICAgIG1hcmtlci5zZXRMYXRMbmcoW2UubGF0bG5nLmxhdCwgZS5sYXRsbmcubG5nXSk7XG4gICAgICAgIG1hcC5zZXRWaWV3KFtlLmxhdGxuZy5sYXQsIGUubGF0bG5nLmxuZ10sMTUpO1xuICAgICAgICB1cGRhdGVUcmFuc2l0UG9pbnRzKCk7XG4gICAgfSk7XG4gICAgXG4gICAgLy8gZ2V0IHBvc2l0aW9uLCBnZXQgcmFkaXVzLCBkcmF3IGJ1ZmZlciwgZmluZCB3aXRoaW4sIGNhbGN1bGF0ZSBkaXN0YW5jZXMsIGZpbmQgbmVhcmVzdCwgYWRkIHRvIG1hcFxuICAgIGZ1bmN0aW9uIHVwZGF0ZVRyYW5zaXRQb2ludHMoKXtcbiAgICAgICAgJCgncGF0aCcpLnJlbW92ZSgpO1xuICAgICAgICAkKCcubGVhZmxldC1tYXJrZXItcGFuZSAqJykubm90KCc6Zmlyc3QnKS5yZW1vdmUoKTtcbiAgICAgICAgdmFyIHBvc2l0aW9uPW1hcmtlci5nZXRMYXRMbmcoKTtcbiAgICAgICAgdmFyIHB0PXBvaW50KFtwb3NpdGlvbi5sbmcsIHBvc2l0aW9uLmxhdF0pO1xuXG4gICAgICAgIC8vZHJhdyBidWZmZXJcbiAgICAgICAgdmFyIGJ1ZmZlckxheWVyID0gTC5tYXBib3guZmVhdHVyZUxheWVyKCkuYWRkVG8obWFwKTtcbiAgICAgICAgXG4gICAgICAgIHZhciB0cmFuc2l0QnVmZmVyID0gYnVmZmVyKHB0LCBjdXJyZW50UmFkaXVzLCAnbWlsZXMnKTtcbiAgICAgICAgdHJhbnNpdEJ1ZmZlci5wcm9wZXJ0aWVzID0ge1xuICAgICAgICAgICAgXCJmaWxsXCI6IFwiIzAwNzA0QVwiLFxuICAgICAgICAgICAgXCJmaWxsLW9wYWNpdHlcIjowLjA1LFxuICAgICAgICAgICAgXCJzdHJva2VcIjogXCIjMDA3MDRBXCIsXG4gICAgICAgICAgICBcInN0cm9rZS13aWR0aFwiOiAyLFxuICAgICAgICAgICAgXCJzdHJva2Utb3BhY2l0eVwiOiAwLjVcbiAgICAgICAgfTtcbiAgICAgICAgXG4gICAgICAgIGJ1ZmZlckxheWVyLnNldEdlb0pTT04odHJhbnNpdEJ1ZmZlcik7XG4gICAgICAgIFxuICAgICAgICAvL2xvYWQgc3RvcHMgYW5kIGZpbHRlciBiYXNlZCBvbiBidWZmZXJcbiAgICAgICAgdmFyIGZpbHRlcmVkU3RvcHMgPSBMLm1hcGJveC5mZWF0dXJlTGF5ZXIoKS5hZGRUbyhtYXApO1xuICAgICAgICB2YXIgc3RvcHMgPSB3aXRoaW4oZGF0YSwgZmMoW3RyYW5zaXRCdWZmZXJdKSk7XG4gICAgICAgIGNvbnNvbGUubG9nKHN0b3BzKTtcbiAgICAgICAgXG4gICAgICAgIHZhciBtZXRyb1N0b3BzID0gW107XG4gICAgICAgIGZvciAocz0wLGw9c3RvcHMuZmVhdHVyZXMubGVuZ3RoO3M8bDtzKyspIHtcbiAgICAgICAgICAgIHZhciBjdXJyU3RvcCA9IHN0b3BzLmZlYXR1cmVzW3NdO1xuICAgICAgICAgICAgdmFyIHN0ciA9IGN1cnJTdG9wWyduYW1lJ107XG4gICAgICAgICAgICB2YXIgcmUgPSAvbWV0cm8gc3RhdGlvbi9pO1xuICAgICAgICAgICAgdmFyIGZvdW5kID0gc3RyLm1hdGNoKHJlKTtcbiAgICAgICAgICAgIGlmIChmb3VuZCkge1xuICAgICAgICAgICAgICAgIG1ldHJvU3RvcHMucHVzaChjdXJyU3RvcCk7XG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgICAgIGNvbnNvbGUubG9nKGZjKFttZXRyb1N0b3BzXSkuZmVhdHVyZXNbMF0pO1xuICAgICAgICBmaWx0ZXJlZFN0b3BzLnNldEdlb0pTT04oZmMoW21ldHJvU3RvcHNdKS5mZWF0dXJlc1swXSk7XG4gICAgICAgIFxuICAgICAgICB2YXIgbWV0cm9TdG9wQ291bnQgPSBtZXRyb1N0b3BzLmxlbmd0aDtcbiAgICAgICAgdmFyIGJ1c1N0b3BDb3VudCA9IHN0b3BzLmZlYXR1cmVzLmxlbmd0aCAtIG1ldHJvU3RvcENvdW50O1xuICAgICAgICBcbiAgICAgICAgJCgnI21ldHJvU3RvcFRhbGx5JykuaHRtbChtZXRyb1N0b3BDb3VudCk7XG4gICAgICAgICQoJyNidXNTdG9wVGFsbHknKS5odG1sKGJ1c1N0b3BDb3VudCk7XG4gICAgfVxuICAgIG1hcmtlci5vbignZHJhZycsIGZ1bmN0aW9uKCl7dXBkYXRlVHJhbnNpdFBvaW50cygpfSk7XG4gICAgdXBkYXRlVHJhbnNpdFBvaW50cygpO1xufSk7Il19
